000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    RCKCS805.                                         00020001
000300 AUTHOR.        JOE LAROSA.                                       00030001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
000500 DATE-WRITTEN.  10-13-99                                          00050001
000600 DATE-COMPILED.                                                   00060001
000700******************************************************************00070001
000800*    E805 - 'STORE DISTRIBUTION BY PACK'                          00080001
000900*    (CLONED FROM E218 - STORE DISTRIBUTION LIST)                 00090001
001000*                                                                 00100001
001100*    THIS PROGRAM LISTS STORE DISTRIBUTION(IN PACKS) FOR A        00110037
001200*    GIVEN PACK-ID.  THE SCREEN ALLOWS UPDATES TO THE ALLOCATED   00120037
001300*    STORE QUANTITIES (CONVERTING THE PACKS BACK TO UNITS PRIOR   00130037
001400*    TO UPDATE), PROCESSING ALL THE ITEMS FOR THE PACK ID.        00140037
001500*----------------------------------------------------------------*00150099
001510*  CHANGED 10/20/14 BY CHERI PARMLEY       CHG#0094517           *00151099
001520*    EXPANDED PO# FROM 7 TO 8 DIGITS                             *00152099
001530*---------------------------------------------------------------* 00153099
001540* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00154099
001550* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00155099
001560* MAKING THE CALL DYNAMIC VS STATIC.                              00156099
001600******************************************************************00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800 DATA DIVISION.                                                   00180001
001900 WORKING-STORAGE SECTION.                                         00190001
002000                                                                  00200001
002100 01  PC-PROGRAM-CONSTANTS.                                        00210001
002200     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC805A  '. 00220001
002300     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM805 '. 00230001
002400     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS805'. 00240001
002500     05  PC-AUDIT-RTN                 PIC X(8)  VALUE 'RCKCS290'. 00250001
002600     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE  +300       00260001
002700                                                COMP SYNC.        00270001
002800     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00280001
002900     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00290001
003000     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +8          00300011
003100                                                COMP SYNC.        00310001
003200     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00320001
003300                                                COMP SYNC.        00330001
003400     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00340001
003500                                                COMP SYNC.        00350001
003600     05  PC-EDIT-MASK                 PIC ZZZ,ZZ9.                00360061
003700     05  PC-ZERO                      PIC S9(4) COMP              00370099
003800                                                VALUE 0.          00380099
003900     05  PC-01                        PIC X(02) VALUE '01'.       00390099
004000     05  PC-CM                        PIC X(02) VALUE 'CM'.       00400001
004100     05  PC-VE                        PIC X(02) VALUE 'VE'.       00410001
004200     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00420001
004300     05  PC-I                         PIC X(01) VALUE 'I'.        00430001
004400     05  PC-A                         PIC X(01) VALUE 'A'.        00440001
004500     05  PC-M                         PIC X(01) VALUE 'M'.        00450065
004600     05  PC-N                         PIC X(01) VALUE 'N'.        00460065
004700     05  PC-RV                        PIC X(02) VALUE 'RV'.       00470099
004800     05  PC-DASH                      PIC X(01) VALUE '-'.        00480001
004900     05  PC-INTER-APPL-CODES.                                     00490001
005000         10  PC-INTER-APPL-PK-LST     PIC X(01) VALUE ' '.        00500010
005100         10  PC-INTER-APPL-PK-LST-DTL PIC X(01) VALUE ' '.        00510010
005200         10  PC-INTER-APPL-STR-ADD    PIC X(01) VALUE '?'.        00520010
005300                                                                  00530038
005400     05  PC-BULK                      PIC X(01) VALUE 'B'.        00540038
005500     05  PC-CASE                      PIC X(01) VALUE 'C'.        00550038
005600     05  PC-MULTIPLE                  PIC X(01) VALUE 'M'.        00560038
005700     05  PC-INNER                     PIC X(01) VALUE 'I'.        00570038
005800     05  PC-SINGLE                    PIC X(01) VALUE 'S'.        00580038
005900     05  PC-PKG-TYP-NOT-FOUND         PIC X(01) VALUE 'X'.        00590038
006000     05  PC-MULTI-SKU-PACK-DESC       PIC X(12) VALUE             00600038
006100         'M MULTI PACK'.                                          00610038
006200     05  PC-SINGLE-SKU-PACK-DESC      PIC X(12) VALUE             00620038
006300         'S SINGLE SKU'.                                          00630038
006400     05  PC-INNER-PACK-DESC           PIC X(12) VALUE             00640038
006500         'I INNER PACK'.                                          00650038
006600     05  PC-BULK-PACK-DESC            PIC X(11) VALUE             00660038
006700         'B BULK PACK'.                                           00670038
006800     05  PC-CASE-PACK-DESC            PIC X(11) VALUE             00680038
006900         'C CASE PACK'.                                           00690038
007000     05  PC-PKG-TYP-NOT-FOUND-DESC    PIC X(19) VALUE             00700038
007100         'PACK TYPE NOT FOUND'.                                   00710038
007200                                                                  00720001
007300     05  PC-TSYMSG-NUMBERS.                                       00730001
007400         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00740001
007500*            INVALID VALUE                                        00750001
007600         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00760001
007700*            MUST BE NUMERIC                                      00770001
007800         10  PC-TSYMSG-00047          PIC 9(5)  VALUE 00047.      00780083
007900*            ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION 00790083
008000         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00800083
008100*            NO END OF RANGE HAS BEEN SPECIFIED                   00810001
008200         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00820001
008300*            END OF RANGE PRECEDES START OF RANGE                 00830001
008400         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00840001
008500*            NO START OF RANGE HAS BEEN SPECIFIED                 00850001
008600         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00860001
008700*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00870001
008800         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00880001
008900*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00890001
009000         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00900001
009100*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00910001
009200         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00920001
009300*            UPDATE(S) SUCCESSFUL                                 00930001
009400         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00940001
009500*            TOP OF LIST                                          00950001
009600         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00960001
009700*            BOTTOM OF LIST                                       00970001
009800         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00980001
009900*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00990001
010000         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01000001
010100*            MORE ITEMS TO DISPLAY                                01010001
010200         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01020001
010300*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 01030001
010400*            CALL HELP DESK                                       01040001
010500         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      01050001
010600*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         01060001
010700         10  PC-TSYMSG-00866          PIC 9(5)  VALUE 00866.      01070001
010800*            RCVR LNE QTY AND DISTR LNE QTY MUST MATCH            01080001
010900         10  PC-TSYMSG-01858          PIC 9(5)  VALUE 01858.      01090001
011000*            UNABLE TO UPDATE STORE DISTROS, CASEPACK SPLIT HAS   01100001
011100*            BEEN PERFORMED                                       01110001
011200         10  PC-TSYMSG-02222          PIC 9(5)  VALUE 02222.      01120077
011300*            EXPECTED PACK QTY MUST MATCH PRORATED PACK QTY       01130088
011400         10  PC-TSYMSG-02382          PIC 9(5)  VALUE 02382.      01140094
011500*            TROUBLE WAS NOT SELECTED, CANNOT GO TO RESPOND SCREEN01150088
011600         10  PC-TSYMSG-02762          PIC 9(5)  VALUE 02762.      01160099
011700*            PACK IS NOT CONFIRMED                                01170099
011800         10  PC-TSYMSG-00984          PIC 9(5)  VALUE 00984.      01180099
011900         10  PC-TSYMSG-03138          PIC 9(5)  VALUE 03138.      01190099
011901* JAK 05/2007 - ADD NEW ERROR MSG AND PROGRAM CONSTANT            01190199
011902         10  PC-TSYMSG-03570          PIC 9(5)  VALUE 03570.      01190299
011920     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.01192099
011930* JAK 05/2007 - END                                               01193099
012000                                                                  01200001
012100 01  PS-PROGRAM-SWITCHES.                                         01210001
012200     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01220001
012300         88  PS-NO-ERROR                        VALUE 'N'.        01230001
012400         88  PS-ERROR                           VALUE 'Y'.        01240001
012500     05  PS-MORE-RECITM-SW            PIC  X    VALUE 'N'.        01250034
012600         88  PS-MORE-RECITM-NO                  VALUE 'N'.        01260034
012700         88  PS-MORE-RECITM-YES                 VALUE 'Y'.        01270034
012800     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01280001
012900         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01290001
013000         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01300001
013100     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01310001
013200         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01320001
013300         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01330001
013310* JAK 05/2007 - ADD SWITCHES                                      01331099
013320     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        01332099
013330         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        01333099
013340         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        01334099
013350     05  PS-DISTRO-TRBL-SW            PIC X(01) VALUE 'N'.        01335099
013360         88  PS-DISTRO-TRBL-YES                 VALUE 'Y'.        01336099
013370         88  PS-DISTRO-TRBL-NO                  VALUE 'N'.        01337099
013380* JAK 05/2007 - END                                               01338099
013400                                                                  01340001
013500 01  DK-DB2-KEYS.                                                 01350001
013600     05  DK-REC-NBR                   PIC S9(9) COMP VALUE +0.    01360003
013700     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01370001
013800     05  DK-DRV-LNE-NBR               PIC S9(4) COMP VALUE +0.    01380003
013900     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    01390001
014000                                                                  01400001
014100 01  PV-PROGRAM-VARIABLES.                                        01410001
014200     05  PV-SUB                       PIC S9(4) VALUE ZERO        01420001
014300                                                COMP SYNC.        01430001
014400     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01440001
014500                                                COMP SYNC.        01450001
014600     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01460001
014700                                                COMP-3.           01470001
014800     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01480001
014900                                                COMP-3.           01490001
015000     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01500001
015100                                                COMP-3.           01510001
015200     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01520001
015300                                                COMP-3.           01530001
015400     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01540001
015500                                                COMP-3.           01550001
015600     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01560001
015700                                                COMP-3.           01570001
015800     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01580001
015900                                                COMP-3.           01590001
016000     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01600001
016100                                                COMP SYNC.        01610001
016200     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01620001
016300                                                COMP SYNC.        01630001
016400     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01640001
016500                                                COMP SYNC.        01650001
016600     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01660001
016700                                                COMP SYNC.        01670001
016800     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01680001
016900                                                COMP SYNC.        01690001
017000     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01700001
017100                                                COMP SYNC.        01710001
017200     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01720001
017300                                                COMP SYNC.        01730001
017400     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01740001
017500                                                COMP SYNC.        01750001
017600     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01760001
017700                                                COMP SYNC.        01770001
017800     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01780001
017900                                                COMP SYNC.        01790001
018000     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01800001
018100                                                COMP SYNC.        01810001
018200     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01820001
018300                                                COMP SYNC.        01830001
018400     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01840001
018500                                                COMP SYNC.        01850001
018600     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01860001
018700                                                COMP SYNC.        01870001
018800     05  PV-DISTR-LNE-QTY             PIC S9(9) VALUE ZERO        01880001
018900                                                COMP SYNC.        01890001
019000     05  PV-VERIFY-QTY-PK             PIC S9(6) VALUE ZERO.       01900017
019100     05  PV-EXPTED-QTY-PK             PIC S9(6) VALUE ZERO.       01910017
019200     05  PV-LAST-QTY-PK               PIC S9(6) VALUE ZERO.       01920017
019300     05  PV-PRIOR-QTY-PK              PIC S9(6) VALUE ZERO.       01930017
019400     05  PV-CURR-PREPK-RATO-QTY       PIC S9(4) VALUE ZERO COMP.  01940076
019500                                                                  01950017
019600     05  PV-AD-DATE-MM-DD-CCYY.                                   01960001
019700         10  PV-AD-DATE-MM            PIC X(02) VALUE SPACES.     01970001
019800         10  FILLER                   PIC X(01) VALUE '-'.        01980001
019900         10  PV-AD-DATE-DD            PIC X(02) VALUE SPACES.     01990001
020000         10  FILLER                   PIC X(01) VALUE '-'.        02000001
020100         10  PV-AD-DATE-CCYY          PIC X(04) VALUE SPACES.     02010001
020200     05  PV-DB2-DATE-FORMAT           PIC X(10).                  02020001
020300     05  PV-DB2-DATE-FORMAT-REDE.                                 02030001
020400         10  PV-DB2-CCYY.                                         02040001
020500             15  PV-DB2-CC            PIC X(02) VALUE SPACES.     02050001
020600             15  PV-DB2-YY            PIC X(02) VALUE SPACES.     02060001
020700         10  FILLER                   PIC X(01) VALUE '-'.        02070001
020800         10  PV-DB2-MM                PIC X(02) VALUE SPACES.     02080001
020900         10  FILLER                   PIC X(01) VALUE '-'.        02090001
021000         10  PV-DB2-DD                PIC X(02) VALUE SPACES.     02100001
021100     05  PV-SCREEN-DATE-FORMAT.                                   02110001
021200         10  PV-SCREEN-DATE-MM        PIC X(02) VALUE SPACES.     02120001
021300         10  PV-SCREEN-DATE-DD        PIC X(02) VALUE SPACES.     02130001
021400         10  PV-SCREEN-DATE-YY        PIC X(02) VALUE SPACES.     02140001
021500     05  PV-CHECK-FOR-DEFAULT-DATE    PIC X(10) VALUE SPACES.     02150001
021600         88  PV-DEFAULT-DATE                    VALUES            02160001
021700                                                '0001-01-01',     02170001
021800                                                '9999-09-09'.     02180001
021900     05  PV-DB2-CURRENT-TMST          PIC X(26).                  02190001
022000     05  PV-KEY-OPER-UNT-ID           PIC S9(4).                  02200010
022010     05  PV-UNPACK-OPER-UNT-ID        PIC  9(4).                  02201099
022100     05  PV-RV-COUNTER                PIC S9(9) VALUE ZERO        02210099
022200                                                COMP-3.           02220099
022210* JAK 05/2007 - ADD PROGRAM VARIABLES                             02221099
022220     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02222099
022230                                                     COMP SYNC.   02223099
022240     05  PV-SQL-CNT                     PIC S9(04)   VALUE +0     02224099
022250                                                    COMP.         02225099
022260* JAK 05/2007 - END                                               02226099
022400 01  MSG-QUEUE-ITEM.                                              02240001
022500     05  FILLER                       PIC X(11)  VALUE            02250001
022600         'QUEUE NAME '.                                           02260001
022700     05  MSG-QUEUE-NAME               PIC X(08).                  02270001
022800     05  FILLER                       PIC X(14)  VALUE            02280001
022900         '  ITEM NUMBER '.                                        02290001
023000     05  MSG-SEL-ITEM                 PIC 9(04).                  02300001
023100                                                                  02310001
023200 01  MSG1-PO-REC.                                                 02320001
023300     05  FILLER                       PIC X(07)  VALUE            02330001
023400         'PO NBR '.                                               02340001
023500     05  MSG1-PO-NBR                  PIC 9(09).                  02350001
023600     05  FILLER                       PIC X(11)  VALUE            02360001
023700         '  REC SEQ  '.                                           02370001
023800     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  02380001
023900     05  FILLER                       PIC X(12)  VALUE            02390001
024000         '  OPER UNIT '.                                          02400001
024100     05  MSG1-OPER-UNT-ID             PIC X(04).                  02410001
024200     05  FILLER                       PIC X(11)  VALUE            02420001
024300         '  FACILITY '.                                           02430001
024400     05  MSG1-FACILITY-ID             PIC X(04).                  02440001
024500                                                                  02450001
024600                                                                  02460001
024700 01  LQW-LIST-QUEUE-WORK-AREA.                                    02470001
024800     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02480001
024900     05  LQW-ITEM-ENTRIES             OCCURS 8 TIMES              02490003
025000                                      INDEXED BY LQW-IDX.         02500001
025100         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02510001
025200         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02520001
025300         10  LQW-SELECTED-SW          PIC X(01).                  02530001
025400             88  LQW-SELECT                      VALUE 'S'.       02540001
025500             88  LQW-DESELECT                    VALUE ' '.       02550001
025600         10  LQW-STR-QTY-PREV         PIC 9(05).                  02560001
025700         10  LQW-STR-QTY              PIC 9(05).                  02570001
025800         10  LQW-STR-NBR              PIC 9(04).                  02580001
025900         10  LQW-EXPTED-ITM-QTY       PIC 9(05).                  02590001
026000         10  LQW-OTR                  PIC X(05).                  02600056
026100         10  LQW-OTR-N                PIC S9(9)                   02610001
026200                                         COMP-3.                  02620001
026300         10  LQW-ORDERED-QTY          PIC X(05).                  02630056
026400         10  LQW-ORDERED-QTY-N        PIC S9(9)                   02640057
026500                                         COMP-3.                  02650056
026600         10  LQW-VERFD-QTY            PIC 9(05).                  02660001
026700         10  LQW-STATUS               PIC X(02).                  02670001
026800         10  LQW-STATUS2              PIC X(02).                  02680001
026900         10  LQW-LAST-QTY-REC         PIC 9(06).                  02690001
027000         10  LQW-LAST-DTE-REC         PIC X(06).                  02700001
027100         10  LQW-PRIOR-QTY-REC        PIC 9(06).                  02710001
027200         10  LQW-PRIOR-DTE-REC        PIC X(06).                  02720001
027300         10  LQW-MORE                 PIC X(01).                  02730001
027400                                                                  02740001
027500******************************************************************02750082
027600*  RECORD LAYOUT 'TROUBLE RESPOND/RESOLVE' - TMKCS505             02760082
027700******************************************************************02770082
027800     COPY TMWS002.                                                02780082
027900                                                                  02790082
028000******************************************************************02800027
028100*  RECORD LAYOUT 'INSERT AUDIT MODULE' - RCKCS290                 02810027
028200******************************************************************02820027
028300     COPY RCWS031.                                                02830027
028400                                                                  02840027
028410* JAK 05/2007 - ADD COPYBOOK FOR SHIPPING CONTROL MODULE          02841099
028411******************************************************************02841199
028412*  RECORD LAYOUT 'SHIPPING CONTROL MODULE' - WSKCS305             02841299
028413******************************************************************02841399
028420     COPY WSWS001.                                                02842099
028430                                                                  02843099
028500******************************************************************02850003
028600*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02860001
028700******************************************************************02870001
028800     COPY RCWS801.                                                02880099
028900                                                                  02890001
029000*---------------------------------------------------------------* 02900099
029100*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 02910099
029200*---------------------------------------------------------------* 02920099
029300     COPY RCWS074.                                                02930099
029400                                                                  02940099
029410*----------------------------------------------------------------*02941099
029420*  COPYBOOK FOR LOGISTICS DOMAIN LOCATION ACCESS MODULE (XLKUT071)02942099
029430*----------------------------------------------------------------*02943099
029440     COPY XLWS071.                                                02944099
029450                                                                  02945099
029500***************************************************************** 02950099
029600*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 02960099
029700*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 02970099
029800***************************************************************** 02980099
029900     COPY RCWS040.                                                02990099
030000                                                                  03000099
030100******************************************************************03010001
030200*    BMS MAP                                                      03020001
030300******************************************************************03030010
030400     COPY RCKM805.                                                03040001
030500                                                                  03050001
030600 01  MR-OCCURS-LAYOUT                 REDEFINES RC805AO.          03060001
030700     05  FILLER                       PIC X(355).                 03070099
030800                                                                  03080001
030900     05  MR-SCROLL-AREA               OCCURS 8 TIMES.             03090001
031000         10  MR-SELECTL               PIC S9(4) COMP.             03100001
031100         10  MR-SELECTA               PIC X.                      03110001
031200         10  MR-SELECTC               PIC X.                      03120001
031300         10  MR-SELECTH               PIC X.                      03130001
031400         10  MR-SELECTI               PIC X.                      03140001
031500                                                                  03150001
031600         10  MR-STR-QTY-L             PIC S9(4) COMP.             03160001
031700         10  MR-STR-QTY-A             PIC X.                      03170001
031800         10  MR-STR-QTY-C             PIC X.                      03180001
031900         10  MR-STR-QTY-H             PIC X.                      03190001
032000         10  MR-STR-QTY.                                          03200001
032100             15  MR-STR-QTY-EDITED    PIC ZZZZ9.                  03210001
032200                                                                  03220001
032300         10  MR-STR-NBR-L             PIC S9(4) COMP.             03230001
032400         10  MR-STR-NBR-A             PIC X.                      03240001
032500         10  MR-STR-NBR-C             PIC X.                      03250001
032600         10  MR-STR-NBR-H             PIC X.                      03260001
032700         10  MR-STR-NBR               PIC X(04).                  03270001
032800                                                                  03280001
032900         10  MR-EXPTED-ITM-QTY-L      PIC S9(4) COMP.             03290001
033000         10  MR-EXPTED-ITM-QTY-A      PIC X.                      03300001
033100         10  MR-EXPTED-ITM-QTY-C      PIC X.                      03310001
033200         10  MR-EXPTED-ITM-QTY-H      PIC X.                      03320001
033300         10  MR-EXPTED-ITM-QTY.                                   03330001
033400             15  MR-EXPTED-ITM-QTY-EDITED                         03340001
033500                                      PIC ZZZZ9.                  03350001
033600                                                                  03360001
033700         10  MR-OTR-L                 PIC S9(4) COMP.             03370001
033800         10  MR-OTR-A                 PIC X.                      03380001
033900         10  MR-OTR-C                 PIC X.                      03390001
034000         10  MR-OTR-H                 PIC X.                      03400001
034100         10  MR-OTR-QTY.                                          03410017
034200             15  MR-OTR-QTY-EDITED    PIC ZZZZZ9.                 03420053
034300                                                                  03430001
034400         10  MR-ORDER-QTY-L           PIC S9(4) COMP.             03440001
034500         10  MR-ORDER-QTY-A           PIC X.                      03450001
034600         10  MR-ORDER-QTY-C           PIC X.                      03460001
034700         10  MR-ORDER-QTY-H           PIC X.                      03470001
034800         10  MR-ORDER-QTY.                                        03480017
034900             15  MR-ORDER-QTY-EDITED  PIC ZZZZZ9.                 03490053
035000                                                                  03500001
035100         10  MR-VERFD-QTY-L           PIC S9(4) COMP.             03510001
035200         10  MR-VERFD-QTY-A           PIC X.                      03520001
035300         10  MR-VERFD-QTY-C           PIC X.                      03530001
035400         10  MR-VERFD-QTY-H           PIC X.                      03540001
035500         10  MR-VERFD-QTY.                                        03550001
035600             15  MR-VERFD-QTY-EDITED  PIC ZZZZ9.                  03560001
035700                                                                  03570001
035800         10  FILLER                   PIC X(6).                   03580001
035900                                                                  03590001
036000         10  MR-STATUS-L              PIC S9(4) COMP.             03600001
036100         10  MR-STATUS-A              PIC X.                      03610001
036200         10  MR-STATUS-C              PIC X.                      03620001
036300         10  MR-STATUS-H              PIC X.                      03630001
036400         10  MR-STATUS                PIC X(02).                  03640001
036500                                                                  03650001
036600         10  MR-LAST-QTY-REC-L        PIC S9(4) COMP.             03660001
036700         10  MR-LAST-QTY-REC-A        PIC X.                      03670001
036800         10  MR-LAST-QTY-REC-C        PIC X.                      03680001
036900         10  MR-LAST-QTY-REC-H        PIC X.                      03690001
037000         10  MR-LAST-QTY-REC.                                     03700001
037100             15  MR-LAST-QTY-REC-EDITED                           03710001
037200                                      PIC ZZZZZ9.                 03720001
037300                                                                  03730001
037400         10  MR-LAST-DTE-REC-L        PIC S9(4) COMP.             03740001
037500         10  MR-LAST-DTE-REC-A        PIC X.                      03750001
037600         10  MR-LAST-DTE-REC-C        PIC X.                      03760001
037700         10  MR-LAST-DTE-REC-H        PIC X.                      03770001
037800         10  MR-LAST-DTE-REC          PIC X(06).                  03780001
037900                                                                  03790001
038000         10  MR-STATUS2-L             PIC S9(4) COMP.             03800001
038100         10  MR-STATUS2-A             PIC X.                      03810001
038200         10  MR-STATUS2-C             PIC X.                      03820001
038300         10  MR-STATUS2-H             PIC X.                      03830001
038400         10  MR-STATUS2               PIC X(02).                  03840001
038500                                                                  03850001
038600         10  MR-PRIOR-QTY-REC-L       PIC S9(4) COMP.             03860001
038700         10  MR-PRIOR-QTY-REC-A       PIC X.                      03870001
038800         10  MR-PRIOR-QTY-REC-C       PIC X.                      03880001
038900         10  MR-PRIOR-QTY-REC-H       PIC X.                      03890001
039000         10  MR-PRIOR-QTY-REC.                                    03900001
039100             15  MR-PRIOR-QTY-REC-EDITED                          03910001
039200                                      PIC ZZZZZ9.                 03920001
039300                                                                  03930001
039400         10  MR-PRIOR-DTE-REC-L       PIC S9(4) COMP.             03940001
039500         10  MR-PRIOR-DTE-REC-A       PIC X.                      03950001
039600         10  MR-PRIOR-DTE-REC-C       PIC X.                      03960001
039700         10  MR-PRIOR-DTE-REC-H       PIC X.                      03970001
039800         10  MR-PRIOR-DTE-REC         PIC X(06).                  03980001
039900                                                                  03990001
040000         10  MR-MORE-L                PIC S9(4) COMP.             04000001
040100         10  MR-MORE-A                PIC X.                      04010001
040200         10  MR-MORE-C                PIC X.                      04020001
040300         10  MR-MORE-H                PIC X.                      04030001
040400         10  MR-MORE                  PIC X(01).                  04040001
040500     05 FILLER                        PIC X(12).                  04050001
040600                                                                  04060024
040700*----------------------------------------------------------------*04070001
040800**  SECURITY SUBROUTINE PARAMETERS                                04080001
040900*----------------------------------------------------------------*04090001
041000     COPY DPWS008.                                                04100099
041100                                                                  04110003
041200******************************************************************04120001
041300*    BMS ATTRIBUTES                                               04130001
041400******************************************************************04140001
041500     COPY DPWS015.                                                04150099
041600                                                                  04160001
041700******************************************************************04170001
041800*    FUNCTION KEYS                                                04180001
041900******************************************************************04190001
042000     COPY DPWS016.                                                04200099
042100                                                                  04210001
042200******************************************************************04220001
042300*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   04230001
042400******************************************************************04240001
042500     COPY DPWS010I.                                               04250099
042600                                                                  04260001
042700******************************************************************04270001
042800*    PARAMETER LIST FOR CICS API                                  04280001
042900******************************************************************04290001
043000     COPY DPWS030.                                                04300099
043010     COPY DPWS930.                                                04301099
043100                                                                  04310001
043200******************************************************************04320001
043300*    GLOBAL COMMUNICATION AREA                                    04330001
043400******************************************************************04340001
043500     COPY DPWS020.                                                04350099
043600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04360001
043700                                                                  04370001
043800******************************************************************04380001
043900*    INTER-APPLICATION COMMUNICATION AREA                         04390001
044000*    RCWS800 = RECEIVER PACK LISK PROGRAM                         04400003
044100*          AND RECEIVER PACK DETAIL LISK PROGRAM                  04410010
044200*    RCWS015 = STORE ADD PROGRAM                                  04420028
044300*    TMWS001 = TROUBLE RESPOND PROGRAM                            04430082
044400******************************************************************04440001
044500         10  INTER-APPL-COMM-AREA       PIC X(200).               04450001
044600     COPY RCWS800.                                                04460099
044700     COPY RCWS015.                                                04470099
044800     COPY TMWS001.                                                04480099
044900                                                                  04490003
045000******************************************************************04500001
045100*    APPLICATION SPECIFIC COMMUNICATION AREA                      04510001
045200******************************************************************04520010
045300         10  ASC-SPECIFIC-COMMAREA.                               04530001
045400             15  ASC-LIST-HEADER-INFO.                            04540001
045500                 20  ASC-KEY-RECEIVER.                            04550001
045600                     25  ASC-KEY-REC-NBR.                         04560003
045610*CLP 10/20/14                                                     04561099
045700                         30  ASC-KEY-REC-NBR-N  PIC 9(08).        04570099
045800                     25  ASC-KEY-REC-DASH       PIC X(01).        04580001
045900                     25  ASC-KEY-REC-SEQ-NBR.                     04590001
046000                         30  ASC-KEY-REC-SEQ-NBR-N                04600001
046100                                                PIC 9(04).        04610001
046200                 20  ASC-KEY-DRV-LNE-NBR        PIC 9(04).        04620003
046300                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   04630007
046400                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   04640004
046500                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        04650004
046600                 20  ASC-KEY-DEPT-NBR           PIC X(03).        04660004
046700                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        04670003
046800                 20  ASC-KEY-PACK-ID            PIC S9(4) COMP.   04680036
046900                 20  ASC-DSP-PACK.                                04690036
047000                     25  ASC-DSP-PACK-ID.                         04700036
047100                         30  ASC-DSP-PACK-ID-N  PIC 9(03).        04710036
047200                     25  ASC-DSP-PACK-1         PIC X(01).        04720036
047300                     25  ASC-DSP-PACK-DASH      PIC X(01).        04730036
047400                     25  ASC-DSP-PACK-2         PIC X(01).        04740036
047500                     25  ASC-DSP-PACK-TYPE      PIC X(01).        04750036
047600                 20  ASC-KEY-PACK-DESC          PIC X(40).        04760003
047700*EXPTD UNIT QTY (RECITM_DTL_CK_ITM_QTY OR RECITM_PKSL_ITM_QTY)    04770034
047800                 20  ASC-KEY-EXPTD-QTY          PIC 9(06).        04780034
047900*EXPTD PACK QTY (RECITM_DTL_CK_ITM_QTY OR RECITM_PKSL_ITM_QTY)    04790034
048000                 20  ASC-KEY-EXPTD-PK-QTY       PIC 9(06).        04800061
048100                 20  ASC-KEY-EXPTD-PK-QTY-ZERO  PIC X(06).        04810034
048200*ALLOC PACK QTY (RECDIS_EXPTED_ITM_QTY RUNNING TOTAL)             04820003
048300                 20  ASC-KEY-ALLOC-PK-QTY       PIC 9(06).        04830003
048400*PACK OTR (CALCULATED BY DPKCS277)                                04840003
048500                 20  ASC-KEY-PACK-OTR           PIC X(05).        04850063
048600                 20  ASC-KEY-PACK-OTR-N         PIC Z(4)9.        04860063
048700                 20  ASC-KEY-CASE-PACK-QTY      PIC 9(04).        04870012
048800                 20  ASC-KEY-INNR-PACK-QTY      PIC 9(04).        04880012
048900*                                                                 04890003
049000             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               04900001
049100                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       04910001
049200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04920001
049300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04930001
049400                                                                  04940001
049500                 20  ASC-ITEM-ARRAY.                              04950001
049600                     25  ASC-ITEM-ENTRIES  OCCURS 8 TIMES.        04960001
049700                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    04970001
049800                                                     COMP-3.      04980001
049900                         30  ASC-TEMP-SELECTED-SW    PIC X.       04990001
050000                             88  ASC-VALID-SELECT    VALUE ' '    05000001
050100                                                           'S'    05010001
050200                                                           'B'    05020001
050300                                                           'E'.   05030001
050400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05040001
050500                             88  ASC-TEMP-SELECT     VALUE 'S'.   05050001
050600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05060001
050700                             88  ASC-TEMP-END        VALUE 'E'.   05070001
050800                         30  ASC-SELECTED-SW         PIC  X.      05080001
050900                             88  ASC-NO-SELECT       VALUE ' '.   05090001
051000                             88  ASC-SELECT          VALUE 'S'.   05100001
051100                             88  ASC-BEGIN           VALUE 'B'.   05110001
051200                             88  ASC-END             VALUE 'E'.   05120001
051300                         30  ASC-STR-QTY-PREV        PIC 9(05).   05130001
051400                         30  ASC-STR-QTY             PIC X(05).   05140003
051500                         30  ASC-STR-QTY-N       REDEFINES        05150035
051600                             ASC-STR-QTY             PIC 9(05).   05160035
051700                         30  ASC-STR-NBR             PIC X(04).   05170001
051800                         30  ASC-STR-NBR-N       REDEFINES        05180035
051900                             ASC-STR-NBR             PIC 9(04).   05190035
052000                         30  ASC-EXPTED-QTY          PIC X(5).    05200017
052100                         30  ASC-EXPTED-QTY-N    REDEFINES        05210035
052200                             ASC-EXPTED-QTY          PIC 9(05).   05220035
052300                         30  ASC-OTR                 PIC X(5).    05230051
052400                         30  ASC-OTR-N               PIC S9(9)    05240035
052500                                                         COMP-3.  05250001
052600                         30  ASC-ORDERED-QTY         PIC X(5).    05260051
052700                         30  ASC-ORDERED-QTY-N       PIC S9(9)    05270055
052800                                                         COMP-3.  05280051
052900                         30  ASC-VERFD-QTY           PIC X(5).    05290017
053000                         30  ASC-VERFD-QTY-N     REDEFINES        05300035
053100                             ASC-VERFD-QTY           PIC 9(09)    05310051
053200                                                         COMP-3.  05320051
053300                         30  ASC-STATUS              PIC X(02).   05330001
053400                         30  ASC-STATUS-2            PIC X(02).   05340001
053500                         30  ASC-LAST-QTY-REC        PIC X(6).    05350017
053600                         30  ASC-LAST-QTY-REC-N  REDEFINES        05360035
053700                             ASC-LAST-QTY-REC        PIC 9(06).   05370035
053800                         30  ASC-LAST-DTE-REC        PIC X(06).   05380001
053900                         30  ASC-PRIOR-QTY-REC       PIC X(6).    05390017
054000                         30  ASC-PRIOR-QTY-REC-N REDEFINES        05400035
054100                             ASC-PRIOR-QTY-REC       PIC 9(06).   05410035
054200                         30  ASC-PRIOR-DTE-REC       PIC X(06).   05420001
054300                         30  ASC-MORE                PIC X(01).   05430001
054400                                                                  05440001
054500             15  ASC-BLK-SUB                         PIC S9(4)    05450001
054600                                                     COMP SYNC.   05460001
054700             15  ASC-ITEM-SUB                        PIC S9(4)    05470001
054800                                                     COMP SYNC.   05480001
054900             15  ASC-SEL-SUB                         PIC S9(4)    05490001
055000                                                     COMP.        05500001
055100             15  ASC-SEL-ITEM                        PIC S9(4)    05510001
055200                                                     COMP.        05520001
055300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    05530001
055400                                                     COMP-3.      05540001
055500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    05550001
055600                                                     COMP-3.      05560001
055700             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    05570001
055800                                                     COMP-3.      05580001
055900             15  ASC-ITEMS-DISPLAYED                 PIC S999     05590001
056000                                                     COMP-3.      05600001
056100             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    05610001
056200                                                     COMP-3.      05620001
056300             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    05630001
056400                                                     COMP-3.      05640001
056500             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    05650001
056600                                                     COMP SYNC.   05660001
056700             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    05670001
056800                                                     COMP-3.      05680001
056900             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    05690001
057000                                                     COMP-3.      05700001
057100             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       05710001
057200                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05720001
057300                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05730001
057400             15  ASC-UPDATE-SW                       PIC X.       05740001
057500                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   05750001
057600                 88  ASC-CANT-UPDATE                 VALUE 'N'.   05760001
057700             15  ASC-LIST-QUEUE-NAME.                             05770001
057800                 20  ASC-LIST-TERM-ID                PIC X(4).    05780001
057900                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    05790001
058000                                                     COMP-3.      05800001
058100                 20  ASC-LIST-SEQ                    PIC 9.       05810001
058200             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    05820001
058300             15  ASC-SEL-QUEUE-NAME-OUT.                          05830001
058400                 20  ASC-SEL-TERM-ID                 PIC X(4).    05840001
058500                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    05850001
058600                                                     COMP-3.      05860001
058700                 20  ASC-SEL-SEQ                     PIC 9.       05870001
058800             15  ASC-START-ITEM-REQUEST.                          05880001
058900                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    05890001
059000             15  ASC-RECDIS-SW                       PIC X.       05900001
059100                 88  ASC-MORE-RECDIS                 VALUE 'Y'.   05910001
059200                 88  ASC-NO-MORE-RECDIS              VALUE 'N'.   05920001
059300             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    05930001
059400                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   05940001
059500*                                                                 05950010
059600             15  ASC-VEND-STYL-NAME                  PIC X(20).   05960001
059700             15  ASC-PURCHS-STATUS-CDE               PIC X(02).   05970001
059800             15  ASC-PURITM-STATUS-CDE               PIC X(02).   05980001
059900             15  ASC-PURITM-UNT-QTY                  PIC S9(9)    05990001
060000                                                         COMP.    06000001
060100             15  ASC-PO-PREPK-ID                     PIC S9(4)    06010010
060200                                                         COMP.    06020010
060300             15  ASC-PO-PREPK-RATO-QTY               PIC S9(4)    06030013
060400                                                         COMP.    06040010
060500             15  ASC-NOTIF-NBR                       PIC S9(9)    06050083
060600                                                         COMP-3.  06060083
060700             15  ASC-HOLD-INTER-APPL                 PIC X(200).  06070001
060800             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   06080001
060900                 88  ASC-INTER-APPL-PK-LST           VALUE ' '.   06090010
061000                 88  ASC-INTER-APPL-PK-LST-DTL       VALUE ' '.   06100010
061100                 88  ASC-INTER-APPL-STR-ADD          VALUE '?'.   06110010
061200             15 ASC-TRBL-FOUND-SW                    PIC  X.      06120001
061300                 88 ASC-TRBL-EXISTS                  VALUE 'Y'.   06130079
061400                 88 ASC-NO-TRBL-EXISTS               VALUE 'N'.   06140079
061500             15  ASC-DISPLAY-DATA-SW                 PIC X.       06150079
061600                 88  ASC-DATA-BY-STORE               VALUE '1'.   06160079
061700                 88  ASC-DATA-BY-RANK                VALUE '2'.   06170079
061800             15  ASC-AUTO-VE-SW                      PIC X.       06180099
061900                 88  ASC-AUTO-VE-YES            VALUE 'Y'.        06190099
062000                 88  ASC-AUTO-VE-NO             VALUE 'N'.        06200099
062100                                                                  06210010
062200******************************************************************06220010
062300* I/O AREA FOR DPKCS277 - CALLED TO CALCULATE OTR (UNITS/PACKS)   06230010
062400******************************************************************06240010
062500     COPY DPWS277.                                                06250099
062600                                                                  06260010
062700******************************************************************06270001
062800*    ABEND PROCESSING                                             06280001
062900******************************************************************06290001
063000     COPY DPWS013.                                                06300099
063100                                                                  06310010
063200******************************************************************06320001
063300*    DB2 SQL COMMUNICATION AREA                                   06330001
063400******************************************************************06340001
063500     EXEC SQL                                                     06350001
063600          INCLUDE SQLCA                                           06360001
063700     END-EXEC.                                                    06370001
063800                                                                  06380010
063900******************************************************************06390001
064000*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          06400001
064100******************************************************************06410001
064200     EXEC SQL                                                     06420001
064300          INCLUDE TPURCHS                                         06430001
064400     END-EXEC.                                                    06440001
064500                                                                  06450024
064600******************************************************************06460001
064700*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     06470001
064800******************************************************************06480001
064900     EXEC SQL                                                     06490001
065000          INCLUDE TPURITM                                         06500001
065100     END-EXEC.                                                    06510001
065200                                                                  06520024
065300******************************************************************06530003
065400*    DB2 DCLGEN FOR PURCHASE ORDER PREPACK TABLE                  06540003
065500******************************************************************06550003
065600     EXEC SQL                                                     06560003
065700          INCLUDE TPOPRPK                                         06570003
065800     END-EXEC.                                                    06580003
065900                                                                  06590024
066000******************************************************************06600001
066100*    DB2 DCLGEN FOR RECEIVER TABLE                                06610001
066200******************************************************************06620001
066300     EXEC SQL                                                     06630001
066400          INCLUDE TRECEIV                                         06640001
066500     END-EXEC.                                                    06650001
066600                                                                  06660024
066700******************************************************************06670001
066800*    DB2 DCLGEN FOR RECEIVER ITEM TABLE                           06680001
066900******************************************************************06690001
067000     EXEC SQL                                                     06700001
067100          INCLUDE TRECITM                                         06710001
067200     END-EXEC.                                                    06720001
067300                                                                  06730024
067400******************************************************************06740001
067500*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   06750001
067600******************************************************************06760001
067700     EXEC SQL                                                     06770001
067800          INCLUDE TRECDIS                                         06780001
067900     END-EXEC.                                                    06790001
068000                                                                  06800024
068100******************************************************************06810001
068200*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  06820001
068300******************************************************************06830001
068400     EXEC SQL                                                     06840001
068500          INCLUDE TENTNME                                         06850001
068600     END-EXEC.                                                    06860001
068700                                                                  06870024
069500******************************************************************06950003
069600*    DB2 DCLGEN FOR TROUBLE NOTIFICATION TABLE                    06960003
069700******************************************************************06970003
069800     EXEC SQL                                                     06980001
069900          INCLUDE TTRBNTF                                         06990001
070000     END-EXEC.                                                    07000001
070100                                                                  07010024
070200******************************************************************07020003
070300*    DB2 DCLGEN FOR TROUBLE REASON TABLE                          07030003
070400******************************************************************07040003
070500     EXEC SQL                                                     07050001
070600          INCLUDE TTRBRSN                                         07060001
070700     END-EXEC.                                                    07070001
070800                                                                  07080024
070900******************************************************************07090003
071000*    DB2 DCLGEN FOR DISTRIBUTION HEADER TABLE                     07100003
071100******************************************************************07110003
071200     EXEC SQL                                                     07120001
071300          INCLUDE TDISTHD                                         07130001
071400     END-EXEC.                                                    07140001
071500                                                                  07150024
071600******************************************************************07160003
071700*    DB2 DCLGEN FOR MERCHANDISE STORE DISTRIBUTION TABLE          07170003
071800******************************************************************07180003
071900     EXEC SQL                                                     07190003
072000          INCLUDE TMESTDS                                         07200003
072100     END-EXEC.                                                    07210003
072200                                                                  07220024
072210* JAK 05/2007 - ADD TABLES FOR WMS CODE                           07221099
072220***************************************************************** 07222099
072230*    DB2 DCLGEN FOR PARM TABLE                                    07223099
072240***************************************************************** 07224099
072250     EXEC SQL                                                     07225099
072260          INCLUDE TKRPRPM                                         07226099
072270     END-EXEC.                                                    07227099
072280                                                                  07228099
072290******************************************************************07229099
072291*    DB2 DCLGEN FOR SHIPMENT TABLE                                07229199
072292******************************************************************07229299
072293     EXEC SQL                                                     07229399
072294          INCLUDE TSHIPMT                                         07229499
072295     END-EXEC.                                                    07229599
072296                                                                  07229699
072297******************************************************************07229799
072298*    DB2 DCLGEN FOR SHIPMENT PO TABLE                             07229899
072299******************************************************************07229999
072300     EXEC SQL                                                     07230099
072301          INCLUDE TSHPTPO                                         07230199
072302     END-EXEC.                                                    07230299
072303                                                                  07230399
072304* JAK 05/2007 - END                                               07230499
072305                                                                  07230599
072310******************************************************************07231001
072400*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 07240001
072500*JPL**************************************************************07250079
072600*NOTE: ==> THIS IS SQL FOR RE-SEQUENCING DISPLAY BY 'RANK'.       07260079
072700     EXEC SQL                                                     07270001
072800          DECLARE RECDIS-RANK-CURSOR CURSOR FOR                   07280079
072900           SELECT A.EXPTED_ITM_QTY,                               07290074
073000                  A.VERIFY_ITM_QTY,                               07300074
073100                  A.AP_VERIFY_ITM_QTY,                            07310074
073200                  A.STR_NBR,                                      07320074
073300                  COALESCE(ALLOC_SEQ_CDE,' '),                    07330072
073400                  COALESCE(RNK_SEQ_NBR ,0)                        07340072
073500           FROM  TRECDIS A                                        07350073
073600           LEFT OUTER JOIN                                        07360072
073700           TMESTDS B                                              07370072
073800           ON   A.ORD_NBR     = B.PO_NBR                          07380073
073900           AND  A.ORD_LNE_NBR = B.PO_LNE_NBR                      07390073
074000           AND  A.STR_NBR     = B.STR_NBR                         07400072
074100           WHERE A.ORD_NBR        = :DK-REC-NBR                   07410073
074200             AND A.ORD_LNE_NBR    = :DK-DRV-LNE-NBR               07420073
074300             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07430073
074400             AND A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID          07440073
074500             AND A.FCLTY_ID       = :ASC-KEY-FCLTY-ID             07450073
074700           ORDER BY B.ALLOC_SEQ_CDE,                              07470073
074800                    B.RNK_SEQ_NBR,                                07480073
074900                    A.STR_NBR                                     07490073
075000     END-EXEC.                                                    07500072
075100                                                                  07510072
075200******************************************************************07520079
075300*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 07530079
075400******************************************************************07540079
075500     EXEC SQL                                                     07550079
075600          DECLARE RECDIS-CURSOR CURSOR FOR                        07560079
075700           SELECT EXPTED_ITM_QTY,                                 07570079
075800                  VERIFY_ITM_QTY,                                 07580079
075900                  AP_VERIFY_ITM_QTY,                              07590079
076000                  STR_NBR                                         07600079
076100             FROM TRECDIS                                         07610079
076200            WHERE ORD_NBR        = :DK-REC-NBR                    07620079
076300              AND ORD_LNE_NBR    = :DK-DRV-LNE-NBR                07630079
076400              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                07640079
076500              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           07650079
076600              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              07660079
076800         ORDER BY STR_NBR                                         07680079
076900     END-EXEC.                                                    07690079
077000                                                                  07700001
077100******************************************************************07710001
077200*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PRIOR RCVR DISTRO     07720001
077300******************************************************************07730001
077400     EXEC SQL                                                     07740001
077500          DECLARE PRIOR-RCVR-CURSOR CURSOR FOR                    07750001
077600           SELECT DATE(A.REC_TMST)                                07760001
077700                , A.STATUS_CDE                                    07770001
077800                , B.EXPTED_ITM_QTY                                07780001
077900                , B.VERIFY_ITM_QTY                                07790001
078000                , B.AP_VERIFY_ITM_QTY                             07800001
078100                , C.STATUS_CDE                                    07810001
078200                , C.PREPK_RATO_QTY                                07820017
078300                , A.REC_SEQ_NBR                                   07830099
078400                , A.PKGNG_CDE                                     07840099
078500             FROM TRECEIV A                                       07850001
078600                , TRECDIS B                                       07860001
078700                , TRECITM C                                       07870001
078800            WHERE A.ORD_NBR        = :DK-REC-NBR                  07880003
078900              AND A.ORD_NBR        = B.ORD_NBR                    07890001
079000              AND A.ORD_NBR        = C.ORD_NBR                    07900001
079100                                                                  07910001
079200              AND B.ORD_LNE_NBR    = :DK-DRV-LNE-NBR              07920004
079300              AND B.ORD_LNE_NBR    = C.ORD_LNE_NBR                07930001
079400                                                                  07940001
079500              AND A.REC_SEQ_NBR   ^= :DK-REC-SEQ-NBR              07950001
079600              AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR                07960001
079700              AND A.REC_SEQ_NBR    = C.REC_SEQ_NBR                07970001
079800                                                                  07980001
079900              AND A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID         07990001
080000              AND A.OPER_UNT_ID    = B.OPER_UNT_ID                08000001
080100                                                                  08010001
080200              AND A.FCLTY_ID       = :ASC-KEY-FCLTY-ID            08020001
080300              AND A.FCLTY_ID       = B.FCLTY_ID                   08030001
080400                                                                  08040001
080500              AND B.STR_NBR        = :DK-STR-NBR                  08050001
080600                                                                  08060001
080700              AND A.VER_STATUS_CDE = :PC-ACTIVE                   08070001
080900              AND C.VER_STATUS_CDE = :PC-ACTIVE                   08090001
081000                                                                  08100001
081100         ORDER BY A.STATUS_CDE, 1 DESC                            08110001
081200     END-EXEC.                                                    08120001
081300                                                                  08130010
081400******************************************************************08140034
081500*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF SELECTED STORE DATA   08150034
081600******************************************************************08160034
081700     EXEC SQL                                                     08170034
081800          DECLARE SELECT-RECITM-CSR CURSOR FOR                    08180034
081900           SELECT ORD_LNE_NBR                                     08190034
082000                , PREPK_RATO_QTY                                  08200034
082100             FROM TRECITM                                         08210034
082200            WHERE ORD_NBR        = :DK-REC-NBR                    08220034
082300              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                08230034
082400              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           08240034
082500              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              08250034
082600              AND PREPK_ID       = :ASC-KEY-PACK-ID               08260036
082700              AND VER_STATUS_CDE = :PC-ACTIVE                     08270034
082800              AND PREPK_RATO_QTY > :PC-ZERO                       08280099
082900                                                                  08290034
083000     END-EXEC.                                                    08300034
083100                                                                  08310034
083200******************************************************************08320034
083300 LINKAGE SECTION.                                                 08330001
083400                                                                  08340001
083500 01  DFHCOMMAREA.                                                 08350001
083600     05  FILLER                       OCCURS 1 TO 4072 TIMES      08360001
083700                                      DEPENDING ON EIBCALEN.      08370001
083800         10  FILLER                   PIC X.                      08380001
083900                                                                  08390001
084000                                                                  08400001
084100******************************************************************08410003
084200******************************************************************08420003
084300 PROCEDURE DIVISION.                                              08430001
084400                                                                  08440001
084500 0000-MAIN-MODULE.                                                08450001
084600                                                                  08460001
084700*STD ARCHITECTURE                                                 08470003
084800     INITIALIZE DP030-CICS-API-FIELDS.                            08480001
084900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08490003
085000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08500003
085100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08510003
085200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08520003
085300     MOVE LENGTH OF RC805AI        TO DP030-MAP-LENGTH (1).       08530003
085400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08540003
085500     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       08550003
085600     PERFORM 0001-CALL-CICS-ARCH-API.                             08560001
085700                                                                  08570001
085800*PROGRAM LOGIC                                                    08580003
085900     PERFORM 1000-CONTROL-PROCESSING.                             08590001
086000                                                                  08600001
086100*STD ARCHITECTURE                                                 08610003
086200     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          08620003
086300     PERFORM 0001-CALL-CICS-ARCH-API.                             08630001
086400                                                                  08640001
086500******************************************************************08650003
086600*         S T A N D A R D   A R C H I T E C T U R E               08660003
086700******************************************************************08670003
086800 0001-CALL-CICS-ARCH-API.                                         08680001
086900                                                                  08690001
087010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08701099
087100                                    DFHCOMMAREA                   08710099
087200                                    DP030-CICS-API-FIELDS         08720099
087300                                    DP020-STANDARD-COMMAREA       08730099
087400                                    RC805AI.                      08740099
087500                                                                  08750001
087600     IF DP030-RC-CALL-SUCCESSFUL OR                               08760001
087700        DP030-RC-APPL-ERROR                                       08770001
087800         CONTINUE                                                 08780001
087900     ELSE                                                         08790001
088000         SET DP013-CICS-ABEND                                     08800001
088100             DP013-NO-ROLLBACK                                    08810001
088200             DP013-XCTL-DISPLAY-RESTART                           08820001
088300                                 TO TRUE                          08830001
088400         MOVE '0001-CALL-CICS-ARCH-API'                           08840001
088500                                 TO DP013-PARAGRAPH               08850001
088520         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O08852099
088530-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08853099
088800         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        08880001
088900                                                                  08890001
089000         PERFORM DP013-0000-PROCESS-ABEND.                        08900001
089100                                                                  08910001
089200******************************************************************08920003
089300 1000-CONTROL-PROCESSING.                                         08930001
089400                                                                  08940001
089500     EVALUATE TRUE                                                08950001
089600       WHEN DP030-RC-APPL-ERROR                                   08960003
089700           MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           08970003
089800           MOVE ZEROES TO ASC-ITEM-AT-TOP-OF-PANEL                08980003
089900           PERFORM 6000-REFRESH-PANEL-FROM-TEMP                   08990003
090000           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     09000003
090100           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   09010003
090200                                                                  09020001
090300       WHEN DP020-NEXT-ACT-INITIAL                                09030003
090400           INITIALIZE ASC-SPECIFIC-COMMAREA                       09040003
090500           MOVE EIBTRMID TO ASC-LIST-TERM-ID                      09050003
090600                            ASC-SEL-TERM-ID                       09060003
090700           MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER     09070003
090800                                         ASC-SEL-TASK-NUMBER      09080003
090900           MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ                 09090003
091000           MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                  09100003
091100           SET PS-NO-ERROR TO TRUE                                09110003
091200*JPL                                                              09120079
091300           MOVE '1' TO ASC-DISPLAY-DATA-SW                        09130079
091400           PERFORM 1100-PROCESS-INTER-APPL-COMM                   09140003
091500           IF PS-NO-ERROR                                         09150003
091600               MOVE INTER-APPL-COMM-AREA TO ASC-HOLD-INTER-APPL   09160003
091700               PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT    09170003
091800               PERFORM 3200-RESET-ATTRIBUTES                      09180003
091900           END-IF                                                 09190003
092000                                                                  09200001
092100       WHEN DP020-NEXT-ACT-READ-MAP                               09210003
092200           MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           09220003
092300           PERFORM 2000-PROCESS-PANEL                             09230003
092400                                                                  09240001
092500       WHEN DP020-NEXT-ACT-RETURN                                 09250003
092600           MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           09260003
092700           MOVE ZEROES TO ASC-ITEM-AT-TOP-OF-PANEL                09270003
092800           MOVE ASC-HOLD-INTER-APPL TO INTER-APPL-COMM-AREA       09280003
092900* THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED                 09290003
093000* INFORMATION BE DISPLAYED UPON RETURN TO THIS                    09300003
093100* PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.                  09310003
093200           PERFORM 2050-DELETE-LIST-QUEUE                         09320003
093300           PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT        09330003
093400           PERFORM 3200-RESET-ATTRIBUTES                          09340003
093500                                                                  09350001
093600       WHEN OTHER                                                 09360003
093700           SET DP013-LOGIC-ABEND                                  09370003
093800               DP013-NO-ROLLBACK TO TRUE                          09380003
093900           MOVE '1000-CONTROL-PROCESSING'                         09390003
094000                                 TO DP013-PARAGRAPH               09400001
094100           MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'      09410003
094200                                 TO DP013-MESSAGE-TEXT(1)         09420001
094300           PERFORM DP013-0000-PROCESS-ABEND                       09430003
094400     END-EVALUATE.                                                09440001
094500                                                                  09450001
094600******************************************************************09460003
094700 1100-PROCESS-INTER-APPL-COMM.                                    09470001
094800                                                                  09480001
094900     MOVE SPACES TO ASC-START-ITEM-REQUEST.                       09490003
095000     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   09500003
095100                                                                  09510001
095200*EVALUATE NOT NEEDED (ONLY ONE FORMAT PASSED).                    09520076
095300*    EVALUATE DP020-INT-APPL-FORMAT-IND                           09530038
095400*      WHEN PC-INTER-APPL-STR-ADD                                 09540038
095500*          IF RC800-SEL-QUEUE-NAME = 'RETURN  '                   09550038
095600*              SET DP020-NEXT-ACT-APPL-ERROR TO TRUE              09560038
095700*          ELSE                                                   09570038
095800*              MOVE RC800-REC-NBR-N      TO ASC-KEY-REC-NBR-N     09580038
095900*              MOVE RC800-REC-SEQ-NBR-N  TO ASC-KEY-REC-SEQ-NBR-N 09590038
096000*              MOVE RC800-OPER-UNIT-ID   TO ASC-KEY-OPER-UNT-ID   09600038
096100*              MOVE RC800-FACILITY-ID    TO ASC-KEY-FCLTY-ID      09610038
096200*              MOVE RC801-REC-LNE-NBR(1) TO ASC-KEY-DRV-LNE-NBR   09620038
096300*              MOVE RC801-PACK-ID(1)     TO ASC-KEY-PACK-ID       09630038
096400*          END-IF                                                 09640038
096500*                                                                 09650016
096600*      WHEN OTHER                                                 09660038
096700           IF RC800-NUMBER-OF-SELECTED-ITEMS = ZERO               09670003
096800               SET ASC-NO-TSQ-UPDATE TO TRUE                      09680003
096900               SET DP020-MSG-FATAL                                09690003
097000                   DP020-NEXT-ACT-APPL-ERROR                      09700003
097100                   PS-ERROR          TO TRUE                      09710003
097200               MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER          09720003
097300           ELSE                                                   09730003
097400               MOVE RC800-REC-NBR-N      TO ASC-KEY-REC-NBR-N     09740022
097500                                            DK-REC-NBR            09750022
097600               MOVE RC800-REC-SEQ-NBR-N  TO ASC-KEY-REC-SEQ-NBR-N 09760022
097700                                            DK-REC-SEQ-NBR        09770022
097800               MOVE RC800-OPER-UNIT-ID   TO ASC-KEY-OPER-UNT-ID   09780022
097900               MOVE RC800-FACILITY-ID    TO ASC-KEY-FCLTY-ID      09790022
098000                                                                  09800001
098100               SET ASC-USE-SELECTION-QUEUE TO TRUE                09810003
098200                                                                  09820001
098300               MOVE RC800-NUMBER-OF-SELECTED-ITEMS                09830003
098400                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 09840003
098500               MOVE RC800-NUMBER-OF-TS-ITEMS                      09850003
098600                                  TO ASC-NUMBER-OF-TS-ITEMS       09860003
098700               MOVE RC800-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN 09870003
098800               MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB           09880010
098900               MOVE ZEROES               TO ASC-SEL-ITEM          09890003
099000               PERFORM 2300-GET-NEXT-RECORD                       09900003
099100           END-IF.                                                09910038
099200***  END-EVALUATE.                                                09920038
099300                                                                  09930003
099400******************************************************************09940003
099500 2000-PROCESS-PANEL.                                              09950001
099600                                                                  09960001
099700     SET PS-NEXT-SCREEN TO TRUE.                                  09970001
099800                                                                  09980003
099900     EVALUATE TRUE                                                09990001
100000       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                10000079
100100*JPL                                                              10010079
100200           IF ASC-DISPLAY-DATA-SW = '1'                           10020079
100300               MOVE '2' TO ASC-DISPLAY-DATA-SW                    10030079
100400           ELSE                                                   10040079
100500               MOVE '1' TO ASC-DISPLAY-DATA-SW                    10050079
100600           END-IF                                                 10060079
100700           PERFORM 2050-DELETE-LIST-QUEUE                         10070079
100800           PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT        10080079
100900           PERFORM 3200-RESET-ATTRIBUTES                          10090079
101000                                                                  10100079
101100       WHEN DP020-SRC-AID = DP016-CLEAR                           10110003
101200           MOVE ZEROES TO ASC-ITEM-AT-TOP-OF-PANEL                10120003
101300           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     10130003
101400           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   10140003
101500                                                                  10150001
101600       WHEN DP020-FK-REFRESH (DP020-SRC-AID)                      10160003
101700           PERFORM 2050-DELETE-LIST-QUEUE                         10170003
101800           PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT        10180003
101900           PERFORM 3200-RESET-ATTRIBUTES                          10190003
102000                                                                  10200001
102100       WHEN DP020-FK-DESELECT (DP020-SRC-AID)                     10210003
102200           PERFORM 2140-DESELECT-ALL-ITEMS                        10220003
102300           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   10230003
102400                                                                  10240001
102500       WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                   10250003
102600           PERFORM 2150-SELECT-ALL-ITEMS                          10260003
102700           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   10270003
102800                                                                  10280001
102900       WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)               10290003
103000           IF ASC-USE-SELECTION-QUEUE                             10300003
103100               PERFORM 6200-DEL-LIST-QUEUE                        10310003
103200               PERFORM 2300-GET-NEXT-RECORD                       10320013
103300               PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT    10330003
103400               PERFORM 3200-RESET-ATTRIBUTES                      10340003
103500           ELSE                                                   10350003
103600*--- BOTTOM OF LIST ---                                           10360003
103700               MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER           10370003
103800               SET DP020-MSG-INFORMATIONAL TO TRUE                10380003
103900           END-IF                                                 10390003
104000                                                                  10400001
104100       WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)               10410003
104200           IF ASC-USE-SELECTION-QUEUE                             10420003
104300               PERFORM 6200-DEL-LIST-QUEUE                        10430003
104400               PERFORM 2310-GET-PREV-RECORD                       10440013
104500               PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT    10450003
104600               PERFORM 3200-RESET-ATTRIBUTES                      10460003
104700           ELSE                                                   10470003
104800*--- TOP OF LIST ---                                              10480003
104900               MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER           10490003
105000               SET DP020-MSG-INFORMATIONAL TO TRUE                10500003
105100           END-IF                                                 10510003
105200                                                                  10520001
105300       WHEN OTHER                                                 10530003
105400           PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                   10540003
105500           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     10550003
105600           IF PS-NO-ERROR                                         10560003
105700               SET DP030-CONTINUE-GO TO TRUE                      10570003
105800               PERFORM 2100-CHECK-FUNCTION-KEY                    10580003
105900           ELSE                                                   10590003
106000               SET DP030-OVERRIDE-GO TO TRUE                      10600003
106100           END-IF                                                 10610003
106200                                                                  10620001
106300     END-EVALUATE.                                                10630001
106400                                                                  10640001
106500******************************************************************10650003
106600 2050-DELETE-LIST-QUEUE.                                          10660001
106700                                                                  10670001
106800     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             10680001
106900                          RESP  (PV-CICS-RESP)                    10690001
107000                          END-EXEC.                               10700001
107100                                                                  10710001
107200     IF (PV-CICS-RESP = DFHRESP (NORMAL))                         10720008
107300       OR (PV-CICS-RESP = DFHRESP (QIDERR))                       10730008
107400         CONTINUE                                                 10740001
107500     ELSE                                                         10750001
107600         SET DP013-CICS-ABEND                                     10760001
107700             DP013-NO-ROLLBACK TO TRUE                            10770008
107800         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         10780008
107900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 10790001
108000              TO DP013-MESSAGE-TEXT (1)                           10800008
108100         PERFORM DP013-0000-PROCESS-ABEND                         10810001
108200     END-IF.                                                      10820001
108300                                                                  10830001
108400     MOVE ZEROES TO ASC-HIGHEST-BLOCK-WRITTEN.                    10840008
108500                                                                  10850001
108600******************************************************************10860003
108700 2100-CHECK-FUNCTION-KEY.                                         10870001
108800                                                                  10880001
108900     SET PS-NEXT-SCREEN TO TRUE.                                  10890043
109000                                                                  10900043
109100     EVALUATE TRUE                                                10910001
109200*PF17 - GO TO RESPRESL (TMARESP  - TMKCS505).                     10920082
109300       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                10930038
109400           IF ASC-NOTIF-NBR NOT > 0                               10940087
109500               MOVE PC-TSYMSG-02382 TO DP020-MSG-NUMBER           10950094
109600               SET PS-ERROR                                       10960087
109700                   DP030-OVERRIDE-GO                              10970087
109800                   DP020-MSG-FATAL        TO TRUE                 10980091
109900           ELSE                                                   10990087
110000              PERFORM 5000-PREPARE-SEL-QUEUE                      11000087
110100              IF RC800-NUMBER-OF-SELECTED-ITEMS = 0               11010089
110200                  MOVE PC-TSYMSG-00057    TO DP020-MSG-NUMBER     11020091
110300                  SET PS-ERROR                                    11030089
110400                      DP030-OVERRIDE-GO                           11040089
110500                      DP020-MSG-FATAL     TO TRUE                 11050091
110600              ELSE                                                11060087
110700                 IF RC800-NUMBER-OF-SELECTED-ITEMS > 1            11070091
110800                    MOVE PC-TSYMSG-00047  TO DP020-MSG-NUMBER     11080091
110900                    SET PS-ERROR                                  11090091
111000                        DP030-OVERRIDE-GO                         11100091
111100                        DP020-MSG-FATAL   TO TRUE                 11110091
111200                 END-IF                                           11120091
111300              END-IF                                              11130087
111400           END-IF                                                 11140083
111500                                                                  11150027
111600*PF22 - GO TO ADDSTORE (RCASTORE - RCKCS230).                     11160040
111700       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                11170026
111800           IF (ASC-CANT-UPDATE                                    11180003
111900             AND DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID))          11190026
112000               MOVE PC-TSYMSG-00734 TO DP020-MSG-NUMBER           11200003
112100               SET PS-ERROR                                       11210003
112200                   DP030-OVERRIDE-GO                              11220003
112300                   DP020-MSG-FATAL TO TRUE                        11230003
112400           ELSE                                                   11240003
112500               MOVE ASC-NUMBER-OF-SELECTED-ITEMS                  11250003
112600                    TO RC015-NUMBER-OF-SELECTED-ITEMS             11260049
112700               MOVE ASC-KEY-OPER-UNT-ID   TO RC015-OPER-UNT-ID    11270049
112800               MOVE ASC-KEY-FCLTY-ID      TO RC015-FCLTY-ID       11280049
112900               MOVE ASC-KEY-REC-NBR-N     TO RC015-PO-NBR         11290049
113000               MOVE ASC-KEY-REC-SEQ-NBR-N TO RC015-REC-SEQ-NBR    11300049
113100               MOVE ASC-KEY-DRV-LNE-NBR   TO RC015-PO-LNE-NBR     11310049
113200               MOVE ASC-KEY-PACK-ID       TO RC015-PO-PACK-ID     11320049
113300               PERFORM 5000-PREPARE-SEL-QUEUE                     11330003
113400               IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO             11340003
113500                   SET ASC-NO-TSQ-UPDATE TO TRUE                  11350003
113600               END-IF                                             11360003
113700           END-IF                                                 11370003
113800                                                                  11380001
113900*PF15 - UPDATE.                                                   11390040
114000       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                11400026
114100           PERFORM 3350-EDIT-DISTR-LNE-QTY                        11410017
114200           IF PS-NO-ERROR                                         11420003
114300               IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO             11430003
114400                   SET ASC-NO-TSQ-UPDATE TO TRUE                  11440003
114500                   SET DP030-OVERRIDE-GO                          11450003
114600                       DP020-MSG-WARNING TO TRUE                  11460003
114700                   MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER      11470003
114800               ELSE                                               11480003
114900                   IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO         11490003
115000                       INITIALIZE RC800-INTER-APPL-COMMAREA       11500003
115100                       MOVE ASC-NUMBER-OF-SELECTED-ITEMS          11510003
115200                                 TO RC800-NUMBER-OF-SELECTED-ITEMS11520003
115300                       MOVE ASC-KEY-REC-NBR-N                     11530004
115400                                 TO RC800-REC-NBR-N               11540003
115500                       PERFORM 5000-PREPARE-SEL-QUEUE             11550003
115600                       SET ASC-NO-TSQ-UPDATE TO TRUE              11560003
115610*JAK 05/2007 - ADD CODE FOR WMOS INTERFACE                        11561099
115630                       PERFORM 5610-SELECT-TRECEIV                11563099
115640                       PERFORM 5600-CHECK-ASNDWN                  11564099
115650                       IF PS-ASNS-TO-WMS-YES                      11565099
115660                         AND PS-NO-ERROR                          11566099
115670                           PERFORM 5620-CHECK-TRECDIS             11567099
115680                           IF PS-DISTRO-TRBL-NO                   11568099
115690                              PERFORM 5630-GET-TRIP-ID            11569099
115691                              IF PS-NO-ERROR                      11569199
115692                                  PERFORM 5640-CALL-WMS-MODULE    11569299
115693                                  IF WS001-SUCCESSFUL             11569399
115694                                     MOVE PC-TSYMSG-03570         11569499
115695                                          TO DP020-MSG-NUMBER     11569599
115696                                     SET DP020-MSG-INFORMATIONAL  11569699
115697                                          TO TRUE                 11569799
115698                                  END-IF                          11569899
115699                              END-IF                              11569999
115700                           END-IF                                 11570099
115701                       END-IF                                     11570199
115702*JAK 05/2007 - END                                                11570299
115703                                                                  11570399
115710                   END-IF                                         11571003
115800               END-IF                                             11580003
115900           END-IF                                                 11590003
116000                                                                  11600001
116100       WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                   11610003
116200           MOVE +1             TO PV-TOP-ITEM                     11620003
116300           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   11630003
116400           PERFORM 3200-RESET-ATTRIBUTES                          11640003
116500                                                                  11650001
116600       WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                    11660003
116700           PERFORM 2110-BROWSE-BACKWARD                           11670003
116800           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   11680003
116900           PERFORM 3200-RESET-ATTRIBUTES                          11690003
117000                                                                  11700001
117100       WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                    11710003
117200           PERFORM 2120-BROWSE-FORWARD                            11720003
117300           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   11730003
117400           PERFORM 3200-RESET-ATTRIBUTES                          11740003
117500                                                                  11750001
117600       WHEN DP020-SRC-AID = DP016-ENTER                           11760003
117700           PERFORM 2180-CHECK-FOR-JUMP-BROWSE                     11770003
117800           IF PS-NO-ERROR                                         11780003
117900               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11790003
118000           END-IF                                                 11800003
118100                                                                  11810001
118200       WHEN OTHER                                                 11820003
118300           SET DP013-CICS-ABEND                                   11830003
118400               DP013-NO-ROLLBACK                                  11840003
118500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 11850003
118600           MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH      11860025
118700           MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'        11870003
118800               TO DP013-MESSAGE-TEXT (1)                          11880025
118900           PERFORM DP013-0000-PROCESS-ABEND                       11890003
119000     END-EVALUATE.                                                11900001
119100                                                                  11910001
119200******************************************************************11920003
119300 2110-BROWSE-BACKWARD.                                            11930001
119400                                                                  11940001
119500     SUBTRACT PC-ITEMS-PER-PANEL                                  11950003
119600         FROM ASC-ITEM-AT-TOP-OF-PANEL                            11960003
119700         GIVING PV-TOP-ITEM.                                      11970001
119800                                                                  11980001
119900     IF PV-TOP-ITEM NOT > +1                                      11990001
120000         MOVE +1                     TO PV-TOP-ITEM               12000003
120100         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          12010003
120200         SET DP020-MSG-INFORMATIONAL TO TRUE.                     12020003
120300                                                                  12030001
120400******************************************************************12040003
120500 2120-BROWSE-FORWARD.                                             12050001
120600                                                                  12060001
120700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12070001
120800         GIVING PV-TOP-ITEM.                                      12080001
120900                                                                  12090001
121000     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    12100001
121100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12110001
121200                                 TO PV-TOP-ITEM                   12120001
121300         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              12130001
121400         SET DP020-MSG-INFORMATIONAL                              12140001
121500                                 TO TRUE                          12150001
121600     ELSE                                                         12160001
121700         COMPUTE PV-BOTTOM-ITEM =                                 12170001
121800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12180001
121900         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             12190001
122000             MOVE PC-TSYMSG-00070                                 12200001
122100                                 TO DP020-MSG-NUMBER              12210001
122200             SET DP020-MSG-INFORMATIONAL                          12220001
122300                                 TO TRUE.                         12230001
122400                                                                  12240001
122500******************************************************************12250003
122600 2140-DESELECT-ALL-ITEMS.                                         12260001
122700                                                                  12270001
122800     MOVE +1                     TO ASC-BLK-SUB.                  12280001
122900                                                                  12290001
123000     PERFORM 2141-CLEAR-SELECTED-INDS                             12300001
123100             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    12310001
123200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12320001
123300                                                                  12330001
123400     ADD +1                      TO ASC-BLK-SUB.                  12340001
123500                                                                  12350001
123600     PERFORM 2141-CLEAR-SELECTED-INDS                             12360001
123700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    12370001
123800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12380001
123900                                                                  12390001
124000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              12400001
124100                                 TO PV-LIST-ITEM-NUMBER.          12410001
124200                                                                  12420001
124300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12430001
124400             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).12440001
124500                                                                  12450001
124600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12460001
124700              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)12470001
124800         MOVE +1                 TO ASC-BLK-SUB                   12480001
124900                                                                  12490001
125000         PERFORM 5100-WRITE-TEMP-STORAGE                          12500001
125100                                                                  12510001
125200         MOVE +1                 TO PV-BLOCK-NUMBER               12520001
125300                                                                  12530001
125400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12540001
125500                                       PV-FIRST-BLOCK-IN-ARRAY - 112550001
125600                                                                  12560001
125700         PERFORM                                                  12570001
125800           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         12580001
125900                                                                  12590001
126000                 PERFORM 4410-READ-TEMP-STORAGE                   12600001
126100                                                                  12610001
126200                 PERFORM 2141-CLEAR-SELECTED-INDS                 12620001
126300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12630001
126400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12640001
126500                                                                  12650001
126600                 PERFORM 5100-WRITE-TEMP-STORAGE                  12660001
126700                                                                  12670001
126800                 ADD +1          TO PV-BLOCK-NUMBER               12680001
126900                                                                  12690001
127000         END-PERFORM                                              12700001
127100                                                                  12710001
127200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12720001
127300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY12730001
127400                                                                  12740001
127500         PERFORM                                                  12750001
127600           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         12760001
127700                                         ASC-HIGHEST-BLOCK-WRITTEN12770001
127800                                                                  12780001
127900                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      12790001
128000                                 TO PV-BLOCK-NUMBER               12800001
128100                                                                  12810001
128200                 PERFORM 4410-READ-TEMP-STORAGE                   12820001
128300                                                                  12830001
128400                 PERFORM 2141-CLEAR-SELECTED-INDS                 12840001
128500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12850001
128600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12860001
128700                                                                  12870001
128800                 PERFORM 5100-WRITE-TEMP-STORAGE                  12880001
128900                                                                  12890001
129000                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        12900001
129100                                                                  12910001
129200         END-PERFORM                                              12920001
129300                                                                  12930001
129400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12940001
129500                                 TO PV-BLOCK-NUMBER               12950001
129600                                                                  12960001
129700         PERFORM 4410-READ-TEMP-STORAGE                           12970001
129800                                                                  12980001
129900     END-IF.                                                      12990001
130000                                                                  13000001
130100     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  13010001
130200                                    ASC-START-OF-SELECTED-RANGE   13020001
130300                                    ASC-END-OF-SELECTED-RANGE.    13030001
130400                                                                  13040001
130500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13050001
130600                                                                  13060001
130700******************************************************************13070003
130800 2141-CLEAR-SELECTED-INDS.                                        13080001
130900                                                                  13090001
131000     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO13100001
131100        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           13110001
131200            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          13120001
131300                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     13130001
131400                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  13140001
131500                                 TO TRUE.                         13150001
131600                                                                  13160001
131700******************************************************************13170003
131800 2150-SELECT-ALL-ITEMS.                                           13180001
131900                                                                  13190001
132000     MOVE +1                     TO ASC-BLK-SUB.                  13200001
132100                                                                  13210001
132200     PERFORM 2151-SET-SELECTED-INDS                               13220001
132300             VARYING ASC-ITEM-SUB FROM 1 BY 1                     13230001
132400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13240001
132500                                                                  13250001
132600     ADD +1                      TO ASC-BLK-SUB.                  13260001
132700                                                                  13270001
132800     PERFORM 2151-SET-SELECTED-INDS                               13280001
132900             VARYING ASC-ITEM-SUB FROM 1 BY 1                     13290001
133000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13300001
133100                                                                  13310001
133200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              13320001
133300                                 TO PV-LIST-ITEM-NUMBER.          13330001
133400                                                                  13340001
133500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13350001
133600             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).13360001
133700                                                                  13370001
133800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13380001
133900              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13390001
134000         MOVE +1                 TO ASC-BLK-SUB                   13400001
134100                                                                  13410001
134200         PERFORM 5100-WRITE-TEMP-STORAGE                          13420001
134300                                                                  13430001
134400         MOVE +1                 TO PV-BLOCK-NUMBER               13440001
134500                                                                  13450001
134600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13460001
134700                                       PV-FIRST-BLOCK-IN-ARRAY - 113470001
134800                                                                  13480001
134900         PERFORM                                                  13490001
135000           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         13500001
135100                                                                  13510001
135200                 PERFORM 4410-READ-TEMP-STORAGE                   13520001
135300                                                                  13530001
135400                 PERFORM 2151-SET-SELECTED-INDS                   13540001
135500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13550001
135600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13560001
135700                                                                  13570001
135800                 PERFORM 5100-WRITE-TEMP-STORAGE                  13580001
135900                                                                  13590001
136000                 ADD +1          TO PV-BLOCK-NUMBER               13600001
136100                                                                  13610001
136200         END-PERFORM                                              13620001
136300                                                                  13630001
136400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13640001
136500                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY13650001
136600                                                                  13660001
136700         PERFORM                                                  13670001
136800           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         13680001
136900                                         ASC-HIGHEST-BLOCK-WRITTEN13690001
137000                                                                  13700001
137100                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      13710001
137200                                 TO PV-BLOCK-NUMBER               13720001
137300                                                                  13730001
137400                 PERFORM 4410-READ-TEMP-STORAGE                   13740001
137500                                                                  13750001
137600                 PERFORM 2151-SET-SELECTED-INDS                   13760001
137700                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13770001
137800                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13780001
137900                                                                  13790001
138000                 PERFORM 5100-WRITE-TEMP-STORAGE                  13800001
138100                                                                  13810001
138200                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        13820001
138300                                                                  13830001
138400         END-PERFORM                                              13840001
138500                                                                  13850001
138600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13860001
138700                                 TO PV-BLOCK-NUMBER               13870001
138800                                                                  13880001
138900         PERFORM 4410-READ-TEMP-STORAGE                           13890001
139000     END-IF.                                                      13900001
139100                                                                  13910001
139200     MOVE ASC-NUMBER-OF-ITEMS-READ                                13920001
139300                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 13930001
139400                                                                  13940001
139500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13950001
139600                                                                  13960001
139700******************************************************************13970003
139800 2151-SET-SELECTED-INDS.                                          13980001
139900                                                                  13990001
140000     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO14000001
140100        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              14010001
140200            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             14020001
140300                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14030001
140400                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  14040001
140500                                 TO TRUE                          14050001
140600        END-IF                                                    14060001
140700     END-IF.                                                      14070001
140800                                                                  14080001
140900******************************************************************14090003
141000 2180-CHECK-FOR-JUMP-BROWSE.                                      14100025
141100                                                                  14110025
141200     SET PS-NO-ERROR TO TRUE.                                     14120025
141300                                                                  14130025
141400     IF ASC-START-ITEM-REQUEST = SPACE                            14140025
141500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             14150025
141600     ELSE                                                         14160025
141700         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     14170025
141800         MOVE +5   TO DP010I-MAXIMUM-DIGITS                       14180025
141900         MOVE ZERO TO DP010I-MAXIMUM-DECIMALS                     14190025
142000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14200025
142100                                                                  14210025
142210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14221099
142220              USING DP010I-NUMERIC-EDIT-AREA                      14222099
142300                                                                  14230025
142400         IF NOT DP010I-ERROR-DETECTED                             14240025
142500             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N14250025
142600             IF ASC-START-ITEM-REQUEST-N > ZERO                   14260025
142700                 IF ASC-START-ITEM-REQUEST-N >                    14270025
142800                                          ASC-NUMBER-OF-ITEMS-READ14280025
142900                    MOVE SPACE TO ASC-START-ITEM-REQUEST          14290025
143000                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ14300025
143100                                        - PC-ITEMS-PER-PANEL + 1  14310025
143200                    IF PV-TOP-ITEM < +1                           14320025
143300                        MOVE +1  TO PV-TOP-ITEM                   14330025
143400                        MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER  14340025
143500                        SET DP020-MSG-INFORMATIONAL TO TRUE       14350025
143600                    END-IF                                        14360025
143700                ELSE                                              14370025
143800                    MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM  14380025
143900                    MOVE SPACE TO ASC-START-ITEM-REQUEST          14390025
144000                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        14400025
144100                                            PC-ITEMS-PER-PANEL - 114410025
144200                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  14420025
144300                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 14430025
144400                         SET DP020-MSG-INFORMATIONAL TO TRUE      14440025
144500                    END-IF                                        14450025
144600                END-IF                                            14460025
144700             ELSE                                                 14470025
144800                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         14480025
144900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14490025
145000                 MOVE -1              TO ASTRTITL                 14500025
145100                 MOVE DP015-UNP-NUM-BRT-MDT                       14510025
145200                                      TO ASTRTITA                 14520025
145300                 MOVE DP015-RED       TO ASTRTITC                 14530025
145400                 MOVE DP015-REVERSE   TO ASTRTITH                 14540025
145500                 SET PS-ERROR                                     14550025
145600                     DP020-MSG-FATAL  TO TRUE                     14560025
145700             END-IF                                               14570025
145800         ELSE                                                     14580025
145900             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             14590025
146000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14600025
146100             MOVE -1              TO ASTRTITL                     14610025
146200             MOVE DP015-UNP-NUM-BRT-MDT                           14620025
146300                                  TO ASTRTITA                     14630025
146400             MOVE DP015-RED       TO ASTRTITC                     14640025
146500             MOVE DP015-REVERSE   TO ASTRTITH                     14650025
146600             SET PS-ERROR                                         14660025
146700                 DP020-MSG-FATAL  TO TRUE                         14670025
146800         END-IF                                                   14680025
146900     END-IF.                                                      14690025
147000                                                                  14700025
147100******************************************************************14710025
147200 2200-MOVE-SCREEN-TO-COMMAREA.                                    14720001
147300                                                                  14730001
147400     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               14740001
147500     MOVE +1                     TO PV-SUB.                       14750001
147600                                                                  14760001
147700     PERFORM 3100-SET-SUBSCRIPTS.                                 14770001
147800                                                                  14780001
147900     IF ASTRTITL > ZERO                                           14790001
148000         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        14800001
148100     ELSE                                                         14810001
148200         IF ASTRTITF = DP015-ERASE-EOF                            14820001
148300             INITIALIZE ASC-START-ITEM-REQUEST                    14830001
148400         END-IF                                                   14840001
148500     END-IF.                                                      14850001
148600                                                                  14860001
148700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14870001
148800             VARYING PV-SUB  FROM 1 BY 1                          14880001
148900             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                14890001
149000                                                                  14900001
149100******************************************************************14910010
149200 2210-MOVE-LINES-TO-COMMAREA.                                     14920001
149300                                                                  14930001
149400*SELECT.                                                          14940010
149500     IF MR-SELECTL (PV-SUB) > ZERO                                14950001
149600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14960003
149700         MOVE MR-SELECTI (PV-SUB) TO ASC-TEMP-SELECTED-SW         14970003
149800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    14980003
149900     ELSE                                                         14990001
150000         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 15000001
150100             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         15010003
150200             MOVE SPACES TO ASC-TEMP-SELECTED-SW                  15020003
150300                           (ASC-BLK-SUB ASC-ITEM-SUB)             15030003
150400         END-IF                                                   15040001
150500     END-IF.                                                      15050001
150600                                                                  15060001
150700*STORE PACK QUANTITY.                                             15070010
150800     IF MR-STR-QTY-L (PV-SUB) > ZERO                              15080001
150900         MOVE MR-STR-QTY (PV-SUB) TO ASC-STR-QTY                  15090003
151000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    15100003
151100     ELSE                                                         15110001
151200         IF MR-STR-QTY-A (PV-SUB) = DP015-ERASE-EOF               15120001
151300             MOVE SPACES TO ASC-STR-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 15130003
151400         END-IF                                                   15140001
151500     END-IF.                                                      15150001
151600                                                                  15160001
151700     ADD +1 TO ASC-ITEM-SUB.                                      15170003
151800                                                                  15180001
151900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15190001
152000         ADD  +1 TO ASC-BLK-SUB                                   15200003
152100         MOVE +1 TO ASC-ITEM-SUB                                  15210003
152200     END-IF.                                                      15220001
152300                                                                  15230001
152400******************************************************************15240001
152500* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *15250001
152600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15260001
152700******************************************************************15270001
152800 2300-GET-NEXT-RECORD.                                            15280001
152900                                                                  15290001
153000     ADD  +1 TO ASC-SEL-SUB.                                      15300008
153100                                                                  15310001
153200     IF ASC-SEL-SUB > RC801-MAX-ITEMS                             15320010
153300         ADD  +1 TO ASC-SEL-ITEM                                  15330008
153400         MOVE +1 TO ASC-SEL-SUB                                   15340008
153500     END-IF.                                                      15350001
153600                                                                  15360001
153700     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 15370001
153800         PERFORM 9100-READ-SEL-QUEUE                              15380001
153900         IF RC801-ITEM (ASC-SEL-SUB) > ZERO                       15390010
154000             MOVE RC801-REC-LNE-NBR (ASC-SEL-SUB)                 15400010
154100                  TO ASC-KEY-DRV-LNE-NBR                          15410008
154200                     DK-DRV-LNE-NBR                               15420079
154300             MOVE RC801-PACK-ID (ASC-SEL-SUB)                     15430021
154400                  TO ASC-KEY-PACK-ID                              15440036
154500                     ASC-DSP-PACK-ID-N                            15450036
154600             MOVE RC801-PACK-DESC (ASC-SEL-SUB)                   15460021
154700                  TO ASC-KEY-PACK-DESC                            15470021
154800             MOVE RC801-TRBL-NOTIF-NBR (ASC-SEL-SUB)              15480083
154900                  TO ASC-NOTIF-NBR                                15490083
155000             SET RC801-INQ (ASC-SEL-SUB) TO TRUE                  15500010
155100             PERFORM 9200-REWRITE-LIST-QUEUE                      15510001
155200         ELSE                                                     15520001
155300             SUBTRACT +1 FROM ASC-SEL-SUB                         15530001
155400*--- BOTTOM OF LIST ---                                           15540008
155500             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             15550008
155600             SET DP020-MSG-INFORMATIONAL TO TRUE                  15560008
155700         END-IF                                                   15570001
155800     ELSE                                                         15580001
155900         SUBTRACT +1 FROM ASC-SEL-ITEM                            15590001
156000         MOVE RC801-MAX-ITEMS TO ASC-SEL-SUB                      15600010
156100         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER                 15610008
156200         SET DP020-MSG-INFORMATIONAL TO TRUE                      15620008
156300     END-IF.                                                      15630001
156400                                                                  15640001
156500******************************************************************15650001
156600* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *15660001
156700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15670001
156800******************************************************************15680001
156900 2310-GET-PREV-RECORD.                                            15690001
157000                                                                  15700001
157100     SUBTRACT +1 FROM ASC-SEL-SUB.                                15710001
157200                                                                  15720001
157300     IF ASC-SEL-SUB < +1                                          15730001
157400         SUBTRACT +1 FROM ASC-SEL-ITEM                            15740001
157500         MOVE RC801-MAX-ITEMS TO ASC-SEL-SUB                      15750010
157600     END-IF.                                                      15760001
157700                                                                  15770001
157800     IF ASC-SEL-ITEM > ZERO                                       15780001
157900         PERFORM 9100-READ-SEL-QUEUE                              15790001
158000         MOVE RC801-REC-LNE-NBR (ASC-SEL-SUB)                     15800010
158100              TO ASC-KEY-DRV-LNE-NBR                              15810010
158200         MOVE RC801-PACK-ID (ASC-SEL-SUB)                         15820021
158300              TO ASC-KEY-PACK-ID                                  15830036
158400                 ASC-DSP-PACK-ID-N                                15840036
158500         MOVE RC801-PACK-DESC (ASC-SEL-SUB)                       15850021
158600              TO ASC-KEY-PACK-DESC                                15860021
158700     ELSE                                                         15870001
158800         MOVE +1 TO ASC-SEL-ITEM                                  15880010
158900                    ASC-SEL-SUB                                   15890010
159000*--- TOP OF LIST ---                                              15900010
159100         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          15910010
159200         SET DP020-MSG-INFORMATIONAL TO TRUE                      15920010
159300     END-IF.                                                      15930001
159400                                                                  15940001
159500******************************************************************15950003
159600 3000-EDIT-DATA-IN-COMMAREA.                                      15960001
159700                                                                  15970001
159800     SET PS-NO-ERROR TO TRUE.                                     15980003
159900                                                                  15990001
160000     PERFORM 3200-RESET-ATTRIBUTES.                               16000001
160100                                                                  16010001
160200     MOVE ASC-ITEMS-DISPLAYED TO PV-SUB.                          16020003
160300                                                                  16030003
160400     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM                         16040003
160500                            + ASC-ITEMS-DISPLAYED - 1.            16050003
160600                                                                  16060003
160700     PERFORM 3100-SET-SUBSCRIPTS.                                 16070001
160800                                                                  16080001
160900     PERFORM 3300-EDIT-SELECTIONS                                 16090001
161000       VARYING PV-SUB FROM PV-SUB BY -1                           16100003
161100         UNTIL PV-SUB < +1.                                       16110003
161200                                                                  16120001
161300     IF PS-NO-ERROR                                               16130001
161400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16140001
161500     END-IF.                                                      16150001
161600                                                                  16160001
161700     IF PS-NO-ERROR                                               16170003
161800       AND ASC-START-OF-SELECTED-RANGE > ZERO                     16180003
161900       AND ASC-END-OF-SELECTED-RANGE > ZERO                       16190003
162000         PERFORM 3500-MARK-RANGE-AS-SELECTED                      16200001
162100     END-IF.                                                      16210001
162200                                                                  16220001
162300******************************************************************16230003
162400 3100-SET-SUBSCRIPTS.                                             16240001
162500                                                                  16250001
162600     COMPUTE ASC-ITEM-SUB =                                       16260001
162700            (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.    16270003
162800                                                                  16280001
162900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16290001
163000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16300001
163100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16310003
163200     ELSE                                                         16320001
163300         MOVE +1 TO ASC-BLK-SUB                                   16330003
163400     END-IF.                                                      16340001
163500                                                                  16350001
163600******************************************************************16360010
163700 3200-RESET-ATTRIBUTES.                                           16370001
163800                                                                  16380001
163900*    IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY          16390017
164000*        MOVE DP015-ASK-DRK-OFF TO AHDR0A                         16400017
164100*                                  AHDR1A                         16410017
164200*                                  AHDR2A                         16420017
164300*                                  AHDR3A                         16430017
164400*                                  ABAR1A                         16440017
164500*                                  ABAR2A                         16450017
164600*                                  ABAR3A                         16460017
164700*                                  ABAR4A                         16470017
164800*                                  ABAR5A                         16480017
164900*                                  ABAR6A                         16490017
165000*                                  ABAR7A                         16500017
165100*                                  ABAR8A                         16510017
165200*        PERFORM VARYING PV-SUB FROM 1 BY 1                       16520017
165300*          UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                     16530017
165400*            MOVE DP015-ASK-DRK-OFF                               16540017
165500*                TO MR-STATUS-A        (PV-SUB)                   16550017
165600*                   MR-LAST-QTY-REC-A  (PV-SUB)                   16560017
165700*                   MR-LAST-DTE-REC-A  (PV-SUB)                   16570017
165800*                   MR-STATUS2-A       (PV-SUB)                   16580017
165900*                   MR-PRIOR-QTY-REC-A (PV-SUB)                   16590017
166000*                   MR-PRIOR-DTE-REC-A (PV-SUB)                   16600017
166100*                   MR-MORE-A          (PV-SUB)                   16610017
166200*        END-PERFORM                                              16620017
166300*    END-IF.                                                      16630017
166400                                                                  16640001
166500     MOVE DP015-HL-OFF           TO ADQTYH.                       16650001
166600     MOVE DP015-BLUE             TO ADQTYC.                       16660001
166700                                                                  16670001
166800     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     16680001
166900     MOVE DP015-GREEN            TO ASTRTITC.                     16690001
167000     MOVE DP015-UNDERLINE        TO ASTRTITH.                     16700001
167100                                                                  16710001
167200     IF ASC-TRBL-EXISTS                                           16720001
167300         MOVE DP015-YELLOW       TO ARCVRC                        16730001
167400     END-IF.                                                      16740001
167500                                                                  16750001
167600     IF ASC-CANT-UPDATE                                           16760003
167700         PERFORM VARYING PV-SUB FROM 1 BY 1                       16770003
167800           UNTIL  PV-SUB > PC-ITEMS-PER-PANEL                     16780003
167900             MOVE DP015-ASK-NOR-OFF TO MR-SELECTA   (PV-SUB)      16790003
168000                                       MR-STR-QTY-A (PV-SUB)      16800003
168100             MOVE DP015-BLUE        TO MR-SELECTC   (PV-SUB)      16810003
168200                                       MR-STR-QTY-C (PV-SUB)      16820003
168300             MOVE DP015-HL-OFF      TO MR-SELECTH   (PV-SUB)      16830003
168400                                       MR-STR-QTY-H (PV-SUB)      16840003
168500         END-PERFORM                                              16850001
168600     ELSE                                                         16860001
168700         PERFORM VARYING PV-SUB FROM 1 BY 1                       16870003
168800           UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                     16880003
168900             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA   (PV-SUB)  16890003
169000             MOVE DP015-UNP-NUM-NOR-OFF TO MR-STR-QTY-A (PV-SUB)  16900003
169100             MOVE DP015-GREEN     TO MR-SELECTC   (PV-SUB)        16910003
169200                                     MR-STR-QTY-C (PV-SUB)        16920003
169300             MOVE DP015-UNDERLINE TO MR-SELECTH   (PV-SUB)        16930003
169400                                     MR-STR-QTY-H (PV-SUB)        16940003
169500         END-PERFORM                                              16950003
169600     END-IF.                                                      16960001
169700                                                                  16970001
169800******************************************************************16980003
169900 3300-EDIT-SELECTIONS.                                            16990001
170000                                                                  17000001
170100     EVALUATE TRUE                                                17010001
170200       WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =     17020033
170300                 ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)       17030033
170400           CONTINUE                                               17040033
170500                                                                  17050001
170600       WHEN ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17060033
170700           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           17070033
170800               ADD +1 TO ASC-NUMBER-OF-SELECTED-ITEMS             17080033
170900               MOVE ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB)17090033
171000                 TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)    17100033
171100           END-IF                                                 17110033
171200                                                                  17120001
171300       WHEN ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB) = SPACE17130033
171400           EVALUATE TRUE                                          17140033
171500             WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)          17150033
171600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17160033
171700                 MOVE SPACE   TO  ASC-SELECTED-SW                 17170033
171800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17180001
171900                                                                  17190001
172000             WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)          17200033
172100                 MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE        17210033
172200                 MOVE SPACE TO ASC-SELECTED-SW                    17220033
172300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17230001
172400                                                                  17240001
172500             WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)          17250033
172600                 MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE          17260033
172700                 MOVE SPACE TO ASC-SELECTED-SW                    17270033
172800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17280001
172900           END-EVALUATE                                           17290033
173000                                                                  17300001
173100       WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)             17310033
173200           IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)              17320033
173300               SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS      17330033
173400           END-IF                                                 17340033
173500           PERFORM 3310-EDIT-RANGE                                17350033
173600                                                                  17360001
173700       WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)              17370033
173800           IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               17380033
173900               SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS      17390033
174000           END-IF                                                 17400033
174100           PERFORM 3310-EDIT-RANGE                                17410033
174200                                                                  17420001
174300       WHEN OTHER                                                 17430033
174400           MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER               17440033
174500           SET PS-ERROR                                           17450033
174600               DP020-MSG-FATAL                                    17460033
174700               DP030-SET-CURSOR-APPL-1 TO TRUE                    17470033
174800           MOVE -1             TO MR-SELECTL (PV-SUB)             17480033
174900           MOVE DP015-RED      TO MR-SELECTC (PV-SUB)             17490033
175000           MOVE DP015-REVERSE  TO MR-SELECTH (PV-SUB)             17500033
175100           IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               17510033
175200               SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS       17520033
175300               MOVE SPACE  TO  ASC-SELECTED-SW                    17530033
175400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17540001
175500           END-IF                                                 17550033
175600     END-EVALUATE.                                                17560001
175700                                                                  17570001
175800     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     17580001
175900         IF ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       17590001
176000             MOVE ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          17600010
176100                  TO DP010I-UNEDITED-FIELD                        17610010
176200             MOVE LENGTH OF ASC-STR-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 17620010
176300                  TO DP010I-MAXIMUM-DIGITS                        17630010
176400             MOVE ZEROES TO DP010I-MAXIMUM-DECIMALS               17640010
176500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              17650010
176610             CALL DP010I-NUMERIC-EDIT-ROUTINE                     17661099
176620                  USING DP010I-NUMERIC-EDIT-AREA                  17662099
176700             IF DP010I-ERROR-DETECTED                             17670010
176800                 SET PS-ERROR                                     17680001
176900                     DP020-MSG-FATAL                              17690001
177000                     DP030-SET-CURSOR-APPL-1 TO TRUE              17700010
177100                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         17710010
177200                 MOVE DP015-UNP-NUM-BRT-OFF                       17720001
177300                                    TO MR-STR-QTY-A (PV-SUB)      17730010
177400                 MOVE -1            TO MR-STR-QTY-L (PV-SUB)      17740010
177500                 MOVE DP015-RED     TO MR-STR-QTY-C (PV-SUB)      17750010
177600                 MOVE DP015-REVERSE TO MR-STR-QTY-H (PV-SUB)      17760010
177700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17770010
177800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17780001
177900             ELSE                                                 17790001
178000                 SUBTRACT ASC-STR-QTY-PREV                        17800001
178100                                    (ASC-BLK-SUB ASC-ITEM-SUB)    17810001
178200                         FROM ASC-KEY-ALLOC-PK-QTY                17820003
178300                 MOVE DP010I-NUMERIC-FIELD                        17830001
178400                                 TO ASC-STR-QTY-N                 17840001
178500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    17850001
178600                 ADD ASC-STR-QTY-N                                17860001
178700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    17870001
178800                         TO ASC-KEY-ALLOC-PK-QTY                  17880003
178900                 MOVE ASC-KEY-ALLOC-PK-QTY TO ADQTYO              17890003
179000                 MOVE ASC-STR-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    17900001
179100                          TO MR-STR-QTY-EDITED (PV-SUB)           17910001
179200                 MOVE ASC-STR-QTY-N                               17920001
179300                                (ASC-BLK-SUB ASC-ITEM-SUB)        17930001
179400                         TO ASC-STR-QTY-PREV                      17940001
179500                                (ASC-BLK-SUB ASC-ITEM-SUB)        17950001
179600                 SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)          17960001
179700                                 TO TRUE                          17970001
179800             END-IF                                               17980001
179900         ELSE                                                     17990001
180000* A SELECTED STORE QTY WILL DEFAULT TO THE PRORATE QTY.           18000001
180100             SUBTRACT ASC-STR-QTY-PREV                            18010001
180200                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18020001
180300                         FROM ASC-KEY-ALLOC-PK-QTY                18030003
180400             ADD ASC-EXPTED-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)       18040017
180500                                 TO ASC-KEY-ALLOC-PK-QTY          18050003
180600             MOVE ASC-EXPTED-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)      18060017
180700                                 TO ASC-STR-QTY-N                 18070001
180800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18080001
180900                                    MR-STR-QTY-EDITED (PV-SUB)    18090001
181000                                    ASC-STR-QTY-PREV              18100001
181100                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18110001
181200         END-IF                                                   18120001
181300     ELSE                                                         18130001
181400         SUBTRACT ASC-STR-QTY-PREV  (ASC-BLK-SUB ASC-ITEM-SUB)    18140001
181500                         FROM ASC-KEY-ALLOC-PK-QTY                18150003
181600         ADD ASC-EXPTED-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)           18160017
181700                                 TO ASC-KEY-ALLOC-PK-QTY          18170003
181800         MOVE ASC-EXPTED-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)          18180017
181900                                 TO ASC-STR-QTY-N                 18190001
182000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18200001
182100*                                   MR-STR-QTY-EDITED (PV-SUB)    18210001
182200                                    ASC-STR-QTY-PREV              18220001
182300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18230001
182400     IF  ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18240001
182500         MOVE SPACE              TO MR-STR-QTY (PV-SUB)           18250001
182600     END-IF                                                       18260001
182700     END-IF.                                                      18270001
182800                                                                  18280001
182900     SUBTRACT +1 FROM PV-ITEM-IN-USE                              18290001
183000                      ASC-ITEM-SUB.                               18300001
183100                                                                  18310001
183200     IF ASC-ITEM-SUB < 1                                          18320001
183300         SUBTRACT +1 FROM ASC-BLK-SUB                             18330001
183400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  18340001
183500     END-IF.                                                      18350001
183600                                                                  18360001
183700******************************************************************18370003
183800 3310-EDIT-RANGE.                                                 18380001
183900                                                                  18390001
184000     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 18400001
184100        IF ASC-START-OF-SELECTED-RANGE = ZERO                     18410001
184200            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  18420001
184300                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  18430001
184400            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   18440001
184500        ELSE                                                      18450001
184600            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18460001
184700                CONTINUE                                          18470001
184800            ELSE                                                  18480001
184900                MOVE PC-TSYMSG-00054                              18490001
185000                                 TO DP020-MSG-NUMBER              18500001
185100                SET DP020-MSG-FATAL                               18510001
185200                    PS-ERROR                                      18520001
185300                    DP030-SET-CURSOR-APPL-1                       18530001
185400                                 TO TRUE                          18540001
185500                MOVE -1          TO MR-SELECTL (PV-SUB)           18550001
185600                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           18560001
185700                MOVE DP015-UNDERLINE                              18570001
185800                                 TO MR-SELECTH (PV-SUB)           18580001
185900            END-IF                                                18590001
186000        END-IF                                                    18600001
186100     ELSE                                                         18610001
186200         IF ASC-END-OF-SELECTED-RANGE = ZERO                      18620001
186300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18630001
186400                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18640001
186500             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     18650001
186600         ELSE                                                     18660001
186700             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        18670001
186800                 CONTINUE                                         18680001
186900             ELSE                                                 18690001
187000                MOVE PC-TSYMSG-00055                              18700001
187100                                 TO DP020-MSG-NUMBER              18710001
187200                SET DP020-MSG-FATAL                               18720001
187300                    PS-ERROR                                      18730001
187400                    DP030-SET-CURSOR-APPL-1                       18740001
187500                                 TO TRUE                          18750001
187600                MOVE -1          TO MR-SELECTL (PV-SUB)           18760001
187700             END-IF                                               18770001
187800         END-IF                                                   18780001
187900     END-IF.                                                      18790001
188000                                                                  18800001
188100******************************************************************18810003
188200 3350-EDIT-DISTR-LNE-QTY.                                         18820001
188300                                                                  18830006
188400     IF ASC-KEY-ALLOC-PK-QTY NOT = ASC-KEY-EXPTD-PK-QTY           18840006
188500         SET PS-ERROR                                             18850001
188600             DP020-MSG-FATAL                                      18860001
188700             DP030-SET-CURSOR-APPL-1 TO TRUE                      18870033
188800         MOVE PC-TSYMSG-02222 TO DP020-MSG-NUMBER                 18880077
188900         MOVE -1              TO MR-SELECTL (1)                   18890033
189000         MOVE DP015-RED       TO ADQTYC                           18900033
189100         MOVE DP015-REVERSE   TO ADQTYH                           18910033
189210     END-IF.                                                      18921033
189300                                                                  18930001
189400******************************************************************18940003
189500 3400-CHECK-RANGE-SEQUENCE.                                       18950001
189600                                                                  18960001
189700     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    18970001
189800        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    18980001
189900        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   18990001
190000         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              19000001
190100         SET PS-ERROR                                             19010001
190200             DP020-MSG-FATAL     TO TRUE                          19020001
190300                                                                  19030001
190400         PERFORM 3410-POSITION-AT-ERROR                           19040001
190500     END-IF.                                                      19050001
190600                                                                  19060001
190700******************************************************************19070003
190800 3410-POSITION-AT-ERROR.                                          19080001
190900                                                                  19090001
191000     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         19100001
191100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               19110001
191200                                                  PV-TOP-ITEM + 1.19120001
191300     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19130001
191400         CONTINUE                                                 19140001
191500     ELSE                                                         19150001
191600         MOVE -1                 TO MR-SELECTL (PV-SUB)           19160001
191700         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           19170001
191800         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           19180001
191900     END-IF.                                                      19190001
192000                                                                  19200001
192100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.19210001
192200     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19220001
192300         CONTINUE                                                 19230001
192400     ELSE                                                         19240001
192500         MOVE -1                 TO MR-SELECTL (PV-SUB)           19250001
192600         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           19260001
192700         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           19270001
192800     END-IF.                                                      19280001
192900                                                                  19290001
193000******************************************************************19300003
193100 3500-MARK-RANGE-AS-SELECTED.                                     19310001
193200                                                                  19320001
193300     MOVE +1                     TO ASC-BLK-SUB.                  19330001
193400                                                                  19340001
193500     PERFORM 3510-MARK-SELECTED-INDS                              19350001
193600             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    19360001
193700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           19370001
193800                                                                  19380001
193900     ADD +1                      TO ASC-BLK-SUB.                  19390001
194000                                                                  19400001
194100     PERFORM 3510-MARK-SELECTED-INDS                              19410001
194200             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    19420001
194300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           19430001
194400                                                                  19440001
194500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              19450001
194600                                 TO PV-LIST-ITEM-NUMBER.          19460001
194700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        19470001
194800                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).19480001
194900     MOVE ASC-START-OF-SELECTED-RANGE                             19490001
195000                                 TO PV-START-OF-SELECTED-RANGE.   19500001
195100     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        19510001
195200             ((PV-START-OF-SELECTED-RANGE - 1) /                  19520001
195300                                              PC-ITEMS-PER-PANEL).19530001
195400     MOVE ASC-END-OF-SELECTED-RANGE                               19540001
195500                                 TO PV-END-OF-SELECTED-RANGE.     19550001
195600     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         19560001
195700             ((PV-END-OF-SELECTED-RANGE - 1) /                    19570001
195800                                              PC-ITEMS-PER-PANEL).19580001
195900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.19590001
196000                                                                  19600001
196100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19610001
196200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19620001
196300         MOVE +1                 TO ASC-BLK-SUB                   19630001
196400                                                                  19640001
196500         PERFORM 5100-WRITE-TEMP-STORAGE                          19650001
196600                                                                  19660001
196700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19670001
196800                                       PV-FIRST-BLOCK-IN-ARRAY - 119680001
196900                                                                  19690001
197000         PERFORM                                                  19700001
197100           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 19710001
197200                 MOVE PV-FIRST-BLOCK-IN-RANGE                     19720001
197300                                 TO PV-BLOCK-NUMBER               19730001
197400                                                                  19740001
197500                 PERFORM 4410-READ-TEMP-STORAGE                   19750001
197600                                                                  19760001
197700                 PERFORM 3510-MARK-SELECTED-INDS                  19770001
197800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        19780001
197900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL19790001
198000                                                                  19800001
198100                 PERFORM 5100-WRITE-TEMP-STORAGE                  19810001
198200                                                                  19820001
198300                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       19830001
198400         END-PERFORM                                              19840001
198500                                                                  19850001
198600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19860001
198700                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY19870001
198800         PERFORM                                                  19880001
198900           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  19890001
199000                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      19900001
199100                                 TO PV-BLOCK-NUMBER               19910001
199200                                                                  19920001
199300                 PERFORM 4410-READ-TEMP-STORAGE                   19930001
199400                                                                  19940001
199500                 PERFORM 3510-MARK-SELECTED-INDS                  19950001
199600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        19960001
199700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL19970001
199800                                                                  19980001
199900                 PERFORM 5100-WRITE-TEMP-STORAGE                  19990001
200000                                                                  20000001
200100                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        20010001
200200         END-PERFORM                                              20020001
200300                                                                  20030001
200400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20040001
200500                                 TO PV-BLOCK-NUMBER               20050001
200600                                                                  20060001
200700         PERFORM 4410-READ-TEMP-STORAGE                           20070001
200800                                                                  20080001
200900     END-IF.                                                      20090001
201000                                                                  20100001
201100     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   20110001
201200                                    ASC-END-OF-SELECTED-RANGE.    20120001
201300                                                                  20130001
201400******************************************************************20140003
201500 3510-MARK-SELECTED-INDS.                                         20150001
201600                                                                  20160001
201700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     20170001
201800                                       ASC-START-OF-SELECTED-RANGE20180001
201900        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  20190001
202000                                         ASC-END-OF-SELECTED-RANGE20200001
202100           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           20210001
202200               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          20220001
202300                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               20230001
202400                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     20240001
202500                                 TO TRUE                          20250001
202600               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  20260001
202700           END-IF                                                 20270001
202800        END-IF                                                    20280001
202900     END-IF.                                                      20290001
203000                                                                  20300003
203100******************************************************************20310010
203200******************************************************************20320013
203300 4000-BUILD-INITIAL-PANEL.                                        20330001
203400                                                                  20340001
203500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             20350001
203600                ASC-BLOCK-ENTRIES (2).                            20360001
203700                                                                  20370001
203800     MOVE +1             TO ASC-BLK-SUB.                          20380008
203900     SET ASC-MORE-RECDIS TO TRUE.                                 20390008
204000                                                                  20400001
204100     MOVE ZEROES         TO ASC-ITEM-SUB                          20410008
204200                            ASC-NUMBER-OF-ITEMS-READ              20420008
204300                            ASC-NUMBER-OF-SELECTED-ITEMS          20430008
204400                            ASC-HIGHEST-BLOCK-WRITTEN             20440008
204500                            ASC-START-OF-SELECTED-RANGE           20450008
204600                            ASC-END-OF-SELECTED-RANGE             20460008
204700                            ASC-ITEM-AT-TOP-OF-PANEL.             20470008
204800                                                                  20480001
204900*MOVE PASSED DATA TO DB2 KEYS.                                    20490010
205000     PERFORM 4010-FORMAT-KEYS.                                    20500001
205100                                                                  20510001
205200     PERFORM 4011-LOOK-FOR-TROUBLE.                               20520001
205300                                                                  20530001
205400*GET DEPT#, PACKING-CODE & VENDOR NAME.                           20540011
205500     PERFORM 4020-GET-VENDOR-NAME.                                20550001
205600     MOVE PURCHS-DEPT-NBR       TO ASC-KEY-DEPT-NBR.              20560010
205700*    MOVE PURCHS-PKGNG-CDE      TO ASC-DSP-PACK-TYPE.             20570099
205800                                                                  20580030
205900*GET PACK ID DESCRIPTION.                                         20590030
206000     PERFORM 4021-GET-PACK-ID-DESC.                               20600030
206100                                                                  20610008
206200*GET PO-PREPACK-ID & PREPACK-RATIO-QTY.                           20620010
206300     PERFORM 4100-SELECT-PURITM-DATA.                             20630001
206400     MOVE PURITM-VEND-STYL-NAME TO ASC-VEND-STYL-NAME.            20640008
206500                                                                  20650001
206600*LINK TO DPKCS277 (RETURNS WITH ALL STORES AND THEIR OTR).        20660010
206700     PERFORM 4200-CALC-OPEN-TO-REC.                               20670008
206800                                                                  20680001
206900*GET PREPK-ID/RATIO, EXPECTED-QTY & OUTER/INNER PACK-QTYS.        20690013
207000     MOVE ZEROES TO PV-CURR-PREPK-RATO-QTY.                       20700076
207100                                                                  20710099
207200     PERFORM 4097-CHECK-AUTOVRFD.                                 20720099
207300                                                                  20730099
207310     PERFORM 4110-SELECT-RECITM-DATA                              20731099
207320                                                                  20732099
207400*    IF ASC-AUTO-VE-NO                                            20740099
207500*        PERFORM 4110-SELECT-RECITM-DATA                          20750099
207600*    ELSE                                                         20760099
207700***  NEEDED TO GET THE RECITM-CASE-PACK-QTY                       20770099
207800*        PERFORM 4110-SELECT-RECITM-DATA                          20780099
207900*        PERFORM 4115-SELECT-RECITM-DATA                          20790099
208000*    END-IF.                                                      20800099
208010                                                                  20801099
208100     MOVE RECITM-PREPK-RATO-QTY                                   20810076
208200       TO PV-CURR-PREPK-RATO-QTY.                                 20820076
208300                                                                  20830099
208400*JPL - OPEN CURSOR.                                               20840079
208500     IF ASC-DATA-BY-STORE                                         20850080
208600         PERFORM 4030-OPEN-CURSOR                                 20860079
208700     ELSE                                                         20870079
208800         PERFORM 4035-OPEN-RANK-CURSOR                            20880079
208900     END-IF.                                                      20890079
209000                                                                  20900079
209100*CALCULATE ALLOCATED-QTY (RECDIS RUNNING TOTAL).                  20910079
209200     PERFORM 4040-GET-REC-DISTRO.                                 20920001
209300*JPL - CLOSE CURSOR.                                              20930079
209400     IF ASC-DATA-BY-STORE                                         20940080
209500         PERFORM 4050-CLOSE-CURSOR                                20950079
209600     ELSE                                                         20960079
209700         PERFORM 4055-CLOSE-RANK-CURSOR                           20970079
209800     END-IF.                                                      20980079
209900                                                                  20990079
210000     MOVE PV-DISTR-LNE-QTY TO ASC-KEY-ALLOC-PK-QTY.               21000010
210100                                                                  21010001
210200*SET PACK OTR.                                                    21020010
210300     IF DP277-NO-DISTRO                                           21030004
210400         MOVE ALL '*' TO ASC-KEY-PACK-OTR                         21040059
210500     ELSE                                                         21050001
210600         IF   DP277-TOTAL-PK-OTR < 0                              21060081
210700             MOVE 0                  TO ASC-KEY-PACK-OTR-N        21070081
210800         ELSE                                                     21080081
210900             MOVE DP277-TOTAL-PK-OTR TO ASC-KEY-PACK-OTR-N        21090081
211000         END-IF                                                   21100081
211100     END-IF.                                                      21110001
211200                                                                  21120001
211300*GET LOCATION NAME.                                               21130099
211400     PERFORM 4060-GET-LOCATION-DESC.                              21140099
211500                                                                  21150010
211600     PERFORM 4070-GET-TRECEIV.                                    21160099
211700     MOVE RECEIV-PKGNG-CDE      TO ASC-DSP-PACK-TYPE.             21170099
211800*CHECK FOR VERIFIED RECEIVER AND VERIFIED ITEMS                   21180098
211900     PERFORM 4072-CHECK-RECITM-VERIFIED.                          21190098
212000     SET ASC-CAN-UPDATE TO TRUE.                                  21200010
212100     IF (RECEIV-STATUS-CDE EQUAL PC-VE                            21210013
212200*      OR RECITM-STATUS-CDE EQUAL PC-VE)                          21220095
212300       OR PV-DB2-COUNT > ZERO)                                    21230099
212400         SET ASC-CANT-UPDATE TO TRUE                              21240013
212500* * * THE FOLLOWING LINES WERE COMMENTED OUT BECAUSE THEY ARE     21250095
212600* * * USELESS AS WRITTEN - APRIL 2000.                            21260096
212700*        IF ASC-NO-TRBL-EXISTS                                    21270095
212800*            IF RECEIV-PACK-BY-ST-IND = 'Y'                       21280095
212900*                PERFORM 4080-CHECK-RACF                          21290095
213000*                IF DP008-ACCESS-DENIED                           21300095
213100*                    SET ASC-CANT-UPDATE TO TRUE                  21310095
213200*                END-IF                                           21320095
213300*            ELSE                                                 21330095
213400*                SET ASC-CANT-UPDATE TO TRUE                      21340095
213500*            END-IF                                               21350095
213600*        END-IF                                                   21360095
213700     END-IF.                                                      21370013
213800                                                                  21380001
213900*CHECK FOR DISTRIBUTION SPLIT.                                    21390020
214000     PERFORM 4090-CHECK-FOR-SPLIT.                                21400010
214100     IF PV-DB2-COUNT > ZERO                                       21410001
214200         SET ASC-CANT-UPDATE   TO TRUE                            21420010
214300         MOVE PC-TSYMSG-01858  TO DP020-MSG-NUMBER                21430010
214400         SET DP020-MSG-WARNING TO TRUE                            21440010
214500     END-IF.                                                      21450010
214600                                                                  21460001
214700*FINISH.                                                          21470010
214800     MOVE +1 TO PV-TOP-ITEM.                                      21480010
214900     MOVE -1 TO MR-SELECTL (1).                                   21490010
215000     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         21500010
215100                                                                  21510010
215200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21520010
215300                                                                  21530010
215400 4000-EXIT.                                                       21540001
215500     EXIT.                                                        21550001
215600                                                                  21560001
215700******************************************************************21570003
215800******************************************************************21580010
215900 4010-FORMAT-KEYS.                                                21590001
216000                                                                  21600001
216100     MOVE ASC-KEY-REC-NBR-N      TO DK-REC-NBR.                   21610004
216200     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               21620001
216300     MOVE ASC-KEY-DRV-LNE-NBR    TO DK-DRV-LNE-NBR.               21630008
216400                                                                  21640001
216500******************************************************************21650003
216600 4011-LOOK-FOR-TROUBLE.                                           21660001
216700                                                                  21670001
216800     EXEC SQL                                                     21680001
216900         SELECT B.TRBL_SHT_DESC                                   21690001
217000           INTO :TRBRSN-TRBL-SHT-DESC                             21700064
217100           FROM  TTRBNTF A                                        21710064
217200                ,TTRBRSN B                                        21720064
217300                ,TRECITM C                                        21730064
217400          WHERE A.PO_NBR              = :DK-REC-NBR               21740064
217500            AND A.REC_SEQ_NBR         = :DK-REC-SEQ-NBR           21750064
217600            AND A.PO_LNE_NBR          = :DK-DRV-LNE-NBR           21760064
217700            AND A.OPER_UNT_ID         = :ASC-KEY-OPER-UNT-ID      21770064
217800            AND A.FCLTY_ID            = :ASC-KEY-FCLTY-ID         21780064
217900            AND A.TRBL_RSN_CDE        = B.TRBL_RSN_CDE            21790064
218000                                                                  21800064
218100            AND C.ORD_NBR             = :DK-REC-NBR               21810064
218200            AND C.REC_SEQ_NBR         = :DK-REC-SEQ-NBR           21820064
218300            AND C.ORD_LNE_NBR         = :DK-DRV-LNE-NBR           21830064
218400                                                                  21840064
218500            AND ((A.PO_LNE_NBR        = :DK-DRV-LNE-NBR           21850064
218600            AND   B.TRBL_LVL_IND     <> :PC-M)                    21860064
218700             OR  (A.PREPK_ID          = :RECITM-PREPK-ID          21870064
218800            AND   B.TRBL_LVL_IND      = :PC-M))                   21880064
218900     END-EXEC.                                                    21890064
219000                                                                  21900001
219100     EVALUATE TRUE                                                21910001
219200         WHEN SQLCODE = ZERO                                      21920001
219300             SET ASC-TRBL-EXISTS           TO TRUE                21930001
219400         WHEN SQLCODE = -811                                      21940001
219500         WHEN SQLCODE = +100                                      21950001
219600             SET ASC-NO-TRBL-EXISTS        TO TRUE                21960001
219700         WHEN SQLCODE = -904                                      21970001
219800         WHEN SQLCODE = -911                                      21980001
219900         WHEN SQLCODE = -913                                      21990001
220000             PERFORM 9900-SOFT-ABORT                              22000001
220100         WHEN SQLWARN0 NOT = SPACE                                22010001
220200         WHEN SQLCODE < ZERO                                      22020001
220300         WHEN SQLCODE > ZERO                                      22030001
220400             MOVE '4011-LOOK-FOR-TROUBLE'                         22040001
220500                             TO DP013-PARAGRAPH                   22050001
220600             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     22060001
220700                             TO DP013-MESSAGE-TEXT (1)            22070001
220800             MOVE SQLCA          TO DP013-SQLCA                   22080001
220900             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      22090001
221000             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      22100001
221100             SET DP013-DB2-ABEND                                  22110001
221200                 DP013-XCTL-DISPLAY-RESTART                       22120001
221300                             TO TRUE                              22130001
221400              PERFORM DP013-0000-PROCESS-ABEND                    22140001
221500     END-EVALUATE.                                                22150001
221600                                                                  22160001
221700******************************************************************22170003
221800 4020-GET-VENDOR-NAME.                                            22180001
221900                                                                  22190001
222000     EXEC SQL                                                     22200001
222100          SELECT B.ENT_NAME_DESC                                  22210001
222200               , A.DEPT_NBR                                       22220001
222300               , A.STATUS_CDE                                     22230001
222400               , A.PKGNG_CDE                                      22240011
222500            INTO :ENTNME-ENT-NAME-DESC                            22250001
222600               , :PURCHS-DEPT-NBR                                 22260001
222700               , :ASC-PURCHS-STATUS-CDE                           22270001
222800               , :PURCHS-PKGNG-CDE                                22280011
222900            FROM TPURCHS A,                                       22290001
223000                 TENTNME B                                        22300001
223100           WHERE A.VER_STATUS_CDE = :PC-ACTIVE                    22310001
223200             AND A.PO_NBR             = :DK-REC-NBR               22320003
223300             AND A.ENT_ID             = B.ENT_ID                  22330001
223400             AND B.TYPE_CDE           = :PC-01                    22340001
223500     END-EXEC                                                     22350001
223600                                                                  22360001
223700     EVALUATE TRUE                                                22370001
223800         WHEN SQLCODE = ZERO                                      22380001
223900             MOVE ENTNME-ENT-NAME-DESC                            22390001
224000                                 TO ASC-KEY-VENDOR-NAME           22400001
224100         WHEN SQLCODE = +100                                      22410001
224200             MOVE 'VENDOR NOT FOUND'                              22420001
224300                                 TO ASC-KEY-VENDOR-NAME           22430001
224400         WHEN SQLCODE = -904                                      22440001
224500         WHEN SQLCODE = -911                                      22450001
224600         WHEN SQLCODE = -913                                      22460001
224700             PERFORM 9900-SOFT-ABORT                              22470001
224800         WHEN SQLWARN0 NOT = SPACES                               22480001
224900         WHEN SQLCODE      NOT = ZERO                             22490001
225000             MOVE '4020-GET-VENDOR-NAME'                          22500001
225100                             TO DP013-PARAGRAPH                   22510001
225200             MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'            22520001
225300                             TO DP013-MESSAGE-TEXT (1)            22530001
225400             MOVE SQLCA         TO DP013-SQLCA                    22540001
225500             MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)           22550001
225600             SET DP013-DB2-ABEND                                  22560001
225700                  DP013-XCTL-DISPLAY-RESTART                      22570001
225800                             TO TRUE                              22580001
225900             PERFORM DP013-0000-PROCESS-ABEND                     22590001
226000     END-EVALUATE.                                                22600001
226100                                                                  22610001
226200******************************************************************22620003
226300 4021-GET-PACK-ID-DESC.                                           22630030
226400                                                                  22640030
226500     EXEC SQL                                                     22650030
226600         SELECT PREPK_DESC                                        22660030
226700              , INPK_UNT_QTY                                      22670099
226800           INTO :POPRPK-PREPK-DESC                                22680030
226900              , :POPRPK-INPK-UNT-QTY                              22690099
227000           FROM TPOPRPK                                           22700030
227100          WHERE PO_NBR      = :DK-REC-NBR                         22710030
227200            AND PO_PREPK_ID = :ASC-KEY-PACK-ID                    22720036
227300     END-EXEC                                                     22730030
227400                                                                  22740030
227500     EVALUATE TRUE                                                22750030
227600       WHEN SQLCODE = ZERO                                        22760030
227700           MOVE POPRPK-PREPK-DESC   TO ASC-KEY-PACK-DESC          22770099
227800           MOVE POPRPK-INPK-UNT-QTY TO ASC-KEY-INNR-PACK-QTY      22780099
227900                                                                  22790030
228000       WHEN SQLCODE = +100                                        22800030
228100           MOVE 'PACK ID DESC NOT FOUND' TO ASC-KEY-PACK-DESC     22810030
228200           MOVE +1                       TO ASC-KEY-INNR-PACK-QTY 22820099
228300                                                                  22830030
228400       WHEN SQLCODE = -904                                        22840030
228500       WHEN SQLCODE = -911                                        22850030
228600       WHEN SQLCODE = -913                                        22860030
228700           PERFORM 9900-SOFT-ABORT                                22870030
228800                                                                  22880030
228900       WHEN SQLWARN0 NOT = SPACES                                 22890030
229000       WHEN SQLCODE  NOT = ZERO                                   22900030
229100           MOVE '4021-GET-PACK-ID-DESC' TO DP013-PARAGRAPH        22910030
229200           MOVE 'UNSUCCESSFUL SELECT OF PACK ID DESC'             22920030
229300                TO DP013-MESSAGE-TEXT (1)                         22930030
229400           MOVE SQLCA     TO DP013-SQLCA                          22940030
229500           MOVE 'TPOPRPK' TO DP013-DB2-TABLE-NAME (1)             22950030
229600           SET DP013-DB2-ABEND                                    22960030
229700               DP013-XCTL-DISPLAY-RESTART TO TRUE                 22970030
229800           PERFORM DP013-0000-PROCESS-ABEND                       22980030
229900     END-EVALUATE.                                                22990030
230000                                                                  23000030
230100******************************************************************23010030
230200 4030-OPEN-CURSOR.                                                23020001
230300                                                                  23030001
230400     EXEC SQL                                                     23040001
230500          OPEN RECDIS-CURSOR                                      23050001
230600     END-EXEC                                                     23060001
230700                                                                  23070001
230800     EVALUATE TRUE                                                23080001
230900         WHEN SQLCODE = ZERO                                      23090001
231000              CONTINUE                                            23100001
231100         WHEN SQLCODE = -904                                      23110001
231200         WHEN SQLCODE = -911                                      23120001
231300         WHEN SQLCODE = -913                                      23130001
231400             PERFORM 9900-SOFT-ABORT                              23140001
231500         WHEN SQLWARN0 NOT = SPACES                               23150001
231600         WHEN SQLCODE      NOT = ZERO                             23160001
231700              MOVE '4030-OPEN-CURSOR'                             23170001
231800                             TO DP013-PARAGRAPH                   23180001
231900              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              23190001
232000                             TO DP013-MESSAGE-TEXT (1)            23200001
232100              MOVE SQLCA         TO DP013-SQLCA                   23210001
232200              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          23220001
232300              SET DP013-XCTL-DISPLAY-RESTART                      23230001
232400                  DP013-DB2-ABEND                                 23240001
232500                             TO TRUE                              23250001
232600                                                                  23260001
232700              PERFORM DP013-0000-PROCESS-ABEND                    23270001
232800     END-EVALUATE.                                                23280001
232900                                                                  23290001
233000******************************************************************23300079
233100 4035-OPEN-RANK-CURSOR.                                           23310079
233200                                                                  23320079
233300     EXEC SQL                                                     23330079
233400          OPEN RECDIS-RANK-CURSOR                                 23340079
233500     END-EXEC                                                     23350079
233600                                                                  23360079
233700     EVALUATE TRUE                                                23370079
233800         WHEN SQLCODE = ZERO                                      23380079
233900              CONTINUE                                            23390079
234000         WHEN SQLCODE = -904                                      23400079
234100         WHEN SQLCODE = -911                                      23410079
234200         WHEN SQLCODE = -913                                      23420079
234300             PERFORM 9900-SOFT-ABORT                              23430079
234400         WHEN SQLWARN0 NOT = SPACES                               23440079
234500         WHEN SQLCODE      NOT = ZERO                             23450079
234600              MOVE '4035-OPEN-CURSOR'                             23460079
234700                             TO DP013-PARAGRAPH                   23470079
234800              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              23480079
234900                             TO DP013-MESSAGE-TEXT (1)            23490079
235000              MOVE SQLCA         TO DP013-SQLCA                   23500079
235100              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          23510079
235200              SET DP013-XCTL-DISPLAY-RESTART                      23520079
235300                  DP013-DB2-ABEND                                 23530079
235400                             TO TRUE                              23540079
235500                                                                  23550079
235600              PERFORM DP013-0000-PROCESS-ABEND                    23560079
235700     END-EVALUATE.                                                23570079
235800                                                                  23580079
235900******************************************************************23590079
236000 4040-GET-REC-DISTRO.                                             23600001
236100                                                                  23610001
236200     PERFORM VARYING PV-READ-COUNT FROM 1 BY 1                    23620013
236300       UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR ASC-NO-MORE-RECDIS   23630013
236400*JPL                                                              23640079
236500         IF ASC-DATA-BY-STORE                                     23650080
236600             PERFORM 4042-FETCH-RECDIS                            23660079
236700         ELSE                                                     23670079
236800             PERFORM 4045-FETCH-RANK-RECDIS                       23680079
236900         END-IF                                                   23690079
237000                                                                  23700001
237100         IF ASC-MORE-RECDIS                                       23710001
237200             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 23720001
237300                 ADD +1          TO ASC-ITEM-SUB                  23730001
237400             ELSE                                                 23740001
237500                 ADD +1          TO ASC-BLK-SUB                   23750001
237600                 MOVE +1         TO ASC-ITEM-SUB                  23760001
237700                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          23770001
237800                     MOVE +1     TO ASC-BLK-SUB                   23780001
237900                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           23790013
238000                     PERFORM 5100-WRITE-TEMP-STORAGE              23800001
238100                     MOVE ASC-BLOCK-ENTRIES                       23810001
238200                                          (PC-MAX-BLOCKS-IN-ARRAY)23820001
238300                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)23830001
238400                     ADD +1      TO ASC-BLK-SUB                   23840001
238500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23850001
238600                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     23860001
238700                                 TO TRUE                          23870001
238800                 END-IF                                           23880001
238900             END-IF                                               23890001
239000                                                                  23900016
239100             ADD +1 TO ASC-NUMBER-OF-ITEMS-READ                   23910016
239200                                                                  23920016
239300             MOVE ASC-NUMBER-OF-ITEMS-READ                        23930001
239400               TO ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) 23940017
239500                                                                  23950017
239600             MOVE RECDIS-STR-NBR                                  23960017
239700               TO ASC-STR-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)        23970017
239800                  DK-STR-NBR                                      23980017
239900                                                                  23990017
240000*CONVERT RECDIS-EXPCTD-ITM-QTY (ALLOC) TO PACK QTY.               24000017
240100***          MOVE RECDIS-EXPTED-ITM-QTY                           24010075
240200***            TO ASC-EXPTED-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)     24020017
240300***               ASC-STR-QTY-PREV (ASC-BLK-SUB ASC-ITEM-SUB)     24030017
240400             MOVE PV-CURR-PREPK-RATO-QTY                          24040076
240500               TO RECITM-PREPK-RATO-QTY                           24050076
240600             IF RECITM-PREPK-RATO-QTY > 0                         24060099
240700                 COMPUTE PV-EXPTED-QTY-PK                         24070099
240800                       = RECDIS-EXPTED-ITM-QTY                    24080099
240900                       / RECITM-PREPK-RATO-QTY                    24090099
241000                 MOVE PV-EXPTED-QTY-PK TO                         24100099
241100                  ASC-EXPTED-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)     24110099
241200                  ASC-STR-QTY-PREV (ASC-BLK-SUB ASC-ITEM-SUB)     24120099
241300             ELSE                                                 24130099
241400                 MOVE ALL '*' TO                                  24140099
241500                  ASC-EXPTED-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       24150099
241600                 MOVE ZEROES TO                                   24160099
241700                  ASC-STR-QTY-PREV (ASC-BLK-SUB ASC-ITEM-SUB)     24170099
241800             END-IF                                               24180099
241900*CONVERT RECDIS-AP-VERIFY-ITM-QTY (VERFD) TO PACK QTY.            24190099
242000             IF RECITM-PREPK-RATO-QTY > 0                         24200099
242100                 COMPUTE PV-VERIFY-QTY-PK                         24210099
242200                       = RECDIS-AP-VERIFY-ITM-QTY                 24220099
242300                       / RECITM-PREPK-RATO-QTY                    24230099
242400                 MOVE PV-VERIFY-QTY-PK                            24240099
242500                 TO ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    24250099
242600             ELSE                                                 24260099
242700                 MOVE ALL '*'                                     24270099
242800                   TO ASC-VERFD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    24280099
242900             END-IF                                               24290099
243000             IF RECITM-PREPK-RATO-QTY = 0                         24300099
243100                 MOVE ZEROES TO PV-DISTR-LNE-QTY                  24310099
243200             ELSE                                                 24320099
243300                 IF RECDIS-VERIFY-ITM-QTY > 0                     24330099
243400                     COMPUTE PV-DISTR-LNE-QTY =                   24340099
243500                             PV-DISTR-LNE-QTY                     24350099
243600                           + (RECDIS-VERIFY-ITM-QTY               24360099
243700                           / RECITM-PREPK-RATO-QTY)               24370099
243800                 ELSE                                             24380099
243900                     COMPUTE PV-DISTR-LNE-QTY =                   24390099
244000                             PV-DISTR-LNE-QTY                     24400099
244100                           + (RECDIS-EXPTED-ITM-QTY               24410099
244200                           / RECITM-PREPK-RATO-QTY)               24420099
244300                 END-IF                                           24430099
244400             END-IF                                               24440099
244500                                                                  24450016
244600*SEARCH DP277-OTR-TABLE TO FIND OTR FOR EACH STORE                24460017
244700             MOVE DK-STR-NBR TO DP277-SEARCH-NBR                  24470013
244800             PERFORM 4210-SEARCH-OTR                              24480001
244900                                                                  24490001
245000             MOVE DP277-OTR-OUT-X    TO ASC-OTR                   24500015
245100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24510001
245200             IF DP277-PK-OTR-OUT < 0                              24520081
245300                MOVE 0                  TO ASC-OTR-N              24530081
245400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24540001
245500             ELSE                                                 24550081
245600                MOVE DP277-PK-OTR-OUT   TO ASC-OTR-N              24560081
245700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24570081
245800             END-IF                                               24580081
245900             MOVE DP277-ORDER-QTY-X  TO ASC-ORDERED-QTY           24590017
246000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24600001
246100             MOVE DP277-ORDER-PK-QTY TO ASC-ORDERED-QTY-N         24610017
246200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     24620017
246300                                                                  24630001
246400*                                                                 24640078
246500*GET DATA FOR 'OTHER RECEIVERS' (RIGHT SIDE OF MAP DETAIL).       24650017
246600             PERFORM 4120-OPEN-PRIOR-RCVR-CURSOR                  24660017
246700             PERFORM 4130-PROCESS-PRIOR-RCVR-DISTRO               24670017
246800             PERFORM 4135-ARE-THERE-ANY-MORE                      24680017
246900             PERFORM 4150-CLOSE-PRIOR-RCVR-CURSOR                 24690017
247000                                                                  24700001
247100         END-IF                                                   24710001
247200     END-PERFORM.                                                 24720001
247300                                                                  24730001
247400     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           24740001
247500         MOVE +1                 TO ASC-BLK-SUB                   24750001
247600                                                                  24760001
247700         PERFORM 5100-WRITE-TEMP-STORAGE                          24770001
247800                                                                  24780001
247900         ADD +1                  TO ASC-BLK-SUB                   24790001
248000                                                                  24800001
248100         PERFORM 5100-WRITE-TEMP-STORAGE                          24810001
248200                                                                  24820001
248300         MOVE +1                 TO ASC-BLK-SUB                   24830001
248400                                    PV-BLOCK-NUMBER               24840001
248500                                                                  24850001
248600         PERFORM 4410-READ-TEMP-STORAGE                           24860001
248700                                                                  24870001
248800         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         24880001
248900             MOVE +2             TO ASC-BLK-SUB                   24890001
249000                                    PV-BLOCK-NUMBER               24900001
249100                                                                  24910001
249200             PERFORM 4410-READ-TEMP-STORAGE                       24920001
249300         END-IF                                                   24930001
249400     END-IF.                                                      24940001
249500                                                                  24950001
249600******************************************************************24960003
249700 4042-FETCH-RECDIS.                                               24970001
249800                                                                  24980001
249900     EXEC SQL                                                     24990001
250000          FETCH  RECDIS-CURSOR                                    25000001
250100           INTO :RECDIS-EXPTED-ITM-QTY,                           25010001
250200                :RECDIS-VERIFY-ITM-QTY,                           25020001
250300                :RECDIS-AP-VERIFY-ITM-QTY,                        25030001
250400                :RECDIS-STR-NBR                                   25040001
250500     END-EXEC.                                                    25050001
250600                                                                  25060001
250700     EVALUATE TRUE                                                25070001
250800         WHEN SQLCODE = ZERO                                      25080001
250900         WHEN SQLCODE = +100                                      25090001
251000              CONTINUE                                            25100001
251110         WHEN SQLCODE = -904                                      25111001
251200         WHEN SQLCODE = -911                                      25120001
251300         WHEN SQLCODE = -913                                      25130001
251400             PERFORM 9900-SOFT-ABORT                              25140001
251500         WHEN SQLWARN0 NOT = SPACES                               25150001
251600         WHEN SQLCODE  NOT = ZERO                                 25160001
251700              MOVE '4042-FETCH-RECDIS'                            25170001
251800                                 TO DP013-PARAGRAPH               25180001
251900              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          25190001
252000                                 TO DP013-MESSAGE-TEXT (1)        25200001
252100              MOVE SQLCA         TO DP013-SQLCA                   25210001
252200              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      25220001
252300              SET DP013-DB2-ABEND                                 25230001
252400                  DP013-XCTL-DISPLAY-RESTART                      25240001
252500                                 TO TRUE                          25250001
252600                                                                  25260001
252700              PERFORM DP013-0000-PROCESS-ABEND                    25270001
252800     END-EVALUATE.                                                25280001
252900                                                                  25290001
253000     IF SQLCODE = +100                                            25300001
253100         SET ASC-NO-MORE-RECDIS  TO TRUE                          25310001
253200     END-IF.                                                      25320001
253300                                                                  25330001
253400******************************************************************25340079
253500 4045-FETCH-RANK-RECDIS.                                          25350079
253600                                                                  25360079
253700     EXEC SQL                                                     25370079
253800          FETCH  RECDIS-RANK-CURSOR                               25380079
253900           INTO :RECDIS-EXPTED-ITM-QTY,                           25390079
254000                :RECDIS-VERIFY-ITM-QTY,                           25400079
254100                :RECDIS-AP-VERIFY-ITM-QTY,                        25410079
254200                :RECDIS-STR-NBR                                   25420079
254300     END-EXEC.                                                    25430079
254400                                                                  25440079
254500     EVALUATE TRUE                                                25450079
254600         WHEN SQLCODE = ZERO                                      25460079
254700         WHEN SQLCODE = +100                                      25470079
254800              CONTINUE                                            25480079
254910         WHEN SQLCODE = -904                                      25491079
255000         WHEN SQLCODE = -911                                      25500079
255100         WHEN SQLCODE = -913                                      25510079
255200             PERFORM 9900-SOFT-ABORT                              25520079
255300         WHEN SQLWARN0 NOT = SPACES                               25530079
255400         WHEN SQLCODE  NOT = ZERO                                 25540079
255500              MOVE '4045-FETCH-RANK-RECDIS'                       25550079
255600                                 TO DP013-PARAGRAPH               25560079
255700              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          25570079
255800                                 TO DP013-MESSAGE-TEXT (1)        25580079
255900              MOVE SQLCA         TO DP013-SQLCA                   25590079
256000              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      25600079
256100              SET DP013-DB2-ABEND                                 25610079
256200                  DP013-XCTL-DISPLAY-RESTART                      25620079
256300                                 TO TRUE                          25630079
256400                                                                  25640079
256500              PERFORM DP013-0000-PROCESS-ABEND                    25650079
256600     END-EVALUATE.                                                25660079
256700                                                                  25670079
256800     IF SQLCODE = +100                                            25680079
256900         SET ASC-NO-MORE-RECDIS  TO TRUE                          25690079
257000     END-IF.                                                      25700079
257100                                                                  25710079
257200******************************************************************25720079
257300 4050-CLOSE-CURSOR.                                               25730001
257400                                                                  25740001
257500     EXEC SQL                                                     25750001
257600          CLOSE RECDIS-CURSOR                                     25760001
257700     END-EXEC.                                                    25770001
257800                                                                  25780001
257900     EVALUATE TRUE                                                25790001
258000         WHEN SQLCODE = ZERO                                      25800001
258100              CONTINUE                                            25810001
258200         WHEN SQLCODE = -904                                      25820001
258300         WHEN SQLCODE = -911                                      25830001
258400         WHEN SQLCODE = -913                                      25840001
258500             PERFORM 9900-SOFT-ABORT                              25850001
258600         WHEN SQLWARN0 NOT = SPACES                               25860001
258700         WHEN SQLCODE  NOT = ZERO                                 25870001
258800              MOVE '4050-CLOSE-CURSOR'                            25880001
258900                                 TO DP013-PARAGRAPH               25890001
259000              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             25900001
259100                                 TO DP013-MESSAGE-TEXT (1)        25910001
259200              MOVE SQLCA         TO DP013-SQLCA                   25920001
259300              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      25930001
259400              SET DP013-DB2-ABEND                                 25940001
259500                  DP013-XCTL-DISPLAY-RESTART                      25950001
259600                                 TO TRUE                          25960001
259700                                                                  25970001
259800              PERFORM DP013-0000-PROCESS-ABEND                    25980001
259900     END-EVALUATE.                                                25990001
260000                                                                  26000001
260100******************************************************************26010079
260200 4055-CLOSE-RANK-CURSOR.                                          26020079
260300                                                                  26030079
260400     EXEC SQL                                                     26040079
260500          CLOSE RECDIS-RANK-CURSOR                                26050079
260600     END-EXEC.                                                    26060079
260700                                                                  26070079
260800     EVALUATE TRUE                                                26080079
260900         WHEN SQLCODE = ZERO                                      26090079
261000              CONTINUE                                            26100079
261100         WHEN SQLCODE = -904                                      26110079
261200         WHEN SQLCODE = -911                                      26120079
261300         WHEN SQLCODE = -913                                      26130079
261400             PERFORM 9900-SOFT-ABORT                              26140079
261500         WHEN SQLWARN0 NOT = SPACES                               26150079
261600         WHEN SQLCODE  NOT = ZERO                                 26160079
261700              MOVE '4055-CLOSE-CURSOR'                            26170079
261800                                 TO DP013-PARAGRAPH               26180079
261900              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             26190079
262000                                 TO DP013-MESSAGE-TEXT (1)        26200079
262100              MOVE SQLCA         TO DP013-SQLCA                   26210079
262200              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      26220079
262300              SET DP013-DB2-ABEND                                 26230079
262400                  DP013-XCTL-DISPLAY-RESTART                      26240079
262500                                 TO TRUE                          26250079
262600                                                                  26260079
262700              PERFORM DP013-0000-PROCESS-ABEND                    26270079
262800     END-EVALUATE.                                                26280079
262900                                                                  26290079
263000******************************************************************26300079
263100*  GET THE LOCATION DESCRIPTION FROM THE XLT_LOC  TABLE          *26310099
263200******************************************************************26320001
263300 4060-GET-LOCATION-DESC.                                          26330099
263400                                                                  26340001
263500     INITIALIZE XL071-COMMAREA-REC.                               26350099
263600                                                                  26360099
263700     MOVE ASC-KEY-OPER-UNT-ID   TO PV-UNPACK-OPER-UNT-ID.         26370099
263800     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         26380099
263900                                                                  26390099
264000     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    26400099
264100                                      XL071-COMMAREA              26410099
264200                                      XL071-COMMAREA-REC.         26420099
264210                                                                  26421099
264300     EVALUATE TRUE                                                26430099
264400         WHEN XL071-NO-ERRORS                                     26440099
264410             MOVE XL071-LOC-NM TO ASC-KEY-FCLTY-DESC              26441099
264500         WHEN XL071-LOC-NOT-FOUND                                 26450099
264600             MOVE SPACES         TO ASC-KEY-FCLTY-DESC            26460099
264700         WHEN XL071-SQLCODE-N = -904                              26470099
264800         WHEN XL071-SQLCODE-N = -911                              26480099
264900         WHEN XL071-SQLCODE-N = -913                              26490099
265000             PERFORM 9900-SOFT-ABORT                              26500099
265100         WHEN XL071-BAD-DB2-RETURN                                26510099
265400             MOVE '4060-GET-LOCATION-DESC' TO DP013-PARAGRAPH     26540099
265600             MOVE 'CALL XLKUT071' TO DP013-MESSAGE-TEXT (1)       26560099
265700             STRING 'LOCATION NBR: '    DELIMITED BY SIZE         26570099
265710                  XL071-LOCATION-NUMBER DELIMITED BY SIZE         26571099
265720                           INTO DP013-MESSAGE-TEXT(2)             26572099
265800             MOVE XL071-SQLCA     TO DP013-SQLCA                  26580099
265810             MOVE XL071-SQLCODE   TO SQLCODE                      26581099
265900             MOVE 'XLT_LOC'       TO DP013-DB2-TABLE-NAME (1)     26590099
266000             SET DP013-DB2-ABEND  TO TRUE                         26600099
266200             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               26620099
266400             PERFORM DP013-0000-PROCESS-ABEND                     26640099
266500     END-EVALUATE.                                                26650099
266600                                                                  26660001
266700******************************************************************26670003
266800 4070-GET-TRECEIV.                                                26680001
266900                                                                  26690001
267000*    EXEC SQL                                                     26700095
267100*         SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            26710095
267200*    END-EXEC.                                                    26720095
267300                                                                  26730001
267400     EXEC SQL                                                     26740001
267500          SELECT                                                  26750001
267600                  A.PACK_BY_ST_IND                                26760001
267700*               , A.ML_POST_TMST                                  26770095
267800*               , A.FS_POST_TMST                                  26780095
267900                , A.STATUS_CDE                                    26790001
268000                , A.PKGNG_CDE                                     26800099
268100*               , B.STATUS_CDE                                    26810095
268200            INTO                                                  26820001
268300                  :RECEIV-PACK-BY-ST-IND                          26830001
268400*               , :RECEIV-ML-POST-TMST                            26840099
268500*               , :RECEIV-FS-POST-TMST                            26850099
268600                , :RECEIV-STATUS-CDE                              26860001
268700                , :RECEIV-PKGNG-CDE                               26870099
268800*               , :RECITM-STATUS-CDE                              26880095
268900            FROM                                                  26890001
269000                  TRECEIV A                                       26900001
269100*               , TRECITM B                                       26910095
269200            WHERE                                                 26920001
269300                  A.ORD_NBR          = :DK-REC-NBR                26930003
269400              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            26940001
269500              AND A.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       26950001
269600              AND A.FCLTY_ID         = :ASC-KEY-FCLTY-ID          26960001
269700              AND A.VER_STATUS_CDE   = :PC-ACTIVE                 26970001
269800*             AND                                                 26980095
269900*                 B.ORD_NBR          = :DK-REC-NBR                26990095
270000*             AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            27000095
270100*             AND B.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       27010095
270200*             AND B.FCLTY_ID         = :ASC-KEY-FCLTY-ID          27020095
270300*             AND B.VER_STATUS_CDE   = :PC-ACTIVE                 27030095
270400*             AND B.ORD_LNE_NBR      = :DK-DRV-LNE-NBR            27040095
270500     END-EXEC.                                                    27050001
270600                                                                  27060001
270700     EVALUATE TRUE                                                27070001
270800         WHEN SQLCODE = ZERO                                      27080001
270900         WHEN SQLCODE = +100                                      27090001
271000              CONTINUE                                            27100001
271100         WHEN SQLCODE = -904                                      27110001
271200         WHEN SQLCODE = -911                                      27120001
271300         WHEN SQLCODE = -913                                      27130001
271400             PERFORM 9900-SOFT-ABORT                              27140001
271500         WHEN SQLWARN0 NOT = SPACES                               27150001
271600         WHEN SQLCODE  NOT = ZERO                                 27160001
271700             MOVE '4070-GET-TRECEIV'                              27170001
271800                                 TO DP013-PARAGRAPH               27180001
271900             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                27190001
272000                                 TO DP013-MESSAGE-TEXT (1)        27200001
272100             MOVE SQLCA         TO DP013-SQLCA                    27210001
272200             MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)       27220001
272300             MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)       27230001
272400             SET DP013-DB2-ABEND                                  27240001
272500                 DP013-XCTL-DISPLAY-RESTART                       27250001
272600                                 TO TRUE                          27260001
272700                                                                  27270001
272800             PERFORM DP013-0000-PROCESS-ABEND                     27280001
272900     END-EVALUATE.                                                27290001
273000                                                                  27300001
273100******************************************************************27310097
273200 4072-CHECK-RECITM-VERIFIED.                                      27320097
273300                                                                  27330097
273400     MOVE ZERO                        TO PV-DB2-COUNT             27340097
273500     EXEC SQL                                                     27350097
273600         SELECT COUNT (*)                                         27360097
273700             INTO   :PV-DB2-COUNT                                 27370097
273800             FROM  TRECITM                                        27380097
273900             WHERE  ORD_NBR          = :DK-REC-NBR                27390097
274000              AND   REC_SEQ_NBR      = :DK-REC-SEQ-NBR            27400097
274100              AND   OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       27410097
274200              AND   FCLTY_ID         = :ASC-KEY-FCLTY-ID          27420097
274300              AND   STATUS_CDE       = :PC-VE                     27430098
274400              AND   VER_STATUS_CDE   = :PC-ACTIVE                 27440097
274500              AND   PREPK_ID         = :ASC-KEY-PACK-ID           27450099
274600     END-EXEC.                                                    27460097
274700                                                                  27470097
274800     EVALUATE TRUE                                                27480097
274900         WHEN SQLCODE = ZERO                                      27490097
275000         WHEN SQLCODE = +100                                      27500097
275100         WHEN SQLCODE = -305                                      27510097
275200             CONTINUE                                             27520097
275300         WHEN SQLCODE = -904                                      27530097
275400         WHEN SQLCODE = -911                                      27540097
275500         WHEN SQLCODE = -913                                      27550097
275600             PERFORM 9900-SOFT-ABORT                              27560097
275700         WHEN SQLWARN0 NOT = SPACES                               27570097
275800         WHEN SQLCODE  NOT = ZERO                                 27580097
275900             MOVE '4072-CHECK-RECITM-VERIFIED'                    27590097
276000                               TO DP013-PARAGRAPH                 27600097
276100             MOVE 'UNSUCCESSFUL COUNT OF TRECITM'                 27610097
276200                               TO DP013-MESSAGE-TEXT (1)          27620097
276300             MOVE SQLCA     TO DP013-SQLCA                        27630097
276400             MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)           27640097
276500             SET DP013-DB2-ABEND                                  27650097
276600                 DP013-XCTL-DISPLAY-RESTART                       27660097
276700                                 TO TRUE                          27670097
276800             PERFORM DP013-0000-PROCESS-ABEND                     27680097
276900     END-EVALUATE.                                                27690097
277000                                                                  27700097
277100******************************************************************27710003
277200 4080-CHECK-RACF.                                                 27720001
277300                                                                  27730001
277400     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         27740001
277500     MOVE 'RCAPRLOC'              TO DP008-FUNCTION-NAME          27750001
277600     SET DP008-ACCESS-TYPE-USE    TO TRUE                         27760001
277700                                                                  27770001
277800     EXEC CICS                                                    27780001
277900         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 27790001
278000              COMMAREA (DP008-SECURITY-COMMAREA)                  27800001
278100              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             27810001
278200     END-EXEC                                                     27820001
278300                                                                  27830001
278400     IF DP008-CALL-SUCCESSFUL                                     27840001
278500         CONTINUE                                                 27850001
278600     ELSE                                                         27860001
278700         MOVE '4080-CHECK-RACF-ACCESS'                            27870001
278800                                     TO DP013-PARAGRAPH           27880001
278900         MOVE 'UNABLE TO ACCESS CICS'                             27890001
279000                                     TO DP013-MESSAGE-TEXT (1)    27900001
279100         MOVE SQLCA                  TO DP013-SQLCA               27910001
279200         SET DP013-DB2-ABEND                                      27920001
279300             DP013-XCTL-DISPLAY-RESTART                           27930001
279400                                     TO TRUE                      27940001
279500         PERFORM DP013-0000-PROCESS-ABEND                         27950001
279600     END-IF.                                                      27960001
279700                                                                  27970003
279800******************************************************************27980003
279900 4090-CHECK-FOR-SPLIT.                                            27990001
280000                                                                  28000001
280100     MOVE ZERO                        TO PV-DB2-COUNT             28010001
280200     EXEC SQL                                                     28020001
280300         SELECT COUNT (*)                                         28030001
280400             INTO   :PV-DB2-COUNT                                 28040001
280500             FROM  TDISTHD                                        28050001
280600         WHERE ORD_NBR          =  :DK-REC-NBR                    28060003
280700         AND   ORD_LNE_NBR      =  :DK-DRV-LNE-NBR                28070004
280800         AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR                28080001
280900         AND   TOT_CART_CNT     >  0                              28090001
280910         AND   CRE_USR_ID  NOT IN ('HOTCMPLT','TRLRUNLD')         28091099
281000     END-EXEC.                                                    28100001
281100                                                                  28110001
281200     EVALUATE TRUE                                                28120001
281300         WHEN SQLCODE = ZERO                                      28130001
281400         WHEN SQLCODE = +100                                      28140001
281500         WHEN SQLCODE = -305                                      28150001
281600             CONTINUE                                             28160001
281700         WHEN SQLCODE = -904                                      28170001
281800         WHEN SQLCODE = -911                                      28180001
281900         WHEN SQLCODE = -913                                      28190001
282000             PERFORM 9900-SOFT-ABORT                              28200001
282100         WHEN SQLWARN0 NOT = SPACES                               28210001
282200         WHEN SQLCODE  NOT = ZERO                                 28220001
282300             MOVE '4090-CHECK-FOR-SPLIT'                          28230001
282400                               TO DP013-PARAGRAPH                 28240001
282500             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                28250001
282600                               TO DP013-MESSAGE-TEXT (1)          28260001
282700             MOVE SQLCA     TO DP013-SQLCA                        28270001
282800             MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)           28280001
282900             SET DP013-DB2-ABEND                                  28290001
283000                 DP013-XCTL-DISPLAY-RESTART                       28300001
283100                                 TO TRUE                          28310001
283200             PERFORM DP013-0000-PROCESS-ABEND                     28320001
283300     END-EVALUATE.                                                28330001
283400                                                                  28340001
283500 4095-CALL-RCKUT128.                                              28350099
283600     MOVE ASC-KEY-OPER-UNT-ID  TO RC074-OPER-UNT-ID.              28360099
283700     MOVE ASC-KEY-FCLTY-ID     TO RC074-FCLTY-ID.                 28370099
283800     MOVE ASC-KEY-REC-NBR-N    TO RC074-PO-NBR.                   28380099
283900     MOVE ASC-KEY-PACK-ID      TO RC074-PACK-ID.                  28390099
284000     MOVE ASC-AUTO-VE-SW       TO RC074-AUTO-VE-SW.               28400099
284100     SET RC074-PACK-QTY-YES    TO TRUE.                           28410099
284200                                                                  28420099
284300     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 28430099
284400                                         RC074-COMMAREA           28440099
284500                                         RC074-FIELDS.            28450099
284600                                                                  28460099
284700     EVALUATE TRUE                                                28470099
284800         WHEN RC074-SUCCESSFUL                                    28480099
284900             CONTINUE                                             28490099
285000         WHEN OTHER                                               28500099
285100             MOVE '4095-CALL-RCKUT128'                            28510099
285200                                 TO DP013-PARAGRAPH               28520099
285300             STRING                                               28530099
285400                  'UNSUCCESSFUL CALL TO RCKUT128 '                28540099
285500                  'SUCCESS-IND = '                                28550099
285600                  RC074-SUCCESS-IND                               28560099
285700                               DELIMITED BY SIZE                  28570099
285800                               INTO DP013-MESSAGE-TEXT (1)        28580099
285900             MOVE RC074-CRA-RET-MSG                               28590099
286000                                 TO DP013-MESSAGE-TEXT (2)        28600099
286100             MOVE RC074-SQLCA    TO DP013-SQLCA                   28610099
286200             SET DP013-DB2-ABEND                                  28620099
286300                 DP013-XCTL-DISPLAY-RESTART                       28630099
286400                                 TO TRUE                          28640099
286500             PERFORM DP013-0000-PROCESS-ABEND                     28650099
286600     END-EVALUATE.                                                28660099
286700                                                                  28670099
286800*----------------------------------------------------------------*28680099
286900*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          28690099
287000*----------------------------------------------------------------*28700099
287100 4097-CHECK-AUTOVRFD.                                             28710099
287200                                                                  28720099
287300     INITIALIZE RC040-FIELDS.                                     28730099
287400     MOVE DP020-LOCATION      TO RC040-SIGNON-LOCATION.           28740099
287500     MOVE ASC-KEY-REC-NBR-N   TO RC040-PO-NBR.                    28750099
287600     MOVE ASC-KEY-REC-SEQ-NBR-N                                   28760099
287700                              TO RC040-PO-RCVR.                   28770099
287800     MOVE DP020-USERID        TO RC040-USER-ID.                   28780099
287900     MOVE 'RCKCS805'          TO RC040-CALLING-PROGRAM.           28790099
288000                                                                  28800099
288100     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  28810099
288200                                        RC040-COMMAREA            28820099
288300                                        RC040-FIELDS.             28830099
288400                                                                  28840099
288500     EVALUATE TRUE                                                28850099
288600         WHEN RC040-SUCCESSFUL                                    28860099
288700                 MOVE RC040-AUTO-VE-SW TO ASC-AUTO-VE-SW          28870099
288800         WHEN RC040-DATABASE-BUSY OR                              28880099
288900              RC040-INVALID-SQL                                   28890099
289000                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       28900099
289100                  SET DP020-MSG-WARNING TO TRUE                   28910099
289200                  SET DP030-OVERRIDE-GO TO TRUE                   28920099
289300         WHEN RC040-NOT-SUCCESSFUL                                28930099
289400                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       28940099
289500                  SET DP020-MSG-WARNING TO TRUE                   28950099
289600                  SET DP030-OVERRIDE-GO TO TRUE                   28960099
289700         WHEN OTHER                                               28970099
289800             MOVE '4097-CHECK-AUTOVRFD ' TO DP013-PARAGRAPH       28980099
289900             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              28990099
290000                                         TO DP013-MESSAGE-TEXT (1)29000099
290100             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)29010099
290200             MOVE RC040-SQLCA            TO DP013-SQLCA           29020099
290300             SET DP013-DB2-ABEND                                  29030099
290400                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              29040099
290500             PERFORM DP013-0000-PROCESS-ABEND                     29050099
290600     END-EVALUATE.                                                29060099
290700                                                                  29070099
290800******************************************************************29080001
290900*    GET THE PO-PREPK-ID TO PASS TO THE OTR ROUTINE (DPKCS277)    29090010
291000******************************************************************29100001
291100 4100-SELECT-PURITM-DATA.                                         29110001
291200                                                                  29120001
291300     EXEC SQL                                                     29130001
291400           SELECT AD_EVNT_DTE                                     29140001
291500                , PO_LNE_NBR                                      29150001
291700                , VEND_STYL_NAME                                  29170001
291800                , STATUS_CDE                                      29180001
291900                , UNT_QTY                                         29190001
292000                , PO_PREPK_ID                                     29200010
292100                , PREPK_RATO_QTY                                  29210010
292200             INTO :PURITM-AD-EVNT-DTE                             29220001
292300                , :PURITM-PO-LNE-NBR                              29230001
292500                , :PURITM-VEND-STYL-NAME                          29250001
292600                , :ASC-PURITM-STATUS-CDE                          29260001
292700                , :ASC-PURITM-UNT-QTY                             29270010
292800                , :ASC-PO-PREPK-ID                                29280010
292900                , :ASC-PO-PREPK-RATO-QTY                          29290013
293000             FROM TPURITM                                         29300001
293100            WHERE PO_NBR         = :DK-REC-NBR                    29310010
293200              AND APP_PO_LNE_NBR = :DK-DRV-LNE-NBR                29320004
293300              AND VER_STATUS_CDE = :PC-ACTIVE                     29330001
293400     END-EXEC                                                     29340001
293500                                                                  29350001
293600     EVALUATE TRUE                                                29360001
293700       WHEN SQLCODE = ZERO                                        29370006
293800       WHEN SQLCODE = +100                                        29380006
293900           CONTINUE                                               29390006
294000                                                                  29400006
294100       WHEN SQLCODE = -904                                        29410006
294200       WHEN SQLCODE = -911                                        29420006
294300       WHEN SQLCODE = -913                                        29430006
294400           PERFORM 9900-SOFT-ABORT                                29440006
294500                                                                  29450006
294600       WHEN SQLWARN0 NOT = SPACES                                 29460006
294700       WHEN SQLCODE NOT = ZERO                                    29470006
294800           MOVE '4100-SELECT-PURITM-DATA' TO DP013-PARAGRAPH      29480006
294900           MOVE 'UNSUCCESSFUL SELECT OF PURITM'                   29490006
295000                          TO DP013-MESSAGE-TEXT (1)               29500006
295100           MOVE SQLCA     TO DP013-SQLCA                          29510006
295200           MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)             29520006
295300           SET DP013-DB2-ABEND                                    29530006
295400               DP013-XCTL-DISPLAY-RESTART TO TRUE                 29540006
295500           PERFORM DP013-0000-PROCESS-ABEND                       29550006
295600     END-EVALUATE.                                                29560001
295700                                                                  29570001
295840******************************************************************29584001
295900*    SELECT RECEIVER ITEM DATA TO DISPLAY IN THE HEADER AREA      29590001
296000******************************************************************29600001
296100 4110-SELECT-RECITM-DATA.                                         29610001
296200                                                                  29620001
296300     INITIALIZE DCLTRECITM.                                       29630001
296400                                                                  29640001
296500     EXEC SQL                                                     29650001
296600         SELECT INNR_PACK_QTY,                                    29660013
296700                CASE_PACK_QTY,                                    29670013
296800                PKSL_ITM_QTY,                                     29680013
296900                DTL_CK_ITM_QTY,                                   29690013
297000                PREPK_ID,                                         29700013
297100                PREPK_RATO_QTY,                                   29710013
297200                CRE_TMST                                          29720013
297300           INTO :RECITM-INNR-PACK-QTY,                            29730013
297400                :RECITM-CASE-PACK-QTY,                            29740013
297500                :RECITM-PKSL-ITM-QTY,                             29750013
297600                :RECITM-DTL-CK-ITM-QTY,                           29760013
297700                :RECITM-PREPK-ID,                                 29770013
297800                :RECITM-PREPK-RATO-QTY,                           29780013
297900                :RECITM-CRE-TMST                                  29790013
298000           FROM TRECITM                                           29800013
298100          WHERE ORD_NBR        = :DK-REC-NBR                      29810013
298200            AND ORD_LNE_NBR    = :DK-DRV-LNE-NBR                  29820013
298300            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  29830013
298400            AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID             29840013
298500            AND FCLTY_ID       = :ASC-KEY-FCLTY-ID                29850013
298600            AND VER_STATUS_CDE = :PC-ACTIVE                       29860013
298700     END-EXEC.                                                    29870013
298800                                                                  29880001
298900     EVALUATE TRUE                                                29890001
299000       WHEN SQLCODE = ZERO                                        29900013
299100       WHEN SQLCODE = +100                                        29910013
299200           CONTINUE                                               29920013
299300                                                                  29930013
299400       WHEN SQLCODE = -904                                        29940013
299500       WHEN SQLCODE = -911                                        29950013
299600       WHEN SQLCODE = -913                                        29960013
299700           PERFORM 9900-SOFT-ABORT                                29970013
299800                                                                  29980013
299900       WHEN SQLWARN0 NOT = SPACES                                 29990013
300000       WHEN SQLCODE  NOT = ZEROES                                 30000013
300100           MOVE '4110-SELECT-RECITM-DATA' TO DP013-PARAGRAPH      30010013
300200           MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'       30020013
300300                TO DP013-MESSAGE-TEXT (1)                         30030013
300400           MOVE SQLCA     TO DP013-SQLCA                          30040013
300500           MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)             30050013
300600           SET DP013-DB2-ABEND                                    30060013
300700               DP013-XCTL-DISPLAY-RESTART TO TRUE                 30070013
300800           PERFORM DP013-0000-PROCESS-ABEND                       30080013
300900     END-EVALUATE.                                                30090013
301000                                                                  30100001
301100*    MOVE RECITM-INNR-PACK-QTY TO ASC-KEY-INNR-PACK-QTY.          30110099
301200     MOVE RECITM-CASE-PACK-QTY TO ASC-KEY-CASE-PACK-QTY.          30120011
301300                                                                  30130001
301400     MOVE RECITM-PREPK-ID      TO ASC-DSP-PACK-ID-N.              30140036
301500                                                                  30150011
301600*CONVERT 'UNIT QTY' TO 'PACK QTY'.                                30160034
301700     MOVE ZEROES TO ASC-KEY-EXPTD-PK-QTY.                         30170034
301800     IF RECITM-DTL-CK-ITM-QTY > 0                                 30180034
301900         MOVE RECITM-DTL-CK-ITM-QTY TO ASC-KEY-EXPTD-QTY          30190034
302000         IF RECITM-PREPK-RATO-QTY > 0                             30200034
302100             COMPUTE ASC-KEY-EXPTD-PK-QTY = RECITM-DTL-CK-ITM-QTY 30210034
302200                                          / RECITM-PREPK-RATO-QTY 30220034
302300         ELSE                                                     30230034
302400             MOVE ALL '*' TO ASC-KEY-EXPTD-PK-QTY-ZERO            30240034
302500     ELSE                                                         30250001
302600         MOVE RECITM-PKSL-ITM-QTY   TO ASC-KEY-EXPTD-QTY          30260034
302700         IF RECITM-PREPK-RATO-QTY > 0                             30270034
302800             COMPUTE ASC-KEY-EXPTD-PK-QTY = RECITM-PKSL-ITM-QTY   30280034
302900                                          / RECITM-PREPK-RATO-QTY 30290034
303000         ELSE                                                     30300034
303100             MOVE ALL '*' TO ASC-KEY-EXPTD-PK-QTY-ZERO            30310034
303200     END-IF.                                                      30320001
303300                                                                  30330001
303400*4115-SELECT-RECITM-DATA.                                         30340099
303500*    INITIALIZE RC074-FIELDS.                                     30350099
303600*    MOVE ASC-KEY-REC-SEQ-NBR-N    TO RC074-RCVR-SEQ-NBR.         30360099
303700*    PERFORM 4095-CALL-RCKUT128.                                  30370099
303800*    MOVE RC074-TOTAL-EXPT-PACK-QTY                               30380099
303900*                               TO ASC-KEY-EXPTD-PK-QTY.          30390099
304000******************************************************************30400003
304100 4120-OPEN-PRIOR-RCVR-CURSOR.                                     30410001
304200                                                                  30420001
304300     EXEC SQL                                                     30430001
304400          OPEN PRIOR-RCVR-CURSOR                                  30440001
304500     END-EXEC                                                     30450001
304600                                                                  30460001
304700     EVALUATE TRUE                                                30470001
304800         WHEN SQLCODE = ZERO                                      30480001
304900              CONTINUE                                            30490001
305000         WHEN SQLCODE = -904                                      30500001
305100         WHEN SQLCODE = -911                                      30510001
305200         WHEN SQLCODE = -913                                      30520001
305300              PERFORM 9900-SOFT-ABORT                             30530001
305400         WHEN SQLWARN0 NOT = SPACES                               30540001
305500         WHEN SQLCODE      NOT = ZERO                             30550001
305600              MOVE '4120-OPEN-PRIOR-RCVR-CURSOR'                  30560001
305700                             TO DP013-PARAGRAPH                   30570001
305800              MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR OPEN'          30580001
305900                             TO DP013-MESSAGE-TEXT (1)            30590001
306000              MOVE SQLCA         TO DP013-SQLCA                   30600001
306100              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          30610001
306200              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (2)          30620001
306300              SET DP013-XCTL-DISPLAY-RESTART                      30630001
306400                  DP013-DB2-ABEND                                 30640001
306500                             TO TRUE                              30650001
306600                                                                  30660001
306700              PERFORM DP013-0000-PROCESS-ABEND                    30670001
306800     END-EVALUATE.                                                30680001
306900                                                                  30690001
307000******************************************************************30700003
307100 4130-PROCESS-PRIOR-RCVR-DISTRO.                                  30710001
307200                                                                  30720001
307300     PERFORM 4140-FETCH-PRIOR-RCVR.                               30730001
307400     IF SQLCODE = +0                                              30740001
307500         MOVE RECEIV-STATUS-CDE                                   30750017
307600           TO ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)               30760017
307700                                                                  30770017
307800         IF ASC-AUTO-VE-YES                                       30780099
307900             IF RECEIV-PKGNG-CDE = 'I' OR 'M'                     30790099
308000                INITIALIZE RC074-FIELDS                           30800099
308100                MOVE RECEIV-REC-SEQ-NBR                           30810099
308200                                      TO RC074-RCVR-SEQ-NBR       30820099
308300                MOVE RECDIS-STR-NBR   TO RC074-STR-NBR            30830099
308400                PERFORM 4095-CALL-RCKUT128                        30840099
308500                IF RECITM-STATUS-CDE = PC-VE                      30850099
308600                    MOVE RC074-VERIFY-PACK-QTY TO                 30860099
308700                       ASC-LAST-QTY-REC-N                         30870099
308800                       (ASC-BLK-SUB ASC-ITEM-SUB)                 30880099
308900                ELSE                                              30890099
309000                    MOVE RC074-TOTAL-ACTL-PACK-QTY TO             30900099
309100                       ASC-LAST-QTY-REC-N                         30910099
309200                       (ASC-BLK-SUB ASC-ITEM-SUB)                 30920099
309300                END-IF                                            30930099
309400             ELSE                                                 30940099
309500                MOVE ALL '*' TO ASC-LAST-QTY-REC                  30950099
309600                    (ASC-BLK-SUB ASC-ITEM-SUB)                    30960099
309700             END-IF                                               30970099
309800         ELSE                                                     30980099
309900*CONVERT RECDIS-AP-VERIFY-ITM-QTY (IP/VE 1) TO PACK QTY.          30990099
310000             IF RECITM-PREPK-RATO-QTY > 0                         31000099
310100                 IF RECITM-STATUS-CDE = PC-VE                     31010099
310200                     COMPUTE PV-LAST-QTY-PK                       31020099
310300                         = RECDIS-AP-VERIFY-ITM-QTY               31030017
310400                         / RECITM-PREPK-RATO-QTY                  31040017
310500                     MOVE PV-LAST-QTY-PK TO ASC-LAST-QTY-REC-N    31050099
310600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   31060017
310700                 ELSE                                             31070099
310800                     COMPUTE PV-LAST-QTY-PK                       31080099
310900                         = RECDIS-VERIFY-ITM-QTY                  31090017
311000                         / RECITM-PREPK-RATO-QTY                  31100017
311100                     MOVE PV-LAST-QTY-PK TO ASC-LAST-QTY-REC-N    31110099
311200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   31120017
311300             ELSE                                                 31130099
311400                 MOVE ALL '*' TO ASC-LAST-QTY-REC                 31140099
311500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   31150017
311600             END-IF                                               31160099
311700         END-IF                                                   31170099
311800                                                                  31180017
311900         IF PV-DB2-DATE-FORMAT = '9999-09-09'                     31190001
312000              MOVE 'ENRTE '                                       31200017
312100                TO ASC-LAST-DTE-REC (ASC-BLK-SUB ASC-ITEM-SUB)    31210017
312200         ELSE                                                     31220001
312300             MOVE PV-DB2-DATE-FORMAT TO PV-DB2-DATE-FORMAT-REDE   31230017
312400             MOVE PV-DB2-MM TO PV-SCREEN-DATE-MM                  31240017
312500             MOVE PV-DB2-DD TO PV-SCREEN-DATE-DD                  31250017
312600             MOVE PV-DB2-YY TO PV-SCREEN-DATE-YY                  31260017
312700             MOVE PV-SCREEN-DATE-FORMAT                           31270001
312800               TO ASC-LAST-DTE-REC (ASC-BLK-SUB ASC-ITEM-SUB)     31280017
312900         END-IF                                                   31290001
313000                                                                  31300017
313100         PERFORM 4140-FETCH-PRIOR-RCVR                            31310001
313200         IF SQLCODE = +0                                          31320001
313300             MOVE RECEIV-STATUS-CDE                               31330018
313400               TO ASC-STATUS-2 (ASC-BLK-SUB ASC-ITEM-SUB)         31340018
313500             IF ASC-AUTO-VE-YES                                   31350099
313600                IF RECEIV-PKGNG-CDE = 'I' OR 'M'                  31360099
313700                   INITIALIZE RC074-FIELDS                        31370099
313800                   MOVE RECEIV-REC-SEQ-NBR                        31380099
313900                                       TO RC074-RCVR-SEQ-NBR      31390099
314000                   MOVE RECDIS-STR-NBR   TO RC074-STR-NBR         31400099
314100                   PERFORM 4095-CALL-RCKUT128                     31410099
314200                   IF RECITM-STATUS-CDE = PC-VE                   31420099
314300                     MOVE RC074-VERIFY-PACK-QTY TO                31430099
314400                       ASC-PRIOR-QTY-REC-N                        31440099
314500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31450099
314600                   ELSE                                           31460099
314700                       MOVE RC074-TOTAL-ACTL-PACK-QTY TO          31470099
314800                         ASC-PRIOR-QTY-REC-N                      31480099
314900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31490099
315000                   END-IF                                         31500099
315100                ELSE                                              31510099
315200                   MOVE ALL '*' TO ASC-PRIOR-QTY-REC              31520099
315300                      (ASC-BLK-SUB ASC-ITEM-SUB)                  31530099
315400                END-IF                                            31540099
315500             ELSE                                                 31550099
315600                                                                  31560018
315700*CONVERT RECDIS-AP-VERIFY-ITM-QTY (IP/VE 2) TO PACK QTY.          31570017
315800                 IF RECITM-PREPK-RATO-QTY > 0                     31580099
315900                     IF RECITM-STATUS-CDE = PC-VE                 31590099
316000                         COMPUTE PV-PRIOR-QTY-PK                  31600099
316100                             = RECDIS-AP-VERIFY-ITM-QTY           31610018
316200                             / RECITM-PREPK-RATO-QTY              31620018
316300                         MOVE PV-PRIOR-QTY-PK TO                  31630099
316400                                    ASC-PRIOR-QTY-REC-N           31640099
316500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31650018
316600                     ELSE                                         31660099
316700                         COMPUTE PV-PRIOR-QTY-PK                  31670099
316800                             = RECDIS-VERIFY-ITM-QTY              31680018
316900                             / RECITM-PREPK-RATO-QTY              31690018
317000                         MOVE PV-PRIOR-QTY-PK TO                  31700099
317100                                    ASC-PRIOR-QTY-REC-N           31710099
317200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31720018
317300                 ELSE                                             31730099
317400                     MOVE ALL '*' TO ASC-PRIOR-QTY-REC            31740099
317500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31750018
317600                 END-IF                                           31760099
317700             END-IF                                               31770099
317800                                                                  31780018
317900             IF PV-DB2-DATE-FORMAT = '9999-09-09'                 31790001
318000                  MOVE 'ENRTE ' TO ASC-PRIOR-DTE-REC              31800018
318100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31810001
318200             ELSE                                                 31820001
318300                 MOVE PV-DB2-DATE-FORMAT                          31830001
318400                                TO PV-DB2-DATE-FORMAT-REDE        31840018
318500                 MOVE PV-DB2-MM TO PV-SCREEN-DATE-MM              31850018
318600                 MOVE PV-DB2-DD TO PV-SCREEN-DATE-DD              31860018
318700                 MOVE PV-DB2-YY TO PV-SCREEN-DATE-YY              31870018
318800                 MOVE PV-SCREEN-DATE-FORMAT                       31880001
318900                                TO ASC-PRIOR-DTE-REC              31890018
319000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31900001
319100             END-IF                                               31910001
319200         END-IF                                                   31920001
319300     END-IF.                                                      31930001
319400                                                                  31940001
319500******************************************************************31950003
319600 4135-ARE-THERE-ANY-MORE.                                         31960001
319700     IF SQLCODE = ZERO                                            31970001
319800*  THIS IS THE RETURN CODE FROM THE SECOND FETCH                  31980001
319900         PERFORM 4140-FETCH-PRIOR-RCVR                            31990001
320000         IF SQLCODE = ZERO                                        32000001
320100             MOVE 'Y'               TO ASC-MORE                   32010001
320200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32020001
320300         END-IF                                                   32030001
320400     END-IF.                                                      32040001
320500                                                                  32050001
320600******************************************************************32060003
320700 4140-FETCH-PRIOR-RCVR.                                           32070001
320800                                                                  32080001
320900     EXEC SQL                                                     32090001
321000          FETCH  PRIOR-RCVR-CURSOR                                32100001
321100           INTO :PV-DB2-DATE-FORMAT,                              32110001
321200                :RECEIV-STATUS-CDE,                               32120001
321300                :RECDIS-EXPTED-ITM-QTY,                           32130001
321400                :RECDIS-VERIFY-ITM-QTY,                           32140001
321500                :RECDIS-AP-VERIFY-ITM-QTY,                        32150001
321600                :RECITM-STATUS-CDE,                               32160017
321700                :RECITM-PREPK-RATO-QTY,                           32170099
321800                :RECEIV-REC-SEQ-NBR,                              32180099
321900                :RECEIV-PKGNG-CDE                                 32190099
322000     END-EXEC.                                                    32200001
322100                                                                  32210001
322200     EVALUATE TRUE                                                32220001
322300         WHEN SQLCODE = ZERO                                      32230001
322400         WHEN SQLCODE = +100                                      32240001
322500              CONTINUE                                            32250001
322501                                                                  32250199
322610         WHEN SQLCODE = -904                                      32261001
322700         WHEN SQLCODE = -911                                      32270001
322800         WHEN SQLCODE = -913                                      32280001
322900              PERFORM 9900-SOFT-ABORT                             32290001
323000         WHEN SQLWARN0 NOT = SPACES                               32300001
323100         WHEN SQLCODE  NOT = ZERO                                 32310001
323200              MOVE '4140-FETCH-PRIOR-RCVR'                        32320001
323300                                 TO DP013-PARAGRAPH               32330001
323400              MOVE 'UNSUCCESSFUL FETCH OF PRIOR RCVR CURSOR'      32340001
323500                                 TO DP013-MESSAGE-TEXT (1)        32350001
323600              MOVE SQLCA         TO DP013-SQLCA                   32360001
323700              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      32370001
323800              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (2)      32380001
323900              SET DP013-DB2-ABEND                                 32390001
324000                  DP013-XCTL-DISPLAY-RESTART                      32400001
324100                                 TO TRUE                          32410001
324200                                                                  32420001
324300              PERFORM DP013-0000-PROCESS-ABEND                    32430001
324400     END-EVALUATE.                                                32440001
324500                                                                  32450001
324600******************************************************************32460003
324700 4150-CLOSE-PRIOR-RCVR-CURSOR.                                    32470001
324800                                                                  32480001
324900     EXEC SQL                                                     32490001
325000          CLOSE PRIOR-RCVR-CURSOR                                 32500001
325100     END-EXEC.                                                    32510001
325200                                                                  32520001
325300     EVALUATE TRUE                                                32530001
325400         WHEN SQLCODE = ZERO                                      32540001
325500              CONTINUE                                            32550001
325600         WHEN SQLCODE = -904                                      32560001
325700         WHEN SQLCODE = -911                                      32570001
325800         WHEN SQLCODE = -913                                      32580001
325900              PERFORM 9900-SOFT-ABORT                             32590001
326000         WHEN SQLWARN0 NOT = SPACES                               32600001
326100         WHEN SQLCODE  NOT = ZERO                                 32610001
326200              MOVE '4150-CLOSE-PRIOR-RCVR-CURSOR'                 32620001
326300                                 TO DP013-PARAGRAPH               32630001
326400              MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR CLOSE'         32640001
326500                                 TO DP013-MESSAGE-TEXT (1)        32650001
326600              MOVE SQLCA         TO DP013-SQLCA                   32660001
326700              MOVE 'TRECEIV '    TO DP013-DB2-TABLE-NAME (1)      32670001
326800              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (2)      32680001
326900              SET DP013-DB2-ABEND                                 32690001
327000                  DP013-XCTL-DISPLAY-RESTART                      32700001
327100                                 TO TRUE                          32710001
327200                                                                  32720001
327300              PERFORM DP013-0000-PROCESS-ABEND                    32730001
327400     END-EVALUATE.                                                32740001
327500                                                                  32750001
327600******************************************************************32760001
327700*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       32770001
327800******************************************************************32780010
327900 4200-CALC-OPEN-TO-REC.                                           32790001
328000                                                                  32800001
328100*ONE LINE & ALL STORES OTR DATA.                                  32810010
328200     SET DP277-STORE-LEVEL-OTR TO TRUE.                           32820010
328300                                                                  32830010
328400*PROCESS ALL RECEIVERS.                                           32840020
328500     SET DP277-RECEIVER-OTR    TO TRUE.                           32850031
328600                                                                  32860001
328700     INITIALIZE DP277-KEYS.                                       32870010
328800                                                                  32880010
328900     MOVE DK-REC-NBR           TO DP277-PO-NBR.                   32890010
329000     MOVE DK-DRV-LNE-NBR       TO DP277-PO-LNE-NBR.               32900010
329100     MOVE DK-REC-SEQ-NBR       TO DP277-REC-SEQ-NBR.              32910010
329200     MOVE ASC-PO-PREPK-ID      TO DP277-PO-PREPK-ID.              32920010
329300     MOVE ASC-KEY-OPER-UNT-ID  TO DP277-OPER-UNT-ID.              32930010
329400     MOVE ASC-KEY-FCLTY-ID     TO DP277-FCLTY-ID.                 32940010
329500                                                                  32950001
329600     COPY DPPD277.                                                32960099
329700                                                                  32970003
329800******************************************************************32980007
329900 4400-MOVE-COMMAREA-TO-SCREEN.                                    32990001
330000                                                                  33000001
330100     IF (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))              33010007
330200       AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))            33020007
330300       OR (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))             33030007
330400                                                                  33040007
330500         MOVE +1 TO ASC-BLK-SUB                                   33050007
330600         PERFORM 5100-WRITE-TEMP-STORAGE                          33060007
330700                                                                  33070007
330800         ADD  +1 TO ASC-BLK-SUB                                   33080007
330900         PERFORM 5100-WRITE-TEMP-STORAGE                          33090007
331000                                                                  33100001
331100         DIVIDE PV-TOP-ITEM                                       33110007
331200             BY PC-ITEMS-PER-PANEL                                33120007
331300         GIVING PV-BLOCK-NUMBER                                   33130007
331400                REMAINDER PV-REMAINDER                            33140007
331500                                                                  33150007
331600         IF PV-REMAINDER > ZERO                                   33160007
331700             ADD +1 TO PV-BLOCK-NUMBER                            33170007
331800         END-IF                                                   33180007
331900                                                                  33190007
332000         MOVE +1 TO ASC-BLK-SUB                                   33200007
332100         PERFORM 4410-READ-TEMP-STORAGE                           33210007
332200                                                                  33220001
332300         ADD  +1 TO ASC-BLK-SUB                                   33230007
332400                    PV-BLOCK-NUMBER                               33240007
332500         PERFORM 4410-READ-TEMP-STORAGE                           33250007
332600                                                                  33260001
332700     END-IF.                                                      33270001
332800                                                                  33280001
332900     MOVE +1 TO ASC-BLK-SUB.                                      33290007
333000     COMPUTE ASC-ITEM-SUB =                                       33300001
333100             ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))          33310007
333200                           + PC-ITEMS-PER-PANEL).                 33320007
333300                                                                  33330001
333400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         33340001
333500         ADD  +1 TO ASC-BLK-SUB                                   33350007
333600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33360001
333700     END-IF.                                                      33370001
333800                                                                  33380001
333900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           33390001
334000             ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).            33400007
334100                                                                  33410001
334200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33420001
334300                                                                  33430001
334400*MOVE DETAIL LINES TO SCREEN                                      33440007
334500     PERFORM 4420-FORMAT-LIST-LINES                               33450001
334600       VARYING PV-SUB FROM PC-ITEMS-PER-PANEL BY -1               33460007
334700         UNTIL PV-SUB < +1.                                       33470007
334800                                                                  33480001
334900     COMPUTE ASC-ITEMS-DISPLAYED =                                33490001
335000             ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).      33500007
335100                                                                  33510007
335200*MOVE HEADER FIELDS TO SCREEN                                     33520007
335300     MOVE ASC-KEY-OPER-UNT-ID        TO PV-KEY-OPER-UNT-ID.       33530010
335400     MOVE PV-KEY-OPER-UNT-ID         TO AOPERO.                   33540010
335500     MOVE PC-DASH                    TO ASC-KEY-REC-DASH.         33550007
335600     MOVE ASC-KEY-RECEIVER           TO ARCVRO.                   33560007
335700                                                                  33570007
335800     MOVE PV-TOP-ITEM                TO ASC-ITEM-AT-TOP-OF-PANEL  33580007
335900                                        ASTRTITO.                 33590007
336000     MOVE ASC-ITEM-AT-BOT-OF-PANEL   TO AENDITO.                  33600007
336100     MOVE ASC-NUMBER-OF-ITEMS-READ   TO ATOTITO.                  33610007
336200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                33620007
336300                                                                  33630001
336400     MOVE ASC-KEY-VENDOR-NAME        TO AVENDO.                   33640007
336500     MOVE ASC-KEY-DEPT-NBR           TO ADEPTO.                   33650007
336600                                                                  33660007
336700     MOVE SPACES                     TO ASC-DSP-PACK-1            33670036
336800                                        ASC-DSP-PACK-2.           33680036
336900     MOVE PC-DASH                    TO ASC-DSP-PACK-DASH.        33690036
337000     MOVE ASC-DSP-PACK               TO APKTYO.                   33700036
337100     MOVE ASC-KEY-PACK-DESC          TO APKDESCO.                 33710007
337200                                                                  33720007
337300     IF ASC-KEY-EXPTD-PK-QTY-ZERO = ALL '*'                       33730034
337400         MOVE ' ******'              TO ARQTYO                    33740057
337500     ELSE                                                         33750034
337600         MOVE ASC-KEY-EXPTD-PK-QTY   TO PC-EDIT-MASK              33760061
337700         MOVE PC-EDIT-MASK           TO ARQTYO                    33770061
337800     END-IF.                                                      33780034
337900                                                                  33790034
338000     MOVE ASC-KEY-ALLOC-PK-QTY       TO ADQTYO.                   33800007
338100                                                                  33810070
338200     IF ASC-KEY-PACK-OTR = ALL '*'                                33820059
338300         MOVE ASC-KEY-PACK-OTR       TO ATOTRO                    33830059
338400     ELSE                                                         33840059
338500         MOVE ASC-KEY-PACK-OTR-N     TO ATOTRO.                   33850059
338600                                                                  33860007
338700     MOVE ASC-KEY-CASE-PACK-QTY      TO AOUTRO.                   33870007
338800     MOVE ASC-KEY-INNR-PACK-QTY      TO AINNRO.                   33880007
338900                                                                  33890001
339000     IF DP020-MSG-NUMBER-X = SPACE                                33900001
339100         IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ   33910006
339200             MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER             33920006
339300             SET DP020-MSG-INFORMATIONAL TO TRUE                  33930006
339400         END-IF                                                   33940006
339500     END-IF.                                                      33950001
339600                                                                  33960001
339700******************************************************************33970006
339800 4410-READ-TEMP-STORAGE.                                          33980001
339900                                                                  33990001
340000     EXEC CICS READQ TS                                           34000001
340100               QUEUE (ASC-LIST-QUEUE-NAME)                        34010001
340200               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            34020001
340300               ITEM  (PV-BLOCK-NUMBER)                            34030001
340400               RESP  (PV-CICS-RESP)                               34040001
340500     END-EXEC.                                                    34050001
340600                                                                  34060001
340700     IF ((PV-CICS-RESP = DFHRESP (NORMAL))                        34070007
340800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     34080007
340900         CONTINUE                                                 34090001
341000     ELSE                                                         34100001
341100         SET DP013-CICS-ABEND                                     34110001
341200             DP013-NO-ROLLBACK TO TRUE                            34120007
341300         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         34130007
341400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   34140001
341500              TO DP013-MESSAGE-TEXT (1)                           34150007
341600         PERFORM DP013-0000-PROCESS-ABEND                         34160001
341700     END-IF.                                                      34170001
341800                                                                  34180001
341900     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB) TO TRUE.            34190007
342000                                                                  34200001
342100     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          34210001
342200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               34220001
342300     END-IF.                                                      34230001
342400                                                                  34240001
342500******************************************************************34250010
342600 4420-FORMAT-LIST-LINES.                                          34260001
342700                                                                  34270001
342800     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       34280001
342900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                34290001
343000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     34300001
343100                                    MR-STR-QTY-A     (PV-SUB)     34310001
343200         MOVE DP015-BLUE         TO MR-STR-NBR-C     (PV-SUB)     34320001
343300         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     34330001
343400                                    MR-STR-QTY       (PV-SUB)     34340001
343500                                    MR-STR-NBR       (PV-SUB)     34350001
343600                                    MR-EXPTED-ITM-QTY(PV-SUB)     34360001
343700                                    MR-OTR-QTY       (PV-SUB)     34370017
343800                                    MR-ORDER-QTY     (PV-SUB)     34380001
343900                                    MR-VERFD-QTY     (PV-SUB)     34390001
344000                                    MR-STATUS        (PV-SUB)     34400001
344100                                    MR-STATUS2       (PV-SUB)     34410001
344200                                    MR-LAST-QTY-REC  (PV-SUB)     34420001
344300                                    MR-LAST-DTE-REC  (PV-SUB)     34430001
344400                                    MR-PRIOR-QTY-REC (PV-SUB)     34440001
344500                                    MR-PRIOR-DTE-REC (PV-SUB)     34450001
344600                                    MR-MORE          (PV-SUB)     34460001
344700     ELSE                                                         34470001
344800         IF ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE34480007
344900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 34490001
345000                  TO MR-SELECTI (PV-SUB)                          34500007
345100         ELSE                                                     34510001
345200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34520001
345300                  TO MR-SELECTI (PV-SUB)                          34530007
345400         END-IF                                                   34540001
345500                                                                  34550001
345600         IF DP030-SET-CURSOR-TRAILER                              34560001
345700             IF ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB) >  34570007
345800                                                             SPACE34580001
345900               OR PV-SUB = 1                                      34590001
346000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34600007
346100                 MOVE -1 TO MR-SELECTL (PV-SUB)                   34610007
346200             END-IF                                               34620007
346300         END-IF                                                   34630001
346400                                                                  34640001
346500         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            34650001
346600             IF (ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES) 34660007
346700               OR (MR-SELECTI (PV-SUB) = SPACES)                  34670007
346800                 MOVE SPACES TO MR-STR-QTY (PV-SUB)               34680007
346900             ELSE                                                 34690001
347000                 MOVE ASC-STR-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    34700007
347100                      TO MR-STR-QTY-EDITED (PV-SUB)               34710007
347200             END-IF                                               34720001
347300             IF ASC-EXPTED-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB) NUMERIC34730069
347400               AND ASC-EXPTED-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) >  34740069
347500                          ASC-OTR-N (ASC-BLK-SUB ASC-ITEM-SUB)    34750069
347600                 MOVE DP015-YELLOW TO MR-STR-NBR-C (PV-SUB)       34760007
347700             ELSE                                                 34770001
347800                 MOVE DP015-BLUE   TO MR-STR-NBR-C (PV-SUB)       34780007
347900             END-IF                                               34790001
348000             MOVE ASC-STR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          34800007
348100               TO MR-STR-NBR (PV-SUB)                             34810017
348200                                                                  34820020
348300             IF ASC-EXPTED-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =       34830017
348400                                                          ALL '*' 34840017
348500                 MOVE ASC-EXPTED-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   34850017
348600                   TO MR-EXPTED-ITM-QTY (PV-SUB)                  34860017
348700             ELSE                                                 34870017
348800                 MOVE ASC-EXPTED-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) 34880017
348900                   TO MR-EXPTED-ITM-QTY-EDITED (PV-SUB)           34890017
349000             END-IF                                               34900017
349100             IF ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB) = ALL '*'      34910017
349200***              MOVE ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB)          34920054
349300                 MOVE ' *****' TO MR-OTR-QTY (PV-SUB)             34930054
349400             ELSE                                                 34940017
349500                 MOVE ASC-OTR-N (ASC-BLK-SUB ASC-ITEM-SUB)        34950017
349600                   TO MR-OTR-QTY-EDITED (PV-SUB)                  34960017
349700             END-IF                                               34970017
349800             IF ASC-ORDERED-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =      34980017
349900                                                          ALL '*' 34990017
350000***              MOVE ASC-ORDERED-QTY (ASC-BLK-SUB ASC-ITEM-SUB)  35000055
350100                 MOVE ' *****' TO MR-ORDER-QTY (PV-SUB)           35010055
350200             ELSE                                                 35020017
350300                 MOVE ASC-ORDERED-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)35030017
350400                   TO MR-ORDER-QTY-EDITED (PV-SUB)                35040017
350500             END-IF                                               35050017
350600             IF ASC-VERFD-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = ALL '*'35060017
350700                 MOVE ASC-VERFD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    35070017
350800                   TO MR-VERFD-QTY (PV-SUB)                       35080018
350900             ELSE                                                 35090017
351000                 MOVE ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)  35100017
351100                   TO MR-VERFD-QTY-EDITED (PV-SUB)                35110018
351200             END-IF                                               35120017
351300                                                                  35130017
351400             MOVE ASC-STATUS         (ASC-BLK-SUB ASC-ITEM-SUB)   35140001
351500                                 TO MR-STATUS          (PV-SUB)   35150001
351600             MOVE ASC-STATUS-2       (ASC-BLK-SUB ASC-ITEM-SUB)   35160001
351700                                 TO MR-STATUS2         (PV-SUB)   35170001
351800             MOVE ASC-MORE           (ASC-BLK-SUB ASC-ITEM-SUB)   35180001
351900                                 TO MR-MORE            (PV-SUB)   35190001
352000                                                                  35200018
352100             IF ASC-LAST-QTY-REC (ASC-BLK-SUB ASC-ITEM-SUB) =     35210018
352200                                                           ALL '*'35220018
352300                 MOVE ASC-LAST-QTY-REC (ASC-BLK-SUB ASC-ITEM-SUB) 35230018
352400                   TO MR-LAST-QTY-REC (PV-SUB)                    35240018
352500             ELSE                                                 35250018
352600                 MOVE ASC-LAST-QTY-REC-N(ASC-BLK-SUB ASC-ITEM-SUB)35260018
352700                   TO MR-LAST-QTY-REC-EDITED (PV-SUB)             35270018
352800             END-IF                                               35280018
352900                                                                  35290018
353000             MOVE ASC-LAST-DTE-REC (ASC-BLK-SUB ASC-ITEM-SUB)     35300018
353100               TO MR-LAST-DTE-REC (PV-SUB)                        35310018
353200                                                                  35320018
353300             IF ASC-PRIOR-QTY-REC (ASC-BLK-SUB ASC-ITEM-SUB) =    35330018
353400                                                           ALL '*'35340018
353500                 MOVE ASC-PRIOR-QTY-REC (ASC-BLK-SUB ASC-ITEM-SUB)35350018
353600                   TO MR-PRIOR-QTY-REC (PV-SUB)                   35360018
353700             ELSE                                                 35370018
353800                 MOVE ASC-PRIOR-QTY-REC-N                         35380018
353900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35390018
354000                   TO MR-PRIOR-QTY-REC-EDITED (PV-SUB)            35400018
354100             END-IF                                               35410018
354200                                                                  35420018
354300             MOVE ASC-PRIOR-DTE-REC  (ASC-BLK-SUB ASC-ITEM-SUB)   35430001
354400                                 TO MR-PRIOR-DTE-REC   (PV-SUB)   35440001
354500         END-IF                                                   35450001
354600     END-IF.                                                      35460001
354700                                                                  35470099
354800     PERFORM 4440-UNCONFIRMED-PACK-CHECK.                         35480099
354900                                                                  35490001
355000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               35500001
355100                                                                  35510001
355200     IF ASC-ITEM-SUB < +1                                         35520001
355300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35530001
355400         MOVE +1                 TO ASC-BLK-SUB.                  35540001
355500                                                                  35550001
355600******************************************************************35560006
355700 4430-CHECK-FOR-BEGIN-AND-END.                                    35570001
355800                                                                  35580001
355900     IF ASC-START-OF-SELECTED-RANGE > ZERO                        35590001
356000        IF ASC-END-OF-SELECTED-RANGE = ZERO                       35600001
356100            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              35610001
356200            SET DP020-MSG-WARNING                                 35620001
356300                                 TO TRUE                          35630001
356400                                                                  35640001
356500            PERFORM 4431-POSITION-AT-WARNING                      35650001
356600                                                                  35660001
356700         END-IF                                                   35670001
356800     ELSE                                                         35680001
356900         IF ASC-END-OF-SELECTED-RANGE > ZERO                      35690001
357000             MOVE PC-TSYMSG-00053                                 35700001
357100                                 TO DP020-MSG-NUMBER              35710001
357200             SET DP020-MSG-WARNING                                35720001
357300                                 TO TRUE                          35730001
357400                                                                  35740001
357500             PERFORM 4431-POSITION-AT-WARNING                     35750001
357600                                                                  35760001
357700         END-IF                                                   35770001
357800     END-IF.                                                      35780001
357900                                                                  35790001
358000******************************************************************35800006
358100 4431-POSITION-AT-WARNING.                                        35810001
358200                                                                  35820001
358300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               35830001
358400                                                  PV-TOP-ITEM + 1.35840001
358500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35850001
358600         CONTINUE                                                 35860001
358700     ELSE                                                         35870001
358800         SET DP030-SET-CURSOR-APPL-1                              35880001
358900                                 TO TRUE                          35890001
359000         MOVE -1                 TO MR-SELECTL (PV-SUB)           35900001
359100         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           35910001
359200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           35920001
359300     END-IF.                                                      35930001
359400                                                                  35940001
359500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.35950001
359600                                                                  35960001
359700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35970001
359800         CONTINUE                                                 35980001
359900     ELSE                                                         35990001
360000         SET DP030-SET-CURSOR-APPL-1                              36000001
360100                                 TO TRUE                          36010001
360200         MOVE -1                 TO MR-SELECTL (PV-SUB)           36020001
360300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           36030001
360400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           36040001
360500     END-IF.                                                      36050001
360600                                                                  36060001
360700*----------------------------------------------------------------*36070099
360800* CHECK IF ANY ITEMS HAVE AN UNCONFIRMED RV STATUS                36080099
360900*----------------------------------------------------------------*36090099
361000 4440-UNCONFIRMED-PACK-CHECK.                                     36100099
361100                                                                  36110099
361200     EXEC SQL                                                     36120099
361300          SELECT COUNT(*)                                         36130099
361400          INTO   :PV-RV-COUNTER                                   36140099
361500          FROM   TPURITM                                          36150099
361600          WHERE  PO_NBR         = :DK-REC-NBR                     36160099
361700            AND  PO_PREPK_ID    = :ASC-KEY-PACK-ID                36170099
361800            AND  VER_STATUS_CDE = :PC-ACTIVE                      36180099
361900            AND  STATUS_CDE     = :PC-RV                          36190099
362000     END-EXEC.                                                    36200099
362100                                                                  36210099
362200     EVALUATE TRUE                                                36220099
362300       WHEN SQLCODE = ZERO                                        36230099
362400             IF PV-RV-COUNTER > 0                                 36240099
362500                SET ASC-CANT-UPDATE   TO TRUE                     36250099
362600                MOVE PC-TSYMSG-02762  TO DP020-MSG-NUMBER         36260099
362700                SET DP020-MSG-WARNING TO TRUE                     36270099
362800             END-IF                                               36280099
362900       WHEN SQLCODE = +100                                        36290099
363000           CONTINUE                                               36300099
363100                                                                  36310099
363200       WHEN SQLCODE = -904                                        36320099
363300       WHEN SQLCODE = -911                                        36330099
363400       WHEN SQLCODE = -913                                        36340099
363500           PERFORM 9900-SOFT-ABORT                                36350099
363600                                                                  36360099
363700       WHEN SQLWARN0 NOT = SPACES                                 36370099
363800       WHEN SQLCODE  NOT = ZERO                                   36380099
363900           MOVE '4440-UNCONFIRMED-PACK-CHECK' TO DP013-PARAGRAPH  36390099
364000           MOVE 'UNSUCCESSFUL COUNT OF TPURITM'                   36400099
364100                          TO DP013-MESSAGE-TEXT (1)               36410099
364200           MOVE SQLCA     TO DP013-SQLCA                          36420099
364300           MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)             36430099
364400           SET DP013-DB2-ABEND                                    36440099
364500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 36450099
364600           PERFORM DP013-0000-PROCESS-ABEND                       36460099
364700     END-EVALUATE.                                                36470099
364800                                                                  36480099
364900                                                                  36490099
365000******************************************************************36500006
365100 5000-PREPARE-SEL-QUEUE.                                          36510001
365200                                                                  36520001
365300     MOVE +1  TO ASC-BLK-SUB.                                     36530034
365400     PERFORM 5100-WRITE-TEMP-STORAGE.                             36540001
365500                                                                  36550001
365600     ADD +1   TO ASC-BLK-SUB.                                     36560034
365700     PERFORM 5100-WRITE-TEMP-STORAGE.                             36570001
365800                                                                  36580001
365900     EVALUATE TRUE                                                36590001
366000*  WHEN GOING TO RESPOND/RESOLVE TROUBLE                          36600082
366100       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                36610082
366200            INITIALIZE TM001-INTER-APPL-COMMAREA                  36620089
366300* SINCE WE ARE ONLY ALLOWING 1 ITEM TO GO TO THE RESPOND SCREEN   36630089
366400* AT A TIME, IT CAN BE HARDCODED HERE.                            36640089
366500            MOVE +1        TO TM001-NUMBER-OF-TS-ITEMS            36650089
366600                              TM001-NUMBER-OF-SELECTED-ITEMS      36660089
366700            MOVE ASC-SEL-QUEUE-NAME-OUT                           36670089
366800                           TO TM001-SEL-QUEUE-NAME                36680089
366900            PERFORM 6010-DELETE-SEL-QUEUE                         36690089
367000                                                                  36700089
367100            MOVE ASC-KEY-OPER-UNT-ID  TO TM001-FCLTY-ID-N         36710089
367200            MOVE ASC-KEY-FCLTY-ID     TO TM001-OPER-UNT-ID-N      36720089
367300            MOVE ASC-KEY-FCLTY-ID     TO TM001-OPER-UNT-ID-N      36730089
367400            MOVE ASC-KEY-REC-NBR-N    TO TM001-PO-NBR-N           36740089
367500            MOVE ASC-KEY-REC-SEQ-NBR  TO TM001-RCVR-SEQ-NBR-N     36750089
367600            MOVE ASC-KEY-DRV-LNE-NBR  TO TM001-PO-LINE-NBR-N      36760089
367700                                                                  36770089
367800            PERFORM 5350-FILL-SEL-QUEUE-REC-TRBL                  36780089
367900              VARYING PV-ITEM FROM 1 BY 1                         36790089
368000               UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          36800089
368100                                                                  36810083
368200                                                                  36820082
368300       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                36830026
368400          MOVE ASC-SEL-QUEUE-NAME-OUT TO RC800-SEL-QUEUE-NAME     36840084
368500                                         RC015-SEL-QUEUE-NAME     36850084
368600          PERFORM 6010-DELETE-SEL-QUEUE                           36860084
368700                                                                  36870084
368800          SET ASC-UPDATE-TSQ  TO TRUE                             36880084
368900          SET RC801-IDX       TO 1                                36890084
369000          MOVE ZERO           TO RC800-NUMBER-OF-TS-ITEMS         36900084
369100                                 RC015-NUMBER-OF-TS-ITEMS         36910084
369200          INITIALIZE RC801-SELECTED-ITEM-ARRAY                    36920085
369300                                                                  36930084
369400           MOVE ASC-KEY-REC-NBR-N     TO DK-REC-NBR               36940006
369500           MOVE ASC-KEY-REC-SEQ-NBR-N TO DK-REC-SEQ-NBR           36950006
369600           MOVE ASC-KEY-DRV-LNE-NBR   TO DK-DRV-LNE-NBR           36960006
369700                                                                  36970006
369800           PERFORM 5300-SEARCH-FOR-SELECTION                      36980006
369900             VARYING PV-ITEM FROM 1 BY 1                          36990006
370000               UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          37000006
370100                                                                  37010006
370200           MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER               37020006
370300           SET DP020-MSG-INFORMATIONAL TO TRUE                    37030006
370400                                                                  37040013
370500           PERFORM 9000-UPDATE-SELECTION-QUEUE                    37050013
370600                                                                  37060001
370700           INITIALIZE ASC-BLOCK-ENTRIES (1)                       37070006
370800                      ASC-BLOCK-ENTRIES (2)                       37080006
370900           MOVE +1     TO ASC-BLK-SUB                             37090006
371000                          PV-TOP-ITEM                             37100006
371100           MOVE ZEROES TO ASC-ITEM-SUB                            37110006
371200                          ASC-NUMBER-OF-SELECTED-ITEMS            37120006
371300                          ASC-START-OF-SELECTED-RANGE             37130006
371400                          ASC-END-OF-SELECTED-RANGE               37140006
371500                          ASC-ITEM-AT-TOP-OF-PANEL                37150006
371600           PERFORM 4410-READ-TEMP-STORAGE                         37160006
371700           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   37170006
371800           PERFORM 3200-RESET-ATTRIBUTES                          37180085
371900                                                                  37190001
372000       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                37200050
372100          MOVE ASC-SEL-QUEUE-NAME-OUT TO RC800-SEL-QUEUE-NAME     37210084
372200                                         RC015-SEL-QUEUE-NAME     37220084
372300          PERFORM 6010-DELETE-SEL-QUEUE                           37230084
372400                                                                  37240084
372500          SET ASC-UPDATE-TSQ  TO TRUE                             37250084
372600          SET RC801-IDX       TO 1                                37260084
372700          MOVE ZERO           TO RC800-NUMBER-OF-TS-ITEMS         37270084
372800                                 RC015-NUMBER-OF-TS-ITEMS         37280084
372900          INITIALIZE RC801-SELECTED-ITEM-ARRAY                    37290086
373000                                                                  37300084
373100                                                                  37310050
373200       WHEN OTHER                                                 37320006
373300          MOVE ASC-SEL-QUEUE-NAME-OUT TO RC800-SEL-QUEUE-NAME     37330084
373400                                         RC015-SEL-QUEUE-NAME     37340084
373500          PERFORM 6010-DELETE-SEL-QUEUE                           37350084
373600                                                                  37360084
373700          SET ASC-UPDATE-TSQ  TO TRUE                             37370084
373800          SET RC801-IDX       TO 1                                37380084
373900          MOVE ZERO           TO RC800-NUMBER-OF-TS-ITEMS         37390084
374000                                 RC015-NUMBER-OF-TS-ITEMS         37400084
374100          INITIALIZE RC801-SELECTED-ITEM-ARRAY                    37410086
374200                                                                  37420084
374300           MOVE SPACE               TO RC801-ACTION-SW(1)         37430067
374400           MOVE ASC-KEY-DRV-LNE-NBR TO RC801-REC-LNE-NBR(1)       37440067
374500           MOVE ASC-KEY-PACK-ID     TO RC801-PACK-ID(1)           37450067
374600           MOVE ASC-KEY-PACK-DESC   TO RC801-PACK-DESC(1)         37460067
374700           SET RC801-IDX UP BY 1                                  37470067
374800     END-EVALUATE.                                                37480001
374900                                                                  37490001
375000     IF RC801-IDX > 1                                             37500041
375100         PERFORM 5205-WRITE-SEL-QUEUE                             37510041
375200         ADD +1 TO RC800-NUMBER-OF-TS-ITEMS                       37520041
375300     END-IF.                                                      37530041
375400                                                                  37540001
375500******************************************************************37550006
375600 5100-WRITE-TEMP-STORAGE.                                         37560001
375700                                                                  37570001
375800     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    37580001
375900          TO PV-LIST-ITEM-NUMBER.                                 37590034
376000                                                                  37600034
376100     COMPUTE PV-BLOCK-NUMBER = 1                                  37610034
376200                             + ((PV-LIST-ITEM-NUMBER - 1)         37620034
376300                             / PC-ITEMS-PER-PANEL).               37630034
376400                                                                  37640001
376500     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           37650001
376600        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       37660001
376700            PERFORM 5105-REWRITE-ASC-LISTQ                        37670001
376800        END-IF                                                    37680001
376900     ELSE                                                         37690001
377000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37700001
377100                 ASC-HIGHEST-BLOCK-WRITTEN + 1                    37710034
377200         PERFORM 5110-WRITE-ASC-LISTQ                             37720001
377300         ADD +1 TO ASC-HIGHEST-BLOCK-WRITTEN                      37730034
377400     END-IF.                                                      37740001
377500                                                                  37750001
377600     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB) TO TRUE.            37760034
377700                                                                  37770001
377800******************************************************************37780006
377900 5105-REWRITE-ASC-LISTQ.                                          37790001
378000                                                                  37800001
378100     EXEC CICS WRITEQ TS                                          37810001
378200               QUEUE   (ASC-LIST-QUEUE-NAME)                      37820001
378300               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           37830001
378400               ITEM    (PV-BLOCK-NUMBER)                          37840001
378500               REWRITE                                            37850001
378600               RESP    (PV-CICS-RESP)                             37860001
378700     END-EXEC.                                                    37870001
378800                                                                  37880001
378900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       37890001
379000         SET DP013-CICS-ABEND                                     37900001
379100             DP013-NO-ROLLBACK   TO TRUE                          37910001
379200         MOVE '5105-REWRITE-ASC-LISTQ'                            37920001
379300                                 TO DP013-PARAGRAPH               37930001
379400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'37940001
379500                                 TO DP013-MESSAGE-TEXT (1)        37950001
379600         PERFORM DP013-0000-PROCESS-ABEND                         37960001
379700     END-IF.                                                      37970001
379800                                                                  37980001
379900******************************************************************37990006
380000 5110-WRITE-ASC-LISTQ.                                            38000001
380100                                                                  38010001
380200     EXEC CICS WRITEQ TS                                          38020001
380300               QUEUE (ASC-LIST-QUEUE-NAME)                        38030001
380400               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            38040001
380500               ITEM  (PV-BLOCK-NUMBER)                            38050001
380600               RESP  (PV-CICS-RESP)                               38060001
380700     END-EXEC.                                                    38070001
380800                                                                  38080001
380900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      38090001
381000         SET DP013-CICS-ABEND                                     38100001
381100             DP013-NO-ROLLBACK   TO TRUE                          38110001
381200         MOVE '5110-WRITE-ASC-LISTQ'                              38120001
381300                                 TO DP013-PARAGRAPH               38130001
381400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  38140001
381500                                 TO DP013-MESSAGE-TEXT (1)        38150001
381600         PERFORM DP013-0000-PROCESS-ABEND                         38160001
381700     END-IF.                                                      38170001
381800                                                                  38180001
381900******************************************************************38190006
382000 5200-FILL-SEL-QUEUE-RECORD.                                      38200001
382100                                                                  38210001
382200     PERFORM 6112-READ-LIST-QUEUE.                                38220001
382300                                                                  38230001
382400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           38240001
382500         PERFORM                                                  38250001
382600           VARYING LQW-IDX  FROM 1 BY 1                           38260038
382700             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL OR                38270038
382800                   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          38280038
382900                                                                  38290038
383000               MOVE SPACE TO RC801-ACTION-SW (RC801-IDX)          38300038
383100               MOVE ASC-KEY-DRV-LNE-NBR                           38310048
383200                    TO RC801-REC-LNE-NBR(RC801-IDX)               38320048
383300               MOVE ASC-KEY-PACK-ID                               38330048
383400                    TO RC801-PACK-ID(RC801-IDX)                   38340048
383500               MOVE ASC-KEY-PACK-DESC                             38350048
383600                    TO RC801-PACK-DESC(RC801-IDX)                 38360048
383700               SET RC801-IDX UP BY 1                              38370038
383800               IF RC801-IDX > RC801-MAX-ITEMS                     38380038
383900                   PERFORM 5205-WRITE-SEL-QUEUE                   38390038
384000                   ADD +1      TO RC800-NUMBER-OF-TS-ITEMS        38400038
384100                   INITIALIZE RC801-SELECTED-ITEM-ARRAY           38410038
384200                   SET RC801-IDX TO 1                             38420038
384300               END-IF                                             38430038
384400         END-PERFORM                                              38440001
384500     END-IF.                                                      38450001
384600                                                                  38460001
384700******************************************************************38470006
384800 5205-WRITE-SEL-QUEUE.                                            38480001
384900                                                                  38490001
385000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC801-SELECTED-ITEMS.   38500038
385100                                                                  38510001
385200     EXEC CICS WRITEQ TS                                          38520001
385300               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     38530001
385400               FROM  (RC801-PREPACK-SELECT-RECORD)                38540010
385500               ITEM  (PV-SEL-QUEUE-ITEM)                          38550001
385600               RESP  (PV-CICS-RESP)                               38560001
385700     END-EXEC.                                                    38570001
385800                                                                  38580001
385900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       38590001
386000         SET DP013-CICS-ABEND                                     38600001
386100             DP013-NO-ROLLBACK TO TRUE                            38610038
386200         MOVE '5205-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           38620038
386300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   38630001
386400              TO DP013-MESSAGE-TEXT (1)                           38640038
386500         PERFORM DP013-0000-PROCESS-ABEND                         38650001
386600     END-IF.                                                      38660001
386700                                                                  38670001
386800******************************************************************38680034
386900 5300-SEARCH-FOR-SELECTION.                                       38690001
387000                                                                  38700001
387100     PERFORM 6112-READ-LIST-QUEUE.                                38710001
387200                                                                  38720001
387300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           38730001
387400         PERFORM                                                  38740001
387500           VARYING LQW-IDX  FROM 1 BY 1                           38750034
387600             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL OR                38760034
387700                   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          38770034
387800                                                                  38780034
387900             IF LQW-SELECT (LQW-IDX)                              38790001
388000                 MOVE LQW-STR-NBR (LQW-IDX) TO RECDIS-STR-NBR     38800034
388100*PROCESS EVERY STORE FOR PACK ID.                                 38810034
388200                 SET PS-MORE-RECITM-YES TO TRUE                   38820034
388300                 PERFORM 5310-OPEN-SELECT-RECITM-CSR              38830034
388400                 PERFORM 5320-PROCESS-SELECT-RECITM               38840034
388500                   UNTIL PS-MORE-RECITM-NO                        38850034
388600                 PERFORM 5330-CLOSE-SELECT-RECITM-CSR             38860034
388700                                                                  38870001
388800                 ADD +1      TO  RC800-NUMBER-OF-TS-ITEMS         38880034
388900                 SET LQW-DESELECT (LQW-IDX) TO TRUE               38890034
389000                 MOVE LQW-SELECTED-SW (LQW-IDX)                   38900001
389100                      TO LQW-TEMP-SELECTED-SW (LQW-IDX)           38910034
389200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     38920034
389300             END-IF                                               38930001
389400         END-PERFORM                                              38940001
389500     END-IF.                                                      38950001
389600                                                                  38960001
389700     MOVE PV-ITEM TO PV-SAVE-ITEM.                                38970034
389800     PERFORM 6111-WRITE-LIST-QUEUE.                               38980001
389900                                                                  38990001
390000******************************************************************39000006
390100 5310-OPEN-SELECT-RECITM-CSR.                                     39010034
390200                                                                  39020034
390300     EXEC SQL                                                     39030034
390400         OPEN SELECT-RECITM-CSR                                   39040034
390500     END-EXEC.                                                    39050034
390600                                                                  39060034
390700     EVALUATE TRUE                                                39070034
390800       WHEN SQLCODE = ZERO                                        39080034
390900           CONTINUE                                               39090034
391000                                                                  39100034
391100       WHEN SQLCODE = -904                                        39110034
391200       WHEN SQLCODE = -911                                        39120034
391300       WHEN SQLCODE = -913                                        39130034
391400           PERFORM 9900-SOFT-ABORT                                39140034
391500                                                                  39150034
391600       WHEN SQLWARN0 NOT = SPACES                                 39160034
391700       WHEN SQLCODE  NOT = ZERO                                   39170034
391800           MOVE '5310-OPEN-SELECT-CSR' TO DP013-PARAGRAPH         39180034
391900           MOVE 'UNSUCCESSFUL RECITM CURSOR OPEN'                 39190034
392000                          TO DP013-MESSAGE-TEXT (1)               39200034
392100           MOVE SQLCA     TO DP013-SQLCA                          39210034
392200           MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)             39220034
392300           SET DP013-XCTL-DISPLAY-RESTART                         39230034
392400               DP013-DB2-ABEND TO TRUE                            39240034
392500           PERFORM DP013-0000-PROCESS-ABEND                       39250034
392600     END-EVALUATE.                                                39260034
392700                                                                  39270034
392800******************************************************************39280034
392900 5320-PROCESS-SELECT-RECITM.                                      39290034
393000                                                                  39300034
393100     PERFORM 5321-FETCH-SELECT-RECITM.                            39310034
393200                                                                  39320034
393300     IF PS-MORE-RECITM-YES                                        39330034
393400         PERFORM 5400-LINK-AUDIT-MODULE                           39340034
393500                                                                  39350034
393600         MOVE LQW-STR-QTY (LQW-IDX)                               39360034
393700              TO LQW-EXPTED-ITM-QTY (LQW-IDX)                     39370034
393800                                                                  39380034
393900         COMPUTE RECDIS-EXPTED-ITM-QTY = LQW-STR-QTY (LQW-IDX)    39390034
394000                                       * RECITM-PREPK-RATO-QTY    39400034
394100         COMPUTE RECDIS-VERIFY-ITM-QTY = LQW-STR-QTY (LQW-IDX)    39410034
394200                                       * RECITM-PREPK-RATO-QTY    39420034
394300         PERFORM 5500-UPDATE-RECDIS                               39430034
394400     END-IF.                                                      39440034
394500                                                                  39450034
394600******************************************************************39460034
394700 5321-FETCH-SELECT-RECITM.                                        39470034
394800                                                                  39480034
394900     EXEC SQL                                                     39490034
395000         FETCH  SELECT-RECITM-CSR                                 39500034
395100          INTO :RECITM-ORD-LNE-NBR,                               39510034
395200               :RECITM-PREPK-RATO-QTY                             39520034
395300     END-EXEC.                                                    39530034
395400                                                                  39540034
395500     EVALUATE TRUE                                                39550034
395600       WHEN SQLCODE = ZERO                                        39560034
395700           CONTINUE                                               39570034
395800                                                                  39580034
395900       WHEN SQLCODE = +100                                        39590034
396000           SET PS-MORE-RECITM-NO TO TRUE                          39600034
396100                                                                  39610034
396200       WHEN SQLCODE = -904                                        39620034
396300       WHEN SQLCODE = -911                                        39630034
396400       WHEN SQLCODE = -913                                        39640034
396500           SET PS-MORE-RECITM-NO TO TRUE                          39650034
396600           PERFORM 9900-SOFT-ABORT                                39660034
396700                                                                  39670034
396800       WHEN SQLWARN0 NOT = SPACES                                 39680034
396900       WHEN SQLCODE  NOT = ZERO                                   39690034
397000           SET PS-MORE-RECITM-NO TO TRUE                          39700034
397100           MOVE '5321-FETCH-SELECT-RECITM'                        39710034
397200                                 TO DP013-PARAGRAPH               39720034
397300           MOVE 'UNSUCCESSFUL FETCH OF SELECT-RECITM-CSR'         39730034
397400                                 TO DP013-MESSAGE-TEXT (1)        39740034
397500           MOVE SQLCA         TO DP013-SQLCA                      39750034
397600           MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (1)         39760034
397700           SET DP013-DB2-ABEND                                    39770034
397800               DP013-XCTL-DISPLAY-RESTART TO TRUE                 39780034
397900           PERFORM DP013-0000-PROCESS-ABEND                       39790034
398000     END-EVALUATE.                                                39800034
398100                                                                  39810034
398200******************************************************************39820034
398300 5330-CLOSE-SELECT-RECITM-CSR.                                    39830034
398400                                                                  39840034
398500     EXEC SQL                                                     39850034
398600         CLOSE SELECT-RECITM-CSR                                  39860034
398700     END-EXEC.                                                    39870034
398800                                                                  39880034
398900     EVALUATE TRUE                                                39890034
399000       WHEN SQLCODE = ZERO                                        39900034
399100           CONTINUE                                               39910034
399200                                                                  39920034
399300       WHEN SQLCODE = -904                                        39930034
399400       WHEN SQLCODE = -911                                        39940034
399500       WHEN SQLCODE = -913                                        39950034
399600           PERFORM 9900-SOFT-ABORT                                39960034
399700                                                                  39970034
399800       WHEN SQLWARN0 NOT = SPACES                                 39980034
399900       WHEN SQLCODE  NOT = ZERO                                   39990034
400000           MOVE '5330-CLOSE-SELECT-RECITM-CSR'                    40000034
400100                           TO DP013-PARAGRAPH                     40010034
400200           MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR CLOSE'            40020034
400300                           TO DP013-MESSAGE-TEXT (1)              40030034
400400           MOVE SQLCA      TO DP013-SQLCA                         40040034
400500           MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)            40050034
400600           SET DP013-DB2-ABEND                                    40060034
400700               DP013-XCTL-DISPLAY-RESTART TO TRUE                 40070034
400800           PERFORM DP013-0000-PROCESS-ABEND                       40080034
400900     END-EVALUATE.                                                40090034
401000                                                                  40100034
401100*----------------------------------------------------------------*40110083
401200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *40120083
401300*----------------------------------------------------------------*40130083
401400 5350-FILL-SEL-QUEUE-REC-TRBL.                                    40140083
401500                                                                  40150083
401600     PERFORM 6112-READ-LIST-QUEUE.                                40160083
401700                                                                  40170083
401800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        40180083
401900         PERFORM VARYING LQW-IDX FROM 1 BY 1                      40190083
402000           UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL          40200083
402100                                                                  40210083
402200*  SINCE THERE IS ONLY GOING TO BE ALLOWED 1 NOTIFICATION NBR     40220093
402300*  TO BE SENT TO THE RESPOND SCREEN AT A TIME, +1 WILL BE         40230093
402400*  HARDCODED FOR THAT SITUATION WHERE THERE ARE NO STORES IN      40240093
402500*  ALLOCATION.                                                    40250093
402600                 MOVE +1           TO TM002-ITEM (TM002-IDX)      40260091
402700                 MOVE ASC-NOTIF-NBR                               40270083
402800                                   TO TM002-NOTIF-NBR             40280083
402900                                        (TM002-IDX)               40290083
403000                 MOVE ASC-KEY-OPER-UNT-ID                         40300083
403100                                   TO  TM002-OPER-UNT-ID          40310083
403200                                        (TM002-IDX)               40320083
403300                 MOVE ASC-KEY-FCLTY-ID                            40330083
403400                                   TO  TM002-FCLTY-ID             40340093
403500                                        (TM002-IDX)               40350083
403600                 MOVE ASC-KEY-REC-NBR-N                           40360083
403700                                   TO  TM002-PO-NBR               40370093
403800                                        (TM002-IDX)               40380083
403900                 MOVE ASC-KEY-REC-SEQ-NBR-N                       40390083
404000                                   TO  TM002-RCVR-SEQ             40400083
404100                                        (TM002-IDX)               40410083
404200                 MOVE ASC-KEY-DRV-LNE-NBR                         40420083
404300                                   TO TM002-PO-LNE-NBR            40430083
404400                                        (TM002-IDX)               40440083
404500                 MOVE ASC-KEY-PACK-ID                             40450083
404600                                   TO TM002-PREPK-ID              40460083
404700                                        (TM002-IDX)               40470083
404800                 MOVE SPACE        TO TM002-ACTION-SW (TM002-IDX) 40480083
404900                 SET TM002-IDX UP BY 1                            40490083
405000                 IF  TM002-IDX > TM002-MAX-ITEMS                  40500083
405100                     PERFORM 5360-WRITE-SEL-QUEUE-TM              40510083
405200                     ADD +1        TO TM001-NUMBER-OF-TS-ITEMS    40520083
405300                     INITIALIZE TM002-SELECTED-ITEM-ARRAY         40530083
405400                     SET TM002-IDX TO  1                          40540083
405500                 END-IF                                           40550083
405600         END-PERFORM                                              40560083
405700         PERFORM 5360-WRITE-SEL-QUEUE-TM                          40570089
405800     END-IF.                                                      40580083
405900                                                                  40590083
406000*----------------------------------------------------------------*40600083
406100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *40610083
406200*----------------------------------------------------------------*40620083
406300 5360-WRITE-SEL-QUEUE-TM.                                         40630083
406400                                                                  40640083
406500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO TM002-SELECTED-ITEMS.   40650083
406600                                                                  40660083
406700     EXEC CICS                                                    40670083
406800          WRITEQ TS                                               40680083
406900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      40690083
407000              FROM  (TM002-MESSAGE-SEL-REC)                       40700083
407100              ITEM  (PV-SEL-QUEUE-ITEM)                           40710083
407200              RESP  (PV-CICS-RESP)                                40720083
407300     END-EXEC.                                                    40730083
407400                                                                  40740083
407500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40750083
407600         CONTINUE                                                 40760083
407700     ELSE                                                         40770083
407800         SET DP013-CICS-ABEND      TO TRUE                        40780083
407900         SET DP013-NO-ROLLBACK     TO TRUE                        40790083
408000         MOVE '5205-WRITE-SEL-QUEUE'                              40800083
408100                                   TO DP013-PARAGRAPH             40810083
408200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          40820083
408300                                   TO DP013-MESSAGE-TEXT(1)       40830083
408400         PERFORM DP013-0000-PROCESS-ABEND                         40840083
408500     END-IF.                                                      40850083
408600 EJECT                                                            40860083
408700******************************************************************40870034
408800*    LINK TO AUDIT MODULE * RCKCS290                             *40880001
408900******************************************************************40890006
409000 5400-LINK-AUDIT-MODULE.                                          40900001
409100                                                                  40910001
409200     EXEC SQL                                                     40920001
409300         SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP             40930034
409400     END-EXEC.                                                    40940001
409500                                                                  40950001
409600     MOVE 'D'                     TO RC031-TABLE-TO-AUDIT.        40960001
409700     MOVE 'B'                     TO RC031-AUD-TYP-CDE.           40970001
409800     MOVE 'U'                     TO RC031-AUD-FUNC-CDE.          40980001
409900     MOVE ASC-KEY-OPER-UNT-ID     TO RC031-OPER-UNT-ID.           40990001
410000     MOVE ASC-KEY-FCLTY-ID        TO RC031-FCLTY-ID.              41000001
410100     MOVE DK-REC-NBR              TO RC031-PO-NBR.                41010003
410200     MOVE DK-REC-SEQ-NBR          TO RC031-REC-SEQ-NBR.           41020001
410300     MOVE RECITM-ORD-LNE-NBR      TO RC031-PO-LNE-NBR.            41030034
410400     MOVE RECDIS-STR-NBR          TO RC031-STR-NBR.               41040001
410500     MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID.            41050001
410600     MOVE DP020-USERID            TO RC031-UPD-UID.               41060001
410700     MOVE PV-DB2-CURRENT-TMST     TO RC031-UPD-TMST.              41070001
410800                                                                  41080001
410900     EXEC CICS                                                    41090001
411000         LINK PROGRAM  (PC-AUDIT-RTN)                             41100034
411100         COMMAREA (RC031-FIELDS)                                  41110034
411200         LENGTH   (PC-AUDIT-RTN-LENGTH)                           41120034
411300     END-EXEC.                                                    41130001
411400                                                                  41140001
411500     EVALUATE TRUE                                                41150001
411600       WHEN RC031-CALL-SUCCESSFUL                                 41160034
411700           CONTINUE                                               41170034
411800                                                                  41180034
411900       WHEN OTHER                                                 41190034
412000           MOVE '5400-LINK-AUDIT-MODULE' TO DP013-PARAGRAPH       41200034
412100           MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                  41210034
412200                                  TO DP013-MESSAGE-TEXT (1)       41220034
412300           MOVE RC031-RETURN-DESC TO DP013-MESSAGE-TEXT (2)       41230034
412400           MOVE RC031-SQLCA       TO DP013-SQLCA                  41240034
412500           SET DP013-DB2-ABEND                                    41250034
412600               DP013-XCTL-DISPLAY-RESTART TO TRUE                 41260034
412700           PERFORM DP013-0000-PROCESS-ABEND                       41270034
412800     END-EVALUATE.                                                41280001
412900                                                                  41290001
413000******************************************************************41300006
413100 5500-UPDATE-RECDIS.                                              41310001
413200                                                                  41320001
413300     EXEC SQL                                                     41330001
413400       UPDATE TRECDIS                                             41340001
413500          SET EXPTED_ITM_QTY     = :RECDIS-EXPTED-ITM-QTY         41350001
413600            , VERIFY_ITM_QTY     = :RECDIS-VERIFY-ITM-QTY         41360001
413700        WHERE ORD_NBR            = :DK-REC-NBR                    41370003
413800          AND ORD_LNE_NBR        = :RECITM-ORD-LNE-NBR            41380034
413900          AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR                41390001
414000          AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID           41400001
414100          AND FCLTY_ID           = :ASC-KEY-FCLTY-ID              41410001
414200          AND STR_NBR            = :RECDIS-STR-NBR                41420001
414300          AND STR_FCLTY_ID       = 1                              41430001
414500     END-EXEC                                                     41450001
414600                                                                  41460001
414700     EVALUATE TRUE                                                41470001
414800       WHEN SQLCODE = ZERO                                        41480034
414900       WHEN SQLCODE = +100                                        41490034
415000           CONTINUE                                               41500034
415100                                                                  41510034
415200       WHEN SQLCODE = -904                                        41520034
415300       WHEN SQLCODE = -911                                        41530034
415400       WHEN SQLCODE = -913                                        41540034
415500           PERFORM 9900-SOFT-ABORT                                41550034
415600                                                                  41560034
415700       WHEN SQLWARN0 NOT = SPACES                                 41570034
415800       WHEN SQLCODE  NOT = ZERO                                   41580034
415900           MOVE '5500-UPDATE-RECDIS' TO DP013-PARAGRAPH           41590034
416000           MOVE 'UNSUCCESSFUL UPDATE OF TRECDIS'                  41600034
416100                          TO DP013-MESSAGE-TEXT (1)               41610034
416200           MOVE SQLCA     TO DP013-SQLCA                          41620034
416300           MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)             41630034
416400           SET DP013-DB2-ABEND                                    41640034
416500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 41650034
416600           PERFORM DP013-0000-PROCESS-ABEND                       41660034
416700     END-EVALUATE.                                                41670001
416800                                                                  41680006
416810* JAK 05/2007 - ADD CODE TO CALL SHIPMENT CONTROL MODULE          41681099
416820******************************************************************41682099
416830*  THIS PARAGRAPH CHECKS TO SEE IF THE DC IS DOWNLOADING TO WMS   41683099
416840******************************************************************41684099
416850 5600-CHECK-ASNDWN.                                               41685099
416860                                                                  41686099
416870     MOVE RECEIV-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.               41687099
416880                                                                  41688099
416890     EXEC SQL                                                     41689099
416891          SELECT   FUNC_TXT                                       41689199
416892            INTO  :KRPRPM-FUNC-TXT                                41689299
416893            FROM                                                  41689399
416894                  TKRPRPM                                         41689499
416895            WHERE                                                 41689599
416896                  LOC_ID            = :KRPRPM-LOC-ID              41689699
416897              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    41689799
416898              AND FUNC_PRC_STAT_CDE = 'AC'                        41689899
416899              AND INTFC_SYS_CDE     = 'KHL'                       41689999
416900              AND FUNC_TXT          = 'Y'                         41690099
416901              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            41690199
416902     END-EXEC.                                                    41690299
416903                                                                  41690399
416904     EVALUATE TRUE                                                41690499
416905         WHEN SQLCODE = ZERO                                      41690599
416906              SET PS-ASNS-TO-WMS-YES    TO TRUE                   41690699
416907         WHEN SQLCODE = +100                                      41690799
416908              SET PS-ASNS-TO-WMS-NO     TO TRUE                   41690899
416909         WHEN SQLCODE = -904                                      41690999
416910         WHEN SQLCODE = -911                                      41691099
416911         WHEN SQLCODE = -913                                      41691199
416912             PERFORM 9900-SOFT-ABORT                              41691299
416919         WHEN SQLWARN0 NOT = SPACES                               41691999
416920         WHEN SQLCODE  NOT = ZERO                                 41692099
416921             SET PS-ERROR             TO TRUE                     41692199
416922             MOVE '5600-CHECK-ASNDWN' TO DP013-PARAGRAPH          41692299
416923             MOVE 'UNSUCCESSFUL CHECK OF TKRPRPM'                 41692399
416924                            TO DP013-MESSAGE-TEXT (1)             41692499
416925             MOVE SQLCA     TO DP013-SQLCA                        41692599
416926             MOVE 'TKRPRPM' TO DP013-DB2-TABLE-NAME (1)           41692699
416927             SET DP013-DB2-ABEND                                  41692799
416928                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41692899
416929             PERFORM DP013-0000-PROCESS-ABEND                     41692999
416930     END-EVALUATE.                                                41693099
416931                                                                  41693199
416932******************************************************************41693299
416933*  THIS PARAGRAPH GETS THE CURRENT OPER ID                        41693399
416934******************************************************************41693499
416935 5610-SELECT-TRECEIV.                                             41693599
416936                                                                  41693699
416937     MOVE ASC-KEY-REC-NBR-N      TO RECEIV-ORD-NBR.               41693799
416938     MOVE ASC-KEY-REC-SEQ-NBR-N  TO RECEIV-REC-SEQ-NBR.           41693899
416939                                                                  41693999
416940     EXEC SQL                                                     41694099
416941          SELECT   CURR_OPER_UNT_ID                               41694199
416942            INTO  :RECEIV-CURR-OPER-UNT-ID                        41694299
416943            FROM                                                  41694399
416944                  TRECEIV                                         41694499
416945            WHERE                                                 41694599
416946                  ORD_NBR           = :RECEIV-ORD-NBR             41694699
416947              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         41694799
416948              AND VER_STATUS_CDE    = 'A'                         41694899
416952     END-EXEC.                                                    41695299
416953                                                                  41695399
416954     EVALUATE TRUE                                                41695499
416955         WHEN SQLCODE = ZERO                                      41695599
416956         WHEN SQLCODE = -811                                      41695699
416957              CONTINUE                                            41695799
416958         WHEN SQLCODE = +100                                      41695899
416959              MOVE ZERO             TO RECEIV-CURR-OPER-UNT-ID    41695999
416960         WHEN SQLCODE = -904                                      41696099
416961         WHEN SQLCODE = -911                                      41696199
416962         WHEN SQLCODE = -913                                      41696299
416963             PERFORM 9900-SOFT-ABORT                              41696399
416964         WHEN SQLWARN0 NOT = SPACES                               41696499
416965         WHEN SQLCODE  NOT = ZERO                                 41696599
416966             SET PS-ERROR             TO TRUE                     41696699
416967             MOVE '5610-SELECT-TRECEIV' TO DP013-PARAGRAPH        41696799
416968             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                41696899
416969                            TO DP013-MESSAGE-TEXT (1)             41696999
416970             MOVE SQLCA     TO DP013-SQLCA                        41697099
416971             MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)           41697199
416972             SET DP013-DB2-ABEND                                  41697299
416973                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41697399
416974             PERFORM DP013-0000-PROCESS-ABEND                     41697499
416975     END-EVALUATE.                                                41697599
416976                                                                  41697699
416977******************************************************************41697799
416978*  THIS PARAGRAPH CHECKS TO SEE IF THE TRECDIS ROWS EXIST.        41697899
416979******************************************************************41697999
416980 5620-CHECK-TRECDIS.                                              41698099
416981                                                                  41698199
416982     MOVE 0                     TO PV-SQL-CNT.                    41698299
416983     MOVE ASC-KEY-REC-NBR-N     TO RECDIS-ORD-NBR.                41698399
416984     MOVE ASC-KEY-DRV-LNE-NBR   TO RECDIS-ORD-LNE-NBR.            41698499
416985     MOVE ASC-KEY-REC-SEQ-NBR-N TO RECDIS-REC-SEQ-NBR.            41698599
416986     MOVE ASC-KEY-OPER-UNT-ID   TO RECDIS-OPER-UNT-ID.            41698699
416987     MOVE ASC-KEY-FCLTY-ID      TO RECDIS-FCLTY-ID.               41698799
416988                                                                  41698899
416989     EXEC SQL                                                     41698999
416990         SELECT COUNT(*)                                          41699099
416991           INTO :PV-SQL-CNT                                       41699199
416992           FROM TRECDIS                                           41699299
416993          WHERE ORD_NBR        = :RECDIS-ORD-NBR                  41699399
416994            AND ORD_LNE_NBR    = :RECDIS-ORD-LNE-NBR              41699499
416995            AND REC_SEQ_NBR    = :RECDIS-REC-SEQ-NBR              41699599
416996            AND OPER_UNT_ID    = :RECDIS-OPER-UNT-ID              41699699
416997            AND FCLTY_ID       = :RECDIS-FCLTY-ID                 41699799
416999     END-EXEC.                                                    41699999
417000                                                                  41700099
417001     EVALUATE TRUE                                                41700199
417002         WHEN SQLCODE = ZERO                                      41700299
417003             IF PV-SQL-CNT = 0                                    41700399
417004                 SET PS-DISTRO-TRBL-YES TO TRUE                   41700499
417005             ELSE                                                 41700599
417006                 SET PS-DISTRO-TRBL-NO  TO TRUE                   41700699
417007             END-IF                                               41700799
417034         WHEN SQLCODE = +100                                      41703499
417035                 SET PS-DISTRO-TRBL-YES TO TRUE                   41703599
417036                                                                  41703699
417037         WHEN SQLCODE = -904                                      41703799
417038         WHEN SQLCODE = -911                                      41703899
417039         WHEN SQLCODE = -913                                      41703999
417040             PERFORM 9900-SOFT-ABORT                              41704099
417041         WHEN SQLWARN0 NOT = SPACES                               41704199
417042         WHEN SQLCODE  NOT = ZERO                                 41704299
417043             SET PS-ERROR             TO TRUE                     41704399
417044             MOVE '5620-CHECK-TRECDIS' TO DP013-PARAGRAPH         41704499
417045             MOVE 'UNSUCCESSFUL CHECK OF TRECDIS'                 41704599
417046                            TO DP013-MESSAGE-TEXT (1)             41704699
417047             MOVE SQLCA     TO DP013-SQLCA                        41704799
417048             MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)           41704899
417049             SET DP013-DB2-ABEND                                  41704999
417050                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41705099
417051             PERFORM DP013-0000-PROCESS-ABEND                     41705199
417052     END-EVALUATE.                                                41705299
417053                                                                  41705399
417054******************************************************************41705499
417055*  THIS PARAGRAPH GETS THE TRIP-ID FROM THE PO/RCVR.              41705599
417056******************************************************************41705699
417057 5630-GET-TRIP-ID.                                                41705799
417058                                                                  41705899
417059     MOVE ASC-KEY-REC-NBR-N     TO SHPTPO-PO-NBR.                 41705999
417060     MOVE ASC-KEY-REC-SEQ-NBR-N TO SHPTPO-REC-SEQ-NBR.            41706099
417061                                                                  41706199
417062     EXEC SQL                                                     41706299
417063         SELECT A.TRIP_ID                                         41706399
417064           INTO :SHIPMT-TRIP-ID                                   41706499
417065           FROM TSHIPMT   A                                       41706599
417066              , TSHPTPO   B                                       41706699
417067          WHERE B.PO_NBR         = :SHPTPO-PO-NBR                 41706799
417068            AND B.REC_SEQ_NBR    = :SHPTPO-REC-SEQ-NBR            41706899
417069            AND A.SHIPT_ID       = B.SHIPT_ID                     41706999
417070            AND B.PRIM_SHIPT_IND = 'Y'                            41707099
417071     END-EXEC.                                                    41707199
417072                                                                  41707299
417073     EVALUATE TRUE                                                41707399
417074         WHEN SQLCODE = ZERO                                      41707499
417075             CONTINUE                                             41707599
417076         WHEN SQLCODE = -904                                      41707699
417077         WHEN SQLCODE = -911                                      41707799
417078         WHEN SQLCODE = -913                                      41707899
417079             PERFORM 9900-SOFT-ABORT                              41707999
417080         WHEN SQLWARN0 NOT = SPACES                               41708099
417081         WHEN SQLCODE  NOT = ZERO                                 41708199
417082             SET PS-ERROR             TO TRUE                     41708299
417083             MOVE '5630-GET-TRIP-ID' TO DP013-PARAGRAPH           41708399
417084             MOVE 'UNSUCCESSFUL SELECT OF TRIP-ID'                41708499
417085                            TO DP013-MESSAGE-TEXT (1)             41708599
417086             MOVE SQLCA     TO DP013-SQLCA                        41708699
417087             MOVE 'TSHIPMT' TO DP013-DB2-TABLE-NAME (1)           41708799
417088             MOVE 'TSHPTPO' TO DP013-DB2-TABLE-NAME (2)           41708899
417089             SET DP013-DB2-ABEND                                  41708999
417090                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41709099
417091             PERFORM DP013-0000-PROCESS-ABEND                     41709199
417092     END-EVALUATE.                                                41709299
417093                                                                  41709399
417094*----------------------------------------------------------------*41709499
417095* LINK TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     41709599
417096*  COPYBOOK WSWS001.                                              41709699
417097*----------------------------------------------------------------*41709799
417098 5640-CALL-WMS-MODULE.                                            41709899
417099                                                                  41709999
417100     SET WS001-INSERT               TO TRUE.                      41710099
417101     MOVE SHIPMT-TRIP-ID            TO WS001-TRIP-ID.             41710199
417102     MOVE ASC-KEY-OPER-UNT-ID       TO WS001-OPER-UNT-ID.         41710299
417103     MOVE DP020-USERID              TO WS001-USER-ID.             41710399
417104     MOVE ASC-KEY-REC-NBR-N         TO WS001-PO-NBR.              41710499
417105     MOVE ASC-KEY-DRV-LNE-NBR       TO WS001-PO-LNE-NBR.          41710599
417106     MOVE ASC-KEY-REC-SEQ-NBR-N     TO WS001-RCVR-NBR.            41710699
417107     MOVE ASC-KEY-PACK-ID           TO WS001-PREPK-ID.            41710799
417108     MOVE ZEROS                     TO WS001-SKU-NBR.             41710899
417109     MOVE ZEROS                     TO WS001-KOHLS-SHIPT-ID.      41710999
417110     MOVE 'RC'                      TO WS001-SHIPMENT-SOURCE.     41711099
417111     MOVE SPACES                    TO WS001-DTL-ASN-LEVEL-IND.   41711199
417112     MOVE DP020-SRC-TASK-NUMBER     TO WS001-SRC-TASK-NUMBER.     41711299
417113     MOVE PC-CURRENT-PROGRAM-NAME   TO WS001-CALLING-PROGRAM-NAME.41711399
417114                                                                  41711499
417115     MOVE LENGTH OF WS001-FIELDS    TO PV-COMMAREA-LENGTH.        41711599
417116                                                                  41711699
417117     EXEC CICS                                                    41711799
417118         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       41711899
417119              COMMAREA (WS001-FIELDS)                             41711999
417120              LENGTH   (PV-COMMAREA-LENGTH)                       41712099
417121     END-EXEC.                                                    41712199
417122                                                                  41712299
417123     EVALUATE TRUE                                                41712399
417124         WHEN WS001-SUCCESSFUL                                    41712499
417125              CONTINUE                                            41712599
417126                                                                  41712699
417127         WHEN OTHER                                               41712799
417128             SET PS-ERROR             TO TRUE                     41712899
417129             SET DP013-CICS-ABEND                                 41712999
417130                 DP013-NO-ROLLBACK TO TRUE                        41713099
417131             MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH     41713199
417132             MOVE 'UNSUCCESSFUL CALL TO SHIPPING CONTROL MODULE'  41713299
417133                  TO DP013-MESSAGE-TEXT (1)                       41713399
417134             PERFORM DP013-0000-PROCESS-ABEND                     41713499
417135                                                                  41713599
417136     END-EVALUATE.                                                41713699
417137                                                                  41713799
417138* JAK 05/2007 - END                                               41713899
417139                                                                  41713999
417140******************************************************************41714099
417141 6000-REFRESH-PANEL-FROM-TEMP.                                    41714199
417150                                                                  41715001
417200     IF ASC-UPDATE-TSQ                                            41720001
417300         SET ASC-NO-TSQ-UPDATE   TO TRUE                          41730001
417400         MOVE ZERO               TO PV-SAVE-ITEM                  41740001
417500                                    PV-SEL-QUEUE-ITEM             41750001
417600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        41760001
417700                                 TO PV-HOLD-SELECTED-ITEMS        41770001
417800         PERFORM 6100-UPDATE-TSQ                                  41780001
417900           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS41790001
418000                                                                  41800001
418100         PERFORM 6010-DELETE-SEL-QUEUE                            41810001
418200                                                                  41820001
418300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         41830001
418400                    ASC-BLOCK-ENTRIES (2)                         41840001
418500                                                                  41850001
418600         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 41860001
418700                GIVING    PV-BLOCK-NUMBER                         41870001
418800                REMAINDER PV-REMAINDER                            41880001
418900                                                                  41890001
419000         IF PV-REMAINDER > ZERO                                   41900001
419100             ADD +1              TO PV-BLOCK-NUMBER               41910001
419200         END-IF                                                   41920001
419300                                                                  41930001
419400         MOVE +1                 TO ASC-BLK-SUB                   41940001
419500                                                                  41950001
419600         PERFORM 4410-READ-TEMP-STORAGE                           41960001
419700                                                                  41970001
419800         ADD +1                  TO ASC-BLK-SUB                   41980001
419900                            PV-BLOCK-NUMBER                       41990001
420000         PERFORM 4410-READ-TEMP-STORAGE                           42000001
420100                                                                  42010001
420200     END-IF.                                                      42020001
420300                                                                  42030001
420400******************************************************************42040006
420500 6010-DELETE-SEL-QUEUE.                                           42050001
420600                                                                  42060001
420700     EXEC CICS DELETEQ TS                                         42070001
420800               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42080001
420900               RESP  (PV-CICS-RESP)                               42090001
421000     END-EXEC.                                                    42100001
421100                                                                  42110001
421200     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     42120001
421300         (PV-CICS-RESP = DFHRESP (QIDERR)))                       42130001
421400         CONTINUE                                                 42140001
421500     ELSE                                                         42150001
421600         SET DP013-CICS-ABEND                                     42160001
421700             DP013-NO-ROLLBACK   TO TRUE                          42170001
421800         MOVE '6010-DELETE-SEL-QUEUE'                             42180001
421900                                 TO DP013-PARAGRAPH               42190001
422000         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  42200001
422100                                 TO DP013-MESSAGE-TEXT (1)        42210001
422200         PERFORM DP013-0000-PROCESS-ABEND                         42220001
422300     END-IF.                                                      42230001
422400                                                                  42240001
422500******************************************************************42250006
422600 6100-UPDATE-TSQ.                                                 42260001
422700                                                                  42270001
422800     ADD 1                       TO PV-SEL-QUEUE-ITEM.            42280001
422900                                                                  42290001
423000     PERFORM 6105-READ-SEL-QUEUE.                                 42300001
423100                                                                  42310001
423200     PERFORM                                                      42320001
423300     VARYING RC801-IDX  FROM 1 BY 1                               42330010
423400     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       42340001
423500             RC801-IDX > RC801-MAX-ITEMS                          42350010
423600                                                                  42360001
423700         IF RC801-ACTION-SW (RC801-IDX) > SPACE                   42370010
423800            PERFORM 6110-PROCESS-ITEMS                            42380001
423900            SET PS-WRITE-LIST-QUEUE                               42390001
424000                                 TO TRUE                          42400001
424100         END-IF                                                   42410001
424200                                                                  42420001
424300         ADD +1                  TO PV-ITEMS-PROCESSED            42430001
424400     END-PERFORM.                                                 42440001
424500                                                                  42450001
424600     IF PS-WRITE-LIST-QUEUE                                       42460001
424700         PERFORM 6111-WRITE-LIST-QUEUE                            42470001
424800     END-IF.                                                      42480001
424900                                                                  42490001
425000******************************************************************42500006
425100 6105-READ-SEL-QUEUE.                                             42510001
425200                                                                  42520001
425300     EXEC CICS READQ TS                                           42530001
425400               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42540001
425500               INTO  (RC801-PREPACK-SELECT-RECORD)                42550010
425600               ITEM  (PV-SEL-QUEUE-ITEM)                          42560001
425700               RESP  (PV-CICS-RESP)                               42570001
425800     END-EXEC.                                                    42580001
425900                                                                  42590001
426000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       42600001
426100         SET DP013-CICS-ABEND                                     42610001
426200             DP013-NO-ROLLBACK   TO TRUE                          42620001
426300         MOVE '6105-READ-SEL-QUEUE'                               42630001
426400                                 TO DP013-PARAGRAPH               42640001
426500         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    42650001
426600                                 TO DP013-MESSAGE-TEXT (1)        42660001
426700         PERFORM DP013-0000-PROCESS-ABEND                         42670001
426800     END-IF.                                                      42680001
426900                                                                  42690001
427000******************************************************************42700006
427100 6110-PROCESS-ITEMS.                                              42710001
427200                                                                  42720001
427300     COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)          42730010
427400                           / PC-ITEMS-PER-PANEL).                 42740010
427500                                                                  42750001
427600     IF PV-ITEM NOT = PV-SAVE-ITEM                                42760001
427700        IF PV-SAVE-ITEM NOT = ZERO                                42770001
427800                                                                  42780001
427900            PERFORM 6111-WRITE-LIST-QUEUE                         42790001
428000                                                                  42800001
428100        END-IF                                                    42810001
428200        MOVE PV-ITEM             TO PV-SAVE-ITEM                  42820001
428300                                                                  42830001
428400        PERFORM 6112-READ-LIST-QUEUE                              42840001
428500                                                                  42850001
428600     END-IF.                                                      42860001
428700                                                                  42870001
428800     COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX) -                   42880010
428900                                    LQW-LIST-ITEM-NUMBER (1)) + 1.42890001
429000     SET LQW-DESELECT (PV-SUB)   TO TRUE                          42900001
429100     MOVE LQW-SELECTED-SW (PV-SUB)                                42910001
429200                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).42920001
429300                                                                  42930001
429400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                42940001
429500                                                                  42950001
429600******************************************************************42960006
429700 6111-WRITE-LIST-QUEUE.                                           42970001
429800                                                                  42980001
429900     EXEC CICS WRITEQ TS                                          42990001
430000               QUEUE (ASC-LIST-QUEUE-NAME)                        43000001
430100               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   43010001
430200               ITEM  (PV-SAVE-ITEM)                               43020001
430300               REWRITE                                            43030001
430400               RESP  (PV-CICS-RESP)                               43040001
430500     END-EXEC.                                                    43050001
430600                                                                  43060001
430700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43070001
430800         SET DP013-CICS-ABEND                                     43080001
430900             DP013-NO-ROLLBACK   TO TRUE                          43090001
431000         MOVE '6111-WRITE-LIST-QUEUE'                             43100001
431100                                 TO DP013-PARAGRAPH               43110001
431200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'43120001
431300                                 TO DP013-MESSAGE-TEXT(1)         43130001
431400         PERFORM DP013-0000-PROCESS-ABEND                         43140001
431500     END-IF.                                                      43150001
431600                                                                  43160001
431700******************************************************************43170006
431800 6112-READ-LIST-QUEUE.                                            43180001
431900                                                                  43190001
432000     EXEC CICS READQ TS                                           43200001
432100               QUEUE (ASC-LIST-QUEUE-NAME)                        43210001
432200               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   43220001
432300               ITEM  (PV-ITEM)                                    43230001
432400               RESP  (PV-CICS-RESP)                               43240001
432500     END-EXEC.                                                    43250001
432600                                                                  43260001
432700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43270001
432800         SET DP013-CICS-ABEND                                     43280001
432900             DP013-NO-ROLLBACK TO TRUE                            43290035
433000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           43300035
433100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   43310001
433200              TO DP013-MESSAGE-TEXT(1)                            43320035
433300         PERFORM DP013-0000-PROCESS-ABEND                         43330001
433400     END-IF.                                                      43340001
433500                                                                  43350001
433600******************************************************************43360001
433700* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *43370001
433800******************************************************************43380001
433900 6200-DEL-LIST-QUEUE.                                             43390001
434000                                                                  43400001
434100     EXEC CICS                                                    43410001
434200         DELETEQ TS                                               43420001
434300             QUEUE (ASC-LIST-QUEUE-NAME)                          43430001
434400             RESP  (PV-CICS-RESP)                                 43440001
434500     END-EXEC.                                                    43450001
434600                                                                  43460001
434700     IF ((PV-CICS-RESP = DFHRESP(NORMAL))                         43470035
434800       OR (PV-CICS-RESP = DFHRESP(QIDERR)))                       43480035
434900         CONTINUE                                                 43490001
435000     ELSE                                                         43500001
435100         SET DP013-CICS-ABEND       TO TRUE                       43510035
435200         SET DP013-NO-ROLLBACK      TO TRUE                       43520035
435300         MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH            43530035
435400         MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'              43540035
435500              TO DP013-MESSAGE-TEXT (1)                           43550035
435600         PERFORM DP013-0000-PROCESS-ABEND                         43560035
435700     END-IF.                                                      43570001
435800                                                                  43580006
435900******************************************************************43590038
436000 7000-FORMAT-COMMAREA.                                            43600038
436100                                                                  43610038
436200     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            43620038
436300         MOVE 1 TO PV-BLOCK-NUMBER                                43630038
436400     ELSE                                                         43640038
436500         MOVE 2 TO PV-BLOCK-NUMBER                                43650038
436600     END-IF.                                                      43660038
436700                                                                  43670038
436800     MOVE ASC-KEY-REC-NBR-N      TO RC800-REC-NBR-N.              43680038
436900     MOVE ASC-KEY-REC-SEQ-NBR-N  TO RC800-REC-SEQ-NBR-N.          43690038
437000     MOVE ASC-KEY-DRV-LNE-NBR    TO RC800-LINE-NBR-N.             43700048
437100     MOVE ASC-KEY-OPER-UNT-ID    TO RC800-OPER-UNIT-ID.           43710038
437200     MOVE ASC-KEY-FCLTY-ID       TO RC800-FACILITY-ID.            43720038
437300***  MOVE ???                    TO RC800-REC-STATUS.             43730041
437400     MOVE ASC-KEY-PACK-ID        TO RC800-PACK-ID.                43740048
437500     MOVE ASC-DSP-PACK-TYPE      TO RC800-PACK-TYPE.              43750041
437600                                                                  43760041
437700     MOVE ASC-KEY-VENDOR-NAME    TO RC800-VENDOR-NAME.            43770041
437800     MOVE ASC-KEY-PACK-DESC      TO RC800-PREPACK-DESC.           43780048
437900     MOVE ASC-KEY-INNR-PACK-QTY  TO RC800-INNER-PACK-QTY.         43790039
438000                                                                  43800038
438100     EVALUATE TRUE                                                43810038
438200         WHEN ASC-DSP-PACK-TYPE = PC-MULTIPLE                     43820039
438300             MOVE PC-MULTI-SKU-PACK-DESC                          43830038
438400                                 TO RC800-PACK-TYPE-DESC          43840038
438500         WHEN ASC-DSP-PACK-TYPE = PC-SINGLE                       43850039
438600             MOVE PC-SINGLE-SKU-PACK-DESC                         43860038
438700                                 TO RC800-PACK-TYPE-DESC          43870038
438800         WHEN ASC-DSP-PACK-TYPE = PC-INNER                        43880039
438900             MOVE PC-INNER-PACK-DESC                              43890038
439000                                 TO RC800-PACK-TYPE-DESC          43900038
439100         WHEN ASC-DSP-PACK-TYPE = PC-BULK                         43910039
439200             MOVE PC-BULK-PACK-DESC                               43920038
439300                                 TO RC800-PACK-TYPE-DESC          43930038
439400         WHEN ASC-DSP-PACK-TYPE = PC-CASE                         43940039
439500             MOVE PC-CASE-PACK-DESC                               43950038
439600                                 TO RC800-PACK-TYPE-DESC          43960038
439700         WHEN ASC-DSP-PACK-TYPE = PC-PKG-TYP-NOT-FOUND            43970039
439800             MOVE PC-PKG-TYP-NOT-FOUND                            43980038
439900                                 TO RC800-PACK-TYPE-DESC          43990038
440000      END-EVALUATE.                                               44000038
440100                                                                  44010038
440200******************************************************************44020001
440300* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *44030001
440400* OBJECT WAS UPDATED.                                            *44040001
440500******************************************************************44050001
440600 9000-UPDATE-SELECTION-QUEUE.                                     44060001
440700                                                                  44070001
440800     PERFORM 9100-READ-SEL-QUEUE.                                 44080013
440900                                                                  44090001
441000     SET RC801-UPD (ASC-SEL-SUB) TO TRUE.                         44100013
441100                                                                  44110013
441200     PERFORM 9200-REWRITE-LIST-QUEUE.                             44120013
441300                                                                  44130001
441400******************************************************************44140001
441500* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *44150001
441600******************************************************************44160001
441700 9100-READ-SEL-QUEUE.                                             44170001
441800                                                                  44180001
441900     EXEC CICS                                                    44190001
442000         READQ TS                                                 44200001
442100             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        44210001
442200             INTO  (RC801-PREPACK-SELECT-RECORD)                  44220010
442300             ITEM  (ASC-SEL-ITEM)                                 44230001
442400             RESP  (PV-CICS-RESP)                                 44240001
442500     END-EXEC.                                                    44250001
442600                                                                  44260001
442700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        44270001
442800         CONTINUE                                                 44280001
442900     ELSE                                                         44290001
443000         SET DP013-LOGIC-ABEND                                    44300001
443100             DP013-NO-ROLLBACK   TO TRUE                          44310001
443200         MOVE '9100-READ-SEL-QUEUE'                               44320001
443300                                 TO DP013-PARAGRAPH               44330001
443400         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    44340001
443500                                 TO DP013-MESSAGE-TEXT (1)        44350001
443600         PERFORM DP013-0000-PROCESS-ABEND                         44360001
443700     END-IF.                                                      44370001
443800                                                                  44380001
443900******************************************************************44390001
444000* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *44400001
444100******************************************************************44410001
444200 9200-REWRITE-LIST-QUEUE.                                         44420001
444300     EXEC CICS                                                    44430001
444400          WRITEQ TS                                               44440001
444500              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     44450001
444600              FROM    (RC801-PREPACK-SELECT-RECORD)               44460010
444700              ITEM    (ASC-SEL-ITEM)                              44470001
444800              RESP    (PV-CICS-RESP)                              44480001
444900              REWRITE                                             44490001
445000     END-EXEC.                                                    44500001
445100                                                                  44510001
445200     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    44520001
445300         SET DP013-CICS-ABEND                                     44530001
445400             DP013-NO-ROLLBACK   TO TRUE                          44540001
445500         MOVE '9200-REWRITE-LIST-QUEUE'                           44550001
445600                                 TO DP013-PARAGRAPH               44560001
445700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   44570001
445800                                 TO DP013-MESSAGE-TEXT (1)        44580001
445900         PERFORM DP013-0000-PROCESS-ABEND                         44590001
446000     END-IF.                                                      44600001
446100                                                                  44610004
446200******************************************************************44620001
446300*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *44630001
446400*    AND THE ERROR SWITCHES.                                     *44640001
446500******************************************************************44650001
446600 9900-SOFT-ABORT.                                                 44660001
446700     SET PS-ERROR         TO TRUE.                                44670001
446800     SET DP020-MSG-FATAL  TO TRUE.                                44680001
446900     MOVE 'THROUGH SOFT-ABORT PARA'                               44690001
447000                      TO DP013-MESSAGE-TEXT (1)                   44700001
447100     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    44710001
447200     IF PS-NO-NEXT-SCREEN                                         44720001
447300        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     44730001
447400     END-IF.                                                      44740001
447500     PERFORM 9901-BACKUP.                                         44750001
447600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          44760001
447700     PERFORM 0001-CALL-CICS-ARCH-API.                             44770001
447800                                                                  44780001
447900 9901-BACKUP.                                                     44790001
448000     EXEC CICS SYNCPOINT                                          44800001
448100          ROLLBACK                                                44810001
448200     END-EXEC.                                                    44820001
448300                                                                  44830001
448400*9999-SOFT-ABORT.                                                 44840001
448500*    SET PS-ERROR                                                 44850001
448600*        DP013-LINK-RETURN                                        44860001
448700*        DP013-ROLLBACK                                           44870001
448800*        DP020-NEXT-ACT-APPL-ERROR                                44880001
448900*        DP020-MSG-FATAL         TO TRUE.                         44890001
449000**                                                                44900001
449100*    MOVE PC-TSYMSG-00551        TO DP020-MSG-NUMBER.             44910001
449200*    PERFORM DP013-0000-PROCESS-ABEND.                            44920001
449300                                                                  44930006
449400******************************************************************44940001
449500*    ABEND PROCESSING                                             44950001
449600******************************************************************44960001
449700     COPY DPPD013.                                                44970099
