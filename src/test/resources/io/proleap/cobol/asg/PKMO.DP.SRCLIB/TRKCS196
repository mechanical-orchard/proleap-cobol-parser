000010*-----------------------*                                         00001099
000020 IDENTIFICATION DIVISION.                                         00002099
000030*-----------------------*                                         00003099
000040 PROGRAM-ID.    TRKCS196.                                         00004099
000050 AUTHOR.        RICH MOORE.                                       00005099
000060 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00006099
000070 DATE-WRITTEN.  5/1/99                                            00007099
000080 DATE-COMPILED.                                                   00008099
000090                                                                  00009099
000100*---------------------------------------------------------------* 00010099
000110*    Y196 - REFER TO THE PROGRAM DOCUMENTATION (TRKCS196)       * 00011099
000120*    FOR THE MAJORITY OF PROGRAM DOCUMENTATION.                 * 00012099
000130* ------------------------------------------------------------  * 00013099
000140* | FIELDS FROM THE PASSED COPYBOOK TRWS195.                 |  * 00014099
000150* |----------------------------------------------------------|  * 00015099
000160* | PO NUMBER               | ANY KOHL'S PO                  |  * 00016099
000170* | DEPARTMENT              | ANY KOHL'S DEPARTMENT          |  * 00017099
000180* | LAST XFACTORY RANGE     | FOR IMPORT ORDERS              |  * 00018099
000190* | SHIP DATE RANGE         | FOR ALL ORDERS                 |  * 00019099
000200* | SKU                     | ANY KOHL'S SKU                 |  * 00020099
000210* | CLASS                   | ANY KOHL'S CLASS               |  * 00021099
000220* | SUBCLASS                | ANY KOHL'S SUBCLASS            |  * 00022099
000230* | OTB                     | AN OTB PERIOD                  |  * 00023099
000240* | AD DATE                 | ANY AD EVENT DATE              |  * 00024099
000250* | NEW STORE INDICATOR     | ANY ORDER FOR A NEW STORE      |  * 00025099
000260* | FOB CODE                | FREE ON BOARD POINT CODE       |  * 00026099
000270* | POE CODE                | POINT OF ENTRY CODE            |  * 00027099
000280* | CNTRY ORG               | IMPORT COUNTRY OF ORIGIN       |  * 00028099
000290* | CNTRY PLC               | IMPORT COUNTRY OF PLACEMENT    |  * 00029099
000300* | VENDOR STYLE            | ANY KOHL'S VENDOR STYLE        |  * 00030099
000310* | VENDOR NAME             | KOHL'S VENDOR                  |  * 00031099
000320* | MAKER NAME              | A FACTORY NAME FOR IMPORT      |  * 00032099
000330* | SEASONAL SET            | SEASONAL SET SHORT NAME        |  * 00033099
000340* | DMM                     | DMM                            |  * 00034099
000350* | GROUP CODE              | GROUP CODE                     |  * 00035099
000360* | EDI INDICATOR           | ONLY POS HANDLED BY EDI        |  * 00036099
000370* | PACK BY STORE           | A PACK BY STORE ORDER          |  * 00037099
000380* | DIRECT STORE            | A PO FOR DIRECT STORE          |  * 00038099
000390* | PRE TICKET              | ANY PO WITH PRE TICKETING      |  * 00039099
000400* | PACK TYP(C,S,M,I,B)     | THE PREPACK INDICATOR          |  * 00040099
000410* | STATUS CODE             | SELECT POS WITH ONE STATUS     |  * 00041099
000420* | STATUS GROUP            | SELECT POS UNDER A STATUS GROUP|  * 00042099
000430* | STORE                   | SELECT A STORE WITH ALLOCATION |  * 00043099
000440* | PICTURED AD             | A PO PART OF A PICTURED AD     |  * 00044099
000450* | PO TYPE                 | SELECT THE PO TYPE             |  * 00045099
000460* ------------------------------------------------------------  * 00046099
000470*                                                               * 00047099
000480* ------------------------------------------------------------  * 00048099
000490* | THE ABOVE SECTION INCLUDES THE FIXED DISPLAY AREA.       |  * 00049099
000500* | THE NEXT GROUP INCLUDES THE VARIABLE DISPLAY AREA.       |  * 00050099
000510* |----------------------------------------------------------|  * 00051099
000520* | PO NUMBER               | DISPLAY OF PO IS FIXED         |  * 00052099
000530* | DEPARTMENT              | DEPARTMENT IS ALSO FIXED       |  * 00053099
000540* | VENDOR                  | VENDOR IS ALSO FIXED           |  * 00054099
000550* | DMM                     | DMM IS ALSO FIXED              |  * 00055099
000560* |----------------------------------------------------------|  * 00056099
000570* | THE REMAINING FIELDS CAN BE INCLUDED OR EXCLUDED IN      |  * 00057099
000580* | THE QUERY.  THE ORDER OF THE FIELDS ON THE VIRTUAL       |  * 00058099
000590* | SCREEN ARE DICTATED BY A DEFAULT ORDER.  THE PLACEMENT   |  * 00059099
000600* | CAN ALSO BE OVERRIDEN IN TRKCS195.                       |  * 00060099
000610* |----------------------------------------------------------|  * 00061099
000620* | FOB CODE                | TPLNSHP                        |  * 00062099
000630* | POE CODE                | TPLNSHP                        |  * 00063099
000640* | START & LAST FCTRY DATES| TPLNSHP                        |  * 00064099
000650* | BOOKING DELIVERY        | IMPORT_DATA_CSR                |  * 00065099
000660* | FOB RECEIPT             | IMPORT_DATA_CSR                |  * 00066099
000670* | SAIL DATE               | IMPORT_DATA_CSR                |  * 00067099
000680* | POE ARRIVAL             | IMPORT_DATA_CSR                |  * 00068099
000690* | CONTAINER ID            | TIMCNPO                        |  * 00069099
000700* | CUSTOMS RELEASE         | TIMCSEN AND TIMCSPO            |  * 00070099
000710* | DEVAN DATE              | TIMCNTK AND TIMCNPO            |  * 00071099
000720* | ETA TO ANY OPEN DC      | SHIP_DATA_CSR                  |  * 00072099
000730* | DONT SHIP BEFORE DATE   | TPLNSHP                        |  * 00073099
000740* | CANCEL DATE             | TPLNSHP                        |  * 00074099
000750* | AD DATE                 | TPURITM                        |  * 00075099
000760* | OPEN TO BUY             | TPURCHS                        |  * 00076099
000770* | PACK TYPE               | TPURCHS                        |  * 00077099
000780* | EDI INDICATOR           | TPURCHS                        |  * 00078099
000790* | STATUS CODE             | SELECT POS WITH ONE STATUS     |  * 00079099
000800* | DOLLARS                 | TPURCHS, TPURITM AND TRECEIV   |  * 00080099
000810* | UNITS                   | TRECEIV                        |  * 00081099
000820* | TRIP TYPE               | TIMCSEN/TIMCNTK                |  * 00082099
000830* | DC SPLITS               | TIMPORL/TALLPLN                |  * 00083099
000840* | STORE DISTRO            | TMESTDS                        |  * 00084099
000850* | QUOTA CT                | ???????                        |  * 00085099
000860* | VENDOR STYLE            | XLT_VND_STYL                   |  * 00086099
000870* | CONTAINER RELEASE DATE  | TIMCNTK                        |  * 00087099
000880* | TRAILER AVAILABLE DATE  | TSHIPST                        |  * 00088099
000890*-------------------------------------------------------------  * 00089099
000900*                                                               * 00090099
000910*    TO AID IN UNDERSTANDING THIS PROGRAM LOOK FOR THE          * 00091099
000920*    FOLLOWING:                                                 * 00092099
000930*                                                               * 00093099
000940*    1. ANY TEXT: "#VARIABLE_LOGIC_GROUP_#" DESCRIBES THE       * 00094099
000950*    SPECIAL PROGRAM LOGIC FOR HANDLING THE VARIABLE SCREEN     * 00095099
000960*    PROCESSING.                                                * 00096099
000970*                                                               * 00097099
000980*    2. PROGRAM CODE WITH TEXT: "#VERY_IMPORTANT"               * 00098099
000990*    SHOULD BE HANDLED WITH EXTREME CARE.                       * 00099099
001000*                                                               * 00100099
001010*    3. COMMENTS  WITH THE NAME "#TIP" AID IN DESCRIBING        * 00101099
001020*    MAINTENANCE REQUIREMENTS.                                  * 00102099
001030*                                                               * 00103099
001040* ------------------------------------------------------------  * 00104099
001050* | DOCUMENTATION ON GROUP 1 CODE                            |  * 00105099
001060* |----------------------------------------------------------|  * 00106099
001070* | GROUP 1 CODE IS CALLED IN THE BEGINNING DURING THE       |  * 00107099
001080* | CALL TO 1100-PROCESS-INTER-APPL-COMM.                    |  * 00108099
001090* | THE MAIN PURPOSE OF GROUP 1 CODE IS TO INTEROGATE THE    |  * 00109099
001100* | PASSED SELECTION CRITERIA, DISPLAY CRITERIA AND          |  * 00110099
001110* | SETTING UP THE PAGING OF THE VIRTUAL SCREENS.            |  * 00111099
001120* | THE OUTPUT OF GROUP 1 IS ULTIMATELY A SORTED             |  * 00112099
001130* | TABLE OF THE DISPLAY CONTROL VARIABLES.                  |  * 00113099
001140* |----------------------------------------------------------|  * 00114099
001150* | PARAGRAPHS CALLED IN GROUP 1.                            |  * 00115099
001160* |----------------------------------------------------------|  * 00116099
001170* | LVL 0=  1100-PROCESS-INTER-APPL-COMM (ARCHITECTURE)      |  * 00117099
001180* |      1=    9410-SETUP-VARIABLE-PARAMETERS                |  * 00118099
001190* |       2=      9420-SORT-VARIABLE-CNTL-TABLE              |  * 00119099
001200* |----------------------------------------------------------|  * 00120099
001210* |----------------------------------------------------------|  * 00121099
001220* | DOCUMENTATION ON GROUP 2 CODE                            |  * 00122099
001230* |----------------------------------------------------------|  * 00123099
001240* | GROUP 2 CONTAINS THE MOST CODE FOR HANDLING THE          |  * 00124099
001250* | VARIABLE LOGIC. THE FIRST PART OF THE VARIABLE PART      |  * 00125099
001260* | BEGINS IN 2100-CHECK-FUNCTION-KEY.                       |  * 00126099
001270* |----------------------------------------------------------|  * 00127099
001280* | PARAGRAPHS CALLED IN GROUP 2.                            |  * 00128099
001290* |----------------------------------------------------------|  * 00129099
001300* | LVL 0=     2100-CHECK-FUNCTION-KEY (ARCHITECTURE)        |  * 00130099
001310* | LVL 0=     4400-MOVE-COMMAREA-TO-SCREEN (ARCHITECTURE)   |  * 00131099
001320* |      1=       9500-FORMAT-VARIABLE-DATA                  |  * 00132099
001330* |       2=         10000-REBUILD-CONTROL-TABLES            |  * 00133099
001340* |       2=         9510-PREPARE-VFLD-FOR-DISPLAY           |  * 00134099
001350* |        3=           9530-BUILD-HEADER-SCREEN-AREA        |  * 00135099
001360* |         4=             9550-MOVE-VDATA-TO-SCREEN         |  * 00136099
001370* |      1=       4420-FORMAT-LIST-LINES (ARCHITECTURE)      |  * 00137099
001380* |       2=         9500-FORMAT-VARIABLE-DATA               |  * 00138099
001390* |        3=           10000-REBUILD-CONTROL-TABLES         |  * 00139099
001400* |        3=           9510-PREPARE-VFLD-FOR-DISPLAY        |  * 00140099
001410* |         4=             9520-BUILD-LIST-SCREEN-AREA       |  * 00141099
001420* |          5=               9550-MOVE-VDATA-TO-SCREEN      |  * 00142099
001430* |      1=       9500-FORMAT-VARIABLE-DATA                  |  * 00143099
001440* |       2=         10000-REBUILD-CONTROL-TABLES            |  * 00144099
001450* |       2=         9510-PREPARE-VFLD-FOR-DISPLAY           |  * 00145099
001460* |        3=           9540-BUILD-TOTAL-SCREEN-AREA         |  * 00146099
001470* |         4=             9550-MOVE-VFLD-TO-SCREEN          |  * 00147099
001480* ------------------------------------------------------------  * 00148099
001490*---------------------------------------------------------------* 00149099
001500* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00150099
001510* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00151099
001520* MAKING THE CALL DYNAMIC VS STATIC.                              00152099
001530*---------------------------------------------------------------* 00153099
001540* CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495         00154099
001550* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00155099
001560* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00156099
001570*-----------------------------------------------------------------00157099
001580                                                                  00158099
001590 ENVIRONMENT DIVISION.                                            00159099
001600                                                                  00160099
001610 DATA DIVISION.                                                   00161099
001620                                                                  00162099
001630 WORKING-STORAGE SECTION.                                         00163099
001640                                                                  00164099
001650 01  DK-DB2-KEYS.                                                 00165099
001660     05  DK-PO-NBR                 PIC S9(9) COMP VALUE +0.       00166099
001670     05  DK-SHIPT-ID               PIC S9(9) COMP VALUE +0.       00167099
001680     05  DK-SHIPT-ID-NULL          PIC S9(4) COMP VALUE +0.       00168099
001690     05  DK-OPER-UNT-ID            PIC S9(4) COMP VALUE +0.       00169099
001700     05  DK-CL-NBR-BEG             PIC X(2)  VALUE SPACES.        00170099
001710     05  DK-CL-NBR-END             PIC X(2)  VALUE SPACES.        00171099
001720     05  DK-STR-NBR                PIC S9(04) COMP VALUE +0.      00172099
001730     05  DK-AGRMT-TYP-ID           PIC X(01)  VALUE SPACES.       00173099
001740     05  DK-TYP-CDE                PIC S9(04) VALUE +0            00174099
001750                                              COMP.               00175099
001760 01  PC-PROGRAM-CONSTANTS.                                        00176099
001770     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00177099
001780                                                    'TR196A  '.   00178099
001790     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00179099
001800                                                    'TRKM196 '.   00180099
001810     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00181099
001820                                                    'TRKCS196'.   00182099
001830     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00183099
001840     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00184099
001850     05  PC-PO-QUEUE-SEQ                PIC  9(01)  VALUE 3.      00185099
001860     05  PC-EXTENDED-QUEUE-SEQ          PIC  9(01)  VALUE 4.      00186099
001870     05  PC-JCL-QUEUE-SEQ               PIC  9(01)  VALUE 5.      00187099
001880     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '1'.    00188099
001890     05  PC-PO-CRIT-SUMM-FORMAT         PIC  X(01)  VALUE '2'.    00189099
001900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00190099
001910                                                    COMP SYNC.    00191099
001920     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00192099
001930                                                    COMP SYNC.    00193099
001940     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00194099
001950                                                    +1000000      00195099
001960                                                    COMP-3.       00196099
001970     05  PC-MAX-GROUPS                  PIC S9(09)  VALUE         00197099
001980                                                    +1            00198099
001990                                                    COMP-3.       00199099
002000     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00200099
002010                                                    COMP SYNC.    00201099
002020     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00202099
002030                                                    COMP-3.       00203099
002040     05  PC-INIT-DATE                   PIC  X(10)  VALUE         00204099
002050                                                    '0001-01-01'. 00205099
002060     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00206099
002070     05  PC-CNT-MINUS-2                 PIC S9(04)  VALUE -2      00207099
002080                                                    COMP SYNC.    00208099
002090     05  PC-CNT-6                       PIC S9(04)  VALUE +6      00209099
002100                                                    COMP SYNC.    00210099
002110     05  PC-CNT-7                       PIC S9(04)  VALUE +7      00211099
002120                                                    COMP SYNC.    00212099
002130     05  PC-A                           PIC  X(01)  VALUE 'A'.    00213099
002140     05  PC-E                           PIC  X(01)  VALUE 'E'.    00214099
002150     05  PC-N                           PIC  X(01)  VALUE 'N'.    00215099
002160     05  PC-O                           PIC  X(01)  VALUE 'O'.    00216099
002170     05  PC-R                           PIC  X(01)  VALUE 'R'.    00217099
002180     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00218099
002190     05  PC-AJ                          PIC  X(02)  VALUE 'AJ'.   00219099
002200     05  PC-AIR                         PIC  X(03)  VALUE 'AIR'.  00220099
002210     05  PC-ACT                         PIC  X(03)  VALUE 'ACT'.  00221099
002220     05  PC-CMP                         PIC  X(03)  VALUE 'CMP'.  00222099
002230     05  PC-II                          PIC  X(02)  VALUE 'II'.   00223099
002240     05  PC-00                          PIC  X(02)  VALUE '00'.   00224099
002250     05  PC-IMPORTS-TYP-CDES.                                     00225099
002260       10  PC-IE                        PIC  X(02)  VALUE 'IE'.   00226099
002270       10  PC-IF                        PIC  X(02)  VALUE 'IF'.   00227099
002280       10  PC-IM                        PIC  X(02)  VALUE 'IM'.   00228099
002290     05  PC-OCEAN                       PIC  X(03)  VALUE 'OCN'.  00229099
002300     05  PC-MULTI                       PIC  X(05)  VALUE         00230099
002310                                                    'MULTI'.      00231099
002320     05  PC-OPEN-PAREN                  PIC  X(01)  VALUE '('.    00232099
002330     05  PC-CLOSE-PAREN                 PIC  X(01)  VALUE ')'.    00233099
002340     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00234099
002350     05  PC-COMMA                       PIC  X(01)  VALUE ','.    00235099
002360     05  PC-SEL                         PIC  X(01)  VALUE 'Y'.    00236099
002370     05  PC-QUOTE                       PIC  X(01)  VALUE X'7D'.  00237099
002380     05  PC-ITEMS-PER-PO-QUEUE          PIC S9(04)  VALUE +26     00238099
002390                                                    COMP SYNC.    00239099
002400     05  PC-MAX-VFLDS-LIMIT             PIC  9(02)  VALUE 47.     00240099
002410     05  PC-MAX-DATA-VFLD-LENGTH        PIC  9(02)  VALUE 14.     00241099
002420     05  PC-FIRST-FIELD                 PIC  9(02)  VALUE 1.      00242099
002430     05  PC-SPACES                      PIC  X(49)  VALUE ' '.    00243099
002440     05  PC-DASH                        PIC  X(01)  VALUE '-'.    00244099
002450     05  PC-ASTERICK                    PIC  X(01)  VALUE '*'.    00245099
002460     05  PC-SCREEN-WIDTH                PIC  99  VALUE 49.        00246099
002470     05  PC-DCSTORE-LIMIT               PIC  99  VALUE 12.        00247099
002480     05  PC-FIRST-VSCREEN               PIC  99  VALUE 1.         00248099
002490     05  PC-TRIP                        PIC  X  VALUE '1'.        00249099
002500     05  PC-DEVAN                       PIC  X  VALUE '2'.        00250099
002510     05  PC-LABEL                       PIC  X(20)                00251099
002520                               VALUE 'TOTALS FOR LIST---->'.      00252099
002530                                                                  00253099
002540*---------------------------------------------------------------* 00254099
002550* #VERY_IMPORTANT  ===>                                         * 00255099
002560* THE ORDER BELOW MUST ALWAYS MATCH PV-VARIABLE-DATA-FIELDS     * 00256099
002570* AND THE DISPLAY CONTROL FIELDS IN PV-VARIABLE-CONTROL-FIELDS. * 00257099
002580* IF NOT UNPREDICTABLE RESULTS WILL OCCUR.                      * 00258099
002590*                                                               * 00259099
002600* FURTHERMORE THE ORDER OF THE LIST BELOW DOES NOT CONTROL      * 00260099
002610* THE ORDER A FIELD IS DISPLAYED IN THE VARIABLE VIEW.          * 00261099
002620*---------------------------------------------------------------* 00262099
002630     05  PC-VFLD-FOB-I                  PIC  9(03)  VALUE 1.      00263099
002640     05  PC-VFLD-POE-I                  PIC  9(03)  VALUE 2.      00264099
002650     05  PC-VFLD-DSB-I                  PIC  9(03)  VALUE 3.      00265099
002660     05  PC-VFLD-SXF-I                  PIC  9(03)  VALUE 4.      00266099
002670     05  PC-VFLD-LXF-I                  PIC  9(03)  VALUE 5.      00267099
002680     05  PC-VFLD-CNL-I                  PIC  9(03)  VALUE 6.      00268099
002690     05  PC-VFLD-FRD-I                  PIC  9(03)  VALUE 7.      00269099
002700     05  PC-VFLD-SLD-I                  PIC  9(03)  VALUE 8.      00270099
002710     05  PC-VFLD-PRD-I                  PIC  9(03)  VALUE 9.      00271099
002720     05  PC-VFLD-CNT-I                  PIC  9(03)  VALUE 10.     00272099
002730     05  PC-VFLD-CSR-I                  PIC  9(03)  VALUE 11.     00273099
002740     05  PC-VFLD-DC1-I                  PIC  9(03)  VALUE 12.     00274099
002750     05  PC-VFLD-DC2-I                  PIC  9(03)  VALUE 13.     00275099
002760     05  PC-VFLD-DC3-I                  PIC  9(03)  VALUE 14.     00276099
002770     05  PC-VFLD-DC4-I                  PIC  9(03)  VALUE 15.     00277099
002780     05  PC-VFLD-DC5-I                  PIC  9(03)  VALUE 16.     00278099
002790     05  PC-VFLD-DC6-I                  PIC  9(03)  VALUE 17.     00279099
002800     05  PC-VFLD-DC7-I                  PIC  9(03)  VALUE 18.     00280099
002810     05  PC-VFLD-DC8-I                  PIC  9(03)  VALUE 19.     00281099
002820     05  PC-VFLD-DC9-I                  PIC  9(03)  VALUE 20.     00282099
002830     05  PC-VFLD-DC10-I                 PIC  9(03)  VALUE 21.     00283099
002840     05  PC-VFLD-DC11-I                 PIC  9(03)  VALUE 22.     00284099
002850     05  PC-VFLD-DC12-I                 PIC  9(03)  VALUE 23.     00285099
002860     05  PC-VFLD-DVN-I                  PIC  9(03)  VALUE 24.     00286099
002870     05  PC-VFLD-BKD-I                  PIC  9(03)  VALUE 25.     00287099
002880     05  PC-VFLD-FSC-I                  PIC  9(03)  VALUE 26.     00288099
002890     05  PC-VFLD-TTC-I                  PIC  9(03)  VALUE 27.     00289099
002900     05  PC-VFLD-TVC-I                  PIC  9(03)  VALUE 28.     00290099
002910     05  PC-VFLD-UOR-I                  PIC  9(03)  VALUE 29.     00291099
002920     05  PC-VFLD-URC-I                  PIC  9(03)  VALUE 30.     00292099
002930     05  PC-VFLD-URP-I                  PIC  9(03)  VALUE 31.     00293099
002940     05  PC-VFLD-DOR-I                  PIC  9(03)  VALUE 32.     00294099
002950     05  PC-VFLD-DRC-I                  PIC  9(03)  VALUE 33.     00295099
002960     05  PC-VFLD-DRP-I                  PIC  9(03)  VALUE 34.     00296099
002970     05  PC-VFLD-OTB-I                  PIC  9(03)  VALUE 35.     00297099
002980     05  PC-VFLD-EDI-I                  PIC  9(03)  VALUE 36.     00298099
002990     05  PC-VFLD-PPK-I                  PIC  9(03)  VALUE 37.     00299099
003000     05  PC-VFLD-STA-I                  PIC  9(03)  VALUE 38.     00300099
003010     05  PC-VFLD-AED-I                  PIC  9(03)  VALUE 39.     00301099
003020     05  PC-VFLD-TRP-I                  PIC  9(03)  VALUE 40.     00302099
003030     05  PC-VFLD-SPL-CRT-I              PIC  9(03)  VALUE 41.     00303099
003040     05  PC-VFLD-SPL-SNT-I              PIC  9(03)  VALUE 42.     00304099
003050     05  PC-VFLD-STD-I                  PIC  9(03)  VALUE 43.     00305099
003060     05  PC-VFLD-QCT-I                  PIC  9(03)  VALUE 44.     00306099
003070     05  PC-VFLD-VNS-I                  PIC  9(03)  VALUE 45.     00307099
003080     05  PC-VFLD-CRL-I                  PIC  9(03)  VALUE 46.     00308099
003090     05  PC-VFLD-TRA-I                  PIC  9(03)  VALUE 47.     00309099
003100                                                                  00310099
003110     05  PC-TSYMSG-NUMBERS.                                       00311099
003120         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00312099
003130         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00313099
003140         10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  00314099
003150         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00315099
003160         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00316099
003170         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00317099
003180         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00318099
003190         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00319099
003200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00320099
003210         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00321099
003220         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00322099
003230         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00323099
003240         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00324099
003250         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  00325099
003260         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00326099
003270         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  00327099
003280         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  00328099
003290         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00329099
003300         10  PC-TSYMSG-00317            PIC  9(05)  VALUE 00317.  00330099
003310         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  00331099
003320         10  PC-TSYMSG-00336            PIC  9(05)  VALUE 00336.  00332099
003330         10  PC-TSYMSG-00486            PIC  9(05)  VALUE 00486.  00333099
003340         10  PC-TSYMSG-00587            PIC  9(05)  VALUE 00587.  00334099
003350         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  00335099
003360         10  PC-TSYMSG-00693            PIC  9(05)  VALUE 00693.  00336099
003370         10  PC-TSYMSG-00694            PIC  9(05)  VALUE 00694.  00337099
003380         10  PC-TSYMSG-01021            PIC  9(05)  VALUE 01021.  00338099
003390         10  PC-TSYMSG-01409            PIC  9(05)  VALUE 01409.  00339099
003400         10  PC-TSYMSG-01451            PIC  9(05)  VALUE 01451.  00340099
003410         10  PC-TSYMSG-01452            PIC  9(05)  VALUE 01452.  00341099
003420         10  PC-TSYMSG-01570            PIC  9(05)  VALUE 01570.  00342099
003430         10  PC-TSYMSG-01882            PIC  9(05)  VALUE 01882.  00343099
003440         10  PC-TSYMSG-01993            PIC  9(05)  VALUE 01993.  00344099
003450         10  PC-TSYMSG-02016            PIC  9(05)  VALUE 02016.  00345099
003460         10  PC-TSYMSG-02667            PIC  9(05)  VALUE 02667.  00346099
003470         10  PC-TSYMSG-02982            PIC  9(05)  VALUE 02982.  00347099
003480***  ADDED WS FIELDS START  - 3/7                                 00348099
003490     05  PC-PROD-JOB-TRK950       PIC  X(08)  VALUE  'TRK950  '.  00349099
003500     05  PC-PROD-CLASS.                                           00350099
003510         10  FILLER               PIC  X(36)  VALUE               00351099
003520         '//      CLASS=Q,MSGCLASS=P,REGION=8M'.                  00352099
003530         10  FILLER               PIC  X(44)  VALUE  SPACES.      00353099
003540     05  PC-PROD-LIBSRCH.                                         00354099
003550         10  FILLLER              PIC  X(40)  VALUE               00355099
003560         '//*                                     '.              00356099
003570     05  PC-PROD-JOB-PARM.                                        00357099
003580         10  FILLER               PIC  X(03)  VALUE  '//*'.       00358099
003590         10  FILLER               PIC  X(77)  VALUE  SPACES.      00359099
003600     05  PC-PROD-JOBLIB.                                          00360099
003610         10  FILLER               PIC  X(39)  VALUE               00361099
003620         '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.               00362099
003630         10  FILLER               PIC  X(41)  VALUE  SPACES.      00363099
003640     05  PC-PROD-PROC-TR.                                         00364099
003650         10  FILLER               PIC  X(29)  VALUE               00365099
003660         '//PS010   EXEC TRK9501,USRID='.                         00366099
003670         10  FILLER               PIC  X(01)  VALUE QUOTE.        00367099
003680         10  PC-PROD-USRID        PIC  X(07)  VALUE  SPACES.      00368099
003690         10  FILLER               PIC  X(01)  VALUE QUOTE.        00369099
003700         10  FILLER               PIC  X(07)  VALUE               00370099
003710         ',CRDTE='.                                               00371099
003720         10  FILLER               PIC  X(01)  VALUE QUOTE.        00372099
003730         10  FILLER               PIC  X(01)  VALUE 'D'.          00373099
003740         10  PC-PROD-CRMNTH       PIC  X(02)  VALUE  SPACES.      00374099
003750         10  PC-PROD-CRDAY        PIC  X(02)  VALUE  SPACES.      00375099
003760         10  PC-PROD-CRYEAR       PIC  X(02)  VALUE  SPACES.      00376099
003770         10  FILLER               PIC  X(01)  VALUE QUOTE.        00377099
003780         10  FILLER               PIC  X(07)  VALUE               00378099
003790         ',CRTIM='.                                               00379099
003800         10  FILLER               PIC  X(01)  VALUE QUOTE.        00380099
003810         10  FILLER               PIC  X(01)  VALUE 'T'.          00381099
003820         10  PC-PROD-CRHOUR       PIC  X(02)  VALUE  SPACES.      00382099
003830         10  PC-PROD-CRMIN        PIC  X(02)  VALUE  SPACES.      00383099
003840         10  PC-PROD-CRSEC        PIC  X(02)  VALUE  SPACES.      00384099
003850         10  FILLER               PIC  X(01)  VALUE QUOTE.        00385099
003860         10  FILLER               PIC  X(10)  VALUE  SPACES.      00386099
003870***********************************************************       00387099
003880*       JCL FOR CICST1 SUBMITS                                    00388099
003890***********************************************************       00389099
003900     05  PC-TEST-CLASS.                                           00390099
003910         10  FILLER               PIC  X(44)  VALUE               00391099
003920         '//      CLASS=A,MSGCLASS=X,REGION=8M,NOTIFY='.          00392099
003930         10  PC-TEST-NOTIFY-ID    PIC  X(07).                     00393099
003940         10  FILLER               PIC  X(29)  VALUE SPACES.       00394099
003950*        ',TYPRUN=HOLD                 '.                         00395099
003960     05  PC-TEST-LIBSRCH.                                         00396099
003970         10  FILLER               PIC  X(40)  VALUE               00397099
003980         '//LIBSRCH  JCLLIB ORDER=TKMA.PROCLIB    '.              00398099
003990         10  FILLER               PIC  X(40)  VALUE  SPACES.      00399099
004000     05  PC-TEST-JOB-PARM.                                        00400099
004010         10  FILLER               PIC  X(18)  VALUE               00401099
004020         '/*JOBPARM P=PROC01'.                                    00402099
004030         10  FILLER               PIC  X(62)  VALUE  SPACES.      00403099
004040     05  PC-TEST-JOBLIB.                                          00404099
004050         10  FILLER               PIC  X(39)  VALUE               00405099
004060         '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.               00406099
004070         10  FILLER               PIC  X(41)  VALUE  SPACES.      00407099
004080     05  PC-TEST-PROC-TR.                                         00408099
004090         10  FILLER               PIC  X(29)  VALUE               00409099
004100         '//PS010   EXEC TRK9501,USRID='.                         00410099
004110         10  FILLER               PIC  X(01)  VALUE QUOTE.        00411099
004120         10  PC-TEST-USRID        PIC  X(07)  VALUE  SPACES.      00412099
004130         10  FILLER               PIC  X(01)  VALUE QUOTE.        00413099
004140         10  FILLER               PIC  X(07)  VALUE               00414099
004150         ',CRDTE='.                                               00415099
004160         10  FILLER               PIC  X(01)  VALUE QUOTE.        00416099
004170         10  FILLER               PIC  X(01)  VALUE 'D'.          00417099
004180         10  PC-TEST-CRMNTH       PIC  X(02)  VALUE  SPACES.      00418099
004190         10  PC-TEST-CRDAY        PIC  X(02)  VALUE  SPACES.      00419099
004200         10  PC-TEST-CRYEAR       PIC  X(02)  VALUE  SPACES.      00420099
004210         10  FILLER               PIC  X(01)  VALUE QUOTE.        00421099
004220         10  FILLER               PIC  X(07)  VALUE               00422099
004230         ',CRTIM='.                                               00423099
004240         10  FILLER               PIC  X(01)  VALUE QUOTE.        00424099
004250         10  FILLER               PIC  X(01)  VALUE 'T'.          00425099
004260         10  PC-TEST-CRHOUR       PIC  X(02)  VALUE  SPACES.      00426099
004270         10  PC-TEST-CRMIN        PIC  X(02)  VALUE  SPACES.      00427099
004280         10  PC-TEST-CRSEC        PIC  X(02)  VALUE  SPACES.      00428099
004290         10  FILLER               PIC  X(01)  VALUE QUOTE.        00429099
004300         10  FILLER               PIC  X(10)  VALUE  SPACES.      00430099
004310                                                                  00431099
004320***  ADDED WS FIELDS  END   - 3/7                                 00432099
004330                                                                  00433099
004340 01  PS-PROGRAM-SWITCHES.                                         00434099
004350     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00435099
004360         88  PS-NO-ERROR                            VALUE 'Y'.    00436099
004370         88  PS-ERROR                               VALUE 'N'.    00437099
004380     05  PS-LIST-SW                     PIC  X(01)  VALUE 'N'.    00438099
004390         88  PS-LIST-END                            VALUE 'Y'.    00439099
004400         88  PS-NO-LIST-END                         VALUE 'N'.    00440099
004410     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00441099
004420         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00442099
004430         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00443099
004440     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00444099
004450         88  PS-DONE                                VALUE 'Y'.    00445099
004460         88  PS-NOT-DONE                            VALUE 'N'.    00446099
004470     05  PS-BKR-FRGT-RLSE-SW            PIC  X(01)  VALUE 'N'.    00447099
004480         88  PS-BKR-FRGT-RLSE                       VALUE 'Y'.    00448099
004490         88  PS-BKR-FRGT-RLSE-NO                    VALUE 'N'.    00449099
004500     05  PS-SKIP-SW                     PIC  X(01)  VALUE 'N'.    00450099
004510         88  PS-DONT-SKIP                           VALUE 'N'.    00451099
004520         88  PS-SKIP                                VALUE 'Y'.    00452099
004530     05  PS-INCLUDE-TOTALS-SW           PIC  X(01)  VALUE 'N'.    00453099
004540         88  PS-INCLUDE-TOTALS                      VALUE 'Y'.    00454099
004550     05  PS-PURITM-SW                   PIC  X(01)  VALUE 'Y'.    00455099
004560         88  PS-206-PURITM                          VALUE 'Y'.    00456099
004570         88  PS-000-PURITM                          VALUE 'N'.    00457099
004580     05  PS-TPURITM-SW                  PIC  X(01)  VALUE 'N'.    00458099
004590         88  PS-DONT-USE-TPURITM                    VALUE 'N'.    00459099
004600         88  PS-USE-TPURITM                         VALUE 'Y'.    00460099
004610     05  PS-XFC-INLINE-SW               PIC  X(01)  VALUE 'N'.    00461099
004620         88  PS-DONT-USE-XFC-INLINE                 VALUE 'N'.    00462099
004630         88  PS-USE-XFC-INLINE                      VALUE 'Y'.    00463099
004640     05  PS-DSB-INLINE-SW               PIC  X(01)  VALUE 'N'.    00464099
004650         88  PS-DONT-USE-DSB-INLINE                 VALUE 'N'.    00465099
004660         88  PS-USE-DSB-INLINE                      VALUE 'Y'.    00466099
004670     05  PS-TENTNME-SW                  PIC  X(01)  VALUE 'N'.    00467099
004680         88  PS-DONT-USE-TENTNME                    VALUE 'N'.    00468099
004690         88  PS-USE-TENTNME                         VALUE 'Y'.    00469099
004700     05  PS-MAKER-NME-SW                PIC  X(01)  VALUE 'N'.    00470099
004710         88  PS-DONT-USE-MAKER-NME                  VALUE 'N'.    00471099
004720         88  PS-USE-MAKER-NME                       VALUE 'Y'.    00472099
004730     05  PS-TMDSEAR-SW                  PIC  X(01)  VALUE 'N'.    00473099
004740         88  PS-DONT-USE-TMDSEAR                    VALUE 'N'.    00474099
004750         88  PS-USE-TMDSEAR                         VALUE 'Y'.    00475099
004760     05  PS-TUPC-SW                     PIC  X(01)  VALUE 'N'.    00476099
004770         88  PS-DONT-USE-TUPC                       VALUE 'N'.    00477099
004780         88  PS-USE-TUPC                            VALUE 'Y'.    00478099
004790     05  PS-TSKXREF-SW                  PIC  X(01)  VALUE 'N'.    00479099
004800         88  PS-DONT-USE-TSKXREF                    VALUE 'N'.    00480099
004810         88  PS-USE-TSKXREF                         VALUE 'Y'.    00481099
004820     05  PS-XLT-SKU-SW                  PIC  X(01)  VALUE 'N'.    00482099
004830         88  PS-DONT-USE-XLT-SKU                    VALUE 'N'.    00483099
004840         88  PS-USE-XLT-SKU                         VALUE 'Y'.    00484099
004850     05  PS-XLT-VND-STYL-SW             PIC  X(01)  VALUE 'N'.    00485099
004860         88  PS-DONT-USE-XLT-VND-STYL               VALUE 'N'.    00486099
004870         88  PS-USE-XLT-VND-STYL                    VALUE 'Y'.    00487099
004880     05  PS-TMESTDS-SW                  PIC  X(01)  VALUE 'N'.    00488099
004890         88  PS-DONT-USE-TMESTDS                    VALUE 'N'.    00489099
004900         88  PS-USE-TMESTDS                         VALUE 'Y'.    00490099
004910     05  PS-DISP-CNTL1-SW               PIC  X(01)  VALUE ' '.    00491099
004920         88  BUILD-HEADER-1                         VALUE '1'.    00492099
004930         88  BUILD-HEADER-2                         VALUE '2'.    00493099
004940         88  BUILD-LINE                             VALUE '3'.    00494099
004950         88  BUILD-TOTAL                            VALUE '4'.    00495099
004960     05  PS-DISP-CNTL2-SW               PIC  X(01)  VALUE ' '.    00496099
004970         88  DISPLAY-HEADER                         VALUE 'H'.    00497099
004980         88  DISPLAY-LIST                           VALUE 'D'.    00498099
004990         88  DISPLAY-TOTAL                          VALUE 'T'.    00499099
005000     05  PS-DISP-CNTL3-SW               PIC  X(01)  VALUE 'N'.    00500099
005010         88  DO-SCREEN-DIMENSION                    VALUE 'Y'.    00501099
005020         88  NO-SCREEN-DIMENSION                    VALUE 'N'.    00502099
005030     05  PS-DISP-CNTL4-SW               PIC  X(01)  VALUE 'N'.    00503099
005040         88  FIRST-FIELD                            VALUE 'Y'.    00504099
005050         88  NOT-FIRST-FIELD                        VALUE 'N'.    00505099
005060     05  PS-TABLE-SELPO-SW              PIC X(03)  VALUE 'NO '.   00506099
005070         88  MORE-SELPO-DATA                       VALUE 'YES'.   00507099
005080         88  NO-MORE-SELPO-DATA                    VALUE 'NO '.   00508099
005090     05  PS-TABLE-LISTPO-SW             PIC X(03) VALUE 'NO '.    00509099
005100         88  MORE-CURSOR-DATA                      VALUE 'YES'.   00510099
005110         88  NO-MORE-CURSOR-DATA                   VALUE 'NO '.   00511099
005120     05  PS-TABLE-STORE-SW              PIC X(03)  VALUE 'NO '.   00512099
005130         88  MORE-STORE-DATA                       VALUE 'YES'.   00513099
005140         88  NO-MORE-STORE-DATA                    VALUE 'NO '.   00514099
005150     05  PS-DISPLAY-DC-SPLITS-SW        PIC  X(01)  VALUE 'N'.    00515099
005160         88  PS-DISPLAY-DC-SPLITS                   VALUE 'Y'.    00516099
005170         88  PS-DISPLAY-DC-SPLITS-NO                VALUE 'N'.    00517099
005180     05  PS-EOC-DC-SPLITS-SW           PIC  X(01)    VALUE 'N'.   00518099
005190         88  PS-EOC-DC-SPLITS                        VALUE 'Y'.   00519099
005200         88  PS-EOC-DC-SPLITS-NO                     VALUE 'N'.   00520099
005210                                                                  00521099
005220 01  PV-PROGRAM-VARIABLES.                                        00522099
005230     05  PV-SUB                         PIC S9(04)  VALUE +0      00523099
005240                                                    COMP SYNC.    00524099
005250     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00525099
005260                                                    COMP SYNC.    00526099
005270     05  PV-SELECT-BYTES                PIC S9(04)  VALUE +137    00527099
005280                                                    COMP SYNC.    00528099
005290     05  PV-STRING-POINTER-SELECT       PIC S9(04)  VALUE +0      00529099
005300                                                    COMP   SYNC.  00530099
005310     05  PV-STRING-POINTER-FROM         PIC S9(04)  VALUE +0      00531099
005320                                                    COMP   SYNC.  00532099
005330     05  PV-STRING-POINTER-WHERE        PIC S9(04)  VALUE +0      00533099
005340                                                    COMP   SYNC.  00534099
005350     05  PV-TALLY-1                     PIC S9(04)  VALUE +0      00535099
005360                                                    COMP   SYNC.  00536099
005370     05  PV-TALLY-2                     PIC S9(04)  VALUE +0      00537099
005380                                                    COMP   SYNC.  00538099
005390     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00539099
005400                                                    COMP-3.       00540099
005410     05  PV-PO-COUNT                    PIC S9(09)  VALUE +0      00541099
005420                                                    COMP-3.       00542099
005430     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00543099
005440                                                    COMP-3.       00544099
005450     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00545099
005460                                                    COMP-3.       00546099
005470     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00547099
005480                                                    COMP-3.       00548099
005490     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00549099
005500                                                    COMP-3.       00550099
005510     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00551099
005520                                                    COMP-3.       00552099
005530     05  PV-MAX-ITEMS                   PIC S9(09)  VALUE +0      00553099
005540                                                    COMP-3.       00554099
005550     05  PV-TEMP-NUM                    PIC S9(09)  VALUE +0      00555099
005560                                                    COMP-3.       00556099
005570     05  PV-GROUPS-TO-READ              PIC S9(09)  VALUE +0      00557099
005580                                                    COMP-3.       00558099
005590     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      00559099
005600                                                    COMP-3.       00560099
005610     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      00561099
005620                                                    COMP SYNC.    00562099
005630     05  PV-JCL-NUMBER                  PIC S9(04)  VALUE +0      00563099
005640                                                    COMP SYNC.    00564099
005650     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00565099
005660                                                    COMP SYNC.    00566099
005670     05  PV-ITEM                        PIC S9(04)  VALUE +0      00567099
005680                                                    COMP SYNC.    00568099
005690     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      00569099
005700                                                    COMP SYNC.    00570099
005710     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      00571099
005720                                                    COMP SYNC.    00572099
005730     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      00573099
005740                                                    COMP SYNC.    00574099
005750     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      00575099
005760                                                    COMP SYNC.    00576099
005770     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      00577099
005780                                                    COMP SYNC.    00578099
005790     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      00579099
005800                                                    COMP SYNC.    00580099
005810     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      00581099
005820                                                    COMP SYNC.    00582099
005830     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      00583099
005840                                                    COMP SYNC.    00584099
005850     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      00585099
005860                                                    COMP SYNC.    00586099
005870     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      00587099
005880                                                    COMP SYNC.    00588099
005890     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      00589099
005900                                                    COMP SYNC.    00590099
005910     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      00591099
005920                                                    COMP SYNC.    00592099
005930     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      00593099
005940                                                    COMP SYNC.    00594099
005950     05  PV-TEMP-PO-NBR                 PIC 9(09)   VALUE ZEROS.  00595099
005960     05  PV-TEMP-STR-NBR                PIC 9(05)   VALUE ZEROS.  00596099
005970     05  PV-TEMP-DEPT-NBR               PIC 9(04)   VALUE ZEROS.  00597099
005980     05  PV-TEMP-DEPT-NBR-X REDEFINES PV-TEMP-DEPT-NBR.           00598099
005990         10 PV-TEMP-DEPT-NBR-X-1        PIC X(01).                00599099
006000         10 PV-TEMP-DEPT-NBR-X-2        PIC X(03).                00600099
006010     05  PV-LQW-DEPT-NBR                PIC 9(04)   VALUE ZEROS.  00601099
006020     05  PV-LQW-DEPT-NBR-X REDEFINES PV-LQW-DEPT-NBR.             00602099
006030         10 PV-LQW-DEPT-NBR-X-1         PIC X(01).                00603099
006040         10 PV-LQW-DEPT-NBR-X-2         PIC X(03).                00604099
006050     05  PV-TEMP-CLASS                  PIC 9(04)   VALUE ZEROS.  00605099
006060     05  PV-TEMP-CLASS-X REDEFINES PV-TEMP-CLASS.                 00606099
006070         10 PV-TEMP-CLASS-X-1           PIC X(02).                00607099
006080         10 PV-TEMP-CLASS-X-2           PIC X(02).                00608099
006090     05  PV-TEMP-SUBCLASS               PIC 9(04)   VALUE ZEROS.  00609099
006100     05  PV-TEMP-SUBCLASS-X REDEFINES PV-TEMP-SUBCLASS.           00610099
006110         10 PV-TEMP-SUBCLASS-X-1        PIC X(02).                00611099
006120         10 PV-TEMP-SUBCLASS-X-2        PIC X(02).                00612099
006130     05  PV-TEMP-SKU                    PIC 9(08)   VALUE ZEROS.  00613099
006140     05  PV-NULL-IND                    PIC S9(04)  VALUE +0 COMP.00614099
006150     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0 COMP.00615099
006160     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0 COMP.00616099
006170     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0 COMP.00617099
006180     05  PV-NULL-IND-4                  PIC S9(04)  VALUE +0 COMP.00618099
006190     05  PV-I                           PIC S9(09)  VALUE +0      00619099
006200                                                    COMP-3.       00620099
006210     05  PV-J                           PIC S9(09)  VALUE +0      00621099
006220                                                    COMP-3.       00622099
006230     05  PV-DC-I                        PIC S9(09)  VALUE +0      00623099
006240                                                    COMP-3.       00624099
006250     05  PV-INCREMENT                   PIC S9(09)  VALUE +0      00625099
006260                                                    COMP-3.       00626099
006270     05  PV-INDEX                       PIC S9(09)  VALUE +0      00627099
006280                                                    COMP-3.       00628099
006290     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      00629099
006300                                                    COMP-3.       00630099
006310     05  PV-DB2-COUNT2                  PIC S9(09)  VALUE +0      00631099
006320                                                    COMP-3.       00632099
006330     05  PV-GP-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3.     00633099
006340     05  PV-TOT-FIRST-COST              PIC S9(9)V99 COMP-3.      00634099
006350     05  PV-TOT-TTC                     PIC S9(9)V99 COMP-3.      00635099
006360     05  PV-TOT-TVC                     PIC S9(9)V99 COMP-3.      00636099
006370     05  PV-TOTAL-CURR-SPLIT-QTY        PIC  S9(13)  VALUE +0     00637099
006380                                                     COMP-3.      00638099
006390     05  PV-TOTAL-CURR-SPLIT-QTY-NULL   PIC S9(04)   VALUE +0     00639099
006400                                                     COMP.        00640099
006410     05  PV-TR195-STR-NBR               PIC X(05).                00641099
006420     05  PV-WORK-DT                     PIC X(8).                 00642099
006430     05  PV-WORK-ETA-ATA                PIC X(02).                00643099
006440     05  PV-WORK-ETA-ATA-DC1            PIC X(02).                00644099
006450     05  PV-WORK-ETA-ATA-DC2            PIC X(02).                00645099
006460     05  PV-WORK-ETA-ATA-DC3            PIC X(02).                00646099
006470     05  PV-WORK-ETA-ATA-DC4            PIC X(02).                00647099
006480     05  PV-WORK-ETA-ATA-DC5            PIC X(02).                00648099
006490     05  PV-WORK-ETA-ATA-DC6            PIC X(02).                00649099
006500     05  PV-WORK-ETA-ATA-DC7            PIC X(02).                00650099
006510     05  PV-WORK-ETA-ATA-DC8            PIC X(02).                00651099
006520     05  PV-WORK-ETA-ATA-DC9            PIC X(02).                00652099
006530     05  PV-WORK-ETA-ATA-DC10           PIC X(02).                00653099
006540     05  PV-WORK-ETA-ATA-DC11           PIC X(02).                00654099
006550     05  PV-WORK-ETA-ATA-DC12           PIC X(02).                00655099
006560     05  PV-WORK-OTB                    PIC X(6).                 00656099
006570     05  PV-DATE                        PIC X(5).                 00657099
006580     05  FILLER REDEFINES PV-DATE.                                00658099
006590         10  PV-DATE-MONTH              PIC XX.                   00659099
006600         10  PV-DATE-SLASH              PIC X.                    00660099
006610         10  PV-DATE-DAY                PIC XX.                   00661099
006620     05  PV-DATE-FIELD.                                           00662099
006630         10 PV-DT-MM                    PIC  X(02).               00663099
006640         10 PV-DT-DD                    PIC  X(02).               00664099
006650         10 PV-DT-CC                    PIC  X(02).               00665099
006660         10 PV-DT-YY                    PIC  X(02).               00666099
006670     05  PV-TABLE-QUALIFIER.                                      00667099
006680         10 FILLER                      PIC X(03) VALUE 'DB2'.    00668099
006690         10 PV-QUALIFIER                PIC X(01) VALUE ' '.      00669099
006700         10 FILLER                      PIC X(03) VALUE 'DBA'.    00670099
006710         10 FILLER                      PIC X(01) VALUE '.'.      00671099
006720     05  PV-TABLE-QUALIFIER-COMMA.                                00672099
006730         10 FILLER                      PIC X(04) VALUE ',DB2'.   00673099
006740         10 PV-QUALIFIER-COMMA          PIC X(01) VALUE ' '.      00674099
006750         10 FILLER                      PIC X(03) VALUE 'DBA'.    00675099
006760         10 FILLER                      PIC X(01) VALUE '.'.      00676099
006770                                                                  00677099
006780     05  PV-CICS-MSG-SQL1               PIC X(120) VALUE SPACE.   00678099
006790     05  PV-CICS-MSG-SQL2               PIC X(120) VALUE SPACE.   00679099
006800     05  PV-CICS-MSG-SQL3               PIC X(120) VALUE SPACE.   00680099
006810     05  PV-CICS-MSG-SQL4               PIC X(120) VALUE SPACE.   00681099
006820     05  PV-CICS-MSG-SQL5               PIC X(120) VALUE SPACE.   00682099
006830     05  PV-TASK-DUR-DUMP               PIC ZZ9.99.               00683099
006840     05  PV-MAX-GROUP-FMT               PIC X.                    00684099
006850     05  PV-POS-READ-FMT                PIC ZZZZZZ.               00685099
006860     05  PV-CICS-MSG-AREA               PIC X(120).               00686099
006870                                                                  00687099
006880     05  PV-MAKER-DESC                  PIC X(37) VALUE SPACES.   00688099
006890     05  PV-QUOTA-CATEGORY              PIC X(05).                00689099
006900     05  PV-ENT-NAME-DESC               PIC X(32) VALUE SPACES.   00690099
006910     05  PV-VEND-STYL-NME               PIC X(22) VALUE SPACES.   00691099
006920     05  PV-PO-TYP-CDE                  PIC X(02) VALUE SPACES.   00692099
006930     05  PV-SYSTEM-ID.                                            00693099
006940         10  FILLER                     PIC  X(04)  VALUE SPACE.  00694099
006950         10  PV-REGION-IND              PIC  X(01).               00695099
006960             88  PV-TEST-CICS                 VALUE 'T'.          00696099
006970             88  PV-QA-CICS                   VALUE 'Q'.          00697099
006980             88  PV-PROD-CICS                 VALUE 'P'.          00698099
006990             88  PV-LEARN-CICS                VALUE 'L'.          00699099
007000         10  FILLER                     PIC X(01)    VALUE SPACES.00700099
007010     05  FILLER                         PIC X(02)    VALUE SPACES.00701099
007020                                                                  00702099
007030***  ADDED WS FIELDS START  - 3/7                                 00703099
007040     05  PV-SYSTM-ID              PIC  X(04)  VALUE SPACES.       00704099
007050         88 PV-CIT1-CICS                      VALUE 'CIT1'.       00705099
007060         88 PV-CIQA-CICS                      VALUE 'CIQA'.       00706099
007070     05  PV-USER-ID               PIC  X(08)  VALUE SPACES.       00707099
007080     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00708099
007090                                              COMP SYNC.          00709099
007100     05  PV-TEST-JOB.                                             00710099
007110         10  PV-TEST-JOB-USER-ID  PIC  X(07).                     00711099
007120         10  FILLER               PIC  X(01)  VALUE 'T'.          00712099
007130                                                                  00713099
007140***  05  PV-BUYER-NAME            PIC  X(25).                     00714099
007150***  05  PV-BUYER-NUMBER          PIC  X(03).                     00715099
007160***  05  PV-BUYER.                                                00716099
007170***      10  FILLER               PIC  X(01)  VALUE 'B'.          00717099
007180***      10  PV-BYR-NBR           PIC  X(03).                     00718099
007190***      10  FILLER               PIC  X(03)  VALUE '   '.        00719099
007200***      10  PV-BYR-NAME          PIC  X(25).                     00720099
007210                                                                  00721099
007220 01  TD-TRANSIENT-DATE-AREA.                                      00722099
007230     05  TD-QUEUE-NAME            PIC  X(04)  VALUE 'IRTD'.       00723099
007240     05  TD-JCL-LINE              PIC  X(80)  VALUE SPACES.       00724099
007250     05  TD-JCL-LINE-LENGTH       PIC S9(04)  VALUE +80           00725099
007260                                              COMP SYNC.          00726099
007270     05  TD-Q-NAME-LENGTH         PIC S9(04)  VALUE +4            00727099
007280                                              COMP SYNC.          00728099
007290                                                                  00729099
007300 01  JL-JCL-LINE-AREA.                                            00730099
007310     05  JL-JCL-LINE-1.                                           00731099
007320         10  FILLER               PIC  X(02)  VALUE '//'.         00732099
007330         10  JL-JOB-NAME          PIC  X(08).                     00733099
007340         10  FILLER               PIC  X(11)  VALUE               00734099
007350         ' JOB KOHLS,'.                                           00735099
007360         10  FILLER               PIC  X(01)  VALUE QUOTE.        00736099
007370         10  FILLER               PIC  X(13)  VALUE               00737099
007380         'PO RECAP FILE'.                                         00738099
007390         10  FILLER               PIC  X(01)  VALUE QUOTE.        00739099
007400         10  FILLER               PIC  X(01)  VALUE ','.          00740099
007410         10  FILLER               PIC  X(43)  VALUE SPACES.       00741099
007420     05  JL-JCL-LINE-2.                                           00742099
007430         10  JL-JCL-CLASS         PIC  X(80).                     00743099
007440********************************************************          00744099
007450*   LINE-2T IS USED WHEN TESTING A PROC IN TKMA.PROCLIB           00745099
007460********************************************************          00746099
007470     05  JL-JCL-LINE-2T.                                          00747099
007480         10  JL-JCL-LIBSRCH       PIC  X(80).                     00748099
007490     05  JL-JCL-LINE-3.                                           00749099
007500         10  JL-JCL-JOB-PARM      PIC  X(80).                     00750099
007510     05  JL-JCL-LINE-4.                                           00751099
007520         10  FILLER               PIC  X(40)  VALUE               00752099
007530         '//**************************************'.              00753099
007540         10  FILLER               PIC  X(40)  VALUE               00754099
007550         '****************************************'.              00755099
007560     05  JL-JCL-LINE-5.                                           00756099
007570         10  FILLER               PIC  X(40)  VALUE               00757099
007580         '//**   JOB WILL CREATE A FILE BASED ON P'.              00758099
007590         10  FILLER               PIC  X(40)  VALUE               00759099
007600         'O RECAP SELECTIONS MADE                 '.              00760099
007610     05  JL-JCL-LINE-6.                                           00761099
007620         10  FILLER               PIC  X(40)  VALUE               00762099
007630         '//**************************************'.              00763099
007640         10  FILLER               PIC  X(40)  VALUE               00764099
007650         '****************************************'.              00765099
007660     05  JL-JCL-LINE-7.                                           00766099
007670         10  JL-JCL-JOBLIB        PIC  X(80).                     00767099
007680     05  JL-JCL-LINE-8.                                           00768099
007690         10  JL-JCL-PROC          PIC  X(80).                     00769099
007700     05  JL-JCL-LINE-9.                                           00770099
007710         10  FILLER               PIC  X(21)  VALUE               00771099
007720         '//S010.SYSUT1   DD * '.                                 00772099
007730         10  FILLER               PIC  X(59)  VALUE SPACES.       00773099
007740***** THIS SHOULD BE USED FOR 19 LINES OF INSTREAM DATA           00774099
007750     05  JL-JCL-LINE-10.                                          00775099
007760         10  JL-JCL-SELECT        PIC  X(80)  VALUE SPACES.       00776099
007770     05  JL-JCL-LINE-11.                                          00777099
007780         10  FILLER               PIC  X(02)  VALUE '/*'.         00778099
007790         10  FILLER               PIC  X(78)  VALUE SPACES.       00779099
007800     05  JL-JCL-LINE-12.                                          00780099
007810         10  FILLER               PIC  X(03)  VALUE '//*'.        00781099
007820         10  FILLER               PIC  X(77)  VALUE SPACES.       00782099
007830     05  JL-JCL-LINE-13.                                          00783099
007840         10  FILLER               PIC  X(21)  VALUE               00784099
007850         '//S020.SYSUT1   DD * '.                                 00785099
007860         10  FILLER               PIC  X(59)  VALUE SPACES.       00786099
007870***** THIS SHOULD BE USED FOR 3 LINES OF INSTREAM DATA            00787099
007880     05  JL-JCL-LINE-14.                                          00788099
007890         10  JL-JCL-OPTIONS       PIC  X(80)  VALUE SPACES.       00789099
007900     05  JL-JCL-LINE-15.                                          00790099
007910         10  FILLER               PIC  X(02)  VALUE '/*'.         00791099
007920         10  FILLER               PIC  X(78)  VALUE SPACES.       00792099
007930     05  JL-JCL-LINE-16.                                          00793099
007940         10  FILLER               PIC  X(03)  VALUE '//*'.        00794099
007950         10  FILLER               PIC  X(77)  VALUE SPACES.       00795099
007960     05  JL-JCL-LINE-EOF.                                         00796099
007970         10  FILLER               PIC  X(05)  VALUE '/*EOF'.      00797099
007980         10  FILLER               PIC  X(75)  VALUE SPACES.       00798099
007990 01  JL-JCL-LINE-TABLE            REDEFINES JL-JCL-LINE-AREA.     00799099
008000     05  JL-JCL-LINE              OCCURS 18 TIMES                 00800099
008010                                  INDEXED BY JL-LINE-INDEX        00801099
008020                                  PIC X(80).                      00802099
008030     EJECT                                                        00803099
008040***  ADDED WS FIELDS  END   - 3/7                                 00804099
008050*---------------------------------------------------------------* 00805099
008060*  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 00806099
008070*---------------------------------------------------------------* 00807099
008080                                                                  00808099
008090 01  PV-SQL-STMT.                                                 00809099
008100     49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.00810099
008110*        SELECT 137 LENGTH PLUS                                   00811099
008120*        FROM   275 LENGTH PLUS  (MAX)                            00812099
008130*        WHERE 1100 LENGTH       (MAX)                            00813099
008140     49  PV-SQL-STMT-TEXT               PIC X(1512)  VALUE SPACES.00814099
008150                                                                  00815099
008160 01  PV-SELECT-CLAUSE                   PIC X(137)  VALUE SPACES. 00816099
008170                                                                  00817099
008180 01  PV-BUILD-SELECT-REC.                                         00818099
008190     05  PV-BUILD-SELECT-LEN            PIC S9(04)  COMP  VALUE 0 00819099
008200                                                          SYNC.   00820099
008210     05  PV-BUILD-SELECT-STMT.                                    00821099
008220         10  FILLER                     PIC  X(24) VALUE          00822099
008230             'SELECT DISTINCT A.PO_NBR'.                          00823099
008240         10  FILLER                     PIC  X(10) VALUE          00824099
008250             ',C.FOB_CDE'.                                        00825099
008260         10  FILLER                     PIC  X(11) VALUE          00826099
008270             ',A.DEPT_NBR'.                                       00827099
008280         10  FILLER                     PIC  X(17) VALUE          00828099
008290             ',C.LAST_FCTRY_DTE'.                                 00829099
008300         10  FILLER                     PIC  X(20) VALUE          00830099
008310             ',C.DONT_SHIP_BEF_DTE'.                              00831099
008320         10  FILLER                     PIC  X(18) VALUE          00832099
008330             ',A.TOT_VAL_RTL_AMT'.                                00833099
008340         10  FILLER                     PIC  X(15) VALUE          00834099
008350             ',A.TOT_UNT_QTY '.                                   00835099
008360         10  FILLER                     PIC  X(22) VALUE          00836099
008370             '                      '.                            00837099
008380                                                                  00838099
008390     05  PV-BUILD-SELECT-STMT-VS.                                 00839099
008400         10  FILLER                     PIC  X(24) VALUE          00840099
008410             'SELECT DISTINCT A.PO_NBR'.                          00841099
008420         10  FILLER                     PIC  X(10) VALUE          00842099
008430             ',C.FOB_CDE'.                                        00843099
008440         10  FILLER                     PIC  X(11) VALUE          00844099
008450             ',A.DEPT_NBR'.                                       00845099
008460         10  FILLER                     PIC  X(17) VALUE          00846099
008470             ',C.LAST_FCTRY_DTE'.                                 00847099
008480         10  FILLER                     PIC  X(20) VALUE          00848099
008490             ',C.DONT_SHIP_BEF_DTE'.                              00849099
008500         10  FILLER                     PIC  X(18) VALUE          00850099
008510             ',A.TOT_VAL_RTL_AMT'.                                00851099
008520         10  FILLER                     PIC  X(15) VALUE          00852099
008530             ',A.TOT_UNT_QTY '.                                   00853099
008540         10  FILLER                     PIC  X(14) VALUE          00854099
008550             ',MIN(K.VS_NBR)'.                                    00855099
008560         10  FILLER                     PIC  X(08) VALUE          00856099
008570             '        '.                                          00857099
008580                                                                  00858099
008590     05  PV-FROM-CLAUSE.                                          00859099
008600         10  FILLER                     PIC  X(275).              00860099
008610                                                                  00861099
008620     05  PV-WHERE-CLAUSE.                                         00862099
008630         10  FILLER                     PIC  X(1100).             00863099
008640                                                                  00864099
008650     05  PV-SV-OPER-UNIT               PIC S9(04) COMP.           00865099
008660     05  PV-SV-FCLTY                   PIC S9(04) COMP.           00866099
008670     05  PV-SV-PO-NBR                  PIC S9(9) COMP VALUE +0.   00867099
008680     05  PV-DEPT-COMPARE               PIC 9(04).                 00868099
008690     05  PV-DEPT-COMPARE-X REDEFINES                              00869099
008700         PV-DEPT-COMPARE.                                         00870099
008710         10 PV-DEPT-COMPARE-X-1        PIC X(01).                 00871099
008720         10 PV-DEPT-COMPARE-X-2        PIC X(03).                 00872099
008730     05  PV-SV-STATUS-CODE             PIC X(02).                 00873099
008740     05  PV-SELPO-DATA.                                           00874099
008750         10 PV-PO-NBR-IN               PIC S9(9) COMP.            00875099
008760         10 PV-FOB-CDE-IN              PIC X(03).                 00876099
008770         10 PV-POE-CDE-IN              PIC X(03).                 00877099
008780         10 PV-DEPT-NBR                PIC X(04).                 00878099
008790         10 PV-DEPT-NBR-N REDEFINES                               00879099
008800            PV-DEPT-NBR                PIC 9(04) COMP.            00880099
008810         10 PV-DUMMY1-DATE             PIC X(10).                 00881099
008820         10 PV-DUMMY2-DATE             PIC X(10).                 00882099
008830     05  PV-SCREEN-DATA-ITEMS.                                    00883099
008840         10 PV-DEPT                     PIC X(04).                00884099
008850         10 PV-DEPT-N REDEFINES                                   00885099
008860            PV-DEPT                     PIC 9(04).                00886099
008870         10 PV-CHAR-OPER-UNT-ID         PIC X(03) VALUE SPACES.   00887099
008880         10 PV-SM-AD-EVNT-DT            PIC X(08) VALUE SPACES.   00888099
008890         10 PV-SM-VENDOR-STYLE          PIC X(08) VALUE SPACES.   00889099
008900         10 PV-SM-OTB-PER-NBR           PIC X(06) VALUE SPACES.   00890099
008910         10 PV-SM-STRT-FCTRY-DTE        PIC X(08) VALUE SPACES.   00891099
008920         10 PV-SM-LAST-FCTRY-DTE        PIC X(08) VALUE SPACES.   00892099
008930         10 PV-SM-DONT-SHP-DTE          PIC X(08) VALUE SPACES.   00893099
008940         10 PV-SM-CAN-IFNOT-SHIP-DTE    PIC X(08) VALUE SPACES.   00894099
008950         10 PV-SM-EXT-CAN-DTE           PIC X(08) VALUE SPACES.   00895099
008960         10 PV-SM-EST-DELY-DT           PIC X(08) VALUE SPACES.   00896099
008970         10 PV-SM-BKNG-DELY-DT          PIC X(08) VALUE SPACES.   00897099
008980         10 PV-SM-ACTL-DELY-DT          PIC X(08) VALUE SPACES.   00898099
008990         10 PV-SM-IMPRT-DPRTR-DT        PIC X(08) VALUE SPACES.   00899099
009000         10 PV-SM-IMPRT-POE-DELY-DT     PIC X(08) VALUE SPACES.   00900099
009010         10 PV-SM-ACTL-CLR-DATE         PIC X(08) VALUE SPACES.   00901099
009020         10 PV-SM-TRIP-ETA-DC1          PIC X(08) VALUE SPACES.   00902099
009030         10 PV-SM-TRIP-ETA-DC2          PIC X(08) VALUE SPACES.   00903099
009040         10 PV-SM-TRIP-ETA-DC3          PIC X(08) VALUE SPACES.   00904099
009050         10 PV-SM-TRIP-ETA-DC4          PIC X(08) VALUE SPACES.   00905099
009060         10 PV-SM-TRIP-ETA-DC5          PIC X(08) VALUE SPACES.   00906099
009070         10 PV-SM-TRIP-ETA-DC6          PIC X(08) VALUE SPACES.   00907099
009080         10 PV-SM-TRIP-ETA-DC7          PIC X(08) VALUE SPACES.   00908099
009090         10 PV-SM-TRIP-ETA-DC8          PIC X(08) VALUE SPACES.   00909099
009100         10 PV-SM-TRIP-ETA-DC9          PIC X(08) VALUE SPACES.   00910099
009110         10 PV-SM-TRIP-ETA-DC10         PIC X(08) VALUE SPACES.   00911099
009120         10 PV-SM-TRIP-ETA-DC11         PIC X(08) VALUE SPACES.   00912099
009130         10 PV-SM-TRIP-ETA-DC12         PIC X(08) VALUE SPACES.   00913099
009140         10 PV-SM-TRIP-ATA-DC1          PIC X(08) VALUE SPACES.   00914099
009150         10 PV-SM-TRIP-ATA-DC2          PIC X(08) VALUE SPACES.   00915099
009160         10 PV-SM-TRIP-ATA-DC3          PIC X(08) VALUE SPACES.   00916099
009170         10 PV-SM-TRIP-ATA-DC4          PIC X(08) VALUE SPACES.   00917099
009180         10 PV-SM-TRIP-ATA-DC5          PIC X(08) VALUE SPACES.   00918099
009190         10 PV-SM-TRIP-ATA-DC6          PIC X(08) VALUE SPACES.   00919099
009200         10 PV-SM-TRIP-ATA-DC7          PIC X(08) VALUE SPACES.   00920099
009210         10 PV-SM-TRIP-ATA-DC8          PIC X(08) VALUE SPACES.   00921099
009220         10 PV-SM-TRIP-ATA-DC9          PIC X(08) VALUE SPACES.   00922099
009230         10 PV-SM-TRIP-ATA-DC10         PIC X(08) VALUE SPACES.   00923099
009240         10 PV-SM-TRIP-ATA-DC11         PIC X(08) VALUE SPACES.   00924099
009250         10 PV-SM-TRIP-ATA-DC12         PIC X(08) VALUE SPACES.   00925099
009260         10 PV-SM-DEVAN-DT              PIC X(08) VALUE SPACES.   00926099
009270         10 PV-SM-SPL-CRT-DT            PIC X(08) VALUE SPACES.   00927099
009280         10 PV-SM-SPL-SNT-DT            PIC X(08) VALUE SPACES.   00928099
009290         10 PV-SM-BKR-FRGT-RLSE-DT      PIC X(08) VALUE SPACES.   00929099
009300         10 PV-SM-TRLR-AVAIL-DT         PIC X(08) VALUE SPACES.   00930099
009310         10 PV-SM-CONTNR-ID             PIC X(12) VALUE SPACES.   00931099
009320         10 PV-SM-STORE-DISTRO          PIC X(01) VALUE SPACES.   00932099
009330         10 PV-ACTL-CLR-DATE            PIC X(10) VALUE SPACES.   00933099
009340         10 PV-FILD-DATE                PIC X(10) VALUE SPACES.   00934099
009350         10 PV-MOM-DPRTR-DATE           PIC X(10) VALUE SPACES.   00935099
009360         10 PV-FDR-DPRTR-DATE           PIC X(10) VALUE SPACES.   00936099
009370         10 PV-TRIP-TYP-CDE             PIC X(01) VALUE SPACES.   00937099
009380         10 PV-TRIP-TYP-CDE-FULL        PIC X(03) VALUE SPACES.   00938099
009390         10 PV-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3      00939099
009400                                            VALUE 0.              00940099
009410         10 PV-UNITS-RECEIVED           PIC S9(15) COMP-3         00941099
009420                                            VALUE 0.              00942099
009430         10 PV-DOLLARS-ORDERED          PIC S9(15)V99 COMP-3      00943099
009440                                            VALUE 0.              00944099
009450         10 PV-UNITS-ORDERED            PIC S9(15) COMP-3         00945099
009460                                            VALUE 0.              00946099
009470         10 PV-TOT-VAL-RTL-AMT          PIC S9(8)V9(2) COMP-3     00947099
009480                                         VALUE 0.                 00948099
009490         10 PV-TOT-VAL-COST-AMT         PIC S9(8)V9(2) COMP-3     00949099
009500                                         VALUE 0.                 00950099
009510         10 PV-TOT-UNT-QTY              PIC S9(9) COMP VALUE 0.   00951099
009520     05  PV-IMPORT-DATA.                                          00952099
009530         10 PV-BKNG-DELY-DT               PIC X(10).              00953099
009540         10 PV-ACTL-DELY-DT               PIC X(10).              00954099
009550         10 PV-FEEDER-DPRTR-DT            PIC X(10).              00955099
009560         10 PV-IMPRT-DPRTR-DT             PIC X(10).              00956099
009570         10 PV-IMPRT-POE-DELY-DT          PIC X(10).              00957099
009580         10 PV-IMPRT-ACT-DELY-DT          PIC X(10).              00958099
009590         10 PV-IMPRT-BKR-FRGT-RLSE-DT     PIC X(10).              00959099
009600         10 PV-CONTNR-ID                  PIC X(12).              00960099
009610         10 PV-TRLR-AVAIL-DT              PIC X(10).              00961099
009620         10 PV-SPL-CRE-DT                 PIC X(10).              00962099
009630         10 PV-SPL-SNT-DT                 PIC X(10).              00963099
009640         10 PV-ORD-SPL-SNT-DT             PIC X(10).              00964099
009650         10 PV-SHPT-SPL-SNT-DT            PIC X(10).              00965099
009660         10 PV-SHPT-SPL-AUD-DT            PIC X(10).              00966099
009670         10 PV-STORE-DISTRO               PIC X(01).              00967099
009680         10 PV-DEVAN-DT                   PIC X(10).              00968099
009690         10 PV-RECORD-TYPE                PIC X(01).              00969099
009700         10 PV-PRTY-CODE                  PIC X(02).              00970099
009710         10 PV-STATUS-CODE                PIC X(02).              00971099
009720     05  PV-SHIP-DATA.                                            00972099
009730         10 PV-OPER-UNT-ID                PIC S9(4) COMP.         00973099
009740         10 PV-FCLTY-ID                   PIC S9(4) COMP.         00974099
009750         10 PV-SHIP-STAT-DT               PIC X(10).              00975099
009760         10 PV-SHIP-STAT-DT1              PIC X(10).              00976099
009770         10 PV-SHIP-STAT-DT2              PIC X(10).              00977099
009780         10 PV-SHIP-ETA-DT                PIC X(10).              00978099
009790     05  PV-NULLS.                                                00979099
009800         10 PV-BKNG-DELY-DT-NULL          PIC S9(04) COMP.        00980099
009810         10 PV-ACTL-DELY-DT-NULL          PIC S9(04) COMP.        00981099
009820         10 PV-IMPRT-DPRTR-DT-NULL        PIC S9(04) COMP.        00982099
009830         10 PV-FEEDER-DPRTR-DT-NULL       PIC S9(04) COMP.        00983099
009840         10 PV-IMPRT-POE-DELY-DT-NULL     PIC S9(04) COMP.        00984099
009850         10 PV-IMPRT-ACT-DELY-DT-NULL     PIC S9(04) COMP.        00985099
009860         10 PV-IMPRT-BKR-FRGT-RLSE-DT-NULL PIC S9(4) COMP.        00986099
009870         10 PV-TRLR-AVAIL-DT-NULL         PIC S9(04) COMP.        00987099
009880         10 PV-OPER-UNT-ID-NULL           PIC S9(04) COMP.        00988099
009890         10 PV-FCLTY-ID-NULL              PIC S9(04) COMP.        00989099
009900         10 PV-SHIP-STAT-DT-NULL          PIC S9(04) COMP.        00990099
009910         10 PV-SHIP-ETA-DT-NULL           PIC S9(04) COMP.        00991099
009920         10 PV-ACTL-CLR-DATE-NULL         PIC S9(04) COMP.        00992099
009930         10 PV-FILD-DATE-NULL             PIC S9(04) COMP.        00993099
009940         10 PV-MOM-DPRTR-DATE-NULL        PIC S9(04) COMP.        00994099
009950         10 PV-FDR-DPRTR-DATE-NULL        PIC S9(04) COMP.        00995099
009960         10 PV-SPL-CRE-DT-NULL            PIC S9(04) COMP.        00996099
009970         10 PV-SPL-SNT-DT-NULL            PIC S9(04) COMP.        00997099
009980         10 PV-ORD-SPL-SNT-DT-NULL        PIC S9(04) COMP.        00998099
009990         10 PV-SHPT-SPL-SNT-DT-NULL       PIC S9(04) COMP.        00999099
010000         10 PV-SHPT-SPL-AUD-DT-NULL       PIC S9(04) COMP.        01000099
010010         10 PV-DEVAN-DT-NULL              PIC S9(04) COMP.        01001099
010020         10 PV-CONT-RLS-DT-NULL           PIC S9(04) COMP.        01002099
010030         10 PV-TRLR-AVL-DT-NULL           PIC S9(04) COMP.        01003099
010040     05  PV-DATE-DB2-FIELD.                                       01004099
010050         10 PV-DB2-CC                    PIC  X(02).              01005099
010060         10 PV-DB2-YY                    PIC  X(02).              01006099
010070         10 FILLER                      PIC  X(01) VALUE '-'.     01007099
010080         10 PV-DB2-MM                    PIC  X(02).              01008099
010090         10 FILLER                      PIC  X(01) VALUE '-'.     01009099
010100         10 PV-DB2-DD                    PIC  X(02).              01010099
010110     05  PV-DISPLAY-CONTROL-VARIABLES.                            01011099
010120         10 PV-LAST-VFLD-LENGTH           PIC 9(03).              01012099
010130         10 PV-WORK-POS                   PIC 9(03).              01013099
010140         10 PV-WORK-PCT                   PIC 9(3)V9(4) COMP-3.   01014099
010150         10 PV-VSCREEN-XPOS               PIC 9(03).              01015099
010160         10 PV-LAST-VSCREEN-XPOS          PIC 9(03).              01016099
010170         10 PV-SPACING-XPOS               PIC 9(03).              01017099
010180         10 PV-FIELD-LENGTH-SO-FAR        PIC 9(03).              01018099
010190         10 PV-LAST-FIELD-LENGTH-SO-FAR   PIC 9(03).              01019099
010200         10 PV-VSCN-I                     PIC 9(03).              01020099
010210         10 PV-BEGIN-FIELD                PIC 9(03).              01021099
010220         10 PV-START-FIELD                PIC 9(03).              01022099
010230         10 PV-LAST-FIELD                 PIC 9(03).              01023099
010240         10 PV-COUNTER1                   PIC 9(03).              01024099
010250         10 PV-COUNTER2                   PIC 9(03).              01025099
010260         10 PV-WORK-DATA                  PIC X(49).              01026099
010270         10 PV-SAVE-DATA                  PIC X(49).              01027099
010280         10 PV-WORK-FIELD                 PIC X(08).              01028099
010290         10 PV-WORK-PAGE-CURR             PIC 9(2).               01029099
010300         10 PV-WORK-PAGE-ALT              PIC 9(2).               01030099
010310*---------------------------------------------------------------* 01031099
010320*  #TIP ==>                                                     * 01032099
010330*  THE ORDER OF THE FIELDS ON THE VIRTUAL SCREEN ARE CONTROLLED * 01033099
010340*  BY THE VALUES SET IN DORDER. CHANGING THE VALUES HERE CHANGE * 01034099
010350*  THE PLACEMENT OF THE FIELDS ON THE VIRTUAL SCREENS. NO OTHER * 01035099
010360*  CODING IS EVER NECESSARY TO CHANGE THE DISPLAY ORDER.        * 01036099
010370*---------------------------------------------------------------* 01037099
010380          10  PV-VFLD-STA-DORDER             PIC 9(02) VALUE 010. 01038099
010390          10  PV-VFLD-QCT-DORDER             PIC 9(02) VALUE 012. 01039099
010400          10  PV-VFLD-VNS-DORDER             PIC 9(02) VALUE 014. 01040099
010410          10  PV-VFLD-FOB-DORDER             PIC 9(02) VALUE 016. 01041099
010420          10  PV-VFLD-POE-DORDER             PIC 9(02) VALUE 018. 01042099
010430          10  PV-VFLD-SXF-DORDER             PIC 9(02) VALUE 019. 01043099
010440          10  PV-VFLD-LXF-DORDER             PIC 9(02) VALUE 020. 01044099
010450          10  PV-VFLD-BKD-DORDER             PIC 9(02) VALUE 022. 01045099
010460          10  PV-VFLD-FRD-DORDER             PIC 9(02) VALUE 024. 01046099
010470          10  PV-VFLD-SLD-DORDER             PIC 9(02) VALUE 026. 01047099
010480          10  PV-VFLD-PRD-DORDER             PIC 9(02) VALUE 028. 01048099
010490          10  PV-VFLD-CNT-DORDER             PIC 9(02) VALUE 030. 01049099
010500          10  PV-VFLD-CSR-DORDER             PIC 9(02) VALUE 032. 01050099
010510          10  PV-VFLD-DVN-DORDER             PIC 9(02) VALUE 034. 01051099
010520          10  PV-VFLD-DC1-DORDER             PIC 9(02) VALUE 036. 01052099
010530          10  PV-VFLD-DC2-DORDER             PIC 9(02) VALUE 038. 01053099
010540          10  PV-VFLD-DC3-DORDER             PIC 9(02) VALUE 040. 01054099
010550          10  PV-VFLD-DC4-DORDER             PIC 9(02) VALUE 042. 01055099
010560          10  PV-VFLD-DC5-DORDER             PIC 9(02) VALUE 044. 01056099
010570          10  PV-VFLD-DC6-DORDER             PIC 9(02) VALUE 046. 01057099
010580          10  PV-VFLD-DC7-DORDER             PIC 9(02) VALUE 048. 01058099
010590          10  PV-VFLD-DC8-DORDER             PIC 9(02) VALUE 050. 01059099
010600          10  PV-VFLD-DC9-DORDER             PIC 9(02) VALUE 052. 01060099
010610          10  PV-VFLD-DC10-DORDER            PIC 9(02) VALUE 054. 01061099
010620          10  PV-VFLD-DC11-DORDER            PIC 9(02) VALUE 056. 01062099
010630          10  PV-VFLD-DC12-DORDER            PIC 9(02) VALUE 058. 01063099
010640          10  PV-VFLD-DSB-DORDER             PIC 9(02) VALUE 060. 01064099
010650          10  PV-VFLD-CNL-DORDER             PIC 9(02) VALUE 062. 01065099
010660          10  PV-VFLD-AED-DORDER             PIC 9(02) VALUE 064. 01066099
010670          10  PV-VFLD-OTB-DORDER             PIC 9(02) VALUE 066. 01067099
010680          10  PV-VFLD-PPK-DORDER             PIC 9(02) VALUE 068. 01068099
010690          10  PV-VFLD-EDI-DORDER             PIC 9(02) VALUE 070. 01069099
010700          10  PV-VFLD-FSC-DORDER             PIC 9(02) VALUE 072. 01070099
010710          10  PV-VFLD-TTC-DORDER             PIC 9(02) VALUE 074. 01071099
010720          10  PV-VFLD-TVC-DORDER             PIC 9(02) VALUE 076. 01072099
010730          10  PV-VFLD-UOR-DORDER             PIC 9(02) VALUE 078. 01073099
010740          10  PV-VFLD-URC-DORDER             PIC 9(02) VALUE 080. 01074099
010750          10  PV-VFLD-URP-DORDER             PIC 9(02) VALUE 082. 01075099
010760          10  PV-VFLD-DOR-DORDER             PIC 9(02) VALUE 084. 01076099
010770          10  PV-VFLD-DRC-DORDER             PIC 9(02) VALUE 086. 01077099
010780          10  PV-VFLD-DRP-DORDER             PIC 9(02) VALUE 088. 01078099
010790          10  PV-VFLD-TRP-DORDER             PIC 9(02) VALUE 090. 01079099
010800          10  PV-VFLD-SPL-CRT-DORDER         PIC 9(02) VALUE 092. 01080099
010810          10  PV-VFLD-SPL-SNT-DORDER         PIC 9(02) VALUE 094. 01081099
010820          10  PV-VFLD-STD-DORDER             PIC 9(02) VALUE 096. 01082099
010830          10  PV-VFLD-CRL-DORDER             PIC 9(02) VALUE 097. 01083099
010840          10  PV-VFLD-TRA-DORDER             PIC 9(02) VALUE 098. 01084099
010850*---------------------------------------------------------------* 01085099
010860*   THE SCREEN CAN DISPLAY UP TO 47 DIFFERENT FIELDS.           * 01086099
010870*   THE USER CAN CHOOSE ANY ONE OF THEM OR ALL BY SETTING THE   * 01087099
010880*   DISPLAY CRITERIA FIELDS IN TRKCS195.                        * 01088099
010890*---------------------------------------------------------------* 01089099
010900* #VERY_IMPORTANT ==>                                           * 01090099
010910*   ASC-VCTL-SORTED-TABLE MUST CORRESPOND TO THE TOTAL LENGTH   * 01091099
010920*   OF PV-VFLD-TABLE.                                           * 01092099
010930*---------------------------------------------------------------* 01093099
010940* #VERY_IMPORTANT ==>                                           * 01094099
010950*    NEVER CHANGE THE ORDER OF THE 10 LEVELS IN                 * 01095099
010960*    PV-VARIABLE-DATA-FIELDS UNLESS THE ORDER IN                * 01096099
010970*    PC-VFLD-XXX-I FIELDS ARE MADE TO CORRESPOND BY             * 01097099
010980*    THE SAME POSITION.                                         * 01098099
010990*---------------------------------------------------------------* 01099099
011000* #VERY_IMPORTANT ==>                                           * 01100099
011010*    NEVER INITIALIZE THE 05 OR 10 LEVEL OF THE                 * 01101099
011020*    PV-VARIABLE-DATA-FIELDS. ONLY INITIALIZE THE               * 01102099
011030*    15 LEVEL.                                                  * 01103099
011040*---------------------------------------------------------------* 01104099
011050* #TIP ==>                                                      * 01105099
011060*    TO ADD A NEW VARIABLE FIELD ADD THE FIELD TO THE           * 01106099
011070*    BOTTOM OF PV-VARIABLE-DATA-FIELDS AND THEN SET IT          * 01107099
011080*    UP USING THE STANDARD CONVENTIONS.  FINALLY                * 01108099
011090*    ADD THE FIELD TO PC-VFLD-XXX-I WITH POSITION ??.           * 01109099
011100*    ALSO SCAN THROUGH THE PROGRAM AND CHANGE ANY ARRAY         * 01110099
011110*    SIZE AND ADD 1 TO PC-MAX-VFLDS-LIMIT. ALSO CHANGE          * 01111099
011120*    THE COMMON AREA AND ANY LOGIC IN THE PROGRAM THAT          * 01112099
011130*    DEALS WITH VARIABLE DATA.  REMEMBER TO SCAN FOR            * 01113099
011140*    THE COMMENT #VARIABLE_LOGIC AS LOGIC IN THIS AREA          * 01114099
011150*    PROBABLY NEEDS CHANGES.                                    * 01115099
011160*---------------------------------------------------------------* 01116099
011170     05  PV-VARIABLE-DATA-FIELDS.                                 01117099
011180*                    FOB CODE                                     01118099
011190         10 PV-FIELD-FOB.                                         01119099
011200            15 PV-HEADER-FOB-LEVEL-1 PIC X(4) VALUE 'FOB '.       01120099
011210            15 FILLER                PIC X(10) VALUE SPACES.      01121099
011220            15 PV-HEADER-FOB-LEVEL-2 PIC X(4) VALUE 'CODE'.       01122099
011230            15 FILLER                PIC X(10) VALUE SPACES.      01123099
011240            15 PV-DATA-FOB           PIC X(3) VALUE SPACES.       01124099
011250            15 FILLER                PIC X(11) VALUE SPACES.      01125099
011260            15 PV-FOB-SUMMARY        PIC X(1) VALUE 'N'.          01126099
011270            15 PV-FOB-LENGTH         PIC 9(2) VALUE 4.            01127099
011280            15 PV-FOB-JUSTIFIED      PIC X(1) VALUE 'L'.          01128099
011290            15 FILLER                PIC X(14) VALUE SPACES.      01129099
011300*                    POE CODE                                     01130099
011310         10 PV-FIELD-POE.                                         01131099
011320            15 PV-HEADER-POE-LEVEL-1 PIC X(4) VALUE 'POE '.       01132099
011330            15 FILLER                PIC X(10) VALUE SPACES.      01133099
011340            15 PV-HEADER-POE-LEVEL-2 PIC X(4) VALUE 'CODE'.       01134099
011350            15 FILLER                PIC X(10) VALUE SPACES.      01135099
011360            15 PV-DATA-POE           PIC X(3) VALUE SPACES.       01136099
011370            15 FILLER                PIC X(11) VALUE SPACES.      01137099
011380            15 PV-POE-SUMMARY        PIC X(1) VALUE 'N'.          01138099
011390            15 PV-POE-LENGTH         PIC 9(2) VALUE 4.            01139099
011400            15 PV-POE-JUSTIFIED      PIC X(1) VALUE 'L'.          01140099
011410            15 FILLER                PIC X(14) VALUE SPACES.      01141099
011420*                    DONT SHIP BY DATE                            01142099
011430         10 PV-FIELD-DSB.                                         01143099
011440            15 PV-HEADER-DSB-LEVEL-1 PIC X(5) VALUE 'DONT '.      01144099
011450            15 FILLER                PIC X(9) VALUE SPACES.       01145099
011460            15 PV-HEADER-DSB-LEVEL-2 PIC X(5) VALUE 'SHPBY'.      01146099
011470            15 FILLER                PIC X(9) VALUE SPACES.       01147099
011480            15 PV-DATA-DSB           PIC X(5) VALUE SPACES.       01148099
011490            15 FILLER                PIC X(9) VALUE SPACES.       01149099
011500            15 PV-DSB-SUMMARY        PIC X(1) VALUE 'N'.          01150099
011510            15 PV-DSB-LENGTH         PIC 9(2) VALUE 5.            01151099
011520            15 PV-DSB-JUSTIFIED      PIC X(1) VALUE 'L'.          01152099
011530            15 FILLER                PIC X(14) VALUE SPACES.      01153099
011540*                   START XFACTORY DATE                           01154099
011550         10 PV-FIELD-SXF.                                         01155099
011560            15 PV-HEADER-SXF-LEVEL-1 PIC X(5) VALUE 'STRT '.      01156099
011570            15 FILLER                PIC X(9) VALUE SPACES.       01157099
011580            15 PV-HEADER-SXF-LEVEL-2 PIC X(5) VALUE 'XFACT'.      01158099
011590            15 FILLER                PIC X(9) VALUE SPACES.       01159099
011600            15 PV-DATA-SXF           PIC X(5) VALUE SPACES.       01160099
011610            15 FILLER                PIC X(9) VALUE SPACES.       01161099
011620            15 PV-SXF-SUMMARY        PIC X(1) VALUE 'N'.          01162099
011630            15 PV-SXF-LENGTH         PIC 9(2) VALUE 5.            01163099
011640            15 PV-SXF-JUSTIFIED      PIC X(1) VALUE 'L'.          01164099
011650            15 FILLER                PIC X(14) VALUE SPACES.      01165099
011660*                    LAST XFACTORY DATE                           01166099
011670         10 PV-FIELD-LXF.                                         01167099
011680            15 PV-HEADER-LXF-LEVEL-1 PIC X(5) VALUE 'LAST '.      01168099
011690            15 FILLER                PIC X(9) VALUE SPACES.       01169099
011700            15 PV-HEADER-LXF-LEVEL-2 PIC X(5) VALUE 'XFACT'.      01170099
011710            15 FILLER                PIC X(9) VALUE SPACES.       01171099
011720            15 PV-DATA-LXF           PIC X(5) VALUE SPACES.       01172099
011730            15 FILLER                PIC X(9) VALUE SPACES.       01173099
011740            15 PV-LXF-SUMMARY        PIC X(1) VALUE 'N'.          01174099
011750            15 PV-LXF-LENGTH         PIC 9(2) VALUE 5.            01175099
011760            15 PV-LXF-JUSTIFIED      PIC X(1) VALUE 'L'.          01176099
011770            15 FILLER                PIC X(14) VALUE SPACES.      01177099
011780*                    CANCEL OR EXTENDED CANCEL DATE               01178099
011790         10 PV-FIELD-CNL.                                         01179099
011800            15 PV-HEADER-CNL-LEVEL-1 PIC X(5) VALUE 'CAN  '.      01180099
011810            15 FILLER                PIC X(9) VALUE SPACES.       01181099
011820            15 PV-HEADER-CNL-LEVEL-2 PIC X(5) VALUE 'DATE '.      01182099
011830            15 FILLER                PIC X(9) VALUE SPACES.       01183099
011840            15 PV-DATA-CNL           PIC X(5) VALUE SPACES.       01184099
011850            15 FILLER                PIC X(9) VALUE SPACES.       01185099
011860            15 PV-CNL-SUMMARY        PIC X(1) VALUE 'N'.          01186099
011870            15 PV-CNL-LENGTH         PIC 9(2) VALUE 5.            01187099
011880            15 PV-CNL-JUSTIFIED      PIC X(1) VALUE 'L'.          01188099
011890            15 FILLER                PIC X(14) VALUE SPACES.      01189099
011900*                    FOB OVERSEAS RECEIPT DATE                    01190099
011910         10 PV-FIELD-FRD.                                         01191099
011920            15 PV-HEADER-FRD-LEVEL-1 PIC X(5) VALUE 'FOB  '.      01192099
011930            15 FILLER                PIC X(9) VALUE SPACES.       01193099
011940            15 PV-HEADER-FRD-LEVEL-2 PIC X(5) VALUE 'RCPT '.      01194099
011950            15 FILLER                PIC X(9) VALUE SPACES.       01195099
011960            15 PV-DATA-FRD           PIC X(5) VALUE SPACES.       01196099
011970            15 FILLER                PIC X(9) VALUE SPACES.       01197099
011980            15 PV-FRD-SUMMARY        PIC X(1) VALUE 'N'.          01198099
011990            15 PV-FRD-LENGTH         PIC 9(2) VALUE 5.            01199099
012000            15 PV-FRD-JUSTIFIED      PIC X(1) VALUE 'L'.          01200099
012010            15 FILLER                PIC X(14) VALUE SPACES.      01201099
012020*                    IMPORT SAIL DATE                             01202099
012030         10 PV-FIELD-SLD.                                         01203099
012040            15 PV-HEADER-SLD-LEVEL-1 PIC X(5) VALUE 'SAIL '.      01204099
012050            15 FILLER                PIC X(9) VALUE SPACES.       01205099
012060            15 PV-HEADER-SLD-LEVEL-2 PIC X(5) VALUE 'DATE '.      01206099
012070            15 FILLER                PIC X(9) VALUE SPACES.       01207099
012080            15 PV-DATA-SLD           PIC X(5) VALUE SPACES.       01208099
012090            15 FILLER                PIC X(9) VALUE SPACES.       01209099
012100            15 PV-SLD-SUMMARY        PIC X(1) VALUE 'N'.          01210099
012110            15 PV-SLD-LENGTH         PIC 9(2) VALUE 5.            01211099
012120            15 PV-SLD-JUSTIFIED      PIC X(1) VALUE 'L'.          01212099
012130            15 FILLER                PIC X(14) VALUE SPACES.      01213099
012140*                    PORT ARRIVAL DATE                            01214099
012150         10 PV-FIELD-PRD.                                         01215099
012160            15 PV-HEADER-PRD-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01216099
012170            15 FILLER                PIC X(7) VALUE SPACES.       01217099
012180            15 PV-HEADER-PRD-LEVEL-2 PIC X(7) VALUE 'POE ARV'.    01218099
012190            15 FILLER                PIC X(7) VALUE SPACES.       01219099
012200            15 PV-DATA-PRD           PIC X(7) VALUE SPACES.       01220099
012210            15 FILLER                PIC X(7) VALUE SPACES.       01221099
012220            15 PV-PRD-SUMMARY        PIC X(1) VALUE 'N'.          01222099
012230            15 PV-PRD-LENGTH         PIC 9(2) VALUE 7.            01223099
012240            15 PV-PRD-JUSTIFIED      PIC X(1) VALUE 'L'.          01224099
012250            15 FILLER                PIC X(14) VALUE SPACES.      01225099
012260*                    CONTAINER ID (FOR POE E/ATA)                 01226099
012270         10 PV-FIELD-CNT.                                         01227099
012280            15 PV-HEADER-CNT-LEVEL-1 PIC X(7) VALUE 'CONTNR '.    01228099
012290            15 FILLER                PIC X(7) VALUE SPACES.       01229099
012300            15 PV-HEADER-CNT-LEVEL-2 PIC X(7) VALUE '  ID   '.    01230099
012310            15 FILLER                PIC X(7) VALUE SPACES.       01231099
012320            15 PV-DATA-CNT           PIC X(12) VALUE SPACES.      01232099
012330            15 FILLER                PIC X(2) VALUE SPACES.       01233099
012340            15 PV-CNT-SUMMARY        PIC X(1) VALUE 'N'.          01234099
012350            15 PV-CNT-LENGTH         PIC 9(2) VALUE 12.           01235099
012360            15 PV-CNT-JUSTIFIED      PIC X(1) VALUE 'L'.          01236099
012370            15 FILLER                PIC X(14) VALUE SPACES.      01237099
012380*                    CUSTOMS RELEASE DATE                         01238099
012390         10 PV-FIELD-CSR.                                         01239099
012400            15 PV-HEADER-CSR-LEVEL-1 PIC X(5) VALUE 'CUST '.      01240099
012410            15 FILLER                PIC X(9) VALUE SPACES.       01241099
012420            15 PV-HEADER-CSR-LEVEL-2 PIC X(5) VALUE 'RLS  '.      01242099
012430            15 FILLER                PIC X(9) VALUE SPACES.       01243099
012440            15 PV-DATA-CSR           PIC X(5) VALUE SPACES.       01244099
012450            15 FILLER                PIC X(9) VALUE SPACES.       01245099
012460            15 PV-CSR-SUMMARY        PIC X(1) VALUE 'N'.          01246099
012470            15 PV-CSR-LENGTH         PIC 9(2) VALUE 5.            01247099
012480            15 PV-CSR-JUSTIFIED      PIC X(1) VALUE 'L'.          01248099
012490            15 FILLER                PIC X(14) VALUE SPACES.      01249099
012500*                    ETA TO DC 1                                  01250099
012510         10 PV-FIELD-DC1.                                         01251099
012520            15 PV-HEADER-DC1-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01252099
012530            15 FILLER                PIC X(7) VALUE SPACES.       01253099
012540            15 FILLER                PIC X(1) VALUE SPACES.       01254099
012550            15 PV-HEADER-DC1-LEVEL-2 PIC X(7) VALUE 'DC     '.    01255099
012560            15 FILLER                PIC X(6) VALUE SPACES.       01256099
012570                                                                  01257099
012580            15 PV-DATA-DC1           PIC X(7) VALUE SPACES.       01258099
012590            15 FILLER                PIC X(7) VALUE SPACES.       01259099
012600            15 PV-DC1-SUMMARY        PIC X(1) VALUE 'N'.          01260099
012610            15 PV-DC1-LENGTH         PIC 9(2) VALUE 7.            01261099
012620            15 PV-DC1-JUSTIFIED      PIC X(1) VALUE 'L'.          01262099
012630            15 FILLER                PIC X(14) VALUE SPACES.      01263099
012640*                    ETA TO DC 2                                  01264099
012650         10 PV-FIELD-DC2.                                         01265099
012660            15 PV-HEADER-DC2-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01266099
012670            15 FILLER                PIC X(7) VALUE SPACES.       01267099
012680            15 FILLER                PIC X(1) VALUE SPACES.       01268099
012690            15 PV-HEADER-DC2-LEVEL-2 PIC X(7) VALUE 'DC     '.    01269099
012700            15 FILLER                PIC X(6) VALUE SPACES.       01270099
012710                                                                  01271099
012720            15 PV-DATA-DC2           PIC X(7) VALUE SPACES.       01272099
012730            15 FILLER                PIC X(7) VALUE SPACES.       01273099
012740            15 PV-DC2-SUMMARY        PIC X(1) VALUE 'N'.          01274099
012750            15 PV-DC2-LENGTH         PIC 9(2) VALUE 7.            01275099
012760            15 PV-DC2-JUSTIFIED      PIC X(1) VALUE 'L'.          01276099
012770            15 FILLER                PIC X(14) VALUE SPACES.      01277099
012780*                    ETA TO DC 3                                  01278099
012790         10 PV-FIELD-DC3.                                         01279099
012800            15 PV-HEADER-DC3-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01280099
012810            15 FILLER                PIC X(7) VALUE SPACES.       01281099
012820            15 FILLER                PIC X(1) VALUE SPACES.       01282099
012830            15 PV-HEADER-DC3-LEVEL-2 PIC X(7) VALUE 'DC     '.    01283099
012840            15 FILLER                PIC X(6) VALUE SPACES.       01284099
012850                                                                  01285099
012860            15 PV-DATA-DC3           PIC X(7) VALUE SPACES.       01286099
012870            15 FILLER                PIC X(7) VALUE SPACES.       01287099
012880            15 PV-DC3-SUMMARY        PIC X(1) VALUE 'N'.          01288099
012890            15 PV-DC3-LENGTH         PIC 9(2) VALUE 7.            01289099
012900            15 PV-DC3-JUSTIFIED      PIC X(1) VALUE 'L'.          01290099
012910            15 FILLER                PIC X(14) VALUE SPACES.      01291099
012920*                    ETA TO DC 4                                  01292099
012930         10 PV-FIELD-DC4.                                         01293099
012940            15 PV-HEADER-DC4-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01294099
012950            15 FILLER                PIC X(7) VALUE SPACES.       01295099
012960            15 FILLER                PIC X(1) VALUE SPACES.       01296099
012970            15 PV-HEADER-DC4-LEVEL-2 PIC X(7) VALUE 'DC     '.    01297099
012980            15 FILLER                PIC X(6) VALUE SPACES.       01298099
012990                                                                  01299099
013000            15 PV-DATA-DC4           PIC X(7) VALUE SPACES.       01300099
013010            15 FILLER                PIC X(7) VALUE SPACES.       01301099
013020            15 PV-DC4-SUMMARY        PIC X(1) VALUE 'N'.          01302099
013030            15 PV-DC4-LENGTH         PIC 9(2) VALUE 7.            01303099
013040            15 PV-DC4-JUSTIFIED      PIC X(1) VALUE 'L'.          01304099
013050            15 FILLER                PIC X(14) VALUE SPACES.      01305099
013060*                    ETA TO DC 5                                  01306099
013070         10 PV-FIELD-DC5.                                         01307099
013080            15 PV-HEADER-DC5-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01308099
013090            15 FILLER                PIC X(7) VALUE SPACES.       01309099
013100            15 FILLER                PIC X(1) VALUE SPACES.       01310099
013110            15 PV-HEADER-DC5-LEVEL-2 PIC X(7) VALUE 'DC     '.    01311099
013120            15 FILLER                PIC X(6) VALUE SPACES.       01312099
013130                                                                  01313099
013140            15 PV-DATA-DC5           PIC X(7) VALUE SPACES.       01314099
013150            15 FILLER                PIC X(7) VALUE SPACES.       01315099
013160            15 PV-DC5-SUMMARY        PIC X(1) VALUE 'N'.          01316099
013170            15 PV-DC5-LENGTH         PIC 9(2) VALUE 7.            01317099
013180            15 PV-DC5-JUSTIFIED      PIC X(1) VALUE 'L'.          01318099
013190            15 FILLER                PIC X(14) VALUE SPACES.      01319099
013200*                    ETA TO DC 6                                  01320099
013210         10 PV-FIELD-DC6.                                         01321099
013220            15 PV-HEADER-DC6-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01322099
013230            15 FILLER                PIC X(7) VALUE SPACES.       01323099
013240            15 FILLER                PIC X(1) VALUE SPACES.       01324099
013250            15 PV-HEADER-DC6-LEVEL-2 PIC X(7) VALUE 'DC     '.    01325099
013260            15 FILLER                PIC X(6) VALUE SPACES.       01326099
013270                                                                  01327099
013280            15 PV-DATA-DC6           PIC X(7) VALUE SPACES.       01328099
013290            15 FILLER                PIC X(7) VALUE SPACES.       01329099
013300            15 PV-DC6-SUMMARY        PIC X(1) VALUE 'N'.          01330099
013310            15 PV-DC6-LENGTH         PIC 9(2) VALUE 7.            01331099
013320            15 PV-DC6-JUSTIFIED      PIC X(1) VALUE 'L'.          01332099
013330            15 FILLER                PIC X(14) VALUE SPACES.      01333099
013340*                    ETA TO DC 7                                  01334099
013350         10 PV-FIELD-DC7.                                         01335099
013360            15 PV-HEADER-DC7-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01336099
013370            15 FILLER                PIC X(7) VALUE SPACES.       01337099
013380            15 FILLER                PIC X(1) VALUE SPACES.       01338099
013390            15 PV-HEADER-DC7-LEVEL-2 PIC X(7) VALUE 'DC     '.    01339099
013400            15 FILLER                PIC X(6) VALUE SPACES.       01340099
013410                                                                  01341099
013420            15 PV-DATA-DC7           PIC X(7) VALUE SPACES.       01342099
013430            15 FILLER                PIC X(7) VALUE SPACES.       01343099
013440            15 PV-DC7-SUMMARY        PIC X(1) VALUE 'N'.          01344099
013450            15 PV-DC7-LENGTH         PIC 9(2) VALUE 7.            01345099
013460            15 PV-DC7-JUSTIFIED      PIC X(1) VALUE 'L'.          01346099
013470            15 FILLER                PIC X(14) VALUE SPACES.      01347099
013480*                    ETA TO DC 8                                  01348099
013490         10 PV-FIELD-DC8.                                         01349099
013500            15 PV-HEADER-DC8-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01350099
013510            15 FILLER                PIC X(7) VALUE SPACES.       01351099
013520            15 FILLER                PIC X(1) VALUE SPACES.       01352099
013530            15 PV-HEADER-DC8-LEVEL-2 PIC X(7) VALUE 'DC     '.    01353099
013540            15 FILLER                PIC X(6) VALUE SPACES.       01354099
013550                                                                  01355099
013560            15 PV-DATA-DC8           PIC X(7) VALUE SPACES.       01356099
013570            15 FILLER                PIC X(7) VALUE SPACES.       01357099
013580            15 PV-DC8-SUMMARY        PIC X(1) VALUE 'N'.          01358099
013590            15 PV-DC8-LENGTH         PIC 9(2) VALUE 7.            01359099
013600            15 PV-DC8-JUSTIFIED      PIC X(1) VALUE 'L'.          01360099
013610            15 FILLER                PIC X(14) VALUE SPACES.      01361099
013620*                    ETA TO DC 9                                  01362099
013630         10 PV-FIELD-DC9.                                         01363099
013640            15 PV-HEADER-DC9-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.    01364099
013650            15 FILLER                PIC X(7) VALUE SPACES.       01365099
013660            15 FILLER                PIC X(1) VALUE SPACES.       01366099
013670            15 PV-HEADER-DC9-LEVEL-2 PIC X(7) VALUE 'DC     '.    01367099
013680            15 FILLER                PIC X(6) VALUE SPACES.       01368099
013690                                                                  01369099
013700            15 PV-DATA-DC9           PIC X(7) VALUE SPACES.       01370099
013710            15 FILLER                PIC X(7) VALUE SPACES.       01371099
013720            15 PV-DC9-SUMMARY        PIC X(1) VALUE 'N'.          01372099
013730            15 PV-DC9-LENGTH         PIC 9(2) VALUE 7.            01373099
013740            15 PV-DC9-JUSTIFIED      PIC X(1) VALUE 'L'.          01374099
013750            15 FILLER                PIC X(14) VALUE SPACES.      01375099
013760*                    ETA TO DC 10                                 01376099
013770         10 PV-FIELD-DC10.                                        01377099
013780            15 PV-HEADER-DC10-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.   01378099
013790            15 FILLER                PIC X(7) VALUE SPACES.       01379099
013800            15 FILLER                PIC X(1) VALUE SPACES.       01380099
013810            15 PV-HEADER-DC10-LEVEL-2 PIC X(7) VALUE 'DC     '.   01381099
013820            15 FILLER                PIC X(6) VALUE SPACES.       01382099
013830                                                                  01383099
013840            15 PV-DATA-DC10          PIC X(7) VALUE SPACES.       01384099
013850            15 FILLER                PIC X(7) VALUE SPACES.       01385099
013860            15 PV-DC10-SUMMARY       PIC X(1) VALUE 'N'.          01386099
013870            15 PV-DC10-LENGTH        PIC 9(2) VALUE 7.            01387099
013880            15 PV-DC10-JUSTIFIED     PIC X(1) VALUE 'L'.          01388099
013890            15 FILLER                PIC X(14) VALUE SPACES.      01389099
013900*                    ETA TO DC 11                                 01390099
013910         10 PV-FIELD-DC11.                                        01391099
013920            15 PV-HEADER-DC11-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.   01392099
013930            15 FILLER                PIC X(7) VALUE SPACES.       01393099
013940            15 FILLER                PIC X(1) VALUE SPACES.       01394099
013950            15 PV-HEADER-DC11-LEVEL-2 PIC X(7) VALUE 'DC     '.   01395099
013960            15 FILLER                PIC X(6) VALUE SPACES.       01396099
013970                                                                  01397099
013980            15 PV-DATA-DC11          PIC X(7) VALUE SPACES.       01398099
013990            15 FILLER                PIC X(7) VALUE SPACES.       01399099
014000            15 PV-DC11-SUMMARY       PIC X(1) VALUE 'N'.          01400099
014010            15 PV-DC11-LENGTH        PIC 9(2) VALUE 7.            01401099
014020            15 PV-DC11-JUSTIFIED     PIC X(1) VALUE 'L'.          01402099
014030            15 FILLER                PIC X(14) VALUE SPACES.      01403099
014040*                    ETA TO DC 12                                 01404099
014050         10 PV-FIELD-DC12.                                        01405099
014060            15 PV-HEADER-DC12-LEVEL-1 PIC X(7) VALUE 'ETA/ATA'.   01406099
014070            15 FILLER                PIC X(7) VALUE SPACES.       01407099
014080            15 FILLER                PIC X(1) VALUE SPACES.       01408099
014090            15 PV-HEADER-DC12-LEVEL-2 PIC X(7) VALUE 'DC     '.   01409099
014100            15 FILLER                PIC X(6) VALUE SPACES.       01410099
014110                                                                  01411099
014120            15 PV-DATA-DC12          PIC X(7) VALUE SPACES.       01412099
014130            15 FILLER                PIC X(7) VALUE SPACES.       01413099
014140            15 PV-DC12-SUMMARY       PIC X(1) VALUE 'N'.          01414099
014150            15 PV-DC12-LENGTH        PIC 9(2) VALUE 7.            01415099
014160            15 PV-DC12-JUSTIFIED     PIC X(1) VALUE 'L'.          01416099
014170            15 FILLER                PIC X(14) VALUE SPACES.      01417099
014180*                    DEVAN DATE AT DECONSOLIDATOR                 01418099
014190         10 PV-FIELD-DVN.                                         01419099
014200            15 PV-HEADER-DVN-LEVEL-1 PIC X(5) VALUE 'DEVAN'.      01420099
014210            15 FILLER                PIC X(9) VALUE SPACES.       01421099
014220            15 PV-HEADER-DVN-LEVEL-2 PIC X(5) VALUE 'DATE '.      01422099
014230            15 FILLER                PIC X(9) VALUE SPACES.       01423099
014240            15 PV-DATA-DVN           PIC X(5) VALUE SPACES.       01424099
014250            15 FILLER                PIC X(9) VALUE SPACES.       01425099
014260            15 PV-DVN-SUMMARY        PIC X(1) VALUE 'N'.          01426099
014270            15 PV-DVN-LENGTH         PIC 9(2) VALUE 5.            01427099
014280            15 PV-DVN-JUSTIFIED      PIC X(1) VALUE 'L'.          01428099
014290            15 FILLER                PIC X(14) VALUE SPACES.      01429099
014300*                    OVERSEAS BOOKING DATE                        01430099
014310         10 PV-FIELD-BKD.                                         01431099
014320            15 PV-HEADER-BKD-LEVEL-1 PIC X(5) VALUE 'BKNG '.      01432099
014330            15 FILLER                PIC X(9) VALUE SPACES.       01433099
014340            15 PV-HEADER-BKD-LEVEL-2 PIC X(5) VALUE 'DELY '.      01434099
014350            15 FILLER                PIC X(9) VALUE SPACES.       01435099
014360            15 PV-DATA-BKD           PIC X(5) VALUE SPACES.       01436099
014370            15 FILLER                PIC X(9) VALUE SPACES.       01437099
014380            15 PV-BKD-SUMMARY        PIC X(1) VALUE 'N'.          01438099
014390            15 PV-BKD-LENGTH         PIC 9(2) VALUE 5.            01439099
014400            15 PV-BKD-JUSTIFIED      PIC X(1) VALUE 'L'.          01440099
014410            15 FILLER                PIC X(14) VALUE SPACES.      01441099
014420*                    IMPORT EXTENDED FIRST COST                   01442099
014430         10 PV-FIELD-FSC.                                         01443099
014440            15 FILLER                PIC X(2) VALUE SPACES.       01444099
014450            15 PV-HEADER-FSC-LEVEL-1 PIC X(12)                    01445099
014460                         VALUE '      1ST   '.                    01446099
014470            15 FILLER                PIC X(2) VALUE SPACES.       01447099
014480            15 PV-HEADER-FSC-LEVEL-2 PIC X(12)                    01448099
014490                         VALUE '     COST   '.                    01449099
014500            15 FILLER                PIC X(2) VALUE SPACES.       01450099
014510            15 PV-DATA-FSC           PIC ZZZZZZZZ9.99.            01451099
014520            15 PV-FSC-SUMMARY        PIC X(1) VALUE 'Y'.          01452099
014530            15 PV-FSC-LENGTH         PIC 9(2) VALUE 12.           01453099
014540            15 PV-FSC-JUSTIFIED      PIC X(1) VALUE 'R'.          01454099
014550            15 FILLER                PIC X(2) VALUE SPACES.       01455099
014560            15 PV-TOTAL-FSC          PIC ZZZZZZZZZZZ9.            01456099
014570*                    IMPORT EXTENDED ESTIMATED LANDED COST        01457099
014580         10 PV-FIELD-TTC.                                         01458099
014590            15 FILLER                PIC X(2) VALUE SPACES.       01459099
014600            15 PV-HEADER-TTC-LEVEL-1 PIC X(12)                    01460099
014610                         VALUE '    TOTAL   '.                    01461099
014620            15 FILLER                PIC X(2) VALUE SPACES.       01462099
014630            15 PV-HEADER-TTC-LEVEL-2 PIC X(12)                    01463099
014640                         VALUE '     COST   '.                    01464099
014650            15 FILLER                PIC X(2) VALUE SPACES.       01465099
014660            15 PV-DATA-TTC           PIC ZZZZZZZZ9.99.            01466099
014670            15 PV-TTC-SUMMARY        PIC X(1) VALUE 'Y'.          01467099
014680            15 PV-TTC-LENGTH         PIC 9(2) VALUE 12.           01468099
014690            15 PV-TTC-JUSTIFIED      PIC X(1) VALUE 'R'.          01469099
014700            15 FILLER                PIC X(2) VALUE SPACES.       01470099
014710            15 PV-TOTAL-TTC          PIC ZZZZZZZZZZZ9.            01471099
014720*                    TOTAL COST FOR VERIFIED UNITS                01472099
014730         10 PV-FIELD-TVC.                                         01473099
014740            15 FILLER                PIC X(2) VALUE SPACES.       01474099
014750            15 PV-HEADER-TVC-LEVEL-1 PIC X(12)                    01475099
014760                         VALUE '    TOT VER '.                    01476099
014770            15 FILLER                PIC X(2) VALUE SPACES.       01477099
014780            15 PV-HEADER-TVC-LEVEL-2 PIC X(12)                    01478099
014790                         VALUE '     COST   '.                    01479099
014800            15 FILLER                PIC X(2) VALUE SPACES.       01480099
014810            15 PV-DATA-TVC           PIC ZZZZZZZZ9.99.            01481099
014820            15 PV-TVC-SUMMARY        PIC X(1) VALUE 'Y'.          01482099
014830            15 PV-TVC-LENGTH         PIC 9(2) VALUE 12.           01483099
014840            15 PV-TVC-JUSTIFIED      PIC X(1) VALUE 'R'.          01484099
014850            15 FILLER                PIC X(2) VALUE SPACES.       01485099
014860            15 PV-TOTAL-TVC          PIC ZZZZZZZZZZZ9.            01486099
014870*                    UNITS ORDERED                                01487099
014880         10 PV-FIELD-UOR.                                         01488099
014890            15 FILLER                PIC X(7) VALUE SPACES.       01489099
014900            15 PV-HEADER-UOR-LEVEL-1 PIC X(7) VALUE ' UNITS '.    01490099
014910            15 FILLER                PIC X(7) VALUE SPACES.       01491099
014920            15 PV-HEADER-UOR-LEVEL-2 PIC X(7) VALUE '  ORD  '.    01492099
014930            15 FILLER                PIC X(5) VALUE SPACES.       01493099
014940            15 PV-DATA-UOR           PIC ZZZZZZZZ9.               01494099
014950            15 PV-UOR-SUMMARY        PIC X(1) VALUE 'Y'.          01495099
014960            15 PV-UOR-LENGTH         PIC 9(2) VALUE 9.            01496099
014970            15 PV-UOR-JUSTIFIED      PIC X(1) VALUE 'R'.          01497099
014980            15 FILLER                PIC X(5) VALUE SPACES.       01498099
014990            15 PV-TOTAL-UOR          PIC ZZZZZZZZ9.               01499099
015000*                    UNITS RECEIVED                               01500099
015010         10 PV-FIELD-URC.                                         01501099
015020            15 FILLER                PIC X(7) VALUE SPACES.       01502099
015030            15 PV-HEADER-URC-LEVEL-1 PIC X(7) VALUE ' UNITS '.    01503099
015040            15 FILLER                PIC X(7) VALUE SPACES.       01504099
015050            15 PV-HEADER-URC-LEVEL-2 PIC X(7) VALUE ' RECVD '.    01505099
015060            15 FILLER                PIC X(5) VALUE SPACES.       01506099
015070            15 PV-DATA-URC           PIC ZZZZZZZZ9.               01507099
015080            15 PV-URC-SUMMARY        PIC X(1) VALUE 'Y'.          01508099
015090            15 PV-URC-LENGTH         PIC 9(2) VALUE 9.            01509099
015100            15 PV-URC-JUSTIFIED      PIC X(1) VALUE 'R'.          01510099
015110            15 FILLER                PIC X(5) VALUE SPACES.       01511099
015120            15 PV-TOTAL-URC          PIC ZZZZZZZZ9.               01512099
015130*                    PERCENT OF UNITS RECEIVED                    01513099
015140         10 PV-FIELD-URP.                                         01514099
015150            15 FILLER                PIC X(9) VALUE SPACES.       01515099
015160            15 PV-HEADER-URP-LEVEL-1 PIC X(5) VALUE 'UNITS'.      01516099
015170            15 FILLER                PIC X(9) VALUE SPACES.       01517099
015180            15 PV-HEADER-URP-LEVEL-2 PIC X(5) VALUE '%RCVD'.      01518099
015190            15 FILLER                PIC X(10) VALUE SPACES.      01519099
015200            15 PV-DATA-URP           PIC ZZ9.                     01520099
015210            15 FILLER                PIC X(1) VALUE '%'.          01521099
015220            15 PV-URP-SUMMARY        PIC X(1) VALUE 'Y'.          01522099
015230            15 PV-URP-LENGTH         PIC 9(2) VALUE 5.            01523099
015240            15 PV-URP-JUSTIFIED      PIC X(1) VALUE 'R'.          01524099
015250            15 FILLER                PIC X(10) VALUE SPACES.      01525099
015260            15 PV-TOTAL-URP          PIC ZZ9.                     01526099
015270            15 FILLER                PIC X(1) VALUE '%'.          01527099
015280*                    RETAIL DOLLARS ORDERED                       01528099
015290         10 PV-FIELD-DOR.                                         01529099
015300            15 FILLER                PIC X(2) VALUE SPACES.       01530099
015310            15 PV-HEADER-DOR-LEVEL-1 PIC X(12)                    01531099
015320                         VALUE '   DOLLARS  '.                    01532099
015330            15 FILLER                PIC X(2) VALUE SPACES.       01533099
015340            15 PV-HEADER-DOR-LEVEL-2 PIC X(12)                    01534099
015350                         VALUE '   ORDERED  '.                    01535099
015360            15 FILLER                PIC X(2) VALUE SPACES.       01536099
015370            15 PV-DATA-DOR           PIC ZZZZZZZZ9.99.            01537099
015380            15 PV-DOR-SUMMARY        PIC X(1) VALUE 'Y'.          01538099
015390            15 PV-DOR-LENGTH         PIC 9(2) VALUE 12.           01539099
015400            15 PV-DOR-JUSTIFIED      PIC X(1) VALUE 'R'.          01540099
015410            15 FILLER                PIC X(2) VALUE SPACES.       01541099
015420            15 PV-TOTAL-DOR          PIC ZZZZZZZZZZZ9.            01542099
015430*                    RETAIL DOLLARS RECEIVED                      01543099
015440         10 PV-FIELD-DRC.                                         01544099
015450            15 FILLER                PIC X(2) VALUE SPACES.       01545099
015460            15 PV-HEADER-DRC-LEVEL-1 PIC X(12)                    01546099
015470                         VALUE '   DOLLARS  '.                    01547099
015480            15 FILLER                PIC X(2) VALUE SPACES.       01548099
015490            15 PV-HEADER-DRC-LEVEL-2 PIC X(12)                    01549099
015500                         VALUE '    RECVD   '.                    01550099
015510            15 FILLER                PIC X(2) VALUE SPACES.       01551099
015520            15 PV-DATA-DRC           PIC ZZZZZZZZ9.99.            01552099
015530            15 PV-DRC-SUMMARY        PIC X(1) VALUE 'Y'.          01553099
015540            15 PV-DRC-LENGTH         PIC 9(2) VALUE 12.           01554099
015550            15 PV-DOR-JUSTIFIED      PIC X(1) VALUE 'R'.          01555099
015560            15 FILLER                PIC X(2) VALUE SPACES.       01556099
015570            15 PV-TOTAL-DRC          PIC ZZZZZZZZZZZ9.            01557099
015580*                    PERCENT OF RETAIL DOLLARS RECEIVED           01558099
015590         10 PV-FIELD-DRP.                                         01559099
015600            15 FILLER                PIC X(9) VALUE SPACES.       01560099
015610            15 PV-HEADER-DRP-LEVEL-1 PIC X(5) VALUE 'DOLLR'.      01561099
015620            15 FILLER                PIC X(9) VALUE SPACES.       01562099
015630            15 PV-HEADER-DRP-LEVEL-2 PIC X(5) VALUE '%RCVD'.      01563099
015640            15 FILLER                PIC X(10) VALUE SPACES.      01564099
015650            15 PV-DATA-DRP           PIC ZZ9.                     01565099
015660            15 FILLER                PIC X(1) VALUE '%'.          01566099
015670            15 PV-DRP-SUMMARY        PIC X(1) VALUE 'Y'.          01567099
015680            15 PV-DRP-LENGTH         PIC 9(2) VALUE 5.            01568099
015690            15 PV-DRP-JUSTIFIED      PIC X(1) VALUE 'R'.          01569099
015700            15 FILLER                PIC X(10) VALUE SPACES.      01570099
015710            15 PV-TOTAL-DRP          PIC ZZ9.                     01571099
015720            15 FILLER                PIC X(1) VALUE '%'.          01572099
015730*                    OPEN TO BUY                                  01573099
015740         10 PV-FIELD-OTB.                                         01574099
015750            15 PV-HEADER-OTB-LEVEL-1 PIC X(5) VALUE '    '.       01575099
015760            15 FILLER                PIC X(9) VALUE SPACES.       01576099
015770            15 PV-HEADER-OTB-LEVEL-2 PIC X(5) VALUE 'OTB '.       01577099
015780            15 FILLER                PIC X(9) VALUE SPACES.       01578099
015790            15 PV-DATA-OTB           PIC X(4) VALUE SPACES.       01579099
015800            15 FILLER                PIC X(10) VALUE SPACES.      01580099
015810            15 PV-OTB-SUMMARY        PIC X(1) VALUE 'N'.          01581099
015820            15 PV-OTB-LENGTH         PIC 9(2) VALUE 4.            01582099
015830            15 PV-OTB-JUSTIFIED      PIC X(1) VALUE 'L'.          01583099
015840            15 FILLER                PIC X(14) VALUE SPACES.      01584099
015850*                    EDI INDICATOR                                01585099
015860         10 PV-FIELD-EDI.                                         01586099
015870            15 PV-HEADER-EDI-LEVEL-1 PIC X(3) VALUE '   '.        01587099
015880            15 FILLER                PIC X(11) VALUE SPACES.      01588099
015890            15 PV-HEADER-EDI-LEVEL-2 PIC X(3) VALUE 'EDI'.        01589099
015900            15 FILLER                PIC X(11) VALUE SPACES.      01590099
015910            15 FILLER                PIC X(01) VALUE SPACES.      01591099
015920            15 PV-DATA-EDI           PIC X(01) VALUE SPACES.      01592099
015930            15 FILLER                PIC X(12) VALUE SPACES.      01593099
015940            15 PV-EDI-SUMMARY        PIC X(1) VALUE 'N'.          01594099
015950            15 PV-EDI-LENGTH         PIC 9(2) VALUE 3.            01595099
015960            15 PV-EDI-JUSTIFIED      PIC X(1) VALUE 'L'.          01596099
015970            15 FILLER                PIC X(14) VALUE SPACES.      01597099
015980*                    PREPACK VALUE                                01598099
015990         10 PV-FIELD-PPK.                                         01599099
016000            15 PV-HEADER-PPK-LEVEL-1 PIC X(4) VALUE 'PACK'.       01600099
016010            15 FILLER                PIC X(10) VALUE SPACES.      01601099
016020            15 PV-HEADER-PPK-LEVEL-2 PIC X(4) VALUE 'TYPE'.       01602099
016030            15 FILLER                PIC X(10) VALUE SPACES.      01603099
016040            15 FILLER                PIC X(01) VALUE SPACES.      01604099
016050            15 PV-DATA-PPK           PIC X(01) VALUE SPACES.      01605099
016060            15 FILLER                PIC X(12) VALUE SPACES.      01606099
016070            15 PV-PPK-SUMMARY        PIC X(1) VALUE 'N'.          01607099
016080            15 PV-PPK-LENGTH         PIC 9(2) VALUE 4.            01608099
016090            15 PV-PPK-JUSTIFIED      PIC X(1) VALUE 'L'.          01609099
016100            15 FILLER                PIC X(14) VALUE SPACES.      01610099
016110*                    PURCHASE ORDER HEADER LEVEL STATUS           01611099
016120         10 PV-FIELD-STA.                                         01612099
016130            15 PV-HEADER-STA-LEVEL-1 PIC X(4) VALUE 'STAT'.       01613099
016140            15 FILLER                PIC X(10) VALUE SPACES.      01614099
016150            15 PV-HEADER-STA-LEVEL-2 PIC X(4) VALUE 'CODE'.       01615099
016160            15 FILLER                PIC X(10) VALUE SPACES.      01616099
016170            15 FILLER                PIC X(1) VALUE SPACES.       01617099
016180            15 PV-DATA-STA           PIC X(2) VALUE SPACES.       01618099
016190            15 FILLER                PIC X(11) VALUE SPACES.      01619099
016200            15 PV-STA-SUMMARY        PIC X(1) VALUE 'N'.          01620099
016210            15 PV-STA-LENGTH         PIC 9(2) VALUE 4.            01621099
016220            15 PV-STA-JUSTIFIED      PIC X(1) VALUE 'L'.          01622099
016230            15 FILLER                PIC X(14) VALUE SPACES.      01623099
016240*                    MINIMUM AD EVENT DATE                        01624099
016250         10 PV-FIELD-AED.                                         01625099
016260            15 PV-HEADER-AEDL-EVEL-1 PIC X(5) VALUE 'AD   '.      01626099
016270            15 FILLER                PIC X(9) VALUE SPACES.       01627099
016280            15 PV-HEADER-AED-LEVEL-2 PIC X(5) VALUE 'DATE '.      01628099
016290            15 FILLER                PIC X(9) VALUE SPACES.       01629099
016300            15 PV-DATA-AED           PIC X(5) VALUE SPACES.       01630099
016310            15 FILLER                PIC X(9) VALUE SPACES.       01631099
016320            15 PV-AED-SUMMARY        PIC X(1) VALUE 'N'.          01632099
016330            15 PV-AED-LENGTH         PIC 9(2) VALUE 5.            01633099
016340            15 PV-AED-JUSTIFIED      PIC X(1) VALUE 'L'.          01634099
016350            15 FILLER                PIC X(14) VALUE SPACES.      01635099
016360*                    TRIP TYPE                                    01636099
016370         10 PV-FIELD-TRP.                                         01637099
016380            15 PV-HEADER-TRP-LEVEL-1 PIC X(4) VALUE 'TRIP'.       01638099
016390            15 FILLER                PIC X(10) VALUE SPACES.      01639099
016400            15 PV-HEADER-TRP-LEVEL-2 PIC X(4) VALUE 'TYPE'.       01640099
016410            15 FILLER                PIC X(10) VALUE SPACES.      01641099
016420            15 PV-DATA-TRP           PIC X(03) VALUE SPACES.      01642099
016430            15 FILLER                PIC X(11) VALUE SPACES.      01643099
016440            15 PV-TRP-SUMMARY        PIC X(1) VALUE 'N'.          01644099
016450            15 PV-TRP-LENGTH         PIC 9(2) VALUE 4.            01645099
016460            15 PV-TRP-JUSTIFIED      PIC X(1) VALUE 'L'.          01646099
016470            15 FILLER                PIC X(14) VALUE SPACES.      01647099
016480*                    DC SPLITS CREATED                            01648099
016490         10 PV-FIELD-SPL-CRT.                                     01649099
016500            15 PV-HEADER-SPL-CRT-LEVEL-1 PIC X(7)  VALUE          01650099
016510                                                   'SPLITS '.     01651099
016520            15 FILLER                    PIC X(07) VALUE SPACES.  01652099
016530            15 PV-HEADER-SPL-CRT-LEVEL-2 PIC X(7)  VALUE          01653099
016540                                                   'CREATE '.     01654099
016550            15 FILLER                    PIC X(07) VALUE SPACES.  01655099
016560            15 PV-DATA-SPL-CRT           PIC X(05) VALUE SPACES.  01656099
016570            15 FILLER                    PIC X(09) VALUE SPACES.  01657099
016580            15 PV-SPL-CRT-SUMMARY        PIC X(1) VALUE 'N'.      01658099
016590            15 PV-SPL-CRT-LENGTH         PIC 9(2) VALUE 7.        01659099
016600            15 PV-SPL-CRT-JUSTIFIED      PIC X(1) VALUE 'L'.      01660099
016610            15 FILLER                    PIC X(14) VALUE SPACES.  01661099
016620*                    DC SPLITS SENT                               01662099
016630         10 PV-FIELD-SPL-SNT.                                     01663099
016640            15 PV-HEADER-SPL-SNT-LEVEL-1 PIC X(8)  VALUE          01664099
016650                                                   'SPLT TO '.    01665099
016660            15 FILLER                    PIC X(06) VALUE SPACES.  01666099
016670            15 PV-HEADER-SPL-SNT-LEVEL-2 PIC X(8)  VALUE          01667099
016680                                                   'DECONSL '.    01668099
016690            15 FILLER                    PIC X(06) VALUE SPACES.  01669099
016700            15 PV-DATA-SPL-SNT           PIC X(05) VALUE SPACES.  01670099
016710            15 FILLER                    PIC X(09) VALUE SPACES.  01671099
016720            15 PV-SPL-SNT-SUMMARY        PIC X(1) VALUE 'N'.      01672099
016730            15 PV-SPL-SNT-LENGTH         PIC 9(2) VALUE 8.        01673099
016740            15 PV-SPL-SNT-JUSTIFIED      PIC X(1) VALUE 'L'.      01674099
016750            15 FILLER                    PIC X(14) VALUE SPACES.  01675099
016760*                    STORE DISTRO                                 01676099
016770         10 PV-FIELD-STD.                                         01677099
016780            15 PV-HEADER-STD-LEVEL-1     PIC X(6)  VALUE          01678099
016790                                                   'STORE '.      01679099
016800            15 FILLER                    PIC X(08) VALUE SPACES.  01680099
016810            15 PV-HEADER-STD-LEVEL-2     PIC X(6)  VALUE          01681099
016820                                                   'DISTRO'.      01682099
016830            15 FILLER                    PIC X(08) VALUE SPACES.  01683099
016840            15 FILLER                    PIC X(02) VALUE SPACES.  01684099
016850            15 PV-DATA-STD               PIC X(01) VALUE SPACES.  01685099
016860            15 FILLER                    PIC X(11) VALUE SPACES.  01686099
016870            15 PV-SPL-STD-SUMMARY        PIC X(1) VALUE 'N'.      01687099
016880            15 PV-SPL-STD-LENGTH         PIC 9(2) VALUE 6.        01688099
016890            15 PV-SPL-STD-JUSTIFIED      PIC X(1) VALUE 'L'.      01689099
016900            15 FILLER                    PIC X(14) VALUE SPACES.  01690099
016910*                    QUOTA CATEGORY                               01691099
016920         10 PV-FIELD-QCT.                                         01692099
016930            15 PV-HEADER-QCT-LEVEL-1     PIC X(8)  VALUE          01693099
016940                                                   'QUOTA   '.    01694099
016950            15 FILLER                    PIC X(06) VALUE SPACES.  01695099
016960            15 PV-HEADER-QCT-LEVEL-2     PIC X(8)  VALUE          01696099
016970                                                   'CATEGORY'.    01697099
016980            15 FILLER                    PIC X(06) VALUE SPACES.  01698099
016990            15 PV-DATA-QCT               PIC X(05) VALUE SPACES.  01699099
017000            15 FILLER                    PIC X(09) VALUE SPACES.  01700099
017010            15 PV-QCT-SUMMARY            PIC X(1) VALUE 'N'.      01701099
017020            15 PV-QCT-LENGTH             PIC 9(2) VALUE 5.        01702099
017030            15 PV-QCT-JUSTIFIED          PIC X(1) VALUE 'L'.      01703099
017040            15 FILLER                    PIC X(14) VALUE SPACES.  01704099
017050*                    VENDOR STYLE                                 01705099
017060         10 PV-FIELD-VNS.                                         01706099
017070            15 PV-HEADER-VNS-LEVEL-1     PIC X(8)  VALUE          01707099
017080                                                   'VENDOR  '.    01708099
017090            15 FILLER                    PIC X(6) VALUE SPACES.   01709099
017100            15 PV-HEADER-VNS-LEVEL-2     PIC X(8)  VALUE          01710099
017110                                                   'STYLE   '.    01711099
017120            15 FILLER                    PIC X(6) VALUE SPACES.   01712099
017130            15 PV-DATA-VNS               PIC X(8) VALUE SPACES.   01713099
017140            15 FILLER                    PIC X(6) VALUE SPACES.   01714099
017150            15 PV-VNS-SUMMARY            PIC X(1) VALUE 'N'.      01715099
017160            15 PV-VNS-LENGTH             PIC 9(2) VALUE 08.       01716099
017170            15 PV-VNS-JUSTIFIED          PIC X(1) VALUE 'L'.      01717099
017180            15 FILLER                    PIC X(14) VALUE SPACES.  01718099
017190*                    CONTAINER RELEASE                            01719099
017200         10 PV-FIELD-CRL.                                         01720099
017210            15 PV-HEADER-CRL-LEVEL-1     PIC X(7)  VALUE          01721099
017220                                                   'CONTNR '.     01722099
017230            15 FILLER                    PIC X(7) VALUE SPACES.   01723099
017240            15 PV-HEADER-CRL-LEVEL-2     PIC X(7)  VALUE          01724099
017250                                                   'RELEASE'.     01725099
017260            15 FILLER                    PIC X(07) VALUE SPACES.  01726099
017270            15 PV-DATA-CRL               PIC X(05) VALUE SPACES.  01727099
017280            15 FILLER                    PIC X(09) VALUE SPACES.  01728099
017290            15 PV-CRL-SUMMARY            PIC X(1) VALUE 'N'.      01729099
017300            15 PV-CRL-LENGTH             PIC 9(2) VALUE 7.        01730099
017310            15 PV-CRL-JUSTIFIED          PIC X(1) VALUE 'L'.      01731099
017320            15 FILLER                    PIC X(14) VALUE SPACES.  01732099
017330*                    TRAILER AVAILABLE                            01733099
017340         10 PV-FIELD-TRA.                                         01734099
017350            15 PV-HEADER-TRA-LEVEL-1     PIC X(5)  VALUE          01735099
017360                                                   'TRLR '.       01736099
017370            15 FILLER                    PIC X(9) VALUE SPACES.   01737099
017380            15 PV-HEADER-TRA-LEVEL-2     PIC X(5)  VALUE          01738099
017390                                                   'AVAIL'.       01739099
017400            15 FILLER                    PIC X(09) VALUE SPACES.  01740099
017410            15 PV-DATA-TRA               PIC X(05) VALUE SPACES.  01741099
017420            15 FILLER                    PIC X(09) VALUE SPACES.  01742099
017430            15 PV-TRA-SUMMARY            PIC X(1) VALUE 'N'.      01743099
017440            15 PV-TRA-LENGTH             PIC 9(2) VALUE 5.        01744099
017450            15 PV-TRA-JUSTIFIED          PIC X(1) VALUE 'L'.      01745099
017460            15 FILLER                    PIC X(14) VALUE SPACES.  01746099
017470                                                                  01747099
017480*---------------------------------------------------------------* 01748099
017490*    PV-VARIABLE-DATA-FIELDS REDEFINED AS AN ARRAY                01749099
017500*---------------------------------------------------------------* 01750099
017510     05  PV-VFLD-TABLE REDEFINES PV-VARIABLE-DATA-FIELDS.         01751099
017520         10  PV-VFLD-TABLE-VALUES                                 01752099
017530               OCCURS 47 TIMES                                    01753099
017540                 INDEXED BY VFLD-I.                               01754099
017550             15 PV-HEADER-LEVEL-1     PIC X(14).                  01755099
017560             15 PV-HEADER-LEVEL-2     PIC X(14).                  01756099
017570             15 PV-DATA               PIC X(14).                  01757099
017580             15 PV-SUMMARY            PIC X(1).                   01758099
017590             15 PV-LENGTH             PIC 9(2).                   01759099
017600             15 PV-JUSTIFIED          PIC X(1).                   01760099
017610             15 PV-TOTAL              PIC X(14).                  01761099
017620*---------------------------------------------------------------* 01762099
017630*    #VERY_IMPORTANT ===>                                       * 01763099
017640*    RELATED FIELDS TO CONTROL VARIABLE DISPLAY                 * 01764099
017650*    THE FOLLOWING CONTROL FIELDS SHOULD NEVER CHANGE           * 01765099
017660*    AFTER START UP. MODIFYING THE CONTENTS OUTSIDE OF          * 01766099
017670*    THE INITIAL SET UP STAGE WILL CAUSE UNPREDICTABLE RESULTS  * 01767099
017680*---------------------------------------------------------------* 01768099
017690     05  PV-VARIABLE-CONTROL-FIELDS.                              01769099
017700*                    FOB CODE                                     01770099
017710         10 PV-CONTROL-FOB.                                       01771099
017720            15 PV-FOB-OORDER         PIC 9(2) VALUE 99.           01772099
017730            15 PV-FOB-POINTER        PIC 9(2) VALUE ZEROS.        01773099
017740            15 PV-FOB-SELECTED       PIC X(1) VALUE 'N'.          01774099
017750            15 PV-FOB-ONVSCREEN      PIC 9(2) VALUE ZERO.         01775099
017760            15 PV-FOB-VFLD-SPACING   PIC 9(1) VALUE 1.            01776099
017770*                    POE CODE                                     01777099
017780         10 PV-CONTROL-POE.                                       01778099
017790            15 PV-POE-OORDER         PIC 9(2) VALUE 99.           01779099
017800            15 PV-POE-POINTER        PIC 9(2) VALUE ZEROS.        01780099
017810            15 PV-POE-SELECTED       PIC X(1) VALUE 'N'.          01781099
017820            15 PV-POE-ONVSCREEN      PIC 9(2) VALUE ZERO.         01782099
017830            15 PV-POE-VFLD-SPACING   PIC 9(1) VALUE 1.            01783099
017840*                    DONT SHIP BY DATE                            01784099
017850         10 PV-CONTROL-DSB.                                       01785099
017860            15 PV-DSB-OORDER         PIC 9(2) VALUE 99.           01786099
017870            15 PV-DSB-POINTER        PIC 9(2) VALUE ZEROS.        01787099
017880            15 PV-DSB-SELECTED       PIC X(1) VALUE 'N'.          01788099
017890            15 PV-DSB-ONVSCREEN      PIC 9(2) VALUE ZERO.         01789099
017900            15 PV-DSB-VFLD-SPACING   PIC 9(1) VALUE 1.            01790099
017910*                   START XFACTORY DATE                           01791099
017920         10 PV-CONTROL-SXF.                                       01792099
017930            15 PV-SXF-OORDER         PIC 9(2) VALUE 99.           01793099
017940            15 PV-SXF-POINTER        PIC 9(2) VALUE ZEROS.        01794099
017950            15 PV-SXF-SELECTED       PIC X(1) VALUE 'N'.          01795099
017960            15 PV-SXF-ONVSCREEN      PIC 9(2) VALUE ZERO.         01796099
017970            15 PV-SXF-VFLD-SPACING   PIC 9(1) VALUE 1.            01797099
017980*                    LAST XFACTORY DATE                           01798099
017990         10 PV-CONTROL-LXF.                                       01799099
018000            15 PV-LXF-OORDER         PIC 9(2) VALUE 99.           01800099
018010            15 PV-LXF-POINTER        PIC 9(2) VALUE ZEROS.        01801099
018020            15 PV-LXF-SELECTED       PIC X(1) VALUE 'N'.          01802099
018030            15 PV-LXF-ONVSCREEN      PIC 9(2) VALUE ZERO.         01803099
018040            15 PV-LXF-VFLD-SPACING   PIC 9(1) VALUE 1.            01804099
018050*                    CANCEL OR EXTENDED CANCEL DATE               01805099
018060         10 PV-CONTROL-CNL.                                       01806099
018070            15 PV-CNL-OORDER         PIC 9(2) VALUE 99.           01807099
018080            15 PV-CNL-POINTER        PIC 9(2) VALUE ZEROS.        01808099
018090            15 PV-CNL-SELECTED       PIC X(1) VALUE 'N'.          01809099
018100            15 PV-CNL-ONVSCREEN      PIC 9(2) VALUE ZERO.         01810099
018110            15 PV-CNL-VFLD-SPACING   PIC 9(1) VALUE 1.            01811099
018120*                    FOB OVERSEAS RECEIPT DATE                    01812099
018130         10 PV-CONTROL-FRD.                                       01813099
018140            15 PV-FRD-OORDER         PIC 9(2) VALUE 99.           01814099
018150            15 PV-FRD-POINTER        PIC 9(2) VALUE ZEROS.        01815099
018160            15 PV-FRD-SELECTED       PIC X(1) VALUE 'N'.          01816099
018170            15 PV-FRD-ONVSCREEN      PIC 9(2) VALUE ZERO.         01817099
018180            15 PV-FRD-VFLD-SPACING   PIC 9(1) VALUE 1.            01818099
018190*                    IMPORT SAIL DATE                             01819099
018200         10 PV-CONTROL-SLD.                                       01820099
018210            15 PV-SLD-OORDER         PIC 9(2) VALUE 99.           01821099
018220            15 PV-SLD-POINTER        PIC 9(2) VALUE ZEROS.        01822099
018230            15 PV-SLD-SELECTED       PIC X(1) VALUE 'N'.          01823099
018240            15 PV-SLD-ONVSCREEN      PIC 9(2) VALUE ZERO.         01824099
018250            15 PV-SLD-VFLD-SPACING   PIC 9(1) VALUE 1.            01825099
018260*                    PORT ARRIVAL DATE                            01826099
018270         10 PV-CONTROL-PRD.                                       01827099
018280            15 PV-PRD-OORDER         PIC 9(2) VALUE 99.           01828099
018290            15 PV-PRD-POINTER        PIC 9(2) VALUE ZEROS.        01829099
018300            15 PV-PRD-SELECTED       PIC X(1) VALUE 'N'.          01830099
018310            15 PV-PRD-ONVSCREEN      PIC 9(2) VALUE ZERO.         01831099
018320            15 PV-PRD-VFLD-SPACING   PIC 9(1) VALUE 1.            01832099
018330*                    CONTAINER ID                                 01833099
018340         10 PV-CONTROL-CNT.                                       01834099
018350            15 PV-CNT-OORDER         PIC 9(2) VALUE 99.           01835099
018360            15 PV-CNT-POINTER        PIC 9(2) VALUE ZEROS.        01836099
018370            15 PV-CNT-SELECTED       PIC X(1) VALUE 'N'.          01837099
018380            15 PV-CNT-ONVSCREEN      PIC 9(2) VALUE ZERO.         01838099
018390            15 PV-CNT-VFLD-SPACING   PIC 9(1) VALUE 1.            01839099
018400*                    CUSTOMS RELEASE DATE                         01840099
018410         10 PV-CONTROL-CSR.                                       01841099
018420            15 PV-CSR-OORDER         PIC 9(2) VALUE 99.           01842099
018430            15 PV-CSR-POINTER        PIC 9(2) VALUE ZEROS.        01843099
018440            15 PV-CSR-SELECTED       PIC X(1) VALUE 'N'.          01844099
018450            15 PV-CSR-ONVSCREEN      PIC 9(2) VALUE ZERO.         01845099
018460            15 PV-CSR-VFLD-SPACING   PIC 9(1) VALUE 1.            01846099
018470*                    ETA TO DC 1                                  01847099
018480         10 PV-CONTROL-DC1.                                       01848099
018490            15 PV-DC1-OORDER         PIC 9(2) VALUE 99.           01849099
018500            15 PV-DC1-POINTER        PIC 9(2) VALUE ZEROS.        01850099
018510            15 PV-DC1-SELECTED       PIC X(1) VALUE 'N'.          01851099
018520            15 PV-DC1-ONVSCREEN      PIC 9(2) VALUE ZERO.         01852099
018530            15 PV-DC1-VFLD-SPACING   PIC 9(1) VALUE 1.            01853099
018540*                    ETA TO DC 2                                  01854099
018550         10 PV-CONTROL-DC2.                                       01855099
018560            15 PV-DC2-OORDER         PIC 9(2) VALUE 99.           01856099
018570            15 PV-DC2-POINTER        PIC 9(2) VALUE ZEROS.        01857099
018580            15 PV-DC2-SELECTED       PIC X(1) VALUE 'N'.          01858099
018590            15 PV-DC2-ONVSCREEN      PIC 9(2) VALUE ZERO.         01859099
018600            15 PV-DC2-VFLD-SPACING   PIC 9(1) VALUE 1.            01860099
018610*                    ETA TO DC 3                                  01861099
018620         10 PV-CONTROL-DC3.                                       01862099
018630            15 PV-DC3-OORDER         PIC 9(2) VALUE 99.           01863099
018640            15 PV-DC3-POINTER        PIC 9(2) VALUE ZEROS.        01864099
018650            15 PV-DC3-SELECTED       PIC X(1) VALUE 'N'.          01865099
018660            15 PV-DC3-ONVSCREEN      PIC 9(2) VALUE ZERO.         01866099
018670            15 PV-DC3-VFLD-SPACING   PIC 9(1) VALUE 1.            01867099
018680*                    ETA TO DC 4                                  01868099
018690         10 PV-CONTROL-DC4.                                       01869099
018700            15 PV-DC4-OORDER         PIC 9(2) VALUE 99.           01870099
018710            15 PV-DC4-POINTER        PIC 9(2) VALUE ZEROS.        01871099
018720            15 PV-DC4-SELECTED       PIC X(1) VALUE 'N'.          01872099
018730            15 PV-DC4-ONVSCREEN      PIC 9(2) VALUE ZERO.         01873099
018740            15 PV-DC4-VFLD-SPACING   PIC 9(1) VALUE 1.            01874099
018750*                    ETA TO DC 5                                  01875099
018760         10 PV-CONTROL-DC5.                                       01876099
018770            15 PV-DC5-OORDER         PIC 9(2) VALUE 99.           01877099
018780            15 PV-DC5-POINTER        PIC 9(2) VALUE ZEROS.        01878099
018790            15 PV-DC5-SELECTED       PIC X(1) VALUE 'N'.          01879099
018800            15 PV-DC5-ONVSCREEN      PIC 9(2) VALUE ZERO.         01880099
018810            15 PV-DC5-VFLD-SPACING   PIC 9(1) VALUE 1.            01881099
018820*                    ETA TO DC 6                                  01882099
018830         10 PV-CONTROL-DC6.                                       01883099
018840            15 PV-DC6-OORDER         PIC 9(2) VALUE 99.           01884099
018850            15 PV-DC6-POINTER        PIC 9(2) VALUE ZEROS.        01885099
018860            15 PV-DC6-SELECTED       PIC X(1) VALUE 'N'.          01886099
018870            15 PV-DC6-ONVSCREEN      PIC 9(2) VALUE ZERO.         01887099
018880            15 PV-DC6-VFLD-SPACING   PIC 9(1) VALUE 1.            01888099
018890*                    ETA TO DC 7                                  01889099
018900         10 PV-CONTROL-DC7.                                       01890099
018910            15 PV-DC7-OORDER         PIC 9(2) VALUE 99.           01891099
018920            15 PV-DC7-POINTER        PIC 9(2) VALUE ZEROS.        01892099
018930            15 PV-DC7-SELECTED       PIC X(1) VALUE 'N'.          01893099
018940            15 PV-DC7-ONVSCREEN      PIC 9(2) VALUE ZERO.         01894099
018950            15 PV-DC7-VFLD-SPACING   PIC 9(1) VALUE 1.            01895099
018960*                    ETA TO DC 8                                  01896099
018970         10 PV-CONTROL-DC8.                                       01897099
018980            15 PV-DC8-OORDER         PIC 9(2) VALUE 99.           01898099
018990            15 PV-DC8-POINTER        PIC 9(2) VALUE ZEROS.        01899099
019000            15 PV-DC8-SELECTED       PIC X(1) VALUE 'N'.          01900099
019010            15 PV-DC8-ONVSCREEN      PIC 9(2) VALUE ZERO.         01901099
019020            15 PV-DC8-VFLD-SPACING   PIC 9(1) VALUE 1.            01902099
019030*                    ETA TO DC 9                                  01903099
019040         10 PV-CONTROL-DC9.                                       01904099
019050            15 PV-DC9-OORDER         PIC 9(2) VALUE 99.           01905099
019060            15 PV-DC9-POINTER        PIC 9(2) VALUE ZEROS.        01906099
019070            15 PV-DC9-SELECTED       PIC X(1) VALUE 'N'.          01907099
019080            15 PV-DC9-ONVSCREEN      PIC 9(2) VALUE ZERO.         01908099
019090            15 PV-DC9-VFLD-SPACING   PIC 9(1) VALUE 1.            01909099
019100*                    ETA TO DC 10                                 01910099
019110         10 PV-CONTROL-DC10.                                      01911099
019120            15 PV-DC10-OORDER        PIC 9(2) VALUE 99.           01912099
019130            15 PV-DC10-POINTER       PIC 9(2) VALUE ZEROS.        01913099
019140            15 PV-DC10-SELECTED      PIC X(1) VALUE 'N'.          01914099
019150            15 PV-DC10-ONVSCREEN     PIC 9(2) VALUE ZERO.         01915099
019160            15 PV-DC10-VFLD-SPACING  PIC 9(1) VALUE 1.            01916099
019170*                    ETA TO DC 11                                 01917099
019180         10 PV-CONTROL-DC11.                                      01918099
019190            15 PV-DC11-OORDER        PIC 9(2) VALUE 99.           01919099
019200            15 PV-DC11-POINTER       PIC 9(2) VALUE ZEROS.        01920099
019210            15 PV-DC11-SELECTED      PIC X(1) VALUE 'N'.          01921099
019220            15 PV-DC11-ONVSCREEN     PIC 9(2) VALUE ZERO.         01922099
019230            15 PV-DC11-VFLD-SPACING  PIC 9(1) VALUE 1.            01923099
019240*                    ETA TO DC 12                                 01924099
019250         10 PV-CONTROL-DC12.                                      01925099
019260            15 PV-DC12-OORDER        PIC 9(2) VALUE 99.           01926099
019270            15 PV-DC12-POINTER       PIC 9(2) VALUE ZEROS.        01927099
019280            15 PV-DC12-SELECTED      PIC X(1) VALUE 'N'.          01928099
019290            15 PV-DC12-ONVSCREEN     PIC 9(2) VALUE ZERO.         01929099
019300            15 PV-DC12-VFLD-SPACING  PIC 9(1) VALUE 1.            01930099
019310*                    DEVAN DATE AT DECONSOLIDATOR                 01931099
019320         10 PV-CONTROL-DVN.                                       01932099
019330            15 PV-DVN-OORDER         PIC 9(2) VALUE 99.           01933099
019340            15 PV-DVN-POINTER        PIC 9(2) VALUE ZEROS.        01934099
019350            15 PV-DVN-SELECTED       PIC X(1) VALUE 'N'.          01935099
019360            15 PV-DVN-ONVSCREEN      PIC 9(2) VALUE ZERO.         01936099
019370            15 PV-DVN-VFLD-SPACING   PIC 9(1) VALUE 1.            01937099
019380*                    OVERSEAS BOOKING DATE                        01938099
019390         10 PV-CONTROL-BKD.                                       01939099
019400            15 PV-BKD-OORDER         PIC 9(2) VALUE 99.           01940099
019410            15 PV-BKD-POINTER        PIC 9(2) VALUE ZEROS.        01941099
019420            15 PV-BKD-SELECTED       PIC X(1) VALUE 'N'.          01942099
019430            15 PV-BKD-ONVSCREEN      PIC 9(2) VALUE ZERO.         01943099
019440            15 PV-BKD-VFLD-SPACING   PIC 9(1) VALUE 1.            01944099
019450*                    IMPORT EXTENDED FIRST COST                   01945099
019460         10 PV-CONTROL-FSC.                                       01946099
019470            15 PV-FSC-OORDER         PIC 9(2) VALUE 99.           01947099
019480            15 PV-FSC-POINTER        PIC 9(2) VALUE ZEROS.        01948099
019490            15 PV-FSC-SELECTED       PIC X(1) VALUE 'N'.          01949099
019500            15 PV-FSC-ONVSCREEN      PIC 9(2) VALUE ZERO.         01950099
019510            15 PV-FSC-VFLD-SPACING   PIC 9(1) VALUE 1.            01951099
019520*                    IMPORT EXTENDED ESTIMATED LANDED COST        01952099
019530         10 PV-CONTROL-TTC.                                       01953099
019540            15 PV-TTC-OORDER         PIC 9(2) VALUE 99.           01954099
019550            15 PV-TTC-POINTER        PIC 9(2) VALUE ZEROS.        01955099
019560            15 PV-TTC-SELECTED       PIC X(1) VALUE 'N'.          01956099
019570            15 PV-TTC-ONVSCREEN      PIC 9(2) VALUE ZERO.         01957099
019580            15 PV-TTC-VFLD-SPACING   PIC 9(1) VALUE 1.            01958099
019590*                    TOTAL COST FOR VERIFIED UNITS                01959099
019600         10 PV-CONTROL-TVC.                                       01960099
019610            15 PV-TVC-OORDER         PIC 9(2) VALUE 99.           01961099
019620            15 PV-TVC-POINTER        PIC 9(2) VALUE ZEROS.        01962099
019630            15 PV-TVC-SELECTED       PIC X(1) VALUE 'N'.          01963099
019640            15 PV-TVC-ONVSCREEN      PIC 9(2) VALUE ZERO.         01964099
019650            15 PV-TVC-VFLD-SPACING   PIC 9(1) VALUE 1.            01965099
019660*                    UNITS ORDERED                                01966099
019670         10 PV-CONTROL-UOR.                                       01967099
019680            15 PV-UOR-OORDER         PIC 9(2) VALUE 99.           01968099
019690            15 PV-UOR-POINTER        PIC 9(2) VALUE ZEROS.        01969099
019700            15 PV-UOR-SELECTED       PIC X(1) VALUE 'N'.          01970099
019710            15 PV-UOR-ONVSCREEN      PIC 9(2) VALUE ZERO.         01971099
019720            15 PV-UOR-VFLD-SPACING   PIC 9(1) VALUE 1.            01972099
019730*                    UNITS RECEIVED                               01973099
019740         10 PV-CONTROL-URC.                                       01974099
019750            15 PV-URC-OORDER         PIC 9(2) VALUE 99.           01975099
019760            15 PV-URC-POINTER        PIC 9(2) VALUE ZEROS.        01976099
019770            15 PV-URC-SELECTED       PIC X(1) VALUE 'N'.          01977099
019780            15 PV-URC-ONVSCREEN      PIC 9(2) VALUE ZERO.         01978099
019790            15 PV-URC-VFLD-SPACING   PIC 9(1) VALUE 1.            01979099
019800*                    PERCENT OF UNITS RECEIVED                    01980099
019810         10 PV-CONTROL-URP.                                       01981099
019820            15 PV-URP-OORDER         PIC 9(2) VALUE 99.           01982099
019830            15 PV-URP-POINTER        PIC 9(2) VALUE ZEROS.        01983099
019840            15 PV-URP-SELECTED       PIC X(1) VALUE 'N'.          01984099
019850            15 PV-URP-ONVSCREEN      PIC 9(2) VALUE ZERO.         01985099
019860            15 PV-URP-VFLD-SPACING   PIC 9(1) VALUE 1.            01986099
019870*                    RETAIL DOLLARS ORDERED                       01987099
019880         10 PV-CONTROL-DOR.                                       01988099
019890            15 PV-DOR-OORDER         PIC 9(2) VALUE 99.           01989099
019900            15 PV-DOR-POINTER        PIC 9(2) VALUE ZEROS.        01990099
019910            15 PV-DOR-SELECTED       PIC X(1) VALUE 'N'.          01991099
019920            15 PV-DOR-ONVSCREEN      PIC 9(2) VALUE ZERO.         01992099
019930            15 PV-DOR-VFLD-SPACING   PIC 9(1) VALUE 1.            01993099
019940*                    RETAIL DOLLARS RECEIVED                      01994099
019950         10 PV-CONTROL-DRC.                                       01995099
019960            15 PV-DRC-OORDER         PIC 9(2) VALUE 99.           01996099
019970            15 PV-DRC-POINTER        PIC 9(2) VALUE ZEROS.        01997099
019980            15 PV-DRC-SELECTED       PIC X(1) VALUE 'N'.          01998099
019990            15 PV-DRC-ONVSCREEN      PIC 9(2) VALUE ZERO.         01999099
020000            15 PV-DRC-VFLD-SPACING   PIC 9(1) VALUE 1.            02000099
020010*                    PERCENT OF RETAIL DOLLARS RECEIVED           02001099
020020         10 PV-CONTROL-DRP.                                       02002099
020030            15 PV-DRP-OORDER         PIC 9(2) VALUE 99.           02003099
020040            15 PV-DRP-POINTER        PIC 9(2) VALUE ZEROS.        02004099
020050            15 PV-DRP-SELECTED       PIC X(1) VALUE 'N'.          02005099
020060            15 PV-DRP-ONVSCREEN      PIC 9(2) VALUE ZERO.         02006099
020070            15 PV-DRP-VFLD-SPACING   PIC 9(1) VALUE 1.            02007099
020080*                    OPEN TO BUY                                  02008099
020090         10 PV-CONTROL-OTB.                                       02009099
020100            15 PV-OTB-OORDER         PIC 9(2) VALUE 99.           02010099
020110            15 PV-OTB-POINTER        PIC 9(2) VALUE ZEROS.        02011099
020120            15 PV-OTB-SELECTED       PIC X(1) VALUE 'N'.          02012099
020130            15 PV-OTB-ONVSCREEN      PIC 9(2) VALUE ZERO.         02013099
020140            15 PV-OTB-VFLD-SPACING   PIC 9(1) VALUE 1.            02014099
020150*                    EDI INDICATOR                                02015099
020160         10 PV-CONTROL-EDI.                                       02016099
020170            15 PV-EDI-OORDER         PIC 9(2) VALUE 99.           02017099
020180            15 PV-EDI-POINTER        PIC 9(2) VALUE ZEROS.        02018099
020190            15 PV-EDI-SELECTED       PIC X(1) VALUE 'N'.          02019099
020200            15 PV-EDI-ONVSCREEN      PIC 9(2) VALUE ZERO.         02020099
020210            15 PV-EDI-VFLD-SPACING   PIC 9(1) VALUE 1.            02021099
020220*                    PREPACK VALUE                                02022099
020230         10 PV-CONTROL-PPK.                                       02023099
020240            15 PV-PPK-OORDER         PIC 9(2) VALUE 99.           02024099
020250            15 PV-PPK-POINTER        PIC 9(2) VALUE ZEROS.        02025099
020260            15 PV-PPK-SELECTED       PIC X(1) VALUE 'N'.          02026099
020270            15 PV-PPK-ONVSCREEN      PIC 9(2) VALUE ZERO.         02027099
020280            15 PV-PPK-VFLD-SPACING   PIC 9(1) VALUE 1.            02028099
020290*                    PURCHASE ORDER HEADER LEVEL STATUS           02029099
020300         10 PV-CONTROL-STA.                                       02030099
020310            15 PV-STA-OORDER         PIC 9(2) VALUE 99.           02031099
020320            15 PV-STA-POINTER        PIC 9(2) VALUE ZEROS.        02032099
020330            15 PV-STA-SELECTED       PIC X(1) VALUE 'N'.          02033099
020340            15 PV-STA-ONVSCREEN      PIC 9(2) VALUE ZERO.         02034099
020350            15 PV-STA-VFLD-SPACING   PIC 9(1) VALUE 1.            02035099
020360*                    MINIMUM AD EVENT DATE                        02036099
020370         10 PV-CONTROL-AED.                                       02037099
020380            15 PV-AED-OORDER         PIC 9(2) VALUE 99.           02038099
020390            15 PV-AED-POINTER        PIC 9(2) VALUE ZEROS.        02039099
020400            15 PV-AED-SELECTED       PIC X(1) VALUE 'N'.          02040099
020410            15 PV-AED-ONVSCREEN      PIC 9(2) VALUE ZERO.         02041099
020420            15 PV-AED-VFLD-SPACING   PIC 9(1) VALUE 1.            02042099
020430*                    TRIP TYPE                                    02043099
020440         10 PV-CONTROL-TRP.                                       02044099
020450            15 PV-TRP-OORDER         PIC 9(2) VALUE 99.           02045099
020460            15 PV-TRP-POINTER        PIC 9(2) VALUE ZEROS.        02046099
020470            15 PV-TRP-SELECTED       PIC X(1) VALUE 'N'.          02047099
020480            15 PV-TRP-ONVSCREEN      PIC 9(2) VALUE ZERO.         02048099
020490            15 PV-TRP-VFLD-SPACING   PIC 9(1) VALUE 1.            02049099
020500*                    DC SPLITS CREATED                            02050099
020510         10 PV-CONTROL-SPL-CRT.                                   02051099
020520            15 PV-SPL-CRT-OORDER         PIC 9(2) VALUE 99.       02052099
020530            15 PV-SPL-CRT-POINTER        PIC 9(2) VALUE ZEROS.    02053099
020540            15 PV-SPL-CRT-SELECTED       PIC X(1) VALUE 'N'.      02054099
020550            15 PV-SPL-CRT-ONVSCREEN      PIC 9(2) VALUE ZERO.     02055099
020560            15 PV-SPL-CRT-VFLD-SPACING   PIC 9(1) VALUE 1.        02056099
020570*                    DC SPLITS SENT                               02057099
020580         10 PV-CONTROL-SPL-SNT.                                   02058099
020590            15 PV-SPL-SNT-OORDER         PIC 9(2) VALUE 99.       02059099
020600            15 PV-SPL-SNT-POINTER        PIC 9(2) VALUE ZEROS.    02060099
020610            15 PV-SPL-SNT-SELECTED       PIC X(1) VALUE 'N'.      02061099
020620            15 PV-SPL-SNT-ONVSCREEN      PIC 9(2) VALUE ZERO.     02062099
020630            15 PV-SPL-SNT-VFLD-SPACING   PIC 9(1) VALUE 1.        02063099
020640*                    STORE DISTRO                                 02064099
020650         10 PV-CONTROL-STD.                                       02065099
020660            15 PV-STD-OORDER             PIC 9(2) VALUE 99.       02066099
020670            15 PV-STD-POINTER            PIC 9(2) VALUE ZEROS.    02067099
020680            15 PV-STD-SELECTED           PIC X(1) VALUE 'N'.      02068099
020690            15 PV-STD-ONVSCREEN          PIC 9(2) VALUE ZERO.     02069099
020700            15 PV-STD-VFLD-SPACING       PIC 9(1) VALUE 1.        02070099
020710*                    QUOTA COUNT                                  02071099
020720         10 PV-CONTROL-QCT.                                       02072099
020730            15 PV-QCT-OORDER         PIC 9(2) VALUE 99.           02073099
020740            15 PV-QCT-POINTER        PIC 9(2) VALUE ZEROS.        02074099
020750            15 PV-QCT-SELECTED       PIC X(1) VALUE 'N'.          02075099
020760            15 PV-QCT-ONVSCREEN      PIC 9(2) VALUE ZERO.         02076099
020770            15 PV-QCT-VFLD-SPACING   PIC 9(1) VALUE 1.            02077099
020780*                    VENDOR STYLE                                 02078099
020790         10 PV-CONTROL-VNS.                                       02079099
020800            15 PV-VNS-OORDER         PIC 9(2) VALUE 99.           02080099
020810            15 PV-VNS-POINTER        PIC 9(2) VALUE ZEROS.        02081099
020820            15 PV-VNS-SELECTED       PIC X(1) VALUE 'N'.          02082099
020830            15 PV-VNS-ONVSCREEN      PIC 9(2) VALUE ZERO.         02083099
020840            15 PV-VNS-VFLD-SPACING   PIC 9(1) VALUE 1.            02084099
020850*                    CONTAINER RELEASE                            02085099
020860         10 PV-CONTROL-CRL.                                       02086099
020870            15 PV-CRL-OORDER         PIC 9(2) VALUE 99.           02087099
020880            15 PV-CRL-POINTER        PIC 9(2) VALUE ZEROS.        02088099
020890            15 PV-CRL-SELECTED       PIC X(1) VALUE 'N'.          02089099
020900            15 PV-CRL-ONVSCREEN      PIC 9(2) VALUE ZERO.         02090099
020910            15 PV-CRL-VFLD-SPACING   PIC 9(1) VALUE 1.            02091099
020920*                    TRAILER AVAILABLE                            02092099
020930         10 PV-CONTROL-TRA.                                       02093099
020940            15 PV-TRA-OORDER         PIC 9(2) VALUE 99.           02094099
020950            15 PV-TRA-POINTER        PIC 9(2) VALUE ZEROS.        02095099
020960            15 PV-TRA-SELECTED       PIC X(1) VALUE 'N'.          02096099
020970            15 PV-TRA-ONVSCREEN      PIC 9(2) VALUE ZERO.         02097099
020980            15 PV-TRA-VFLD-SPACING   PIC 9(1) VALUE 1.            02098099
020990*---------------------------------------------------------------* 02099099
021000*  PV-VARIABLE-CONTROL-FIELDS DEFINED AS AN ARRAY               * 02100099
021010*---------------------------------------------------------------* 02101099
021020     05  PV-VCTL-TABLE.                                           02102099
021030         10 PV-VFLD-CONTROL-VALUES                                02103099
021040               OCCURS 47 TIMES                                    02104099
021050                 INDEXED BY VCTL-I.                               02105099
021060             15 PV-USORT-ORDER        PIC 9(2).                   02106099
021070             15 PV-USORT-POINTER      PIC 9(2).                   02107099
021080             15 PV-USORT-SELECTED     PIC X(1).                   02108099
021090             15 PV-USORT-ONVSCREEN    PIC 9(2).                   02109099
021100             15 PV-USORT-VFLD-SPACING PIC 9(1).                   02110099
021110*---------------------------------------------------------------* 02111099
021120*  PV-VARIABLE-CONTROL-FIELDS AS SORTED                         * 02112099
021130*---------------------------------------------------------------* 02113099
021140     05  PV-VCTL-SORTED-TABLE.                                    02114099
021150         10 PV-VFLD-CONTROL-SORTED-VALUES                         02115099
021160               OCCURS 47 TIMES                                    02116099
021170                 INDEXED BY PV-VSCTL-I.                           02117099
021180             15 PV-SORT-ORDER         PIC 9(2).                   02118099
021190             15 PV-SORT-POINTER       PIC 9(2).                   02119099
021200             15 PV-SORT-SELECTED      PIC X(1).                   02120099
021210             15 PV-SORT-ONVSCREEN     PIC 9(2).                   02121099
021220             15 PV-SORT-VFLD-SPACING  PIC 9(1).                   02122099
021230*---------------------------------------------------------------* 02123099
021240*  DC ARRAY THE PROGRAM CAN CURRENTLY HANDLE 12 DCS.            * 02124099
021250*---------------------------------------------------------------* 02125099
021260      05  PV-DC-TABLE.                                            02126099
021270          10  PV-DC-TABLE-VALUES                                  02127099
021280               OCCURS 12 TIMES                                    02128099
021290                 INDEXED BY DC-I.                                 02129099
021300              15 DC-STORE-NMBR             PIC S9(04) COMP.       02130099
021310              15 DC-STORE-NAME             PIC X(05).             02131099
021320                                                                  02132099
021330*----------------------------------------------------------------*02133099
021340*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *02134099
021350*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *02135099
021360*   APPLICATION-SPECIFIC COMMAREA.                               *02136099
021370*----------------------------------------------------------------*02137099
021380 01  LQW-LIST-QUEUE-WORK-AREA.                                    02138099
021390     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02139099
021400     05  LQW-ITEM-ENTRIES               OCCURS 13   TIMES         02140099
021410                                        INDEXED BY  LQW-IDX.      02141099
021420         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02142099
021430         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02143099
021440         10  LQW-SELECTED-SW            PIC  X(01).               02144099
021450             88 LQW-SELECT              VALUE 'S'.                02145099
021460             88 LQW-DESELECT            VALUE ' '.                02146099
021470         10  LQW-PO                     PIC S9(09) COMP.          02147099
021480         10  LQW-DEPT                   PIC  9(04) COMP.          02148099
021490         10  LQW-VND                    PIC  X(8).                02149099
021500         10  LQW-DMM-FIXED              PIC  X(02).               02150099
021510         10  LQW-IP                     PIC  X(1).                02151099
021520 EJECT                                                            02152099
021530*----------------------------------------------------------------*02153099
021540*   THIS IS THE LAYOUT FOR THE EXTENDED DATA TEMP STORAGE QUEUE. *02154099
021550*   THE NUMBER OF BLOCKS AND ITEM ARRAY MUST CORRESPOND TO THE   *02155099
021560*   APPLICATION SPECIFIC COMMAREA.                               *02156099
021570*                                                                *02157099
021580*   THE EXTENDED TEMPORARY STORAGE QUEUE WAS BUILT TO BE AN      *02158099
021590*   EXTENSION TO THE APPLICATION SPECIFIC COMMAREA.  THE         *02159099
021600*   APPLICATION SPECIFIC COMMAREA COULD NOT HOLD THE ENTIRE      *02160099
021610*   VARIABLE DATA SO AN EXTENDED AREA WAS NEEDED.                *02161099
021620*----------------------------------------------------------------*02162099
021630 01  EXT-LIST-QUEUE-WORK-AREA.                                    02163099
021640     15  EXT-BLOCK-ENTRIES OCCURS 2 TIMES.                        02164099
021650         20  EXT-ITEM-ARRAY             OCCURS 13   TIMES         02165099
021660                                        INDEXED BY  EXT-IDX.      02166099
021670             30  EXT-LIST-ITEM-NUMBER   PIC S9(09)  COMP-3.       02167099
021680             30  EXT-PO                 PIC S9(09)  COMP.         02168099
021690             30  EXT-FOB                PIC  X(03).               02169099
021700             30  EXT-POE                PIC  X(03).               02170099
021710             30  EXT-DSB                PIC  X(08).               02171099
021720             30  EXT-SXF                PIC  X(08).               02172099
021730             30  EXT-LXF                PIC  X(08).               02173099
021740             30  EXT-CNL                PIC  X(08).               02174099
021750             30  EXT-FRD                PIC  X(08).               02175099
021760             30  EXT-SLD                PIC  X(08).               02176099
021770             30  EXT-PRD                PIC  X(08).               02177099
021780             30  EXT-PRD-ETA-ATA        PIC  X(02).               02178099
021790             30  EXT-CNT                PIC  X(12).               02179099
021800             30  EXT-CSR                PIC  X(08).               02180099
021810             30  EXT-DC1                PIC  X(08).               02181099
021820             30  EXT-DC1-ETA-ATA        PIC  X(02).               02182099
021830             30  EXT-DC2                PIC  X(08).               02183099
021840             30  EXT-DC2-ETA-ATA        PIC  X(02).               02184099
021850             30  EXT-DC3                PIC  X(08).               02185099
021860             30  EXT-DC3-ETA-ATA        PIC  X(02).               02186099
021870             30  EXT-DC4                PIC  X(08).               02187099
021880             30  EXT-DC4-ETA-ATA        PIC  X(02).               02188099
021890             30  EXT-DC5                PIC  X(08).               02189099
021900             30  EXT-DC5-ETA-ATA        PIC  X(02).               02190099
021910             30  EXT-DC6                PIC  X(08).               02191099
021920             30  EXT-DC6-ETA-ATA        PIC  X(02).               02192099
021930             30  EXT-DC7                PIC  X(08).               02193099
021940             30  EXT-DC7-ETA-ATA        PIC  X(02).               02194099
021950             30  EXT-DC8                PIC  X(08).               02195099
021960             30  EXT-DC8-ETA-ATA        PIC  X(02).               02196099
021970             30  EXT-DC9                PIC  X(08).               02197099
021980             30  EXT-DC9-ETA-ATA        PIC  X(02).               02198099
021990             30  EXT-DC10               PIC  X(08).               02199099
022000             30  EXT-DC10-ETA-ATA       PIC  X(02).               02200099
022010             30  EXT-DC11               PIC  X(08).               02201099
022020             30  EXT-DC11-ETA-ATA       PIC  X(02).               02202099
022030             30  EXT-DC12               PIC  X(08).               02203099
022040             30  EXT-DC12-ETA-ATA       PIC  X(02).               02204099
022050             30  EXT-DVN                PIC  X(08).               02205099
022060             30  EXT-BKD                PIC  X(08).               02206099
022070             30  EXT-AED                PIC  X(08).               02207099
022080             30  EXT-FSC                PIC  9(9)V9(2) COMP-3.    02208099
022090             30  EXT-TTC                PIC  9(9)V9(2) COMP-3.    02209099
022100             30  EXT-TVC                PIC  9(9)V9(2) COMP-3.    02210099
022110             30  EXT-UOR                PIC S9(9) COMP.           02211099
022120             30  EXT-URC                PIC S9(9) COMP.           02212099
022130             30  EXT-DOR                PIC  9(9)V9(2) COMP-3.    02213099
022140             30  EXT-DRC                PIC  9(9)V9(2) COMP-3.    02214099
022150             30  EXT-OTB                PIC  X(06).               02215099
022160             30  EXT-STA                PIC  X(02).               02216099
022170             30  EXT-INP                PIC  X(01).               02217099
022180             30  EXT-EDI                PIC  X(01).               02218099
022190             30  EXT-PPK                PIC  X(01).               02219099
022200             30  EXT-TRP                PIC  X(03).               02220099
022210             30  EXT-SPL-CRT            PIC  X(08).               02221099
022220             30  EXT-SPL-SNT            PIC  X(08).               02222099
022230             30  EXT-STD                PIC  X(01).               02223099
022240             30  EXT-QCT                PIC  X(05).               02224099
022250             30  EXT-VNS                PIC  X(08).               02225099
022260             30  EXT-CRL                PIC  X(08).               02226099
022270             30  EXT-TRA                PIC  X(08).               02227099
022280 EJECT                                                            02228099
022290*----------------------------------------------------------------*02229099
022300*   THIS IS THE LAYOUT FOR THE PO QUEUE TEMP STORAGE AREA.       *02230099
022310*   THE NUMBER OF BLOCKS AND ITEM ARRAY MUST CORRESPOND TO THE   *02231099
022320*   APPLICATION SPECIFIC COMMAREA.                               *02232099
022330*----------------------------------------------------------------*02233099
022340 01  POQ-LIST-QUEUE-WORK-AREA.                                    02234099
022350     15  POQ-ITEM-ARRAY             OCCURS 26  TIMES              02235099
022360                                    INDEXED BY POQ-IDX.           02236099
022370         20  POQ-PO                 PIC S9(09) COMP.              02237099
022380         20  POQ-FSC                PIC 9(9)V9(2) COMP-3.         02238099
022390         20  POQ-TTC                PIC 9(9)V9(2) COMP-3.         02239099
022400         20  POQ-TVC                PIC 9(9)V9(2) COMP-3.         02240099
022410         20  POQ-DOR                PIC 9(9)V9(2) COMP-3.         02241099
022420         20  POQ-DRC                PIC 9(9)V9(2) COMP-3.         02242099
022430         20  POQ-UOR                PIC S9(9) COMP.               02243099
022440         20  POQ-URC                PIC S9(9) COMP.               02244099
022450 EJECT                                                            02245099
022460*---------------------------------------------------------------* 02246099
022470*  RECORD LAYOUT FOR THE PO SELECTION TEMP STORAGE QUEUE.       * 02247099
022480*---------------------------------------------------------------* 02248099
022490     COPY POWS012.                                                02249099
022500                                                                  02250099
022510 EJECT                                                            02251099
022520*---------------------------------------------------------------* 02252099
022530*    MAP LAYOUT                                                 * 02253099
022540*---------------------------------------------------------------* 02254099
022550                                                                  02255099
022560     COPY TRKM196.                                                02256099
022570 01  MR-OCCURS-LAYOUT                   REDEFINES  TR196AO.       02257099
022580     05  FILLER                         PIC X(42).                02258099
022590                                                                  02259099
022600     05  MR-VHEADER-LEVEL1-AREA.                                  02260099
022610         10  MR-VHDR1L                  PIC S9(04) COMP.          02261099
022620         10  MR-VHDR1A                  PIC  X(01).               02262099
022630         10  MR-VHDR1-FILLER            PIC  X(02).               02263099
022640         10  MR-VHDR1                   PIC  X(49).               02264099
022650                                                                  02265099
022660     05  MR-VHEADER-LEVEL2-AREA.                                  02266099
022670         10  MR-VHDR2L                  PIC S9(04) COMP.          02267099
022680         10  MR-VHDR2A                  PIC  X(01).               02268099
022690         10  MR-VHDR2-FILLER            PIC  X(02).               02269099
022700         10  MR-VHDR2                   PIC  X(49).               02270099
022710                                                                  02271099
022720     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          02272099
022730         10  MR-SELECTL                 PIC S9(04) COMP.          02273099
022740         10  MR-SELECTA                 PIC  X(01).               02274099
022750         10  MR-SELECTC                 PIC  X(01).               02275099
022760         10  MR-SELECTH                 PIC  X(01).               02276099
022770         10  MR-SELECTI                 PIC  X(01).               02277099
022780                                                                  02278099
022790         10  MR-POL                     PIC S9(04) COMP.          02279099
022800         10  MR-POA                     PIC  X(01).               02280099
022810         10  MR-POC                     PIC  X(01).               02281099
022820         10  MR-POH                     PIC  X(01).               02282099
022830         10  MR-PO                      PIC  ZZZZZZZZ.            02283099
022840                                                                  02284099
022850         10  MR-DEPTL                   PIC S9(04) COMP.          02285099
022860         10  MR-DEPTA                   PIC  X(01).               02286099
022870         10  MR-DEPTC                   PIC  X(01).               02287099
022880         10  MR-DEPTH                   PIC  X(01).               02288099
022890         10  MR-DEPT                    PIC  ZZZZ.                02289099
022900                                                                  02290099
022910         10  MR-VENDORL                 PIC S9(04) COMP.          02291099
022920         10  MR-VENDORA                 PIC  X(01).               02292099
022930         10  MR-VENDORC                 PIC  X(01).               02293099
022940         10  MR-VENDORH                 PIC  X(01).               02294099
022950         10  MR-VENDOR                  PIC  X(08).               02295099
022960                                                                  02296099
022970         10  MR-DMML                    PIC S9(04) COMP.          02297099
022980         10  MR-DMMA                    PIC  X(01).               02298099
022990         10  MR-DMMC                    PIC  X(01).               02299099
023000         10  MR-DMMH                    PIC  X(01).               02300099
023010         10  MR-DMM-FIXED               PIC  X(02).               02301099
023020                                                                  02302099
023030         10  MR-VFLDL                   PIC S9(04) COMP.          02303099
023040         10  MR-VFLDA                   PIC  X(01).               02304099
023050         10  MR-VFLDC                   PIC  X(01).               02305099
023060         10  MR-VFLDH                   PIC  X(01).               02306099
023070         10  MR-VFLD                    PIC  X(49).               02307099
023080                                                                  02308099
023090     05  MR-TOTAL-AREA.                                           02309099
023100                                                                  02310099
023110         10  MR-TTXTL               PIC S9(04) COMP.              02311099
023120         10  MR-TTXTA               PIC  X(01).                   02312099
023130         10  MR-TTXTC               PIC  X(01).                   02313099
023140         10  MR-TTXTH               PIC  X(01).                   02314099
023150         10  MR-TTXT                PIC  X(20).                   02315099
023160                                                                  02316099
023170         10  MR-TFLDL               PIC S9(04) COMP.              02317099
023180         10  MR-TFLDA               PIC  X(01).                   02318099
023190         10  MR-TFLDC               PIC  X(01).                   02319099
023200         10  MR-TFLDH               PIC  X(01).                   02320099
023210         10  MR-TFLD                PIC  X(49).                   02321099
023220                                                                  02322099
023230 EJECT                                                            02323099
023240*---------------------------------------------------------------* 02324099
023250*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02325099
023260*---------------------------------------------------------------* 02326099
023270                                                                  02327099
023280     COPY DPWS015.                                                02328099
023290                                                                  02329099
023300 EJECT                                                            02330099
023310*---------------------------------------------------------------* 02331099
023320*    FUNCTION KEYS COPYBOOK.                                    * 02332099
023330*---------------------------------------------------------------* 02333099
023340                                                                  02334099
023350     COPY DPWS016.                                                02335099
023360                                                                  02336099
023370 EJECT                                                            02337099
023380*---------------------------------------------------------------* 02338099
023390*    NUMERIC EDIT LAYOUT.                                       * 02339099
023400*---------------------------------------------------------------* 02340099
023410                                                                  02341099
023420     COPY DPWS010I.                                               02342099
023430                                                                  02343099
023440 EJECT                                                            02344099
023450*---------------------------------------------------------------* 02345099
023460*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02346099
023470*---------------------------------------------------------------* 02347099
023480                                                                  02348099
023490     COPY DPWS030.                                                02349099
023500     COPY DPWS930.                                                02350099
023510 EJECT                                                            02351099
023520*---------------------------------------------------------------* 02352099
023530*    STANDARD COMMAREA.                                         * 02353099
023540*---------------------------------------------------------------* 02354099
023550                                                                  02355099
023560     COPY DPWS020.                                                02356099
023570     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02357099
023580                                                                  02358099
023590*---------------------------------------------------------------* 02359099
023600* INTER-APPLICATION COMMAREA.                                   * 02360099
023610*   TRWS105 - ARE THE INPUT LAYOUTS FOR THIS PROGRAM            * 02361099
023620*---------------------------------------------------------------* 02362099
023630                                                                  02363099
023640         10  INTER-APPL-COMM-AREA       PIC X(200).               02364099
023650     COPY TRWS105.                                                02365099
023660     COPY POWS013.                                                02366099
023670     COPY TRWS195.                                                02367099
023680                                                                  02368099
023690*---------------------------------------------------------------* 02369099
023700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02370099
023710*---------------------------------------------------------------* 02371099
023720         10  ASC-SPECIFIC-COMMAREA.                               02372099
023730             15  TR195-CLASS-RANGE-SW        PIC X(01).           02373099
023740                 88  TR195-CLASS-RANGE       VALUE 'Y'.           02374099
023750             15  ASC-SEL-CRIT-FIELDS.                             02375099
023760                 20  ASC-KEY-PO-NBR          PIC S9(9) COMP.      02376099
023770                 20  ASC-KEY-CNTRY-ORG       PIC X(3).            02377099
023780                 20  ASC-KEY-CNTRY-PLC       PIC X(3).            02378099
023790                 20  ASC-XFACT-BEF-DTE       PIC X(10).           02379099
023800                 20  ASC-XFACT-END-DTE       PIC X(10).           02380099
023810                 20  ASC-DEPT-NBR            PIC 9(04) COMP.      02381099
023820                 20  ASC-STR-NBR             PIC S9(04) COMP.     02382099
023830                 20  ASC-CLASS               PIC 9(04) COMP.      02383099
023840                 20  ASC-SUBCLASS            PIC 9(04) COMP.      02384099
023850                 20  ASC-SKU                 PIC 9(08) COMP.      02385099
023860                 20  ASC-SHPDT-BEF-DTE       PIC X(10).           02386099
023870                 20  ASC-SHPDT-END-DTE       PIC X(10).           02387099
023880                 20  ASC-OTB-PER-NBR-BEG     PIC X(6).            02388099
023890                 20  ASC-OTB-PER-NBR-END     PIC X(6).            02389099
023900                 20  ASC-EDI-IND             PIC X(01).           02390099
023910                 20  ASC-STATUS-CDE          PIC X(2).            02391099
023920                 20  ASC-AD-EVNT-DTE         PIC X(10).           02392099
023930                 20  ASC-PACK-BY-STORE-IND   PIC X(01).           02393099
023940                 20  ASC-STATUS-CLS          PIC X(3).            02394099
023950                 20  ASC-NEW-STR-IND         PIC X(01).           02395099
023960                 20  ASC-PRE-TICKET-IND      PIC X(01).           02396099
023970                 20  ASC-PO-TYP-CDE          PIC X(2).            02397099
023980                 20  ASC-FOB-CDE             PIC X(03).           02398099
023990                 20  ASC-POE-CDE             PIC X(03).           02399099
024000                 20  ASC-DIRECT-STORE-IND    PIC X(01).           02400099
024010                 20  ASC-PIC-AD-IND          PIC X(01).           02401099
024020                 20  ASC-PRE-PACK-IND        PIC X(01).           02402099
024030                 20  ASC-MAKER-NME           PIC X(35).           02403099
024040                 20  ASC-ENT-NAME-DESC       PIC X(30).           02404099
024050                 20  ASC-VEND-STYL-NME       PIC X(20).           02405099
024060                 20  ASC-SEASONAL-SET        PIC X(05).           02406099
024070                 20  ASC-QUOTA-CATEGORY      PIC X(05).           02407099
024080                 20  ASC-DMM                 PIC X(02).           02408099
024090                 20  ASC-GROUP-CDE           PIC X(03).           02409099
024100                 20  ASC-SORT1-BY-IND        PIC X(01).           02410099
024110                 20  ASC-SORT2-BY-IND        PIC X(01).           02411099
024120             15  ASC-LIST-TOTALS.                                 02412099
024130                 20  ASC-TFSC   PIC 9(12)V9(2) COMP-3.            02413099
024140                 20  ASC-TTTC   PIC 9(12)V9(2) COMP-3.            02414099
024150                 20  ASC-TTVC   PIC 9(12)V9(2) COMP-3.            02415099
024160                 20  ASC-TUOR   PIC S9(9) COMP.                   02416099
024170                 20  ASC-TURC   PIC S9(9) COMP.                   02417099
024180                 20  ASC-TDOR   PIC 9(12)V9(2) COMP-3.            02418099
024190                 20  ASC-TDRC   PIC 9(12)V9(2) COMP-3.            02419099
024200             15  ASC-TASK-DOCUMENTING.                            02420099
024210                 20 ASC-DOC-SW                PIC X(01).          02421099
024220                    88  ASC-WRITE-TO-CSSL      VALUE 'Y'.         02422099
024230                    88  ASC-DONT-WRITE-TO-CSSL VALUE 'N'.         02423099
024240                 20 ASC-CICS-ABSTIME     PIC S9(15) COMP-3 SYNC.  02424099
024250                 20 ASC-CICS-CURRENT-SECONDS                      02425099
024260                                         PIC S9(8)V9(2) COMP-3.   02426099
024270                 20 ASC-CICS-LAST-SECONDS                         02427099
024280                                         PIC S9(8)V9(2) COMP-3.   02428099
024290                 20 ASC-LAST-DB-SECONDS                           02429099
024300                                         PIC S9(8)V9(2) COMP-3.   02430099
024310                 20 ASC-CICS-DATE        PIC X(8).                02431099
024320                 20 ASC-CICS-TIME        PIC X(8).                02432099
024330                 20 ASC-GROUPS-LOADED    PIC ZZZZ9.               02433099
024340                 20 ASC-TASK-ID          PIC 9(01).               02434099
024350                 20 ASC-TASK-DURATION    PIC 9(3)V9(2).           02435099
024360                 20 ASC-TASK-TIME        PIC 9(3)V9(2).           02436099
024370                 20 ASC-TASK-POINTER     PIC S9(04)               02437099
024380                                             COMP SYNC.           02438099
024390                 20 ASC-DB-LOAD1-CNT     PIC S9(04)               02439099
024400                                             COMP SYNC.           02440099
024410                 20 ASC-DB-LOAD2-CNT     PIC S9(04)               02441099
024420                                             COMP SYNC.           02442099
024430                 20 ASC-DB-LOAD3-CNT     PIC S9(04)               02443099
024440                                             COMP SYNC.           02444099
024450                 20 ASC-DB-LOAD1-SECONDS                          02445099
024460                                         PIC S9(8)V9(2) COMP-3.   02446099
024470                 20 ASC-DB-LOAD2-SECONDS                          02447099
024480                                         PIC S9(8)V9(2) COMP-3.   02448099
024490                 20 ASC-DB-LOAD3-SECONDS                          02449099
024500                                         PIC S9(8)V9(2) COMP-3.   02450099
024510                 20 ASC-DB-LOAD1-AVG                              02451099
024520                                         PIC S9(8)V9(2) COMP-3.   02452099
024530                 20 ASC-DB-LOAD2-AVG                              02453099
024540                                         PIC S9(8)V9(2) COMP-3.   02454099
024550                 20 ASC-DB-LOAD3-AVG                              02455099
024560                                         PIC S9(8)V9(2) COMP-3.   02456099
024570             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02457099
024580                 20  ASC-BLOCK-MODIFIED-SW          PIC  X(01).   02458099
024590                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    02459099
024600                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    02460099
024610                                                                  02461099
024620                 20  ASC-ITEM-ARRAY.                              02462099
024630                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        02463099
024640                         30  ASC-LIST-ITEM-NUMBER                 02464099
024650                                                     PIC S9(09)   02465099
024660                                                     COMP-3.      02466099
024670                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  02467099
024680                             88  ASC-VALID-SELECT    VALUE ' '    02468099
024690                                                           'S'    02469099
024700                                                           'B'    02470099
024710                                                           'E'.   02471099
024720                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   02472099
024730                             88  ASC-TEMP-SELECT     VALUE 'S'.   02473099
024740                             88  ASC-TEMP-BEGIN      VALUE 'B'.   02474099
024750                             88  ASC-TEMP-END        VALUE 'E'.   02475099
024760                         30  ASC-SELECTED-SW         PIC  X(01).  02476099
024770                             88  ASC-NO-SELECT       VALUE ' '.   02477099
024780                             88  ASC-SELECT          VALUE 'S'.   02478099
024790                             88  ASC-BEGIN           VALUE 'B'.   02479099
024800                             88  ASC-END             VALUE 'E'.   02480099
024810                         30  ASC-PO         PIC  S9(09) COMP.     02481099
024820                         30  ASC-DEPT       PIC  9(04) COMP.      02482099
024830                         30  ASC-VND        PIC  X(08).           02483099
024840                         30  ASC-DMM-FIXED  PIC  X(02).           02484099
024850                         30  ASC-IP         PIC  X(01).           02485099
024860                                                                  02486099
024870             15  ASC-BLK-SUB                         PIC S9(04)   02487099
024880                                                          COMP    02488099
024890                                                          SYNC.   02489099
024900             15  ASC-EXT-SUB                         PIC S9(04)   02490099
024910                                                          COMP    02491099
024920                                                          SYNC.   02492099
024930             15  ASC-ITEM-SUB                        PIC S9(04)   02493099
024940                                                          COMP    02494099
024950                                                          SYNC.   02495099
024960             15  ASC-POQ-ITEM-SUB                    PIC S9(04)   02496099
024970                                                          COMP    02497099
024980                                                          SYNC.   02498099
024990             15  ASC-POQ-BLK-SUB                     PIC S9(04)   02499099
025000                                                          COMP    02500099
025010                                                          SYNC.   02501099
025020             15  ASC-POQ-LAST-SUB                    PIC S9(04)   02502099
025030                                                          COMP    02503099
025040                                                          SYNC.   02504099
025050             15  ASC-POQ-LAST-ITEM                   PIC S9(04)   02505099
025060                                                          COMP    02506099
025070                                                          SYNC.   02507099
025080             15  ASC-POQ-LAST-BLK                    PIC S9(04)   02508099
025090                                                          COMP    02509099
025100                                                          SYNC.   02510099
025110             15  ASC-MAX-GROUPS                      PIC S9(09)   02511099
025120                                                          COMP    02512099
025130                                                          SYNC.   02513099
025140             15  ASC-SEL-ITEM                        PIC S9(04)   02514099
025150                                                          COMP    02515099
025160                                                          SYNC.   02516099
025170             15  ASC-SEL-SUB                         PIC S9(04)   02517099
025180                                                          COMP    02518099
025190                                                          SYNC.   02519099
025200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   02520099
025210                                                          COMP-3. 02521099
025220             15  ASC-NUMBER-OF-POS-READ              PIC S9(09)   02522099
025230                                                          COMP-3. 02523099
025240             15  ASC-NBR-OF-POS-DISPLAYED            PIC S9(09)   02524099
025250                                                          COMP-3. 02525099
025260             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   02526099
025270                                                          COMP-3. 02527099
025280             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   02528099
025290                                                          COMP-3. 02529099
025300             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   02530099
025310                                                          COMP-3. 02531099
025320             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   02532099
025330                                                          COMP-3. 02533099
025340             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02534099
025350                                                          COMP    02535099
025360                                                          SYNC.   02536099
025370             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   02537099
025380                                                          COMP-3. 02538099
025390             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   02539099
025400                                                          COMP-3. 02540099
025410             15  ASC-WRITE-EXTENDED-STORAGE-SW       PIC  X(01).  02541099
025420                 88  ASC-WRITE-EXTENDED-STORAGE      VALUE 'Y'.   02542099
025430                 88  ASC-DONT-WRITE-EXT-STORAGE      VALUE 'N'.   02543099
025440             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  02544099
025450                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   02545099
025460                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   02546099
025470             15  ASC-ITEMS-LEFT-ON-PO--IND           PIC  X(01).  02547099
025480                 88  ASC-ITEMS-LEFT-ON-PO            VALUE 'Y'.   02548099
025490                 88  ASC-NO-ITEMS-LEFT-ON-PO         VALUE 'N'.   02549099
025500             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  02550099
025510                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   02551099
025520                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   02552099
025530             15  ASC-LIST-QUEUE-NAME.                             02553099
025540                 20  ASC-LIST-TERM-ID                PIC  X(04).  02554099
025550                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   02555099
025560                                                          COMP-3. 02556099
025570                 20  ASC-LIST-SEQ                    PIC  9(01).  02557099
025580             15  ASC-SEL-QUEUE-NAME.                              02558099
025590                 20  ASC-SEL-TERM-ID                 PIC  X(04).  02559099
025600                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   02560099
025610                                                          COMP-3. 02561099
025620                 20  ASC-SEL-SEQ                     PIC  9(01).  02562099
025630             15  ASC-PO-QUEUE-NAME.                               02563099
025640                 20  ASC-PO-TERM-ID                  PIC  X(04).  02564099
025650                 20  ASC-PO-TASK-NUMBER              PIC S9(05)   02565099
025660                                                          COMP-3. 02566099
025670                 20  ASC-PO-SEQ                      PIC  9(01).  02567099
025680             15  ASC-EXTENDED-QUEUE-NAME.                         02568099
025690                 20  ASC-EXTENDED-TERM-ID            PIC  X(04).  02569099
025700                 20  ASC-EXTENDED-TASK-NUMBER        PIC S9(05)   02570099
025710                                                          COMP-3. 02571099
025720                 20  ASC-EXTENDED-SEQ                PIC  9(01).  02572099
025730             15  ASC-JCL-QUEUE-NAME.                              02573099
025740                 20  ASC-JCL-TERM-ID                 PIC  X(04).  02574099
025750                 20  ASC-JCL-TASK-NUMBER             PIC S9(05)   02575099
025760                                                          COMP-3. 02576099
025770                 20  ASC-JCL-SEQ                     PIC  9(01).  02577099
025780             15  ASC-USE-SEL-QUEUE-SW    PIC  X(01).              02578099
025790                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   02579099
025800                 88  ASC-NO-USE-SELECTION-QUEUE      VALUE 'N'.   02580099
025810             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(09)   02581099
025820                                                          COMP-3. 02582099
025830             15  ASC-START-ITEM-REQUEST.                          02583099
025840                 20  ASC-START-ITEM-REQUEST-N        PIC 9(05).   02584099
025850*---------------------------------------------------------------* 02585099
025860*    ADDITIONAL COMMAREA VARIABLE DISPLAY VARIABLES             * 02586099
025870*---------------------------------------------------------------* 02587099
025880*    VCTL-SORTED-TABLE CONTAINS THE CONTROL INFORMATION FOR THE * 02588099
025890*    VARIABLE DISPLAY.  DURING THE PROGRAM START UP PHASE       * 02589099
025900*    THIS TABLE IS BUILT.                                       * 02590099
025910*---------------------------------------------------------------* 02591099
025920             15  ASC-VCTL-SORTED-TABLE               PIC X(376).  02592099
025930             15  ASC-DC-TABLE                        PIC X(84).   02593099
025940             15  ASC-DC-NMBR                         PIC 9(2).    02594099
025950*---------------------------------------------------------------* 02595099
025960*    REDRAW-VARIABLE-SCREEN INDICATES WHETHER THE SCREEN        * 02596099
025970*    SHOULD BE DRAWN AGAIN.                                     * 02597099
025980*---------------------------------------------------------------* 02598099
025990             15  ASC-REDRAW-VARIABLE-SCREEN          PIC S9.      02599099
026000*---------------------------------------------------------------* 02600099
026010*    SEL-VARIABLE-SCREEN CONTAINS THE CURRENT DISPLAYED SCREEN. * 02601099
026020*    IN THE BEGINNING THE FIELD IS SET TO 0 & THEN AS THE USER  * 02602099
026030*    SELECTS F10/F11 THIS FIELD IS DECREMENTED OR INCREMENTED.  * 02603099
026040*---------------------------------------------------------------* 02604099
026050             15  ASC-SEL-VARIABLE-SCREEN             PIC S9.      02605099
026060*---------------------------------------------------------------* 02606099
026070*    ASC-VSCREEN HOLDS THE LAST VIRTUAL SCREEN. CURRENTLY ONLY  * 02607099
026080*    5 SCREENS ARE EVER USED.  IF MORE FIELDS ARE ADDED TO THE  * 02608099
026090*    VARIABLE SCREEN THIS FIELD SHOULD BE ADDED AS A PIC 99.   .* 02609099
026100*---------------------------------------------------------------* 02610099
026110             15  ASC-MAX-VARIABLE-SCREENS            PIC S9.      02611099
026120*---------------------------------------------------------------* 02612099
026130*    ABEND PROCESSING COPYBOOK.                                 * 02613099
026140*---------------------------------------------------------------* 02614099
026150                                                                  02615099
026160     COPY DPWS013.                                                02616099
026170                                                                  02617099
026180 EJECT                                                            02618099
026190*---------------------------------------------------------------* 02619099
026200*    DB2 AREA FOR COMMUNICATIONS                                * 02620099
026210*---------------------------------------------------------------* 02621099
026220     EXEC SQL                                                     02622099
026230          INCLUDE SQLCA                                           02623099
026240     END-EXEC.                                                    02624099
026250*---------------------------------------------------------------* 02625099
026260*  DCLGEN FOR ALL TRECEIV                                         02626099
026270*---------------------------------------------------------------* 02627099
026280     EXEC SQL                                                     02628099
026290          INCLUDE TRECEIV                                         02629099
026300     END-EXEC.                                                    02630099
026310 EJECT                                                            02631099
026320*---------------------------------------------------------------* 02632099
026330*  DCLGEN FOR ALL TSTATCD                                         02633099
026340*---------------------------------------------------------------* 02634099
026350     EXEC SQL                                                     02635099
026360          INCLUDE TSTATCD                                         02636099
026370     END-EXEC.                                                    02637099
026380 EJECT                                                            02638099
026390*---------------------------------------------------------------* 02639099
026400*  DCLGEN FOR ALL TRECDIS                                         02640099
026410*---------------------------------------------------------------* 02641099
026420     EXEC SQL                                                     02642099
026430          INCLUDE TRECDIS                                         02643099
026440     END-EXEC.                                                    02644099
026450 EJECT                                                            02645099
026460*---------------------------------------------------------------* 02646099
026470*  DCLGEN FOR ALL TRECITM                                         02647099
026480*---------------------------------------------------------------* 02648099
026490     EXEC SQL                                                     02649099
026500          INCLUDE TRECITM                                         02650099
026510     END-EXEC.                                                    02651099
026520 EJECT                                                            02652099
026530*---------------------------------------------------------------* 02653099
026540*  DCLGEN FOR ALL TMESTDS                                         02654099
026550*---------------------------------------------------------------* 02655099
026560     EXEC SQL                                                     02656099
026570          INCLUDE TMESTDS                                         02657099
026580     END-EXEC.                                                    02658099
026590 EJECT                                                            02659099
026600*---------------------------------------------------------------* 02660099
026610*  DCLGEN FOR ALL TPOAGMT                                         02661099
026620*---------------------------------------------------------------* 02662099
026630     EXEC SQL                                                     02663099
026640          INCLUDE TPOAGMT                                         02664099
026650     END-EXEC.                                                    02665099
026660 EJECT                                                            02666099
026670*---------------------------------------------------------------* 02667099
026680*  DCLGEN FOR ALL TIMFOB                                          02668099
026690*---------------------------------------------------------------* 02669099
026700     EXEC SQL                                                     02670099
026710          INCLUDE TIMFOB                                          02671099
026720     END-EXEC.                                                    02672099
026730 EJECT                                                            02673099
026740*---------------------------------------------------------------* 02674099
026750*  DCLGEN FOR ALL TIMPOE                                          02675099
026760*---------------------------------------------------------------* 02676099
026770     EXEC SQL                                                     02677099
026780          INCLUDE TIMPOE                                          02678099
026790     END-EXEC.                                                    02679099
026800 EJECT                                                            02680099
026810*---------------------------------------------------------------* 02681099
026820*  DCLGEN FOR ALL TPOTYCD                                         02682099
026830*---------------------------------------------------------------* 02683099
026840     EXEC SQL                                                     02684099
026850          INCLUDE TPOTYCD                                         02685099
026860     END-EXEC.                                                    02686099
026870 EJECT                                                            02687099
026880*---------------------------------------------------------------* 02688099
026890*  DCLGEN FOR ALL TIMCSEN                                         02689099
026900*---------------------------------------------------------------* 02690099
026910     EXEC SQL                                                     02691099
026920          INCLUDE TIMCSEN                                         02692099
026930     END-EXEC.                                                    02693099
026940 EJECT                                                            02694099
026950*---------------------------------------------------------------* 02695099
026960*  DCLGEN FOR ALL TIMCSPO                                         02696099
026970*---------------------------------------------------------------* 02697099
026980     EXEC SQL                                                     02698099
026990          INCLUDE TIMCSPO                                         02699099
027000     END-EXEC.                                                    02700099
027010 EJECT                                                            02701099
027020*---------------------------------------------------------------* 02702099
027030*  DCLGEN FOR ALL TMDSEAR                                         02703099
027040*---------------------------------------------------------------* 02704099
027050     EXEC SQL                                                     02705099
027060          INCLUDE TMDSEAR                                         02706099
027070     END-EXEC.                                                    02707099
027080 EJECT                                                            02708099
027090*---------------------------------------------------------------* 02709099
027100*  DCLGEN FOR ALL TUPC                                            02710099
027110*---------------------------------------------------------------* 02711099
027120     EXEC SQL                                                     02712099
027130          INCLUDE TUPC                                            02713099
027140     END-EXEC.                                                    02714099
027150 EJECT                                                            02715099
027160*---------------------------------------------------------------* 02716099
027170*  DCLGEN FOR ALL TSKXREF                                         02717099
027180*---------------------------------------------------------------* 02718099
027190     EXEC SQL                                                     02719099
027200          INCLUDE TSKXREF                                         02720099
027210     END-EXEC.                                                    02721099
027220 EJECT                                                            02722099
027230*---------------------------------------------------------------* 02723099
027240*  DCLGEN FOR ALL XLT_SKU                                         02724099
027250*---------------------------------------------------------------* 02725099
027260     EXEC SQL                                                     02726099
027270          INCLUDE XLT00003                                        02727099
027280     END-EXEC.                                                    02728099
027290 EJECT                                                            02729099
027300*---------------------------------------------------------------* 02730099
027310*  DCLGEN FOR ALL XLT_VND_STYL                                    02731099
027320*---------------------------------------------------------------* 02732099
027330     EXEC SQL                                                     02733099
027340          INCLUDE XLT00004                                        02734099
027350     END-EXEC.                                                    02735099
027360 EJECT                                                            02736099
027370*---------------------------------------------------------------* 02737099
027380*  DCLGEN FOR ALL TSHPTPO                                         02738099
027390*---------------------------------------------------------------* 02739099
027400     EXEC SQL                                                     02740099
027410          INCLUDE TSHPTPO                                         02741099
027420     END-EXEC.                                                    02742099
027430 EJECT                                                            02743099
027440*---------------------------------------------------------------* 02744099
027450*  DCLGEN FOR ALL TIMRCPO                                         02745099
027460*---------------------------------------------------------------* 02746099
027470     EXEC SQL                                                     02747099
027480          INCLUDE TIMRCPO                                         02748099
027490     END-EXEC.                                                    02749099
027500 EJECT                                                            02750099
027510*---------------------------------------------------------------* 02751099
027520*  DCLGEN FOR ALL TPLNSHP                                         02752099
027530*---------------------------------------------------------------* 02753099
027540     EXEC SQL                                                     02754099
027550          INCLUDE TPLNSHP                                         02755099
027560     END-EXEC.                                                    02756099
027570 EJECT                                                            02757099
027580*---------------------------------------------------------------* 02758099
027590*    DB2 AREA FOR LOGISTICS LOCATION TABLE - XLT_LOC            * 02759099
027600*---------------------------------------------------------------* 02760099
027610     EXEC SQL                                                     02761099
027620          INCLUDE XLT00010                                        02762099
027630     END-EXEC.                                                    02763099
027640/                                                                 02764099
027650*---------------------------------------------------------------* 02765099
027660*    DB2 AREA FOR LOGISTICS LOCATION TABLE - XLT_DC_LOC_ASGMT   * 02766099
027670*---------------------------------------------------------------* 02767099
027680     EXEC SQL                                                     02768099
027690          INCLUDE XLT00014                                        02769099
027700     END-EXEC.                                                    02770099
027710/                                                                 02771099
027720*---------------------------------------------------------------* 02772099
027730*  DCLGEN FOR ALL TPURITM                                         02773099
027740*---------------------------------------------------------------* 02774099
027750     EXEC SQL                                                     02775099
027760          INCLUDE TPURITM                                         02776099
027770     END-EXEC.                                                    02777099
027780 EJECT                                                            02778099
027790*---------------------------------------------------------------* 02779099
027800*  DCLGEN FOR ALL TPURCHS                                         02780099
027810*---------------------------------------------------------------* 02781099
027820     EXEC SQL                                                     02782099
027830          INCLUDE TPURCHS                                         02783099
027840     END-EXEC.                                                    02784099
027850 EJECT                                                            02785099
027860*---------------------------------------------------------------* 02786099
027870*  DCLGEN FOR ALL TALLPLN                                         02787099
027880*---------------------------------------------------------------* 02788099
027890     EXEC SQL                                                     02789099
027900          INCLUDE TALLPLN                                         02790099
027910     END-EXEC.                                                    02791099
027920 EJECT                                                            02792099
027930*---------------------------------------------------------------* 02793099
027940*  DCLGEN FOR ALL TIMBKPO                                         02794099
027950*---------------------------------------------------------------* 02795099
027960     EXEC SQL                                                     02796099
027970          INCLUDE TIMBKPO                                         02797099
027980     END-EXEC.                                                    02798099
027990 EJECT                                                            02799099
028000 EJECT                                                            02800099
028010*---------------------------------------------------------------* 02801099
028020*  DCLGEN FOR ALL TIMCNPO                                         02802099
028030*---------------------------------------------------------------* 02803099
028040     EXEC SQL                                                     02804099
028050          INCLUDE TIMCNPO                                         02805099
028060     END-EXEC.                                                    02806099
028070 EJECT                                                            02807099
028080*---------------------------------------------------------------* 02808099
028090*  DCLGEN FOR ALL TIMCNRL                                         02809099
028100*---------------------------------------------------------------* 02810099
028110     EXEC SQL                                                     02811099
028120          INCLUDE TIMCNRL                                         02812099
028130     END-EXEC.                                                    02813099
028140 EJECT                                                            02814099
028150*---------------------------------------------------------------* 02815099
028160*  DCLGEN FOR ALL TAUCNRL                                         02816099
028170*---------------------------------------------------------------* 02817099
028180     EXEC SQL                                                     02818099
028190          INCLUDE TAUCNRL                                         02819099
028200     END-EXEC.                                                    02820099
028210 EJECT                                                            02821099
028220*---------------------------------------------------------------* 02822099
028230*  DCLGEN FOR ALL TIMCNTK                                         02823099
028240*---------------------------------------------------------------* 02824099
028250     EXEC SQL                                                     02825099
028260          INCLUDE TIMCNTK                                         02826099
028270     END-EXEC.                                                    02827099
028280 EJECT                                                            02828099
028290*---------------------------------------------------------------* 02829099
028300*  DCLGEN FOR ALL TSHIPST                                         02830099
028310*---------------------------------------------------------------* 02831099
028320     EXEC SQL                                                     02832099
028330          INCLUDE TSHIPST                                         02833099
028340     END-EXEC.                                                    02834099
028350 EJECT                                                            02835099
028360*---------------------------------------------------------------* 02836099
028370*  DCLGEN FOR ALL TTRIPST                                         02837099
028380*---------------------------------------------------------------* 02838099
028390     EXEC SQL                                                     02839099
028400          INCLUDE TTRIPST                                         02840099
028410     END-EXEC.                                                    02841099
028420 EJECT                                                            02842099
028430*---------------------------------------------------------------* 02843099
028440*  DCLGEN FOR ALL TSHIPMT                                         02844099
028450*---------------------------------------------------------------* 02845099
028460     EXEC SQL                                                     02846099
028470          INCLUDE TSHIPMT                                         02847099
028480     END-EXEC.                                                    02848099
028490 EJECT                                                            02849099
028500*---------------------------------------------------------------* 02850099
028510*  DCLGEN FOR ALL TVHTRIP                                         02851099
028520*---------------------------------------------------------------* 02852099
028530     EXEC SQL                                                     02853099
028540          INCLUDE TVHTRIP                                         02854099
028550     END-EXEC.                                                    02855099
028560 EJECT                                                            02856099
028570*---------------------------------------------------------------* 02857099
028580*  DCLGEN FOR ALL TENTNME                                         02858099
028590*---------------------------------------------------------------* 02859099
028600     EXEC SQL                                                     02860099
028610          INCLUDE TENTNME                                         02861099
028620     END-EXEC.                                                    02862099
028630 EJECT                                                            02863099
028640*---------------------------------------------------------------* 02864099
028650*  DCLGEN FOR ALL TIMPORL                                         02865099
028660*---------------------------------------------------------------* 02866099
028670     EXEC SQL                                                     02867099
028680          INCLUDE TIMPORL                                         02868099
028690     END-EXEC.                                                    02869099
028700 EJECT                                                            02870099
028710*---------------------------------------------------------------* 02871099
028720*  CURSOR TO PULL SHIPMENT DATA                                   02872099
028730*---------------------------------------------------------------* 02873099
028740     EXEC SQL                                                     02874099
028750       DECLARE SHIP_DATA_CSR CURSOR FOR                           02875099
028760           SELECT MIN(COALESCE(DATE(U.EST_AR_TMST),               02876099
028770                                    DATE('9999-09-09')))          02877099
028780                 ,MIN(COALESCE(V.STATUS_DTE,DATE('9999-09-09')))  02878099
028790                 ,MIN(COALESCE(W.STATUS_DTE,DATE('9999-09-09')))  02879099
028800                 ,U.OPER_UNT_ID                                   02880099
028810           FROM (((SELECT C.EST_AR_TMST                           02881099
028820                         ,D.OPER_UNT_ID                           02882099
028830                         ,A.SHIPT_ID                              02883099
028840                    FROM  TSHPTPO A                               02884099
028850                         ,TSHIPMT B                               02885099
028860                         ,TVHTRIP C                               02886099
028870                         ,TTRIPST D                               02887099
028880                    WHERE A.PO_NBR          = :DK-PO-NBR          02888099
028890                      AND A.SHIPT_ID        = B.SHIPT_ID          02889099
028900                      AND B.TRIP_ID         = C.TRIP_ID           02890099
028910                      AND B.TRIP_ID         = D.TRIP_ID           02891099
028920                      AND C.VEH_NBR         IS NOT NULL           02892099
028930                      AND D.TRIP_STATUS_CDE = 'EN') AS U          02893099
028940                      LEFT OUTER JOIN                             02894099
028950                      (SELECT B.SHIPT_ID                          02895099
028960                             ,A.STATUS_DTE                        02896099
028970                         FROM  TSHIPST A                          02897099
028980                              ,TSHPTPO B                          02898099
028990                         WHERE B.PO_NBR         = :DK-PO-NBR      02899099
029000                         AND A.SHIPT_ID         = B.SHIPT_ID      02900099
029010                         AND A.SHIPT_STATUS_CDE = 'AR') AS V      02901099
029020                         ON U.SHIPT_ID = V.SHIPT_ID)              02902099
029030                      LEFT OUTER JOIN                             02903099
029040                      (SELECT B.SHIPT_ID                          02904099
029050                             ,A.STATUS_DTE                        02905099
029060                         FROM  TSHIPST A                          02906099
029070                              ,TSHPTPO B                          02907099
029080                         WHERE B.PO_NBR         = :DK-PO-NBR      02908099
029090                         AND A.SHIPT_ID         = B.SHIPT_ID      02909099
029100                         AND A.SHIPT_STATUS_CDE = 'AG') AS W      02910099
029110                         ON U.SHIPT_ID = W.SHIPT_ID)              02911099
029120               GROUP BY                                           02912099
029130                  U.OPER_UNT_ID                                   02913099
029140*              OPTIMIZE FOR 9 ROWS                                02914099
029150     END-EXEC.                                                    02915099
029160 EJECT                                                            02916099
029170*---------------------------------------------------------------* 02917099
029180*  CURSOR TO PULL BACK DC STORE NUMBER                            02918099
029190*---------------------------------------------------------------* 02919099
029200                                                                  02920099
029210     EXEC SQL                                                     02921099
029220       DECLARE STORE_CSR CURSOR FOR                               02922099
029230        SELECT A.LOC_NBR                                          02923099
029240              ,A.LOC_5_ABBR_NM                                    02924099
029250        FROM XLT_LOC  A                                           02925099
029260           , XLT_DC_LOC_ASGMT  B                                  02926099
029270        WHERE A.LOC_TYP_CDE = 'DC'                                02927099
029280          AND A.LOC_NBR = B.LOC_NBR                               02928099
029290          AND (CURRENT DATE <  (A.CLO_DTE + 30 DAYS)              02929099
029300           OR  '9999-09-09'  =  A.CLO_DTE)                        02930099
029310          AND (A.ZIP_10_CDE <> '0'                                02931099
029320           OR  A.ZIP_10_CDE <> ' ')                               02932099
029330          AND B.EFF_BEG_DTE =                                     02933099
029340              (SELECT MAX(C.EFF_BEG_DTE)                          02934099
029350                 FROM XLT_DC_LOC_ASGMT  C                         02935099
029360                WHERE C.LOC_NBR = A.LOC_NBR)                      02936099
029370          AND (CURRENT DATE) > (B.EFF_BEG_DTE - 50 DAYS)          02937099
029380     END-EXEC.                                                    02938099
029390 EJECT                                                            02939099
029400*---------------------------------------------------------------* 02940099
029410*    CURSOR DECLARATION FOR SELECTING POE CODE CITY AND STATE   * 02941099
029420*---------------------------------------------------------------* 02942099
029430                                                                  02943099
029440     EXEC SQL                                                     02944099
029450          DECLARE  POE-CSR CURSOR                                 02945099
029460              FOR  SELECT DISTINCT                                02946099
029470                   A.POE_CDE                                      02947099
029480             FROM  TIMPOE  A                                      02948099
029490            WHERE  A.POE_CDE        = :TR195-POE-CDE              02949099
029500     END-EXEC.                                                    02950099
029510                                                                  02951099
029520 EJECT                                                            02952099
029530*---------------------------------------------------------------* 02953099
029540*    CURSOR DECLARATION TO OBTAIN ALL LINES FOR PURCHASE ORDERS * 02954099
029550*---------------------------------------------------------------* 02955099
029560                                                                  02956099
029570     EXEC SQL                                                     02957099
029580          DECLARE DC-SPLITS-CSR CURSOR FOR                        02958099
029590           SELECT                                                 02959099
029600                  A.PO_LNE_NBR                                    02960099
029610             FROM                                                 02961099
029620                  TPURITM   A                                     02962099
029630                , TPURCHS   B                                     02963099
029640             WHERE A.PO_NBR         =  :DK-PO-NBR                 02964099
029650               AND A.PO_NBR         =  B.PO_NBR                   02965099
029660               AND A.VER_STATUS_CDE = 'A'                         02966099
029670               AND B.VER_STATUS_CDE = 'A'                         02967099
029680               AND A.STATUS_CDE     IN ('AC','AP','CM','CB','RV') 02968099
029690               AND B.STATUS_CDE     IN ('AC','AP','CM','CA')      02969099
029700             ORDER BY A.PO_LNE_NBR                                02970099
029710     END-EXEC.                                                    02971099
029720*----------------------------------------------------------------*02972099
029730 LINKAGE SECTION.                                                 02973099
029740                                                                  02974099
029750 01  DFHCOMMAREA.                                                 02975099
029760     05  FILLER                         OCCURS  1 TO 4072 TIMES   02976099
029770                                        DEPENDING ON EIBCALEN.    02977099
029780         10  FILLER                     PIC X.                    02978099
029790 EJECT                                                            02979099
029800*----------------------------------------------------------------*02980099
029810 PROCEDURE DIVISION.                                              02981099
029820*----------------------------------------------------------------*02982099
029830*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM.  *02983099
029840*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM   *02984099
029850*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT.  *02985099
029860*----------------------------------------------------------------*02986099
029870 0000-MAIN-MODULE.                                                02987099
029880                                                                  02988099
029890     INITIALIZE DP030-CICS-API-FIELDS.                            02989099
029900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02990099
029910     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02991099
029920     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02992099
029930     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02993099
029940     MOVE LENGTH OF TR196AI        TO DP030-MAP-LENGTH (1).       02994099
029950     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02995099
029960     PERFORM 0001-CALL-CICS-ARCH-API.                             02996099
029970*                                                                 02997099
029980     PERFORM 1000-CONTROL-PROCESSING.                             02998099
029990*                                                                 02999099
030000     IF ASC-WRITE-TO-CSSL                                         03000099
030010*----------------------------------------------------------------*03001099
030020* SELF DOCUMENT TASK#6                                           *03002099
030030*----------------------------------------------------------------*03003099
030040        PERFORM 10001-ASK-CICS-FOR-TIME                           03004099
030050        PERFORM 10005-FORMAT-CICS-TIME                            03005099
030060        PERFORM 10007-STRING-TIME-MESSAGE                         03006099
030070        PERFORM 10002-WRITE-SQL-TO-CICS                           03007099
030080        PERFORM 10003-WRITE-CICS-LOG                              03008099
030090        SET ASC-DONT-WRITE-TO-CSSL TO TRUE                        03009099
030100     END-IF.                                                      03010099
030110*                                                                 03011099
030120     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03012099
030130     PERFORM 0001-CALL-CICS-ARCH-API.                             03013099
030140                                                                  03014099
030150*----------------------------------------------------------------*03015099
030160*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *03016099
030170*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *03017099
030180*----------------------------------------------------------------*03018099
030190 0001-CALL-CICS-ARCH-API.                                         03019099
030200                                                                  03020099
030210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03021099
030220                                    DFHCOMMAREA                   03022099
030230                                    DP030-CICS-API-FIELDS         03023099
030240                                    DP020-STANDARD-COMMAREA       03024099
030250                                    TR196AI.                      03025099
030260*                                                                 03026099
030270     IF  DP030-RC-CALL-SUCCESSFUL                                 03027099
030280         CONTINUE                                                 03028099
030290     ELSE                                                         03029099
030300         SET DP013-NO-ROLLBACK                                    03030099
030310             DP013-XCTL-DISPLAY-RESTART                           03031099
030320             DP013-CICS-ABEND      TO TRUE                        03032099
030330         MOVE '0001-CALL-CICS-ARCH-API'                           03033099
030340                                   TO DP013-PARAGRAPH             03034099
030350         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03035099
030360-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03036099
030370         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03037099
030380         PERFORM DP013-0000-PROCESS-ABEND                         03038099
030390     END-IF.                                                      03039099
030400                                                                  03040099
030410 EJECT                                                            03041099
030420*----------------------------------------------------------------*03042099
030430* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *03043099
030440* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *03044099
030450*                                                                *03045099
030460* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *03046099
030470*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *03047099
030480*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *03048099
030490*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *03049099
030500*----------------------------------------------------------------*03050099
030510 1000-CONTROL-PROCESSING.                                         03051099
030520                                                                  03052099
030530     EVALUATE TRUE                                                03053099
030540         WHEN DP020-NEXT-ACT-INITIAL                              03054099
030550             INITIALIZE ASC-SPECIFIC-COMMAREA                     03055099
030560             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            03056099
030570                                      ASC-SEL-TERM-ID             03057099
030580                                      ASC-PO-TERM-ID              03058099
030590                                      ASC-EXTENDED-TERM-ID        03059099
030600                                      ASC-JCL-TERM-ID             03060099
030610             MOVE DP020-SRC-TASK-NUMBER                           03061099
030620                                   TO ASC-LIST-TASK-NUMBER        03062099
030630                                      ASC-SEL-TASK-NUMBER         03063099
030640                                      ASC-PO-TASK-NUMBER          03064099
030650                                      ASC-EXTENDED-TASK-NUMBER    03065099
030660                                      ASC-JCL-TASK-NUMBER         03066099
030670             MOVE PC-LIST-QUEUE-SEQ                               03067099
030680                                   TO ASC-LIST-SEQ                03068099
030690             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 03069099
030700             MOVE PC-PO-QUEUE-SEQ TO ASC-PO-SEQ                   03070099
030710             MOVE PC-EXTENDED-QUEUE-SEQ TO ASC-EXTENDED-SEQ       03071099
030720             MOVE PC-JCL-QUEUE-SEQ TO ASC-JCL-SEQ                 03072099
030730             PERFORM 1100-PROCESS-INTER-APPL-COMM                 03073099
030740*-------$TEMPLATE NOTE$------------------------------------------*03074099
030750* IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION, *03075099
030760* SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO   *03076099
030770* TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED. *03077099
030780*----------------------------------------------------------------*03078099
030790             IF  PS-COMMAREA-NOT-VALID                            03079099
030800                 SET DP020-NEXT-ACT-APPL-ERROR                    03080099
030810                                   TO TRUE                        03081099
030820             ELSE                                                 03082099
030830                 PERFORM 4000-BUILD-INITIAL-PANEL                 03083099
030840             END-IF                                               03084099
030850                                                                  03085099
030860         WHEN DP020-NEXT-ACT-READ-MAP                             03086099
030870             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        03087099
030880                                   TO PV-TOP-ITEM                 03088099
030890             PERFORM 2000-PROCESS-PANEL                           03089099
030900                                                                  03090099
030910         WHEN DP020-NEXT-ACT-RETURN                               03091099
030920             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        03092099
030930                                   TO PV-TOP-ITEM                 03093099
030940             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    03094099
030950             MOVE ASC-VCTL-SORTED-TABLE TO                        03095099
030960                             PV-VCTL-SORTED-TABLE                 03096099
030970             MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN                03097099
030980             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 03098099
030990             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03099099
031000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03100099
031010                                                                  03101099
031020         WHEN OTHER                                               03102099
031030             SET DP013-LOGIC-ABEND TO TRUE                        03103099
031040             SET DP013-NO-ROLLBACK TO TRUE                        03104099
031050             MOVE '1000-CONTROL-PROCESSING'                       03105099
031060                                   TO DP013-PARAGRAPH             03106099
031070             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    03107099
031080                                   TO DP013-MESSAGE-TEXT(1)       03108099
031090             PERFORM DP013-0000-PROCESS-ABEND                     03109099
031100     END-EVALUATE.                                                03110099
031110                                                                  03111099
031120 EJECT                                                            03112099
031130*----------------------------------------------------------------*03113099
031140* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *03114099
031150* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *03115099
031160*----------------------------------------------------------------*03116099
031170                                                                  03117099
031180 1100-PROCESS-INTER-APPL-COMM.                                    03118099
031190*                                                                 03119099
031200**   MOVE 'Y' TO ASC-DOC-SW. --  THIS WILL TURN ON CICS LOGGING.  03120099
031210     MOVE 'N' TO ASC-DOC-SW.                                      03121099
031220     MOVE 1 TO ASC-TASK-ID.                                       03122099
031230     MOVE +1 TO ASC-TASK-POINTER.                                 03123099
031240                                                                  03124099
031250     IF ASC-WRITE-TO-CSSL                                         03125099
031260        PERFORM 10001-ASK-CICS-FOR-TIME                           03126099
031270        PERFORM 10006-SAVE-LAST-TASK-TIME.                        03127099
031280*                                                                 03128099
031290                                                                  03129099
031300     SET PS-COMMAREA-VALID         TO TRUE.                       03130099
031310     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     03131099
031320                                                                  03132099
031330     IF TR195-PO-NBR = ZEROES                                     03133099
031340       AND TR195-DEPT-NBR = ZEROES                                03134099
031350         AND TR195-XFACT-BEF-DTE = SPACES                         03135099
031360           AND TR195-XFACT-END-DTE = SPACES                       03136099
031370             AND TR195-SHPDT-BEF-DTE  = SPACES                    03137099
031380               AND TR195-SHPDT-END-DTE  = SPACES                  03138099
031390            MOVE PC-TSYMSG-02016                                  03139099
031400                                  TO DP020-MSG-NUMBER             03140099
031410            SET PS-ERROR                                          03141099
031420                 PS-COMMAREA-NOT-VALID                            03142099
031430                 DP020-MSG-FATAL                                  03143099
031440                                 TO TRUE                          03144099
031450     ELSE                                                         03145099
031460                                                                  03146099
031470         IF  TR195-DEPT-NBR > ZEROES                              03147099
031480             INITIALIZE PV-DB2-COUNT                              03148099
031490             MOVE TR195-DEPT-NBR TO PV-DEPT-COMPARE               03149099
031500             PERFORM 9700-VALIDATE-DEPT                           03150099
031510             IF  PV-DB2-COUNT = +0                                03151099
031520                 MOVE PC-TSYMSG-00588                             03152099
031530                                 TO DP020-MSG-NUMBER              03153099
031540                  SET PS-ERROR                                    03154099
031550                      PS-COMMAREA-NOT-VALID                       03155099
031560                      DP020-MSG-FATAL                             03156099
031570                                 TO TRUE                          03157099
031580             END-IF                                               03158099
031590         END-IF                                                   03159099
031600                                                                  03160099
031610                                                                  03161099
031620         IF  PS-NO-ERROR                                          03162099
031630          AND TR195-PO-NBR > ZERO                                 03163099
031640             INITIALIZE PV-DB2-COUNT                              03164099
031650             PERFORM 9730-VALIDATE-PO                             03165099
031660             IF  PV-DB2-COUNT = +0                                03166099
031670                 MOVE PC-TSYMSG-00083                             03167099
031680                                 TO DP020-MSG-NUMBER              03168099
031690                  SET PS-ERROR                                    03169099
031700                      PS-COMMAREA-NOT-VALID                       03170099
031710                      DP020-MSG-FATAL                             03171099
031720                                 TO TRUE                          03172099
031730             END-IF                                               03173099
031740         END-IF                                                   03174099
031750                                                                  03175099
031760         MOVE TR195-STR-NBR TO PV-TR195-STR-NBR                   03176099
031770         IF  PS-NO-ERROR                                          03177099
031780          AND  PV-TR195-STR-NBR > SPACES                          03178099
031790             INITIALIZE PV-DB2-COUNT                              03179099
031800             PERFORM 9760-VALIDATE-STORE                          03180099
031810             IF  PV-DB2-COUNT = +0                                03181099
031820                 MOVE PC-TSYMSG-00017                             03182099
031830                                 TO DP020-MSG-NUMBER              03183099
031840                  SET PS-ERROR                                    03184099
031850                      PS-COMMAREA-NOT-VALID                       03185099
031860                      DP020-MSG-FATAL                             03186099
031870                                 TO TRUE                          03187099
031880             END-IF                                               03188099
031890         END-IF                                                   03189099
031900                                                                  03190099
031910         IF  PS-NO-ERROR                                          03191099
031920          AND TR195-FOB-CDE > SPACES                              03192099
031930             INITIALIZE PV-DB2-COUNT                              03193099
031940             PERFORM 9740-VALIDATE-FOB-CODE                       03194099
031950             IF  PV-DB2-COUNT = +0                                03195099
031960                 MOVE PC-TSYMSG-01451                             03196099
031970                                 TO DP020-MSG-NUMBER              03197099
031980                  SET PS-ERROR                                    03198099
031990                      PS-COMMAREA-NOT-VALID                       03199099
032000                      DP020-MSG-FATAL                             03200099
032010                                 TO TRUE                          03201099
032020             END-IF                                               03202099
032030         END-IF                                                   03203099
032040                                                                  03204099
032050         IF  PS-NO-ERROR                                          03205099
032060          AND TR195-POE-CDE > SPACES                              03206099
032070             PERFORM 9750-OPEN-POE-CURSOR                         03207099
032080             PERFORM 9754-FETCH-POE-CURSOR                        03208099
032090             PERFORM 9752-CLOSE-POE-CURSOR                        03209099
032100         END-IF                                                   03210099
032110                                                                  03211099
032120         IF  PS-NO-ERROR                                          03212099
032130         IF  TR195-SKU > ZEROES                                   03213099
032140             IF  TR195-DEPT-NBR = ZEROES                          03214099
032150                 MOVE PC-TSYMSG-00486                             03215099
032160                                 TO DP020-MSG-NUMBER              03216099
032170                 SET PS-ERROR                                     03217099
032180                     PS-COMMAREA-NOT-VALID                        03218099
032190                     DP020-MSG-FATAL                              03219099
032200                                 TO TRUE                          03220099
032210             ELSE                                                 03221099
032220                 IF TR195-SUBCLASS = ZEROES                       03222099
032230                     MOVE PC-TSYMSG-02982                         03223099
032240                                 TO DP020-MSG-NUMBER              03224099
032250                     SET PS-ERROR                                 03225099
032260                         PS-COMMAREA-NOT-VALID                    03226099
032270                         DP020-MSG-FATAL                          03227099
032280                                 TO TRUE                          03228099
032290                 ELSE                                             03229099
032300                     IF TR195-CLASS = ZEROES                      03230099
032310                         MOVE PC-TSYMSG-00694                     03231099
032320                                 TO DP020-MSG-NUMBER              03232099
032330                         SET PS-ERROR                             03233099
032340                             PS-COMMAREA-NOT-VALID                03234099
032350                             DP020-MSG-FATAL                      03235099
032360                                     TO TRUE                      03236099
032370                     END-IF                                       03237099
032380                 END-IF                                           03238099
032390             END-IF                                               03239099
032400         END-IF                                                   03240099
032410         END-IF                                                   03241099
032420                                                                  03242099
032430         IF  PS-NO-ERROR                                          03243099
032440         AND TR195-SUBCLASS > ZEROES                              03244099
032450             IF TR195-DEPT-NBR = ZEROES                           03245099
032460                 MOVE PC-TSYMSG-01409                             03246099
032470                                 TO DP020-MSG-NUMBER              03247099
032480                 SET PS-ERROR                                     03248099
032490                 PS-COMMAREA-NOT-VALID                            03249099
032500                 DP020-MSG-FATAL TO TRUE                          03250099
032510             ELSE                                                 03251099
032520                 IF TR195-CLASS = ZEROES                          03252099
032530                     MOVE PC-TSYMSG-00694                         03253099
032540                             TO DP020-MSG-NUMBER                  03254099
032550                     SET PS-ERROR                                 03255099
032560                         PS-COMMAREA-NOT-VALID                    03256099
032570                         DP020-MSG-FATAL                          03257099
032580                                 TO TRUE                          03258099
032590                 END-IF                                           03259099
032600             END-IF                                               03260099
032610         END-IF                                                   03261099
032620                                                                  03262099
032630         IF  PS-NO-ERROR                                          03263099
032640         AND TR195-CLASS > ZEROES                                 03264099
032650             IF TR195-DEPT-NBR = ZEROES                           03265099
032660                 MOVE PC-TSYMSG-01409                             03266099
032670                                 TO DP020-MSG-NUMBER              03267099
032680                 SET PS-ERROR                                     03268099
032690                     PS-COMMAREA-NOT-VALID                        03269099
032700                     DP020-MSG-FATAL TO TRUE                      03270099
032710             ELSE                                                 03271099
032720                 MOVE SPACES TO TR195-CLASS-RANGE-SW              03272099
032730                 EVALUATE TR195-CLASS                             03273099
032740                     WHEN 10                                      03274099
032750                         MOVE '10'           TO DK-CL-NBR-BEG     03275099
032760                         MOVE '19'           TO DK-CL-NBR-END     03276099
032770                         SET TR195-CLASS-RANGE TO TRUE            03277099
032780                     WHEN 20                                      03278099
032790                         MOVE '20'           TO DK-CL-NBR-BEG     03279099
032800                         MOVE '29'           TO DK-CL-NBR-END     03280099
032810                         SET TR195-CLASS-RANGE TO TRUE            03281099
032820                     WHEN 30                                      03282099
032830                         MOVE '30'           TO DK-CL-NBR-BEG     03283099
032840                         MOVE '39'           TO DK-CL-NBR-END     03284099
032850                         SET TR195-CLASS-RANGE TO TRUE            03285099
032860                     WHEN 40                                      03286099
032870                         MOVE '40'           TO DK-CL-NBR-BEG     03287099
032880                         MOVE '49'           TO DK-CL-NBR-END     03288099
032890                         SET TR195-CLASS-RANGE TO TRUE            03289099
032900                     WHEN 50                                      03290099
032910                         MOVE '50'           TO DK-CL-NBR-BEG     03291099
032920                         MOVE '59'           TO DK-CL-NBR-END     03292099
032930                         SET TR195-CLASS-RANGE TO TRUE            03293099
032940                     WHEN 60                                      03294099
032950                         MOVE '60'           TO DK-CL-NBR-BEG     03295099
032960                         MOVE '69'           TO DK-CL-NBR-END     03296099
032970                         SET TR195-CLASS-RANGE TO TRUE            03297099
032980                     WHEN 70                                      03298099
032990                         MOVE '70'           TO DK-CL-NBR-BEG     03299099
033000                         MOVE '79'           TO DK-CL-NBR-END     03300099
033010                         SET TR195-CLASS-RANGE TO TRUE            03301099
033020                     WHEN 80                                      03302099
033030                         MOVE '80'           TO DK-CL-NBR-BEG     03303099
033040                         MOVE '89'           TO DK-CL-NBR-END     03304099
033050                         SET TR195-CLASS-RANGE TO TRUE            03305099
033060                     WHEN 90                                      03306099
033070                         MOVE '90'           TO DK-CL-NBR-BEG     03307099
033080                         MOVE '99'           TO DK-CL-NBR-END     03308099
033090                         SET TR195-CLASS-RANGE TO TRUE            03309099
033100                 END-EVALUATE                                     03310099
033110             END-IF                                               03311099
033120         END-IF                                                   03312099
033130                                                                  03313099
033140         IF  PS-NO-ERROR                                          03314099
033150         AND NOT TR195-CLASS-RANGE                                03315099
033160         AND TR195-CLASS > ZEROS                                  03316099
033170             MOVE PC-TSYMSG-00693                                 03317099
033180                 TO DP020-MSG-NUMBER                              03318099
033190             SET PS-ERROR                                         03319099
033200                 PS-COMMAREA-NOT-VALID                            03320099
033210                 DP020-MSG-FATAL                                  03321099
033220                     TO TRUE                                      03322099
033230         END-IF                                                   03323099
033240                                                                  03324099
033250                                                                  03325099
033260         IF  PS-NO-ERROR                                          03326099
033270         AND TR195-STATUS-CDE   > SPACES                          03327099
033280             INITIALIZE PV-DB2-COUNT                              03328099
033290             MOVE TR195-STATUS-CDE                                03329099
033300                                 TO STATCD-STATUS-CDE             03330099
033310             PERFORM 9710-VALIDATE-STATUS-CODE                    03331099
033320             IF  PV-DB2-COUNT = +0                                03332099
033330                 MOVE PC-TSYMSG-00168                             03333099
033340                                 TO DP020-MSG-NUMBER              03334099
033350                  SET PS-ERROR                                    03335099
033360                      PS-COMMAREA-NOT-VALID                       03336099
033370                      DP020-MSG-FATAL                             03337099
033380                                 TO TRUE                          03338099
033390             END-IF                                               03339099
033400         END-IF                                                   03340099
033410                                                                  03341099
033420         IF  PS-NO-ERROR                                          03342099
033430         AND TR195-PO-TYP-CDE > SPACES                            03343099
033440             MOVE ZERO TO PV-TALLY-1                              03344099
033450                          PV-TALLY-2                              03345099
033460             MOVE TR195-PO-TYP-CDE TO PV-PO-TYP-CDE               03346099
033470             INSPECT PV-PO-TYP-CDE                                03347099
033480             TALLYING PV-TALLY-1 FOR ALL '*'                      03348099
033490                      PV-TALLY-2 FOR ALL '?'                      03349099
033500             IF PV-TALLY-1 + PV-TALLY-2 = ZERO                    03350099
033510               AND TR195-PO-TYP-CDE      NOT = 'II'               03351099
033520                 INITIALIZE PV-DB2-COUNT                          03352099
033530                 PERFORM 9720-VALIDATE-PO-TYPE-CODE               03353099
033540                 IF PV-DB2-COUNT = +0                             03354099
033550                     MOVE PC-TSYMSG-00587                         03355099
033560                                 TO DP020-MSG-NUMBER              03356099
033570                     SET PS-ERROR                                 03357099
033580                         PS-COMMAREA-NOT-VALID                    03358099
033590                         DP020-MSG-FATAL                          03359099
033600                                    TO TRUE                       03360099
033610                 END-IF                                           03361099
033620             END-IF                                               03362099
033630         END-IF                                                   03363099
033640                                                                  03364099
033650         IF  PS-NO-ERROR                                          03365099
033660            MOVE +0  TO ASC-MAX-VARIABLE-SCREENS                  03366099
033670            MOVE +1  TO ASC-MAX-GROUPS                            03367099
033680            PERFORM 9400-SETUP-VARIABLE-PARAMETERS                03368099
033690            MOVE +0 TO ASC-SEL-VARIABLE-SCREEN                    03369099
033700            MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN                 03370099
033710         END-IF                                                   03371099
033720                                                                  03372099
033730     END-IF.                                                      03373099
033740                                                                  03374099
033750     IF  PS-NO-ERROR                                              03375099
033760         MOVE TR195-PO-NBR            TO ASC-KEY-PO-NBR           03376099
033770         MOVE TR195-CNTRY-ORG         TO ASC-KEY-CNTRY-ORG        03377099
033780         MOVE TR195-CNTRY-PLC         TO ASC-KEY-CNTRY-PLC        03378099
033790         MOVE TR195-DEPT-NBR          TO ASC-DEPT-NBR             03379099
033800         MOVE TR195-STATUS-GRP        TO ASC-STATUS-CLS           03380099
033810         MOVE TR195-STATUS-CDE        TO ASC-STATUS-CDE           03381099
033820         MOVE TR195-CLASS             TO ASC-CLASS                03382099
033830         MOVE TR195-SUBCLASS          TO ASC-SUBCLASS             03383099
033840         MOVE TR195-PO-TYP-CDE        TO ASC-PO-TYP-CDE           03384099
033850         MOVE TR195-SKU               TO ASC-SKU                  03385099
033860         MOVE TR195-ENT-NAME-DESC     TO ASC-ENT-NAME-DESC        03386099
033870         MOVE TR195-VEND-STYL-NME     TO ASC-VEND-STYL-NME        03387099
033880         MOVE TR195-SEASONAL-SET      TO ASC-SEASONAL-SET         03388099
033890         MOVE TR195-DMM               TO ASC-DMM                  03389099
033900         MOVE TR195-GROUP-CDE         TO ASC-GROUP-CDE            03390099
033910                                                                  03391099
033920         IF TR195-AD-EVNT-DTE > SPACES                            03392099
033930           MOVE TR195-AD-EVNT-DTE       TO PV-DATE-FIELD          03393099
033940           MOVE PV-DT-DD                TO PV-DB2-DD              03394099
033950           MOVE PV-DT-MM                TO PV-DB2-MM              03395099
033960           MOVE PV-DT-CC                TO PV-DB2-CC              03396099
033970           MOVE PV-DT-YY                TO PV-DB2-YY              03397099
033980           MOVE PV-DATE-DB2-FIELD       TO ASC-AD-EVNT-DTE        03398099
033990         END-IF                                                   03399099
034000                                                                  03400099
034010         MOVE TR195-PRE-PACK-IND      TO ASC-PRE-PACK-IND         03401099
034020         MOVE TR195-PIC-AD-IND        TO ASC-PIC-AD-IND           03402099
034030         MOVE TR195-FOB-CDE           TO ASC-FOB-CDE              03403099
034040         MOVE TR195-POE-CDE           TO ASC-POE-CDE              03404099
034050         MOVE TR195-MAKER-NME         TO ASC-MAKER-NME            03405099
034060         MOVE TR195-STR-NBR           TO ASC-STR-NBR              03406099
034070         MOVE TR195-NEW-STR-IND       TO ASC-NEW-STR-IND          03407099
034080                                                                  03408099
034090         IF TR195-XFACT-BEF-DTE > SPACES                          03409099
034100           MOVE TR195-XFACT-BEF-DTE     TO PV-DATE-FIELD          03410099
034110           MOVE PV-DT-DD                TO PV-DB2-DD              03411099
034120           MOVE PV-DT-MM                TO PV-DB2-MM              03412099
034130           MOVE PV-DT-CC                TO PV-DB2-CC              03413099
034140           MOVE PV-DT-YY                TO PV-DB2-YY              03414099
034150           MOVE PV-DATE-DB2-FIELD       TO ASC-XFACT-BEF-DTE      03415099
034160         END-IF                                                   03416099
034170                                                                  03417099
034180         IF TR195-XFACT-END-DTE > SPACES                          03418099
034190           MOVE TR195-XFACT-END-DTE     TO PV-DATE-FIELD          03419099
034200           MOVE PV-DT-DD                TO PV-DB2-DD              03420099
034210           MOVE PV-DT-MM                TO PV-DB2-MM              03421099
034220           MOVE PV-DT-CC                TO PV-DB2-CC              03422099
034230           MOVE PV-DT-YY                TO PV-DB2-YY              03423099
034240           MOVE PV-DATE-DB2-FIELD       TO ASC-XFACT-END-DTE      03424099
034250         END-IF                                                   03425099
034260                                                                  03426099
034270         IF TR195-SHPDT-BEF-DTE > SPACES                          03427099
034280           MOVE TR195-SHPDT-BEF-DTE     TO PV-DATE-FIELD          03428099
034290           MOVE PV-DT-DD                TO PV-DB2-DD              03429099
034300           MOVE PV-DT-MM                TO PV-DB2-MM              03430099
034310           MOVE PV-DT-CC                TO PV-DB2-CC              03431099
034320           MOVE PV-DT-YY                TO PV-DB2-YY              03432099
034330           MOVE PV-DATE-DB2-FIELD       TO ASC-SHPDT-BEF-DTE      03433099
034340         END-IF                                                   03434099
034350                                                                  03435099
034360         IF TR195-SHPDT-END-DTE > SPACES                          03436099
034370           MOVE TR195-SHPDT-END-DTE     TO PV-DATE-FIELD          03437099
034380           MOVE PV-DT-DD                TO PV-DB2-DD              03438099
034390           MOVE PV-DT-MM                TO PV-DB2-MM              03439099
034400           MOVE PV-DT-CC                TO PV-DB2-CC              03440099
034410           MOVE PV-DT-YY                TO PV-DB2-YY              03441099
034420           MOVE PV-DATE-DB2-FIELD       TO ASC-SHPDT-END-DTE      03442099
034430         END-IF                                                   03443099
034440                                                                  03444099
034450         MOVE TR195-OTB-PER-NBR-BEG   TO ASC-OTB-PER-NBR-BEG      03445099
034460         MOVE TR195-OTB-PER-NBR-END   TO ASC-OTB-PER-NBR-END      03446099
034470         MOVE TR195-SORT1-BY-IND      TO ASC-SORT1-BY-IND         03447099
034480         MOVE TR195-SORT2-BY-IND      TO ASC-SORT2-BY-IND         03448099
034490         MOVE TR195-EDI-IND           TO ASC-EDI-IND              03449099
034500         MOVE TR195-PRE-TICKET-IND    TO ASC-PRE-TICKET-IND       03450099
034510         MOVE TR195-DIRECT-STORE-IND  TO ASC-DIRECT-STORE-IND     03451099
034520         MOVE TR195-PACK-BY-STORE-IND TO ASC-PACK-BY-STORE-IND    03452099
034530         MOVE TR195-QUOTA-CATEGORY    TO ASC-QUOTA-CATEGORY       03453099
034540     END-IF.                                                      03454099
034550                                                                  03455099
034560                                                                  03456099
034570 EJECT                                                            03457099
034580*----------------------------------------------------------------*03458099
034590* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *03459099
034600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *03460099
034610* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *03461099
034620* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *03462099
034630* FUNCTION KEYS CAN GET THIS FAR.                                *03463099
034640*----------------------------------------------------------------*03464099
034650                                                                  03465099
034660 2000-PROCESS-PANEL.                                              03466099
034670                                                                  03467099
034680     EVALUATE TRUE                                                03468099
034690         WHEN DP020-SRC-AID = DP016-CLEAR                         03469099
034700             MOVE ASC-VCTL-SORTED-TABLE TO                        03470099
034710                             PV-VCTL-SORTED-TABLE                 03471099
034720             MOVE -1  TO ASC-REDRAW-VARIABLE-SCREEN               03472099
034730             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                03473099
034740             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03474099
034750             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03475099
034760                                                                  03476099
034770         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    03477099
034780             MOVE ASC-VCTL-SORTED-TABLE TO                        03478099
034790                             PV-VCTL-SORTED-TABLE                 03479099
034800             MOVE +0  TO ASC-SEL-VARIABLE-SCREEN                  03480099
034810             MOVE -1  TO ASC-REDRAW-VARIABLE-SCREEN               03481099
034820             PERFORM 2050-DELETE-LIST-QUEUE                       03482099
034830             PERFORM 2051-DELETE-PO-QUEUE                         03483099
034840             PERFORM 2052-DELETE-VARIABLE-QUEUE                   03484099
034850             PERFORM 4000-BUILD-INITIAL-PANEL                     03485099
034860                                                                  03486099
034870         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    03487099
034880             PERFORM 3200-RESET-ATTRIBUTES                        03488099
034890             PERFORM 2140-DESELECT-ALL-ITEMS                      03489099
034900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03490099
034910                                                                  03491099
034920         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  03492099
034930             PERFORM 3200-RESET-ATTRIBUTES                        03493099
034940             PERFORM 2150-SELECT-ALL-ITEMS                        03494099
034950             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03495099
034960                                                                  03496099
034970         WHEN OTHER                                               03497099
034980             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03498099
034990             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03499099
035000             IF  PS-NO-ERROR                                      03500099
035010                 SET DP030-CONTINUE-GO                            03501099
035020                                 TO TRUE                          03502099
035030                 PERFORM 2100-CHECK-FUNCTION-KEY                  03503099
035040             ELSE                                                 03504099
035050                 SET DP030-OVERRIDE-GO                            03505099
035060                                 TO TRUE                          03506099
035070             END-IF                                               03507099
035080     END-EVALUATE.                                                03508099
035090                                                                  03509099
035100 EJECT                                                            03510099
035110*----------------------------------------------------------------*03511099
035120*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *03512099
035130*----------------------------------------------------------------*03513099
035140                                                                  03514099
035150 2050-DELETE-LIST-QUEUE.                                          03515099
035160                                                                  03516099
035170     EXEC CICS                                                    03517099
035180         DELETEQ TS                                               03518099
035190             QUEUE (ASC-LIST-QUEUE-NAME)                          03519099
035200             RESP  (PV-CICS-RESP)                                 03520099
035210     END-EXEC.                                                    03521099
035220                                                                  03522099
035230     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       03523099
035240        (PV-CICS-RESP = DFHRESP(QIDERR))                          03524099
035250         CONTINUE                                                 03525099
035260     ELSE                                                         03526099
035270         SET DP013-CICS-ABEND      TO TRUE                        03527099
035280         SET DP013-NO-ROLLBACK     TO TRUE                        03528099
035290                                                                  03529099
035300         MOVE '2050-DELETE-LIST-QUEUE'                            03530099
035310                                   TO DP013-PARAGRAPH             03531099
035320         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    03532099
035330                                   TO DP013-MESSAGE-TEXT (1)      03533099
035340         PERFORM DP013-0000-PROCESS-ABEND                         03534099
035350     END-IF.                                                      03535099
035360                                                                  03536099
035370     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  03537099
035380                                                                  03538099
035390 EJECT                                                            03539099
035400*----------------------------------------------------------------*03540099
035410*  DELETE THE PO TEMP STORAGE QUEUE.                             *03541099
035420*----------------------------------------------------------------*03542099
035430                                                                  03543099
035440 2051-DELETE-PO-QUEUE.                                            03544099
035450                                                                  03545099
035460     EXEC CICS                                                    03546099
035470         DELETEQ TS                                               03547099
035480             QUEUE (ASC-PO-QUEUE-NAME)                            03548099
035490             RESP  (PV-CICS-RESP)                                 03549099
035500     END-EXEC.                                                    03550099
035510                                                                  03551099
035520     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       03552099
035530        (PV-CICS-RESP = DFHRESP(QIDERR))                          03553099
035540         CONTINUE                                                 03554099
035550     ELSE                                                         03555099
035560         SET DP013-CICS-ABEND      TO TRUE                        03556099
035570         SET DP013-NO-ROLLBACK     TO TRUE                        03557099
035580                                                                  03558099
035590         MOVE '2051-DELETE-PO-QUEUE'                              03559099
035600                                   TO DP013-PARAGRAPH             03560099
035610         MOVE 'ERROR TRYING TO DELETE PO TEMP STORAGE QUEUE'      03561099
035620                                   TO DP013-MESSAGE-TEXT (1)      03562099
035630         PERFORM DP013-0000-PROCESS-ABEND                         03563099
035640     END-IF.                                                      03564099
035650                                                                  03565099
035660     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  03566099
035670                                                                  03567099
035680 EJECT                                                            03568099
035690*----------------------------------------------------------------*03569099
035700*  DELETE THE VARIABLE TEMP STORAGE QUEUE.                       *03570099
035710*----------------------------------------------------------------*03571099
035720                                                                  03572099
035730 2052-DELETE-VARIABLE-QUEUE.                                      03573099
035740                                                                  03574099
035750     EXEC CICS                                                    03575099
035760         DELETEQ TS                                               03576099
035770             QUEUE (ASC-EXTENDED-QUEUE-NAME)                      03577099
035780             RESP  (PV-CICS-RESP)                                 03578099
035790     END-EXEC.                                                    03579099
035800                                                                  03580099
035810     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       03581099
035820        (PV-CICS-RESP = DFHRESP(QIDERR))                          03582099
035830         CONTINUE                                                 03583099
035840     ELSE                                                         03584099
035850         SET DP013-CICS-ABEND      TO TRUE                        03585099
035860         SET DP013-NO-ROLLBACK     TO TRUE                        03586099
035870                                                                  03587099
035880         MOVE '2052-DELETE-VARIABLE-QUEUE'                        03588099
035890                                   TO DP013-PARAGRAPH             03589099
035900         MOVE 'ERROR TRYING TO DELETE VBL TEMP STORAGE QUEUE'     03590099
035910                                   TO DP013-MESSAGE-TEXT (1)      03591099
035920         PERFORM DP013-0000-PROCESS-ABEND                         03592099
035930     END-IF.                                                      03593099
035940                                                                  03594099
035950     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  03595099
035960                                                                  03596099
035970 EJECT                                                            03597099
035980*----------------------------------------------------------------*03598099
035990* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*03599099
036000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *03600099
036010* CICS ARCHITECTURE API.                                         *03601099
036020*----------------------------------------------------------------*03602099
036030                                                                  03603099
036040 2100-CHECK-FUNCTION-KEY.                                         03604099
036050                                                                  03605099
036060     EVALUATE TRUE                                                03606099
036070                                                                  03607099
036080         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03608099
036090            IF ASC-NUMBER-OF-SELECTED-ITEMS = 1                   03609099
036100              INITIALIZE         TR105-INTER-APPL-COMMAREA        03610099
036110              PERFORM 5000-PREPARE-SEL-QUEUE                      03611099
036120            ELSE                                                  03612099
036130              IF ASC-NUMBER-OF-SELECTED-ITEMS > 1                 03613099
036140                SET DP030-OVERRIDE-GO TO TRUE                     03614099
036150                MOVE PC-TSYMSG-00047  TO DP020-MSG-NUMBER         03615099
036160                SET DP020-MSG-WARNING TO TRUE                     03616099
036170              ELSE                                                03617099
036180                IF ASC-NUMBER-OF-SELECTED-ITEMS = 0               03618099
036190                  SET DP030-OVERRIDE-GO TO TRUE                   03619099
036200                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       03620099
036210                  SET DP020-MSG-WARNING TO TRUE                   03621099
036220                END-IF                                            03622099
036230              END-IF                                              03623099
036240            END-IF                                                03624099
036250                                                                  03625099
036260         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03626099
036270              IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                 03627099
036280                 INITIALIZE PO013-INTER-APPL-COMMAREA             03628099
036290                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO             03629099
036300                         PO013-NUMBER-OF-SELECTED-ITEMS           03630099
036310                 MOVE ASC-SEL-QUEUE-NAME           TO             03631099
036320                         PO013-SEL-QUEUE-NAME                     03632099
036330                 PERFORM 5000-PREPARE-SEL-QUEUE                   03633099
036340               ELSE                                               03634099
036350                 SET DP030-OVERRIDE-GO TO TRUE                    03635099
036360                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        03636099
036370                 SET DP020-MSG-WARNING TO TRUE                    03637099
036380              END-IF                                              03638099
036390                                                                  03639099
036400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03640099
036410              IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                 03641099
036420                 INITIALIZE PO013-INTER-APPL-COMMAREA             03642099
036430                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO             03643099
036440                         PO013-NUMBER-OF-SELECTED-ITEMS           03644099
036450                 MOVE ASC-SEL-QUEUE-NAME           TO             03645099
036460                         PO013-SEL-QUEUE-NAME                     03646099
036470                 PERFORM 5000-PREPARE-SEL-QUEUE                   03647099
036480               ELSE                                               03648099
036490                 SET DP030-OVERRIDE-GO TO TRUE                    03649099
036500                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        03650099
036510                 SET DP020-MSG-WARNING TO TRUE                    03651099
036520              END-IF                                              03652099
036530                                                                  03653099
036540********   DIANE BEGIN  3/7                                       03654099
036550         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03655099
036560             IF ASC-NBR-OF-POS-DISPLAYED > 0                      03656099
036570                 IF ASC-NBR-OF-POS-DISPLAYED < 20001              03657099
036580                     SET DP030-CONTINUE-GO TO TRUE                03658099
036590                     PERFORM 4152-READ-JCL-QUEUE                  03659099
036600                     IF PS-NO-ERROR                               03660099
036610                       PERFORM 7000-SUBMIT-FILE                   03661099
036620                     END-IF                                       03662099
036630*                    --- JCL PROCESS COMPLETED ---                03663099
036640                     PERFORM 4153-DELETE-JCL-QUEUE                03664099
036650                 ELSE                                             03665099
036660                     SET DP030-OVERRIDE-GO TO TRUE                03666099
036670                     MOVE PC-TSYMSG-00336 TO DP020-MSG-NUMBER     03667099
036680                     SET DP020-MSG-WARNING TO TRUE                03668099
036690                 END-IF                                           03669099
036700             ELSE                                                 03670099
036710                 SET DP030-OVERRIDE-GO TO TRUE                    03671099
036720                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        03672099
036730                 SET DP020-MSG-WARNING TO TRUE                    03673099
036740             END-IF                                               03674099
036750                                                                  03675099
036760********   DIANE  END   3/7                                       03676099
036770         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  03677099
036780             MOVE +1               TO PV-TOP-ITEM                 03678099
036790             MOVE ASC-VCTL-SORTED-TABLE TO                        03679099
036800                                PV-VCTL-SORTED-TABLE              03680099
036810             MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN                03681099
036820             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03682099
036830             PERFORM 3200-RESET-ATTRIBUTES                        03683099
036840                                                                  03684099
036850         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   03685099
036860             MOVE ASC-VCTL-SORTED-TABLE TO                        03686099
036870                             PV-VCTL-SORTED-TABLE                 03687099
036880             MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN                03688099
036890             PERFORM 2110-BROWSE-BACKWARD                         03689099
036900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03690099
036910             PERFORM 3200-RESET-ATTRIBUTES                        03691099
036920                                                                  03692099
036930         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   03693099
036940             MOVE ASC-VCTL-SORTED-TABLE TO                        03694099
036950                             PV-VCTL-SORTED-TABLE                 03695099
036960             MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN                03696099
036970             PERFORM 2120-BROWSE-FORWARD                          03697099
036980             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03698099
036990                                                                  03699099
037000         WHEN DP020-FK-LEFT(DP020-SRC-AID)                        03700099
037010*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*03701099
037020*  THIS SECTION OF CODE SHIFTS ONE VIRTUAL SCREEN PAGE TO THE    *03702099
037030*  LEFT. ASC-SEL-VARIABLE-SCREEN IS A GLOBAL VARIABLE THAT HOLDS *03703099
037040*  THE CURRENT VIRTUAL SCREEN.  VIRTUAL SCREENS ALWAYS BEGIN     *03704099
037050*  AT 0 AND CAN GO AS HIGH AS 99. BEYOND 99 THE SYSTEM WILL LOOP *03705099
037060*  BACK TO 0.  CURRENTLY ONLY 5 VIRTUAL SCREENS WOULD EVER BE    *03706099
037070*  NEEDED FOR THE 39 FIELDS THUS THERE IS LOTS OF ROOM FOR       *03707099
037080*  GROWTH.                                                       *03708099
037090*----------------------------------------------------------------*03709099
037100             MOVE ASC-VCTL-SORTED-TABLE TO                        03710099
037110                             PV-VCTL-SORTED-TABLE                 03711099
037120             MOVE ASC-SEL-VARIABLE-SCREEN TO                      03712099
037130                             ASC-REDRAW-VARIABLE-SCREEN           03713099
037140             IF ASC-SEL-VARIABLE-SCREEN = 0                       03714099
037150                SET DP030-OVERRIDE-GO TO TRUE                     03715099
037160                MOVE PC-TSYMSG-01993  TO DP020-MSG-NUMBER         03716099
037170                SET DP020-MSG-INFORMATIONAL TO TRUE               03717099
037180             ELSE                                                 03718099
037190               IF ASC-SEL-VARIABLE-SCREEN > 0                     03719099
037200                SUBTRACT 1 FROM ASC-SEL-VARIABLE-SCREEN           03720099
037210               END-IF                                             03721099
037220             END-IF                                               03722099
037230*#END_OF_VARIABLE_LOGIC------------------------------------------*03723099
037240             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03724099
037250             PERFORM 3200-RESET-ATTRIBUTES                        03725099
037260                                                                  03726099
037270         WHEN DP020-FK-RIGHT(DP020-SRC-AID)                       03727099
037280*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*03728099
037290*  THIS SECTION OF CODE HANDLES THE SHIFTING ONE VIRTUAL SCREEN  *03729099
037300*  RIGHT.  IT WORKS THE SAME WAY AS SHIFTING LEFT EXCEPT IN      *03730099
037310*  REVERSE.                                                      *03731099
037320*----------------------------------------------------------------*03732099
037330             MOVE ASC-VCTL-SORTED-TABLE TO                        03733099
037340                             PV-VCTL-SORTED-TABLE                 03734099
037350             MOVE ASC-SEL-VARIABLE-SCREEN TO                      03735099
037360                    ASC-REDRAW-VARIABLE-SCREEN                    03736099
037370             IF ASC-SEL-VARIABLE-SCREEN                           03737099
037380                                  = ASC-MAX-VARIABLE-SCREENS      03738099
037390                SET DP030-OVERRIDE-GO TO TRUE                     03739099
037400                MOVE PC-TSYMSG-01993  TO DP020-MSG-NUMBER         03740099
037410                SET DP020-MSG-INFORMATIONAL TO TRUE               03741099
037420             ELSE                                                 03742099
037430               IF ASC-SEL-VARIABLE-SCREEN                         03743099
037440                                 < ASC-MAX-VARIABLE-SCREENS       03744099
037450                  ADD 1 TO ASC-SEL-VARIABLE-SCREEN                03745099
037460               END-IF                                             03746099
037470             END-IF                                               03747099
037480*#END_OF_VARIABLE_LOGIC------------------------------------------*03748099
037490             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03749099
037500             PERFORM 3200-RESET-ATTRIBUTES                        03750099
037510                                                                  03751099
037520         WHEN DP020-SRC-AID = DP016-ENTER                         03752099
037530             MOVE ASC-VCTL-SORTED-TABLE TO                        03753099
037540                           PV-VCTL-SORTED-TABLE                   03754099
037550             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   03755099
037560             IF  PS-ERROR                                         03756099
037570                 CONTINUE                                         03757099
037580             ELSE                                                 03758099
037590                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03759099
037600                 PERFORM 3200-RESET-ATTRIBUTES                    03760099
037610             END-IF                                               03761099
037620                                                                  03762099
037630         WHEN OTHER                                               03763099
037640             SET DP013-NO-ROLLBACK                                03764099
037650                 DP013-XCTL-DISPLAY-RESTART                       03765099
037660                 DP013-CICS-ABEND  TO TRUE                        03766099
037670             MOVE '2100-CHECK-FUNCTION-KEY'                       03767099
037680                                   TO DP013-PARAGRAPH             03768099
037690             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03769099
037700                                   TO DP013-MESSAGE-TEXT (1)      03770099
037710             PERFORM DP013-0000-PROCESS-ABEND                     03771099
037720     END-EVALUATE.                                                03772099
037730                                                                  03773099
037740 EJECT                                                            03774099
037750*----------------------------------------------------------------*03775099
037760*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *03776099
037770*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *03777099
037780*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *03778099
037790*    MESSAGE.                                                    *03779099
037800*----------------------------------------------------------------*03780099
037810                                                                  03781099
037820 2110-BROWSE-BACKWARD.                                            03782099
037830                                                                  03783099
037840     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    03784099
037850         GIVING PV-TOP-ITEM.                                      03785099
037860*                                                                 03786099
037870     IF  ((PV-TOP-ITEM < +1)                                      03787099
037880       OR (PV-TOP-ITEM = +1))                                     03788099
037890         MOVE +1                   TO PV-TOP-ITEM                 03789099
037900*------- TOP OF LIST -----                                        03790099
037910         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            03791099
037920         SET DP020-MSG-INFORMATIONAL TO TRUE                      03792099
037930     END-IF.                                                      03793099
037940                                                                  03794099
037950 EJECT                                                            03795099
037960*----------------------------------------------------------------*03796099
037970*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *03797099
037980*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *03798099
037990*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *03799099
038000*----------------------------------------------------------------*03800099
038010                                                                  03801099
038020 2120-BROWSE-FORWARD.                                             03802099
038030     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              03803099
038040         GIVING PV-TOP-ITEM.                                      03804099
038050     COMPUTE PV-BOTTOM-ITEM =                                     03805099
038060         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1.                    03806099
038070*                                                                 03807099
038080     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ                03808099
038090       AND ASC-ITEMS-LEFT-ON-DB                                   03809099
038100         ADD PC-ITEMS-PER-PANEL  1                                03810099
038110             GIVING ASC-ITEM-SUB                                  03811099
038120         ADD PC-MAX-BLOCKS-IN-ARRAY 1                             03812099
038130             GIVING ASC-BLK-SUB                                   03813099
038140         MOVE ASC-MAX-GROUPS      TO PV-GROUPS-TO-READ            03814099
038150         PERFORM 4005-BUILD-ADDITIONAL-PANELS                     03815099
038160     END-IF.                                                      03816099
038170                                                                  03817099
038180*                                                                 03818099
038190     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   03819099
038200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            03820099
038210                                   TO PV-TOP-ITEM                 03821099
038220*        -- BOTTOM OF LIST --                                     03822099
038230         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            03823099
038240         SET DP020-MSG-INFORMATIONAL                              03824099
038250                                   TO TRUE                        03825099
038260     ELSE                                                         03826099
038270         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            03827099
038280*            -- BOTTOM OF LIST --                                 03828099
038290             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            03829099
038300             SET DP020-MSG-INFORMATIONAL                          03830099
038310                                   TO TRUE                        03831099
038320         END-IF                                                   03832099
038330     END-IF.                                                      03833099
038340 EJECT                                                            03834099
038350*----------------------------------------------------------------*03835099
038360*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *03836099
038370*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *03837099
038380*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *03838099
038390*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *03839099
038400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *03840099
038410*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *03841099
038420*----------------------------------------------------------------*03842099
038430                                                                  03843099
038440 2130-CHECK-FOR-JUMP-BROWSE.                                      03844099
038450                                                                  03845099
038460     SET PS-NO-ERROR               TO TRUE.                       03846099
038470     IF  (ASC-START-ITEM-REQUEST = SPACE)                         03847099
038480         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            03848099
038490                                   TO PV-TOP-ITEM                 03849099
038500     ELSE                                                         03850099
038510         MOVE ASC-START-ITEM-REQUEST                              03851099
038520                                   TO DP010I-UNEDITED-FIELD       03852099
038530         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       03853099
038540         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     03854099
038550         SET DP010I-NEGATIVE-NOT-ALLOWED                          03855099
038560                                   TO TRUE                        03856099
038570         CALL DP010I-NUMERIC-EDIT-ROUTINE                         03857099
038580              USING DP010I-NUMERIC-EDIT-AREA                      03858099
038590                                                                  03859099
038600         IF  NOT DP010I-ERROR-DETECTED                            03860099
038610             MOVE DP010I-NUMERIC-FIELD                            03861099
038620                                   TO  ASC-START-ITEM-REQUEST-N   03862099
038630             IF  ASC-START-ITEM-REQUEST-N > ZERO                  03863099
038640                 PERFORM 2131-GET-MORE-PANELS                     03864099
038650                 IF  ASC-START-ITEM-REQUEST-N >                   03865099
038660                                          ASC-NUMBER-OF-ITEMS-READ03866099
038670                     MOVE SPACE TO ASC-START-ITEM-REQUEST         03867099
038680                     COMPUTE PV-TOP-ITEM =                        03868099
038690                             ASC-NUMBER-OF-ITEMS-READ             03869099
038700                             - PC-ITEMS-PER-PANEL + 1             03870099
038710                     IF  PV-TOP-ITEM < +1                         03871099
038720                         MOVE +1   TO PV-TOP-ITEM                 03872099
038730                         MOVE PC-TSYMSG-00070                     03873099
038740                                   TO DP020-MSG-NUMBER            03874099
038750                         SET DP020-MSG-INFORMATIONAL              03875099
038760                                   TO TRUE                        03876099
038770                     END-IF                                       03877099
038780                 ELSE                                             03878099
038790                     MOVE ASC-START-ITEM-REQUEST-N                03879099
038800                                   TO PV-TOP-ITEM                 03880099
038810                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      03881099
038820                     COMPUTE PV-BOTTOM-ITEM =                     03882099
038830                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     03883099
038840                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ03884099
038850*----------------------- BOTTOM OF LIST --------------            03885099
038860                         MOVE PC-TSYMSG-00070                     03886099
038870                                   TO DP020-MSG-NUMBER            03887099
038880                         SET DP020-MSG-INFORMATIONAL              03888099
038890                                   TO TRUE                        03889099
038900                     END-IF                                       03890099
038910                 END-IF                                           03891099
038920             ELSE                                                 03892099
038930*--------------- VALUE OUT OF RANGE ------------------            03893099
038940                 MOVE PC-TSYMSG-00101                             03894099
038950                                   TO DP020-MSG-NUMBER            03895099
038960                 MOVE -1           TO ASTRTITL                    03896099
038970                 SET DP030-SET-CURSOR-APPL-1                      03897099
038980                                   TO TRUE                        03898099
038990                 MOVE DP015-REVERSE                               03899099
039000                                   TO ASTRTITH                    03900099
039010                 MOVE DP015-RED    TO ASTRTITC                    03901099
039020                 MOVE DP015-UNP-NUM-BRT-MDT                       03902099
039030                                   TO ASTRTITA                    03903099
039040                 SET DP020-MSG-FATAL                              03904099
039050                                   TO TRUE                        03905099
039060                 SET PS-ERROR      TO TRUE                        03906099
039070             END-IF                                               03907099
039080                                                                  03908099
039090         ELSE                                                     03909099
039100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03910099
039110             MOVE -1               TO ASTRTITL                    03911099
039120             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03912099
039130             MOVE DP015-REVERSE    TO ASTRTITH                    03913099
039140             MOVE DP015-RED        TO ASTRTITC                    03914099
039150             MOVE DP015-UNP-NUM-BRT-MDT                           03915099
039160                                   TO ASTRTITA                    03916099
039170             SET DP020-MSG-FATAL   TO TRUE                        03917099
039180             SET PS-ERROR          TO TRUE                        03918099
039190         END-IF                                                   03919099
039200     END-IF.                                                      03920099
039210                                                                  03921099
039220 EJECT                                                            03922099
039230*----------------------------------------------------------------*03923099
039240* SEE IF THERE IS A NEED TO READ ADDITIONAL PANELS OF INFO FROM  *03924099
039250* DATABASE BASED ON THE JUMP-BROWSE REQUEST.  IF THERE IS        *03925099
039260* CALCULATE THE NUMBER TO READ AND READ THEM.                    *03926099
039270*----------------------------------------------------------------*03927099
039280                                                                  03928099
039290 2131-GET-MORE-PANELS.                                            03929099
039300     IF  ASC-START-ITEM-REQUEST-N >                               03930099
039310                              ASC-NUMBER-OF-ITEMS-READ            03931099
039320         IF  ASC-ITEMS-LEFT-ON-DB                                 03932099
039330             ADD PC-ITEMS-PER-PANEL  1                            03933099
039340                 GIVING ASC-ITEM-SUB                              03934099
039350             COMPUTE PV-GROUPS-TO-READ ROUNDED =                  03935099
039360                 (((ASC-START-ITEM-REQUEST-N                      03936099
039370                 - ASC-NUMBER-OF-ITEMS-READ)                      03937099
039380                 / (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-PANEL)) 03938099
039390                 + 1)                                             03939099
039400             PERFORM 4005-BUILD-ADDITIONAL-PANELS                 03940099
039410         END-IF                                                   03941099
039420     END-IF.                                                      03942099
039430 EJECT                                                            03943099
039440*----------------------------------------------------------------*03944099
039450*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *03945099
039460*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *03946099
039470*----------------------------------------------------------------*03947099
039480                                                                  03948099
039490 2140-DESELECT-ALL-ITEMS.                                         03949099
039500                                                                  03950099
039510     MOVE +1                       TO ASC-BLK-SUB.                03951099
039520                                                                  03952099
039530     PERFORM 2141-CLEAR-SELECTED-INDS                             03953099
039540         VARYING ASC-ITEM-SUB                                     03954099
039550         FROM 1 BY 1                                              03955099
039560         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 03956099
039570                                                                  03957099
039580     ADD +1                        TO ASC-BLK-SUB.                03958099
039590                                                                  03959099
039600     PERFORM 2141-CLEAR-SELECTED-INDS                             03960099
039610         VARYING ASC-ITEM-SUB                                     03961099
039620         FROM 1 BY 1                                              03962099
039630         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 03963099
039640                                                                  03964099
039650     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               03965099
039660                                   TO PV-LIST-ITEM-NUMBER.        03966099
039670                                                                  03967099
039680     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            03968099
039690         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    03969099
039700                                                                  03970099
039710     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     03971099
039720        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      03972099
039730         MOVE +1                   TO ASC-BLK-SUB                 03973099
039740                                                                  03974099
039750         PERFORM 5100-WRITE-TEMP-STORAGE                          03975099
039760                                                                  03976099
039770         MOVE +1                   TO PV-BLOCK-NUMBER             03977099
039780                                                                  03978099
039790         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         03979099
039800             PV-FIRST-BLOCK-IN-ARRAY - 1                          03980099
039810                                                                  03981099
039820         PERFORM                                                  03982099
039830             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       03983099
039840                                                                  03984099
039850             PERFORM 4410-READ-TEMP-STORAGE                       03985099
039860                                                                  03986099
039870             PERFORM 2141-CLEAR-SELECTED-INDS                     03987099
039880                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 03988099
039890                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          03989099
039900                                                                  03990099
039910             PERFORM 5100-WRITE-TEMP-STORAGE                      03991099
039920                                                                  03992099
039930             ADD +1                TO PV-BLOCK-NUMBER             03993099
039940                                                                  03994099
039950         END-PERFORM                                              03995099
039960                                                                  03996099
039970         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         03997099
039980             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     03998099
039990                                                                  03999099
040000         PERFORM                                                  04000099
040010             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       04001099
040020                   ASC-HIGHEST-BLOCK-WRITTEN                      04002099
040030                                                                  04003099
040040             MOVE PV-NEXT-BLOCK-IN-ARRAY                          04004099
040050                                   TO PV-BLOCK-NUMBER             04005099
040060                                                                  04006099
040070             PERFORM 4410-READ-TEMP-STORAGE                       04007099
040080                                                                  04008099
040090             PERFORM 2141-CLEAR-SELECTED-INDS                     04009099
040100                 VARYING ASC-ITEM-SUB                             04010099
040110                 FROM 1 BY 1                                      04011099
040120                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04012099
040130                                                                  04013099
040140             PERFORM 5100-WRITE-TEMP-STORAGE                      04014099
040150                                                                  04015099
040160             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      04016099
040170                                                                  04017099
040180         END-PERFORM                                              04018099
040190                                                                  04019099
040200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             04020099
040210                                   TO PV-BLOCK-NUMBER             04021099
040220                                                                  04022099
040230         PERFORM 4410-READ-TEMP-STORAGE                           04023099
040240     END-IF.                                                      04024099
040250                                                                  04025099
040260     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS04026099
040270                                      ASC-START-OF-SELECTED-RANGE 04027099
040280                                      ASC-END-OF-SELECTED-RANGE.  04028099
040290                                                                  04029099
040300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        04030099
040310                                                                  04031099
040320 EJECT                                                            04032099
040330*----------------------------------------------------------------*04033099
040340*    MARK EACH ITEM AS BEING NOT SELECTED.                       *04034099
040350*----------------------------------------------------------------*04035099
040360                                                                  04036099
040370 2141-CLEAR-SELECTED-INDS.                                        04037099
040380                                                                  04038099
040390     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           04039099
040400             NOT EQUAL ZERO                                       04040099
040410         IF  (ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             04041099
040420           AND ASC-TEMP-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB))      04042099
040430             CONTINUE                                             04043099
040440         ELSE                                                     04044099
040450             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          04045099
040460                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    04046099
040470                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  04047099
040480                                   TO TRUE                        04048099
040490         END-IF                                                   04049099
040500     END-IF.                                                      04050099
040510                                                                  04051099
040520 EJECT                                                            04052099
040530*----------------------------------------------------------------*04053099
040540*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *04054099
040550*  FOR ALL ITEMS.                                                *04055099
040560*----------------------------------------------------------------*04056099
040570                                                                  04057099
040580 2150-SELECT-ALL-ITEMS.                                           04058099
040590                                                                  04059099
040600                                                                  04060099
040610*  SELECT ALL ITEMS IN THE CURRENT 'FIRST' BLOCK.                 04061099
040620     MOVE +1                       TO ASC-BLK-SUB.                04062099
040630     PERFORM 2151-SET-SELECTED-INDS                               04063099
040640         VARYING ASC-ITEM-SUB                                     04064099
040650         FROM 1 BY 1                                              04065099
040660         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04066099
040670                                                                  04067099
040680*  SELECT ALL ITEMS IN THE CURRENT 'SECOND' BLOCK.                04068099
040690     ADD +1                        TO ASC-BLK-SUB.                04069099
040700     PERFORM 2151-SET-SELECTED-INDS                               04070099
040710         VARYING ASC-ITEM-SUB                                     04071099
040720         FROM 1 BY 1                                              04072099
040730         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04073099
040740                                                                  04074099
040750     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               04075099
040760                                   TO PV-LIST-ITEM-NUMBER.        04076099
040770                                                                  04077099
040780     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            04078099
040790         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    04079099
040800                                                                  04080099
040810     IF ((PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                    04081099
040820        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY) OR 04082099
040830        (ASC-ITEMS-LEFT-ON-DB))                                   04083099
040840         MOVE +1                   TO ASC-BLK-SUB                 04084099
040850         PERFORM 5100-WRITE-TEMP-STORAGE                          04085099
040860         ADD +1                    TO ASC-BLK-SUB                 04086099
040870         PERFORM 5100-WRITE-TEMP-STORAGE                          04087099
040880         MOVE +1                   TO ASC-BLK-SUB                 04088099
040890                                                                  04089099
040900*  SELECT EVERYTHING 'BEFORE' THE CURRENT BLOCKS                  04090099
040910         MOVE +1                   TO PV-BLOCK-NUMBER             04091099
040920                                                                  04092099
040930         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         04093099
040940             PV-FIRST-BLOCK-IN-ARRAY - 1                          04094099
040950                                                                  04095099
040960         PERFORM                                                  04096099
040970             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       04097099
040980                                                                  04098099
040990             PERFORM 4410-READ-TEMP-STORAGE                       04099099
041000                                                                  04100099
041010             PERFORM 2151-SET-SELECTED-INDS                       04101099
041020                 VARYING ASC-ITEM-SUB                             04102099
041030                 FROM 1 BY 1                                      04103099
041040                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04104099
041050                                                                  04105099
041060             PERFORM 5100-WRITE-TEMP-STORAGE                      04106099
041070                                                                  04107099
041080             ADD +1                TO PV-BLOCK-NUMBER             04108099
041090                                                                  04109099
041100         END-PERFORM                                              04110099
041110                                                                  04111099
041120* IF NOT ALL DATA HAS BEEN READ, READ EVERYTHING, AND PUT IT      04112099
041130* INTO TEMP STORAGE.                                              04113099
041140     IF  ASC-ITEMS-LEFT-ON-DB                                     04114099
041150         COMPUTE PV-GROUPS-TO-READ =                              04115099
041160             (((PC-MAX-ITEMS - ASC-NUMBER-OF-ITEMS-READ)          04116099
041170             / (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-PANEL)) + 1)04117099
041180         PERFORM 4005-BUILD-ADDITIONAL-PANELS                     04118099
041190     END-IF                                                       04119099
041200                                                                  04120099
041210* SELECT EVERYTHING AFTER THE CURRENT BLOCKS                      04121099
041220         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         04122099
041230             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     04123099
041240                                                                  04124099
041250         PERFORM                                                  04125099
041260             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       04126099
041270                   ASC-HIGHEST-BLOCK-WRITTEN                      04127099
041280                                                                  04128099
041290             MOVE PV-NEXT-BLOCK-IN-ARRAY                          04129099
041300                                   TO PV-BLOCK-NUMBER             04130099
041310                                                                  04131099
041320             PERFORM 4410-READ-TEMP-STORAGE                       04132099
041330                                                                  04133099
041340             PERFORM 2151-SET-SELECTED-INDS                       04134099
041350                 VARYING ASC-ITEM-SUB                             04135099
041360                 FROM 1 BY 1                                      04136099
041370                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04137099
041380                                                                  04138099
041390             PERFORM 5100-WRITE-TEMP-STORAGE                      04139099
041400                                                                  04140099
041410             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      04141099
041420                                                                  04142099
041430         END-PERFORM                                              04143099
041440                                                                  04144099
041450*  REPOSITION TO CURRENT BLOCKS                                   04145099
041460         MOVE PV-FIRST-BLOCK-IN-ARRAY                             04146099
041470                                   TO PV-BLOCK-NUMBER             04147099
041480                                                                  04148099
041490         PERFORM 4410-READ-TEMP-STORAGE                           04149099
041500     END-IF.                                                      04150099
041510                                                                  04151099
041520                                                                  04152099
041530     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             04153099
041540                       ASC-NUMBER-OF-SELECTED-ITEMS.              04154099
041550                                                                  04155099
041560     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        04156099
041570                                                                  04157099
041580 EJECT                                                            04158099
041590*----------------------------------------------------------------*04159099
041600*    MARK EACH ITEM AS BEING SELECTED.                           *04160099
041610*----------------------------------------------------------------*04161099
041620                                                                  04162099
041630 2151-SET-SELECTED-INDS.                                          04163099
041640                                                                  04164099
041650     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           04165099
041660             NOT EQUAL ZERO                                       04166099
041670         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             04167099
041680             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             04168099
041690                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        04169099
041700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  04170099
041710                               TO  TRUE                           04171099
041720         END-IF                                                   04172099
041730     END-IF.                                                      04173099
041740                                                                  04174099
041750 EJECT                                                            04175099
041760*----------------------------------------------------------------*04176099
041770*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *04177099
041780*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *04178099
041790*----------------------------------------------------------------*04179099
041800                                                                  04180099
041810 2200-MOVE-SCREEN-TO-COMMAREA.                                    04181099
041820                                                                  04182099
041830     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             04183099
041840     MOVE +1                       TO PV-SUB.                     04184099
041850*                                                                 04185099
041860     PERFORM 3100-SET-SUBSCRIPTS.                                 04186099
041870     IF  ASTRTITL > ZERO                                          04187099
041880         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          04188099
041890     ELSE                                                         04189099
041900         IF  ASTRTITF = DP015-ERASE-EOF                           04190099
041910             INITIALIZE ASC-START-ITEM-REQUEST                    04191099
041920         END-IF                                                   04192099
041930     END-IF.                                                      04193099
041940     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          04194099
041950         VARYING PV-SUB                                           04195099
041960         FROM 1 BY 1                                              04196099
041970         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      04197099
041980                                                                  04198099
041990 EJECT                                                            04199099
042000*----------------------------------------------------------------*04200099
042010*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *04201099
042020*----------------------------------------------------------------*04202099
042030                                                                  04203099
042040 2210-MOVE-LINES-TO-COMMAREA.                                     04204099
042050                                                                  04205099
042060     IF  MR-SELECTL (PV-SUB) > ZERO                               04206099
042070         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             04207099
042080         MOVE MR-SELECTI (PV-SUB)                                 04208099
042090                                   TO ASC-TEMP-SELECTED-SW        04209099
042100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      04210099
042110     ELSE                                                         04211099
042120         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                04212099
042130                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     04213099
042140                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        04214099
042150                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      04215099
042160         END-IF                                                   04216099
042170     END-IF.                                                      04217099
042180     ADD +1                        TO ASC-ITEM-SUB.               04218099
042190     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        04219099
042200         ADD  +1                   TO ASC-BLK-SUB                 04220099
042210         MOVE +1                   TO ASC-ITEM-SUB                04221099
042220     END-IF.                                                      04222099
042230                                                                  04223099
042240 EJECT                                                            04224099
042250*----------------------------------------------------------------*04225099
042260*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *04226099
042270*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *04227099
042280*----------------------------------------------------------------*04228099
042290                                                                  04229099
042300 3000-EDIT-DATA-IN-COMMAREA.                                      04230099
042310                                                                  04231099
042320     SET PS-NO-ERROR               TO TRUE.                       04232099
042330     PERFORM 3200-RESET-ATTRIBUTES.                               04233099
042340     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     04234099
042350*----------------------------------------------------------------*04235099
042360* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.             *04236099
042370* EDITTING IS DONE FROM THE BOTTOM UP.                           *04237099
042380*----------------------------------------------------------------*04238099
042390     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       04239099
042400         ASC-ITEMS-DISPLAYED - 1.                                 04240099
042410     PERFORM 3100-SET-SUBSCRIPTS.                                 04241099
042420     PERFORM 3300-EDIT-SELECTIONS                                 04242099
042430         VARYING PV-SUB                                           04243099
042440         FROM PV-SUB BY -1                                        04244099
042450         UNTIL PV-SUB < +1.                                       04245099
042460*                                                                 04246099
042470     IF  PS-NO-ERROR                                              04247099
042480         PERFORM 3400-CHECK-RANGE-SEQUENCE                        04248099
042490     END-IF.                                                      04249099
042500*                                                                 04250099
042510     IF  ((PS-NO-ERROR)                                           04251099
042520       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   04252099
042530       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    04253099
042540             PERFORM 3500-MARK-RANGE-AS-SELECTED                  04254099
042550     END-IF.                                                      04255099
042560                                                                  04256099
042570 EJECT                                                            04257099
042580*----------------------------------------------------------------*04258099
042590*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *04259099
042600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY. THIS WILL *04260099
042610*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *04261099
042620*                                                                *04262099
042630*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *04263099
042640*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *04264099
042650*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *04265099
042660*    US IN THE 2ND BLOCK OF THE ARRAY.                           *04266099
042670*----------------------------------------------------------------*04267099
042680                                                                  04268099
042690 3100-SET-SUBSCRIPTS.                                             04269099
042700                                                                  04270099
042710     COMPUTE ASC-ITEM-SUB =                                       04271099
042720         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        04272099
042730                                                                  04273099
042740     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         04274099
042750         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            04275099
042760                                                                  04276099
042770         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               04277099
042780     ELSE                                                         04278099
042790         MOVE +1                     TO ASC-BLK-SUB               04279099
042800     END-IF.                                                      04280099
042810                                                                  04281099
042820 EJECT                                                            04282099
042830*----------------------------------------------------------------*04283099
042840*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *04284099
042850*----------------------------------------------------------------*04285099
042860                                                                  04286099
042870 3200-RESET-ATTRIBUTES.                                           04287099
042880                                                                  04288099
042890     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   04289099
042900     MOVE DP015-GREEN              TO ASTRTITC.                   04290099
042910     MOVE DP015-UNDERLINE          TO ASTRTITH.                   04291099
042920                                                                  04292099
042930     PERFORM                                                      04293099
042940         VARYING PV-SUB                                           04294099
042950         FROM 1 BY 1                                              04295099
042960         UNTIL PV-SUB > (PC-ITEMS-PER-PANEL  OR                   04296099
042970                         ASC-ITEMS-DISPLAYED)                     04297099
042980         MOVE DP015-UNP-ALP-NOR-OFF                               04298099
042990                                   TO MR-SELECTA (PV-SUB)         04299099
043000         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         04300099
043010         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         04301099
043020     END-PERFORM.                                                 04302099
043030                                                                  04303099
043040 EJECT                                                            04304099
043050*----------------------------------------------------------------*04305099
043060*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *04306099
043070*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *04307099
043080*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *04308099
043090*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *04309099
043100*----------------------------------------------------------------*04310099
043110                                                                  04311099
043120 3300-EDIT-SELECTIONS.                                            04312099
043130                                                                  04313099
043140     EVALUATE TRUE                                                04314099
043150         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     04315099
043160             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         04316099
043170                 CONTINUE                                         04317099
043180         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         04318099
043190             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        04319099
043200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   04320099
043210                 MOVE ASC-TEMP-SELECTED-SW                        04321099
043220                                      (ASC-BLK-SUB ASC-ITEM-SUB)  04322099
043230                                TO ASC-SELECTED-SW                04323099
043240                                      (ASC-BLK-SUB ASC-ITEM-SUB)  04324099
043250             END-IF                                               04325099
043260         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     04326099
043270                                = SPACE                           04327099
043280             EVALUATE TRUE                                        04328099
043290                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       04329099
043300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS04330099
043310                     MOVE SPACE TO ASC-SELECTED-SW                04331099
043320                                      (ASC-BLK-SUB ASC-ITEM-SUB)  04332099
043330                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        04333099
043340                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    04334099
043350                     MOVE SPACE TO ASC-SELECTED-SW                04335099
043360                                      (ASC-BLK-SUB ASC-ITEM-SUB)  04336099
043370                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          04337099
043380                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      04338099
043390                     MOVE SPACE TO ASC-SELECTED-SW                04339099
043400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  04340099
043410             END-EVALUATE                                         04341099
043420         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           04342099
043430             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            04343099
043440                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    04344099
043450             END-IF                                               04345099
043460             PERFORM 3310-EDIT-RANGE                              04346099
043470         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             04347099
043480             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            04348099
043490                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    04349099
043500             END-IF                                               04350099
043510             PERFORM 3310-EDIT-RANGE                              04351099
043520         WHEN OTHER                                               04352099
043530             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           04353099
043540             SET DP020-MSG-FATAL    TO TRUE                       04354099
043550             MOVE -1                TO MR-SELECTL (PV-SUB)        04355099
043560             SET DP030-SET-CURSOR-APPL-1                          04356099
043570                                    TO TRUE                       04357099
043580             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        04358099
043590             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        04359099
043600             SET PS-ERROR TO TRUE                                 04360099
043610             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            04361099
043620                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     04362099
043630                 MOVE SPACE         TO ASC-SELECTED-SW            04363099
043640                                        (ASC-BLK-SUB ASC-ITEM-SUB)04364099
043650             END-IF                                               04365099
043660     END-EVALUATE.                                                04366099
043670                                                                  04367099
043680     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 04368099
043690     SUBTRACT +1 FROM ASC-ITEM-SUB.                               04369099
043700     IF  ASC-ITEM-SUB < 1                                         04370099
043710         SUBTRACT +1 FROM ASC-BLK-SUB                             04371099
043720         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                04372099
043730     END-IF.                                                      04373099
043740                                                                  04374099
043750 EJECT                                                            04375099
043760*----------------------------------------------------------------*04376099
043770*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *04377099
043780*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *04378099
043790*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *04379099
043800*  THE ENDING.                                                   *04380099
043810*----------------------------------------------------------------*04381099
043820                                                                  04382099
043830 3310-EDIT-RANGE.                                                 04383099
043840                                                                  04384099
043850     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                04385099
043860         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   04386099
043870             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)04387099
043880                                   TO ASC-SELECTED-SW             04388099
043890                                        (ASC-BLK-SUB ASC-ITEM-SUB)04389099
043900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 04390099
043910         ELSE                                                     04391099
043920             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     04392099
043930                 CONTINUE                                         04393099
043940             ELSE                                                 04394099
043950*--------------- ONLY ONE BEGINNING-OF-RANGE-ALLOWED ---          04395099
043960                 MOVE PC-TSYMSG-00054                             04396099
043970                                   TO DP020-MSG-NUMBER            04397099
043980                 SET DP020-MSG-FATAL                              04398099
043990                                   TO TRUE                        04399099
044000                 MOVE -1           TO MR-SELECTL (PV-SUB)         04400099
044010                 SET DP030-SET-CURSOR-APPL-1                      04401099
044020                                   TO TRUE                        04402099
044030                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         04403099
044040                 MOVE DP015-UNDERLINE                             04404099
044050                                   TO MR-SELECTH (PV-SUB)         04405099
044060                 SET PS-ERROR      TO TRUE                        04406099
044070             END-IF                                               04407099
044080         END-IF                                                   04408099
044090     ELSE                                                         04409099
044100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     04410099
044110             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 04411099
044120                                   TO ASC-SELECTED-SW             04412099
044130                                     (ASC-BLK-SUB ASC-ITEM-SUB)   04413099
044140             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   04414099
044150         ELSE                                                     04415099
044160             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       04416099
044170                 CONTINUE                                         04417099
044180             ELSE                                                 04418099
044190*--------------- ONLY ONE END-OF-RANGE ALLOWED -------            04419099
044200                 MOVE PC-TSYMSG-00055                             04420099
044210                                   TO DP020-MSG-NUMBER            04421099
044220                 SET DP020-MSG-FATAL                              04422099
044230                                   TO TRUE                        04423099
044240                 MOVE -1           TO MR-SELECTL (PV-SUB)         04424099
044250                 SET DP030-SET-CURSOR-APPL-1                      04425099
044260                                   TO TRUE                        04426099
044270                 SET PS-ERROR      TO TRUE                        04427099
044280             END-IF                                               04428099
044290         END-IF                                                   04429099
044300     END-IF.                                                      04430099
044310                                                                  04431099
044320 EJECT                                                            04432099
044330*----------------------------------------------------------------*04433099
044340*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *04434099
044350*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *04435099
044360*----------------------------------------------------------------*04436099
044370                                                                  04437099
044380 3400-CHECK-RANGE-SEQUENCE.                                       04438099
044390                                                                  04439099
044400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       04440099
044410       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      04441099
044420       AND  ASC-START-OF-SELECTED-RANGE >                         04442099
044430                                         ASC-END-OF-SELECTED-RANGE04443099
044440*------- END-OF-RANGE BEFORE BEGINNING-OF-RANGE --                04444099
044450         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 04445099
044460         SET DP020-MSG-FATAL TO TRUE                              04446099
044470         SET PS-ERROR TO TRUE                                     04447099
044480         PERFORM 3410-POSITION-AT-ERROR                           04448099
044490     END-IF.                                                      04449099
044500                                                                  04450099
044510 EJECT                                                            04451099
044520*----------------------------------------------------------------*04452099
044530*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *04453099
044540*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *04454099
044550*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *04455099
044560*----------------------------------------------------------------*04456099
044570                                                                  04457099
044580 3410-POSITION-AT-ERROR.                                          04458099
044590                                                                  04459099
044600     SET DP030-SET-CURSOR-APPL-1                                  04460099
044610                                   TO TRUE.                       04461099
044620     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 04462099
044630                    - PV-TOP-ITEM + 1.                            04463099
044640     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      04464099
044650         CONTINUE                                                 04465099
044660     ELSE                                                         04466099
044670         MOVE -1                   TO MR-SELECTL (PV-SUB)         04467099
044680         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         04468099
044690         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         04469099
044700     END-IF.                                                      04470099
044710*                                                                 04471099
044720     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   04472099
044730                    - PV-TOP-ITEM + 1.                            04473099
044740     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      04474099
044750         CONTINUE                                                 04475099
044760     ELSE                                                         04476099
044770         MOVE -1                   TO MR-SELECTL (PV-SUB)         04477099
044780         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         04478099
044790         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         04479099
044800     END-IF.                                                      04480099
044810                                                                  04481099
044820 EJECT                                                            04482099
044830*----------------------------------------------------------------*04483099
044840*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *04484099
044850*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *04485099
044860*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *04486099
044870*----------------------------------------------------------------*04487099
044880                                                                  04488099
044890 3500-MARK-RANGE-AS-SELECTED.                                     04489099
044900                                                                  04490099
044910     MOVE +1                       TO  ASC-BLK-SUB.               04491099
044920     PERFORM 3510-MARK-SELECTED-INDS                              04492099
044930         VARYING ASC-ITEM-SUB                                     04493099
044940         FROM 1 BY 1                                              04494099
044950         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04495099
044960                                                                  04496099
044970     ADD +1                        TO ASC-BLK-SUB.                04497099
044980     PERFORM 3510-MARK-SELECTED-INDS                              04498099
044990         VARYING ASC-ITEM-SUB                                     04499099
045000         FROM 1 BY 1                                              04500099
045010         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 04501099
045020                                                                  04502099
045030     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               04503099
045040                                   TO  PV-LIST-ITEM-NUMBER.       04504099
045050     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            04505099
045060         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         04506099
045070               PC-ITEMS-PER-PANEL).                               04507099
045080                                                                  04508099
045090     MOVE ASC-START-OF-SELECTED-RANGE                             04509099
045100                                   TO PV-START-OF-SELECTED-RANGE. 04510099
045110     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            04511099
045120         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  04512099
045130               PC-ITEMS-PER-PANEL).                               04513099
045140                                                                  04514099
045150     MOVE ASC-END-OF-SELECTED-RANGE                               04515099
045160                                   TO  PV-END-OF-SELECTED-RANGE.  04516099
045170     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             04517099
045180         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    04518099
045190               PC-ITEMS-PER-PANEL).                               04519099
045200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             04520099
045210         PV-FIRST-BLOCK-IN-ARRAY + 1.                             04521099
045220                                                                  04522099
045230     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    04523099
045240        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        04524099
045250         MOVE +1                   TO ASC-BLK-SUB                 04525099
045260         PERFORM 5100-WRITE-TEMP-STORAGE                          04526099
045270         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         04527099
045280             PV-FIRST-BLOCK-IN-ARRAY - 1                          04528099
045290                                                                  04529099
045300         PERFORM                                                  04530099
045310             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      04531099
045320                   PV-PREV-BLOCK-IN-ARRAY                         04532099
045330             MOVE PV-FIRST-BLOCK-IN-RANGE                         04533099
045340                                   TO PV-BLOCK-NUMBER             04534099
045350             PERFORM 4410-READ-TEMP-STORAGE                       04535099
045360             PERFORM 3510-MARK-SELECTED-INDS                      04536099
045370                 VARYING ASC-ITEM-SUB                             04537099
045380                 FROM 1 BY 1                                      04538099
045390                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04539099
045400             PERFORM 5100-WRITE-TEMP-STORAGE                      04540099
045410             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     04541099
045420         END-PERFORM                                              04542099
045430                                                                  04543099
045440         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         04544099
045450             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     04545099
045460         PERFORM                                                  04546099
045470             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       04547099
045480                   PV-LAST-BLOCK-IN-RANGE                         04548099
045490             MOVE PV-NEXT-BLOCK-IN-ARRAY                          04549099
045500                                   TO PV-BLOCK-NUMBER             04550099
045510             PERFORM 4410-READ-TEMP-STORAGE                       04551099
045520             PERFORM 3510-MARK-SELECTED-INDS                      04552099
045530                 VARYING ASC-ITEM-SUB                             04553099
045540                 FROM 1 BY 1                                      04554099
045550                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          04555099
045560             PERFORM 5100-WRITE-TEMP-STORAGE                      04556099
045570             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      04557099
045580         END-PERFORM                                              04558099
045590                                                                  04559099
045600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             04560099
045610                                   TO PV-BLOCK-NUMBER             04561099
045620         PERFORM 4410-READ-TEMP-STORAGE                           04562099
045630     END-IF.                                                      04563099
045640                                                                  04564099
045650     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 04565099
045660                                      ASC-END-OF-SELECTED-RANGE.  04566099
045670                                                                  04567099
045680 EJECT                                                            04568099
045690*----------------------------------------------------------------*04569099
045700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *04570099
045710*----------------------------------------------------------------*04571099
045720                                                                  04572099
045730 3510-MARK-SELECTED-INDS.                                         04573099
045740                                                                  04574099
045750     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         04575099
045760                                ASC-ITEM-SUB) >                   04576099
045770         ASC-START-OF-SELECTED-RANGE)                             04577099
045780     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         04578099
045790                                ASC-ITEM-SUB) =                   04579099
045800         ASC-START-OF-SELECTED-RANGE)                             04580099
045810                                                                  04581099
045820         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     04582099
045830                                    ASC-ITEM-SUB) <               04583099
045840             ASC-END-OF-SELECTED-RANGE)                           04584099
045850         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     04585099
045860                                    ASC-ITEM-SUB) =               04586099
045870             ASC-END-OF-SELECTED-RANGE)                           04587099
045880                                                                  04588099
045890             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          04589099
045900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   04590099
045910                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   04591099
045920                               TO TRUE                            04592099
045930                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              04593099
045940                               TO TRUE                            04594099
045950                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    04595099
045960             END-IF                                               04596099
045970         END-IF                                                   04597099
045980     END-IF.                                                      04598099
045990                                                                  04599099
046000 EJECT                                                            04600099
046010*----------------------------------------------------------------*04601099
046020*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *04602099
046030*    INITIALIZE ALL COUNTERS AND FLAGS.                          *04603099
046040*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *04604099
046050*    DISPLAY THE PANEL TO USER.                                  *04605099
046060*----------------------------------------------------------------*04606099
046070                                                                  04607099
046080 4000-BUILD-INITIAL-PANEL.                                        04608099
046090                                                                  04609099
046100     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             04610099
046110                                ASC-BLOCK-ENTRIES (2)             04611099
046120                                EXT-BLOCK-ENTRIES (1)             04612099
046130                                EXT-BLOCK-ENTRIES (2).            04613099
046140                                                                  04614099
046150     MOVE +1                 TO ASC-BLK-SUB                       04615099
046160                                ASC-POQ-BLK-SUB                   04616099
046170                                PV-STRING-POINTER-SELECT          04617099
046180                                PV-STRING-POINTER-FROM            04618099
046190                                PV-STRING-POINTER-WHERE.          04619099
046200                                                                  04620099
046210     SET DP030-SET-CURSOR-TRAILER TO TRUE.                        04621099
046220     SET ASC-ITEMS-LEFT-ON-DB                                     04622099
046230                             TO TRUE.                             04623099
046240     SET ASC-ITEMS-LEFT-ON-PO                                     04624099
046250                             TO TRUE.                             04625099
046260     MOVE ASC-MAX-GROUPS     TO PV-GROUPS-TO-READ.                04626099
046270                                                                  04627099
046280     MOVE +0                 TO ASC-ITEM-SUB                      04628099
046290                                ASC-POQ-ITEM-SUB                  04629099
046300                                ASC-POQ-LAST-SUB                  04630099
046310                                ASC-NUMBER-OF-POS-READ            04631099
046320                                ASC-NBR-OF-POS-DISPLAYED          04632099
046330                                ASC-NUMBER-OF-ITEMS-READ          04633099
046340                                ASC-NUMBER-OF-SELECTED-ITEMS      04634099
046350                                ASC-HIGHEST-BLOCK-WRITTEN         04635099
046360                                ASC-START-OF-SELECTED-RANGE       04636099
046370                                ASC-END-OF-SELECTED-RANGE         04637099
046380                                ASC-ITEM-AT-TOP-OF-PANEL.         04638099
046390                                                                  04639099
046400     EXEC CICS ASSIGN                                             04640099
046410               APPLID(PV-SYSTEM-ID)                               04641099
046420     END-EXEC.                                                    04642099
046430                                                                  04643099
046440     MOVE PV-REGION-IND TO PV-QUALIFIER                           04644099
046450                           PV-QUALIFIER-COMMA.                    04645099
046460                                                                  04646099
046470     MOVE SPACES        TO PV-FROM-CLAUSE                         04647099
046480                           PV-SELECT-CLAUSE                       04648099
046490                           PV-WHERE-CLAUSE.                       04649099
046500                                                                  04650099
046510     INITIALIZE  ASC-TFSC                                         04651099
046520                 ASC-TTTC                                         04652099
046530                 ASC-TTVC                                         04653099
046540                 ASC-TDOR                                         04654099
046550                 ASC-TDRC                                         04655099
046560                 ASC-TURC                                         04656099
046570                 ASC-TUOR.                                        04657099
046580                                                                  04658099
046590     PERFORM 4100-BUILD-DYNAMIC-CURSOR.                           04659099
046600     PERFORM 4150-COMBINE-DYNAMIC-SQL.                            04660099
046610     PERFORM 4151-WRITE-JCL-QUEUE.                                04661099
046620                                                                  04662099
046630     PERFORM 4010-DECLARE-CURSOR.                                 04663099
046640     PERFORM 4020-PREPARE-CURSOR.                                 04664099
046650                                                                  04665099
046660     PERFORM 4030-OPEN-CURSOR.                                    04666099
046670                                                                  04667099
046680     PERFORM 10000-REBUILD-CONTROL-TABLES.                        04668099
046690                                                                  04669099
046700     PERFORM 4301-READ-ITEMS-FROM-DY-CURSOR                       04670099
046710        UNTIL ASC-NO-ITEMS-LEFT-ON-PO                             04671099
046720                                                                  04672099
046730*----------------------------------------------------------------*04673099
046740* SELF DOCUMENT TASK#1                                           *04674099
046750*----------------------------------------------------------------*04675099
046760     IF ASC-WRITE-TO-CSSL                                         04676099
046770        PERFORM 10001-ASK-CICS-FOR-TIME                           04677099
046780        PERFORM 10005-FORMAT-CICS-TIME                            04678099
046790        PERFORM 10004-ASK-DURATION-OF-TASK                        04679099
046800        MOVE ASC-TASK-DURATION TO ASC-TASK-TIME                   04680099
046810        PERFORM 10007-STRING-TIME-MESSAGE                         04681099
046820        PERFORM 10006-SAVE-LAST-TASK-TIME                         04682099
046830        ADD 1 TO ASC-TASK-ID.                                     04683099
046840                                                                  04684099
046850     PERFORM 4040-CLOSE-CURSOR.                                   04685099
046860                                                                  04686099
046870     IF  ASC-NUMBER-OF-POS-READ = ZERO                            04687099
046880         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    04688099
046890         SET DP020-MSG-FATAL   TO  TRUE                           04689099
046900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               04690099
046910     ELSE                                                         04691099
046920         MOVE ASC-NUMBER-OF-POS-READ TO                           04692099
046930                  ASC-NBR-OF-POS-DISPLAYED                        04693099
046940         MOVE +0 TO ASC-POQ-LAST-ITEM                             04694099
046950         MOVE +1 TO ASC-POQ-LAST-BLK                              04695099
046960         PERFORM 4005-BUILD-ADDITIONAL-PANELS                     04696099
046970         MOVE +1 TO PV-TOP-ITEM                                   04697099
046980         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      04698099
046990             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                04699099
047000             SET DP020-MSG-FATAL   TO  TRUE                       04700099
047010             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           04701099
047020         ELSE                                                     04702099
047030             MOVE 1                TO ASC-BLK-SUB                 04703099
047040                                      PV-BLOCK-NUMBER             04704099
047050             PERFORM 4410-READ-TEMP-STORAGE                       04705099
047060             IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1         04706099
047070                 MOVE 2            TO ASC-BLK-SUB                 04707099
047080                                      PV-BLOCK-NUMBER             04708099
047090                 PERFORM 4410-READ-TEMP-STORAGE                   04709099
047100             END-IF                                               04710099
047110             MOVE -1               TO MR-SELECTL (1)              04711099
047120             SET DP030-SET-CURSOR-APPL-1                          04712099
047130                                   TO TRUE                        04713099
047140             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04714099
047150         END-IF                                                   04715099
047160     END-IF.                                                      04716099
047170                                                                  04717099
047180 EJECT                                                            04718099
047190*----------------------------------------------------------------*04719099
047200*    THE LOGIC IN THIS PARAGRAPH IS VERY SIMILAR TO THAT IN THE  *04720099
047210*    'BUILD INITIAL PANEL' PARAGRAPH, EXCEPT THAT THE VARIABLES  *04721099
047220*    ARE NOT INITIALIZED.                                        *04722099
047230*----------------------------------------------------------------*04723099
047240                                                                  04724099
047250 4005-BUILD-ADDITIONAL-PANELS.                                    04725099
047260                                                                  04726099
047270     PERFORM 10000-REBUILD-CONTROL-TABLES.                        04727099
047280                                                                  04728099
047290     SET ASC-WRITE-EXTENDED-STORAGE TO TRUE.                      04729099
047300                                                                  04730099
047310     MOVE ASC-POQ-LAST-ITEM TO ASC-POQ-ITEM-SUB.                  04731099
047320     MOVE ASC-POQ-LAST-BLK TO  ASC-POQ-BLK-SUB.                   04732099
047330                                                                  04733099
047340     PERFORM 4401-RELOAD-EXTENDED-STORAGE.                        04734099
047350     PERFORM 4411-READ-PO-QUEUE-STORAGE.                          04735099
047360                                                                  04736099
047370     PERFORM 4300-READ-ITEMS-FROM-DB                              04737099
047380         VARYING PV-TEMP-NUM                                      04738099
047390         FROM 1 BY 1                                              04739099
047400         UNTIL PV-TEMP-NUM > PV-GROUPS-TO-READ                    04740099
047410            OR ASC-NO-ITEMS-LEFT-ON-DB.                           04741099
047420                                                                  04742099
047430*----------------------------------------------------------------*04743099
047440* SELF DOCUMENT TASK#2                                           *04744099
047450*----------------------------------------------------------------*04745099
047460     IF ASC-WRITE-TO-CSSL                                         04746099
047470        PERFORM 10001-ASK-CICS-FOR-TIME                           04747099
047480        PERFORM 10005-FORMAT-CICS-TIME                            04748099
047490        PERFORM 10004-ASK-DURATION-OF-TASK                        04749099
047500        MOVE ASC-TASK-DURATION TO ASC-TASK-TIME                   04750099
047510        PERFORM 10007-STRING-TIME-MESSAGE                         04751099
047520        PERFORM 10006-SAVE-LAST-TASK-TIME                         04752099
047530        ADD 1 TO ASC-TASK-ID                                      04753099
047540                                                                  04754099
047550*----------------------------------------------------------------*04755099
047560* SELF DOCUMENT TASK#3-5                                         *04756099
047570*----------------------------------------------------------------*04757099
047580     IF ASC-WRITE-TO-CSSL AND ASC-POQ-BLK-SUB > 0                 04758099
047590                                                                  04759099
047600        IF ASC-DB-LOAD1-CNT > 0                                   04760099
047610           DIVIDE ASC-DB-LOAD1-SECONDS BY ASC-POQ-BLK-SUB         04761099
047620                     GIVING ASC-DB-LOAD1-AVG                      04762099
047630        ELSE                                                      04763099
047640           MOVE 0  TO ASC-DB-LOAD1-AVG                            04764099
047650        END-IF                                                    04765099
047660        MOVE ASC-DB-LOAD1-AVG TO ASC-TASK-TIME                    04766099
047670        PERFORM 10007-STRING-TIME-MESSAGE                         04767099
047680        ADD 1 TO ASC-TASK-ID                                      04768099
047690        INITIALIZE ASC-DB-LOAD1-CNT                               04769099
047700        INITIALIZE ASC-DB-LOAD1-SECONDS                           04770099
047710                                                                  04771099
047720        IF ASC-DB-LOAD2-CNT > 0                                   04772099
047730           DIVIDE ASC-DB-LOAD2-SECONDS BY ASC-POQ-BLK-SUB         04773099
047740                     GIVING ASC-DB-LOAD2-AVG                      04774099
047750        ELSE                                                      04775099
047760           MOVE 0  TO ASC-DB-LOAD2-AVG                            04776099
047770        END-IF                                                    04777099
047780        MOVE ASC-DB-LOAD2-AVG TO ASC-TASK-TIME                    04778099
047790        PERFORM 10007-STRING-TIME-MESSAGE                         04779099
047800        ADD 1 TO ASC-TASK-ID                                      04780099
047810        INITIALIZE ASC-DB-LOAD2-CNT                               04781099
047820        INITIALIZE ASC-DB-LOAD2-SECONDS                           04782099
047830                                                                  04783099
047840        IF ASC-DB-LOAD3-CNT > 0                                   04784099
047850           DIVIDE ASC-DB-LOAD3-SECONDS BY ASC-POQ-BLK-SUB         04785099
047860                     GIVING ASC-DB-LOAD3-AVG                      04786099
047870        ELSE                                                      04787099
047880           MOVE 0  TO ASC-DB-LOAD3-AVG                            04788099
047890        END-IF                                                    04789099
047900        MOVE ASC-DB-LOAD3-AVG TO ASC-TASK-TIME                    04790099
047910        PERFORM 10007-STRING-TIME-MESSAGE                         04791099
047920        MOVE ASC-POQ-BLK-SUB TO ASC-GROUPS-LOADED                 04792099
047930        ADD 1 TO ASC-TASK-ID                                      04793099
047940        INITIALIZE ASC-DB-LOAD3-CNT                               04794099
047950        INITIALIZE ASC-DB-LOAD3-SECONDS                           04795099
047960     END-IF.                                                      04796099
047970                                                                  04797099
047980     MOVE ASC-POQ-ITEM-SUB TO ASC-POQ-LAST-ITEM.                  04798099
047990     MOVE ASC-POQ-BLK-SUB TO ASC-POQ-LAST-BLK.                    04799099
048000                                                                  04800099
048010     SET ASC-DONT-WRITE-EXT-STORAGE TO TRUE.                      04801099
048020                                                                  04802099
048030 EJECT                                                            04803099
048040*----------------------------------------------------------------*04804099
048050* DECLARE THE CURSOR FOR DYNAMIC SQL CALL                        *04805099
048060*----------------------------------------------------------------*04806099
048070                                                                  04807099
048080 4010-DECLARE-CURSOR.                                             04808099
048090     EXEC SQL                                                     04809099
048100         DECLARE PO-CSR CURSOR FOR                                04810099
048110                 PO-SELECT                                        04811099
048120     END-EXEC.                                                    04812099
048130 4010-EXIT.                                                       04813099
048140     EXIT.                                                        04814099
048150 EJECT                                                            04815099
048160*----------------------------------------------------------------*04816099
048170* OPEN THE DYNAMIC CURSOR                                        *04817099
048180*----------------------------------------------------------------*04818099
048190                                                                  04819099
048200 4020-PREPARE-CURSOR.                                             04820099
048210     EXEC SQL                                                     04821099
048220         PREPARE PO-SELECT FROM :PV-SQL-STMT                      04822099
048230     END-EXEC.                                                    04823099
048240                                                                  04824099
048250     EVALUATE TRUE                                                04825099
048260         WHEN SQLCODE = +0                                        04826099
048270           CONTINUE                                               04827099
048280         WHEN SQLCODE = -206                                      04828099
048290           SET PS-206-PURITM         TO TRUE                      04829099
048300         WHEN SQLWARN0 NOT = SPACE                                04830099
048310         WHEN SQLCODE  NOT = 0                                    04831099
048320              MOVE '4020-PREPARE-CURSOR'                          04832099
048330                               TO DP013-PARAGRAPH                 04833099
048340              MOVE 'PREPARE PO-CSR    '                           04834099
048350                               TO DP013-MESSAGE-TEXT (1)          04835099
048360              MOVE SQLCA       TO DP013-SQLCA                     04836099
048370              MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)        04837099
048380              MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)        04838099
048390              MOVE 'TPLNSHP'   TO DP013-DB2-TABLE-NAME (3)        04839099
048400              MOVE 'TSTATCD'   TO DP013-DB2-TABLE-NAME (4)        04840099
048410              SET DP013-DB2-ABEND                                 04841099
048420                               TO TRUE                            04842099
048430              PERFORM DP013-0000-PROCESS-ABEND                    04843099
048440     END-EVALUATE.                                                04844099
048450 EJECT                                                            04845099
048460*----------------------------------------------------------------*04846099
048470* OPEN THE DYNAMIC CURSOR                                        *04847099
048480*----------------------------------------------------------------*04848099
048490                                                                  04849099
048500 4030-OPEN-CURSOR.                                                04850099
048510     PERFORM                                                      04851099
048520         WITH TEST AFTER                                          04852099
048530         VARYING PV-RETRY-COUNTER                                 04853099
048540         FROM 1 BY 1                                              04854099
048550         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               04855099
048560            OR (SQLCODE = +0))                                    04856099
048570                                                                  04857099
048580         EXEC SQL                                                 04858099
048590             OPEN PO-CSR                                          04859099
048600         END-EXEC                                                 04860099
048610                                                                  04861099
048620         EVALUATE TRUE                                            04862099
048630             WHEN SQLCODE = +0                                    04863099
048640                  CONTINUE                                        04864099
048650             WHEN SQLCODE = -904                                  04865099
048660             WHEN SQLCODE = -913                                  04866099
048670                  CONTINUE                                        04867099
048680             WHEN SQLWARN0 NOT = SPACE                            04868099
048690             WHEN SQLCODE  NOT = +0                               04869099
048700                  MOVE '4030-OPEN-CURSOR'                         04870099
048710                                   TO DP013-PARAGRAPH             04871099
048720                  MOVE 'OPEN PO-CSR CURSOR'                       04872099
048730                                   TO DP013-MESSAGE-TEXT (1)      04873099
048740                  MOVE SQLCA       TO DP013-SQLCA                 04874099
048750                  MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)    04875099
048760                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)    04876099
048770                  MOVE 'TPLNSHP'   TO DP013-DB2-TABLE-NAME (3)    04877099
048780                  MOVE 'TENTNME'   TO DP013-DB2-TABLE-NAME (4)    04878099
048790                  SET DP013-DB2-ABEND                             04879099
048800                                   TO TRUE                        04880099
048810                  PERFORM DP013-0000-PROCESS-ABEND                04881099
048820         END-EVALUATE                                             04882099
048830     END-PERFORM.                                                 04883099
048840                                                                  04884099
048850     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        04885099
048860         MOVE '4030-OPEN-CURSOR'   TO DP013-PARAGRAPH             04886099
048870         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              04887099
048880                                   TO DP013-MESSAGE-TEXT (1)      04888099
048890         MOVE SQLCA                TO DP013-SQLCA                 04889099
048900         SET DP013-DB2-ABEND       TO TRUE                        04890099
048910         PERFORM DP013-0000-PROCESS-ABEND                         04891099
048920     END-IF.                                                      04892099
048930 EJECT                                                            04893099
048940*----------------------------------------------------------------*04894099
048950* CLOSE THE DYNAMIC CURSOR                                       *04895099
048960*----------------------------------------------------------------*04896099
048970                                                                  04897099
048980 4040-CLOSE-CURSOR.                                               04898099
048990                                                                  04899099
049000     EXEC SQL                                                     04900099
049010         CLOSE PO-CSR                                             04901099
049020     END-EXEC.                                                    04902099
049030                                                                  04903099
049040     EVALUATE TRUE                                                04904099
049050         WHEN SQLCODE = +0                                        04905099
049060              CONTINUE                                            04906099
049070         WHEN SQLWARN0 NOT = SPACE                                04907099
049080         WHEN SQLCODE  NOT = +0                                   04908099
049090              MOVE '4040-CLOSE-CURSOR'                            04909099
049100                                   TO DP013-PARAGRAPH             04910099
049110              MOVE 'CLOSE PO-CSR CURSOR'                          04911099
049120                                   TO DP013-MESSAGE-TEXT (1)      04912099
049130              MOVE SQLCA           TO DP013-SQLCA                 04913099
049140              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    04914099
049150              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    04915099
049160              MOVE 'TPLNSHP'       TO DP013-DB2-TABLE-NAME (3)    04916099
049170              MOVE 'TENTNME'       TO DP013-DB2-TABLE-NAME (4)    04917099
049180              SET DP013-DB2-ABEND  TO TRUE                        04918099
049190              PERFORM DP013-0000-PROCESS-ABEND                    04919099
049200     END-EVALUATE.                                                04920099
049210 EJECT                                                            04921099
049220*----------------------------------------------------------------*04922099
049230*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *04923099
049240*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *04924099
049250*----------------------------------------------------------------*04925099
049260                                                                  04926099
049270 4100-BUILD-DYNAMIC-CURSOR.                                       04927099
049280                                                                  04928099
049290     IF ASC-SORT1-BY-IND = 'V'                                    04929099
049300      OR ASC-SORT2-BY-IND = 'V'                                   04930099
049310        SET PS-USE-TPURITM TO TRUE                                04931099
049320        SET PS-USE-XLT-SKU TO TRUE                                04932099
049330        SET PS-USE-XLT-VND-STYL TO TRUE                           04933099
049340        STRING                                                    04934099
049350           PV-BUILD-SELECT-STMT-VS       DELIMITED BY SIZE        04935099
049360        INTO                                                      04936099
049370           PV-SELECT-CLAUSE                                       04937099
049380        WITH                                                      04938099
049390           POINTER PV-STRING-POINTER-SELECT                       04939099
049400        MOVE LENGTH OF PV-BUILD-SELECT-STMT-VS                    04940099
049410                                TO PV-SELECT-BYTES                04941099
049420     ELSE                                                         04942099
049430        STRING                                                    04943099
049440           PV-BUILD-SELECT-STMT          DELIMITED BY SIZE        04944099
049450        INTO                                                      04945099
049460           PV-SELECT-CLAUSE                                       04946099
049470        WITH                                                      04947099
049480           POINTER PV-STRING-POINTER-SELECT                       04948099
049490        MOVE LENGTH OF PV-BUILD-SELECT-STMT                       04949099
049500                                TO PV-SELECT-BYTES.               04950099
049510                                                                  04951099
049520     IF  ASC-DEPT-NBR > ZEROES                                    04952099
049530         PERFORM 4101-DEPT-NBR.                                   04953099
049540                                                                  04954099
049550     IF  ASC-KEY-PO-NBR > ZEROES                                  04955099
049560         PERFORM 4102-PO-NBR.                                     04956099
049570                                                                  04957099
049580     IF  ASC-PO-TYP-CDE > SPACES                                  04958099
049590         PERFORM 4103-PO-TYP-CDE.                                 04959099
049600                                                                  04960099
049610     IF  ASC-QUOTA-CATEGORY > SPACES                              04961099
049620         PERFORM 4103-QUOTA-CATEGORY.                             04962099
049630                                                                  04963099
049640     IF  ASC-STATUS-CDE > SPACES                                  04964099
049650         PERFORM 4104-STATUS-CDE.                                 04965099
049660                                                                  04966099
049670     IF  ASC-STATUS-CLS > SPACES                                  04967099
049680         PERFORM 4105-STATUS-CLS.                                 04968099
049690                                                                  04969099
049700     IF  ASC-FOB-CDE > SPACES                                     04970099
049710         PERFORM 4106-FOB-CDE.                                    04971099
049720                                                                  04972099
049730     IF  ASC-STR-NBR > ZEROES                                     04973099
049740         SET PS-USE-TMESTDS TO TRUE                               04974099
049750         PERFORM 4103-STR-NBR.                                    04975099
049760                                                                  04976099
049770     IF  ASC-PIC-AD-IND > SPACES                                  04977099
049780         SET PS-USE-TPURITM TO TRUE                               04978099
049790         PERFORM 4107-PIC-AD-IND.                                 04979099
049800                                                                  04980099
049810     IF  ASC-NEW-STR-IND > SPACES                                 04981099
049820         PERFORM 4108-NEW-STR-IND.                                04982099
049830                                                                  04983099
049840     IF TR195-CLASS-RANGE                                         04984099
049850        IF TR195-CLASS > ZEROS                                    04985099
049860            SET PS-USE-TPURITM TO TRUE                            04986099
049870            PERFORM 4110-CLASS                                    04987099
049880        END-IF                                                    04988099
049890     END-IF.                                                      04989099
049900                                                                  04990099
049910     IF ASC-SUBCLASS > ZEROES                                     04991099
049920        SET PS-USE-TPURITM TO TRUE                                04992099
049930        PERFORM 4109-SUBCLASS                                     04993099
049940     END-IF.                                                      04994099
049950                                                                  04995099
049960     IF ASC-SKU > ZEROES                                          04996099
049970        SET PS-USE-TSKXREF TO TRUE                                04997099
049980        SET PS-USE-TPURITM TO TRUE                                04998099
049990        PERFORM 4111-SKU                                          04999099
050000     END-IF.                                                      05000099
050010                                                                  05001099
050020     IF  ASC-AD-EVNT-DTE > SPACES                                 05002099
050030         SET PS-USE-TPURITM TO TRUE                               05003099
050040         PERFORM 4112-AD-EVNT-DTE.                                05004099
050050                                                                  05005099
050060     IF  ASC-OTB-PER-NBR-BEG > SPACES AND                         05006099
050070         ASC-OTB-PER-NBR-END > SPACES                             05007099
050080         IF ASC-OTB-PER-NBR-BEG = ASC-OTB-PER-NBR-END             05008099
050090            PERFORM 4113-OTB-PER-ONE                              05009099
050100         ELSE                                                     05010099
050110            PERFORM 4114-OTB-PER-NBR-BEG-END                      05011099
050120         END-IF                                                   05012099
050130     ELSE                                                         05013099
050140        IF  ASC-OTB-PER-NBR-BEG > SPACES                          05014099
050150            MOVE HIGH-VALUES TO ASC-OTB-PER-NBR-END               05015099
050160            PERFORM 4115-OTB-PER-BEG                              05016099
050170        ELSE                                                      05017099
050180           IF  ASC-OTB-PER-NBR-END > SPACES                       05018099
050190               MOVE LOW-VALUES  TO ASC-OTB-PER-NBR-BEG            05019099
050200               PERFORM 4116-OTB-PER-END                           05020099
050210           END-IF                                                 05021099
050220        END-IF                                                    05022099
050230     END-IF.                                                      05023099
050240                                                                  05024099
050250     IF  ASC-XFACT-BEF-DTE > SPACES AND                           05025099
050260         ASC-XFACT-END-DTE > SPACES                               05026099
050270       IF ASC-DEPT-NBR > ZEROES                                   05027099
050280        OR ASC-KEY-PO-NBR > ZEROES                                05028099
050290         IF ASC-XFACT-BEF-DTE =                                   05029099
050300            ASC-XFACT-END-DTE                                     05030099
050310            PERFORM 4117-XFACT-DTE-ONE                            05031099
050320         ELSE                                                     05032099
050330            PERFORM 4118-XFACT-BEF-END-DTE                        05033099
050340         END-IF                                                   05034099
050350       ELSE                                                       05035099
050360         SET PS-USE-XFC-INLINE TO TRUE                            05036099
050370       END-IF                                                     05037099
050380     ELSE                                                         05038099
050390        IF  ASC-XFACT-BEF-DTE > SPACES                            05039099
050400            MOVE '9999-09-09' TO ASC-XFACT-END-DTE                05040099
050410            PERFORM 4119-XFACT-BEF-DTE                            05041099
050420        ELSE                                                      05042099
050430           IF  ASC-XFACT-END-DTE > SPACES                         05043099
050440               MOVE '0001-01-01' TO ASC-XFACT-BEF-DTE             05044099
050450               PERFORM 4120-XFACT-END-DTE                         05045099
050460           END-IF                                                 05046099
050470        END-IF                                                    05047099
050480     END-IF.                                                      05048099
050490                                                                  05049099
050500     IF  ASC-ENT-NAME-DESC > SPACES                               05050099
050510         SET PS-USE-TENTNME TO TRUE                               05051099
050520         PERFORM 4121-ENT-NAME-DESC.                              05052099
050530                                                                  05053099
050540     IF  ASC-VEND-STYL-NME > SPACES                               05054099
050550         SET PS-USE-TPURITM TO TRUE                               05055099
050560         SET PS-USE-XLT-SKU TO TRUE                               05056099
050570         SET PS-USE-XLT-VND-STYL TO TRUE                          05057099
050580         PERFORM 4122-VEND-STYL-NME.                              05058099
050590                                                                  05059099
050600     IF  ASC-MAKER-NME > SPACES                                   05060099
050610         SET PS-USE-MAKER-NME TO TRUE                             05061099
050620         PERFORM 4123-MAKER-NME.                                  05062099
050630                                                                  05063099
050640     IF  ASC-PRE-PACK-IND > SPACES                                05064099
050650       OR ASC-PACK-BY-STORE-IND = 'Y'                             05065099
050660          IF ASC-PACK-BY-STORE-IND = 'Y'                          05066099
050670             MOVE SPACES   TO ASC-PRE-PACK-IND                    05067099
050680          END-IF                                                  05068099
050690          PERFORM 4124-PPI-IND                                    05069099
050700     END-IF.                                                      05070099
050710                                                                  05071099
050720     IF  ASC-SHPDT-BEF-DTE > SPACES AND                           05072099
050730         ASC-SHPDT-END-DTE > SPACES                               05073099
050740       IF ASC-DEPT-NBR > ZEROES                                   05074099
050750        OR ASC-KEY-PO-NBR > ZEROES                                05075099
050760         IF ASC-SHPDT-BEF-DTE =                                   05076099
050770            ASC-SHPDT-END-DTE                                     05077099
050780            PERFORM 4125-SHPDT-DTE-ONE                            05078099
050790         ELSE                                                     05079099
050800            PERFORM 4126-SHPDT-BEF-END-DTE                        05080099
050810         END-IF                                                   05081099
050820       ELSE                                                       05082099
050830         SET PS-USE-DSB-INLINE TO TRUE                            05083099
050840       END-IF                                                     05084099
050850     ELSE                                                         05085099
050860        IF  ASC-SHPDT-BEF-DTE > SPACES                            05086099
050870            MOVE '9999-09-09' TO ASC-SHPDT-END-DTE                05087099
050880            PERFORM 4127-SHPDT-BEF-DTE                            05088099
050890        ELSE                                                      05089099
050900           IF  ASC-SHPDT-END-DTE > SPACES                         05090099
050910               MOVE '0001-01-01' TO ASC-SHPDT-BEF-DTE             05091099
050920               PERFORM 4128-SHPDT-END-DTE                         05092099
050930           END-IF                                                 05093099
050940        END-IF                                                    05094099
050950     END-IF.                                                      05095099
050960                                                                  05096099
050970     IF  ASC-POE-CDE > SPACES                                     05097099
050980         PERFORM 4129-POE-CDE.                                    05098099
050990                                                                  05099099
051000     IF  ASC-EDI-IND > SPACES                                     05100099
051010         PERFORM 4130-EDI-IND.                                    05101099
051020                                                                  05102099
051030     IF  ASC-DIRECT-STORE-IND > SPACES                            05103099
051040         PERFORM 4131-DIR-STORE-IND.                              05104099
051050                                                                  05105099
051060     IF  ASC-KEY-CNTRY-ORG > SPACES                               05106099
051070         PERFORM 4132-CNTRY-ORG.                                  05107099
051080                                                                  05108099
051090     IF  ASC-KEY-CNTRY-PLC > SPACES                               05109099
051100         PERFORM 4133-CNTRY-PLC.                                  05110099
051110                                                                  05111099
051120     IF  ASC-SEASONAL-SET > SPACES                                05112099
051130         PERFORM 4134-SEASONAL-SET.                               05113099
051140                                                                  05114099
051150     IF  ASC-DMM > SPACES                                         05115099
051160         SET PS-USE-TMDSEAR TO TRUE                               05116099
051170         PERFORM 4135-DMM.                                        05117099
051180                                                                  05118099
051190     IF  ASC-GROUP-CDE > SPACES                                   05119099
051200         SET PS-USE-TUPC TO TRUE                                  05120099
051210         SET PS-USE-TPURITM TO TRUE                               05121099
051220         SET PS-USE-TSKXREF TO TRUE                               05122099
051230         PERFORM 4136-GROUP-CDE.                                  05123099
051240                                                                  05124099
051250     STRING                                                       05125099
051260         ' AND A.VER_STATUS_CDE = '           DELIMITED BY SIZE,  05126099
051270         PC-QUOTE                             DELIMITED BY SIZE,  05127099
051280         'A'                                  DELIMITED BY SIZE,  05128099
051290         PC-QUOTE                             DELIMITED BY SIZE,  05129099
051300                                                                  05130099
051310         ' AND C.VER_STATUS_CDE = '           DELIMITED BY SIZE,  05131099
051320         PC-QUOTE                             DELIMITED BY SIZE,  05132099
051330         'A'                                  DELIMITED BY SIZE,  05133099
051340         PC-QUOTE                             DELIMITED BY SIZE,  05134099
051350                                                                  05135099
051360         ' AND A.PO_CATEG_CDE = '             DELIMITED BY SIZE,  05136099
051370         PC-QUOTE                             DELIMITED BY SIZE,  05137099
051380         'MR'                                 DELIMITED BY SIZE,  05138099
051390         PC-QUOTE                             DELIMITED BY SIZE,  05139099
051400                                                                  05140099
051410         ' AND A.PO_NBR = C.PO_NBR'           DELIMITED BY SIZE,  05141099
051420                                                                  05142099
051430         ' AND E.STATUS_TYP_CDE = '           DELIMITED BY SIZE,  05143099
051440         PC-QUOTE                             DELIMITED BY SIZE,  05144099
051450         'P'                                  DELIMITED BY SIZE,  05145099
051460         PC-QUOTE                             DELIMITED BY SIZE,  05146099
051470                                                                  05147099
051480         ' AND A.STATUS_CDE = E.STATUS_CDE'   DELIMITED BY SIZE   05148099
051490     INTO                                                         05149099
051500         PV-WHERE-CLAUSE                                          05150099
051510     WITH                                                         05151099
051520         POINTER PV-STRING-POINTER-WHERE.                         05152099
051530                                                                  05153099
051540     IF PS-USE-TPURITM                                            05154099
051550        STRING                                                    05155099
051560            ' AND B.VER_STATUS_CDE = '        DELIMITED BY SIZE,  05156099
051570            PC-QUOTE                          DELIMITED BY SIZE,  05157099
051580            'A'                               DELIMITED BY SIZE,  05158099
051590            PC-QUOTE                          DELIMITED BY SIZE,  05159099
051600                                                                  05160099
051610            ' AND A.PO_NBR = B.PO_NBR'        DELIMITED BY SIZE   05161099
051620        INTO                                                      05162099
051630            PV-WHERE-CLAUSE                                       05163099
051640        WITH                                                      05164099
051650            POINTER PV-STRING-POINTER-WHERE.                      05165099
051660                                                                  05166099
051670     IF PS-USE-TENTNME                                            05167099
051680        STRING                                                    05168099
051690            ' AND A.ENT_ID = D.ENT_ID'        DELIMITED BY SIZE   05169099
051700        INTO                                                      05170099
051710            PV-WHERE-CLAUSE                                       05171099
051720        WITH                                                      05172099
051730            POINTER PV-STRING-POINTER-WHERE.                      05173099
051740                                                                  05174099
051750     IF PS-USE-MAKER-NME                                          05175099
051760        STRING                                                    05176099
051770         ' AND A.IMPRT_FCTRY_ID = M.ENT_ID'     DELIMITED BY SIZE 05177099
051780         ' AND M.TYPE_CDE = '                   DELIMITED BY SIZE,05178099
051790         PC-QUOTE                               DELIMITED BY SIZE,05179099
051800         '01'                                   DELIMITED BY SIZE,05180099
051810         PC-QUOTE                               DELIMITED BY SIZE,05181099
051820        INTO                                                      05182099
051830            PV-WHERE-CLAUSE                                       05183099
051840        WITH                                                      05184099
051850            POINTER PV-STRING-POINTER-WHERE.                      05185099
051860                                                                  05186099
051870     IF PS-USE-TMDSEAR                                            05187099
051880        STRING                                                    05188099
051890            ' AND A.DEPT_NBR = F.DEPT_NBR'    DELIMITED BY SIZE   05189099
051900        INTO                                                      05190099
051910            PV-WHERE-CLAUSE                                       05191099
051920        WITH                                                      05192099
051930            POINTER PV-STRING-POINTER-WHERE.                      05193099
051940                                                                  05194099
051950     IF PS-USE-TUPC                                               05195099
051960        STRING                                                    05196099
051970         ' AND H.INTR_UPC_ID = G.INTR_UPC_ID'   DELIMITED BY SIZE 05197099
051980         ' AND G.UPC_TYP_CDE = '                DELIMITED BY SIZE,05198099
051990         PC-QUOTE                               DELIMITED BY SIZE,05199099
052000         'I'                                    DELIMITED BY SIZE,05200099
052010         PC-QUOTE                               DELIMITED BY SIZE,05201099
052020        INTO                                                      05202099
052030            PV-WHERE-CLAUSE                                       05203099
052040        WITH                                                      05204099
052050            POINTER PV-STRING-POINTER-WHERE.                      05205099
052060                                                                  05206099
052070     IF PS-USE-TSKXREF                                            05207099
052080        STRING                                                    05208099
052090         ' AND B.ITM_NBR = H.ITM_NBR'           DELIMITED BY SIZE 05209099
052100        INTO                                                      05210099
052110            PV-WHERE-CLAUSE                                       05211099
052120        WITH                                                      05212099
052130            POINTER PV-STRING-POINTER-WHERE.                      05213099
052140                                                                  05214099
052150     IF PS-USE-XLT-SKU                                            05215099
052160        STRING                                                    05216099
052170         ' AND B.ITM_NBR = J.ITM_NBR'           DELIMITED BY SIZE 05217099
052180        INTO                                                      05218099
052190            PV-WHERE-CLAUSE                                       05219099
052200        WITH                                                      05220099
052210            POINTER PV-STRING-POINTER-WHERE.                      05221099
052220                                                                  05222099
052230     IF PS-USE-XLT-VND-STYL                                       05223099
052240        STRING                                                    05224099
052250         ' AND J.STYL_ID = K.STYL_ID'           DELIMITED BY SIZE 05225099
052260        INTO                                                      05226099
052270            PV-WHERE-CLAUSE                                       05227099
052280        WITH                                                      05228099
052290            POINTER PV-STRING-POINTER-WHERE.                      05229099
052300                                                                  05230099
052310     IF PS-USE-TMESTDS                                            05231099
052320        STRING                                                    05232099
052330            ' AND A.PO_NBR = L.PO_NBR'      DELIMITED BY SIZE     05233099
052340        INTO                                                      05234099
052350            PV-WHERE-CLAUSE                                       05235099
052360        WITH                                                      05236099
052370            POINTER PV-STRING-POINTER-WHERE.                      05237099
052380                                                                  05238099
052390* THE FOLLOWING CODE WILL SETUP THE FROM CLAUSE                   05239099
052400                                                                  05240099
052410     STRING                                                       05241099
052420         PV-TABLE-QUALIFIER                   DELIMITED BY SIZE,  05242099
052430         'TPURCHS A'                          DELIMITED BY SIZE,  05243099
052440         PV-TABLE-QUALIFIER-COMMA             DELIMITED BY SIZE,  05244099
052450         'TPLNSHP C'                          DELIMITED BY SIZE,  05245099
052460         PV-TABLE-QUALIFIER-COMMA             DELIMITED BY SIZE,  05246099
052470         'TSTATCD E'                          DELIMITED BY SIZE   05247099
052480        INTO                                                      05248099
052490            PV-FROM-CLAUSE                                        05249099
052500        WITH                                                      05250099
052510            POINTER PV-STRING-POINTER-FROM.                       05251099
052520                                                                  05252099
052530     IF PS-USE-TPURITM                                            05253099
052540        STRING                                                    05254099
052550            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05255099
052560            'TPURITM B'                       DELIMITED BY SIZE   05256099
052570        INTO                                                      05257099
052580            PV-FROM-CLAUSE                                        05258099
052590        WITH                                                      05259099
052600            POINTER PV-STRING-POINTER-FROM.                       05260099
052610                                                                  05261099
052620     IF PS-USE-TENTNME                                            05262099
052630        STRING                                                    05263099
052640            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05264099
052650            'TENTNME D'                       DELIMITED BY SIZE   05265099
052660        INTO                                                      05266099
052670            PV-FROM-CLAUSE                                        05267099
052680        WITH                                                      05268099
052690            POINTER PV-STRING-POINTER-FROM.                       05269099
052700                                                                  05270099
052710     IF PS-USE-MAKER-NME                                          05271099
052720        STRING                                                    05272099
052730            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05273099
052740            'TENTNME M'                       DELIMITED BY SIZE   05274099
052750        INTO                                                      05275099
052760            PV-FROM-CLAUSE                                        05276099
052770        WITH                                                      05277099
052780            POINTER PV-STRING-POINTER-FROM.                       05278099
052790                                                                  05279099
052800     IF PS-USE-TMDSEAR                                            05280099
052810        STRING                                                    05281099
052820            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05282099
052830            'TMDSEAR F'                       DELIMITED BY SIZE   05283099
052840        INTO                                                      05284099
052850            PV-FROM-CLAUSE                                        05285099
052860        WITH                                                      05286099
052870            POINTER PV-STRING-POINTER-FROM.                       05287099
052880                                                                  05288099
052890     IF PS-USE-TUPC                                               05289099
052900        STRING                                                    05290099
052910            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05291099
052920            'TUPC G'                          DELIMITED BY SIZE   05292099
052930        INTO                                                      05293099
052940            PV-FROM-CLAUSE                                        05294099
052950        WITH                                                      05295099
052960            POINTER PV-STRING-POINTER-FROM.                       05296099
052970                                                                  05297099
052980     IF PS-USE-TSKXREF                                            05298099
052990        STRING                                                    05299099
053000            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05300099
053010            'TSKXREF H'                       DELIMITED BY SIZE   05301099
053020        INTO                                                      05302099
053030            PV-FROM-CLAUSE                                        05303099
053040        WITH                                                      05304099
053050            POINTER PV-STRING-POINTER-FROM.                       05305099
053060                                                                  05306099
053070     IF PS-USE-XLT-SKU                                            05307099
053080        STRING                                                    05308099
053090            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05309099
053100            'XLT_SKU J'                       DELIMITED BY SIZE   05310099
053110        INTO                                                      05311099
053120            PV-FROM-CLAUSE                                        05312099
053130        WITH                                                      05313099
053140            POINTER PV-STRING-POINTER-FROM.                       05314099
053150                                                                  05315099
053160     IF PS-USE-XLT-VND-STYL                                       05316099
053170        STRING                                                    05317099
053180            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05318099
053190            'XLT_VND_STYL K'                  DELIMITED BY SIZE   05319099
053200        INTO                                                      05320099
053210            PV-FROM-CLAUSE                                        05321099
053220        WITH                                                      05322099
053230            POINTER PV-STRING-POINTER-FROM.                       05323099
053240                                                                  05324099
053250     IF PS-USE-TMESTDS                                            05325099
053260        STRING                                                    05326099
053270            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  05327099
053280            'TMESTDS L'                       DELIMITED BY SIZE   05328099
053290        INTO                                                      05329099
053300            PV-FROM-CLAUSE                                        05330099
053310        WITH                                                      05331099
053320            POINTER PV-STRING-POINTER-FROM.                       05332099
053330                                                                  05333099
053340     IF PS-USE-XFC-INLINE AND PS-DONT-USE-DSB-INLINE              05334099
053350        STRING                                                    05335099
053360         ',(SELECT '                        DELIMITED BY SIZE,    05336099
053370         'I.PO_NBR '                        DELIMITED BY SIZE,    05337099
053380         'FROM '                            DELIMITED BY SIZE,    05338099
053390         PV-TABLE-QUALIFIER                 DELIMITED BY SIZE,    05339099
053400         'TPLNSHP I '                       DELIMITED BY SIZE,    05340099
053410         'WHERE '                           DELIMITED BY SIZE,    05341099
053420         '(I.LAST_FCTRY_DTE BETWEEN '       DELIMITED BY SIZE,    05342099
053430         PC-QUOTE                           DELIMITED BY SIZE,    05343099
053440         ASC-XFACT-BEF-DTE                  DELIMITED BY SIZE,    05344099
053450         PC-QUOTE                           DELIMITED BY SIZE,    05345099
053460         ' AND '                            DELIMITED BY SIZE,    05346099
053470         PC-QUOTE                           DELIMITED BY SIZE,    05347099
053480         ASC-XFACT-END-DTE                  DELIMITED BY SIZE,    05348099
053490         PC-QUOTE                           DELIMITED BY SIZE,    05349099
053500         ') '                               DELIMITED BY SIZE,    05350099
053510         'AND '                             DELIMITED BY SIZE,    05351099
053520         'I.VER_STATUS_CDE = '              DELIMITED BY SIZE,    05352099
053530         PC-QUOTE                           DELIMITED BY SIZE,    05353099
053540         'A'                                DELIMITED BY SIZE,    05354099
053550         PC-QUOTE                           DELIMITED BY SIZE,    05355099
053560         ') AS I'                           DELIMITED BY SIZE     05356099
053570        INTO                                                      05357099
053580            PV-FROM-CLAUSE                                        05358099
053590        WITH                                                      05359099
053600            POINTER PV-STRING-POINTER-FROM.                       05360099
053610                                                                  05361099
053620     IF PS-USE-DSB-INLINE AND PS-DONT-USE-XFC-INLINE              05362099
053630        STRING                                                    05363099
053640         ',(SELECT '                        DELIMITED BY SIZE,    05364099
053650         'I.PO_NBR '                        DELIMITED BY SIZE,    05365099
053660         'FROM '                            DELIMITED BY SIZE,    05366099
053670         PV-TABLE-QUALIFIER                 DELIMITED BY SIZE,    05367099
053680         'TPLNSHP I '                       DELIMITED BY SIZE,    05368099
053690         'WHERE '                           DELIMITED BY SIZE,    05369099
053700         '(I.DONT_SHIP_BEF_DTE BETWEEN '    DELIMITED BY SIZE,    05370099
053710         PC-QUOTE                           DELIMITED BY SIZE,    05371099
053720         ASC-SHPDT-BEF-DTE                  DELIMITED BY SIZE,    05372099
053730         PC-QUOTE                           DELIMITED BY SIZE,    05373099
053740         ' AND '                            DELIMITED BY SIZE,    05374099
053750         PC-QUOTE                           DELIMITED BY SIZE,    05375099
053760         ASC-SHPDT-END-DTE                  DELIMITED BY SIZE,    05376099
053770         PC-QUOTE                           DELIMITED BY SIZE,    05377099
053780         ') '                               DELIMITED BY SIZE,    05378099
053790         'AND '                             DELIMITED BY SIZE,    05379099
053800         'I.VER_STATUS_CDE = '              DELIMITED BY SIZE,    05380099
053810         PC-QUOTE                           DELIMITED BY SIZE,    05381099
053820         'A'                                DELIMITED BY SIZE,    05382099
053830         PC-QUOTE                           DELIMITED BY SIZE,    05383099
053840         ') AS I'                           DELIMITED BY SIZE     05384099
053850        INTO                                                      05385099
053860            PV-FROM-CLAUSE                                        05386099
053870        WITH                                                      05387099
053880            POINTER PV-STRING-POINTER-FROM.                       05388099
053890                                                                  05389099
053900     IF PS-USE-DSB-INLINE AND PS-USE-XFC-INLINE                   05390099
053910        STRING                                                    05391099
053920         ',(SELECT '                        DELIMITED BY SIZE,    05392099
053930         'I.PO_NBR '                        DELIMITED BY SIZE,    05393099
053940         'FROM '                            DELIMITED BY SIZE,    05394099
053950         PV-TABLE-QUALIFIER                 DELIMITED BY SIZE,    05395099
053960         'TPLNSHP I '                       DELIMITED BY SIZE,    05396099
053970         'WHERE '                           DELIMITED BY SIZE,    05397099
053980         '(I.DONT_SHIP_BEF_DTE BETWEEN '    DELIMITED BY SIZE,    05398099
053990         PC-QUOTE                           DELIMITED BY SIZE,    05399099
054000         ASC-SHPDT-BEF-DTE                  DELIMITED BY SIZE,    05400099
054010         PC-QUOTE                           DELIMITED BY SIZE,    05401099
054020         ' AND '                            DELIMITED BY SIZE,    05402099
054030         PC-QUOTE                           DELIMITED BY SIZE,    05403099
054040         ASC-SHPDT-END-DTE                  DELIMITED BY SIZE,    05404099
054050         PC-QUOTE                           DELIMITED BY SIZE,    05405099
054060         ') AND '                           DELIMITED BY SIZE,    05406099
054070         '(I.LAST_FCTRY_DTE BETWEEN '       DELIMITED BY SIZE,    05407099
054080         PC-QUOTE                           DELIMITED BY SIZE,    05408099
054090         ASC-XFACT-BEF-DTE                  DELIMITED BY SIZE,    05409099
054100         PC-QUOTE                           DELIMITED BY SIZE,    05410099
054110         ' AND '                            DELIMITED BY SIZE,    05411099
054120         PC-QUOTE                           DELIMITED BY SIZE,    05412099
054130         ASC-XFACT-END-DTE                  DELIMITED BY SIZE,    05413099
054140         PC-QUOTE                           DELIMITED BY SIZE,    05414099
054150         ') '                               DELIMITED BY SIZE,    05415099
054160         'AND '                             DELIMITED BY SIZE,    05416099
054170         'I.VER_STATUS_CDE = '              DELIMITED BY SIZE,    05417099
054180         PC-QUOTE                           DELIMITED BY SIZE,    05418099
054190         'A'                                DELIMITED BY SIZE,    05419099
054200         PC-QUOTE                           DELIMITED BY SIZE,    05420099
054210         ') AS I'                           DELIMITED BY SIZE     05421099
054220        INTO                                                      05422099
054230            PV-FROM-CLAUSE                                        05423099
054240        WITH                                                      05424099
054250            POINTER PV-STRING-POINTER-FROM.                       05425099
054260                                                                  05426099
054270     IF PS-USE-XFC-INLINE OR PS-USE-DSB-INLINE                    05427099
054280        STRING                                                    05428099
054290          ' AND '                           DELIMITED BY SIZE,    05429099
054300          'I.PO_NBR = '                     DELIMITED BY SIZE,    05430099
054310          'C.PO_NBR'                        DELIMITED BY SIZE     05431099
054320        INTO                                                      05432099
054330            PV-WHERE-CLAUSE                                       05433099
054340        WITH                                                      05434099
054350            POINTER PV-STRING-POINTER-WHERE                       05435099
054360     END-IF.                                                      05436099
054370                                                                  05437099
054380     IF ASC-SORT1-BY-IND = 'V'                                    05438099
054390      OR ASC-SORT2-BY-IND = 'V'                                   05439099
054400     STRING                                                       05440099
054410         ' GROUP BY'               DELIMITED BY SIZE,             05441099
054420         ' A.PO_NBR '              DELIMITED BY SIZE,             05442099
054430         ',C.FOB_CDE'              DELIMITED BY SIZE,             05443099
054440         ',A.DEPT_NBR'             DELIMITED BY SIZE,             05444099
054450         ',C.LAST_FCTRY_DTE'       DELIMITED BY SIZE,             05445099
054460         ',C.DONT_SHIP_BEF_DTE'    DELIMITED BY SIZE,             05446099
054470         ',A.TOT_VAL_RTL_AMT'      DELIMITED BY SIZE,             05447099
054480         ',A.TOT_UNT_QTY'          DELIMITED BY SIZE              05448099
054490     INTO                                                         05449099
054500         PV-WHERE-CLAUSE                                          05450099
054510     WITH                                                         05451099
054520         POINTER PV-STRING-POINTER-WHERE                          05452099
054530     END-IF.                                                      05453099
054540                                                                  05454099
054550     EVALUATE ASC-SORT1-BY-IND                                    05455099
054560         WHEN 'F'                                                 05456099
054570             STRING                                               05457099
054580                  ' ORDER BY'               DELIMITED BY SIZE,    05458099
054590                  ' C.FOB_CDE'              DELIMITED BY SIZE     05459099
054600              INTO                                                05460099
054610                  PV-WHERE-CLAUSE                                 05461099
054620              WITH                                                05462099
054630                  POINTER PV-STRING-POINTER-WHERE                 05463099
054640                                                                  05464099
054650         WHEN 'X'                                                 05465099
054660             STRING                                               05466099
054670                  ' ORDER BY'               DELIMITED BY SIZE,    05467099
054680                  ' C.LAST_FCTRY_DTE'       DELIMITED BY SIZE     05468099
054690              INTO                                                05469099
054700                  PV-WHERE-CLAUSE                                 05470099
054710              WITH                                                05471099
054720                  POINTER PV-STRING-POINTER-WHERE                 05472099
054730                                                                  05473099
054740         WHEN 'S'                                                 05474099
054750             STRING                                               05475099
054760                  ' ORDER BY'               DELIMITED BY SIZE,    05476099
054770                  ' DONT_SHIP_BEF_DTE'      DELIMITED BY SIZE     05477099
054780              INTO                                                05478099
054790                  PV-WHERE-CLAUSE                                 05479099
054800              WITH                                                05480099
054810                  POINTER PV-STRING-POINTER-WHERE                 05481099
054820                                                                  05482099
054830         WHEN 'D'                                                 05483099
054840             STRING                                               05484099
054850                  ' ORDER BY'               DELIMITED BY SIZE,    05485099
054860                  ' DEPT_NBR'               DELIMITED BY SIZE     05486099
054870              INTO                                                05487099
054880                  PV-WHERE-CLAUSE                                 05488099
054890              WITH                                                05489099
054900                  POINTER PV-STRING-POINTER-WHERE                 05490099
054910                                                                  05491099
054920         WHEN 'V'                                                 05492099
054930             STRING                                               05493099
054940                  ' ORDER BY'               DELIMITED BY SIZE,    05494099
054950                  ' 8'                      DELIMITED BY SIZE     05495099
054960              INTO                                                05496099
054970                  PV-WHERE-CLAUSE                                 05497099
054980              WITH                                                05498099
054990                  POINTER PV-STRING-POINTER-WHERE                 05499099
055000                                                                  05500099
055010         WHEN OTHER                                               05501099
055020             STRING                                               05502099
055030                  ' ORDER BY'               DELIMITED BY SIZE,    05503099
055040                  ' A.PO_NBR'               DELIMITED BY SIZE     05504099
055050              INTO                                                05505099
055060                  PV-WHERE-CLAUSE                                 05506099
055070              WITH                                                05507099
055080                  POINTER PV-STRING-POINTER-WHERE                 05508099
055090     END-EVALUATE.                                                05509099
055100                                                                  05510099
055110     EVALUATE ASC-SORT2-BY-IND                                    05511099
055120         WHEN 'F'                                                 05512099
055130             STRING                                               05513099
055140                  ',C.FOB_CDE'              DELIMITED BY SIZE     05514099
055150              INTO                                                05515099
055160                  PV-WHERE-CLAUSE                                 05516099
055170              WITH                                                05517099
055180                  POINTER PV-STRING-POINTER-WHERE                 05518099
055190                                                                  05519099
055200         WHEN 'X'                                                 05520099
055210             STRING                                               05521099
055220                  ',C.LAST_FCTRY_DTE'       DELIMITED BY SIZE     05522099
055230              INTO                                                05523099
055240                  PV-WHERE-CLAUSE                                 05524099
055250              WITH                                                05525099
055260                  POINTER PV-STRING-POINTER-WHERE                 05526099
055270                                                                  05527099
055280         WHEN 'S'                                                 05528099
055290             STRING                                               05529099
055300                  ',DONT_SHIP_BEF_DTE'      DELIMITED BY SIZE     05530099
055310              INTO                                                05531099
055320                  PV-WHERE-CLAUSE                                 05532099
055330              WITH                                                05533099
055340                  POINTER PV-STRING-POINTER-WHERE                 05534099
055350                                                                  05535099
055360         WHEN 'D'                                                 05536099
055370             STRING                                               05537099
055380                  ',DEPT_NBR'               DELIMITED BY SIZE     05538099
055390              INTO                                                05539099
055400                  PV-WHERE-CLAUSE                                 05540099
055410              WITH                                                05541099
055420                  POINTER PV-STRING-POINTER-WHERE                 05542099
055430                                                                  05543099
055440         WHEN 'P'                                                 05544099
055450             STRING                                               05545099
055460                  ',A.PO_NBR'               DELIMITED BY SIZE     05546099
055470              INTO                                                05547099
055480                  PV-WHERE-CLAUSE                                 05548099
055490              WITH                                                05549099
055500                  POINTER PV-STRING-POINTER-WHERE                 05550099
055510                                                                  05551099
055520         WHEN 'V'                                                 05552099
055530             STRING                                               05553099
055540                  ',8       '               DELIMITED BY SIZE     05554099
055550              INTO                                                05555099
055560                  PV-WHERE-CLAUSE                                 05556099
055570              WITH                                                05557099
055580                  POINTER PV-STRING-POINTER-WHERE                 05558099
055590                                                                  05559099
055600         WHEN OTHER                                               05560099
055610             STRING                                               05561099
055620                  ',A.PO_NBR'               DELIMITED BY SIZE     05562099
055630              INTO                                                05563099
055640                  PV-WHERE-CLAUSE                                 05564099
055650              WITH                                                05565099
055660                  POINTER PV-STRING-POINTER-WHERE                 05566099
055670                                                                  05567099
055680     END-EVALUATE.                                                05568099
055690                                                                  05569099
055700 EJECT                                                            05570099
055710*----------------------------------------------------------------*05571099
055720*    SET UP THE DEPARTMENT NUMBER WHERE CLAUSE                   *05572099
055730*----------------------------------------------------------------*05573099
055740                                                                  05574099
055750 4101-DEPT-NBR.                                                   05575099
055760                                                                  05576099
055770     IF PV-STRING-POINTER-WHERE > 1                               05577099
055780        STRING                                                    05578099
055790            ' AND '                           DELIMITED BY SIZE   05579099
055800        INTO                                                      05580099
055810            PV-WHERE-CLAUSE                                       05581099
055820        WITH                                                      05582099
055830            POINTER PV-STRING-POINTER-WHERE.                      05583099
055840                                                                  05584099
055850     MOVE ZEROES TO PV-TEMP-DEPT-NBR.                             05585099
055860     MOVE ASC-DEPT-NBR TO PV-TEMP-DEPT-NBR.                       05586099
055870                                                                  05587099
055880     STRING                                                       05588099
055890         'A.DEPT_NBR = '                      DELIMITED BY SIZE,  05589099
055900         PC-QUOTE                             DELIMITED BY SIZE,  05590099
055910         PV-TEMP-DEPT-NBR-X-2                 DELIMITED BY SIZE,  05591099
055920         PC-QUOTE                             DELIMITED BY SIZE   05592099
055930     INTO                                                         05593099
055940         PV-WHERE-CLAUSE                                          05594099
055950     WITH                                                         05595099
055960         POINTER PV-STRING-POINTER-WHERE.                         05596099
055970 EJECT                                                            05597099
055980*----------------------------------------------------------------*05598099
055990*    SET UP THE PO NUMBER WHERE CLAUSE                           *05599099
056000*----------------------------------------------------------------*05600099
056010                                                                  05601099
056020 4102-PO-NBR.                                                     05602099
056030                                                                  05603099
056040     IF PV-STRING-POINTER-WHERE > 1                               05604099
056050        STRING                                                    05605099
056060            ' AND '                           DELIMITED BY SIZE   05606099
056070        INTO                                                      05607099
056080            PV-WHERE-CLAUSE                                       05608099
056090        WITH                                                      05609099
056100            POINTER PV-STRING-POINTER-WHERE.                      05610099
056110                                                                  05611099
056120     MOVE ASC-KEY-PO-NBR   TO PV-TEMP-PO-NBR.                     05612099
056130                                                                  05613099
056140     STRING                                                       05614099
056150         'A.PO_NBR = '                        DELIMITED BY SIZE,  05615099
056160         PV-TEMP-PO-NBR                       DELIMITED BY SIZE   05616099
056170     INTO                                                         05617099
056180         PV-WHERE-CLAUSE                                          05618099
056190     WITH                                                         05619099
056200         POINTER PV-STRING-POINTER-WHERE.                         05620099
056210 EJECT                                                            05621099
056220*----------------------------------------------------------------*05622099
056230*    SET UP THE PO TYPE WHERE CLAUSE                             *05623099
056240*----------------------------------------------------------------*05624099
056250 4103-PO-TYP-CDE.                                                 05625099
056260                                                                  05626099
056270     IF PV-STRING-POINTER-WHERE > 1                               05627099
056280        STRING                                                    05628099
056290            ' AND '                           DELIMITED BY SIZE   05629099
056300        INTO                                                      05630099
056310            PV-WHERE-CLAUSE                                       05631099
056320        WITH                                                      05632099
056330            POINTER PV-STRING-POINTER-WHERE.                      05633099
056340                                                                  05634099
056350     MOVE ZERO TO PV-TALLY-1                                      05635099
056360                  PV-TALLY-2.                                     05636099
056370                                                                  05637099
056380     MOVE ASC-PO-TYP-CDE TO PV-PO-TYP-CDE.                        05638099
056390     INSPECT PV-PO-TYP-CDE                                        05639099
056400        TALLYING PV-TALLY-1 FOR ALL '*'                           05640099
056410                 PV-TALLY-2 FOR ALL '?'                           05641099
056420        REPLACING ALL '*' BY '%'                                  05642099
056430                  ALL '?' BY '_'                                  05643099
056440                  ALL '''' BY '_'.                                05644099
056450                                                                  05645099
056460     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            05646099
056470       IF PV-PO-TYP-CDE = PC-II                                   05647099
056480        STRING                                                    05648099
056490           'A.PO_TYP_CDE IN '                  DELIMITED BY SIZE, 05649099
056500            PC-OPEN-PAREN                      DELIMITED BY SIZE, 05650099
056510            PC-QUOTE                           DELIMITED BY SIZE, 05651099
056520            PC-IE                              DELIMITED BY SIZE, 05652099
056530            PC-QUOTE                           DELIMITED BY SIZE, 05653099
056540            PC-COMMA                           DELIMITED BY SIZE, 05654099
056550            PC-QUOTE                           DELIMITED BY SIZE, 05655099
056560            PC-IF                              DELIMITED BY SIZE, 05656099
056570            PC-QUOTE                           DELIMITED BY SIZE, 05657099
056580            PC-COMMA                           DELIMITED BY SIZE, 05658099
056590            PC-QUOTE                           DELIMITED BY SIZE, 05659099
056600            PC-IM                              DELIMITED BY SIZE, 05660099
056610            PC-QUOTE                           DELIMITED BY SIZE, 05661099
056620            PC-CLOSE-PAREN                     DELIMITED BY SIZE  05662099
056630        INTO                                                      05663099
056640            PV-WHERE-CLAUSE                                       05664099
056650        WITH                                                      05665099
056660            POINTER PV-STRING-POINTER-WHERE                       05666099
056670       ELSE                                                       05667099
056680          STRING                                                  05668099
056690              'A.PO_TYP_CDE LIKE '             DELIMITED BY SIZE, 05669099
056700              PC-QUOTE                         DELIMITED BY SIZE, 05670099
056710              PV-PO-TYP-CDE                    DELIMITED BY SIZE, 05671099
056720              PC-PERCENT                       DELIMITED BY SIZE, 05672099
056730              PC-QUOTE                         DELIMITED BY SIZE  05673099
056740          INTO                                                    05674099
056750              PV-WHERE-CLAUSE                                     05675099
056760          WITH                                                    05676099
056770              POINTER PV-STRING-POINTER-WHERE                     05677099
056780       END-IF                                                     05678099
056790     ELSE                                                         05679099
056800        STRING                                                    05680099
056810            'A.PO_TYP_CDE LIKE '               DELIMITED BY SIZE, 05681099
056820            PC-QUOTE                           DELIMITED BY SIZE, 05682099
056830            PV-PO-TYP-CDE                      DELIMITED BY SIZE, 05683099
056840            PC-QUOTE                           DELIMITED BY SIZE  05684099
056850        INTO                                                      05685099
056860            PV-WHERE-CLAUSE                                       05686099
056870        WITH                                                      05687099
056880            POINTER PV-STRING-POINTER-WHERE                       05688099
056890     END-IF.                                                      05689099
056900 EJECT                                                            05690099
056910*----------------------------------------------------------------*05691099
056920*    SET UP THE STORE NUMBER CLAUSE                              *05692099
056930*----------------------------------------------------------------*05693099
056940 4103-STR-NBR.                                                    05694099
056950                                                                  05695099
056960     IF PV-STRING-POINTER-WHERE > 1                               05696099
056970        STRING                                                    05697099
056980            ' AND '                           DELIMITED BY SIZE   05698099
056990        INTO                                                      05699099
057000            PV-WHERE-CLAUSE                                       05700099
057010        WITH                                                      05701099
057020            POINTER PV-STRING-POINTER-WHERE.                      05702099
057030                                                                  05703099
057040        MOVE ASC-STR-NBR TO PV-TEMP-STR-NBR.                      05704099
057050                                                                  05705099
057060        STRING                                                    05706099
057070            'L.STR_NBR = '                     DELIMITED BY SIZE, 05707099
057080            PV-TEMP-STR-NBR                    DELIMITED BY SIZE  05708099
057090        INTO                                                      05709099
057100            PV-WHERE-CLAUSE                                       05710099
057110        WITH                                                      05711099
057120            POINTER PV-STRING-POINTER-WHERE.                      05712099
057130 EJECT                                                            05713099
057140*----------------------------------------------------------------*05714099
057150*    SET UP THE QUOTA CATEGORY WHERE CLAUSE                      *05715099
057160*----------------------------------------------------------------*05716099
057170 4103-QUOTA-CATEGORY.                                             05717099
057180                                                                  05718099
057190     IF PV-STRING-POINTER-WHERE > 1                               05719099
057200        STRING                                                    05720099
057210            ' AND '                           DELIMITED BY SIZE   05721099
057220        INTO                                                      05722099
057230            PV-WHERE-CLAUSE                                       05723099
057240        WITH                                                      05724099
057250            POINTER PV-STRING-POINTER-WHERE.                      05725099
057260                                                                  05726099
057270        STRING                                                    05727099
057280            'A.QTA_CTG_CDE = '                 DELIMITED BY SIZE, 05728099
057290            PC-QUOTE                           DELIMITED BY SIZE, 05729099
057300            ASC-QUOTA-CATEGORY                 DELIMITED BY ' ',  05730099
057310            PC-QUOTE                           DELIMITED BY SIZE  05731099
057320        INTO                                                      05732099
057330            PV-WHERE-CLAUSE                                       05733099
057340        WITH                                                      05734099
057350            POINTER PV-STRING-POINTER-WHERE.                      05735099
057360 EJECT                                                            05736099
057370*----------------------------------------------------------------*05737099
057380*    SET UP THE STATUS CODE WHERE CLAUSE                         *05738099
057390*----------------------------------------------------------------*05739099
057400 4104-STATUS-CDE.                                                 05740099
057410                                                                  05741099
057420     IF PV-STRING-POINTER-WHERE > 1                               05742099
057430        STRING                                                    05743099
057440            ' AND '                           DELIMITED BY SIZE   05744099
057450        INTO                                                      05745099
057460            PV-WHERE-CLAUSE                                       05746099
057470        WITH                                                      05747099
057480            POINTER PV-STRING-POINTER-WHERE.                      05748099
057490                                                                  05749099
057500     STRING                                                       05750099
057510         'A.STATUS_CDE = '                    DELIMITED BY SIZE,  05751099
057520         PC-QUOTE                             DELIMITED BY SIZE,  05752099
057530         ASC-STATUS-CDE                       DELIMITED BY SIZE,  05753099
057540         PC-QUOTE                             DELIMITED BY SIZE   05754099
057550     INTO                                                         05755099
057560         PV-WHERE-CLAUSE                                          05756099
057570     WITH                                                         05757099
057580         POINTER PV-STRING-POINTER-WHERE.                         05758099
057590 EJECT                                                            05759099
057600*----------------------------------------------------------------*05760099
057610*    SET UP THE STATUS CLASS CLAUSE                              *05761099
057620*----------------------------------------------------------------*05762099
057630 4105-STATUS-CLS.                                                 05763099
057640                                                                  05764099
057650     IF PV-STRING-POINTER-WHERE > 1                               05765099
057660        STRING                                                    05766099
057670            ' AND '                           DELIMITED BY SIZE   05767099
057680        INTO                                                      05768099
057690            PV-WHERE-CLAUSE                                       05769099
057700        WITH                                                      05770099
057710            POINTER PV-STRING-POINTER-WHERE.                      05771099
057720                                                                  05772099
057730     IF ASC-STATUS-CLS = 'BTH'                                    05773099
057740         STRING                                                   05774099
057750             'E.STATUS_CLS IN ('              DELIMITED BY SIZE,  05775099
057760             PC-QUOTE                         DELIMITED BY SIZE,  05776099
057770             PC-ACT                           DELIMITED BY SIZE,  05777099
057780             PC-QUOTE                         DELIMITED BY SIZE,  05778099
057790             ','                              DELIMITED BY SIZE,  05779099
057800             PC-QUOTE                         DELIMITED BY SIZE,  05780099
057810             PC-CMP                           DELIMITED BY SIZE,  05781099
057820             PC-QUOTE                         DELIMITED BY SIZE,  05782099
057830             ')'                              DELIMITED BY SIZE   05783099
057840         INTO                                                     05784099
057850             PV-WHERE-CLAUSE                                      05785099
057860         WITH                                                     05786099
057870             POINTER PV-STRING-POINTER-WHERE                      05787099
057880     ELSE                                                         05788099
057890         STRING                                                   05789099
057900             'E.STATUS_CLS = '                DELIMITED BY SIZE,  05790099
057910             PC-QUOTE                         DELIMITED BY SIZE,  05791099
057920             ASC-STATUS-CLS                   DELIMITED BY SIZE,  05792099
057930             PC-QUOTE                         DELIMITED BY SIZE   05793099
057940         INTO                                                     05794099
057950             PV-WHERE-CLAUSE                                      05795099
057960         WITH                                                     05796099
057970             POINTER PV-STRING-POINTER-WHERE                      05797099
057980     END-IF.                                                      05798099
057990 EJECT                                                            05799099
058000*----------------------------------------------------------------*05800099
058010*    SET UP THE FOB WHERE CLAUSE                                 *05801099
058020*----------------------------------------------------------------*05802099
058030                                                                  05803099
058040 4106-FOB-CDE.                                                    05804099
058050                                                                  05805099
058060     IF PV-STRING-POINTER-WHERE > 1                               05806099
058070        STRING                                                    05807099
058080            ' AND '                           DELIMITED BY SIZE   05808099
058090        INTO                                                      05809099
058100            PV-WHERE-CLAUSE                                       05810099
058110        WITH                                                      05811099
058120            POINTER PV-STRING-POINTER-WHERE.                      05812099
058130                                                                  05813099
058140     STRING                                                       05814099
058150         'C.FOB_CDE = '                       DELIMITED BY SIZE,  05815099
058160         PC-QUOTE                             DELIMITED BY SIZE,  05816099
058170         ASC-FOB-CDE                          DELIMITED BY SIZE,  05817099
058180         PC-QUOTE                             DELIMITED BY SIZE   05818099
058190     INTO                                                         05819099
058200         PV-WHERE-CLAUSE                                          05820099
058210     WITH                                                         05821099
058220         POINTER PV-STRING-POINTER-WHERE.                         05822099
058230 EJECT                                                            05823099
058240*----------------------------------------------------------------*05824099
058250*    SET UP THE PICTURE INDICATOR CLAUSE                         *05825099
058260*----------------------------------------------------------------*05826099
058270                                                                  05827099
058280 4107-PIC-AD-IND.                                                 05828099
058290                                                                  05829099
058300     IF PV-STRING-POINTER-WHERE > 1                               05830099
058310        STRING                                                    05831099
058320            ' AND '                           DELIMITED BY SIZE   05832099
058330        INTO                                                      05833099
058340            PV-WHERE-CLAUSE                                       05834099
058350        WITH                                                      05835099
058360            POINTER PV-STRING-POINTER-WHERE.                      05836099
058370                                                                  05837099
058380     STRING                                                       05838099
058390         'B.PIC_ITM_IND = '                   DELIMITED BY SIZE,  05839099
058400         PC-QUOTE                             DELIMITED BY SIZE,  05840099
058410         ASC-PIC-AD-IND                       DELIMITED BY SIZE,  05841099
058420         PC-QUOTE                             DELIMITED BY SIZE   05842099
058430     INTO                                                         05843099
058440         PV-WHERE-CLAUSE                                          05844099
058450     WITH                                                         05845099
058460         POINTER PV-STRING-POINTER-WHERE.                         05846099
058470 EJECT                                                            05847099
058480*----------------------------------------------------------------*05848099
058490*    SET UP THE NEW STORE INDICATOR CLAUSE                       *05849099
058500*----------------------------------------------------------------*05850099
058510                                                                  05851099
058520 4108-NEW-STR-IND.                                                05852099
058530                                                                  05853099
058540     IF PV-STRING-POINTER-WHERE > 1                               05854099
058550        STRING                                                    05855099
058560            ' AND '                           DELIMITED BY SIZE   05856099
058570        INTO                                                      05857099
058580            PV-WHERE-CLAUSE                                       05858099
058590        WITH                                                      05859099
058600            POINTER PV-STRING-POINTER-WHERE.                      05860099
058610                                                                  05861099
058620     STRING                                                       05862099
058630         'A.NEW_STR_PO_IND = '                DELIMITED BY SIZE,  05863099
058640         PC-QUOTE                             DELIMITED BY SIZE,  05864099
058650         ASC-NEW-STR-IND                      DELIMITED BY SIZE,  05865099
058660         PC-QUOTE                             DELIMITED BY SIZE   05866099
058670     INTO                                                         05867099
058680         PV-WHERE-CLAUSE                                          05868099
058690     WITH                                                         05869099
058700         POINTER PV-STRING-POINTER-WHERE.                         05870099
058710 EJECT                                                            05871099
058720*----------------------------------------------------------------*05872099
058730*    SET UP THE SUBCLASS WHERE CLAUSE                            *05873099
058740*----------------------------------------------------------------*05874099
058750                                                                  05875099
058760 4109-SUBCLASS.                                                   05876099
058770                                                                  05877099
058780     IF PV-STRING-POINTER-WHERE > 1                               05878099
058790        STRING                                                    05879099
058800            ' AND '                           DELIMITED BY SIZE   05880099
058810        INTO                                                      05881099
058820            PV-WHERE-CLAUSE                                       05882099
058830        WITH                                                      05883099
058840            POINTER PV-STRING-POINTER-WHERE.                      05884099
058850                                                                  05885099
058860     MOVE ASC-SUBCLASS TO PV-TEMP-SUBCLASS.                       05886099
058870                                                                  05887099
058880     STRING                                                       05888099
058890         'B.CL_NBR = '                        DELIMITED BY SIZE,  05889099
058900         PC-QUOTE                             DELIMITED BY SIZE,  05890099
058910         PV-TEMP-SUBCLASS-X-2                 DELIMITED BY SIZE,  05891099
058920         PC-QUOTE                             DELIMITED BY SIZE   05892099
058930     INTO                                                         05893099
058940         PV-WHERE-CLAUSE                                          05894099
058950     WITH                                                         05895099
058960         POINTER PV-STRING-POINTER-WHERE.                         05896099
058970 EJECT                                                            05897099
058980*----------------------------------------------------------------*05898099
058990*    SET UP THE STANDARD CLASS NUMBER                            *05899099
059000*----------------------------------------------------------------*05900099
059010                                                                  05901099
059020 4110-CLASS.                                                      05902099
059030                                                                  05903099
059040     IF PV-STRING-POINTER-WHERE > 1                               05904099
059050        STRING                                                    05905099
059060            ' AND '                           DELIMITED BY SIZE   05906099
059070        INTO                                                      05907099
059080            PV-WHERE-CLAUSE                                       05908099
059090        WITH                                                      05909099
059100            POINTER PV-STRING-POINTER-WHERE.                      05910099
059110                                                                  05911099
059120     STRING                                                       05912099
059130         '(B.CL_NBR BETWEEN '                 DELIMITED BY SIZE,  05913099
059140         PC-QUOTE                             DELIMITED BY SIZE,  05914099
059150         DK-CL-NBR-BEG                        DELIMITED BY SIZE,  05915099
059160         PC-QUOTE                             DELIMITED BY SIZE,  05916099
059170         ' AND '                              DELIMITED BY SIZE,  05917099
059180         PC-QUOTE                             DELIMITED BY SIZE,  05918099
059190         DK-CL-NBR-END                        DELIMITED BY SIZE,  05919099
059200         PC-QUOTE                             DELIMITED BY SIZE,  05920099
059210         ')'                                  DELIMITED BY SIZE   05921099
059220     INTO                                                         05922099
059230         PV-WHERE-CLAUSE                                          05923099
059240     WITH                                                         05924099
059250         POINTER PV-STRING-POINTER-WHERE.                         05925099
059260                                                                  05926099
059270*----------------------------------------------------------------*05927099
059280*    SET UP THE SKU                                              *05928099
059290*----------------------------------------------------------------*05929099
059300                                                                  05930099
059310 4111-SKU.                                                        05931099
059320                                                                  05932099
059330     IF PV-STRING-POINTER-WHERE > 1                               05933099
059340        STRING                                                    05934099
059350            ' AND '                           DELIMITED BY SIZE   05935099
059360        INTO                                                      05936099
059370            PV-WHERE-CLAUSE                                       05937099
059380        WITH                                                      05938099
059390            POINTER PV-STRING-POINTER-WHERE.                      05939099
059400                                                                  05940099
059410     MOVE ASC-SKU TO PV-TEMP-SKU.                                 05941099
059420                                                                  05942099
059430     STRING                                                       05943099
059440         'H.SKU = '                           DELIMITED BY SIZE,  05944099
059450         PV-TEMP-SKU                          DELIMITED BY SIZE   05945099
059460     INTO                                                         05946099
059470         PV-WHERE-CLAUSE                                          05947099
059480     WITH                                                         05948099
059490         POINTER PV-STRING-POINTER-WHERE.                         05949099
059500 EJECT                                                            05950099
059510*----------------------------------------------------------------*05951099
059520*    SET UP THE AD EVENT WHERE CLAUSE                            *05952099
059530*----------------------------------------------------------------*05953099
059540                                                                  05954099
059550 4112-AD-EVNT-DTE.                                                05955099
059560                                                                  05956099
059570     IF PV-STRING-POINTER-WHERE > 1                               05957099
059580        STRING                                                    05958099
059590            ' AND '                           DELIMITED BY SIZE   05959099
059600        INTO                                                      05960099
059610            PV-WHERE-CLAUSE                                       05961099
059620        WITH                                                      05962099
059630            POINTER PV-STRING-POINTER-WHERE.                      05963099
059640                                                                  05964099
059650     STRING                                                       05965099
059660         'B.AD_EVNT_DTE = '                   DELIMITED BY SIZE,  05966099
059670         PC-QUOTE                             DELIMITED BY SIZE,  05967099
059680         ASC-AD-EVNT-DTE                      DELIMITED BY SIZE,  05968099
059690         PC-QUOTE                             DELIMITED BY SIZE   05969099
059700     INTO                                                         05970099
059710         PV-WHERE-CLAUSE                                          05971099
059720     WITH                                                         05972099
059730         POINTER PV-STRING-POINTER-WHERE.                         05973099
059740 EJECT                                                            05974099
059750*----------------------------------------------------------------*05975099
059760*    SET UP THE OTB PERIOD WHERE CLAUSE                          *05976099
059770*----------------------------------------------------------------*05977099
059780                                                                  05978099
059790 4113-OTB-PER-ONE.                                                05979099
059800                                                                  05980099
059810     IF PV-STRING-POINTER-WHERE > 1                               05981099
059820        STRING                                                    05982099
059830            ' AND '                           DELIMITED BY SIZE   05983099
059840        INTO                                                      05984099
059850            PV-WHERE-CLAUSE                                       05985099
059860        WITH                                                      05986099
059870            POINTER PV-STRING-POINTER-WHERE.                      05987099
059880                                                                  05988099
059890     STRING                                                       05989099
059900         'A.OTB_PER_NBR = '                   DELIMITED BY SIZE,  05990099
059910         PC-QUOTE                             DELIMITED BY SIZE,  05991099
059920         ASC-OTB-PER-NBR-BEG                  DELIMITED BY SIZE,  05992099
059930         PC-QUOTE                             DELIMITED BY SIZE   05993099
059940     INTO                                                         05994099
059950         PV-WHERE-CLAUSE                                          05995099
059960     WITH                                                         05996099
059970         POINTER PV-STRING-POINTER-WHERE.                         05997099
059980 EJECT                                                            05998099
059990*----------------------------------------------------------------*05999099
060000*    SET UP THE OTB ENTIRE PERIOD CLAUSE                         *06000099
060010*----------------------------------------------------------------*06001099
060020                                                                  06002099
060030 4114-OTB-PER-NBR-BEG-END.                                        06003099
060040                                                                  06004099
060050     IF PV-STRING-POINTER-WHERE > 1                               06005099
060060        STRING                                                    06006099
060070            ' AND '                           DELIMITED BY SIZE   06007099
060080        INTO                                                      06008099
060090            PV-WHERE-CLAUSE                                       06009099
060100        WITH                                                      06010099
060110            POINTER PV-STRING-POINTER-WHERE.                      06011099
060120                                                                  06012099
060130     STRING                                                       06013099
060140         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  06014099
060150         PC-QUOTE                             DELIMITED BY SIZE,  06015099
060160         ASC-OTB-PER-NBR-BEG                  DELIMITED BY SIZE,  06016099
060170         PC-QUOTE                             DELIMITED BY SIZE,  06017099
060180         ' AND '                              DELIMITED BY SIZE,  06018099
060190         PC-QUOTE                             DELIMITED BY SIZE,  06019099
060200         ASC-OTB-PER-NBR-END                  DELIMITED BY SIZE,  06020099
060210         PC-QUOTE                             DELIMITED BY SIZE,  06021099
060220         ')'                                  DELIMITED BY SIZE   06022099
060230     INTO                                                         06023099
060240         PV-WHERE-CLAUSE                                          06024099
060250     WITH                                                         06025099
060260         POINTER PV-STRING-POINTER-WHERE.                         06026099
060270 EJECT                                                            06027099
060280*----------------------------------------------------------------*06028099
060290*    SET UP THE OTB PERIOD WHEN BEGIN IS USED                    *06029099
060300*----------------------------------------------------------------*06030099
060310                                                                  06031099
060320 4115-OTB-PER-BEG.                                                06032099
060330                                                                  06033099
060340     IF PV-STRING-POINTER-WHERE > 1                               06034099
060350        STRING                                                    06035099
060360            ' AND '                           DELIMITED BY SIZE   06036099
060370        INTO                                                      06037099
060380            PV-WHERE-CLAUSE                                       06038099
060390        WITH                                                      06039099
060400            POINTER PV-STRING-POINTER-WHERE.                      06040099
060410                                                                  06041099
060420     STRING                                                       06042099
060430         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  06043099
060440         PC-QUOTE                             DELIMITED BY SIZE,  06044099
060450         ASC-OTB-PER-NBR-BEG                  DELIMITED BY SIZE,  06045099
060460         PC-QUOTE                             DELIMITED BY SIZE,  06046099
060470         ' AND '                              DELIMITED BY SIZE,  06047099
060480         PC-QUOTE                             DELIMITED BY SIZE,  06048099
060490         ASC-OTB-PER-NBR-END                  DELIMITED BY SIZE,  06049099
060500         PC-QUOTE                             DELIMITED BY SIZE,  06050099
060510         ')'                                  DELIMITED BY SIZE   06051099
060520     INTO                                                         06052099
060530         PV-WHERE-CLAUSE                                          06053099
060540     WITH                                                         06054099
060550         POINTER PV-STRING-POINTER-WHERE.                         06055099
060560 EJECT                                                            06056099
060570*----------------------------------------------------------------*06057099
060580*    SET UP THE OTB PERIOD WHEN END IS USED                      *06058099
060590*----------------------------------------------------------------*06059099
060600                                                                  06060099
060610 4116-OTB-PER-END.                                                06061099
060620                                                                  06062099
060630     IF PV-STRING-POINTER-WHERE > 1                               06063099
060640        STRING                                                    06064099
060650            ' AND '                           DELIMITED BY SIZE   06065099
060660        INTO                                                      06066099
060670            PV-WHERE-CLAUSE                                       06067099
060680        WITH                                                      06068099
060690            POINTER PV-STRING-POINTER-WHERE.                      06069099
060700                                                                  06070099
060710     STRING                                                       06071099
060720         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  06072099
060730         PC-QUOTE                             DELIMITED BY SIZE,  06073099
060740         ASC-OTB-PER-NBR-BEG                  DELIMITED BY SIZE,  06074099
060750         PC-QUOTE                             DELIMITED BY SIZE,  06075099
060760         ' AND '                              DELIMITED BY SIZE,  06076099
060770         PC-QUOTE                             DELIMITED BY SIZE,  06077099
060780         ASC-OTB-PER-NBR-END                  DELIMITED BY SIZE,  06078099
060790         PC-QUOTE                             DELIMITED BY SIZE,  06079099
060800         ')'                                  DELIMITED BY SIZE   06080099
060810     INTO                                                         06081099
060820         PV-WHERE-CLAUSE                                          06082099
060830     WITH                                                         06083099
060840         POINTER PV-STRING-POINTER-WHERE.                         06084099
060850 EJECT                                                            06085099
060860*----------------------------------------------------------------*06086099
060870*    SET UP THE XFACTORY DATE RANGE                              *06087099
060880*----------------------------------------------------------------*06088099
060890                                                                  06089099
060900 4117-XFACT-DTE-ONE.                                              06090099
060910                                                                  06091099
060920     IF PV-STRING-POINTER-WHERE > 1                               06092099
060930        STRING                                                    06093099
060940            ' AND '                           DELIMITED BY SIZE   06094099
060950        INTO                                                      06095099
060960            PV-WHERE-CLAUSE                                       06096099
060970        WITH                                                      06097099
060980            POINTER PV-STRING-POINTER-WHERE.                      06098099
060990                                                                  06099099
061000     STRING                                                       06100099
061010         'C.LAST_FCTRY_DTE = '                DELIMITED BY SIZE,  06101099
061020         PC-QUOTE                             DELIMITED BY SIZE,  06102099
061030         ASC-XFACT-BEF-DTE                    DELIMITED BY SIZE,  06103099
061040         PC-QUOTE                             DELIMITED BY SIZE   06104099
061050     INTO                                                         06105099
061060         PV-WHERE-CLAUSE                                          06106099
061070     WITH                                                         06107099
061080         POINTER PV-STRING-POINTER-WHERE.                         06108099
061090 EJECT                                                            06109099
061100*----------------------------------------------------------------*06110099
061110*    DEFINE THE XFACTORY DATE RANGE                              *06111099
061120*----------------------------------------------------------------*06112099
061130                                                                  06113099
061140 4118-XFACT-BEF-END-DTE.                                          06114099
061150                                                                  06115099
061160     IF PV-STRING-POINTER-WHERE > 1                               06116099
061170        STRING                                                    06117099
061180            ' AND '                           DELIMITED BY SIZE   06118099
061190        INTO                                                      06119099
061200            PV-WHERE-CLAUSE                                       06120099
061210        WITH                                                      06121099
061220            POINTER PV-STRING-POINTER-WHERE.                      06122099
061230                                                                  06123099
061240     STRING                                                       06124099
061250         '(C.LAST_FCTRY_DTE BETWEEN '         DELIMITED BY SIZE,  06125099
061260         PC-QUOTE                             DELIMITED BY SIZE,  06126099
061270         ASC-XFACT-BEF-DTE                    DELIMITED BY SIZE,  06127099
061280         PC-QUOTE                             DELIMITED BY SIZE,  06128099
061290         ' AND '                              DELIMITED BY SIZE,  06129099
061300         PC-QUOTE                             DELIMITED BY SIZE,  06130099
061310         ASC-XFACT-END-DTE                    DELIMITED BY SIZE,  06131099
061320         PC-QUOTE                             DELIMITED BY SIZE,  06132099
061330         ')'                                  DELIMITED BY SIZE   06133099
061340     INTO                                                         06134099
061350         PV-WHERE-CLAUSE                                          06135099
061360     WITH                                                         06136099
061370         POINTER PV-STRING-POINTER-WHERE.                         06137099
061380 EJECT                                                            06138099
061390*----------------------------------------------------------------*06139099
061400*    DEFINE THE XFACTORY DATE RANGE FOR BEFORE ONLY              *06140099
061410*----------------------------------------------------------------*06141099
061420                                                                  06142099
061430 4119-XFACT-BEF-DTE.                                              06143099
061440                                                                  06144099
061450     IF PV-STRING-POINTER-WHERE > 1                               06145099
061460        STRING                                                    06146099
061470            ' AND '                           DELIMITED BY SIZE   06147099
061480        INTO                                                      06148099
061490            PV-WHERE-CLAUSE                                       06149099
061500        WITH                                                      06150099
061510            POINTER PV-STRING-POINTER-WHERE.                      06151099
061520                                                                  06152099
061530     STRING                                                       06153099
061540         '(C.LAST_FCTRY_DTE BETWEEN '         DELIMITED BY SIZE,  06154099
061550         PC-QUOTE                             DELIMITED BY SIZE,  06155099
061560         ASC-XFACT-BEF-DTE                    DELIMITED BY SIZE,  06156099
061570         PC-QUOTE                             DELIMITED BY SIZE,  06157099
061580         ' AND '                              DELIMITED BY SIZE,  06158099
061590         PC-QUOTE                             DELIMITED BY SIZE,  06159099
061600         ASC-XFACT-END-DTE                    DELIMITED BY SIZE,  06160099
061610         PC-QUOTE                             DELIMITED BY SIZE,  06161099
061620         ')'                                  DELIMITED BY SIZE   06162099
061630     INTO                                                         06163099
061640         PV-WHERE-CLAUSE                                          06164099
061650     WITH                                                         06165099
061660         POINTER PV-STRING-POINTER-WHERE.                         06166099
061670 EJECT                                                            06167099
061680*----------------------------------------------------------------*06168099
061690*    DEFINE THE XFACTORY DATE RANGE FOR END ONLY                 *06169099
061700*----------------------------------------------------------------*06170099
061710                                                                  06171099
061720 4120-XFACT-END-DTE.                                              06172099
061730                                                                  06173099
061740     IF PV-STRING-POINTER-WHERE > 1                               06174099
061750        STRING                                                    06175099
061760            ' AND '                           DELIMITED BY SIZE   06176099
061770        INTO                                                      06177099
061780            PV-WHERE-CLAUSE                                       06178099
061790        WITH                                                      06179099
061800            POINTER PV-STRING-POINTER-WHERE.                      06180099
061810                                                                  06181099
061820     STRING                                                       06182099
061830         '(C.LAST_FCTRY_DTE BETWEEN '         DELIMITED BY SIZE,  06183099
061840         PC-QUOTE                             DELIMITED BY SIZE,  06184099
061850         ASC-XFACT-BEF-DTE                    DELIMITED BY SIZE,  06185099
061860         PC-QUOTE                             DELIMITED BY SIZE,  06186099
061870         ' AND '                              DELIMITED BY SIZE,  06187099
061880         PC-QUOTE                             DELIMITED BY SIZE,  06188099
061890         ASC-XFACT-END-DTE                    DELIMITED BY SIZE,  06189099
061900         PC-QUOTE                             DELIMITED BY SIZE,  06190099
061910         ')'                                  DELIMITED BY SIZE   06191099
061920     INTO                                                         06192099
061930         PV-WHERE-CLAUSE                                          06193099
061940     WITH                                                         06194099
061950         POINTER PV-STRING-POINTER-WHERE.                         06195099
061960                                                                  06196099
061970                                                                  06197099
061980 EJECT                                                            06198099
061990*----------------------------------------------------------------*06199099
062000*    DEFINE THE ENTITY NAME DESCRIPTION                          *06200099
062010*----------------------------------------------------------------*06201099
062020                                                                  06202099
062030 4121-ENT-NAME-DESC.                                              06203099
062040                                                                  06204099
062050*TALLYING CODE                                                    06205099
062060     IF PV-STRING-POINTER-WHERE > 1                               06206099
062070        STRING                                                    06207099
062080            ' AND '                           DELIMITED BY SIZE   06208099
062090        INTO                                                      06209099
062100            PV-WHERE-CLAUSE                                       06210099
062110        WITH                                                      06211099
062120            POINTER PV-STRING-POINTER-WHERE.                      06212099
062130                                                                  06213099
062140     MOVE ZERO TO PV-TALLY-1                                      06214099
062150                  PV-TALLY-2.                                     06215099
062160                                                                  06216099
062170     MOVE ASC-ENT-NAME-DESC TO PV-ENT-NAME-DESC.                  06217099
062180     INSPECT PV-ENT-NAME-DESC                                     06218099
062190        TALLYING PV-TALLY-1 FOR ALL '*'                           06219099
062200                 PV-TALLY-2 FOR ALL '?'                           06220099
062210        REPLACING ALL '*' BY '%'                                  06221099
062220                  ALL '?' BY '_'                                  06222099
062230                  ALL '''' BY '_'.                                06223099
062240                                                                  06224099
062250     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            06225099
062260        STRING                                                    06226099
062270            'D.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 06227099
062280            PC-QUOTE                           DELIMITED BY SIZE, 06228099
062290            PV-ENT-NAME-DESC                   DELIMITED BY '  ', 06229099
062300            PC-PERCENT                         DELIMITED BY SIZE, 06230099
062310            PC-QUOTE                           DELIMITED BY SIZE  06231099
062320        INTO                                                      06232099
062330            PV-WHERE-CLAUSE                                       06233099
062340        WITH                                                      06234099
062350            POINTER PV-STRING-POINTER-WHERE                       06235099
062360     ELSE                                                         06236099
062370        STRING                                                    06237099
062380            'D.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 06238099
062390            PC-QUOTE                           DELIMITED BY SIZE, 06239099
062400            PV-ENT-NAME-DESC                   DELIMITED BY '  ', 06240099
062410            PC-QUOTE                           DELIMITED BY SIZE  06241099
062420        INTO                                                      06242099
062430            PV-WHERE-CLAUSE                                       06243099
062440        WITH                                                      06244099
062450            POINTER PV-STRING-POINTER-WHERE                       06245099
062460     END-IF.                                                      06246099
062470 EJECT                                                            06247099
062480*----------------------------------------------------------------*06248099
062490*    DEFINE THE VENDOR STYLE NAME                                *06249099
062500*----------------------------------------------------------------*06250099
062510                                                                  06251099
062520 4122-VEND-STYL-NME.                                              06252099
062530                                                                  06253099
062540     IF PV-STRING-POINTER-WHERE > 1                               06254099
062550        STRING                                                    06255099
062560            ' AND '                           DELIMITED BY SIZE   06256099
062570        INTO                                                      06257099
062580            PV-WHERE-CLAUSE                                       06258099
062590        WITH                                                      06259099
062600            POINTER PV-STRING-POINTER-WHERE.                      06260099
062610                                                                  06261099
062620     MOVE ZERO TO PV-TALLY-1                                      06262099
062630                  PV-TALLY-2.                                     06263099
062640                                                                  06264099
062650     MOVE ASC-VEND-STYL-NME TO PV-VEND-STYL-NME.                  06265099
062660     INSPECT PV-VEND-STYL-NME                                     06266099
062670        TALLYING PV-TALLY-1 FOR ALL '*'                           06267099
062680                 PV-TALLY-2 FOR ALL '?'                           06268099
062690        REPLACING ALL '*' BY '%'                                  06269099
062700                  ALL '?' BY '_'                                  06270099
062710                  ALL '''' BY '_'.                                06271099
062720                                                                  06272099
062730     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            06273099
062740        STRING                                                    06274099
062750            'K.VS_NBR LIKE '                   DELIMITED BY SIZE, 06275099
062760            PC-QUOTE                           DELIMITED BY SIZE, 06276099
062770            PV-VEND-STYL-NME                   DELIMITED BY '  ', 06277099
062780            PC-PERCENT                         DELIMITED BY SIZE, 06278099
062790            PC-QUOTE                           DELIMITED BY SIZE  06279099
062800        INTO                                                      06280099
062810            PV-WHERE-CLAUSE                                       06281099
062820        WITH                                                      06282099
062830            POINTER PV-STRING-POINTER-WHERE                       06283099
062840     ELSE                                                         06284099
062850        STRING                                                    06285099
062860            'K.VS_NBR LIKE '                   DELIMITED BY SIZE, 06286099
062870            PC-QUOTE                           DELIMITED BY SIZE, 06287099
062880            PV-VEND-STYL-NME                   DELIMITED BY '  ', 06288099
062890            PC-QUOTE                           DELIMITED BY SIZE  06289099
062900        INTO                                                      06290099
062910            PV-WHERE-CLAUSE                                       06291099
062920        WITH                                                      06292099
062930            POINTER PV-STRING-POINTER-WHERE                       06293099
062940     END-IF.                                                      06294099
062950 EJECT                                                            06295099
062960*----------------------------------------------------------------*06296099
062970*    DEFINE THE MAKER NAME                                       *06297099
062980*----------------------------------------------------------------*06298099
062990                                                                  06299099
063000 4123-MAKER-NME.                                                  06300099
063010                                                                  06301099
063020     IF PV-STRING-POINTER-WHERE > 1                               06302099
063030        STRING                                                    06303099
063040            ' AND '                           DELIMITED BY SIZE   06304099
063050        INTO                                                      06305099
063060            PV-WHERE-CLAUSE                                       06306099
063070        WITH                                                      06307099
063080            POINTER PV-STRING-POINTER-WHERE.                      06308099
063090                                                                  06309099
063100     MOVE ZERO TO PV-TALLY-1                                      06310099
063110                  PV-TALLY-2.                                     06311099
063120                                                                  06312099
063130     MOVE ASC-MAKER-NME TO PV-MAKER-DESC.                         06313099
063140     INSPECT PV-MAKER-DESC                                        06314099
063150        TALLYING PV-TALLY-1 FOR ALL '*'                           06315099
063160                 PV-TALLY-2 FOR ALL '?'                           06316099
063170        REPLACING ALL '*' BY '%'                                  06317099
063180                  ALL '?' BY '_'                                  06318099
063190                  ALL '''' BY '_'.                                06319099
063200                                                                  06320099
063210     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            06321099
063220        STRING                                                    06322099
063230            'M.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 06323099
063240            PC-QUOTE                           DELIMITED BY SIZE, 06324099
063250            PV-MAKER-DESC                      DELIMITED BY '  ', 06325099
063260            PC-PERCENT                         DELIMITED BY SIZE, 06326099
063270            PC-QUOTE                           DELIMITED BY SIZE  06327099
063280        INTO                                                      06328099
063290            PV-WHERE-CLAUSE                                       06329099
063300        WITH                                                      06330099
063310            POINTER PV-STRING-POINTER-WHERE                       06331099
063320     ELSE                                                         06332099
063330        STRING                                                    06333099
063340            'M.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 06334099
063350            PC-QUOTE                           DELIMITED BY SIZE, 06335099
063360            PV-MAKER-DESC                      DELIMITED BY '  ', 06336099
063370            PC-QUOTE                           DELIMITED BY SIZE  06337099
063380        INTO                                                      06338099
063390            PV-WHERE-CLAUSE                                       06339099
063400        WITH                                                      06340099
063410            POINTER PV-STRING-POINTER-WHERE                       06341099
063420     END-IF.                                                      06342099
063430 EJECT                                                            06343099
063440*----------------------------------------------------------------*06344099
063450*    SET UP THE PREPACK INDICATOR CLAUSE                         *06345099
063460*----------------------------------------------------------------*06346099
063470                                                                  06347099
063480 4124-PPI-IND.                                                    06348099
063490                                                                  06349099
063500     IF PV-STRING-POINTER-WHERE > 1                               06350099
063510        STRING                                                    06351099
063520            ' AND '                           DELIMITED BY SIZE   06352099
063530        INTO                                                      06353099
063540            PV-WHERE-CLAUSE                                       06354099
063550        WITH                                                      06355099
063560            POINTER PV-STRING-POINTER-WHERE.                      06356099
063570                                                                  06357099
063580     STRING                                                       06358099
063590         'A.PKGNG_CDE = '                     DELIMITED BY SIZE,  06359099
063600         PC-QUOTE                             DELIMITED BY SIZE,  06360099
063610         ASC-PRE-PACK-IND                     DELIMITED BY SIZE,  06361099
063620         PC-QUOTE                             DELIMITED BY SIZE   06362099
063630     INTO                                                         06363099
063640         PV-WHERE-CLAUSE                                          06364099
063650     WITH                                                         06365099
063660         POINTER PV-STRING-POINTER-WHERE.                         06366099
063670 EJECT                                                            06367099
063680*----------------------------------------------------------------*06368099
063690*    SET UP THE SHPDT DATE RANGE                                 *06369099
063700*----------------------------------------------------------------*06370099
063710                                                                  06371099
063720 4125-SHPDT-DTE-ONE.                                              06372099
063730                                                                  06373099
063740     IF PV-STRING-POINTER-WHERE > 1                               06374099
063750        STRING                                                    06375099
063760            ' AND '                           DELIMITED BY SIZE   06376099
063770        INTO                                                      06377099
063780            PV-WHERE-CLAUSE                                       06378099
063790        WITH                                                      06379099
063800            POINTER PV-STRING-POINTER-WHERE.                      06380099
063810                                                                  06381099
063820     STRING                                                       06382099
063830         'C.DONT_SHIP_BEF_DTE = '             DELIMITED BY SIZE,  06383099
063840         PC-QUOTE                             DELIMITED BY SIZE,  06384099
063850         ASC-SHPDT-BEF-DTE                    DELIMITED BY SIZE,  06385099
063860         PC-QUOTE                             DELIMITED BY SIZE   06386099
063870     INTO                                                         06387099
063880         PV-WHERE-CLAUSE                                          06388099
063890     WITH                                                         06389099
063900         POINTER PV-STRING-POINTER-WHERE.                         06390099
063910 EJECT                                                            06391099
063920*----------------------------------------------------------------*06392099
063930*    DEFINE THE SHIP DATE RANGE                                  *06393099
063940*----------------------------------------------------------------*06394099
063950                                                                  06395099
063960 4126-SHPDT-BEF-END-DTE.                                          06396099
063970                                                                  06397099
063980     IF PV-STRING-POINTER-WHERE > 1                               06398099
063990        STRING                                                    06399099
064000            ' AND '                           DELIMITED BY SIZE   06400099
064010        INTO                                                      06401099
064020            PV-WHERE-CLAUSE                                       06402099
064030        WITH                                                      06403099
064040            POINTER PV-STRING-POINTER-WHERE.                      06404099
064050                                                                  06405099
064060     STRING                                                       06406099
064070         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  06407099
064080         PC-QUOTE                             DELIMITED BY SIZE,  06408099
064090         ASC-SHPDT-BEF-DTE                    DELIMITED BY SIZE,  06409099
064100         PC-QUOTE                             DELIMITED BY SIZE,  06410099
064110         ' AND '                              DELIMITED BY SIZE,  06411099
064120         PC-QUOTE                             DELIMITED BY SIZE,  06412099
064130         ASC-SHPDT-END-DTE                    DELIMITED BY SIZE,  06413099
064140         PC-QUOTE                             DELIMITED BY SIZE,  06414099
064150         ')'                                  DELIMITED BY SIZE   06415099
064160     INTO                                                         06416099
064170         PV-WHERE-CLAUSE                                          06417099
064180     WITH                                                         06418099
064190         POINTER PV-STRING-POINTER-WHERE.                         06419099
064200 EJECT                                                            06420099
064210*----------------------------------------------------------------*06421099
064220*    DEFINE THE SHIP DATE RANGE FOR BEFORE ONLY                  *06422099
064230*----------------------------------------------------------------*06423099
064240                                                                  06424099
064250 4127-SHPDT-BEF-DTE.                                              06425099
064260                                                                  06426099
064270     IF PV-STRING-POINTER-WHERE > 1                               06427099
064280        STRING                                                    06428099
064290            ' AND '                           DELIMITED BY SIZE   06429099
064300        INTO                                                      06430099
064310            PV-WHERE-CLAUSE                                       06431099
064320        WITH                                                      06432099
064330            POINTER PV-STRING-POINTER-WHERE.                      06433099
064340                                                                  06434099
064350     STRING                                                       06435099
064360         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  06436099
064370         PC-QUOTE                             DELIMITED BY SIZE,  06437099
064380         ASC-SHPDT-BEF-DTE                    DELIMITED BY SIZE,  06438099
064390         PC-QUOTE                             DELIMITED BY SIZE,  06439099
064400         ' AND '                              DELIMITED BY SIZE,  06440099
064410         PC-QUOTE                             DELIMITED BY SIZE,  06441099
064420         ASC-SHPDT-END-DTE                    DELIMITED BY SIZE,  06442099
064430         PC-QUOTE                             DELIMITED BY SIZE,  06443099
064440         ')'                                  DELIMITED BY SIZE   06444099
064450     INTO                                                         06445099
064460         PV-WHERE-CLAUSE                                          06446099
064470     WITH                                                         06447099
064480         POINTER PV-STRING-POINTER-WHERE.                         06448099
064490 EJECT                                                            06449099
064500*----------------------------------------------------------------*06450099
064510*    DEFINE THE SHIP DATE RANGE FOR END ONLY                     *06451099
064520*----------------------------------------------------------------*06452099
064530                                                                  06453099
064540 4128-SHPDT-END-DTE.                                              06454099
064550                                                                  06455099
064560     IF PV-STRING-POINTER-WHERE > 1                               06456099
064570        STRING                                                    06457099
064580            ' AND '                           DELIMITED BY SIZE   06458099
064590        INTO                                                      06459099
064600            PV-WHERE-CLAUSE                                       06460099
064610        WITH                                                      06461099
064620            POINTER PV-STRING-POINTER-WHERE.                      06462099
064630                                                                  06463099
064640     STRING                                                       06464099
064650         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  06465099
064660         PC-QUOTE                             DELIMITED BY SIZE,  06466099
064670         ASC-SHPDT-BEF-DTE                    DELIMITED BY SIZE,  06467099
064680         PC-QUOTE                             DELIMITED BY SIZE,  06468099
064690         ' AND '                              DELIMITED BY SIZE,  06469099
064700         PC-QUOTE                             DELIMITED BY SIZE,  06470099
064710         ASC-SHPDT-END-DTE                    DELIMITED BY SIZE,  06471099
064720         PC-QUOTE                             DELIMITED BY SIZE,  06472099
064730         ')'                                  DELIMITED BY SIZE   06473099
064740     INTO                                                         06474099
064750         PV-WHERE-CLAUSE                                          06475099
064760     WITH                                                         06476099
064770         POINTER PV-STRING-POINTER-WHERE.                         06477099
064780 EJECT                                                            06478099
064790*----------------------------------------------------------------*06479099
064800*    SET UP THE POE CODE WHERE CLAUSE                            *06480099
064810*----------------------------------------------------------------*06481099
064820                                                                  06482099
064830 4129-POE-CDE.                                                    06483099
064840                                                                  06484099
064850     IF PV-STRING-POINTER-WHERE > 1                               06485099
064860        STRING                                                    06486099
064870            ' AND '                           DELIMITED BY SIZE   06487099
064880        INTO                                                      06488099
064890            PV-WHERE-CLAUSE                                       06489099
064900        WITH                                                      06490099
064910            POINTER PV-STRING-POINTER-WHERE.                      06491099
064920                                                                  06492099
064930     STRING                                                       06493099
064940         'C.POE_CDE = '                       DELIMITED BY SIZE,  06494099
064950         PC-QUOTE                             DELIMITED BY SIZE,  06495099
064960         ASC-POE-CDE                          DELIMITED BY SIZE,  06496099
064970         PC-QUOTE                             DELIMITED BY SIZE   06497099
064980     INTO                                                         06498099
064990         PV-WHERE-CLAUSE                                          06499099
065000     WITH                                                         06500099
065010         POINTER PV-STRING-POINTER-WHERE.                         06501099
065020 EJECT                                                            06502099
065030                                                                  06503099
065040*----------------------------------------------------------------*06504099
065050*    SET UP THE EDI INDICATOR                                    *06505099
065060*----------------------------------------------------------------*06506099
065070                                                                  06507099
065080 4130-EDI-IND.                                                    06508099
065090                                                                  06509099
065100     IF PV-STRING-POINTER-WHERE > 1                               06510099
065110        STRING                                                    06511099
065120            ' AND '                           DELIMITED BY SIZE   06512099
065130        INTO                                                      06513099
065140            PV-WHERE-CLAUSE                                       06514099
065150        WITH                                                      06515099
065160            POINTER PV-STRING-POINTER-WHERE.                      06516099
065170                                                                  06517099
065180     STRING                                                       06518099
065190         'A.EDI_IND = '                       DELIMITED BY SIZE,  06519099
065200         PC-QUOTE                             DELIMITED BY SIZE,  06520099
065210         ASC-EDI-IND                          DELIMITED BY SIZE,  06521099
065220         PC-QUOTE                             DELIMITED BY SIZE   06522099
065230     INTO                                                         06523099
065240         PV-WHERE-CLAUSE                                          06524099
065250     WITH                                                         06525099
065260         POINTER PV-STRING-POINTER-WHERE.                         06526099
065270                                                                  06527099
065280 EJECT                                                            06528099
065290*----------------------------------------------------------------*06529099
065300*    SET UP THE DIRECT STORE INDICATOR                           *06530099
065310*----------------------------------------------------------------*06531099
065320                                                                  06532099
065330 4131-DIR-STORE-IND.                                              06533099
065340                                                                  06534099
065350     IF PV-STRING-POINTER-WHERE > 1                               06535099
065360        STRING                                                    06536099
065370            ' AND '                           DELIMITED BY SIZE   06537099
065380        INTO                                                      06538099
065390            PV-WHERE-CLAUSE                                       06539099
065400        WITH                                                      06540099
065410            POINTER PV-STRING-POINTER-WHERE.                      06541099
065420                                                                  06542099
065430     STRING                                                       06543099
065440         'A.DIR_STR_IND = '                   DELIMITED BY SIZE,  06544099
065450         PC-QUOTE                             DELIMITED BY SIZE,  06545099
065460         ASC-DIRECT-STORE-IND                 DELIMITED BY SIZE,  06546099
065470         PC-QUOTE                             DELIMITED BY SIZE   06547099
065480     INTO                                                         06548099
065490         PV-WHERE-CLAUSE                                          06549099
065500     WITH                                                         06550099
065510         POINTER PV-STRING-POINTER-WHERE.                         06551099
065520                                                                  06552099
065530 EJECT                                                            06553099
065540*----------------------------------------------------------------*06554099
065550*    SET UP THE COUNTRY OF PRODUCTION CLAUSE                     *06555099
065560*----------------------------------------------------------------*06556099
065570                                                                  06557099
065580 4132-CNTRY-ORG.                                                  06558099
065590                                                                  06559099
065600     IF PV-STRING-POINTER-WHERE > 1                               06560099
065610        STRING                                                    06561099
065620            ' AND '                           DELIMITED BY SIZE   06562099
065630        INTO                                                      06563099
065640            PV-WHERE-CLAUSE                                       06564099
065650        WITH                                                      06565099
065660            POINTER PV-STRING-POINTER-WHERE.                      06566099
065670                                                                  06567099
065680     STRING                                                       06568099
065690         'A.PROD_CNTRY_CDE = '                DELIMITED BY SIZE,  06569099
065700         PC-QUOTE                             DELIMITED BY SIZE,  06570099
065710         ASC-KEY-CNTRY-ORG                    DELIMITED BY SIZE,  06571099
065720         PC-QUOTE                             DELIMITED BY SIZE   06572099
065730     INTO                                                         06573099
065740         PV-WHERE-CLAUSE                                          06574099
065750     WITH                                                         06575099
065760         POINTER PV-STRING-POINTER-WHERE.                         06576099
065770                                                                  06577099
065780 EJECT                                                            06578099
065790*----------------------------------------------------------------*06579099
065800*    SET UP THE COUNTRY OF PLACEMENT CLAUSE                      *06580099
065810*----------------------------------------------------------------*06581099
065820                                                                  06582099
065830 4133-CNTRY-PLC.                                                  06583099
065840                                                                  06584099
065850     IF PV-STRING-POINTER-WHERE > 1                               06585099
065860        STRING                                                    06586099
065870            ' AND '                           DELIMITED BY SIZE   06587099
065880        INTO                                                      06588099
065890            PV-WHERE-CLAUSE                                       06589099
065900        WITH                                                      06590099
065910            POINTER PV-STRING-POINTER-WHERE.                      06591099
065920                                                                  06592099
065930     STRING                                                       06593099
065940         'A.PLCMNT_CNTRY_CDE = '              DELIMITED BY SIZE,  06594099
065950         PC-QUOTE                             DELIMITED BY SIZE,  06595099
065960         ASC-KEY-CNTRY-PLC                    DELIMITED BY SIZE,  06596099
065970         PC-QUOTE                             DELIMITED BY SIZE   06597099
065980     INTO                                                         06598099
065990         PV-WHERE-CLAUSE                                          06599099
066000     WITH                                                         06600099
066010         POINTER PV-STRING-POINTER-WHERE.                         06601099
066020                                                                  06602099
066030 EJECT                                                            06603099
066040*----------------------------------------------------------------*06604099
066050*    SET UP THE SEASONAL SET CLAUSE                              *06605099
066060*----------------------------------------------------------------*06606099
066070                                                                  06607099
066080 4134-SEASONAL-SET.                                               06608099
066090                                                                  06609099
066100     IF PV-STRING-POINTER-WHERE > 1                               06610099
066110        STRING                                                    06611099
066120            ' AND '                           DELIMITED BY SIZE   06612099
066130        INTO                                                      06613099
066140            PV-WHERE-CLAUSE                                       06614099
066150        WITH                                                      06615099
066160            POINTER PV-STRING-POINTER-WHERE.                      06616099
066170                                                                  06617099
066180     STRING                                                       06618099
066190         'A.SEASET_SHRT_NM = '                DELIMITED BY SIZE,  06619099
066200         PC-QUOTE                             DELIMITED BY SIZE,  06620099
066210         ASC-SEASONAL-SET                     DELIMITED BY ' ',   06621099
066220         PC-QUOTE                             DELIMITED BY SIZE   06622099
066230     INTO                                                         06623099
066240         PV-WHERE-CLAUSE                                          06624099
066250     WITH                                                         06625099
066260         POINTER PV-STRING-POINTER-WHERE.                         06626099
066270                                                                  06627099
066280 EJECT                                                            06628099
066290*----------------------------------------------------------------*06629099
066300*    SET UP THE DMM CLAUSE                                       *06630099
066310*----------------------------------------------------------------*06631099
066320                                                                  06632099
066330 4135-DMM.                                                        06633099
066340                                                                  06634099
066350     IF PV-STRING-POINTER-WHERE > 1                               06635099
066360        STRING                                                    06636099
066370            ' AND '                           DELIMITED BY SIZE   06637099
066380        INTO                                                      06638099
066390            PV-WHERE-CLAUSE                                       06639099
066400        WITH                                                      06640099
066410            POINTER PV-STRING-POINTER-WHERE.                      06641099
066420                                                                  06642099
066430     STRING                                                       06643099
066440         'F.DMA_NBR = '                       DELIMITED BY SIZE,  06644099
066450         PC-QUOTE                             DELIMITED BY SIZE,  06645099
066460         ASC-DMM                              DELIMITED BY SIZE,  06646099
066470         PC-QUOTE                             DELIMITED BY SIZE   06647099
066480     INTO                                                         06648099
066490         PV-WHERE-CLAUSE                                          06649099
066500     WITH                                                         06650099
066510         POINTER PV-STRING-POINTER-WHERE.                         06651099
066520                                                                  06652099
066530 EJECT                                                            06653099
066540*----------------------------------------------------------------*06654099
066550*    SET UP THE GROUP CODE CLAUSE                                *06655099
066560*----------------------------------------------------------------*06656099
066570 4136-GROUP-CDE.                                                  06657099
066580                                                                  06658099
066590     IF PV-STRING-POINTER-WHERE > 1                               06659099
066600        STRING                                                    06660099
066610            ' AND '                           DELIMITED BY SIZE   06661099
066620        INTO                                                      06662099
066630            PV-WHERE-CLAUSE                                       06663099
066640        WITH                                                      06664099
066650            POINTER PV-STRING-POINTER-WHERE.                      06665099
066660                                                                  06666099
066670     STRING                                                       06667099
066680         'G.GP_CDE = '                        DELIMITED BY SIZE,  06668099
066690         PC-QUOTE                             DELIMITED BY SIZE,  06669099
066700         ASC-GROUP-CDE                        DELIMITED BY ' ',   06670099
066710         PC-QUOTE                             DELIMITED BY SIZE   06671099
066720     INTO                                                         06672099
066730         PV-WHERE-CLAUSE                                          06673099
066740     WITH                                                         06674099
066750         POINTER PV-STRING-POINTER-WHERE.                         06675099
066760                                                                  06676099
066770 EJECT                                                            06677099
066780*----------------------------------------------------------------*06678099
066790*    STRING TOGETHER THE CODE TO BUILD DYNAMIC SQL CURSOR        *06679099
066800*----------------------------------------------------------------*06680099
066810                                                                  06681099
066820 4150-COMBINE-DYNAMIC-SQL.                                        06682099
066830                                                                  06683099
066840     MOVE SPACES TO PV-SQL-STMT-TEXT.                             06684099
066850                                                                  06685099
066860     STRING PV-SELECT-CLAUSE                  DELIMITED BY SIZE,  06686099
066870            ' FROM '                          DELIMITED BY SIZE,  06687099
066880            PV-FROM-CLAUSE                    DELIMITED BY '  ',  06688099
066890            ' WHERE '                         DELIMITED BY SIZE,  06689099
066900            PV-WHERE-CLAUSE                   DELIMITED BY '  '   06690099
066910     INTO                                                         06691099
066920         PV-SQL-STMT-TEXT.                                        06692099
066930                                                                  06693099
066940     IF ASC-WRITE-TO-CSSL                                         06694099
066950       PERFORM 10001-ASK-CICS-FOR-TIME                            06695099
066960       PERFORM 10005-FORMAT-CICS-TIME                             06696099
066970       IF PV-WHERE-CLAUSE (1:100) NOT = SPACES                    06697099
066980          STRING                                                  06698099
066990           ' Y196'                      DELIMITED BY SIZE,        06699099
067000           '|'                          DELIMITED BY SIZE,        06700099
067010           DP020-USERID (1:7)           DELIMITED BY SIZE,        06701099
067020           '|'                          DELIMITED BY SIZE,        06702099
067030           ASC-CICS-TIME (1:5)          DELIMITED BY SIZE,        06703099
067040           '|'                          DELIMITED BY SIZE,        06704099
067050           PV-WHERE-CLAUSE (1:100)      DELIMITED BY SIZE         06705099
067060           INTO                                                   06706099
067070           PV-CICS-MSG-SQL1                                       06707099
067080       END-IF                                                     06708099
067090       IF PV-WHERE-CLAUSE (101:100) NOT = SPACES                  06709099
067100          STRING                                                  06710099
067110           ' Y196'                      DELIMITED BY SIZE,        06711099
067120           '|'                          DELIMITED BY SIZE,        06712099
067130           DP020-USERID (1:7)           DELIMITED BY SIZE,        06713099
067140           '|'                          DELIMITED BY SIZE,        06714099
067150           ASC-CICS-TIME (1:5)          DELIMITED BY SIZE,        06715099
067160           '|'                          DELIMITED BY SIZE,        06716099
067170           PV-WHERE-CLAUSE (101:100)    DELIMITED BY SIZE         06717099
067180           INTO                                                   06718099
067190           PV-CICS-MSG-SQL2                                       06719099
067200       END-IF                                                     06720099
067210       IF PV-WHERE-CLAUSE (201:100) NOT = SPACES                  06721099
067220          STRING                                                  06722099
067230           ' Y196'                      DELIMITED BY SIZE,        06723099
067240           '|'                          DELIMITED BY SIZE,        06724099
067250           DP020-USERID (1:7)           DELIMITED BY SIZE,        06725099
067260           '|'                          DELIMITED BY SIZE,        06726099
067270           ASC-CICS-TIME (1:5)          DELIMITED BY SIZE,        06727099
067280           '|'                          DELIMITED BY SIZE,        06728099
067290           PV-WHERE-CLAUSE (201:100)    DELIMITED BY SIZE         06729099
067300           INTO                                                   06730099
067310           PV-CICS-MSG-SQL3                                       06731099
067320       END-IF                                                     06732099
067330       IF PV-WHERE-CLAUSE (301:100) NOT = SPACES                  06733099
067340          STRING                                                  06734099
067350           ' Y196'                      DELIMITED BY SIZE,        06735099
067360           '|'                          DELIMITED BY SIZE,        06736099
067370           DP020-USERID (1:7)           DELIMITED BY SIZE,        06737099
067380           '|'                          DELIMITED BY SIZE,        06738099
067390           ASC-CICS-TIME (1:5)          DELIMITED BY SIZE,        06739099
067400           '|'                          DELIMITED BY SIZE,        06740099
067410           PV-WHERE-CLAUSE (301:100)    DELIMITED BY SIZE         06741099
067420           INTO                                                   06742099
067430           PV-CICS-MSG-SQL4                                       06743099
067440       END-IF                                                     06744099
067450       IF PV-WHERE-CLAUSE (401:100) NOT = SPACES                  06745099
067460          STRING                                                  06746099
067470           ' Y196'                      DELIMITED BY SIZE,        06747099
067480           '|'                          DELIMITED BY SIZE,        06748099
067490           DP020-USERID (1:7)           DELIMITED BY SIZE,        06749099
067500           '|'                          DELIMITED BY SIZE,        06750099
067510           ASC-CICS-TIME (1:5)          DELIMITED BY SIZE,        06751099
067520           '|'                          DELIMITED BY SIZE,        06752099
067530           PV-WHERE-CLAUSE (401:100)    DELIMITED BY SIZE         06753099
067540           INTO                                                   06754099
067550           PV-CICS-MSG-SQL5                                       06755099
067560       END-IF                                                     06756099
067570     END-IF.                                                      06757099
067580                                                                  06758099
067590     ADD PV-SELECT-BYTES                                          06759099
067600         PC-CNT-7                                                 06760099
067610         PV-STRING-POINTER-FROM                                   06761099
067620         PC-CNT-7                                                 06762099
067630         PV-STRING-POINTER-WHERE                                  06763099
067640         PC-CNT-MINUS-2                                           06764099
067650     GIVING                                                       06765099
067660         PV-SQL-STMT-LEN.                                         06766099
067670 4150-EXIT.                                                       06767099
067680     EXIT.                                                        06768099
067690 EJECT                                                            06769099
067700*----------------------------------------------------------------*06770099
067710*  WRITE THE SELECT STATEMENT TO THE JCL QUEUE                   *06771099
067720*----------------------------------------------------------------*06772099
067730                                                                  06773099
067740 4151-WRITE-JCL-QUEUE.                                            06774099
067750                                                                  06775099
067760     MOVE +1                   TO PV-JCL-NUMBER.                  06776099
067770     EXEC CICS                                                    06777099
067780         WRITEQ TS                                                06778099
067790             QUEUE (ASC-JCL-QUEUE-NAME)                           06779099
067800             FROM  (PV-SQL-STMT-TEXT)                             06780099
067810             ITEM  (PV-JCL-NUMBER)                                06781099
067820             RESP  (PV-CICS-RESP)                                 06782099
067830     END-EXEC.                                                    06783099
067840                                                                  06784099
067850     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           06785099
067860         CONTINUE                                                 06786099
067870     ELSE                                                         06787099
067880         SET DP013-CICS-ABEND            TO TRUE                  06788099
067890         SET DP013-NO-ROLLBACK           TO TRUE                  06789099
067900         MOVE '4151-WRITE-JCL-QUEUE  '   TO DP013-PARAGRAPH       06790099
067910         MOVE 'ATTEMPTING TO WRITE JCL TEMP STORAGE QUEUE   '     06791099
067920                                         TO DP013-MESSAGE-TEXT(1) 06792099
067930         PERFORM DP013-0000-PROCESS-ABEND                         06793099
067940     END-IF.                                                      06794099
067950                                                                  06795099
067960 4151-EXIT.                                                       06796099
067970     EXIT.                                                        06797099
067980 EJECT                                                            06798099
067990*----------------------------------------------------------------*06799099
068000*    READ THE SQL STATEMENT FROM THE STORAGE QUEUE               *06800099
068010*----------------------------------------------------------------*06801099
068020 4152-READ-JCL-QUEUE.                                             06802099
068030                                                                  06803099
068040     MOVE +1                   TO PV-JCL-NUMBER.                  06804099
068050     EXEC CICS                                                    06805099
068060         READQ TS                                                 06806099
068070             QUEUE (ASC-JCL-QUEUE-NAME)                           06807099
068080             INTO  (PV-SQL-STMT-TEXT)                             06808099
068090             ITEM  (PV-JCL-NUMBER)                                06809099
068100             RESP  (PV-CICS-RESP)                                 06810099
068110     END-EXEC.                                                    06811099
068120*                                                                 06812099
068130     IF   (PV-CICS-RESP = DFHRESP (NORMAL))                       06813099
068140*****  OR (PV-CICS-RESP = DFHRESP (ITEMERR))                      06814099
068150         CONTINUE                                                 06815099
068160     ELSE                                                         06816099
068170         SET DP030-OVERRIDE-GO                                    06817099
068180             PS-ERROR                                             06818099
068190             DP020-MSG-WARNING TO TRUE                            06819099
068200         MOVE PC-TSYMSG-02667 TO DP020-MSG-NUMBER                 06820099
068210     END-IF.                                                      06821099
068220 4152-EXIT.                                                       06822099
068230     EXIT.                                                        06823099
068240*                                                                 06824099
068250 EJECT                                                            06825099
068260*----------------------------------------------------------------*06826099
068270*    DELETE THE JCL TEMP STORAGE QUEUE.                          *06827099
068280*----------------------------------------------------------------*06828099
068290                                                                  06829099
068300 4153-DELETE-JCL-QUEUE.                                           06830099
068310                                                                  06831099
068320     EXEC CICS                                                    06832099
068330         DELETEQ TS                                               06833099
068340             QUEUE (ASC-JCL-QUEUE-NAME)                           06834099
068350             RESP  (PV-CICS-RESP)                                 06835099
068360     END-EXEC.                                                    06836099
068370                                                                  06837099
068380     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      06838099
068390        (PV-CICS-RESP = DFHRESP(QIDERR)))                         06839099
068400         CONTINUE                                                 06840099
068410     ELSE                                                         06841099
068420         SET DP013-CICS-ABEND TO TRUE                             06842099
068430         SET DP013-NO-ROLLBACK TO TRUE                            06843099
068440         MOVE '4153-DELETE-JCL-QUEUE'                             06844099
068450                        TO DP013-PARAGRAPH                        06845099
068460         MOVE 'ERROR TRYING TO DELETE THE  JCL  TS QUEUE'         06846099
068470                        TO DP013-MESSAGE-TEXT (1)                 06847099
068480         PERFORM DP013-0000-PROCESS-ABEND                         06848099
068490     END-IF.                                                      06849099
068500 4153-EXIT.                                                       06850099
068510     EXIT.                                                        06851099
068520                                                                  06852099
068530 EJECT                                                            06853099
068540*----------------------------------------------------------------*06854099
068550*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *06855099
068560*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *06856099
068570*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *06857099
068580*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *06858099
068590*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *06859099
068600*                                                                *06860099
068610*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *06861099
068620*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *06862099
068630*    UPON INITIALIZATION.                                        *06863099
068640*----------------------------------------------------------------*06864099
068650                                                                  06865099
068660 4300-READ-ITEMS-FROM-DB.                                         06866099
068670                                                                  06867099
068680     COMPUTE PV-MAX-ITEMS =                                       06868099
068690             ((ASC-MAX-GROUPS * PC-ITEMS-PER-PANEL)               06869099
068700             * PC-MAX-BLOCKS-IN-ARRAY).                           06870099
068710                                                                  06871099
068720     PERFORM                                                      06872099
068730         VARYING PV-READ-COUNT                                    06873099
068740         FROM 1 BY 1                                              06874099
068750         UNTIL ((PV-READ-COUNT > PV-MAX-ITEMS)                    06875099
068760            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         06876099
068770                                                                  06877099
068780         PERFORM 4311-FETCH-PO-QUEUE                              06878099
068790                                                                  06879099
068800         MOVE 'N'                  TO PS-SKIP-SW                  06880099
068810                                                                  06881099
068820         IF  ASC-ITEMS-LEFT-ON-DB                                 06882099
068830         IF  ASC-STR-NBR > ZERO                                   06883099
068840             INITIALIZE PV-DB2-COUNT                              06884099
068850             MOVE ASC-STR-NBR      TO DK-STR-NBR                  06885099
068860             PERFORM 9770-CHECK-STORE-ALLOC                       06886099
068870             IF  PV-DB2-COUNT = +0                                06887099
068880                 SET PS-SKIP       TO TRUE                        06888099
068890             END-IF                                               06889099
068900         END-IF                                                   06890099
068910                                                                  06891099
068920         IF  ASC-PRE-TICKET-IND > SPACES                          06892099
068930             INITIALIZE PV-DB2-COUNT                              06893099
068940             MOVE '4'              TO DK-AGRMT-TYP-ID             06894099
068950             MOVE 1                TO DK-TYP-CDE                  06895099
068960             PERFORM 9780-CHECK-SERVICE                           06896099
068970             IF  ASC-PRE-TICKET-IND = 'Y'                         06897099
068980                 IF  PV-DB2-COUNT = +0                            06898099
068990                     SET PS-SKIP   TO TRUE                        06899099
069000                 END-IF                                           06900099
069010             ELSE                                                 06901099
069020                 IF  PV-DB2-COUNT > +0                            06902099
069030                     SET PS-SKIP   TO TRUE                        06903099
069040                 END-IF                                           06904099
069050             END-IF                                               06905099
069060         END-IF                                                   06906099
069070                                                                  06907099
069080         IF  ASC-PACK-BY-STORE-IND > SPACES                       06908099
069090           AND  ASC-PACK-BY-STORE-IND   NOT =  'Y'                06909099
069100             INITIALIZE PV-DB2-COUNT                              06910099
069110             MOVE '4'              TO DK-AGRMT-TYP-ID             06911099
069120             MOVE 4                TO DK-TYP-CDE                  06912099
069130             PERFORM 9780-CHECK-SERVICE                           06913099
069140***          IF  ASC-PACK-BY-STORE-IND = 'Y'                      06914099
069150***              IF  PV-DB2-COUNT = +0                            06915099
069160***                  SET PS-SKIP   TO TRUE                        06916099
069170***              END-IF                                           06917099
069180***          ELSE                                                 06918099
069190                 IF  PV-DB2-COUNT > +0                            06919099
069200                     SET PS-SKIP   TO TRUE                        06920099
069210                 END-IF                                           06921099
069220***          END-IF                                               06922099
069230         END-IF                                                   06923099
069240         IF PS-SKIP                                               06924099
069250            SUBTRACT 1 FROM ASC-NBR-OF-POS-DISPLAYED              06925099
069260            ADD 1 TO PV-MAX-ITEMS                                 06926099
069270         END-IF                                                   06927099
069280         END-IF                                                   06928099
069290                                                                  06929099
069300                                                                  06930099
069310         IF  ASC-ITEMS-LEFT-ON-DB                                 06931099
069320         AND PS-DONT-SKIP                                         06932099
069330             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                06933099
069340                 ADD +1            TO ASC-ITEM-SUB                06934099
069350             ELSE                                                 06935099
069360                 ADD +1            TO ASC-BLK-SUB                 06936099
069370                 MOVE +1           TO ASC-ITEM-SUB                06937099
069380                                                                  06938099
069390                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         06939099
069400                     MOVE +1       TO ASC-BLK-SUB                 06940099
069410                     SET ASC-BLOCK-MODIFIED (1)                   06941099
069420                                              TO TRUE             06942099
069430                     PERFORM 5100-WRITE-TEMP-STORAGE              06943099
069440                     MOVE ASC-BLOCK-ENTRIES                       06944099
069450                               (PC-MAX-BLOCKS-IN-ARRAY)           06945099
069460                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 06946099
069470                     MOVE EXT-BLOCK-ENTRIES                       06947099
069480                               (PC-MAX-BLOCKS-IN-ARRAY)           06948099
069490                                TO EXT-BLOCK-ENTRIES(ASC-BLK-SUB) 06949099
069500                     ADD +1        TO ASC-BLK-SUB                 06950099
069510                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   06951099
069520                     INITIALIZE EXT-BLOCK-ENTRIES (ASC-BLK-SUB)   06952099
069530                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      06953099
069540                                   TO  TRUE                       06954099
069550                 END-IF                                           06955099
069560             END-IF                                               06956099
069570             ADD +1                  TO  ASC-NUMBER-OF-ITEMS-READ 06957099
069580             MOVE ASC-NUMBER-OF-ITEMS-READ                        06958099
069590                                     TO  ASC-LIST-ITEM-NUMBER     06959099
069600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 06960099
069610             MOVE ASC-NUMBER-OF-ITEMS-READ                        06961099
069620                                     TO  EXT-LIST-ITEM-NUMBER     06962099
069630                                       (ASC-BLK-SUB ASC-ITEM-SUB) 06963099
069640             MOVE DK-PO-NBR                                       06964099
069650                         TO ASC-PO (ASC-BLK-SUB ASC-ITEM-SUB)     06965099
069660             MOVE DK-PO-NBR                                       06966099
069670                         TO EXT-PO (ASC-BLK-SUB ASC-ITEM-SUB)     06967099
069680             PERFORM 9600-DB2-LOAD-PO-DATA                        06968099
069690             PERFORM 9610-DB2-LOAD-IMPORT-DATA                    06969099
069700             PERFORM 9620-DB2-LOAD-DC-DATA                        06970099
069710             MOVE SPACES TO ENTNME-ENT-NAME-DESC                  06971099
069720             PERFORM 9910-GET-VENDOR-SHORT-NAME                   06972099
069730             IF  SQLCODE = +100                                   06973099
069740                 PERFORM 9920-GET-VENDOR-PRIMARY-NAME             06974099
069750             END-IF                                               06975099
069760             MOVE ENTNME-ENT-NAME-DESC                            06976099
069770                         TO ASC-VND (ASC-BLK-SUB ASC-ITEM-SUB)    06977099
069780             MOVE SPACES TO MDSEAR-DMA-NBR                        06978099
069790             PERFORM 9923-SELECT-DMM-NBR                          06979099
069800             MOVE MDSEAR-DMA-NBR                                  06980099
069810                  TO ASC-DMM-FIXED (ASC-BLK-SUB ASC-ITEM-SUB)     06981099
069820         END-IF                                                   06982099
069830     END-PERFORM.                                                 06983099
069840                                                                  06984099
069850     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          06985099
069860         MOVE +1               TO ASC-BLK-SUB                     06986099
069870         PERFORM 5100-WRITE-TEMP-STORAGE                          06987099
069880         ADD +1                TO ASC-BLK-SUB                     06988099
069890         PERFORM 5100-WRITE-TEMP-STORAGE                          06989099
069900     END-IF.                                                      06990099
069910                                                                  06991099
069920                                                                  06992099
069930 EJECT                                                            06993099
069940*----------------------------------------------------------------*06994099
069950*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *06995099
069960*    ARRAY.  WHENEVER THE PO ARRAY TABLE BECOMES FULL, WRITE     *06996099
069970*    OUT TO THE PO TEMPORARY STORAGE QUEUE AND INITIALIZE THE    *06997099
069980*    ARRAY MAKING IT AVAILABLE TO BE USED.                       *06998099
069990*----------------------------------------------------------------*06999099
070000                                                                  07000099
070010 4301-READ-ITEMS-FROM-DY-CURSOR.                                  07001099
070020                                                                  07002099
070030     PERFORM                                                      07003099
070040         VARYING PV-READ-COUNT                                    07004099
070050         FROM 1 BY 1                                              07005099
070060         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    07006099
070070            OR (ASC-NO-ITEMS-LEFT-ON-PO))                         07007099
070080                                                                  07008099
070090         PERFORM 4310-FETCH                                       07009099
070100                                                                  07010099
070110         IF  ASC-ITEMS-LEFT-ON-PO                                 07011099
070120          AND DK-PO-NBR NOT = PV-SV-PO-NBR                        07012099
070130             IF  ASC-POQ-ITEM-SUB < PC-ITEMS-PER-PO-QUEUE         07013099
070140                 ADD +1 TO ASC-POQ-ITEM-SUB                       07014099
070150             ELSE                                                 07015099
070160                 PERFORM 5111-WRITE-PO-QUEUE                      07016099
070170                 ADD +1 TO ASC-POQ-BLK-SUB                        07017099
070180                 MOVE +1 TO ASC-POQ-ITEM-SUB                      07018099
070190                 INITIALIZE POQ-LIST-QUEUE-WORK-AREA              07019099
070200             END-IF                                               07020099
070210                                                                  07021099
070220             ADD +1         TO  ASC-NUMBER-OF-POS-READ            07022099
070230             MOVE DK-PO-NBR TO POQ-PO (ASC-POQ-ITEM-SUB)          07023099
070240             MOVE DK-PO-NBR TO PV-SV-PO-NBR                       07024099
070250                                                                  07025099
070260             IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'           07026099
070270             OR PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'           07027099
070280             OR PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'           07028099
070290             OR PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'           07029099
070300             OR PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'           07030099
070310             OR PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'           07031099
070320                PERFORM 9930-GET-DOLLARS-RECEIVED                 07032099
070330                PERFORM 9950-GET-UNITS-RECEIVED                   07033099
070340                PERFORM 9970-GET-TOTAL-COST                       07034099
070350                PERFORM 9975-GET-TOTAL-VERIFIED-COST              07035099
070360                MOVE PV-TOT-FIRST-COST                            07036099
070370                     TO POQ-FSC (ASC-POQ-ITEM-SUB)                07037099
070380                MOVE PV-TOT-TTC                                   07038099
070390                     TO POQ-TTC (ASC-POQ-ITEM-SUB)                07039099
070400                MOVE PV-TOT-TVC                                   07040099
070410                     TO POQ-TVC (ASC-POQ-ITEM-SUB)                07041099
070420                MOVE PURCHS-TOT-VAL-RTL-AMT                       07042099
070430                     TO POQ-DOR (ASC-POQ-ITEM-SUB)                07043099
070440                MOVE PV-DOLLARS-RECEIVED                          07044099
070450                     TO POQ-DRC (ASC-POQ-ITEM-SUB)                07045099
070460                MOVE PV-UNITS-RECEIVED                            07046099
070470                     TO POQ-URC (ASC-POQ-ITEM-SUB)                07047099
070480                MOVE PURCHS-TOT-UNT-QTY                           07048099
070490                     TO POQ-UOR (ASC-POQ-ITEM-SUB)                07049099
070500***** DD START                                                    07050099
070510                IF ASC-PRE-TICKET-IND > SPACES                    07051099
070520                OR ASC-PACK-BY-STORE-IND > SPACES                 07052099
070530                    PERFORM 4302-CHECK-PBS-AND-PRTKT              07053099
070540                    IF PS-INCLUDE-TOTALS                          07054099
070550                        ADD PV-UNITS-RECEIVED TO ASC-TURC         07055099
070560                        ADD PURCHS-TOT-UNT-QTY TO ASC-TUOR        07056099
070570                        ADD PV-TOT-FIRST-COST TO ASC-TFSC         07057099
070580                        ADD PV-TOT-TTC      TO ASC-TTTC           07058099
070590                        ADD PV-TOT-TVC      TO ASC-TTVC           07059099
070600                        ADD PURCHS-TOT-VAL-RTL-AMT TO ASC-TDOR    07060099
070610                        ADD PV-DOLLARS-RECEIVED TO ASC-TDRC       07061099
070620                    END-IF                                        07062099
070630                ELSE                                              07063099
070640                    ADD PV-UNITS-RECEIVED TO ASC-TURC             07064099
070650                    ADD PURCHS-TOT-UNT-QTY TO ASC-TUOR            07065099
070660                    ADD PV-TOT-FIRST-COST TO ASC-TFSC             07066099
070670                    ADD PV-TOT-TTC          TO ASC-TTTC           07067099
070680                    ADD PV-TOT-TVC          TO ASC-TTVC           07068099
070690                    ADD PURCHS-TOT-VAL-RTL-AMT TO ASC-TDOR        07069099
070700                    ADD PV-DOLLARS-RECEIVED TO ASC-TDRC           07070099
070710                 END-IF                                           07071099
070720***** DD END                                                      07072099
070730             END-IF                                               07073099
070740         END-IF                                                   07074099
070750     END-PERFORM.                                                 07075099
070760                                                                  07076099
070770     IF  ASC-NUMBER-OF-POS-READ > ZERO                            07077099
070780         PERFORM 5111-WRITE-PO-QUEUE                              07078099
070790     END-IF.                                                      07079099
070800                                                                  07080099
070810 EJECT                                                            07081099
070820***** DD START                                                    07082099
070830*----------------------------------------------------------------*07083099
070840*    CHECK PACK BY STORE AND PRE-TICKET INDICATORS               *07084099
070850*----------------------------------------------------------------*07085099
070860                                                                  07086099
070870 4302-CHECK-PBS-AND-PRTKT.                                        07087099
070880                                                                  07088099
070890     MOVE 'N' TO PS-INCLUDE-TOTALS-SW.                            07089099
070900                                                                  07090099
070910     IF ASC-PRE-TICKET-IND > SPACES                               07091099
070920         INITIALIZE PV-DB2-COUNT                                  07092099
070930         MOVE '4'                  TO DK-AGRMT-TYP-ID             07093099
070940         MOVE 1                    TO DK-TYP-CDE                  07094099
070950         PERFORM 9780-CHECK-SERVICE                               07095099
070960         IF ASC-PRE-TICKET-IND = 'Y'                              07096099
070970             IF PV-DB2-COUNT > +0                                 07097099
070980                 SET PS-INCLUDE-TOTALS TO TRUE                    07098099
070990             END-IF                                               07099099
071000         ELSE                                                     07100099
071010             IF PV-DB2-COUNT = +0                                 07101099
071020                 SET PS-INCLUDE-TOTALS TO TRUE                    07102099
071030             END-IF                                               07103099
071040         END-IF                                                   07104099
071050     END-IF.                                                      07105099
071060                                                                  07106099
071070     IF ASC-PACK-BY-STORE-IND > SPACES                            07107099
071080       IF ASC-PACK-BY-STORE-IND  =  'Y'                           07108099
071090          SET PS-INCLUDE-TOTALS TO TRUE                           07109099
071100       ELSE                                                       07110099
071110          INITIALIZE PV-DB2-COUNT                                 07111099
071120          MOVE '4'                  TO DK-AGRMT-TYP-ID            07112099
071130          MOVE 4                    TO DK-TYP-CDE                 07113099
071140          PERFORM 9780-CHECK-SERVICE                              07114099
071150          IF PV-DB2-COUNT = +0                                    07115099
071160             SET PS-INCLUDE-TOTALS TO TRUE                        07116099
071170          END-IF                                                  07117099
071180       END-IF                                                     07118099
071190     END-IF.                                                      07119099
071200                                                                  07120099
071210***** DD END                                                      07121099
071220                                                                  07122099
071230*----------------------------------------------------------------*07123099
071240*    FETCH THE FIRST CURSOR                                      *07124099
071250*----------------------------------------------------------------*07125099
071260                                                                  07126099
071270 4310-FETCH.                                                      07127099
071280*                                                                 07128099
071290     IF ASC-SORT1-BY-IND = 'V'                                    07129099
071300      OR ASC-SORT2-BY-IND = 'V'                                   07130099
071310       EXEC SQL                                                   07131099
071320         FETCH PO-CSR                                             07132099
071330         INTO  :PV-PO-NBR-IN                                      07133099
071340              ,:PV-FOB-CDE-IN                                     07134099
071350              ,:PV-DEPT-NBR                                       07135099
071360              ,:PLNSHP-LAST-FCTRY-DTE                             07136099
071370              ,:PLNSHP-DONT-SHIP-BEF-DTE                          07137099
071380              ,:PURCHS-TOT-VAL-RTL-AMT                            07138099
071390              ,:PURCHS-TOT-UNT-QTY                                07139099
071400              ,:XLT00004-VS-NBR                                   07140099
071410       END-EXEC                                                   07141099
071420     ELSE                                                         07142099
071430       EXEC SQL                                                   07143099
071440         FETCH PO-CSR                                             07144099
071450         INTO  :PV-PO-NBR-IN                                      07145099
071460              ,:PV-FOB-CDE-IN                                     07146099
071470              ,:PV-DEPT-NBR                                       07147099
071480              ,:PLNSHP-LAST-FCTRY-DTE                             07148099
071490              ,:PLNSHP-DONT-SHIP-BEF-DTE                          07149099
071500              ,:PURCHS-TOT-VAL-RTL-AMT                            07150099
071510              ,:PURCHS-TOT-UNT-QTY                                07151099
071520       END-EXEC                                                   07152099
071530     END-IF                                                       07153099
071540*                                                                 07154099
071550     EVALUATE TRUE                                                07155099
071560         WHEN SQLCODE = ZERO                                      07156099
071570              MOVE PV-PO-NBR-IN TO DK-PO-NBR                      07157099
071580         WHEN SQLCODE = +100                                      07158099
071590              CONTINUE                                            07159099
071600         WHEN SQLWARN0 NOT = SPACE                                07160099
071610         WHEN SQLCODE NOT = ZERO                                  07161099
071620              MOVE '4310-FETCH'                                   07162099
071630                               TO DP013-PARAGRAPH                 07163099
071640              MOVE 'FETCH PO CURSOR'                              07164099
071650                               TO DP013-MESSAGE-TEXT (1)          07165099
071660              MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)        07166099
071670              MOVE 'TPLNSHP'   TO DP013-DB2-TABLE-NAME (3)        07167099
071680              MOVE SQLCA       TO DP013-SQLCA                     07168099
071690              SET DP013-DB2-ABEND                                 07169099
071700                               TO TRUE                            07170099
071710              PERFORM DP013-0000-PROCESS-ABEND                    07171099
071720     END-EVALUATE                                                 07172099
071730     IF  SQLCODE EQUAL +100                                       07173099
071740         SET ASC-NO-ITEMS-LEFT-ON-PO                              07174099
071750                                   TO TRUE                        07175099
071760     END-IF.                                                      07176099
071770*                                                                 07177099
071780 EJECT                                                            07178099
071790*----------------------------------------------------------------*07179099
071800*    FETCH FROM THE PO WORK STORAGE QUEUE.                       *07180099
071810*----------------------------------------------------------------*07181099
071820                                                                  07182099
071830 4311-FETCH-PO-QUEUE.                                             07183099
071840*                                                                 07184099
071850     ADD +1 TO ASC-POQ-LAST-SUB                                   07185099
071860     IF  ASC-POQ-LAST-SUB > ASC-NUMBER-OF-POS-READ                07186099
071870         SET ASC-NO-ITEMS-LEFT-ON-DB                              07187099
071880                                   TO TRUE                        07188099
071890     END-IF.                                                      07189099
071900*                                                                 07190099
071910     IF  ASC-ITEMS-LEFT-ON-DB                                     07191099
071920         IF  ASC-POQ-ITEM-SUB < PC-ITEMS-PER-PO-QUEUE             07192099
071930             ADD +1 TO ASC-POQ-ITEM-SUB                           07193099
071940         ELSE                                                     07194099
071950             ADD +1 TO ASC-POQ-BLK-SUB                            07195099
071960             MOVE +1 TO ASC-POQ-ITEM-SUB                          07196099
071970             PERFORM 4411-READ-PO-QUEUE-STORAGE                   07197099
071980         END-IF                                                   07198099
071990         MOVE POQ-PO (ASC-POQ-ITEM-SUB) TO DK-PO-NBR              07199099
072000     END-IF.                                                      07200099
072010*                                                                 07201099
072020 EJECT                                                            07202099
072030*----------------------------------------------------------------*07203099
072040* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *07204099
072050*----------------------------------------------------------------*07205099
072060                                                                  07206099
072070 4400-MOVE-COMMAREA-TO-SCREEN.                                    07207099
072080                                                                  07208099
072090     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             07209099
072100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          07210099
072110         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          07211099
072120             MOVE +1    TO ASC-BLK-SUB                            07212099
072130             PERFORM 5100-WRITE-TEMP-STORAGE                      07213099
072140             ADD +1     TO ASC-BLK-SUB                            07214099
072150             PERFORM 5100-WRITE-TEMP-STORAGE                      07215099
072160             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             07216099
072170                 GIVING PV-BLOCK-NUMBER                           07217099
072180                 REMAINDER PV-REMAINDER                           07218099
072190             IF  PV-REMAINDER > ZERO                              07219099
072200                 ADD +1 TO PV-BLOCK-NUMBER                        07220099
072210             END-IF                                               07221099
072220             MOVE +1    TO ASC-BLK-SUB                            07222099
072230             PERFORM 4410-READ-TEMP-STORAGE                       07223099
072240             ADD +1     TO ASC-BLK-SUB                            07224099
072250                           PV-BLOCK-NUMBER                        07225099
072260             PERFORM 4410-READ-TEMP-STORAGE                       07226099
072270     END-IF.                                                      07227099
072280*                                                                 07228099
072290     PERFORM 4401-RELOAD-EXTENDED-STORAGE.                        07229099
072300*                                                                 07230099
072310     MOVE +1            TO ASC-BLK-SUB.                           07231099
072320*                                                                 07232099
072330     COMPUTE ASC-ITEM-SUB =                                       07233099
072340         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              07234099
072350         + PC-ITEMS-PER-PANEL).                                   07235099
072360*                                                                 07236099
072370     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        07237099
072380         ADD +1         TO ASC-BLK-SUB                            07238099
072390         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            07239099
072400     END-IF.                                                      07240099
072410*                                                                 07241099
072420     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           07242099
072430         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                07243099
072440     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        07244099
072450                                                                  07245099
072460*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*07246099
072470* BUILD VARIABLE HEADER PART                                     *07247099
072480*----------------------------------------------------------------*07248099
072490     IF  ASC-SEL-VARIABLE-SCREEN NOT =                            07249099
072500                         ASC-REDRAW-VARIABLE-SCREEN               07250099
072510         SET DISPLAY-HEADER TO TRUE                               07251099
072520         PERFORM 9500-FORMAT-VARIABLE-DATA                        07252099
072530     END-IF.                                                      07253099
072540*#END_OF_VARIABLE_LOGIC------------------------------------------*07254099
072550                                                                  07255099
072560     PERFORM 4420-FORMAT-LIST-LINES                               07256099
072570         VARYING PV-SUB                                           07257099
072580         FROM PC-ITEMS-PER-PANEL BY -1                            07258099
072590         UNTIL PV-SUB < +1.                                       07259099
072600                                                                  07260099
072610*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*07261099
072620* BUILD VARIABLE TOTAL PART                                      *07262099
072630*----------------------------------------------------------------*07263099
072640     IF  ASC-SEL-VARIABLE-SCREEN NOT =                            07264099
072650                         ASC-REDRAW-VARIABLE-SCREEN               07265099
072660         SET DISPLAY-TOTAL TO TRUE                                07266099
072670         PERFORM 9500-FORMAT-VARIABLE-DATA                        07267099
072680     END-IF.                                                      07268099
072690                                                                  07269099
072700     MOVE ASC-SEL-VARIABLE-SCREEN TO                              07270099
072710                    ASC-REDRAW-VARIABLE-SCREEN.                   07271099
072720                                                                  07272099
072730*#END_OF_VARIABLE_LOGIC------------------------------------------*07273099
072740                                                                  07274099
072750*                                                                 07275099
072760     COMPUTE ASC-ITEMS-DISPLAYED =                                07276099
072770         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          07277099
072780*                                                                 07278099
072790     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    07279099
072800                                      ASTRTITO.                   07280099
072810     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    07281099
072820     MOVE ASC-NBR-OF-POS-DISPLAYED TO ATOTITO.                    07282099
072830     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            07283099
072840                                   TO ASELITO.                    07284099
072850*                                                                 07285099
072860     IF  DP020-MSG-NUMBER-X = SPACE                               07286099
072870         IF  (ASC-ITEMS-LEFT-ON-DB)                               07287099
072880           OR  (ASC-ITEM-AT-BOT-OF-PANEL                          07288099
072890                              < ASC-NUMBER-OF-ITEMS-READ)         07289099
072900*            --- MORE ITEMS TO DISPLAY ----                       07290099
072910             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            07291099
072920             SET DP020-MSG-INFORMATIONAL TO TRUE                  07292099
072930         ELSE                                                     07293099
072940             IF  ASC-ITEM-AT-BOT-OF-PANEL =                       07294099
072950                                        ASC-NUMBER-OF-ITEMS-READ  07295099
072960*                --- BOTTOM OF LIST ----                          07296099
072970                 MOVE PC-TSYMSG-00070                             07297099
072980                                   TO DP020-MSG-NUMBER            07298099
072990                 SET DP020-MSG-INFORMATIONAL TO TRUE              07299099
073000             END-IF                                               07300099
073010         END-IF                                                   07301099
073020     END-IF.                                                      07302099
073030                                                                  07303099
073040 EJECT                                                            07304099
073050*----------------------------------------------------------------*07305099
073060*    THE VARIABLE DATA STORAGE QUEUE IS NOT PERSISTENT SO IT     *07306099
073070*    ALWAYS NEEDS TO BE REREAD                                   *07307099
073080*----------------------------------------------------------------*07308099
073090 4401-RELOAD-EXTENDED-STORAGE.                                    07309099
073100                                                                  07310099
073110     IF ASC-HIGHEST-BLOCK-WRITTEN > 0                             07311099
073120                                                                  07312099
073130        DIVIDE ASC-LIST-ITEM-NUMBER(1 1) BY PC-ITEMS-PER-PANEL    07313099
073140               GIVING PV-BLOCK-NUMBER                             07314099
073150               REMAINDER PV-REMAINDER                             07315099
073160        IF  PV-REMAINDER > ZERO                                   07316099
073170            ADD +1 TO PV-BLOCK-NUMBER                             07317099
073180        END-IF                                                    07318099
073190                                                                  07319099
073200        IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)          07320099
073210         OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)         07321099
073220          MOVE +1 TO ASC-EXT-SUB                                  07322099
073230          PERFORM 4412-READ-EXTENDED-STORAGE                      07323099
073240        END-IF                                                    07324099
073250                                                                  07325099
073260        ADD +1  TO ASC-EXT-SUB                                    07326099
073270                   PV-BLOCK-NUMBER                                07327099
073280                                                                  07328099
073290        IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)          07329099
073300         OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)         07330099
073310            PERFORM 4412-READ-EXTENDED-STORAGE                    07331099
073320        END-IF                                                    07332099
073330                                                                  07333099
073340     END-IF.                                                      07334099
073350                                                                  07335099
073360 EJECT                                                            07336099
073370*----------------------------------------------------------------*07337099
073380*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *07338099
073390*----------------------------------------------------------------*07339099
073400 4410-READ-TEMP-STORAGE.                                          07340099
073410                                                                  07341099
073420     EXEC CICS                                                    07342099
073430         READQ TS                                                 07343099
073440             QUEUE (ASC-LIST-QUEUE-NAME)                          07344099
073450             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               07345099
073460             ITEM  (PV-BLOCK-NUMBER)                              07346099
073470             RESP  (PV-CICS-RESP)                                 07347099
073480     END-EXEC.                                                    07348099
073490*                                                                 07349099
073500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       07350099
073510       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     07351099
073520         CONTINUE                                                 07352099
073530     ELSE                                                         07353099
073540         SET DP013-CICS-ABEND     TO TRUE                         07354099
073550         SET DP013-NO-ROLLBACK    TO TRUE                         07355099
073560         MOVE '4410-READ-TEMP-STORAGE'                            07356099
073570                                  TO DP013-PARAGRAPH              07357099
073580         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      07358099
073590                                  TO DP013-MESSAGE-TEXT(1)        07359099
073600         PERFORM DP013-0000-PROCESS-ABEND                         07360099
073610     END-IF.                                                      07361099
073620*                                                                 07362099
073630     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             07363099
073640*                                                                 07364099
073650     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         07365099
073660         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               07366099
073670     END-IF.                                                      07367099
073680                                                                  07368099
073690 EJECT                                                            07369099
073700*----------------------------------------------------------------*07370099
073710*    READ A BLOCK FROM PO QUEUE STORAGE INTO THE ARRAY.          *07371099
073720*----------------------------------------------------------------*07372099
073730                                                                  07373099
073740 4411-READ-PO-QUEUE-STORAGE.                                      07374099
073750                                                                  07375099
073760     EXEC CICS                                                    07376099
073770         READQ TS                                                 07377099
073780             QUEUE (ASC-PO-QUEUE-NAME)                            07378099
073790             INTO  (POQ-LIST-QUEUE-WORK-AREA)                     07379099
073800             ITEM  (ASC-POQ-BLK-SUB)                              07380099
073810             RESP  (PV-CICS-RESP)                                 07381099
073820     END-EXEC.                                                    07382099
073830*                                                                 07383099
073840     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       07384099
073850       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     07385099
073860         CONTINUE                                                 07386099
073870     ELSE                                                         07387099
073880         SET DP013-CICS-ABEND     TO TRUE                         07388099
073890         SET DP013-NO-ROLLBACK    TO TRUE                         07389099
073900         MOVE '4411-READ-PO-QUEUE-STORAGE'                        07390099
073910                                  TO DP013-PARAGRAPH              07391099
073920         MOVE 'ERROR TRYING TO READ FROM PO TEMP STORAGE QUEUE'   07392099
073930                                  TO DP013-MESSAGE-TEXT(1)        07393099
073940         PERFORM DP013-0000-PROCESS-ABEND                         07394099
073950     END-IF.                                                      07395099
073960*                                                                 07396099
073970     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         07397099
073980         INITIALIZE POQ-LIST-QUEUE-WORK-AREA                      07398099
073990     END-IF.                                                      07399099
074000                                                                  07400099
074010 EJECT                                                            07401099
074020*----------------------------------------------------------------*07402099
074030*    READ A BLOCK FROM VARIABLE STORAGE QUEUE INTO THE ARRAY.    *07403099
074040*----------------------------------------------------------------*07404099
074050                                                                  07405099
074060 4412-READ-EXTENDED-STORAGE.                                      07406099
074070                                                                  07407099
074080     EXEC CICS                                                    07408099
074090         READQ TS                                                 07409099
074100             QUEUE (ASC-EXTENDED-QUEUE-NAME)                      07410099
074110             INTO  (EXT-BLOCK-ENTRIES(ASC-EXT-SUB))               07411099
074120             ITEM  (PV-BLOCK-NUMBER)                              07412099
074130             RESP  (PV-CICS-RESP)                                 07413099
074140     END-EXEC.                                                    07414099
074150*                                                                 07415099
074160     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       07416099
074170       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     07417099
074180         CONTINUE                                                 07418099
074190     ELSE                                                         07419099
074200         SET DP013-CICS-ABEND     TO TRUE                         07420099
074210         SET DP013-NO-ROLLBACK    TO TRUE                         07421099
074220         MOVE '4412-READ-EXTENDED-STORAGE'                        07422099
074230                                  TO DP013-PARAGRAPH              07423099
074240         MOVE 'ERROR TRYING TO READ FROM VARIABLE STORAGE QUEUE'  07424099
074250                                  TO DP013-MESSAGE-TEXT(1)        07425099
074260         PERFORM DP013-0000-PROCESS-ABEND                         07426099
074270     END-IF.                                                      07427099
074280*                                                                 07428099
074290     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         07429099
074300         INITIALIZE EXT-BLOCK-ENTRIES (ASC-EXT-SUB)               07430099
074310     END-IF.                                                      07431099
074320                                                                  07432099
074330 EJECT                                                            07433099
074340*----------------------------------------------------------------*07434099
074350*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *07435099
074360*----------------------------------------------------------------*07436099
074370                                                                  07437099
074380 4420-FORMAT-LIST-LINES.                                          07438099
074390                                                                  07439099
074400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      07440099
074410         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                07441099
074420         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA    (PV-SUB)        07442099
074430         MOVE DP015-HL-OFF       TO MR-SELECTH    (PV-SUB)        07443099
074440         MOVE SPACES             TO MR-SELECTI    (PV-SUB)        07444099
074450                                    MR-VENDOR     (PV-SUB)        07445099
074460                                    MR-DMM-FIXED  (PV-SUB)        07446099
074470                                    MR-VFLD       (PV-SUB)        07447099
074480         MOVE 0                  TO MR-PO         (PV-SUB)        07448099
074490                                    MR-DEPT       (PV-SUB)        07449099
074500     ELSE                                                         07450099
074510         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      07451099
074520                                                   > SPACE        07452099
074530             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 07453099
074540                                 TO MR-SELECTI (PV-SUB)           07454099
074550         ELSE                                                     07455099
074560             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      07456099
074570                                 TO MR-SELECTI (PV-SUB)           07457099
074580         END-IF                                                   07458099
074590                                                                  07459099
074600         IF  DP030-SET-CURSOR-TRAILER                             07460099
074610             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)07461099
074620                 > SPACE)                                         07462099
074630               OR (PV-SUB = 1))                                   07463099
074640                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07464099
074650                MOVE -1          TO MR-SELECTL (PV-SUB)           07465099
074660             END-IF                                               07466099
074670         END-IF                                                   07467099
074680                                                                  07468099
074690         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           07469099
074700             MOVE -1           TO ASC-REDRAW-VARIABLE-SCREEN      07470099
074710             MOVE ASC-PO       (ASC-BLK-SUB ASC-ITEM-SUB)         07471099
074720                               TO MR-PO     (PV-SUB)              07472099
074730             MOVE ASC-DEPT     (ASC-BLK-SUB ASC-ITEM-SUB)         07473099
074740                               TO MR-DEPT   (PV-SUB)              07474099
074750             MOVE ASC-VND      (ASC-BLK-SUB ASC-ITEM-SUB)         07475099
074760                               TO MR-VENDOR (PV-SUB)              07476099
074770             MOVE ASC-DMM-FIXED (ASC-BLK-SUB ASC-ITEM-SUB)        07477099
074780                               TO MR-DMM-FIXED (PV-SUB)           07478099
074790             IF ASC-IP  (ASC-BLK-SUB ASC-ITEM-SUB) = 'Y'          07479099
074800                 MOVE DP015-YELLOW TO MR-POC(PV-SUB)              07480099
074810             ELSE                                                 07481099
074820                 MOVE DP015-BLUE TO MR-POC(PV-SUB)                07482099
074830             END-IF                                               07483099
074840         END-IF                                                   07484099
074850                                                                  07485099
074860*#VARIABLE_LOGIC_GROUP_2----------------------------------------* 07486099
074870*  ONLY REDRAW THE VARIABLE SCREEN PART                         * 07487099
074880*---------------------------------------------------------------* 07488099
074890         IF  ASC-SEL-VARIABLE-SCREEN NOT =                        07489099
074900                        ASC-REDRAW-VARIABLE-SCREEN                07490099
074910             IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)   07491099
074920               = EXT-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  07492099
074930               SET DISPLAY-LIST TO TRUE                           07493099
074940               PERFORM 9500-FORMAT-VARIABLE-DATA                  07494099
074950             ELSE                                                 07495099
074960                MOVE PC-TSYMSG-01570 TO DP020-MSG-NUMBER          07496099
074970                SET  DP020-MSG-FATAL TO TRUE                      07497099
074980             END-IF                                               07498099
074990         END-IF                                                   07499099
075000*#END_OF_VARIABLE_LOGIC------------------------------------------*07500099
075010                                                                  07501099
075020     END-IF.                                                      07502099
075030     SUBTRACT +1 FROM ASC-ITEM-SUB                                07503099
075040     IF  ASC-ITEM-SUB < + 1                                       07504099
075050         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  07505099
075060         MOVE +1                 TO ASC-BLK-SUB                   07506099
075070     END-IF.                                                      07507099
075080                                                                  07508099
075090 EJECT                                                            07509099
075100*----------------------------------------------------------------*07510099
075110*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *07511099
075120*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *07512099
075130*  ISSUE A WARNING.                                              *07513099
075140*----------------------------------------------------------------*07514099
075150                                                                  07515099
075160 4430-CHECK-FOR-BEGIN-AND-END.                                    07516099
075170                                                                  07517099
075180     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       07518099
075190         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     07519099
075200*----------- NO END-OF-RANGE SPECFIED ---                         07520099
075210             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            07521099
075220             SET DP020-MSG-WARNING TO TRUE                        07522099
075230             PERFORM 4431-POSITION-AT-WARNING                     07523099
075240         END-IF                                                   07524099
075250     ELSE                                                         07525099
075260         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     07526099
075270*----------- NO BEGINNING-OF-RANGE SPECFIED ---                   07527099
075280             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            07528099
075290             SET DP020-MSG-WARNING TO TRUE                        07529099
075300             PERFORM 4431-POSITION-AT-WARNING                     07530099
075310         END-IF                                                   07531099
075320     END-IF.                                                      07532099
075330                                                                  07533099
075340 EJECT                                                            07534099
075350*----------------------------------------------------------------*07535099
075360*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *07536099
075370*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *07537099
075380*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *07538099
075390*  POSITION THE CURSOR THERE.                                    *07539099
075400*----------------------------------------------------------------*07540099
075410                                                                  07541099
075420 4431-POSITION-AT-WARNING.                                        07542099
075430                                                                  07543099
075440     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 07544099
075450                    - PV-TOP-ITEM + 1.                            07545099
075460     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      07546099
075470         CONTINUE                                                 07547099
075480     ELSE                                                         07548099
075490         SET DP030-SET-CURSOR-APPL-1                              07549099
075500                                   TO TRUE                        07550099
075510         MOVE -1                   TO MR-SELECTL (PV-SUB)         07551099
075520         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         07552099
075530         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         07553099
075540     END-IF.                                                      07554099
075550*                                                                 07555099
075560     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   07556099
075570                    - PV-TOP-ITEM + 1.                            07557099
075580     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      07558099
075590         CONTINUE                                                 07559099
075600     ELSE                                                         07560099
075610         SET DP030-SET-CURSOR-APPL-1                              07561099
075620                                   TO TRUE                        07562099
075630         MOVE -1                   TO MR-SELECTL (PV-SUB)         07563099
075640         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         07564099
075650         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         07565099
075660     END-IF.                                                      07566099
075670                                                                  07567099
075680 EJECT                                                            07568099
075690*----------------------------------------------------------------*07569099
075700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *07570099
075710* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *07571099
075720* FOR THE SELECTED ITEMS QUEUE.                                  *07572099
075730*                                                                *07573099
075740* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *07574099
075750* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *07575099
075760* THE ARRAY IS FULL.                                             *07576099
075770*----------------------------------------------------------------*07577099
075780                                                                  07578099
075790 5000-PREPARE-SEL-QUEUE.                                          07579099
075800                                                                  07580099
075810     MOVE +1                   TO  ASC-BLK-SUB.                   07581099
075820     PERFORM 5100-WRITE-TEMP-STORAGE.                             07582099
075830     ADD +1                    TO  ASC-BLK-SUB.                   07583099
075840     PERFORM 5100-WRITE-TEMP-STORAGE.                             07584099
075850     PERFORM 6010-DELETE-SEL-QUEUE.                               07585099
075860                                                                  07586099
075870     SET ASC-UPDATE-TSQ        TO  TRUE.                          07587099
075880                                                                  07588099
075890     SET PO012-IDX             TO  1.                             07589099
075900     MOVE ZERO                 TO PV-SEL-QUEUE-ITEM.              07590099
075910                                                                  07591099
075920     INITIALIZE PO012-SELECTED-ITEM-ARRAY.                        07592099
075930     MOVE ZERO TO PO013-NUMBER-OF-TS-ITEMS.                       07593099
075940                                                                  07594099
075950     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           07595099
075960             VARYING PV-ITEM                                      07596099
075970             FROM 1 BY 1                                          07597099
075980             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     07598099
075990                                                                  07599099
076000     IF  PO012-IDX > 1                                            07600099
076010         ADD +1        TO PV-SEL-QUEUE-ITEM                       07601099
076020         PERFORM 5205-WRITE-SEL-QUEUE                             07602099
076030         ADD +1 TO PO013-NUMBER-OF-TS-ITEMS                       07603099
076040     END-IF.                                                      07604099
076050*                                                                 07605099
076060 EJECT                                                            07606099
076070*----------------------------------------------------------------*07607099
076080*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *07608099
076090*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *07609099
076100*----------------------------------------------------------------*07610099
076110                                                                  07611099
076120 5100-WRITE-TEMP-STORAGE.                                         07612099
076130                                                                  07613099
076140     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     07614099
076150                                   TO PV-LIST-ITEM-NUMBER.        07615099
076160     COMPUTE PV-BLOCK-NUMBER =                                    07616099
076170         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    07617099
076180                                                                  07618099
076190     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             07619099
076200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             07620099
076210         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      07621099
076220             PERFORM 5105-REWRITE-ASC-LISTQ                       07622099
076230             IF ASC-WRITE-EXTENDED-STORAGE                        07623099
076240                PERFORM 5106-REWRITE-EXTENDED-STORAGE             07624099
076250             END-IF                                               07625099
076260         END-IF                                                   07626099
076270     ELSE                                                         07627099
076280         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       07628099
076290         ASC-HIGHEST-BLOCK-WRITTEN + 1                            07629099
076300         PERFORM 5110-WRITE-ASC-LISTQ                             07630099
076310         IF ASC-WRITE-EXTENDED-STORAGE                            07631099
076320            PERFORM 5112-WRITE-EXTENDED-STORAGE                   07632099
076330         END-IF                                                   07633099
076340         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   07634099
076350     END-IF.                                                      07635099
076360                                                                  07636099
076370     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             07637099
076380                                                                  07638099
076390 EJECT                                                            07639099
076400*----------------------------------------------------------------*07640099
076410*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *07641099
076420*  SPECIFIC COMMAREA.                                            *07642099
076430*----------------------------------------------------------------*07643099
076440                                                                  07644099
076450 5105-REWRITE-ASC-LISTQ.                                          07645099
076460                                                                  07646099
076470     EXEC CICS                                                    07647099
076480         WRITEQ TS                                                07648099
076490             QUEUE (ASC-LIST-QUEUE-NAME)                          07649099
076500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               07650099
076510             ITEM  (PV-BLOCK-NUMBER)                              07651099
076520             REWRITE                                              07652099
076530             RESP  (PV-CICS-RESP)                                 07653099
076540     END-EXEC.                                                    07654099
076550                                                                  07655099
076560     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           07656099
076570         CONTINUE                                                 07657099
076580     ELSE                                                         07658099
076590         SET DP013-CICS-ABEND            TO TRUE                  07659099
076600         SET DP013-NO-ROLLBACK           TO TRUE                  07660099
076610         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       07661099
076620         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     07662099
076630                                         TO DP013-MESSAGE-TEXT(1) 07663099
076640         PERFORM DP013-0000-PROCESS-ABEND                         07664099
076650     END-IF.                                                      07665099
076660                                                                  07666099
076670 EJECT                                                            07667099
076680*----------------------------------------------------------------*07668099
076690*  REWRITE THE VAR TEMP STORAGE QUEUE                            *07669099
076700*----------------------------------------------------------------*07670099
076710                                                                  07671099
076720 5106-REWRITE-EXTENDED-STORAGE.                                   07672099
076730                                                                  07673099
076740     EXEC CICS                                                    07674099
076750         WRITEQ TS                                                07675099
076760             QUEUE (ASC-EXTENDED-QUEUE-NAME)                      07676099
076770             FROM  (EXT-BLOCK-ENTRIES(ASC-BLK-SUB))               07677099
076780             ITEM  (PV-BLOCK-NUMBER)                              07678099
076790             REWRITE                                              07679099
076800             RESP  (PV-CICS-RESP)                                 07680099
076810     END-EXEC.                                                    07681099
076820                                                                  07682099
076830     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           07683099
076840         CONTINUE                                                 07684099
076850     ELSE                                                         07685099
076860         SET DP013-CICS-ABEND            TO TRUE                  07686099
076870         SET DP013-NO-ROLLBACK           TO TRUE                  07687099
076880         MOVE '5106-REWRITE-EXTENDED-STORAGE' TO DP013-PARAGRAPH  07688099
076890         MOVE 'ATTEMPTING TO REWRITE VARIABLE STORAGE QUEUE'      07689099
076900                                         TO DP013-MESSAGE-TEXT(1) 07690099
076910         PERFORM DP013-0000-PROCESS-ABEND                         07691099
076920     END-IF.                                                      07692099
076930                                                                  07693099
076940 EJECT                                                            07694099
076950*----------------------------------------------------------------*07695099
076960*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *07696099
076970*  SPECIFIC COMMAREA.                                            *07697099
076980*----------------------------------------------------------------*07698099
076990                                                                  07699099
077000 5110-WRITE-ASC-LISTQ.                                            07700099
077010                                                                  07701099
077020     EXEC CICS                                                    07702099
077030         WRITEQ TS                                                07703099
077040             QUEUE (ASC-LIST-QUEUE-NAME)                          07704099
077050             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               07705099
077060             ITEM  (PV-BLOCK-NUMBER)                              07706099
077070             RESP  (PV-CICS-RESP)                                 07707099
077080     END-EXEC.                                                    07708099
077090                                                                  07709099
077100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      07710099
077110         SET DP013-CICS-ABEND      TO TRUE                        07711099
077120         SET DP013-NO-ROLLBACK     TO TRUE                        07712099
077130         MOVE '5110-WRITE-ASC-LISTQ'                              07713099
077140                                   TO DP013-PARAGRAPH             07714099
077150         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE QUEUE'            07715099
077160                                   TO DP013-MESSAGE-TEXT(1)       07716099
077170         PERFORM DP013-0000-PROCESS-ABEND                         07717099
077180     END-IF.                                                      07718099
077190                                                                  07719099
077200 EJECT                                                            07720099
077210*----------------------------------------------------------------*07721099
077220*  WRITE THE PO TEMP STORAGE QUEUE FROM READING THE DYNAMIC      *07722099
077230*  CURSOR.                                                       *07723099
077240*----------------------------------------------------------------*07724099
077250                                                                  07725099
077260 5111-WRITE-PO-QUEUE.                                             07726099
077270                                                                  07727099
077280     EXEC CICS                                                    07728099
077290         WRITEQ TS                                                07729099
077300             QUEUE (ASC-PO-QUEUE-NAME)                            07730099
077310             FROM  (POQ-LIST-QUEUE-WORK-AREA)                     07731099
077320             ITEM  (ASC-POQ-BLK-SUB)                              07732099
077330             RESP  (PV-CICS-RESP)                                 07733099
077340     END-EXEC.                                                    07734099
077350                                                                  07735099
077360     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      07736099
077370         SET DP013-CICS-ABEND      TO TRUE                        07737099
077380         SET DP013-NO-ROLLBACK     TO TRUE                        07738099
077390         MOVE '5111-WRITE-PO-QUEUE'                               07739099
077400                                   TO DP013-PARAGRAPH             07740099
077410         MOVE 'ATTEMPTING TO WRITE TO PO STORAGE QUEUE'           07741099
077420                                   TO DP013-MESSAGE-TEXT(1)       07742099
077430         PERFORM DP013-0000-PROCESS-ABEND                         07743099
077440     END-IF.                                                      07744099
077450                                                                  07745099
077460 EJECT                                                            07746099
077470*----------------------------------------------------------------*07747099
077480*  WRITE THE VARIABLE DATA STORAGE QUEUE AT THE SAME TIME        *07748099
077490*  LIST QUEUE IS WRITTEN.                                        *07749099
077500*----------------------------------------------------------------*07750099
077510                                                                  07751099
077520 5112-WRITE-EXTENDED-STORAGE.                                     07752099
077530                                                                  07753099
077540     EXEC CICS                                                    07754099
077550         WRITEQ TS                                                07755099
077560             QUEUE (ASC-EXTENDED-QUEUE-NAME)                      07756099
077570             FROM  (EXT-BLOCK-ENTRIES(ASC-BLK-SUB))               07757099
077580             ITEM  (PV-BLOCK-NUMBER)                              07758099
077590             RESP  (PV-CICS-RESP)                                 07759099
077600     END-EXEC.                                                    07760099
077610                                                                  07761099
077620     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      07762099
077630         SET DP013-CICS-ABEND      TO TRUE                        07763099
077640         SET DP013-NO-ROLLBACK     TO TRUE                        07764099
077650         MOVE '5112-WRITE-EXTENDED-STORAGE'                       07765099
077660                                   TO DP013-PARAGRAPH             07766099
077670         MOVE 'ATTEMPTING TO WRITE TO VARIABLE STORAGE QUEUE'     07767099
077680                                   TO DP013-MESSAGE-TEXT(1)       07768099
077690         PERFORM DP013-0000-PROCESS-ABEND                         07769099
077700     END-IF.                                                      07770099
077710                                                                  07771099
077720 EJECT                                                            07772099
077730*----------------------------------------------------------------*07773099
077740* READ A LIST QUEUE RECORD AND MOVE THE KEY OF SELECTED OBJECTS  *07774099
077750* THIS PARAGRAPH IS ONLY CALLED WHEN THERE IS ONE SELECTED       *07775099
077760* RECORD.                                                        *07776099
077770*----------------------------------------------------------------*07777099
077780                                                                  07778099
077790 5200-FILL-SEL-QUEUE-RECORD.                                      07779099
077800                                                                  07780099
077810     PERFORM 6112-READ-LIST-QUEUE.                                07781099
077820                                                                  07782099
077830     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       07783099
077840         PERFORM                                                  07784099
077850         VARYING LQW-IDX                                          07785099
077860         FROM 1 BY 1                                              07786099
077870         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            07787099
077880           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          07788099
077890             IF  LQW-SELECT (LQW-IDX)                             07789099
077900                 IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)        07790099
077910                  MOVE LQW-PO (LQW-IDX)   TO TR105-PO-NBR         07791099
077920                 ELSE                                             07792099
077930                  MOVE LQW-PO (LQW-IDX)   TO                      07793099
077940                                 PO012-PO-NBR (PO012-IDX)         07794099
077950                  MOVE ZEROES             TO PV-LQW-DEPT-NBR      07795099
077960                  MOVE LQW-DEPT (LQW-IDX) TO PV-LQW-DEPT-NBR      07796099
077970                  MOVE PV-LQW-DEPT-NBR-X-2 TO                     07797099
077980                                 PO012-DEPT-NBR (PO012-IDX)       07798099
077990                 END-IF                                           07799099
078000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              07800099
078010                                   TO PO012-ITEM (PO012-IDX)      07801099
078020                 MOVE 'I' TO PO012-ACTION-SW (PO012-IDX)          07802099
078030                 SET PO012-IDX UP BY 1                            07803099
078040                 IF  PO012-IDX > PO012-MAX-ITEMS                  07804099
078050                     ADD +1        TO PV-SEL-QUEUE-ITEM           07805099
078060                     PERFORM 5205-WRITE-SEL-QUEUE                 07806099
078070                     ADD +1 TO PO013-NUMBER-OF-TS-ITEMS           07807099
078080                     INITIALIZE PO012-SELECTED-ITEM-ARRAY         07808099
078090                     SET PO012-IDX TO  1                          07809099
078100                 END-IF                                           07810099
078110             END-IF                                               07811099
078120         END-PERFORM                                              07812099
078130     END-IF.                                                      07813099
078140                                                                  07814099
078150 EJECT                                                            07815099
078160*----------------------------------------------------------------*07816099
078170*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *07817099
078180*----------------------------------------------------------------*07818099
078190                                                                  07819099
078200 5205-WRITE-SEL-QUEUE.                                            07820099
078210                                                                  07821099
078220     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            07822099
078230                                   TO PO012-SELECTED-ITEMS.       07823099
078240                                                                  07824099
078250     EXEC CICS                                                    07825099
078260          WRITEQ TS                                               07826099
078270             QUEUE (ASC-SEL-QUEUE-NAME)                           07827099
078280             FROM  (PO012-PO-SELECT-RECORD)                       07828099
078290             ITEM  (PV-SEL-QUEUE-ITEM)                            07829099
078300             RESP  (PV-CICS-RESP)                                 07830099
078310     END-EXEC.                                                    07831099
078320                                                                  07832099
078330     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          07833099
078340         CONTINUE                                                 07834099
078350     ELSE                                                         07835099
078360         SET DP013-CICS-ABEND      TO TRUE                        07836099
078370         SET DP013-NO-ROLLBACK     TO TRUE                        07837099
078380         MOVE '5205-WRITE-SEL-QUEUE'                              07838099
078390                                   TO DP013-PARAGRAPH             07839099
078400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          07840099
078410                                   TO DP013-MESSAGE-TEXT(1)       07841099
078420         PERFORM DP013-0000-PROCESS-ABEND                         07842099
078430     END-IF.                                                      07843099
078440                                                                  07844099
078450 EJECT                                                            07845099
078460*----------------------------------------------------------------*07846099
078470*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *07847099
078480*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *07848099
078490*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *07849099
078500*  THE USER.                                                     *07850099
078510*----------------------------------------------------------------*07851099
078520                                                                  07852099
078530 6000-REFRESH-PANEL-FROM-TEMP.                                    07853099
078540                                                                  07854099
078550     IF  ASC-UPDATE-TSQ                                           07855099
078560         SET ASC-NO-TSQ-UPDATE TO TRUE                            07856099
078570         MOVE ZERO                 TO PV-SAVE-ITEM                07857099
078580                                      PV-SEL-QUEUE-ITEM           07858099
078590         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        07859099
078600                                   TO PV-HOLD-SELECTED-ITEMS      07860099
078610         MOVE +1                   TO PV-ITEMS-PROCESSED          07861099
078620         PERFORM 6100-UPDATE-TSQ                                  07862099
078630             UNTIL PV-ITEMS-PROCESSED >                           07863099
078640                                     PV-HOLD-SELECTED-ITEMS       07864099
078650         PERFORM 6010-DELETE-SEL-QUEUE                            07865099
078660         INITIALIZE ASC-BLOCK-ENTRIES (1)                         07866099
078670                    ASC-BLOCK-ENTRIES (2)                         07867099
078680     END-IF.                                                      07868099
078690                                                                  07869099
078700 EJECT                                                            07870099
078710*----------------------------------------------------------------*07871099
078720*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *07872099
078730*----------------------------------------------------------------*07873099
078740                                                                  07874099
078750 6010-DELETE-SEL-QUEUE.                                           07875099
078760                                                                  07876099
078770     EXEC CICS                                                    07877099
078780         DELETEQ TS                                               07878099
078790             QUEUE (ASC-SEL-QUEUE-NAME)                           07879099
078800             RESP  (PV-CICS-RESP)                                 07880099
078810     END-EXEC.                                                    07881099
078820                                                                  07882099
078830     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      07883099
078840        (PV-CICS-RESP = DFHRESP(QIDERR)))                         07884099
078850         CONTINUE                                                 07885099
078860     ELSE                                                         07886099
078870         SET DP013-CICS-ABEND TO TRUE                             07887099
078880         SET DP013-NO-ROLLBACK TO TRUE                            07888099
078890         MOVE '6010-DELETE-SEL-QUEUE'                             07889099
078900                        TO DP013-PARAGRAPH                        07890099
078910         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         07891099
078920                        TO DP013-MESSAGE-TEXT (1)                 07892099
078930         PERFORM DP013-0000-PROCESS-ABEND                         07893099
078940     END-IF.                                                      07894099
078950                                                                  07895099
078960 EJECT                                                            07896099
078970*----------------------------------------------------------------*07897099
078980*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *07898099
078990*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *07899099
079000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *07900099
079010*    THE TEMP QUEUE.                                             *07901099
079020*----------------------------------------------------------------*07902099
079030                                                                  07903099
079040 6100-UPDATE-TSQ.                                                 07904099
079050                                                                  07905099
079060     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             07906099
079070     PERFORM 6105-READ-SEL-QUEUE.                                 07907099
079080     PERFORM                                                      07908099
079090         VARYING PO012-IDX                                        07909099
079100         FROM 1 BY 1                                              07910099
079110         UNTIL ((PV-ITEMS-PROCESSED >                             07911099
079120                              PV-HOLD-SELECTED-ITEMS)             07912099
079130         OR (PO012-IDX GREATER THAN PO012-MAX-ITEMS))             07913099
079140         IF  PO012-ACTION-SW (PO012-IDX) > SPACE                  07914099
079150             PERFORM 6110-PROCESS-ITEMS                           07915099
079160         END-IF                                                   07916099
079170         ADD +1                TO PV-ITEMS-PROCESSED              07917099
079180     END-PERFORM.                                                 07918099
079190     PERFORM 6111-WRITE-LIST-QUEUE.                               07919099
079200                                                                  07920099
079210 EJECT                                                            07921099
079220*----------------------------------------------------------------*07922099
079230*    READ THE LIST QUEUE RECORD.                                 *07923099
079240*----------------------------------------------------------------*07924099
079250                                                                  07925099
079260 6105-READ-SEL-QUEUE.                                             07926099
079270                                                                  07927099
079280     EXEC CICS                                                    07928099
079290          READQ TS                                                07929099
079300             QUEUE (ASC-SEL-QUEUE-NAME)                           07930099
079310             INTO  (PO012-PO-SELECT-RECORD)                       07931099
079320             ITEM  (PV-SEL-QUEUE-ITEM)                            07932099
079330             RESP  (PV-CICS-RESP)                                 07933099
079340     END-EXEC.                                                    07934099
079350                                                                  07935099
079360     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          07936099
079370         CONTINUE                                                 07937099
079380     ELSE                                                         07938099
079390         SET DP013-CICS-ABEND      TO  TRUE                       07939099
079400         SET DP013-NO-ROLLBACK     TO  TRUE                       07940099
079410         MOVE '6105-READ-SEL-QUEUE'                               07941099
079420                                   TO  DP013-PARAGRAPH            07942099
079430         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           07943099
079440                                   TO  DP013-MESSAGE-TEXT(1)      07944099
079450         PERFORM DP013-0000-PROCESS-ABEND                         07945099
079460     END-IF.                                                      07946099
079470                                                                  07947099
079480 EJECT                                                            07948099
079490*----------------------------------------------------------------*07949099
079500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*07950099
079510*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*07951099
079520*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *07952099
079530*----------------------------------------------------------------*07953099
079540                                                                  07954099
079550 6110-PROCESS-ITEMS.                                              07955099
079560                                                                  07956099
079570     COMPUTE PV-ITEM = 1 + ((PO012-ITEM (PO012-IDX) - 1)          07957099
079580                     / PC-ITEMS-PER-PANEL).                       07958099
079590                                                                  07959099
079600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           07960099
079610         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          07961099
079620             PERFORM 6111-WRITE-LIST-QUEUE                        07962099
079630         END-IF                                                   07963099
079640         MOVE PV-ITEM          TO PV-SAVE-ITEM                    07964099
079650                                                                  07965099
079660         PERFORM 6112-READ-LIST-QUEUE                             07966099
079670         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               07967099
079680             CONTINUE                                             07968099
079690         END-IF                                                   07969099
079700     END-IF.                                                      07970099
079710                                                                  07971099
079720     COMPUTE PV-SUB = (PO012-ITEM (PO012-IDX)                     07972099
079730                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              07973099
079740     SET LQW-DESELECT (PV-SUB) TO    TRUE.                        07974099
079750     MOVE LQW-SELECTED-SW (PV-SUB)                                07975099
079760                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  07976099
079770                                                                  07977099
079780*    IF PO012-INQ (PO012-IDX)                                     07978099
079790*       MOVE PC-INQ            TO LQW-ACTION (PV-SUB)             07979099
079800*    END-IF.                                                      07980099
079810                                                                  07981099
079820     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                07982099
079830                                                                  07983099
079840 EJECT                                                            07984099
079850*----------------------------------------------------------------*07985099
079860*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *07986099
079870*----------------------------------------------------------------*07987099
079880                                                                  07988099
079890 6111-WRITE-LIST-QUEUE.                                           07989099
079900                                                                  07990099
079910     EXEC CICS                                                    07991099
079920         WRITEQ TS                                                07992099
079930             QUEUE (ASC-LIST-QUEUE-NAME)                          07993099
079940             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     07994099
079950             ITEM  (PV-SAVE-ITEM)                                 07995099
079960             REWRITE                                              07996099
079970             RESP  (PV-CICS-RESP)                                 07997099
079980     END-EXEC.                                                    07998099
079990                                                                  07999099
080000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          08000099
080010         CONTINUE                                                 08001099
080020     ELSE                                                         08002099
080030         SET DP013-CICS-ABEND  TO  TRUE                           08003099
080040         SET DP013-NO-ROLLBACK TO  TRUE                           08004099
080050         MOVE '6111-WRITE-LIST-QUEUE'                             08005099
080060                               TO  DP013-PARAGRAPH                08006099
080070         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  08007099
080080                               TO  DP013-MESSAGE-TEXT(1)          08008099
080090         PERFORM DP013-0000-PROCESS-ABEND                         08009099
080100     END-IF.                                                      08010099
080110                                                                  08011099
080120     IF LQW-LIST-ITEM-NUMBER (1) = ASC-LIST-ITEM-NUMBER (1 1)     08012099
080130         MOVE LQW-LIST-QUEUE-WORK-AREA TO ASC-BLOCK-ENTRIES (1)   08013099
080140     ELSE                                                         08014099
080150         MOVE LQW-LIST-QUEUE-WORK-AREA TO ASC-BLOCK-ENTRIES (2)   08015099
080160     END-IF.                                                      08016099
080170                                                                  08017099
080180 EJECT                                                            08018099
080190*----------------------------------------------------------------*08019099
080200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*08020099
080210*----------------------------------------------------------------*08021099
080220                                                                  08022099
080230 6112-READ-LIST-QUEUE.                                            08023099
080240                                                                  08024099
080250     EXEC CICS                                                    08025099
080260         READQ TS                                                 08026099
080270             QUEUE (ASC-LIST-QUEUE-NAME)                          08027099
080280             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     08028099
080290             ITEM  (PV-ITEM)                                      08029099
080300             RESP  (PV-CICS-RESP)                                 08030099
080310     END-EXEC.                                                    08031099
080320                                                                  08032099
080330     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          08033099
080340         CONTINUE                                                 08034099
080350     ELSE                                                         08035099
080360         SET DP013-CICS-ABEND        TO TRUE                      08036099
080370         SET DP013-NO-ROLLBACK       TO TRUE                      08037099
080380         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           08038099
080390         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    08039099
080400                                     TO DP013-MESSAGE-TEXT(1)     08040099
080410         PERFORM DP013-0000-PROCESS-ABEND                         08041099
080420     END-IF.                                                      08042099
080430                                                                  08043099
080440 EJECT                                                            08044099
080450*----------------------------------------------------------------*08045099
080460*  CONTROLS PROCESSING FOR SUBMITTING FILE REQUEST               *08046099
080470*----------------------------------------------------------------*08047099
080480 7000-SUBMIT-FILE.                                                08048099
080490                                                                  08049099
080500     PERFORM 7100-GET-USER-SYSTEM.                                08050099
080510     IF ASC-CICS-ABSTIME = 0                                      08051099
080520         PERFORM 10001-ASK-CICS-FOR-TIME                          08052099
080530         PERFORM 10005-FORMAT-CICS-TIME                           08053099
080540     END-IF.                                                      08054099
080550                                                                  08055099
080560     IF PV-CIT1-CICS                                              08056099
080570         MOVE PV-USER-ID           TO PV-TEST-JOB-USER-ID         08057099
080580                                      PC-TEST-NOTIFY-ID           08058099
080590                                      PC-TEST-USRID               08059099
080600         MOVE ASC-CICS-TIME(1:2)   TO  PC-TEST-CRHOUR             08060099
080610         MOVE ASC-CICS-TIME(4:2)   TO  PC-TEST-CRMIN              08061099
080620         MOVE ASC-CICS-TIME(7:2)   TO  PC-TEST-CRSEC              08062099
080630         MOVE ASC-CICS-DATE(1:2)   TO  PC-TEST-CRMNTH             08063099
080640         MOVE ASC-CICS-DATE(3:2)   TO  PC-TEST-CRDAY              08064099
080650         MOVE ASC-CICS-DATE(5:2)   TO  PC-TEST-CRYEAR             08065099
080660         MOVE PV-TEST-JOB          TO JL-JOB-NAME                 08066099
080670         MOVE PC-TEST-CLASS        TO JL-JCL-CLASS                08067099
080680         MOVE PC-TEST-LIBSRCH      TO JL-JCL-LIBSRCH              08068099
080690         MOVE PC-TEST-JOB-PARM     TO JL-JCL-JOB-PARM             08069099
080700         MOVE PC-TEST-JOBLIB       TO JL-JCL-JOBLIB               08070099
080710         MOVE PC-TEST-PROC-TR      TO JL-JCL-PROC                 08071099
080720     ELSE                                                         08072099
080730         IF PV-CIQA-CICS                                          08073099
080740             CONTINUE                                             08074099
080750         ELSE                                                     08075099
080760             MOVE DP020-USERID(1:7)  TO  PC-PROD-USRID            08076099
080770             MOVE ASC-CICS-TIME(1:2) TO  PC-PROD-CRHOUR           08077099
080780             MOVE ASC-CICS-TIME(4:2) TO  PC-PROD-CRMIN            08078099
080790             MOVE ASC-CICS-TIME(7:2) TO  PC-PROD-CRSEC            08079099
080800             MOVE ASC-CICS-DATE(1:2) TO  PC-PROD-CRMNTH           08080099
080810             MOVE ASC-CICS-DATE(3:2) TO  PC-PROD-CRDAY            08081099
080820             MOVE ASC-CICS-DATE(5:2) TO  PC-PROD-CRYEAR           08082099
080830             MOVE PC-PROD-JOB-TRK950 TO JL-JOB-NAME               08083099
080840             MOVE PC-PROD-CLASS    TO JL-JCL-CLASS                08084099
080850             MOVE PC-PROD-LIBSRCH  TO JL-JCL-LIBSRCH              08085099
080860             MOVE PC-PROD-JOB-PARM TO JL-JCL-JOB-PARM             08086099
080870             MOVE PC-PROD-JOBLIB   TO JL-JCL-JOBLIB               08087099
080880             MOVE PC-PROD-PROC-TR  TO JL-JCL-PROC                 08088099
080890         END-IF                                                   08089099
080900     END-IF.                                                      08090099
080910                                                                  08091099
080920                                                                  08092099
080930     PERFORM 7200-TD-QUEUE-ENQ.                                   08093099
080940     PERFORM                                                      08094099
080950         VARYING JL-LINE-INDEX                                    08095099
080960         FROM 1 BY 1                                              08096099
080970         UNTIL JL-LINE-INDEX > 18                                 08097099
080980             IF JL-LINE-INDEX = 11                                08098099
080990                 PERFORM 7020-LOAD-SELECT                         08099099
081000             ELSE                                                 08100099
081010                 IF JL-LINE-INDEX = 15                            08101099
081020                     PERFORM 7040-LOAD-OPTIONS                    08102099
081030                 ELSE                                             08103099
081040                     IF JL-LINE-INDEX = 3                         08104099
081050                         IF PV-CIT1-CICS                          08105099
081060                             MOVE JL-JCL-LINE (JL-LINE-INDEX)     08106099
081070                                               TO TD-JCL-LINE     08107099
081080                             PERFORM 7300-WRITE-TRANS-DATA-LINE   08108099
081090                         END-IF                                   08109099
081100                     ELSE                                         08110099
081110                         MOVE JL-JCL-LINE (JL-LINE-INDEX)         08111099
081120                                               TO TD-JCL-LINE     08112099
081130                         PERFORM 7300-WRITE-TRANS-DATA-LINE       08113099
081140                     END-IF                                       08114099
081150                 END-IF                                           08115099
081160             END-IF                                               08116099
081170     END-PERFORM.                                                 08117099
081180     PERFORM 7400-TD-QUEUE-DEQ.                                   08118099
081190                                                                  08119099
081200*----------------------------------------------------------------*08120099
081210*  WRITE THE DYNAMIC SQL TO THE TRANS-DATA QUEUE                 *08121099
081220*----------------------------------------------------------------*08122099
081230 7020-LOAD-SELECT.                                                08123099
081240                                                                  08124099
081250     MOVE PV-SQL-STMT-TEXT(1:80)     TO TD-JCL-LINE.              08125099
081260     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08126099
081270     MOVE PV-SQL-STMT-TEXT(81:80)    TO TD-JCL-LINE.              08127099
081280     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08128099
081290     MOVE PV-SQL-STMT-TEXT(161:80)   TO TD-JCL-LINE.              08129099
081300     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08130099
081310     MOVE PV-SQL-STMT-TEXT(241:80)   TO TD-JCL-LINE.              08131099
081320     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08132099
081330     MOVE PV-SQL-STMT-TEXT(321:80)   TO TD-JCL-LINE.              08133099
081340     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08134099
081350     MOVE PV-SQL-STMT-TEXT(401:80)   TO TD-JCL-LINE.              08135099
081360     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08136099
081370     MOVE PV-SQL-STMT-TEXT(481:80)   TO TD-JCL-LINE.              08137099
081380     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08138099
081390     MOVE PV-SQL-STMT-TEXT(561:80)   TO TD-JCL-LINE.              08139099
081400     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08140099
081410     MOVE PV-SQL-STMT-TEXT(641:80)   TO TD-JCL-LINE.              08141099
081420     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08142099
081430     MOVE PV-SQL-STMT-TEXT(721:80)   TO TD-JCL-LINE.              08143099
081440     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08144099
081450     MOVE PV-SQL-STMT-TEXT(801:80)   TO TD-JCL-LINE.              08145099
081460     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08146099
081470     MOVE PV-SQL-STMT-TEXT(881:80)   TO TD-JCL-LINE.              08147099
081480     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08148099
081490     MOVE PV-SQL-STMT-TEXT(961:80)   TO TD-JCL-LINE.              08149099
081500     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08150099
081510     MOVE PV-SQL-STMT-TEXT(1041:80)  TO TD-JCL-LINE.              08151099
081520     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08152099
081530     MOVE PV-SQL-STMT-TEXT(1121:80)  TO TD-JCL-LINE.              08153099
081540     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08154099
081550     MOVE PV-SQL-STMT-TEXT(1201:80)  TO TD-JCL-LINE.              08155099
081560     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08156099
081570     MOVE PV-SQL-STMT-TEXT(1281:80)  TO TD-JCL-LINE.              08157099
081580     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08158099
081590     MOVE PV-SQL-STMT-TEXT(1361:80)  TO TD-JCL-LINE.              08159099
081600     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08160099
081610     MOVE PV-SQL-STMT-TEXT(1441:72)  TO TD-JCL-LINE.              08161099
081620     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08162099
081630                                                                  08163099
081640 7020-EXIT.                                                       08164099
081650     EXIT.                                                        08165099
081660                                                                  08166099
081670*----------------------------------------------------------------*08167099
081680*  WRITE THE OPTIONS SELECTED TO THE TRANS-DATA QUE              *08168099
081690*----------------------------------------------------------------*08169099
081700 7040-LOAD-OPTIONS.                                               08170099
081710                                                                  08171099
081720     MOVE TR195-INTER-APPL-COMMAREA(1:80) TO TD-JCL-LINE.         08172099
081730     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08173099
081740     MOVE TR195-INTER-APPL-COMMAREA(81:80) TO TD-JCL-LINE.        08174099
081750     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08175099
081760     MOVE TR195-INTER-APPL-COMMAREA(161:40) TO TD-JCL-LINE.       08176099
081770     PERFORM 7300-WRITE-TRANS-DATA-LINE.                          08177099
081780                                                                  08178099
081790 7040-EXIT.                                                       08179099
081800     EXIT.                                                        08180099
081810*----------------------------------------------------------------*08181099
081820*  GET CURRENT SYSTEM AND USER ID                                *08182099
081830*----------------------------------------------------------------*08183099
081840 7100-GET-USER-SYSTEM.                                            08184099
081850                                                                  08185099
081860     EXEC CICS ASSIGN                                             08186099
081870          SYSID    (PV-SYSTM-ID)                                  08187099
081880          USERID   (PV-USER-ID)                                   08188099
081890          RESP     (PV-CICS-RESPONSE)                             08189099
081900     END-EXEC.                                                    08190099
081910                                                                  08191099
081920     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    08192099
081930         SET DP013-LOGIC-ABEND     TO TRUE                        08193099
081940         SET DP013-NO-ROLLBACK     TO TRUE                        08194099
081950         MOVE '7100-GET-USER-ID'   TO DP013-PARAGRAPH             08195099
081960         MOVE PV-CICS-RESPONSE     TO DP013-MESSAGE-TEXT (1)      08196099
081970         MOVE 'ERROR GETTING USER ID'                             08197099
081980                                   TO DP013-MESSAGE-TEXT (2)      08198099
081990         PERFORM DP013-0000-PROCESS-ABEND                         08199099
082000      END-IF.                                                     08200099
082010                                                                  08201099
082020*----------------------------------------------------------------*08202099
082030*  ENQUE THE TRANSIENT DATA QUEUE                                *08203099
082040*----------------------------------------------------------------*08204099
082050 7200-TD-QUEUE-ENQ.                                               08205099
082060                                                                  08206099
082070     EXEC CICS ENQ                                                08207099
082080          RESOURCE (TD-QUEUE-NAME)                                08208099
082090          LENGTH   (TD-Q-NAME-LENGTH)                             08209099
082100          RESP     (PV-CICS-RESPONSE)                             08210099
082110     END-EXEC.                                                    08211099
082120                                                                  08212099
082130     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    08213099
082140         SET DP013-LOGIC-ABEND     TO TRUE                        08214099
082150         SET DP013-NO-ROLLBACK     TO TRUE                        08215099
082160         MOVE '7200-TD-QUEUE-ENQ'  TO DP013-PARAGRAPH             08216099
082170         MOVE PV-CICS-RESPONSE     TO DP013-MESSAGE-TEXT (1)      08217099
082180         MOVE 'ERROR ENQUEING TD'                                 08218099
082190                                   TO DP013-MESSAGE-TEXT (2)      08219099
082200         PERFORM DP013-0000-PROCESS-ABEND                         08220099
082210     END-IF.                                                      08221099
082220                                                                  08222099
082230*----------------------------------------------------------------*08223099
082240*  WRITE A JCL LINE TO THE TRANSIENT DATE QUEUE                  *08224099
082250*----------------------------------------------------------------*08225099
082260 7300-WRITE-TRANS-DATA-LINE.                                      08226099
082270                                                                  08227099
082280     EXEC CICS WRITEQ TD                                          08228099
082290          QUEUE    (TD-QUEUE-NAME)                                08229099
082300          FROM     (TD-JCL-LINE)                                  08230099
082310          LENGTH   (TD-JCL-LINE-LENGTH)                           08231099
082320          RESP     (PV-CICS-RESPONSE)                             08232099
082330     END-EXEC.                                                    08233099
082340                                                                  08234099
082350     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    08235099
082360         SET DP013-LOGIC-ABEND     TO TRUE                        08236099
082370         SET DP013-NO-ROLLBACK     TO TRUE                        08237099
082380         MOVE '7300-WRITE-TRANS-DATA-LINE'                        08238099
082390                                   TO DP013-PARAGRAPH             08239099
082400         MOVE PV-CICS-RESPONSE     TO DP013-MESSAGE-TEXT (1)      08240099
082410         MOVE 'ERROR WRITEING TRANS DATA LINE'                    08241099
082420                                   TO DP013-MESSAGE-TEXT (2)      08242099
082430         PERFORM DP013-0000-PROCESS-ABEND                         08243099
082440     END-IF.                                                      08244099
082450                                                                  08245099
082460*----------------------------------------------------------------*08246099
082470*  DENQUE THE TRANSIENT DATA QUEUE                               *08247099
082480*----------------------------------------------------------------*08248099
082490 7400-TD-QUEUE-DEQ.                                               08249099
082500                                                                  08250099
082510     EXEC CICS DEQ                                                08251099
082520          RESOURCE (TD-QUEUE-NAME)                                08252099
082530          LENGTH   (TD-Q-NAME-LENGTH)                             08253099
082540          RESP     (PV-CICS-RESPONSE)                             08254099
082550     END-EXEC.                                                    08255099
082560                                                                  08256099
082570     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    08257099
082580         SET DP013-LOGIC-ABEND     TO TRUE                        08258099
082590         SET DP013-NO-ROLLBACK     TO TRUE                        08259099
082600         MOVE '7400-TD-QUEUE-DEQ'  TO DP013-PARAGRAPH             08260099
082610         MOVE PV-CICS-RESPONSE     TO DP013-MESSAGE-TEXT (1)      08261099
082620         MOVE 'ERROR DENQUEING TD'                                08262099
082630                                   TO DP013-MESSAGE-TEXT (2)      08263099
082640         PERFORM DP013-0000-PROCESS-ABEND                         08264099
082650     END-IF.                                                      08265099
082660                                                                  08266099
082670*----------------------------------------------------------------*08267099
082680*    READ THE LIST QUEUE RECORD.                                 *08268099
082690*----------------------------------------------------------------*08269099
082700                                                                  08270099
082710 9100-READ-SEL-QUEUE.                                             08271099
082720                                                                  08272099
082730     EXEC CICS                                                    08273099
082740          READQ TS                                                08274099
082750             QUEUE (ASC-SEL-QUEUE-NAME)                           08275099
082760             INTO  (PO012-PO-SELECT-RECORD)                       08276099
082770             ITEM  (ASC-SEL-ITEM)                                 08277099
082780             RESP  (PV-CICS-RESP)                                 08278099
082790     END-EXEC.                                                    08279099
082800                                                                  08280099
082810     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          08281099
082820         CONTINUE                                                 08282099
082830     ELSE                                                         08283099
082840         SET DP013-CICS-ABEND      TO  TRUE                       08284099
082850         SET DP013-NO-ROLLBACK     TO  TRUE                       08285099
082860         MOVE '9100-READ-SEL-QUEUE'                               08286099
082870                                   TO  DP013-PARAGRAPH            08287099
082880         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           08288099
082890                                   TO  DP013-MESSAGE-TEXT(1)      08289099
082900         PERFORM DP013-0000-PROCESS-ABEND                         08290099
082910     END-IF.                                                      08291099
082920                                                                  08292099
082930 EJECT                                                            08293099
082940*----------------------------------------------------------------*08294099
082950*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *08295099
082960*  SPECIFIC COMMAREA.                                            *08296099
082970*----------------------------------------------------------------*08297099
082980                                                                  08298099
082990 9200-REWRITE-SEL-QUEUE.                                          08299099
083000                                                                  08300099
083010     EXEC CICS                                                    08301099
083020         WRITEQ TS                                                08302099
083030             QUEUE (ASC-SEL-QUEUE-NAME)                           08303099
083040             FROM  (PO012-PO-SELECT-RECORD)                       08304099
083050             ITEM  (ASC-SEL-ITEM)                                 08305099
083060             REWRITE                                              08306099
083070             RESP  (PV-CICS-RESP)                                 08307099
083080     END-EXEC.                                                    08308099
083090                                                                  08309099
083100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           08310099
083110         CONTINUE                                                 08311099
083120     ELSE                                                         08312099
083130         SET DP013-CICS-ABEND            TO TRUE                  08313099
083140         SET DP013-NO-ROLLBACK           TO TRUE                  08314099
083150         MOVE '9200-REWRITE-SEL-QUEUE'   TO DP013-PARAGRAPH       08315099
083160         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     08316099
083170                                         TO DP013-MESSAGE-TEXT(1) 08317099
083180         PERFORM DP013-0000-PROCESS-ABEND                         08318099
083190     END-IF.                                                      08319099
083200 EJECT                                                            08320099
083210*----------------------------------------------------------------*08321099
083220*  SET UP THE VARIABLE CONTROL TABLE                             *08322099
083230*----------------------------------------------------------------*08323099
083240                                                                  08324099
083250 9400-SETUP-VARIABLE-PARAMETERS.                                  08325099
083260                                                                  08326099
083270*#VARIABLE_LOGIC_GROUP_1-----------------------------------------*08327099
083280*  THIS CODE IS PART OF THE INITIAL PROGRAM START UP PHASE.      *08328099
083290*  IT BEGINS BY LOADING ALL OF THE DC STORE NUMBERS.  THEN       *08329099
083300*  IT SCANS THE TR19-DISPLAY-DXXX CRITERIA FIELDS TO DETERMINE   *08330099
083310*  WHAT FIELDS SHOULD DISPLAY.  IF THE USERS OVERRIDE THE        *08331099
083320*  PLACEMENT OF COLUMNS ON THE VARIABLE DISPLAY, THEN THIS       *08332099
083330*  SECTION SETS UP THE OVERRIDE ORDER.                           *08333099
083340*----------------------------------------------------------------*08334099
083350*---------------------------------------------------------------* 08335099
083360*  #TIP ==>                                                     * 08336099
083370*  IF MORE THAN 12 DCS ARE NEEDED THEN PARAGRAPH                * 08337099
083380*  9870-FETCH-STORE WILL NEED TO CHANGE.                        * 08338099
083390*---------------------------------------------------------------* 08339099
083400     SET MORE-STORE-DATA TO TRUE.                                 08340099
083410     PERFORM 9860-OPEN-STORE-CURSOR.                              08341099
083420     PERFORM 9870-FETCH-STORE                                     08342099
083430                    UNTIL NO-MORE-STORE-DATA                      08343099
083440     PERFORM 9880-CLOSE-STORE-CURSOR.                             08344099
083450     MOVE PV-DC-TABLE TO ASC-DC-TABLE.                            08345099
083460     MOVE PV-DC-I     TO ASC-DC-NMBR.                             08346099
083470                                                                  08347099
083480*---------------------------------------------------------------* 08348099
083490*  #TIP ==>                                                     * 08349099
083500*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          * 08350099
083510*  OF ONE OF THE FOLLOWING.                                     * 08351099
083520*                                                               * 08352099
083530*  NORMALLY THE CONVENTION FOR EACH BLOCK SHOULD NEVER          * 08353099
083540*  CHANGE.                                                      * 08354099
083550*---------------------------------------------------------------* 08355099
083560     IF TR195-DISPLAY-DFOB                                        08356099
083570        SET DO-SCREEN-DIMENSION TO TRUE                           08357099
083580        MOVE TR195-DFOB         TO PV-FOB-SELECTED                08358099
083590        MOVE PC-VFLD-FOB-I      TO PV-FOB-POINTER                 08359099
083600        MOVE PV-VFLD-FOB-DORDER TO PV-FOB-OORDER                  08360099
083610        IF TR195-DISPLAY-OFOB                                     08361099
083620           MOVE PC-SEL     TO PV-FOB-SELECTED                     08362099
083630           MOVE TR195-DFOB TO PV-FOB-OORDER.                      08363099
083640                                                                  08364099
083650     IF TR195-DISPLAY-DPOE                                        08365099
083660        SET DO-SCREEN-DIMENSION TO TRUE                           08366099
083670        MOVE TR195-DPOE         TO PV-POE-SELECTED                08367099
083680        MOVE PC-VFLD-POE-I      TO PV-POE-POINTER                 08368099
083690        MOVE PV-VFLD-POE-DORDER TO PV-POE-OORDER                  08369099
083700        IF TR195-DISPLAY-OPOE                                     08370099
083710           MOVE PC-SEL     TO PV-POE-SELECTED                     08371099
083720           MOVE TR195-DPOE TO PV-POE-OORDER.                      08372099
083730                                                                  08373099
083740     IF TR195-DISPLAY-DDSB                                        08374099
083750        SET DO-SCREEN-DIMENSION TO TRUE                           08375099
083760        MOVE TR195-DDSB         TO PV-DSB-SELECTED                08376099
083770        MOVE PC-VFLD-DSB-I      TO PV-DSB-POINTER                 08377099
083780        MOVE PV-VFLD-DSB-DORDER TO PV-DSB-OORDER                  08378099
083790        IF TR195-DISPLAY-ODSB                                     08379099
083800           MOVE PC-SEL     TO PV-DSB-SELECTED                     08380099
083810           MOVE TR195-DDSB TO PV-DSB-OORDER.                      08381099
083820                                                                  08382099
083830     IF TR195-DISPLAY-DXFC                                        08383099
083840        SET DO-SCREEN-DIMENSION TO TRUE                           08384099
083850        MOVE TR195-DXFC         TO PV-SXF-SELECTED                08385099
083860        MOVE PC-VFLD-SXF-I      TO PV-SXF-POINTER                 08386099
083870        MOVE PV-VFLD-SXF-DORDER TO PV-SXF-OORDER                  08387099
083880        IF TR195-DISPLAY-OXFC                                     08388099
083890           MOVE PC-SEL     TO PV-SXF-SELECTED                     08389099
083900           MOVE TR195-DXFC TO PV-SXF-OORDER.                      08390099
083910                                                                  08391099
083920     IF TR195-DISPLAY-DXFC                                        08392099
083930        SET DO-SCREEN-DIMENSION TO TRUE                           08393099
083940        MOVE TR195-DXFC         TO PV-LXF-SELECTED                08394099
083950        MOVE PC-VFLD-LXF-I      TO PV-LXF-POINTER                 08395099
083960        MOVE PV-VFLD-LXF-DORDER TO PV-LXF-OORDER                  08396099
083970        IF TR195-DISPLAY-OXFC                                     08397099
083980           MOVE PC-SEL     TO PV-LXF-SELECTED                     08398099
083990           MOVE TR195-DXFC TO PV-LXF-OORDER.                      08399099
084000                                                                  08400099
084010     IF TR195-DISPLAY-DCNL                                        08401099
084020        SET DO-SCREEN-DIMENSION TO TRUE                           08402099
084030        MOVE TR195-DCNL         TO PV-CNL-SELECTED                08403099
084040        MOVE PC-VFLD-CNL-I      TO PV-CNL-POINTER                 08404099
084050        MOVE PV-VFLD-CNL-DORDER TO PV-CNL-OORDER                  08405099
084060        IF TR195-DISPLAY-OCNL                                     08406099
084070           MOVE PC-SEL     TO PV-CNL-SELECTED                     08407099
084080           MOVE TR195-DCNL TO PV-CNL-OORDER.                      08408099
084090                                                                  08409099
084100     IF TR195-DISPLAY-DFRD                                        08410099
084110        SET DO-SCREEN-DIMENSION TO TRUE                           08411099
084120        MOVE TR195-DFRD         TO PV-FRD-SELECTED                08412099
084130        MOVE PC-VFLD-FRD-I      TO PV-FRD-POINTER                 08413099
084140        MOVE PV-VFLD-FRD-DORDER TO PV-FRD-OORDER                  08414099
084150        IF TR195-DISPLAY-OFRD                                     08415099
084160           MOVE PC-SEL     TO PV-FRD-SELECTED                     08416099
084170           MOVE TR195-DFRD TO PV-FRD-OORDER.                      08417099
084180                                                                  08418099
084190     IF TR195-DISPLAY-DSLD                                        08419099
084200        SET DO-SCREEN-DIMENSION TO TRUE                           08420099
084210        MOVE TR195-DSLD         TO PV-SLD-SELECTED                08421099
084220        MOVE PC-VFLD-SLD-I      TO PV-SLD-POINTER                 08422099
084230        MOVE PV-VFLD-SLD-DORDER TO PV-SLD-OORDER                  08423099
084240        IF TR195-DISPLAY-OSLD                                     08424099
084250           MOVE PC-SEL     TO PV-SLD-SELECTED                     08425099
084260           MOVE TR195-DSLD TO PV-SLD-OORDER.                      08426099
084270                                                                  08427099
084280     IF TR195-DISPLAY-DPRD                                        08428099
084290        SET DO-SCREEN-DIMENSION TO TRUE                           08429099
084300        MOVE TR195-DPRD         TO PV-PRD-SELECTED                08430099
084310        MOVE PC-VFLD-PRD-I      TO PV-PRD-POINTER                 08431099
084320        MOVE PV-VFLD-PRD-DORDER TO PV-PRD-OORDER                  08432099
084330        IF TR195-DISPLAY-OPRD                                     08433099
084340           MOVE PC-SEL     TO PV-PRD-SELECTED                     08434099
084350           MOVE TR195-DPRD TO PV-PRD-OORDER.                      08435099
084360                                                                  08436099
084370     IF TR195-DISPLAY-DPRD                                        08437099
084380        SET DO-SCREEN-DIMENSION TO TRUE                           08438099
084390        MOVE TR195-DPRD         TO PV-CNT-SELECTED                08439099
084400        MOVE PC-VFLD-CNT-I      TO PV-CNT-POINTER                 08440099
084410        MOVE PV-VFLD-CNT-DORDER TO PV-CNT-OORDER                  08441099
084420        IF TR195-DISPLAY-OPRD                                     08442099
084430           MOVE PC-SEL     TO PV-CNT-SELECTED                     08443099
084440           MOVE TR195-DPRD TO PV-CNT-OORDER.                      08444099
084450                                                                  08445099
084460     IF TR195-DISPLAY-DCSR                                        08446099
084470        SET DO-SCREEN-DIMENSION TO TRUE                           08447099
084480        MOVE TR195-DCSR         TO PV-CSR-SELECTED                08448099
084490        MOVE PC-VFLD-CSR-I      TO PV-CSR-POINTER                 08449099
084500        MOVE PV-VFLD-CSR-DORDER TO PV-CSR-OORDER                  08450099
084510        IF TR195-DISPLAY-OCSR                                     08451099
084520           MOVE PC-SEL     TO PV-CSR-SELECTED                     08452099
084530           MOVE TR195-DCSR TO PV-CSR-OORDER.                      08453099
084540                                                                  08454099
084550     IF TR195-DISPLAY-DETA                                        08455099
084560      IF DC-STORE-NMBR(1) NOT = ZEROS                             08456099
084570        SET DO-SCREEN-DIMENSION TO TRUE                           08457099
084580        MOVE TR195-DETA         TO PV-DC1-SELECTED                08458099
084590        MOVE PC-VFLD-DC1-I      TO PV-DC1-POINTER                 08459099
084600        MOVE PV-VFLD-DC1-DORDER TO PV-DC1-OORDER                  08460099
084610        IF TR195-DISPLAY-OETA                                     08461099
084620           MOVE PC-SEL     TO PV-DC1-SELECTED                     08462099
084630           MOVE TR195-DETA TO PV-DC1-OORDER.                      08463099
084640                                                                  08464099
084650     IF TR195-DISPLAY-DETA                                        08465099
084660      IF DC-STORE-NMBR(2) NOT = ZEROS                             08466099
084670        SET DO-SCREEN-DIMENSION TO TRUE                           08467099
084680        MOVE TR195-DETA         TO PV-DC2-SELECTED                08468099
084690        MOVE PC-VFLD-DC2-I      TO PV-DC2-POINTER                 08469099
084700        MOVE PV-VFLD-DC2-DORDER TO PV-DC2-OORDER                  08470099
084710        IF TR195-DISPLAY-OETA                                     08471099
084720           MOVE PC-SEL     TO PV-DC2-SELECTED                     08472099
084730           MOVE TR195-DETA TO PV-DC2-OORDER.                      08473099
084740                                                                  08474099
084750     IF TR195-DISPLAY-DETA                                        08475099
084760      IF DC-STORE-NMBR(3) NOT = ZEROS                             08476099
084770        SET DO-SCREEN-DIMENSION TO TRUE                           08477099
084780        MOVE TR195-DETA         TO PV-DC3-SELECTED                08478099
084790        MOVE PC-VFLD-DC3-I      TO PV-DC3-POINTER                 08479099
084800        MOVE PV-VFLD-DC3-DORDER TO PV-DC3-OORDER                  08480099
084810        IF TR195-DISPLAY-OETA                                     08481099
084820           MOVE PC-SEL     TO PV-DC3-SELECTED                     08482099
084830           MOVE TR195-DETA TO PV-DC3-OORDER.                      08483099
084840                                                                  08484099
084850     IF TR195-DISPLAY-DETA                                        08485099
084860      IF DC-STORE-NMBR(4) NOT = ZEROS                             08486099
084870        SET DO-SCREEN-DIMENSION TO TRUE                           08487099
084880        MOVE TR195-DETA         TO PV-DC4-SELECTED                08488099
084890        MOVE PC-VFLD-DC4-I      TO PV-DC4-POINTER                 08489099
084900        MOVE PV-VFLD-DC4-DORDER TO PV-DC4-OORDER                  08490099
084910        IF TR195-DISPLAY-OETA                                     08491099
084920           MOVE PC-SEL     TO PV-DC4-SELECTED                     08492099
084930           MOVE TR195-DETA TO PV-DC4-OORDER.                      08493099
084940                                                                  08494099
084950     IF TR195-DISPLAY-DETA                                        08495099
084960      IF DC-STORE-NMBR(5) NOT = ZEROS                             08496099
084970        SET DO-SCREEN-DIMENSION TO TRUE                           08497099
084980        MOVE TR195-DETA         TO PV-DC5-SELECTED                08498099
084990        MOVE PC-VFLD-DC5-I      TO PV-DC5-POINTER                 08499099
085000        MOVE PV-VFLD-DC5-DORDER TO PV-DC5-OORDER                  08500099
085010        IF TR195-DISPLAY-OETA                                     08501099
085020           MOVE PC-SEL     TO PV-DC5-SELECTED                     08502099
085030           MOVE TR195-DETA TO PV-DC5-OORDER.                      08503099
085040                                                                  08504099
085050     IF TR195-DISPLAY-DETA                                        08505099
085060      IF DC-STORE-NMBR(6) NOT = ZEROS                             08506099
085070        SET DO-SCREEN-DIMENSION TO TRUE                           08507099
085080        MOVE TR195-DETA         TO PV-DC6-SELECTED                08508099
085090        MOVE PC-VFLD-DC6-I      TO PV-DC6-POINTER                 08509099
085100        MOVE PV-VFLD-DC6-DORDER TO PV-DC6-OORDER                  08510099
085110        IF TR195-DISPLAY-OETA                                     08511099
085120           MOVE PC-SEL     TO PV-DC6-SELECTED                     08512099
085130           MOVE TR195-DETA TO PV-DC6-OORDER.                      08513099
085140                                                                  08514099
085150     IF TR195-DISPLAY-DETA                                        08515099
085160      IF DC-STORE-NMBR(7) NOT = ZEROS                             08516099
085170        SET DO-SCREEN-DIMENSION TO TRUE                           08517099
085180        MOVE TR195-DETA         TO PV-DC7-SELECTED                08518099
085190        MOVE PC-VFLD-DC7-I      TO PV-DC7-POINTER                 08519099
085200        MOVE PV-VFLD-DC7-DORDER TO PV-DC7-OORDER                  08520099
085210        IF TR195-DISPLAY-OETA                                     08521099
085220           MOVE PC-SEL     TO PV-DC7-SELECTED                     08522099
085230           MOVE TR195-DETA TO PV-DC7-OORDER.                      08523099
085240                                                                  08524099
085250     IF TR195-DISPLAY-DETA                                        08525099
085260      IF DC-STORE-NMBR(8) NOT = ZEROS                             08526099
085270        SET DO-SCREEN-DIMENSION TO TRUE                           08527099
085280        MOVE TR195-DETA         TO PV-DC8-SELECTED                08528099
085290        MOVE PC-VFLD-DC8-I      TO PV-DC8-POINTER                 08529099
085300        MOVE PV-VFLD-DC8-DORDER TO PV-DC8-OORDER                  08530099
085310        IF TR195-DISPLAY-OETA                                     08531099
085320           MOVE PC-SEL     TO PV-DC8-SELECTED                     08532099
085330           MOVE TR195-DETA TO PV-DC8-OORDER.                      08533099
085340                                                                  08534099
085350     IF TR195-DISPLAY-DETA                                        08535099
085360      IF DC-STORE-NMBR(9) NOT = ZEROS                             08536099
085370        SET DO-SCREEN-DIMENSION TO TRUE                           08537099
085380        MOVE TR195-DETA         TO PV-DC9-SELECTED                08538099
085390        MOVE PC-VFLD-DC9-I      TO PV-DC9-POINTER                 08539099
085400        MOVE PV-VFLD-DC9-DORDER TO PV-DC9-OORDER                  08540099
085410        IF TR195-DISPLAY-OETA                                     08541099
085420           MOVE PC-SEL     TO PV-DC9-SELECTED                     08542099
085430           MOVE TR195-DETA TO PV-DC9-OORDER.                      08543099
085440                                                                  08544099
085450     IF TR195-DISPLAY-DETA                                        08545099
085460      IF DC-STORE-NMBR(10) NOT = ZEROS                            08546099
085470        SET DO-SCREEN-DIMENSION TO TRUE                           08547099
085480        MOVE TR195-DETA          TO PV-DC10-SELECTED              08548099
085490        MOVE PC-VFLD-DC10-I      TO PV-DC10-POINTER               08549099
085500        MOVE PV-VFLD-DC10-DORDER TO PV-DC10-OORDER                08550099
085510        IF TR195-DISPLAY-OETA                                     08551099
085520           MOVE PC-SEL     TO PV-DC10-SELECTED                    08552099
085530           MOVE TR195-DETA TO PV-DC10-OORDER.                     08553099
085540                                                                  08554099
085550     IF TR195-DISPLAY-DETA                                        08555099
085560      IF DC-STORE-NMBR(11) NOT = ZEROS                            08556099
085570        SET DO-SCREEN-DIMENSION TO TRUE                           08557099
085580        MOVE TR195-DETA          TO PV-DC11-SELECTED              08558099
085590        MOVE PC-VFLD-DC11-I      TO PV-DC11-POINTER               08559099
085600        MOVE PV-VFLD-DC11-DORDER TO PV-DC11-OORDER                08560099
085610        IF TR195-DISPLAY-OETA                                     08561099
085620           MOVE PC-SEL     TO PV-DC11-SELECTED                    08562099
085630           MOVE TR195-DETA TO PV-DC11-OORDER.                     08563099
085640                                                                  08564099
085650     IF TR195-DISPLAY-DETA                                        08565099
085660      IF DC-STORE-NMBR(12) NOT = ZEROS                            08566099
085670        SET DO-SCREEN-DIMENSION TO TRUE                           08567099
085680        MOVE TR195-DETA          TO PV-DC12-SELECTED              08568099
085690        MOVE PC-VFLD-DC12-I      TO PV-DC12-POINTER               08569099
085700        MOVE PV-VFLD-DC12-DORDER TO PV-DC12-OORDER                08570099
085710        IF TR195-DISPLAY-OETA                                     08571099
085720           MOVE PC-SEL     TO PV-DC12-SELECTED                    08572099
085730           MOVE TR195-DETA TO PV-DC12-OORDER.                     08573099
085740                                                                  08574099
085750     IF TR195-DISPLAY-DDVN                                        08575099
085760        SET DO-SCREEN-DIMENSION TO TRUE                           08576099
085770        MOVE TR195-DDVN         TO PV-DVN-SELECTED                08577099
085780        MOVE PC-VFLD-DVN-I      TO PV-DVN-POINTER                 08578099
085790        MOVE PV-VFLD-DVN-DORDER TO PV-DVN-OORDER                  08579099
085800        IF TR195-DISPLAY-ODVN                                     08580099
085810           MOVE PC-SEL     TO PV-DVN-SELECTED                     08581099
085820           MOVE TR195-DDVN TO PV-DVN-OORDER.                      08582099
085830                                                                  08583099
085840     IF TR195-DISPLAY-DBKD                                        08584099
085850        SET DO-SCREEN-DIMENSION TO TRUE                           08585099
085860        MOVE TR195-DBKD         TO PV-BKD-SELECTED                08586099
085870        MOVE PC-VFLD-BKD-I      TO PV-BKD-POINTER                 08587099
085880        MOVE PV-VFLD-BKD-DORDER TO PV-BKD-OORDER                  08588099
085890        IF TR195-DISPLAY-OBKD                                     08589099
085900           MOVE PC-SEL     TO PV-BKD-SELECTED                     08590099
085910           MOVE TR195-DBKD TO PV-BKD-OORDER.                      08591099
085920                                                                  08592099
085930     IF TR195-DISPLAY-DDOL                                        08593099
085940        SET DO-SCREEN-DIMENSION TO TRUE                           08594099
085950        MOVE TR195-DDOL         TO PV-FSC-SELECTED                08595099
085960        MOVE PC-VFLD-FSC-I      TO PV-FSC-POINTER                 08596099
085970        MOVE PV-VFLD-FSC-DORDER TO PV-FSC-OORDER                  08597099
085980        IF TR195-DISPLAY-ODOL                                     08598099
085990           MOVE PC-SEL     TO PV-FSC-SELECTED                     08599099
086000           MOVE TR195-DDOL TO PV-FSC-OORDER.                      08600099
086010                                                                  08601099
086020     IF TR195-DISPLAY-DDOL                                        08602099
086030        SET DO-SCREEN-DIMENSION TO TRUE                           08603099
086040        MOVE TR195-DDOL         TO PV-TTC-SELECTED                08604099
086050        MOVE PC-VFLD-TTC-I      TO PV-TTC-POINTER                 08605099
086060        MOVE PV-VFLD-TTC-DORDER TO PV-TTC-OORDER                  08606099
086070        IF TR195-DISPLAY-ODOL                                     08607099
086080           MOVE PC-SEL     TO PV-TTC-SELECTED                     08608099
086090           MOVE TR195-DDOL TO PV-TTC-OORDER.                      08609099
086100                                                                  08610099
086110     IF TR195-DISPLAY-DDOL                                        08611099
086120        SET DO-SCREEN-DIMENSION TO TRUE                           08612099
086130        MOVE TR195-DDOL         TO PV-TVC-SELECTED                08613099
086140        MOVE PC-VFLD-TVC-I      TO PV-TVC-POINTER                 08614099
086150        MOVE PV-VFLD-TVC-DORDER TO PV-TVC-OORDER                  08615099
086160        IF TR195-DISPLAY-ODOL                                     08616099
086170           MOVE PC-SEL     TO PV-TVC-SELECTED                     08617099
086180           MOVE TR195-DDOL TO PV-TVC-OORDER.                      08618099
086190                                                                  08619099
086200     IF TR195-DISPLAY-DUNT                                        08620099
086210        SET DO-SCREEN-DIMENSION TO TRUE                           08621099
086220        MOVE TR195-DUNT         TO PV-UOR-SELECTED                08622099
086230        MOVE PC-VFLD-UOR-I      TO PV-UOR-POINTER                 08623099
086240        MOVE PV-VFLD-UOR-DORDER TO PV-UOR-OORDER                  08624099
086250        IF TR195-DISPLAY-OUNT                                     08625099
086260           MOVE PC-SEL     TO PV-UOR-SELECTED                     08626099
086270           MOVE TR195-DUNT TO PV-UOR-OORDER.                      08627099
086280                                                                  08628099
086290     IF TR195-DISPLAY-DUNT                                        08629099
086300        SET DO-SCREEN-DIMENSION TO TRUE                           08630099
086310        MOVE TR195-DUNT         TO PV-URC-SELECTED                08631099
086320        MOVE PC-VFLD-URC-I      TO PV-URC-POINTER                 08632099
086330        MOVE PV-VFLD-URC-DORDER TO PV-URC-OORDER                  08633099
086340        IF TR195-DISPLAY-OUNT                                     08634099
086350           MOVE PC-SEL     TO PV-URC-SELECTED                     08635099
086360           MOVE TR195-DUNT TO PV-URC-OORDER.                      08636099
086370                                                                  08637099
086380     IF TR195-DISPLAY-DUNT                                        08638099
086390        SET DO-SCREEN-DIMENSION TO TRUE                           08639099
086400        MOVE TR195-DUNT         TO PV-URP-SELECTED                08640099
086410        MOVE PC-VFLD-URP-I      TO PV-URP-POINTER                 08641099
086420        MOVE PV-VFLD-URP-DORDER TO PV-URP-OORDER                  08642099
086430        IF TR195-DISPLAY-OUNT                                     08643099
086440           MOVE PC-SEL     TO PV-URP-SELECTED                     08644099
086450           MOVE TR195-DUNT TO PV-URP-OORDER.                      08645099
086460                                                                  08646099
086470     IF TR195-DISPLAY-DDOL                                        08647099
086480        SET DO-SCREEN-DIMENSION TO TRUE                           08648099
086490        MOVE TR195-DDOL         TO PV-DOR-SELECTED                08649099
086500        MOVE PC-VFLD-DOR-I      TO PV-DOR-POINTER                 08650099
086510        MOVE PV-VFLD-DOR-DORDER TO PV-DOR-OORDER                  08651099
086520        IF TR195-DISPLAY-ODOL                                     08652099
086530           MOVE PC-SEL     TO PV-DOR-SELECTED                     08653099
086540           MOVE TR195-DDOL TO PV-DOR-OORDER.                      08654099
086550                                                                  08655099
086560     IF TR195-DISPLAY-DDOL                                        08656099
086570        SET DO-SCREEN-DIMENSION TO TRUE                           08657099
086580        MOVE TR195-DDOL         TO PV-DRC-SELECTED                08658099
086590        MOVE PC-VFLD-DRC-I      TO PV-DRC-POINTER                 08659099
086600        MOVE PV-VFLD-DRC-DORDER TO PV-DRC-OORDER                  08660099
086610        IF TR195-DISPLAY-ODOL                                     08661099
086620           MOVE PC-SEL     TO PV-DRC-SELECTED                     08662099
086630           MOVE TR195-DDOL TO PV-DRC-OORDER.                      08663099
086640                                                                  08664099
086650     IF TR195-DISPLAY-DDOL                                        08665099
086660        SET DO-SCREEN-DIMENSION TO TRUE                           08666099
086670        MOVE TR195-DDOL         TO PV-DRP-SELECTED                08667099
086680        MOVE PC-VFLD-DRP-I      TO PV-DRP-POINTER                 08668099
086690        MOVE PV-VFLD-DRP-DORDER TO PV-DRP-OORDER                  08669099
086700        IF TR195-DISPLAY-ODOL                                     08670099
086710           MOVE PC-SEL     TO PV-DRP-SELECTED                     08671099
086720           MOVE TR195-DDOL TO PV-DRP-OORDER.                      08672099
086730                                                                  08673099
086740     IF TR195-DISPLAY-DOTB                                        08674099
086750        SET DO-SCREEN-DIMENSION TO TRUE                           08675099
086760        MOVE TR195-DOTB         TO PV-OTB-SELECTED                08676099
086770        MOVE PC-VFLD-OTB-I      TO PV-OTB-POINTER                 08677099
086780        MOVE PV-VFLD-OTB-DORDER TO PV-OTB-OORDER                  08678099
086790        IF TR195-DISPLAY-OOTB                                     08679099
086800           MOVE PC-SEL     TO PV-OTB-SELECTED                     08680099
086810           MOVE TR195-DOTB TO PV-OTB-OORDER.                      08681099
086820                                                                  08682099
086830     IF TR195-DISPLAY-DEDI                                        08683099
086840        SET DO-SCREEN-DIMENSION TO TRUE                           08684099
086850        MOVE TR195-DEDI         TO PV-EDI-SELECTED                08685099
086860        MOVE PC-VFLD-EDI-I      TO PV-EDI-POINTER                 08686099
086870        MOVE PV-VFLD-EDI-DORDER TO PV-EDI-OORDER                  08687099
086880        IF TR195-DISPLAY-OEDI                                     08688099
086890           MOVE PC-SEL     TO PV-EDI-SELECTED                     08689099
086900           MOVE TR195-DEDI TO PV-EDI-OORDER.                      08690099
086910                                                                  08691099
086920     IF TR195-DISPLAY-DPPK                                        08692099
086930        SET DO-SCREEN-DIMENSION TO TRUE                           08693099
086940        MOVE TR195-DPPK         TO PV-PPK-SELECTED                08694099
086950        MOVE PC-VFLD-PPK-I      TO PV-PPK-POINTER                 08695099
086960        MOVE PV-VFLD-PPK-DORDER TO PV-PPK-OORDER                  08696099
086970        IF TR195-DISPLAY-OPPK                                     08697099
086980           MOVE PC-SEL     TO PV-PPK-SELECTED                     08698099
086990           MOVE TR195-DPPK TO PV-PPK-OORDER.                      08699099
087000                                                                  08700099
087010     IF TR195-DISPLAY-DSTA                                        08701099
087020        SET DO-SCREEN-DIMENSION TO TRUE                           08702099
087030        MOVE TR195-DSTA         TO PV-STA-SELECTED                08703099
087040        MOVE PC-VFLD-STA-I      TO PV-STA-POINTER                 08704099
087050        MOVE PV-VFLD-STA-DORDER TO PV-STA-OORDER                  08705099
087060        IF TR195-DISPLAY-OSTA                                     08706099
087070           MOVE PC-SEL     TO PV-STA-SELECTED                     08707099
087080           MOVE TR195-DSTA TO PV-STA-OORDER.                      08708099
087090                                                                  08709099
087100     IF TR195-DISPLAY-DTRP                                        08710099
087110        SET DO-SCREEN-DIMENSION TO TRUE                           08711099
087120        MOVE TR195-DTRP         TO PV-TRP-SELECTED                08712099
087130        MOVE PC-VFLD-TRP-I      TO PV-TRP-POINTER                 08713099
087140        MOVE PV-VFLD-TRP-DORDER TO PV-TRP-OORDER                  08714099
087150        IF TR195-DISPLAY-OTRP                                     08715099
087160           MOVE PC-SEL     TO PV-TRP-SELECTED                     08716099
087170           MOVE TR195-DTRP TO PV-TRP-OORDER.                      08717099
087180                                                                  08718099
087190     IF TR195-DISPLAY-DSPL                                        08719099
087200        SET DO-SCREEN-DIMENSION TO TRUE                           08720099
087210        MOVE TR195-DSPL             TO PV-SPL-CRT-SELECTED        08721099
087220        MOVE PC-VFLD-SPL-CRT-I      TO PV-SPL-CRT-POINTER         08722099
087230        MOVE PV-VFLD-SPL-CRT-DORDER TO PV-SPL-CRT-OORDER          08723099
087240        IF TR195-DISPLAY-OSPL                                     08724099
087250           MOVE PC-SEL     TO PV-SPL-CRT-SELECTED                 08725099
087260           MOVE TR195-DSPL TO PV-SPL-CRT-OORDER.                  08726099
087270                                                                  08727099
087280     IF TR195-DISPLAY-DSPL                                        08728099
087290        SET DO-SCREEN-DIMENSION TO TRUE                           08729099
087300        MOVE TR195-DSPL             TO PV-SPL-SNT-SELECTED        08730099
087310        MOVE PC-VFLD-SPL-SNT-I      TO PV-SPL-SNT-POINTER         08731099
087320        MOVE PV-VFLD-SPL-SNT-DORDER TO PV-SPL-SNT-OORDER          08732099
087330        IF TR195-DISPLAY-OSPL                                     08733099
087340           MOVE PC-SEL     TO PV-SPL-SNT-SELECTED                 08734099
087350           MOVE TR195-DSPL TO PV-SPL-SNT-OORDER.                  08735099
087360                                                                  08736099
087370     IF TR195-DISPLAY-DSPL                                        08737099
087380        SET DO-SCREEN-DIMENSION TO TRUE                           08738099
087390        MOVE TR195-DSPL             TO PV-STD-SELECTED            08739099
087400        MOVE PC-VFLD-STD-I          TO PV-STD-POINTER             08740099
087410        MOVE PV-VFLD-STD-DORDER     TO PV-STD-OORDER              08741099
087420        IF TR195-DISPLAY-OSPL                                     08742099
087430           MOVE PC-SEL     TO PV-STD-SELECTED                     08743099
087440           MOVE TR195-DSPL TO PV-STD-OORDER.                      08744099
087450                                                                  08745099
087460     IF TR195-DISPLAY-DADD                                        08746099
087470        SET DO-SCREEN-DIMENSION TO TRUE                           08747099
087480        MOVE TR195-DADD         TO PV-AED-SELECTED                08748099
087490        MOVE PC-VFLD-AED-I      TO PV-AED-POINTER                 08749099
087500        MOVE PV-VFLD-AED-DORDER TO PV-AED-OORDER                  08750099
087510        IF TR195-DISPLAY-OADD                                     08751099
087520           MOVE PC-SEL     TO PV-AED-SELECTED                     08752099
087530           MOVE TR195-DADD TO PV-AED-OORDER.                      08753099
087540                                                                  08754099
087550     IF TR195-DISPLAY-DQCT                                        08755099
087560        SET DO-SCREEN-DIMENSION TO TRUE                           08756099
087570        MOVE TR195-DQCT         TO PV-QCT-SELECTED                08757099
087580        MOVE PC-VFLD-QCT-I      TO PV-QCT-POINTER                 08758099
087590        MOVE PV-VFLD-QCT-DORDER TO PV-QCT-OORDER                  08759099
087600        IF TR195-DISPLAY-OQCT                                     08760099
087610           MOVE PC-SEL     TO PV-QCT-SELECTED                     08761099
087620           MOVE TR195-DQCT TO PV-QCT-OORDER.                      08762099
087630                                                                  08763099
087640     IF TR195-DISPLAY-DVNS                                        08764099
087650        SET DO-SCREEN-DIMENSION TO TRUE                           08765099
087660        MOVE TR195-DVNS         TO PV-VNS-SELECTED                08766099
087670        MOVE PC-VFLD-VNS-I      TO PV-VNS-POINTER                 08767099
087680        MOVE PV-VFLD-VNS-DORDER TO PV-VNS-OORDER                  08768099
087690        IF TR195-DISPLAY-OVNS                                     08769099
087700           MOVE PC-SEL     TO PV-VNS-SELECTED                     08770099
087710           MOVE TR195-DVNS TO PV-VNS-OORDER.                      08771099
087720                                                                  08772099
087730        IF TR195-DISPLAY-DDOL OR TR195-DISPLAY-DUNT               08773099
087740           MOVE PC-MAX-GROUPS      TO ASC-MAX-GROUPS.             08774099
087750                                                                  08775099
087760     IF TR195-DISPLAY-DCRL                                        08776099
087770        SET DO-SCREEN-DIMENSION TO TRUE                           08777099
087780        MOVE TR195-DCRL         TO PV-CRL-SELECTED                08778099
087790        MOVE PC-VFLD-CRL-I      TO PV-CRL-POINTER                 08779099
087800        MOVE PV-VFLD-CRL-DORDER TO PV-CRL-OORDER                  08780099
087810        IF TR195-DISPLAY-OCRL                                     08781099
087820           MOVE PC-SEL     TO PV-CRL-SELECTED                     08782099
087830           MOVE TR195-DCRL TO PV-CRL-OORDER.                      08783099
087840                                                                  08784099
087850     IF TR195-DISPLAY-DTRA                                        08785099
087860        SET DO-SCREEN-DIMENSION TO TRUE                           08786099
087870        MOVE TR195-DTRA         TO PV-TRA-SELECTED                08787099
087880        MOVE PC-VFLD-TRA-I      TO PV-TRA-POINTER                 08788099
087890        MOVE PV-VFLD-TRA-DORDER TO PV-TRA-OORDER                  08789099
087900        IF TR195-DISPLAY-OTRA                                     08790099
087910           MOVE PC-SEL     TO PV-TRA-SELECTED                     08791099
087920           MOVE TR195-DTRA TO PV-TRA-OORDER.                      08792099
087930                                                                  08793099
087940* ------------------------------------------------------------  * 08794099
087950* |  #TIP ==> WHEN DEALING WITH THE CONTROL VARABLE DATA     |  * 08795099
087960* |  STRUCTURE ALWAYS DEAL WITH THE SORTED TABLE ONLY        |  * 08796099
087970* |  AS THIS STRUCTURE IS THE ONE ORGAINIZED IN THE ORDER    |  * 08797099
087980* |  THE FIELDS ARE PLACED ON THE SCREEN. PLUS THIS IS THE   |  * 08798099
087990* |  ONLY DATA STRUCTURE SAVED IN THE COMMON AREA.           |  * 08799099
088000* ------------------------------------------------------------  * 08800099
088010     MOVE +1 TO PV-I.                                             08801099
088020     PERFORM 9410-SORT-VARIABLE-CNTL-TABLE.                       08802099
088030*#END_OF_VARIABLE_LOGIC------------------------------------------*08803099
088040                                                                  08804099
088050     IF DO-SCREEN-DIMENSION                                       08805099
088060*#VARIABLE_LOGIC_GROUP_1----------------------------------------* 08806099
088070*  THE FOLLOWING LOGIC IS A KEY PART OF THE PROGRAM. THIS LOGIC * 08807099
088080*  SETS THE VIRTUAL SCREEN FOR EVERY VARIABLE FIELD.            * 08808099
088090*  THE ALGORITHM IS BASICALLY SIMPLE.  THE LOGIC LOOPS THROUGH  * 08809099
088100*  EVERY SELECTED FIELD, CHECKS THE LENGTH AND DETERMINES WHAT  * 08810099
088110*  SCREEN IT CAN FIT ON.  SPACING IS NOT CHANGED IN THIS LOGIC. * 08811099
088120*  IF MORE SOPHISTICATED CONTROL OF SCREENS & SPACING IS NEEDED * 08812099
088130*  THEN THIS AREA OF CODE SHOULD CHANGE.                        * 08813099
088140*---------------------------------------------------------------* 08814099
088150       MOVE +0 TO PV-VSCN-I                                       08815099
088160       PERFORM WITH TEST BEFORE                                   08816099
088170        VARYING PV-I FROM PC-FIRST-FIELD BY 1                     08817099
088180        UNTIL PV-I > PC-MAX-VFLDS-LIMIT                           08818099
088190          IF PV-SORT-SELECTED(PV-I) = 'Y'                         08819099
088200              MOVE PV-SORT-POINTER(PV-I) TO PV-INDEX              08820099
088210              COMPUTE PV-FIELD-LENGTH-SO-FAR =                    08821099
088220                       PV-FIELD-LENGTH-SO-FAR                     08822099
088230                     + PV-LENGTH(PV-INDEX)                        08823099
088240                     + PV-SORT-VFLD-SPACING(PV-I)                 08824099
088250            IF PV-FIELD-LENGTH-SO-FAR > PC-SCREEN-WIDTH           08825099
088260               COMPUTE PV-FIELD-LENGTH-SO-FAR =                   08826099
088270                               PV-LENGTH(PV-INDEX)                08827099
088280                             + PV-SORT-VFLD-SPACING(PV-I)         08828099
088290               ADD  +1 TO PV-VSCN-I                               08829099
088300               MOVE PV-VSCN-I TO PV-SORT-ONVSCREEN(PV-I)          08830099
088310            ELSE                                                  08831099
088320               MOVE PV-VSCN-I TO PV-SORT-ONVSCREEN(PV-I)          08832099
088330               IF PV-FIELD-LENGTH-SO-FAR = PC-SCREEN-WIDTH        08833099
088340                AND PV-I NOT = PC-MAX-VFLDS-LIMIT                 08834099
088350                  ADD +1 TO PV-VSCN-I                             08835099
088360                  MOVE 0 TO PV-FIELD-LENGTH-SO-FAR                08836099
088370               END-IF                                             08837099
088380            END-IF                                                08838099
088390          END-IF                                                  08839099
088400       END-PERFORM                                                08840099
088410       MOVE PV-VSCN-I TO ASC-MAX-VARIABLE-SCREENS                 08841099
088420*#END_OF_VARIABLE_LOGIC------------------------------------------*08842099
088430     END-IF.                                                      08843099
088440                                                                  08844099
088450     MOVE PV-VCTL-SORTED-TABLE TO ASC-VCTL-SORTED-TABLE.          08845099
088460                                                                  08846099
088470 EJECT                                                            08847099
088480*----------------------------------------------------------------*08848099
088490*  SORT ROUTINE IMPLEMENTS THE BASIC BUBBLE SORT                 *08849099
088500*  IT SIMPLY REORGANIZES THE DISPLAY CRITERIA FIELDS INTO        *08850099
088510*  A SPECIFIC DISPLAY ORDER                                      *08851099
088520*----------------------------------------------------------------*08852099
088530                                                                  08853099
088540 9410-SORT-VARIABLE-CNTL-TABLE.                                   08854099
088550                                                                  08855099
088560*#VARIABLE_LOGIC_GROUP_1----------------------------------------* 08856099
088570*  CURRENTLY A SIMPLE BUBBLE SORT IS USED TO SORT THE UNSORTED  * 08857099
088580*  VARIABLE CONTROL TABLE.  SORTING WILL ENSURE THE PLACEMENT   * 08858099
088590*  OF THE COLUMNS ON THE DISPLAY ARE MAINTAINED.                * 08859099
088600*---------------------------------------------------------------* 08860099
088610     MOVE PV-VARIABLE-CONTROL-FIELDS TO PV-VCTL-TABLE.            08861099
088620     MOVE PV-VCTL-TABLE TO PV-VCTL-SORTED-TABLE.                  08862099
088630*  TOP LOOP                                                       08863099
088640     PERFORM WITH TEST BEFORE                                     08864099
088650      VARYING PV-COUNTER1 FROM 1 BY 1                             08865099
088660        UNTIL PV-COUNTER1 > PC-MAX-VFLDS-LIMIT                    08866099
088670*  INNER LOOP                                                     08867099
088680        COMPUTE PV-COUNTER2 = PV-COUNTER1 + 1                     08868099
088690        PERFORM WITH TEST BEFORE                                  08869099
088700         VARYING PV-COUNTER2                                      08870099
088710           FROM PV-COUNTER2 BY 1                                  08871099
088720           UNTIL PV-COUNTER2 > PC-MAX-VFLDS-LIMIT                 08872099
088730            IF (PV-SORT-ORDER (PV-COUNTER2) <                     08873099
088740                                  PV-SORT-ORDER (PV-COUNTER1))    08874099
088750* ------------------------------------------------------------  * 08875099
088760* |  #TIP ==> IF PV-VFLD-CONTROL-SORTED-VALUES INCREASES     |  * 08876099
088770* |  IN SIZE MAKE SURE THE SIZE OF THIS DATA STRUCTURE       |  * 08877099
088780* |  IS MATCHED IN PV-WORK-FIELD.                            |  * 08878099
088790* ------------------------------------------------------------  * 08879099
088800              MOVE PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER1)    08880099
088810                TO PV-WORK-FIELD                                  08881099
088820              MOVE PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER2)    08882099
088830                TO PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER1)    08883099
088840              MOVE PV-WORK-FIELD                                  08884099
088850                TO PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER2)    08885099
088860           END-IF                                                 08886099
088870        END-PERFORM                                               08887099
088880     END-PERFORM.                                                 08888099
088890*#END_OF_VARIABLE_LOGIC------------------------------------------*08889099
088900 EJECT                                                            08890099
088910*---------------------------------------------------------------* 08891099
088920*  #VERY_IMPORTANT ==>                                          * 08892099
088930*  WHEN EVER THE PROGRAM DEALS WITH A PV-USORT-XXXX FIELD       * 08893099
088940*  10000-REBUILD-CONTROL-TABLE HAS TO BE CALLED TO REBUILD THE  * 08894099
088950*  DATA STRUCTURE AS ONLY THE SORTED TABLE IS EVER SAVED IN THE * 08895099
088960*  COMMAREA.                                                    * 08896099
088970*---------------------------------------------------------------* 08897099
088980                                                                  08898099
088990 9500-FORMAT-VARIABLE-DATA.                                       08899099
089000*#VARIABLE_LOGIC_GROUP_2----------------------------------------* 08900099
089010*  DO THE INTERMEDIATE STEP BY BUILDING AND REFORMATING THE     * 08901099
089020*  DATA STORAGE FIELDS. THE NEXT PARAGRAPH USES THE RE-         * 08902099
089030*  FORMATTED DATA AND SUBSCRIPTS IT INTO A LONG STRING.         * 08903099
089040*  THE LONG STRING REPRESENTS THE ACTUAL SCREEN FIELD.          * 08904099
089050*---------------------------------------------------------------* 08905099
089060                                                                  08906099
089070     PERFORM 10000-REBUILD-CONTROL-TABLES.                        08907099
089080                                                                  08908099
089090*---------------------------------------------------------------* 08909099
089100*  #TIP ==>                                                     * 08910099
089110*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          * 08911099
089120*  OF ONE OF THE FOLLOWING.                                     * 08912099
089130*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       * 08913099
089140*  CHANGE.                                                      * 08914099
089150*---------------------------------------------------------------* 08915099
089160                                                                  08916099
089170     IF DISPLAY-HEADER                                            08917099
089180                                                                  08918099
089190       MOVE DC-STORE-NAME(1) TO PV-HEADER-DC1-LEVEL-2             08919099
089200       MOVE DC-STORE-NAME(2) TO PV-HEADER-DC2-LEVEL-2             08920099
089210       MOVE DC-STORE-NAME(3) TO PV-HEADER-DC3-LEVEL-2             08921099
089220       MOVE DC-STORE-NAME(4) TO PV-HEADER-DC4-LEVEL-2             08922099
089230       MOVE DC-STORE-NAME(5) TO PV-HEADER-DC5-LEVEL-2             08923099
089240       MOVE DC-STORE-NAME(6) TO PV-HEADER-DC6-LEVEL-2             08924099
089250       MOVE DC-STORE-NAME(7) TO PV-HEADER-DC7-LEVEL-2             08925099
089260       MOVE DC-STORE-NAME(8) TO PV-HEADER-DC8-LEVEL-2             08926099
089270       MOVE DC-STORE-NAME(9) TO PV-HEADER-DC9-LEVEL-2             08927099
089280       MOVE DC-STORE-NAME(10) TO PV-HEADER-DC10-LEVEL-2           08928099
089290       MOVE DC-STORE-NAME(11) TO PV-HEADER-DC11-LEVEL-2           08929099
089300       MOVE DC-STORE-NAME(12) TO PV-HEADER-DC12-LEVEL-2           08930099
089310                                                                  08931099
089320     END-IF.                                                      08932099
089330                                                                  08933099
089340     IF DISPLAY-LIST                                              08934099
089350                                                                  08935099
089360     IF PV-USORT-SELECTED (PC-VFLD-FOB-I) = 'Y'                   08936099
089370        MOVE EXT-FOB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-FOB    08937099
089380     END-IF                                                       08938099
089390                                                                  08939099
089400     IF PV-USORT-SELECTED (PC-VFLD-POE-I) = 'Y'                   08940099
089410        MOVE EXT-POE (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-POE    08941099
089420     END-IF                                                       08942099
089430                                                                  08943099
089440     IF PV-USORT-SELECTED (PC-VFLD-SXF-I) = 'Y'                   08944099
089450        MOVE EXT-SXF (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     08945099
089460        IF PV-WORK-DT = SPACES                                    08946099
089470           MOVE SPACES TO PV-DATA-SXF                             08947099
089480        ELSE                                                      08948099
089490        MOVE PV-WORK-DT (5:2) TO PV-DATA-SXF (1:2)                08949099
089500        MOVE '/'              TO PV-DATA-SXF (3:1)                08950099
089510        MOVE PV-WORK-DT (7:2) TO PV-DATA-SXF (4:2)                08951099
089520        END-IF                                                    08952099
089530     END-IF                                                       08953099
089540                                                                  08954099
089550     IF PV-USORT-SELECTED (PC-VFLD-LXF-I) = 'Y'                   08955099
089560        MOVE EXT-LXF (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     08956099
089570        IF PV-WORK-DT = SPACES                                    08957099
089580           MOVE SPACES TO PV-DATA-LXF                             08958099
089590        ELSE                                                      08959099
089600        MOVE PV-WORK-DT (5:2) TO PV-DATA-LXF (1:2)                08960099
089610        MOVE '/'              TO PV-DATA-LXF (3:1)                08961099
089620        MOVE PV-WORK-DT (7:2) TO PV-DATA-LXF (4:2)                08962099
089630        END-IF                                                    08963099
089640     END-IF                                                       08964099
089650                                                                  08965099
089660     IF PV-USORT-SELECTED (PC-VFLD-DSB-I) = 'Y'                   08966099
089670        MOVE EXT-DSB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     08967099
089680        IF PV-WORK-DT = SPACES                                    08968099
089690           MOVE SPACES TO PV-DATA-DSB                             08969099
089700        ELSE                                                      08970099
089710        MOVE PV-WORK-DT (5:2) TO PV-DATA-DSB (1:2)                08971099
089720        MOVE '/'              TO PV-DATA-DSB (3:1)                08972099
089730        MOVE PV-WORK-DT (7:2) TO PV-DATA-DSB (4:2)                08973099
089740        END-IF                                                    08974099
089750     END-IF                                                       08975099
089760                                                                  08976099
089770     IF PV-USORT-SELECTED (PC-VFLD-CNL-I) = 'Y'                   08977099
089780        MOVE EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     08978099
089790        IF PV-WORK-DT = SPACES                                    08979099
089800           MOVE SPACES TO PV-DATA-CNL                             08980099
089810        ELSE                                                      08981099
089820        MOVE PV-WORK-DT (5:2) TO PV-DATA-CNL (1:2)                08982099
089830        MOVE '/'              TO PV-DATA-CNL (3:1)                08983099
089840        MOVE PV-WORK-DT (7:2) TO PV-DATA-CNL (4:2)                08984099
089850        END-IF                                                    08985099
089860     END-IF                                                       08986099
089870                                                                  08987099
089880     IF PV-USORT-SELECTED (PC-VFLD-FRD-I) = 'Y'                   08988099
089890        MOVE EXT-FRD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     08989099
089900        IF PV-WORK-DT = SPACES                                    08990099
089910           MOVE SPACES TO PV-DATA-FRD                             08991099
089920        ELSE                                                      08992099
089930        MOVE PV-WORK-DT (5:2) TO PV-DATA-FRD (1:2)                08993099
089940        MOVE '/'              TO PV-DATA-FRD (3:1)                08994099
089950        MOVE PV-WORK-DT (7:2) TO PV-DATA-FRD (4:2)                08995099
089960        END-IF                                                    08996099
089970     END-IF                                                       08997099
089980                                                                  08998099
089990     IF PV-USORT-SELECTED (PC-VFLD-SLD-I) = 'Y'                   08999099
090000        MOVE EXT-SLD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09000099
090010        IF PV-WORK-DT = SPACES                                    09001099
090020           MOVE SPACES TO PV-DATA-SLD                             09002099
090030        ELSE                                                      09003099
090040        MOVE PV-WORK-DT (5:2) TO PV-DATA-SLD (1:2)                09004099
090050        MOVE '/'              TO PV-DATA-SLD (3:1)                09005099
090060        MOVE PV-WORK-DT (7:2) TO PV-DATA-SLD (4:2)                09006099
090070        END-IF                                                    09007099
090080     END-IF                                                       09008099
090090                                                                  09009099
090100     IF PV-USORT-SELECTED (PC-VFLD-PRD-I) = 'Y'                   09010099
090110        MOVE EXT-CNT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-CNT    09011099
090120        MOVE EXT-PRD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09012099
090130        MOVE EXT-PRD-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09013099
090140                  PV-WORK-ETA-ATA                                 09014099
090150        IF PV-WORK-DT = SPACES                                    09015099
090160           MOVE SPACES TO PV-DATA-PRD                             09016099
090170        ELSE                                                      09017099
090180        MOVE PV-WORK-DT (5:2) TO PV-DATA-PRD (1:2)                09018099
090190        MOVE '/'              TO PV-DATA-PRD (3:1)                09019099
090200        MOVE PV-WORK-DT (7:2) TO PV-DATA-PRD (4:2)                09020099
090210        MOVE PV-WORK-ETA-ATA  TO PV-DATA-PRD (6:2)                09021099
090220        END-IF                                                    09022099
090230     END-IF                                                       09023099
090240                                                                  09024099
090250     IF PV-USORT-SELECTED (PC-VFLD-CSR-I) = 'Y'                   09025099
090260        MOVE EXT-CSR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09026099
090270        IF PV-WORK-DT = SPACES                                    09027099
090280           MOVE SPACES TO PV-DATA-CSR                             09028099
090290        ELSE                                                      09029099
090300        MOVE PV-WORK-DT (5:2) TO PV-DATA-CSR (1:2)                09030099
090310        MOVE '/'              TO PV-DATA-CSR (3:1)                09031099
090320        MOVE PV-WORK-DT (7:2) TO PV-DATA-CSR (4:2)                09032099
090330        END-IF                                                    09033099
090340     END-IF                                                       09034099
090350                                                                  09035099
090360     IF PV-USORT-SELECTED (PC-VFLD-DC1-I) = 'Y'                   09036099
090370        MOVE EXT-DC1 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09037099
090380        MOVE EXT-DC1-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09038099
090390                  PV-WORK-ETA-ATA-DC1                             09039099
090400        IF PV-WORK-DT = SPACES                                    09040099
090410           MOVE SPACES TO PV-DATA-DC1                             09041099
090420        ELSE                                                      09042099
090430        MOVE PV-WORK-DT (5:2)    TO PV-DATA-DC1 (1:2)             09043099
090440        MOVE '/'                 TO PV-DATA-DC1 (3:1)             09044099
090450        MOVE PV-WORK-DT (7:2)    TO PV-DATA-DC1 (4:2)             09045099
090460        MOVE PV-WORK-ETA-ATA-DC1 TO PV-DATA-DC1 (6:2)             09046099
090470        END-IF                                                    09047099
090480     END-IF                                                       09048099
090490                                                                  09049099
090500     IF PV-USORT-SELECTED (PC-VFLD-DC2-I) = 'Y'                   09050099
090510        MOVE EXT-DC2 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09051099
090520        MOVE EXT-DC2-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09052099
090530                  PV-WORK-ETA-ATA-DC2                             09053099
090540        IF PV-WORK-DT = SPACES                                    09054099
090550           MOVE SPACES TO PV-DATA-DC2                             09055099
090560        ELSE                                                      09056099
090570        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC2 (1:2)            09057099
090580        MOVE '/'                  TO PV-DATA-DC2 (3:1)            09058099
090590        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC2 (4:2)            09059099
090600        MOVE PV-WORK-ETA-ATA-DC2  TO PV-DATA-DC2 (6:2)            09060099
090610        END-IF                                                    09061099
090620     END-IF                                                       09062099
090630                                                                  09063099
090640     IF PV-USORT-SELECTED (PC-VFLD-DC3-I) = 'Y'                   09064099
090650        MOVE EXT-DC3 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09065099
090660        MOVE EXT-DC3-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09066099
090670                  PV-WORK-ETA-ATA-DC3                             09067099
090680        IF PV-WORK-DT = SPACES                                    09068099
090690           MOVE SPACES TO PV-DATA-DC3                             09069099
090700        ELSE                                                      09070099
090710        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC3 (1:2)            09071099
090720        MOVE '/'                  TO PV-DATA-DC3 (3:1)            09072099
090730        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC3 (4:2)            09073099
090740        MOVE PV-WORK-ETA-ATA-DC3  TO PV-DATA-DC3 (6:2)            09074099
090750        END-IF                                                    09075099
090760     END-IF                                                       09076099
090770                                                                  09077099
090780     IF PV-USORT-SELECTED (PC-VFLD-DC4-I) = 'Y'                   09078099
090790        MOVE EXT-DC4 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09079099
090800        MOVE EXT-DC4-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09080099
090810                  PV-WORK-ETA-ATA-DC4                             09081099
090820        IF PV-WORK-DT = SPACES                                    09082099
090830           MOVE SPACES TO PV-DATA-DC4                             09083099
090840        ELSE                                                      09084099
090850        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC4 (1:2)            09085099
090860        MOVE '/'                  TO PV-DATA-DC4 (3:1)            09086099
090870        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC4 (4:2)            09087099
090880        MOVE PV-WORK-ETA-ATA-DC4  TO PV-DATA-DC4 (6:2)            09088099
090890        END-IF                                                    09089099
090900     END-IF                                                       09090099
090910                                                                  09091099
090920     IF PV-USORT-SELECTED (PC-VFLD-DC5-I) = 'Y'                   09092099
090930        MOVE EXT-DC5 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09093099
090940        MOVE EXT-DC5-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09094099
090950                  PV-WORK-ETA-ATA-DC5                             09095099
090960        IF PV-WORK-DT = SPACES                                    09096099
090970           MOVE SPACES TO PV-DATA-DC5                             09097099
090980        ELSE                                                      09098099
090990        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC5 (1:2)            09099099
091000        MOVE '/'                  TO PV-DATA-DC5 (3:1)            09100099
091010        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC5 (4:2)            09101099
091020        MOVE PV-WORK-ETA-ATA-DC5  TO PV-DATA-DC5 (6:2)            09102099
091030        END-IF                                                    09103099
091040     END-IF                                                       09104099
091050                                                                  09105099
091060     IF PV-USORT-SELECTED (PC-VFLD-DC6-I) = 'Y'                   09106099
091070        MOVE EXT-DC6 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09107099
091080        MOVE EXT-DC6-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09108099
091090                  PV-WORK-ETA-ATA-DC6                             09109099
091100        IF PV-WORK-DT = SPACES                                    09110099
091110           MOVE SPACES TO PV-DATA-DC6                             09111099
091120        ELSE                                                      09112099
091130        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC6 (1:2)            09113099
091140        MOVE '/'                  TO PV-DATA-DC6 (3:1)            09114099
091150        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC6 (4:2)            09115099
091160        MOVE PV-WORK-ETA-ATA-DC6  TO PV-DATA-DC6 (6:2)            09116099
091170        END-IF                                                    09117099
091180     END-IF                                                       09118099
091190                                                                  09119099
091200     IF PV-USORT-SELECTED (PC-VFLD-DC7-I) = 'Y'                   09120099
091210        MOVE EXT-DC7 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09121099
091220        MOVE EXT-DC7-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09122099
091230                  PV-WORK-ETA-ATA-DC7                             09123099
091240        IF PV-WORK-DT = SPACES                                    09124099
091250           MOVE SPACES TO PV-DATA-DC7                             09125099
091260        ELSE                                                      09126099
091270        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC7 (1:2)            09127099
091280        MOVE '/'                  TO PV-DATA-DC7 (3:1)            09128099
091290        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC7 (4:2)            09129099
091300        MOVE PV-WORK-ETA-ATA-DC7  TO PV-DATA-DC7 (6:2)            09130099
091310        END-IF                                                    09131099
091320     END-IF                                                       09132099
091330                                                                  09133099
091340     IF PV-USORT-SELECTED (PC-VFLD-DC8-I) = 'Y'                   09134099
091350        MOVE EXT-DC8 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09135099
091360        MOVE EXT-DC8-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09136099
091370                  PV-WORK-ETA-ATA-DC8                             09137099
091380        IF PV-WORK-DT = SPACES                                    09138099
091390           MOVE SPACES TO PV-DATA-DC8                             09139099
091400        ELSE                                                      09140099
091410        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC8 (1:2)            09141099
091420        MOVE '/'                  TO PV-DATA-DC8 (3:1)            09142099
091430        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC8 (4:2)            09143099
091440        MOVE PV-WORK-ETA-ATA-DC8  TO PV-DATA-DC8 (6:2)            09144099
091450        END-IF                                                    09145099
091460     END-IF                                                       09146099
091470                                                                  09147099
091480     IF PV-USORT-SELECTED (PC-VFLD-DC9-I) = 'Y'                   09148099
091490        MOVE EXT-DC9 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09149099
091500        MOVE EXT-DC9-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO        09150099
091510                  PV-WORK-ETA-ATA-DC9                             09151099
091520        IF PV-WORK-DT = SPACES                                    09152099
091530           MOVE SPACES TO PV-DATA-DC9                             09153099
091540        ELSE                                                      09154099
091550        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC9 (1:2)            09155099
091560        MOVE '/'                  TO PV-DATA-DC9 (3:1)            09156099
091570        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC9 (4:2)            09157099
091580        MOVE PV-WORK-ETA-ATA-DC9  TO PV-DATA-DC9 (6:2)            09158099
091590        END-IF                                                    09159099
091600     END-IF                                                       09160099
091610                                                                  09161099
091620     IF PV-USORT-SELECTED (PC-VFLD-DC10-I) = 'Y'                  09162099
091630        MOVE EXT-DC10 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT    09163099
091640        MOVE EXT-DC10-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO       09164099
091650                  PV-WORK-ETA-ATA-DC10                            09165099
091660        IF PV-WORK-DT = SPACES                                    09166099
091670           MOVE SPACES TO PV-DATA-DC10                            09167099
091680        ELSE                                                      09168099
091690        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC10 (1:2)           09169099
091700        MOVE '/'                  TO PV-DATA-DC10 (3:1)           09170099
091710        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC10 (4:2)           09171099
091720        MOVE PV-WORK-ETA-ATA-DC10 TO PV-DATA-DC10 (6:2)           09172099
091730        END-IF                                                    09173099
091740     END-IF                                                       09174099
091750                                                                  09175099
091760     IF PV-USORT-SELECTED (PC-VFLD-DC11-I) = 'Y'                  09176099
091770        MOVE EXT-DC11 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT    09177099
091780        MOVE EXT-DC11-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO       09178099
091790                  PV-WORK-ETA-ATA-DC11                            09179099
091800        IF PV-WORK-DT = SPACES                                    09180099
091810           MOVE SPACES TO PV-DATA-DC11                            09181099
091820        ELSE                                                      09182099
091830        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC11 (1:2)           09183099
091840        MOVE '/'                  TO PV-DATA-DC11 (3:1)           09184099
091850        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC11 (4:2)           09185099
091860        MOVE PV-WORK-ETA-ATA-DC11 TO PV-DATA-DC11 (6:2)           09186099
091870        END-IF                                                    09187099
091880     END-IF                                                       09188099
091890                                                                  09189099
091900     IF PV-USORT-SELECTED (PC-VFLD-DC12-I) = 'Y'                  09190099
091910        MOVE EXT-DC12 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT    09191099
091920        MOVE EXT-DC12-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO       09192099
091930                  PV-WORK-ETA-ATA-DC12                            09193099
091940        IF PV-WORK-DT = SPACES                                    09194099
091950           MOVE SPACES TO PV-DATA-DC12                            09195099
091960        ELSE                                                      09196099
091970        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC12 (1:2)           09197099
091980        MOVE '/'                  TO PV-DATA-DC12 (3:1)           09198099
091990        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC12 (4:2)           09199099
092000        MOVE PV-WORK-ETA-ATA-DC12 TO PV-DATA-DC12 (6:2)           09200099
092010        END-IF                                                    09201099
092020     END-IF                                                       09202099
092030                                                                  09203099
092040     IF PV-USORT-SELECTED (PC-VFLD-DVN-I) = 'Y'                   09204099
092050        MOVE EXT-DVN (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09205099
092060        IF PV-WORK-DT = SPACES                                    09206099
092070           MOVE SPACES TO PV-DATA-DVN                             09207099
092080        ELSE                                                      09208099
092090        MOVE PV-WORK-DT (5:2) TO PV-DATA-DVN (1:2)                09209099
092100        MOVE '/'              TO PV-DATA-DVN (3:1)                09210099
092110        MOVE PV-WORK-DT (7:2) TO PV-DATA-DVN (4:2)                09211099
092120        END-IF                                                    09212099
092130     END-IF                                                       09213099
092140                                                                  09214099
092150     IF PV-USORT-SELECTED (PC-VFLD-BKD-I) = 'Y'                   09215099
092160        MOVE EXT-BKD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09216099
092170        IF PV-WORK-DT = SPACES                                    09217099
092180           MOVE SPACES TO PV-DATA-BKD                             09218099
092190        ELSE                                                      09219099
092200        MOVE PV-WORK-DT (5:2) TO PV-DATA-BKD (1:2)                09220099
092210        MOVE '/'              TO PV-DATA-BKD (3:1)                09221099
092220        MOVE PV-WORK-DT (7:2) TO PV-DATA-BKD (4:2)                09222099
092230        END-IF                                                    09223099
092240     END-IF                                                       09224099
092250                                                                  09225099
092260     IF PV-USORT-SELECTED (PC-VFLD-FSC-I) = 'Y'                   09226099
092270        MOVE EXT-FSC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-FSC    09227099
092280     END-IF                                                       09228099
092290                                                                  09229099
092300     IF PV-USORT-SELECTED (PC-VFLD-TTC-I) = 'Y'                   09230099
092310        MOVE EXT-TTC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TTC    09231099
092320     END-IF                                                       09232099
092330                                                                  09233099
092340     IF PV-USORT-SELECTED (PC-VFLD-TVC-I) = 'Y'                   09234099
092350        MOVE EXT-TVC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TVC    09235099
092360     END-IF                                                       09236099
092370                                                                  09237099
092380     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                   09238099
092390        MOVE EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-UOR    09239099
092400     END-IF                                                       09240099
092410                                                                  09241099
092420     IF PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                   09242099
092430        MOVE EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-URC    09243099
092440     END-IF                                                       09244099
092450                                                                  09245099
092460     IF PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                   09246099
092470        IF EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB) > 0                 09247099
092480          COMPUTE PV-WORK-PCT =                                   09248099
092490            (EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB) /                 09249099
092500                  EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB)) * 100       09250099
092510        ELSE                                                      09251099
092520            MOVE 0  TO PV-WORK-PCT                                09252099
092530        END-IF                                                    09253099
092540        MOVE PV-WORK-PCT TO PV-DATA-URP                           09254099
092550     END-IF                                                       09255099
092560                                                                  09256099
092570     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                   09257099
092580        MOVE EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-DOR    09258099
092590     END-IF                                                       09259099
092600                                                                  09260099
092610     IF PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                   09261099
092620        MOVE EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-DRC    09262099
092630     END-IF                                                       09263099
092640                                                                  09264099
092650     IF PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                   09265099
092660        IF EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB) > 0                 09266099
092670          COMPUTE PV-WORK-PCT =                                   09267099
092680            (EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB) /                 09268099
092690                  EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB)) * 100       09269099
092700        ELSE                                                      09270099
092710            MOVE 0  TO PV-WORK-PCT                                09271099
092720        END-IF                                                    09272099
092730        MOVE PV-WORK-PCT TO PV-DATA-DRP                           09273099
092740     END-IF                                                       09274099
092750                                                                  09275099
092760     IF PV-USORT-SELECTED (PC-VFLD-OTB-I) = 'Y'                   09276099
092770        MOVE EXT-OTB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-OTB    09277099
092780        IF PV-WORK-OTB = SPACES                                   09278099
092790           MOVE SPACES TO PV-DATA-OTB                             09279099
092800        ELSE                                                      09280099
092810        MOVE PV-WORK-OTB (3:2) TO PV-DATA-OTB (1:2)               09281099
092820        MOVE PV-WORK-OTB (5:2) TO PV-DATA-OTB (3:2)               09282099
092830        END-IF                                                    09283099
092840     END-IF                                                       09284099
092850                                                                  09285099
092860     IF PV-USORT-SELECTED (PC-VFLD-EDI-I) = 'Y'                   09286099
092870        MOVE EXT-EDI (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-EDI    09287099
092880     END-IF                                                       09288099
092890                                                                  09289099
092900     IF PV-USORT-SELECTED (PC-VFLD-PPK-I) = 'Y'                   09290099
092910        MOVE EXT-PPK (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-PPK    09291099
092920     END-IF                                                       09292099
092930                                                                  09293099
092940     IF PV-USORT-SELECTED (PC-VFLD-STA-I) = 'Y'                   09294099
092950        MOVE EXT-STA (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-STA    09295099
092960     END-IF                                                       09296099
092970                                                                  09297099
092980     IF PV-USORT-SELECTED (PC-VFLD-QCT-I) = 'Y'                   09298099
092990        MOVE EXT-QCT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-QCT    09299099
093000     END-IF                                                       09300099
093010                                                                  09301099
093020     IF PV-USORT-SELECTED (PC-VFLD-VNS-I) = 'Y'                   09302099
093030        MOVE EXT-VNS (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-VNS    09303099
093040     END-IF                                                       09304099
093050                                                                  09305099
093060     IF PV-USORT-SELECTED (PC-VFLD-TRP-I) = 'Y'                   09306099
093070        MOVE EXT-TRP (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TRP    09307099
093080     END-IF                                                       09308099
093090                                                                  09309099
093100     IF PV-USORT-SELECTED (PC-VFLD-SPL-CRT-I) = 'Y'               09310099
093110        MOVE EXT-SPL-CRT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT 09311099
093120        IF PV-WORK-DT = SPACES                                    09312099
093130           MOVE SPACES TO PV-DATA-SPL-CRT                         09313099
093140        ELSE                                                      09314099
093150        MOVE PV-WORK-DT (5:2) TO PV-DATA-SPL-CRT (1:2)            09315099
093160        MOVE '/'              TO PV-DATA-SPL-CRT (3:1)            09316099
093170        MOVE PV-WORK-DT (7:2) TO PV-DATA-SPL-CRT (4:2)            09317099
093180        END-IF                                                    09318099
093190     END-IF                                                       09319099
093200                                                                  09320099
093210     IF PV-USORT-SELECTED (PC-VFLD-SPL-SNT-I) = 'Y'               09321099
093220        MOVE EXT-STD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-STD    09322099
093230        MOVE EXT-SPL-SNT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT 09323099
093240        IF PV-WORK-DT = SPACES                                    09324099
093250           MOVE SPACES TO PV-DATA-SPL-SNT                         09325099
093260        ELSE                                                      09326099
093270        MOVE PV-WORK-DT (5:2) TO PV-DATA-SPL-SNT (1:2)            09327099
093280        MOVE '/'              TO PV-DATA-SPL-SNT (3:1)            09328099
093290        MOVE PV-WORK-DT (7:2) TO PV-DATA-SPL-SNT (4:2)            09329099
093300        END-IF                                                    09330099
093310     END-IF                                                       09331099
093320                                                                  09332099
093330     IF PV-USORT-SELECTED (PC-VFLD-AED-I) = 'Y'                   09333099
093340        MOVE EXT-AED (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09334099
093350        IF PV-WORK-DT = SPACES                                    09335099
093360           MOVE SPACES TO PV-DATA-AED                             09336099
093370        ELSE                                                      09337099
093380        MOVE PV-WORK-DT (5:2) TO PV-DATA-AED (1:2)                09338099
093390        MOVE '/'              TO PV-DATA-AED (3:1)                09339099
093400        MOVE PV-WORK-DT (7:2) TO PV-DATA-AED (4:2)                09340099
093410        END-IF                                                    09341099
093420     END-IF                                                       09342099
093430                                                                  09343099
093440     IF PV-USORT-SELECTED (PC-VFLD-CRL-I) = 'Y'                   09344099
093450        MOVE EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09345099
093460        IF PV-WORK-DT = SPACES                                    09346099
093470           MOVE SPACES TO PV-DATA-CRL                             09347099
093480        ELSE                                                      09348099
093490        MOVE PV-WORK-DT (5:2) TO PV-DATA-CRL (1:2)                09349099
093500        MOVE '/'              TO PV-DATA-CRL (3:1)                09350099
093510        MOVE PV-WORK-DT (7:2) TO PV-DATA-CRL (4:2)                09351099
093520        END-IF                                                    09352099
093530     END-IF                                                       09353099
093540                                                                  09354099
093550     IF PV-USORT-SELECTED (PC-VFLD-TRA-I) = 'Y'                   09355099
093560        MOVE EXT-TRA (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT     09356099
093570        IF PV-WORK-DT = SPACES                                    09357099
093580           MOVE SPACES TO PV-DATA-TRA                             09358099
093590        ELSE                                                      09359099
093600        MOVE PV-WORK-DT (5:2) TO PV-DATA-TRA (1:2)                09360099
093610        MOVE '/'              TO PV-DATA-TRA (3:1)                09361099
093620        MOVE PV-WORK-DT (7:2) TO PV-DATA-TRA (4:2)                09362099
093630        END-IF                                                    09363099
093640     END-IF                                                       09364099
093650                                                                  09365099
093660     END-IF.                                                      09366099
093670                                                                  09367099
093680     IF DISPLAY-TOTAL                                             09368099
093690                                                                  09369099
093700     IF PV-USORT-SELECTED (PC-VFLD-FSC-I) = 'Y'                   09370099
093710        MOVE ASC-TFSC TO PV-TOTAL-FSC                             09371099
093720     END-IF                                                       09372099
093730                                                                  09373099
093740     IF PV-USORT-SELECTED (PC-VFLD-TTC-I) = 'Y'                   09374099
093750        MOVE ASC-TTTC TO PV-TOTAL-TTC                             09375099
093760     END-IF                                                       09376099
093770                                                                  09377099
093780     IF PV-USORT-SELECTED (PC-VFLD-TVC-I) = 'Y'                   09378099
093790        MOVE ASC-TTVC TO PV-TOTAL-TVC                             09379099
093800     END-IF                                                       09380099
093810                                                                  09381099
093820     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                   09382099
093830        MOVE ASC-TUOR TO PV-TOTAL-UOR                             09383099
093840     END-IF                                                       09384099
093850                                                                  09385099
093860     IF PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                   09386099
093870        MOVE ASC-TURC TO PV-TOTAL-URC                             09387099
093880     END-IF                                                       09388099
093890                                                                  09389099
093900     IF PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                   09390099
093910        IF ASC-TUOR > 0                                           09391099
093920          COMPUTE PV-WORK-PCT =                                   09392099
093930            (ASC-TURC / ASC-TUOR) * 100                           09393099
093940        ELSE                                                      09394099
093950            MOVE 0  TO PV-WORK-PCT                                09395099
093960        END-IF                                                    09396099
093970        MOVE PV-WORK-PCT TO PV-TOTAL-URP                          09397099
093980     END-IF                                                       09398099
093990                                                                  09399099
094000     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                   09400099
094010        MOVE ASC-TDOR TO PV-TOTAL-DOR                             09401099
094020     END-IF                                                       09402099
094030                                                                  09403099
094040     IF PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                   09404099
094050        MOVE ASC-TDRC TO PV-TOTAL-DRC                             09405099
094060     END-IF                                                       09406099
094070                                                                  09407099
094080     IF PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                   09408099
094090        IF ASC-TDOR > 0                                           09409099
094100          COMPUTE PV-WORK-PCT =                                   09410099
094110            (ASC-TDRC  / ASC-TDOR) * 100                          09411099
094120        ELSE                                                      09412099
094130            MOVE 0  TO PV-WORK-PCT                                09413099
094140        END-IF                                                    09414099
094150        MOVE PV-WORK-PCT  TO PV-TOTAL-DRP                         09415099
094160     END-IF                                                       09416099
094170                                                                  09417099
094180     END-IF.                                                      09418099
094190                                                                  09419099
094200     PERFORM 9510-PREPARE-VFLD-FOR-DISPLAY.                       09420099
094210                                                                  09421099
094220*#END_OF_VARIABLE_LOGIC------------------------------------------*09422099
094230                                                                  09423099
094240 EJECT                                                            09424099
094250*----------------------------------------------------------------*09425099
094260* THIS ROUTINE PASSES THROUGH THE SCREEN FIELDS AND              *09426099
094270* CALLS EITHER 9520-BUILD-LIST-SCREEN-AREA OR                    *09427099
094280* 9530-REFORMAT-VFLD-HEADER-PART OR 9540-BUILD-TOTAL-SCREEN-AREA *09428099
094290*----------------------------------------------------------------*09429099
094300                                                                  09430099
094310 9510-PREPARE-VFLD-FOR-DISPLAY.                                   09431099
094320                                                                  09432099
094330*#VARIABLE_LOGIC_GROUP_2----------------------------------------* 09433099
094340*  THIS IS THE FINAL PARAGRAPH WHERE THE CICS MAP FIELDS ARE    * 09434099
094350*  ACTUALLY BUILT.  IT TAKES A VARIABLE FORMATTED DATA          * 09435099
094360*  FIELD AND THEN BASED ON THE FIELD SIZE SUBSCRIPT THE FIELD   * 09436099
094370*  ONTO A STRING. THIS PARAGRAPH HAS TO LOOP THROUGH THE SORTED * 09437099
094380*  CONTROL TABLE, DETERMINE IF A FIELD IS ON THE CURRENT        * 09438099
094390*  REQUESTED PAGE, SET THE X POSITION OF THE FIELD AND THEN     * 09439099
094400*  EITHER THE LIST OR HEADER OR TOTAL PARAGRAPHS TO PERFORM THE * 09440099
094410*  ACTUAL MOVE OF DATA ONTO THE MR FIELD.                       * 09441099
094420*---------------------------------------------------------------* 09442099
094430     MOVE 0 TO PV-LAST-VFLD-LENGTH.                               09443099
094440     IF DISPLAY-HEADER                                            09444099
094450       MOVE SPACES TO MR-VHDR1                                    09445099
094460       MOVE SPACES TO MR-VHDR2                                    09446099
094470     ELSE                                                         09447099
094480       IF DISPLAY-TOTAL                                           09448099
094490         MOVE SPACES TO MR-TTXT                                   09449099
094500         MOVE SPACES TO MR-TFLD                                   09450099
094510       ELSE                                                       09451099
094520         MOVE SPACES TO MR-VFLD (PV-SUB)                          09452099
094530       END-IF                                                     09453099
094540     END-IF.                                                      09454099
094550                                                                  09455099
094560     SET FIRST-FIELD TO TRUE.                                     09456099
094570                                                                  09457099
094580     PERFORM WITH TEST BEFORE                                     09458099
094590      VARYING PV-I FROM PC-FIRST-FIELD BY +1                      09459099
094600        UNTIL PV-I > PC-MAX-VFLDS-LIMIT                           09460099
094610                                                                  09461099
094620          IF PV-SORT-SELECTED(PV-I) = 'Y'                         09462099
094630           AND PV-SORT-ONVSCREEN(PV-I) = ASC-SEL-VARIABLE-SCREEN  09463099
094640                                                                  09464099
094650             MOVE PV-SORT-POINTER (PV-I) TO PV-J                  09465099
094660                                                                  09466099
094670             IF FIRST-FIELD                                       09467099
094680                 COMPUTE PV-VSCREEN-XPOS = 1                      09468099
094690                                + PV-SORT-VFLD-SPACING(PV-I)      09469099
094700             ELSE                                                 09470099
094710                 COMPUTE PV-VSCREEN-XPOS = PV-LAST-VSCREEN-XPOS   09471099
094720                                + PV-LAST-VFLD-LENGTH             09472099
094730                                + PV-SORT-VFLD-SPACING(PV-I)      09473099
094740            END-IF                                                09474099
094750                                                                  09475099
094760            COMPUTE PV-SPACING-XPOS = PV-VSCREEN-XPOS -           09476099
094770                                - PV-SORT-VFLD-SPACING(PV-I)      09477099
094780                                                                  09478099
094790            IF DISPLAY-HEADER                                     09479099
094800              PERFORM 9530-BUILD-HEADER-SCREEN-AREA               09480099
094810            ELSE                                                  09481099
094820              IF DISPLAY-TOTAL                                    09482099
094830                PERFORM 9540-BUILD-TOTAL-SCREEN-AREA              09483099
094840              ELSE                                                09484099
094850                PERFORM 9520-BUILD-LIST-SCREEN-AREA               09485099
094860              END-IF                                              09486099
094870            END-IF                                                09487099
094880                                                                  09488099
094890            SET  NOT-FIRST-FIELD TO TRUE                          09489099
094900            MOVE PV-VSCREEN-XPOS TO PV-LAST-VSCREEN-XPOS          09490099
094910            MOVE PV-LENGTH(PV-J) TO PV-LAST-VFLD-LENGTH           09491099
094920                                                                  09492099
094930          END-IF                                                  09493099
094940     END-PERFORM.                                                 09494099
094950*#END_OF_VARIABLE_LOGIC------------------------------------------*09495099
094960                                                                  09496099
094970 EJECT                                                            09497099
094980*----------------------------------------------------------------*09498099
094990* THIS ROUTINE BUILDS THE PHYSICAL LINE AND TOTAL PART.          *09499099
095000*----------------------------------------------------------------*09500099
095010                                                                  09501099
095020 9520-BUILD-LIST-SCREEN-AREA.                                     09502099
095030                                                                  09503099
095040*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*09504099
095050*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE LIST       * 09505099
095060*  AND TOTAL PART OF THE CICS MAP FIELDS.                       * 09506099
095070*---------------------------------------------------------------* 09507099
095080     SET BUILD-LINE TO TRUE.                                      09508099
095090     MOVE PV-DATA (PV-J) TO PV-WORK-DATA.                         09509099
095100     MOVE MR-VFLD (PV-SUB) TO PV-SAVE-DATA.                       09510099
095110     PERFORM 9550-MOVE-VDATA-TO-SCREEN.                           09511099
095120     MOVE PV-SAVE-DATA TO MR-VFLD (PV-SUB).                       09512099
095130*#END_OF_VARIABLE_LOGIC------------------------------------------*09513099
095140                                                                  09514099
095150 EJECT                                                            09515099
095160*----------------------------------------------------------------*09516099
095170* THIS ROUTINE BUILDS 54 CHARACTER PHYSICAL HEADER PART.         *09517099
095180*----------------------------------------------------------------*09518099
095190                                                                  09519099
095200 9530-BUILD-HEADER-SCREEN-AREA.                                   09520099
095210                                                                  09521099
095220*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*09522099
095230*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE HEADER     * 09523099
095240*  LEVEL 1 AND LEVEL 2 ONLY.                                    * 09524099
095250*---------------------------------------------------------------* 09525099
095260      MOVE PV-HEADER-LEVEL-1 (PV-J) TO PV-WORK-DATA.              09526099
095270      SET BUILD-HEADER-1 TO TRUE.                                 09527099
095280      MOVE MR-VHDR1 TO PV-SAVE-DATA.                              09528099
095290      PERFORM 9550-MOVE-VDATA-TO-SCREEN.                          09529099
095300      MOVE PV-SAVE-DATA TO MR-VHDR1.                              09530099
095310                                                                  09531099
095320      MOVE PV-HEADER-LEVEL-2 (PV-J) TO PV-WORK-DATA.              09532099
095330      SET BUILD-HEADER-2 TO TRUE.                                 09533099
095340      MOVE MR-VHDR2 TO PV-SAVE-DATA.                              09534099
095350      PERFORM 9550-MOVE-VDATA-TO-SCREEN.                          09535099
095360      MOVE PV-SAVE-DATA TO MR-VHDR2.                              09536099
095370*#END_OF_VARIABLE_LOGIC------------------------------------------*09537099
095380                                                                  09538099
095390 EJECT                                                            09539099
095400*----------------------------------------------------------------*09540099
095410* THIS ROUTINE BUILDS THE TOTAL PART.                            *09541099
095420*----------------------------------------------------------------*09542099
095430                                                                  09543099
095440 9540-BUILD-TOTAL-SCREEN-AREA.                                    09544099
095450                                                                  09545099
095460*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*09546099
095470*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE LIST       * 09547099
095480*  AND TOTAL PART OF THE CICS MAP FIELDS.                       * 09548099
095490*---------------------------------------------------------------* 09549099
095500     SET BUILD-TOTAL     TO TRUE.                                 09550099
095510     MOVE PV-TOTAL(PV-J) TO PV-WORK-DATA.                         09551099
095520     MOVE MR-TFLD        TO PV-SAVE-DATA.                         09552099
095530     PERFORM 9550-MOVE-VDATA-TO-SCREEN.                           09553099
095540     MOVE PV-SAVE-DATA   TO MR-TFLD.                              09554099
095550     IF MR-TFLD NOT = SPACES                                      09555099
095560        MOVE DP015-YELLOW   TO MR-TFLDC                           09556099
095570        MOVE DP015-WHITE    TO MR-TTXTC                           09557099
095580        MOVE PC-LABEL       TO MR-TTXT                            09558099
095590     END-IF.                                                      09559099
095600*#END_OF_VARIABLE_LOGIC------------------------------------------*09560099
095610                                                                  09561099
095620 EJECT                                                            09562099
095630*----------------------------------------------------------------*09563099
095640* BUILD THE PHYSICAL SCREEN PART WHICH IS 54 BYTES LONG FROM     *09564099
095650* THE VARIABLE DATA. THIS ROUTINE REFORMATS THE VARIABLE HEADER  *09565099
095660* LINE AND TOTAL LINE INTO THE ACTUAL PHYSICAL SCREEN DIMENSIONS.*09566099
095670*----------------------------------------------------------------*09567099
095680                                                                  09568099
095690 9550-MOVE-VDATA-TO-SCREEN.                                       09569099
095700                                                                  09570099
095710*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*09571099
095720*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF SPACING AND    * 09572099
095730*  POSITIONING OF THE DATA ON THE SCREEN.                       * 09573099
095740*---------------------------------------------------------------* 09574099
095750*  #VERY_IMPORTANT ==>                                          * 09575099
095760*  THIS LOGIC SHOULD NEVER CHANGE REGARDLESS OF                 * 09576099
095770*  HOW MANY VARIABLE FIELDS EXIST. THIS CODE IS FLEXIBLE        * 09577099
095780*  ENOUGH TO HANDLE GROWTH SO IT SHOULD BE STATIC.              * 09578099
095790*---------------------------------------------------------------* 09579099
095800*  #VERY_IMPORTANT ==>                                          * 09580099
095810*  NOTE THE DIFFERENCE BETWEEN PV-I AND PV-J.  PV-I IS THE      * 09581099
095820*  INDEX TO THE SORTED VARIABLE CONTROL TABLE.  WHERE AS THE    * 09582099
095830*  PV-J VARIABLE IS THE POINTER TO THE UNSORTED VARIABLE        * 09583099
095840*  CONTROL DATA ARRAY.                                          * 09584099
095850*---------------------------------------------------------------* 09585099
095860     MOVE PC-SPACES(1:PV-SORT-VFLD-SPACING(PV-I)) TO              09586099
095870       PV-SAVE-DATA(PV-SPACING-XPOS:PV-SORT-VFLD-SPACING(PV-I))   09587099
095880                                                                  09588099
095890     IF PV-JUSTIFIED (PV-J) = 'L'                                 09589099
095900       COMPUTE PV-WORK-POS = 1                                    09590099
095910     ELSE                                                         09591099
095920       COMPUTE PV-WORK-POS =                                      09592099
095930          (PC-MAX-DATA-VFLD-LENGTH - PV-LENGTH(PV-J)) + 1.        09593099
095940                                                                  09594099
095950     EVALUATE TRUE                                                09595099
095960                                                                  09596099
095970       WHEN BUILD-HEADER-1                                        09597099
095980        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO        09598099
095990          PV-SAVE-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))           09599099
096000                                                                  09600099
096010       WHEN BUILD-HEADER-2                                        09601099
096020        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO        09602099
096030          PV-SAVE-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))           09603099
096040                                                                  09604099
096050       WHEN BUILD-LINE                                            09605099
096060        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO        09606099
096070          PV-SAVE-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))           09607099
096080                                                                  09608099
096090       WHEN BUILD-TOTAL                                           09609099
096100        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO        09610099
096110          PV-SAVE-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))           09611099
096120                                                                  09612099
096130     END-EVALUATE.                                                09613099
096140*#END_OF_VARIABLE_LOGIC------------------------------------------*09614099
096150                                                                  09615099
096160 EJECT                                                            09616099
096170*----------------------------------------------------------------*09617099
096180*  LOAD ASC DATA AS ITS REQUESTED                                 09618099
096190*----------------------------------------------------------------*09619099
096200 9600-DB2-LOAD-PO-DATA.                                           09620099
096210                                                                  09621099
096220     IF ASC-WRITE-TO-CSSL                                         09622099
096230        PERFORM 10001-ASK-CICS-FOR-TIME                           09623099
096240        PERFORM 10008-SAVE-LAST-DB-TIME                           09624099
096250     END-IF.                                                      09625099
096260                                                                  09626099
096270     MOVE SPACES     TO PV-SM-LAST-FCTRY-DTE.                     09627099
096280     MOVE SPACES     TO PV-SM-OTB-PER-NBR.                        09628099
096290     MOVE SPACES     TO PV-SM-DONT-SHP-DTE.                       09629099
096300     MOVE SPACES     TO PV-SM-CAN-IFNOT-SHIP-DTE.                 09630099
096310     MOVE SPACES     TO PV-SM-EXT-CAN-DTE.                        09631099
096320     MOVE SPACES     TO PV-SM-VENDOR-STYLE.                       09632099
096330     MOVE SPACES     TO PV-SM-TRLR-AVAIL-DT.                      09633099
096340                                                                  09634099
096350*#VARIABLE_LOGIC_GROUP_2_AND_GROUP_2-----------------------------*09635099
096360*  THIS LOGIC GOES OUT TO DB2 AND PULLS IN THE DATA             * 09636099
096370*  ONLY WHEN THE DATA IS SELECTED BY THE USER WILL              * 09637099
096380*  DB2 DATA BE RETRIEVED.  THUS THE LESS DATA SELECTED          * 09638099
096390*  TO BE DISPLAYED THE FASTER THE PROGRAM SHOULD PERFORM.       * 09639099
096400*---------------------------------------------------------------* 09640099
096410                                                                  09641099
096420     PERFORM 9900-LOAD-PO-DETAILS.                                09642099
096430                                                                  09643099
096440     IF PLNSHP-STRT-FCTRY-DTE NOT = '0001-01-01'                  09644099
096450        MOVE PLNSHP-STRT-FCTRY-DTE (1:4) TO                       09645099
096460                        PV-SM-STRT-FCTRY-DTE (1:4)                09646099
096470        MOVE PLNSHP-STRT-FCTRY-DTE (6:2) TO                       09647099
096480                        PV-SM-STRT-FCTRY-DTE (5:2)                09648099
096490        MOVE PLNSHP-STRT-FCTRY-DTE (9:2) TO                       09649099
096500                        PV-SM-STRT-FCTRY-DTE (7:2)                09650099
096510     END-IF.                                                      09651099
096520                                                                  09652099
096530     IF PLNSHP-LAST-FCTRY-DTE NOT = '0001-01-01'                  09653099
096540        MOVE PLNSHP-LAST-FCTRY-DTE (1:4) TO                       09654099
096550                        PV-SM-LAST-FCTRY-DTE (1:4)                09655099
096560        MOVE PLNSHP-LAST-FCTRY-DTE (6:2) TO                       09656099
096570                        PV-SM-LAST-FCTRY-DTE (5:2)                09657099
096580        MOVE PLNSHP-LAST-FCTRY-DTE (9:2) TO                       09658099
096590                        PV-SM-LAST-FCTRY-DTE (7:2)                09659099
096600     END-IF.                                                      09660099
096610                                                                  09661099
096620     IF PURCHS-OTB-PER-NBR NOT = '000101'                         09662099
096630        MOVE PURCHS-OTB-PER-NBR TO                                09663099
096640                       PV-SM-OTB-PER-NBR                          09664099
096650     END-IF.                                                      09665099
096660                                                                  09666099
096670     IF PLNSHP-DONT-SHIP-BEF-DTE NOT = '0001-01-01'               09667099
096680        MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO                    09668099
096690                        PV-SM-DONT-SHP-DTE(1:4)                   09669099
096700        MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO                    09670099
096710                        PV-SM-DONT-SHP-DTE(5:2)                   09671099
096720        MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO                    09672099
096730                        PV-SM-DONT-SHP-DTE(7:2)                   09673099
096740     END-IF.                                                      09674099
096750                                                                  09675099
096760     IF PLNSHP-CAN-IFNOT-SHIP-DTE NOT = '0001-01-01'              09676099
096770        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (1:4) TO                   09677099
096780                     PV-SM-CAN-IFNOT-SHIP-DTE(1:4)                09678099
096790        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (6:2) TO                   09679099
096800                     PV-SM-CAN-IFNOT-SHIP-DTE(5:2)                09680099
096810        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (9:2) TO                   09681099
096820                     PV-SM-CAN-IFNOT-SHIP-DTE(7:2)                09682099
096830     END-IF.                                                      09683099
096840                                                                  09684099
096850     IF PLNSHP-EXT-CAN-DTE NOT = '0001-01-01'                     09685099
096860        MOVE PLNSHP-EXT-CAN-DTE (1:4) TO                          09686099
096870                        PV-SM-EXT-CAN-DTE(1:4)                    09687099
096880        MOVE PLNSHP-EXT-CAN-DTE (6:2) TO                          09688099
096890                        PV-SM-EXT-CAN-DTE(5:2)                    09689099
096900        MOVE PLNSHP-EXT-CAN-DTE (9:2) TO                          09690099
096910                        PV-SM-EXT-CAN-DTE(7:2)                    09691099
096920     END-IF.                                                      09692099
096930                                                                  09693099
096940     MOVE PV-SM-OTB-PER-NBR                                       09694099
096950          TO EXT-OTB (ASC-BLK-SUB ASC-ITEM-SUB).                  09695099
096960     MOVE PV-SM-DONT-SHP-DTE                                      09696099
096970          TO EXT-DSB (ASC-BLK-SUB ASC-ITEM-SUB).                  09697099
096980     MOVE PV-SM-STRT-FCTRY-DTE                                    09698099
096990          TO EXT-SXF (ASC-BLK-SUB ASC-ITEM-SUB).                  09699099
097000     MOVE PV-SM-LAST-FCTRY-DTE                                    09700099
097010          TO EXT-LXF (ASC-BLK-SUB ASC-ITEM-SUB).                  09701099
097020     MOVE PV-SM-CAN-IFNOT-SHIP-DTE                                09702099
097030          TO EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB).                  09703099
097040     IF PV-SM-EXT-CAN-DTE NOT = SPACES                            09704099
097050          MOVE PV-SM-EXT-CAN-DTE TO                               09705099
097060              EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB)                  09706099
097070     END-IF.                                                      09707099
097080                                                                  09708099
097090     MOVE PLNSHP-FOB-CDE                                          09709099
097100          TO EXT-FOB (ASC-BLK-SUB ASC-ITEM-SUB).                  09710099
097110     MOVE PLNSHP-POE-CDE                                          09711099
097120          TO EXT-POE (ASC-BLK-SUB ASC-ITEM-SUB).                  09712099
097130     MOVE PURCHS-EDI-IND                                          09713099
097140          TO EXT-EDI (ASC-BLK-SUB ASC-ITEM-SUB).                  09714099
097150     MOVE PURCHS-PKGNG-CDE                                        09715099
097160          TO EXT-PPK (ASC-BLK-SUB ASC-ITEM-SUB).                  09716099
097170     MOVE PURCHS-STATUS-CDE                                       09717099
097180          TO EXT-STA (ASC-BLK-SUB ASC-ITEM-SUB).                  09718099
097190     MOVE PURCHS-DEPT-NBR                                         09719099
097200          TO ASC-DEPT (ASC-BLK-SUB ASC-ITEM-SUB).                 09720099
097210                                                                  09721099
097220     IF PV-USORT-SELECTED (PC-VFLD-AED-I) = 'Y'                   09722099
097230        PERFORM 9960-GET-MIN-AD-DATE                              09723099
097240        MOVE PV-SM-AD-EVNT-DT                                     09724099
097250             TO EXT-AED (ASC-BLK-SUB ASC-ITEM-SUB)                09725099
097260     END-IF.                                                      09726099
097270                                                                  09727099
097280     IF PV-USORT-SELECTED (PC-VFLD-QCT-I) = 'Y'                   09728099
097290        MOVE PURCHS-QTA-CTG-CDE                                   09729099
097300             TO EXT-QCT (ASC-BLK-SUB ASC-ITEM-SUB)                09730099
097310     END-IF.                                                      09731099
097320                                                                  09732099
097330     IF PV-USORT-SELECTED (PC-VFLD-VNS-I) = 'Y'                   09733099
097340        PERFORM 9965-GET-VENDOR-STYLE                             09734099
097350        MOVE PV-SM-VENDOR-STYLE                                   09735099
097360             TO EXT-VNS (ASC-BLK-SUB ASC-ITEM-SUB)                09736099
097370     END-IF.                                                      09737099
097380                                                                  09738099
097390     IF PV-USORT-SELECTED (PC-VFLD-TRA-I) = 'Y'                   09739099
097400        PERFORM 9962-GET-TRLR-AVAIL-DATE                          09740099
097410        MOVE PV-SM-TRLR-AVAIL-DT                                  09741099
097420             TO EXT-TRA (ASC-BLK-SUB ASC-ITEM-SUB)                09742099
097430     END-IF.                                                      09743099
097440                                                                  09744099
097450     MOVE    +0   TO PV-DB2-COUNT2                                09745099
097460     PERFORM 9940-CHECK-IN-PROCESS                                09746099
097470     IF PV-DB2-COUNT2 > 0                                         09747099
097480       MOVE 'Y'            TO ASC-IP                              09748099
097490                      (ASC-BLK-SUB ASC-ITEM-SUB)                  09749099
097500     ELSE                                                         09750099
097510       MOVE 'N'            TO ASC-IP                              09751099
097520                      (ASC-BLK-SUB ASC-ITEM-SUB)                  09752099
097530     END-IF.                                                      09753099
097540                                                                  09754099
097550*---------------------------------------------------------------* 09755099
097560*  #TIP ==>                                                     * 09756099
097570*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          * 09757099
097580*  OF ONE OF THE FOLLOWING IF CONDTIONS SHOULD BE DONE.         * 09758099
097590*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       * 09759099
097600*  CHANGE.  IN THE FOLLOWING SECTION ONLY THE DOLLAR AND        * 09760099
097610*  UNIT TYPE FIELDS SHOULD BE ADDED. OTHERWISE THE CODE SHOULD  * 09761099
097620*  GO IN THE DATA-LOAD-IMPORT-DATA SECTION.                     * 09762099
097630*---------------------------------------------------------------* 09763099
097640                                                                  09764099
097650     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                   09765099
097660     OR PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                   09766099
097670     OR PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                   09767099
097680        MOVE POQ-FSC (ASC-POQ-ITEM-SUB)                           09768099
097690             TO EXT-FSC (ASC-BLK-SUB ASC-ITEM-SUB)                09769099
097700        MOVE POQ-TTC (ASC-POQ-ITEM-SUB)                           09770099
097710             TO EXT-TTC (ASC-BLK-SUB ASC-ITEM-SUB)                09771099
097720        MOVE POQ-TVC (ASC-POQ-ITEM-SUB)                           09772099
097730             TO EXT-TVC (ASC-BLK-SUB ASC-ITEM-SUB)                09773099
097740        MOVE POQ-DOR (ASC-POQ-ITEM-SUB)                           09774099
097750             TO EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB)                09775099
097760        MOVE POQ-DRC (ASC-POQ-ITEM-SUB)                           09776099
097770             TO EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB)                09777099
097780     END-IF.                                                      09778099
097790                                                                  09779099
097800     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                   09780099
097810     OR PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                   09781099
097820     OR PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                   09782099
097830        MOVE POQ-URC (ASC-POQ-ITEM-SUB)                           09783099
097840             TO EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB)                09784099
097850        MOVE POQ-UOR (ASC-POQ-ITEM-SUB)                           09785099
097860             TO EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB)                09786099
097870     END-IF.                                                      09787099
097880*#END_OF_VARIABLE_LOGIC------------------------------------------*09788099
097890                                                                  09789099
097900     IF ASC-WRITE-TO-CSSL                                         09790099
097910        PERFORM 10001-ASK-CICS-FOR-TIME                           09791099
097920        PERFORM 10009-ASK-DURATION-OF-DB-TASK                     09792099
097930        ADD ASC-TASK-DURATION TO ASC-DB-LOAD1-SECONDS             09793099
097940        ADD +1 TO ASC-DB-LOAD1-CNT                                09794099
097950     END-IF.                                                      09795099
097960                                                                  09796099
097970 EJECT                                                            09797099
097980*----------------------------------------------------------------*09798099
097990*  LOAD ASC DATA AS ITS REQUESTED                                 09799099
098000*----------------------------------------------------------------*09800099
098010                                                                  09801099
098020 9610-DB2-LOAD-IMPORT-DATA.                                       09802099
098030                                                                  09803099
098040     IF ASC-WRITE-TO-CSSL                                         09804099
098050        PERFORM 10001-ASK-CICS-FOR-TIME                           09805099
098060        PERFORM 10008-SAVE-LAST-DB-TIME                           09806099
098070     END-IF.                                                      09807099
098080                                                                  09808099
098090*#VARIABLE_LOGIC_GROUP_2----------------------------------------* 09809099
098100*  THIS LOGIC GOES OUT TO DB2 AND PULLS IN THE DATA             * 09810099
098110*  ONLY WHEN THE DATA IS SELECTED BY THE USER WILL              * 09811099
098120*  DB2 DATA BE RETRIEVED.  THUS THE LESS DATA SELECTED          * 09812099
098130*  TO BE DISPLAYED THE FASTER THE PROGRAM SHOULD PERFORM.       * 09813099
098140*---------------------------------------------------------------* 09814099
098150                                                                  09815099
098160     MOVE SPACES     TO PV-SM-BKNG-DELY-DT.                       09816099
098170     MOVE SPACES     TO PV-SM-ACTL-DELY-DT.                       09817099
098180     MOVE SPACES     TO PV-SM-IMPRT-DPRTR-DT.                     09818099
098190     MOVE SPACES     TO PV-SM-IMPRT-POE-DELY-DT.                  09819099
098200     MOVE SPACES     TO PV-WORK-ETA-ATA.                          09820099
098210     MOVE SPACES     TO PV-TRIP-TYP-CDE-FULL.                     09821099
098220     MOVE SPACES     TO PV-SM-SPL-CRT-DT.                         09822099
098230     MOVE SPACES     TO PV-SM-SPL-SNT-DT.                         09823099
098240     MOVE SPACES     TO PV-SM-STORE-DISTRO.                       09824099
098250     MOVE SPACES     TO PV-SM-DEVAN-DT.                           09825099
098260     MOVE SPACES     TO PV-SM-BKR-FRGT-RLSE-DT.                   09826099
098270     MOVE SPACES     TO PV-SM-CONTNR-ID.                          09827099
098280                                                                  09828099
098290*---------------------------------------------------------------* 09829099
098300*  #TIP ==>                                                     * 09830099
098310*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          * 09831099
098320*  OF ONE OF THE FOLLOWING IF CONDTIONS SHOULD BE DONE.         * 09832099
098330*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       * 09833099
098340*  CHANGE.                                                      * 09834099
098350*---------------------------------------------------------------* 09835099
098360                                                                  09836099
098370     IF PV-USORT-SELECTED (PC-VFLD-SLD-I) = 'Y'                   09837099
098380     OR PV-USORT-SELECTED (PC-VFLD-PRD-I) = 'Y'                   09838099
098390     OR PV-USORT-SELECTED (PC-VFLD-CRL-I) = 'Y'                   09839099
098400        PERFORM 9820-SELECT-CONTAINER-DATA                        09840099
098410        MOVE PV-SM-IMPRT-DPRTR-DT                                 09841099
098420             TO EXT-SLD (ASC-BLK-SUB ASC-ITEM-SUB)                09842099
098430        MOVE PV-SM-IMPRT-POE-DELY-DT                              09843099
098440             TO EXT-PRD (ASC-BLK-SUB ASC-ITEM-SUB)                09844099
098450        MOVE PV-WORK-ETA-ATA                                      09845099
098460             TO EXT-PRD-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09846099
098470                                                                  09847099
098480        SET PS-BKR-FRGT-RLSE-NO TO TRUE                           09848099
098490        PERFORM 9822-SELECT-CONTNR-RLSE-CDE                       09849099
098500        IF PS-BKR-FRGT-RLSE                                       09850099
098510            MOVE PV-SM-BKR-FRGT-RLSE-DT                           09851099
098520                 TO EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB)            09852099
098530        ELSE                                                      09853099
098540            MOVE SPACES                                           09854099
098550                 TO EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB)            09855099
098560        END-IF                                                    09856099
098570                                                                  09857099
098580        PERFORM 9825-SELECT-CONTNR-ID                             09858099
098590        MOVE PV-SM-CONTNR-ID                                      09859099
098600             TO EXT-CNT (ASC-BLK-SUB ASC-ITEM-SUB)                09860099
098610     END-IF.                                                      09861099
098620                                                                  09862099
098630     IF PV-USORT-SELECTED (PC-VFLD-FRD-I) = 'Y'                   09863099
098640        PERFORM 9810-SELECT-RECEIPT-DATA                          09864099
098650        MOVE PV-SM-ACTL-DELY-DT                                   09865099
098660             TO EXT-FRD (ASC-BLK-SUB ASC-ITEM-SUB)                09866099
098670     END-IF.                                                      09867099
098680                                                                  09868099
098690     IF PV-USORT-SELECTED (PC-VFLD-BKD-I) = 'Y'                   09869099
098700        PERFORM 9800-SELECT-BOOKING-DATA                          09870099
098710        MOVE PV-SM-BKNG-DELY-DT                                   09871099
098720             TO EXT-BKD (ASC-BLK-SUB ASC-ITEM-SUB)                09872099
098730     END-IF.                                                      09873099
098740                                                                  09874099
098750     IF PV-USORT-SELECTED (PC-VFLD-CSR-I) = 'Y'                   09875099
098760        PERFORM 9890-LOAD-CUSTOMS-DATA                            09876099
098770        MOVE PV-SM-ACTL-CLR-DATE                                  09877099
098780             TO EXT-CSR (ASC-BLK-SUB ASC-ITEM-SUB)                09878099
098790     END-IF.                                                      09879099
098800                                                                  09880099
098810     IF PV-USORT-SELECTED (PC-VFLD-DVN-I) = 'Y'                   09881099
098820        PERFORM 9895-SELECT-DEVAN-DATA                            09882099
098830        MOVE PV-SM-DEVAN-DT                                       09883099
098840             TO EXT-DVN (ASC-BLK-SUB ASC-ITEM-SUB)                09884099
098850     END-IF.                                                      09885099
098860                                                                  09886099
098870     IF PV-USORT-SELECTED (PC-VFLD-TRP-I) = 'Y'                   09887099
098880        PERFORM 9905-LOAD-TRIP-TYPE-DATA                          09888099
098890        MOVE PV-TRIP-TYP-CDE-FULL                                 09889099
098900             TO EXT-TRP (ASC-BLK-SUB ASC-ITEM-SUB)                09890099
098910     END-IF.                                                      09891099
098920                                                                  09892099
098930     IF PV-USORT-SELECTED (PC-VFLD-SPL-CRT-I) = 'Y' OR            09893099
098940        PV-USORT-SELECTED (PC-VFLD-SPL-SNT-I) = 'Y'               09894099
098950        PERFORM 9912-LOAD-DC-SPLIT-CREATE-DATE                    09895099
098960        PERFORM 9917-LOAD-DC-SPLIT-SENT-DATE                      09896099
098970*       PERFORM 9918-LOAD-DC-SPLIT-ORDR-SENT-DTE                  09897099
098980        MOVE PV-SM-SPL-CRT-DT                                     09898099
098990             TO EXT-SPL-CRT (ASC-BLK-SUB ASC-ITEM-SUB)            09899099
099000        MOVE PV-SM-SPL-SNT-DT                                     09900099
099010             TO EXT-SPL-SNT (ASC-BLK-SUB ASC-ITEM-SUB)            09901099
099020        INITIALIZE PV-DB2-COUNT                                   09902099
099030        PERFORM 9928-SELECT-STORE-DISTRO                          09903099
099040        MOVE PV-SM-STORE-DISTRO                                   09904099
099050             TO EXT-STD (ASC-BLK-SUB ASC-ITEM-SUB)                09905099
099060     END-IF.                                                      09906099
099070                                                                  09907099
099080*#END_OF_VARIABLE_LOGIC------------------------------------------*09908099
099090                                                                  09909099
099100     IF ASC-WRITE-TO-CSSL                                         09910099
099110        PERFORM 10001-ASK-CICS-FOR-TIME                           09911099
099120        PERFORM 10009-ASK-DURATION-OF-DB-TASK                     09912099
099130        ADD ASC-TASK-DURATION TO ASC-DB-LOAD2-SECONDS             09913099
099140        ADD +1 TO ASC-DB-LOAD2-CNT                                09914099
099150     END-IF.                                                      09915099
099160                                                                  09916099
099170 EJECT                                                            09917099
099180*----------------------------------------------------------------*09918099
099190*  LOAD ASC DATA AS ITS REQUESTED                                 09919099
099200*----------------------------------------------------------------*09920099
099210                                                                  09921099
099220 9620-DB2-LOAD-DC-DATA.                                           09922099
099230                                                                  09923099
099240     IF ASC-WRITE-TO-CSSL                                         09924099
099250        PERFORM 10001-ASK-CICS-FOR-TIME                           09925099
099260        PERFORM 10008-SAVE-LAST-DB-TIME                           09926099
099270     END-IF.                                                      09927099
099280                                                                  09928099
099290     MOVE SPACES     TO PV-SM-TRIP-ETA-DC1.                       09929099
099300     MOVE SPACES     TO PV-SM-TRIP-ETA-DC2.                       09930099
099310     MOVE SPACES     TO PV-SM-TRIP-ETA-DC3.                       09931099
099320     MOVE SPACES     TO PV-SM-TRIP-ETA-DC4.                       09932099
099330     MOVE SPACES     TO PV-SM-TRIP-ETA-DC5.                       09933099
099340     MOVE SPACES     TO PV-SM-TRIP-ETA-DC6.                       09934099
099350     MOVE SPACES     TO PV-SM-TRIP-ETA-DC7.                       09935099
099360     MOVE SPACES     TO PV-SM-TRIP-ETA-DC8.                       09936099
099370     MOVE SPACES     TO PV-SM-TRIP-ETA-DC9.                       09937099
099380     MOVE SPACES     TO PV-SM-TRIP-ETA-DC10.                      09938099
099390     MOVE SPACES     TO PV-SM-TRIP-ETA-DC11.                      09939099
099400     MOVE SPACES     TO PV-SM-TRIP-ETA-DC12.                      09940099
099410                                                                  09941099
099420     MOVE SPACES     TO PV-WORK-ETA-ATA                           09942099
099430                        PV-WORK-ETA-ATA-DC1                       09943099
099440                        PV-WORK-ETA-ATA-DC2                       09944099
099450                        PV-WORK-ETA-ATA-DC3                       09945099
099460                        PV-WORK-ETA-ATA-DC4                       09946099
099470                        PV-WORK-ETA-ATA-DC5                       09947099
099480                        PV-WORK-ETA-ATA-DC6                       09948099
099490                        PV-WORK-ETA-ATA-DC7                       09949099
099500                        PV-WORK-ETA-ATA-DC8                       09950099
099510                        PV-WORK-ETA-ATA-DC9                       09951099
099520                        PV-WORK-ETA-ATA-DC10                      09952099
099530                        PV-WORK-ETA-ATA-DC11                      09953099
099540                        PV-WORK-ETA-ATA-DC12.                     09954099
099550                                                                  09955099
099560     IF PV-USORT-SELECTED (PC-VFLD-DC1-I) = 'Y'                   09956099
099570     OR PV-USORT-SELECTED (PC-VFLD-DC2-I) = 'Y'                   09957099
099580     OR PV-USORT-SELECTED (PC-VFLD-DC3-I) = 'Y'                   09958099
099590     OR PV-USORT-SELECTED (PC-VFLD-DC4-I) = 'Y'                   09959099
099600     OR PV-USORT-SELECTED (PC-VFLD-DC5-I) = 'Y'                   09960099
099610     OR PV-USORT-SELECTED (PC-VFLD-DC6-I) = 'Y'                   09961099
099620     OR PV-USORT-SELECTED (PC-VFLD-DC7-I) = 'Y'                   09962099
099630     OR PV-USORT-SELECTED (PC-VFLD-DC8-I) = 'Y'                   09963099
099640     OR PV-USORT-SELECTED (PC-VFLD-DC9-I) = 'Y'                   09964099
099650     OR PV-USORT-SELECTED (PC-VFLD-DC10-I) = 'Y'                  09965099
099660     OR PV-USORT-SELECTED (PC-VFLD-DC11-I) = 'Y'                  09966099
099670     OR PV-USORT-SELECTED (PC-VFLD-DC12-I) = 'Y'                  09967099
099680                                                                  09968099
099690        MOVE ZEROS TO PV-SV-OPER-UNIT                             09969099
099700        MOVE ZEROS TO PV-SV-FCLTY                                 09970099
099710        MOVE ASC-DC-TABLE TO PV-DC-TABLE                          09971099
099720                                                                  09972099
099730        SET MORE-CURSOR-DATA TO TRUE                              09973099
099740        PERFORM 9980-OPEN-SHIP-CSR                                09974099
099750        PERFORM 9850-FETCH-DC-ETA-ATA-DATA                        09975099
099760                UNTIL NO-MORE-CURSOR-DATA                         09976099
099770        PERFORM 9990-CLOSE-SHIP-CSR                               09977099
099780                                                                  09978099
099790        MOVE PV-SM-TRIP-ETA-DC1                                   09979099
099800             TO EXT-DC1 (ASC-BLK-SUB ASC-ITEM-SUB)                09980099
099810        MOVE PV-WORK-ETA-ATA-DC1                                  09981099
099820             TO EXT-DC1-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09982099
099830        MOVE PV-SM-TRIP-ETA-DC2                                   09983099
099840             TO EXT-DC2 (ASC-BLK-SUB ASC-ITEM-SUB)                09984099
099850        MOVE PV-WORK-ETA-ATA-DC2                                  09985099
099860             TO EXT-DC2-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09986099
099870        MOVE PV-SM-TRIP-ETA-DC3                                   09987099
099880             TO EXT-DC3 (ASC-BLK-SUB ASC-ITEM-SUB)                09988099
099890        MOVE PV-WORK-ETA-ATA-DC3                                  09989099
099900             TO EXT-DC3-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09990099
099910        MOVE PV-SM-TRIP-ETA-DC4                                   09991099
099920             TO EXT-DC4 (ASC-BLK-SUB ASC-ITEM-SUB)                09992099
099930        MOVE PV-WORK-ETA-ATA-DC4                                  09993099
099940             TO EXT-DC4-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09994099
099950        MOVE PV-SM-TRIP-ETA-DC5                                   09995099
099960             TO EXT-DC5 (ASC-BLK-SUB ASC-ITEM-SUB)                09996099
099970        MOVE PV-WORK-ETA-ATA-DC5                                  09997099
099980             TO EXT-DC5-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        09998099
099990        MOVE PV-SM-TRIP-ETA-DC6                                   09999099
100000             TO EXT-DC6 (ASC-BLK-SUB ASC-ITEM-SUB)                10000099
100010        MOVE PV-WORK-ETA-ATA-DC6                                  10001099
100020             TO EXT-DC6-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        10002099
100030        MOVE PV-SM-TRIP-ETA-DC7                                   10003099
100040             TO EXT-DC7 (ASC-BLK-SUB ASC-ITEM-SUB)                10004099
100050        MOVE PV-WORK-ETA-ATA-DC7                                  10005099
100060             TO EXT-DC7-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        10006099
100070        MOVE PV-SM-TRIP-ETA-DC8                                   10007099
100080             TO EXT-DC8 (ASC-BLK-SUB ASC-ITEM-SUB)                10008099
100090        MOVE PV-WORK-ETA-ATA-DC8                                  10009099
100100             TO EXT-DC8-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        10010099
100110        MOVE PV-SM-TRIP-ETA-DC9                                   10011099
100120             TO EXT-DC9 (ASC-BLK-SUB ASC-ITEM-SUB)                10012099
100130        MOVE PV-WORK-ETA-ATA-DC9                                  10013099
100140             TO EXT-DC9-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)        10014099
100150        MOVE PV-SM-TRIP-ETA-DC10                                  10015099
100160             TO EXT-DC10 (ASC-BLK-SUB ASC-ITEM-SUB)               10016099
100170        MOVE PV-WORK-ETA-ATA-DC10                                 10017099
100180             TO EXT-DC10-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)       10018099
100190        MOVE PV-SM-TRIP-ETA-DC11                                  10019099
100200             TO EXT-DC11 (ASC-BLK-SUB ASC-ITEM-SUB)               10020099
100210        MOVE PV-WORK-ETA-ATA-DC11                                 10021099
100220             TO EXT-DC11-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)       10022099
100230        MOVE PV-SM-TRIP-ETA-DC12                                  10023099
100240             TO EXT-DC12 (ASC-BLK-SUB ASC-ITEM-SUB)               10024099
100250        MOVE PV-WORK-ETA-ATA-DC12                                 10025099
100260             TO EXT-DC12-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)       10026099
100270     END-IF.                                                      10027099
100280*#END_OF_VARIABLE_LOGIC------------------------------------------*10028099
100290                                                                  10029099
100300     IF ASC-WRITE-TO-CSSL                                         10030099
100310        PERFORM 10001-ASK-CICS-FOR-TIME                           10031099
100320        PERFORM 10009-ASK-DURATION-OF-DB-TASK                     10032099
100330        ADD ASC-TASK-DURATION TO ASC-DB-LOAD3-SECONDS             10033099
100340        ADD +1 TO ASC-DB-LOAD3-CNT                                10034099
100350     END-IF.                                                      10035099
100360                                                                  10036099
100370 EJECT                                                            10037099
100380*----------------------------------------------------------------*10038099
100390*  VALIDATE THE DEPARTMENT NUMBER                                *10039099
100400*----------------------------------------------------------------*10040099
100410 9700-VALIDATE-DEPT.                                              10041099
100420                                                                  10042099
100430     PERFORM                                                      10043099
100440         WITH TEST AFTER                                          10044099
100450         VARYING PV-RETRY-COUNTER                                 10045099
100460         FROM 1 BY 1                                              10046099
100470         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10047099
100480             OR (SQLCODE = +0)                                    10048099
100490             OR (SQLCODE = +100))                                 10049099
100500                                                                  10050099
100510         EXEC SQL                                                 10051099
100520              SELECT COUNT(*)                                     10052099
100530                INTO :PV-DB2-COUNT                                10053099
100540                FROM TMDSEAR                                      10054099
100550               WHERE DEPT_NBR   = :PV-DEPT-COMPARE-X-2            10055099
100560                 AND OPERCO_NBR = '03'                            10056099
100570                 AND MDSELV_CDE = 'DPT'                           10057099
100580                 AND STRT_DTE  <= CURRENT DATE                    10058099
100590                 AND END_DTE   >= CURRENT DATE                    10059099
100600         END-EXEC                                                 10060099
100610                                                                  10061099
100620         EVALUATE TRUE                                            10062099
100630             WHEN SQLCODE = +0                                    10063099
100640             WHEN SQLCODE = +100                                  10064099
100650             WHEN SQLCODE = -904                                  10065099
100660             WHEN SQLCODE = -913                                  10066099
100670                  CONTINUE                                        10067099
100680                                                                  10068099
100690             WHEN SQLWARN0 NOT = SPACES                           10069099
100700             WHEN SQLCODE < +0                                    10070099
100710             WHEN SQLCODE > +0                                    10071099
100720                  MOVE '9700-VALIDATE-DEPT'                       10072099
100730                                  TO DP013-PARAGRAPH              10073099
100740                  MOVE 'UNSUCCESSFUL COUNT ON DEPARTMENT'         10074099
100750                                  TO DP013-MESSAGE-TEXT (1)       10075099
100760                  MOVE SQLCA      TO DP013-SQLCA                  10076099
100770                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     10077099
100780                  SET DP013-DB2-ABEND                             10078099
100790                      DP013-XCTL-DISPLAY-RESTART                  10079099
100800                                  TO TRUE                         10080099
100810                  PERFORM DP013-0000-PROCESS-ABEND                10081099
100820         END-EVALUATE                                             10082099
100830     END-PERFORM.                                                 10083099
100840                                                                  10084099
100850     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10085099
100860         MOVE '9700-VALIDATE-DEPT'                                10086099
100870                                  TO DP013-PARAGRAPH              10087099
100880         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TMDSEAR'          10088099
100890                                  TO DP013-MESSAGE-TEXT (1)       10089099
100900         MOVE SQLCA               TO DP013-SQLCA                  10090099
100910         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     10091099
100920         SET DP013-DB2-ABEND                                      10092099
100930             DP013-XCTL-DISPLAY-RESTART                           10093099
100940                                  TO TRUE                         10094099
100950         PERFORM DP013-0000-PROCESS-ABEND                         10095099
100960     END-IF.                                                      10096099
100970 EJECT                                                            10097099
100980*----------------------------------------------------------------*10098099
100990*  VALIDATE THE STATUS CODE                                      *10099099
101000*----------------------------------------------------------------*10100099
101010                                                                  10101099
101020 9710-VALIDATE-STATUS-CODE.                                       10102099
101030                                                                  10103099
101040     PERFORM                                                      10104099
101050         WITH TEST AFTER                                          10105099
101060         VARYING PV-RETRY-COUNTER                                 10106099
101070         FROM 1 BY 1                                              10107099
101080         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10108099
101090             OR (SQLCODE = +0)                                    10109099
101100             OR (SQLCODE = +100))                                 10110099
101110                                                                  10111099
101120         EXEC SQL                                                 10112099
101130              SELECT COUNT(*)                                     10113099
101140                INTO :PV-DB2-COUNT                                10114099
101150                FROM TSTATCD                                      10115099
101160               WHERE STATUS_TYP_CDE = 'P'                         10116099
101170                 AND STATUS_CDE     = :STATCD-STATUS-CDE          10117099
101180         END-EXEC                                                 10118099
101190                                                                  10119099
101200         EVALUATE TRUE                                            10120099
101210             WHEN SQLCODE = +0                                    10121099
101220             WHEN SQLCODE = +100                                  10122099
101230             WHEN SQLCODE = -904                                  10123099
101240             WHEN SQLCODE = -913                                  10124099
101250                  CONTINUE                                        10125099
101260                                                                  10126099
101270             WHEN SQLWARN0 NOT = SPACES                           10127099
101280             WHEN SQLCODE < +0                                    10128099
101290             WHEN SQLCODE > +0                                    10129099
101300                  MOVE '9710-VALIDATE-STATUS-CODE'                10130099
101310                                  TO DP013-PARAGRAPH              10131099
101320                  MOVE 'UNSUCCESSFUL COUNT ON STATUS CODE'        10132099
101330                                  TO DP013-MESSAGE-TEXT (1)       10133099
101340                  MOVE SQLCA      TO DP013-SQLCA                  10134099
101350                  MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (1)     10135099
101360                  SET DP013-DB2-ABEND                             10136099
101370                      DP013-XCTL-DISPLAY-RESTART                  10137099
101380                                  TO TRUE                         10138099
101390                  PERFORM DP013-0000-PROCESS-ABEND                10139099
101400         END-EVALUATE                                             10140099
101410     END-PERFORM.                                                 10141099
101420                                                                  10142099
101430     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10143099
101440         MOVE '9710-VALIDATE-STATUS-CODE'                         10144099
101450                                  TO DP013-PARAGRAPH              10145099
101460         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TSTATCD'          10146099
101470                                  TO DP013-MESSAGE-TEXT (1)       10147099
101480         MOVE SQLCA               TO DP013-SQLCA                  10148099
101490         MOVE 'TSTATCD '          TO DP013-DB2-TABLE-NAME (1)     10149099
101500         SET DP013-DB2-ABEND                                      10150099
101510             DP013-XCTL-DISPLAY-RESTART                           10151099
101520                                  TO TRUE                         10152099
101530         PERFORM DP013-0000-PROCESS-ABEND                         10153099
101540     END-IF.                                                      10154099
101550 EJECT                                                            10155099
101560*----------------------------------------------------------------*10156099
101570*  VALIDATE THE STATUS CODE                                      *10157099
101580*----------------------------------------------------------------*10158099
101590                                                                  10159099
101600 9720-VALIDATE-PO-TYPE-CODE.                                      10160099
101610                                                                  10161099
101620     PERFORM                                                      10162099
101630         WITH TEST AFTER                                          10163099
101640         VARYING PV-RETRY-COUNTER                                 10164099
101650         FROM 1 BY 1                                              10165099
101660         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10166099
101670             OR (SQLCODE = +0)                                    10167099
101680             OR (SQLCODE = +100))                                 10168099
101690                                                                  10169099
101700         EXEC SQL                                                 10170099
101710              SELECT COUNT(*)                                     10171099
101720                INTO :PV-DB2-COUNT                                10172099
101730                FROM TPOTYCD                                      10173099
101740               WHERE PO_VARIETY_CDE = 'T'                         10174099
101750                 AND PO_TYP_CDE     = :TR195-PO-TYP-CDE           10175099
101760         END-EXEC                                                 10176099
101770                                                                  10177099
101780         EVALUATE TRUE                                            10178099
101790             WHEN SQLCODE = +0                                    10179099
101800             WHEN SQLCODE = +100                                  10180099
101810             WHEN SQLCODE = -904                                  10181099
101820             WHEN SQLCODE = -913                                  10182099
101830                  CONTINUE                                        10183099
101840                                                                  10184099
101850             WHEN SQLWARN0 NOT = SPACES                           10185099
101860             WHEN SQLCODE < +0                                    10186099
101870             WHEN SQLCODE > +0                                    10187099
101880                  MOVE '9720-VALIDATE-PO-TYPE-CODE'               10188099
101890                                  TO DP013-PARAGRAPH              10189099
101900                  MOVE 'UNSUCCESSFUL COUNT ON TYPE CODE'          10190099
101910                                  TO DP013-MESSAGE-TEXT (1)       10191099
101920                  MOVE SQLCA      TO DP013-SQLCA                  10192099
101930                  MOVE 'TPOTYCD ' TO DP013-DB2-TABLE-NAME (1)     10193099
101940                  SET DP013-DB2-ABEND                             10194099
101950                      DP013-XCTL-DISPLAY-RESTART                  10195099
101960                                  TO TRUE                         10196099
101970                  PERFORM DP013-0000-PROCESS-ABEND                10197099
101980         END-EVALUATE                                             10198099
101990     END-PERFORM.                                                 10199099
102000                                                                  10200099
102010     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10201099
102020         MOVE '9720-VALIDATE-PO-TYPE-CODE'                        10202099
102030                                  TO DP013-PARAGRAPH              10203099
102040         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TPOTYCD'          10204099
102050                                  TO DP013-MESSAGE-TEXT (1)       10205099
102060         MOVE SQLCA               TO DP013-SQLCA                  10206099
102070         MOVE 'TPOTYCD '          TO DP013-DB2-TABLE-NAME (1)     10207099
102080         SET DP013-DB2-ABEND                                      10208099
102090             DP013-XCTL-DISPLAY-RESTART                           10209099
102100                                  TO TRUE                         10210099
102110         PERFORM DP013-0000-PROCESS-ABEND                         10211099
102120     END-IF.                                                      10212099
102130                                                                  10213099
102140 EJECT                                                            10214099
102150*----------------------------------------------------------------*10215099
102160*  VALIDATE THE PO TABLE                                         *10216099
102170*----------------------------------------------------------------*10217099
102180                                                                  10218099
102190 9730-VALIDATE-PO.                                                10219099
102200                                                                  10220099
102210     PERFORM                                                      10221099
102220         WITH TEST AFTER                                          10222099
102230         VARYING PV-RETRY-COUNTER                                 10223099
102240         FROM 1 BY 1                                              10224099
102250         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10225099
102260             OR (SQLCODE = +0)                                    10226099
102270             OR (SQLCODE = +100))                                 10227099
102280                                                                  10228099
102290         EXEC SQL                                                 10229099
102300              SELECT COUNT(*)                                     10230099
102310                INTO :PV-DB2-COUNT                                10231099
102320                FROM TPURCHS                                      10232099
102330               WHERE PO_NBR         = :TR195-PO-NBR               10233099
102340                 AND VER_STATUS_CDE = 'A'                         10234099
102350         END-EXEC                                                 10235099
102360                                                                  10236099
102370         EVALUATE TRUE                                            10237099
102380             WHEN SQLCODE = +0                                    10238099
102390             WHEN SQLCODE = +100                                  10239099
102400             WHEN SQLCODE = -904                                  10240099
102410             WHEN SQLCODE = -913                                  10241099
102420                  CONTINUE                                        10242099
102430                                                                  10243099
102440             WHEN SQLWARN0 NOT = SPACES                           10244099
102450             WHEN SQLCODE < +0                                    10245099
102460             WHEN SQLCODE > +0                                    10246099
102470                  MOVE '9730-VALIDATE-PO'                         10247099
102480                                  TO DP013-PARAGRAPH              10248099
102490                  MOVE 'UNSUCCESSFUL COUNT ON PO'                 10249099
102500                                  TO DP013-MESSAGE-TEXT (1)       10250099
102510                  MOVE SQLCA      TO DP013-SQLCA                  10251099
102520                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     10252099
102530                  SET DP013-DB2-ABEND                             10253099
102540                      DP013-XCTL-DISPLAY-RESTART                  10254099
102550                                  TO TRUE                         10255099
102560                  PERFORM DP013-0000-PROCESS-ABEND                10256099
102570         END-EVALUATE                                             10257099
102580     END-PERFORM.                                                 10258099
102590                                                                  10259099
102600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10260099
102610         MOVE '9730-VALIDATE-PO'                                  10261099
102620                                  TO DP013-PARAGRAPH              10262099
102630         MOVE 'MAX RETRIES EXCEEDED ON FETCH ON TPURCHS'          10263099
102640                                  TO DP013-MESSAGE-TEXT (1)       10264099
102650         MOVE SQLCA               TO DP013-SQLCA                  10265099
102660         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     10266099
102670         SET DP013-DB2-ABEND                                      10267099
102680             DP013-XCTL-DISPLAY-RESTART                           10268099
102690                                  TO TRUE                         10269099
102700         PERFORM DP013-0000-PROCESS-ABEND                         10270099
102710     END-IF.                                                      10271099
102720 EJECT                                                            10272099
102730*----------------------------------------------------------------*10273099
102740*  VALIDATE THE FOB CODE                                         *10274099
102750*----------------------------------------------------------------*10275099
102760                                                                  10276099
102770 9740-VALIDATE-FOB-CODE.                                          10277099
102780                                                                  10278099
102790     PERFORM                                                      10279099
102800         WITH TEST AFTER                                          10280099
102810         VARYING PV-RETRY-COUNTER                                 10281099
102820         FROM 1 BY 1                                              10282099
102830         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10283099
102840             OR (SQLCODE = +0)                                    10284099
102850             OR (SQLCODE = -811)                                  10285099
102860             OR (SQLCODE = +100))                                 10286099
102870                                                                  10287099
102880         EXEC SQL                                                 10288099
102890              SELECT COUNT(*)                                     10289099
102900                INTO :PV-DB2-COUNT                                10290099
102910                FROM TIMFOB                                       10291099
102920               WHERE FOB_CDE        = :TR195-FOB-CDE              10292099
102930         END-EXEC                                                 10293099
102940                                                                  10294099
102950         EVALUATE TRUE                                            10295099
102960             WHEN SQLCODE = +0                                    10296099
102970             WHEN SQLCODE = +100                                  10297099
102980             WHEN SQLCODE = -811                                  10298099
102990             WHEN SQLCODE = -904                                  10299099
103000             WHEN SQLCODE = -913                                  10300099
103010                  CONTINUE                                        10301099
103020                                                                  10302099
103030             WHEN SQLWARN0 NOT = SPACES                           10303099
103040             WHEN SQLCODE < +0                                    10304099
103050             WHEN SQLCODE > +0                                    10305099
103060                  MOVE '9740-VALIDATE-FOB-CODE'                   10306099
103070                                  TO DP013-PARAGRAPH              10307099
103080                  MOVE 'UNSUCCESSFUL COUNT ON TYPE CODE'          10308099
103090                                  TO DP013-MESSAGE-TEXT (1)       10309099
103100                  MOVE SQLCA      TO DP013-SQLCA                  10310099
103110                  MOVE 'TIMFOB  ' TO DP013-DB2-TABLE-NAME (1)     10311099
103120                  SET DP013-DB2-ABEND                             10312099
103130                      DP013-XCTL-DISPLAY-RESTART                  10313099
103140                                  TO TRUE                         10314099
103150                  PERFORM DP013-0000-PROCESS-ABEND                10315099
103160         END-EVALUATE                                             10316099
103170     END-PERFORM.                                                 10317099
103180                                                                  10318099
103190     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10319099
103200         MOVE '9740-VALIDATE-FOB-CODE'                            10320099
103210                                  TO DP013-PARAGRAPH              10321099
103220         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TIMFOB'           10322099
103230                                  TO DP013-MESSAGE-TEXT (1)       10323099
103240         MOVE SQLCA               TO DP013-SQLCA                  10324099
103250         MOVE 'TIMFOB '           TO DP013-DB2-TABLE-NAME (1)     10325099
103260         SET DP013-DB2-ABEND                                      10326099
103270             DP013-XCTL-DISPLAY-RESTART                           10327099
103280                                  TO TRUE                         10328099
103290         PERFORM DP013-0000-PROCESS-ABEND                         10329099
103300     END-IF.                                                      10330099
103310                                                                  10331099
103320 EJECT                                                            10332099
103330*----------------------------------------------------------------*10333099
103340*   OPEN THE POE CODE CURSOR                                     *10334099
103350*----------------------------------------------------------------*10335099
103360 9750-OPEN-POE-CURSOR.                                            10336099
103370                                                                  10337099
103380     PERFORM                                                      10338099
103390         WITH TEST AFTER                                          10339099
103400         VARYING PV-RETRY-COUNTER                                 10340099
103410         FROM 1 BY 1                                              10341099
103420         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10342099
103430                   OR (SQLCODE = ZERO))                           10343099
103440                                                                  10344099
103450         MOVE 'CURSOR:  POE-CSR'     TO DP013-MESSAGE-TEXT (2)    10345099
103460                                                                  10346099
103470         EXEC SQL                                                 10347099
103480              OPEN POE-CSR                                        10348099
103490         END-EXEC                                                 10349099
103500                                                                  10350099
103510         EVALUATE TRUE                                            10351099
103520             WHEN SQLCODE = ZERO                                  10352099
103530             WHEN SQLCODE = -904                                  10353099
103540             WHEN SQLCODE = -913                                  10354099
103550                 CONTINUE                                         10355099
103560             WHEN SQLWARN0 NOT = SPACES                           10356099
103570             WHEN SQLCODE < ZERO                                  10357099
103580             WHEN SQLCODE > ZERO                                  10358099
103590                 MOVE '9750-OPEN-POE-CURSOR'                      10359099
103600                                   TO DP013-PARAGRAPH             10360099
103610                 MOVE 'OPEN POE CURSOR - '                        10361099
103620                                   TO DP013-MESSAGE-TEXT (1)      10362099
103630                 MOVE SQLCA        TO DP013-SQLCA                 10363099
103640                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)    10364099
103650                 SET DP013-DB2-ABEND                              10365099
103660                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10366099
103670                 PERFORM DP013-0000-PROCESS-ABEND                 10367099
103680         END-EVALUATE                                             10368099
103690     END-PERFORM.                                                 10369099
103700*                                                                 10370099
103710     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10371099
103720         MOVE '9750-OPEN-POE-CURSOR' TO DP013-PARAGRAPH           10372099
103730         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   10373099
103740                                   TO DP013-MESSAGE-TEXT (1)      10374099
103750         MOVE SQLCA                TO DP013-SQLCA                 10375099
103760         MOVE 'TIMPOE  '           TO DP013-DB2-TABLE-NAME (1)    10376099
103770         SET DP013-DB2-ABEND                                      10377099
103780             DP013-XCTL-DISPLAY-RESTART                           10378099
103790                                   TO TRUE                        10379099
103800         PERFORM DP013-0000-PROCESS-ABEND                         10380099
103810     END-IF.                                                      10381099
103820                                                                  10382099
103830 EJECT                                                            10383099
103840*----------------------------------------------------------------*10384099
103850*   CLOSE THE POE CODE CURSOR                                    *10385099
103860*----------------------------------------------------------------*10386099
103870 9752-CLOSE-POE-CURSOR.                                           10387099
103880                                                                  10388099
103890     EXEC SQL                                                     10389099
103900          CLOSE POE-CSR                                           10390099
103910     END-EXEC.                                                    10391099
103920                                                                  10392099
103930     EVALUATE TRUE                                                10393099
103940         WHEN SQLCODE = ZERO                                      10394099
103950             CONTINUE                                             10395099
103960         WHEN SQLWARN0 NOT = SPACES                               10396099
103970         WHEN SQLCODE < ZERO                                      10397099
103980         WHEN SQLCODE > ZERO                                      10398099
103990             MOVE '9752-CLOSE-POE-CURSOR'                         10399099
104000                               TO DP013-PARAGRAPH                 10400099
104010             MOVE 'CLOSE POE CURSOR '                             10401099
104020                               TO DP013-MESSAGE-TEXT (1)          10402099
104030             MOVE SQLCA        TO DP013-SQLCA                     10403099
104040             MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)        10404099
104050             SET DP013-DB2-ABEND                                  10405099
104060                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10406099
104070             PERFORM DP013-0000-PROCESS-ABEND                     10407099
104080     END-EVALUATE.                                                10408099
104090                                                                  10409099
104100 EJECT                                                            10410099
104110*----------------------------------------------------------------*10411099
104120*    FETCH THE POE CODE CURSOR                                   *10412099
104130*----------------------------------------------------------------*10413099
104140 9754-FETCH-POE-CURSOR.                                           10414099
104150                                                                  10415099
104160     EXEC SQL                                                     10416099
104170          FETCH POE-CSR                                           10417099
104180          INTO  :IMPOE-POE-CDE                                    10418099
104190     END-EXEC.                                                    10419099
104200                                                                  10420099
104210     EVALUATE TRUE                                                10421099
104220         WHEN SQLCODE = ZERO                                      10422099
104230         WHEN SQLCODE = -811                                      10423099
104240             CONTINUE                                             10424099
104250         WHEN SQLCODE = +100                                      10425099
104260             MOVE PC-TSYMSG-01452 TO DP020-MSG-NUMBER             10426099
104270             SET PS-ERROR                                         10427099
104280                 PS-COMMAREA-NOT-VALID                            10428099
104290                 DP020-MSG-FATAL TO TRUE                          10429099
104300         WHEN SQLWARN0 NOT = SPACE                                10430099
104310         WHEN SQLCODE NOT = ZERO                                  10431099
104320              MOVE '9754-FETCH-POE-CURSOR'                        10432099
104330                               TO DP013-PARAGRAPH                 10433099
104340              MOVE 'FETCH POE CURSOR'                             10434099
104350                               TO DP013-MESSAGE-TEXT (1)          10435099
104360              MOVE SQLCA       TO DP013-SQLCA                     10436099
104370              SET DP013-DB2-ABEND                                 10437099
104380                               TO TRUE                            10438099
104390              PERFORM DP013-0000-PROCESS-ABEND                    10439099
104400     END-EVALUATE.                                                10440099
104410                                                                  10441099
104420 EJECT                                                            10442099
104430*----------------------------------------------------------------*10443099
104440*  VALIDATE THE STORE NUMBER FROM SELECTION CRITERIA             *10444099
104450*----------------------------------------------------------------*10445099
104460                                                                  10446099
104470 9760-VALIDATE-STORE.                                             10447099
104480                                                                  10448099
104490     PERFORM                                                      10449099
104500         WITH TEST AFTER                                          10450099
104510         VARYING PV-RETRY-COUNTER                                 10451099
104520         FROM 1 BY 1                                              10452099
104530         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10453099
104540             OR (SQLCODE = +0)                                    10454099
104550             OR (SQLCODE = +100))                                 10455099
104560                                                                  10456099
104570         EXEC SQL                                                 10457099
104580              SELECT COUNT(*)                                     10458099
104590                INTO :PV-DB2-COUNT                                10459099
104600                FROM XLT_LOC                                      10460099
104610               WHERE LOC_NBR = :TR195-STR-NBR                     10461099
104620         END-EXEC                                                 10462099
104630                                                                  10463099
104640         EVALUATE TRUE                                            10464099
104650             WHEN SQLCODE = +0                                    10465099
104660             WHEN SQLCODE = +100                                  10466099
104670             WHEN SQLCODE = -904                                  10467099
104680             WHEN SQLCODE = -913                                  10468099
104690                  CONTINUE                                        10469099
104700                                                                  10470099
104710             WHEN SQLWARN0 NOT = SPACES                           10471099
104720             WHEN SQLCODE < +0                                    10472099
104730             WHEN SQLCODE > +0                                    10473099
104740                  MOVE '9760-VALIDATE-STORE'                      10474099
104750                                  TO DP013-PARAGRAPH              10475099
104760                  MOVE 'UNSUCCESSFUL COUNT ON STORE'              10476099
104770                                  TO DP013-MESSAGE-TEXT (1)       10477099
104780                  MOVE SQLCA      TO DP013-SQLCA                  10478099
104790                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)     10479099
104800                  SET DP013-DB2-ABEND                             10480099
104810                      DP013-XCTL-DISPLAY-RESTART                  10481099
104820                                  TO TRUE                         10482099
104830                  PERFORM DP013-0000-PROCESS-ABEND                10483099
104840         END-EVALUATE                                             10484099
104850     END-PERFORM.                                                 10485099
104860                                                                  10486099
104870     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10487099
104880         MOVE '9760-VALIDATE-STORE'                               10488099
104890                                  TO DP013-PARAGRAPH              10489099
104900         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON XLT_LOC'          10490099
104910                                  TO DP013-MESSAGE-TEXT (1)       10491099
104920         MOVE SQLCA               TO DP013-SQLCA                  10492099
104930         MOVE 'XLT_LOC '          TO DP013-DB2-TABLE-NAME (1)     10493099
104940         SET DP013-DB2-ABEND                                      10494099
104950             DP013-XCTL-DISPLAY-RESTART                           10495099
104960                                  TO TRUE                         10496099
104970         PERFORM DP013-0000-PROCESS-ABEND                         10497099
104980     END-IF.                                                      10498099
104990 EJECT                                                            10499099
105000*----------------------------------------------------------------*10500099
105010* CHECK IF PO HAS ANY STORE ALLOCATIONS                          *10501099
105020*----------------------------------------------------------------*10502099
105030                                                                  10503099
105040 9770-CHECK-STORE-ALLOC.                                          10504099
105050                                                                  10505099
105060     EXEC SQL                                                     10506099
105070          SELECT COUNT(*)                                         10507099
105080            INTO :PV-DB2-COUNT                                    10508099
105090            FROM TMESTDS                                          10509099
105100           WHERE PO_NBR  = :DK-PO-NBR                             10510099
105110             AND STR_NBR = :DK-STR-NBR                            10511099
105120     END-EXEC.                                                    10512099
105130                                                                  10513099
105140     EVALUATE TRUE                                                10514099
105150         WHEN SQLCODE = +0                                        10515099
105160         WHEN SQLCODE = +100                                      10516099
105170         WHEN SQLCODE = -904                                      10517099
105180         WHEN SQLCODE = -913                                      10518099
105190              CONTINUE                                            10519099
105200                                                                  10520099
105210         WHEN SQLWARN0 NOT = SPACES                               10521099
105220         WHEN SQLCODE < +0                                        10522099
105230         WHEN SQLCODE > +0                                        10523099
105240              MOVE '9770-CHECK-STORE-ALLOC'                       10524099
105250                              TO DP013-PARAGRAPH                  10525099
105260              MOVE 'UNSUCCESSFUL SELECT STORE ALLOCATIONS '       10526099
105270                              TO DP013-MESSAGE-TEXT (1)           10527099
105280              MOVE SQLCA      TO DP013-SQLCA                      10528099
105290              MOVE 'TMESTDS ' TO DP013-DB2-TABLE-NAME (1)         10529099
105300              SET DP013-DB2-ABEND                                 10530099
105310                  DP013-XCTL-DISPLAY-RESTART                      10531099
105320                              TO TRUE                             10532099
105330              PERFORM DP013-0000-PROCESS-ABEND                    10533099
105340     END-EVALUATE.                                                10534099
105350                                                                  10535099
105360 EJECT                                                            10536099
105370*----------------------------------------------------------------*10537099
105380* CHECK IF PO OFFERS A PARTICULAR TYPE OF SERVICE                *10538099
105390*----------------------------------------------------------------*10539099
105400                                                                  10540099
105410 9780-CHECK-SERVICE.                                              10541099
105420                                                                  10542099
105430     EXEC SQL                                                     10543099
105440          SELECT COUNT(*)                                         10544099
105450            INTO :PV-DB2-COUNT                                    10545099
105460            FROM TPOAGMT                                          10546099
105470           WHERE PO_NBR         = :DK-PO-NBR                      10547099
105480             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                10548099
105490             AND VER_STATUS_CDE = 'A'                             10549099
105500             AND TYP_CDE        = :DK-TYP-CDE                     10550099
105510     END-EXEC.                                                    10551099
105520                                                                  10552099
105530     EVALUATE TRUE                                                10553099
105540         WHEN SQLCODE = +0                                        10554099
105550         WHEN SQLCODE = +100                                      10555099
105560         WHEN SQLCODE = -904                                      10556099
105570         WHEN SQLCODE = -913                                      10557099
105580              CONTINUE                                            10558099
105590                                                                  10559099
105600         WHEN SQLWARN0 NOT = SPACES                               10560099
105610         WHEN SQLCODE < +0                                        10561099
105620         WHEN SQLCODE > +0                                        10562099
105630              MOVE '9780-CHECK-SERVICE'                           10563099
105640                              TO DP013-PARAGRAPH                  10564099
105650              MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'       10565099
105660                              TO DP013-MESSAGE-TEXT (1)           10566099
105670              MOVE SQLCA      TO DP013-SQLCA                      10567099
105680              MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)         10568099
105690              SET DP013-DB2-ABEND                                 10569099
105700                  DP013-XCTL-DISPLAY-RESTART                      10570099
105710                              TO TRUE                             10571099
105720              PERFORM DP013-0000-PROCESS-ABEND                    10572099
105730     END-EVALUATE.                                                10573099
105740                                                                  10574099
105750 EJECT                                                            10575099
105760*----------------------------------------------------------------*10576099
105770*  READ BOOKING DATA                                             *10577099
105780*----------------------------------------------------------------*10578099
105790 9800-SELECT-BOOKING-DATA.                                        10579099
105800     PERFORM                                                      10580099
105810         WITH TEST AFTER                                          10581099
105820         VARYING PV-RETRY-COUNTER                                 10582099
105830         FROM 1 BY 1                                              10583099
105840         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10584099
105850             OR (SQLCODE = -811)                                  10585099
105860             OR (SQLCODE = +100)                                  10586099
105870             OR (SQLCODE = ZERO))                                 10587099
105880*                                                                 10588099
105890         EXEC SQL                                                 10589099
105900             SELECT MIN(DATE(PO_BKG_DELY_TMST))                   10590099
105910             INTO                                                 10591099
105920               :PV-BKNG-DELY-DT                                   10592099
105930               :PV-BKNG-DELY-DT-NULL                              10593099
105940             FROM   TIMBKPO                                       10594099
105950             WHERE  PO_NBR IN (:DK-PO-NBR)                        10595099
105960             AND    DATE(PO_BKG_DELY_TMST)  <>                    10596099
105970                            '0001-01-01'                          10597099
105980         END-EXEC                                                 10598099
105990*                                                                 10599099
106000     EVALUATE TRUE                                                10600099
106010         WHEN SQLCODE = ZERO                                      10601099
106020         WHEN SQLCODE = -811                                      10602099
106030             IF PV-BKNG-DELY-DT-NULL = 0                          10603099
106040              AND PV-BKNG-DELY-DT NOT = '0001-01-01'              10604099
106050                MOVE PV-BKNG-DELY-DT (1:4) TO                     10605099
106060                                PV-SM-BKNG-DELY-DT(1:4)           10606099
106070                MOVE PV-BKNG-DELY-DT (6:2) TO                     10607099
106080                                PV-SM-BKNG-DELY-DT(5:2)           10608099
106090                MOVE PV-BKNG-DELY-DT (9:2) TO                     10609099
106100                                PV-SM-BKNG-DELY-DT(7:2)           10610099
106110             END-IF                                               10611099
106120         WHEN SQLWARN0 NOT = SPACES                               10612099
106130         WHEN SQLCODE < ZERO                                      10613099
106140         WHEN SQLCODE > ZERO                                      10614099
106150             MOVE '9800-SELECT-BOOKING-DATA'                      10615099
106160                               TO DP013-PARAGRAPH                 10616099
106170             MOVE 'SELECT DATA'                                   10617099
106180                               TO DP013-MESSAGE-TEXT (1)          10618099
106190             MOVE SQLCA        TO DP013-SQLCA                     10619099
106200             MOVE 'TIMBKPO'    TO DP013-DB2-TABLE-NAME (1)        10620099
106210             SET DP013-DB2-ABEND                                  10621099
106220                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10622099
106230             PERFORM DP013-0000-PROCESS-ABEND                     10623099
106240     END-EVALUATE                                                 10624099
106250     END-PERFORM.                                                 10625099
106260*                                                                 10626099
106270     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10627099
106280         MOVE '9800-SELECT-BOOKING-DATA'                          10628099
106290                               TO DP013-PARAGRAPH                 10629099
106300         MOVE 'SELECT DATA'                                       10630099
106310                           TO DP013-MESSAGE-TEXT (1)              10631099
106320         MOVE SQLCA        TO DP013-SQLCA                         10632099
106330         MOVE 'TIMBKPO'    TO DP013-DB2-TABLE-NAME (1)            10633099
106340         SET DP013-DB2-ABEND                                      10634099
106350             DP013-XCTL-DISPLAY-RESTART                           10635099
106360                                   TO TRUE                        10636099
106370         PERFORM DP013-0000-PROCESS-ABEND                         10637099
106380     END-IF.                                                      10638099
106390 EJECT                                                            10639099
106400*                                                                 10640099
106410*----------------------------------------------------------------*10641099
106420*  READ IMPORT RECEIPT DATA                                      *10642099
106430*----------------------------------------------------------------*10643099
106440 9810-SELECT-RECEIPT-DATA.                                        10644099
106450     PERFORM                                                      10645099
106460         WITH TEST AFTER                                          10646099
106470         VARYING PV-RETRY-COUNTER                                 10647099
106480         FROM 1 BY 1                                              10648099
106490         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10649099
106500             OR (SQLCODE = -811)                                  10650099
106510             OR (SQLCODE = +100)                                  10651099
106520             OR (SQLCODE = ZERO))                                 10652099
106530*                                                                 10653099
106540         EXEC SQL                                                 10654099
106550             SELECT MIN(DATE(PO_RCVD_DELY_TMST))                  10655099
106560             INTO                                                 10656099
106570               :PV-ACTL-DELY-DT                                   10657099
106580               :PV-ACTL-DELY-DT-NULL                              10658099
106590             FROM   TIMRCPO                                       10659099
106600             WHERE  PO_NBR IN (:DK-PO-NBR)                        10660099
106610             AND    DATE(PO_RCVD_DELY_TMST)  <>                   10661099
106620                                '0001-01-01'                      10662099
106630         END-EXEC                                                 10663099
106640*                                                                 10664099
106650     EVALUATE TRUE                                                10665099
106660         WHEN SQLCODE = ZERO                                      10666099
106670         WHEN SQLCODE = -811                                      10667099
106680             IF PV-ACTL-DELY-DT-NULL = 0                          10668099
106690              AND PV-ACTL-DELY-DT NOT = '0001-01-01'              10669099
106700                MOVE PV-ACTL-DELY-DT (1:4) TO                     10670099
106710                                PV-SM-ACTL-DELY-DT(1:4)           10671099
106720                MOVE PV-ACTL-DELY-DT (6:2) TO                     10672099
106730                                PV-SM-ACTL-DELY-DT(5:2)           10673099
106740                MOVE PV-ACTL-DELY-DT (9:2) TO                     10674099
106750                                PV-SM-ACTL-DELY-DT(7:2)           10675099
106760             END-IF                                               10676099
106770         WHEN SQLWARN0 NOT = SPACES                               10677099
106780         WHEN SQLCODE < ZERO                                      10678099
106790         WHEN SQLCODE > ZERO                                      10679099
106800             MOVE '9810-SELECT-RECEIPT-DATA'                      10680099
106810                               TO DP013-PARAGRAPH                 10681099
106820             MOVE 'SELECT DATA'                                   10682099
106830                               TO DP013-MESSAGE-TEXT (1)          10683099
106840             MOVE SQLCA        TO DP013-SQLCA                     10684099
106850             MOVE 'TIMRCPO'      TO DP013-DB2-TABLE-NAME (1)      10685099
106860             SET DP013-DB2-ABEND                                  10686099
106870                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10687099
106880             PERFORM DP013-0000-PROCESS-ABEND                     10688099
106890     END-EVALUATE                                                 10689099
106900     END-PERFORM.                                                 10690099
106910*                                                                 10691099
106920     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10692099
106930         MOVE '9810-SELECT-RECEIPT-DATA'                          10693099
106940                               TO DP013-PARAGRAPH                 10694099
106950         MOVE 'SELECT DATA'                                       10695099
106960                           TO DP013-MESSAGE-TEXT (1)              10696099
106970         MOVE SQLCA        TO DP013-SQLCA                         10697099
106980         MOVE 'TIMRCPO'    TO DP013-DB2-TABLE-NAME (1)            10698099
106990         SET DP013-DB2-ABEND                                      10699099
107000             DP013-XCTL-DISPLAY-RESTART                           10700099
107010                                   TO TRUE                        10701099
107020         PERFORM DP013-0000-PROCESS-ABEND                         10702099
107030     END-IF.                                                      10703099
107040 EJECT                                                            10704099
107050*----------------------------------------------------------------*10705099
107060*    FETCH THE IMPORT CURSOR                                     *10706099
107070*----------------------------------------------------------------*10707099
107080                                                                  10708099
107090 9820-SELECT-CONTAINER-DATA.                                      10709099
107100*                                                                 10710099
107110     PERFORM                                                      10711099
107120         WITH TEST AFTER                                          10712099
107130         VARYING PV-RETRY-COUNTER                                 10713099
107140         FROM 1 BY 1                                              10714099
107150         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10715099
107160             OR (SQLCODE = -811)                                  10716099
107170             OR (SQLCODE = +100)                                  10717099
107180             OR (SQLCODE = ZERO))                                 10718099
107190                                                                  10719099
107200     EXEC SQL                                                     10720099
107210            SELECT MIN(T.MOM_DPRTR_DTE)                           10721099
107220                  ,MIN(T.MOM_POE_DELY_DTE)                        10722099
107230                  ,MIN(T.ACTL_POE_DELY_DTE)                       10723099
107240                  ,MIN(T.FDR_DPRTR_DTE)                           10724099
107250                  ,MIN(T.BKR_FRGT_RLSE_DTE)                       10725099
107260            INTO                                                  10726099
107270              :PV-IMPRT-DPRTR-DT                                  10727099
107280              :PV-IMPRT-DPRTR-DT-NULL                             10728099
107290             ,:PV-IMPRT-POE-DELY-DT                               10729099
107300              :PV-IMPRT-POE-DELY-DT-NULL                          10730099
107310             ,:PV-IMPRT-ACT-DELY-DT                               10731099
107320              :PV-IMPRT-ACT-DELY-DT-NULL                          10732099
107330             ,:PV-FEEDER-DPRTR-DT                                 10733099
107340              :PV-FEEDER-DPRTR-DT-NULL                            10734099
107350             ,:PV-IMPRT-BKR-FRGT-RLSE-DT                          10735099
107360              :PV-IMPRT-BKR-FRGT-RLSE-DT-NULL                     10736099
107370            FROM (SELECT CASE                                     10737099
107380                           WHEN DATE(B.MOM_DPRTR_TMST)            10738099
107390                                    = '0001-01-01'                10739099
107400                             THEN DATE('9999-09-09')              10740099
107410                           WHEN DATE(B.MOM_DPRTR_TMST)            10741099
107420                                   <> '0001-01-01'                10742099
107430                             THEN DATE(B.MOM_DPRTR_TMST)          10743099
107440                           END AS MOM_DPRTR_DTE                   10744099
107450                        ,CASE                                     10745099
107460                           WHEN DATE(B.MOM_POE_DELY_TMST)         10746099
107470                                    = '0001-01-01'                10747099
107480                             THEN DATE('9999-09-09')              10748099
107490                           WHEN DATE(B.MOM_POE_DELY_TMST)         10749099
107500                                   <> '0001-01-01'                10750099
107510                             THEN DATE(B.MOM_POE_DELY_TMST)       10751099
107520                           END AS MOM_POE_DELY_DTE                10752099
107530                         ,CASE                                    10753099
107540                           WHEN DATE(B.ACTL_POE_DELY_TMST)        10754099
107550                                    = '0001-01-01'                10755099
107560                             THEN DATE('9999-09-09')              10756099
107570                           WHEN DATE(B.ACTL_POE_DELY_TMST)        10757099
107580                                   <> '0001-01-01'                10758099
107590                             THEN DATE(B.ACTL_POE_DELY_TMST)      10759099
107600                          END AS ACTL_POE_DELY_DTE                10760099
107610                         ,CASE                                    10761099
107620                            WHEN DATE(B.FDR_DPRTR_TMST)           10762099
107630                                   = '0001-01-01'                 10763099
107640                              THEN DATE('9999-09-09')             10764099
107650                            WHEN DATE(B.FDR_DPRTR_TMST)           10765099
107660                                  <> '0001-01-01'                 10766099
107670                              THEN DATE(B.FDR_DPRTR_TMST)         10767099
107680                          END AS FDR_DPRTR_DTE                    10768099
107690                         ,CASE                                    10769099
107700                           WHEN DATE(B.BKR_FRGT_RLSE_TMST)        10770099
107710                                    = '0001-01-01'                10771099
107720                             THEN DATE('9999-09-09')              10772099
107730                           WHEN DATE(B.BKR_FRGT_RLSE_TMST)        10773099
107740                                   <> '0001-01-01'                10774099
107750                             THEN DATE(B.BKR_FRGT_RLSE_TMST)      10775099
107760                          END AS BKR_FRGT_RLSE_DTE                10776099
107770                  FROM  TIMCNPO A                                 10777099
107780                       ,TIMCNTK B                                 10778099
107790                  WHERE A.PO_NBR         = :DK-PO-NBR             10779099
107800                  AND   A.CONTNR_ID      = B.CONTNR_ID            10780099
107810                  AND   A.CONTNR_SEQ_NBR =                        10781099
107820                                 B.CONTNR_SEQ_NBR) AS T           10782099
107830     END-EXEC                                                     10783099
107840                                                                  10784099
107850     EVALUATE TRUE                                                10785099
107860         WHEN SQLCODE = ZERO                                      10786099
107870         WHEN SQLCODE = -811                                      10787099
107880                                                                  10788099
107890             IF (PV-IMPRT-DPRTR-DT-NULL = 0                       10789099
107900              AND PV-FEEDER-DPRTR-DT-NULL = 0                     10790099
107910               AND PV-FEEDER-DPRTR-DT NOT = '9999-09-09'          10791099
107920                AND PV-FEEDER-DPRTR-DT < PV-IMPRT-DPRTR-DT)       10792099
107930                   OR (PV-FEEDER-DPRTR-DT-NULL = 0                10793099
107940                       AND PV-FEEDER-DPRTR-DT NOT = '9999-09-09'  10794099
107950                         AND PV-IMPRT-DPRTR-DT-NULL = -1)         10795099
107960                           MOVE PV-FEEDER-DPRTR-DT TO             10796099
107970                                           PV-IMPRT-DPRTR-DT      10797099
107980                           MOVE +0 TO PV-IMPRT-DPRTR-DT-NULL      10798099
107990             END-IF                                               10799099
108000                                                                  10800099
108010             IF PV-IMPRT-DPRTR-DT-NULL = 0                        10801099
108020              AND PV-IMPRT-DPRTR-DT NOT = '9999-09-09'            10802099
108030                 MOVE PV-IMPRT-DPRTR-DT (1:4) TO                  10803099
108040                               PV-SM-IMPRT-DPRTR-DT(1:4)          10804099
108050                 MOVE PV-IMPRT-DPRTR-DT (6:2) TO                  10805099
108060                               PV-SM-IMPRT-DPRTR-DT(5:2)          10806099
108070                 MOVE PV-IMPRT-DPRTR-DT (9:2) TO                  10807099
108080                               PV-SM-IMPRT-DPRTR-DT(7:2)          10808099
108090             END-IF                                               10809099
108100                                                                  10810099
108110             IF PV-IMPRT-ACT-DELY-DT-NULL = 0                     10811099
108120               AND PV-IMPRT-ACT-DELY-DT NOT = '9999-09-09'        10812099
108130                MOVE PV-IMPRT-ACT-DELY-DT (1:4) TO                10813099
108140                            PV-SM-IMPRT-POE-DELY-DT(1:4)          10814099
108150                MOVE PV-IMPRT-ACT-DELY-DT (6:2) TO                10815099
108160                            PV-SM-IMPRT-POE-DELY-DT(5:2)          10816099
108170                MOVE PV-IMPRT-ACT-DELY-DT (9:2) TO                10817099
108180                            PV-SM-IMPRT-POE-DELY-DT(7:2)          10818099
108190                MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)             10819099
108200                MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)             10820099
108210             ELSE                                                 10821099
108220                IF PV-IMPRT-POE-DELY-DT-NULL = 0                  10822099
108230                 AND PV-IMPRT-POE-DELY-DT NOT = '9999-09-09'      10823099
108240                  MOVE PV-IMPRT-POE-DELY-DT (1:4) TO              10824099
108250                              PV-SM-IMPRT-POE-DELY-DT(1:4)        10825099
108260                  MOVE PV-IMPRT-POE-DELY-DT (6:2) TO              10826099
108270                              PV-SM-IMPRT-POE-DELY-DT(5:2)        10827099
108280                  MOVE PV-IMPRT-POE-DELY-DT (9:2) TO              10828099
108290                              PV-SM-IMPRT-POE-DELY-DT(7:2)        10829099
108300                  MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)           10830099
108310                  MOVE PC-E    TO PV-WORK-ETA-ATA (2:1)           10831099
108320                END-IF                                            10832099
108330             END-IF                                               10833099
108340                                                                  10834099
108350             IF PV-IMPRT-BKR-FRGT-RLSE-DT-NULL = 0                10835099
108360              AND PV-IMPRT-BKR-FRGT-RLSE-DT NOT = '9999-09-09'    10836099
108370                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (1:4) TO          10837099
108380                               PV-SM-BKR-FRGT-RLSE-DT(1:4)        10838099
108390                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (6:2) TO          10839099
108400                               PV-SM-BKR-FRGT-RLSE-DT(5:2)        10840099
108410                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (9:2) TO          10841099
108420                               PV-SM-BKR-FRGT-RLSE-DT(7:2)        10842099
108430             END-IF                                               10843099
108440                                                                  10844099
108450         WHEN SQLCODE = +100                                      10845099
108460             CONTINUE                                             10846099
108470         WHEN SQLWARN0 NOT = SPACE                                10847099
108480         WHEN SQLCODE NOT = ZERO                                  10848099
108490              MOVE '9820-SELECT-CONTAINER-DATA'                   10849099
108500                               TO DP013-PARAGRAPH                 10850099
108510              MOVE 'SELECT CONTAINER DATA'                        10851099
108520                               TO DP013-MESSAGE-TEXT (1)          10852099
108530              MOVE SQLCA       TO DP013-SQLCA                     10853099
108540              MOVE 'TIMCNPO'   TO DP013-DB2-TABLE-NAME (1)        10854099
108550              MOVE 'TIMCNTK'   TO DP013-DB2-TABLE-NAME (2)        10855099
108560              SET DP013-DB2-ABEND                                 10856099
108570                               TO TRUE                            10857099
108580              PERFORM DP013-0000-PROCESS-ABEND                    10858099
108590     END-EVALUATE                                                 10859099
108600     END-PERFORM.                                                 10860099
108610                                                                  10861099
108620     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10862099
108630         MOVE '9820-SELECT-CONTAINER-DATA'                        10863099
108640                           TO DP013-PARAGRAPH                     10864099
108650         MOVE 'SELECT CONTAINER DATA'                             10865099
108660                           TO DP013-MESSAGE-TEXT (1)              10866099
108670         MOVE SQLCA       TO DP013-SQLCA                          10867099
108680         MOVE 'TIMCNPO'   TO DP013-DB2-TABLE-NAME (1)             10868099
108690         MOVE 'TIMCNTK'   TO DP013-DB2-TABLE-NAME (2)             10869099
108700         SET DP013-DB2-ABEND                                      10870099
108710             DP013-XCTL-DISPLAY-RESTART                           10871099
108720                                   TO TRUE                        10872099
108730         PERFORM DP013-0000-PROCESS-ABEND                         10873099
108740     END-IF.                                                      10874099
108750*                                                                 10875099
108760 EJECT                                                            10876099
108770*----------------------------------------------------------------*10877099
108780*  SELECT THE CONTAINER RELEASE DATE                             *10878099
108790*----------------------------------------------------------------*10879099
108800 9822-SELECT-CONTNR-RLSE-CDE.                                     10880099
108810                                                                  10881099
108820     PERFORM                                                      10882099
108830         WITH TEST AFTER                                          10883099
108840         VARYING PV-RETRY-COUNTER                                 10884099
108850         FROM 1 BY 1                                              10885099
108860         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10886099
108870             OR (SQLCODE = -811)                                  10887099
108880             OR (SQLCODE = +100)                                  10888099
108890             OR (SQLCODE = ZERO))                                 10889099
108900*                                                                 10890099
108910         EXEC SQL                                                 10891099
108920             SELECT A.BKR_FRGT_RLSE_CDE                           10892099
108930               INTO                                               10893099
108940                   :IMCNPO-BKR-FRGT-RLSE-CDE                      10894099
108950              FROM  TIMCNPO A                                     10895099
108960                   ,TIMCNTK B                                     10896099
108970             WHERE A.PO_NBR         = :DK-PO-NBR                  10897099
108980               AND A.CONTNR_ID      = B.CONTNR_ID                 10898099
108990               AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR            10899099
109000         END-EXEC                                                 10900099
109010*                                                                 10901099
109020     EVALUATE TRUE                                                10902099
109030         WHEN SQLCODE = ZERO                                      10903099
109040         WHEN SQLCODE = -811                                      10904099
109050             IF IMCNPO-BKR-FRGT-RLSE-CDE = SPACES                 10905099
109060                 SET PS-BKR-FRGT-RLSE-NO TO TRUE                  10906099
109070             ELSE                                                 10907099
109080                 SET PS-BKR-FRGT-RLSE TO TRUE                     10908099
109090             END-IF                                               10909099
109100                                                                  10910099
109110         WHEN SQLCODE = +100                                      10911099
109120             SET PS-BKR-FRGT-RLSE-NO TO TRUE                      10912099
109130                                                                  10913099
109140         WHEN SQLWARN0 NOT = SPACES                               10914099
109150         WHEN SQLCODE < ZERO                                      10915099
109160         WHEN SQLCODE > ZERO                                      10916099
109170             MOVE '9822-SELECT-CONTNR-RLSE-CDE'                   10917099
109180                               TO DP013-PARAGRAPH                 10918099
109190             MOVE 'SELECT DATA'                                   10919099
109200                               TO DP013-MESSAGE-TEXT (1)          10920099
109210             MOVE SQLCA        TO DP013-SQLCA                     10921099
109220             MOVE 'TIMCNPO'      TO DP013-DB2-TABLE-NAME (1)      10922099
109230             SET DP013-DB2-ABEND                                  10923099
109240                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10924099
109250             PERFORM DP013-0000-PROCESS-ABEND                     10925099
109260     END-EVALUATE                                                 10926099
109270     END-PERFORM.                                                 10927099
109280*                                                                 10928099
109290     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10929099
109300         MOVE '9822-SELECT-CONTNR-RLSE-CDE'                       10930099
109310                               TO DP013-PARAGRAPH                 10931099
109320         MOVE 'SELECT DATA'                                       10932099
109330                           TO DP013-MESSAGE-TEXT (1)              10933099
109340         MOVE SQLCA        TO DP013-SQLCA                         10934099
109350         MOVE 'TIMCNPO'    TO DP013-DB2-TABLE-NAME (1)            10935099
109360         SET DP013-DB2-ABEND                                      10936099
109370             DP013-XCTL-DISPLAY-RESTART                           10937099
109380                                   TO TRUE                        10938099
109390         PERFORM DP013-0000-PROCESS-ABEND                         10939099
109400     END-IF.                                                      10940099
109410 EJECT                                                            10941099
109420*----------------------------------------------------------------*10942099
109430*  SELECT THE CONTAINER ID                                       *10943099
109440*----------------------------------------------------------------*10944099
109450 9825-SELECT-CONTNR-ID.                                           10945099
109460                                                                  10946099
109470     PERFORM                                                      10947099
109480         WITH TEST AFTER                                          10948099
109490         VARYING PV-RETRY-COUNTER                                 10949099
109500         FROM 1 BY 1                                              10950099
109510         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10951099
109520             OR (SQLCODE = -811)                                  10952099
109530             OR (SQLCODE = +100)                                  10953099
109540             OR (SQLCODE = ZERO))                                 10954099
109550*                                                                 10955099
109560         EXEC SQL                                                 10956099
109570             SELECT A.CONTNR_ID                                   10957099
109580               INTO                                               10958099
109590                   :PV-CONTNR-ID                                  10959099
109600              FROM  TIMCNPO A                                     10960099
109610             WHERE A.PO_NBR         = :DK-PO-NBR                  10961099
109620         END-EXEC                                                 10962099
109630*                                                                 10963099
109640     EVALUATE TRUE                                                10964099
109650         WHEN SQLCODE = ZERO                                      10965099
109660             MOVE PV-CONTNR-ID TO PV-SM-CONTNR-ID                 10966099
109670                                                                  10967099
109680         WHEN SQLCODE = -811                                      10968099
109690             MOVE PC-MULTI TO PV-SM-CONTNR-ID                     10969099
109700                                                                  10970099
109710         WHEN SQLCODE = +100                                      10971099
109720             MOVE SPACES TO PV-SM-CONTNR-ID                       10972099
109730                                                                  10973099
109740         WHEN SQLWARN0 NOT = SPACES                               10974099
109750         WHEN SQLCODE < ZERO                                      10975099
109760         WHEN SQLCODE > ZERO                                      10976099
109770             MOVE '9825-SELECT-CONTNR-ID'                         10977099
109780                               TO DP013-PARAGRAPH                 10978099
109790             MOVE 'SELECT DATA'                                   10979099
109800                               TO DP013-MESSAGE-TEXT (1)          10980099
109810             MOVE SQLCA        TO DP013-SQLCA                     10981099
109820             MOVE 'TIMCNTK'      TO DP013-DB2-TABLE-NAME (1)      10982099
109830             SET DP013-DB2-ABEND                                  10983099
109840                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10984099
109850             PERFORM DP013-0000-PROCESS-ABEND                     10985099
109860     END-EVALUATE                                                 10986099
109870     END-PERFORM.                                                 10987099
109880*                                                                 10988099
109890     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10989099
109900         MOVE '9825-SELECT-CONTNR-ID'                             10990099
109910                               TO DP013-PARAGRAPH                 10991099
109920         MOVE 'SELECT DATA'                                       10992099
109930                           TO DP013-MESSAGE-TEXT (1)              10993099
109940         MOVE SQLCA        TO DP013-SQLCA                         10994099
109950         MOVE 'TIMCNTK'    TO DP013-DB2-TABLE-NAME (1)            10995099
109960         SET DP013-DB2-ABEND                                      10996099
109970             DP013-XCTL-DISPLAY-RESTART                           10997099
109980                                   TO TRUE                        10998099
109990         PERFORM DP013-0000-PROCESS-ABEND                         10999099
110000     END-IF.                                                      11000099
110010 EJECT                                                            11001099
110020*----------------------------------------------------------------*11002099
110030*    FETCH THE SHIP CURSOR                                       *11003099
110040*----------------------------------------------------------------*11004099
110050                                                                  11005099
110060 9850-FETCH-DC-ETA-ATA-DATA.                                      11006099
110070                                                                  11007099
110080     MOVE '9999-09-09' TO PV-SHIP-ETA-DT.                         11008099
110090     MOVE '9999-09-09' TO PV-SHIP-STAT-DT.                        11009099
110100     MOVE '9999-09-09' TO PV-SHIP-STAT-DT1.                       11010099
110110     MOVE '9999-09-09' TO PV-SHIP-STAT-DT2.                       11011099
110120                                                                  11012099
110130     EXEC SQL                                                     11013099
110140           FETCH SHIP_DATA_CSR                                    11014099
110150           INTO                                                   11015099
110160              :PV-SHIP-ETA-DT:PV-NULL-IND-1                       11016099
110170             ,:PV-SHIP-STAT-DT1:PV-NULL-IND-2                     11017099
110180             ,:PV-SHIP-STAT-DT2:PV-NULL-IND-3                     11018099
110190             ,:PV-OPER-UNT-ID                                     11019099
110200              :PV-OPER-UNT-ID-NULL                                11020099
110210     END-EXEC.                                                    11021099
110220                                                                  11022099
110230     EVALUATE TRUE                                                11023099
110240         WHEN SQLCODE = ZERO                                      11024099
110250            IF PV-OPER-UNT-ID-NULL = 0                            11025099
110260                 IF PV-SHIP-STAT-DT1 = '9999-09-09'               11026099
110270                     MOVE PV-SHIP-STAT-DT2 TO PV-SHIP-STAT-DT     11027099
110280                     MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)        11028099
110290                     MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)        11029099
110300                 ELSE                                             11030099
110310                     MOVE PV-SHIP-STAT-DT1 TO PV-SHIP-STAT-DT     11031099
110320                     MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)        11032099
110330                     MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)        11033099
110340                 END-IF                                           11034099
110350                                                                  11035099
110360                 IF PV-SHIP-STAT-DT = '9999-09-09'                11036099
110370                  AND PV-SHIP-ETA-DT NOT = '9999-09-09'           11037099
110380                   MOVE PV-SHIP-ETA-DT TO PV-SHIP-STAT-DT         11038099
110390                   MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)          11039099
110400                   MOVE PC-E    TO PV-WORK-ETA-ATA (2:1)          11040099
110410                 END-IF                                           11041099
110420                                                                  11042099
110430                 IF PV-SHIP-STAT-DT NOT = '9999-09-09'            11043099
110440                   EVALUATE TRUE                                  11044099
110450                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(1)       11045099
110460                      MOVE PV-SHIP-STAT-DT (1:4) TO               11046099
110470                              PV-SM-TRIP-ETA-DC1(1:4)             11047099
110480                      MOVE PV-SHIP-STAT-DT (6:2) TO               11048099
110490                              PV-SM-TRIP-ETA-DC1(5:2)             11049099
110500                      MOVE PV-SHIP-STAT-DT (9:2) TO               11050099
110510                              PV-SM-TRIP-ETA-DC1(7:2)             11051099
110520                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC1 11052099
110530                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(2)       11053099
110540                      MOVE PV-SHIP-STAT-DT (1:4) TO               11054099
110550                              PV-SM-TRIP-ETA-DC2(1:4)             11055099
110560                      MOVE PV-SHIP-STAT-DT (6:2) TO               11056099
110570                              PV-SM-TRIP-ETA-DC2(5:2)             11057099
110580                      MOVE PV-SHIP-STAT-DT (9:2) TO               11058099
110590                              PV-SM-TRIP-ETA-DC2(7:2)             11059099
110600                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC2 11060099
110610                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(3)       11061099
110620                      MOVE PV-SHIP-STAT-DT (1:4) TO               11062099
110630                              PV-SM-TRIP-ETA-DC3(1:4)             11063099
110640                      MOVE PV-SHIP-STAT-DT (6:2) TO               11064099
110650                              PV-SM-TRIP-ETA-DC3(5:2)             11065099
110660                      MOVE PV-SHIP-STAT-DT (9:2) TO               11066099
110670                              PV-SM-TRIP-ETA-DC3(7:2)             11067099
110680                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC3 11068099
110690                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(4)       11069099
110700                      MOVE PV-SHIP-STAT-DT (1:4) TO               11070099
110710                              PV-SM-TRIP-ETA-DC4(1:4)             11071099
110720                      MOVE PV-SHIP-STAT-DT (6:2) TO               11072099
110730                              PV-SM-TRIP-ETA-DC4(5:2)             11073099
110740                      MOVE PV-SHIP-STAT-DT (9:2) TO               11074099
110750                              PV-SM-TRIP-ETA-DC4(7:2)             11075099
110760                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC4 11076099
110770                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(5)       11077099
110780                      MOVE PV-SHIP-STAT-DT (1:4) TO               11078099
110790                              PV-SM-TRIP-ETA-DC5(1:4)             11079099
110800                      MOVE PV-SHIP-STAT-DT (6:2) TO               11080099
110810                              PV-SM-TRIP-ETA-DC5(5:2)             11081099
110820                      MOVE PV-SHIP-STAT-DT (9:2) TO               11082099
110830                              PV-SM-TRIP-ETA-DC5(7:2)             11083099
110840                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC5 11084099
110850                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(6)       11085099
110860                      MOVE PV-SHIP-STAT-DT (1:4) TO               11086099
110870                              PV-SM-TRIP-ETA-DC6(1:4)             11087099
110880                      MOVE PV-SHIP-STAT-DT (6:2) TO               11088099
110890                              PV-SM-TRIP-ETA-DC6(5:2)             11089099
110900                      MOVE PV-SHIP-STAT-DT (9:2) TO               11090099
110910                              PV-SM-TRIP-ETA-DC6(7:2)             11091099
110920                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC6 11092099
110930                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(7)       11093099
110940                      MOVE PV-SHIP-STAT-DT (1:4) TO               11094099
110950                              PV-SM-TRIP-ETA-DC7(1:4)             11095099
110960                      MOVE PV-SHIP-STAT-DT (6:2) TO               11096099
110970                              PV-SM-TRIP-ETA-DC7(5:2)             11097099
110980                      MOVE PV-SHIP-STAT-DT (9:2) TO               11098099
110990                              PV-SM-TRIP-ETA-DC7(7:2)             11099099
111000                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC7 11100099
111010                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(8)       11101099
111020                      MOVE PV-SHIP-STAT-DT (1:4) TO               11102099
111030                              PV-SM-TRIP-ETA-DC8(1:4)             11103099
111040                      MOVE PV-SHIP-STAT-DT (6:2) TO               11104099
111050                              PV-SM-TRIP-ETA-DC8(5:2)             11105099
111060                      MOVE PV-SHIP-STAT-DT (9:2) TO               11106099
111070                              PV-SM-TRIP-ETA-DC8(7:2)             11107099
111080                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC8 11108099
111090                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(9)       11109099
111100                      MOVE PV-SHIP-STAT-DT (1:4) TO               11110099
111110                              PV-SM-TRIP-ETA-DC9(1:4)             11111099
111120                      MOVE PV-SHIP-STAT-DT (6:2) TO               11112099
111130                              PV-SM-TRIP-ETA-DC9(5:2)             11113099
111140                      MOVE PV-SHIP-STAT-DT (9:2) TO               11114099
111150                              PV-SM-TRIP-ETA-DC9(7:2)             11115099
111160                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC9 11116099
111170                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(10)      11117099
111180                      MOVE PV-SHIP-STAT-DT (1:4) TO               11118099
111190                              PV-SM-TRIP-ETA-DC10(1:4)            11119099
111200                      MOVE PV-SHIP-STAT-DT (6:2) TO               11120099
111210                              PV-SM-TRIP-ETA-DC10(5:2)            11121099
111220                      MOVE PV-SHIP-STAT-DT (9:2) TO               11122099
111230                              PV-SM-TRIP-ETA-DC10(7:2)            11123099
111240                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC1011124099
111250                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(11)      11125099
111260                      MOVE PV-SHIP-STAT-DT (1:4) TO               11126099
111270                              PV-SM-TRIP-ETA-DC11(1:4)            11127099
111280                      MOVE PV-SHIP-STAT-DT (6:2) TO               11128099
111290                              PV-SM-TRIP-ETA-DC11(5:2)            11129099
111300                      MOVE PV-SHIP-STAT-DT (9:2) TO               11130099
111310                              PV-SM-TRIP-ETA-DC11(7:2)            11131099
111320                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC1111132099
111330                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(12)      11133099
111340                      MOVE PV-SHIP-STAT-DT (1:4) TO               11134099
111350                              PV-SM-TRIP-ETA-DC12(1:4)            11135099
111360                      MOVE PV-SHIP-STAT-DT (6:2) TO               11136099
111370                              PV-SM-TRIP-ETA-DC12(5:2)            11137099
111380                      MOVE PV-SHIP-STAT-DT (9:2) TO               11138099
111390                              PV-SM-TRIP-ETA-DC12(7:2)            11139099
111400                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC1211140099
111410                   END-EVALUATE                                   11141099
111420                 END-IF                                           11142099
111430            END-IF                                                11143099
111440         WHEN SQLCODE = +100                                      11144099
111450              SET NO-MORE-CURSOR-DATA  TO TRUE                    11145099
111460         WHEN SQLWARN0 NOT = SPACE                                11146099
111470         WHEN SQLCODE NOT = ZERO                                  11147099
111480                 MOVE '9850-FETCH-DC-ETA-ATA-DATA'                11148099
111490                                  TO DP013-PARAGRAPH              11149099
111500                 MOVE 'FETCH SHIP CURSOR'                         11150099
111510                                  TO DP013-MESSAGE-TEXT (1)       11151099
111520                 MOVE SQLCA       TO DP013-SQLCA                  11152099
111530                 SET DP013-DB2-ABEND                              11153099
111540                                  TO TRUE                         11154099
111550                 PERFORM DP013-0000-PROCESS-ABEND                 11155099
111560     END-EVALUATE.                                                11156099
111570 EJECT                                                            11157099
111580*----------------------------------------------------------------*11158099
111590*  LOAD STORE NUMBER                                             *11159099
111600*----------------------------------------------------------------*11160099
111610                                                                  11161099
111620 9860-OPEN-STORE-CURSOR.                                          11162099
111630                                                                  11163099
111640     PERFORM                                                      11164099
111650         WITH TEST AFTER                                          11165099
111660         VARYING PV-RETRY-COUNTER                                 11166099
111670         FROM 1 BY 1                                              11167099
111680         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11168099
111690             OR (SQLCODE = ZERO))                                 11169099
111700*                                                                 11170099
111710         EXEC SQL                                                 11171099
111720             OPEN STORE_CSR                                       11172099
111730         END-EXEC                                                 11173099
111740*                                                                 11174099
111750         EVALUATE TRUE                                            11175099
111760             WHEN SQLCODE = ZERO                                  11176099
111770             WHEN SQLCODE = -904                                  11177099
111780             WHEN SQLCODE = -913                                  11178099
111790                 CONTINUE                                         11179099
111800             WHEN SQLWARN0 NOT = SPACES                           11180099
111810             WHEN SQLCODE < ZERO                                  11181099
111820             WHEN SQLCODE > ZERO                                  11182099
111830                 MOVE '9860-OPEN-CURSOR'                          11183099
111840                                   TO DP013-PARAGRAPH             11184099
111850                 MOVE 'OPEN CURSOR - '                            11185099
111860                                   TO DP013-MESSAGE-TEXT (1)      11186099
111870                 MOVE SQLCA        TO DP013-SQLCA                 11187099
111880                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    11188099
111890                 SET DP013-DB2-ABEND                              11189099
111900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11190099
111910                 PERFORM DP013-0000-PROCESS-ABEND                 11191099
111920         END-EVALUATE                                             11192099
111930     END-PERFORM.                                                 11193099
111940*                                                                 11194099
111950     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11195099
111960         MOVE '9860-OPEN-CURSOR'   TO DP013-PARAGRAPH             11196099
111970         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   11197099
111980                                   TO DP013-MESSAGE-TEXT (1)      11198099
111990         MOVE SQLCA                TO DP013-SQLCA                 11199099
112000         MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1)     11200099
112010         SET DP013-DB2-ABEND                                      11201099
112020             DP013-XCTL-DISPLAY-RESTART                           11202099
112030                                   TO TRUE                        11203099
112040         PERFORM DP013-0000-PROCESS-ABEND                         11204099
112050     END-IF.                                                      11205099
112060 EJECT                                                            11206099
112070*----------------------------------------------------------------*11207099
112080*    FETCH THE STORE CURSOR                                      *11208099
112090*----------------------------------------------------------------*11209099
112100                                                                  11210099
112110 9870-FETCH-STORE.                                                11211099
112120*                                                                 11212099
112130     EXEC SQL                                                     11213099
112140        FETCH STORE_CSR                                           11214099
112150        INTO                                                      11215099
112160           :XLT00010-LOC-NBR                                      11216099
112170          ,:XLT00010-LOC-5-ABBR-NM                                11217099
112180     END-EXEC                                                     11218099
112190                                                                  11219099
112200     EVALUATE TRUE                                                11220099
112210         WHEN SQLCODE = ZERO                                      11221099
112220           ADD +1 TO PV-DC-I                                      11222099
112230           IF PV-DC-I < PC-DCSTORE-LIMIT                          11223099
112240            OR PV-DC-I = PC-DCSTORE-LIMIT                         11224099
112250              MOVE XLT00010-LOC-NBR TO                            11225099
112260                          DC-STORE-NMBR(PV-DC-I)                  11226099
112270              MOVE XLT00010-LOC-5-ABBR-NM TO                      11227099
112280                          DC-STORE-NAME(PV-DC-I)                  11228099
112290           ELSE                                                   11229099
112300             SET NO-MORE-STORE-DATA  TO TRUE                      11230099
112310           END-IF                                                 11231099
112320         WHEN SQLCODE = +100                                      11232099
112330           SET NO-MORE-STORE-DATA  TO TRUE                        11233099
112340         WHEN SQLWARN0 NOT = SPACE                                11234099
112350         WHEN SQLCODE NOT = ZERO                                  11235099
112360              MOVE '9870-FETCH-STORE'                             11236099
112370                               TO DP013-PARAGRAPH                 11237099
112380              MOVE 'FETCH STORE CURSOR'                           11238099
112390                               TO DP013-MESSAGE-TEXT (1)          11239099
112400              MOVE SQLCA       TO DP013-SQLCA                     11240099
112410              SET DP013-DB2-ABEND                                 11241099
112420                               TO TRUE                            11242099
112430              PERFORM DP013-0000-PROCESS-ABEND                    11243099
112440     END-EVALUATE.                                                11244099
112450*                                                                 11245099
112460 EJECT                                                            11246099
112470*----------------------------------------------------------------*11247099
112480*  LOAD STORE NUMBER                                             *11248099
112490*----------------------------------------------------------------*11249099
112500                                                                  11250099
112510 9880-CLOSE-STORE-CURSOR.                                         11251099
112520                                                                  11252099
112530     PERFORM                                                      11253099
112540         WITH TEST AFTER                                          11254099
112550         VARYING PV-RETRY-COUNTER                                 11255099
112560         FROM 1 BY 1                                              11256099
112570         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11257099
112580             OR (SQLCODE = ZERO))                                 11258099
112590*                                                                 11259099
112600         EXEC SQL                                                 11260099
112610             CLOSE STORE_CSR                                      11261099
112620         END-EXEC                                                 11262099
112630*                                                                 11263099
112640         EVALUATE TRUE                                            11264099
112650             WHEN SQLCODE = ZERO                                  11265099
112660             WHEN SQLCODE = -904                                  11266099
112670             WHEN SQLCODE = -913                                  11267099
112680                 CONTINUE                                         11268099
112690             WHEN SQLWARN0 NOT = SPACES                           11269099
112700             WHEN SQLCODE < ZERO                                  11270099
112710             WHEN SQLCODE > ZERO                                  11271099
112720                 MOVE '9880-CLOSE-CURSOR'                         11272099
112730                                   TO DP013-PARAGRAPH             11273099
112740                 MOVE 'CLOSE CURSOR - '                           11274099
112750                                   TO DP013-MESSAGE-TEXT (1)      11275099
112760                 MOVE SQLCA        TO DP013-SQLCA                 11276099
112770                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    11277099
112780                 SET DP013-DB2-ABEND                              11278099
112790                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11279099
112800                 PERFORM DP013-0000-PROCESS-ABEND                 11280099
112810         END-EVALUATE                                             11281099
112820     END-PERFORM.                                                 11282099
112830*                                                                 11283099
112840     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11284099
112850         MOVE '9880-CLOSE-CURSOR'   TO DP013-PARAGRAPH            11285099
112860         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   11286099
112870                                   TO DP013-MESSAGE-TEXT (1)      11287099
112880         MOVE SQLCA                TO DP013-SQLCA                 11288099
112890         MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1)     11289099
112900         SET DP013-DB2-ABEND                                      11290099
112910             DP013-XCTL-DISPLAY-RESTART                           11291099
112920                                   TO TRUE                        11292099
112930         PERFORM DP013-0000-PROCESS-ABEND                         11293099
112940     END-IF.                                                      11294099
112950 EJECT                                                            11295099
112960*----------------------------------------------------------------*11296099
112970*  DETERMINE CUSTOMS RELEASE DATE                                *11297099
112980*----------------------------------------------------------------*11298099
112990                                                                  11299099
113000 9890-LOAD-CUSTOMS-DATA.                                          11300099
113010                                                                  11301099
113020     PERFORM                                                      11302099
113030         WITH TEST AFTER                                          11303099
113040         VARYING PV-RETRY-COUNTER                                 11304099
113050         FROM 1 BY 1                                              11305099
113060         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11306099
113070             OR (SQLCODE = +100)                                  11307099
113080             OR (SQLCODE = -811)                                  11308099
113090             OR (SQLCODE = ZERO))                                 11309099
113100                                                                  11310099
113110     EXEC SQL                                                     11311099
113120          SELECT MIN(DATE(A.ACTL_CLR_TMST))                       11312099
113130            INTO :PV-ACTL-CLR-DATE:PV-ACTL-CLR-DATE-NULL          11313099
113140            FROM TIMCSEN A                                        11314099
113150                ,TIMCSPO B                                        11315099
113160           WHERE B.PO_NBR        = :DK-PO-NBR                     11316099
113170           AND   A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                  11317099
113180     END-EXEC                                                     11318099
113190                                                                  11319099
113200     EVALUATE TRUE                                                11320099
113210         WHEN SQLCODE = +0                                        11321099
113220         WHEN SQLCODE = -811                                      11322099
113230             IF PV-ACTL-CLR-DATE-NULL = 0                         11323099
113240              AND PV-ACTL-CLR-DATE NOT = '0001-01-01'             11324099
113250                 MOVE PV-ACTL-CLR-DATE (1:4) TO                   11325099
113260                                PV-SM-ACTL-CLR-DATE(1:4)          11326099
113270                 MOVE PV-ACTL-CLR-DATE (6:2) TO                   11327099
113280                                PV-SM-ACTL-CLR-DATE(5:2)          11328099
113290                 MOVE PV-ACTL-CLR-DATE (9:2) TO                   11329099
113300                                PV-SM-ACTL-CLR-DATE(7:2)          11330099
113310              ELSE                                                11331099
113320                  MOVE SPACES     TO PV-SM-ACTL-CLR-DATE          11332099
113330             END-IF                                               11333099
113340         WHEN SQLCODE = +100                                      11334099
113350         WHEN SQLCODE = -904                                      11335099
113360         WHEN SQLCODE = -913                                      11336099
113370              CONTINUE                                            11337099
113380         WHEN SQLWARN0 NOT = SPACES                               11338099
113390         WHEN SQLCODE < +0                                        11339099
113400         WHEN SQLCODE > +0                                        11340099
113410              MOVE '9890-LOAD-CUSTOMS-DATA'                       11341099
113420                              TO DP013-PARAGRAPH                  11342099
113430              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11343099
113440                              TO DP013-MESSAGE-TEXT (1)           11344099
113450              MOVE SQLCA      TO DP013-SQLCA                      11345099
113460              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)         11346099
113470              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)         11347099
113480              SET DP013-DB2-ABEND                                 11348099
113490                  DP013-XCTL-DISPLAY-RESTART                      11349099
113500                              TO TRUE                             11350099
113510              PERFORM DP013-0000-PROCESS-ABEND                    11351099
113520     END-EVALUATE                                                 11352099
113530     END-PERFORM.                                                 11353099
113540*                                                                 11354099
113550     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11355099
113560         MOVE '9890-LOAD-CUSTOMS-DATA' TO DP013-PARAGRAPH         11356099
113570         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11357099
113580                                   TO DP013-MESSAGE-TEXT (1)      11358099
113590         MOVE SQLCA                TO DP013-SQLCA                 11359099
113600         MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)              11360099
113610         MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)              11361099
113620         SET DP013-DB2-ABEND                                      11362099
113630             DP013-XCTL-DISPLAY-RESTART                           11363099
113640                                   TO TRUE                        11364099
113650         PERFORM DP013-0000-PROCESS-ABEND                         11365099
113660     END-IF.                                                      11366099
113670 EJECT                                                            11367099
113680*----------------------------------------------------------------*11368099
113690*  DETERMINE DEVAN DATE                                          *11369099
113700*----------------------------------------------------------------*11370099
113710                                                                  11371099
113720 9895-SELECT-DEVAN-DATA.                                          11372099
113730                                                                  11373099
113740     PERFORM                                                      11374099
113750         WITH TEST AFTER                                          11375099
113760         VARYING PV-RETRY-COUNTER                                 11376099
113770         FROM 1 BY 1                                              11377099
113780         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11378099
113790             OR (SQLCODE = -811)                                  11379099
113800             OR (SQLCODE = +100)                                  11380099
113810             OR (SQLCODE = ZERO))                                 11381099
113820                                                                  11382099
113830       EXEC SQL                                                   11383099
113840            SELECT MIN(DATE(A.DVN_TMST))                          11384099
113850            INTO                                                  11385099
113860              :PV-DEVAN-DT:PV-DEVAN-DT-NULL                       11386099
113870            FROM  TIMCNTK A                                       11387099
113880                 ,TIMCNPO B                                       11388099
113890            WHERE B.PO_NBR         =  :DK-PO-NBR                  11389099
113900              AND A.CONTNR_ID      =  B.CONTNR_ID                 11390099
113910              AND A.CONTNR_SEQ_NBR =  B.CONTNR_SEQ_NBR            11391099
113920              AND DATE(A.DVN_TMST) <> '0001-01-01'                11392099
113930              AND B.DVN_CDE =         :PC-Y                       11393099
113940       END-EXEC                                                   11394099
113950                                                                  11395099
113960     EVALUATE TRUE                                                11396099
113970         WHEN SQLCODE = +0                                        11397099
113980         WHEN SQLCODE = -811                                      11398099
113990              IF PV-DEVAN-DT-NULL = 0                             11399099
114000                  MOVE PV-DEVAN-DT (1:4) TO                       11400099
114010                                PV-SM-DEVAN-DT(1:4)               11401099
114020                  MOVE PV-DEVAN-DT (6:2) TO                       11402099
114030                                PV-SM-DEVAN-DT(5:2)               11403099
114040                  MOVE PV-DEVAN-DT (9:2) TO                       11404099
114050                                PV-SM-DEVAN-DT(7:2)               11405099
114060              END-IF                                              11406099
114070         WHEN SQLCODE = +100                                      11407099
114080         WHEN SQLCODE = -904                                      11408099
114090         WHEN SQLCODE = -913                                      11409099
114100              CONTINUE                                            11410099
114110         WHEN SQLWARN0 NOT = SPACES                               11411099
114120         WHEN SQLCODE < +0                                        11412099
114130         WHEN SQLCODE > +0                                        11413099
114140              MOVE '9895-SELECT-DEVAN-DATA'                       11414099
114150                              TO DP013-PARAGRAPH                  11415099
114160              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11416099
114170                              TO DP013-MESSAGE-TEXT (1)           11417099
114180              MOVE SQLCA      TO DP013-SQLCA                      11418099
114190              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)         11419099
114200              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)         11420099
114210              SET DP013-DB2-ABEND                                 11421099
114220                  DP013-XCTL-DISPLAY-RESTART                      11422099
114230                              TO TRUE                             11423099
114240              PERFORM DP013-0000-PROCESS-ABEND                    11424099
114250     END-EVALUATE                                                 11425099
114260     END-PERFORM.                                                 11426099
114270*                                                                 11427099
114280     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11428099
114290         MOVE '9895-SELECT-DEVAN-DATA' TO DP013-PARAGRAPH         11429099
114300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11430099
114310                                   TO DP013-MESSAGE-TEXT (1)      11431099
114320         MOVE SQLCA                TO DP013-SQLCA                 11432099
114330         MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)              11433099
114340         MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)              11434099
114350         SET DP013-DB2-ABEND                                      11435099
114360             DP013-XCTL-DISPLAY-RESTART                           11436099
114370                                   TO TRUE                        11437099
114380         PERFORM DP013-0000-PROCESS-ABEND                         11438099
114390     END-IF.                                                      11439099
114400 EJECT                                                            11440099
114410*---------------------------------------------------------------* 11441099
114420*  CURSOR TO PULL BACK DATA BY PO NUMBER SELECTION                11442099
114430*---------------------------------------------------------------* 11443099
114440                                                                  11444099
114450 9900-LOAD-PO-DETAILS.                                            11445099
114460                                                                  11446099
114470     INITIALIZE PV-SCREEN-DATA-ITEMS                              11447099
114480     REPLACING NUMERIC BY ZEROS                                   11448099
114490               ALPHANUMERIC BY SPACES.                            11449099
114500     PERFORM                                                      11450099
114510         WITH TEST AFTER                                          11451099
114520         VARYING PV-RETRY-COUNTER                                 11452099
114530         FROM 1 BY 1                                              11453099
114540         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11454099
114550             OR (SQLCODE = +0)                                    11455099
114560             OR (SQLCODE = -811))                                 11456099
114570                                                                  11457099
114580         EXEC SQL                                                 11458099
114590                SELECT DISTINCT M.PO_NBR                          11459099
114600                      ,M.STATUS_CDE                               11460099
114610                      ,M.PO_TYP_CDE                               11461099
114620                      ,M.DEPT_NBR                                 11462099
114630                      ,M.ENT_ID                                   11463099
114640                      ,O.DONT_SHIP_BEF_DTE                        11464099
114650                      ,O.STRT_FCTRY_DTE                           11465099
114660                      ,O.LAST_FCTRY_DTE                           11466099
114670                      ,O.CAN_IFNOT_SHIP_DTE                       11467099
114680                      ,O.EXT_CAN_DTE                              11468099
114690                      ,O.FOB_CDE                                  11469099
114700                      ,O.POE_CDE                                  11470099
114710                      ,M.OTB_PER_NBR                              11471099
114720                      ,M.EDI_IND                                  11472099
114730                      ,M.PKGNG_CDE                                11473099
114740                      ,M.QTA_CTG_CDE                              11474099
114750                  INTO                                            11475099
114760                     :PURCHS-PO-NBR                               11476099
114770                    ,:PURCHS-STATUS-CDE                           11477099
114780                    ,:PURCHS-PO-TYP-CDE                           11478099
114790                    ,:PURCHS-DEPT-NBR                             11479099
114800                    ,:PURCHS-ENT-ID                               11480099
114810                    ,:PLNSHP-DONT-SHIP-BEF-DTE                    11481099
114820                    ,:PLNSHP-STRT-FCTRY-DTE                       11482099
114830                    ,:PLNSHP-LAST-FCTRY-DTE                       11483099
114840                    ,:PLNSHP-CAN-IFNOT-SHIP-DTE                   11484099
114850                    ,:PLNSHP-EXT-CAN-DTE                          11485099
114860                    ,:PLNSHP-FOB-CDE                              11486099
114870                    ,:PLNSHP-POE-CDE                              11487099
114880                    ,:PURCHS-OTB-PER-NBR                          11488099
114890                    ,:PURCHS-EDI-IND                              11489099
114900                    ,:PURCHS-PKGNG-CDE                            11490099
114910                    ,:PURCHS-QTA-CTG-CDE                          11491099
114920                  FROM   TPURCHS M                                11492099
114930                        ,TPLNSHP O                                11493099
114940                  WHERE  M.PO_NBR = :DK-PO-NBR                    11494099
114950                  AND    M.PO_NBR  = O.PO_NBR                     11495099
114960                  AND    M.VER_STATUS_CDE  = 'A'                  11496099
114970                  AND    O.VER_STATUS_CDE  = 'A'                  11497099
114980         END-EXEC                                                 11498099
114990                                                                  11499099
115000         EVALUATE TRUE                                            11500099
115010          WHEN SQLCODE = +0                                       11501099
115020          WHEN SQLCODE = -811                                     11502099
115030           MOVE PURCHS-DEPT-NBR           TO PV-DEPT              11503099
115040          WHEN SQLCODE = +100                                     11504099
115050          WHEN SQLCODE = -904                                     11505099
115060          WHEN SQLCODE = -913                                     11506099
115070               CONTINUE                                           11507099
115080          WHEN SQLWARN0 NOT = SPACES                              11508099
115090          WHEN SQLCODE < +0                                       11509099
115100          WHEN SQLCODE > +0                                       11510099
115110                  MOVE '9900-LOAD-PO-DETAILS'                     11511099
115120                                  TO DP013-PARAGRAPH              11512099
115130                  MOVE 'UNSUCCESSFUL FETCH OF PO DETAILS'         11513099
115140                                  TO DP013-MESSAGE-TEXT (1)       11514099
115150                  MOVE SQLCA      TO DP013-SQLCA                  11515099
115160                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     11516099
115170                  MOVE 'TPLNSHP ' TO DP013-DB2-TABLE-NAME (2)     11517099
115180                  SET DP013-DB2-ABEND                             11518099
115190                      DP013-XCTL-DISPLAY-RESTART                  11519099
115200                                  TO TRUE                         11520099
115210                  PERFORM DP013-0000-PROCESS-ABEND                11521099
115220         END-EVALUATE                                             11522099
115230     END-PERFORM.                                                 11523099
115240                                                                  11524099
115250     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11525099
115260         MOVE '9900-LOAD-PO-DETAILS'                              11526099
115270                                  TO DP013-PARAGRAPH              11527099
115280         MOVE 'UNSUCCESSFUL FETCH OF PO DETAILS'                  11528099
115290                                  TO DP013-MESSAGE-TEXT (1)       11529099
115300         MOVE SQLCA               TO DP013-SQLCA                  11530099
115310         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     11531099
115320         SET DP013-DB2-ABEND                                      11532099
115330             DP013-XCTL-DISPLAY-RESTART                           11533099
115340                                  TO TRUE                         11534099
115350         PERFORM DP013-0000-PROCESS-ABEND                         11535099
115360     END-IF.                                                      11536099
115370                                                                  11537099
115380 EJECT                                                            11538099
115390*----------------------------------------------------------------*11539099
115400*  DETERMINE TRIP TYPE FROM CUSTOMS PO TABLE                     *11540099
115410*----------------------------------------------------------------*11541099
115420 9905-LOAD-TRIP-TYPE-DATA.                                        11542099
115430                                                                  11543099
115440     PERFORM                                                      11544099
115450         WITH TEST AFTER                                          11545099
115460         VARYING PV-RETRY-COUNTER                                 11546099
115470         FROM 1 BY 1                                              11547099
115480         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11548099
115490             OR (SQLCODE = +100)                                  11549099
115500             OR (SQLCODE = -811)                                  11550099
115510             OR (SQLCODE = ZERO))                                 11551099
115520                                                                  11552099
115530     EXEC SQL                                                     11553099
115540          SELECT MIN(DATE(A.FILD_TMST))                           11554099
115550            INTO :PV-FILD-DATE:PV-FILD-DATE-NULL                  11555099
115560            FROM TIMCSEN A                                        11556099
115570                ,TIMCSPO B                                        11557099
115580           WHERE B.PO_NBR       = :DK-PO-NBR                      11558099
115590           AND   A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                  11559099
115600     END-EXEC                                                     11560099
115610                                                                  11561099
115620     EVALUATE TRUE                                                11562099
115630         WHEN SQLCODE = +0                                        11563099
115640         WHEN SQLCODE = -811                                      11564099
115650             IF PV-FILD-DATE > SPACES                             11565099
115660                 PERFORM 9906-LOAD-TRIP-TYPE-DATA-2               11566099
115670             ELSE                                                 11567099
115680                 PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1               11568099
115690             END-IF                                               11569099
115700         WHEN SQLCODE = +100                                      11570099
115710                 PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1               11571099
115720         WHEN SQLCODE = -904                                      11572099
115730         WHEN SQLCODE = -913                                      11573099
115740              CONTINUE                                            11574099
115750         WHEN SQLWARN0 NOT = SPACES                               11575099
115760         WHEN SQLCODE < +0                                        11576099
115770         WHEN SQLCODE > +0                                        11577099
115780              MOVE '9905-LOAD-TRIP-TYPE-DATA'                     11578099
115790                              TO DP013-PARAGRAPH                  11579099
115800              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11580099
115810                              TO DP013-MESSAGE-TEXT (1)           11581099
115820              MOVE SQLCA      TO DP013-SQLCA                      11582099
115830              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)         11583099
115840              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)         11584099
115850              SET DP013-DB2-ABEND                                 11585099
115860                  DP013-XCTL-DISPLAY-RESTART                      11586099
115870                              TO TRUE                             11587099
115880              PERFORM DP013-0000-PROCESS-ABEND                    11588099
115890     END-EVALUATE                                                 11589099
115900     END-PERFORM.                                                 11590099
115910                                                                  11591099
115920     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11592099
115930         MOVE '9905-LOAD-TRIP-TYPE-DATA' TO DP013-PARAGRAPH       11593099
115940         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11594099
115950                                   TO DP013-MESSAGE-TEXT (1)      11595099
115960         MOVE SQLCA                TO DP013-SQLCA                 11596099
115970         MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)              11597099
115980         MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)              11598099
115990         SET DP013-DB2-ABEND                                      11599099
116000             DP013-XCTL-DISPLAY-RESTART                           11600099
116010                                   TO TRUE                        11601099
116020         PERFORM DP013-0000-PROCESS-ABEND                         11602099
116030     END-IF.                                                      11603099
116040 EJECT                                                            11604099
116050*----------------------------------------------------------------*11605099
116060*  DETERMINE TRIP TYPE                                           *11606099
116070*----------------------------------------------------------------*11607099
116080 9906-LOAD-TRIP-TYPE-DATA-2.                                      11608099
116090                                                                  11609099
116100     PERFORM                                                      11610099
116110         WITH TEST AFTER                                          11611099
116120         VARYING PV-RETRY-COUNTER                                 11612099
116130         FROM 1 BY 1                                              11613099
116140         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11614099
116150             OR (SQLCODE = +100)                                  11615099
116160             OR (SQLCODE = -811)                                  11616099
116170             OR (SQLCODE = ZERO))                                 11617099
116180                                                                  11618099
116190     EXEC SQL                                                     11619099
116200          SELECT A.MOM_TRIP_TYP_CDE                               11620099
116210            INTO :PV-TRIP-TYP-CDE                                 11621099
116220            FROM TIMCSEN A                                        11622099
116230                ,TIMCSPO B                                        11623099
116240           WHERE B.PO_NBR             = :DK-PO-NBR                11624099
116250           AND   A.CSTM_ENTR_ID       = B.CSTM_ENTR_ID            11625099
116260           AND   DATE(A.FILD_TMST)    = :PV-FILD-DATE             11626099
116270     END-EXEC                                                     11627099
116280                                                                  11628099
116290     EVALUATE TRUE                                                11629099
116300         WHEN SQLCODE = +0                                        11630099
116310         WHEN SQLCODE = -811                                      11631099
116320             IF PV-TRIP-TYP-CDE = PC-A                            11632099
116330                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL              11633099
116340             ELSE                                                 11634099
116350                 IF PV-TRIP-TYP-CDE = PC-O                        11635099
116360                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL        11636099
116370                 ELSE                                             11637099
116380                     PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1           11638099
116390                 END-IF                                           11639099
116400             END-IF                                               11640099
116410         WHEN SQLCODE = +100                                      11641099
116420         WHEN SQLCODE = -904                                      11642099
116430         WHEN SQLCODE = -913                                      11643099
116440              CONTINUE                                            11644099
116450         WHEN SQLWARN0 NOT = SPACES                               11645099
116460         WHEN SQLCODE < +0                                        11646099
116470         WHEN SQLCODE > +0                                        11647099
116480              MOVE '9906-LOAD-TRIP-TYPE-DATA-2'                   11648099
116490                              TO DP013-PARAGRAPH                  11649099
116500              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11650099
116510                              TO DP013-MESSAGE-TEXT (1)           11651099
116520              MOVE SQLCA      TO DP013-SQLCA                      11652099
116530              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)         11653099
116540              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)         11654099
116550              SET DP013-DB2-ABEND                                 11655099
116560                  DP013-XCTL-DISPLAY-RESTART                      11656099
116570                              TO TRUE                             11657099
116580              PERFORM DP013-0000-PROCESS-ABEND                    11658099
116590     END-EVALUATE                                                 11659099
116600     END-PERFORM.                                                 11660099
116610                                                                  11661099
116620     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11662099
116630         MOVE '9906-LOAD-TRIP-TYPE-DATA-2' TO DP013-PARAGRAPH     11663099
116640         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11664099
116650                                   TO DP013-MESSAGE-TEXT (1)      11665099
116660         MOVE SQLCA                TO DP013-SQLCA                 11666099
116670         MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)              11667099
116680         MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)              11668099
116690         SET DP013-DB2-ABEND                                      11669099
116700             DP013-XCTL-DISPLAY-RESTART                           11670099
116710                                   TO TRUE                        11671099
116720         PERFORM DP013-0000-PROCESS-ABEND                         11672099
116730     END-IF.                                                      11673099
116740 EJECT                                                            11674099
116750*----------------------------------------------------------------*11675099
116760*  DETERMINE TRIP TYPE FROM CONTAINER TABLE                      *11676099
116770*----------------------------------------------------------------*11677099
116780 9907-LOAD-TRIP-TYPE-CNTR-1.                                      11678099
116790                                                                  11679099
116800     PERFORM                                                      11680099
116810         WITH TEST AFTER                                          11681099
116820         VARYING PV-RETRY-COUNTER                                 11682099
116830         FROM 1 BY 1                                              11683099
116840         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11684099
116850             OR (SQLCODE = +100)                                  11685099
116860             OR (SQLCODE = -811)                                  11686099
116870             OR (SQLCODE = ZERO))                                 11687099
116880                                                                  11688099
116890     EXEC SQL                                                     11689099
116900          SELECT MIN(DATE(A.MOM_DPRTR_TMST))                      11690099
116910               , MIN(DATE(A.FDR_DPRTR_TMST))                      11691099
116920            INTO :PV-MOM-DPRTR-DATE:PV-MOM-DPRTR-DATE-NULL        11692099
116930               , :PV-FDR-DPRTR-DATE:PV-FDR-DPRTR-DATE-NULL        11693099
116940            FROM TIMCNTK A                                        11694099
116950                ,TIMCNPO B                                        11695099
116960           WHERE B.PO_NBR         = :DK-PO-NBR                    11696099
116970           AND   A.CONTNR_ID      = B.CONTNR_ID                   11697099
116980           AND   A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR              11698099
116990     END-EXEC                                                     11699099
117000                                                                  11700099
117010     EVALUATE TRUE                                                11701099
117020         WHEN SQLCODE = +0                                        11702099
117030         WHEN SQLCODE = -811                                      11703099
117040                 IF (PV-MOM-DPRTR-DATE > '0001-01-01' AND         11704099
117050                     PV-FDR-DPRTR-DATE = '0001-01-01')       OR   11705099
117060                    (PV-MOM-DPRTR-DATE > '0001-01-01' AND         11706099
117070                     PV-MOM-DPRTR-DATE < PV-FDR-DPRTR-DATE)       11707099
117080                      PERFORM 9908-LOAD-TRIP-TYPE-CNTR-2          11708099
117090                 ELSE                                             11709099
117100                 IF (PV-FDR-DPRTR-DATE > '0001-01-01' AND         11710099
117110                     PV-MOM-DPRTR-DATE = '0001-01-01')       OR   11711099
117120                    (PV-FDR-DPRTR-DATE > '0001-01-01' AND         11712099
117130                     PV-FDR-DPRTR-DATE < PV-MOM-DPRTR-DATE)       11713099
117140                      PERFORM 9909-LOAD-TRIP-TYPE-CNTR-3          11714099
117150                 ELSE                                             11715099
117160                 IF (PV-MOM-DPRTR-DATE = '0001-01-01' AND         11716099
117170                     PV-FDR-DPRTR-DATE = '0001-01-01')            11717099
117180                      MOVE SPACES TO PV-TRIP-TYP-CDE-FULL         11718099
117190                 END-IF                                           11719099
117200                 END-IF                                           11720099
117210                 END-IF                                           11721099
117220         WHEN SQLCODE = +100                                      11722099
117230             MOVE SPACES TO PV-TRIP-TYP-CDE-FULL                  11723099
117240         WHEN SQLCODE = -904                                      11724099
117250         WHEN SQLCODE = -913                                      11725099
117260              CONTINUE                                            11726099
117270         WHEN SQLWARN0 NOT = SPACES                               11727099
117280         WHEN SQLCODE < +0                                        11728099
117290         WHEN SQLCODE > +0                                        11729099
117300              MOVE '9907-LOAD-TRIP-TYPE-CNTR-1'                   11730099
117310                              TO DP013-PARAGRAPH                  11731099
117320              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11732099
117330                              TO DP013-MESSAGE-TEXT (1)           11733099
117340              MOVE SQLCA      TO DP013-SQLCA                      11734099
117350              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)         11735099
117360              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)         11736099
117370              SET DP013-DB2-ABEND                                 11737099
117380                  DP013-XCTL-DISPLAY-RESTART                      11738099
117390                              TO TRUE                             11739099
117400              PERFORM DP013-0000-PROCESS-ABEND                    11740099
117410     END-EVALUATE                                                 11741099
117420     END-PERFORM.                                                 11742099
117430*                                                                 11743099
117440     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11744099
117450         MOVE '9907-LOAD-TRIP-TYPE-CNTR-1' TO DP013-PARAGRAPH     11745099
117460         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11746099
117470                                   TO DP013-MESSAGE-TEXT (1)      11747099
117480         MOVE SQLCA                TO DP013-SQLCA                 11748099
117490         MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)              11749099
117500         MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)              11750099
117510         SET DP013-DB2-ABEND                                      11751099
117520             DP013-XCTL-DISPLAY-RESTART                           11752099
117530                                   TO TRUE                        11753099
117540         PERFORM DP013-0000-PROCESS-ABEND                         11754099
117550     END-IF.                                                      11755099
117560 EJECT                                                            11756099
117570*----------------------------------------------------------------*11757099
117580*  DETERMINE TRIP TYPE                                           *11758099
117590*----------------------------------------------------------------*11759099
117600 9908-LOAD-TRIP-TYPE-CNTR-2.                                      11760099
117610                                                                  11761099
117620     PERFORM                                                      11762099
117630         WITH TEST AFTER                                          11763099
117640         VARYING PV-RETRY-COUNTER                                 11764099
117650         FROM 1 BY 1                                              11765099
117660         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11766099
117670             OR (SQLCODE = +100)                                  11767099
117680             OR (SQLCODE = -811)                                  11768099
117690             OR (SQLCODE = ZERO))                                 11769099
117700                                                                  11770099
117710     EXEC SQL                                                     11771099
117720          SELECT A.MOM_TRIP_TYP_CDE                               11772099
117730            INTO :PV-TRIP-TYP-CDE                                 11773099
117740            FROM TIMCNTK A                                        11774099
117750                ,TIMCNPO B                                        11775099
117760           WHERE B.PO_NBR               = :DK-PO-NBR              11776099
117770           AND   A.CONTNR_ID            = B.CONTNR_ID             11777099
117780           AND   A.CONTNR_SEQ_NBR       = B.CONTNR_SEQ_NBR        11778099
117790           AND   DATE(A.MOM_DPRTR_TMST) = :PV-MOM-DPRTR-DATE      11779099
117800     END-EXEC                                                     11780099
117810                                                                  11781099
117820     EVALUATE TRUE                                                11782099
117830         WHEN SQLCODE = +0                                        11783099
117840         WHEN SQLCODE = -811                                      11784099
117850             IF PV-TRIP-TYP-CDE = PC-A                            11785099
117860                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL              11786099
117870             ELSE                                                 11787099
117880                 IF PV-TRIP-TYP-CDE = PC-O                        11788099
117890                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL        11789099
117900                 ELSE                                             11790099
117910                     MOVE SPACES TO PV-TRIP-TYP-CDE-FULL          11791099
117920                 END-IF                                           11792099
117930             END-IF                                               11793099
117940         WHEN SQLCODE = +100                                      11794099
117950         WHEN SQLCODE = -904                                      11795099
117960         WHEN SQLCODE = -913                                      11796099
117970              CONTINUE                                            11797099
117980         WHEN SQLWARN0 NOT = SPACES                               11798099
117990         WHEN SQLCODE < +0                                        11799099
118000         WHEN SQLCODE > +0                                        11800099
118010              MOVE '9908-LOAD-TRIP-TYPE-CNTR-2'                   11801099
118020                              TO DP013-PARAGRAPH                  11802099
118030              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11803099
118040                              TO DP013-MESSAGE-TEXT (1)           11804099
118050              MOVE SQLCA      TO DP013-SQLCA                      11805099
118060              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)         11806099
118070              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)         11807099
118080              SET DP013-DB2-ABEND                                 11808099
118090                  DP013-XCTL-DISPLAY-RESTART                      11809099
118100                              TO TRUE                             11810099
118110              PERFORM DP013-0000-PROCESS-ABEND                    11811099
118120     END-EVALUATE                                                 11812099
118130     END-PERFORM.                                                 11813099
118140*                                                                 11814099
118150     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11815099
118160         MOVE '9908-LOAD-TRIP-TYPE-CNTR-2' TO DP013-PARAGRAPH     11816099
118170         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11817099
118180                                   TO DP013-MESSAGE-TEXT (1)      11818099
118190         MOVE SQLCA                TO DP013-SQLCA                 11819099
118200         MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)              11820099
118210         MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)              11821099
118220         SET DP013-DB2-ABEND                                      11822099
118230             DP013-XCTL-DISPLAY-RESTART                           11823099
118240                                   TO TRUE                        11824099
118250         PERFORM DP013-0000-PROCESS-ABEND                         11825099
118260     END-IF.                                                      11826099
118270 EJECT                                                            11827099
118280*----------------------------------------------------------------*11828099
118290*  DETERMINE TRIP TYPE                                           *11829099
118300*----------------------------------------------------------------*11830099
118310 9909-LOAD-TRIP-TYPE-CNTR-3.                                      11831099
118320                                                                  11832099
118330     PERFORM                                                      11833099
118340         WITH TEST AFTER                                          11834099
118350         VARYING PV-RETRY-COUNTER                                 11835099
118360         FROM 1 BY 1                                              11836099
118370         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11837099
118380             OR (SQLCODE = +100)                                  11838099
118390             OR (SQLCODE = -811)                                  11839099
118400             OR (SQLCODE = ZERO))                                 11840099
118410                                                                  11841099
118420     EXEC SQL                                                     11842099
118430          SELECT A.FDR_TRIP_TYP_CDE                               11843099
118440            INTO :PV-TRIP-TYP-CDE                                 11844099
118450            FROM TIMCNTK A                                        11845099
118460                ,TIMCNPO B                                        11846099
118470           WHERE B.PO_NBR               = :DK-PO-NBR              11847099
118480           AND   A.CONTNR_ID            = B.CONTNR_ID             11848099
118490           AND   A.CONTNR_SEQ_NBR       = B.CONTNR_SEQ_NBR        11849099
118500           AND   DATE(A.FDR_DPRTR_TMST) = :PV-FDR-DPRTR-DATE      11850099
118510     END-EXEC                                                     11851099
118520                                                                  11852099
118530     EVALUATE TRUE                                                11853099
118540         WHEN SQLCODE = +0                                        11854099
118550         WHEN SQLCODE = -811                                      11855099
118560             IF PV-TRIP-TYP-CDE = PC-A                            11856099
118570                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL              11857099
118580             ELSE                                                 11858099
118590                 IF PV-TRIP-TYP-CDE = PC-O                        11859099
118600                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL        11860099
118610                 ELSE                                             11861099
118620                     MOVE SPACES TO PV-TRIP-TYP-CDE-FULL          11862099
118630                 END-IF                                           11863099
118640             END-IF                                               11864099
118650         WHEN SQLCODE = +100                                      11865099
118660         WHEN SQLCODE = -904                                      11866099
118670         WHEN SQLCODE = -913                                      11867099
118680              CONTINUE                                            11868099
118690         WHEN SQLWARN0 NOT = SPACES                               11869099
118700         WHEN SQLCODE < +0                                        11870099
118710         WHEN SQLCODE > +0                                        11871099
118720              MOVE '9909-LOAD-TRIP-TYPE-CNTR-3'                   11872099
118730                              TO DP013-PARAGRAPH                  11873099
118740              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               11874099
118750                              TO DP013-MESSAGE-TEXT (1)           11875099
118760              MOVE SQLCA      TO DP013-SQLCA                      11876099
118770              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)         11877099
118780              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)         11878099
118790              SET DP013-DB2-ABEND                                 11879099
118800                  DP013-XCTL-DISPLAY-RESTART                      11880099
118810                              TO TRUE                             11881099
118820              PERFORM DP013-0000-PROCESS-ABEND                    11882099
118830     END-EVALUATE                                                 11883099
118840     END-PERFORM.                                                 11884099
118850*                                                                 11885099
118860     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11886099
118870         MOVE '9909-LOAD-TRIP-TYPE-CNTR-3' TO DP013-PARAGRAPH     11887099
118880         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11888099
118890                                   TO DP013-MESSAGE-TEXT (1)      11889099
118900         MOVE SQLCA                TO DP013-SQLCA                 11890099
118910         MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)              11891099
118920         MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)              11892099
118930         SET DP013-DB2-ABEND                                      11893099
118940             DP013-XCTL-DISPLAY-RESTART                           11894099
118950                                   TO TRUE                        11895099
118960         PERFORM DP013-0000-PROCESS-ABEND                         11896099
118970     END-IF.                                                      11897099
118980 EJECT                                                            11898099
118990*----------------------------------------------------------------*11899099
119000* GET THE VENDOR SHORT NAME                                      *11900099
119010*----------------------------------------------------------------*11901099
119020                                                                  11902099
119030 9910-GET-VENDOR-SHORT-NAME.                                      11903099
119040                                                                  11904099
119050     EXEC SQL                                                     11905099
119060         SELECT ENT_NAME_DESC                                     11906099
119070              , ENT_ID                                            11907099
119080          INTO  :ENTNME-ENT-NAME-DESC                             11908099
119090              , :ENTNME-ENT-ID                                    11909099
119100          FROM  TENTNME                                           11910099
119110          WHERE ENT_ID   = :PURCHS-ENT-ID                         11911099
119120            AND TYPE_CDE = '04'                                   11912099
119130     END-EXEC.                                                    11913099
119140                                                                  11914099
119150     EVALUATE TRUE                                                11915099
119160         WHEN SQLCODE = +0                                        11916099
119170         WHEN SQLCODE = +100                                      11917099
119180         WHEN SQLCODE = -904                                      11918099
119190         WHEN SQLCODE = -913                                      11919099
119200             CONTINUE                                             11920099
119210         WHEN SQLWARN0 NOT = SPACE                                11921099
119220         WHEN SQLCODE < +0                                        11922099
119230         WHEN SQLCODE > +0                                        11923099
119240             MOVE '9910-GET-VENDOR-SHORT-NAME'                    11924099
119250                                 TO DP013-PARAGRAPH               11925099
119260             MOVE 'SELECT ON ENTERPRISE NAME TABLE'               11926099
119270                                 TO DP013-MESSAGE-TEXT (1)        11927099
119280             MOVE SQLCA          TO DP013-SQLCA                   11928099
119290             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)      11929099
119300                 SET DP013-DB2-ABEND                              11930099
119310                     DP013-XCTL-DISPLAY-RESTART                   11931099
119320                                 TO TRUE                          11932099
119330             PERFORM DP013-0000-PROCESS-ABEND                     11933099
119340     END-EVALUATE.                                                11934099
119350 EJECT                                                            11935099
119360*----------------------------------------------------------------*11936099
119370*  DETERMINE DC SPLITS CREATE DATE                               *11937099
119380*----------------------------------------------------------------*11938099
119390 9912-LOAD-DC-SPLIT-CREATE-DATE.                                  11939099
119400                                                                  11940099
119410     PERFORM 9925-OPEN-DC-SPLITS-CURSOR.                          11941099
119420     SET PS-EOC-DC-SPLITS-NO TO TRUE.                             11942099
119430     SET PS-DISPLAY-DC-SPLITS TO TRUE.                            11943099
119440     INITIALIZE PV-TOTAL-CURR-SPLIT-QTY                           11944099
119450                PV-TOTAL-CURR-SPLIT-QTY-NULL.                     11945099
119460     PERFORM 9913-PROCESS-DC-SPLIT-CRT-DATE                       11946099
119470         UNTIL PS-EOC-DC-SPLITS OR                                11947099
119480               PS-DISPLAY-DC-SPLITS-NO.                           11948099
119490                                                                  11949099
119500     PERFORM 9926-CLOSE-DC-SPLITS-CURSOR.                         11950099
119510                                                                  11951099
119520     IF PS-DISPLAY-DC-SPLITS                                      11952099
119530         PERFORM 9915-SELECT-DC-SPLIT-CRT-DATE                    11953099
119540     END-IF.                                                      11954099
119550                                                                  11955099
119560*----------------------------------------------------------------*11956099
119570*  DETERMINE DC SPLITS CREATE DATE                               *11957099
119580*----------------------------------------------------------------*11958099
119590 9913-PROCESS-DC-SPLIT-CRT-DATE.                                  11959099
119600                                                                  11960099
119610     PERFORM 9927-FETCH-DC-SPLITS-CURSOR.                         11961099
119620                                                                  11962099
119630     IF PS-EOC-DC-SPLITS                                          11963099
119640*        *******************************************              11964099
119650*        *  BELOW 'IF' CHECKS TO SEE IF YOU'VE HIT *              11965099
119660*        *  EOC ON THE FIRST FETCH OF TH DC CURSOR *              11966099
119670*        *  WHICH MEANS THERE ARE NO SPLITS, OR    *              11967099
119680*        *  THE LINE STATUSES ARE ALL INVALID.     *              11968099
119690*        *******************************************              11969099
119700         IF PV-TOTAL-CURR-SPLIT-QTY = ZERO                        11970099
119710            SET PS-DISPLAY-DC-SPLITS-NO TO TRUE                   11971099
119720         END-IF                                                   11972099
119730     ELSE                                                         11973099
119740         PERFORM 9914-SUM-TALLPLN-LINES                           11974099
119750     END-IF.                                                      11975099
119760                                                                  11976099
119770*----------------------------------------------------------------*11977099
119780*  SUMMARY OF TALLPLN LINES FOR DC SPLITS CREATE DATE            *11978099
119790*----------------------------------------------------------------*11979099
119800 9914-SUM-TALLPLN-LINES.                                          11980099
119810                                                                  11981099
119820     EXEC SQL                                                     11982099
119830           SELECT                                                 11983099
119840                  SUM (A.CURR_SPLIT_QTY)                          11984099
119850             INTO                                                 11985099
119860            :PV-TOTAL-CURR-SPLIT-QTY:PV-TOTAL-CURR-SPLIT-QTY-NULL 11986099
119870             FROM                                                 11987099
119880                  TALLPLN   A                                     11988099
119890             WHERE A.PO_NBR         = :DK-PO-NBR                  11989099
119900               AND A.PO_LNE_NBR     = :PURITM-PO-LNE-NBR          11990099
119910     END-EXEC                                                     11991099
119920                                                                  11992099
119930     EVALUATE TRUE                                                11993099
119940         WHEN SQLCODE = ZERO                                      11994099
119950             IF PV-TOTAL-CURR-SPLIT-QTY = ZERO                    11995099
119960                 SET PS-DISPLAY-DC-SPLITS-NO TO TRUE              11996099
119970             END-IF                                               11997099
119980                                                                  11998099
119990         WHEN SQLCODE = +100                                      11999099
120000             SET PS-DISPLAY-DC-SPLITS-NO TO TRUE                  12000099
120010                                                                  12001099
120020         WHEN SQLWARN0 NOT = SPACES                               12002099
120030         WHEN SQLCODE < ZERO                                      12003099
120040         WHEN SQLCODE > ZERO                                      12004099
120050             MOVE '9914-SUM-TALLPLN-LINES'                        12005099
120060                               TO DP013-PARAGRAPH                 12006099
120070             MOVE 'SUM DATE'   TO DP013-MESSAGE-TEXT (1)          12007099
120080             MOVE SQLCA        TO DP013-SQLCA                     12008099
120090             MOVE 'TALLPLN'      TO DP013-DB2-TABLE-NAME (1)      12009099
120100             SET DP013-DB2-ABEND                                  12010099
120110                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12011099
120120             PERFORM DP013-0000-PROCESS-ABEND                     12012099
120130     END-EVALUATE.                                                12013099
120140                                                                  12014099
120150*----------------------------------------------------------------*12015099
120160*  SELECT DC SPLITS CREATE DATE                                  *12016099
120170*----------------------------------------------------------------*12017099
120180 9915-SELECT-DC-SPLIT-CRT-DATE.                                   12018099
120190                                                                  12019099
120200     PERFORM                                                      12020099
120210         WITH TEST AFTER                                          12021099
120220         VARYING PV-RETRY-COUNTER                                 12022099
120230         FROM 1 BY 1                                              12023099
120240         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12024099
120250             OR (SQLCODE = -811)                                  12025099
120260             OR (SQLCODE = +100)                                  12026099
120270             OR (SQLCODE = ZERO))                                 12027099
120280*                                                                 12028099
120290         EXEC SQL                                                 12029099
120300             SELECT MAX(DATE(SPLIT_CRE_DATE))                     12030099
120310             INTO                                                 12031099
120320               :PV-SPL-CRE-DT                                     12032099
120330               :PV-SPL-CRE-DT-NULL                                12033099
120340             FROM   TALLPLN                                       12034099
120350             WHERE  PO_NBR IN (:DK-PO-NBR)                        12035099
120360             AND    DATE(SPLIT_CRE_DATE) <>                       12036099
120370                                '0001-01-01'                      12037099
120380         END-EXEC                                                 12038099
120390*                                                                 12039099
120400     EVALUATE TRUE                                                12040099
120410         WHEN SQLCODE = ZERO                                      12041099
120420         WHEN SQLCODE = -811                                      12042099
120430             IF PV-SPL-CRE-DT-NULL = 0                            12043099
120440              AND PV-SPL-CRE-DT NOT = '0001-01-01'                12044099
120450                MOVE PV-SPL-CRE-DT (1:4) TO                       12045099
120460                              PV-SM-SPL-CRT-DT(1:4)               12046099
120470                MOVE PV-SPL-CRE-DT (6:2) TO                       12047099
120480                              PV-SM-SPL-CRT-DT(5:2)               12048099
120490                MOVE PV-SPL-CRE-DT (9:2) TO                       12049099
120500                              PV-SM-SPL-CRT-DT(7:2)               12050099
120510             END-IF                                               12051099
120520         WHEN SQLWARN0 NOT = SPACES                               12052099
120530         WHEN SQLCODE < ZERO                                      12053099
120540         WHEN SQLCODE > ZERO                                      12054099
120550             MOVE '9915-SELECT-DC-SPLIT-CRT-DATE'                 12055099
120560                               TO DP013-PARAGRAPH                 12056099
120570             MOVE 'SELECT DATA'                                   12057099
120580                               TO DP013-MESSAGE-TEXT (1)          12058099
120590             MOVE SQLCA        TO DP013-SQLCA                     12059099
120600             MOVE 'TALLPLN'      TO DP013-DB2-TABLE-NAME (1)      12060099
120610             SET DP013-DB2-ABEND                                  12061099
120620                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12062099
120630             PERFORM DP013-0000-PROCESS-ABEND                     12063099
120640     END-EVALUATE                                                 12064099
120650     END-PERFORM.                                                 12065099
120660*                                                                 12066099
120670     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12067099
120680         MOVE '9915-SELECT-DC-SPLIT-CRT-DATE'                     12068099
120690                               TO DP013-PARAGRAPH                 12069099
120700         MOVE 'SELECT DATA'                                       12070099
120710                           TO DP013-MESSAGE-TEXT (1)              12071099
120720         MOVE SQLCA        TO DP013-SQLCA                         12072099
120730         MOVE 'TALLPLN'    TO DP013-DB2-TABLE-NAME (1)            12073099
120740         SET DP013-DB2-ABEND                                      12074099
120750             DP013-XCTL-DISPLAY-RESTART                           12075099
120760                                   TO TRUE                        12076099
120770         PERFORM DP013-0000-PROCESS-ABEND                         12077099
120780     END-IF.                                                      12078099
120790 EJECT                                                            12079099
120800*----------------------------------------------------------------*12080099
120810*  SELECT DC SPLITS CREATE DATE                                  *12081099
120820*----------------------------------------------------------------*12082099
120830 9917-LOAD-DC-SPLIT-SENT-DATE.                                    12083099
120840                                                                  12084099
120850     PERFORM 9918-GET-DC-SPLIT-ORDR-SNT-DTE.                      12085099
120860     PERFORM 9919-GET-DC-SPLIT-SHPT-SNT-DTE.                      12086099
120870     PERFORM 9919A-CHECK-AUDIT-DATES.                             12087099
120880     IF  PV-ORD-SPL-SNT-DT     = '9999-09-09'                     12088099
120890     AND PV-SHPT-SPL-SNT-DT    = '9999-09-09'                     12089099
120900     AND PV-SHPT-SPL-AUD-DT    = '9999-09-09'                     12090099
120910         MOVE SPACES TO PV-SM-SPL-SNT-DT                          12091099
120920     ELSE                                                         12092099
120930         IF PV-ORD-SPL-SNT-DT <= PV-SHPT-SPL-SNT-DT               12093099
120940             IF PV-ORD-SPL-SNT-DT <= PV-SHPT-SPL-AUD-DT           12094099
120950                 MOVE PV-ORD-SPL-SNT-DT (1:4) TO                  12095099
120960                               PV-SM-SPL-SNT-DT(1:4)              12096099
120970                 MOVE PV-ORD-SPL-SNT-DT (6:2) TO                  12097099
120980                               PV-SM-SPL-SNT-DT(5:2)              12098099
120990                 MOVE PV-ORD-SPL-SNT-DT (9:2) TO                  12099099
121000                               PV-SM-SPL-SNT-DT(7:2)              12100099
121010             ELSE                                                 12101099
121020                 MOVE PV-SHPT-SPL-AUD-DT (1:4) TO                 12102099
121030                               PV-SM-SPL-SNT-DT(1:4)              12103099
121040                 MOVE PV-SHPT-SPL-AUD-DT (6:2) TO                 12104099
121050                               PV-SM-SPL-SNT-DT(5:2)              12105099
121060                 MOVE PV-SHPT-SPL-AUD-DT (9:2) TO                 12106099
121070                               PV-SM-SPL-SNT-DT(7:2)              12107099
121080                 IF PV-SM-SPL-SNT-DT = '9999-09-09'               12108099
121090                    MOVE SPACES TO PV-SM-SPL-SNT-DT               12109099
121100                 END-IF                                           12110099
121110             END-IF                                               12111099
121120         ELSE                                                     12112099
121130             IF PV-SHPT-SPL-SNT-DT <= PV-SHPT-SPL-AUD-DT          12113099
121140                 MOVE PV-SHPT-SPL-SNT-DT (1:4) TO                 12114099
121150                               PV-SM-SPL-SNT-DT(1:4)              12115099
121160                 MOVE PV-SHPT-SPL-SNT-DT (6:2) TO                 12116099
121170                               PV-SM-SPL-SNT-DT(5:2)              12117099
121180                 MOVE PV-SHPT-SPL-SNT-DT (9:2) TO                 12118099
121190                               PV-SM-SPL-SNT-DT(7:2)              12119099
121200             ELSE                                                 12120099
121210                 MOVE PV-SHPT-SPL-AUD-DT (1:4) TO                 12121099
121220                               PV-SM-SPL-SNT-DT(1:4)              12122099
121230                 MOVE PV-SHPT-SPL-AUD-DT (6:2) TO                 12123099
121240                               PV-SM-SPL-SNT-DT(5:2)              12124099
121250                 MOVE PV-SHPT-SPL-AUD-DT (9:2) TO                 12125099
121260                               PV-SM-SPL-SNT-DT(7:2)              12126099
121270                 IF PV-SM-SPL-SNT-DT = '9999-09-09'               12127099
121280                    MOVE SPACES TO PV-SM-SPL-SNT-DT               12128099
121290                 END-IF                                           12129099
121300             END-IF                                               12130099
121310         END-IF                                                   12131099
121320     END-IF.                                                      12132099
121330*----------------------------------------------------------------*12133099
121340*  DETERMINE DC SPLITS ORDR SENT DATE                            *12134099
121350*----------------------------------------------------------------*12135099
121360 9918-GET-DC-SPLIT-ORDR-SNT-DTE.                                  12136099
121370                                                                  12137099
121380     PERFORM                                                      12138099
121390         WITH TEST AFTER                                          12139099
121400         VARYING PV-RETRY-COUNTER                                 12140099
121410         FROM 1 BY 1                                              12141099
121420         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12142099
121430             OR (SQLCODE = -811)                                  12143099
121440             OR (SQLCODE = +100)                                  12144099
121450             OR (SQLCODE = ZERO))                                 12145099
121460*                                                                 12146099
121470         EXEC SQL                                                 12147099
121480             SELECT MIN(DATE(DCONSLR_ACTL_DTE))                   12148099
121490             INTO                                                 12149099
121500               :PV-ORD-SPL-SNT-DT                                 12150099
121510               :PV-ORD-SPL-SNT-DT-NULL                            12151099
121520             FROM   TIMPORL                                       12152099
121530             WHERE  PO_NBR IN (:DK-PO-NBR)                        12153099
121540             AND    VER_STATUS_CDE   = 'A'                        12154099
121550             AND    DCONSLR_RLSE_CDE IN(:PC-R, :PC-Y)             12155099
121560             AND    DATE(DCONSLR_ACTL_DTE)   <>                   12156099
121570                                '9999-09-09'                      12157099
121580         END-EXEC                                                 12158099
121590*                                                                 12159099
121600     EVALUATE TRUE                                                12160099
121610         WHEN SQLCODE = ZERO                                      12161099
121620         WHEN SQLCODE = -811                                      12162099
121630             IF PV-ORD-SPL-SNT-DT-NULL = 0                        12163099
121640              AND PV-ORD-SPL-SNT-DT NOT = '9999-09-09'            12164099
121650                NEXT SENTENCE                                     12165099
121660             ELSE                                                 12166099
121670                MOVE '9999-09-09' TO PV-ORD-SPL-SNT-DT            12167099
121680             END-IF                                               12168099
121690         WHEN SQLWARN0 NOT = SPACES                               12169099
121700         WHEN SQLCODE < ZERO                                      12170099
121710         WHEN SQLCODE > ZERO                                      12171099
121720             MOVE '9918-LOAD-DC-SPLIT-ORDR-SNT-DTE'               12172099
121730                               TO DP013-PARAGRAPH                 12173099
121740             MOVE 'SELECT DATA'                                   12174099
121750                               TO DP013-MESSAGE-TEXT (1)          12175099
121760             MOVE SQLCA        TO DP013-SQLCA                     12176099
121770             MOVE 'TIMPORL'      TO DP013-DB2-TABLE-NAME (1)      12177099
121780             SET DP013-DB2-ABEND                                  12178099
121790                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12179099
121800             PERFORM DP013-0000-PROCESS-ABEND                     12180099
121810     END-EVALUATE                                                 12181099
121820     END-PERFORM.                                                 12182099
121830*                                                                 12183099
121840     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12184099
121850         MOVE '9918-LOAD-DC-SPLIT-ORDR-SNT-DTE'                   12185099
121860                               TO DP013-PARAGRAPH                 12186099
121870         MOVE 'SELECT DATA'                                       12187099
121880                           TO DP013-MESSAGE-TEXT (1)              12188099
121890         MOVE SQLCA        TO DP013-SQLCA                         12189099
121900         MOVE 'TIMPORL'    TO DP013-DB2-TABLE-NAME (1)            12190099
121910         SET DP013-DB2-ABEND                                      12191099
121920             DP013-XCTL-DISPLAY-RESTART                           12192099
121930                                   TO TRUE                        12193099
121940         PERFORM DP013-0000-PROCESS-ABEND                         12194099
121950     END-IF.                                                      12195099
121960 EJECT                                                            12196099
121970*----------------------------------------------------------------*12197099
121980*  DETERMINE DC SPLITS SHPT SENT DATE                            *12198099
121990*----------------------------------------------------------------*12199099
122000 9919-GET-DC-SPLIT-SHPT-SNT-DTE.                                  12200099
122010                                                                  12201099
122020     PERFORM                                                      12202099
122030         WITH TEST AFTER                                          12203099
122040         VARYING PV-RETRY-COUNTER                                 12204099
122050         FROM 1 BY 1                                              12205099
122060         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12206099
122070             OR (SQLCODE = -811)                                  12207099
122080             OR (SQLCODE = +100)                                  12208099
122090             OR (SQLCODE = ZERO))                                 12209099
122100*                                                                 12210099
122110         EXEC SQL                                                 12211099
122120             SELECT MIN(DATE(DCONSLR_ACTL_DTE))                   12212099
122130             INTO                                                 12213099
122140               :PV-SHPT-SPL-SNT-DT                                12214099
122150               :PV-SHPT-SPL-SNT-DT-NULL                           12215099
122160             FROM   TIMCNRL                                       12216099
122170             WHERE  PO_NBR IN (:DK-PO-NBR)                        12217099
122180             AND    DCONSLR_RLSE_CDE IN(:PC-R, :PC-Y)             12218099
122190             AND    DATE(DCONSLR_ACTL_DTE)   <>                   12219099
122200                                '9999-09-09'                      12220099
122210         END-EXEC                                                 12221099
122220*                                                                 12222099
122230     EVALUATE TRUE                                                12223099
122240         WHEN SQLCODE = ZERO                                      12224099
122250         WHEN SQLCODE = -811                                      12225099
122260             IF PV-SHPT-SPL-SNT-DT-NULL = 0                       12226099
122270              AND PV-SHPT-SPL-SNT-DT NOT = '9999-09-09'           12227099
122280                NEXT SENTENCE                                     12228099
122290             ELSE                                                 12229099
122300                MOVE '9999-09-09' TO PV-SHPT-SPL-SNT-DT           12230099
122310             END-IF                                               12231099
122320         WHEN SQLWARN0 NOT = SPACES                               12232099
122330         WHEN SQLCODE < ZERO                                      12233099
122340         WHEN SQLCODE > ZERO                                      12234099
122350             MOVE '9919-LOAD-DC-SPLIT-SHPT-SNT-DTE'               12235099
122360                               TO DP013-PARAGRAPH                 12236099
122370             MOVE 'SELECT DATA'                                   12237099
122380                               TO DP013-MESSAGE-TEXT (1)          12238099
122390             MOVE SQLCA        TO DP013-SQLCA                     12239099
122400             MOVE 'TIMCNRL'      TO DP013-DB2-TABLE-NAME (1)      12240099
122410             SET DP013-DB2-ABEND                                  12241099
122420                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12242099
122430             PERFORM DP013-0000-PROCESS-ABEND                     12243099
122440     END-EVALUATE                                                 12244099
122450     END-PERFORM.                                                 12245099
122460*                                                                 12246099
122470     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12247099
122480         MOVE '9919-LOAD-DC-SPLIT-SHPT-SNT-DTE'                   12248099
122490                               TO DP013-PARAGRAPH                 12249099
122500         MOVE 'SELECT DATA'                                       12250099
122510                           TO DP013-MESSAGE-TEXT (1)              12251099
122520         MOVE SQLCA        TO DP013-SQLCA                         12252099
122530         MOVE 'TIMCNRL'    TO DP013-DB2-TABLE-NAME (1)            12253099
122540         SET DP013-DB2-ABEND                                      12254099
122550             DP013-XCTL-DISPLAY-RESTART                           12255099
122560                                   TO TRUE                        12256099
122570         PERFORM DP013-0000-PROCESS-ABEND                         12257099
122580     END-IF.                                                      12258099
122590 EJECT                                                            12259099
122600*----------------------------------------------------------------*12260099
122610*  DETERMINE DC SPLITS SHPT SENT DATE (EARLIEST)                 *12261099
122620*----------------------------------------------------------------*12262099
122630 9919A-CHECK-AUDIT-DATES.                                         12263099
122640                                                                  12264099
122650     PERFORM                                                      12265099
122660         WITH TEST AFTER                                          12266099
122670         VARYING PV-RETRY-COUNTER                                 12267099
122680         FROM 1 BY 1                                              12268099
122690         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12269099
122700             OR (SQLCODE = -811)                                  12270099
122710             OR (SQLCODE = +100)                                  12271099
122720             OR (SQLCODE = ZERO))                                 12272099
122730*                                                                 12273099
122740         EXEC SQL                                                 12274099
122750             SELECT MIN(DATE(DCONSLR_ACTL_DTE))                   12275099
122760             INTO                                                 12276099
122770               :PV-SHPT-SPL-AUD-DT                                12277099
122780               :PV-SHPT-SPL-AUD-DT-NULL                           12278099
122790             FROM   TAUCNRL                                       12279099
122800             WHERE  PO_NBR IN (:DK-PO-NBR)                        12280099
122810             AND    DCONSLR_RLSE_CDE IN(:PC-R, :PC-Y)             12281099
122820             AND    DATE(DCONSLR_ACTL_DTE)   <>                   12282099
122830                                '9999-09-09'                      12283099
122840         END-EXEC                                                 12284099
122850*                                                                 12285099
122860     EVALUATE TRUE                                                12286099
122870         WHEN SQLCODE = ZERO                                      12287099
122880         WHEN SQLCODE = -811                                      12288099
122890             IF PV-SHPT-SPL-AUD-DT-NULL = 0                       12289099
122900              AND PV-SHPT-SPL-AUD-DT NOT = '9999-09-09'           12290099
122910                NEXT SENTENCE                                     12291099
122920             ELSE                                                 12292099
122930                MOVE '9999-09-09' TO PV-SHPT-SPL-AUD-DT           12293099
122940             END-IF                                               12294099
122950         WHEN SQLWARN0 NOT = SPACES                               12295099
122960         WHEN SQLCODE < ZERO                                      12296099
122970         WHEN SQLCODE > ZERO                                      12297099
122980             MOVE '9919A-CHECK-AUDIT-DATES'                       12298099
122990                               TO DP013-PARAGRAPH                 12299099
123000             MOVE 'SELECT DATA'                                   12300099
123010                               TO DP013-MESSAGE-TEXT (1)          12301099
123020             MOVE SQLCA        TO DP013-SQLCA                     12302099
123030             MOVE 'TAUCNRL'      TO DP013-DB2-TABLE-NAME (1)      12303099
123040             SET DP013-DB2-ABEND                                  12304099
123050                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12305099
123060             PERFORM DP013-0000-PROCESS-ABEND                     12306099
123070     END-EVALUATE                                                 12307099
123080     END-PERFORM.                                                 12308099
123090*                                                                 12309099
123100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12310099
123110         MOVE '9919A-CHECK-AUDIT-DATES'                           12311099
123120                               TO DP013-PARAGRAPH                 12312099
123130         MOVE 'SELECT DATA'                                       12313099
123140                           TO DP013-MESSAGE-TEXT (1)              12314099
123150         MOVE SQLCA        TO DP013-SQLCA                         12315099
123160         MOVE 'TAUCNRL'    TO DP013-DB2-TABLE-NAME (1)            12316099
123170         SET DP013-DB2-ABEND                                      12317099
123180             DP013-XCTL-DISPLAY-RESTART                           12318099
123190                                   TO TRUE                        12319099
123200         PERFORM DP013-0000-PROCESS-ABEND                         12320099
123210     END-IF.                                                      12321099
123220 EJECT                                                            12322099
123230*----------------------------------------------------------------*12323099
123240* GET THE VENDOR PRIMARY NAME                                    *12324099
123250*----------------------------------------------------------------*12325099
123260                                                                  12326099
123270 9920-GET-VENDOR-PRIMARY-NAME.                                    12327099
123280                                                                  12328099
123290     EXEC SQL                                                     12329099
123300         SELECT ENT_NAME_DESC                                     12330099
123310              , ENT_ID                                            12331099
123320          INTO  :ENTNME-ENT-NAME-DESC                             12332099
123330              , :ENTNME-ENT-ID                                    12333099
123340          FROM  TENTNME                                           12334099
123350          WHERE ENT_ID   = :PURCHS-ENT-ID                         12335099
123360            AND TYPE_CDE = '01'                                   12336099
123370     END-EXEC.                                                    12337099
123380                                                                  12338099
123390     EVALUATE TRUE                                                12339099
123400         WHEN SQLCODE = +0                                        12340099
123410         WHEN SQLCODE = +100                                      12341099
123420         WHEN SQLCODE = -904                                      12342099
123430         WHEN SQLCODE = -913                                      12343099
123440             CONTINUE                                             12344099
123450         WHEN SQLWARN0 NOT = SPACE                                12345099
123460         WHEN SQLCODE < +0                                        12346099
123470         WHEN SQLCODE > +0                                        12347099
123480             MOVE '9920-GET-VENDOR-PRIMARY-NAME'                  12348099
123490                                 TO DP013-PARAGRAPH               12349099
123500             MOVE 'SELECT ON ENTERPRISE NAME TABLE'               12350099
123510                                 TO DP013-MESSAGE-TEXT (1)        12351099
123520             MOVE SQLCA          TO DP013-SQLCA                   12352099
123530             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)      12353099
123540                 SET DP013-DB2-ABEND                              12354099
123550                     DP013-XCTL-DISPLAY-RESTART                   12355099
123560                                 TO TRUE                          12356099
123570             PERFORM DP013-0000-PROCESS-ABEND                     12357099
123580     END-EVALUATE.                                                12358099
123590 EJECT                                                            12359099
123600*----------------------------------------------------------------*12360099
123610* SELECT DMM (DMA) NUMBER                                        *12361099
123620*----------------------------------------------------------------*12362099
123630 9923-SELECT-DMM-NBR.                                             12363099
123640                                                                  12364099
123650     EXEC SQL                                                     12365099
123660         SELECT DMA_NBR                                           12366099
123670          INTO  :MDSEAR-DMA-NBR                                   12367099
123680          FROM  TMDSEAR                                           12368099
123690          WHERE DEPT_NBR  = :PURCHS-DEPT-NBR                      12369099
123700     END-EXEC.                                                    12370099
123710                                                                  12371099
123720     EVALUATE TRUE                                                12372099
123730         WHEN SQLCODE = +0                                        12373099
123740         WHEN SQLCODE = -811                                      12374099
123750         WHEN SQLCODE = -904                                      12375099
123760         WHEN SQLCODE = -913                                      12376099
123770             CONTINUE                                             12377099
123780                                                                  12378099
123790         WHEN SQLCODE = +100                                      12379099
123800             MOVE SPACES TO MDSEAR-DMA-NBR                        12380099
123810                                                                  12381099
123820         WHEN SQLWARN0 NOT = SPACE                                12382099
123830         WHEN SQLCODE < +0                                        12383099
123840         WHEN SQLCODE > +0                                        12384099
123850             MOVE '9923-SELECT-DMM-NBR'                           12385099
123860                                 TO DP013-PARAGRAPH               12386099
123870             MOVE 'SELECT ON TMDSEAR TABLE'                       12387099
123880                                 TO DP013-MESSAGE-TEXT (1)        12388099
123890             MOVE SQLCA          TO DP013-SQLCA                   12389099
123900             MOVE 'TMDSEAR'      TO DP013-DB2-TABLE-NAME (1)      12390099
123910                 SET DP013-DB2-ABEND                              12391099
123920                     DP013-XCTL-DISPLAY-RESTART                   12392099
123930                                 TO TRUE                          12393099
123940             PERFORM DP013-0000-PROCESS-ABEND                     12394099
123950     END-EVALUATE.                                                12395099
123960 EJECT                                                            12396099
123970*----------------------------------------------------------------*12397099
123980*   OPEN THE DC SPLITS CREATE DATE CURSOR                        *12398099
123990*----------------------------------------------------------------*12399099
124000 9925-OPEN-DC-SPLITS-CURSOR.                                      12400099
124010                                                                  12401099
124020     PERFORM                                                      12402099
124030         WITH TEST AFTER                                          12403099
124040         VARYING PV-RETRY-COUNTER                                 12404099
124050         FROM 1 BY 1                                              12405099
124060         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12406099
124070                   OR (SQLCODE = ZERO))                           12407099
124080                                                                  12408099
124090         MOVE 'CURSOR:  DC-SPLITS-CSR' TO DP013-MESSAGE-TEXT (2)  12409099
124100                                                                  12410099
124110         EXEC SQL                                                 12411099
124120              OPEN DC-SPLITS-CSR                                  12412099
124130         END-EXEC                                                 12413099
124140                                                                  12414099
124150         EVALUATE TRUE                                            12415099
124160             WHEN SQLCODE = ZERO                                  12416099
124170             WHEN SQLCODE = -904                                  12417099
124180             WHEN SQLCODE = -913                                  12418099
124190                 CONTINUE                                         12419099
124200             WHEN SQLWARN0 NOT = SPACES                           12420099
124210             WHEN SQLCODE < ZERO                                  12421099
124220             WHEN SQLCODE > ZERO                                  12422099
124230                 MOVE '9925-OPEN-DC-SPLITS-CURSOR'                12423099
124240                                   TO DP013-PARAGRAPH             12424099
124250                 MOVE 'OPEN DC SPLITS CURSOR - '                  12425099
124260                                   TO DP013-MESSAGE-TEXT (1)      12426099
124270                 MOVE SQLCA        TO DP013-SQLCA                 12427099
124280                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)    12428099
124290                 SET DP013-DB2-ABEND                              12429099
124300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12430099
124310                 PERFORM DP013-0000-PROCESS-ABEND                 12431099
124320         END-EVALUATE                                             12432099
124330     END-PERFORM.                                                 12433099
124340*                                                                 12434099
124350     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12435099
124360         MOVE '9925-OPEN-DC-SPLITS-CURSOR' TO DP013-PARAGRAPH     12436099
124370         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   12437099
124380                                   TO DP013-MESSAGE-TEXT (1)      12438099
124390         MOVE SQLCA                TO DP013-SQLCA                 12439099
124400         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    12440099
124410         SET DP013-DB2-ABEND                                      12441099
124420             DP013-XCTL-DISPLAY-RESTART                           12442099
124430                                   TO TRUE                        12443099
124440         PERFORM DP013-0000-PROCESS-ABEND                         12444099
124450     END-IF.                                                      12445099
124460                                                                  12446099
124470 EJECT                                                            12447099
124480*----------------------------------------------------------------*12448099
124490*   CLOSE THE DC SPLITS CREATE DATE CURSOR                       *12449099
124500*----------------------------------------------------------------*12450099
124510 9926-CLOSE-DC-SPLITS-CURSOR.                                     12451099
124520                                                                  12452099
124530     EXEC SQL                                                     12453099
124540          CLOSE DC-SPLITS-CSR                                     12454099
124550     END-EXEC.                                                    12455099
124560                                                                  12456099
124570     EVALUATE TRUE                                                12457099
124580         WHEN SQLCODE = ZERO                                      12458099
124590             CONTINUE                                             12459099
124600         WHEN SQLWARN0 NOT = SPACES                               12460099
124610         WHEN SQLCODE < ZERO                                      12461099
124620         WHEN SQLCODE > ZERO                                      12462099
124630             MOVE '9926-CLOSE-DC-SPLITS-CURSOR'                   12463099
124640                               TO DP013-PARAGRAPH                 12464099
124650             MOVE 'CLOSE DC SPLITS CURSOR'                        12465099
124660                               TO DP013-MESSAGE-TEXT (1)          12466099
124670             MOVE SQLCA        TO DP013-SQLCA                     12467099
124680             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)        12468099
124690             SET DP013-DB2-ABEND                                  12469099
124700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12470099
124710             PERFORM DP013-0000-PROCESS-ABEND                     12471099
124720     END-EVALUATE.                                                12472099
124730                                                                  12473099
124740 EJECT                                                            12474099
124750*----------------------------------------------------------------*12475099
124760*    FETCH THE DC SPLITS CREATE DATE CURSOR                      *12476099
124770*----------------------------------------------------------------*12477099
124780 9927-FETCH-DC-SPLITS-CURSOR.                                     12478099
124790                                                                  12479099
124800     EXEC SQL                                                     12480099
124810          FETCH DC-SPLITS-CSR                                     12481099
124820          INTO  :PURITM-PO-LNE-NBR                                12482099
124830     END-EXEC.                                                    12483099
124840                                                                  12484099
124850     EVALUATE TRUE                                                12485099
124860         WHEN SQLCODE = ZERO                                      12486099
124870         WHEN SQLCODE = -811                                      12487099
124880             SET PS-EOC-DC-SPLITS-NO TO TRUE                      12488099
124890                                                                  12489099
124900         WHEN SQLCODE = +100                                      12490099
124910             SET PS-EOC-DC-SPLITS TO TRUE                         12491099
124920                                                                  12492099
124930         WHEN SQLWARN0 NOT = SPACE                                12493099
124940         WHEN SQLCODE NOT = ZERO                                  12494099
124950              MOVE '9927-FETCH-DC-SPLITS-CURSOR'                  12495099
124960                               TO DP013-PARAGRAPH                 12496099
124970              MOVE 'FETCH DC SPLIT CURSOR'                        12497099
124980                               TO DP013-MESSAGE-TEXT (1)          12498099
124990              MOVE SQLCA       TO DP013-SQLCA                     12499099
125000              SET DP013-DB2-ABEND                                 12500099
125010                               TO TRUE                            12501099
125020              PERFORM DP013-0000-PROCESS-ABEND                    12502099
125030     END-EVALUATE.                                                12503099
125040                                                                  12504099
125050 EJECT                                                            12505099
125060*----------------------------------------------------------------*12506099
125070*  SELECT STORE DISTRO                                           *12507099
125080*----------------------------------------------------------------*12508099
125090 9928-SELECT-STORE-DISTRO.                                        12509099
125100                                                                  12510099
125110     PERFORM                                                      12511099
125120         WITH TEST AFTER                                          12512099
125130         VARYING PV-RETRY-COUNTER                                 12513099
125140         FROM 1 BY 1                                              12514099
125150         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12515099
125160             OR (SQLCODE = -811)                                  12516099
125170             OR (SQLCODE = +100)                                  12517099
125180             OR (SQLCODE = ZERO))                                 12518099
125190*                                                                 12519099
125200         EXEC SQL                                                 12520099
125210            SELECT COUNT(*)                                       12521099
125220              INTO :PV-DB2-COUNT                                  12522099
125230              FROM  TMESTDS                                       12523099
125240              WHERE PO_NBR = :DK-PO-NBR                           12524099
125250         END-EXEC                                                 12525099
125260*                                                                 12526099
125270     EVALUATE TRUE                                                12527099
125280         WHEN SQLCODE = ZERO                                      12528099
125290         WHEN SQLCODE = -811                                      12529099
125300             IF PV-DB2-COUNT > +0                                 12530099
125310                 MOVE PC-Y TO PV-SM-STORE-DISTRO                  12531099
125320             ELSE                                                 12532099
125330                 MOVE PC-N TO PV-SM-STORE-DISTRO                  12533099
125340             END-IF                                               12534099
125350                                                                  12535099
125360         WHEN SQLCODE = +100                                      12536099
125370             MOVE PC-N TO PV-SM-STORE-DISTRO                      12537099
125380                                                                  12538099
125390         WHEN SQLWARN0 NOT = SPACES                               12539099
125400         WHEN SQLCODE < ZERO                                      12540099
125410         WHEN SQLCODE > ZERO                                      12541099
125420             MOVE '9928-SELECT-STORE-DISTRO'                      12542099
125430                               TO DP013-PARAGRAPH                 12543099
125440             MOVE 'SELECT DATA'                                   12544099
125450                               TO DP013-MESSAGE-TEXT (1)          12545099
125460             MOVE SQLCA        TO DP013-SQLCA                     12546099
125470             MOVE 'TMESTDS'      TO DP013-DB2-TABLE-NAME (1)      12547099
125480             SET DP013-DB2-ABEND                                  12548099
125490                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12549099
125500             PERFORM DP013-0000-PROCESS-ABEND                     12550099
125510     END-EVALUATE                                                 12551099
125520     END-PERFORM.                                                 12552099
125530*                                                                 12553099
125540     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12554099
125550         MOVE '9928-SELECT-STORE-DISTRO'                          12555099
125560                               TO DP013-PARAGRAPH                 12556099
125570         MOVE 'SELECT DATA'                                       12557099
125580                           TO DP013-MESSAGE-TEXT (1)              12558099
125590         MOVE SQLCA        TO DP013-SQLCA                         12559099
125600         MOVE 'TMESTDS'    TO DP013-DB2-TABLE-NAME (1)            12560099
125610         SET DP013-DB2-ABEND                                      12561099
125620             DP013-XCTL-DISPLAY-RESTART                           12562099
125630                                   TO TRUE                        12563099
125640         PERFORM DP013-0000-PROCESS-ABEND                         12564099
125650     END-IF.                                                      12565099
125660 EJECT                                                            12566099
125670*----------------------------------------------------------------*12567099
125680* GET DOLLARS RECEIVED                                           *12568099
125690*----------------------------------------------------------------*12569099
125700                                                                  12570099
125710 9930-GET-DOLLARS-RECEIVED.                                       12571099
125720                                                                  12572099
125730     INITIALIZE PV-GP-DOLLARS-RECEIVED                            12573099
125740                PV-NULL-IND.                                      12574099
125750     EXEC SQL                                                     12575099
125760      SELECT SUM(DECIMAL                                          12576099
125770           (C.AP_VERIFY_ITM_QTY * (A.GP_RTL_AMT / A.GP_QTY),9,2)) 12577099
125780         INTO :PV-GP-DOLLARS-RECEIVED:PV-NULL-IND                 12578099
125790         FROM TPURITM A,                                          12579099
125800              TRECITM B,                                          12580099
125810              TRECDIS C                                           12581099
125820         WHERE A.PO_NBR         = :DK-PO-NBR                      12582099
125830           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   12583099
125840           AND A.VER_NBR        = B.PO_VER_NBR                    12584099
125850           AND B.ORD_NBR        = A.PO_NBR                        12585099
125860           AND B.STATUS_CDE     = 'VE'                            12586099
125870           AND B.VER_STATUS_CDE = 'A'                             12587099
125880           AND C.ORD_NBR        = A.PO_NBR                        12588099
125890           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                   12589099
125900           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                   12590099
125920           AND A.GP_QTY         > 1                               12592099
125930     END-EXEC.                                                    12593099
125940                                                                  12594099
125950     EVALUATE TRUE                                                12595099
125960         WHEN SQLCODE = +0                                        12596099
125970           IF PV-NULL-IND NOT = -1                                12597099
125980             CONTINUE                                             12598099
125990              ELSE                                                12599099
126000             MOVE ZEROES TO PV-GP-DOLLARS-RECEIVED                12600099
126010           END-IF                                                 12601099
126020           CONTINUE                                               12602099
126030         WHEN SQLCODE = -904                                      12603099
126040         WHEN SQLCODE = -913                                      12604099
126050              CONTINUE                                            12605099
126060                                                                  12606099
126070         WHEN SQLWARN0 NOT = SPACES                               12607099
126080         WHEN SQLCODE < +0                                        12608099
126090         WHEN SQLCODE > +0                                        12609099
126100              MOVE '9930-GET-DOLLARS-RECEIVED'                    12610099
126110                              TO DP013-PARAGRAPH                  12611099
126120              MOVE 'UNSUCCESSFUL SELECT GP DOLLARS RECEIVED'      12612099
126130                              TO DP013-MESSAGE-TEXT (1)           12613099
126140              MOVE SQLCA      TO DP013-SQLCA                      12614099
126150              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)         12615099
126160              SET DP013-DB2-ABEND                                 12616099
126170                  DP013-XCTL-DISPLAY-RESTART                      12617099
126180                              TO TRUE                             12618099
126190              PERFORM DP013-0000-PROCESS-ABEND                    12619099
126200     END-EVALUATE.                                                12620099
126210                                                                  12621099
126220     INITIALIZE PV-DOLLARS-RECEIVED                               12622099
126230                PV-NULL-IND.                                      12623099
126240     EXEC SQL                                                     12624099
126250      SELECT SUM(C.AP_VERIFY_ITM_QTY * A.UNT_RTL_PR_AMT)          12625099
126260         INTO :PV-DOLLARS-RECEIVED:PV-NULL-IND                    12626099
126270         FROM TPURITM A,                                          12627099
126280              TRECITM B,                                          12628099
126290              TRECDIS C                                           12629099
126300         WHERE A.PO_NBR         = :DK-PO-NBR                      12630099
126310           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   12631099
126320           AND A.VER_NBR        = B.PO_VER_NBR                    12632099
126330           AND B.ORD_NBR        = A.PO_NBR                        12633099
126340           AND B.STATUS_CDE     = 'VE'                            12634099
126350           AND B.VER_STATUS_CDE = 'A'                             12635099
126360           AND C.ORD_NBR        = A.PO_NBR                        12636099
126370           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                   12637099
126380           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                   12638099
126400           AND A.GP_QTY        <= 1                               12640099
126410     END-EXEC.                                                    12641099
126420                                                                  12642099
126430     EVALUATE TRUE                                                12643099
126440         WHEN SQLCODE = +0                                        12644099
126450           IF PV-NULL-IND NOT = -1                                12645099
126460             CONTINUE                                             12646099
126470              ELSE                                                12647099
126480             MOVE ZEROES TO PV-DOLLARS-RECEIVED                   12648099
126490           END-IF                                                 12649099
126500           CONTINUE                                               12650099
126510         WHEN SQLCODE = -904                                      12651099
126520         WHEN SQLCODE = -913                                      12652099
126530              CONTINUE                                            12653099
126540                                                                  12654099
126550         WHEN SQLWARN0 NOT = SPACES                               12655099
126560         WHEN SQLCODE < +0                                        12656099
126570         WHEN SQLCODE > +0                                        12657099
126580              MOVE '9930-GET-DOLLARS-RECEIVED'                    12658099
126590                              TO DP013-PARAGRAPH                  12659099
126600              MOVE 'UNSUCCESSFUL SELECT DOLLARS RECEIVED'         12660099
126610                              TO DP013-MESSAGE-TEXT (1)           12661099
126620              MOVE SQLCA      TO DP013-SQLCA                      12662099
126630              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)         12663099
126640              SET DP013-DB2-ABEND                                 12664099
126650                  DP013-XCTL-DISPLAY-RESTART                      12665099
126660                              TO TRUE                             12666099
126670              PERFORM DP013-0000-PROCESS-ABEND                    12667099
126680     END-EVALUATE.                                                12668099
126690       ADD PV-DOLLARS-RECEIVED TO PV-GP-DOLLARS-RECEIVED GIVING   12669099
126700          PV-DOLLARS-RECEIVED.                                    12670099
126710                                                                  12671099
126720 EJECT                                                            12672099
126730*----------------------------------------------------------------*12673099
126740*  DETERMINE IF ANY OF THE ORDERS ARE HAVE IN-PROCESS RECEIVERS, *12674099
126750*  IF THE ORDER DOES, HIGHLIGHT THE PO IN YELLOW ON THE SCREEN.  *12675099
126760*----------------------------------------------------------------*12676099
126770                                                                  12677099
126780 9940-CHECK-IN-PROCESS.                                           12678099
126790                                                                  12679099
126800     EXEC SQL                                                     12680099
126810          SELECT COUNT(*)                                         12681099
126820            INTO :PV-DB2-COUNT2                                   12682099
126830            FROM TRECEIV                                          12683099
126840           WHERE ORD_NBR        = :DK-PO-NBR                      12684099
126850             AND VER_STATUS_CDE = 'A'                             12685099
126860             AND STATUS_CDE     = 'IP'                            12686099
126870     END-EXEC.                                                    12687099
126880                                                                  12688099
126890     EVALUATE TRUE                                                12689099
126900         WHEN SQLCODE = +0                                        12690099
126910         WHEN SQLCODE = +100                                      12691099
126920         WHEN SQLCODE = -904                                      12692099
126930         WHEN SQLCODE = -913                                      12693099
126940              CONTINUE                                            12694099
126950                                                                  12695099
126960         WHEN SQLWARN0 NOT = SPACES                               12696099
126970         WHEN SQLCODE < +0                                        12697099
126980         WHEN SQLCODE > +0                                        12698099
126990              MOVE '9940-CHECK-IN-PROCESS'                        12699099
127000                              TO DP013-PARAGRAPH                  12700099
127010              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               12701099
127020                              TO DP013-MESSAGE-TEXT (1)           12702099
127030              MOVE SQLCA      TO DP013-SQLCA                      12703099
127040              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         12704099
127050              SET DP013-DB2-ABEND                                 12705099
127060                  DP013-XCTL-DISPLAY-RESTART                      12706099
127070                              TO TRUE                             12707099
127080              PERFORM DP013-0000-PROCESS-ABEND                    12708099
127090     END-EVALUATE.                                                12709099
127100                                                                  12710099
127110*----------------------------------------------------------------*12711099
127120*  DETERMINE UNITS RECEIVED                                      *12712099
127130*----------------------------------------------------------------*12713099
127140 9950-GET-UNITS-RECEIVED.                                         12714099
127150                                                                  12715099
127160     INITIALIZE PV-UNITS-RECEIVED                                 12716099
127170                PV-NULL-IND.                                      12717099
127180     PERFORM                                                      12718099
127190         WITH TEST AFTER                                          12719099
127200         VARYING PV-RETRY-COUNTER                                 12720099
127210         FROM 1 BY 1                                              12721099
127220         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12722099
127230             OR (SQLCODE = +0)                                    12723099
127240             OR (SQLCODE = +100))                                 12724099
127250                                                                  12725099
127260         EXEC SQL                                                 12726099
127270             SELECT SUM(B.AP_VERIFY_ITM_QTY)                      12727099
127280             INTO :PV-UNITS-RECEIVED:PV-NULL-IND                  12728099
127290             FROM TRECITM A,                                      12729099
127300                  TRECDIS B                                       12730099
127310             WHERE A.ORD_NBR        = :DK-PO-NBR                  12731099
127320               AND A.ORD_NBR        = B.ORD_NBR                   12732099
127330               AND A.STATUS_CDE     = 'VE'                        12733099
127340               AND A.VER_STATUS_CDE = 'A'                         12734099
127350               AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR               12735099
127360               AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR               12736099
127380         END-EXEC                                                 12738099
127390                                                                  12739099
127400         EVALUATE TRUE                                            12740099
127410             WHEN SQLCODE = +0                                    12741099
127420             WHEN SQLCODE = +100                                  12742099
127430             WHEN SQLCODE = -904                                  12743099
127440             WHEN SQLCODE = -913                                  12744099
127450                  CONTINUE                                        12745099
127460                                                                  12746099
127470             WHEN SQLWARN0 NOT = SPACES                           12747099
127480             WHEN SQLCODE < +0                                    12748099
127490             WHEN SQLCODE > +0                                    12749099
127500                  MOVE '9950-GET-UNITS-RCVD'                      12750099
127510                                  TO DP013-PARAGRAPH              12751099
127520                  MOVE 'UNSUCCESSFUL SELECT UNITS RCVD  '         12752099
127530                                  TO DP013-MESSAGE-TEXT (1)       12753099
127540                  MOVE SQLCA      TO DP013-SQLCA                  12754099
127550                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     12755099
127560                  MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (2)     12756099
127570                  SET DP013-DB2-ABEND                             12757099
127580                      DP013-XCTL-DISPLAY-RESTART                  12758099
127590                                  TO TRUE                         12759099
127600                  PERFORM DP013-0000-PROCESS-ABEND                12760099
127610         END-EVALUATE                                             12761099
127620     END-PERFORM.                                                 12762099
127630                                                                  12763099
127640     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12764099
127650         MOVE '9950-GET-UNITS-RCVD '                              12765099
127660                                  TO DP013-PARAGRAPH              12766099
127670         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TRECITM'          12767099
127680                                  TO DP013-MESSAGE-TEXT (1)       12768099
127690         MOVE SQLCA               TO DP013-SQLCA                  12769099
127700         MOVE 'TRECITM '          TO DP013-DB2-TABLE-NAME (1)     12770099
127710         MOVE 'TRECDIS '          TO DP013-DB2-TABLE-NAME (2)     12771099
127720         SET DP013-DB2-ABEND                                      12772099
127730             DP013-XCTL-DISPLAY-RESTART                           12773099
127740                                  TO TRUE                         12774099
127750         PERFORM DP013-0000-PROCESS-ABEND                         12775099
127760     END-IF.                                                      12776099
127770                                                                  12777099
127780 EJECT                                                            12778099
127790                                                                  12779099
127800*----------------------------------------------------------------*12780099
127810*  DETERMINE MIN AD DATE                                         *12781099
127820*----------------------------------------------------------------*12782099
127830                                                                  12783099
127840 9960-GET-MIN-AD-DATE.                                            12784099
127850                                                                  12785099
127860     PERFORM                                                      12786099
127870         WITH TEST AFTER                                          12787099
127880         VARYING PV-RETRY-COUNTER                                 12788099
127890         FROM 1 BY 1                                              12789099
127900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12790099
127910             OR (SQLCODE = +0)                                    12791099
127920             OR (SQLCODE = +100))                                 12792099
127930                                                                  12793099
127940         EXEC SQL                                                 12794099
127950             SELECT MIN(AD_EVNT_DTE)                              12795099
127960              INTO  :PURITM-AD-EVNT-DTE:PV-NULL-IND               12796099
127970              FROM  TPURITM                                       12797099
127980              WHERE PO_NBR          = :DK-PO-NBR                  12798099
127990                AND VER_STATUS_CDE  = 'A'                         12799099
128000                AND AD_EVNT_DTE     > '0001-01-01'                12800099
128010                AND STATUS_CDE NOT IN ('CA')                      12801099
128020         END-EXEC                                                 12802099
128030                                                                  12803099
128040         EVALUATE TRUE                                            12804099
128050             WHEN SQLCODE = +0                                    12805099
128060                  IF  PV-NULL-IND < +0                            12806099
128070                      MOVE SPACES     TO PV-SM-AD-EVNT-DT         12807099
128080                  ELSE                                            12808099
128090                      MOVE PURITM-AD-EVNT-DTE (1:4) TO            12809099
128100                                       PV-SM-AD-EVNT-DT(1:4)      12810099
128110                      MOVE PURITM-AD-EVNT-DTE (6:2) TO            12811099
128120                                       PV-SM-AD-EVNT-DT(5:2)      12812099
128130                      MOVE PURITM-AD-EVNT-DTE (9:2) TO            12813099
128140                                       PV-SM-AD-EVNT-DT(7:2)      12814099
128150                  END-IF                                          12815099
128160             WHEN SQLCODE = +100                                  12816099
128170                  MOVE SPACES          TO PV-SM-AD-EVNT-DT        12817099
128180             WHEN SQLCODE = -904                                  12818099
128190             WHEN SQLCODE = -913                                  12819099
128200                  CONTINUE                                        12820099
128210                                                                  12821099
128220             WHEN SQLWARN0 NOT = SPACES                           12822099
128230             WHEN SQLCODE < +0                                    12823099
128240             WHEN SQLCODE > +0                                    12824099
128250                  MOVE '9960-GET-MIN-AD-DTE'                      12825099
128260                                  TO DP013-PARAGRAPH              12826099
128270                  MOVE 'UNSUCCESSFUL SELECT MIN AD DATE '         12827099
128280                                  TO DP013-MESSAGE-TEXT (1)       12828099
128290                  MOVE SQLCA      TO DP013-SQLCA                  12829099
128300                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     12830099
128310                  SET DP013-DB2-ABEND                             12831099
128320                      DP013-XCTL-DISPLAY-RESTART                  12832099
128330                                  TO TRUE                         12833099
128340                  PERFORM DP013-0000-PROCESS-ABEND                12834099
128350         END-EVALUATE                                             12835099
128360     END-PERFORM.                                                 12836099
128370                                                                  12837099
128380     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12838099
128390         MOVE '9960-GET-MIN-AD-DATE'                              12839099
128400                                  TO DP013-PARAGRAPH              12840099
128410         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TPURITM'          12841099
128420                                  TO DP013-MESSAGE-TEXT (1)       12842099
128430         MOVE SQLCA               TO DP013-SQLCA                  12843099
128440         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     12844099
128450         SET DP013-DB2-ABEND                                      12845099
128460             DP013-XCTL-DISPLAY-RESTART                           12846099
128470                                  TO TRUE                         12847099
128480         PERFORM DP013-0000-PROCESS-ABEND                         12848099
128490     END-IF.                                                      12849099
128500                                                                  12850099
128510 EJECT                                                            12851099
128520*----------------------------------------------------------------*12852099
128530*      SELECT TRAILER AVAILABLE DATE FROM SHIPST                 *12853099
128540*----------------------------------------------------------------*12854099
128550 9962-GET-TRLR-AVAIL-DATE.                                        12855099
128560                                                                  12856099
128570     PERFORM                                                      12857099
128580         WITH TEST AFTER                                          12858099
128590         VARYING PV-RETRY-COUNTER                                 12859099
128600         FROM 1 BY 1                                              12860099
128610         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12861099
128620             OR (SQLCODE = +0)                                    12862099
128630             OR (SQLCODE = +100))                                 12863099
128640                                                                  12864099
128650         EXEC SQL                                                 12865099
128660             SELECT DISTINCT                                      12866099
128670                    MIN(C.STATUS_DTE)                             12867099
128680             INTO  :PV-TRLR-AVAIL-DT:PV-TRLR-AVAIL-DT-NULL        12868099
128690             FROM   TSHPTPO A                                     12869099
128700                   ,TSHIPMT B                                     12870099
128710                   ,TSHIPST C                                     12871099
128720            WHERE  A.PO_NBR        = :DK-PO-NBR                   12872099
128730              AND  A.SHIPT_ID      = B.SHIPT_ID                   12873099
128740              AND  A.SHIPT_ID      = C.SHIPT_ID                   12874099
128750              AND  C.SHIPT_STATUS_CDE = :PC-AJ                    12875099
128760         END-EXEC                                                 12876099
128770                                                                  12877099
128780         EVALUATE TRUE                                            12878099
128790             WHEN SQLCODE = ZERO                                  12879099
128800                  IF PV-TRLR-AVAIL-DT-NULL < +0                   12880099
128810                      MOVE SPACES TO PV-SM-TRLR-AVAIL-DT          12881099
128820                  ELSE                                            12882099
128830                      MOVE PV-TRLR-AVAIL-DT (1:4) TO              12883099
128840                                       PV-SM-TRLR-AVAIL-DT (1:4)  12884099
128850                      MOVE PV-TRLR-AVAIL-DT (6:2) TO              12885099
128860                                       PV-SM-TRLR-AVAIL-DT (5:2)  12886099
128870                      MOVE PV-TRLR-AVAIL-DT (9:2) TO              12887099
128880                                       PV-SM-TRLR-AVAIL-DT (7:2)  12888099
128890                  END-IF                                          12889099
128900                                                                  12890099
128910             WHEN SQLCODE = +100                                  12891099
128920                  MOVE SPACES TO PV-SM-TRLR-AVAIL-DT              12892099
128930                                                                  12893099
128940             WHEN SQLCODE = -904                                  12894099
128950             WHEN SQLCODE = -913                                  12895099
128960                  CONTINUE                                        12896099
128970                                                                  12897099
128980             WHEN SQLWARN0 NOT = SPACES                           12898099
128990             WHEN SQLCODE < +0                                    12899099
129000             WHEN SQLCODE > +0                                    12900099
129010                  MOVE '9962-GET-TRLR-AVAIL-DATE'                 12901099
129020                                  TO DP013-PARAGRAPH              12902099
129030                  MOVE 'SQL ERROR ON TRLR AVAIL DATE SELECT'      12903099
129040                                  TO DP013-MESSAGE-TEXT (1)       12904099
129050                  MOVE SQLCA      TO DP013-SQLCA                  12905099
129060                  MOVE 'TSHIPST ' TO DP013-DB2-TABLE-NAME (1)     12906099
129070                  SET DP013-DB2-ABEND                             12907099
129080                      DP013-XCTL-DISPLAY-RESTART                  12908099
129090                                  TO TRUE                         12909099
129100                  PERFORM DP013-0000-PROCESS-ABEND                12910099
129110         END-EVALUATE                                             12911099
129120     END-PERFORM.                                                 12912099
129130                                                                  12913099
129140     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12914099
129150         MOVE '9962-GET-TRLR-AVAIL-DATE'                          12915099
129160                                  TO DP013-PARAGRAPH              12916099
129170         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TSHIPST'          12917099
129180                                  TO DP013-MESSAGE-TEXT (1)       12918099
129190         MOVE SQLCA               TO DP013-SQLCA                  12919099
129200         MOVE 'TSHIPST '          TO DP013-DB2-TABLE-NAME (1)     12920099
129210         SET DP013-DB2-ABEND                                      12921099
129220             DP013-XCTL-DISPLAY-RESTART                           12922099
129230                                  TO TRUE                         12923099
129240         PERFORM DP013-0000-PROCESS-ABEND                         12924099
129250     END-IF.                                                      12925099
129260                                                                  12926099
129270 EJECT                                                            12927099
129280*----------------------------------------------------------------*12928099
129290*  DETERMINE VENDOR STYLE                                        *12929099
129300*----------------------------------------------------------------*12930099
129310                                                                  12931099
129320 9965-GET-VENDOR-STYLE.                                           12932099
129330                                                                  12933099
129340     PERFORM                                                      12934099
129350         WITH TEST AFTER                                          12935099
129360         VARYING PV-RETRY-COUNTER                                 12936099
129370         FROM 1 BY 1                                              12937099
129380         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12938099
129390             OR (SQLCODE = +0)                                    12939099
129400             OR (SQLCODE = +100)                                  12940099
129410             OR (SQLCODE = -811))                                 12941099
129420                                                                  12942099
129430         EXEC SQL                                                 12943099
129440             SELECT DISTINCT VS_NBR                               12944099
129450              INTO  :XLT00004-VS-NBR                              12945099
129460              FROM  TPURITM A                                     12946099
129470                  , XLT_SKU B                                     12947099
129480                  , XLT_VND_STYL C                                12948099
129490              WHERE A.PO_NBR          = :DK-PO-NBR                12949099
129500                AND A.VER_STATUS_CDE  = 'A'                       12950099
129510                AND STATUS_CDE NOT IN ('CA')                      12951099
129520                AND A.ITM_NBR = B.ITM_NBR                         12952099
129530                AND B.STYL_ID = C.STYL_ID                         12953099
129540         END-EXEC                                                 12954099
129550                                                                  12955099
129560         EVALUATE TRUE                                            12956099
129570             WHEN SQLCODE = +0                                    12957099
129580                  MOVE XLT00004-VS-NBR TO                         12958099
129590                                   PV-SM-VENDOR-STYLE             12959099
129600             WHEN SQLCODE = +100                                  12960099
129610                  MOVE SPACES      TO PV-SM-VENDOR-STYLE          12961099
129620             WHEN SQLCODE = -811                                  12962099
129630                  MOVE 'MULTI   '  TO PV-SM-VENDOR-STYLE          12963099
129640             WHEN SQLCODE = -904                                  12964099
129650             WHEN SQLCODE = -913                                  12965099
129660                  CONTINUE                                        12966099
129670                                                                  12967099
129680             WHEN SQLWARN0 NOT = SPACES                           12968099
129690             WHEN SQLCODE < +0                                    12969099
129700             WHEN SQLCODE > +0                                    12970099
129710                  MOVE '9965-GET-VENDOR-STYLE'                    12971099
129720                                  TO DP013-PARAGRAPH              12972099
129730                  MOVE 'UNSUCCESSFUL SELECT VENDOR STYLE'         12973099
129740                                  TO DP013-MESSAGE-TEXT (1)       12974099
129750                  MOVE SQLCA      TO DP013-SQLCA                  12975099
129760                  MOVE 'XLT_VND_STYL' TO DP013-DB2-TABLE-NAME (1) 12976099
129770                  SET DP013-DB2-ABEND                             12977099
129780                      DP013-XCTL-DISPLAY-RESTART                  12978099
129790                                  TO TRUE                         12979099
129800                  PERFORM DP013-0000-PROCESS-ABEND                12980099
129810         END-EVALUATE                                             12981099
129820     END-PERFORM.                                                 12982099
129830                                                                  12983099
129840     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12984099
129850         MOVE '9965-GET-VENDOR-STYLE'                             12985099
129860                                  TO DP013-PARAGRAPH              12986099
129870         MOVE 'MAX RETRIES EXCEEDED ON SELECT XLT_VND_STYL'       12987099
129880                                  TO DP013-MESSAGE-TEXT (1)       12988099
129890         MOVE SQLCA               TO DP013-SQLCA                  12989099
129900         MOVE 'XLT_VND_STYL'      TO DP013-DB2-TABLE-NAME (1)     12990099
129910         SET DP013-DB2-ABEND                                      12991099
129920             DP013-XCTL-DISPLAY-RESTART                           12992099
129930                                  TO TRUE                         12993099
129940         PERFORM DP013-0000-PROCESS-ABEND                         12994099
129950     END-IF.                                                      12995099
129960                                                                  12996099
129970*----------------------------------------------------------------*12997099
129980*  DETERMINE TOTAL COST AND RETAIL DOLLARS AND UNITS             *12998099
129990*  IGNORE THE MIN  ,MIN(B.TOT_VAL_RTL_AMT)                       *12999099
130000*                  ,MIN(B.TOT_UNT_QTY)                           *13000099
130010*  SINCE THE SQL WILL ONLY PULL BACK 1 TPURCHS ROW THE           *13001099
130020*  TOTAL RETAIL AND UNIT WILL ALWAYS BE THE SAME                 *13002099
130030*  THE SQL WAS WRITTEN THIS WAY FOR THE PROGRAM TO BIND.         *13003099
130040*----------------------------------------------------------------*13004099
130050 9970-GET-TOTAL-COST.                                             13005099
130060                                                                  13006099
130070     PERFORM                                                      13007099
130080         WITH TEST AFTER                                          13008099
130090         VARYING PV-RETRY-COUNTER                                 13009099
130100         FROM 1 BY 1                                              13010099
130110         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13011099
130120             OR (SQLCODE = +0)                                    13012099
130130             OR (SQLCODE = -811)                                  13013099
130140             OR (SQLCODE = +100))                                 13014099
130150                                                                  13015099
130160         EXEC SQL                                                 13016099
130170          SELECT SUM(DECIMAL                                      13017099
130180                    (A.UNT_COST_AMT * A.UNT_QTY,9,2))             13018099
130190                ,SUM(DECIMAL                                      13019099
130200                    (A.PRD_1ST_COST_AMT * A.UNT_QTY,9,2))         13020099
130210              INTO  :PV-TOT-TTC:PV-NULL-IND-1                     13021099
130220                   ,:PV-TOT-FIRST-COST:PV-NULL-IND-2              13022099
130230             FROM TPURITM A                                       13023099
130240             WHERE A.PO_NBR         = :DK-PO-NBR                  13024099
130250               AND A.VER_STATUS_CDE = 'A'                         13025099
130260               AND A.STATUS_CDE    <> 'CA'                        13026099
130270         END-EXEC                                                 13027099
130280                                                                  13028099
130290         EVALUATE TRUE                                            13029099
130300             WHEN SQLCODE = +0                                    13030099
130310             WHEN SQLCODE = -811                                  13031099
130320                  IF  PV-NULL-IND-1 < +0                          13032099
130330                      MOVE +0      TO PV-TOT-TTC                  13033099
130340                  END-IF                                          13034099
130350                  IF  PV-NULL-IND-2 < +0                          13035099
130360                      MOVE +0      TO PV-TOT-FIRST-COST           13036099
130370                  END-IF                                          13037099
130380             WHEN SQLCODE = +100                                  13038099
130390             WHEN SQLCODE = -904                                  13039099
130400             WHEN SQLCODE = -913                                  13040099
130410                  MOVE +0     TO PV-TOT-FIRST-COST                13041099
130420                  MOVE +0     TO PV-TOT-TTC                       13042099
130430             WHEN SQLWARN0 NOT = SPACES                           13043099
130440             WHEN SQLCODE < +0                                    13044099
130450             WHEN SQLCODE > +0                                    13045099
130460                  MOVE '9970-GET-TOTAL-COST'                      13046099
130470                                  TO DP013-PARAGRAPH              13047099
130480                  MOVE 'UNSUCCESSFUL SELECT OF TOTAL COST'        13048099
130490                                  TO DP013-MESSAGE-TEXT (1)       13049099
130500                  MOVE SQLCA      TO DP013-SQLCA                  13050099
130510                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     13051099
130520                  SET DP013-DB2-ABEND                             13052099
130530                      DP013-XCTL-DISPLAY-RESTART                  13053099
130540                                  TO TRUE                         13054099
130550                  PERFORM DP013-0000-PROCESS-ABEND                13055099
130560         END-EVALUATE                                             13056099
130570                                                                  13057099
130580     END-PERFORM.                                                 13058099
130590                                                                  13059099
130600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13060099
130610         MOVE '9970-GET-TOTAL-COST'                               13061099
130620                                  TO DP013-PARAGRAPH              13062099
130630         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TPURITM'          13063099
130640                                  TO DP013-MESSAGE-TEXT (1)       13064099
130650         MOVE SQLCA               TO DP013-SQLCA                  13065099
130660         MOVE 'TPURITM'           TO DP013-DB2-TABLE-NAME (1)     13066099
130670         MOVE 'TPURCHS'           TO DP013-DB2-TABLE-NAME (2)     13067099
130680         SET DP013-DB2-ABEND                                      13068099
130690             DP013-XCTL-DISPLAY-RESTART                           13069099
130700                                  TO TRUE                         13070099
130710         PERFORM DP013-0000-PROCESS-ABEND                         13071099
130720     END-IF.                                                      13072099
130730                                                                  13073099
130740 EJECT                                                            13074099
130750*----------------------------------------------------------------*13075099
130760*  DETERMINE TOTAL COST FOR VERIFIED UNITS                       *13076099
130770*----------------------------------------------------------------*13077099
130780 9975-GET-TOTAL-VERIFIED-COST.                                    13078099
130790                                                                  13079099
130800     PERFORM                                                      13080099
130810         WITH TEST AFTER                                          13081099
130820         VARYING PV-RETRY-COUNTER                                 13082099
130830         FROM 1 BY 1                                              13083099
130840         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13084099
130850             OR (SQLCODE = +0)                                    13085099
130860             OR (SQLCODE = -811)                                  13086099
130870             OR (SQLCODE = +100))                                 13087099
130880                                                                  13088099
130890         EXEC SQL                                                 13089099
130900          SELECT SUM(DECIMAL                                      13090099
130910                    (A.UNT_COST_AMT * C.AP_VERIFY_ITM_QTY))       13091099
130920              INTO  :PV-TOT-TVC:PV-NULL-IND-1                     13092099
130930              FROM  TPURITM A                                     13093099
130940                   ,TRECITM B                                     13094099
130950                   ,TRECDIS C                                     13095099
130960             WHERE A.PO_NBR         = :DK-PO-NBR                  13096099
130970               AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR               13097099
130980               AND A.VER_NBR        = B.PO_VER_NBR                13098099
130990               AND B.ORD_NBR        = A.PO_NBR                    13099099
131000               AND B.STATUS_CDE     = 'VE'                        13100099
131010               AND B.VER_STATUS_CDE = 'A'                         13101099
131020               AND C.ORD_NBR        = A.PO_NBR                    13102099
131030               AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR               13103099
131040               AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR               13104099
131060         END-EXEC                                                 13106099
131070                                                                  13107099
131080         EVALUATE TRUE                                            13108099
131090             WHEN SQLCODE = +0                                    13109099
131100             WHEN SQLCODE = -811                                  13110099
131110                  IF  PV-NULL-IND-1 < +0                          13111099
131120                      MOVE +0      TO PV-TOT-TVC                  13112099
131130                  END-IF                                          13113099
131140             WHEN SQLCODE = +100                                  13114099
131150             WHEN SQLCODE = -904                                  13115099
131160             WHEN SQLCODE = -913                                  13116099
131170                  MOVE +0     TO PV-TOT-TVC                       13117099
131180             WHEN SQLWARN0 NOT = SPACES                           13118099
131190             WHEN SQLCODE < +0                                    13119099
131200             WHEN SQLCODE > +0                                    13120099
131210                  MOVE '9975-GET-TOTAL-VERIFIED-COST'             13121099
131220                                  TO DP013-PARAGRAPH              13122099
131230                  MOVE 'UNSUCCESSFUL SELECT OF VERIFIED COST'     13123099
131240                                  TO DP013-MESSAGE-TEXT (1)       13124099
131250                  MOVE SQLCA      TO DP013-SQLCA                  13125099
131260                  MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)     13126099
131270                  SET DP013-DB2-ABEND                             13127099
131280                      DP013-XCTL-DISPLAY-RESTART                  13128099
131290                                  TO TRUE                         13129099
131300                  PERFORM DP013-0000-PROCESS-ABEND                13130099
131310         END-EVALUATE                                             13131099
131320                                                                  13132099
131330     END-PERFORM.                                                 13133099
131340                                                                  13134099
131350     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13135099
131360         MOVE '9975-GET-TOTAL-VERIFIED-COST'                      13136099
131370                                  TO DP013-PARAGRAPH              13137099
131380         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TPURITM'          13138099
131390                                  TO DP013-MESSAGE-TEXT (1)       13139099
131400         MOVE SQLCA               TO DP013-SQLCA                  13140099
131410         MOVE 'TRECDIS'           TO DP013-DB2-TABLE-NAME (1)     13141099
131420         SET DP013-DB2-ABEND                                      13142099
131430             DP013-XCTL-DISPLAY-RESTART                           13143099
131440                                  TO TRUE                         13144099
131450         PERFORM DP013-0000-PROCESS-ABEND                         13145099
131460     END-IF.                                                      13146099
131470                                                                  13147099
131480 EJECT                                                            13148099
131490*----------------------------------------------------------------*13149099
131500*   OPEN THE CURSOR                                              *13150099
131510*----------------------------------------------------------------*13151099
131520                                                                  13152099
131530 9980-OPEN-SHIP-CSR.                                              13153099
131540     PERFORM                                                      13154099
131550         WITH TEST AFTER                                          13155099
131560         VARYING PV-RETRY-COUNTER                                 13156099
131570         FROM 1 BY 1                                              13157099
131580         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13158099
131590             OR (SQLCODE = ZERO))                                 13159099
131600*                                                                 13160099
131610         EXEC SQL                                                 13161099
131620             OPEN SHIP_DATA_CSR                                   13162099
131630         END-EXEC                                                 13163099
131640*                                                                 13164099
131650         EVALUATE TRUE                                            13165099
131660             WHEN SQLCODE = ZERO                                  13166099
131670             WHEN SQLCODE = -904                                  13167099
131680             WHEN SQLCODE = -913                                  13168099
131690                 CONTINUE                                         13169099
131700             WHEN SQLWARN0 NOT = SPACES                           13170099
131710             WHEN SQLCODE < ZERO                                  13171099
131720             WHEN SQLCODE > ZERO                                  13172099
131730                 MOVE '9980-OPEN-CURSOR'                          13173099
131740                                   TO DP013-PARAGRAPH             13174099
131750                 MOVE 'OPEN CURSOR - '                            13175099
131760                                   TO DP013-MESSAGE-TEXT (1)      13176099
131770                 MOVE SQLCA        TO DP013-SQLCA                 13177099
131780                 MOVE 'SHIP'        TO DP013-DB2-TABLE-NAME (1)   13178099
131790                 SET DP013-DB2-ABEND                              13179099
131800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13180099
131810                 PERFORM DP013-0000-PROCESS-ABEND                 13181099
131820         END-EVALUATE                                             13182099
131830     END-PERFORM.                                                 13183099
131840*                                                                 13184099
131850     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13185099
131860         MOVE '9980-OPEN-CURSOR'   TO DP013-PARAGRAPH             13186099
131870         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   13187099
131880                                   TO DP013-MESSAGE-TEXT (1)      13188099
131890         MOVE SQLCA                TO DP013-SQLCA                 13189099
131900         MOVE 'SHIP'                TO DP013-DB2-TABLE-NAME (1)   13190099
131910         SET DP013-DB2-ABEND                                      13191099
131920             DP013-XCTL-DISPLAY-RESTART                           13192099
131930                                   TO TRUE                        13193099
131940         PERFORM DP013-0000-PROCESS-ABEND                         13194099
131950     END-IF.                                                      13195099
131960 EJECT                                                            13196099
131970*----------------------------------------------------------------*13197099
131980*   CLOSE THE CURSOR                                             *13198099
131990*----------------------------------------------------------------*13199099
132000                                                                  13200099
132010 9990-CLOSE-SHIP-CSR.                                             13201099
132020     PERFORM                                                      13202099
132030         WITH TEST AFTER                                          13203099
132040         VARYING PV-RETRY-COUNTER                                 13204099
132050         FROM 1 BY 1                                              13205099
132060         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13206099
132070             OR (SQLCODE = ZERO))                                 13207099
132080*                                                                 13208099
132090         EXEC SQL                                                 13209099
132100             CLOSE SHIP_DATA_CSR                                  13210099
132110         END-EXEC                                                 13211099
132120*                                                                 13212099
132130         EVALUATE TRUE                                            13213099
132140             WHEN SQLCODE = ZERO                                  13214099
132150             WHEN SQLCODE = -904                                  13215099
132160             WHEN SQLCODE = -913                                  13216099
132170                 CONTINUE                                         13217099
132180             WHEN SQLWARN0 NOT = SPACES                           13218099
132190             WHEN SQLCODE < ZERO                                  13219099
132200             WHEN SQLCODE > ZERO                                  13220099
132210                 MOVE '9990-CLOSE-CURSOR'                         13221099
132220                                   TO DP013-PARAGRAPH             13222099
132230                 MOVE 'OPEN CURSOR - '                            13223099
132240                                   TO DP013-MESSAGE-TEXT (1)      13224099
132250                 MOVE SQLCA        TO DP013-SQLCA                 13225099
132260                 MOVE 'SHIP'        TO DP013-DB2-TABLE-NAME (1)   13226099
132270                 SET DP013-DB2-ABEND                              13227099
132280                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13228099
132290                 PERFORM DP013-0000-PROCESS-ABEND                 13229099
132300         END-EVALUATE                                             13230099
132310     END-PERFORM.                                                 13231099
132320*                                                                 13232099
132330     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13233099
132340         MOVE '9990-CLOSE-CURSOR'   TO DP013-PARAGRAPH            13234099
132350         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   13235099
132360                                   TO DP013-MESSAGE-TEXT (1)      13236099
132370         MOVE SQLCA                TO DP013-SQLCA                 13237099
132380         MOVE 'SHIP'                TO DP013-DB2-TABLE-NAME (1)   13238099
132390         SET DP013-DB2-ABEND                                      13239099
132400             DP013-XCTL-DISPLAY-RESTART                           13240099
132410                                   TO TRUE                        13241099
132420         PERFORM DP013-0000-PROCESS-ABEND                         13242099
132430     END-IF.                                                      13243099
132440 EJECT                                                            13244099
132450*----------------------------------------------------------------*13245099
132460* REBUILD UNSORTED CONTROL TABLE.                                *13246099
132470*----------------------------------------------------------------*13247099
132480                                                                  13248099
132490 10000-REBUILD-CONTROL-TABLES.                                    13249099
132500                                                                  13250099
132510*#VARIABLE_LOGIC_GROUP_2----------------------------------------* 13251099
132520*  THIS LOGIC TAKES THE COMMONAREA SORTED VARIABLE CONTROL      * 13252099
132530*  TABLE AND REBUILDS THE UNSORTED TABLE.                       * 13253099
132540*  ONLY THE USORT-SELECTED FIELD IS NEEDED THUS ONLY            * 13254099
132550*  IT IS BEING REBUILT.                                         * 13255099
132560*---------------------------------------------------------------* 13256099
132570     MOVE ASC-VCTL-SORTED-TABLE TO PV-VCTL-SORTED-TABLE.          13257099
132580     MOVE ASC-DC-TABLE TO PV-DC-TABLE.                            13258099
132590                                                                  13259099
132600     PERFORM WITH TEST AFTER                                      13260099
132610      VARYING PV-VSCTL-I FROM 1 BY 1                              13261099
132620      UNTIL PV-VSCTL-I > PC-MAX-VFLDS-LIMIT                       13262099
132630       IF PV-SORT-SELECTED(PV-VSCTL-I) = 'Y'                      13263099
132640          MOVE PV-SORT-POINTER(PV-VSCTL-I) TO PV-INDEX            13264099
132650          MOVE PV-SORT-SELECTED(PV-VSCTL-I)                       13265099
132660            TO PV-USORT-SELECTED(PV-INDEX)                        13266099
132670       END-IF                                                     13267099
132680     END-PERFORM.                                                 13268099
132690*#END_OF_VARIABLE_LOGIC------------------------------------------*13269099
132700                                                                  13270099
132710 EJECT                                                            13271099
132720*----------------------------------------------------------------*13272099
132730* ASK CICS FOR THE TIME                                          *13273099
132740*----------------------------------------------------------------*13274099
132750 10001-ASK-CICS-FOR-TIME.                                         13275099
132760                                                                  13276099
132770      EXEC CICS                                                   13277099
132780          ASKTIME ABSTIME(ASC-CICS-ABSTIME)                       13278099
132790          RESP (PV-CICS-RESP)                                     13279099
132800      END-EXEC.                                                   13280099
132810                                                                  13281099
132820                                                                  13282099
132830      IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                       13283099
132840          MOVE 0 TO ASC-CICS-ABSTIME                              13284099
132850      END-IF.                                                     13285099
132860                                                                  13286099
132870      DIVIDE ASC-CICS-ABSTIME BY 1000                             13287099
132880                    GIVING ASC-CICS-CURRENT-SECONDS.              13288099
132890                                                                  13289099
132900*----------------------------------------------------------------*13290099
132910* WRITE TO THE CICS LOG FOR MONITORING                           *13291099
132920*----------------------------------------------------------------*13292099
132930 10002-WRITE-SQL-TO-CICS.                                         13293099
132940                                                                  13294099
132950     IF PV-CICS-MSG-SQL1 NOT = SPACES                             13295099
132960     EXEC CICS                                                    13296099
132970         WRITEQ TD                                                13297099
132980             QUEUE  ('CSSL')                                      13298099
132990             FROM   (PV-CICS-MSG-SQL1)                            13299099
133000             RESP   (PV-CICS-RESP)                                13300099
133010     END-EXEC.                                                    13301099
133020     IF PV-CICS-MSG-SQL2 NOT = SPACES                             13302099
133030     EXEC CICS                                                    13303099
133040         WRITEQ TD                                                13304099
133050             QUEUE  ('CSSL')                                      13305099
133060             FROM   (PV-CICS-MSG-SQL2)                            13306099
133070             RESP   (PV-CICS-RESP)                                13307099
133080     END-EXEC.                                                    13308099
133090     IF PV-CICS-MSG-SQL3 NOT = SPACES                             13309099
133100     EXEC CICS                                                    13310099
133110         WRITEQ TD                                                13311099
133120             QUEUE  ('CSSL')                                      13312099
133130             FROM   (PV-CICS-MSG-SQL3)                            13313099
133140             RESP   (PV-CICS-RESP)                                13314099
133150     END-EXEC.                                                    13315099
133160     IF PV-CICS-MSG-SQL4 NOT = SPACES                             13316099
133170     EXEC CICS                                                    13317099
133180         WRITEQ TD                                                13318099
133190             QUEUE  ('CSSL')                                      13319099
133200             FROM   (PV-CICS-MSG-SQL4)                            13320099
133210             RESP   (PV-CICS-RESP)                                13321099
133220     END-EXEC.                                                    13322099
133230     IF PV-CICS-MSG-SQL5 NOT = SPACES                             13323099
133240     EXEC CICS                                                    13324099
133250         WRITEQ TD                                                13325099
133260             QUEUE  ('CSSL')                                      13326099
133270             FROM   (PV-CICS-MSG-SQL5)                            13327099
133280             RESP   (PV-CICS-RESP)                                13328099
133290     END-EXEC.                                                    13329099
133300*----------------------------------------------------------------*13330099
133310* WRITE TO THE CICS LOG FOR MONITORING                           *13331099
133320*----------------------------------------------------------------*13332099
133330 10003-WRITE-CICS-LOG.                                            13333099
133340                                                                  13334099
133350     EXEC CICS                                                    13335099
133360         WRITEQ TD                                                13336099
133370             QUEUE  ('CSSL')                                      13337099
133380             FROM   (PV-CICS-MSG-AREA)                            13338099
133390             RESP   (PV-CICS-RESP)                                13339099
133400     END-EXEC.                                                    13340099
133410     MOVE +1                      TO ASC-TASK-POINTER.            13341099
133420     MOVE SPACES                  TO PV-CICS-MSG-AREA.            13342099
133430                                                                  13343099
133440*----------------------------------------------------------------*13344099
133450* FIND THE TIME FROM THE LAST TASK PROCESSED.                    *13345099
133460*----------------------------------------------------------------*13346099
133470 10004-ASK-DURATION-OF-TASK.                                      13347099
133480                                                                  13348099
133490      SUBTRACT ASC-CICS-CURRENT-SECONDS                           13349099
133500        FROM ASC-CICS-LAST-SECONDS GIVING ASC-TASK-DURATION.      13350099
133510*----------------------------------------------------------------*13351099
133520* ASK CICS FOR THE TIME                                          *13352099
133530*----------------------------------------------------------------*13353099
133540 10005-FORMAT-CICS-TIME.                                          13354099
133550                                                                  13355099
133560      EXEC CICS                                                   13356099
133570          FORMATTIME ABSTIME(ASC-CICS-ABSTIME)                    13357099
133580                     DATE(ASC-CICS-DATE)                          13358099
133590                     TIME(ASC-CICS-TIME)                          13359099
133600                     TIMESEP(':')                                 13360099
133610          RESP (PV-CICS-RESP)                                     13361099
133620      END-EXEC.                                                   13362099
133630                                                                  13363099
133640     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        13364099
133650         MOVE 0 TO ASC-CICS-ABSTIME                               13365099
133660         MOVE SPACES TO ASC-CICS-TIME                             13366099
133670     END-IF.                                                      13367099
133680                                                                  13368099
133690*----------------------------------------------------------------*13369099
133700* SAVE THE CICS TIME.                                            *13370099
133710*----------------------------------------------------------------*13371099
133720 10006-SAVE-LAST-TASK-TIME.                                       13372099
133730      MOVE ASC-CICS-CURRENT-SECONDS TO ASC-CICS-LAST-SECONDS.     13373099
133740                                                                  13374099
133750*----------------------------------------------------------------*13375099
133760* SAVE THE CICS TIME.                                            *13376099
133770*----------------------------------------------------------------*13377099
133780 10007-STRING-TIME-MESSAGE.                                       13378099
133790                                                                  13379099
133800     IF ASC-TASK-ID < 7                                           13380099
133810                                                                  13381099
133820      IF ASC-TASK-POINTER = 1                                     13382099
133830        MOVE SPACES TO PV-CICS-MSG-AREA                           13383099
133840        IF ASC-MAX-GROUPS = 1                                     13384099
133850          MOVE 'S' TO PV-MAX-GROUP-FMT                            13385099
133860        ELSE                                                      13386099
133870          MOVE 'A' TO PV-MAX-GROUP-FMT                            13387099
133880        END-IF                                                    13388099
133890        STRING                                                    13389099
133900            ' Y196'                      DELIMITED BY SIZE,       13390099
133910            '|'                          DELIMITED BY SIZE,       13391099
133920            DP020-USERID (1:7)           DELIMITED BY SIZE,       13392099
133930            '|'                          DELIMITED BY SIZE,       13393099
133940            ASC-CICS-TIME                DELIMITED BY SIZE        13394099
133950            '|'                          DELIMITED BY SIZE,       13395099
133960            PV-MAX-GROUP-FMT             DELIMITED BY SIZE        13396099
133970        INTO                                                      13397099
133980            PV-CICS-MSG-AREA                                      13398099
133990        WITH                                                      13399099
134000            POINTER ASC-TASK-POINTER                              13400099
134010      END-IF                                                      13401099
134020      IF ASC-TASK-ID = 6                                          13402099
134030           STRING                                                 13403099
134040               '|'                 DELIMITED BY SIZE,             13404099
134050               ASC-CICS-TIME       DELIMITED BY SIZE              13405099
134060           INTO                                                   13406099
134070               PV-CICS-MSG-AREA                                   13407099
134080           WITH                                                   13408099
134090               POINTER ASC-TASK-POINTER                           13409099
134100                                                                  13410099
134110           MOVE ASC-NUMBER-OF-POS-READ TO PV-POS-READ-FMT         13411099
134120           STRING                                                 13412099
134130              '|'                  DELIMITED BY SIZE,             13413099
134140              PV-POS-READ-FMT      DELIMITED BY SIZE,             13414099
134150              '|'                  DELIMITED BY SIZE,             13415099
134160              ASC-GROUPS-LOADED    DELIMITED BY SIZE,             13416099
134170              '|'                  DELIMITED BY SIZE              13417099
134180           INTO                                                   13418099
134190              PV-CICS-MSG-AREA                                    13419099
134200           WITH                                                   13420099
134210              POINTER ASC-TASK-POINTER                            13421099
134220                                                                  13422099
134230      ELSE                                                        13423099
134240         MOVE ASC-TASK-TIME     TO PV-TASK-DUR-DUMP               13424099
134250                                                                  13425099
134260         STRING                                                   13426099
134270            '|'                    DELIMITED BY SIZE,             13427099
134280            ASC-TASK-ID            DELIMITED BY SIZE,             13428099
134290            '|'                    DELIMITED BY SIZE,             13429099
134300            PV-TASK-DUR-DUMP       DELIMITED BY SIZE              13430099
134310         INTO                                                     13431099
134320            PV-CICS-MSG-AREA                                      13432099
134330         WITH                                                     13433099
134340            POINTER ASC-TASK-POINTER                              13434099
134350      END-IF                                                      13435099
134360     END-IF.                                                      13436099
134370                                                                  13437099
134380                                                                  13438099
134390*----------------------------------------------------------------*13439099
134400* SAVE THE CICS DB TIME.                                         *13440099
134410*----------------------------------------------------------------*13441099
134420 10008-SAVE-LAST-DB-TIME.                                         13442099
134430      MOVE ASC-CICS-CURRENT-SECONDS TO ASC-LAST-DB-SECONDS.       13443099
134440                                                                  13444099
134450*----------------------------------------------------------------*13445099
134460* FIND THE TIME FROM THE LAST TASK PROCESSED.                    *13446099
134470*----------------------------------------------------------------*13447099
134480 10009-ASK-DURATION-OF-DB-TASK.                                   13448099
134490                                                                  13449099
134500      SUBTRACT ASC-CICS-CURRENT-SECONDS                           13450099
134510        FROM ASC-LAST-DB-SECONDS GIVING ASC-TASK-DURATION.        13451099
134520                                                                  13452099
134530*----------------------------------------------------------------*13453099
134540*    ABEND PROCESSOR MODULE                                      *13454099
134550*----------------------------------------------------------------*13455099
134560                                                                  13456099
134570     COPY DPPD013.                                                13457099
