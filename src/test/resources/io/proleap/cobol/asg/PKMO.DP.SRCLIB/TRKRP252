000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKRP252.                                         00050000
000600 AUTHOR.        MIKE FRIESS                                       00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   AUG.,1998.                                        00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200*  THIS PROGRAM CREATES A DETAIL REPORT OF DATA THAT WAS LOADED   00120000
001300*  TO THE DB2 TABLES IN TRKUP255.                                 00130001
001400*----------------------------------------------------------------*00140000
      * ****************************************************************00141005
      * CHANGE DESCRIPTION                                              00142005
      * ****************************************************************00143005
      * DATE  07/01/2010                                                00144005
      *  CHANGE MADE: ADDED THE NEW RECORD TYPE 'ARVDCN' WHICH WOULD    00145005
      *  CONTAIN INFORMATION PERTAINING TO THE ARRIVAL OF CONTAINERS AT 00146005
      *  THE DECONSOLIDATOR. THIS IS BEING DONE AS PART OF THE IMPORT   00147005
      *  REPLENISHMENT PROJECT 2010.                                    00148005
      * MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                  00149005
      * CHANGES TAGGED AS MS 07/01/2010                                 00149105
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000 CONFIGURATION SECTION.                                           00200000
002100                                                                  00210000
002200 SOURCE-COMPUTER.        IBM-3090.                                00220000
002300 OBJECT-COMPUTER.        IBM-3090.                                00230000
002400                                                                  00240000
002500 INPUT-OUTPUT SECTION.                                            00250000
002600                                                                  00260000
002700 FILE-CONTROL.                                                    00270000
002800                                                                  00280000
002900     SELECT LOAD-FILE                                             00290000
003000         ASSIGN TO INP01.                                         00300000
003100                                                                  00310000
003200     SELECT LOAD-REPORT-FILE                                      00320000
003300         ASSIGN TO RPT01.                                         00330000
003400                                                                  00340000
003500******************************************************************00350000
003600 DATA DIVISION.                                                   00360000
003700******************************************************************00370000
003800                                                                  00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  LOAD-FILE                                                    00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004400     BLOCK CONTAINS 0 RECORDS.                                    00440000
004500                                                                  00450000
004600 01  LOAD-RECORD                      PIC  X(508).                00460000
004700                                                                  00470000
004800                                                                  00480000
004900 FD  LOAD-REPORT-FILE                                             00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS.                                    00520000
005300                                                                  00530000
005400 01  LOAD-REPORT-RECORD               PIC  X(132).                00540000
005500                                                                  00550000
005600                                                                  00560000
005700*----------------------------------------------------------------*00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900*----------------------------------------------------------------*00590000
006000                                                                  00600000
006100*----------------------------------------------------------------*00610000
006200***  WORK FIELDS FOR THE LOAD REPORT                              00620000
006300*----------------------------------------------------------------*00630000
006400     COPY TRRD251.                                                00640002
006500                                                                  00650000
006600*----------------------------------------------------------------*00660000
006700***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00670000
006800*----------------------------------------------------------------*00680000
006900     COPY DPWS132O.                                               00690002
007000                                                                  00700000
007100 01  HL-P1-PAGE-HEADER-1.                                         00710000
007200         10 FILLER                   PIC  X(02)      VALUE SPACES.00720000
007300     05  HL-P1-TRANS-DATE.                                        00730000
007400         10 HL-P1-TRANS-MM           PIC  X(02)      VALUE SPACE. 00740000
007500         10 FILLER                   PIC  X(01)      VALUE '/'.   00750000
007600         10 HL-P1-TRANS-DD           PIC  X(02)      VALUE SPACE. 00760000
007700         10 FILLER                   PIC  X(01)      VALUE '/'.   00770000
007800         10 HL-P1-TRANS-YY           PIC  X(02)      VALUE SPACE. 00780000
007900     05  FILLER                      PIC  X(02)      VALUE SPACE. 00790000
008000     05  HL-P1-TRANS-TIME.                                        00800000
008100         10 HL-P1-TRANS-TIME-HH      PIC  X(02)      VALUE SPACE. 00810000
008200         10 FILLER                   PIC  X(01)      VALUE ':'.   00820000
008300         10 HL-P1-TRANS-TIME-MM      PIC  X(02)      VALUE SPACE. 00830000
008400     05  FILLER                      PIC  X(01)      VALUE SPACE. 00840000
008500     05  FILLER                      PIC  X(13)      VALUE        00850000
008600         'TRANSMIT DATE'.                                         00860000
008700     05  FILLER                      PIC  X(16)      VALUE SPACE. 00870000
008800     05  FILLER                      PIC  X(38)      VALUE        00880000
008900         '    IMPORT PURCHASE ORDER TRACKING    '.                00890000
009000     05  FILLER                      PIC  X(18)      VALUE SPACE. 00900000
009100     05  FILLER                      PIC  X(07)      VALUE        00910000
009200         'FILE ID'.                                               00920000
009300     05  FILLER                      PIC  X(02)      VALUE SPACE. 00930000
009400     05  HL-P1-FILE-ID               PIC  X(09)      VALUE SPACE. 00940000
009500     05  FILLER                      PIC  X(12)      VALUE SPACE. 00950000
009600                                                                  00960000
009700 01  HL-P2-PAGE-HEADER-2.                                         00970000
009800         10 FILLER                   PIC  X(02)      VALUE SPACES.00980000
009900     05  HL-P2-LOAD-DATE.                                         00990000
010000         10 HL-P2-LOAD-MM            PIC  X(02)      VALUE SPACE. 01000000
010100         10 FILLER                   PIC  X(01)      VALUE '/'.   01010000
010200         10 HL-P2-LOAD-DD            PIC  X(02)      VALUE SPACE. 01020000
010300         10 FILLER                   PIC  X(01)      VALUE '/'.   01030000
010400         10 HL-P2-LOAD-YY            PIC  X(02)      VALUE SPACE. 01040000
010500     05  FILLER                      PIC  X(02)      VALUE SPACE. 01050000
010600     05  HL-P2-LOAD-TIME.                                         01060000
010700         10 HL-P2-LOAD-TIME-HH       PIC  X(02)      VALUE SPACE. 01070000
010800         10 FILLER                   PIC  X(01)      VALUE ':'.   01080000
010900         10 HL-P2-LOAD-TIME-MM       PIC  X(02)      VALUE SPACE. 01090000
011000     05  FILLER                      PIC  X(01)      VALUE SPACE. 01100000
011100     05  FILLER                      PIC  X(13)      VALUE        01110000
011200         'LOAD DATE    '.                                         01120000
011300     05  FILLER                      PIC  X(16)      VALUE SPACE. 01130000
011400     05  FILLER                      PIC  X(40)      VALUE        01140000
011500         ' VESSEL / VOYAGE DELIVERY LOAD DETAILS '.               01150000
011600     05  FILLER                      PIC  X(16)      VALUE SPACE. 01160000
011700     05  HL-P2-ENTITY                PIC  X(30)      VALUE SPACE. 01170000
011800     05  FILLER                      PIC  X(01)      VALUE SPACE. 01180000
011900                                                                  01190000
012000 01  HL-C1-CNTNR-HEADER-1.                                        01200000
012100     05  FILLER                      PIC  X(53)      VALUE SPACE. 01210000
012200     05  FILLER                      PIC  X(14)      VALUE        01220000
012300         'DECONSOLIDATER'.                                        01230000
012400     05  FILLER                      PIC  X(65)      VALUE SPACE. 01240000
012500                                                                  01250000
012600 01  HL-C2-CNTNR-HEADER-2.                                        01260000
012700     05  FILLER                      PIC  X(09)      VALUE        01270000
012800         'CONTAINER'.                                             01280000
012900     05  FILLER                      PIC  X(16)      VALUE SPACE. 01290000
013000     05  FILLER                      PIC  X(11)      VALUE        01300000
013100         'VESSEL NAME'.                                           01310000
013200     05  FILLER                      PIC  X(17)      VALUE SPACE. 01320000
013300     05  FILLER                      PIC  X(14)      VALUE        01330000
013400         '     SCAC     '.                                        01340000
013500     05  FILLER                      PIC  X(07)      VALUE SPACE. 01350000
013600     05  FILLER                      PIC  X(22)      VALUE        01360000
013700         '   PORT OF ENTRY      '.                                01370000
013800     05  HL-C2-TEXT-MSG              PIC  X(36)      VALUE SPACE. 01380000
013900                                                                  01390000
014000 01  DL-C1-CNTNR-LINE.                                            01400000
014100     05  DL-C1-CONTAINER            PIC  X(12)    VALUE SPACES.   01410000
014200     05  FILLER                     PIC  X(13)    VALUE SPACES.   01420000
014300     05  DL-C1-VESSEL-NAME          PIC  X(25)    VALUE SPACES.   01430000
014400     05  FILLER                     PIC  X(08)    VALUE SPACES.   01440000
014500     05  DL-C1-DCONSLR-SCAC         PIC  X(04)    VALUE SPACES.   01450000
014600     05  FILLER                     PIC  X(15)    VALUE SPACES.   01460000
014700     05  DL-C1-POE                  PIC  X(30)    VALUE SPACES.   01470000
014800     05  FILLER                     PIC  X(25)    VALUE SPACES.   01480000
014900                                                                  01490000
015000 01  HL-D1-DETAIL-HEADER-1.                                       01500000
015100     05  FILLER                      PIC  X(04)      VALUE        01510000
015200         'RECD'.                                                  01520000
015300     05  FILLER                      PIC  X(03)      VALUE SPACE. 01530000
015400     05  FILLER                      PIC  X(03)      VALUE        01540000
015500         'TRN'.                                                   01550000
015600     05  FILLER                      PIC  X(135)     VALUE SPACE. 01560000
015700                                                                  01570000
015800 01  HL-D2-DETAIL-HEADER-2.                                       01580000
015900     05  FILLER                      PIC  X(04)      VALUE        01590000
016000         'TYPE'.                                                  01600000
016100     05  FILLER                      PIC  X(03)      VALUE SPACE. 01610000
016200     05  FILLER                      PIC  X(04)      VALUE        01620000
016300         'TYPE'.                                                  01630000
016400     05  FILLER                      PIC  X(02)      VALUE SPACE. 01640000
016500     05  FILLER                      PIC  X(09)      VALUE        01650000
016600         'PO NUMBER'.                                             01660000
016700     05  FILLER                      PIC  X(03)      VALUE SPACE. 01670000
016800     05  FILLER                      PIC  X(22)      VALUE        01680000
016900         'EXTERNAL REFERENCE NBR'.                                01690000
017000     05  FILLER                      PIC  X(06)      VALUE SPACE. 01700000
017100     05  HL-D2-TIME-1-COL-HDR        PIC  X(29)      VALUE SPACE. 01710000
017200     05  FILLER                      PIC  X(49)      VALUE SPACE. 01720000
017300                                                                  01730000
017400 01  DL-D1-DETAIL-LINE.                                           01740000
017500     05  DL-D1-RECD-TYPE            PIC  X(06)    VALUE SPACES.   01750000
017600     05  FILLER                     PIC  X(03)    VALUE SPACES.   01760000
017700     05  DL-D1-TRN-TYP              PIC  X(01)    VALUE SPACES.   01770000
017800     05  FILLER                     PIC  X(03)    VALUE SPACES.   01780000
017900     05  DL-D1-PO-NBR               PIC  X(09)    VALUE SPACES.   01790000
018000     05  FILLER                     PIC  X(03)    VALUE SPACES.   01800000
018100     05  DL-D1-EXTL-REF-NBR         PIC  X(15)    VALUE SPACES.   01810000
018200     05  FILLER                     PIC  X(13)    VALUE SPACES.   01820000
018300     05  DL-D1-DATE-1.                                            01830000
018400         10  DL-D1-DATE-1-MM        PIC  X(02)    VALUE SPACES.   01840000
018500         10  DL-D1-DATE-1-SLASH-1   PIC  X(01)    VALUE SPACES.   01850000
018600         10  DL-D1-DATE-1-DD        PIC  X(02)    VALUE SPACES.   01860000
018700         10  DL-D1-DATE-1-SLASH-2   PIC  X(01)    VALUE SPACES.   01870000
018800         10  DL-D1-DATE-1-CCYY      PIC  X(04)    VALUE SPACES.   01880000
018900     05  FILLER                     PIC  X(02)    VALUE SPACES.   01890000
019000     05  DL-D1-TIME-1.                                            01900000
019100         10  DL-D1-TIME-1-HH        PIC  X(02)    VALUE SPACES.   01910000
019200         10  DL-D1-TIME-1-COLON     PIC  X(01)    VALUE SPACES.   01920000
019300         10  DL-D1-TIME-1-MM        PIC  X(02)    VALUE SPACES.   01930000
019400                                                                  01940000
019500 01  TRL-HEADING-LINE-1.                                          01950000
019600     05  FILLER                      PIC  X(31)      VALUE        01960000
019700         'A = ADD, C = CHANGE, D = DELETE'.                       01970000
019800     05  FILLER                      PIC  X(101)     VALUE SPACE. 01980000
019900                                                                  01990000
020000 01  ER-END-OF-REPORT-LINE.                                       02000000
020100     05  FILLER                     PIC  X(54)    VALUE SPACE.    02010000
020200     05  FILLER                     PIC  X(25)    VALUE           02020000
020300         '***** END OF REPORT *****'.                             02030000
020400     05  FILLER                     PIC  X(53)    VALUE SPACE.    02040000
020500                                                                  02050000
020600 01  EP-EMPTY-REPORT-LINE.                                        02060000
020700     05  FILLER                     PIC  X(25)    VALUE           02070000
020800         '******* NO DATA *********'.                             02080000
020900     05  FILLER                     PIC  X(107)   VALUE SPACE.    02090000
021000                                                                  02100000
021100 01  PS-PROGRAM-SWITCHES.                                         02110000
021200     05  PS-EOF-LOAD-FILE-SW        PIC  X(01)    VALUE SPACE.    02120000
021300         88  PS-EOF-LOAD-FILE                     VALUE 'Y'.      02130000
021400     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    02140000
021500         88  PS-NEW-PAGE                          VALUE 'Y'.      02150000
021600         88  PS-NEW-PAGE-NO                       VALUE 'N'.      02160000
021700     05  PS-DETAIL-SW               PIC  X(01)    VALUE 'Y'.      02170000
021800         88  PS-DETAIL                            VALUE 'Y'.      02180000
021900         88  PS-DETAIL-NO                         VALUE 'N'.      02190000
022000                                                                  02200000
022100 01 PC-PROGRAM-CONSTANTS.                                         02210000
022200     05  PC-PAGE-SIZE-054           PIC S9(04)    VALUE +054      02220000
022300                                                  COMP SYNC.      02230000
022400     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      02240000
022500                                                  COMP SYNC.      02250000
022600     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +6        02260000
022700                                                  COMP SYNC.      02270000
022800     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        02280000
022900                                                  COMP SYNC.      02290000
023000     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       02300000
023100                                                  COMP SYNC.      02310000
023200     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           02320000
023300         'TRKRP252'.                                              02330000
023400     05  PC-A                       PIC  X(01)    VALUE 'A'.      02340000
023500     05  PC-01                      PIC  X(02)    VALUE '01'.     02350000
023600                                                                  02360000
023700     05  PC-DEFAULT-DATE            PIC  X(10)    VALUE           02370000
023800         '01 01 0001'.                                            02380000
023900     05  PC-DEFAULT-TIME            PIC  X(05)    VALUE           02390000
024000         '00 00'.                                                 02400000
024100     05  PC-RECYCLE-TEXT            PIC  X(36)    VALUE           02410000
024200         'RDD - RECYCLE FROM CONTAINER DELETE '.                  02420000
024300                                                                  02430000
024400                                                                  02440000
024500 01  PV-PROGRAM-VARIABLES.                                        02450000
024600     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      02460000
024700                                                  COMP SYNC.      02470000
024800     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   02480000
024900     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   02490000
025000     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   02500000
025100         88 PV-ADU-REC-TYP-CDE-ADU       VALUE 'ADU  '.           02510000
025200         88 PV-ADD-REC-TYP-CDE-ADD       VALUE 'ADD  '.           02520000
025300         88 PV-ETA-REC-TYP-CDE-ETA       VALUE 'ETA  '.           02530000
025400     05  PV-PREV-CONTNR-ID          PIC  X(15)    VALUE SPACES.   02540000
025500     05  PV-PREV-TRN-TYP            PIC  X(01)    VALUE SPACES.   02550000
025600     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   02560000
025700     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     02570000
025800                                                                  02580000
025900 01  SD-SYSTEM-DATE.                                              02590000
026000     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   02600000
026100     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   02610000
026200     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   02620000
026300                                                                  02630000
026400 01  ST-SYSTEM-TIME.                                              02640000
026500     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   02650000
026600     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   02660000
026700     05  FILLER                     PIC  9(04)      VALUE ZERO.   02670000
026800                                                                  02680000
026900******************************************************************02690000
027000 PROCEDURE DIVISION.                                              02700000
027100******************************************************************02710000
027200                                                                  02720000
027300*----------------------------------------------------------------*02730000
027400* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     02740000
027500*      PROGRAM.                                                   02750000
027600*----------------------------------------------------------------*02760000
027700                                                                  02770000
027800 0000-PROGRAM-MAINLINE.                                           02780000
027900                                                                  02790000
028000     PERFORM 1000-INITIALIZE.                                     02800000
028100                                                                  02810000
028200     IF PS-DETAIL-NO                                              02820000
028300        CONTINUE                                                  02830000
028400     ELSE                                                         02840000
028500        PERFORM 2000-PROCESS-REPORT-DATA                          02850000
028600          UNTIL PS-EOF-LOAD-FILE.                                 02860000
028700                                                                  02870000
028800     PERFORM 9000-EOJ-ROUTINE.                                    02880000
028900                                                                  02890000
029000     STOP RUN.                                                    02900000
029100                                                                  02910000
029200******************************************************************02920000
029300*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    02930000
029400*    -- OPEN FILES                                                02940000
029500*    -- SET UP AND PRINT REPORT HEADINGS                          02950000
029600******************************************************************02960000
029700                                                                  02970000
029800 1000-INITIALIZE.                                                 02980000
029900                                                                  02990000
030000     OPEN INPUT  LOAD-FILE                                        03000000
030100          OUTPUT LOAD-REPORT-FILE.                                03010000
030200                                                                  03020000
030300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03030000
030400     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03040000
030500                                                                  03050000
030600     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03060000
030700     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03070000
030800     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03080000
030900     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03090000
031000     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03100000
031100                                                                  03110000
031200     MOVE PC-CURRENT-PROGRAM-NAME                                 03120000
031300                                 TO DP132O-PROGRAM-NAME.          03130000
031400                                                                  03140000
031500     MOVE 1                      TO DP132O-REPORT-NUMBER.         03150000
031600                                                                  03160000
031700     INITIALIZE     PS-NEW-PAGE-SW.                               03170000
031800                                                                  03180000
031900     PERFORM 7000-READ-LOAD-FILE UNTIL                            03190000
032000             PS-EOF-LOAD-FILE OR                                  03200000
032100            (TR251-RPT-TYP-DETAIL AND                             03210000
032200             NOT TR251-REC-TYP-HDR-CDE-HDR).                      03220000
032300                                                                  03230000
032400     IF PS-EOF-LOAD-FILE                                          03240000
032500        CONTINUE                                                  03250000
032600     ELSE                                                         03260000
032700        PERFORM 2060-MOVE-CNTNR-LINE-FIELDS                       03270000
032800     END-IF.                                                      03280000
032900                                                                  03290000
033000     PERFORM  8000-WRITE-PAGE-HEADINGS.                           03300000
033100                                                                  03310000
033200     IF TR251-ERROR-TYPE = 'EMT' OR                               03320000
033300        PS-EOF-LOAD-FILE                                          03330000
033400        SET PS-DETAIL-NO TO TRUE                                  03340000
033500     ELSE                                                         03350000
033600        PERFORM 2025-BUILD-LOAD-RPT-DATA                          03360000
033700     END-IF.                                                      03370000
033800                                                                  03380000
033900****************************************************************  03390000
034000*  PROCESSING FOR LOAD RECORDS.                                   03400000
034100******************************************************************03410000
034200                                                                  03420000
034300 2000-PROCESS-REPORT-DATA.                                        03430000
034400                                                                  03440000
034500     MOVE SPACES TO TR251-RPT-TYP.                                03450000
034600                                                                  03460000
034700     PERFORM 7000-READ-LOAD-FILE UNTIL                            03470000
034800             PS-EOF-LOAD-FILE OR                                  03480000
034900            (TR251-RPT-TYP-DETAIL AND                             03490000
035000             NOT TR251-REC-TYP-HDR-CDE-HDR)                       03500000
035100                                                                  03510000
035200     IF PS-EOF-LOAD-FILE                                          03520000
035300        CONTINUE                                                  03530000
035400     ELSE                                                         03540000
035500        IF TR251-RPT-TYP-DETAIL                                   03550000
035600           PERFORM 2025-BUILD-LOAD-RPT-DATA                       03560000
035700        END-IF                                                    03570000
035800     END-IF.                                                      03580000
035900                                                                  03590000
036000******************************************************************03600000
036100*  BUILD THE LINES FOR THE REPORT.                                03610000
036200******************************************************************03620000
036300                                                                  03630000
      * MS 07/01/2010                                                   03631007
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.     03632007
                                                                        03633007
036400 2025-BUILD-LOAD-RPT-DATA.                                        03640000
036500                                                                  03650000
036600     IF TR251-REC-TYP-DVN-CDE-DVN  OR                             03660000
036700        TR251-REC-TYP-DVNRD-CDE-DVNRDD                            03670000
036800        PERFORM 3500-MOVE-DVN-TO-DETAIL                           03680000
036900     END-IF.                                                      03690000
037000                                                                  03700000
037100     IF TR251-REC-TYP-DPU-CDE-DPU  OR                             03710000
037200        TR251-REC-TYP-DPURD-CDE-DPURDD                            03720000
037300        PERFORM 3600-MOVE-DPU-TO-DETAIL                           03730000
037400     END-IF.                                                      03740000
037500                                                                  03750000
037600     IF TR251-REC-TYP-DLV-CDE-DLV  OR                             03760000
037700        TR251-REC-TYP-DLVRD-CDE-DLVRDD                            03770000
037800        PERFORM 3700-MOVE-DLV-TO-DETAIL                           03780000
037900     END-IF.                                                      03790000
038000                                                                  03800000
038100     IF TR251-REC-TYP-CRP-CDE-CRP  OR                             03810000
038200        TR251-REC-TYP-CRPRD-CDE-CRPRDD                            03820000
038300        PERFORM 3710-MOVE-CRP-TO-DETAIL                           03830000
038400     END-IF.                                                      03840000
038500                                                                  03850000
038600     IF TR251-REC-TYP-RTN-CDE-RTN  OR                             03860000
038700        TR251-REC-TYP-RTNRD-CDE-RTNRDD                            03870000
038800        PERFORM 3720-MOVE-RTN-TO-DETAIL                           03880000
038900     END-IF.                                                      03890000
                                                                        03891007
           IF TR251-REC-TYP-ARVDCN-CD-ARVDCN  OR                        03892003
              TR251-REC-TYP-ARVDRD-CD-ARVDRD                            03893003
              PERFORM 3730-MOVE-ARVDCN-TO-DETAIL                        03894002
           END-IF.                                                      03895005
039000                                                                  03900000
039100*    *********************************************                03910000
039200*    * CLEAN UP DATE/TIME FIELDS BEFORE PRINT    *                03920000
039300*    *********************************************                03930000
039400     IF DL-D1-DATE-1-MM      NOT NUMERIC OR                       03940000
039500        DL-D1-DATE-1       = PC-DEFAULT-DATE                      03950000
039600        MOVE SPACES TO DL-D1-DATE-1                               03960000
039700     ELSE                                                         03970000
039800        MOVE '/'   TO DL-D1-DATE-1-SLASH-1                        03980000
039900                      DL-D1-DATE-1-SLASH-2                        03990000
040000     END-IF.                                                      04000000
040100                                                                  04010000
040200     IF DL-D1-TIME-1-HH      NOT NUMERIC OR                       04020000
040300        DL-D1-TIME-1       = PC-DEFAULT-TIME                      04030000
040400        MOVE SPACES TO DL-D1-TIME-1                               04040000
040500     ELSE                                                         04050000
040600        MOVE ':' TO DL-D1-TIME-1-COLON                            04060000
040700     END-IF.                                                      04070000
040800                                                                  04080000
040900     PERFORM 2050-CHECK-FOR-PREVIOUS.                             04090000
041000                                                                  04100000
041100     PERFORM 8100-WRITE-LOAD-RPT-DETAIL.                          04110000
041200                                                                  04120000
041300****************************************************************  04130000
041400*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             04140000
041500*  DATA IS NOT REPEATED FOR CONTAINER-NO                          04150000
041600* *************************************************************** 04160000
041700                                                                  04170000
041800 2050-CHECK-FOR-PREVIOUS.                                         04180000
041900                                                                  04190000
042000                                                                  04200000
042100     IF TR251-CONTNR-ID = PV-PREV-CONTNR-ID  AND                  04210000
042200        TR251-TRN-TYP   = PV-PREV-TRN-TYP    AND                  04220000
042300        (TR251-ERROR-TYPE   NOT =  'EDI')                         04230000
042400        CONTINUE                                                  04240000
042500     ELSE                                                         04250000
042600        PERFORM 2060-MOVE-CNTNR-LINE-FIELDS                       04260000
042700        SET PS-NEW-PAGE         TO TRUE                           04270000
042800        PERFORM  8000-WRITE-PAGE-HEADINGS                         04280000
042900     END-IF.                                                      04290000
043000                                                                  04300000
043100****************************************************************  04310000
043200*  THESE FIELDS GET MOVED ONLY WHEN THERE'S A CONTAINER BREAK.    04320000
043300* *************************************************************** 04330000
043400                                                                  04340000
043500 2060-MOVE-CNTNR-LINE-FIELDS.                                     04350000
043600                                                                  04360000
043700     MOVE TR251-CONTNR-ID     TO DL-C1-CONTAINER                  04370000
043800                                 PV-PREV-CONTNR-ID.               04380000
043900     MOVE TR251-TRN-TYP       TO PV-PREV-TRN-TYP.                 04390000
044000     MOVE TR251-DPU-IMPRT-VEH-NM                                  04400000
044100                              TO DL-C1-VESSEL-NAME.               04410000
044200     MOVE TR251-DCONSLR-SCAC-ID                                   04420000
044300                              TO DL-C1-DCONSLR-SCAC.              04430000
044400     MOVE TR251-POE-NM        TO DL-C1-POE.                       04440000
044500                                                                  04450000
044600******************************************************************04460000
044700* MOVE DVN DATA TO REPORT DETAIL LINE                             04470000
044800******************************************************************04480000
044900                                                                  04490000
045000 3500-MOVE-DVN-TO-DETAIL.                                         04500000
045100                                                                  04510000
045200     INITIALIZE   DL-D1-DETAIL-LINE.                              04520000
045300                                                                  04530000
045400     MOVE TR251-REC-TYP-DVN-CDE (1:3) TO DL-D1-RECD-TYPE.         04540000
045500     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           04550000
045600     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            04560000
045700     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      04570000
045800                                                                  04580000
045900                                                                  04590000
046000     MOVE TR251-DVN-CONTNR-DEVAN-DTE (1:4) TO                     04600000
046100         DL-D1-DATE-1-CCYY.                                       04610000
046200     MOVE TR251-DVN-CONTNR-DEVAN-DTE (5:2) TO                     04620000
046300         DL-D1-DATE-1-MM.                                         04630000
046400     MOVE TR251-DVN-CONTNR-DEVAN-DTE (7:2) TO                     04640000
046500         DL-D1-DATE-1-DD.                                         04650000
046600                                                                  04660000
046700     MOVE TR251-DVN-CONTNR-DEVAN-TM (1:2) TO                      04670000
046800         DL-D1-TIME-1-HH.                                         04680000
046900     MOVE TR251-DVN-CONTNR-DEVAN-TM (3:2) TO                      04690000
047000         DL-D1-TIME-1-MM.                                         04700000
047100                                                                  04710000
047200     MOVE 'CONTAINER DEVAN '                                      04720000
047300                             TO HL-D2-TIME-1-COL-HDR.             04730000
047400                                                                  04740000
047500                                                                  04750000
047600******************************************************************04760000
047700* MOVE DPU DATA TO REPORT DETAIL LINE                             04770000
047800******************************************************************04780000
047900                                                                  04790000
048000 3600-MOVE-DPU-TO-DETAIL.                                         04800000
048100                                                                  04810000
048200     INITIALIZE  DL-D1-DETAIL-LINE.                               04820000
048300                                                                  04830000
048400     MOVE TR251-REC-TYP-DPU-CDE (1:3) TO DL-D1-RECD-TYPE.         04840000
048500     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           04850000
048600     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            04860000
048700     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      04870000
048800                                                                  04880000
048900                                                                  04890000
049000     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (1:4) TO                    04900000
049100         DL-D1-DATE-1-CCYY.                                       04910000
049200     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (5:2) TO                    04920000
049300         DL-D1-DATE-1-MM.                                         04930000
049400     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (7:2) TO                    04940000
049500         DL-D1-DATE-1-DD.                                         04950000
049600                                                                  04960000
049700     MOVE TR251-DPU-DELY-ORD-RCVD-TM (1:2) TO                     04970000
049800           DL-D1-TIME-1-HH.                                       04980000
049900     MOVE TR251-DPU-DELY-ORD-RCVD-TM (3:2) TO                     04990000
050000           DL-D1-TIME-1-MM.                                       05000000
050100                                                                  05010000
050200     MOVE 'DLV ORDER RCVD   '                                     05020000
050300                             TO HL-D2-TIME-1-COL-HDR.             05030000
050400                                                                  05040000
050500******************************************************************05050000
050600* MOVE DLV DATA TO REPORT DETAIL LINE                             05060000
050700******************************************************************05070000
050800                                                                  05080000
050900 3700-MOVE-DLV-TO-DETAIL.                                         05090000
051000                                                                  05100000
051100     INITIALIZE   DL-D1-DETAIL-LINE.                              05110000
051200                                                                  05120000
051300     MOVE TR251-REC-TYP-DLV-CDE (1:3) TO DL-D1-RECD-TYPE.         05130000
051400     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05140000
051500     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05150000
051600     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05160000
051700                                                                  05170000
051800     MOVE TR251-DLV-CONTNR-PCKUP-DTE (1:4) TO                     05180000
051900         DL-D1-DATE-1-CCYY.                                       05190000
052000     MOVE TR251-DLV-CONTNR-PCKUP-DTE (5:2) TO                     05200000
052100         DL-D1-DATE-1-MM.                                         05210000
052200     MOVE TR251-DLV-CONTNR-PCKUP-DTE (7:2) TO                     05220000
052300         DL-D1-DATE-1-DD.                                         05230000
052400                                                                  05240000
052500     MOVE TR251-DLV-CONTNR-PCKUP-TM (1:2) TO                      05250000
052600           DL-D1-TIME-1-HH.                                       05260000
052700     MOVE TR251-DLV-CONTNR-PCKUP-TM (3:2) TO                      05270000
052800           DL-D1-TIME-1-MM.                                       05280000
052900                                                                  05290000
053000     MOVE 'CONTAINER PICKUP '                                     05300000
053100                             TO HL-D2-TIME-1-COL-HDR.             05310000
053200                                                                  05320000
053300                                                                  05330000
053400******************************************************************05340000
053500* MOVE CRP DATA TO REPORT DETAIL LINE                             05350000
053600******************************************************************05360000
053700                                                                  05370000
053800 3710-MOVE-CRP-TO-DETAIL.                                         05380000
053900                                                                  05390000
054000     INITIALIZE   DL-D1-DETAIL-LINE.                              05400000
054100                                                                  05410000
054200     MOVE TR251-REC-TYP-CRP-CDE (1:3) TO DL-D1-RECD-TYPE.         05420000
054300     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05430000
054400     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05440000
054500     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05450000
054600                                                                  05460000
054700     MOVE TR251-CRP-FRGT-RLSE-DTE (1:4) TO                        05470000
054800         DL-D1-DATE-1-CCYY.                                       05480000
054900     MOVE TR251-CRP-FRGT-RLSE-DTE (5:2) TO                        05490000
055000         DL-D1-DATE-1-MM.                                         05500000
055100     MOVE TR251-CRP-FRGT-RLSE-DTE (7:2) TO                        05510000
055200         DL-D1-DATE-1-DD.                                         05520000
055300                                                                  05530000
055400     MOVE TR251-CRP-FRGT-RLSE-TM (1:2) TO                         05540000
055500           DL-D1-TIME-1-HH.                                       05550000
055600     MOVE TR251-CRP-FRGT-RLSE-TM (3:2) TO                         05560000
055700           DL-D1-TIME-1-MM.                                       05570000
055800                                                                  05580000
055900     MOVE 'CONTAINER READY FOR PICKUP '                           05590000
056000                             TO HL-D2-TIME-1-COL-HDR.             05600000
056100                                                                  05610000
056200                                                                  05620000
056300******************************************************************05630000
056400* MOVE RTN DATA TO REPORT DETAIL LINE                             05640000
056500******************************************************************05650000
056600                                                                  05660000
056700 3720-MOVE-RTN-TO-DETAIL.                                         05670000
056800                                                                  05680000
056900     INITIALIZE   DL-D1-DETAIL-LINE.                              05690000
057000                                                                  05700000
057100     MOVE TR251-REC-TYP-CRP-CDE (1:3) TO DL-D1-RECD-TYPE.         05710000
057200     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05720000
057300     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05730000
057400     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05740000
057500                                                                  05750000
057600     MOVE TR251-RTN-CONTNR-RETURN-DTE (1:4) TO                    05760000
057700         DL-D1-DATE-1-CCYY.                                       05770000
057800     MOVE TR251-RTN-CONTNR-RETURN-DTE (5:2) TO                    05780000
057900         DL-D1-DATE-1-MM.                                         05790000
058000     MOVE TR251-RTN-CONTNR-RETURN-DTE (7:2) TO                    05800000
058100         DL-D1-DATE-1-DD.                                         05810000
058200                                                                  05820000
058300     MOVE TR251-RTN-CONTNR-RETURN-TM (1:2) TO                     05830000
058400           DL-D1-TIME-1-HH.                                       05840000
058500     MOVE TR251-RTN-CONTNR-RETURN-TM (3:2) TO                     05850000
058600           DL-D1-TIME-1-MM.                                       05860000
058700                                                                  05870000
058800     MOVE 'CONTAINER RETURNED '                                   05880000
058900                             TO HL-D2-TIME-1-COL-HDR.             05890000
059000                                                                  05900000
      * ADDED PARA 3730 FOR THE PROCESSING OF ARVDCN RECORDS.           05900106
      * MS 07/01/2010 BEG                                               05900205
                                                                        05900305
       3730-MOVE-ARVDCN-TO-DETAIL.                                      05901005
                                                                        05902002
           INITIALIZE  DL-D1-DETAIL-LINE                                05903002
                                                                        05904002
           MOVE TR251-REC-TYP-ARVDCN-CDE (1:6) TO DL-D1-RECD-TYPE.      05905108
           MOVE TR251-TRN-TYP                  TO DL-D1-TRN-TYP.        05906005
           MOVE TR251-PO-NBR                   TO DL-D1-PO-NBR.         05907005
           MOVE TR251-EXTL-REF-NBR             TO DL-D1-EXTL-REF-NBR.   05908005
                                                                        05909002
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (1:4) TO                  05909102
                  DL-D1-DATE-1-CCYY.                                    05909202
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (5:2) TO                  05909302
                  DL-D1-DATE-1-MM.                                      05909402
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (7:2) TO                  05909502
                  DL-D1-DATE-1-DD.                                      05909602
                                                                        05909702
           MOVE TR251-ARVDCN-ARRIVE-DECON-TM (1:2)  TO                  05909805
                  DL-D1-TIME-1-HH.                                      05909902
           MOVE TR251-ARVDCN-ARRIVE-DECON-TM (3:2)  TO                  05910005
                  DL-D1-TIME-1-MM.                                      05910102
                                                                        05910202
           MOVE 'CONTAINER ARRIVED AT DECON'                            05910302
                                                TO HL-D2-TIME-1-COL-HDR.05910405
      * MS 07/01/2010 END                                               05910505
059100                                                                  05911000
059200******************************************************************05920000
059300*  READ THE LOAD-FILE                                            *05930000
059400******************************************************************05940000
059500 7000-READ-LOAD-FILE.                                             05950000
059600                                                                  05960000
059700     READ LOAD-FILE                                               05970000
059800        INTO TR251-RECORD                                         05980000
059900           AT END                                                 05990000
060000              SET PS-EOF-LOAD-FILE TO TRUE.                       06000000
060100                                                                  06010000
060200     IF TR251-REC-TYP-HDR-CDE-HDR                                 06020000
060300        MOVE TR251-HDR-CONSOL-TRNS-DTE (5:2) TO                   06030000
060400           HL-P1-TRANS-MM                                         06040000
060500        MOVE TR251-HDR-CONSOL-TRNS-DTE (7:2) TO                   06050000
060600           HL-P1-TRANS-DD                                         06060000
060700        MOVE TR251-HDR-CONSOL-TRNS-DTE (3:2) TO                   06070000
060800           HL-P1-TRANS-YY                                         06080000
060900        MOVE TR251-HDR-CONSOL-TRNS-TM (1:2) TO                    06090000
061000           HL-P1-TRANS-TIME-HH                                    06100000
061100        MOVE TR251-HDR-CONSOL-TRNS-TM (3:2) TO                    06110000
061200           HL-P1-TRANS-TIME-MM                                    06120000
061300        MOVE TR251-HDR-CONSOL-FIL-ID TO                           06130000
061400           HL-P1-FILE-ID                                          06140000
061500        MOVE TR251-HDR-LOAD-DTE (5:2) TO                          06150000
061600           HL-P2-LOAD-MM                                          06160000
061700        MOVE TR251-HDR-LOAD-DTE (7:2) TO                          06170000
061800           HL-P2-LOAD-DD                                          06180000
061900        MOVE TR251-HDR-LOAD-DTE (3:2) TO                          06190000
062000           HL-P2-LOAD-YY                                          06200000
062100        MOVE TR251-HDR-LOAD-TM (1:2) TO                           06210000
062200           HL-P2-LOAD-TIME-HH                                     06220000
062300        MOVE TR251-HDR-LOAD-TM (3:2) TO                           06230000
062400           HL-P2-LOAD-TIME-MM                                     06240000
062500        MOVE TR251-HDR-CONSOL-ENTNME TO                           06250000
062600           HL-P2-ENTITY                                           06260000
062700        MOVE TR251-REC-TYP-HDR-CDE TO                             06270000
062800           PV-REC-TYP-CDE-PREV                                    06280000
062900     END-IF.                                                      06290000
063000                                                                  06300000
063100***************************************************************** 06310000
063200*  PRINT THE HEADINGS ON EACH PAGE.                             * 06320000
063300***************************************************************** 06330000
063400                                                                  06340000
      * MS 07/01/2010                                                   06341007
      * ADDED PROCESSING FOR ARVDRD RECORDS.                            06342007
                                                                        06343007
063500 8000-WRITE-PAGE-HEADINGS.                                        06350000
063600                                                                  06360000
063700     ADD 1                TO PV-PAGE-COUNT.                       06370000
063800     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  06380000
063900                                                                  06390000
064000     IF PV-PAGE-COUNT > 1                                         06400000
064100        PERFORM                                                   06410000
064200           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          06420000
064300           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 06430000
064400                                                                  06440000
064500           WRITE LOAD-REPORT-RECORD FROM PV-BLANK-LINE            06450000
064600              AFTER ADVANCING 1 LINE                              06460000
064700                                                                  06470000
064800        END-PERFORM                                               06480000
064900                                                                  06490000
065000        IF PV-LINES-USED > PC-PAGE-SIZE-060                       06500000
065100           WRITE LOAD-REPORT-RECORD FROM TRL-HEADING-LINE-1       06510000
065200              AFTER ADVANCING 2 LINES                             06520000
065300        END-IF                                                    06530000
065400     END-IF.                                                      06540000
065500                                                                  06550000
065600     WRITE LOAD-REPORT-RECORD FROM  DP132O-STANDRD-HEADER-132-COLS06560000
065700        AFTER ADVANCING PAGE.                                     06570000
065800                                                                  06580000
065900     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       06590000
066000                                                                  06600000
066100     WRITE LOAD-REPORT-RECORD FROM HL-P1-PAGE-HEADER-1            06610000
066200        AFTER ADVANCING 1 LINE.                                   06620000
066300                                                                  06630000
066400     WRITE LOAD-REPORT-RECORD FROM HL-P2-PAGE-HEADER-2            06640000
066500        AFTER ADVANCING 1 LINE.                                   06650000
066600                                                                  06660000
066700     WRITE LOAD-REPORT-RECORD FROM HL-C1-CNTNR-HEADER-1           06670000
066800        AFTER ADVANCING 2 LINES.                                  06680000
066900                                                                  06690000
067000     IF TR251-REC-TYP-DPURD-CDE-DPURDD  OR                        06700000
067100        TR251-REC-TYP-DLVRD-CDE-DLVRDD  OR                        06710000
067200        TR251-REC-TYP-DVNRD-CDE-DVNRDD  OR                        06720000
067300        TR251-REC-TYP-CRPRD-CDE-CRPRDD  OR                        06730000
              TR251-REC-TYP-RTNRD-CDE-RTNRDD  OR                        06741005
              TR251-REC-TYP-ARVDRD-CD-ARVDRD                            06742005
067500         MOVE PC-RECYCLE-TEXT         TO HL-C2-TEXT-MSG           06750000
067600     ELSE                                                         06760000
067700         MOVE SPACES                  TO HL-C2-TEXT-MSG           06770000
067800     END-IF.                                                      06780000
067900                                                                  06790000
068000     WRITE LOAD-REPORT-RECORD FROM HL-C2-CNTNR-HEADER-2           06800000
068100        AFTER ADVANCING 1 LINES.                                  06810000
068200                                                                  06820000
068300     WRITE LOAD-REPORT-RECORD FROM DL-C1-CNTNR-LINE               06830000
068400        AFTER ADVANCING 1 LINES.                                  06840000
068500                                                                  06850000
068600     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   06860000
068700                                                                  06870000
068800******************************************************************06880000
068900*  WRITE THE LOAD REPORT DETAIL RECORD.                           06890000
069000******************************************************************06900000
069100                                                                  06910000
      * MS 07/01/2010                                                   06911007
      * ADDED PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.         06912007
                                                                        06913007
069200 8100-WRITE-LOAD-RPT-DETAIL.                                      06920007
069300                                                                  06930000
069400     IF PV-LINES-USED >= PC-PAGE-SIZE-054                         06940000
069500        SET PS-NEW-PAGE  TO TRUE                                  06950000
069600        PERFORM 8000-WRITE-PAGE-HEADINGS                          06960000
069700     END-IF.                                                      06970000
069800                                                                  06980000
069900     EVALUATE TRUE                                                06990000
070000                                                                  07000000
070100       WHEN TR251-REC-TYP-DVN-CDE-DVN                             07010000
070200       WHEN TR251-REC-TYP-DPU-CDE-DPU                             07020000
070300       WHEN TR251-REC-TYP-DLV-CDE-DLV                             07030000
070400       WHEN TR251-REC-TYP-CRP-CDE-CRP                             07040000
070500       WHEN TR251-REC-TYP-RTN-CDE-RTN                             07050000
             WHEN TR251-REC-TYP-ARVDCN-CD-ARVDCN                        07051005
070600       WHEN TR251-REC-TYP-DVNRD-CDE-DVNRDD                        07060000
070700       WHEN TR251-REC-TYP-DPURD-CDE-DPURDD                        07070000
070800       WHEN TR251-REC-TYP-DLVRD-CDE-DLVRDD                        07080000
070900       WHEN TR251-REC-TYP-CRPRD-CDE-CRPRDD                        07090000
071000       WHEN TR251-REC-TYP-RTNRD-CDE-RTNRDD                        07100000
             WHEN TR251-REC-TYP-ARVDRD-CD-ARVDRD                        07101005
071100        PERFORM 8200-WRITE-DETAIL-RECORD                          07110000
071200                                                                  07120000
071300       WHEN OTHER                                                 07130000
071400        DISPLAY '** INVALID RECORD TYPE - '                       07140000
071500        DISPLAY  TR251-REC-TYP-DPU-CDE                            07150000
071600                                                                  07160000
071700     END-EVALUATE.                                                07170000
071800                                                                  07180000
071900******************************************************************07190000
072000*  PRINT DETAIL LOAD RECORD                                       07200000
072100******************************************************************07210000
072200                                                                  07220000
072300 8200-WRITE-DETAIL-RECORD.                                        07230000
072400                                                                  07240000
072500     IF TR251-REC-TYP-DPU-CDE = PV-REC-TYP-CDE-PREV AND           07250000
072600        PS-NEW-PAGE-NO                                            07260000
072700        CONTINUE                                                  07270000
072800     ELSE                                                         07280000
072900        WRITE LOAD-REPORT-RECORD FROM HL-D1-DETAIL-HEADER-1       07290000
073000           AFTER ADVANCING 2 LINES                                07300000
073100        WRITE LOAD-REPORT-RECORD FROM HL-D2-DETAIL-HEADER-2       07310000
073200           AFTER ADVANCING 1 LINES                                07320000
073300        ADD 3 TO PV-LINES-USED                                    07330000
073400     END-IF.                                                      07340000
073500                                                                  07350000
073600     WRITE LOAD-REPORT-RECORD FROM DL-D1-DETAIL-LINE              07360000
073700        AFTER ADVANCING 1 LINES.                                  07370000
073800     ADD 1 TO PV-LINES-USED.                                      07380000
073900                                                                  07390000
074000     SET PS-NEW-PAGE-NO TO TRUE.                                  07400000
074100     MOVE TR251-REC-TYP-DPU-CDE TO  PV-REC-TYP-CDE-PREV.          07410000
074200                                                                  07420000
074300******************************************************************07430000
074400*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  07440000
074500*  THE CURSOR.                                                    07450000
074600******************************************************************07460000
074700                                                                  07470000
074800 9000-EOJ-ROUTINE.                                                07480000
074900                                                                  07490000
075000     IF PS-DETAIL-NO                                              07500000
075100        WRITE LOAD-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE        07510000
075200            AFTER ADVANCING 2 LINES                               07520000
075300                                                                  07530000
075400        WRITE LOAD-REPORT-RECORD FROM ER-END-OF-REPORT-LINE       07540000
075500            AFTER ADVANCING 2 LINES                               07550000
075600     ELSE                                                         07560000
075700        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07570000
075800           PERFORM 8000-WRITE-PAGE-HEADINGS                       07580000
075900        END-IF                                                    07590000
076000                                                                  07600000
076100        WRITE LOAD-REPORT-RECORD FROM ER-END-OF-REPORT-LINE       07610000
076200            AFTER ADVANCING 2 LINES                               07620000
076300                                                                  07630000
076400        ADD 2 TO PV-LINES-USED                                    07640000
076500                                                                  07650000
076600        PERFORM                                                   07660000
076700           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          07670000
076800           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 07680000
076900                                                                  07690000
077000           WRITE LOAD-REPORT-RECORD FROM PV-BLANK-LINE            07700000
077100              AFTER ADVANCING 1 LINE                              07710000
077200                                                                  07720000
077300        END-PERFORM                                               07730000
077400                                                                  07740000
077500        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07750000
077600           WRITE LOAD-REPORT-RECORD FROM TRL-HEADING-LINE-1       07760000
077700              AFTER ADVANCING 2 LINES                             07770000
077800        END-IF                                                    07780000
077900     END-IF.                                                      07790000
078000                                                                  07800000
078100     CLOSE LOAD-FILE                                              07810000
078200           LOAD-REPORT-FILE.                                      07820000
