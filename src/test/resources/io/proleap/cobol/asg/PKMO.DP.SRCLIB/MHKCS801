      ******************************************************************00010014
       IDENTIFICATION DIVISION.                                         00020014
      ******************************************************************00030014
                                                                        00040014
       PROGRAM-ID.                MHKCS801.                             00050014
       AUTHOR.                    MARIA KLAMIK.                         00060014
       INSTALLATION.              KOHLS DEPARTMENT STORES.              00070014
       DATE-WRITTEN.              07-30-2004.                           00080014
       DATE-COMPILED.                                                   00090014
                                                                        00100014
      ******************************************************************00110014
      *               CICS PROGRAM - MHKCS801 - F801                   *00120014
      *                                                                *00130014
      *           MERCHANDISE INQUIRY - SKU LIST CRITERIA              *00140014
      *                                                                *00150014
      *  THIS PROGRAM ALLOWS THE USERS TO ENTER PARAMETERS TO          *00160014
      *  REQUEST AN ONLINE LIST OF SKUS.   DEPARTMENT IS THE ONLY      *00170014
      *  REQUIRED FIELD.  THE FOLLOWING SELECTION FIELDS MAY BE USED:  *00180014
      *                                                                *00190014
      *           DEPARTMENT       - A VALID 3 DIGIT DEPARTMENT NUMBER *00200014
      *                              OPTIONAL FIELD                    *00210014
      *           MAJOR CLASS      - A VALID 2 DIGIT MAJOR CLASS       *00220014
      *                              NUMBER                            *00230014
      *                              OPTIONAL FIELD                    *00240014
      *           SUBCLASS         - A VALID 2 DIGIT SUBCLASS NUMBER   *00250014
      *                              OPTIONAL FIELD                    *00260014
      *           SKU              - A VALID 8 DIGIT SKU NUMBER        *00270014
      *                              OPTIONAL FIELD                    *00280014
      *           UPC              - A VALID 14 DIGIT UPC NUMBER       *00290014
      *                              OPTIONAL FIELD                    *00300014
      *           STORE            - A VALID STORE NUMBER              *00310014
      *                              OPTIONAL FIELD                    *00320014
      *                                                                *00330014
      *  PLEASE NOTE THAT EITHER A DEPARTMENT, A SKU NUMBER OR A       *00340014
      *  UPC NUMBER MUST BE ENTERED.                                   *00350014
      *                                                                *00360014
      *  IF A VALID REQUEST HAS BEEN MADE, THE FOLLOWING APPLIES WHEN  *00370014
      *  DETERMINING THE SUBSEQUENT SCREEN TO DISPLAY:                 *00380014
      *                                                                *00390014
      *  IF ANY SYSTEM ERRORS ARE DETECTED, THAT THE PROGRAM CAN       *00400014
      *  NOT RESOLVE, THE PROGRAM WILL BE TERMINATED, AN ERROR         *00410014
      *  MESSAGE WILL BE DISPLAYED ON THE SCREEN, AND PROGRAM CONTROL  *00420014
      *  WILL BE RETURNED TO NATIVE CICS.                              *00430014
      *                                                                *00440014
      ******************************************************************00450014
      *  MAINTENANCE                                                   *00460014
      ******************************************************************00470014
      *  CHANGED 07/30/2004 REVISED BY MARIA KLAMIK -                  *00480014
      *    INITIAL INSTALLATION OF CRITERIA SCREEN.                    *00490014
      *                                            (WR# 26354)         *00500014
      ******************************************************************00510014
262978* CHANGED 10/21/2021    BY JIM HUNTER      WR: CHG0262978         00511077
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00512077
262978* MAKING THE CALL DYNAMIC VS STATIC.                              00513077
262978******************************************************************00514077
CICS  * CHANGED 10/28/2022    BY JIM HUNTER      WR: CHG0277420         00515078
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00516078
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00517078
CICS  ******************************************************************00518078
       ENVIRONMENT DIVISION.                                            00520014
      ******************************************************************00530014
                                                                        00540014
      ******************************************************************00550014
       DATA DIVISION.                                                   00560014
      ******************************************************************00570014
                                                                        00580014
                                                                        00590014
       WORKING-STORAGE SECTION.                                         00600014
      *                                                                 00610014
       01  PC-PROGRAM-CONSTANTS.                                        00620014
           05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'MH801A  '. 00630014
           05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'MHKM801 '. 00640014
           05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'MHKCS801'. 00650014
           05  PC-TSYMSG-NUMBERS.                                       00660014
               10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00670014
               10  PC-TSYMSG-00100       PIC  9(05)  VALUE  00100.      00690022
               10  PC-TSYMSG-00110       PIC  9(05)  VALUE  00110.      00691025
               10  PC-TSYMSG-00332       PIC  9(05)  VALUE  00332.      00701053
               10  PC-TSYMSG-00419       PIC  9(05)  VALUE  00419.      00730024
               10  PC-TSYMSG-01907       PIC  9(05)  VALUE  01907.      00731025
               10  PC-TSYMSG-02294       PIC  9(05)  VALUE  02294.      00732045
               10  PC-TSYMSG-02532       PIC  9(05)  VALUE  02532.      00740014
               10  PC-TSYMSG-02940       PIC  9(05)  VALUE  02940.      00741056
           05  PC-MAX-RETRIES            PIC S9(04)  VALUE  +3          00750045
                                                    COMP.               00760022
           05  PC-CORP-LOCATION          PIC X(05)   VALUE '00000'.     00761045
           05  PC-CORP-DESC              PIC X(10)                      00762045
                                         VALUE 'ALL STORES'.            00763045
      *                                                                 00770014
       01  PV-PROGRAM-VARIABLES.                                        00780065
           05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00790022
                                                    COMP SYNC.          00800022
           05  PV-UPC-NBR               PIC S9(15)V COMP-3 VALUE +0.    00810024
           05  PV-SKU-NBR               PIC S9(08)V COMP-3 VALUE +0.    00820024
           05  PV-DEPT-NBR              PIC 9(04).                      00821036
           05  PV-DEPT-NBR-CHAR-3.                                      00821136
               10 FILLER                PIC X(01).                      00822036
               10 PV-DEPT-NBR-3         PIC X(03).                      00823036
           05  PV-MCL-NBR               PIC 9(04).                      00824036
           05  PV-MCL-NBR-CHAR-2.                                       00824136
               10 FILLER                PIC X(02).                      00825036
               10 PV-MCL-NBR-2          PIC X(02).                      00826036
           05  PV-SCL-NBR               PIC 9(04).                      00826136
           05  PV-SCL-NBR-CHAR-2.                                       00827036
               10 FILLER                PIC 9(02).                      00828035
               10 PV-SCL-NBR-2          PIC 9(02).                      00829035
           05  PV-SCL-NBR-CHAR.                                         00829234
               10 FILLER                PIC X(01) VALUE '0'.            00829334
               10 PV-SCL-NBR-CHAR-X2    PIC X(02).                      00829437
           05  PV-SCL-CHAR-3            PIC X(03).                      00829534
           05  PV-LOC-NBR               PIC S9(4) COMP.                 00829645
           05  PV-ITEM-NBR              PIC S9(15)  COMP-3.             00829753
           05  PV-ONE                   PIC S9(04)  VALUE +0            00829973
                                                    COMP SYNC.          00830073
      *                                                                 00831022
       01  PS-PROGRAM-SWITCHES.                                         00840022
           05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00850014
               88  PS-ERROR                          VALUE  'Y'.        00860014
               88  PS-NO-ERROR                       VALUE  'N'.        00870014
                                                                        00880014
       01  PM-PROGRAM-MESSAGES.                                         00890014
           05  PM-ABEND-INFO-A.                                         00900014
               10  FILLER                PIC X(15)   VALUE              00910014
                                         'DP020-SRC-AID: '.             00920014
               10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00930014
               10  FILLER                PIC X(19)   VALUE              00940014
                                         '. DP020-FK-ACTION: '.         00950014
               10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00960014
               10  FILLER                PIC X(22)   VALUE              00970014
                                         '. DP020-FK-DISPN-IND: '.      00980014
               10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00990014
               10  FILLER                PIC X(01)   VALUE '.'.         01000014
               10  FILLER                PIC X(19)   VALUE SPACE.       01010014
                                                                        01020014
                                                                        01020370
      ******************************************************************01020444
      *    MAP LAYOUT                                                  *01020544
      ******************************************************************01020644
           COPY MHKM801.                                                01020744
                                                                        01020844
      ******************************************************************01100014
      *    ATTRIBUTE SETTINGS COPYBOOK.                                *01110014
      ******************************************************************01120014
           COPY DPWS015.                                                01130014
                                                                        01140042
      ******************************************************************01150014
      *    FUNCTION KEYS COPYBOOK                                      *01160014
      ******************************************************************01170014
           COPY DPWS016.                                                01180014
                                                                        01190042
      ******************************************************************01200044
      ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01210044
      ** SUB-ROUTINE (DPKUT100).                                      **01220044
      ******************************************************************01230044
           COPY DPWS010I.                                               01240044
                                                                        01250044
      ******************************************************************01260014
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01270014
      ** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01280014
      ******************************************************************01290014
           COPY DPWS030.                                                01300014
CICS       COPY DPWS930.                                                01301078
                                                                        01310042
      ***************************************************************** 01320014
      *    STANDARD COMMAREA.                                           01330014
      ***************************************************************** 01340014
           COPY DPWS020.                                                01350014
                                                                        01360042
      ***************************************************************** 01370014
      *    INTER-APPLICATION COMMAREA.                                  01380014
      ***************************************************************** 01390014
           COPY MHWS000.                                                01400014
                                                                        01410042
      ***************************************************************** 01420014
      *    SPECIFIC COMMMAREA FOR MHKCS801.  LENGTH (102)               01430023
      ***************************************************************** 01440014
               10  ASC-SPECIFIC-COMMAREA.                               01450014
                   15  ASC-DEPT-NUMBER-X           PIC  X(03).          01460014
                   15  ASC-DEPT-NUMBER REDEFINES                        01470014
                       ASC-DEPT-NUMBER-X           PIC  9(03).          01480014
                   15  ASC-DEPT-DESC               PIC  X(25).          01490014
                   15  ASC-MCL-NUMBER-X            PIC  X(02).          01500014
                   15  ASC-MCL-NUMBER REDEFINES                         01510014
                       ASC-MCL-NUMBER-X            PIC  9(02).          01520014
                   15  ASC-SCL-NUMBER-X            PIC  X(02).          01530014
                   15  ASC-SCL-NUMBER REDEFINES                         01540014
                       ASC-SCL-NUMBER-X            PIC  9(02).          01550014
                   15  ASC-SKU-NUMBER-X            PIC  X(08).          01560014
                   15  ASC-SKU-NUMBER REDEFINES                         01570014
                       ASC-SKU-NUMBER-X            PIC  9(08).          01580014
                   15  ASC-SKU-DESC                PIC  X(25).          01590014
                   15  ASC-UPC-NUMBER-X            PIC  X(14).          01600014
                   15  ASC-UPC-NUMBER REDEFINES                         01610014
                       ASC-UPC-NUMBER-X            PIC  9(14).          01620014
                   15  ASC-STORE-NUMBER-X          PIC  X(05).          01630014
                   15  ASC-STORE-NUMBER REDEFINES                       01640014
                       ASC-STORE-NUMBER-X          PIC  9(05).          01650014
                   15  ASC-STORE-DESC              PIC  X(10).          01660014
                   15  ASC-ITEM-NBR                PIC S9(15) COMP-3.   01670023
               10  FILLER                          PIC  X(2763).        01680023
           EJECT                                                        01690014
      ******************************************************************01700014
      *    ABEND PROCESSING COPYBOOK.                                  *01710014
      ******************************************************************01720014
           COPY DPWS013.                                                01730014
                                                                        01740014
      ******************************************************************01750014
      *    THIS IS THE DCLGEN MEMBER FOR THE LOCATION TABLE            *01760014
      ******************************************************************01770014
           EXEC SQL                                                     01780045
               INCLUDE XMT00001                                         01790046
           END-EXEC.                                                    01800045
                                                                        01810045
      ******************************************************************01811027
      *    THIS IS THE DCLGEN MEMBER FOR THE TUPCSKU TABLE             *01812064
      ******************************************************************01813027
           EXEC SQL                                                     01814027
               INCLUDE TUPCSKU                                          01815064
           END-EXEC.                                                    01816027
                                                                        01817027
      ******************************************************************01820014
      *    TSK IS THE DCLGEN MEMBER FOR THE SKU TABLE                  *01830014
      ******************************************************************01840014
           EXEC SQL                                                     01850026
               INCLUDE TSK                                              01860026
           END-EXEC.                                                    01870026
                                                                        01880014
      ******************************************************************01890014
      *    TSKXREF IS THE DCLGEN MEMBER FOR THE SKU XREF TABLE         *01900014
      ******************************************************************01910014
           EXEC SQL                                                     01920026
               INCLUDE TSKXREF                                          01930026
           END-EXEC.                                                    01940026
                                                                        01950014
      ******************************************************************01960014
      *    TSKST IS THE DCLGEN MEMBER FOR THE SKU/STORE TABLE          *01970014
      ******************************************************************01980014
           EXEC SQL                                                     01990026
               INCLUDE TSKST                                            02000026
           END-EXEC.                                                    02010026
                                                                        02020014
      ******************************************************************02030014
      *    DEPARTMENT/CLASS VALIDATION                                  02040014
      ******************************************************************02050014
           EXEC SQL                                                     02060026
               INCLUDE TMDSEAR                                          02070026
           END-EXEC.                                                    02080026
                                                                        02090014
      ******************************************************************02090171
      *    DUMMY TABLE USED FOR EXISTANCE CHECKING                      02090271
      ******************************************************************02090371
           EXEC SQL                                                     02090471
               INCLUDE SYSDUMMY                                         02090571
           END-EXEC.                                                    02090671
                                                                        02090771
      ******************************************************************02091028
      *    SQLCA IS THE DB2 COMMUNICATIONS AREA                        *02092028
      ******************************************************************02093028
           EXEC SQL                                                     02094028
               INCLUDE SQLCA                                            02095028
           END-EXEC.                                                    02096028
                                                                        02097028
       EJECT                                                            02100014
      ******************************************************************02110014
       LINKAGE SECTION.                                                 02120014
      ******************************************************************02130014
                                                                        02140014
       01  DFHCOMMAREA.                                                 02150014
           05  FILLER                         OCCURS  1 TO 4072 TIMES   02160014
                                              DEPENDING ON EIBCALEN.    02170014
               10  FILLER                     PIC X.                    02180014
                                                                        02200014
      ***************************************************************** 02210014
       PROCEDURE DIVISION.                                              02220014
      ***************************************************************** 02230014
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02240014
      ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02250014
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02260014
      **                                                             ** 02270014
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02280014
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02290014
      ***************************************************************** 02300014
       0000-MAIN-MODULE.                                                02310014
           INITIALIZE DP030-CICS-API-FIELDS.                            02320014
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02330014
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02340014
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02350014
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02360014
           MOVE LENGTH OF MH801AI        TO DP030-MAP-LENGTH (1).       02370014
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02380014
           PERFORM 0001-CALL-CICS-ARCH-API.                             02390014
      *                                                                 02400014
           PERFORM 1000-CONTROL-PROCESSING                              02410014
      *                                                                 02420014
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02430014
           PERFORM 0001-CALL-CICS-ARCH-API.                             02440014
                                                                        02450014
       0001-CALL-CICS-ARCH-API.                                         02460014
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02470078
                                          DFHCOMMAREA                   02480078
                                          DP030-CICS-API-FIELDS         02490078
                                          DP020-STANDARD-COMMAREA       02500078
                                          MH801AI.                      02510078
      *                                                                 02520014
           IF  DP030-RC-CALL-SUCCESSFUL                                 02530014
               CONTINUE                                                 02540014
           ELSE                                                         02550014
               SET DP013-NO-ROLLBACK                                    02560014
                   DP013-XCTL-DISPLAY-RESTART                           02570014
                   DP013-CICS-ABEND      TO TRUE                        02580014
               MOVE 'BEFORE 0000-MAIN-MODULE'                           02590014
                                         TO DP013-PARAGRAPH             02600014
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02601078
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02602078
               MOVE DP030-RETURN-CODE                                   02630014
                                         TO DP013-MESSAGE-TEXT (3)      02640014
               PERFORM DP013-0000-PROCESS-ABEND                         02650014
           END-IF.                                                      02660014
       EJECT                                                            02670014
      ***************************************************************** 02671045
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02690014
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02700014
      ***************************************************************** 02701045
       1000-CONTROL-PROCESSING.                                         02730014
                                                                        02740014
           EVALUATE TRUE                                                02750014
               WHEN DP020-NEXT-ACT-INITIAL                              02760014
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     02770014
                   PERFORM 4000-BUILD-INITIAL-PANEL                     02780014
                                                                        02790014
               WHEN DP020-NEXT-ACT-READ-MAP                             02800014
                   PERFORM 2000-FKEY-PROCESSING                         02810014
                                                                        02820014
               WHEN DP020-NEXT-ACT-RETURN                               02830014
                   PERFORM 4200-MOVE-INTR-APPL-TO-COMAREA               02831075
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02840014
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02850014
                                                                        02860014
               WHEN OTHER                                               02870014
                   SET DP013-LOGIC-ABEND                                02880014
                       DP013-NO-ROLLBACK TO TRUE                        02890014
                   MOVE '1000-CONTROL-PROCESSING'                       02900014
                                         TO  DP013-PARAGRAPH            02910014
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02920014
                                         TO  DP013-MESSAGE-TEXT(1)      02930014
                   MOVE DP020-NEXT-APPL-ACTIVITY                        02940014
                                         TO DP013-MESSAGE-TEXT(2)       02950014
                   PERFORM DP013-0000-PROCESS-ABEND                     02960014
           END-EVALUATE.                                                02970014
                                                                        02980014
      ***************************************************************** 02981045
      * FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03000014
      * SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03010014
      * EDITS.                                                         *03020014
      ***************************************************************** 03021045
       2000-FKEY-PROCESSING.                                            03050014
                                                                        03060014
           EVALUATE TRUE                                                03070014
                                                                        03080014
               WHEN DP020-SRC-AID = DP016-CLEAR                         03090014
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03100014
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03110014
                                                                        03120014
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03130014
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     03140014
                   PERFORM 4000-BUILD-INITIAL-PANEL                     03150014
                   PERFORM 3200-RESET-ATTRIBUTES                        03160014
                                                                        03170014
               WHEN OTHER                                               03180014
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03190014
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03200014
                   IF  PS-NO-ERROR                                      03210014
                       SET DP030-CONTINUE-GO TO TRUE                    03220014
                       PERFORM 2100-CHECK-FUNCTION-KEY                  03230014
                   ELSE                                                 03240014
                       SET DP030-OVERRIDE-GO TO TRUE                    03250014
                   END-IF                                               03260014
           END-EVALUATE.                                                03270014
                                                                        03271053
      ******************************************************************03280014
      ** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03290014
      ** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03300014
      ** FROM THE CICS ARCHITECTURE API.                              **03310014
      ******************************************************************03320014
       2100-CHECK-FUNCTION-KEY.                                         03330014
           EVALUATE TRUE                                                03340014
               WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               03381056
               WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               03382056
               WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               03382162
                   PERFORM 2110-PREPARE-INTER-APPL-COMM                 03382256
                                                                        03385056
               WHEN DP020-SRC-AID = DP016-ENTER                         03390014
                   CONTINUE                                             03400014
                                                                        03410014
               WHEN OTHER                                               03420014
                   SET DP013-NO-ROLLBACK                                03430014
                       DP013-XCTL-DISPLAY-RESTART                       03440014
                       DP013-CICS-ABEND  TO TRUE                        03450014
                   MOVE '2100-CHECK-FUNCTION-KEY'                       03460014
                                         TO DP013-PARAGRAPH             03470014
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03480014
                                         TO DP013-MESSAGE-TEXT (1)      03490014
                   MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 03500014
                                         TO DP013-MESSAGE-TEXT (2)      03510014
                   MOVE DP020-SRC-AID    TO PM-A-SRC-AID                03520014
                   MOVE DP020-FK-ACTION (DP020-SRC-AID)                 03530014
                                         TO PM-A-FK-ACTION              03540014
                   MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              03550014
                                         TO PM-A-FK-DISPN               03560014
                   MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      03570014
                   MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        03580014
                                         TO DP013-MESSAGE-TEXT (4)      03590014
                   PERFORM DP013-0000-PROCESS-ABEND                     03600014
           END-EVALUATE.                                                03610014
                                                                        03611053
      ******************************************************************03620014
      ** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03630014
      ** INTER-APPLICATION COMMAREA - MHWS000                         **03640014
      ******************************************************************03650014
       2110-PREPARE-INTER-APPL-COMM.                                    03660014
                                                                        03670014
           INITIALIZE MH000-INTER-APPL-COMMAREA.                        03680014
                                                                        03690014
           MOVE ASC-DEPT-NUMBER-X        TO MH000-DEPT-NUMBER-X.        03700014
           MOVE ASC-DEPT-DESC            TO MH000-DEPT-NAME.            03701052
           MOVE ASC-MCL-NUMBER-X         TO MH000-MCL-NUMBER-X.         03710014
           MOVE ASC-SCL-NUMBER-X         TO MH000-SCL-NUMBER-X.         03720014
           MOVE ASC-SKU-NUMBER-X         TO MH000-SKU-NUMBER-X.         03730014
           MOVE ASC-SKU-DESC             TO MH000-SKU-DESCRIPTION.      03740014
           MOVE ASC-UPC-NUMBER-X         TO MH000-UPC-NUMBER-X.         03750017
           MOVE ASC-STORE-NUMBER-X       TO MH000-STORE-NUMBER-X.       03760014
           MOVE ASC-STORE-DESC           TO MH000-STORE-SHORT-NAME.     03770014
           MOVE ASC-ITEM-NBR             TO MH000-ITEM-NUMBER.          03771050
                                                                        03780014
       EJECT                                                            03790414
      ******************************************************************03791045
      * MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03810014
      * THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03820014
      * APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03830014
      ******************************************************************03831045
       2200-MOVE-SCREEN-TO-COMMAREA.                                    03850014
                                                                        03860014
           IF  DEPTL > ZERO                                             03870014
               MOVE DEPTI                TO ASC-DEPT-NUMBER-X           03880014
           ELSE                                                         03890014
               IF  DEPTF = DP015-ERASE-EOF                              03900014
                   MOVE SPACE            TO ASC-DEPT-NUMBER-X           03910014
                                            ASC-DEPT-DESC               03911038
                                            DPTDSCO                     03912039
               END-IF                                                   03920014
           END-IF.                                                      03930014
                                                                        03940014
           IF  MAJCLL > ZERO                                            03950014
               MOVE MAJCLI               TO ASC-MCL-NUMBER-X            03960014
           ELSE                                                         03970014
               IF  MAJCLF = DP015-ERASE-EOF                             03980014
                   MOVE SPACE            TO ASC-MCL-NUMBER-X            03990014
               END-IF                                                   04000014
           END-IF.                                                      04010014
                                                                        04020014
           IF  SUBCLL > ZERO                                            04030014
               MOVE SUBCLI               TO ASC-SCL-NUMBER-X            04040014
           ELSE                                                         04050014
               IF  SUBCLF = DP015-ERASE-EOF                             04060014
                   MOVE SPACE            TO ASC-SCL-NUMBER-X            04070014
               END-IF                                                   04080014
           END-IF.                                                      04090014
                                                                        04100014
           IF  SKUL > ZERO                                              04110014
               MOVE SKUI                 TO ASC-SKU-NUMBER-X            04120014
           ELSE                                                         04130014
               IF  SKUF = DP015-ERASE-EOF                               04140014
                   MOVE SPACE            TO ASC-SKU-NUMBER-X            04150014
                                            ASC-SKU-DESC                04151038
                                            SKUDSCO                     04152039
               END-IF                                                   04160014
           END-IF.                                                      04170014
                                                                        04180014
           IF  UPCL > ZERO                                              04190014
               MOVE UPCI                 TO ASC-UPC-NUMBER-X            04200014
           ELSE                                                         04210014
               IF  UPCF = DP015-ERASE-EOF                               04220014
                   MOVE SPACE            TO ASC-UPC-NUMBER-X            04230014
               END-IF                                                   04240014
           END-IF.                                                      04250014
                                                                        04260014
           IF  STOREL > ZERO                                            04270014
               MOVE STOREI               TO ASC-STORE-NUMBER-X          04280014
           ELSE                                                         04290014
               IF  STOREF = DP015-ERASE-EOF                             04300014
                   MOVE SPACE            TO ASC-STORE-NUMBER-X          04310014
                                            ASC-STORE-DESC              04311040
                                            STDESCO                     04312040
               END-IF                                                   04320014
           END-IF.                                                      04330014
                                                                        04340014
      ******************************************************************04351045
      * EDIT THE CRITERIA SPECIFICATION SCREEN.                        *04360014
      ******************************************************************04361045
       3000-EDIT-DATA-IN-COMMAREA.                                      04380014
                                                                        04390014
           PERFORM 3200-RESET-ATTRIBUTES.                               04400014
                                                                        04410014
      *- MUST ENTER DEPARTMENT, SKU OR UPC IN THE CRITERIA.             04420020
           IF ASC-DEPT-NUMBER-X > SPACES                                04430019
              OR ASC-SKU-NUMBER-X > SPACES                              04440019
              OR ASC-UPC-NUMBER-X > SPACES                              04450019
              CONTINUE                                                  04460019
           ELSE                                                         04470019
              SET PS-ERROR                                              04480019
                  DP020-MSG-FATAL   TO TRUE                             04490019
              MOVE PC-TSYMSG-02532  TO DP020-MSG-NUMBER                 04500019
              MOVE DP015-UNP-ALP-BRT-OFF                                04510019
                                    TO DEPTA                            04520019
                                       SKUA                             04530020
                                       UPCA                             04540020
              MOVE DP015-RED        TO DEPTC                            04550019
                                       SKUC                             04560020
                                       UPCC                             04570020
              MOVE DP015-REVERSE    TO DEPTH                            04580019
                                       SKUH                             04590020
                                       UPCH                             04600020
              MOVE -1               TO DEPTL                            04610019
              SET DP030-SET-CURSOR-APPL-1 TO TRUE                       04620019
           END-IF.                                                      04630019
                                                                        04640019
      *- NUMERIC EDIT CHECK ALL CRITERIA FIELDS.                        04650019
           IF PS-ERROR                                                  04660019
              CONTINUE                                                  04670019
           ELSE                                                         04680019
              PERFORM 3300-VALIDATE-NUMERIC                             04690019
           END-IF.                                                      04700019
                                                                        04710019
      *- VALIDATE KEY PRODUCT DATA                                      04720021
      *- PLEASE NOTE:  WHEN UPC IS ENTERED AND IS VALID,                04730021
      *-   DEPT, MCL, SCL AND SKU WILL BE RETRIEVED AND                 04740020
      *-   OUTPUT TO THE SCREEN.                                        04750020
      *- PLEASE NOTE:  WHEN SKU IS ENTERED AND IS VALID,                04760021
      *-   DEPT, MCL, SCL WILL BE RETRIEVED AND                         04770020
      *-   OUTPUT TO THE SCREEN - UPC WILL REMAIN SPACES.               04780020
      *- PLEASE NOTE:  WHEN DEPARTMENT IS ENTERED AND IS VALID,         04790021
      *-   THE PROGRAM WILL CHECK IF MCL AND SCL WERE ENTERED -         04800021
      *-   IS SO, THE FIELDS WILL ALSO BE VALIDATED.                    04810021
      *-   SKU AND UPC WILL REMAIN SPACES.                              04820021
           IF PS-ERROR                                                  04830021
              CONTINUE                                                  04840021
           ELSE                                                         04850021
              IF ASC-UPC-NUMBER-X > SPACES                              04860021
                 PERFORM 3400-VALIDATE-UPC-NBR                          04870021
                 IF SQLCODE = ZERO                                      04880022
                    PERFORM 3410-MOVE-UPC-VALUES                        04890023
                 ELSE                                                   04900022
                    PERFORM 3415-FORMAT-UPC-ERROR                       04910024
                    SET PS-ERROR                                        04920022
                        DP020-MSG-FATAL   TO TRUE                       04930022
                    MOVE PC-TSYMSG-00100  TO DP020-MSG-NUMBER           04940022
                    MOVE DP015-UNP-ALP-BRT-OFF                          04950022
                                          TO UPCA                       04960022
                    MOVE DP015-RED        TO UPCC                       04970022
                    MOVE DP015-REVERSE    TO UPCH                       04980022
                    MOVE -1               TO UPCL                       04990022
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05000022
                 END-IF                                                 05010022
              ELSE                                                      05020021
                 IF ASC-SKU-NUMBER-X > SPACES                           05030021
                    PERFORM 3500-VALIDATE-SKU-NBR                       05040021
                    IF SQLCODE = ZERO                                   05050024
                       PERFORM 3510-MOVE-SKU-VALUES                     05060024
                    ELSE                                                05070024
                       PERFORM 3515-FORMAT-SKU-ERROR                    05080024
                       SET PS-ERROR                                     05090024
                           DP020-MSG-FATAL   TO TRUE                    05100024
                       MOVE PC-TSYMSG-00419  TO DP020-MSG-NUMBER        05110024
                       MOVE DP015-UNP-ALP-BRT-OFF                       05120024
                                             TO SKUA                    05130024
                       MOVE DP015-RED        TO SKUC                    05140024
                       MOVE DP015-REVERSE    TO SKUH                    05150024
                       MOVE -1               TO SKUL                    05160024
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              05170024
                    END-IF                                              05180024
                 ELSE                                                   05190021
                    PERFORM 3600-VALIDATE-DEPT-NBR                      05200021
                 END-IF                                                 05350021
              END-IF                                                    05360021
           END-IF.                                                      05370021
                                                                        05380020
      *- VALIDATE LOCATION NUMBER                                       05390021
      *- PLEASE NOTE:  WHEN LOCATION NUMBER IS SPACES, THE DEFAULT      05400021
      *-   LOCATION NUMBER WILL BE THE CORPORATE LOCATION - STORE 0.    05410021
           IF PS-ERROR                                                  05420045
              CONTINUE                                                  05430045
           ELSE                                                         05440045
              IF ASC-STORE-NUMBER-X > SPACES                            05441045
                AND ASC-STORE-NUMBER > ZERO                             05442048
                 PERFORM 3700-VALIDATE-STORE-NBR                        05450045
                 IF SQLCODE = ZERO                                      05451045
                    MOVE XMT00001-LOC-10-ABBR-NM TO ASC-STORE-DESC      05452045
                                                    STDESCO             05452145
                 ELSE                                                   05453045
                    MOVE SPACES TO ASC-STORE-DESC                       05454045
                                   STDESCO                              05454145
                    SET PS-ERROR                                        05455045
                        DP020-MSG-FATAL   TO TRUE                       05456045
                    MOVE PC-TSYMSG-02294  TO DP020-MSG-NUMBER           05457045
                    MOVE DP015-UNP-ALP-BRT-OFF                          05458045
                                          TO STOREA                     05459045
                    MOVE DP015-RED        TO STOREC                     05459145
                    MOVE DP015-REVERSE    TO STOREH                     05459245
                    MOVE -1               TO STOREL                     05459345
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05459445
              ELSE                                                      05459545
                 MOVE PC-CORP-LOCATION TO ASC-STORE-NUMBER-X            05459645
                                          STOREO                        05459745
                 MOVE PC-CORP-DESC     TO ASC-STORE-DESC                05459845
                                          STDESCO                       05459945
           END-IF.                                                      05460045
                                                                        05460153
      *- VALIDATE, WHEN SKU/UPC ENTERED, THAT THE SKU/UPC TO STORE      05461053
      *- COMBINATION EXISTS.  (I.E. A ROW EXISTS ON SKU/STORE TABLE)    05462053
           IF PS-ERROR                                                  05464053
              CONTINUE                                                  05465053
           ELSE                                                         05466053
              IF ASC-SKU-NUMBER-X  > SPACES                             05467053
                OR ASC-UPC-NUMBER-X > SPACES                            05468053
                 PERFORM 3800-VALIDATE-SKU-STORE                        05469053
                 IF SQLCODE = ZERO                                      05469153
                    CONTINUE                                            05469253
                 ELSE                                                   05469453
                    SET PS-ERROR                                        05469753
                        DP020-MSG-FATAL   TO TRUE                       05469853
                    MOVE PC-TSYMSG-00332  TO DP020-MSG-NUMBER           05469953
                    MOVE DP015-UNP-ALP-BRT-OFF                          05470053
                                          TO SKUA                       05470153
                                             STOREA                     05470254
                    MOVE DP015-RED        TO SKUC                       05470353
                                             STOREC                     05470454
                    MOVE DP015-REVERSE    TO SKUH                       05470553
                                             STOREH                     05470654
                    MOVE -1               TO SKUL                       05470753
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05470853
              END-IF                                                    05470953
           END-IF.                                                      05471153
                                                                        05472045
      **  MUST HAVE A FULLY QUALIFED SKU TO NAVIGATE                    05472162
      **  TO THE SKU OR UPC INQUIRY.                                    05472262
           IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)                     05473062
            OR DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)                    05473162
               IF ASC-SKU-NUMBER-X > SPACES                             05473562
                  CONTINUE                                              05473662
               ELSE                                                     05473762
                  SET PS-ERROR                                          05473862
                      DP020-MSG-FATAL   TO TRUE                         05473962
                  MOVE PC-TSYMSG-02940  TO DP020-MSG-NUMBER             05474062
                  MOVE DP015-UNP-ALP-BRT-OFF                            05474162
                                        TO SKUA                         05474262
                                           UPCA                         05474362
                  MOVE DP015-RED        TO SKUC                         05474462
                                           UPCC                         05474562
                  MOVE DP015-REVERSE    TO SKUH                         05474662
                                           UPCH                         05474762
                  MOVE -1               TO SKUL                         05474862
                  SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05474962
               END-IF                                                   05475062
           END-IF                                                       05475162
                                                                        05475262
           IF  PS-NO-ERROR                                              05480014
               MOVE -1                   TO DEPTL                       05490014
               SET DP030-SET-CURSOR-APPL-1                              05500014
                                         TO TRUE                        05510014
           END-IF.                                                      05520014
                                                                        05521053
      ******************************************************************05530014
      ** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **05540014
      ** MAP.                                                         **05550014
      ******************************************************************05560014
       3200-RESET-ATTRIBUTES.                                           05570014
           MOVE DP015-UNP-ALP-NOR-OFF    TO DEPTA                       05580014
                                            MAJCLA                      05590014
                                            SUBCLA                      05600014
                                            SKUA                        05610014
                                            UPCA                        05620014
                                            STOREA.                     05630014
           MOVE DP015-GREEN              TO DEPTC                       05640014
                                            MAJCLC                      05650014
                                            SUBCLC                      05660014
                                            SKUC                        05670014
                                            UPCC                        05680014
                                            STOREC.                     05690014
           MOVE DP015-UNDERLINE          TO DEPTH                       05700014
                                            MAJCLH                      05710014
                                            SUBCLH                      05720014
                                            SKUH                        05730014
                                            UPCH                        05740014
                                            STOREH.                     05750014
                                                                        05760014
           MOVE DP015-HL-OFF               TO DPTDSCH                   05770014
                                              SKUDSCH                   05780014
                                              STDESCH.                  05790014
                                                                        05800014
           MOVE DP015-BLUE                 TO DPTDSCC                   05810014
                                              SKUDSCC                   05820014
                                              STDESCC.                  05830014
                                                                        05840014
           MOVE DP015-ASK-NOR-OFF          TO DPTDSCA                   05850014
                                              SKUDSCA                   05860014
                                              STDESCA.                  05870014
                                                                        05880014
      ******************************************************************05890014
      ** VALIDATE IF THE ENTERED FIELDS ARE NUMERIC.                  **05900014
      ******************************************************************05910014
       3300-VALIDATE-NUMERIC.                                           05920014
                                                                        05930014
           IF  ASC-DEPT-NUMBER-X > SPACE                                05940014
               MOVE ASC-DEPT-NUMBER-X       TO DP010I-UNEDITED-FIELD    05950014
               MOVE LENGTH OF ASC-DEPT-NUMBER-X TO DP010I-MAXIMUM-DIGITS05960014
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  05970014
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05980014
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05991076
262978              USING DP010I-NUMERIC-EDIT-AREA                      05992076
               IF  DP010I-ERROR-DETECTED                                06000014
                   SET PS-ERROR                                         06010014
                       DP020-MSG-FATAL   TO TRUE                        06020014
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06030014
                   MOVE DP015-UNP-ALP-BRT-OFF                           06040014
                                         TO DEPTA                       06050014
                   MOVE DP015-RED        TO DEPTC                       06060014
                   MOVE DP015-REVERSE    TO DEPTH                       06070014
                   MOVE -1               TO DEPTL                       06080014
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06090014
                   MOVE SPACES           TO ASC-DEPT-DESC               06091041
                                            DPTDSCO                     06092041
               ELSE                                                     06100014
                   MOVE DP010I-NUMERIC-FIELD TO ASC-DEPT-NUMBER         06110014
                   MOVE ASC-DEPT-NUMBER  TO DEPTO                       06120014
               END-IF                                                   06130014
           END-IF.                                                      06140014
                                                                        06150014
           IF  ASC-MCL-NUMBER-X > SPACE                                 06160014
               MOVE ASC-MCL-NUMBER-X        TO DP010I-UNEDITED-FIELD    06170014
               MOVE LENGTH OF ASC-MCL-NUMBER-X TO DP010I-MAXIMUM-DIGITS 06180014
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  06190014
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06200014
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06211076
262978              USING DP010I-NUMERIC-EDIT-AREA                      06212076
               IF  DP010I-ERROR-DETECTED                                06220014
                   SET PS-ERROR                                         06230014
                       DP020-MSG-FATAL   TO TRUE                        06240014
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06250014
                   MOVE DP015-UNP-ALP-BRT-OFF                           06260014
                                         TO MAJCLA                      06270014
                   MOVE DP015-RED        TO MAJCLC                      06280014
                   MOVE DP015-REVERSE    TO MAJCLH                      06290014
                   MOVE -1               TO MAJCLL                      06300014
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06310014
               ELSE                                                     06320014
                   MOVE DP010I-NUMERIC-FIELD TO ASC-MCL-NUMBER          06330014
                   MOVE ASC-MCL-NUMBER  TO MAJCLO                       06340014
               END-IF                                                   06350014
           END-IF.                                                      06360014
                                                                        06370016
           IF  ASC-SCL-NUMBER-X > SPACE                                 06380016
               MOVE ASC-SCL-NUMBER-X        TO DP010I-UNEDITED-FIELD    06390016
               MOVE LENGTH OF ASC-SCL-NUMBER-X TO DP010I-MAXIMUM-DIGITS 06400016
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  06410016
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06420016
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06431076
262978              USING DP010I-NUMERIC-EDIT-AREA                      06432076
               IF  DP010I-ERROR-DETECTED                                06440016
                   SET PS-ERROR                                         06450016
                       DP020-MSG-FATAL   TO TRUE                        06460016
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06470016
                   MOVE DP015-UNP-ALP-BRT-OFF                           06480016
                                         TO SUBCLA                      06490016
                   MOVE DP015-RED        TO SUBCLC                      06500016
                   MOVE DP015-REVERSE    TO SUBCLH                      06510016
                   MOVE -1               TO SUBCLL                      06520016
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06530016
               ELSE                                                     06540016
                   MOVE DP010I-NUMERIC-FIELD TO ASC-SCL-NUMBER          06550016
                   MOVE ASC-SCL-NUMBER  TO SUBCLO                       06560016
               END-IF                                                   06570016
           END-IF.                                                      06580016
                                                                        06590016
           IF  ASC-SKU-NUMBER-X > SPACE                                 06600016
               MOVE ASC-SKU-NUMBER-X        TO DP010I-UNEDITED-FIELD    06610016
               MOVE LENGTH OF ASC-SKU-NUMBER-X TO DP010I-MAXIMUM-DIGITS 06620016
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  06630016
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06640016
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06651076
262978              USING DP010I-NUMERIC-EDIT-AREA                      06652076
               IF  DP010I-ERROR-DETECTED                                06660016
                   SET PS-ERROR                                         06670016
                       DP020-MSG-FATAL   TO TRUE                        06680016
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06690016
                   MOVE DP015-UNP-ALP-BRT-OFF                           06700016
                                         TO SKUA                        06710016
                   MOVE DP015-RED        TO SKUC                        06720016
                   MOVE DP015-REVERSE    TO SKUH                        06730016
                   MOVE -1               TO SKUL                        06740016
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06750016
                   MOVE SPACES           TO ASC-SKU-DESC                06751041
                                            SKUDSCO                     06752041
               ELSE                                                     06760016
                   MOVE DP010I-NUMERIC-FIELD TO ASC-SKU-NUMBER          06770016
                   MOVE ASC-SKU-NUMBER  TO SKUO                         06780016
               END-IF                                                   06790016
           END-IF.                                                      06800016
                                                                        06810016
           IF  ASC-UPC-NUMBER-X > SPACE                                 06820016
               MOVE ASC-UPC-NUMBER-X        TO DP010I-UNEDITED-FIELD    06830016
               MOVE LENGTH OF ASC-UPC-NUMBER-X TO DP010I-MAXIMUM-DIGITS 06840016
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  06850016
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06860016
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06871076
262978              USING DP010I-NUMERIC-EDIT-AREA                      06872076
               IF  DP010I-ERROR-DETECTED                                06880016
                   SET PS-ERROR                                         06890016
                       DP020-MSG-FATAL   TO TRUE                        06900016
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06910016
                   MOVE DP015-UNP-ALP-BRT-OFF                           06920016
                                         TO UPCA                        06930016
                   MOVE DP015-RED        TO UPCC                        06940016
                   MOVE DP015-REVERSE    TO UPCH                        06950016
                   MOVE -1               TO UPCL                        06960016
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06970016
               ELSE                                                     06980016
                   MOVE DP010I-NUM-FIELD-15-DIG-2-DEC                   06990018
                                             TO ASC-UPC-NUMBER          07000018
                   MOVE ASC-UPC-NUMBER  TO UPCO                         07010018
               END-IF                                                   07020018
           END-IF.                                                      07030018
                                                                        07040018
           IF  ASC-STORE-NUMBER-X > SPACE                               07050018
               MOVE ASC-STORE-NUMBER-X      TO DP010I-UNEDITED-FIELD    07060018
               MOVE LENGTH OF ASC-STORE-NUMBER-X                        07070018
                                               TO DP010I-MAXIMUM-DIGITS 07080018
               MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  07090018
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07100018
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07111076
262978              USING DP010I-NUMERIC-EDIT-AREA                      07112076
               IF  DP010I-ERROR-DETECTED                                07120018
                   SET PS-ERROR                                         07130018
                       DP020-MSG-FATAL   TO TRUE                        07140018
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07150018
                   MOVE DP015-UNP-ALP-BRT-OFF                           07160018
                                         TO STOREA                      07170018
                   MOVE DP015-RED        TO STOREC                      07180018
                   MOVE DP015-REVERSE    TO STOREH                      07190018
                   MOVE -1               TO STOREL                      07200018
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07210018
                   MOVE SPACES           TO ASC-STORE-DESC              07211041
                                            STDESCO                     07212041
               ELSE                                                     07220018
                   MOVE DP010I-NUMERIC-FIELD TO ASC-STORE-NUMBER        07230018
                   MOVE ASC-STORE-NUMBER TO STOREO                      07240018
               END-IF                                                   07250018
           END-IF.                                                      07260018
                                                                        07270021
      ******************************************************************07280021
      ** VALIDATE UPC NUMBER.                                         **07290021
      ******************************************************************07300021
       3400-VALIDATE-UPC-NBR.                                           07310021
                                                                        07320022
           MOVE ASC-UPC-NUMBER TO PV-UPC-NBR.                           07330024
                                                                        07340024
           PERFORM                                                      07350022
               WITH TEST AFTER                                          07360022
               VARYING PV-RETRY-COUNTER                                 07370022
               FROM 1 BY 1                                              07380022
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07390022
                         OR (SQLCODE = ZERO)                            07400022
                         OR (SQLCODE = +100))                           07410022
               EXEC SQL                                                 07420022
                 SELECT X.DEPT                                          07430022
                       ,X.CLASS                                         07440022
                       ,X.SUBCLASS                                      07450022
                       ,X.SKU                                           07460022
                       ,X.ITM_NBR                                       07470022
                   INTO :SKXREF-DEPT                                    07480022
                       ,:SKXREF-CLASS                                   07490022
                       ,:SKXREF-SUBCLASS                                07500022
                       ,:SKXREF-SKU                                     07510022
                       ,:SKXREF-ITM-NBR                                 07520022
                   FROM TUPCSKU U                                       07530064
                       ,TSKXREF X                                       07540022
                  WHERE U.ITEM_NBR = X.ITM_NBR                          07550064
                    AND X.SKU_STAT_CDE ^= '00'                          07560022
                    AND U.UPC_NBR = :PV-UPC-NBR                         07570022
               END-EXEC                                                 07580022
                                                                        07590022
               EVALUATE TRUE                                            07600022
                   WHEN SQLCODE = ZERO                                  07610022
                   WHEN SQLCODE = +100                                  07620022
                       CONTINUE                                         07650022
                   WHEN SQLWARN0 NOT = SPACES                           07660022
                   WHEN SQLCODE < ZERO                                  07670022
                   WHEN SQLCODE > ZERO                                  07680022
                       MOVE '3400-VALIDATE-UPC-NBR'                     07690022
                                         TO DP013-PARAGRAPH             07700022
                       MOVE 'VALIDATE UPC NUMBER'                       07710022
                                         TO DP013-MESSAGE-TEXT (1)      07720022
                       MOVE SQLCA        TO DP013-SQLCA                 07730022
                       MOVE 'TUPCSKU'    TO DP013-DB2-TABLE-NAME (1)    07740064
                       SET DP013-DB2-ABEND                              07750022
                           DP013-XCTL-DISPLAY-RESTART                   07760022
                                         TO TRUE                        07770022
                       PERFORM DP013-0000-PROCESS-ABEND                 07780022
               END-EVALUATE                                             07790022
           END-PERFORM.                                                 07800022
                                                                        07810022
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07820022
               MOVE '3400-VALIDATE-UPC-NBR'                             07830022
                                         TO DP013-PARAGRAPH             07840022
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     07850022
                                         TO DP013-MESSAGE-TEXT (1)      07860022
               MOVE 'VALIDATE UPC NUMBER'                               07870022
                                         TO DP013-MESSAGE-TEXT (2)      07880022
               MOVE SQLCA                TO DP013-SQLCA                 07890022
               MOVE 'TUPCSKU'            TO DP013-DB2-TABLE-NAME (1)    07900064
               SET DP013-DB2-ABEND                                      07910022
                   DP013-XCTL-DISPLAY-RESTART                           07920022
                                         TO TRUE                        07930022
               PERFORM DP013-0000-PROCESS-ABEND                         07940022
           END-IF.                                                      07950022
                                                                        07960022
      ******************************************************************07970023
      ** VALID UPC - MOVE DETAIL TO COMMAREA & SCREEN.                **07980030
      ******************************************************************07990023
       3410-MOVE-UPC-VALUES.                                            08000023
                                                                        08010036
           MOVE SKXREF-DEPT      TO PV-DEPT-NBR.                        08020032
           MOVE PV-DEPT-NBR      TO PV-DEPT-NBR-CHAR-3.                 08020136
           MOVE PV-DEPT-NBR-3    TO ASC-DEPT-NUMBER-X                   08020236
                                    DEPTO.                              08021030
           MOVE SKXREF-CLASS     TO PV-MCL-NBR.                         08030032
           MOVE PV-MCL-NBR       TO PV-MCL-NBR-CHAR-2.                  08030136
           MOVE PV-MCL-NBR-2     TO ASC-MCL-NUMBER-X                    08030236
                                    MAJCLO.                             08031030
           MOVE SKXREF-SUBCLASS  TO PV-SCL-NBR.                         08040032
           MOVE PV-SCL-NBR       TO PV-SCL-NBR-CHAR-2.                  08040136
           MOVE PV-SCL-NBR-2     TO ASC-SCL-NUMBER-X                    08040236
                                    SUBCLO.                             08041030
           MOVE SKXREF-SKU       TO ASC-SKU-NUMBER-X                    08050031
                                    SKUO.                               08051030
           MOVE SKXREF-ITM-NBR   TO ASC-ITEM-NBR.                       08060024
                                                                        08070023
           PERFORM 3690-GET-DEPT-DESC.                                  08071025
                                                                        08072025
           IF SQLCODE = ZERO                                            08073025
              MOVE MDSEAR-DESC TO ASC-DEPT-DESC                         08074025
                                  DPTDSCO                               08074130
           ELSE                                                         08075025
              MOVE SPACES      TO ASC-DEPT-DESC                         08076025
                                  DPTDSCO                               08076130
           END-IF.                                                      08077025
                                                                        08077128
           PERFORM 3695-GET-SKU-DESC.                                   08078028
                                                                        08079028
           IF SQLCODE = ZERO                                            08079128
              MOVE TSK-SKU-DESC TO ASC-SKU-DESC                         08079228
                                   SKUDSCO                              08079330
           ELSE                                                         08079428
              MOVE SPACES       TO ASC-SKU-DESC                         08079530
                                   SKUDSCO                              08079630
           END-IF.                                                      08079728
                                                                        08080024
      ******************************************************************08090024
      ** INVALID UPC - MOVE SPACES TO COMMAREA AND SCREEN.            **08100030
      ******************************************************************08110024
       3415-FORMAT-UPC-ERROR.                                           08120024
                                                                        08130024
           MOVE SPACES           TO ASC-DEPT-NUMBER-X                   08140030
                                    DEPTO.                              08141030
           MOVE SPACES           TO ASC-DEPT-DESC                       08150030
                                    DPTDSCO.                            08151030
           MOVE SPACES           TO ASC-MCL-NUMBER-X                    08160030
                                    MAJCLO.                             08161030
           MOVE SPACES           TO ASC-SCL-NUMBER-X                    08170030
                                    SUBCLO.                             08171030
           MOVE SPACES           TO ASC-SKU-NUMBER-X                    08180030
                                    SKUO.                               08181030
           MOVE SPACES           TO ASC-SKU-DESC                        08190030
                                    SKUDSCO.                            08191030
           MOVE ZERO             TO ASC-ITEM-NBR.                       08210024
                                                                        08220024
      ******************************************************************08230023
      ** VALIDATE SKU NUMBER.                                         **08240023
      ******************************************************************08250023
       3500-VALIDATE-SKU-NBR.                                           08260023
                                                                        08270023
           MOVE ASC-SKU-NUMBER TO PV-SKU-NBR.                           08280024
                                                                        08290024
           PERFORM                                                      08300024
               WITH TEST AFTER                                          08310024
               VARYING PV-RETRY-COUNTER                                 08320024
               FROM 1 BY 1                                              08330024
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08340024
                         OR (SQLCODE = ZERO)                            08350024
                         OR (SQLCODE = +100))                           08360024
               EXEC SQL                                                 08370024
                 SELECT X.DEPT                                          08380024
                       ,X.CLASS                                         08390024
                       ,X.SUBCLASS                                      08400024
                       ,X.ITM_NBR                                       08420024
                   INTO :SKXREF-DEPT                                    08430024
                       ,:SKXREF-CLASS                                   08440024
                       ,:SKXREF-SUBCLASS                                08450024
                       ,:SKXREF-ITM-NBR                                 08470024
                   FROM TSKXREF X                                       08480024
                  WHERE X.SKU = :PV-SKU-NBR                             08490024
                    AND X.SKU_STAT_CDE ^= '00'                          08500024
               END-EXEC                                                 08510024
                                                                        08520024
               EVALUATE TRUE                                            08530024
                   WHEN SQLCODE = ZERO                                  08540024
                   WHEN SQLCODE = +100                                  08550024
                       CONTINUE                                         08580024
                   WHEN SQLWARN0 NOT = SPACES                           08590024
                   WHEN SQLCODE < ZERO                                  08600024
                   WHEN SQLCODE > ZERO                                  08610024
                       MOVE '3500-VALIDATE-SKU-NBR'                     08620024
                                         TO DP013-PARAGRAPH             08630024
                       MOVE 'VALIDATE SKU NUMBER'                       08640024
                                         TO DP013-MESSAGE-TEXT (1)      08650024
                       MOVE SQLCA        TO DP013-SQLCA                 08660024
                       MOVE 'TSKXREF'    TO DP013-DB2-TABLE-NAME (1)    08670024
                       SET DP013-DB2-ABEND                              08680024
                           DP013-XCTL-DISPLAY-RESTART                   08690024
                                         TO TRUE                        08700024
                       PERFORM DP013-0000-PROCESS-ABEND                 08710024
               END-EVALUATE                                             08720024
           END-PERFORM.                                                 08730024
                                                                        08740024
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        08750024
               MOVE '3500-VALIDATE-SKU-NBR'                             08760024
                                         TO DP013-PARAGRAPH             08770024
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     08780024
                                         TO DP013-MESSAGE-TEXT (1)      08790024
               MOVE 'VALIDATE SKU NUMBER'                               08800024
                                         TO DP013-MESSAGE-TEXT (2)      08810024
               MOVE SQLCA                TO DP013-SQLCA                 08820024
               MOVE 'TSKXREF'            TO DP013-DB2-TABLE-NAME (1)    08830024
               SET DP013-DB2-ABEND                                      08840024
                   DP013-XCTL-DISPLAY-RESTART                           08850024
                                         TO TRUE                        08860024
               PERFORM DP013-0000-PROCESS-ABEND                         08870024
           END-IF.                                                      08880024
                                                                        08890024
      ******************************************************************08900024
      ** VALID SKU - MOVE DETAIL TO COMMAREA AND SCREEN.              **08910030
      ******************************************************************08920024
       3510-MOVE-SKU-VALUES.                                            08930024
                                                                        08931036
           MOVE SKXREF-DEPT      TO PV-DEPT-NBR.                        08940036
           MOVE PV-DEPT-NBR      TO PV-DEPT-NBR-CHAR-3.                 08950036
           MOVE PV-DEPT-NBR-3    TO ASC-DEPT-NUMBER-X                   08960036
                                    DEPTO.                              08970036
           MOVE SKXREF-CLASS     TO PV-MCL-NBR.                         08980036
           MOVE PV-MCL-NBR       TO PV-MCL-NBR-CHAR-2.                  08990036
           MOVE PV-MCL-NBR-2     TO ASC-MCL-NUMBER-X                    09000036
                                    MAJCLO.                             09001036
           MOVE SKXREF-SUBCLASS  TO PV-SCL-NBR.                         09002036
           MOVE PV-SCL-NBR       TO PV-SCL-NBR-CHAR-2.                  09003036
           MOVE PV-SCL-NBR-2     TO ASC-SCL-NUMBER-X                    09004036
                                    SUBCLO.                             09005036
           MOVE SPACES           TO ASC-UPC-NUMBER-X                    09011232
                                    UPCO.                               09011332
           MOVE SKXREF-ITM-NBR   TO ASC-ITEM-NBR.                       09011432
           PERFORM 3690-GET-DEPT-DESC.                                  09011525
                                                                        09011625
           IF SQLCODE = ZERO                                            09011725
              MOVE MDSEAR-DESC TO ASC-DEPT-DESC                         09012025
                                  DPTDSCO                               09012130
           ELSE                                                         09013025
              MOVE SPACES      TO ASC-DEPT-DESC                         09014025
                                  DPTDSCO                               09014130
           END-IF.                                                      09015025
                                                                        09016025
           PERFORM 3695-GET-SKU-DESC.                                   09017025
                                                                        09018025
           IF SQLCODE = ZERO                                            09019025
              MOVE TSK-SKU-DESC TO ASC-SKU-DESC                         09019128
                                   SKUDSCO                              09019230
           ELSE                                                         09019325
              MOVE SPACES       TO ASC-SKU-DESC                         09019430
                                   SKUDSCO                              09019530
           END-IF.                                                      09019625
                                                                        09019725
      ******************************************************************09020024
      ** INVALID SKU - MOVE SPACES TO COMMAREA AND SCREEN.            **09030030
      ******************************************************************09040024
       3515-FORMAT-SKU-ERROR.                                           09050024
                                                                        09060024
           MOVE SPACES           TO ASC-DEPT-NUMBER-X                   09070030
                                    DEPTO.                              09071030
           MOVE SPACES           TO ASC-DEPT-DESC                       09080030
                                    DPTDSCO.                            09081030
           MOVE SPACES           TO ASC-MCL-NUMBER-X                    09090030
                                    MAJCLO.                             09091030
           MOVE SPACES           TO ASC-SCL-NUMBER-X                    09100030
                                    SUBCLO.                             09101030
           MOVE SPACES           TO ASC-SKU-DESC                        09110030
                                    SKUDSCO.                            09111030
           MOVE SPACES           TO ASC-UPC-NUMBER-X                    09120030
                                    UPCO.                               09130030
           MOVE ZERO             TO ASC-ITEM-NBR.                       09140024
                                                                        09150024
      ******************************************************************09160024
      ** VALIDATE DEPARTMENT/ MAJOR CLASS/ SUBCLASS COMBINATIONS.     **09170025
      ******************************************************************09190024
       3600-VALIDATE-DEPT-NBR.                                          09200024
                                                                        09210024
           IF ASC-DEPT-NUMBER-X > SPACES                                09211025
              IF ASC-MCL-NUMBER-X > SPACES                              09212025
                 IF ASC-SCL-NUMBER-X > SPACES                           09212125
                    PERFORM 3610-VALIDATE-SCL                           09212225
                    IF SQLCODE = ZERO                                   09212325
                       PERFORM 3615-MOVE-SCL-VALUES                     09212525
                    ELSE                                                09212625
                       PERFORM 3617-FORMAT-SCL-ERROR                    09212725
                       SET PS-ERROR                                     09212825
                           DP020-MSG-FATAL   TO TRUE                    09212925
                       MOVE PC-TSYMSG-00110  TO DP020-MSG-NUMBER        09213025
                       MOVE DP015-UNP-ALP-BRT-OFF                       09213125
                                             TO DEPTA                   09213225
                                                MAJCLA                  09213325
                                                SUBCLA                  09213425
                       MOVE DP015-RED        TO DEPTC                   09213525
                                                MAJCLC                  09213625
                                                SUBCLC                  09213725
                       MOVE DP015-REVERSE    TO DEPTH                   09213825
                                                MAJCLH                  09213925
                                                SUBCLH                  09214025
                       MOVE -1               TO SUBCLL                  09214125
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              09214225
                    END-IF                                              09214325
                 ELSE                                                   09214425
                    PERFORM 3620-VALIDATE-MCL                           09214525
                    IF SQLCODE = ZERO                                   09214625
                       PERFORM 3625-MOVE-MCL-VALUES                     09214725
                    ELSE                                                09214825
                       PERFORM 3627-FORMAT-MCL-ERROR                    09214925
                       SET PS-ERROR                                     09215025
                           DP020-MSG-FATAL   TO TRUE                    09215125
                       MOVE PC-TSYMSG-00110  TO DP020-MSG-NUMBER        09215225
                       MOVE DP015-UNP-ALP-BRT-OFF                       09215325
                                             TO DEPTA                   09215425
                                                MAJCLA                  09215525
                       MOVE DP015-RED        TO DEPTC                   09215625
                                                MAJCLC                  09215725
                       MOVE DP015-REVERSE    TO DEPTH                   09215825
                                                MAJCLH                  09215925
                       MOVE -1               TO MAJCLL                  09216025
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              09216125
                    END-IF                                              09216225
                 END-IF                                                 09216325
              ELSE                                                      09216425
                 PERFORM 3630-VALIDATE-DEPT                             09216525
                 IF SQLCODE = ZERO                                      09216625
                    PERFORM 3635-MOVE-DEPT-VALUES                       09216725
                 ELSE                                                   09216825
                    PERFORM 3637-FORMAT-DEPT-ERROR                      09216925
                    SET PS-ERROR                                        09217025
                        DP020-MSG-FATAL   TO TRUE                       09217125
                    MOVE PC-TSYMSG-01907  TO DP020-MSG-NUMBER           09217225
                    MOVE DP015-UNP-ALP-BRT-OFF                          09217325
                                          TO DEPTA                      09217425
                    MOVE DP015-RED        TO DEPTC                      09217625
                    MOVE DP015-REVERSE    TO DEPTH                      09217825
                    MOVE -1               TO DEPTL                      09218026
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                 09218125
                 END-IF                                                 09218225
              END-IF                                                    09218325
           END-IF.                                                      09218425
                                                                        09218525
      ******************************************************************09218625
      ** VALIDATE DEPARTMENT/MAJOR CLASS/SUBCLASS COMBINATION.        **09218725
      ******************************************************************09218825
       3610-VALIDATE-SCL.                                               09218925
                                                                        09219025
           MOVE ASC-SCL-NUMBER-X TO PV-SCL-NBR-CHAR-X2.                 09219137
           MOVE PV-SCL-NBR-CHAR  TO PV-SCL-CHAR-3.                      09219234
                                                                        09219333
           PERFORM                                                      09220225
               WITH TEST AFTER                                          09220325
               VARYING PV-RETRY-COUNTER                                 09220425
               FROM 1 BY 1                                              09220525
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09220625
                         OR (SQLCODE = ZERO)                            09220725
                         OR (SQLCODE = +100))                           09220825
               EXEC SQL                                                 09220925
                   SELECT MDSEAR_DESC                                   09221025
                       INTO :MDSEAR-DESC                                09221125
                       FROM TMDSEAR                                     09221225
                       WHERE OPERCO_NBR = '03'                          09221325
                         AND DEPT_NBR = :ASC-DEPT-NUMBER-X              09221425
                         AND MAJ_CL_NBR = :ASC-MCL-NUMBER-X             09221525
                         AND SUB_CL_NBR = :PV-SCL-CHAR-3                09221634
                         AND MDSELV_CDE = 'SCL'                         09221725
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  09221825
               END-EXEC                                                 09221925
                                                                        09222025
               EVALUATE TRUE                                            09222125
                   WHEN SQLCODE = ZERO                                  09222225
                   WHEN SQLCODE = +100                                  09222325
                       CONTINUE                                         09222625
                   WHEN SQLWARN0 NOT = SPACES                           09222725
                   WHEN SQLCODE < ZERO                                  09222825
                   WHEN SQLCODE > ZERO                                  09222925
                       MOVE '3610-VALIDATE-SCL'                         09223025
                                         TO DP013-PARAGRAPH             09223125
                       MOVE 'VALIDATE SCL COMBO'                        09223225
                                         TO DP013-MESSAGE-TEXT (1)      09223325
                       MOVE SQLCA        TO DP013-SQLCA                 09223425
                       MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    09223525
                       SET DP013-DB2-ABEND                              09223625
                           DP013-XCTL-DISPLAY-RESTART                   09223725
                                         TO TRUE                        09223825
                       PERFORM DP013-0000-PROCESS-ABEND                 09223925
               END-EVALUATE                                             09224025
           END-PERFORM.                                                 09224125
                                                                        09224225
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09224325
               MOVE '3610-VALIDATE-SCL'                                 09224425
                                         TO DP013-PARAGRAPH             09224525
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09224625
                                         TO DP013-MESSAGE-TEXT (1)      09224725
               MOVE 'VALIDATE SCL COMBO'                                09224825
                                         TO DP013-MESSAGE-TEXT (2)      09224925
               MOVE SQLCA                TO DP013-SQLCA                 09225025
               MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    09225125
               SET DP013-DB2-ABEND                                      09225225
                   DP013-XCTL-DISPLAY-RESTART                           09225325
                                         TO TRUE                        09225425
               PERFORM DP013-0000-PROCESS-ABEND                         09225525
           END-IF.                                                      09225625
                                                                        09225725
      ******************************************************************09226025
      ** VALID DEPARTMENT/MAJOR CLASS/SUBCLASS - MOVE DETAIL TO       **09230025
      ** COMMAREA AND SCREEN.                                         **09231030
      ******************************************************************09240024
       3615-MOVE-SCL-VALUES.                                            09250025
                                                                        09255025
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09256030
                                     SKUO.                              09256130
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09257030
                                     UPCO.                              09257130
            MOVE SPACES           TO ASC-SKU-DESC                       09258030
                                     SKUDSCO.                           09258130
                                                                        09258225
            PERFORM 3690-GET-DEPT-DESC.                                 09258325
                                                                        09258425
            IF SQLCODE = ZERO                                           09258525
               MOVE MDSEAR-DESC TO ASC-DEPT-DESC                        09258625
                                   DPTDSCO                              09258730
            ELSE                                                        09258825
               MOVE SPACES      TO ASC-DEPT-DESC                        09258925
                                   DPTDSCO                              09259030
            END-IF.                                                     09260025
                                                                        09265825
      ******************************************************************09265925
      ** INVALID DEPARTMENT/MAJOR CLASS/SUBCLASS - MOVE SPACES TO     **09266025
      ** COMMAREA AND SCREEN.                                         **09266130
      ******************************************************************09266225
       3617-FORMAT-SCL-ERROR.                                           09266325
                                                                        09266425
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09266530
                                     SKUO.                              09266630
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09266730
                                     UPCO.                              09266830
            MOVE SPACES           TO ASC-DEPT-DESC                      09266930
                                     DPTDSCO.                           09267030
            MOVE SPACES           TO ASC-SKU-DESC                       09267130
                                     SKUDSCO.                           09267230
                                                                        09267325
      ******************************************************************09267425
      ** VALIDATE DEPARTMENT/MAJOR CLASS COMBINATION.                 **09267525
      ******************************************************************09267625
       3620-VALIDATE-MCL.                                               09267725
                                                                        09267825
           PERFORM                                                      09267925
               WITH TEST AFTER                                          09268025
               VARYING PV-RETRY-COUNTER                                 09268125
               FROM 1 BY 1                                              09268225
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09268325
                         OR (SQLCODE = ZERO)                            09268425
                         OR (SQLCODE = +100))                           09268525
               EXEC SQL                                                 09268625
                   SELECT MDSEAR_DESC                                   09268725
                       INTO :MDSEAR-DESC                                09268825
                       FROM TMDSEAR                                     09268925
                       WHERE OPERCO_NBR = '03'                          09269025
                         AND DEPT_NBR = :ASC-DEPT-NUMBER-X              09269125
                         AND MAJ_CL_NBR = :ASC-MCL-NUMBER-X             09269225
                         AND MDSELV_CDE = 'MCL'                         09269325
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  09269425
               END-EXEC                                                 09269525
                                                                        09269625
               EVALUATE TRUE                                            09269725
                   WHEN SQLCODE = ZERO                                  09269825
                   WHEN SQLCODE = +100                                  09269925
                       CONTINUE                                         09270225
                   WHEN SQLWARN0 NOT = SPACES                           09270325
                   WHEN SQLCODE < ZERO                                  09270425
                   WHEN SQLCODE > ZERO                                  09270525
                       MOVE '3620-VALIDATE-MCL'                         09270625
                                         TO DP013-PARAGRAPH             09270725
                       MOVE 'VALIDATE MCL COMBO'                        09270825
                                         TO DP013-MESSAGE-TEXT (1)      09270925
                       MOVE SQLCA        TO DP013-SQLCA                 09271025
                       MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    09271125
                       SET DP013-DB2-ABEND                              09271225
                           DP013-XCTL-DISPLAY-RESTART                   09271325
                                         TO TRUE                        09271425
                       PERFORM DP013-0000-PROCESS-ABEND                 09271525
               END-EVALUATE                                             09271625
           END-PERFORM.                                                 09271725
                                                                        09271825
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09271925
               MOVE '3620-VALIDATE-MCL'                                 09272025
                                         TO DP013-PARAGRAPH             09272125
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09272225
                                         TO DP013-MESSAGE-TEXT (1)      09272325
               MOVE 'VALIDATE MCL COMBO'                                09272425
                                         TO DP013-MESSAGE-TEXT (2)      09272525
               MOVE SQLCA                TO DP013-SQLCA                 09272625
               MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    09272725
               SET DP013-DB2-ABEND                                      09272825
                   DP013-XCTL-DISPLAY-RESTART                           09272925
                                         TO TRUE                        09273025
               PERFORM DP013-0000-PROCESS-ABEND                         09273125
           END-IF.                                                      09273225
                                                                        09273325
      ******************************************************************09273425
      ** VALID DEPARTMENT/MAJOR CLASS - MOVE DETAIL TO                **09273525
      ** COMMAREA AND SCREEN.                                         **09273630
      ******************************************************************09273725
       3625-MOVE-MCL-VALUES.                                            09273825
                                                                        09273925
            MOVE SPACES           TO ASC-SCL-NUMBER-X                   09274030
                                     SUBCLO.                            09274130
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09274230
                                     SKUO.                              09274330
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09274430
                                     UPCO.                              09274530
            MOVE SPACES           TO ASC-SKU-DESC                       09274630
                                     SKUDSCO.                           09274730
                                                                        09274825
            PERFORM 3690-GET-DEPT-DESC.                                 09274925
                                                                        09275025
            IF SQLCODE = ZERO                                           09275125
               MOVE MDSEAR-DESC TO ASC-DEPT-DESC                        09275225
                                   DPTDSCO                              09275330
            ELSE                                                        09275425
               MOVE SPACES      TO ASC-DEPT-DESC                        09275525
                                   DPTDSCO                              09275630
            END-IF.                                                     09275725
                                                                        09275825
      ******************************************************************09275925
      ** INVALID DEPARTMENT/MAJOR CLASS  - MOVE SPACES TO             **09276025
      ** COMMAREA AND SCREEN.                                         **09276130
      ******************************************************************09276225
       3627-FORMAT-MCL-ERROR.                                           09276325
                                                                        09276425
            MOVE SPACES           TO ASC-SCL-NUMBER-X                   09276530
                                     SUBCLO.                            09276630
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09276730
                                     SKUO.                              09276830
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09276930
                                     UPCO.                              09277030
            MOVE SPACES           TO ASC-DEPT-DESC                      09277130
                                     DPTDSCO.                           09277230
            MOVE SPACES           TO ASC-SKU-DESC                       09277330
                                     SKUDSCO.                           09277430
                                                                        09277525
      ******************************************************************09277625
      ** VALIDATE DEPARTMENT.                                         **09277725
      ******************************************************************09277825
       3630-VALIDATE-DEPT.                                              09277925
                                                                        09278025
           PERFORM                                                      09278125
               WITH TEST AFTER                                          09278225
               VARYING PV-RETRY-COUNTER                                 09278325
               FROM 1 BY 1                                              09278425
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09278525
                         OR (SQLCODE = ZERO)                            09278625
                         OR (SQLCODE = +100))                           09278725
               EXEC SQL                                                 09278825
                   SELECT MDSEAR_DESC                                   09278925
                       INTO :MDSEAR-DESC                                09279025
                       FROM TMDSEAR                                     09279125
                       WHERE OPERCO_NBR = '03'                          09279225
                         AND DEPT_NBR = :ASC-DEPT-NUMBER-X              09279325
                         AND MDSELV_CDE = 'DPT'                         09279425
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  09279525
               END-EXEC                                                 09279625
                                                                        09279725
               EVALUATE TRUE                                            09279825
                   WHEN SQLCODE = ZERO                                  09279925
                   WHEN SQLCODE = +100                                  09280025
                       CONTINUE                                         09280325
                   WHEN SQLWARN0 NOT = SPACES                           09280425
                   WHEN SQLCODE < ZERO                                  09280525
                   WHEN SQLCODE > ZERO                                  09280625
                       MOVE '3630-VALIDATE-DEPT'                        09280725
                                         TO DP013-PARAGRAPH             09280825
                       MOVE 'VALIDATE DEPT COMBO'                       09280925
                                         TO DP013-MESSAGE-TEXT (1)      09281025
                       MOVE SQLCA        TO DP013-SQLCA                 09281125
                       MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    09281225
                       SET DP013-DB2-ABEND                              09281325
                           DP013-XCTL-DISPLAY-RESTART                   09281425
                                         TO TRUE                        09281525
                       PERFORM DP013-0000-PROCESS-ABEND                 09281625
               END-EVALUATE                                             09281725
           END-PERFORM.                                                 09281825
                                                                        09281925
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09282025
               MOVE '3630-VALIDATE-DEPT'                                09282125
                                         TO DP013-PARAGRAPH             09282225
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09282325
                                         TO DP013-MESSAGE-TEXT (1)      09282425
               MOVE 'VALIDATE DEPT COMBO'                               09282525
                                         TO DP013-MESSAGE-TEXT (2)      09282625
               MOVE SQLCA                TO DP013-SQLCA                 09282725
               MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    09282825
               SET DP013-DB2-ABEND                                      09282925
                   DP013-XCTL-DISPLAY-RESTART                           09283025
                                         TO TRUE                        09283125
               PERFORM DP013-0000-PROCESS-ABEND                         09283225
           END-IF.                                                      09283325
                                                                        09283425
      ******************************************************************09283525
      ** VALID DEPARTMENT - MOVE DETAIL TO COMMAREA AND SCREEN.       **09283630
      ******************************************************************09283725
       3635-MOVE-DEPT-VALUES.                                           09283825
                                                                        09283925
            MOVE SPACES           TO ASC-MCL-NUMBER-X                   09284030
                                     MAJCLO.                            09284130
            MOVE SPACES           TO ASC-SCL-NUMBER-X                   09284230
                                     SUBCLO.                            09284330
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09284430
                                     SKUO.                              09284530
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09284630
                                     UPCO.                              09284730
            MOVE SPACES           TO ASC-SKU-DESC                       09284830
                                     SKUDSCO.                           09284930
            MOVE MDSEAR-DESC      TO ASC-DEPT-DESC                      09285030
                                     DPTDSCO.                           09285131
                                                                        09285225
      ******************************************************************09285325
      ** INVALID DEPARTMENT - MOVE SPACES TO COMMAREA AND SCREEN.     **09285430
      ******************************************************************09285525
       3637-FORMAT-DEPT-ERROR.                                          09285625
                                                                        09285725
            MOVE SPACES           TO ASC-MCL-NUMBER-X                   09285830
                                     MAJCLO.                            09285930
            MOVE SPACES           TO ASC-SCL-NUMBER-X                   09286030
                                     SUBCLO.                            09286130
            MOVE SPACES           TO ASC-SKU-NUMBER-X                   09286230
                                     SKUO.                              09286330
            MOVE SPACES           TO ASC-UPC-NUMBER-X                   09286430
                                     UPCO.                              09286530
            MOVE SPACES           TO ASC-SKU-DESC                       09286630
                                     SKUDSCO.                           09286730
            MOVE SPACES           TO ASC-DEPT-DESC                      09286830
                                     DPTDSCO.                           09286930
                                                                        09287025
      ******************************************************************09287125
      ** GET THE DEPARMENT DESCRITPTION                               **09287225
      ******************************************************************09287325
       3690-GET-DEPT-DESC.                                              09287425
                                                                        09287525
           PERFORM                                                      09287625
               WITH TEST AFTER                                          09287725
               VARYING PV-RETRY-COUNTER                                 09287825
               FROM 1 BY 1                                              09287925
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09288025
                         OR (SQLCODE = ZERO)                            09288125
                         OR (SQLCODE = +100))                           09288225
               EXEC SQL                                                 09288325
                   SELECT MDSEAR_DESC                                   09288425
                       INTO :MDSEAR-DESC                                09288525
                       FROM TMDSEAR                                     09288625
                       WHERE OPERCO_NBR = '03'                          09288725
                         AND DEPT_NBR = :ASC-DEPT-NUMBER-X              09288825
                         AND MDSELV_CDE = 'DPT'                         09288925
                         AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE  09289025
               END-EXEC                                                 09289125
                                                                        09289225
               EVALUATE TRUE                                            09289325
                   WHEN SQLCODE = ZERO                                  09289425
                   WHEN SQLCODE = +100                                  09289525
                       CONTINUE                                         09289825
                   WHEN SQLWARN0 NOT = SPACES                           09289925
                   WHEN SQLCODE < ZERO                                  09290025
                   WHEN SQLCODE > ZERO                                  09290125
                       MOVE '3690-GET-DEPT-DESC'                        09290225
                                         TO DP013-PARAGRAPH             09290325
                       MOVE 'GET DEPT DESCRIPTION'                      09290425
                                         TO DP013-MESSAGE-TEXT (1)      09290525
                       MOVE SQLCA        TO DP013-SQLCA                 09290625
                       MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    09290725
                       SET DP013-DB2-ABEND                              09290825
                           DP013-XCTL-DISPLAY-RESTART                   09290925
                                         TO TRUE                        09291025
                       PERFORM DP013-0000-PROCESS-ABEND                 09291125
               END-EVALUATE                                             09291225
           END-PERFORM.                                                 09291325
                                                                        09291425
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09291525
               MOVE '3690-GET-DEPT-DESC'                                09291625
                                         TO DP013-PARAGRAPH             09291725
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09291825
                                         TO DP013-MESSAGE-TEXT (1)      09291925
               MOVE 'GET DEPT DESCRIPTION'                              09292025
                                         TO DP013-MESSAGE-TEXT (2)      09292125
               MOVE SQLCA                TO DP013-SQLCA                 09292225
               MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    09292325
               SET DP013-DB2-ABEND                                      09292425
                   DP013-XCTL-DISPLAY-RESTART                           09292525
                                         TO TRUE                        09292625
               PERFORM DP013-0000-PROCESS-ABEND                         09292725
           END-IF.                                                      09292825
                                                                        09292925
      ******************************************************************09293025
      ** GET THE SKU DESCRITPTION                                     **09293125
      ******************************************************************09293225
       3695-GET-SKU-DESC.                                               09293325
                                                                        09293425
           PERFORM                                                      09293525
               WITH TEST AFTER                                          09293625
               VARYING PV-RETRY-COUNTER                                 09293725
               FROM 1 BY 1                                              09293825
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09293925
                         OR (SQLCODE = ZERO)                            09294025
                         OR (SQLCODE = +100))                           09294125
               EXEC SQL                                                 09294225
                   SELECT SKU_DESC                                      09294325
                       INTO :TSK-SKU-DESC                               09294425
                       FROM TSK                                         09294525
                       WHERE ITEM_NMBR = :SKXREF-ITM-NBR                09294625
               END-EXEC                                                 09294725
                                                                        09294825
               EVALUATE TRUE                                            09294925
                   WHEN SQLCODE = ZERO                                  09295025
                   WHEN SQLCODE = +100                                  09295125
                       CONTINUE                                         09295425
                   WHEN SQLWARN0 NOT = SPACES                           09295525
                   WHEN SQLCODE < ZERO                                  09295625
                   WHEN SQLCODE > ZERO                                  09295725
                       MOVE '3695-GET-SKU-DESC'                         09295825
                                         TO DP013-PARAGRAPH             09295925
                       MOVE 'GET SKU DESCRIPTION'                       09296025
                                         TO DP013-MESSAGE-TEXT (1)      09296125
                       MOVE SQLCA        TO DP013-SQLCA                 09296225
                       MOVE 'TSK    '    TO DP013-DB2-TABLE-NAME (1)    09296325
                       SET DP013-DB2-ABEND                              09296425
                           DP013-XCTL-DISPLAY-RESTART                   09296525
                                         TO TRUE                        09296625
                       PERFORM DP013-0000-PROCESS-ABEND                 09296725
               END-EVALUATE                                             09296825
           END-PERFORM.                                                 09296925
                                                                        09297025
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09297125
               MOVE '3695-GET-SKU-DESC'                                 09297225
                                         TO DP013-PARAGRAPH             09297325
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09297425
                                         TO DP013-MESSAGE-TEXT (1)      09297525
               MOVE 'GET SKU DESCRIPTION'                               09297625
                                         TO DP013-MESSAGE-TEXT (2)      09297725
               MOVE SQLCA                TO DP013-SQLCA                 09297825
               MOVE 'TSK    '            TO DP013-DB2-TABLE-NAME (1)    09297925
               SET DP013-DB2-ABEND                                      09298025
                   DP013-XCTL-DISPLAY-RESTART                           09298125
                                         TO TRUE                        09298225
               PERFORM DP013-0000-PROCESS-ABEND                         09298325
           END-IF.                                                      09298425
                                                                        09298525
      ******************************************************************09298625
      ** VALIDATE STORE NUMBER.                                       **09298725
      ******************************************************************09298825
       3700-VALIDATE-STORE-NBR.                                         09298945
                                                                        09299045
           MOVE ASC-STORE-NUMBER TO PV-LOC-NBR.                         09299248
                                                                        09299645
           PERFORM                                                      09299745
               WITH TEST AFTER                                          09299845
               VARYING PV-RETRY-COUNTER                                 09299945
               FROM 1 BY 1                                              09300045
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09300145
                         OR (SQLCODE = ZERO)                            09300245
                         OR (SQLCODE = +100))                           09300345
               EXEC SQL                                                 09300445
                   SELECT LOC_10_ABBR_NM                                09300545
                       INTO :XMT00001-LOC-10-ABBR-NM                    09300645
                       FROM XMT_LOC                                     09300745
                       WHERE LOC_NBR = :PV-LOC-NBR                      09300845
                       AND ((FINCL_CLO_DTE >= CURRENT DATE)             09300947
                        OR  (FINCL_CLO_DTE IS NULL))                    09301047
               END-EXEC                                                 09301145
                                                                        09301245
               EVALUATE TRUE                                            09301345
                   WHEN SQLCODE = ZERO                                  09301445
                   WHEN SQLCODE = +100                                  09301545
                       CONTINUE                                         09301845
                   WHEN SQLWARN0 NOT = SPACES                           09301945
                   WHEN SQLCODE < ZERO                                  09302045
                   WHEN SQLCODE > ZERO                                  09302145
                       MOVE '3700-VALIDATE-STORE-NBR'                   09302245
                                         TO DP013-PARAGRAPH             09302345
                       MOVE 'VALIDATE STORE NBR'                        09302445
                                         TO DP013-MESSAGE-TEXT (1)      09302545
                       MOVE SQLCA        TO DP013-SQLCA                 09302645
                       MOVE 'XMT_LOC'    TO DP013-DB2-TABLE-NAME (1)    09302745
                       SET DP013-DB2-ABEND                              09302845
                           DP013-XCTL-DISPLAY-RESTART                   09302945
                                         TO TRUE                        09303045
                       PERFORM DP013-0000-PROCESS-ABEND                 09303145
               END-EVALUATE                                             09303245
           END-PERFORM.                                                 09303345
                                                                        09303445
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09303545
               MOVE '3700-VALIDATE-STORE-NBR'                           09303645
                                         TO DP013-PARAGRAPH             09303745
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09303845
                                         TO DP013-MESSAGE-TEXT (1)      09303945
               MOVE 'VALIDATE STORE NBR'                                09304045
                                         TO DP013-MESSAGE-TEXT (2)      09304145
               MOVE SQLCA                TO DP013-SQLCA                 09304245
               MOVE 'XMT_LOC'            TO DP013-DB2-TABLE-NAME (1)    09304345
               SET DP013-DB2-ABEND                                      09304445
                   DP013-XCTL-DISPLAY-RESTART                           09304545
                                         TO TRUE                        09304645
               PERFORM DP013-0000-PROCESS-ABEND                         09304745
           END-IF.                                                      09304845
                                                                        09304945
      ******************************************************************09305025
      ** VALIDATE SKU/STORE EXISTANCE.                                **09305125
      ** THIS IS THE STANDARD METHOD FOR EXISTANCE CHECKING.          **09305269
      ******************************************************************09305369
       3800-VALIDATE-SKU-STORE.                                         09305469
                                                                        09305569
           MOVE ASC-STORE-NUMBER TO PV-LOC-NBR.                         09305669
           MOVE ASC-ITEM-NBR     TO PV-ITEM-NBR.                        09305769
                                                                        09305869
           PERFORM                                                      09305969
               WITH TEST AFTER                                          09306069
               VARYING PV-RETRY-COUNTER                                 09306169
               FROM 1 BY 1                                              09306269
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09306369
                         OR (SQLCODE = ZERO)                            09306469
                         OR (SQLCODE = +100))                           09306569
               EXEC SQL                                                 09306767
                   SELECT 1                                             09307369
                    INTO :PV-ONE                                        09307471
                    FROM SYSIBM.SYSDUMMY1 X                             09307569
                    WHERE  EXISTS                                       09307669
                       (SELECT 1                                        09307769
                          FROM TSKST                                    09307869
                         WHERE ITEM_NMBR = :PV-ITEM-NBR                 09307969
                           AND LOC_NBR = :PV-LOC-NBR                    09308069
                           AND X.IBMREQD  > ' ')                        09308269
               END-EXEC                                                 09308369
                                                                        09308469
               EVALUATE TRUE                                            09308569
                   WHEN SQLCODE = ZERO                                  09308669
                   WHEN SQLCODE = +100                                  09308769
                       CONTINUE                                         09308869
                   WHEN SQLWARN0 NOT = SPACES                           09308969
                   WHEN SQLCODE < ZERO                                  09309069
                   WHEN SQLCODE > ZERO                                  09309169
                       MOVE '3800-VALIDATE-SKU-STORE'                   09309269
                                         TO DP013-PARAGRAPH             09309369
                       MOVE 'VALIDATE SKU/STORE NBR'                    09309469
                                         TO DP013-MESSAGE-TEXT (1)      09309569
                       MOVE SQLCA        TO DP013-SQLCA                 09309669
                       MOVE 'TSKST  '    TO DP013-DB2-TABLE-NAME (1)    09309769
                       SET DP013-DB2-ABEND                              09309869
                           DP013-XCTL-DISPLAY-RESTART                   09309969
                                         TO TRUE                        09310069
                       PERFORM DP013-0000-PROCESS-ABEND                 09310169
               END-EVALUATE                                             09310269
           END-PERFORM.                                                 09310369
                                                                        09310469
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09310569
               MOVE '3800-VALIDATE-SKU-STORE'                           09310669
                                         TO DP013-PARAGRAPH             09310769
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09310869
                                         TO DP013-MESSAGE-TEXT (1)      09310969
               MOVE 'VALIDATE SKU/STORE NBR'                            09311069
                                         TO DP013-MESSAGE-TEXT (2)      09311169
               MOVE SQLCA                TO DP013-SQLCA                 09311269
               MOVE 'TSKST  '            TO DP013-DB2-TABLE-NAME (1)    09311369
               SET DP013-DB2-ABEND                                      09311469
                   DP013-XCTL-DISPLAY-RESTART                           09311569
                                         TO TRUE                        09311669
               PERFORM DP013-0000-PROCESS-ABEND                         09311769
           END-IF.                                                      09311869
                                                                        09311969
      ******************************************************************09312069
      *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *09312169
      ******************************************************************09312269
       4000-BUILD-INITIAL-PANEL.                                        09312369
           SET DP030-SET-CURSOR-APPL-1   TO TRUE                        09313014
           MOVE -1                       TO DEPTL.                      09320014
                                                                        09330053
      ******************************************************************09340074
      *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *09340174
      ******************************************************************09340274
       4200-MOVE-INTR-APPL-TO-COMAREA.                                  09340375
                                                                        09340474
           MOVE MH000-DEPT-NUMBER-X      TO ASC-DEPT-NUMBER-X.          09340574
           MOVE MH000-DEPT-NAME          TO ASC-DEPT-DESC.              09340674
           MOVE MH000-MCL-NUMBER-X       TO ASC-MCL-NUMBER-X.           09340774
           MOVE MH000-SCL-NUMBER-X       TO ASC-SCL-NUMBER-X.           09340874
           MOVE MH000-SKU-NUMBER-X       TO ASC-SKU-NUMBER-X.           09340974
           MOVE MH000-SKU-DESCRIPTION    TO ASC-SKU-DESC.               09341074
           MOVE MH000-UPC-NUMBER-X       TO ASC-UPC-NUMBER-X.           09341174
           MOVE MH000-STORE-NUMBER-X     TO ASC-STORE-NUMBER-X.         09341274
           MOVE MH000-STORE-SHORT-NAME   TO ASC-STORE-DESC.             09341374
                                                                        09341574
      ******************************************************************09342045
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *09350014
      ******************************************************************09361045
       4400-MOVE-COMMAREA-TO-SCREEN.                                    09370014
                                                                        09371074
           MOVE ASC-DEPT-NUMBER-X        TO DEPTO.                      09380014
           MOVE ASC-DEPT-DESC            TO DPTDSCO.                    09390014
           MOVE ASC-MCL-NUMBER-X         TO MAJCLO.                     09400014
           MOVE ASC-SCL-NUMBER-X         TO SUBCLO.                     09410014
           MOVE ASC-SKU-NUMBER-X         TO SKUO.                       09420014
           MOVE ASC-SKU-DESC             TO SKUDSCO.                    09430014
           MOVE ASC-UPC-NUMBER-X         TO UPCO.                       09440014
           MOVE ASC-STORE-NUMBER-X       TO STOREO.                     09450014
           MOVE ASC-STORE-DESC           TO STDESCO.                    09460014
       EJECT                                                            09470014
      ******************************************************************09471045
      *    ABEND PROCESSOR MODULE                                      *09490014
      ******************************************************************09491045
           COPY DPPD013.                                                09520014
