000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP018.                                00020000
000300 AUTHOR.                 M J GROFF.                               00030000
000400 DATE-WRITTEN.           JUNE 1983.                               00040000
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*GIMBEL'S DIRECT SHIPMENTS--BATCH  1/84                           00070000
000800*GIMBEL'S BUYER VERIFIED JOURNAL CHANGES--PROGRAM RCKRP018        00080000
000900*THE PROGRAM MODIFICATIONS ARE AS FOLLOWS:                        00090000
001000*1)THE HEADER ON THE REPORT MUST BE MODIFIED TO INCLUDE THE LABEL 00100000
001100*  'RECEIVING LOCATION' OR SOMETHING SIMILAR                      00110000
001200*2)ON EACH CONTROL BREAK FOR PURCHASE ORDER, MOVE RC043-RECEIVING-00120000
001300*  ATION TO A 2 BYTE ALPHANUMERIC FIELD WHICH MUST BE CREATED     00130000
001400*  ON THE DETAIL LINE UNDERNEATH RECEIVING LOCATION               00140000
001500******************************************************************00150000
001600******************************************************************00160000
001700**               P R O G R A M    C H A N G E S                  *00170000
001800******************************************************************00180000
001900** DATE   |      CHANGES                             | REFERENCE *00190000
002000**---------------------------------------------------------------*00200000
002100** 02/84  | ADD THE RECEIVING LOCATION FOR ALL PO'S  |  020784   *00210000
002200**        | ON THE BUYERS RECEIPT JOURNAL.           |           *00220000
002300**---------------------------------------------------------------*00230000
002400** 06/84  | CHANGES NECESSARY FOR KOHLS ADDITION     | T MIHALKO *00240000
002500******************************************************************00250000
002600**        | A. REGION '03' AS OPERATING COMPANY WILL      |      *00260000
002700**        |    PRINT SINCE IT IS FROM STORE EXTRACT       |      *00270000
002800**        |    WS-HDR3-REGION.                            |      *00280000
002900**        | B. REFERENCE TO 'STORE' IN HEADER AND         |      *00290000
003000**        |    DETAIL LINES WILL HAVE TO BE REMOVED       |      *00300000
003100**        |    WHEN PROCESSING KOHLS DATA.                |      *00310000
003200**        | C. ADD HEADER NAME 'COST TOTAL',              |      *00320000
003300**        |    DETAIL FIELD 'WS-DTL-COST' AND             |      *00330000
003400**        |    'WS-TTL-COST' ACCUMULATOR TO PRINT         |      *00340000
003500**        |    APPORIATE DATA. THIS INFORMATION IS        |      *00350000
003600**        |    PASSED FROM CMP802MB.                      |      *00360000
003700**---------------------------------------------------------------*00370000
003800** 12/88  | CHANGES FOR MAINSTREET AQUISITION        | J PLINSKA *00380000
003900**        |  SEPERATE REPORT TOTALS BY DISTRIBUTION  |           *00390000
004000**        |  CENTER.                                 |           *00400000
004100******************************************************************00410000
004200**        | A. REPORT ACCUMULATED TOTALS FOR DEPARTMENT,  |      *00420000
004300**        |    DIVISION, REGION AND TOTAL ALL REGIONS     |      *00430000
004400**        |    ARE SPLIT BY DISTRIBUTION CENTER.          |      *00440000
004500**        | B. REVISE THE PRINTING FORMAT OF THE TOTAL    |      *00450000
004600**        |    LINES TO MAKE THE REPORT MORE READABLE.    |      *00460000
004700**---------------------------------------------------------------*00470000
004800** 05/94  | INCREASED STORE NUMBER FROM 2 TO 3       | B BILSKI  *00480000
004900**        | INCREASED PO NUMBER FROM 7 TO 8          | TKMA117   *00490000
005000******************************************************************00500000
005100** 05/97  | ADDED WEEKLY RECEIPTS FILE & LOGIC FOR   | D METZGER *00510000
005200**        | LEDGER APPLICATION.  NEEDED FOR DEFERRED |&T MEDREK  *00520000
005300**        | BOOKING OF RECEIPTS.                     | TKMA313   *00530000
005400******************************************************************00540000
005500** 10/14  | INC1024683 MODIFIED PROGRAM TO USE UNIT  | LENIN M   *00550003
005600**        | COST FOR IMPORT PO'S AND PRIVATE LABEL   | TAG :     *00560004
005700**        | DOMESTIC PO'S WHILE FIRST COST FOR       | LM4683    *00570004
005800**        | DOMESTIC PO'S.                           |           *00580004
005900******************************************************************00590000
006000** 10/14  | CHG0098147 CHANGES THRU OUT THE PROGRAM  | PRITHIVI  *00600000
006100**        | TO INCREASE THE SIZE OF PO# FROM 7 DIGITS| TAG :     *00610000
006200**        | TO 8 DIGITS.                             |PS 10/27/14*00620000
006300******************************************************************00630000
006400 ENVIRONMENT DIVISION.                                            00640000
006500 CONFIGURATION SECTION.                                           00650000
006600 OBJECT-COMPUTER.            IBM-370.                             00660000
006700 SOURCE-COMPUTER.            IBM-370.                             00670000
006800 INPUT-OUTPUT SECTION.                                            00680000
006900 FILE-CONTROL.                                                    00690000
007000 SKIP1                                                            00700000
007100     SELECT STORE-EXTRACT        ASSIGN TO UT-S-INP01.            00710000
007200     SELECT BUYERS-RECEIPTS      ASSIGN TO UT-S-RPT01.            00720000
007300     SELECT CC-RUN-TYPE          ASSIGN TO UT-S-INP03.            00730000
007400     SELECT WEEKLY-RECEIPTS-FILE ASSIGN TO OUT01.                 00740000
007500 EJECT                                                            00750000
007600 DATA DIVISION.                                                   00760000
007700 FILE SECTION.                                                    00770000
007800 SKIP3                                                            00780000
007900 FD  STORE-EXTRACT                                                00790000
008000     RECORDING MODE IS F                                          00800000
008100     RECORD CONTAINS 550 CHARACTERS                               00810000
008200     BLOCK CONTAINS  0 RECORDS                                    00820000
008300     LABEL RECORDS ARE STANDARD.                                  00830000
008400 SKIP1                                                            00840000
008500 01  STORE-EXTRACT-REC           PIC X(550).                      00850000
008600 SKIP3                                                            00860000
008700 FD  BUYERS-RECEIPTS                                              00870000
008800     RECORDING MODE IS F                                          00880000
008900     RECORD CONTAINS 132 CHARACTERS                               00890000
009000     BLOCK CONTAINS  0 RECORDS                                    00900000
009100     LABEL RECORDS ARE STANDARD.                                  00910000
009200 SKIP1                                                            00920000
009300 01  BUYERS-RECEIPTS-RPT         PIC X(132).                      00930000
009400 SKIP3                                                            00940000
009500 FD  CC-RUN-TYPE                                                  00950000
009600     RECORDING MODE IS F                                          00960000
009700     RECORD CONTAINS 080 CHARACTERS                               00970000
009800     BLOCK CONTAINS  0 RECORDS                                    00980000
009900     LABEL RECORDS ARE STANDARD.                                  00990000
010000 SKIP1                                                            01000000
010100 01  CC-RUN-TYPE-RECORD          PIC X(080).                      01010000
010200 SKIP3                                                            01020000
010300 FD  WEEKLY-RECEIPTS-FILE                                         01030000
010400     RECORDING MODE IS F                                          01040000
010500     RECORD CONTAINS 80 CHARACTERS                                01050000
010600     BLOCK CONTAINS  0 RECORDS                                    01060000
010700     LABEL RECORDS ARE STANDARD.                                  01070000
010800 SKIP1                                                            01080000
010900 01  WEEKLY-RECEIPTS-REC         PIC X(080).                      01090000
011000 SKIP3                                                            01100000
011100 EJECT                                                            01110000
011200 WORKING-STORAGE SECTION.                                         01120000
011300                                                                  01130000
011400 01  PROGRAM-SWITCHES.                                            01140000
011500     05  PS-EOF-SW               PIC X(01) VALUE 'N'.             01150000
011600         88  PS-EOF              VALUE 'Y'.                       01160000
011700     05  PS-DEPT-BREAK-SW        PIC X(01) VALUE 'N'.             01170000
011800         88  PS-DEPT-BREAK       VALUE 'Y'.                       01180000
011900     05  PS-BYR-BREAK-SW         PIC X(01) VALUE 'N'.             01190000
012000         88  PS-BYR-BREAK        VALUE 'Y'.                       01200000
012100     05  PS-DMM-BREAK-SW         PIC X(01) VALUE 'N'.             01210000
012200         88  PS-DMM-BREAK        VALUE 'Y'.                       01220000
012300     05  PS-GMM-BREAK-SW         PIC X(01) VALUE 'N'.             01230000
012400         88  PS-GMM-BREAK        VALUE 'Y'.                       01240000
012500     05  PS-FINAL-BREAK-SW       PIC X(01) VALUE 'N'.             01250000
012600         88  PS-FINAL-BREAK-SW   VALUE 'Y'.                       01260000
012700     05  DEPT-FOUND-SW                     PIC X      VALUE 'N'.  01270000
012800         88  DEPT-FOUND                               VALUE 'Y'.  01280000
012900         88  DEPT-NOT-FOUND                           VALUE 'N'.  01290000
013000     05  END-OF-DEPT-SW                    PIC X      VALUE 'N'.  01300000
013100         88  END-OF-DEPT-CSR                          VALUE 'Y'.  01310000
013200         88  NOT-END-OF-DEPT-CSR                      VALUE 'N'.  01320000
013300********************** RECORD COUNTERS ***************************01330000
013400 77  WS-CNT-DTL                  PIC 9(9)            VALUE 0.     01340000
013500********************** REPORT CALC FIELDS ************************01350000
013600 77  WS-TOTAL-POSEQ-RETAIL       PIC S9(13)V99 COMP-3 VALUE +0.   01360000
013700 77  WS-TOTAL-POSEQ-COST         PIC S9(13)V99 COMP-3 VALUE +0.   01370000
013800 77  WS-TOTAL-POSEQ-UNITS        PIC S9(13)V99 COMP-3 VALUE +0.   01380000
013900 77  WS-TOTAL-PO-RETAIL          PIC S9(13)V99 COMP-3 VALUE +0.   01390000
014000 77  WS-TOTAL-PO-COST            PIC S9(13)V99 COMP-3 VALUE +0.   01400000
014100 77  WS-TOTAL-PO-UNITS           PIC S9(13)V99 COMP-3 VALUE +0.   01410000
014200 77  WS-TOTAL-CLASS-RETAIL       PIC S9(13)V99 COMP-3 VALUE +0.   01420000
014300 77  WS-TOTAL-CLASS-COST         PIC S9(13)V99 COMP-3 VALUE +0.   01430000
014400 77  WS-TOTAL-CLASS-UNITS        PIC S9(13)V99 COMP-3 VALUE +0.   01440000
014500 77  WS-TOTAL-MAJ-CLASS-RETAIL   PIC S9(13)V99 COMP-3 VALUE +0.   01450000
014600 77  WS-TOTAL-MAJ-CLASS-COST     PIC S9(13)V99 COMP-3 VALUE +0.   01460000
014700 77  WS-TOTAL-MAJ-CLASS-UNITS    PIC S9(13)V99 COMP-3 VALUE +0.   01470000
014800 77  WS-TOTAL-DEPT-RETAIL        PIC S9(13)V99 COMP-3 VALUE +0.   01480000
014900 77  WS-TOTAL-DEPT-COST          PIC S9(13)V99 COMP-3 VALUE +0.   01490000
015000 77  WS-TOTAL-DEPT-UNITS         PIC S9(13)V99 COMP-3 VALUE +0.   01500000
015100 77  WS-TOTAL-BYR-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01510000
015200 77  WS-TOTAL-BYR-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01520000
015300 77  WS-TOTAL-BYR-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01530000
015400 77  WS-TOTAL-DMM-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01540000
015500 77  WS-TOTAL-DMM-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01550000
015600 77  WS-TOTAL-DMM-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01560000
015700 77  WS-TOTAL-GMM-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01570000
015800 77  WS-TOTAL-GMM-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01580000
015900 77  WS-TOTAL-GMM-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01590000
016000 77  WS-TOTAL-RPT-RETAIL         PIC S9(13)V99 COMP-3 VALUE +0.   01600000
016100 77  WS-TOTAL-RPT-COST           PIC S9(13)V99 COMP-3 VALUE +0.   01610000
016200 77  WS-TOTAL-RPT-UNITS          PIC S9(13)V99 COMP-3 VALUE +0.   01620000
016300                                                                  01630000
016400 77  WS-LINE-CNT                 PIC S9(3)    COMP-3 VALUE +56.   01640000
016500 77  WS-PAGE-CNT                 PIC S9(5)    COMP-3 VALUE +0.    01650000
016600********************** HOLD AREAS/SWITCHES ***********************01660000
016700 01  WS-CC                       PIC 9               VALUE 1.     01670000
016800 01  WS-FIRST-TIME-IND           PIC X               VALUE 'X'.   01680000
016900     88  FIRST-TIME                                  VALUE 'X'.   01690000
017000 01  WS-WK-END-DATE                                  VALUE        01700000
017100                                                       LOW-VALUES.01710000
017200     05  WS-WK-END-CC            PIC XX.                          01720000
017300     05  WS-WK-END-YY            PIC XX.                          01730000
017400     05  WS-WK-END-MM            PIC XX.                          01740000
017500     05  WS-WK-END-DD            PIC XX.                          01750000
017600 01  WS-LAST-DAY-OF-WEEK.                                         01760000
017700     05  WS-LAST-DAY-OF-WEEK-CC  PIC XX.                          01770000
017800     05  WS-LAST-DAY-OF-WEEK-YY  PIC XX.                          01780000
017900     05  FILLER                  PIC X.                           01790000
018000     05  WS-LAST-DAY-OF-WEEK-MM  PIC XX.                          01800000
018100     05  FILLER                  PIC X.                           01810000
018200     05  WS-LAST-DAY-OF-WEEK-DD  PIC XX.                          01820000
018300 01  WS-1ST-DAY-OF-WEEK.                                          01830000
018400     05  WS-1ST-DAY-OF-WEEK-CC   PIC XX.                          01840000
018500     05  WS-1ST-DAY-OF-WEEK-YY   PIC XX.                          01850000
018600     05  FILLER                  PIC X.                           01860000
018700     05  WS-1ST-DAY-OF-WEEK-MM   PIC XX.                          01870000
018800     05  FILLER                  PIC X.                           01880000
018900     05  WS-1ST-DAY-OF-WEEK-DD   PIC XX.                          01890000
019000 01  WS-DATE-VERIFIED-COUNT.                                      01900000
019100     05  WS-DATE-VFYD-COUNT-MM   PIC XX.                          01910000
019200     05  WS-DATE-VFYD-COUNT-DD   PIC XX.                          01920000
019300     05  WS-DATE-VFYD-COUNT-YY   PIC XX.                          01930000
019400 01  WS-DATE-VERIFIED-PRT.                                        01940000
019500     05  WS-DATE-VERIFIED-PRT-MM PIC XX.                          01950000
019600     05  FILLER                  PIC X     VALUE '/'.             01960000
019700     05  WS-DATE-VERIFIED-PRT-DD PIC XX.                          01970000
019800     05  FILLER                  PIC X     VALUE '/'.             01980000
019900     05  WS-DATE-VERIFIED-PRT-YY PIC XX.                          01990000
020000 01  WS-DATE-RECEIVED.                                            02000000
020100     05  WS-DATE-RECEIVED-MM     PIC XX.                          02010000
020200     05  WS-DATE-RECEIVED-DD     PIC XX.                          02020000
020300     05  WS-DATE-RECEIVED-YY     PIC XX.                          02030000
020400 01  WS-DATE-RECEIVED-PRT.                                        02040000
020500     05  WS-DATE-RECEIVED-PRT-MM PIC XX.                          02050000
020600     05  FILLER                  PIC X     VALUE '/'.             02060000
020700     05  WS-DATE-RECEIVED-PRT-DD PIC XX.                          02070000
020800     05  FILLER                  PIC X     VALUE '/'.             02080000
020900     05  WS-DATE-RECEIVED-PRT-YY PIC XX.                          02090000
021000 01  WS-COMPARE-DATE.                                             02100000
021100     05  WS-COMPARE-DATE-CC      PIC XX.                          02110000
021200     05  WS-COMPARE-DATE-YY      PIC XX.                          02120000
021300     05  WS-COMPARE-DATE-MM      PIC XX.                          02130000
021400     05  WS-COMPARE-DATE-DD      PIC XX.                          02140000
021500 01  WS-DATE.                                                     02150000
021600     05  WS-DATE-YY              PIC XX.                          02160000
021700     05  WS-DATE-MM              PIC XX.                          02170000
021800     05  WS-DATE-DD              PIC XX.                          02180000
021900 01  WS-DATE-CCYYMMDD.                                            02190000
022000     05  WS-DATE-CCYYMMDD-CC     PIC XX.                          02200000
022100     05  WS-DATE-CCYYMMDD-YY     PIC XX.                          02210000
022200     05  WS-DATE-CCYYMMDD-MM     PIC XX.                          02220000
022300     05  WS-DATE-CCYYMMDD-DD     PIC XX.                          02230000
022400 01  WS-HOLD-TCOCNTL-DATE.                                        02240000
022500     05  WS-HOLD-TCOCNTL-CC      PIC XX.                          02250000
022600     05  WS-HOLD-TCOCNTL-YY      PIC XX.                          02260000
022700     05  FILLER                  PIC X.                           02270000
022800     05  WS-HOLD-TCOCNTL-MM      PIC XX.                          02280000
022900     05  FILLER                  PIC X.                           02290000
023000     05  WS-HOLD-TCOCNTL-DD      PIC XX.                          02300000
023100 01  WS-TIME.                                                     02310000
023200     05  WS-TIME-HH              PIC 99.                          02320000
023300     05  WS-TIME-MM              PIC 99.                          02330000
023400     05  WS-TIME-SS              PIC 99.                          02340000
023500                                                                  02350000
023600 01  WS-RUN-TYPE-RECORD.                                          02360000
023700     05  WS-RUN-TYPE             PIC X.                           02370000
023800         88  WEEKLY-RUN          VALUE 'W'.                       02380000
023900         88  MONTHLY-RUN         VALUE 'M'.                       02390000
024000     05  FILLER                  PIC X(79).                       02400000
024100                                                                  02410000
024200 01  WS-HDR3-WEEK.                                                02420000
024300     05  FILLER              PIC X(43)       VALUE                02430000
024400     'VERIFIED COUNT INFORMATION FOR THE WEEK OF '.               02440000
024500     05  WS-HDR3-MM          PIC XX          VALUE SPACES.        02450000
024600     05  FILLER              PIC X           VALUE '/'.           02460000
024700     05  WS-HDR3-DD          PIC XX          VALUE SPACES.        02470000
024800     05  FILLER              PIC X           VALUE '/'.           02480000
024900     05  WS-HDR3-CC          PIC XX          VALUE SPACES.        02490000
025000     05  WS-HDR3-YY          PIC XX          VALUE SPACES.        02500000
025100     05  FILLER              PIC X(17)       VALUE SPACES.        02510000
025200     05  WS-HDR3-WEEKJOB     PIC X(08)       VALUE SPACES.        02520000
025300                                                                  02530000
025400 01  WS-HDR3-MONTH.                                               02540000
025500     05  FILLER              PIC X(43)       VALUE                02550000
025600     'VERIFIED COUNT INFORMATION FOR THE MONTH OF'.               02560000
025700     05  FILLER              PIC X           VALUE SPACES.        02570000
025800     05  WS-HDR3-MONTH-ABBR  PIC X(03)       VALUE SPACES.        02580000
025900     05  FILLER              PIC X           VALUE '.'.           02590000
026000     05  FILLER              PIC X           VALUE SPACES.        02600000
026100     05  WS-HDR3-MONTH-CC    PIC XX          VALUE SPACES.        02610000
026200     05  WS-HDR3-MONTH-YY    PIC XX          VALUE SPACES.        02620000
026300     05  FILLER              PIC X(17)       VALUE SPACES.        02630000
026400     05  WS-HDR3-MNTHJOB     PIC X(08)       VALUE SPACES.        02640000
026500                                                                  02650000
026600 01  WS-HOLD-GM                  PIC X(02).                       02660000
026700 01  WS-HOLD-DM                  PIC X(02).                       02670000
026800 01  WS-HOLD-BYR                 PIC X(03).                       02680000
026900 01  WS-MONTH                    PIC X(03).                       02690000
027000 01  WS-HOLD-DEPT                PIC X(03).                       02700000
027100 01  WS-HOLD-CLASS               PIC X(03).                       02710000
027200 01  WS-HOLD-CLASS-NAME          PIC X(25).                       02720000
027300 01  WS-HOLD-MAJ-CLASS           PIC X(02).                       02730000
027400 01  WS-HOLD-MAJ-CLASS-NAME      PIC X(25).                       02740000
027500 01  WS-HOLD-PO                  PIC 9(08).                       02750000
027600 01  WS-HOLD-REC-SEQ-NBR         PIC 9(09).                       02760000
027700 01  WS-HOLD-REC-SRC-CDE         PIC X(01).                       02770000
027800 01  WS-HOLD-DEF                 PIC X(03).                       02780000
027900 01  WS-HOLD-ADJ-CYC-NBR         PIC S9(09) COMP.                 02790000
028000 01  WS-HOLD-VENDOR-NAME         PIC X(25).                       02800000
028100 01  WS-HOLD-STORE               PIC 9(04).                       02810000
028200 01  WS-HOLD-OPER-UNT-ID         PIC 9(04).                       02820000
028300 01  WS-HOLD-RECEIPT-DATE        PIC X(06).                       02830000
028400 01  WS-HOLD-VERIFY-DATE         PIC X(06).                       02840000
028500 01  WS-HOLD-PRCS-DAYS           PIC 9(03)V9.                     02850000
028600 01  WS-SAVE-MKUP                PIC 9(03)V9(4)-.                 02860000
028700 01  PV-PO-NBR                   PIC S9(9)  VALUE ZEROS           02870000
028800                                            COMP.                 02880000
028900 01  WS-PO-BEING-PROCESSED       PIC 9(09)  VALUE ZEROS.          02890000
029000 01  WS-COST-EXTENSION           PIC S9(9)V99.                    02900000
029100 01  WS-MISC-INFO.                                                02910000
029200     05  PC-MAX-RETRIES                    PIC S9(4)  VALUE +3    02920000
029300                                                      COMP-3.     02930000
029400     05  PC-MORE-THAN-MAX-RETRY            PIC S9(4)  VALUE +4.   02940000
029500     05  PV-PARAGRAPH-NAME                 PIC X(30).             02950000
029600     05  PV-DB2-OPERATION                  PIC X(30)  VALUE SPACE.02960000
029700     05  PV-RETRY-CNT                      PIC S9(04) VALUE +0    02970000
029800                                                      COMP SYNC.  02980000
029900     05  PV-DEPT-NBR-X                   PIC X(03).               02990000
030000     05  FILLER  REDEFINES  PV-DEPT-NBR-X.                        03000000
030100         10  PV-DEPT-NBR-9               PIC 9(03).               03010000
030200     05  PV-DEPT-NBR-B                   PIC S9(04) VALUE +0      03020000
030300                                             COMP SYNC.           03030000
030400     05  PV-MAX-DEPT-TBL-RECS            PIC S9(05) VALUE +999    03040000
030500                                             COMP-3.              03050000
030600     05  PV-NBR-DEPT-TBL-RECS            PIC S9(05) VALUE +0      03060000
030700                                             COMP-3.              03070000
030800     05  PV-HOLD-REC-SEQ-NBR-1-3 PIC 9(03).                       03080000
030900     05  FILLER  REDEFINES  PV-HOLD-REC-SEQ-NBR-1-3.              03090000
031000         10  PV-HOLD-REC-SEQ-NBR-1   PIC X(01).                   03100000
031100         10  PV-HOLD-REC-SEQ-NBR-2   PIC X(01).                   03110000
031200         10  PV-HOLD-REC-SEQ-NBR-3   PIC X(01).                   03120000
031210                                                                  03121005
031220     05  PV-DISP-TABLE-IDX               PIC S9(04) COMP.         03122005
031230     05  PV-DISP-IDX                     PIC 9(04).               03123005
031240     05  PV-DISP-COUNT                   PIC ZZZ,ZZZ,ZZ9.         03124005
031250     05  PV-SE-STR-EXT-COUNT             PIC 9(09) VALUE ZEROES.  03125005
031260     05  PV-WKLY-RCPT-CNT                PIC 9(09) VALUE ZEROES.  03126005
031270     05  PV-DEPT-NO-RCPT-CNT             PIC 9(09) VALUE ZEROES.  03127005
031280     05  PV-RPT-DTL-LINE-CNT             PIC 9(09) VALUE ZEROES.  03128016
031300                                                                  03130000
031400 01  DT-DEPT-TABLE.                                               03140000
031500     05  DT-DEPT-TBL  OCCURS 999 TIMES                            03150000
031600                      INDEXED BY IDX-DT.                          03160000
031700         10  DT-DEPT-NBR                   PIC X(03).             03170000
031800         10  DT-GMA-NBR                    PIC X(02).             03180000
031900         10  DT-DMA-NBR                    PIC X(02).             03190000
032000         10  DT-BYR-NBR                    PIC X(03).             03200000
032100         10  DT-WRITE-SW                   PIC X(01).             03210000
032200                                                                  03220000
032300 01  PROGRAM-CONSTANTS.                                           03230000
032400     05  PC-DPKUT500             PIC X(08)  VALUE 'DPKUT500'.     03240000
032500                                                                  03250000
032600 01  ABEND-CODE                  PIC S9(04)     VALUE +0          03260000
032700                                                     COMP SYNC.   03270000
032800     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 03280000
032900     88  ABEND-4002-READ-ERROR                  VALUE +4002.      03290000
033000     88  ABEND-4003-CTRL-CARD-ERROR             VALUE +4003.      03300000
033100     88  ABEND-4004-TABLE-ERROR                 VALUE +4004.      03310000
033200     88  ABEND-4005-OPEN-ERROR                  VALUE +4005.      03320000
033300     88  ABEND-4006-CLOSE-ERROR                 VALUE +4006.      03330000
033400     88  ABEND-4007-SEQUENCE-ERROR              VALUE +4007.      03340000
033500     88  ABEND-4008-DATS-ERROR                  VALUE +4008.      03350000
033600     88  ABEND-4009-KEY-DATS-ERROR              VALUE +4009.      03360000
033700     88  ABEND-4013-DB2-ERROR                   VALUE +4013.      03370000
033800     88  ABEND-4019-DATE-ROUTINE                VALUE +4019.      03380000
033900                                                                  03390000
034000*********************** STORE WORK RECORD IN ******************** 03400000
034100     COPY RCRD043.                                                03410000
034200                                                                  03420000
034300******************** WEEKLY RECEIPTS RECORD OUT ******************03430000
034400     COPY MLRD031.                                                03440000
034500                                                                  03450000
034600**************************************************                03460000
034700*  WORK AREA FOR DPKUT500 DATE ROUTINE           *                03470000
034800**************************************************                03480000
034900     COPY DPWS500.                                                03490000
035000                                                                  03500000
035100************************ HEADER/DETIAL LINES *********************03510000
035200     COPY DPWS132O.                                               03520000
035300                                                                  03530000
035400 01  WS-HEADER2.                                                  03540000
035500     05  FILLER              PIC X(55)       VALUE SPACES.        03550000
035600     05  FILLER              PIC X(77)       VALUE                03560000
035700     'BUYER RECEIPTS JOURNAL'.                                    03570000
035800                                                                  03580000
035900 01  WS-HEADER3.                                                  03590000
036000     05  FILLER              PIC X(40)       VALUE SPACES.        03600000
036100     05  WS-HDR3             PIC X(78)       VALUE SPACES.        03610000
036200     05  FILLER              PIC X(14)       VALUE SPACES.        03620000
036300                                                                  03630000
036400 01  WS-HEADER4.                                                  03640000
036500     05  FILLER              PIC X(01)       VALUE SPACES.        03650000
036600     05  FILLER              PIC X(06)       VALUE                03660000
036700     'GMM:  '.                                                    03670000
036800     05  WS-HDR4-GMM-NO      PIC X(02)       VALUE SPACES.        03680000
036900     05  FILLER              PIC X(03)       VALUE SPACES.        03690000
037000     05  WS-HDR4-GMM-NAME    PIC X(30)       VALUE SPACES.        03700000
037100     05  FILLER              PIC X(90)       VALUE SPACES.        03710000
037200                                                                  03720000
037300 01  WS-HEADER5.                                                  03730000
037400     05  FILLER              PIC X(01)       VALUE SPACES.        03740000
037500     05  FILLER              PIC X(06)       VALUE                03750000
037600     'DMM:  '.                                                    03760000
037700     05  WS-HDR5-DMM-NO      PIC X(02)       VALUE SPACES.        03770000
037800     05  FILLER              PIC X(03)       VALUE SPACES.        03780000
037900     05  WS-HDR5-DMM-NAME    PIC X(30)       VALUE SPACES.        03790000
038000     05  FILLER              PIC X(90)       VALUE SPACES.        03800000
038100                                                                  03810000
038200 01  WS-HEADER6.                                                  03820000
038300     05  FILLER              PIC X(01)       VALUE SPACES.        03830000
038400     05  FILLER              PIC X(06)       VALUE                03840000
038500     'BYR:  '.                                                    03850000
038600     05  WS-HDR6-BYR-NO      PIC X(03)       VALUE SPACES.        03860000
038700     05  FILLER              PIC X(02)       VALUE SPACES.        03870000
038800     05  WS-HDR6-BYR-NAME    PIC X(30)       VALUE SPACES.        03880000
038900     05  FILLER              PIC X(90)       VALUE SPACES.        03890000
039000                                                                  03900000
039100 01  WS-HEADER7.                                                  03910000
039200     05  FILLER              PIC X(01)       VALUE SPACES.        03920000
039300     05  FILLER              PIC X(06)       VALUE                03930000
039400     'DPT:  '.                                                    03940000
039500     05  WS-HDR7-DEPARTMENT  PIC X(03)       VALUE SPACES.        03950000
039600     05  FILLER              PIC X(02)       VALUE SPACES.        03960000
039700     05  WS-HDR7-DEPT-NAME   PIC X(25)       VALUE SPACES.        03970000
039800     05  FILLER              PIC X(95)       VALUE SPACES.        03980000
039900                                                                  03990000
040000 01  WS-HEADER8.                                                  04000000
040100     05  FILLER              PIC X(01)       VALUE SPACES.        04010000
040200     05  FILLER              PIC X(11)       VALUE                04020000
040300     'PO/SEQ     '.                                               04030000
040400     05  FILLER              PIC X(01)       VALUE SPACES.        04040000
040500     05  FILLER              PIC X(25)       VALUE SPACES.        04050000
040600     05  FILLER              PIC X(02)       VALUE SPACES.        04060000
040700     05  FILLER              PIC X(03)       VALUE                04070000
040800     'CLS'.                                                       04080000
040900     05  FILLER              PIC X(01)       VALUE SPACES.        04090000
041000     05  FILLER              PIC X(05)       VALUE                04100000
041100     'REC  '.                                                     04110000
041200     05  FILLER              PIC X(01)       VALUE SPACES.        04120000
041300     05  FILLER              PIC X(08)       VALUE                04130000
041400     ' RECEIPT'.                                                  04140000
041500     05  FILLER              PIC X(02)       VALUE SPACES.        04150000
041600     05  FILLER              PIC X(08)       VALUE                04160000
041700     ' VERIFY '.                                                  04170000
041800     05  FILLER              PIC X(01)       VALUE SPACES.        04180000
041900     05  FILLER              PIC X(04)       VALUE                04190000
042000     '# OF'.                                                      04200000
042100     05  FILLER              PIC X(01)       VALUE SPACES.        04210000
042200     05  FILLER              PIC X(12)       VALUE                04220000
042300     '    UNITS   '.                                              04230000
042400     05  FILLER              PIC X(01)       VALUE SPACES.        04240000
042500     05  FILLER              PIC X(16)       VALUE                04250000
042600     '      COST      '.                                          04260000
042700     05  FILLER              PIC X(01)       VALUE SPACES.        04270000
042800     05  FILLER              PIC X(16)       VALUE                04280000
042900     '     RETAIL     '.                                          04290000
043000     05  FILLER              PIC X(01)       VALUE SPACES.        04300000
043100     05  FILLER              PIC X(06)       VALUE                04310000
043200     ' MKUP '.                                                    04320000
043300     05  FILLER              PIC X(04)       VALUE SPACES.        04330000
043400                                                                  04340000
043500 01  WS-HEADER9.                                                  04350000
043600     05  FILLER              PIC X(01)       VALUE SPACES.        04360000
043700     05  FILLER              PIC X(11)       VALUE                04370000
043800     'NUMBER     '.                                               04380000
043900     05  FILLER              PIC X(01)       VALUE SPACES.        04390000
044000     05  FILLER              PIC X(25)       VALUE                04400000
044100     'VENDOR NAME              '.                                 04410000
044200     05  FILLER              PIC X(02)       VALUE SPACES.        04420000
044300     05  FILLER              PIC X(03)       VALUE                04430000
044400     'NUM'.                                                       04440000
044500     05  FILLER              PIC X(01)       VALUE SPACES.        04450000
044600     05  FILLER              PIC X(05)       VALUE                04460000
044700     'LOCAT'.                                                     04470000
044800     05  FILLER              PIC X(01)       VALUE SPACES.        04480000
044900     05  FILLER              PIC X(08)       VALUE                04490000
045000     '  DATE  '.                                                  04500000
045100     05  FILLER              PIC X(02)       VALUE SPACES.        04510000
045200     05  FILLER              PIC X(08)       VALUE                04520000
045300     '  DATE  '.                                                  04530000
045400     05  FILLER              PIC X(01)       VALUE SPACES.        04540000
045500     05  FILLER              PIC X(04)       VALUE                04550000
045600     'DAYS'.                                                      04560000
045700     05  FILLER              PIC X(01)       VALUE SPACES.        04570000
045800     05  FILLER              PIC X(12)       VALUE                04580000
045900     '   VERIFIED '.                                              04590000
046000     05  FILLER              PIC X(01)       VALUE SPACES.        04600000
046100     05  FILLER              PIC X(16)       VALUE                04610000
046200     '    VERIFIED    '.                                          04620000
046300     05  FILLER              PIC X(01)       VALUE SPACES.        04630000
046400     05  FILLER              PIC X(16)       VALUE                04640000
046500     '    VERIFIED    '.                                          04650000
046600     05  FILLER              PIC X(01)       VALUE SPACES.        04660000
046700     05  FILLER              PIC X(06)       VALUE                04670000
046800     '  %   '.                                                    04680000
046900     05  FILLER              PIC X(01)       VALUE SPACES.        04690000
047000     05  FILLER              PIC X(04)       VALUE                04700000
047100     'NOTE'.                                                      04710000
047200                                                                  04720000
047300 01  WS-HEADER10.                                                 04730000
047400     05  FILLER              PIC X(01)       VALUE SPACES.        04740000
047500     05  FILLER              PIC X(11)       VALUE                04750000
047600     '-----------'.                                               04760000
047700     05  FILLER              PIC X(01)       VALUE SPACES.        04770000
047800     05  FILLER              PIC X(25)       VALUE                04780000
047900     '-------------------------'.                                 04790000
048000     05  FILLER              PIC X(02)       VALUE SPACES.        04800000
048100     05  FILLER              PIC X(03)       VALUE                04810000
048200     '---'.                                                       04820000
048300     05  FILLER              PIC X(01)       VALUE SPACES.        04830000
048400     05  FILLER              PIC X(05)       VALUE                04840000
048500     '-----'.                                                     04850000
048600     05  FILLER              PIC X(01)       VALUE SPACES.        04860000
048700     05  FILLER              PIC X(08)       VALUE                04870000
048800     '--------'.                                                  04880000
048900     05  FILLER              PIC X(02)       VALUE SPACES.        04890000
049000     05  FILLER              PIC X(08)       VALUE                04900000
049100     '--------'.                                                  04910000
049200     05  FILLER              PIC X(01)       VALUE SPACES.        04920000
049300     05  FILLER              PIC X(04)       VALUE                04930000
049400     '----'.                                                      04940000
049500     05  FILLER              PIC X(01)       VALUE SPACES.        04950000
049600     05  FILLER              PIC X(12)       VALUE                04960000
049700     '-----------'.                                               04970000
049800     05  FILLER              PIC X(01)       VALUE SPACES.        04980000
049900     05  FILLER              PIC X(16)       VALUE                04990000
050000     '---------------'.                                           05000000
050100     05  FILLER              PIC X(01)       VALUE SPACES.        05010000
050200     05  FILLER              PIC X(16)       VALUE                05020000
050300     '---------------'.                                           05030000
050400     05  FILLER              PIC X(01)       VALUE SPACES.        05040000
050500     05  FILLER              PIC X(06)       VALUE                05050000
050600     '------'.                                                    05060000
050700     05  FILLER              PIC X(01)       VALUE SPACES.        05070000
050800     05  FILLER              PIC X(04)       VALUE                05080000
050900     '----'.                                                      05090000
051000                                                                  05100000
051100 01  WS-DETAIL.                                                   05110000
051200     05  FILLER              PIC X(01)       VALUE SPACES.        05120000
051300*PS 10/27/14 CHANGE STARTS                                        05130000
051400     05  WS-DTL-PO-NUMBER    PIC Z(08)       VALUE ZERO.          05140000
051500*PS 10/27/14 CHANGE ENDS                                          05150000
051600     05  WS-DASH1            PIC X(01)       VALUE SPACES.        05160000
051700     05  WS-DTL-REC-SEQ      PIC X(03)       VALUE SPACES.        05170000
051800     05  FILLER              PIC X(01)       VALUE SPACES.        05180000
051900     05  WS-DTL-VENDOR-NAME  PIC X(25)       VALUE SPACES.        05190000
052000     05  FILLER              PIC X(02)       VALUE SPACES.        05200000
052100     05  WS-DTL-CLASS        PIC X(02)       VALUE SPACES.        05210000
052200     05  FILLER              PIC X(02)       VALUE SPACES.        05220000
052300     05  WS-DTL-REC-LOC      PIC X(04)       VALUE SPACES.        05230000
052400     05  FILLER              PIC X(02)       VALUE SPACES.        05240000
052500     05  WS-DTL-REC-DATE     PIC X(08)       VALUE SPACES.        05250000
052600     05  FILLER              PIC X(02)       VALUE SPACES.        05260000
052700     05  WS-DTL-VRFD-DATE    PIC X(08)       VALUE SPACES.        05270000
052800     05  FILLER              PIC X(01)       VALUE SPACES.        05280000
052900     05  WS-DTL-PRCS-DAYS    PIC ZZ.9        VALUE ZEROS.         05290000
053000     05  FILLER              PIC X(01)       VALUE SPACES.        05300000
053100     05  WS-DTL-UNIT-TOTAL   PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05310000
053200     05  FILLER              PIC X(01)       VALUE SPACES.        05320000
053300     05  WS-DTL-TOTAL-COST   PIC $$$$,$$$,$$$.99-                 05330000
053400                                             VALUE ZEROS.         05340000
053500     05  FILLER              PIC X(01)       VALUE SPACES.        05350000
053600     05  WS-DTL-TOTAL-RETAIL PIC $$$$,$$$,$$$.99-                 05360000
053700                                             VALUE ZEROS.         05370000
053800     05  FILLER              PIC X(01)       VALUE SPACES.        05380000
053900     05  WS-DTL-MKUP         PIC ZZZ.9       VALUE ZEROS.         05390000
054000     05  WS-PCT1             PIC X(01)       VALUE SPACES.        05400000
054100     05  FILLER              PIC X(01)       VALUE SPACES.        05410000
054200     05  WS-DTL-DEF          PIC X(03)       VALUE SPACES.        05420000
054300                                                                  05430000
054400 01  WS-TOTAL-LINE1.                                              05440000
054500     05  FILLER              PIC X(19)       VALUE SPACES.        05450000
054600     05  WS-TTL-LIT-A        PIC X(11)       VALUE SPACES.        05460000
054700     05  WS-TTL-LIT-B        PIC X(02)       VALUE SPACES.        05470000
054800     05  FILLER              PIC X(02)       VALUE SPACES.        05480000
054900     05  WS-TTL-LIT-C        PIC X(25)       VALUE SPACES.        05490000
055000     05  WS-TTL-LIT-1        PIC X(12)       VALUE SPACES.        05500000
055100     05  FILLER              PIC X(03)       VALUE SPACES.        05510000
055200     05  WS-TTL-UNIT-TOTAL1  PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05520000
055300     05  FILLER              PIC X(01)       VALUE SPACES.        05530000
055400     05  WS-TTL-TOTAL-COST1  PIC $$$$,$$$,$$$.99-                 05540000
055500                                             VALUE ZEROS.         05550000
055600     05  FILLER  REDEFINES  WS-TTL-TOTAL-COST1.                   05560000
055700         10  WS-TTL-TOTAL-COST1-RD                                05570000
055800                             PIC $$$$$,$$$,$$$.99.                05580000
055900     05  FILLER              PIC X(01)       VALUE SPACES.        05590000
056000     05  WS-TTL-TOTAL-RETAIL1 PIC $$$$,$$$,$$$.99-                05600000
056100                                             VALUE ZEROS.         05610000
056200     05  FILLER  REDEFINES  WS-TTL-TOTAL-RETAIL1.                 05620000
056300         10  WS-TTL-TOTAL-RETAIL1-RD                              05630000
056400                             PIC $$$$$,$$$,$$$.99.                05640000
056500     05  FILLER              PIC X(01)       VALUE SPACES.        05650000
056600     05  WS-TTL-MKUP1        PIC ZZZ.9       VALUE ZEROS.         05660000
056700     05  WS-TTL-PCT1         PIC X(01)       VALUE SPACES.        05670000
056800     05  FILLER              PIC X(06)       VALUE SPACES.        05680000
056900                                                                  05690000
057000 01  WS-TOTAL-LINE2.                                              05700000
057100     05  FILLER              PIC X(59)       VALUE SPACES.        05710000
057200     05  WS-TTL-LIT-2        PIC X(12)       VALUE SPACES.        05720000
057300     05  FILLER              PIC X(03)       VALUE SPACES.        05730000
057400     05  WS-TTL-UNIT-TOTAL   PIC ZZZ,ZZZ,ZZZ- VALUE ZEROS.        05740000
057500     05  FILLER              PIC X(01)       VALUE SPACES.        05750000
057600     05  WS-TTL-TOTAL-COST   PIC $$$$,$$$,$$$.99-                 05760000
057700                                             VALUE ZEROS.         05770000
057800     05  FILLER  REDEFINES  WS-TTL-TOTAL-COST.                    05780000
057900         10  WS-TTL-TOTAL-COST-RD                                 05790000
058000                             PIC $$$$$,$$$,$$$.99.                05800000
058100     05  FILLER              PIC X(01)       VALUE SPACES.        05810000
058200     05  WS-TTL-TOTAL-RETAIL PIC $$$$,$$$,$$$.99-                 05820000
058300                                             VALUE ZEROS.         05830000
058400     05  FILLER  REDEFINES  WS-TTL-TOTAL-RETAIL.                  05840000
058500         10  WS-TTL-TOTAL-RETAIL-RD                               05850000
058600                             PIC $$$$$,$$$,$$$.99.                05860000
058700     05  FILLER              PIC X(01)       VALUE SPACES.        05870000
058800     05  WS-TTL-MKUP         PIC ZZZ.9       VALUE ZEROS.         05880000
058900     05  WS-TTL-PCT          PIC X(01)       VALUE SPACES.        05890000
059000     05  FILLER              PIC X(06)       VALUE SPACES.        05900000
059100                                                                  05910000
059200 01  WS-TOTAL-DASH.                                               05920000
059300     05  FILLER              PIC X(74)       VALUE SPACES.        05930000
059400     05  FILLER              PIC X(12)                            05940000
059500                             VALUE '------------'.                05950000
059600     05  FILLER              PIC X(01)       VALUE SPACES.        05960000
059700     05  FILLER              PIC X(16)                            05970000
059800                             VALUE '----------------'.            05980000
059900     05  FILLER              PIC X(01)       VALUE SPACES.        05990000
060000     05  FILLER              PIC X(16)                            06000000
060100                             VALUE '----------------'.            06010000
060200     05  FILLER              PIC X(01)       VALUE SPACES.        06020000
060300     05  FILLER              PIC X(06)                            06030000
060400                             VALUE '------'.                      06040000
060500     05  FILLER              PIC X(03)       VALUE SPACES.        06050000
060600                                                                  06060000
060700******************************************************************06070000
060800*    SQL COMMUNICATIONS AREA DCLGEN                               06080000
060900******************************************************************06090000
061000     EXEC SQL                                                     06100000
061100         INCLUDE SQLCA                                            06110000
061200     END-EXEC.                                                    06120000
061300******************************************************************06130000
061400*  EXTENSION TO THE SQL COMMUNICATIONS AREA FOR EDITING           06140000
061500*  SQL CODES FOR DISPLAY                                          06150000
061600******************************************************************06160000
061700     COPY SQLCA2.                                                 06170000
061800     EJECT                                                        06180000
061900******************************************************************06190000
062000*  DB2 FORMATTED MESSAGES                                        *06200000
062100******************************************************************06210000
062200     COPY DPWS004.                                                06220000
062300     EJECT                                                        06230000
062400******************************************************************06240000
062500*  COMPANY CONTROL TABLE                                          06250000
062600******************************************************************06260000
062700     EXEC SQL                                                     06270000
062800         INCLUDE TCOCNTL                                          06280000
062900     END-EXEC.                                                    06290000
063000******************************************************************06300000
063100*  MERCHANDISE AREA TABLE                                         06310000
063200******************************************************************06320000
063300     EXEC SQL                                                     06330000
063400         INCLUDE TMDSEAR                                          06340000
063500     END-EXEC.                                                    06350000
063600******************************************************************06360000
063700*  PURCHASE TABLE                                                 06370000
063800******************************************************************06380000
063900     EXEC SQL                                                     06390000
064000         INCLUDE TPURCHS                                          06400000
064100     END-EXEC.                                                    06410000
064200******************************************************************06420000
064300*  CURSOR RETRIEVES ALL CURRENT DEPARTMENTS FOR KOHLS             06430000
064400******************************************************************06440000
064500     EXEC SQL                                                     06450000
064600       DECLARE DEPT_CSR CURSOR FOR                                06460000
064700         SELECT DEPT_NBR                                          06470000
064800                ,GMA_NBR                                          06480000
064900                ,DMA_NBR                                          06490000
065000                ,BYR_NBR                                          06500000
065100           FROM TMDSEAR                                           06510000
065200          WHERE OPERCO_NBR = '03'                                 06520000
065300            AND MDSELV_CDE = 'DPT'                                06530000
065400            AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE         06540000
065500     END-EXEC.                                                    06550000
065600                                                                  06560000
065700 PROCEDURE DIVISION.                                              06570000
065800 0000-OPEN-FILES.                                                 06580000
065810*                                                                 06581005
065820     DISPLAY ' '.                                                 06582005
065830     DISPLAY 'RCKRP018-START'.                                    06583005
065831     DISPLAY ' '.                                                 06583105
065840*                                                                 06584005
065900     OPEN INPUT  STORE-EXTRACT                                    06590000
066000                 CC-RUN-TYPE                                      06600000
066100          OUTPUT BUYERS-RECEIPTS                                  06610000
066200                 WEEKLY-RECEIPTS-FILE.                            06620000
066300                                                                  06630000
066400     ACCEPT WS-DATE       FROM  DATE.                             06640000
066500     MOVE WS-DATE-MM  TO  DP132O-RUN-MONTH.                       06650000
066600     MOVE WS-DATE-DD  TO  DP132O-RUN-DAY.                         06660000
066700     MOVE WS-DATE-YY  TO  DP132O-RUN-YEAR.                        06670000
066800     ACCEPT WS-TIME       FROM  TIME.                             06680000
066900     MOVE WS-TIME-HH  TO  DP132O-RUN-HOUR.                        06690000
067000     MOVE WS-TIME-MM  TO  DP132O-RUN-MINUTE.                      06700000
067100     MOVE 'RCKRP018'  TO DP132O-PROGRAM-NAME.                     06710000
067200     MOVE 1           TO DP132O-REPORT-NUMBER.                    06720000
067300                                                                  06730000
067400     PERFORM 0005-READ-TCOCNTL THRU 0005-EXIT.                    06740000
067430                                                                  06743005
067500     MOVE COCNTL-BTCH-PRC-DTE                                     06750000
067600                      TO  WS-HOLD-TCOCNTL-DATE.                   06760000
067700     MOVE WS-HOLD-TCOCNTL-CC                                      06770000
067800                      TO  WS-DATE-CCYYMMDD-CC.                    06780000
067900     MOVE WS-HOLD-TCOCNTL-YY                                      06790000
068000                      TO  WS-DATE-CCYYMMDD-YY.                    06800000
068100     MOVE WS-HOLD-TCOCNTL-MM                                      06810000
068200                      TO  WS-DATE-CCYYMMDD-MM.                    06820000
068300     MOVE WS-HOLD-TCOCNTL-DD                                      06830000
068400                      TO  WS-DATE-CCYYMMDD-DD.                    06840000
068410*                                                                 06841005
068420     DISPLAY 'BATCH PROCESS DATE: ' COCNTL-BTCH-PRC-DTE.          06842011
068430     DISPLAY 'WS-DATE-CCYYMMDD:   ' WS-DATE-CCYYMMDD.             06843011
068440*                                                                 06844005
068500                                                                  06850000
068600     PERFORM 0010-READ-CONTROL-FILE THRU 0010-EXIT.               06860000
068610*                                                                 06861005
068620     DISPLAY 'CONTROL FILE:       ' WS-RUN-TYPE-RECORD.           06862011
068640*                                                                 06864005
068700     IF MONTHLY-RUN                                               06870000
068800         NEXT SENTENCE                                            06880000
068900     ELSE                                                         06890000
069000        PERFORM 0020-LOAD-ALL-DEPTS THRU 0020-LOAD-ALL-DEPT-EXIT. 06900000
069100                                                                  06910000
069200     PERFORM UNTIL PS-EOF                                         06920000
069300         PERFORM 0200-READ-STORE-EXTRACT THRU 0200-EXIT           06930000
069400         IF PS-EOF                                                06940000
069500             CONTINUE                                             06950000
069600         ELSE                                                     06960000
069700             PERFORM 0300-PROCESS-DATA THRU 0300-EXIT             06970000
069800         END-IF                                                   06980000
069900     END-PERFORM.                                                 06990000
070000                                                                  07000000
070100     PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT.                 07010000
070200     PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT.                07020000
070300     PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT.               07030000
070400     PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT.               07040000
070500     PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT.                   07050000
070600     PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT.                    07060000
070700     PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT.                    07070000
070800     PERFORM 0460-PRT-GMM-LINE THRU 0460-EXIT.                    07080000
070900     PERFORM 0470-PRT-FINAL-LINE THRU 0470-EXIT.                  07090000
071000                                                                  07100000
071100     SET IDX-DT TO +1.                                            07110000
071200     IF MONTHLY-RUN                                               07120000
071300         NEXT SENTENCE                                            07130000
071400     ELSE                                                         07140000
071500         PERFORM 1200-DEPTS-W-NO-RCPTS THRU                       07150000
071600             1200-EXIT-DEPTS-W-NO-RCPTS                           07160000
071700             PV-MAX-DEPT-TBL-RECS TIMES.                          07170000
071800                                                                  07180000
071900     CLOSE STORE-EXTRACT                                          07190000
072000           CC-RUN-TYPE                                            07200000
072100           BUYERS-RECEIPTS                                        07210000
072200           WEEKLY-RECEIPTS-FILE.                                  07220000
072210*                                                                 07221005
072211     DISPLAY ' '.                                                 07221105
072212     MOVE PV-SE-STR-EXT-COUNT   TO  PV-DISP-COUNT.                07221211
072213     DISPLAY 'SE READ COUNT:      ' PV-DISP-COUNT.                07221311
072214     MOVE PV-WKLY-RCPT-CNT      TO  PV-DISP-COUNT.                07221411
072215     DISPLAY 'WKLY RCPT OUT CNT:  ' PV-DISP-COUNT.                07221511
072216     MOVE PV-DEPT-NO-RCPT-CNT   TO  PV-DISP-COUNT.                07221611
072217     DISPLAY 'DEPT NO RCPT CNT:   ' PV-DISP-COUNT.                07221711
072218     MOVE PV-RPT-DTL-LINE-CNT   TO  PV-DISP-COUNT.                07221816
072219     DISPLAY 'RPT DTL LINE CNT:   ' PV-DISP-COUNT.                07221916
072220     DISPLAY ' '.                                                 07222016
072230     DISPLAY 'RCKRP018-END  '.                                    07223005
072231     DISPLAY ' '.                                                 07223105
072240*                                                                 07224005
072300     GOBACK.                                                      07230000
072400                                                                  07240000
072500 0005-READ-TCOCNTL.                                               07250000
072600                                                                  07260000
072700     EXEC SQL                                                     07270000
072800         SELECT                                                   07280000
072900                BTCH_PRC_DTE - 5 DAYS                             07290002
073000         INTO  :COCNTL-BTCH-PRC-DTE                               07300000
073100         FROM TCOCNTL                                             07310000
073200         WHERE OPER_UNT_ID = 90                                   07320000
073300     END-EXEC.                                                    07330000
073400                                                                  07340000
073500     EVALUATE TRUE                                                07350000
073600         WHEN SQLCODE = +0                                        07360000
073700         WHEN SQLCODE = -811                                      07370000
073800             CONTINUE                                             07380000
073900         WHEN OTHER                                               07390000
074000             DISPLAY 'PGM RCKRP018 ABENDED - READ TCOCNTL '       07400000
074100             MOVE '0005-READ-TCOCNTL' TO PV-PARAGRAPH-NAME        07410000
074200             MOVE 'SELECT       '      TO PV-DB2-OPERATION        07420000
074300             PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT      07430000
074400     END-EVALUATE.                                                07440000
074500 0005-EXIT. EXIT.                                                 07450000
074600                                                                  07460000
074700 0010-READ-CONTROL-FILE.                                          07470000
074800     MOVE '0010-READ-CONTROL-FILE'     TO PV-PARAGRAPH-NAME.      07480000
074900                                                                  07490000
075000     READ CC-RUN-TYPE           INTO WS-RUN-TYPE-RECORD           07500000
075100         AT END                                                   07510000
075200             DISPLAY 'RCKRP018  - CONTROL FILE EMPTY'             07520000
075300     END-READ.                                                    07530000
075400 0010-EXIT. EXIT.                                                 07540000
075500                                                                  07550000
075600***************************************************************   07560000
075700 0020-LOAD-ALL-DEPTS.                                             07570000
075800***************************************************************   07580000
075900     MOVE HIGH-VALUES           TO DT-DEPT-TABLE                  07590000
076000     SET NOT-END-OF-DEPT-CSR TO TRUE                              07600000
076100     MOVE +0                    TO PV-RETRY-CNT                   07610000
076200     PERFORM 0030-OPEN-DEPT-CSR  THRU 0030-OPEN-DEPT-CSR-EXIT.    07620000
076300                                                                  07630000
076400     PERFORM                                                      07640000
076500       UNTIL END-OF-DEPT-CSR OR                                   07650000
076600             PV-RETRY-CNT > PC-MAX-RETRIES                        07660000
076700         PERFORM 0040-FETCH-DEPT-CSR THRU 0040-FETCH-DEPT-CSR-EXIT07670000
076800         IF  DEPT-FOUND                                           07680000
076900             IF  PV-NBR-DEPT-TBL-RECS > PV-MAX-DEPT-TBL-RECS      07690000
077000                 DISPLAY '*** ABEND *** IN RCKRP018'              07700000
077100                 DISPLAY 'INTERNAL DEPT TABLE OVERFLOW - EXPAND'  07710000
077200                 MOVE +4003 TO ABEND-CODE                         07720000
077300                 CALL 'ILBOABN0' USING ABEND-CODE                 07730000
077400             ELSE                                                 07740000
077500                 MOVE MDSEAR-DEPT-NBR    TO PV-DEPT-NBR-X         07750000
077600                 MOVE PV-DEPT-NBR-9      TO PV-DEPT-NBR-B         07760000
077700                 SET IDX-DT              TO PV-DEPT-NBR-B         07770000
077800                 MOVE MDSEAR-DEPT-NBR    TO DT-DEPT-NBR (IDX-DT)  07780000
077900                 MOVE MDSEAR-GMA-NBR     TO DT-GMA-NBR  (IDX-DT)  07790000
078000                 MOVE MDSEAR-DMA-NBR     TO DT-DMA-NBR  (IDX-DT)  07800000
078100                 MOVE MDSEAR-BYR-NBR     TO DT-BYR-NBR  (IDX-DT)  07810000
078200             END-IF                                               07820000
078300         END-IF                                                   07830000
078400     END-PERFORM.                                                 07840000
078500*                                                                 07850005
078501     SET PV-DISP-TABLE-IDX        TO IDX-DT.                      07850111
078502     MOVE PV-DISP-TABLE-IDX       TO PV-DISP-IDX.                 07850211
078504     DISPLAY 'DEPT COUNT:         '  PV-DISP-IDX                  07850411
078510                                                                  07851005
078520*                                                                 07852005
078600     PERFORM 0050-CLOSE-DEPT-CSR THRU 0050-CLOSE-DEPT-CSR-EXIT.   07860000
078700                                                                  07870000
078800 0020-LOAD-ALL-DEPT-EXIT. EXIT.                                   07880000
078900                                                                  07890000
079000***************************************************************   07900000
079100 0030-OPEN-DEPT-CSR.                                              07910000
079200******************************************************************07920000
079300     MOVE ZERO TO PV-RETRY-CNT                                    07930000
079400     PERFORM                                                      07940000
079500         WITH TEST AFTER                                          07950000
079600         UNTIL PV-RETRY-CNT > PC-MAX-RETRIES                      07960000
079700            OR SQLCODE = ZERO                                     07970000
079800                                                                  07980000
079900         EXEC SQL                                                 07990000
080000             OPEN DEPT_CSR                                        08000000
080100         END-EXEC                                                 08010000
080200                                                                  08020000
080300         EVALUATE SQLCODE                                         08030000
080400             WHEN -913                                            08040000
080500             WHEN -911                                            08050000
080600             WHEN -904                                            08060000
080700             WHEN +0                                              08070000
080800               CONTINUE                                           08080000
080900             WHEN OTHER                                           08090000
081000               DISPLAY 'PGM RCKRP018 ABENDED - OPEN DEPT CSR'     08100000
081100               MOVE '0030-OPEN-DEPT' TO PV-PARAGRAPH-NAME         08110000
081200               MOVE 'OPEN DEPT_CSR'      TO PV-DB2-OPERATION      08120000
081300               PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT    08130000
081400         END-EVALUATE                                             08140000
081500         COMPUTE PV-RETRY-CNT = PV-RETRY-CNT + 1                  08150000
081600     END-PERFORM.                                                 08160000
081700                                                                  08170000
081800     IF  PV-RETRY-CNT > PC-MAX-RETRIES                            08180000
081900         DISPLAY 'PGM RCKRP018 ABENDED - OPEN SCL CURSOR'         08190000
082000         DISPLAY '0030-OPEN-DEPT-CSR'                             08200000
082100         DISPLAY 'MAX RETRIES EXCEEDED FOR OPEN SCL CURSOR'       08210000
082200         DISPLAY 'SQL RETURN CODE IS ' SQLCODE                    08220000
082300         MOVE 'OPEN DEPT_CSR ' TO PV-DB2-OPERATION                08230000
082400         PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT          08240000
082500     END-IF.                                                      08250000
082600                                                                  08260000
082700 0030-OPEN-DEPT-CSR-EXIT. EXIT.                                   08270000
082800                                                                  08280000
082900***************************************************************   08290000
083000 0040-FETCH-DEPT-CSR.                                             08300000
083100***************************************************************   08310000
083200     SET DEPT-NOT-FOUND TO TRUE.                                  08320000
083300     PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                     08330000
083400       UNTIL PV-RETRY-CNT > PC-MAX-RETRIES OR                     08340000
083500             DEPT-FOUND                                           08350000
083600                                                                  08360000
083700       EXEC SQL                                                   08370000
083800            FETCH DEPT_CSR                                        08380000
083900             INTO :MDSEAR-DEPT-NBR                                08390000
084000                 ,:MDSEAR-GMA-NBR                                 08400000
084100                 ,:MDSEAR-DMA-NBR                                 08410000
084200                 ,:MDSEAR-BYR-NBR                                 08420000
084300       END-EXEC                                                   08430000
084400                                                                  08440000
084500*      SET DEPT-NOT-FOUND TO TRUE.                                08450000
084600                                                                  08460000
084700       EVALUATE SQLCODE                                           08470000
084800           WHEN -913                                              08480000
084900           WHEN -911                                              08490000
085000           WHEN -904                                              08500000
085100               ADD +1 TO PV-RETRY-CNT                             08510000
085200           WHEN +0                                                08520000
085300               SET DEPT-FOUND TO TRUE                             08530000
085400           WHEN +100                                              08540000
085500               MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT        08550000
085600               SET END-OF-DEPT-CSR TO TRUE                        08560000
085700           WHEN OTHER                                             08570000
085800               MOVE '0040-FETCH-DEPT-CSR' TO                      08580000
085900                   PV-PARAGRAPH-NAME                              08590000
086000               MOVE 'FETCH VSM CURSOR' TO                         08600000
086100                   PV-DB2-OPERATION                               08610000
086200               PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT    08620000
086300       END-EVALUATE                                               08630000
086400     END-PERFORM.                                                 08640000
086500                                                                  08650000
086600     IF (SQLWARN0 NOT = SPACES                                    08660000
086700       OR (SQLCODE > 0 AND SQLCODE NOT = +100)                    08670000
086800       OR SQLCODE < 0)                                            08680000
086900         MOVE '0040-FETCH-DEPT-CSR' TO                            08690000
087000             PV-PARAGRAPH-NAME                                    08700000
087100         MOVE 'MAX RETRIES EXCEEDED' TO                           08710000
087200                   PV-DB2-OPERATION                               08720000
087300         PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT          08730000
087400     END-IF.                                                      08740000
087500 0040-FETCH-DEPT-CSR-EXIT. EXIT.                                  08750000
087600                                                                  08760000
087700******************************************************************08770000
087800 0050-CLOSE-DEPT-CSR.                                             08780000
087900******************************************************************08790000
088000     EXEC SQL                                                     08800000
088100        CLOSE DEPT_CSR                                            08810000
088200     END-EXEC.                                                    08820000
088300                                                                  08830000
088400     EVALUATE SQLCODE                                             08840000
088500         WHEN +0                                                  08850000
088600             CONTINUE                                             08860000
088700         WHEN OTHER                                               08870000
088800             MOVE '0050-CLOSE-DEPT-CSR' TO                        08880000
088900                 PV-PARAGRAPH-NAME                                08890000
089000             MOVE 'CLOSE DEPT_CSR' TO                             08900000
089100                 PV-DB2-OPERATION                                 08910000
089200             PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT      08920000
089300     END-EVALUATE.                                                08930000
089400                                                                  08940000
089500 0050-CLOSE-DEPT-CSR-EXIT. EXIT.                                  08950000
089600                                                                  08960000
089700 0200-READ-STORE-EXTRACT.                                         08970000
089800     READ STORE-EXTRACT INTO RC043-EXP-STORE-EXTRACT-RECORD       08980000
089900         AT END                                                   08990000
090000             SET PS-EOF TO TRUE                                   09000005
090010         NOT AT END                                               09001005
090020             ADD 1      TO PV-SE-STR-EXT-COUNT.                   09002005
090100                                                                  09010000
090200     IF PS-EOF                                                    09020000
090300         CONTINUE                                                 09030000
090400     ELSE                                                         09040000
090500         MOVE RC043-DATE-VERIFIED-COUNT TO WS-DATE-VERIFIED-COUNT 09050000
090600         MOVE WS-DATE-VFYD-COUNT-MM      TO WS-COMPARE-DATE-MM    09060000
090700         MOVE WS-DATE-VFYD-COUNT-DD      TO WS-COMPARE-DATE-DD    09070000
090800         MOVE WS-DATE-VFYD-COUNT-YY      TO WS-COMPARE-DATE-YY    09080000
090900                                                                  09090000
091000         IF WS-COMPARE-DATE-YY > 80                               09100000
091100             MOVE '19'                   TO WS-COMPARE-DATE-CC    09110000
091200         ELSE                                                     09120000
091300             MOVE '20'                   TO WS-COMPARE-DATE-CC    09130000
091400         END-IF                                                   09140000
091500                                                                  09150000
091600         IF WS-COMPARE-DATE > WS-WK-END-DATE                      09160000
091700             MOVE WS-COMPARE-DATE        TO WS-WK-END-DATE        09170000
091800         END-IF                                                   09180000
091900     END-IF.                                                      09190000
092000 0200-EXIT. EXIT.                                                 09200000
092100                                                                  09210000
092200 0300-PROCESS-DATA.                                               09220000
092300                                                                  09230000
092400     IF WEEKLY-RUN AND RC043-MTD-CDE = 'M'                        09240000
092500         GO TO 0300-EXIT.                                         09250000
092600                                                                  09260000
092700     IF FIRST-TIME                                                09270000
092800         PERFORM 1050-DATE-CALCULATION THRU                       09280000
092900                 1050-EXIT                                        09290000
093000         IF WEEKLY-RUN                                            09300000
093100             MOVE WS-1ST-DAY-OF-WEEK-MM     TO WS-HDR3-MM         09310000
093200             MOVE WS-1ST-DAY-OF-WEEK-DD     TO WS-HDR3-DD         09320000
093300             MOVE WS-1ST-DAY-OF-WEEK-CC     TO WS-HDR3-CC         09330000
093400             MOVE WS-1ST-DAY-OF-WEEK-YY     TO WS-HDR3-YY         09340000
093500             MOVE 'MPK11035'                TO WS-HDR3-WEEKJOB    09350000
093600             MOVE WS-HDR3-WEEK              TO WS-HDR3            09360000
093700             MOVE 1                       TO DP132O-REPORT-NUMBER 09370000
093800         ELSE                                                     09380000
093900         IF MONTHLY-RUN                                           09390000
094000             MOVE WS-MONTH                  TO WS-HDR3-MONTH-ABBR 09400000
094100             MOVE WS-1ST-DAY-OF-WEEK-CC     TO WS-HDR3-MONTH-CC   09410000
094200             MOVE WS-1ST-DAY-OF-WEEK-YY     TO WS-HDR3-MONTH-YY   09420000
094300             MOVE 'MPK51005'                TO WS-HDR3-MNTHJOB    09430000
094400             MOVE WS-HDR3-MONTH             TO WS-HDR3            09440000
094500             MOVE 2                       TO DP132O-REPORT-NUMBER 09450000
094600         ELSE                                                     09460000
094700             MOVE '???????????????????'     TO WS-HDR3.           09470000
094800                                                                  09480000
094900     IF FIRST-TIME                                                09490000
095000         MOVE SPACE TO WS-FIRST-TIME-IND                          09500000
095100         MOVE RC043-GMM-NBR             TO WS-HOLD-GM             09510000
095200         MOVE RC043-GMM-NBR             TO WS-HDR4-GMM-NO         09520000
095300         MOVE RC043-GMM-NAME            TO WS-HDR4-GMM-NAME       09530000
095400         MOVE RC043-DMM-NBR             TO WS-HOLD-DM             09540000
095500         MOVE RC043-DMM-NBR             TO WS-HDR5-DMM-NO         09550000
095600         MOVE RC043-DMM-NAME            TO WS-HDR5-DMM-NAME       09560000
095700         MOVE RC043-BYR-NBR             TO WS-HOLD-BYR            09570000
095800         MOVE RC043-BYR-NBR             TO WS-HDR6-BYR-NO         09580000
095900         MOVE RC043-BYR-NAME            TO WS-HDR6-BYR-NAME       09590000
096000         MOVE RC043-DEPT                TO WS-HOLD-DEPT           09600000
096100         MOVE RC043-DEPT                TO WS-HDR7-DEPARTMENT     09610000
096200         MOVE RC043-DEPT-NAME           TO WS-HDR7-DEPT-NAME      09620000
096300         MOVE RC043-CLASS               TO WS-HOLD-CLASS          09630000
096400         MOVE RC043-SUB-CL-DESC         TO WS-HOLD-CLASS-NAME     09640000
096500         MOVE RC043-MAJ-CL-NBR          TO WS-HOLD-MAJ-CLASS      09650000
096600         MOVE RC043-MAJ-CL-DESC         TO WS-HOLD-MAJ-CLASS-NAME 09660000
096700         MOVE RC043-PO                  TO WS-HOLD-PO             09670000
096800         MOVE RC043-REC-SEQ-NBR         TO WS-HOLD-REC-SEQ-NBR    09680000
096900         MOVE RC043-REC-SRC-CDE         TO WS-HOLD-REC-SRC-CDE    09690000
097000         MOVE RC043-DEFERRED            TO WS-HOLD-DEF            09700000
097100         MOVE RC043-ADJ-CYC-NBR         TO WS-HOLD-ADJ-CYC-NBR    09710000
097200         MOVE RC043-VENDOR-NAME-INHOUSE TO WS-HOLD-VENDOR-NAME    09720000
097300         MOVE RC043-LOC-NBR             TO WS-HOLD-STORE          09730000
097400         MOVE RC043-OPER-UNT-ID         TO WS-HOLD-OPER-UNT-ID    09740000
097500         MOVE RC043-DATE-RECEIVED       TO WS-HOLD-RECEIPT-DATE   09750000
097600         MOVE RC043-DATE-VERIFIED-COUNT TO WS-HOLD-VERIFY-DATE    09760000
097700         MOVE RC043-PRCS-DAYS           TO WS-HOLD-PRCS-DAYS      09770000
097800             IF RC043-RECEIVING-LOCATION = 'DS'                   09780000
097900                  MOVE WS-HOLD-STORE      TO WS-HOLD-OPER-UNT-ID  09790000
098000             END-IF                                               09800000
098100     END-IF.                                                      09810000
098200                                                                  09820000
098300     IF RC043-GMM-NBR NOT = WS-HOLD-GM                            09830000
098400         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09840000
098500         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09850000
098600         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09860000
098700         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            09870000
098800         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                09880000
098900         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 09890000
099000         PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT                 09900000
099100         MOVE 'Y'              TO PS-GMM-BREAK-SW                 09910000
099200         PERFORM 0460-PRT-GMM-LINE THRU 0460-EXIT                 09920000
099300         MOVE 'N'              TO PS-GMM-BREAK-SW                 09930000
099400     END-IF.                                                      09940000
099500                                                                  09950000
099600     IF RC043-DMM-NBR NOT = WS-HOLD-DM                            09960000
099700         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              09970000
099800         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             09980000
099900         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            09990000
100000         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            10000000
100100         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                10010000
100200         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 10020000
100300         MOVE 'Y'              TO PS-DMM-BREAK-SW                 10030000
100400         PERFORM 0450-PRT-DMM-LINE THRU 0450-EXIT                 10040000
100500         MOVE 'N'              TO PS-DMM-BREAK-SW                 10050000
100600     END-IF.                                                      10060000
100700                                                                  10070000
100800     IF RC043-BYR-NBR NOT = WS-HOLD-BYR                           10080000
100900         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10090000
101000         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             10100000
101100         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            10110000
101200         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            10120000
101300         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                10130000
101400         MOVE 'Y'              TO PS-BYR-BREAK-SW                 10140000
101500         PERFORM 0440-PRT-BYR-LINE THRU 0440-EXIT                 10150000
101600         MOVE 'N'              TO PS-BYR-BREAK-SW                 10160000
101700     END-IF.                                                      10170000
101800                                                                  10180000
101900     IF RC043-DEPT NOT = WS-HOLD-DEPT                             10190000
102000         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10200000
102100         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             10210000
102200         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            10220000
102300         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            10230000
102400         MOVE 'Y'              TO PS-DEPT-BREAK-SW                10240000
102500         PERFORM 0430-PRT-DEPT-LINE THRU 0430-EXIT                10250000
102600         MOVE 'N'              TO PS-DEPT-BREAK-SW                10260000
102700     END-IF.                                                      10270000
102800                                                                  10280000
102900     IF RC043-MAJ-CL-NBR NOT = WS-HOLD-MAJ-CLASS                  10290000
103000         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10300000
103100         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             10310000
103200         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            10320000
103300         PERFORM 0425-PRT-MAJTOTAL-LINE THRU 0425-EXIT            10330000
103400     END-IF.                                                      10340000
103500                                                                  10350000
103600     IF RC043-CLASS NOT = WS-HOLD-CLASS                           10360000
103700         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10370000
103800         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             10380000
103900         PERFORM 0420-PRT-CLSTOTAL-LINE THRU 0420-EXIT            10390000
104000     END-IF.                                                      10400000
104100                                                                  10410000
104200     IF RC043-PO = WS-HOLD-PO AND                                 10420000
104300        RC043-REC-SEQ-NBR = WS-HOLD-REC-SEQ-NBR AND               10430000
104400        RC043-REC-SRC-CDE = WS-HOLD-REC-SRC-CDE AND               10440000
104500        RC043-ADJ-CYC-NBR = WS-HOLD-ADJ-CYC-NBR                   10450000
104600         NEXT SENTENCE                                            10460000
104700     ELSE                                                         10470000
104800     IF RC043-PO = WS-HOLD-PO                                     10480000
104900         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10490000
105000     ELSE                                                         10500000
105100         PERFORM 0400-PRT-DETAIL-LINE THRU 0400-EXIT              10510000
105200         PERFORM 0410-PRT-POTOTAL-LINE THRU 0410-EXIT             10520000
105300     END-IF.                                                      10530000
105400     IF RC043-PO NOT    = WS-PO-BEING-PROCESSED                   10540000
105500         MOVE RC043-PO TO WS-PO-BEING-PROCESSED                   10550000
105600                          PV-PO-NBR                               10560000
105700         PERFORM 5000-GET-PO-INFO THRU 5000-EXIT                  10570000
105800     END-IF.                                                      10580000
105900     PERFORM 1300-COST-SELECT THRU 1300-EXIT.                     10590000
106000     PERFORM 0350-SAVE-TOTALS THRU 0350-EXIT.                     10600000
106100 0300-EXIT. EXIT.                                                 10610000
106200*                                                                 10620000
106300 1300-COST-SELECT.                                                10630000
106400     IF  RC043-PO-TYP-CDE  = ('IM' OR 'IE' OR 'IF')               10640004
106500     OR  PURCHS-DERVD-LBL-TYP-CDE = ('P' OR 'E')                  10650017
106600         MOVE RC043-COST-EXTENSION     TO WS-COST-EXTENSION       10660004
106700     ELSE                                                         10670000
106800         MOVE RC043-1ST-COST-EXTENSION TO WS-COST-EXTENSION       10680004
106900     END-IF.                                                      10690000
107000 1300-EXIT. EXIT.                                                 10700000
107100*                                                                 10710000
107200 0350-SAVE-TOTALS.                                                10720000
107300     COMPUTE WS-TOTAL-POSEQ-UNITS =                               10730000
107400         WS-TOTAL-POSEQ-UNITS  + RC043-RETAIL-UNITS-MARK.         10740000
107500     COMPUTE WS-TOTAL-POSEQ-COST  =                               10750000
107600*        WS-TOTAL-POSEQ-COST   + RC043-COST-EXTENSION.            10760000
107700         WS-TOTAL-POSEQ-COST   + WS-COST-EXTENSION.               10770000
107800     COMPUTE WS-TOTAL-POSEQ-RETAIL  =                             10780000
107900         WS-TOTAL-POSEQ-RETAIL  + RC043-RETAIL-EXTENSION.         10790000
108000                                                                  10800000
108100     COMPUTE WS-TOTAL-PO-UNITS =                                  10810000
108200         WS-TOTAL-PO-UNITS  + RC043-RETAIL-UNITS-MARK.            10820000
108300     COMPUTE WS-TOTAL-PO-COST  =                                  10830000
108400*        WS-TOTAL-PO-COST   + RC043-COST-EXTENSION.               10840000
108500         WS-TOTAL-PO-COST   + WS-COST-EXTENSION.                  10850000
108600     COMPUTE WS-TOTAL-PO-RETAIL  =                                10860000
108700         WS-TOTAL-PO-RETAIL  + RC043-RETAIL-EXTENSION.            10870000
108800                                                                  10880000
108900     COMPUTE WS-TOTAL-CLASS-UNITS =                               10890000
109000         WS-TOTAL-CLASS-UNITS  + RC043-RETAIL-UNITS-MARK.         10900000
109100     COMPUTE WS-TOTAL-CLASS-COST  =                               10910000
109200*        WS-TOTAL-CLASS-COST   + RC043-COST-EXTENSION.            10920000
109300         WS-TOTAL-CLASS-COST   + WS-COST-EXTENSION.               10930000
109400     COMPUTE WS-TOTAL-CLASS-RETAIL  =                             10940000
109500         WS-TOTAL-CLASS-RETAIL  + RC043-RETAIL-EXTENSION.         10950000
109600                                                                  10960000
109700     COMPUTE WS-TOTAL-MAJ-CLASS-UNITS =                           10970000
109800         WS-TOTAL-MAJ-CLASS-UNITS  + RC043-RETAIL-UNITS-MARK.     10980000
109900     COMPUTE WS-TOTAL-MAJ-CLASS-COST  =                           10990000
110000*        WS-TOTAL-MAJ-CLASS-COST   + RC043-COST-EXTENSION.        11000000
110100         WS-TOTAL-MAJ-CLASS-COST   + WS-COST-EXTENSION.           11010000
110200     COMPUTE WS-TOTAL-MAJ-CLASS-RETAIL  =                         11020000
110300         WS-TOTAL-MAJ-CLASS-RETAIL  + RC043-RETAIL-EXTENSION.     11030000
110400                                                                  11040000
110500     COMPUTE WS-TOTAL-DEPT-UNITS =                                11050000
110600         WS-TOTAL-DEPT-UNITS  + RC043-RETAIL-UNITS-MARK.          11060000
110700     COMPUTE WS-TOTAL-DEPT-COST  =                                11070000
110800*        WS-TOTAL-DEPT-COST   + RC043-COST-EXTENSION.             11080000
110900         WS-TOTAL-DEPT-COST   + WS-COST-EXTENSION.                11090000
111000     COMPUTE WS-TOTAL-DEPT-RETAIL  =                              11100000
111100         WS-TOTAL-DEPT-RETAIL  + RC043-RETAIL-EXTENSION.          11110000
111200                                                                  11120000
111300     COMPUTE WS-TOTAL-BYR-UNITS =                                 11130000
111400         WS-TOTAL-BYR-UNITS  + RC043-RETAIL-UNITS-MARK.           11140000
111500     COMPUTE WS-TOTAL-BYR-COST  =                                 11150000
111600*        WS-TOTAL-BYR-COST   + RC043-COST-EXTENSION.              11160000
111700         WS-TOTAL-BYR-COST   + WS-COST-EXTENSION.                 11170000
111800     COMPUTE WS-TOTAL-BYR-RETAIL  =                               11180000
111900         WS-TOTAL-BYR-RETAIL  + RC043-RETAIL-EXTENSION.           11190000
112000                                                                  11200000
112100     COMPUTE WS-TOTAL-DMM-UNITS =                                 11210000
112200         WS-TOTAL-DMM-UNITS  + RC043-RETAIL-UNITS-MARK.           11220000
112300     COMPUTE WS-TOTAL-DMM-COST  =                                 11230000
112400*        WS-TOTAL-DMM-COST   + RC043-COST-EXTENSION.              11240000
112500         WS-TOTAL-DMM-COST   + WS-COST-EXTENSION.                 11250000
112600     COMPUTE WS-TOTAL-DMM-RETAIL  =                               11260000
112700         WS-TOTAL-DMM-RETAIL  + RC043-RETAIL-EXTENSION.           11270000
112800                                                                  11280000
112900     COMPUTE WS-TOTAL-GMM-UNITS =                                 11290000
113000         WS-TOTAL-GMM-UNITS  + RC043-RETAIL-UNITS-MARK.           11300000
113100     COMPUTE WS-TOTAL-GMM-COST  =                                 11310000
113200*        WS-TOTAL-GMM-COST   + RC043-COST-EXTENSION.              11320000
113300         WS-TOTAL-GMM-COST   + WS-COST-EXTENSION.                 11330000
113400     COMPUTE WS-TOTAL-GMM-RETAIL  =                               11340000
113500         WS-TOTAL-GMM-RETAIL  + RC043-RETAIL-EXTENSION.           11350000
113600                                                                  11360000
113700     COMPUTE WS-TOTAL-RPT-UNITS  =                                11370000
113800         WS-TOTAL-RPT-UNITS  + RC043-RETAIL-UNITS-MARK.           11380000
113900     COMPUTE WS-TOTAL-RPT-COST   =                                11390000
114000*        WS-TOTAL-RPT-COST   + RC043-COST-EXTENSION.              11400000
114100         WS-TOTAL-RPT-COST   + WS-COST-EXTENSION.                 11410000
114200     COMPUTE WS-TOTAL-RPT-RETAIL =                                11420000
114300         WS-TOTAL-RPT-RETAIL + RC043-RETAIL-EXTENSION.            11430000
114400 0350-EXIT. EXIT.                                                 11440000
114500                                                                  11450000
114600 0400-PRT-DETAIL-LINE.                                            11460000
114700     ADD 1                           TO WS-CNT-DTL.               11470000
114800     IF WS-CNT-DTL = 1                                            11480000
114900         MOVE 2                      TO WS-CC                     11490000
115000         MOVE WS-HOLD-VENDOR-NAME    TO WS-DTL-VENDOR-NAME        11500000
115100         MOVE WS-HOLD-CLASS          TO WS-DTL-CLASS              11510000
115200         ELSE                                                     11520000
115300             MOVE 1                  TO WS-CC                     11530000
115400     END-IF.                                                      11540000
115500     MOVE WS-HOLD-PO                 TO WS-DTL-PO-NUMBER.         11550000
115600     MOVE '-'                        TO WS-DASH1.                 11560000
115700                                                                  11570000
115800     MOVE WS-HOLD-REC-SEQ-NBR        TO PV-HOLD-REC-SEQ-NBR-1-3.  11580000
115900     IF PV-HOLD-REC-SEQ-NBR-1 = '0' AND                           11590000
116000        PV-HOLD-REC-SEQ-NBR-2 = '0'                               11600000
116100         MOVE PV-HOLD-REC-SEQ-NBR-3  TO WS-DTL-REC-SEQ            11610000
116200     ELSE                                                         11620000
116300     IF PV-HOLD-REC-SEQ-NBR-1 = '0'                               11630000
116400        STRING PV-HOLD-REC-SEQ-NBR-2 PV-HOLD-REC-SEQ-NBR-3        11640000
116500            DELIMITED BY SIZE INTO WS-DTL-REC-SEQ                 11650000
116600     ELSE                                                         11660000
116700        MOVE PV-HOLD-REC-SEQ-NBR-1-3 TO WS-DTL-REC-SEQ.           11670000
116800                                                                  11680000
116900     IF WS-HOLD-REC-SRC-CDE  = 'A' AND WS-HOLD-DEF = 'DEF'        11690000
117000         MOVE 'A/D'                  TO WS-DTL-DEF                11700000
117100     ELSE                                                         11710000
117200     IF WS-HOLD-REC-SRC-CDE  = 'A'                                11720000
117300         MOVE 'ADJ'                  TO WS-DTL-DEF                11730000
117400     ELSE                                                         11740000
117500     IF WS-HOLD-DEF          = 'DEF'                              11750000
117600         MOVE 'DEF'                  TO WS-DTL-DEF                11760000
117700     ELSE                                                         11770000
117800         MOVE '   '                  TO WS-DTL-DEF.               11780000
117900     MOVE WS-HOLD-OPER-UNT-ID        TO WS-DTL-REC-LOC.           11790000
118000     MOVE WS-HOLD-RECEIPT-DATE       TO WS-DATE-RECEIVED.         11800000
118100     MOVE WS-DATE-RECEIVED-MM        TO WS-DATE-RECEIVED-PRT-MM.  11810000
118200     MOVE WS-DATE-RECEIVED-DD        TO WS-DATE-RECEIVED-PRT-DD.  11820000
118300     MOVE WS-DATE-RECEIVED-YY        TO WS-DATE-RECEIVED-PRT-YY.  11830000
118400     MOVE WS-DATE-RECEIVED-PRT       TO WS-DTL-REC-DATE.          11840000
118500     MOVE WS-HOLD-VERIFY-DATE        TO WS-DATE-VERIFIED-COUNT.   11850000
118600     MOVE WS-DATE-VFYD-COUNT-MM      TO WS-DATE-VERIFIED-PRT-MM.  11860000
118700     MOVE WS-DATE-VFYD-COUNT-DD      TO WS-DATE-VERIFIED-PRT-DD.  11870000
118800     MOVE WS-DATE-VFYD-COUNT-YY      TO WS-DATE-VERIFIED-PRT-YY.  11880000
118900     MOVE WS-DATE-VERIFIED-PRT       TO WS-DTL-VRFD-DATE.         11890000
119000     MOVE WS-HOLD-PRCS-DAYS          TO WS-DTL-PRCS-DAYS.         11900000
119100     MOVE WS-TOTAL-POSEQ-UNITS       TO WS-DTL-UNIT-TOTAL.        11910000
119200     MOVE WS-TOTAL-POSEQ-COST        TO WS-DTL-TOTAL-COST.        11920000
119300     MOVE WS-TOTAL-POSEQ-RETAIL      TO WS-DTL-TOTAL-RETAIL.      11930000
119400     MOVE '%'                        TO WS-PCT1.                  11940000
119500                                                                  11950000
119600     IF WS-TOTAL-POSEQ-RETAIL = 0                                 11960000
119700         MOVE 0                      TO WS-DTL-MKUP               11970000
119800     ELSE                                                         11980000
119900         COMPUTE WS-SAVE-MKUP =                                   11990000
120000          ((WS-TOTAL-POSEQ-RETAIL - WS-TOTAL-POSEQ-COST) /        12000000
120100             WS-TOTAL-POSEQ-RETAIL)  * 100                        12010000
120200         MOVE WS-SAVE-MKUP           TO WS-DTL-MKUP.              12020000
120300                                                                  12030000
120400     IF WS-LINE-CNT > 55                                          12040000
120500         PERFORM 1000-PRINT-HEADINGS THRU                         12050000
120600                 1000-EXIT-PRINT-HEADINGS.                        12060000
120700     WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER WS-CC.        12070000
120710                                                                  12071016
120720     ADD 1     TO PV-RPT-DTL-LINE-CNT.                            12072016
120730                                                                  12073016
120800     ADD WS-CC TO WS-LINE-CNT.                                    12080000
120900     MOVE 1 TO WS-CC.                                             12090000
121000     MOVE SPACES TO WS-DETAIL.                                    12100000
121100     MOVE RC043-PO                   TO WS-HOLD-PO.               12110000
121200     MOVE RC043-REC-SEQ-NBR          TO WS-HOLD-REC-SEQ-NBR.      12120000
121300     MOVE RC043-REC-SRC-CDE          TO WS-HOLD-REC-SRC-CDE.      12130000
121400     MOVE RC043-DEFERRED             TO WS-HOLD-DEF.              12140000
121500     MOVE RC043-ADJ-CYC-NBR          TO WS-HOLD-ADJ-CYC-NBR.      12150000
121600     MOVE RC043-VENDOR-NAME-INHOUSE  TO WS-HOLD-VENDOR-NAME.      12160000
121700     MOVE RC043-LOC-NBR              TO WS-HOLD-STORE.            12170000
121800     MOVE RC043-OPER-UNT-ID          TO WS-HOLD-OPER-UNT-ID.      12180000
121900     MOVE RC043-DATE-RECEIVED        TO WS-HOLD-RECEIPT-DATE.     12190000
122000     MOVE RC043-DATE-VERIFIED-COUNT  TO WS-HOLD-VERIFY-DATE.      12200000
122100     MOVE RC043-PRCS-DAYS            TO WS-HOLD-PRCS-DAYS.        12210000
122200     MOVE +0                         TO WS-TOTAL-POSEQ-UNITS      12220000
122300                                        WS-TOTAL-POSEQ-COST       12230000
122400                                        WS-TOTAL-POSEQ-RETAIL.    12240000
122500     IF RC043-RECEIVING-LOCATION = 'DS'                           12250000
122600             MOVE WS-HOLD-STORE      TO WS-HOLD-OPER-UNT-ID.      12260000
122700 0400-EXIT. EXIT.                                                 12270000
122800                                                                  12280000
122900 0410-PRT-POTOTAL-LINE.                                           12290000
123000     IF WS-CNT-DTL = 1                                            12300000
123100         MOVE 0                      TO WS-CNT-DTL                12310000
123200         MOVE +0                     TO WS-TOTAL-PO-UNITS         12320000
123300                                        WS-TOTAL-PO-COST          12330000
123400                                        WS-TOTAL-PO-RETAIL        12340000
123500         GO TO 0410-EXIT.                                         12350000
123600                                                                  12360000
123700     MOVE '   PO TOTAL:'             TO WS-TTL-LIT-2.             12370000
123800     IF  WS-TOTAL-PO-RETAIL >  999999999.99                       12380000
123900         MOVE  WS-TOTAL-PO-RETAIL    TO WS-TTL-TOTAL-RETAIL-RD    12390000
124000     ELSE                                                         12400000
124100         MOVE  WS-TOTAL-PO-RETAIL    TO WS-TTL-TOTAL-RETAIL       12410000
124200     END-IF.                                                      12420000
124300     IF  WS-TOTAL-PO-COST >  999999999.99                         12430000
124400         MOVE  WS-TOTAL-PO-COST      TO WS-TTL-TOTAL-COST-RD      12440000
124500     ELSE                                                         12450000
124600         MOVE  WS-TOTAL-PO-COST      TO WS-TTL-TOTAL-COST         12460000
124700     END-IF.                                                      12470000
124800     MOVE  WS-TOTAL-PO-UNITS         TO WS-TTL-UNIT-TOTAL.        12480000
124900     MOVE '%'                        TO WS-TTL-PCT.               12490000
125000                                                                  12500000
125100     IF WS-TOTAL-PO-RETAIL  = 0                                   12510000
125200         MOVE 0                      TO WS-TTL-MKUP               12520000
125300     ELSE                                                         12530000
125400         COMPUTE WS-SAVE-MKUP =                                   12540000
125500          ((WS-TOTAL-PO-RETAIL   - WS-TOTAL-PO-COST  ) /          12550000
125600             WS-TOTAL-PO-RETAIL)  * 100                           12560000
125700         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              12570000
125800                                                                  12580000
125900     IF WS-LINE-CNT > 55                                          12590000
126000         PERFORM 1000-PRINT-HEADINGS THRU                         12600000
126100                 1000-EXIT-PRINT-HEADINGS.                        12610000
126200     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       12620000
126300     ADD WS-CC TO WS-LINE-CNT.                                    12630000
126400                                                                  12640000
126500     MOVE 0                          TO WS-CNT-DTL.               12650000
126600     MOVE +0                         TO WS-TOTAL-PO-UNITS         12660000
126700                                        WS-TOTAL-PO-COST          12670000
126800                                        WS-TOTAL-PO-RETAIL.       12680000
126900 0410-EXIT. EXIT.                                                 12690000
127000                                                                  12700000
127100 0420-PRT-CLSTOTAL-LINE.                                          12710000
127200     IF WS-LINE-CNT > 55                                          12720000
127300         PERFORM 1000-PRINT-HEADINGS THRU                         12730000
127400                 1000-EXIT-PRINT-HEADINGS.                        12740000
127500     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-DASH AFTER 1.        12750000
127600     ADD 1     TO WS-LINE-CNT.                                    12760000
127700                                                                  12770000
127800     MOVE 'SUBCLASS - '              TO WS-TTL-LIT-A.             12780000
127900     MOVE WS-HOLD-CLASS              TO WS-TTL-LIT-B.             12790000
128000     MOVE WS-HOLD-CLASS-NAME         TO WS-TTL-LIT-C.             12800000
128100     MOVE '      TOTAL:'             TO WS-TTL-LIT-1.             12810000
128200     IF  WS-TOTAL-CLASS-RETAIL >  999999999.99                    12820000
128300         MOVE  WS-TOTAL-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1-RD   12830000
128400     ELSE                                                         12840000
128500         MOVE  WS-TOTAL-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1      12850000
128600     END-IF.                                                      12860000
128700     IF  WS-TOTAL-CLASS-COST >    999999999.99                    12870000
128800         MOVE  WS-TOTAL-CLASS-COST TO WS-TTL-TOTAL-COST1-RD       12880000
128900     ELSE                                                         12890000
129000         MOVE  WS-TOTAL-CLASS-COST TO WS-TTL-TOTAL-COST1          12900000
129100     END-IF.                                                      12910000
129200     MOVE  WS-TOTAL-CLASS-UNITS      TO WS-TTL-UNIT-TOTAL1.       12920000
129300     MOVE '%'                        TO WS-TTL-PCT1.              12930000
129400                                                                  12940000
129500     IF WS-TOTAL-CLASS-RETAIL = 0                                 12950000
129600         MOVE 0                      TO WS-TTL-MKUP1              12960000
129700     ELSE                                                         12970000
129800         COMPUTE WS-SAVE-MKUP =                                   12980000
129900          ((WS-TOTAL-CLASS-RETAIL   - WS-TOTAL-CLASS-COST  ) /    12990000
130000             WS-TOTAL-CLASS-RETAIL)  * 100                        13000000
130100         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP1.             13010000
130200                                                                  13020000
130300     IF WS-LINE-CNT > 55                                          13030000
130400         PERFORM 1000-PRINT-HEADINGS THRU                         13040000
130500                 1000-EXIT-PRINT-HEADINGS.                        13050000
130600     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE1 AFTER 1.       13060000
130700     ADD WS-CC TO WS-LINE-CNT.                                    13070000
130800                                                                  13080000
130900     MOVE RC043-CLASS                TO WS-HOLD-CLASS.            13090000
131000     MOVE RC043-SUB-CL-DESC          TO WS-HOLD-CLASS-NAME.       13100000
131100     MOVE +0                         TO WS-TOTAL-CLASS-UNITS      13110000
131200                                        WS-TOTAL-CLASS-COST       13120000
131300                                        WS-TOTAL-CLASS-RETAIL.    13130000
131400 0420-EXIT. EXIT.                                                 13140000
131500                                                                  13150000
131600 0425-PRT-MAJTOTAL-LINE.                                          13160000
131700     IF WS-LINE-CNT > 55                                          13170000
131800         PERFORM 1000-PRINT-HEADINGS THRU                         13180000
131900                 1000-EXIT-PRINT-HEADINGS.                        13190000
132000     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-DASH AFTER 1.        13200000
132100     ADD 1     TO WS-LINE-CNT.                                    13210000
132200                                                                  13220000
132300     MOVE '   CLASS - '              TO WS-TTL-LIT-A.             13230000
132400     MOVE WS-HOLD-MAJ-CLASS          TO WS-TTL-LIT-B.             13240000
132500     MOVE WS-HOLD-MAJ-CLASS-NAME     TO WS-TTL-LIT-C.             13250000
132600     MOVE '      TOTAL:'             TO WS-TTL-LIT-1.             13260000
132700     IF  WS-TOTAL-MAJ-CLASS-RETAIL >  999999999.99                13270000
132800         MOVE WS-TOTAL-MAJ-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1-RD13280000
132900     ELSE                                                         13290000
133000         MOVE WS-TOTAL-MAJ-CLASS-RETAIL TO WS-TTL-TOTAL-RETAIL1   13300000
133100     END-IF.                                                      13310000
133200     IF  WS-TOTAL-MAJ-CLASS-COST >    999999999.99                13320000
133300         MOVE WS-TOTAL-MAJ-CLASS-COST TO   WS-TTL-TOTAL-COST1-RD  13330000
133400     ELSE                                                         13340000
133500         MOVE WS-TOTAL-MAJ-CLASS-COST TO WS-TTL-TOTAL-COST1       13350000
133600     END-IF.                                                      13360000
133700     MOVE  WS-TOTAL-MAJ-CLASS-UNITS  TO WS-TTL-UNIT-TOTAL1.       13370000
133800     MOVE '%'                        TO WS-TTL-PCT1.              13380000
133900                                                                  13390000
134000     IF WS-TOTAL-MAJ-CLASS-RETAIL = 0                             13400000
134100         MOVE 0                      TO WS-TTL-MKUP1              13410000
134200     ELSE                                                         13420000
134300         COMPUTE WS-SAVE-MKUP =                                   13430000
134400          ((WS-TOTAL-MAJ-CLASS-RETAIL -                           13440000
134500            WS-TOTAL-MAJ-CLASS-COST  ) /                          13450000
134600             WS-TOTAL-MAJ-CLASS-RETAIL)  * 100                    13460000
134700         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP1.             13470000
134800                                                                  13480000
134900     IF WS-LINE-CNT > 55                                          13490000
135000         PERFORM 1000-PRINT-HEADINGS THRU                         13500000
135100                 1000-EXIT-PRINT-HEADINGS.                        13510000
135200     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE1 AFTER 1.       13520000
135300     ADD WS-CC TO WS-LINE-CNT.                                    13530000
135400                                                                  13540000
135500     IF WS-LINE-CNT > 55                                          13550000
135600         PERFORM 1000-PRINT-HEADINGS THRU                         13560000
135700                 1000-EXIT-PRINT-HEADINGS.                        13570000
135800     MOVE SPACES TO WS-DETAIL.                                    13580000
135900     WRITE BUYERS-RECEIPTS-RPT FROM WS-DETAIL AFTER 2.            13590000
136000     ADD 2     TO WS-LINE-CNT.                                    13600000
136100     MOVE 1 TO WS-CC.                                             13610000
136200                                                                  13620000
136300     MOVE RC043-MAJ-CL-NBR           TO WS-HOLD-MAJ-CLASS.        13630000
136400     MOVE RC043-MAJ-CL-DESC          TO WS-HOLD-MAJ-CLASS-NAME.   13640000
136500     MOVE +0                        TO WS-TOTAL-MAJ-CLASS-UNITS   13650000
136600                                       WS-TOTAL-MAJ-CLASS-COST    13660000
136700                                       WS-TOTAL-MAJ-CLASS-RETAIL. 13670000
136800 0425-EXIT. EXIT.                                                 13680000
136900                                                                  13690000
137000 0430-PRT-DEPT-LINE.                                              13700000
137100     IF MONTHLY-RUN                                               13710000
137200         NEXT SENTENCE                                            13720000
137300     ELSE                                                         13730000
137400         PERFORM 0700-WRITE-VRFD-RECORD THRU 0700-EXIT.           13740000
137500                                                                  13750000
137600     MOVE ' DEPT TOTAL:'             TO WS-TTL-LIT-2.             13760000
137700     IF  WS-TOTAL-DEPT-RETAIL >  999999999.99                     13770000
137800         MOVE WS-TOTAL-DEPT-RETAIL TO WS-TTL-TOTAL-RETAIL-RD      13780000
137900     ELSE                                                         13790000
138000         MOVE WS-TOTAL-DEPT-RETAIL TO WS-TTL-TOTAL-RETAIL         13800000
138100     END-IF.                                                      13810000
138200     IF  WS-TOTAL-DEPT-COST >    999999999.99                     13820000
138300         MOVE WS-TOTAL-DEPT-COST TO WS-TTL-TOTAL-COST-RD          13830000
138400     ELSE                                                         13840000
138500         MOVE WS-TOTAL-DEPT-COST TO WS-TTL-TOTAL-COST             13850000
138600     END-IF.                                                      13860000
138700     MOVE  WS-TOTAL-DEPT-UNITS       TO WS-TTL-UNIT-TOTAL.        13870000
138800     MOVE '%'                        TO WS-TTL-PCT.               13880000
138900                                                                  13890000
139000     IF WS-TOTAL-DEPT-RETAIL = 0                                  13900000
139100         MOVE 0                      TO WS-TTL-MKUP               13910000
139200     ELSE                                                         13920000
139300         COMPUTE WS-SAVE-MKUP =                                   13930000
139400          ((WS-TOTAL-DEPT-RETAIL   - WS-TOTAL-DEPT-COST  ) /      13940000
139500             WS-TOTAL-DEPT-RETAIL)  * 100                         13950000
139600         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              13960000
139700                                                                  13970000
139800     IF WS-LINE-CNT > 55                                          13980000
139900         PERFORM 1000-PRINT-HEADINGS THRU                         13990000
140000                 1000-EXIT-PRINT-HEADINGS.                        14000000
140100     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       14010000
140200                                                                  14020000
140300     IF PS-DEPT-BREAK                                             14030000
140400         ADD 100 TO WS-LINE-CNT                                   14040000
140500     ELSE                                                         14050000
140600         ADD 1 TO WS-LINE-CNT.                                    14060000
140700                                                                  14070000
140800     MOVE +0                         TO WS-TOTAL-DEPT-UNITS       14080000
140900                                        WS-TOTAL-DEPT-COST        14090000
141000                                        WS-TOTAL-DEPT-RETAIL.     14100000
141100     MOVE RC043-DEPT                 TO WS-HOLD-DEPT.             14110000
141200     MOVE RC043-DEPT                 TO WS-HDR7-DEPARTMENT.       14120000
141300     MOVE RC043-DEPT-NAME            TO WS-HDR7-DEPT-NAME.        14130000
141400 0430-EXIT. EXIT.                                                 14140000
141500                                                                  14150000
141600 0440-PRT-BYR-LINE.                                               14160000
141700     MOVE 'BUYER TOTAL:'             TO WS-TTL-LIT-2.             14170000
141800     IF  WS-TOTAL-BYR-RETAIL >  999999999.99                      14180000
141900         MOVE WS-TOTAL-BYR-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       14190000
142000     ELSE                                                         14200000
142100         MOVE WS-TOTAL-BYR-RETAIL TO WS-TTL-TOTAL-RETAIL          14210000
142200     END-IF.                                                      14220000
142300     IF  WS-TOTAL-BYR-COST >    999999999.99                      14230000
142400         MOVE WS-TOTAL-BYR-COST TO WS-TTL-TOTAL-COST-RD           14240000
142500     ELSE                                                         14250000
142600         MOVE WS-TOTAL-BYR-COST TO WS-TTL-TOTAL-COST              14260000
142700     END-IF.                                                      14270000
142800     MOVE  WS-TOTAL-BYR-UNITS        TO WS-TTL-UNIT-TOTAL.        14280000
142900     MOVE '%'                        TO WS-TTL-PCT.               14290000
143000                                                                  14300000
143100     IF WS-TOTAL-BYR-RETAIL = 0                                   14310000
143200         MOVE 0                      TO WS-TTL-MKUP               14320000
143300     ELSE                                                         14330000
143400         COMPUTE WS-SAVE-MKUP =                                   14340000
143500          ((WS-TOTAL-BYR-RETAIL   - WS-TOTAL-BYR-COST  ) /        14350000
143600             WS-TOTAL-BYR-RETAIL)  * 100                          14360000
143700         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              14370000
143800                                                                  14380000
143900     IF WS-LINE-CNT > 55                                          14390000
144000         PERFORM 1000-PRINT-HEADINGS THRU                         14400000
144100                 1000-EXIT-PRINT-HEADINGS.                        14410000
144200     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       14420000
144300                                                                  14430000
144400     IF PS-BYR-BREAK                                              14440000
144500         ADD 100 TO WS-LINE-CNT                                   14450000
144600     ELSE                                                         14460000
144700         ADD 1 TO WS-LINE-CNT.                                    14470000
144800                                                                  14480000
144900     MOVE +0                         TO WS-TOTAL-BYR-UNITS        14490000
145000                                        WS-TOTAL-BYR-COST         14500000
145100                                        WS-TOTAL-BYR-RETAIL.      14510000
145200     MOVE RC043-BYR-NBR              TO WS-HOLD-BYR.              14520000
145300     MOVE RC043-BYR-NBR              TO WS-HDR6-BYR-NO.           14530000
145400     MOVE RC043-BYR-NAME             TO WS-HDR6-BYR-NAME.         14540000
145500 0440-EXIT. EXIT.                                                 14550000
145600                                                                  14560000
145700 0450-PRT-DMM-LINE.                                               14570000
145800     MOVE '  DMM TOTAL:'             TO WS-TTL-LIT-2.             14580000
145900     IF  WS-TOTAL-DMM-RETAIL >  999999999.99                      14590000
146000         MOVE WS-TOTAL-DMM-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       14600000
146100     ELSE                                                         14610000
146200         MOVE WS-TOTAL-DMM-RETAIL TO WS-TTL-TOTAL-RETAIL          14620000
146300     END-IF.                                                      14630000
146400     IF  WS-TOTAL-DMM-COST >    999999999.99                      14640000
146500         MOVE WS-TOTAL-DMM-COST TO WS-TTL-TOTAL-COST-RD           14650000
146600     ELSE                                                         14660000
146700         MOVE WS-TOTAL-DMM-COST TO WS-TTL-TOTAL-COST              14670000
146800     END-IF.                                                      14680000
146900     MOVE  WS-TOTAL-DMM-UNITS        TO WS-TTL-UNIT-TOTAL.        14690000
147000     MOVE '%'                        TO WS-TTL-PCT.               14700000
147100                                                                  14710000
147200     IF WS-TOTAL-DMM-RETAIL = 0                                   14720000
147300         MOVE 0                      TO WS-TTL-MKUP               14730000
147400     ELSE                                                         14740000
147500         COMPUTE WS-SAVE-MKUP =                                   14750000
147600          ((WS-TOTAL-DMM-RETAIL   - WS-TOTAL-DMM-COST  ) /        14760000
147700             WS-TOTAL-DMM-RETAIL)  * 100                          14770000
147800         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              14780000
147900                                                                  14790000
148000     IF WS-LINE-CNT > 55                                          14800000
148100         PERFORM 1000-PRINT-HEADINGS THRU                         14810000
148200                 1000-EXIT-PRINT-HEADINGS.                        14820000
148300     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       14830000
148400                                                                  14840000
148500     IF PS-DMM-BREAK                                              14850000
148600         ADD 100 TO WS-LINE-CNT                                   14860000
148700     ELSE                                                         14870000
148800         ADD 1 TO WS-LINE-CNT.                                    14880000
148900                                                                  14890000
149000     MOVE +0                         TO WS-TOTAL-DMM-UNITS        14900000
149100                                        WS-TOTAL-DMM-COST         14910000
149200                                        WS-TOTAL-DMM-RETAIL.      14920000
149300     MOVE RC043-DMM-NBR              TO WS-HOLD-DM.               14930000
149400     MOVE RC043-DMM-NBR              TO WS-HDR5-DMM-NO.           14940000
149500     MOVE RC043-DMM-NAME             TO WS-HDR5-DMM-NAME.         14950000
149600 0450-EXIT. EXIT.                                                 14960000
149700                                                                  14970000
149800 0460-PRT-GMM-LINE.                                               14980000
149900     MOVE '  GMM TOTAL:'             TO WS-TTL-LIT-2.             14990000
150000     IF  WS-TOTAL-GMM-RETAIL >  999999999.99                      15000000
150100         MOVE WS-TOTAL-GMM-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       15010000
150200     ELSE                                                         15020000
150300         MOVE WS-TOTAL-GMM-RETAIL TO WS-TTL-TOTAL-RETAIL          15030000
150400     END-IF.                                                      15040000
150500     IF  WS-TOTAL-GMM-COST >    999999999.99                      15050000
150600         MOVE WS-TOTAL-GMM-COST TO WS-TTL-TOTAL-COST-RD           15060000
150700     ELSE                                                         15070000
150800         MOVE WS-TOTAL-GMM-COST TO WS-TTL-TOTAL-COST              15080000
150900     END-IF.                                                      15090000
151000     MOVE  WS-TOTAL-GMM-UNITS        TO WS-TTL-UNIT-TOTAL.        15100000
151100     MOVE '%'                        TO WS-TTL-PCT.               15110000
151200                                                                  15120000
151300     IF WS-TOTAL-GMM-RETAIL = 0                                   15130000
151400         MOVE 0                      TO WS-TTL-MKUP               15140000
151500     ELSE                                                         15150000
151600         COMPUTE WS-SAVE-MKUP =                                   15160000
151700          ((WS-TOTAL-GMM-RETAIL   - WS-TOTAL-GMM-COST  ) /        15170000
151800             WS-TOTAL-GMM-RETAIL)  * 100                          15180000
151900         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              15190000
152000                                                                  15200000
152100     IF WS-LINE-CNT > 55                                          15210000
152200         PERFORM 1000-PRINT-HEADINGS THRU                         15220000
152300                 1000-EXIT-PRINT-HEADINGS.                        15230000
152400     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       15240000
152500                                                                  15250000
152600     IF PS-GMM-BREAK                                              15260000
152700         ADD 100 TO WS-LINE-CNT                                   15270000
152800     ELSE                                                         15280000
152900         ADD 1 TO WS-LINE-CNT.                                    15290000
153000                                                                  15300000
153100     MOVE +0                         TO WS-TOTAL-GMM-UNITS        15310000
153200                                        WS-TOTAL-GMM-COST         15320000
153300                                        WS-TOTAL-GMM-RETAIL.      15330000
153400     MOVE RC043-GMM-NBR              TO WS-HOLD-GM.               15340000
153500     MOVE RC043-GMM-NBR              TO WS-HDR4-GMM-NO.           15350000
153600     MOVE RC043-GMM-NAME             TO WS-HDR4-GMM-NAME.         15360000
153700 0460-EXIT. EXIT.                                                 15370000
153800                                                                  15380000
153900 0470-PRT-FINAL-LINE.                                             15390000
154000                                                                  15400000
154100*    WRITE THE FINAL TOTALS ON A SEPARATE PAGE                    15410000
154200     ADD +1 TO WS-PAGE-CNT.                                       15420000
154300     MOVE WS-PAGE-CNT TO DP132O-PAGE-NUMBER.                      15430000
154400     WRITE BUYERS-RECEIPTS-RPT FROM                               15440000
154500                           DP132O-STANDRD-HEADER-132-COLS         15450000
154600                               AFTER PAGE.                        15460000
154700     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER2 AFTER 1.           15470000
154800     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER3 AFTER 1.           15480000
154900     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER8 AFTER 2.           15490000
155000     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER9 AFTER 1.           15500000
155100     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER10 AFTER 1.          15510000
155200                                                                  15520000
155300     MOVE 'FINAL TOTAL:'             TO WS-TTL-LIT-2.             15530000
155400     IF  WS-TOTAL-RPT-RETAIL >  999999999.99                      15540000
155500         MOVE WS-TOTAL-RPT-RETAIL TO WS-TTL-TOTAL-RETAIL-RD       15550000
155600     ELSE                                                         15560000
155700         MOVE WS-TOTAL-RPT-RETAIL TO WS-TTL-TOTAL-RETAIL          15570000
155800     END-IF.                                                      15580000
155900     IF  WS-TOTAL-RPT-COST >    999999999.99                      15590000
156000         MOVE WS-TOTAL-RPT-COST TO WS-TTL-TOTAL-COST-RD           15600000
156100     ELSE                                                         15610000
156200         MOVE WS-TOTAL-RPT-COST TO WS-TTL-TOTAL-COST              15620000
156300     END-IF.                                                      15630000
156400     MOVE  WS-TOTAL-RPT-UNITS        TO WS-TTL-UNIT-TOTAL.        15640000
156500     MOVE '%'                        TO WS-TTL-PCT.               15650000
156600                                                                  15660000
156700     IF WS-TOTAL-RPT-RETAIL = 0                                   15670000
156800         MOVE 0                      TO WS-TTL-MKUP               15680000
156900     ELSE                                                         15690000
157000         COMPUTE WS-SAVE-MKUP =                                   15700000
157100          ((WS-TOTAL-RPT-RETAIL   - WS-TOTAL-RPT-COST  ) /        15710000
157200             WS-TOTAL-RPT-RETAIL)  * 100                          15720000
157300         MOVE WS-SAVE-MKUP           TO WS-TTL-MKUP.              15730000
157400                                                                  15740000
157800     WRITE BUYERS-RECEIPTS-RPT FROM WS-TOTAL-LINE2 AFTER 1.       15780000
157900 0470-EXIT. EXIT.                                                 15790000
158000                                                                  15800000
158100 0700-WRITE-VRFD-RECORD.                                          15810000
158200******************************************************************15820000
158300* SET TABLE INDEX EQUAL TO THE DEPT # MOVED TO DETAIL LINE        15830000
158400* SO THAT THE GMA/DMA/BYR NUMBERS CAN BE MOVED TO THE OUTPUT RECOR15840000
158500* AND THE WEEKLY RECEIPTS AT THE DEPT LEVEL CAN BE WRITTEN        15850000
158600******************************************************************15860000
158700     MOVE WS-HOLD-DEPT            TO PV-DEPT-NBR-X.               15870000
158800     MOVE PV-DEPT-NBR-9           TO PV-DEPT-NBR-B.               15880000
158900     SET IDX-DT                   TO PV-DEPT-NBR-B.               15890000
159000                                                                  15900000
159100     IF  DT-DEPT-NBR (IDX-DT) = WS-HOLD-DEPT                      15910000
159200         MOVE DT-GMA-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-GMA-NBR15920000
159300         MOVE DT-DMA-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-DMA-NBR15930000
159400         MOVE DT-BYR-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-BYR-NBR15940000
159500         MOVE PV-DEPT-NBR-X         TO ML031-WKLY-RECEIPTS-DPT-NBR15950000
159600         MOVE WS-TOTAL-DEPT-COST    TO                            15960000
159700                                    ML031-WKLY-RECEIPTS-DEPT-COST 15970000
159800         MOVE WS-TOTAL-DEPT-RETAIL  TO                            15980000
159900                                    ML031-WKLY-RECEIPTS-DEPT-RETL 15990000
160000         WRITE WEEKLY-RECEIPTS-REC  FROM                          16000000
160100                                    ML031-WKLY-RECEIPTS-DEPT-REC  16010000
160200         MOVE 'Y'                   TO DT-WRITE-SW(IDX-DT)        16020000
160210                                                                  16021005
160220         ADD  1  TO  PV-WKLY-RCPT-CNT                             16022005
160300     ELSE                                                         16030000
160310         SET PV-DISP-TABLE-IDX       TO IDX-DT                    16031010
160320         MOVE PV-DISP-TABLE-IDX      TO PV-DISP-IDX               16032010
160400         DISPLAY '** RCKRP018 DEPT ' WS-HOLD-DEPT ' NOT FOUND!'   16040008
160410                 '  DEPT TABLE ENTRIES: ' PV-DISP-IDX             16041010
160500         MOVE +0                 TO ML031-WKLY-RECEIPTS-GMA-NBR   16050000
160600         MOVE +0                 TO ML031-WKLY-RECEIPTS-DMA-NBR   16060000
160700         MOVE +0                 TO ML031-WKLY-RECEIPTS-BYR-NBR   16070000
160800     END-IF.                                                      16080000
160900 0700-EXIT. EXIT.                                                 16090000
161000                                                                  16100000
161100 1000-PRINT-HEADINGS.                                             16110000
161200     ADD +1 TO WS-PAGE-CNT.                                       16120000
161300     MOVE WS-PAGE-CNT TO DP132O-PAGE-NUMBER.                      16130000
161400     WRITE BUYERS-RECEIPTS-RPT FROM                               16140000
161500                           DP132O-STANDRD-HEADER-132-COLS         16150000
161600                               AFTER PAGE.                        16160000
161700     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER2 AFTER 1.           16170000
161800     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER3 AFTER 1.           16180000
161900     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER4 AFTER 1.           16190000
162000     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER5 AFTER 1.           16200000
162100     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER6 AFTER 1.           16210000
162200     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER7 AFTER 2.           16220000
162300     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER8 AFTER 2.           16230000
162400     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER9 AFTER 1.           16240000
162500     WRITE BUYERS-RECEIPTS-RPT FROM WS-HEADER10 AFTER 1.          16250000
162600     MOVE +11 TO WS-LINE-CNT.                                     16260000
162700     MOVE WS-HOLD-VENDOR-NAME        TO WS-DTL-VENDOR-NAME.       16270000
162800     MOVE WS-HOLD-CLASS              TO WS-DTL-CLASS.             16280000
162900 1000-EXIT-PRINT-HEADINGS. EXIT.                                  16290000
163000                                                                  16300000
163100 1050-DATE-CALCULATION.                                           16310000
163200     INITIALIZE DPG51.                                            16320000
163300     MOVE WS-DATE                  TO DPG51-SYSTEM-DATE.          16330000
163400     SET  DPG51-FISCAL-454-CALENDAR                               16340000
163500                                   TO TRUE.                       16350000
163600     SET  DPG51-DO-NOT-INCR-DECR-DATE                             16360000
163700                                   TO TRUE.                       16370000
163800                                                                  16380000
163900     SET DPG52-LK-DTE-ISO          TO TRUE.                       16390000
164000                                                                  16400000
164100     IF  WS-WK-END-DATE > WS-DATE-CCYYMMDD                        16410000
164200         MOVE WS-WK-END-DATE       TO DPG52-LK-DATE-INPUT         16420000
164300     ELSE                                                         16430000
164400         MOVE WS-DATE-CCYYMMDD     TO DPG52-LK-DATE-INPUT         16440000
164500     END-IF.                                                      16450000
164600                                                                  16460000
164700     CALL PC-DPKUT500 USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.  16470000
164800                                                                  16480000
164900     IF (DPG54-DATE-INVALID                                       16490000
165000     OR  DPG54-SEVERE-ERROR)                                      16500000
165100         DISPLAY '*** ABEND *** IN RCKRP018'                      16510000
165200         DISPLAY 'ERROR IN CALL TO DPKUT500'                      16520000
165300         DISPLAY DPG54-ERROR-MESSAGE                              16530000
165400         MOVE +4003 TO ABEND-CODE                                 16540000
165500         CALL 'ILBOABN0' USING ABEND-CODE                         16550000
165600     ELSE                                                         16560000
165700         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO WS-1ST-DAY-OF-WEEK    16570000
165800         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO WS-LAST-DAY-OF-WEEK   16580000
165900         MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3   TO WS-MONTH        16590000
166000         DISPLAY 'WS-LAST-DAY-OF-WEEK =>' WS-LAST-DAY-OF-WEEK     16600000
166100         DISPLAY 'WS-1ST-DAY-0F-WEEK = ' WS-1ST-DAY-OF-WEEK       16610000
166200         DISPLAY 'WS-MONTH = ' WS-MONTH                           16620000
166300     END-IF.                                                      16630000
166400 1050-EXIT.  EXIT.                                                16640000
166500                                                                  16650000
166600 1200-DEPTS-W-NO-RCPTS.                                           16660000
166700     IF  DT-DEPT-NBR (IDX-DT) NUMERIC AND                         16670000
166800         DT-WRITE-SW (IDX-DT) NOT = 'Y'                           16680000
166900         MOVE DT-GMA-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-GMA-NBR16690000
167000         MOVE DT-DMA-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-DMA-NBR16700000
167100         MOVE DT-BYR-NBR(IDX-DT)    TO ML031-WKLY-RECEIPTS-BYR-NBR16710000
167200         MOVE DT-DEPT-NBR(IDX-DT)   TO ML031-WKLY-RECEIPTS-DPT-NBR16720000
167300         MOVE +0                    TO                            16730000
167400                                    ML031-WKLY-RECEIPTS-DEPT-COST 16740000
167500         MOVE +0                    TO                            16750000
167600                                    ML031-WKLY-RECEIPTS-DEPT-RETL 16760000
167700         WRITE WEEKLY-RECEIPTS-REC  FROM                          16770000
167800                                    ML031-WKLY-RECEIPTS-DEPT-REC  16780000
167810         ADD  1  TO  PV-DEPT-NO-RCPT-CNT                          16781005
167900     END-IF.                                                      16790000
168000                                                                  16800000
168100     SET IDX-DT UP BY +1.                                         16810000
168200 1200-EXIT-DEPTS-W-NO-RCPTS. EXIT.                                16820000
168300*                                                                 16830000
168400 5000-GET-PO-INFO.                                                16840000
168500*                                                                 16850000
168600     INITIALIZE  DCLTPURCHS.                                      16860000
168700     EXEC SQL                                                     16870000
168800        SELECT  DERVD_LBL_TYP_CDE                                 16880000
168900          INTO :PURCHS-DERVD-LBL-TYP-CDE                          16890000
169000        FROM  TPURCHS                                             16900000
169100        WHERE  VER_STATUS_CDE = 'A'                               16910000
169200               AND  PO_NBR    = :PV-PO-NBR                        16920000
169300        WITH UR                                                   16930000
169400     END-EXEC.                                                    16940000
169500*                                                                 16950000
169600     EVALUATE TRUE                                                16960000
169700        WHEN SQLCODE = ZERO                                       16970000
169800        WHEN SQLCODE = 100                                        16980000
169900          CONTINUE                                                16990000
170000        WHEN SQLWARN0 NOT = SPACES                                17000000
170100        WHEN SQLCODE  NOT = ZERO                                  17010000
170200          DISPLAY 'PGM RCKRP018 ABENDED - READ GET-PO-INFO '      17020000
170300          MOVE '5000-GET-PO-INFO'     TO PV-PARAGRAPH-NAME        17030000
170400          MOVE 'UNSUCCESSFUL SELECT ' TO PV-DB2-OPERATION         17040000
170500          PERFORM 9100-SQL-ERROR THRU 9100-SQL-ERROR-EXIT         17050000
170600     END-EVALUATE.                                                17060000
170700 5000-EXIT. EXIT.                                                 17070000
170800*                                                                 17080000
170900******************************************************************17090000
171000*  FORMAT A DB2 ERROR MESSAGE, RELEASE ALL LOCKS, AND ABEND THE  *17100000
171100*  PROGRAM.                                                      *17110000
171200******************************************************************17120000
171300 9100-SQL-ERROR.                                                  17130000
171400     MOVE SQLCODE                    TO SQLCODE2.                 17140000
171500     MOVE SQLERRD(3)                 TO SQLERRD3.                 17150000
171600     DISPLAY '** ABEND **          = SQL ERROR'.                  17160000
171700     DISPLAY '** PROGRAM **        = RCKRP018'                    17170000
171800     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NAME          17180000
171900     DISPLAY '** SQLCODE **        = ' SQLCODE2.                  17190000
172000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  17200000
172100     DISPLAY '** SQLERRM **        = ' SQLERRM.                   17210000
172200     DISPLAY '** SQLERRMC **       = ' SQLERRMC.                  17220000
172300                                                                  17230000
172400     DISPLAY '** SQLWARN0 **       = ' SQLWARN0.                  17240000
172500     DISPLAY '** SQLWARN1 **       = ' SQLWARN1.                  17250000
172600     DISPLAY '** SQLWARN2 **       = ' SQLWARN2.                  17260000
172700     DISPLAY '** SQLWARN3 **       = ' SQLWARN3.                  17270000
172800     DISPLAY '** SQLWARN4 **       = ' SQLWARN4.                  17280000
172900     DISPLAY '** SQLWARN5 **       = ' SQLWARN5.                  17290000
173000     DISPLAY '** SQLWARN6 **       = ' SQLWARN6.                  17300000
173100     DISPLAY '** SQLWARN7 **       = ' SQLWARN7.                  17310000
173200     DISPLAY '** ABEND     **'.                                   17320000
173300     DISPLAY '** PROGRAM   ** = RCKRP018'.                        17330000
173400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              17340000
173500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               17350000
173600                                                                  17360000
173700 9100-SQL-ERROR-EXIT. EXIT.                                       17370000
173800******************************************************************17380000
173900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    17390000
174000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         17400000
174100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     17410000
174200* FORMAT.                                                         17420000
174300******************************************************************17430000
174400     COPY DPPD004.                                                17440000
