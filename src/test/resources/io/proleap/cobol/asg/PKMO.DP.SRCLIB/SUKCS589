000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS589.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JAN, 2002.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S589 - AUDIT RESULTS LIST PROGRAM.                         * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF THE AUDITS.  THE          * 00130000
001400*    ASSOCIATED SOURCE, OPER UNIT, PO AND RECEIVER, LINE/PACK,  * 00140000
001500*    SKU, REQUEST DATE, PROCESS STATUS, ERROR PERCENT AND       * 00150000
001600*    DEFERRED IND WILL BE DISPLAYED.  THE APPROPRIATE PROGRAM   * 00160000
001700*    IS INVOKED WHEN THE OPERATOR SELECTS ONE OR MORE ITEMS AND * 00170000
001800*    PRESSES A FUNCTION KEY.                                    * 00180000
001900*                                                               * 00190000
002000*---------------------------------------------------------------* 00200000
001500*---------------------------------------------------------------* 00201000
000510* 10/14/2013  CHERI PARMLEY  CHG0068598     TKID: TKMAF76       * 00202001
000520*             ADD RWRK_AUD_CNTL_NBR TO EACH OF THE CURSORS WHEN * 00203000
000560*             NOT APPLICABLE NEED TO INCLUDE COLUMN IN SAME     * 00204000
000560*             POSITION WITH A DEFAULT. NEW COLUMN IS USED TO    * 00204100
000560*             DETERMINE IF THERE IS MULTIPLE AUDITS (QC AND     * 00204200
000560*             RFID). IF SO HIGHLIGHT THE SRC COLUMN. IF RFID    * 00204300
000560*             AUDIT, IT WILL DISPLAY 'RFID' IN THE LINE/PACK    * 00204400
000560*             COLUMN.  CHANGES TAGGED CLP 10/14/2013            * 00204500
001500*---------------------------------------------------------------* 00204600
001500*---------------------------------------------------------------* 00204700
000510* 11/20/2013  VENKATESH SHANMUGAM 5148D     TKID: TKMAHH5       * 00204800
000520*             ADDED A LOGIC TO FIND OUT THE WHETHER THE AUDIT   * 00204900
000560*             NUMBER IS PART OF COMBINED AUDIT OR NOT.          * 00205000
      *             ONLY THOSE AUDIT NUMBERS WILL BE DISPLAYED IN *     00206000
      *             YELLOW COLOUR                                     * 00207000
000560*             CHANGES TAGGED VSH 10/14/2013                     * 00208001
001500*---------------------------------------------------------------* 00208121
000510* 03/19/2014  CHERI PARMLEY       5148D     TKID: TKMAF76       * 00208221
000520*             CHANGED ALL THE CURSORS TO ORDER BY PO & RCVR NO  * 00208321
      *             TAGGED WITH *CLP03/18/14                            00208421
001500*---------------------------------------------------------------* 00209000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00209222
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00209322
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00209422
001130*                                                                 00209523
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00209623
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00209723
263968*---------------------------------------------------------------* 00209822
002100 EJECT                                                            00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600 WORKING-STORAGE SECTION.                                         00260000
002700                                                                  00270000
002800 01  DK-DB2-KEYS.                                                 00280000
002900     05  DK-ENT-ID                      PIC S9(09)  COMP.         00290000
003000     05  DK-AUDIT-NBR                   PIC S9(09)  COMP.         00300000
003100     05  DK-AUDIT-STATUS-1              PIC  X(01)  VALUE SPACES. 00310000
003200     05  DK-AUDIT-STATUS-2              PIC  X(01)  VALUE SPACES. 00320000
003300     05  DK-AUDIT-STATUS-3              PIC  X(01)  VALUE SPACES. 00330000
003400     05  DK-MAN-AUD-STATUS-1            PIC  X(02)  VALUE SPACES. 00340000
003500     05  DK-MAN-AUD-STATUS-2            PIC  X(02)  VALUE SPACES. 00350000
003600     05  DK-MAN-AUD-STATUS-3            PIC  X(02)  VALUE SPACES. 00360000
003700     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP.         00370000
003800     05  DK-PO                          PIC S9(09)  COMP.         00380000
003900     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00390000
004000     05  DK-DATE-FROM-TIMESTAMP         PIC  X(26)  VALUE SPACES. 00400000
004100     05  DK-DATE-TO-TIMESTAMP           PIC  X(26)  VALUE SPACES. 00410000
004200     05  DK-DEPT-NBR                    PIC S9(04)  COMP-3.       00420000
004300     05  DK-DEPT                        PIC  X(03)  VALUE SPACES. 00430000
004400     05  DK-PACKAGING-TYPE              PIC  X(02)  VALUE SPACES. 00440000
004500     05  DK-PROCESS-STATUS              PIC  X(01)  VALUE SPACES. 00450000
004600     05  DK-CRTN-ID                     PIC S9(18)V COMP-3        00460000
004700                                                    VALUE ZEROES. 00470000
004800                                                                  00480000
004900 01  PC-PROGRAM-CONSTANTS.                                        00490000
005000     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00500000
005100                                                    'SU589A  '.   00510000
005200     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00520000
005300                                                    'SUKM589 '.   00530000
005400     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00540000
005500                                                    'SUKCS589'.   00550000
005600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00560000
005700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00570000
005800     05  PC-INTER-APPL-CODES.                                     00580000
005900         10  PC-INTER-APPL-CRIT-SPEC                              00590000
006000                                  PIC  X(01)  VALUE '1'.          00600000
006100         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00610000
006200         10  PC-INTER-APPL-CHKIN  PIC  X(01)  VALUE '3'.          00620000
006300         10  PC-INTER-APPL-SUSPEND PIC  X(01)  VALUE '4'.         00630000
006400     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00640000
006500                                                    COMP SYNC.    00650000
006600     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00660000
006700                                                    COMP SYNC.    00670000
006800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00680000
006900                                                    +1000000      00690000
007000                                                    COMP-3.       00700000
007100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00710000
007200                                                    COMP SYNC.    00720000
007300     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00730000
007400                                                    COMP-3.       00740000
007500     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00750000
007600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00760000
007700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00770000
007800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00780000
007900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00790000
008000     05  PC-01                          PIC  X(02)  VALUE '01'.   00800000
008100     05  PC-MAX-DATE               PIC  X(10)  VALUE '9999-09-09'.00810000
008200     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00820000
008300     05  PC-PASS                   PIC  X(07)  VALUE 'PASS   '.   00830000
008400     05  PC-FAIL                   PIC  X(07)  VALUE 'FAIL   '.   00840000
008500     05  PC-IN-PROC                PIC  X(07)  VALUE 'IN PROC'.   00850000
008600     05  PC-NOT-NEEDED             PIC  X(07)  VALUE 'NOTNEED'.   00860000
008700     05  PC-OPEN                   PIC  X(07)  VALUE 'OPEN   '.   00870000
008800     05  PC-CLOSED                 PIC  X(07)  VALUE 'CLOSED '.   00880000
008900     05  PC-ALL                    PIC  X(07)  VALUE 'ALL    '.   00890000
009000     05  PC-BULK-CSEPK             PIC  X(10)  VALUE 'BULK/CSEPK'.00900000
009100     05  PC-PREPACK                PIC  X(10)  VALUE 'PRE-PACK  '.00910000
009200     05  PC-PBS                    PIC  X(10)  VALUE 'PBS       '.00920000
009300     05  PC-ALL-DC                 PIC  X(30)  VALUE              00930000
009400            'ALL DISTRIBUTION CENTERS'.                           00930100
      *CLP 10/14/2013 BEGIN - PR5148D                                   00930200
009300     05  PC-RFID                   PIC  X(10)  VALUE 'RFID      '.00930300
      *CLP 10/14/2013 END   - PR4148D                                   00930400
009500                                                                  00930500
009600******************************************************************00930600
009700*   SYSTEM MESSAGES                                              *00930700
009800******************************************************************00930800
009900* 00005 - INVALID VALUE                                          *00930900
010000* 00008 - MUST BE NUMERIC                                        *00931000
010100* 00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED    *00932000
010200* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                     *00933000
010300* 00052 - END OF RANGE PRECEDES START OF RANGE                   *00934000
010400* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                   *00935000
010500* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED     *00936000
010600* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED       *00937000
010700* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION         *00938000
010800* 00069 - TOP OF LIST                                            *00939000
010900* 00070 - BOTTOM OF LIST                                         *00940000
011000* 00101 - VALUE MUST BE GREATER THAN ZERO AND LESS THAN 100,000,0*00950000
011100* 00148 - DATA DOES NOT EXIST                                    *00960000
011200* 00279 - MORE ITEMS TO DISPLAY                                  *00970000
011300* 00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID             *00980000
011400* 00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL CA*00990000
011500* 02844 - YOU DO NOT HAVE THE AUTHORITY TO UPDATE RANK           *01000000
011600* 99901 - INVALID COMMAND WAS ENTERED                            *01010000
011700******************************************************************01020000
011800     05  PC-TSYMSG-NUMBERS.                                       01030000
011900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01040000
012000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01050000
012100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01060000
012200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01070000
012300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01080000
012400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01090000
012500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01100000
012600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01110000
012700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01120000
012800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01130000
012900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01140000
013000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01150000
013100         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01160000
013200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01170000
013300         10  PC-TSYMSG-00302            PIC  9(05)  VALUE 00302.  01180000
013400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01190000
013500         10  PC-TSYMSG-02844            PIC  9(05)  VALUE 02844.  01200000
013600         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01210000
013700*                                                                 01220000
013800 01  PS-PROGRAM-SWITCHES.                                         01230000
013900     05  PS-CURSOR-TYPE-SW              PIC  X(01)  VALUE ' '.    01240000
014000         88  PS-OPER-PO                             VALUE 'A'.    01250000
014100         88  PS-OPER-STAT                           VALUE 'B'.    01260000
014200         88  PS-OPER-STAT-DATE                      VALUE 'C'.    01270000
014300         88  PS-PO-RCVR                             VALUE 'D'.    01280000
014400         88  PS-PO                                  VALUE 'E'.    01290000
014500         88  PS-OPER-ENT-DEPT-DATE                  VALUE 'F'.    01300000
014600         88  PS-OPER-ENT-DATE                       VALUE 'G'.    01310000
014700         88  PS-ENT-DEPT-DATE                       VALUE 'H'.    01320000
014800         88  PS-ENT-DATE                            VALUE 'I'.    01330000
014900         88  PS-OPER-ENT                            VALUE 'J'.    01340000
015000         88  PS-ENT                                 VALUE 'K'.    01350000
015100         88  PS-AUDIT                               VALUE 'L'.    01360000
015200         88  PS-OPER                                VALUE 'M'.    01370000
015300         88  PS-OPER-DATE                           VALUE 'N'.    01380000
015400         88  PS-MAN-AUDIT                           VALUE 'O'.    01390000
015500         88  PS-MAN-OPER-DTE                        VALUE 'P'.    01400000
015600         88  PS-MAN-OPER-STAT-DTE                   VALUE 'Q'.    01410000
015700         88  PS-MAN-OPER                            VALUE 'R'.    01420000
015800         88  PS-MAN-OPER-STATUS                     VALUE 'S'.    01430000
015900         88  PS-ALL-AUDIT                           VALUE 'T'.    01440000
016000         88  PS-ALL-OPER-DTE                        VALUE 'U'.    01450000
016100         88  PS-ALL-OPER-STAT-DTE                   VALUE 'V'.    01460000
016200         88  PS-ALL-OPER                            VALUE 'W'.    01470000
016300         88  PS-ALL-OPER-STATUS                     VALUE 'X'.    01480000
016400         88  PS-OPER-PO-RCVR                        VALUE 'Y'.    01490000
016500         88  PS-ALL-CRTN                            VALUE 'Z'.    01500000
016600         88  PS-ALL-CRTN-AUDT                       VALUE '1'.    01510000
016700         88  PS-MAN-CRTN                            VALUE '2'.    01520000
016800         88  PS-MAN-CRTN-AUDT                       VALUE '3'.    01530000
016900         88  PS-ALL-SYSTEM                          VALUE '4'.    01540000
017000         88  PS-ALL-MANUAL                          VALUE '5'.    01550000
017100         88  PS-ALL-ALL                             VALUE '6'.    01560000
017200         88  PS-PO-RCVR-ALL-STATS                   VALUE '7'.    01570000
017300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01580000
017400         88  PS-NO-ERROR                            VALUE 'Y'.    01590000
017500         88  PS-ERROR                               VALUE 'N'.    01600000
017600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01610000
017700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01620000
017800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01630000
017900     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01640000
018000         88  PS-DONE                                VALUE 'Y'.    01650000
018100         88  PS-NOT-DONE                            VALUE 'N'.    01660000
018200     05  PS-END-OF-RANKINGS-SW          PIC  X(01)  VALUE 'N'.    01670000
018300         88  PS-END-OF-RANKINGS                     VALUE 'Y'.    01680000
018400         88  PS-NOT-END-OF-RANKINGS                 VALUE 'N'.    01690000
018500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01700000
018600         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01710000
018700         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01720000
018800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01730000
018900         88  PS-LIST-END                            VALUE  'Y'.   01740000
019000         88  PS-NO-LIST-END                         VALUE  'N'.   01750000
019100     05  PS-UPC-SKU-SW                  PIC  X(01)  VALUE  ' '.   01760000
019200         88  PS-NO-UPC-SKU-FND                      VALUE  'N'.   01770000
019300         88  PS-MULTI-SKU-FND                       VALUE  'M'.   01780000
019400*                                                                 01790000
019500 01  PV-PROGRAM-VARIABLES.                                        01800000
006561     05  PV-NULL-IND                    PIC S9(4)   VALUE ZERO    01810000
006562                                                     COMP SYNC.   01820000
019600     05  PV-SQL-CODE                    PIC 9(09).                01830000
019700     05  PV-SQL-CODE-DESC               PIC X(20).                01840000
019800     05  PV-SKU-NBR-X                   PIC X(08).                01850000
019900     05  PV-SKU-NBR REDEFINES PV-SKU-NBR-X                        01860000
020000                                        PIC 9(08).                01870000
020100     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01880000
020200                                                    COMP SYNC.    01890000
020300     05  PV-CICS-MSG-AREA               PIC  X(100) VALUE SPACE.  01900000
020400     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      01910000
020500                                                    COMP SYNC.    01920000
020600     05  PV-SUB                         PIC S9(04)  VALUE +0      01930000
020700                                                    COMP SYNC.    01940000
020800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01950000
020900                                                    COMP SYNC.    01960000
021000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01970000
021100                                                    COMP-3.       01980000
021200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01990000
021300                                                    COMP-3.       02000000
021400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02010000
021500                                                    COMP-3.       02020000
021600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02030000
021700                                                    COMP-3.       02040000
021800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02050000
021900                                                    COMP-3.       02060000
022000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02070000
022100                                                    COMP-3.       02080000
022200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02090000
022300                                                    COMP-3.       02100000
022400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02110000
022500                                                    COMP SYNC.    02120000
022600     05  PV-ITEM                        PIC S9(04)  VALUE +0      02130000
022700                                                    COMP SYNC.    02140000
022800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02150000
022900                                                    COMP SYNC.    02160000
023000     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02170000
023100                                                    COMP SYNC.    02180000
023200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02190000
023300                                                    COMP SYNC.    02200000
023400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02210000
023500                                                    COMP SYNC.    02220000
023600     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02230000
023700                                                    COMP SYNC.    02240000
023800     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02250000
023900                                                    COMP SYNC.    02260000
024000     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02270000
024100                                                    COMP SYNC.    02280000
024200     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02290000
024300                                                    COMP SYNC.    02300000
024400     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02310000
024500                                                    COMP SYNC.    02320000
024600     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02330000
024700                                                    COMP SYNC.    02340000
024800     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02350000
024900                                                    COMP SYNC.    02360000
025000     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02370000
025100                                                    COMP SYNC.    02380000
025200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02390000
025300                                                    COMP SYNC.    02400000
025400     05  PV-SYS-MAN-IND                 PIC  X(01).               02410000
025500     05  PV-BULK-VND-RNKG-CDE           PIC  X(06).               02420000
025600     05  PV-PREPACK-VND-RNKG-CDE        PIC  X(06).               02430000
025700     05  PV-PBS-VND-RNKG-CDE            PIC  X(06).               02440000
025800     05  PV-LINE-PACK-NBR               PIC  9(04).               02450000
025900     05  PV-COUNT-DEPT-RANKGS           PIC S9(04)  COMP.         02460000
026000     05  PV-ENT-ID                      PIC ZZZZZZZZ9.            02470000
026100     05  PV-DEPT-NBR                    PIC ZZZ9.                 02480000
026200     05  PV-OPER-UNIT-ID                PIC ZZZZ.                 02490000
026300     05  PV-PO-RECEIVER.                                          02500000
026400         10  PV-PO-NBR                  PIC ZZZZZZZZ9.            02510000
026500         10  PV-DASH                    PIC X(1)  VALUE '-'.      02520000
026600         10  PV-RECEIVER                PIC 999.                  02530000
026700                                                                  02540000
026800         10  PV-RCVR-TEXT-R REDEFINES PV-RECEIVER.                02550000
026900             15  PV-RCVR-NUMBER-3POS         PIC  X(03).          02560000
027000                                                                  02570000
027100     05  PV-CSR-SEQ-DATE                PIC X(10) VALUE SPACES.   02580000
027100     05  PV-CSR-AUDIT-NBR               PIC S9(09) COMP.          02590000
027200                                                                  02600000
027300     05  PV-REQ-DATE.                                             02610000
027400         10  PV-REQ-DATE-MM             PIC 9(02).                02620000
027500         10  FILLER                     PIC X(1)  VALUE '-'.      02630000
027600         10  PV-REQ-DATE-DD             PIC 9(02).                02640000
027700         10  FILLER                     PIC X(1)  VALUE '-'.      02650000
027800         10  PV-REQ-DATE-YY             PIC 9(02).                02660000
027900                                                                  02670000
028000     05  PV-REQ-DATE-MDCY.                                        02680000
028100         10  PV-REQ-DATE-MDCY-MM        PIC 9(02).                02690000
028200         10  FILLER                     PIC X(1)  VALUE '-'.      02700000
028300         10  PV-REQ-DATE-MDCY-DD        PIC 9(02).                02710000
028400         10  FILLER                     PIC X(1)  VALUE '-'.      02720000
028500         10  PV-REQ-DATE-MDCY-CCYY      PIC 9(04).                02730000
028600                                                                  02740000
028700     05  PV-REQ-TIME.                                             02750000
028800         10  PV-REQ-TIME-HR             PIC 9(02).                02760000
028900         10  FILLER                     PIC X(1)  VALUE ':'.      02770000
029000         10  PV-REQ-TIME-MN             PIC 9(02).                02780000
029100                                                                  02790000
029200     05  PV-FROM-DATE-TIME.                                       02800000
029300         10  PV-FROM-DATE-YY            PIC 9(04).                02810000
029400         10  FILLER                     PIC X(1)  VALUE '-'.      02820000
029500         10  PV-FROM-DATE-MM            PIC 9(02).                02830000
029600         10  FILLER                     PIC X(1)  VALUE '-'.      02840000
029700         10  PV-FROM-DATE-DD            PIC 9(02).                02850000
029800         10  FILLER                     PIC X(16)                 02860000
029900                  VALUE '-00.00.00.000000'.                       02870000
030000     05  PV-TO-DATE-TIME.                                         02880000
030100         10  PV-TO-DATE-YY              PIC 9(04).                02890000
030200         10  FILLER                     PIC X(1)  VALUE '-'.      02900000
030300         10  PV-TO-DATE-MM              PIC 9(02).                02910000
030400         10  FILLER                     PIC X(1)  VALUE '-'.      02920000
030500         10  PV-TO-DATE-DD              PIC 9(02).                02930000
030600         10  FILLER                     PIC X(16)                 02940000
030700                  VALUE '-23.59.59.999999'.                       02950000
030800     05  PV-DISPLAY-DATE.                                         02960000
030900         10  PV-DISPLAY-DATE-MM         PIC 9(02).                02970000
031000         10  FILLER                     PIC X(1)  VALUE '/'.      02980000
031100         10  PV-DISPLAY-DATE-DD         PIC 9(02).                02990000
031200         10  FILLER                     PIC X(1)  VALUE '/'.      03000000
031300         10  PV-DISPLAY-DATE-YY         PIC 9(04).                03010000
031400                                                                  03020000
031500     05  PV-PKG-TYP-1                    PIC X(02)  VALUE SPACES. 03030000
031600         88   PV-PKG-1-BC                           VALUE 'BC'.   03040000
031700         88   PV-PKG-1-PP                           VALUE 'PP'.   03050000
031800         88   PV-PKG-1-PBS                          VALUE 'PS'.   03060000
031800         88   PV-PKG-1-RFID                         VALUE 'RF'.   03070000
031900     05  PV-PKG-TYP-2                    PIC X(02)  VALUE SPACES. 03080000
032000         88   PV-PKG-2-BC                           VALUE 'BC'.   03090000
032100         88   PV-PKG-2-PP                           VALUE 'PP'.   03100000
032200         88   PV-PKG-2-PBS                          VALUE 'PS'.   03110000
032200         88   PV-PKG-2-RFID                         VALUE 'RF'.   03120000
032300     05  PV-PKG-TYP-3                    PIC X(02)  VALUE SPACES. 03130000
032400         88   PV-PKG-3-BC                           VALUE 'BC'.   03140000
032500         88   PV-PKG-3-PP                           VALUE 'PP'.   03150000
032600         88   PV-PKG-3-PBS                          VALUE 'PS'.   03160000
032600         88   PV-PKG-3-RFID                         VALUE 'RF'.   03170000
032300     05  PV-PKG-TYP-4                    PIC X(02)  VALUE SPACES. 03180000
032400         88   PV-PKG-4-BC                           VALUE 'BC'.   03190000
032500         88   PV-PKG-4-PP                           VALUE 'PP'.   03200000
032600         88   PV-PKG-4-PBS                          VALUE 'PS'.   03210000
032600         88   PV-PKG-4-RFID                         VALUE 'RF'.   03220000
032700                                                                  03230000
032800     05  PV-PROC-STAT-1                  PIC X(01)  VALUE SPACES. 03240000
032900         88   PV-STAT-1-P                           VALUE 'P'.    03250000
033000         88   PV-STAT-1-F                           VALUE 'F'.    03260000
033100         88   PV-STAT-1-I                           VALUE 'I'.    03270000
033200         88   PV-STAT-1-N                           VALUE 'N'.    03280000
033300     05  PV-PROC-STAT-2                  PIC X(01)  VALUE SPACES. 03290000
033400         88   PV-STAT-2-P                           VALUE 'P'.    03300000
033500         88   PV-STAT-2-F                           VALUE 'F'.    03310000
033600         88   PV-STAT-2-I                           VALUE 'I'.    03320000
033700         88   PV-STAT-2-N                           VALUE 'N'.    03330000
033800     05  PV-PROC-STAT-3                  PIC X(01)  VALUE SPACES. 03340000
033900         88   PV-STAT-3-P                           VALUE 'P'.    03350000
034000         88   PV-STAT-3-F                           VALUE 'F'.    03360000
034100         88   PV-STAT-3-I                           VALUE 'I'.    03370000
034200         88   PV-STAT-3-N                           VALUE 'N'.    03380000
034300     05  PV-PROC-STAT-4                  PIC X(01)  VALUE SPACES. 03390000
034400         88   PV-STAT-4-P                           VALUE 'P'.    03400000
034500         88   PV-STAT-4-F                           VALUE 'F'.    03410000
034600         88   PV-STAT-4-I                           VALUE 'I'.    03420000
034700         88   PV-STAT-4-N                           VALUE 'N'.    03430000
      *                                                                 03440000
034800******************************************************************03450000
034900**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03460000
035000**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03470000
035100**  APPLICATION-SPECIFIC COMMAREA.                              **03480000
035200******************************************************************03490000
035300 01  LQW-LIST-QUEUE-WORK-AREA.                                    03500000
035400     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03510000
035500     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03520000
035600                                        INDEXED BY LQW-IDX.       03530000
035700         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03540000
035800         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03550000
035900         10  LQW-SELECTED-SW            PIC  X(01).               03560000
036000             88  LQW-SELECT                         VALUE 'S'.    03570000
036100             88  LQW-DESELECT                       VALUE ' '.    03580000
036200         10  LQW-AUDIT-NBR              PIC S9(09)  COMP.         03590000
036300         10  LQW-SOURCE                 PIC  X(03).               03600000
036400         10  LQW-OPER-UNIT              PIC S9(04)  COMP.         03610000
036500         10  LQW-OPER-DESC              PIC  X(30).               03620000
036600         10  LQW-PO-RECEIVER            PIC  X(13).               03630000
036700         10  LQW-PACK-LINE              PIC  X(06).               03640000
036800         10  LQW-PKG-TYPE               PIC  X(02).               03650000
036900         10  LQW-SKU                    PIC  X(15).               03660000
037000         10  LQW-REQUEST-DATE           PIC  X(08).               03670000
037100         10  LQW-REQUEST-MDCY           PIC  X(10).               03680000
037200         10  LQW-REQUEST-TIME           PIC  X(05).               03690000
037300         10  LQW-PROCESS-STATUS         PIC  X(07).               03700000
037400         10  LQW-PROCESS-ST-CDE         PIC  X(01).               03710000
037500         10  LQW-DEFERRED-IND           PIC  X(01).               03720000
037600         10  LQW-MODIFIED-IND           PIC  X(01).               03730000
037600         10  LQW-MULTIPLE-AUDITS-IND    PIC  X(01).               03740000
037600         10  LQW-RFID-AUDIT-IND         PIC  X(01).               03750000
037700                                                                  03760000
037800     EJECT                                                        03770000
037900*---------------------------------------------------------------* 03780000
038000*  RECORD LAYOUT FOR THE VENDOR SELECTION TEMP STORAGE QUEUE.   * 03790000
038100*---------------------------------------------------------------* 03800000
038200                                                                  03810000
038300     COPY SUWS025.                                                03820000
038400                                                                  03830000
038500*  DOMAIN ITEM MODULE                                             03840000
038600     COPY XLWS001.                                                03850000
038700*                                                                 03860000
038800*----------------------------------------------------------------*03870000
038900**  SECURITY SUBROUTINE PARAMETERS                                03880000
039000*----------------------------------------------------------------*03890000
039100     COPY DPWS008.                                                03900000
039200     EJECT                                                        03910000
039300*---------------------------------------------------------------* 03920000
039400*    MAP LAYOUT                                                 * 03930000
039500*---------------------------------------------------------------* 03940000
039600                                                                  03950000
039700     COPY SUKM589.                                                03960000
039800*                                                                 03970000
039900 01  MR-OCCURS-LAYOUT                   REDEFINES  SU589AO.       03980000
040000     05  FILLER                         PIC X(285).               03990000
040100     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04000000
040200         10  MR-SELECTL                 PIC S9(04) COMP.          04010000
040300         10  MR-SELECTA                 PIC  X(01).               04020000
040400         10  MR-SELECTC                 PIC  X(01).               04030000
040500         10  MR-SELECTH                 PIC  X(01).               04040000
040600         10  MR-SELECTI                 PIC  X(01).               04050000
040700                                                                  04060000
040800         10  MR-AUDIT-NBRL              PIC S9(04) COMP.          04070000
040900         10  MR-AUDIT-NBRA              PIC  X(01).               04080000
041000         10  MR-AUDIT-NBRC              PIC  X(01).               04090000
041100         10  MR-AUDIT-NBRH              PIC  X(01).               04100000
041200         10  MR-AUDIT-NBR-X.                                      04110000
041300             15  MR-AUDIT-NBR           PIC ZZZZZZZZ9.            04120000
041400                                                                  04130000
041500         10  MR-SOURCEL                 PIC S9(04) COMP.          04140000
041600         10  MR-SOURCEA                 PIC  X(01).               04150000
041700         10  MR-SOURCEC                 PIC  X(01).               04160000
041800         10  MR-SOURCEH                 PIC  X(01).               04170000
041900         10  MR-SOURCE                  PIC  X(03).               04180000
042000                                                                  04190000
042100         10  MR-OPER-UNITL              PIC S9(04) COMP.          04200000
042200         10  MR-OPER-UNITA              PIC  X(01).               04210000
042300         10  MR-OPER-UNITC              PIC  X(01).               04220000
042400         10  MR-OPER-UNITH              PIC  X(01).               04230000
042500         10  MR-OPER-UNIT-X.                                      04240000
042600             15  MR-OPER-UNIT           PIC  ZZZ9.                04250000
042700                                                                  04260000
042800         10  MR-PO-RECEIVERL            PIC S9(04) COMP.          04270000
042900         10  MR-PO-RECEIVERA            PIC  X(01).               04280000
043000         10  MR-PO-RECEIVERC            PIC  X(01).               04290000
043100         10  MR-PO-RECEIVERH            PIC  X(01).               04300000
043200         10  MR-PO-RECEIVER             PIC X(13).                04310000
043300                                                                  04320000
043400         10  MR-LINE-PACKL              PIC S9(04) COMP.          04330000
043500         10  MR-LINE-PACKA              PIC  X(01).               04340000
043600         10  MR-LINE-PACKC              PIC  X(01).               04350000
043700         10  MR-LINE-PACKH              PIC  X(01).               04360000
043800         10  MR-LINE-PACK               PIC  X(06).               04370000
043900                                                                  04380000
044000         10  MR-SKUL                    PIC S9(04) COMP.          04390000
044100         10  MR-SKUA                    PIC  X(01).               04400000
044200         10  MR-SKUC                    PIC  X(01).               04410000
044300         10  MR-SKUH                    PIC  X(01).               04420000
044400         10  MR-SKU                     PIC  X(15).               04430000
044500                                                                  04440000
044600         10  MR-REQUEST-DATEL           PIC S9(04) COMP.          04450000
044700         10  MR-REQUEST-DATEA           PIC  X(01).               04460000
044800         10  MR-REQUEST-DATEC           PIC  X(01).               04470000
044900         10  MR-REQUEST-DATEH           PIC  X(01).               04480000
045000         10  MR-REQUEST-DATE            PIC  X(08).               04490000
045100                                                                  04500000
045200         10  MR-PROCESS-STATUSL         PIC S9(04) COMP.          04510000
045300         10  MR-PROCESS-STATUSA         PIC  X(01).               04520000
045400         10  MR-PROCESS-STATUSC         PIC  X(01).               04530000
045500         10  MR-PROCESS-STATUSH         PIC  X(01).               04540000
045600         10  MR-PROCESS-STATUS          PIC  X(05).               04550000
045700                                                                  04560000
045800         10  MR-DEFERRED-INDL           PIC S9(04) COMP.          04570000
045900         10  MR-DEFERRED-INDA           PIC  X(01).               04580000
046000         10  MR-DEFERRED-INDC           PIC  X(01).               04590000
046100         10  MR-DEFERRED-INDH           PIC  X(01).               04600000
046200         10  MR-DEFERRED-IND            PIC  X(01).               04610000
046300                                                                  04620000
046400         10  MR-MODIFIED-INDL           PIC S9(04) COMP.          04630000
046500         10  MR-MODIFIED-INDA           PIC  X(01).               04640000
046600         10  MR-MODIFIED-INDC           PIC  X(01).               04650000
046700         10  MR-MODIFIED-INDH           PIC  X(01).               04660000
046800         10  MR-MODIFIED-IND            PIC  X(01).               04670000
046900                                                                  04680000
047000     05  FILLER                         PIC X(12).                04690000
047100                                                                  04700000
047200     EJECT                                                        04710000
047300                                                                  04720000
047400***************************************************************** 04730000
047500*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04740000
047600*             LOCATION MODULE (XLKUT071)                        * 04750000
047700***************************************************************** 04760000
047800     COPY XLWS071.                                                04770000
047900                                                                  04780000
048000*---------------------------------------------------------------* 04790000
048100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04800000
048200*---------------------------------------------------------------* 04810000
048300                                                                  04820000
048400     COPY DPWS015.                                                04830000
048500                                                                  04840000
048600*---------------------------------------------------------------* 04850000
048700*    FUNCTION KEYS COPYBOOK.                                    * 04860000
048800*---------------------------------------------------------------* 04870000
048900                                                                  04880000
049000     COPY DPWS016.                                                04890000
049100                                                                  04900000
049200*---------------------------------------------------------------* 04910000
049300*    NUMERIC EDIT LAYOUT.                                       * 04920000
049400*---------------------------------------------------------------* 04930000
049500                                                                  04940000
049600     COPY DPWS010I.                                               04950000
049700 EJECT                                                            04960000
049800*---------------------------------------------------------------* 04970000
049900*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04980023
050000*---------------------------------------------------------------* 04990000
050100                                                                  05000000
050200     COPY DPWS030.                                                05010000
050200     COPY DPWS930.                                                05011023
050300 EJECT                                                            05020000
050400*---------------------------------------------------------------* 05030000
050500*    STANDARD COMMAREA.                                         * 05040000
050600*---------------------------------------------------------------* 05050000
050700                                                                  05060000
050800     COPY DPWS020.                                                05070000
050900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05080000
051000                                                                  05090000
051100*---------------------------------------------------------------* 05100000
051200* INTER-APPLICATION COMMAREA.                                   * 05110000
051300*   SUWS023 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05120000
051400*             SPEC SCREEN.                                      * 05130000
051500*   SUWS024 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05140000
051600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05150000
051700*---------------------------------------------------------------* 05160000
051800                                                                  05170000
051900         10  INTER-APPL-COMM-AREA       PIC X(200).               05180000
052000     COPY SUWS023.                                                05190000
052100     COPY SUWS024.                                                05200000
052200*---------------------------------------------------------------* 05210000
052300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05220000
052400*---------------------------------------------------------------* 05230000
052500         10  ASC-SPECIFIC-COMMAREA.                               05240000
052600             15  ASC-LIST-KEYS.                                   05250000
052700                 20  ASC-PACKAGING-TYPE              PIC  X(02).  05260000
052800                     88  ASC-BULK-CASE          VALUE 'BC'.       05270000
052900                     88  ASC-PREPACK            VALUE 'PP'.       05280000
053000                     88  ASC-PBS                VALUE 'PS'.       05290000
053000                     88  ASC-RFID               VALUE 'RF'.       05300000
053100                 20  ASC-PROCESS-STATUS              PIC  X(01).  05310000
053200                     88  ASC-PASS               VALUE 'P'.        05320000
053300                     88  ASC-FAIL               VALUE 'F'.        05330000
053400                     88  ASC-IN-PROCESS         VALUE 'I'.        05340000
053500                     88  ASC-NOT-NEEDED         VALUE 'N'.        05350000
053600                     88  ASC-OPEN               VALUE 'O'.        05360000
053700                     88  ASC-CLOSED             VALUE 'C'.        05370000
053800                     88  ASC-ALL-TYPES          VALUE 'A'.        05380000
053900                 20  ASC-PO                          PIC  9(09).  05390000
054000                 20  ASC-RECEIVER-SEQ                PIC  9(03).  05400000
054100                 20  ASC-PO-RECEIVER.                             05410000
054200                     25  ASC-PO-NBR                  PIC X(08).   05420000
054300                     25  ASC-PO-NBR-N REDEFINES ASC-PO-NBR        05430000
054400                                                     PIC 9(08).   05440000
054500                     25  FILLER                      PIC X(01).   05450000
054600                     25  ASC-RCVR                    PIC X(04).   05460000
054700                     25  ASC-RCVR-N REDEFINES ASC-RCVR            05470000
054800                                                     PIC 9(04).   05480000
054900                 20  ASC-VENDOR-NAME                 PIC  X(30).  05490000
055000                 20  ASC-ENT-ID.                                  05500000
055100                     25  ASC-ENT-ID-N                PIC 9(09).   05510000
055200                 20  ASC-DEPARTMENT-DESC             PIC  X(30).  05520000
055300                 20  ASC-DEPT-NBR.                                05530000
055400                     25  ASC-DEPT-NBR-N              PIC  9(04).  05540000
055500                 20  ASC-AUDIT-TYPE                  PIC  X(01).  05550000
055600                 20  ASC-CURSOR-TYPE-SW              PIC X(01).   05560000
055700                 20  ASC-AUDIT-STATUS                PIC  X(01).  05570000
055800                 20  ASC-OPER-UNIT-ID.                            05580000
055900                     25  ASC-OPER-UNIT-ID-N          PIC  9(04).  05590000
056000                 20  ASC-OPER-DESC                   PIC  X(30).  05600000
056100                 20  ASC-SYS-MAN-IND                 PIC  X(01).  05610000
056200                     88  ASC-SYSTEM             VALUE 'S'.        05620000
056300                     88  ASC-MANUAL             VALUE 'M'.        05630000
056400                     88  ASC-ALL                VALUE 'A'.        05640000
056500                 20  ASC-FROM-DATE-MM                PIC  9(02).  05650000
056600                 20  ASC-FROM-DATE-DD                PIC  9(02).  05660000
056700                 20  ASC-FROM-DATE-YY                PIC  9(04).  05670000
056800                 20  ASC-TO-DATE-MM                  PIC  9(02).  05680000
056900                 20  ASC-TO-DATE-DD                  PIC  9(02).  05690000
057000                 20  ASC-TO-DATE-YY                  PIC  9(04).  05700000
057100                 20  ASC-AUDIT-NBR                   PIC  9(09).  05710000
057200                 20  ASC-CARTON-ID                   PIC  9(18).  05720000
057300                 20  ASC-CRTN-AUDT                   PIC  9(09).  05730000
057400                 20  ASC-TITLE1                      PIC X(13).   05740000
057500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05750000
057600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05760000
057700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05770000
057800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05780000
057900                                                                  05790000
058000                 20  ASC-ITEM-ARRAY.                              05800000
058100                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05810000
058200                         30  ASC-LIST-ITEM-NUMBER                 05820000
058300                                                     PIC S9(09)   05830000
058400                                                     COMP-3.      05840000
058500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05850000
058600                             88  ASC-VALID-SELECT    VALUE ' '    05860000
058700                                                           'S'    05870000
058800                                                           'B'    05880000
058900                                                           'E'.   05890000
059000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05900000
059100                             88  ASC-TEMP-SELECT     VALUE 'S'.   05910000
059200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05920000
059300                             88  ASC-TEMP-END        VALUE 'E'.   05930000
059400                         30  ASC-SELECTED-SW         PIC  X(01).  05940000
059500                             88  ASC-NO-SELECT       VALUE ' '.   05950000
059600                             88  ASC-SELECT          VALUE 'S'.   05960000
059700                             88  ASC-BEGIN           VALUE 'B'.   05970000
059800                             88  ASC-END             VALUE 'E'.   05980000
059900                         30  ASC-TBL-AUDIT-NBR       PIC S9(09)   05990000
060000                                                     COMP.        06000000
060100                         30  ASC-TBL-SOURCE          PIC  X(03).  06010000
060200                         30  ASC-TBL-OPER-UNIT       PIC S9(04)   06020000
060300                                                     COMP.        06030000
060400                         30  ASC-TBL-OPER-DESC       PIC  X(30).  06040000
060500                         30  ASC-TBL-PO-RECEIVER     PIC  X(13).  06050000
060600                         30  ASC-TBL-PACK-LINE       PIC  X(06).  06060000
060700                         30  ASC-TBL-PKG-TYPE        PIC  X(02).  06070000
060800                         30  ASC-TBL-SKU             PIC  X(15).  06080000
060900                         30  ASC-TBL-REQUEST-DATE    PIC  X(08).  06090000
061000                         30  ASC-TBL-REQUEST-MDCY    PIC  X(10).  06100000
061100                         30  ASC-TBL-REQUEST-TIME    PIC  X(05).  06110000
061200                         30  ASC-TBL-PROCESS-STATUS  PIC  X(07).  06120000
061300                         30  ASC-TBL-PROCESS-ST-CDE  PIC  X(01).  06130000
061400                         30  ASC-TBL-DEFERRED-IND    PIC  X(01).  06140000
061500                         30  ASC-TBL-MODIFIED-IND    PIC  X(01).  06150000
      *CLP 10/14/2013 BEGIN - PR5148D                                   06151000
                               30  ASC-MULTIPLE-AUDITS-IND   PIC X(01). 06152000
                                   88  ASC-MULTIPLE-AUD     VALUE 'Y'.  06153000
                                   88  ASC-NOT-MULTIPLE-AUD VALUE 'N'.  06153100
                               30  ASC-RFID-AUDIT-IND        PIC X(01). 06153200
                                   88  ASC-RFID-AUD         VALUE 'Y'.  06153300
                                   88  ASC-NOT-RFID-AUD     VALUE 'N'.  06153400
      *CLP 10/14/2013 END  - PR5148D                                    06153500
061600                                                                  06153600
061700             15  ASC-BLK-SUB                         PIC S9(04)   06153700
061800                                                          COMP    06153800
061900                                                          SYNC.   06153900
062000             15  ASC-ITEM-SUB                        PIC S9(04)   06154000
062100                                                          COMP    06155000
062200                                                          SYNC.   06156000
062300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   06157000
062400                                                          COMP-3. 06158000
062500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   06159000
062600                                                          COMP-3. 06160000
062700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06170000
062800                                                          COMP-3. 06180000
062900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06190000
063000                                                          COMP-3. 06200000
063100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06210000
063200                                                          COMP-3. 06220000
063300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06230000
063400                                                          COMP    06240000
063500                                                          SYNC.   06250000
063600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06260000
063700                                                          COMP-3. 06270000
063800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06280000
063900                                                          COMP-3. 06290000
064000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06300000
064100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06310000
064200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06320000
064300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06330000
064400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06340000
064500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06350000
064600             15  ASC-LIST-QUEUE-NAME.                             06360000
064700                 20  ASC-LIST-TERM-ID                PIC  X(04).  06370000
064800                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06380000
064900                                                          COMP-3. 06390000
065000                 20  ASC-LIST-SEQ                    PIC  9(01).  06400000
065100             15  ASC-SEL-QUEUE-NAME.                              06410000
065200                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06420000
065300                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06430000
065400                                                          COMP-3. 06440000
065500                 20  ASC-SEL-SEQ                     PIC  9(01).  06450000
065600                                                                  06460000
065700             15  ASC-SEL-QUEUE-NAME-IN.                           06470000
065800                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               06480000
065900                 20  ASC-SEL-TASK-NUMBER-IN                       06490000
066000                                      PIC S9(05) COMP-3.          06500000
066100                 20  ASC-SEL-SEQ-IN      PIC 9(01).               06510000
066200             15  ASC-USE-SELECTION-QUEUE-IND                      06520000
066300                                           PIC  X(01).            06530000
066400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06540000
066500             15  ASC-START-ITEM-REQUEST.                          06550000
066600                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06560000
066700             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    06570000
066800             15  ASC-SEL-SUB               PIC S9(04)  COMP.      06580000
066900             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      06590000
      *VSH 10/14/2013 BEGIN - PR5148D                                   06600000
000000             15  ASC-COUNT                 PIC S9(04)  COMP.      06610000
      *VSH 10/14/2013 END - PR5148D                                     06620000
067000     EJECT                                                        06630000
067100*---------------------------------------------------------------* 06640000
067200*    ABEND PROCESSING COPYBOOK.                                 * 06650000
067300*---------------------------------------------------------------* 06660000
067400                                                                  06670000
067500     COPY DPWS013.                                                06680000
067600                                                                  06690000
067700*---------------------------------------------------------------* 06700000
067800*  DCLGEN FOR THE DB2 DEPARTMENT TABLE                            06710000
067900*---------------------------------------------------------------* 06720000
068000     EXEC SQL                                                     06730000
068100         INCLUDE TVNDDPT                                          06740000
068200     END-EXEC.                                                    06750000
068300*----------------------------------------------------------------*06760000
068400*    DB2 DCLGEN FOR THE MERCHANDISE AREA TABLE                    06770000
068500*----------------------------------------------------------------*06780000
068600     EXEC SQL                                                     06790000
068700          INCLUDE TMDSEAR                                         06800000
068800     END-EXEC.                                                    06810000
068900                                                                  06820000
069000 EJECT                                                            06830000
069100*----------------------------------------------------------------*06840000
069200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  06850000
069300*  TABLE                                                          06860000
069400*----------------------------------------------------------------*06870000
069500     EXEC SQL                                                     06880000
069600         INCLUDE TSHUUPC                                          06890000
069700     END-EXEC.                                                    06900000
069800                                                                  06910000
069900*----------------------------------------------------------------*06920000
070000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT SHIPPING UPC 06930000
070100*  TABLE                                                          06940000
070200*----------------------------------------------------------------*06950000
070300     EXEC SQL                                                     06960000
070400         INCLUDE TSUAUPC                                          06970000
070500     END-EXEC.                                                    06980000
070600                                                                  06990000
070700*----------------------------------------------------------------*07000000
070800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT TABLE        07010000
070900*----------------------------------------------------------------*07020000
071000     EXEC SQL                                                     07030000
071100         INCLUDE TSUNAUD                                          07040000
071200     END-EXEC.                                                    07050000
071300*----------------------------------------------------------------*07060000
071400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT TRAN TABLE   07070000
071500*----------------------------------------------------------------*07080000
071600     EXEC SQL                                                     07090000
071700         INCLUDE TSUATRN                                          07100000
071800     END-EXEC.                                                    07110000
071900*----------------------------------------------------------------*07120000
072000*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             07130000
072100*    (SUT_PO_AUD_REQ)                                             07140000
072200*----------------------------------------------------------------*07150000
072300     EXEC SQL                                                     07160000
072400          INCLUDE SUT00015                                        07170000
072500     END-EXEC.                                                    07180000
072600*----------------------------------------------------------------*07190000
072700*    DB2 SQL COMMUNICATION AREA                                   07200000
072800*----------------------------------------------------------------*07210000
072900     EXEC SQL                                                     07220000
073000          INCLUDE SQLCA                                           07230000
073100     END-EXEC.                                                    07240000
073200                                                                  07250000
073300                                                                  07260000
073400*---------------------------------------------------------------* 07270000
073500*    CURSOR FOR ALL AUDITS FOR AN OPER ID AND STATUS            * 07280000
073600*---------------------------------------------------------------* 07290000
073700                                                                  07300000
073800*    EXEC SQL                                                     07310000
073900*        SELECT DISTINCT                                          07320000
074000*               TRN_NBR                                           07330000
074100*             , TRN_LNE_NBR                                       07340000
074200*        INTO   :SHUUPC-TRN-NBR                                   07350000
074300*             , :SHUUPC-TRN-LNE-NBR                               07360000
074400*        FROM   TSHUUPC                                           07370000
074500*        WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             07380000
074600*    END-EXEC.                                                    07390000
074700*                                                                 07400000
074800                                                                  07410000
074900     EXEC SQL                                                     07420000
075000          DECLARE ALL-SYSTEM-CSR CURSOR                           07430000
075100          FOR SELECT DISTINCT                                     07440000
075200                'A'                                               07450000
075300             ,  PO_NBR                                            07460000
075400             ,  PO_LNE_NBR                                        07470000
075500             ,  PO_PREPK_ID                                       07480000
075600             ,  PKGNG_TYP_CDE                                     07490000
075700             ,  OPER_UNT_ID                                       07500000
075800             ,  RCVR_SEQ_NBR                                      07510000
075900             ,  AUD_CNTL_NBR                                      07520000
076000             ,  AUD_STAT_CDE                                      07530000
076100             ,  DFRD_AUD_IND                                      07540000
076200             ,  AUD_ERR_PCT                                       07550000
076300             ,  CRE_TMST                                          07560000
076400             ,  MOD_QTY_IND                                       07570000
076500             ,  '  '                                              07580000
076600             ,  '99'                                              07590000
076700             ,  DATE(CRE_TMST)                                    07600000
076400             ,  RWRK_AUD_CNTL_NBR                                 07610000
076800          FROM                                                    07620000
076900                SUT_PO_AUD_REQ                                    07630000
077000          WHERE PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              07640000
077100                                      :PV-PKG-TYP-2,              07650000
077200                                      :PV-PKG-TYP-3,              07660000
077200                                      :PV-PKG-TYP-4)              07670000
077300            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            07680000
077400                                      :PV-PROC-STAT-2,            07690000
077500                                      :PV-PROC-STAT-3,            07700000
077600                                      :PV-PROC-STAT-4)            07710000
      **CLP03/18/14                                                     07720021
077700          ORDER BY PO_NBR                                         07721011
077700                  ,RCVR_SEQ_NBR                                   07722011
077800     END-EXEC.                                                    07730000
077900                                                                  07740000
078000                                                                  07750000
078100     EXEC SQL                                                     07760000
078200          DECLARE ALL-MANUAL-CSR CURSOR                           07770000
078300          FOR SELECT DISTINCT                                     07780000
078400                'B'                                               07790000
078500             ,  B.TRN_NBR                                         07800000
078600             ,  0                                                 07810000
078700             ,  0                                                 07820000
078800             ,  A.OPER_UNT_ID                                     07830000
078900             ,  B.REC_SEQ_NBR                                     07840000
079000             ,  A.AUD_CNTL_NBR                                    07850000
079100             ,  ' '                                               07860000
079200             ,  ' '                                               07870000
079300             ,  0.0                                               07880000
079400             ,  A.AUD_STRT_TMST                                   07890000
079500             ,  A.AUD_STAT_CDE                                    07900000
079600             ,  A.AUD_TYP_CDE                                     07910000
079700             ,  DATE(A.AUD_STRT_TMST)                             07920000
076400             ,  0                                                 07930000
079800          FROM                                                    07940000
079900                TSUNAUD        A                                  07950000
080000             ,  TSUATRN        B                                  07960000
080100          WHERE A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       07970000
080200                                      :DK-MAN-AUD-STATUS-2,       07980000
080300                                      :DK-MAN-AUD-STATUS-3)       07990000
080400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              08000000
080500**          AND NOT EXISTS (SELECT *                              08010000
080600**                           FROM SUT_PO_AUD_REQ C                08020000
080700**                          WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)08030000
      **CLP03/18/14                                                     08040121
080800          ORDER BY B.TRN_NBR                                      08041017
                        ,B.REC_SEQ_NBR                                  08042017
080900     END-EXEC.                                                    08050000
081000                                                                  08060000
081100                                                                  08070000
081200     EXEC SQL                                                     08080000
081300          DECLARE ALL-ALL-CSR CURSOR                              08090000
081400          FOR SELECT                                              08100000
081500                'A'                                               08110000
081600             ,  PO_NBR                                            08120000
081700             ,  PO_LNE_NBR                                        08130000
081800             ,  PO_PREPK_ID                                       08140000
081900             ,  PKGNG_TYP_CDE                                     08150000
082000             ,  OPER_UNT_ID                                       08160000
082100             ,  RCVR_SEQ_NBR                                      08170000
082200             ,  AUD_CNTL_NBR                                      08180000
082300             ,  AUD_STAT_CDE                                      08190000
082400             ,  DFRD_AUD_IND                                      08200000
082500             ,  AUD_ERR_PCT                                       08210000
082600             ,  CRE_TMST                                          08220000
082700             ,  MOD_QTY_IND                                       08230000
082800             ,  '  '                                              08240000
082900             ,  '99'                                              08250000
083000             ,  DATE(CRE_TMST)                                    08260000
076400             ,  RWRK_AUD_CNTL_NBR                                 08270000
083100          FROM                                                    08280000
083200                SUT_PO_AUD_REQ                                    08290000
083300          WHERE AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            08300000
083400                                      :PV-PROC-STAT-2,            08310000
083500                                      :PV-PROC-STAT-3,            08320000
083600                                      :PV-PROC-STAT-4)            08330000
083700            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              08340000
083800                                      :PV-PKG-TYP-2,              08350000
083900                                      :PV-PKG-TYP-3,              08360000
083900                                      :PV-PKG-TYP-4)              08370000
084000       UNION                                                      08380000
084100              SELECT DISTINCT                                     08390000
084200                'B'                                               08400000
084300             ,  B.TRN_NBR                                         08410000
084400             ,  0                                                 08420000
084500             ,  0                                                 08430000
084600             ,  ' '                                               08440000
084700             ,  A.OPER_UNT_ID                                     08450000
084800             ,  B.REC_SEQ_NBR                                     08460000
084900             ,  A.AUD_CNTL_NBR                                    08470000
085000             ,  ' '                                               08480000
085100             ,  ' '                                               08490000
085200             ,  0.0                                               08500000
085300             ,  A.AUD_STRT_TMST                                   08510000
085400             ,  ' '                                               08520000
085500             ,  A.AUD_STAT_CDE                                    08530000
085600             ,  A.AUD_TYP_CDE                                     08540000
085700             ,  DATE(A.AUD_STRT_TMST)                             08550000
                   ,  0                                                 08560000
085800          FROM                                                    08570000
085900                TSUNAUD        A                                  08580000
086000             ,  TSUATRN        B                                  08590000
086100          WHERE A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       08600000
086200                                      :DK-MAN-AUD-STATUS-2,       08610000
086300                                      :DK-MAN-AUD-STATUS-3)       08620000
086400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              08630000
086500            AND NOT EXISTS                                        08640000
086600                   (SELECT *                                      08650000
086700                       FROM SUT_PO_AUD_REQ X                      08660000
086800                       WHERE                                      08670000
086900                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        08680000
      **CLP03/18/14                                                     08690021
087200          ORDER BY 2                                              08711017
087200                  ,7                                              08712014
087300     END-EXEC.                                                    08720000
087400                                                                  08730000
087500                                                                  08740000
087600                                                                  08750000
087700     EXEC SQL                                                     08760000
087800          DECLARE OPER-STATUS-CSR CURSOR                          08770000
087900          FOR SELECT DISTINCT                                     08780000
088000                'A'                                               08790000
088100             ,  PO_NBR                                            08800000
088200             ,  PO_LNE_NBR                                        08810000
088300             ,  PO_PREPK_ID                                       08820000
088400             ,  PKGNG_TYP_CDE                                     08830000
088500             ,  OPER_UNT_ID                                       08840000
088600             ,  RCVR_SEQ_NBR                                      08850000
088700             ,  AUD_CNTL_NBR                                      08860000
088800             ,  AUD_STAT_CDE                                      08870000
088900             ,  DFRD_AUD_IND                                      08880000
089000             ,  AUD_ERR_PCT                                       08890000
089100             ,  CRE_TMST                                          08900000
089200             ,  MOD_QTY_IND                                       08910000
089300             ,  '  '                                              08920000
089400             ,  '99'                                              08930000
089500             ,  DATE(CRE_TMST)                                    08940000
076400             ,  RWRK_AUD_CNTL_NBR                                 08950000
089600          FROM                                                    08960000
089700                SUT_PO_AUD_REQ                                    08970000
089800          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               08980000
089900            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              08990000
090000                                      :PV-PKG-TYP-2,              09000000
090100                                      :PV-PKG-TYP-3,              09010000
090100                                      :PV-PKG-TYP-4)              09011000
090200            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            09012000
090300                                      :PV-PROC-STAT-2,            09013000
090400                                      :PV-PROC-STAT-3,            09014000
090500                                      :PV-PROC-STAT-4)            09015000
      **CLP03/18/14                                                     09016021
090600          ORDER BY PO_NBR                                         09016114
090600                  ,RCVR_SEQ_NBR                                   09016214
090700     END-EXEC.                                                    09017000
090800                                                                  09018000
090900     EXEC SQL                                                     09019000
091000          DECLARE OPER-CSR CURSOR                                 09020000
091100          FOR SELECT DISTINCT                                     09030000
091200                'A'                                               09040000
091300             ,  PO_NBR                                            09050000
091400             ,  PO_LNE_NBR                                        09060000
091500             ,  PO_PREPK_ID                                       09070000
091600             ,  PKGNG_TYP_CDE                                     09080000
091700             ,  OPER_UNT_ID                                       09090000
091800             ,  RCVR_SEQ_NBR                                      09100000
091900             ,  AUD_CNTL_NBR                                      09110000
092000             ,  AUD_STAT_CDE                                      09120000
092100             ,  DFRD_AUD_IND                                      09130000
092200             ,  AUD_ERR_PCT                                       09140000
092300             ,  CRE_TMST                                          09150000
092400             ,  MOD_QTY_IND                                       09160000
092500             ,  '  '                                              09170000
092600             ,  '99'                                              09180000
092700             ,  DATE(CRE_TMST)                                    09190000
076400             ,  RWRK_AUD_CNTL_NBR                                 09200000
092800          FROM                                                    09210000
092900                SUT_PO_AUD_REQ                                    09220000
093000          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               09230000
093100            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              09240000
093200                                      :PV-PKG-TYP-2,              09250000
093300                                      :PV-PKG-TYP-3,              09260000
093300                                      :PV-PKG-TYP-4)              09270000
093400            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            09280000
093500                                      :PV-PROC-STAT-2,            09290000
093600                                      :PV-PROC-STAT-3,            09300000
093700                                      :PV-PROC-STAT-4)            09310000
      **CLP03/18/14                                                     09320021
093800          ORDER BY PO_NBR                                         09321014
093800                  ,RCVR_SEQ_NBR                                   09322014
093900     END-EXEC.                                                    09330000
094000                                                                  09340000
094100     EXEC SQL                                                     09350000
094200          DECLARE OPER-STAT-DATE-CSR CURSOR                       09360000
094300          FOR SELECT                                              09370000
094400                'A'                                               09380000
094500             ,  PO_NBR                                            09390000
094600             ,  PO_LNE_NBR                                        09400000
094700             ,  PO_PREPK_ID                                       09410000
094800             ,  PKGNG_TYP_CDE                                     09420000
094900             ,  OPER_UNT_ID                                       09430000
095000             ,  RCVR_SEQ_NBR                                      09440000
095100             ,  AUD_CNTL_NBR                                      09450000
095200             ,  AUD_STAT_CDE                                      09460000
095300             ,  DFRD_AUD_IND                                      09470000
095400             ,  AUD_ERR_PCT                                       09480000
095500             ,  CRE_TMST                                          09490000
095600             ,  MOD_QTY_IND                                       09500000
095700             ,  '  '                                              09510000
095800             ,  '99'                                              09520000
095900             ,  DATE(CRE_TMST)                                    09530000
076400             ,  RWRK_AUD_CNTL_NBR                                 09540000
096000          FROM                                                    09550000
096100                SUT_PO_AUD_REQ                                    09560000
096200          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               09570000
096300            AND AUD_STAT_CDE      = :DK-AUDIT-STATUS-1            09580000
096400            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       09590000
096500            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         09600000
096600            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              09610000
096700                                      :PV-PKG-TYP-2,              09620000
096800                                      :PV-PKG-TYP-3,              09630000
096800                                      :PV-PKG-TYP-4)              09640000
096900            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            09650000
097000                                      :PV-PROC-STAT-2,            09660000
097100                                      :PV-PROC-STAT-3,            09670000
097200                                      :PV-PROC-STAT-4)            09680000
      **CLP03/18/14                                                     09690021
097400          ORDER BY PO_NBR                                         09701017
097400                  ,RCVR_SEQ_NBR                                   09702014
097500     END-EXEC.                                                    09710000
097600                                                                  09720000
097700     EXEC SQL                                                     09730000
097800          DECLARE OPER-DATE-CSR CURSOR                            09740000
097900          FOR SELECT                                              09750000
098000                'A'                                               09760000
098100             ,  PO_NBR                                            09770000
098200             ,  PO_LNE_NBR                                        09780000
098300             ,  PO_PREPK_ID                                       09790000
098400             ,  PKGNG_TYP_CDE                                     09800000
098500             ,  OPER_UNT_ID                                       09810000
098600             ,  RCVR_SEQ_NBR                                      09820000
098700             ,  AUD_CNTL_NBR                                      09830000
098800             ,  AUD_STAT_CDE                                      09840000
098900             ,  DFRD_AUD_IND                                      09850000
099000             ,  AUD_ERR_PCT                                       09860000
099100             ,  CRE_TMST                                          09870000
099200             ,  MOD_QTY_IND                                       09880000
099300             ,  '  '                                              09890000
099400             ,  '99'                                              09900000
099500             ,  DATE(CRE_TMST)                                    09910000
076400             ,  RWRK_AUD_CNTL_NBR                                 09920000
099600          FROM                                                    09930000
099700                SUT_PO_AUD_REQ                                    09940000
099800          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               09950000
099900            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       09960000
100000            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         09970000
100100            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              09980000
100200                                      :PV-PKG-TYP-2,              09990000
100300                                      :PV-PKG-TYP-3,              10000000
100300                                      :PV-PKG-TYP-4)              10010000
100400            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            10020000
100500                                      :PV-PROC-STAT-2,            10030000
100600                                      :PV-PROC-STAT-3,            10040000
100700                                      :PV-PROC-STAT-4)            10050000
      **CLP03/18/14                                                     10060021
100900          ORDER BY PO_NBR                                         10071020
100900                  ,RCVR_SEQ_NBR                                   10072014
101000     END-EXEC.                                                    10080000
101100                                                                  10090000
101200     EXEC SQL                                                     10100000
101300          DECLARE OPER-PO-RCVR-CSR CURSOR                         10110000
101400          FOR SELECT                                              10120000
101500                'A'                                               10130000
101600             ,  PO_NBR                                            10140000
101700             ,  PO_LNE_NBR                                        10150000
101800             ,  PO_PREPK_ID                                       10160000
101900             ,  PKGNG_TYP_CDE                                     10170000
102000             ,  OPER_UNT_ID                                       10180000
102100             ,  RCVR_SEQ_NBR                                      10190000
102200             ,  AUD_CNTL_NBR                                      10200000
102300             ,  AUD_STAT_CDE                                      10210000
102400             ,  DFRD_AUD_IND                                      10220000
102500             ,  AUD_ERR_PCT                                       10230000
102600             ,  CRE_TMST                                          10240000
102700             ,  MOD_QTY_IND                                       10250000
102800             ,  '  '                                              10260000
102900             ,  '99'                                              10270000
103000             ,  DATE(CRE_TMST)                                    10280000
076400             ,  RWRK_AUD_CNTL_NBR                                 10290000
103100          FROM                                                    10300000
103200                SUT_PO_AUD_REQ                                    10310000
103300          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               10320000
103400            AND PO_NBR            = :DK-PO                        10330000
103500            AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR               10340000
103600            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              10350000
103700                                      :PV-PKG-TYP-2,              10360000
103800                                      :PV-PKG-TYP-3,              10370000
103800                                      :PV-PKG-TYP-4)              10380000
103900            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            10390000
104000                                      :PV-PROC-STAT-2,            10400000
104100                                      :PV-PROC-STAT-3,            10410000
104200                                      :PV-PROC-STAT-4)            10420000
104300          ORDER BY PO_NBR                                         10430000
104400                  ,RCVR_SEQ_NBR                                   10440000
104500                  ,PO_LNE_NBR                                     10450000
104600                  ,PO_PREPK_ID                                    10460000
104700     END-EXEC.                                                    10470000
104800                                                                  10480000
104900     EXEC SQL                                                     10490000
105000          DECLARE OPER-PO-CSR CURSOR                              10500000
105100          FOR SELECT                                              10510000
105200                'A'                                               10520000
105300             ,  PO_NBR                                            10530000
105400             ,  PO_LNE_NBR                                        10540000
105500             ,  PO_PREPK_ID                                       10550000
105600             ,  PKGNG_TYP_CDE                                     10560000
105700             ,  OPER_UNT_ID                                       10570000
105800             ,  RCVR_SEQ_NBR                                      10580000
105900             ,  AUD_CNTL_NBR                                      10590000
106000             ,  AUD_STAT_CDE                                      10600000
106100             ,  DFRD_AUD_IND                                      10610000
106200             ,  AUD_ERR_PCT                                       10620000
106300             ,  CRE_TMST                                          10630000
106400             ,  MOD_QTY_IND                                       10640000
106500             ,  '  '                                              10650000
106600             ,  '99'                                              10660000
106700             ,  DATE(CRE_TMST)                                    10670000
076400             ,  RWRK_AUD_CNTL_NBR                                 10671000
106800          FROM                                                    10672000
106900                SUT_PO_AUD_REQ                                    10673000
107000          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               10674000
107100            AND PO_NBR            = :DK-PO                        10675000
107200            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            10676000
107300                                      :PV-PROC-STAT-2,            10677000
107400                                      :PV-PROC-STAT-3,            10678000
107500                                      :PV-PROC-STAT-4)            10679000
107600            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              10680000
107700                                      :PV-PKG-TYP-2,              10690000
107800                                      :PV-PKG-TYP-3,              10700000
107800                                      :PV-PKG-TYP-4)              10710000
107900          ORDER BY PO_NBR                                         10720000
108000                  ,RCVR_SEQ_NBR                                   10730000
108100                  ,PO_LNE_NBR                                     10740000
108200                  ,PO_PREPK_ID                                    10750000
108300     END-EXEC.                                                    10760000
108400                                                                  10770000
108500     EXEC SQL                                                     10780000
108600          DECLARE PO-CSR CURSOR                                   10790000
108700          FOR SELECT                                              10800000
108800                'A'                                               10810000
108900             ,  PO_NBR                                            10820000
109000             ,  PO_LNE_NBR                                        10830000
109100             ,  PO_PREPK_ID                                       10840000
109200             ,  PKGNG_TYP_CDE                                     10850000
109300             ,  OPER_UNT_ID                                       10860000
109400             ,  RCVR_SEQ_NBR                                      10870000
109500             ,  AUD_CNTL_NBR                                      10880000
109600             ,  AUD_STAT_CDE                                      10890000
109700             ,  DFRD_AUD_IND                                      10900000
109800             ,  AUD_ERR_PCT                                       10910000
109900             ,  CRE_TMST                                          10920000
110000             ,  MOD_QTY_IND                                       10930000
110100             ,  '  '                                              10940000
110200             ,  '99'                                              10950000
110300             ,  DATE(CRE_TMST)                                    10960000
076400             ,  RWRK_AUD_CNTL_NBR                                 10970000
110400          FROM                                                    10980000
110500                SUT_PO_AUD_REQ                                    10990000
110600          WHERE PO_NBR            = :DK-PO                        11000000
110700            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            11010000
110800                                      :PV-PROC-STAT-2,            11020000
110900                                      :PV-PROC-STAT-3,            11030000
111000                                      :PV-PROC-STAT-4)            11040000
111100            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              11050000
111200                                      :PV-PKG-TYP-2,              11060000
111300                                      :PV-PKG-TYP-3,              11070000
111300                                      :PV-PKG-TYP-4)              11080000
111400          ORDER BY PO_NBR                                         11090000
111500                  ,PO_LNE_NBR                                     11100000
111600                  ,OPER_UNT_ID                                    11110000
111700                  ,RCVR_SEQ_NBR                                   11120000
111800     END-EXEC.                                                    11130000
111900                                                                  11140000
112000     EXEC SQL                                                     11150000
112100          DECLARE PO-RECEIVER-CSR CURSOR                          11160000
112200          FOR SELECT                                              11170000
112300                'A'                                               11180000
112400             ,  PO_NBR                                            11190000
112500             ,  PO_LNE_NBR                                        11200000
112600             ,  PO_PREPK_ID                                       11210000
112700             ,  PKGNG_TYP_CDE                                     11220000
112800             ,  OPER_UNT_ID                                       11230000
112900             ,  RCVR_SEQ_NBR                                      11240000
113000             ,  AUD_CNTL_NBR                                      11250000
113100             ,  AUD_STAT_CDE                                      11260000
113200             ,  DFRD_AUD_IND                                      11270000
113300             ,  AUD_ERR_PCT                                       11280000
113400             ,  CRE_TMST                                          11290000
113500             ,  MOD_QTY_IND                                       11300000
113600             ,  '  '                                              11310000
113700             ,  '99'                                              11320000
113800             ,  DATE(CRE_TMST)                                    11330000
076400             ,  RWRK_AUD_CNTL_NBR                                 11340000
113900          FROM                                                    11350000
114000                SUT_PO_AUD_REQ                                    11360000
114100          WHERE PO_NBR            = :DK-PO                        11370000
114200            AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR               11380000
114300            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              11390000
114400                                      :PV-PKG-TYP-2,              11400000
114500                                      :PV-PKG-TYP-3,              11410000
114500                                      :PV-PKG-TYP-4)              11420000
114600            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            11430000
114700                                      :PV-PROC-STAT-2,            11440000
114800                                      :PV-PROC-STAT-3,            11450000
114900                                      :PV-PROC-STAT-4)            11460000
115000          ORDER BY PO_NBR                                         11470000
115100                  ,RCVR_SEQ_NBR                                   11480000
115200                  ,PO_LNE_NBR                                     11490000
115300                  ,PO_PREPK_ID                                    11500000
115400     END-EXEC.                                                    11510000
115500                                                                  11520000
115600*    ALL AUDITS FOR THIS PO/RCVR                                  11530000
115700     EXEC SQL                                                     11540000
115800          DECLARE PO-RCVR-ALL-CSR CURSOR                          11550000
115900          FOR SELECT                                              11560000
116000                'A'                                               11570000
116100             ,  PO_NBR                                            11580000
116200             ,  PO_LNE_NBR                                        11590000
116300             ,  PO_PREPK_ID                                       11600000
116400             ,  PKGNG_TYP_CDE                                     11610000
116500             ,  OPER_UNT_ID                                       11620000
116600             ,  RCVR_SEQ_NBR                                      11630000
116700             ,  AUD_CNTL_NBR                                      11640000
116800             ,  AUD_STAT_CDE                                      11650000
116900             ,  DFRD_AUD_IND                                      11660000
117000             ,  AUD_ERR_PCT                                       11670000
117100             ,  CRE_TMST                                          11680000
117200             ,  MOD_QTY_IND                                       11690000
117300             ,  '  '                                              11700000
117400             ,  '99'                                              11710000
117500             ,  DATE(CRE_TMST)                                    11720000
076400             ,  RWRK_AUD_CNTL_NBR                                 11730000
117600          FROM                                                    11740000
117700                SUT_PO_AUD_REQ    AUDR                            11750000
117800          WHERE PO_NBR            = :DK-PO                        11760000
117900            AND RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR               11770000
118000          ORDER BY PO_NBR                                         11780000
118100                  ,RCVR_SEQ_NBR                                   11790000
118200                  ,PO_LNE_NBR                                     11800000
118300                  ,PO_PREPK_ID                                    11810000
118400     END-EXEC.                                                    11820000
118500                                                                  11830000
118600     EXEC SQL                                                     11840000
118700          DECLARE ENT-CSR CURSOR                                  11850000
118800          FOR SELECT                                              11860000
118900                'A'                                               11870000
119000             ,  PO_NBR                                            11880000
119100             ,  PO_LNE_NBR                                        11890000
119200             ,  PO_PREPK_ID                                       11900000
119300             ,  PKGNG_TYP_CDE                                     11910000
119400             ,  OPER_UNT_ID                                       11920000
119500             ,  RCVR_SEQ_NBR                                      11930000
119600             ,  AUD_CNTL_NBR                                      11940000
119700             ,  AUD_STAT_CDE                                      11950000
119800             ,  DFRD_AUD_IND                                      11960000
119900             ,  AUD_ERR_PCT                                       11970000
120000             ,  CRE_TMST                                          11980000
120100             ,  MOD_QTY_IND                                       11990000
120200             ,  '  '                                              12000000
120300             ,  '99'                                              12010000
120400             ,  DATE(CRE_TMST)                                    12020000
076400             ,  RWRK_AUD_CNTL_NBR                                 12030000
120500          FROM                                                    12040000
120600                SUT_PO_AUD_REQ                                    12050000
120700          WHERE ENT_ID            = :DK-ENT-ID                    12060000
120800            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            12070000
120900                                      :PV-PROC-STAT-2,            12080000
121000                                      :PV-PROC-STAT-3,            12090000
121100                                      :PV-PROC-STAT-4)            12100000
121200            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              12110000
121300                                      :PV-PKG-TYP-2,              12120000
121400                                      :PV-PKG-TYP-3,              12130000
121400                                      :PV-PKG-TYP-4)              12140000
      **CLP03/18/14                                                     12150021
104300          ORDER BY PO_NBR                                         12151014
104400                  ,RCVR_SEQ_NBR                                   12152014
121600     END-EXEC.                                                    12160000
121700                                                                  12170000
121800     EXEC SQL                                                     12180000
121900          DECLARE OPER-ENT-ID CURSOR                              12190000
122000          FOR SELECT                                              12200000
122100                'A'                                               12210000
122200             ,  PO_NBR                                            12220000
122300             ,  PO_LNE_NBR                                        12230000
122400             ,  PO_PREPK_ID                                       12240000
122500             ,  PKGNG_TYP_CDE                                     12250000
122600             ,  OPER_UNT_ID                                       12260000
122700             ,  RCVR_SEQ_NBR                                      12270000
122800             ,  AUD_CNTL_NBR                                      12280000
122900             ,  AUD_STAT_CDE                                      12290000
123000             ,  DFRD_AUD_IND                                      12300000
123100             ,  AUD_ERR_PCT                                       12310000
123200             ,  CRE_TMST                                          12320000
123300             ,  MOD_QTY_IND                                       12330000
123400             ,  '  '                                              12340000
123500             ,  '99'                                              12350000
123600             ,  DATE(CRE_TMST)                                    12360000
076400             ,  RWRK_AUD_CNTL_NBR                                 12361000
123700          FROM                                                    12362000
123800                SUT_PO_AUD_REQ                                    12363000
123900          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               12364000
124000            AND ENT_ID            = :DK-ENT-ID                    12365000
124100            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            12366000
124200                                      :PV-PROC-STAT-2,            12367000
124300                                      :PV-PROC-STAT-3,            12368000
124400                                      :PV-PROC-STAT-4)            12369000
124500            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              12370000
124600                                      :PV-PKG-TYP-2,              12380000
124700                                      :PV-PKG-TYP-3,              12390000
124700                                      :PV-PKG-TYP-4)              12400000
      **CLP03/18/14                                                     12410021
115000          ORDER BY PO_NBR                                         12411020
115100                  ,RCVR_SEQ_NBR                                   12412003
125000     END-EXEC.                                                    12430000
125100                                                                  12440000
125200     EXEC SQL                                                     12450000
125300          DECLARE ENT-DATE-CSR CURSOR                             12460000
125400          FOR SELECT                                              12470000
125500                'A'                                               12480000
125600             ,  PO_NBR                                            12490000
125700             ,  PO_LNE_NBR                                        12500000
125800             ,  PO_PREPK_ID                                       12510000
125900             ,  PKGNG_TYP_CDE                                     12520000
126000             ,  OPER_UNT_ID                                       12530000
126100             ,  RCVR_SEQ_NBR                                      12540000
126200             ,  AUD_CNTL_NBR                                      12550000
126300             ,  AUD_STAT_CDE                                      12560000
126400             ,  DFRD_AUD_IND                                      12570000
126500             ,  AUD_ERR_PCT                                       12580000
126600             ,  CRE_TMST                                          12590000
126700             ,  MOD_QTY_IND                                       12600000
126800             ,  '  '                                              12610000
126900             ,  '99'                                              12620000
127000             ,  DATE(CRE_TMST)                                    12630000
076400             ,  RWRK_AUD_CNTL_NBR                                 12640000
127100          FROM                                                    12650000
127200                SUT_PO_AUD_REQ                                    12660000
127300          WHERE ENT_ID            = :DK-ENT-ID                    12670000
127400            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       12680000
127500            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         12690000
127600            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            12700000
127700                                      :PV-PROC-STAT-2,            12710000
127800                                      :PV-PROC-STAT-3,            12720000
127900                                      :PV-PROC-STAT-4)            12730000
128000            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              12740000
128100                                      :PV-PKG-TYP-2,              12750000
128200                                      :PV-PKG-TYP-3,              12760000
128200                                      :PV-PKG-TYP-4)              12770000
      **CLP03/18/14                                                     12780021
128400          ORDER BY PO_NBR                                         12791020
128400                  ,RCVR_SEQ_NBR                                   12792015
128500     END-EXEC.                                                    12800000
128600                                                                  12810000
128700     EXEC SQL                                                     12820000
128800          DECLARE OPER-ENT-DATE-CSR CURSOR                        12830000
128900          FOR SELECT                                              12840000
129000                'A'                                               12850000
129100             ,  PO_NBR                                            12860000
129200             ,  PO_LNE_NBR                                        12870000
129300             ,  PO_PREPK_ID                                       12880000
129400             ,  PKGNG_TYP_CDE                                     12890000
129500             ,  OPER_UNT_ID                                       12900000
129600             ,  RCVR_SEQ_NBR                                      12910000
129700             ,  AUD_CNTL_NBR                                      12920000
129800             ,  AUD_STAT_CDE                                      12930000
129900             ,  DFRD_AUD_IND                                      12940000
130000             ,  AUD_ERR_PCT                                       12950000
130100             ,  CRE_TMST                                          12960000
130200             ,  MOD_QTY_IND                                       12970000
130300             ,  '  '                                              12980000
130400             ,  '99'                                              12990000
130500             ,  DATE(CRE_TMST)                                    13000000
076400             ,  RWRK_AUD_CNTL_NBR                                 13010000
130600          FROM                                                    13020000
130700                SUT_PO_AUD_REQ                                    13030000
130800          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               13040000
130900            AND ENT_ID            = :DK-ENT-ID                    13050000
131000            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       13060000
131100            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         13070000
131200            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            13080000
131300                                      :PV-PROC-STAT-2,            13090000
131400                                      :PV-PROC-STAT-3,            13100000
131500                                      :PV-PROC-STAT-4)            13110000
131600            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              13120000
131700                                      :PV-PKG-TYP-2,              13130000
131800                                      :PV-PKG-TYP-3,              13140000
131800                                      :PV-PKG-TYP-4)              13150000
      **CLP03/18/14                                                     13160021
                ORDER BY PO_NBR                                         13161020
                        ,RCVR_SEQ_NBR                                   13162015
132200     END-EXEC.                                                    13190000
132300                                                                  13200000
132400     EXEC SQL                                                     13210000
132500          DECLARE ENT-DEPT-DATE-CSR CURSOR                        13220000
132600          FOR SELECT                                              13230000
132700                'A'                                               13240000
132800             ,  PO_NBR                                            13250000
132900             ,  PO_LNE_NBR                                        13260000
133000             ,  PO_PREPK_ID                                       13270000
133100             ,  PKGNG_TYP_CDE                                     13280000
133200             ,  OPER_UNT_ID                                       13290000
133300             ,  RCVR_SEQ_NBR                                      13300000
133400             ,  AUD_CNTL_NBR                                      13310000
133500             ,  AUD_STAT_CDE                                      13320000
133600             ,  DFRD_AUD_IND                                      13330000
133700             ,  AUD_ERR_PCT                                       13340000
133800             ,  CRE_TMST                                          13350000
133900             ,  MOD_QTY_IND                                       13360000
134000             ,  '  '                                              13370000
134100             ,  '99'                                              13380000
134200             ,  DATE(CRE_TMST)                                    13390000
076400             ,  RWRK_AUD_CNTL_NBR                                 13400000
134300          FROM                                                    13410000
134400                SUT_PO_AUD_REQ                                    13420000
134500          WHERE ENT_ID            = :DK-ENT-ID                    13430000
134600            AND DEPT_NBR          = :DK-DEPT-NBR                  13440000
134700            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       13450000
134800            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         13460000
134900            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            13470000
135000                                      :PV-PROC-STAT-2,            13480000
135100                                      :PV-PROC-STAT-3,            13490000
135200                                      :PV-PROC-STAT-4)            13500000
135300            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              13510000
135400                                      :PV-PKG-TYP-2,              13520000
135500                                      :PV-PKG-TYP-3,              13530000
135500                                      :PV-PKG-TYP-4)              13540000
      **CLP03/18/14                                                     13550021
                ORDER BY PO_NBR                                         13551020
                        ,RCVR_SEQ_NBR                                   13552015
135800     END-EXEC.                                                    13570000
135900                                                                  13580000
136000     EXEC SQL                                                     13590000
136100          DECLARE OP-ENT-DPT-DAT-CSR CURSOR                       13600000
136200          FOR SELECT                                              13610000
136300                'A'                                               13620000
136400             ,  PO_NBR                                            13630000
136500             ,  PO_LNE_NBR                                        13640000
136600             ,  PO_PREPK_ID                                       13650000
136700             ,  PKGNG_TYP_CDE                                     13660000
136800             ,  OPER_UNT_ID                                       13670000
136900             ,  RCVR_SEQ_NBR                                      13680000
137000             ,  AUD_CNTL_NBR                                      13690000
137100             ,  AUD_STAT_CDE                                      13700000
137200             ,  DFRD_AUD_IND                                      13710000
137300             ,  AUD_ERR_PCT                                       13720000
137400             ,  CRE_TMST                                          13730000
137500             ,  MOD_QTY_IND                                       13740000
137600             ,  '  '                                              13750000
137700             ,  '99'                                              13760000
137800             ,  DATE(CRE_TMST)                                    13770000
076400             ,  RWRK_AUD_CNTL_NBR                                 13780000
137900          FROM                                                    13790000
138000                SUT_PO_AUD_REQ                                    13800000
138100          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               13810000
138200            AND ENT_ID            = :DK-ENT-ID                    13820000
138300            AND DEPT_NBR          > :DK-DEPT-NBR                  13830000
138400            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       13840000
138500            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         13850000
138600            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            13860000
138700                                      :PV-PROC-STAT-2,            13870000
138800                                      :PV-PROC-STAT-3,            13880000
138900                                      :PV-PROC-STAT-4)            13890000
139000            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              13900000
139100                                      :PV-PKG-TYP-2,              13910000
139200                                      :PV-PKG-TYP-3,              13920000
139200                                      :PV-PKG-TYP-4)              13921000
      **CLP03/18/14                                                     13922021
139400          ORDER BY PO_NBR                                         13923120
139400                  ,RCVR_SEQ_NBR                                   13923215
139600     END-EXEC.                                                    13925000
139700                                                                  13926000
139800     EXEC SQL                                                     13927000
139900          DECLARE AUDIT-CSR CURSOR                                13928000
140000          FOR SELECT                                              13929000
140100                'A'                                               13930000
140200             ,  PO_NBR                                            13940000
140300             ,  PO_LNE_NBR                                        13950000
140400             ,  PO_PREPK_ID                                       13960000
140500             ,  PKGNG_TYP_CDE                                     13970000
140600             ,  OPER_UNT_ID                                       13980000
140700             ,  RCVR_SEQ_NBR                                      13990000
140800             ,  AUD_CNTL_NBR                                      14000000
140900             ,  AUD_STAT_CDE                                      14010000
141000             ,  DFRD_AUD_IND                                      14020000
141100             ,  AUD_ERR_PCT                                       14030000
141200             ,  CRE_TMST                                          14040000
141300             ,  MOD_QTY_IND                                       14050000
141400             ,  '  '                                              14060000
141500             ,  '99'                                              14070000
141600             ,  DATE(CRE_TMST)                                    14080000
076400             ,  RWRK_AUD_CNTL_NBR                                 14090000
141700          FROM                                                    14100000
141800                SUT_PO_AUD_REQ                                    14110000
141900          WHERE AUD_CNTL_NBR      = :DK-AUDIT-NBR                 14120000
      **CLP03/18/14                                                     14130021
142000          ORDER BY PO_NBR                                         14131015
142000                  ,RCVR_SEQ_NBR                                   14132015
142100     END-EXEC.                                                    14140000
142200                                                                  14150000
142300     EXEC SQL                                                     14160000
142400          DECLARE ALL-OPER-STAT-CSR CURSOR                        14170000
142500          FOR SELECT                                              14180000
142600                'A'                                               14190000
142700             ,  PO_NBR                                            14200000
142800             ,  PO_LNE_NBR                                        14210000
142900             ,  PO_PREPK_ID                                       14220000
143000             ,  PKGNG_TYP_CDE                                     14230000
143100             ,  OPER_UNT_ID                                       14240000
143200             ,  RCVR_SEQ_NBR                                      14250000
143300             ,  AUD_CNTL_NBR                                      14260000
143400             ,  AUD_STAT_CDE                                      14270000
143500             ,  DFRD_AUD_IND                                      14280000
143600             ,  AUD_ERR_PCT                                       14290000
143700             ,  CRE_TMST                                          14300000
143800             ,  MOD_QTY_IND                                       14310000
143900             ,  '  '                                              14320000
144000             ,  '99'                                              14330000
144100             ,  DATE(CRE_TMST)                                    14340000
076400             ,  RWRK_AUD_CNTL_NBR                                 14350000
144200          FROM                                                    14360000
144300                SUT_PO_AUD_REQ                                    14370000
144400          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               14380000
144500            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            14390000
144600                                      :PV-PROC-STAT-2,            14400000
144700                                      :PV-PROC-STAT-3,            14410000
144800                                      :PV-PROC-STAT-4)            14420000
144900            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              14430000
145000                                      :PV-PKG-TYP-2,              14440000
145100                                      :PV-PKG-TYP-3,              14450000
145100                                      :PV-PKG-TYP-4)              14460000
145200       UNION                                                      14470000
145300              SELECT DISTINCT                                     14480000
145400                'B'                                               14490000
145500             ,  B.TRN_NBR                                         14500000
145600             ,  0                                                 14510000
145700             ,  0                                                 14520000
145800             ,  ' '                                               14530000
145900             ,  A.OPER_UNT_ID                                     14540000
146000             ,  B.REC_SEQ_NBR                                     14550000
146100             ,  A.AUD_CNTL_NBR                                    14560000
146200             ,  ' '                                               14570000
146300             ,  ' '                                               14580000
146400             ,  0.0                                               14590000
146500             ,  A.AUD_STRT_TMST                                   14600000
146600             ,  ' '                                               14610000
146700             ,  A.AUD_STAT_CDE                                    14620000
146800             ,  A.AUD_TYP_CDE                                     14630000
146900             ,  DATE(A.AUD_STRT_TMST)                             14640000
                   ,  0                                                 14650000
147000          FROM                                                    14660000
147100                TSUNAUD        A                                  14670000
147200             ,  TSUATRN        B                                  14680000
147300          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             14690000
147400            AND A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       14700000
147500                                      :DK-MAN-AUD-STATUS-2)       14710000
147600            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              14720000
147700            AND NOT EXISTS                                        14730000
147800                   (SELECT *                                      14740000
147900                       FROM SUT_PO_AUD_REQ X                      14750000
148000                       WHERE                                      14760000
148100                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        14770000
      **CLP03/18/14                                                     14780021
                ORDER BY 2                                              14800217
148400                  ,7                                              14801017
148500     END-EXEC.                                                    14810000
148600                                                                  14820000
148700     EXEC SQL                                                     14830000
148800          DECLARE ALL-OPER-CSR CURSOR                             14840000
148900          FOR SELECT                                              14850000
149000                'A'                                               14860000
149100             ,  PO_NBR                                            14870000
149200             ,  PO_LNE_NBR                                        14880000
149300             ,  PO_PREPK_ID                                       14890000
149400             ,  PKGNG_TYP_CDE                                     14900000
149500             ,  OPER_UNT_ID                                       14910000
149600             ,  RCVR_SEQ_NBR                                      14920000
149700             ,  AUD_CNTL_NBR                                      14930000
149800             ,  AUD_STAT_CDE                                      14940000
149900             ,  DFRD_AUD_IND                                      14950000
150000             ,  AUD_ERR_PCT                                       14960000
150100             ,  CRE_TMST                                          14970000
150200             ,  MOD_QTY_IND                                       14980000
150300             ,  '  '                                              14990000
150400             ,  '99'                                              15000000
150500             ,  DATE(CRE_TMST)                                    15010000
076400             ,  RWRK_AUD_CNTL_NBR                                 15020000
150600          FROM                                                    15030000
150700                SUT_PO_AUD_REQ                                    15040000
150800          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               15050000
150900            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            15060000
151000                                      :PV-PROC-STAT-2,            15070000
151100                                      :PV-PROC-STAT-3,            15080000
151200                                      :PV-PROC-STAT-4)            15090000
151300            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              15100000
151400                                      :PV-PKG-TYP-2,              15110000
151500                                      :PV-PKG-TYP-3,              15120000
151500                                      :PV-PKG-TYP-4)              15130000
151600       UNION                                                      15140000
151700              SELECT DISTINCT                                     15150000
151800                'B'                                               15160000
151900             ,  B.TRN_NBR                                         15170000
152000             ,  0                                                 15180000
152100             ,  0                                                 15190000
152200             ,  ' '                                               15200000
152300             ,  A.OPER_UNT_ID                                     15210000
152400             ,  B.REC_SEQ_NBR                                     15220000
152500             ,  A.AUD_CNTL_NBR                                    15230000
152600             ,  ' '                                               15240000
152700             ,  ' '                                               15250000
152800             ,  0.0                                               15260000
152900             ,  A.AUD_STRT_TMST                                   15270000
153000             ,  ' '                                               15280000
153100             ,  A.AUD_STAT_CDE                                    15290000
153200             ,  A.AUD_TYP_CDE                                     15300000
153300             ,  DATE(A.AUD_STRT_TMST)                             15310000
                   ,  0                                                 15320000
153400          FROM                                                    15330000
153500                TSUNAUD        A                                  15340000
153600             ,  TSUATRN        B                                  15350000
153700          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             15360000
153800            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              15370000
153900            AND NOT EXISTS                                        15380000
154000                   (SELECT *                                      15390000
154100                       FROM SUT_PO_AUD_REQ X                      15400000
154200                       WHERE                                      15410000
154300                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        15420000
      **CLP03/18/14                                                     15430021
154500          ORDER BY 2                                              15441020
154500                  ,7                                              15442015
154600     END-EXEC.                                                    15450000
154700                                                                  15460000
154800     EXEC SQL                                                     15470000
154900          DECLARE ALL-OP-STAT-DT-CSR CURSOR                       15480000
155000          FOR SELECT                                              15490000
155100                'A'                                               15500000
155200             ,  PO_NBR                                            15510000
155300             ,  PO_LNE_NBR                                        15520000
155400             ,  PO_PREPK_ID                                       15530000
155500             ,  PKGNG_TYP_CDE                                     15540000
155600             ,  OPER_UNT_ID                                       15550000
155700             ,  RCVR_SEQ_NBR                                      15560000
155800             ,  AUD_CNTL_NBR                                      15570000
155900             ,  AUD_STAT_CDE                                      15580000
156000             ,  DFRD_AUD_IND                                      15590000
156100             ,  AUD_ERR_PCT                                       15600000
156200             ,  CRE_TMST                                          15610000
156300             ,  MOD_QTY_IND                                       15620000
156400             ,  '  '                                              15630000
156500             ,  '99'                                              15640000
156600             ,  DATE(CRE_TMST)                                    15650000
076400             ,  RWRK_AUD_CNTL_NBR                                 15660000
156700          FROM                                                    15670000
156800                SUT_PO_AUD_REQ                                    15680000
156900          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               15690000
157000            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       15700000
157100            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         15710000
157200            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            15720000
157300                                      :PV-PROC-STAT-2,            15730000
157400                                      :PV-PROC-STAT-3,            15740000
157500                                      :PV-PROC-STAT-4)            15750000
157600            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              15760000
157700                                      :PV-PKG-TYP-2,              15770000
157800                                      :PV-PKG-TYP-3,              15780000
157800                                      :PV-PKG-TYP-4)              15781000
157900       UNION                                                      15782000
158000              SELECT DISTINCT                                     15783000
158100                'B'                                               15784000
158200             ,  B.TRN_NBR                                         15785000
158300             ,  0                                                 15786000
158400             ,  0                                                 15787000
158500             ,  ' '                                               15788000
158600             ,  A.OPER_UNT_ID                                     15789000
158700             ,  B.REC_SEQ_NBR                                     15790000
158800             ,  A.AUD_CNTL_NBR                                    15800000
158900             ,  ' '                                               15810000
159000             ,  ' '                                               15820000
159100             ,  0.0                                               15830000
159200             ,  A.AUD_STRT_TMST                                   15840000
159300             ,  ' '                                               15850000
159400             ,  A.AUD_STAT_CDE                                    15860000
159500             ,  A.AUD_TYP_CDE                                     15870000
159600             ,  DATE(A.AUD_STRT_TMST)                             15880000
                   ,  0                                                 15890000
159700          FROM                                                    15900000
159800                TSUNAUD        A                                  15910000
159900             ,  TSUATRN        B                                  15920000
160000          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             15930000
160100            AND A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       15940000
160200                                      :DK-MAN-AUD-STATUS-2)       15950000
160300            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              15960000
160400            AND A.AUD_STRT_TMST    >= :DK-DATE-FROM-TIMESTAMP     15970000
160500            AND A.AUD_STRT_TMST    <= :DK-DATE-TO-TIMESTAMP       15980000
160600            AND NOT EXISTS                                        15990000
160700                   (SELECT *                                      16000000
160800                       FROM SUT_PO_AUD_REQ X                      16010000
160900                       WHERE                                      16020000
161000                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        16030000
      **CLP03/18/14                                                     16040021
161200          ORDER BY 2                                              16051020
161200                  ,7                                              16052015
161300     END-EXEC.                                                    16060000
161400                                                                  16070000
161500     EXEC SQL                                                     16080000
161600          DECLARE ALL-OPER-DTE-CSR CURSOR                         16090000
161700          FOR SELECT                                              16100000
161800                'A'                                               16110000
161900             ,  PO_NBR                                            16120000
162000             ,  PO_LNE_NBR                                        16130000
162100             ,  PO_PREPK_ID                                       16140000
162200             ,  PKGNG_TYP_CDE                                     16150000
162300             ,  OPER_UNT_ID                                       16160000
162400             ,  RCVR_SEQ_NBR                                      16170000
162500             ,  AUD_CNTL_NBR                                      16180000
162600             ,  AUD_STAT_CDE                                      16190000
162700             ,  DFRD_AUD_IND                                      16200000
162800             ,  AUD_ERR_PCT                                       16210000
162900             ,  CRE_TMST                                          16220000
163000             ,  MOD_QTY_IND                                       16230000
163100             ,  '  '                                              16240000
163200             ,  '99'                                              16250000
163300             ,  DATE(CRE_TMST)                                    16260000
076400             ,  RWRK_AUD_CNTL_NBR                                 16270000
163400          FROM                                                    16280000
163500                SUT_PO_AUD_REQ                                    16290000
163600          WHERE OPER_UNT_ID       = :DK-OPER-UNT-ID               16300000
163700            AND CRE_TMST         >= :DK-DATE-FROM-TIMESTAMP       16310000
163800            AND CRE_TMST         <= :DK-DATE-TO-TIMESTAMP         16320000
163900            AND AUD_STAT_CDE      IN (:PV-PROC-STAT-1,            16330000
164000                                      :PV-PROC-STAT-2,            16340000
164100                                      :PV-PROC-STAT-3,            16350000
164200                                      :PV-PROC-STAT-4)            16360000
164300            AND PKGNG_TYP_CDE     IN (:PV-PKG-TYP-1,              16370000
164400                                      :PV-PKG-TYP-2,              16380000
164500                                      :PV-PKG-TYP-3,              16390000
164500                                      :PV-PKG-TYP-4)              16400000
164600       UNION                                                      16410000
164700              SELECT DISTINCT                                     16420000
164800                'B'                                               16430000
164900             ,  B.TRN_NBR                                         16440000
165000             ,  0                                                 16450000
165100             ,  0                                                 16460000
165200             ,  ' '                                               16470000
165300             ,  A.OPER_UNT_ID                                     16480000
165400             ,  B.REC_SEQ_NBR                                     16490000
165500             ,  A.AUD_CNTL_NBR                                    16500000
165600             ,  ' '                                               16510000
165700             ,  ' '                                               16520000
165800             ,  0.0                                               16530000
165900             ,  A.AUD_STRT_TMST                                   16540000
166000             ,  ' '                                               16550000
166100             ,  A.AUD_STAT_CDE                                    16560000
166200             ,  A.AUD_TYP_CDE                                     16570000
166300             ,  DATE(A.AUD_STRT_TMST)                             16580000
                   ,  0                                                 16590000
166400          FROM                                                    16600000
166500                TSUNAUD        A                                  16610000
166600             ,  TSUATRN        B                                  16620000
166700          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             16630000
166800            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              16640000
166900            AND A.AUD_STRT_TMST    >= :DK-DATE-FROM-TIMESTAMP     16650000
167000            AND A.AUD_STRT_TMST    <= :DK-DATE-TO-TIMESTAMP       16660000
167100            AND NOT EXISTS                                        16670000
167200                   (SELECT *                                      16680000
167300                       FROM SUT_PO_AUD_REQ X                      16690000
167400                       WHERE                                      16700000
167500                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        16710000
      **CLP03/18/14                                                     16720021
161200          ORDER BY 2                                              16731020
161200                  ,7                                              16732015
167800     END-EXEC.                                                    16740000
167900                                                                  16750000
168000     EXEC SQL                                                     16760000
168100          DECLARE ALL-AUDIT-CSR CURSOR                            16770000
168200          FOR SELECT                                              16780000
168300                'A'                                               16790000
168400             ,  PO_NBR                                            16800000
168500             ,  PO_LNE_NBR                                        16810000
168600             ,  PO_PREPK_ID                                       16820000
168700             ,  PKGNG_TYP_CDE                                     16830000
168800             ,  OPER_UNT_ID                                       16840000
168900             ,  RCVR_SEQ_NBR                                      16850000
169000             ,  AUD_CNTL_NBR                                      16860000
169100             ,  AUD_STAT_CDE                                      16870000
169200             ,  DFRD_AUD_IND                                      16880000
169300             ,  AUD_ERR_PCT                                       16890000
169400             ,  CRE_TMST                                          16900000
169500             ,  MOD_QTY_IND                                       16910000
169600             ,  '  '                                              16920000
169700             ,  '99'                                              16930000
169800             ,  DATE(CRE_TMST)                                    16940000
076400             ,  RWRK_AUD_CNTL_NBR                                 16950000
169900          FROM                                                    16960000
170000                SUT_PO_AUD_REQ                                    16970000
170100          WHERE AUD_CNTL_NBR      = :DK-AUDIT-NBR                 16980000
170200       UNION                                                      16990000
170300              SELECT DISTINCT                                     17000000
170400                'B'                                               17010000
170500             ,  B.TRN_NBR                                         17020000
170600             ,  0                                                 17030000
170700             ,  0                                                 17040000
170800             ,  ' '                                               17050000
170900             ,  A.OPER_UNT_ID                                     17060000
171000             ,  B.REC_SEQ_NBR                                     17070000
171100             ,  A.AUD_CNTL_NBR                                    17080000
171200             ,  ' '                                               17090000
171300             ,  ' '                                               17100000
171400             ,  0.0                                               17110000
171500             ,  A.AUD_STRT_TMST                                   17120000
171600             ,  ' '                                               17130000
171700             ,  A.AUD_STAT_CDE                                    17140000
171800             ,  A.AUD_TYP_CDE                                     17150000
171900             ,  DATE(A.AUD_STRT_TMST)                             17160000
                   ,  0                                                 17170000
172000          FROM                                                    17180000
172100                TSUNAUD        A                                  17190000
172200             ,  TSUATRN        B                                  17200000
172300          WHERE A.AUD_CNTL_NBR      = :DK-AUDIT-NBR               17210000
172400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              17220000
172500            AND NOT EXISTS                                        17230000
172600                   (SELECT *                                      17240000
172700                       FROM SUT_PO_AUD_REQ X                      17250000
172800                       WHERE                                      17260000
172900                          X.AUD_CNTL_NBR = A.AUD_CNTL_NBR)        17270000
      **CLP03/18/14                                                     17280021
161200          ORDER BY 2                                              17281017
161200                  ,7                                              17282017
173100     END-EXEC.                                                    17290000
173200                                                                  17300000
173300     EXEC SQL                                                     17310000
173400          DECLARE MAN-OPER-STAT-CSR CURSOR                        17320000
173500          FOR SELECT DISTINCT                                     17330000
173600                'B'                                               17340000
173700             ,  B.TRN_NBR                                         17350000
173800             ,  0                                                 17360000
173900             ,  0                                                 17370000
174000             ,  A.OPER_UNT_ID                                     17380000
174100             ,  B.REC_SEQ_NBR                                     17390000
174200             ,  A.AUD_CNTL_NBR                                    17400000
174300             ,  ' '                                               17410000
174400             ,  ' '                                               17420000
174500             ,  0.0                                               17430000
174600             ,  A.AUD_STRT_TMST                                   17440000
174700             ,  A.AUD_STAT_CDE                                    17450000
174800             ,  A.AUD_TYP_CDE                                     17460000
174900             ,  DATE(A.AUD_STRT_TMST)                             17470000
                   ,  0                                                 17480000
175000          FROM                                                    17490000
175100                TSUNAUD        A                                  17500000
175200             ,  TSUATRN        B                                  17510000
175300          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             17520000
175400            AND A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       17530000
175500                                      :DK-MAN-AUD-STATUS-2)       17540000
175600            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              17550000
175700            AND NOT EXISTS (SELECT *                              17560000
175800                             FROM SUT_PO_AUD_REQ C                17570000
175900                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)17580000
      **CLP03/18/14                                                     17590021
176000          ORDER BY 2                                              17591017
176000                  ,7                                              17592017
176100     END-EXEC.                                                    17600000
176200                                                                  17610000
176300     EXEC SQL                                                     17620000
176400          DECLARE MAN-OPER-CSR CURSOR                             17630000
176500          FOR SELECT DISTINCT                                     17640000
176600               'B'                                                17650000
176700             ,  B.TRN_NBR                                         17660000
176800             ,  0                                                 17670000
176900             ,  0                                                 17680000
177000             ,  A.OPER_UNT_ID                                     17690000
177100             ,  B.REC_SEQ_NBR                                     17700000
177200             ,  A.AUD_CNTL_NBR                                    17710000
177300             ,  ' '                                               17720000
177400             ,  ' '                                               17730000
177500             ,  0.0                                               17740000
177600             ,  A.AUD_STRT_TMST                                   17750000
177700             ,  A.AUD_STAT_CDE                                    17760000
177800             ,  A.AUD_TYP_CDE                                     17770000
177900             ,  DATE(A.AUD_STRT_TMST)                             17780000
                   ,  0                                                 17790000
178000          FROM                                                    17800000
178100                TSUNAUD        A                                  17810000
178200             ,  TSUATRN        B                                  17820000
178300          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             17830000
178400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              17840000
178500            AND NOT EXISTS (SELECT *                              17850000
178600                             FROM SUT_PO_AUD_REQ C                17860000
178700                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)17870000
      **CLP03/18/14                                                     17880021
178800          ORDER BY 2                                              17881017
178800                  ,7                                              17882017
178900     END-EXEC.                                                    17890000
179000                                                                  17900000
179100     EXEC SQL                                                     17910000
179200          DECLARE MAN-OP-STAT-DT-CSR CURSOR                       17920000
179300          FOR SELECT DISTINCT                                     17930000
179400                'B'                                               17940000
179500             ,  B.TRN_NBR                                         17950000
179600             ,  0                                                 17960000
179700             ,  0                                                 17970000
179800             ,  A.OPER_UNT_ID                                     17980000
179900             ,  B.REC_SEQ_NBR                                     17990000
180000             ,  A.AUD_CNTL_NBR                                    18000000
180100             ,  ' '                                               18010000
180200             ,  ' '                                               18020000
180300             ,  0.0                                               18030000
180400             ,  A.AUD_STRT_TMST                                   18040000
180500             ,  A.AUD_STAT_CDE                                    18050000
180600             ,  A.AUD_TYP_CDE                                     18060000
180700             ,  DATE(A.AUD_STRT_TMST)                             18070000
                   ,  0                                                 18071000
180800          FROM                                                    18072000
180900                TSUNAUD        A                                  18073000
181000             ,  TSUATRN        B                                  18074000
181100          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             18075000
181200            AND A.AUD_STAT_CDE    IN (:DK-MAN-AUD-STATUS-1,       18076000
181300                                      :DK-MAN-AUD-STATUS-2)       18077000
181400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              18078000
181500            AND NOT EXISTS (SELECT *                              18079000
181600                             FROM SUT_PO_AUD_REQ C                18080000
181700                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)18090000
181800            AND A.AUD_STRT_TMST    >= :DK-DATE-FROM-TIMESTAMP     18100000
181900            AND A.AUD_STRT_TMST    <= :DK-DATE-TO-TIMESTAMP       18110000
      **CLP03/18/14                                                     18120021
178800          ORDER BY 2                                              18121017
178800                  ,7                                              18122017
182100     END-EXEC.                                                    18130000
182200                                                                  18140000
182300     EXEC SQL                                                     18150000
182400          DECLARE MAN-OPER-DTE-CSR CURSOR                         18160000
182500          FOR SELECT DISTINCT                                     18170000
182600                'B'                                               18180000
182700             ,  B.TRN_NBR                                         18190000
182800             ,  0                                                 18200000
182900             ,  0                                                 18210000
183000             ,  A.OPER_UNT_ID                                     18220000
183100             ,  B.REC_SEQ_NBR                                     18230000
183200             ,  A.AUD_CNTL_NBR                                    18240000
183300             ,  ' '                                               18250000
183400             ,  ' '                                               18260000
183500             ,  0.0                                               18270000
183600             ,  A.AUD_STRT_TMST                                   18280000
183700             ,  A.AUD_STAT_CDE                                    18290000
183800             ,  A.AUD_TYP_CDE                                     18300000
183900             ,  DATE(A.AUD_STRT_TMST)                             18310000
                   ,  0                                                 18320000
184000          FROM                                                    18330000
184100                TSUNAUD        A                                  18340000
184200             ,  TSUATRN        B                                  18350000
184300          WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID             18360000
184400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              18370000
184500            AND NOT EXISTS (SELECT *                              18380000
184600                             FROM SUT_PO_AUD_REQ C                18390000
184700                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)18400000
184800            AND A.AUD_STRT_TMST    >= :DK-DATE-FROM-TIMESTAMP     18410000
184900            AND A.AUD_STRT_TMST    <= :DK-DATE-TO-TIMESTAMP       18420000
      **CLP03/18/14                                                     18430021
178800          ORDER BY 2                                              18431017
178800                  ,7                                              18432017
185100     END-EXEC.                                                    18440000
185200                                                                  18450000
185300     EXEC SQL                                                     18460000
185400          DECLARE MAN-AUDIT-CSR CURSOR                            18470000
185500          FOR SELECT DISTINCT                                     18480000
185600                'B'                                               18490000
185700             ,  B.TRN_NBR                                         18500000
185800             ,  0                                                 18510000
185900             ,  0                                                 18520000
186000             ,  A.OPER_UNT_ID                                     18530000
186100             ,  B.REC_SEQ_NBR                                     18540000
186200             ,  A.AUD_CNTL_NBR                                    18550000
186300             ,  ' '                                               18560000
186400             ,  ' '                                               18570000
186500             ,  0.0                                               18580000
186600             ,  A.AUD_STRT_TMST                                   18590000
186700             ,  A.AUD_STAT_CDE                                    18600000
186800             ,  A.AUD_TYP_CDE                                     18610000
186900             ,  DATE(A.AUD_STRT_TMST)                             18620000
                   ,  0                                                 18630000
187000          FROM                                                    18640000
187100                TSUNAUD        A                                  18650000
187200             ,  TSUATRN        B                                  18660000
187300          WHERE A.AUD_CNTL_NBR      = :DK-AUDIT-NBR               18670000
187400            AND A.AUD_CNTL_NBR      = B.AUD_CNTL_NBR              18680000
187500            AND NOT EXISTS (SELECT *                              18690000
187600                             FROM SUT_PO_AUD_REQ C                18700000
187700                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)18710000
      **CLP03/18/14                                                     18720021
178800          ORDER BY 2                                              18721017
178800                  ,7                                              18722017
187900     END-EXEC.                                                    18730000
188000                                                                  18740000
188100                                                                  18750000
188200* CURSOR FOR AUDITS FOR A SPECIFIC CARTON ID                      18760000
188300     EXEC SQL                                                     18770000
188400          DECLARE ALL-CRTN-CSR CURSOR                             18780000
188500          FOR SELECT DISTINCT                                     18790000
188600                'A'                                               18800000
188700             ,  A.PO_NBR                                          18810000
188800             ,  A.PO_LNE_NBR                                      18820000
188900             ,  A.PO_PREPK_ID                                     18830000
189000             ,  A.PKGNG_TYP_CDE                                   18840000
189100             ,  A.OPER_UNT_ID                                     18850000
189200             ,  A.RCVR_SEQ_NBR                                    18860000
189300             ,  A.AUD_CNTL_NBR                                    18870000
189400             ,  A.AUD_STAT_CDE                                    18880000
189500             ,  A.DFRD_AUD_IND                                    18890000
189600             ,  A.AUD_ERR_PCT                                     18900000
189700             ,  A.CRE_TMST                                        18910000
189800             ,  A.MOD_QTY_IND                                     18920000
189900             ,  '  '                                              18930000
190000             ,  '99'                                              18940000
190100             ,  DATE(A.CRE_TMST)                                  18950000
076400             ,  RWRK_AUD_CNTL_NBR                                 18960000
190200          FROM                                                    18970000
190300                SUT_PO_AUD_REQ A                                  18980000
190400               ,TSUATRN C                                         18990000
190500          WHERE C.SHIPT_UNT_ID      =  :DK-CRTN-ID                19000000
190600            AND C.AUD_CNTL_NBR      =  A.AUD_CNTL_NBR             19010000
190700       UNION                                                      19020000
190800              SELECT DISTINCT                                     19030000
190900                'B'                                               19040000
191000             ,  B.TRN_NBR                                         19050000
191100             ,  0                                                 19060000
191200             ,  0                                                 19070000
191300             ,  ' '                                               19080000
191400             ,  A.OPER_UNT_ID                                     19090000
191500             ,  B.REC_SEQ_NBR                                     19100000
191600             ,  A.AUD_CNTL_NBR                                    19110000
191700             ,  ' '                                               19120000
191800             ,  ' '                                               19130000
191900             ,  0.0                                               19140000
192000             ,  A.AUD_STRT_TMST                                   19150000
192100             ,  ' '                                               19160000
192200             ,  A.AUD_STAT_CDE                                    19170000
192300             ,  A.AUD_TYP_CDE                                     19180000
192400             ,  DATE(A.AUD_STRT_TMST)                             19190000
                   ,  0                                                 19200000
192500          FROM                                                    19210000
192600                TSUNAUD        A                                  19220000
192700             ,  TSUATRN        B                                  19230000
192800          WHERE B.SHIPT_UNT_ID      =  :DK-CRTN-ID                19240000
192900            AND B.AUD_CNTL_NBR      =  A.AUD_CNTL_NBR             19250000
193000            AND B.AUD_CNTL_NBR NOT IN (                           19260000
193100                    SELECT DISTINCT                               19270000
193200                           E.AUD_CNTL_NBR                         19280000
193300                      FROM                                        19290000
193400                           SUT_PO_AUD_REQ E                       19300000
193500                          ,TSUATRN F                              19310000
193600                     WHERE F.SHIPT_UNT_ID  =  :DK-CRTN-ID         19320000
193700                       AND F.AUD_CNTL_NBR  =  E.AUD_CNTL_NBR)     19330000
      **CLP03/18/14                                                     19340021
178800          ORDER BY 2                                              19341017
178800                  ,7                                              19342017
193900     END-EXEC.                                                    19350000
194000                                                                  19360000
194100                                                                  19370000
194200* CURSOR FOR AUDITS FOR A SPECIFIC CARTON ID & AUDIT NUMBER       19380000
194300     EXEC SQL                                                     19390000
194400          DECLARE ALL-CRTN-AUDT-CSR CURSOR                        19400000
194500          FOR SELECT DISTINCT                                     19410000
194600                'A'                                               19420000
194700             ,  A.PO_NBR                                          19430000
194800             ,  A.PO_LNE_NBR                                      19440000
194900             ,  A.PO_PREPK_ID                                     19450000
195000             ,  A.PKGNG_TYP_CDE                                   19460000
195100             ,  A.OPER_UNT_ID                                     19470000
195200             ,  A.RCVR_SEQ_NBR                                    19480000
195300             ,  A.AUD_CNTL_NBR                                    19490000
195400             ,  A.AUD_STAT_CDE                                    19500000
195500             ,  A.DFRD_AUD_IND                                    19510000
195600             ,  A.AUD_ERR_PCT                                     19520000
195700             ,  A.CRE_TMST                                        19530000
195800             ,  A.MOD_QTY_IND                                     19540000
195900             ,  '  '                                              19550000
196000             ,  '99'                                              19560000
196100             ,  DATE(A.CRE_TMST)                                  19570000
076400             ,  RWRK_AUD_CNTL_NBR                                 19580000
196200          FROM                                                    19590000
196300                SUT_PO_AUD_REQ A                                  19600000
196400               ,TSUATRN C                                         19610000
196500          WHERE C.SHIPT_UNT_ID      =  :DK-CRTN-ID                19620000
196600            AND C.AUD_CNTL_NBR      =  :DK-AUDIT-NBR              19630000
196700            AND C.AUD_CNTL_NBR      =  A.AUD_CNTL_NBR             19640000
196800       UNION                                                      19650000
196900              SELECT DISTINCT                                     19660000
197000                'B'                                               19670000
197100             ,  B.TRN_NBR                                         19680000
197200             ,  0                                                 19690000
197300             ,  0                                                 19700000
197400             ,  ' '                                               19710000
197500             ,  A.OPER_UNT_ID                                     19720000
197600             ,  B.REC_SEQ_NBR                                     19730000
197700             ,  A.AUD_CNTL_NBR                                    19740000
197800             ,  ' '                                               19750000
197900             ,  ' '                                               19760000
198000             ,  0.0                                               19770000
198100             ,  A.AUD_STRT_TMST                                   19780000
198200             ,  ' '                                               19790000
198300             ,  A.AUD_STAT_CDE                                    19800000
198400             ,  A.AUD_TYP_CDE                                     19810000
198500             ,  DATE(A.AUD_STRT_TMST)                             19820000
                   ,  0                                                 19830000
198600          FROM                                                    19840000
198700                TSUNAUD        A                                  19850000
198800             ,  TSUATRN        B                                  19860000
198900          WHERE B.SHIPT_UNT_ID      =  :DK-CRTN-ID                19870000
199000            AND B.AUD_CNTL_NBR      =  :DK-AUDIT-NBR              19880000
199100            AND B.AUD_CNTL_NBR      =  A.AUD_CNTL_NBR             19890000
199200            AND B.AUD_CNTL_NBR NOT IN (                           19900000
199300                    SELECT DISTINCT                               19910000
199400                           E.AUD_CNTL_NBR                         19920000
199500                      FROM                                        19930000
199600                           SUT_PO_AUD_REQ E                       19940000
199700                          ,TSUATRN F                              19950000
199800                     WHERE F.SHIPT_UNT_ID  =  :DK-CRTN-ID         19960000
199900                       AND F.AUD_CNTL_NBR  =  E.AUD_CNTL_NBR)     19970000
      **CLP03/18/14                                                     19980021
178800          ORDER BY 2                                              19981017
178800                  ,7                                              19982017
200100     END-EXEC.                                                    19990000
200200                                                                  20000000
200300* CURSOR FOR MANUAL AUDITS FOR A SPECIFIC CRTN ID                 20010000
200400     EXEC SQL                                                     20020000
200500          DECLARE MAN-CRTN-CSR CURSOR                             20030000
200600          FOR SELECT DISTINCT                                     20040000
200700                'B'                                               20050000
200800             ,  B.TRN_NBR                                         20060000
200900             ,  0                                                 20070000
201000             ,  0                                                 20080000
201100             ,  A.OPER_UNT_ID                                     20090000
201200             ,  B.REC_SEQ_NBR                                     20100000
201300             ,  A.AUD_CNTL_NBR                                    20110000
201400             ,  ' '                                               20120000
201500             ,  ' '                                               20130000
201600             ,  0.0                                               20140000
201700             ,  A.AUD_STRT_TMST                                   20150000
201800             ,  A.AUD_STAT_CDE                                    20160000
201900             ,  A.AUD_TYP_CDE                                     20170000
202000             ,  DATE(A.AUD_STRT_TMST)                             20180000
                   ,  0                                                 20190000
202100          FROM                                                    20200000
202200                TSUNAUD A                                         20210000
202300               ,TSUATRN B                                         20220000
202400          WHERE B.SHIPT_UNT_ID      =  :DK-CRTN-ID                20230000
202500            AND A.AUD_CNTL_NBR      =  B.AUD_CNTL_NBR             20240000
202600            AND NOT EXISTS (SELECT *                              20250000
202700                             FROM SUT_PO_AUD_REQ C                20260000
202800                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)20270000
202900     END-EXEC.                                                    20280000
203000                                                                  20290000
203100* CURSOR FOR MANUAL AUDITS FOR A SPECIFIC CRTN ID & AUDIT NUMBER  20300000
203200     EXEC SQL                                                     20310000
203300          DECLARE MAN-CRTN-AUDT-CSR CURSOR                        20320000
203400          FOR SELECT DISTINCT                                     20330000
203500                'B'                                               20340000
203600             ,  B.TRN_NBR                                         20350000
203700             ,  0                                                 20360000
203800             ,  0                                                 20370000
203900             ,  A.OPER_UNT_ID                                     20380000
204000             ,  B.REC_SEQ_NBR                                     20390000
204100             ,  A.AUD_CNTL_NBR                                    20400000
204200             ,  ' '                                               20410000
204300             ,  ' '                                               20420000
204400             ,  0.0                                               20430000
204500             ,  A.AUD_STRT_TMST                                   20440000
204600             ,  A.AUD_STAT_CDE                                    20450000
204700             ,  A.AUD_TYP_CDE                                     20460000
204800             ,  DATE(A.AUD_STRT_TMST)                             20470000
                   ,  0                                                 20480000
204900          FROM                                                    20490000
205000                TSUNAUD A                                         20500000
205100               ,TSUATRN B                                         20510000
205200          WHERE B.SHIPT_UNT_ID      =  :DK-CRTN-ID                20520000
205300            AND B.AUD_CNTL_NBR      =  :DK-AUDIT-NBR              20530000
205400            AND A.AUD_CNTL_NBR      =  B.AUD_CNTL_NBR             20540000
205500            AND NOT EXISTS (SELECT *                              20550000
205600                             FROM SUT_PO_AUD_REQ C                20560000
205700                            WHERE C.AUD_CNTL_NBR = A.AUD_CNTL_NBR)20570000
205800     END-EXEC.                                                    20580000
205900                                                                  20590000
206000                                                                  20600000
206100 EJECT                                                            20610000
206200 LINKAGE SECTION.                                                 20620000
206300                                                                  20630000
206400 01  DFHCOMMAREA.                                                 20640000
206500     05  FILLER                         OCCURS  1 TO 4072 TIMES   20650000
206600                                        DEPENDING ON EIBCALEN.    20660000
206700         10  FILLER                     PIC X.                    20670000
206800                                                                  20680000
206900 EJECT                                                            20690000
207000 PROCEDURE DIVISION.                                              20700000
207100******************************************************************20710000
207200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **20720000
207300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **20730000
207400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **20740000
207500******************************************************************20750000
207600 0000-MAIN-MODULE.                                                20760000
207700     INITIALIZE DP030-CICS-API-FIELDS.                            20770000
207800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       20780000
207900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          20790000
208000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         20800000
208100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       20810000
208200     MOVE LENGTH OF SU589AI        TO DP030-MAP-LENGTH (1).       20820000
208300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     20830000
208400     PERFORM 0001-CALL-CICS-ARCH-API.                             20840000
208500*                                                                 20850000
208600     PERFORM 1000-CONTROL-PROCESSING                              20860000
208700*                                                                 20870000
208800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     20880000
208900     PERFORM 0001-CALL-CICS-ARCH-API.                             20890000
209000                                                                  20900000
209100******************************************************************20910000
209200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **20920000
209300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **20930000
209400******************************************************************20940000
209500 0001-CALL-CICS-ARCH-API.                                         20950000
209600*    CALL 'DPKCS030' USING DFHEIBLK                               20960023
209600     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      20961023
209700                           DFHCOMMAREA                            20970000
209800                           DP030-CICS-API-FIELDS                  20980000
209900                           DP020-STANDARD-COMMAREA                20990000
210000                           SU589AI.                               21000000
210100*                                                                 21010000
210200     IF  DP030-RC-CALL-SUCCESSFUL                                 21020000
210300         CONTINUE                                                 21030000
210400     ELSE                                                         21040000
210500         SET DP013-NO-ROLLBACK                                    21050000
210600             DP013-XCTL-DISPLAY-RESTART                           21060000
210700             DP013-CICS-ABEND      TO TRUE                        21070000
210800         MOVE '0001-CALL-CICS-ARCH-API'                           21080000
210900                                   TO DP013-PARAGRAPH             21090000
211000*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX21100023
211100*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      21110023
211000         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O21111023
211100-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      21112023
211200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      21120000
211300         PERFORM DP013-0000-PROCESS-ABEND                         21130000
211400     END-IF.                                                      21140000
211500*----------------------------------------------------------------*21150000
211600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *21160000
211700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *21170000
211800*                                                                *21180000
211900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *21190000
212000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *21200000
212100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *21210000
212200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *21220000
212300*----------------------------------------------------------------*21230000
212400                                                                  21240000
212500 1000-CONTROL-PROCESSING.                                         21250000
212600                                                                  21260000
212700     EVALUATE TRUE                                                21270000
212800         WHEN DP020-NEXT-ACT-INITIAL                              21280000
212900             INITIALIZE ASC-SPECIFIC-COMMAREA                     21290000
213000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            21300000
213100                                      ASC-SEL-TERM-ID             21310000
213200             MOVE DP020-SRC-TASK-NUMBER                           21320000
213300                                   TO ASC-LIST-TASK-NUMBER        21330000
213400                                      ASC-SEL-TASK-NUMBER         21340000
213500             MOVE PC-LIST-QUEUE-SEQ                               21350000
213600                                   TO ASC-LIST-SEQ                21360000
213700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 21370000
213800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 21380000
213900***-----$TEMPLATE NOTE$-------------------------------------------21390000
214000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,21400000
214100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  21410000
214200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.21420000
214300***---------------------------------------------------------------21430000
214400             IF  PS-COMMAREA-NOT-VALID                            21440000
214500***              MOVE PC-TSYMSG-99901                             21450000
214600***                                TO DP020-MSG-NUMBER            21460000
214700***              SET DP020-MSG-FATAL                              21470000
214800***                                TO TRUE                        21480000
214900                 SET DP020-NEXT-ACT-APPL-ERROR                    21490000
215000                                   TO TRUE                        21500000
215100             ELSE                                                 21510000
215200                 PERFORM 4000-BUILD-INITIAL-PANEL                 21520000
215300             END-IF                                               21530000
215400                                                                  21540000
215500         WHEN DP020-NEXT-ACT-READ-MAP                             21550000
215600             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        21560000
215700                                   TO PV-TOP-ITEM                 21570000
215800             PERFORM 2000-PROCESS-PANEL                           21580000
215900                                                                  21590000
216000         WHEN DP020-NEXT-ACT-RETURN                               21600000
216100             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        21610000
216200                                   TO PV-TOP-ITEM                 21620000
216300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    21630000
216400             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 21640000
216500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 21650000
216600*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   21660000
216700                                                                  21670000
216800         WHEN OTHER                                               21680000
216900             SET DP013-LOGIC-ABEND TO TRUE                        21690000
217000             SET DP013-NO-ROLLBACK TO TRUE                        21700000
217100             MOVE '1000-CONTROL-PROCESSING'                       21710000
217200                                   TO DP013-PARAGRAPH             21720000
217300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    21730000
217400                                   TO DP013-MESSAGE-TEXT(1)       21740000
217500             PERFORM DP013-0000-PROCESS-ABEND                     21750000
217600     END-EVALUATE.                                                21760000
217700                                                                  21770000
217800 EJECT                                                            21780000
217900*----------------------------------------------------------------*21790000
218000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *21800000
218100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *21810000
218200*----------------------------------------------------------------*21820000
218300                                                                  21830000
218400 1100-PROCESS-INTER-APPL-COMM.                                    21840000
218500                                                                  21850000
218600     SET PS-COMMAREA-VALID         TO TRUE.                       21860000
218700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     21870000
218800     EVALUATE DP020-INT-APPL-FORMAT-IND                           21880000
218900         WHEN PC-INTER-APPL-CRIT-SPEC                             21890000
219000             MOVE SU023-OPER-UNIT-ID   TO ASC-OPER-UNIT-ID        21900000
219100             IF ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND             21910000
219200                ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND             21920000
219300                ASC-OPER-UNIT-ID NOT EQUAL '0000'                 21930000
219400                 MOVE ASC-OPER-UNIT-ID-N   TO DK-OPER-UNT-ID      21940000
219500                 PERFORM 1500-SELECT-OPER-UNIT                    21950000
219600                 IF XL071-NO-ERRORS                               21960000
219700                     MOVE XL071-LOC-NM  TO  ASC-OPER-DESC         21970000
219800                 ELSE                                             21980000
219900                     MOVE SPACES        TO  ASC-OPER-DESC         21990000
220000                 END-IF                                           22000000
220100             ELSE                                                 22010000
220200                 MOVE PC-ALL-DC        TO ASC-OPER-DESC           22020000
220300             END-IF                                               22030000
220400                                                                  22040000
220500             MOVE SU023-SYS-MAN-IND    TO ASC-SYS-MAN-IND         22050000
220600             MOVE SU023-FROM-DATE-MM   TO ASC-FROM-DATE-MM        22060000
220700             MOVE SU023-FROM-DATE-DD   TO ASC-FROM-DATE-DD        22070000
220800             MOVE SU023-FROM-DATE-YY   TO ASC-FROM-DATE-YY        22080000
220900                                                                  22090000
221000             MOVE SU023-PO             TO ASC-PO                  22100000
221100             MOVE SU023-RECEIVER-SEQ   TO ASC-RECEIVER-SEQ        22110000
221200                                                                  22120000
221300             MOVE SU023-TO-DATE-MM     TO ASC-TO-DATE-MM          22130000
221400             MOVE SU023-TO-DATE-DD     TO ASC-TO-DATE-DD          22140000
221500             MOVE SU023-TO-DATE-YY     TO ASC-TO-DATE-YY          22150000
221600                                                                  22160000
221700             MOVE SU023-ENT-ID         TO ASC-ENT-ID-N            22170000
221800                                          DK-ENT-ID               22180000
221900                                                                  22190000
222000             MOVE SU023-VENDOR-NAME    TO ASC-VENDOR-NAME         22200000
222100                                                                  22210000
222200             MOVE SU023-PROCESS-STATUS TO ASC-PROCESS-STATUS      22220000
222300                                          DK-PROCESS-STATUS       22230000
222400                                                                  22240000
222500             MOVE SU023-DEPT-NBR       TO ASC-DEPT-NBR-N          22250000
222600                                          DK-DEPT                 22260000
222700             IF SU023-ENT-ID > 0 AND                              22270000
222800                SU023-DEPT-NBR > 0                                22280000
222900                 PERFORM 1400-SELECT-DEPARTMENT                   22290000
223000                 MOVE MDSEAR-DESC      TO ASC-DEPARTMENT-DESC     22300000
223100             ELSE                                                 22310000
223200                 MOVE SPACES           TO ASC-DEPARTMENT-DESC     22320000
223300             END-IF                                               22330000
223400                                                                  22340000
223500             MOVE SU023-PACKAGING-TYPE TO ASC-PACKAGING-TYPE      22350000
223600                                          DK-PACKAGING-TYPE       22360000
223700                                                                  22370000
223800             MOVE SU023-AUDIT-TYPE     TO ASC-AUDIT-TYPE          22380000
223900             MOVE SU023-AUDIT-STATUS   TO ASC-AUDIT-STATUS        22390000
224000             MOVE SU023-AUDIT-NBR      TO ASC-AUDIT-NBR           22400000
224100             MOVE SU023-CARTON-ID      TO ASC-CARTON-ID           22410000
224200             MOVE SU023-CRTN-AUDT      TO ASC-CRTN-AUDT           22420000
224300                                                                  22430000
224400         WHEN PC-INTER-APPL-LIST                                  22440000
224500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  22450000
224600             MOVE SU024-NUMBER-OF-SELECTED-ITEMS                  22460000
224700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS22470000
224800             MOVE SU024-NUMBER-OF-TS-ITEMS                        22480000
224900                                   TO ASC-NUMBER-OF-TS-ITEMS      22490000
225000             MOVE SU024-SEL-QUEUE-NAME                            22500000
225100                                   TO ASC-SEL-QUEUE-NAME-IN       22510000
225200             PERFORM 1120-PREPARE-LIST-ENTRY                      22520000
225300                                                                  22530000
225400         WHEN PC-INTER-APPL-CHKIN                                 22540000
225500             SET ASC-USE-SELECTION-QUEUE                          22550000
225600                 PS-PO-RCVR-ALL-STATS    TO TRUE                  22560000
225700             MOVE SU024-NUMBER-OF-SELECTED-ITEMS                  22570000
225800                                   TO ASC-NUMBER-OF-SELECTED-ITEMS22580000
225900             MOVE SU024-NUMBER-OF-TS-ITEMS                        22590000
226000                                   TO ASC-NUMBER-OF-TS-ITEMS      22600000
226100             MOVE SU024-SEL-QUEUE-NAME                            22610000
226200                                   TO ASC-SEL-QUEUE-NAME-IN       22620000
226300             PERFORM 1120-PREPARE-LIST-ENTRY                      22630000
226400                                                                  22640000
226500         WHEN PC-INTER-APPL-SUSPEND                               22650000
226600             SET ASC-USE-SELECTION-QUEUE                          22660000
226700                 PS-PO-RCVR-ALL-STATS    TO TRUE                  22670000
226800             MOVE SU024-NUMBER-OF-SELECTED-ITEMS                  22680000
226900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS22690000
227000             MOVE SU024-NUMBER-OF-TS-ITEMS                        22700000
227100                                   TO ASC-NUMBER-OF-TS-ITEMS      22710000
227200             MOVE SU024-SEL-QUEUE-NAME                            22720000
227300                                   TO ASC-SEL-QUEUE-NAME-IN       22730000
227400             PERFORM 1120-PREPARE-LIST-ENTRY                      22740000
227500                                                                  22750000
227600                                                                  22760000
227700         WHEN OTHER                                               22770000
227800             IF  DP020-NAV-KEY-DATA > SPACE                       22780000
227900                 PERFORM 1110-EDIT-NAV-KEY                        22790000
228000             ELSE                                                 22800000
228100                 MOVE PC-TSYMSG-00148                             22810000
228200                                   TO DP020-MSG-NUMBER            22820000
228300                 SET DP020-MSG-FATAL                              22830000
228400                     DP020-NEXT-ACT-APPL-ERROR                    22840000
228500                                   TO TRUE                        22850000
228600             END-IF                                               22860000
228700     END-EVALUATE.                                                22870000
228800                                                                  22880000
228900******************************************************************22890000
229000** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **22900000
229100** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **22910000
229200** ACCEPTED.                                                    **22920000
229300******************************************************************22930000
229400 1110-EDIT-NAV-KEY.                                               22940000
229500     IF  ASC-ENT-ID > SPACE                                       22950000
229600         MOVE DP020-NAV-KEY-DATA   TO DP010I-UNEDITED-FIELD       22960000
229700         MOVE LENGTH OF ASC-ENT-ID                                22970000
229800                                   TO DP010I-MAXIMUM-DIGITS       22980000
229900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     22990000
230000         SET DP010I-NEGATIVE-NOT-ALLOWED                          23000000
230100                                   TO TRUE                        23010000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         23021022
263968              USING DP010I-NUMERIC-EDIT-AREA                      23022022
230300         IF  DP010I-ERROR-DETECTED                                23030000
230400             SET PS-ERROR                                         23040000
230500                 DP020-MSG-FATAL   TO TRUE                        23050000
230600*            -- INVALID DATA IN KEY FIELD ---                     23060000
230700             MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER            23070000
230800             SET DP020-NEXT-ACT-APPL-ERROR                        23080000
230900                                   TO TRUE                        23090000
231000         ELSE                                                     23100000
231100             MOVE DP010I-NUMERIC-FIELD                            23110000
231200                                   TO ASC-ENT-ID-N                23120000
231300         END-IF                                                   23130000
231400     END-IF.                                                      23140000
231500*----------------------------------------------------------------*23150000
231600* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *23160000
231700* STORAGE QUEUE PASSED FROM THE LIST.                            *23170000
231800*----------------------------------------------------------------*23180000
231900 1120-PREPARE-LIST-ENTRY.                                         23190000
232000     MOVE SU025-MAX-ITEMS          TO ASC-SEL-SUB.                23200000
232100     MOVE ZERO                     TO ASC-SEL-ITEM.               23210000
232200     PERFORM 2300-GET-NEXT-RECORD.                                23220000
232300 EJECT                                                            23230000
232400                                                                  23240000
232500                                                                  23250000
232600 1400-SELECT-DEPARTMENT.                                          23260000
232700                                                                  23270000
232800     EXEC SQL                                                     23280000
232900         SELECT A.ENT_ID                                          23290000
233000             ,  B.MDSEAR_DESC                                     23300000
233100          INTO  :VNDDPT-ENT-ID                                    23310000
233200             ,  :MDSEAR-DESC                                      23320000
233300          FROM  TVNDDPT A                                         23330000
233400             ,  TMDSEAR B                                         23340000
233500          WHERE A.ENT_ID         = :DK-ENT-ID                     23350000
233600            AND A.DEPT_NBR       = :DK-DEPT                       23360000
233700            AND A.DEPT_NBR       = B.DEPT_NBR                     23370000
233800            AND B.MDSELV_CDE     = 'DPT'                          23380000
233900            AND B.OPERCO_NBR     = '03'                           23390000
234000            AND (B.STRT_DTE     <= CURRENT DATE AND               23400000
234100                 B.END_DTE       > CURRENT DATE)                  23410000
234200     END-EXEC.                                                    23420000
234300                                                                  23430000
234400     EVALUATE TRUE                                                23440000
234500         WHEN SQLCODE = +0                                        23450000
234600             CONTINUE                                             23460000
234700                                                                  23470000
234800         WHEN SQLCODE = +100                                      23480000
234900             MOVE SPACES           TO MDSEAR-DESC                 23490000
235000                                                                  23500000
235100         WHEN SQLWARN0 NOT = SPACE                                23510000
235200         WHEN SQLCODE < +0                                        23520000
235300         WHEN SQLCODE > +0                                        23530000
235400             MOVE '1400-SELECT-DEPARTMENT'                        23540000
235500                             TO DP013-PARAGRAPH                   23550000
235600             MOVE 'VALIDATE THE DEPT NUMBER'                      23560000
235700                             TO DP013-MESSAGE-TEXT (1)            23570000
235800             MOVE SQLCA      TO DP013-SQLCA                       23580000
235900             MOVE 'TVNDDPT'  TO DP013-DB2-TABLE-NAME (1)          23590000
236000             MOVE 'TMDSEAR'  TO DP013-DB2-TABLE-NAME (1)          23600000
236100             SET DP013-DB2-ABEND                                  23610000
236200                             TO TRUE                              23620000
236300             SET DP013-XCTL-DISPLAY-RESTART                       23630000
236400                             TO TRUE                              23640000
236500             PERFORM DP013-0000-PROCESS-ABEND                     23650000
236600     END-EVALUATE.                                                23660000
236700                                                                  23670000
236800*----------------------------------------------------------------*23680000
236900*       GET THE FACILITY NAME                                    *23690000
237000*----------------------------------------------------------------*23700000
237100 1500-SELECT-OPER-UNIT.                                           23710000
237200* LOCATION HIERARCHY DOMAIN TABLE XLT00010                        23720000
237300                                                                  23730000
237400     INITIALIZE XL071-COMMAREA-REC.                               23740000
237500     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               23750000
237600                                                                  23760000
237700     CALL XL071-LOCATION-MODULE USING                             23770000
237800                                    DFHEIBLK                      23780000
237900                                    XL071-COMMAREA                23790000
238000                                    XL071-COMMAREA-REC.           23800000
238100                                                                  23810000
238200     EVALUATE TRUE                                                23820000
238300         WHEN XL071-NO-ERRORS                                     23830000
238400              CONTINUE                                            23840000
238500                                                                  23850000
238600         WHEN OTHER                                               23860000
238700              INITIALIZE PV-CICS-MSG-AREA                         23870000
238800              STRING ' SUKCS589 - CALL XLTUT071 -'                23880000
238900                     ' SQLCODE=' XL071-SQLCODE                    23890000
239000                     ' TABLE='   XL071-DB2-TABLE                  23900000
239100                                              DELIMITED BY SIZE   23910000
239200                                         INTO PV-CICS-MSG-AREA    23920000
239300              MOVE LENGTH OF PV-CICS-MSG-AREA                     23930000
239400                                        TO PV-COMMAREA-LENGTH     23940000
239500              EXEC CICS                                           23950000
239600                   WRITEQ TD                                      23960000
239700                    QUEUE  ('CSSL')                               23970000
239800                     FROM  (PV-CICS-MSG-AREA)                     23980000
239900                   LENGTH  (PV-COMMAREA-LENGTH)                   23990000
240000                     RESP  (PV-CICS-RESPONSE)                     24000000
240100              END-EXEC                                            24010000
240200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              24020000
240300              PERFORM 9900-SOFT-ABORT                             24030000
240400     END-EVALUATE.                                                24040000
240500                                                                  24050000
240600*----------------------------------------------------------------*24060000
240700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *24070000
240800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *24080000
240900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *24090000
241000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *24100000
241100* FUNCTION KEYS CAN GET THIS FAR.                                *24110000
241200*----------------------------------------------------------------*24120000
241300                                                                  24130000
241400 2000-PROCESS-PANEL.                                              24140000
241500     EVALUATE TRUE                                                24150000
241600         WHEN DP020-SRC-AID = DP016-CLEAR                         24160000
241700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    24170000
241800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   24180000
241900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24190000
242000                                                                  24200000
242100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    24210000
242200             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         24220000
242300             MOVE ASC-ENT-ID-N     TO DK-ENT-ID                   24230000
242400             MOVE ASC-DEPT-NBR-N   TO DK-AUDIT-NBR                24240000
242500             PERFORM 2050-DELETE-LIST-QUEUE                       24250000
242600             PERFORM 4000-BUILD-INITIAL-PANEL                     24260000
242700                                                                  24270000
242800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             24280000
242900             IF ASC-USE-SELECTION-QUEUE                           24290000
243000                 PERFORM 2300-GET-NEXT-RECORD                     24300000
243100                 IF PS-LIST-END                                   24310000
243200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         24320000
243300                     SET PS-NO-LIST-END TO TRUE                   24330000
243400                 ELSE                                             24340000
243500                     PERFORM 2050-DELETE-LIST-QUEUE               24350000
243600                     PERFORM 3200-RESET-ATTRIBUTES                24360000
243700             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         24370000
243800                     PERFORM 4000-BUILD-INITIAL-PANEL             24380000
243900                 END-IF                                           24390000
244000              ELSE                                                24400000
244100*                --- BOTTOM OF LIST ---                           24410000
244200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         24420000
244300                 SET DP020-MSG-INFORMATIONAL TO TRUE              24430000
244400             END-IF                                               24440000
244500                                                                  24450000
244600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             24460000
244700             IF ASC-USE-SELECTION-QUEUE                           24470000
244800                 PERFORM 2310-GET-PREV-RECORD                     24480000
244900                 IF PS-LIST-END                                   24490000
245000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         24500000
245100                     SET PS-NO-LIST-END TO TRUE                   24510000
245200                 ELSE                                             24520000
245300                     PERFORM 2050-DELETE-LIST-QUEUE               24530000
245400                     PERFORM 3200-RESET-ATTRIBUTES                24540000
245500             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         24550000
245600                     PERFORM 4000-BUILD-INITIAL-PANEL             24560000
245700                 END-IF                                           24570000
245800             ELSE                                                 24580000
245900                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         24590000
246000                 SET DP020-MSG-INFORMATIONAL TO TRUE              24600000
246100             END-IF                                               24610000
246200                                                                  24620000
246300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    24630000
246400             PERFORM 2140-DESELECT-ALL-ITEMS                      24640000
246500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24650000
246600                                                                  24660000
246700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  24670000
246800             PERFORM 2150-SELECT-ALL-ITEMS                        24680000
246900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24690000
247000                                                                  24700000
247100         WHEN OTHER                                               24710000
247200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 24720000
247300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   24730000
247400             IF  PS-NO-ERROR                                      24740000
247500                 SET DP030-CONTINUE-GO                            24750000
247600                                 TO TRUE                          24760000
247700                 PERFORM 2100-CHECK-FUNCTION-KEY                  24770000
247800             ELSE                                                 24780000
247900                 SET DP030-OVERRIDE-GO                            24790000
248000                                 TO TRUE                          24800000
248100             END-IF                                               24810000
248200     END-EVALUATE.                                                24820000
248300 EJECT                                                            24830000
248400*----------------------------------------------------------------*24840000
248500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *24850000
248600*----------------------------------------------------------------*24860000
248700 2050-DELETE-LIST-QUEUE.                                          24870000
248800                                                                  24880000
248900     EXEC CICS                                                    24890000
249000         DELETEQ TS                                               24900000
249100             QUEUE (ASC-LIST-QUEUE-NAME)                          24910000
249200             RESP  (PV-CICS-RESPONSE)                             24920000
249300     END-EXEC.                                                    24930000
249400                                                                  24940000
249500     IF (PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                   24950000
249600        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      24960000
249700         CONTINUE                                                 24970000
249800     ELSE                                                         24980000
249900         SET DP013-CICS-ABEND      TO TRUE                        24990000
250000         SET DP013-NO-ROLLBACK     TO TRUE                        25000000
250100                                                                  25010000
250200         MOVE '2050-DELETE-LIST-QUEUE'                            25020000
250300                                   TO DP013-PARAGRAPH             25030000
250400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    25040000
250500                                   TO DP013-MESSAGE-TEXT (1)      25050000
250600         PERFORM DP013-0000-PROCESS-ABEND                         25060000
250700     END-IF.                                                      25070000
250800                                                                  25080000
250900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  25090000
251000 EJECT                                                            25100000
251100*----------------------------------------------------------------*25110000
251200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*25120000
251300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *25130000
251400* CICS ARCHITECTURE API.                                         *25140000
251500*----------------------------------------------------------------*25150000
251600 2100-CHECK-FUNCTION-KEY.                                         25160000
251700     EVALUATE TRUE                                                25170000
251800                                                                  25180000
251900* F14 - SU-AUDIT RESULTS DETAIL (LOCAL-FUNC-01) - SUKCS590        25190000
252000*                                                                 25200000
252100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              25210000
252200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              25220000
252300                 INITIALIZE SU024-INTER-APPL-COMMAREA             25230000
252400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                25240000
252500                            TO SU024-NUMBER-OF-SELECTED-ITEMS     25250000
252600                 PERFORM 5000-PREPARE-SEL-QUEUE                   25260000
252700             ELSE                                                 25270000
252800                 SET DP030-OVERRIDE-GO                            25280000
252900                                   TO TRUE                        25290000
253000                 MOVE PC-TSYMSG-00057                             25300000
253100                                   TO DP020-MSG-NUMBER            25310000
253200                 SET DP020-MSG-WARNING                            25320000
253300                                   TO TRUE                        25330000
253400             END-IF                                               25340000
253500                                                                  25350000
253600* F23 - SU-AUDITED CARTON LIST (LOCAL-FUNC-02) - SUKCS591         25360000
253700*                                                                 25370000
253800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              25380000
253900                                                                  25390000
254000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              25400000
254100                 INITIALIZE SU024-INTER-APPL-COMMAREA             25410000
254200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                25420000
254300                                TO SU024-NUMBER-OF-SELECTED-ITEMS 25430000
254400                 PERFORM 5000-PREPARE-SEL-QUEUE                   25440000
254500                                                                  25450000
254600                 MOVE ASC-OPER-DESC       TO SU024-OPER-DESC      25460000
254700                 MOVE ASC-PROCESS-STATUS  TO SU024-PROCESS-STATUS 25470000
254800                 MOVE ASC-PACKAGING-TYPE  TO SU024-PACKAGING-TYPE 25480000
254900                 MOVE ASC-ENT-ID-N        TO SU024-ENT-ID         25490000
255000                 MOVE ASC-VENDOR-NAME     TO SU024-VENDOR-NAME    25500000
255100                 MOVE ASC-DEPT-NBR-N      TO SU024-DEPT-NBR       25510000
255200                 MOVE ASC-DEPARTMENT-DESC TO SU024-DEPARTMENT-DESC25520000
255300             ELSE                                                 25530000
255400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25540000
255500                 SET DP030-OVERRIDE-GO                            25550000
255600                                   TO TRUE                        25560000
255700                 MOVE PC-TSYMSG-00057                             25570000
255800                                   TO DP020-MSG-NUMBER            25580000
255900                 SET DP020-MSG-WARNING                            25590000
256000                                   TO TRUE                        25600000
256100             END-IF                                               25610000
256200                                                                  25620000
256300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  25630000
256400             MOVE +1               TO PV-TOP-ITEM                 25640000
256500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25650000
256600                                                                  25660000
256700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   25670000
256800             PERFORM 2110-BROWSE-BACKWARD                         25680000
256900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25690000
257000                                                                  25700000
257100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   25710000
257200             PERFORM 2120-BROWSE-FORWARD                          25720000
257300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25730000
257400                                                                  25740000
257500         WHEN DP020-SRC-AID = DP016-ENTER                         25750000
257600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   25760000
257700             IF  PS-ERROR                                         25770000
257800                 CONTINUE                                         25780000
257900             ELSE                                                 25790000
258000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25800000
258100             END-IF                                               25810000
258200                                                                  25820000
258300         WHEN OTHER                                               25830000
258400             PERFORM 2050-DELETE-LIST-QUEUE                       25840000
258500             MOVE ASC-CURSOR-TYPE-SW TO PS-CURSOR-TYPE-SW         25850000
258600             PERFORM 4000-BUILD-INITIAL-PANEL                     25860000
258700             PERFORM 3200-RESET-ATTRIBUTES                        25870000
258800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25880000
258900     END-EVALUATE.                                                25890000
259000                                                                  25900000
259100*----------------------------------------------------------------*25910000
259200* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     25920000
259300*----------------------------------------------------------------*25930000
259400 2105-RACF-ACCESS.                                                25940000
259500                                                                  25950000
259600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  25960000
259700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  25970000
259800                                                                  25980000
259900      EXEC CICS                                                   25990000
260000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 26000000
260100              COMMAREA (DP008-SECURITY-COMMAREA)                  26010000
260200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             26020000
260300      END-EXEC                                                    26030000
260400                                                                  26040000
260500      IF DP008-CALL-SUCCESSFUL                                    26050000
260600         IF DP008-ACCESS-ALLOWED                                  26060000
260700             SET PS-ACCESS-ALLOWED TO TRUE                        26070000
260800         ELSE                                                     26080000
260900             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    26090000
261000         END-IF                                                   26100000
261100     ELSE                                                         26110000
261200         MOVE '2105-RACF-ACCESS'                                  26120000
261300                               TO DP013-PARAGRAPH                 26130000
261400          MOVE 'UNABLE TO ACCESS CICS'                            26140000
261500                               TO DP013-MESSAGE-TEXT (1)          26150000
261600          MOVE SQLCA                 TO DP013-SQLCA               26160000
261700          SET DP013-DB2-ABEND                                     26170000
261800              DP013-XCTL-DISPLAY-RESTART                          26180000
261900                               TO TRUE                            26190000
262000          PERFORM DP013-0000-PROCESS-ABEND                        26200000
262100      END-IF.                                                     26210000
262200                                                                  26220000
262300*                                                                 26230000
262400*----------------------------------------------------------------*26240000
262500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *26250000
262600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *26260000
262700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *26270000
262800*    MESSAGE.                                                    *26280000
262900*----------------------------------------------------------------*26290000
263000                                                                  26300000
263100 2110-BROWSE-BACKWARD.                                            26310000
263200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    26320000
263300         GIVING PV-TOP-ITEM.                                      26330000
263400*                                                                 26340000
263500     IF  ((PV-TOP-ITEM < +1)                                      26350000
263600       OR (PV-TOP-ITEM = +1))                                     26360000
263700         MOVE +1                   TO PV-TOP-ITEM                 26370000
263800*        -- TOP OF LIST --                                        26380000
263900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            26390000
264000         SET DP020-MSG-INFORMATIONAL TO TRUE                      26400000
264100     END-IF.                                                      26410000
264200                                                                  26420000
264300 EJECT                                                            26430000
264400*----------------------------------------------------------------*26440000
264500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *26450000
264600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *26460000
264700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *26470000
264800*----------------------------------------------------------------*26480000
264900                                                                  26490000
265000 2120-BROWSE-FORWARD.                                             26500000
265100                                                                  26510000
265200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              26520000
265300         GIVING PV-TOP-ITEM.                                      26530000
265400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   26540000
265500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            26550000
265600                                   TO PV-TOP-ITEM                 26560000
265700*        -- BOTTOM OF LIST --                                     26570000
265800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            26580000
265900         SET DP020-MSG-INFORMATIONAL                              26590000
266000                                   TO TRUE                        26600000
266100     ELSE                                                         26610000
266200         COMPUTE PV-BOTTOM-ITEM =                                 26620000
266300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 26630000
266400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            26640000
266500*            -- BOTTOM OF LIST --                                 26650000
266600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            26660000
266700             SET DP020-MSG-INFORMATIONAL                          26670000
266800                                   TO TRUE                        26680000
266900         END-IF                                                   26690000
267000     END-IF.                                                      26700000
267100 EJECT                                                            26710000
267200*----------------------------------------------------------------*26720000
267300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *26730000
267400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *26740000
267500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *26750000
267600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *26760000
267700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *26770000
267800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *26780000
267900*----------------------------------------------------------------*26790000
268000                                                                  26800000
268100 2130-CHECK-FOR-JUMP-BROWSE.                                      26810000
268200     SET PS-NO-ERROR               TO TRUE.                       26820000
268300     IF (ASC-START-ITEM-REQUEST = SPACE)                          26830000
268400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            26840000
268500                                   TO PV-TOP-ITEM                 26850000
268600     ELSE                                                         26860000
268700         MOVE ASC-START-ITEM-REQUEST                              26870000
268800                                   TO DP010I-UNEDITED-FIELD       26880000
268900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       26890000
269000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     26900000
269100         SET DP010I-NEGATIVE-NOT-ALLOWED                          26910000
269200                                   TO TRUE                        26920000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         26931022
263968              USING DP010I-NUMERIC-EDIT-AREA                      26932022
269400                                                                  26940000
269500         IF  NOT DP010I-ERROR-DETECTED                            26950000
269600             MOVE DP010I-NUMERIC-FIELD                            26960000
269700                                   TO  ASC-START-ITEM-REQUEST-N   26970000
269800             IF  ASC-START-ITEM-REQUEST-N > ZERO                  26980000
269900                 IF  ASC-START-ITEM-REQUEST-N >                   26990000
270000                                          ASC-NUMBER-OF-ITEMS-READ27000000
270100                     MOVE SPACE TO ASC-START-ITEM-REQUEST         27010000
270200                     COMPUTE PV-TOP-ITEM =                        27020000
270300                             ASC-NUMBER-OF-ITEMS-READ             27030000
270400                             - PC-ITEMS-PER-PANEL + 1             27040000
270500                     IF  PV-TOP-ITEM < +1                         27050000
270600                         MOVE +1   TO PV-TOP-ITEM                 27060000
270700                         MOVE PC-TSYMSG-00070                     27070000
270800                                   TO DP020-MSG-NUMBER            27080000
270900                         SET DP020-MSG-INFORMATIONAL              27090000
271000                                   TO TRUE                        27100000
271100                     END-IF                                       27110000
271200                 ELSE                                             27120000
271300                     MOVE ASC-START-ITEM-REQUEST-N                27130000
271400                                   TO PV-TOP-ITEM                 27140000
271500                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      27150000
271600                     COMPUTE PV-BOTTOM-ITEM =                     27160000
271700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     27170000
271800                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ27180000
271900*                        -- BOTTOM OF LIST --                     27190000
272000                         MOVE PC-TSYMSG-00070                     27200000
272100                                   TO DP020-MSG-NUMBER            27210000
272200                         SET DP020-MSG-INFORMATIONAL              27220000
272300                                   TO TRUE                        27230000
272400                     END-IF                                       27240000
272500                 END-IF                                           27250000
272600             ELSE                                                 27260000
272700*                --- VALUE OUT OF RANGE ----                      27270000
272800                 MOVE PC-TSYMSG-00101                             27280000
272900                                   TO DP020-MSG-NUMBER            27290000
273000                 MOVE -1           TO ASTRTITL                    27300000
273100                 SET DP030-SET-CURSOR-APPL-1                      27310000
273200                                   TO TRUE                        27320000
273300                 MOVE DP015-REVERSE                               27330000
273400                                   TO ASTRTITH                    27340000
273500                 MOVE DP015-RED    TO ASTRTITC                    27350000
273600                 MOVE DP015-UNP-NUM-BRT-MDT                       27360000
273700                                   TO ASTRTITA                    27370000
273800                 SET DP020-MSG-FATAL                              27380000
273900                                   TO TRUE                        27390000
274000                 SET PS-ERROR      TO TRUE                        27400000
274100             END-IF                                               27410000
274200                                                                  27420000
274300         ELSE                                                     27430000
274400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            27440000
274500             MOVE -1               TO ASTRTITL                    27450000
274600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  27460000
274700             MOVE DP015-REVERSE    TO ASTRTITH                    27470000
274800             MOVE DP015-RED        TO ASTRTITC                    27480000
274900             MOVE DP015-UNP-NUM-BRT-MDT                           27490000
275000                                   TO ASTRTITA                    27500000
275100             SET DP020-MSG-FATAL   TO TRUE                        27510000
275200             SET PS-ERROR          TO TRUE                        27520000
275300         END-IF                                                   27530000
275400     END-IF.                                                      27540000
275500 EJECT                                                            27550000
275600*----------------------------------------------------------------*27560000
275700*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *27570000
275800*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *27580000
275900*----------------------------------------------------------------*27590000
276000 2140-DESELECT-ALL-ITEMS.                                         27600000
276100     MOVE +1                       TO ASC-BLK-SUB.                27610000
276200                                                                  27620000
276300     PERFORM 2141-CLEAR-SELECTED-INDS                             27630000
276400         VARYING ASC-ITEM-SUB                                     27640000
276500         FROM 1 BY 1                                              27650000
276600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27660000
276700                                                                  27670000
276800     ADD +1                        TO ASC-BLK-SUB.                27680000
276900                                                                  27690000
277000     PERFORM 2141-CLEAR-SELECTED-INDS                             27700000
277100         VARYING ASC-ITEM-SUB                                     27710000
277200         FROM 1 BY 1                                              27720000
277300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27730000
277400                                                                  27740000
277500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               27750000
277600                                   TO PV-LIST-ITEM-NUMBER.        27760000
277700                                                                  27770000
277800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            27780000
277900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27790000
278000                                                                  27800000
278100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     27810000
278200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      27820000
278300         MOVE +1                   TO ASC-BLK-SUB                 27830000
278400                                                                  27840000
278500         PERFORM 5100-WRITE-TEMP-STORAGE                          27850000
278600                                                                  27860000
278700         MOVE +1                   TO PV-BLOCK-NUMBER             27870000
278800                                                                  27880000
278900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         27890000
279000             PV-FIRST-BLOCK-IN-ARRAY - 1                          27900000
279100                                                                  27910000
279200         PERFORM                                                  27920000
279300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       27930000
279400                                                                  27940000
279500             PERFORM 4410-READ-TEMP-STORAGE                       27950000
279600                                                                  27960000
279700             PERFORM 2141-CLEAR-SELECTED-INDS                     27970000
279800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 27980000
279900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27990000
280000                                                                  28000000
280100             PERFORM 5100-WRITE-TEMP-STORAGE                      28010000
280200                                                                  28020000
280300             ADD +1                TO PV-BLOCK-NUMBER             28030000
280400                                                                  28040000
280500         END-PERFORM                                              28050000
280600                                                                  28060000
280700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         28070000
280800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     28080000
280900                                                                  28090000
281000         PERFORM                                                  28100000
281100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       28110000
281200                   ASC-HIGHEST-BLOCK-WRITTEN                      28120000
281300                                                                  28130000
281400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          28140000
281500                                   TO PV-BLOCK-NUMBER             28150000
281600                                                                  28160000
281700             PERFORM 4410-READ-TEMP-STORAGE                       28170000
281800                                                                  28180000
281900             PERFORM 2141-CLEAR-SELECTED-INDS                     28190000
282000                 VARYING ASC-ITEM-SUB                             28200000
282100                 FROM 1 BY 1                                      28210000
282200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28220000
282300                                                                  28230000
282400             PERFORM 5100-WRITE-TEMP-STORAGE                      28240000
282500                                                                  28250000
282600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      28260000
282700                                                                  28270000
282800         END-PERFORM                                              28280000
282900                                                                  28290000
283000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             28300000
283100                                   TO PV-BLOCK-NUMBER             28310000
283200                                                                  28320000
283300         PERFORM 4410-READ-TEMP-STORAGE                           28330000
283400     END-IF.                                                      28340000
283500                                                                  28350000
283600                                                                  28360000
283700     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 28370000
283800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.28380000
283900     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  28390000
284000                                                                  28400000
284100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        28410000
284200                                                                  28420000
284300 EJECT                                                            28430000
284400*----------------------------------------------------------------*28440000
284500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *28450000
284600*----------------------------------------------------------------*28460000
284700                                                                  28470000
284800 2141-CLEAR-SELECTED-INDS.                                        28480000
284900                                                                  28490000
285000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           28500000
285100             NOT EQUAL ZERO                                       28510000
285200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          28520000
285300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          28530000
285400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    28540000
285500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  28550000
285600                                   TO TRUE                        28560000
285700         END-IF                                                   28570000
285800     END-IF.                                                      28580000
285900                                                                  28590000
286000 EJECT                                                            28600000
286100*----------------------------------------------------------------*28610000
286200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *28620000
286300*  FOR ALL ITEMS.                                                *28630000
286400*----------------------------------------------------------------*28640000
286500                                                                  28650000
286600 2150-SELECT-ALL-ITEMS.                                           28660000
286700                                                                  28670000
286800     MOVE +1                       TO ASC-BLK-SUB.                28680000
286900                                                                  28690000
287000     PERFORM 2151-SET-SELECTED-INDS                               28700000
287100         VARYING ASC-ITEM-SUB                                     28710000
287200         FROM 1 BY 1                                              28720000
287300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 28730000
287400                                                                  28740000
287500     ADD +1                        TO ASC-BLK-SUB.                28750000
287600                                                                  28760000
287700     PERFORM 2151-SET-SELECTED-INDS                               28770000
287800         VARYING ASC-ITEM-SUB                                     28780000
287900         FROM 1 BY 1                                              28790000
288000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 28800000
288100                                                                  28810000
288200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               28820000
288300                                   TO PV-LIST-ITEM-NUMBER.        28830000
288400                                                                  28840000
288500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            28850000
288600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    28860000
288700                                                                  28870000
288800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     28880000
288900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    28890000
289000         MOVE +1                   TO ASC-BLK-SUB                 28900000
289100                                                                  28910000
289200         PERFORM 5100-WRITE-TEMP-STORAGE                          28920000
289300                                                                  28930000
289400         MOVE +1                   TO PV-BLOCK-NUMBER             28940000
289500                                                                  28950000
289600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         28960000
289700             PV-FIRST-BLOCK-IN-ARRAY - 1                          28970000
289800                                                                  28980000
289900         PERFORM                                                  28990000
290000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       29000000
290100                                                                  29010000
290200             PERFORM 4410-READ-TEMP-STORAGE                       29020000
290300                                                                  29030000
290400             PERFORM 2151-SET-SELECTED-INDS                       29040000
290500                 VARYING ASC-ITEM-SUB                             29050000
290600                 FROM 1 BY 1                                      29060000
290700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29070000
290800                                                                  29080000
290900             PERFORM 5100-WRITE-TEMP-STORAGE                      29090000
291000                                                                  29100000
291100             ADD +1                TO PV-BLOCK-NUMBER             29110000
291200                                                                  29120000
291300         END-PERFORM                                              29130000
291400                                                                  29140000
291500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         29150000
291600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     29160000
291700                                                                  29170000
291800         PERFORM                                                  29180000
291900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       29190000
292000                   ASC-HIGHEST-BLOCK-WRITTEN                      29200000
292100                                                                  29210000
292200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          29220000
292300                                   TO PV-BLOCK-NUMBER             29230000
292400                                                                  29240000
292500             PERFORM 4410-READ-TEMP-STORAGE                       29250000
292600                                                                  29260000
292700             PERFORM 2151-SET-SELECTED-INDS                       29270000
292800                 VARYING ASC-ITEM-SUB                             29280000
292900                 FROM 1 BY 1                                      29290000
293000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29300000
293100                                                                  29310000
293200             PERFORM 5100-WRITE-TEMP-STORAGE                      29320000
293300                                                                  29330000
293400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      29340000
293500                                                                  29350000
293600         END-PERFORM                                              29360000
293700                                                                  29370000
293800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             29380000
293900                                   TO PV-BLOCK-NUMBER             29390000
294000                                                                  29400000
294100         PERFORM 4410-READ-TEMP-STORAGE                           29410000
294200     END-IF.                                                      29420000
294300                                                                  29430000
294400                                                                  29440000
294500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             29450000
294600                       ASC-NUMBER-OF-SELECTED-ITEMS.              29460000
294700                                                                  29470000
294800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        29480000
294900                                                                  29490000
295000 EJECT                                                            29500000
295100*----------------------------------------------------------------*29510000
295200*    MARK EACH ITEM AS BEING SELECTED.                           *29520000
295300*----------------------------------------------------------------*29530000
295400                                                                  29540000
295500 2151-SET-SELECTED-INDS.                                          29550000
295600                                                                  29560000
295700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           29570000
295800             NOT EQUAL ZERO                                       29580000
295900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             29590000
296000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             29600000
296100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        29610000
296200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  29620000
296300                               TO  TRUE                           29630000
296400         END-IF                                                   29640000
296500     END-IF.                                                      29650000
296600******************************************************************29660000
296700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **29670000
296800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **29680000
296900******************************************************************29690000
297000 2200-MOVE-SCREEN-TO-COMMAREA.                                    29700000
297100                                                                  29710000
297200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             29720000
297300     MOVE +1                       TO PV-SUB.                     29730000
297400*                                                                 29740000
297500     PERFORM 3100-SET-SUBSCRIPTS.                                 29750000
297600     IF  ASTRTITL > ZERO                                          29760000
297700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          29770000
297800     ELSE                                                         29780000
297900         IF  ASTRTITF = DP015-ERASE-EOF                           29790000
298000             INITIALIZE ASC-START-ITEM-REQUEST                    29800000
298100         END-IF                                                   29810000
298200     END-IF.                                                      29820000
298300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          29830000
298400         VARYING PV-SUB                                           29840000
298500         FROM 1 BY 1                                              29850000
298600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      29860000
298700******************************************************************29870000
298800** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**29880000
298900******************************************************************29890000
299000 2210-MOVE-LINES-TO-COMMAREA.                                     29900000
299100     IF  MR-SELECTL (PV-SUB) > ZERO                               29910000
299200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             29920000
299300         MOVE MR-SELECTI (PV-SUB)                                 29930000
299400                                   TO ASC-TEMP-SELECTED-SW        29940000
299500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      29950000
299600     ELSE                                                         29960000
299700         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                29970000
299800                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     29980000
299900                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        29990000
300000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      30000000
300100         END-IF                                                   30010000
300200     END-IF.                                                      30020000
300300     ADD +1                        TO ASC-ITEM-SUB.               30030000
300400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30040000
300500         ADD +1                    TO ASC-BLK-SUB                 30050000
300600         MOVE +1                   TO ASC-ITEM-SUB                30060000
300700     END-IF.                                                      30070000
300800                                                                  30080000
300900 2300-GET-NEXT-RECORD.                                            30090000
301000         ADD +1                    TO ASC-SEL-SUB                 30100000
301100         IF ASC-SEL-SUB > SU025-MAX-ITEMS                         30110000
301200             ADD +1                TO ASC-SEL-ITEM                30120000
301300             MOVE +1               TO ASC-SEL-SUB                 30130000
301400         END-IF                                                   30140000
301500         IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS             30150000
301600             PERFORM 9100-READ-SEL-QUEUE                          30160000
301700             IF SU025-ITEM (ASC-SEL-SUB) > ZERO                   30170000
301800                 MOVE SU025-AUDIT-NBR (ASC-SEL-SUB)               30180000
301900                                       TO ASC-AUDIT-NBR           30190000
302000                 MOVE SU025-PO-RECEIVER (ASC-SEL-SUB)             30200000
302100                                      TO ASC-PO-RECEIVER          30210000
302200                 INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO  30220000
302300                 MOVE ASC-PO-NBR-N    TO ASC-PO                   30230000
302400                 INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO    30240000
302500                 MOVE ASC-RCVR-N      TO ASC-RECEIVER-SEQ         30250000
302600                 SET SU025-INQ (ASC-SEL-SUB)                      30260000
302700                                       TO TRUE                    30270000
302800                 PERFORM 9200-REWRITE-LIST-QUEUE                  30280000
302900             ELSE                                                 30290000
303000                 SUBTRACT +1 FROM ASC-SEL-SUB                     30300000
303100*                --- BOTTOM OF LIST ---                           30310000
303200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         30320000
303300                 SET DP020-MSG-INFORMATIONAL                      30330000
303400                                       TO TRUE                    30340000
303500             END-IF                                               30350000
303600         ELSE                                                     30360000
303700             SUBTRACT +1 FROM ASC-SEL-ITEM                        30370000
303800             MOVE SU025-MAX-ITEMS  TO ASC-SEL-SUB                 30380000
303900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            30390000
304000             SET DP020-MSG-INFORMATIONAL                          30400000
304100                                       TO TRUE                    30410000
304200         END-IF.                                                  30420000
304300                                                                  30430000
304400 2310-GET-PREV-RECORD.                                            30440000
304500     SUBTRACT +1                 FROM ASC-SEL-SUB.                30450000
304600     IF ASC-SEL-SUB < +1                                          30460000
304700         SUBTRACT +1             FROM ASC-SEL-ITEM                30470000
304800         MOVE SU025-MAX-ITEMS      TO ASC-SEL-SUB                 30480000
304900     END-IF.                                                      30490000
305000                                                                  30500000
305100     MOVE SU024-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       30510000
305200     IF ASC-SEL-ITEM > ZERO                                       30520000
305300         PERFORM 9100-READ-SEL-QUEUE                              30530000
305400         MOVE SU025-AUDIT-NBR  (ASC-SEL-SUB)                      30540000
305500                                      TO ASC-AUDIT-NBR            30550000
305600         MOVE SU025-PO-RECEIVER (ASC-SEL-SUB)                     30560000
305700                                      TO ASC-PO-RECEIVER          30570000
305800         INSPECT ASC-PO-NBR REPLACING ALL SPACES BY ZERO          30580000
305900         MOVE ASC-PO-NBR-N            TO ASC-PO                   30590000
306000         INSPECT ASC-RCVR REPLACING ALL SPACES BY ZERO            30600000
306100         MOVE ASC-RCVR-N              TO ASC-RECEIVER-SEQ         30610000
306200         SET SU025-INQ (ASC-SEL-SUB)  TO TRUE                     30620000
306300         PERFORM 5120-REWRITE-LIST-QUEUE                          30630000
306400     ELSE                                                         30640000
306500             MOVE +1 TO  ASC-SEL-SUB                              30650000
306600                         ASC-SEL-ITEM                             30660000
306700*            --- TOP OF LIST ---                                  30670000
306800             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            30680000
306900             SET DP020-MSG-INFORMATIONAL                          30690000
307000                                   TO TRUE                        30700000
307100     END-IF.                                                      30710000
307200                                                                  30720000
307300******************************************************************30730000
307400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **30740000
307500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **30750000
307600******************************************************************30760000
307700 3000-EDIT-DATA-IN-COMMAREA.                                      30770000
307800     SET PS-NO-ERROR               TO TRUE.                       30780000
307900     PERFORM 3200-RESET-ATTRIBUTES.                               30790000
308000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     30800000
308100**                                                                30810000
308200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              30820000
308300* EDITTING IS DONE FROM THE BOTTOM UP.                            30830000
308400**                                                                30840000
308500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       30850000
308600         ASC-ITEMS-DISPLAYED - 1.                                 30860000
308700     PERFORM 3100-SET-SUBSCRIPTS.                                 30870000
308800     PERFORM 3300-EDIT-SELECTIONS                                 30880000
308900         VARYING PV-SUB                                           30890000
309000         FROM PV-SUB BY -1                                        30900000
309100         UNTIL PV-SUB < +1                                        30910000
309200*                                                                 30920000
309300     IF  PS-NO-ERROR                                              30930000
309400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        30940000
309500     END-IF.                                                      30950000
309600*                                                                 30960000
309700     IF  ((PS-NO-ERROR)                                           30970000
309800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   30980000
309900       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    30990000
310000             PERFORM 3500-MARK-RANGE-AS-SELECTED                  31000000
310100     END-IF.                                                      31010000
310200 EJECT                                                            31020000
310300*----------------------------------------------------------------*31030000
310400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *31040000
310500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*31050000
310600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *31060000
310700*                                                                *31070000
310800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *31080000
310900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *31090000
311000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *31100000
311100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *31110000
311200*----------------------------------------------------------------*31120000
311300                                                                  31130000
311400 3100-SET-SUBSCRIPTS.                                             31140000
311500                                                                  31150000
311600     COMPUTE ASC-ITEM-SUB =                                       31160000
311700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        31170000
311800                                                                  31180000
311900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         31190000
312000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31200000
312100                                                                  31210000
312200         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               31220000
312300     ELSE                                                         31230000
312400         MOVE +1                     TO ASC-BLK-SUB               31240000
312500     END-IF.                                                      31250000
312600******************************************************************31260000
312700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **31270000
312800******************************************************************31280000
312900                                                                  31290000
313000 3200-RESET-ATTRIBUTES.                                           31300000
313100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   31310000
313200     MOVE DP015-GREEN              TO ASTRTITC.                   31320000
313300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   31330000
313400                                                                  31340000
313500     PERFORM                                                      31350000
313600         VARYING PV-SUB                                           31360000
313700         FROM 1 BY 1                                              31370000
313800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        31380000
313900         MOVE DP015-UNP-ALP-NOR-OFF                               31390000
314000                                   TO MR-SELECTA (PV-SUB)         31400000
314100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         31410000
314200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         31420000
314300*        MOVE DP015-UNP-ALP-NOR-OFF TO MR-LINE-PACKA (PV-SUB)     31430000
314400         MOVE DP015-ASK-NOR-OFF     TO MR-LINE-PACKA (PV-SUB)     31440000
314500     END-PERFORM.                                                 31450000
314600******************************************************************31460000
314700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **31470000
314800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **31480000
314900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **31490000
315000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **31500000
315100******************************************************************31510000
315200 3300-EDIT-SELECTIONS.                                            31520000
315300     EVALUATE TRUE                                                31530000
315400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     31540000
315500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         31550000
315600                 CONTINUE                                         31560000
315700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         31570000
315800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        31580000
315900                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   31590000
316000                 MOVE ASC-TEMP-SELECTED-SW                        31600000
316100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31610000
316200                                TO ASC-SELECTED-SW                31620000
316300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31630000
316400             END-IF                                               31640000
316500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     31650000
316600                 = SPACE                                          31660000
316700             EVALUATE TRUE                                        31670000
316800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       31680000
316900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS31690000
317000                     MOVE SPACE TO ASC-SELECTED-SW                31700000
317100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31710000
317200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        31720000
317300                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    31730000
317400                     MOVE SPACE TO ASC-SELECTED-SW                31740000
317500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31750000
317600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          31760000
317700                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      31770000
317800                     MOVE SPACE TO ASC-SELECTED-SW                31780000
317900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31790000
318000             END-EVALUATE                                         31800000
318100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           31810000
318200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31820000
318300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31830000
318400             END-IF                                               31840000
318500             PERFORM 3310-EDIT-RANGE                              31850000
318600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             31860000
318700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31870000
318800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31880000
318900             END-IF                                               31890000
319000             PERFORM 3310-EDIT-RANGE                              31900000
319100         WHEN OTHER                                               31910000
319200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           31920000
319300             SET DP020-MSG-FATAL    TO TRUE                       31930000
319400             MOVE -1                TO MR-SELECTL (PV-SUB)        31940000
319500             SET DP030-SET-CURSOR-APPL-1                          31950000
319600                                    TO TRUE                       31960000
319700             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        31970000
319800             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        31980000
319900             SET PS-ERROR TO TRUE                                 31990000
320000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            32000000
320100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     32010000
320200                 MOVE SPACE         TO ASC-SELECTED-SW            32020000
320300                                        (ASC-BLK-SUB ASC-ITEM-SUB)32030000
320400             END-IF                                               32040000
320500     END-EVALUATE.                                                32050000
320600                                                                  32060000
320700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 32070000
320800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               32080000
320900     IF  ASC-ITEM-SUB < 1                                         32090000
321000         SUBTRACT +1 FROM ASC-BLK-SUB                             32100000
321100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                32110000
321200     END-IF.                                                      32120000
321300******************************************************************32130000
321400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **32140000
321500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **32150000
321600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**32160000
321700** THE ENDING.                                                  **32170000
321800******************************************************************32180000
321900 3310-EDIT-RANGE.                                                 32190000
322000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                32200000
322100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   32210000
322200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)32220000
322300                                   TO ASC-SELECTED-SW             32230000
322400                                        (ASC-BLK-SUB ASC-ITEM-SUB)32240000
322500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 32250000
322600         ELSE                                                     32260000
322700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     32270000
322800                 CONTINUE                                         32280000
322900             ELSE                                                 32290000
323000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        32300000
323100                 MOVE PC-TSYMSG-00054                             32310000
323200                                   TO DP020-MSG-NUMBER            32320000
323300                 SET DP020-MSG-FATAL                              32330000
323400                                   TO TRUE                        32340000
323500                 MOVE -1           TO MR-SELECTL (PV-SUB)         32350000
323600                 SET DP030-SET-CURSOR-APPL-1                      32360000
323700                                   TO TRUE                        32370000
323800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         32380000
323900                 MOVE DP015-UNDERLINE                             32390000
324000                                   TO MR-SELECTH (PV-SUB)         32400000
324100                 SET PS-ERROR      TO TRUE                        32410000
324200             END-IF                                               32420000
324300         END-IF                                                   32430000
324400     ELSE                                                         32440000
324500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     32450000
324600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32460000
324700                                   TO ASC-SELECTED-SW             32470000
324800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   32480000
324900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   32490000
325000         ELSE                                                     32500000
325100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       32510000
325200                 CONTINUE                                         32520000
325300             ELSE                                                 32530000
325400*                -- ONLY ONE END-OF-RANGE ALLOWED --              32540000
325500                 MOVE PC-TSYMSG-00055                             32550000
325600                                   TO DP020-MSG-NUMBER            32560000
325700                 SET DP020-MSG-FATAL                              32570000
325800                                   TO TRUE                        32580000
325900                 MOVE -1           TO MR-SELECTL (PV-SUB)         32590000
326000                 SET DP030-SET-CURSOR-APPL-1                      32600000
326100                                   TO TRUE                        32610000
326200                 SET PS-ERROR      TO TRUE                        32620000
326300             END-IF                                               32630000
326400         END-IF                                                   32640000
326500     END-IF.                                                      32650000
326600*                                                                 32660000
326700******************************************************************32670000
326800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **32680000
326900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **32690000
327000******************************************************************32700000
327100 3400-CHECK-RANGE-SEQUENCE.                                       32710000
327200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32720000
327300       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      32730000
327400       AND  ASC-START-OF-SELECTED-RANGE >                         32740000
327500                                         ASC-END-OF-SELECTED-RANGE32750000
327600*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                32760000
327700         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 32770000
327800         SET DP020-MSG-FATAL TO TRUE                              32780000
327900         SET PS-ERROR TO TRUE                                     32790000
328000         PERFORM 3410-POSITION-AT-ERROR                           32800000
328100     END-IF.                                                      32810000
328200******************************************************************32820000
328300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **32830000
328400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **32840000
328500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **32850000
328600******************************************************************32860000
328700 3410-POSITION-AT-ERROR.                                          32870000
328800     SET DP030-SET-CURSOR-APPL-1                                  32880000
328900                                   TO TRUE.                       32890000
329000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 32900000
329100                    - PV-TOP-ITEM + 1.                            32910000
329200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32920000
329300         CONTINUE                                                 32930000
329400     ELSE                                                         32940000
329500         MOVE -1                   TO MR-SELECTL (PV-SUB)         32950000
329600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32960000
329700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         32970000
329800     END-IF.                                                      32980000
329900*                                                                 32990000
330000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   33000000
330100                    - PV-TOP-ITEM + 1.                            33010000
330200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33020000
330300         CONTINUE                                                 33030000
330400     ELSE                                                         33040000
330500         MOVE -1                   TO MR-SELECTL (PV-SUB)         33050000
330600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         33060000
330700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         33070000
330800     END-IF.                                                      33080000
330900 EJECT                                                            33090000
331000*----------------------------------------------------------------*33100000
331100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *33110000
331200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *33120000
331300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *33130000
331400*----------------------------------------------------------------*33140000
331500                                                                  33150000
331600 3500-MARK-RANGE-AS-SELECTED.                                     33160000
331700     MOVE +1                       TO  ASC-BLK-SUB.               33170000
331800     PERFORM 3510-MARK-SELECTED-INDS                              33180000
331900         VARYING ASC-ITEM-SUB                                     33190000
332000         FROM 1 BY 1                                              33200000
332100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 33210000
332200                                                                  33220000
332300     ADD +1                        TO ASC-BLK-SUB.                33230000
332400     PERFORM 3510-MARK-SELECTED-INDS                              33240000
332500         VARYING ASC-ITEM-SUB                                     33250000
332600         FROM 1 BY 1                                              33260000
332700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 33270000
332800                                                                  33280000
332900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               33290000
333000                                   TO  PV-LIST-ITEM-NUMBER.       33300000
333100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            33310000
333200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         33320000
333300               PC-ITEMS-PER-PANEL).                               33330000
333400                                                                  33340000
333500     MOVE ASC-START-OF-SELECTED-RANGE                             33350000
333600                                   TO PV-START-OF-SELECTED-RANGE. 33360000
333700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            33370000
333800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  33380000
333900               PC-ITEMS-PER-PANEL).                               33390000
334000                                                                  33400000
334100     MOVE ASC-END-OF-SELECTED-RANGE                               33410000
334200                                   TO  PV-END-OF-SELECTED-RANGE.  33420000
334300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             33430000
334400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    33440000
334500               PC-ITEMS-PER-PANEL).                               33450000
334600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             33460000
334700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             33470000
334800                                                                  33480000
334900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    33490000
335000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        33500000
335100         MOVE +1                   TO ASC-BLK-SUB                 33510000
335200         PERFORM 5100-WRITE-TEMP-STORAGE                          33520000
335300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         33530000
335400             PV-FIRST-BLOCK-IN-ARRAY - 1                          33540000
335500                                                                  33550000
335600         PERFORM                                                  33560000
335700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      33570000
335800                   PV-PREV-BLOCK-IN-ARRAY                         33580000
335900             MOVE PV-FIRST-BLOCK-IN-RANGE                         33590000
336000                                   TO PV-BLOCK-NUMBER             33600000
336100             PERFORM 4410-READ-TEMP-STORAGE                       33610000
336200             PERFORM 3510-MARK-SELECTED-INDS                      33620000
336300                 VARYING ASC-ITEM-SUB                             33630000
336400                 FROM 1 BY 1                                      33640000
336500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33650000
336600             PERFORM 5100-WRITE-TEMP-STORAGE                      33660000
336700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     33670000
336800         END-PERFORM                                              33680000
336900                                                                  33690000
337000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         33700000
337100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     33710000
337200         PERFORM                                                  33720000
337300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       33730000
337400                   PV-LAST-BLOCK-IN-RANGE                         33740000
337500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          33750000
337600                                   TO PV-BLOCK-NUMBER             33760000
337700             PERFORM 4410-READ-TEMP-STORAGE                       33770000
337800             PERFORM 3510-MARK-SELECTED-INDS                      33780000
337900                 VARYING ASC-ITEM-SUB                             33790000
338000                 FROM 1 BY 1                                      33800000
338100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33810000
338200             PERFORM 5100-WRITE-TEMP-STORAGE                      33820000
338300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      33830000
338400         END-PERFORM                                              33840000
338500                                                                  33850000
338600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             33860000
338700                                   TO PV-BLOCK-NUMBER             33870000
338800         PERFORM 4410-READ-TEMP-STORAGE                           33880000
338900     END-IF.                                                      33890000
339000                                                                  33900000
339100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 33910000
339200                                      ASC-END-OF-SELECTED-RANGE.  33920000
339300                                                                  33930000
339400 EJECT                                                            33940000
339500*----------------------------------------------------------------*33950000
339600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *33960000
339700*----------------------------------------------------------------*33970000
339800                                                                  33980000
339900 3510-MARK-SELECTED-INDS.                                         33990000
340000                                                                  34000000
340100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         34010000
340200                                ASC-ITEM-SUB) >                   34020000
340300         ASC-START-OF-SELECTED-RANGE)                             34030000
340400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         34040000
340500                                ASC-ITEM-SUB) =                   34050000
340600         ASC-START-OF-SELECTED-RANGE)                             34060000
340700                                                                  34070000
340800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     34080000
340900                                    ASC-ITEM-SUB) <               34090000
341000             ASC-END-OF-SELECTED-RANGE)                           34100000
341100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     34110000
341200                                    ASC-ITEM-SUB) =               34120000
341300             ASC-END-OF-SELECTED-RANGE)                           34130000
341400                                                                  34140000
341500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          34150000
341600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   34160000
341700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   34170000
341800                               TO TRUE                            34180000
341900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              34190000
342000                               TO TRUE                            34200000
342100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    34210000
342200             END-IF                                               34220000
342300         END-IF                                                   34230000
342400     END-IF.                                                      34240000
342500                                                                  34250000
342600 EJECT                                                            34260000
342700*----------------------------------------------------------------*34270000
342800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *34280000
342900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *34290000
343000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *34300000
343100*    DISPLAY THE PANEL TO USER.                                  *34310000
343200*----------------------------------------------------------------*34320000
343300                                                                  34330000
343400 4000-BUILD-INITIAL-PANEL.                                        34340000
343500                                                                  34350000
343600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            34360000
343700                                 ASC-BLOCK-ENTRIES (2).           34370000
343800     MOVE +1                 TO ASC-BLK-SUB.                      34380000
343900     SET ASC-ITEMS-LEFT-ON-DB                                     34390000
344000                             TO TRUE.                             34400000
344100                                                                  34410000
344200     MOVE +0                 TO ASC-ITEM-SUB                      34420000
344300                                ASC-NUMBER-OF-ITEMS-READ          34430000
344400                                ASC-NUMBER-OF-SELECTED-ITEMS      34440000
344500                                ASC-HIGHEST-BLOCK-WRITTEN         34450000
344600                                ASC-START-OF-SELECTED-RANGE       34460000
344700                                ASC-END-OF-SELECTED-RANGE         34470000
344800                                ASC-ITEM-AT-TOP-OF-PANEL.         34480000
344900     PERFORM 4100-PREPARE-CURSOR                                  34490000
345000     IF PS-CURSOR-TYPE-SW = SPACES                                34500000
345100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    34510000
345200         SET DP020-MSG-FATAL   TO  TRUE                           34520000
345300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               34530000
345400     ELSE                                                         34540000
345500                                                                  34550000
345600         MOVE PS-CURSOR-TYPE-SW       TO ASC-CURSOR-TYPE-SW       34560000
345700         PERFORM 4010-OPEN-CURSOR                                 34570000
345800                                                                  34580000
345900         PERFORM 4300-READ-ITEMS-FROM-DB                          34590000
346000                                                                  34600000
346100         PERFORM 4020-CLOSE-CURSOR                                34610000
346200                                                                  34620000
346300         MOVE +1                   TO  PV-TOP-ITEM                34630000
346400                                                                  34640000
346500                                                                  34650000
346600*  07/02/2004                                                     34660000
346700     EVALUATE TRUE                                                34670000
346800         WHEN SU025-SELECTED-ITEMS > 1                            34680000
346900             IF ASC-NUMBER-OF-ITEMS-READ = ZERO                   34690000
347000                 SET DP030-SET-CURSOR-APPL-1                      34700000
347100                     DP020-MSG-FATAL  TO TRUE                     34710000
347200                 MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER         34720000
347300*                PERFORM 3000-EDIT-DATA-IN-COMMAREA               34730000
347400                 PERFORM 3200-RESET-ATTRIBUTES                    34740000
347500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34750000
347600             ELSE                                                 34760000
347700                 MOVE -1           TO MR-SELECTL (1)              34770000
347800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34780000
347900                 PERFORM 3200-RESET-ATTRIBUTES                    34790000
348000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34800000
348100             END-IF                                               34810000
348200         WHEN OTHER                                               34820000
348300             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  34830000
348400                 SET DP020-NEXT-ACT-APPL-ERROR                    34840000
348500                     DP020-MSG-FATAL  TO  TRUE                    34850000
348600                 MOVE PC-TSYMSG-00050 TO  DP020-MSG-NUMBER        34860000
348700             ELSE                                                 34870000
348800                 MOVE -1              TO MR-SELECTL (1)           34880000
348900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34890000
349000                 PERFORM 3200-RESET-ATTRIBUTES                    34900000
349100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34910000
349200             END-IF                                               34920000
349300         END-EVALUATE                                             34930000
349400                                                                  34940000
349500*        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      34950000
349600*            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                34960000
349700*            SET DP020-MSG-FATAL   TO  TRUE                       34970000
349800*            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           34980000
349900*        ELSE                                                     34990000
350000*            MOVE -1               TO MR-SELECTL (1)              35000000
350100*            SET DP030-SET-CURSOR-APPL-1                          35010000
350200*                                  TO TRUE                        35020000
350300*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 35030000
350400*        END-IF                                                   35040000
350500     END-IF.                                                      35050000
350600 EJECT                                                            35060000
350700*----------------------------------------------------------------*35070000
350800* OPEN THE TMESSAGE CURSOR.                                      *35080000
350900*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *35090000
351000*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *35100000
351100*   USER.                                                        *35110000
351200*----------------------------------------------------------------*35120000
351300                                                                  35130000
351400 4010-OPEN-CURSOR.                                                35140000
351500                                                                  35150000
351600     PERFORM                                                      35160000
351700         WITH TEST AFTER                                          35170000
351800         VARYING PV-RETRY-COUNTER                                 35180000
351900         FROM 1 BY 1                                              35190000
352000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35200000
352100                   OR (SQLCODE = ZERO))                           35210000
352200             MOVE 'CURSOR:  AUDIT-CSR'                            35220000
352300                               TO DP013-MESSAGE-TEXT (2)          35230000
352400         EVALUATE TRUE                                            35240000
352500             WHEN PS-OPER-PO                                      35250000
352600                 EXEC SQL                                         35260000
352700                      OPEN OPER-PO-CSR                            35270000
352800                 END-EXEC                                         35280000
352900             WHEN PS-OPER-PO-RCVR                                 35290000
353000                 EXEC SQL                                         35300000
353100                      OPEN OPER-PO-RCVR-CSR                       35310000
353200                 END-EXEC                                         35320000
353300             WHEN PS-OPER                                         35330000
353400                 EXEC SQL                                         35340000
353500                      OPEN OPER-CSR                               35350000
353600                 END-EXEC                                         35360000
353700             WHEN PS-OPER-STAT                                    35370000
353800                 EXEC SQL                                         35380000
353900                      OPEN OPER-STATUS-CSR                        35390000
354000                 END-EXEC                                         35400000
354100             WHEN PS-OPER-STAT-DATE                               35410000
354200                 EXEC SQL                                         35420000
354300                      OPEN OPER-STAT-DATE-CSR                     35430000
354400                 END-EXEC                                         35440000
354500             WHEN PS-OPER-DATE                                    35450000
354600                 EXEC SQL                                         35460000
354700                      OPEN OPER-DATE-CSR                          35470000
354800                 END-EXEC                                         35480000
354900             WHEN PS-PO-RCVR                                      35490000
355000                 EXEC SQL                                         35500000
355100                      OPEN PO-RECEIVER-CSR                        35510000
355200                 END-EXEC                                         35520000
355300             WHEN PS-PO-RCVR-ALL-STATS                            35530000
355400                 EXEC SQL                                         35540000
355500                      OPEN PO-RCVR-ALL-CSR                        35550000
355600                 END-EXEC                                         35560000
355700             WHEN PS-PO                                           35570000
355800                 EXEC SQL                                         35580000
355900                      OPEN PO-CSR                                 35590000
356000                 END-EXEC                                         35600000
356100             WHEN PS-OPER-ENT-DEPT-DATE                           35610000
356200                 EXEC SQL                                         35620000
356300                      OPEN OP-ENT-DPT-DAT-CSR                     35630000
356400                 END-EXEC                                         35640000
356500             WHEN PS-OPER-ENT-DATE                                35650000
356600                 EXEC SQL                                         35660000
356700                      OPEN OPER-ENT-DATE-CSR                      35670000
356800                 END-EXEC                                         35680000
356900             WHEN PS-ENT-DEPT-DATE                                35690000
357000                 EXEC SQL                                         35700000
357100                      OPEN ENT-DEPT-DATE-CSR                      35710000
357200                 END-EXEC                                         35720000
357300             WHEN PS-ENT-DATE                                     35730000
357400                 EXEC SQL                                         35740000
357500                      OPEN ENT-DATE-CSR                           35750000
357600                 END-EXEC                                         35760000
357700             WHEN PS-OPER-ENT                                     35770000
357800                 EXEC SQL                                         35780000
357900                      OPEN OPER-ENT-ID                            35790000
358000                 END-EXEC                                         35800000
358100             WHEN PS-ENT                                          35810000
358200                 EXEC SQL                                         35820000
358300                      OPEN ENT-CSR                                35830000
358400                 END-EXEC                                         35840000
358500             WHEN PS-AUDIT                                        35850000
358600                 EXEC SQL                                         35860000
358700                      OPEN AUDIT-CSR                              35870000
358800                 END-EXEC                                         35880000
358900             WHEN PS-MAN-AUDIT                                    35890000
359000                 EXEC SQL                                         35900000
359100                      OPEN MAN-AUDIT-CSR                          35910000
359200                 END-EXEC                                         35920000
359300             WHEN PS-MAN-OPER-DTE                                 35930000
359400                 EXEC SQL                                         35940000
359500                      OPEN MAN-OPER-DTE-CSR                       35950000
359600                 END-EXEC                                         35960000
359700             WHEN PS-MAN-OPER-STAT-DTE                            35970000
359800                 EXEC SQL                                         35980000
359900                      OPEN MAN-OP-STAT-DT-CSR                     35990000
360000                 END-EXEC                                         36000000
360100             WHEN PS-MAN-OPER                                     36010000
360200                 EXEC SQL                                         36020000
360300                      OPEN MAN-OPER-CSR                           36030000
360400                 END-EXEC                                         36040000
360500             WHEN PS-MAN-OPER-STATUS                              36050000
360600                 EXEC SQL                                         36060000
360700                      OPEN MAN-OPER-STAT-CSR                      36070000
360800                 END-EXEC                                         36080000
360900             WHEN PS-ALL-AUDIT                                    36090000
361000                 EXEC SQL                                         36100000
361100                      OPEN ALL-AUDIT-CSR                          36110000
361200                 END-EXEC                                         36120000
361300             WHEN PS-ALL-OPER-DTE                                 36130000
361400                 EXEC SQL                                         36140000
361500                      OPEN ALL-OPER-DTE-CSR                       36150000
361600                 END-EXEC                                         36160000
361700             WHEN PS-ALL-OPER-STAT-DTE                            36170000
361800                 EXEC SQL                                         36180000
361900                      OPEN ALL-OP-STAT-DT-CSR                     36190000
362000                 END-EXEC                                         36200000
362100             WHEN PS-ALL-OPER                                     36210000
362200                 EXEC SQL                                         36220000
362300                      OPEN ALL-OPER-CSR                           36230000
362400                 END-EXEC                                         36240000
362500             WHEN PS-ALL-OPER-STATUS                              36250000
362600                 EXEC SQL                                         36260000
362700                      OPEN ALL-OPER-STAT-CSR                      36270000
362800                 END-EXEC                                         36280000
362900             WHEN PS-ALL-CRTN                                     36290000
363000                 EXEC SQL                                         36300000
363100                      OPEN ALL-CRTN-CSR                           36310000
363200                 END-EXEC                                         36320000
363300             WHEN PS-ALL-CRTN-AUDT                                36330000
363400                 EXEC SQL                                         36340000
363500                      OPEN ALL-CRTN-AUDT-CSR                      36350000
363600                 END-EXEC                                         36360000
363700             WHEN PS-MAN-CRTN                                     36370000
363800                 EXEC SQL                                         36380000
363900                      OPEN MAN-CRTN-CSR                           36390000
364000                 END-EXEC                                         36400000
364100             WHEN PS-MAN-CRTN-AUDT                                36410000
364200                 EXEC SQL                                         36420000
364300                      OPEN MAN-CRTN-AUDT-CSR                      36430000
364400                 END-EXEC                                         36440000
364500             WHEN PS-ALL-SYSTEM                                   36450000
364600                 EXEC SQL                                         36460000
364700                      OPEN ALL-SYSTEM-CSR                         36470000
364800                 END-EXEC                                         36480000
364900             WHEN PS-ALL-MANUAL                                   36490000
365000                 EXEC SQL                                         36500000
365100                      OPEN ALL-MANUAL-CSR                         36510000
365200                 END-EXEC                                         36520000
365300             WHEN PS-ALL-ALL                                      36530000
365400                 EXEC SQL                                         36540000
365500                      OPEN ALL-ALL-CSR                            36550000
365600                 END-EXEC                                         36560000
365700         END-EVALUATE                                             36570000
365800                                                                  36580000
365900         EVALUATE TRUE                                            36590000
366000             WHEN SQLCODE = ZERO                                  36600000
366100             WHEN SQLCODE = -904                                  36610000
366200             WHEN SQLCODE = -913                                  36620000
366300                 CONTINUE                                         36630000
366400             WHEN SQLWARN0 NOT = SPACES                           36640000
366500             WHEN SQLCODE < ZERO                                  36650000
366600             WHEN SQLCODE > ZERO                                  36660000
366700                 MOVE '4010-OPEN-CURSOR'                          36670000
366800                                   TO DP013-PARAGRAPH             36680000
366900                 MOVE 'OPEN SYSTEM MESSAGE CURSOR - '             36690000
367000                                   TO DP013-MESSAGE-TEXT (1)      36700000
367100                 MOVE SQLCA        TO DP013-SQLCA                 36710000
367200                 MOVE 'SUT00015'   TO DP013-DB2-TABLE-NAME (1)    36720000
367300                 MOVE 'TMDSEAR '   TO DP013-DB2-TABLE-NAME (2)    36730000
367400                 SET DP013-DB2-ABEND                              36740000
367500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36750000
367600                 PERFORM DP013-0000-PROCESS-ABEND                 36760000
367700         END-EVALUATE                                             36770000
367800     END-PERFORM.                                                 36780000
367900*                                                                 36790000
368000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36800000
368100         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             36810000
368200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   36820000
368300                                   TO DP013-MESSAGE-TEXT (1)      36830000
368400         MOVE SQLCA                TO DP013-SQLCA                 36840000
368500         MOVE 'SUT00015'           TO DP013-DB2-TABLE-NAME (1)    36850000
368600         SET DP013-DB2-ABEND                                      36860000
368700             DP013-XCTL-DISPLAY-RESTART                           36870000
368800                                   TO TRUE                        36880000
368900         PERFORM DP013-0000-PROCESS-ABEND                         36890000
369000     END-IF.                                                      36900000
369100                                                                  36910000
369200 EJECT                                                            36920000
369300*----------------------------------------------------------------*36930000
369400* CLOSE THE TMESSAGE CURSOR.                                     *36940000
369500*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *36950000
369600*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *36960000
369700*   USER.                                                        *36970000
369800*----------------------------------------------------------------*36980000
369900                                                                  36990000
370000 4020-CLOSE-CURSOR.                                               37000000
370100     EVALUATE TRUE                                                37010000
370200         WHEN PS-OPER-PO                                          37020000
370300             EXEC SQL                                             37030000
370400                  CLOSE OPER-PO-CSR                               37040000
370500             END-EXEC                                             37050000
370600         WHEN PS-OPER-PO-RCVR                                     37060000
370700             EXEC SQL                                             37070000
370800                  CLOSE OPER-PO-RCVR-CSR                          37080000
370900             END-EXEC                                             37090000
371000         WHEN PS-OPER                                             37100000
371100             EXEC SQL                                             37110000
371200                  CLOSE OPER-CSR                                  37120000
371300             END-EXEC                                             37130000
371400         WHEN PS-OPER-STAT                                        37140000
371500             EXEC SQL                                             37150000
371600                  CLOSE OPER-STATUS-CSR                           37160000
371700             END-EXEC                                             37170000
371800         WHEN PS-OPER-STAT-DATE                                   37180000
371900             EXEC SQL                                             37190000
372000                  CLOSE OPER-STAT-DATE-CSR                        37200000
372100             END-EXEC                                             37210000
372200         WHEN PS-OPER-DATE                                        37220000
372300             EXEC SQL                                             37230000
372400                  CLOSE OPER-DATE-CSR                             37240000
372500             END-EXEC                                             37250000
372600         WHEN PS-PO-RCVR                                          37260000
372700             EXEC SQL                                             37270000
372800                  CLOSE PO-RECEIVER-CSR                           37280000
372900             END-EXEC                                             37290000
373000         WHEN PS-PO-RCVR-ALL-STATS                                37300000
373100             EXEC SQL                                             37310000
373200                  CLOSE PO-RCVR-ALL-CSR                           37320000
373300             END-EXEC                                             37330000
373400         WHEN PS-PO                                               37340000
373500             EXEC SQL                                             37350000
373600                  CLOSE PO-CSR                                    37360000
373700             END-EXEC                                             37370000
373800         WHEN PS-OPER-ENT-DEPT-DATE                               37380000
373900             EXEC SQL                                             37390000
374000                  CLOSE OP-ENT-DPT-DAT-CSR                        37400000
374100             END-EXEC                                             37410000
374200         WHEN PS-OPER-ENT-DATE                                    37420000
374300             EXEC SQL                                             37430000
374400                  CLOSE OPER-ENT-DATE-CSR                         37440000
374500             END-EXEC                                             37450000
374600         WHEN PS-ENT-DEPT-DATE                                    37460000
374700             EXEC SQL                                             37470000
374800                  CLOSE ENT-DEPT-DATE-CSR                         37480000
374900             END-EXEC                                             37490000
375000         WHEN PS-ENT-DATE                                         37500000
375100             EXEC SQL                                             37510000
375200                  CLOSE ENT-DATE-CSR                              37520000
375300             END-EXEC                                             37530000
375400         WHEN PS-OPER-ENT                                         37540000
375500             EXEC SQL                                             37550000
375600                  CLOSE OPER-ENT-ID                               37560000
375700             END-EXEC                                             37570000
375800         WHEN PS-ENT                                              37580000
375900             EXEC SQL                                             37590000
376000                  CLOSE ENT-CSR                                   37600000
376100             END-EXEC                                             37610000
376200         WHEN PS-AUDIT                                            37620000
376300             EXEC SQL                                             37630000
376400                  CLOSE AUDIT-CSR                                 37640000
376500             END-EXEC                                             37650000
376600         WHEN PS-MAN-AUDIT                                        37660000
376700             EXEC SQL                                             37670000
376800                  CLOSE MAN-AUDIT-CSR                             37680000
376900             END-EXEC                                             37690000
377000         WHEN PS-MAN-OPER-DTE                                     37700000
377100             EXEC SQL                                             37710000
377200                  CLOSE MAN-OPER-DTE-CSR                          37720000
377300             END-EXEC                                             37730000
377400         WHEN PS-MAN-OPER-STAT-DTE                                37740000
377500             EXEC SQL                                             37750000
377600                  CLOSE MAN-OP-STAT-DT-CSR                        37760000
377700             END-EXEC                                             37770000
377800         WHEN PS-MAN-OPER                                         37780000
377900             EXEC SQL                                             37790000
378000                  CLOSE MAN-OPER-CSR                              37800000
378100             END-EXEC                                             37810000
378200         WHEN PS-MAN-OPER-STATUS                                  37820000
378300             EXEC SQL                                             37830000
378400                  CLOSE MAN-OPER-STAT-CSR                         37840000
378500             END-EXEC                                             37850000
378600         WHEN PS-ALL-AUDIT                                        37860000
378700             EXEC SQL                                             37870000
378800                  CLOSE ALL-AUDIT-CSR                             37880000
378900             END-EXEC                                             37890000
379000         WHEN PS-ALL-OPER-DTE                                     37900000
379100             EXEC SQL                                             37910000
379200                  CLOSE ALL-OPER-DTE-CSR                          37920000
379300             END-EXEC                                             37930000
379400         WHEN PS-ALL-OPER-STAT-DTE                                37940000
379500             EXEC SQL                                             37950000
379600                  CLOSE ALL-OP-STAT-DT-CSR                        37960000
379700             END-EXEC                                             37970000
379800         WHEN PS-ALL-OPER                                         37980000
379900             EXEC SQL                                             37990000
380000                  CLOSE ALL-OPER-CSR                              38000000
380100             END-EXEC                                             38010000
380200         WHEN PS-ALL-OPER-STATUS                                  38020000
380300             EXEC SQL                                             38030000
380400                  CLOSE ALL-OPER-STAT-CSR                         38040000
380500             END-EXEC                                             38050000
380600         WHEN PS-ALL-CRTN                                         38060000
380700             EXEC SQL                                             38070000
380800                  CLOSE ALL-CRTN-CSR                              38080000
380900             END-EXEC                                             38090000
381000         WHEN PS-ALL-CRTN-AUDT                                    38100000
381100             EXEC SQL                                             38110000
381200                  CLOSE ALL-CRTN-AUDT-CSR                         38120000
381300             END-EXEC                                             38130000
381400         WHEN PS-MAN-CRTN                                         38140000
381500             EXEC SQL                                             38150000
381600                  CLOSE MAN-CRTN-CSR                              38160000
381700             END-EXEC                                             38170000
381800         WHEN PS-MAN-CRTN-AUDT                                    38180000
381900             EXEC SQL                                             38190000
382000                  CLOSE MAN-CRTN-AUDT-CSR                         38200000
382100             END-EXEC                                             38210000
382200         WHEN PS-ALL-SYSTEM                                       38220000
382300             EXEC SQL                                             38230000
382400                  CLOSE ALL-SYSTEM-CSR                            38240000
382500             END-EXEC                                             38250000
382600         WHEN PS-ALL-MANUAL                                       38260000
382700             EXEC SQL                                             38270000
382800                  CLOSE ALL-MANUAL-CSR                            38280000
382900             END-EXEC                                             38290000
383000         WHEN PS-ALL-ALL                                          38300000
383100             EXEC SQL                                             38310000
383200                  CLOSE ALL-ALL-CSR                               38320000
383300             END-EXEC                                             38330000
383400     END-EVALUATE.                                                38340000
383500*                                                                 38350000
383600     EVALUATE TRUE                                                38360000
383700         WHEN SQLCODE = ZERO                                      38370000
383800             CONTINUE                                             38380000
383900         WHEN SQLWARN0 NOT = SPACES                               38390000
384000         WHEN SQLCODE < ZERO                                      38400000
384100         WHEN SQLCODE > ZERO                                      38410000
384200             MOVE '4020-CLOSE-CURSOR'                             38420000
384300                               TO DP013-PARAGRAPH                 38430000
384400             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  38440000
384500                               TO DP013-MESSAGE-TEXT (1)          38450000
384600             MOVE SQLCA        TO DP013-SQLCA                     38460000
384700             MOVE 'SUT00015'   TO DP013-DB2-TABLE-NAME (1)        38470000
384800             SET DP013-DB2-ABEND                                  38480000
384900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38490000
385000             PERFORM DP013-0000-PROCESS-ABEND                     38500000
385100     END-EVALUATE.                                                38510000
385200                                                                  38520000
385300 EJECT                                                            38530000
385400*----------------------------------------------------------------*38540000
385500*    SET UP THE HOST VARIABLES.                                  *38550000
385600*----------------------------------------------------------------*38560000
385700                                                                  38570000
385800 4100-PREPARE-CURSOR.                                             38580000
385900                                                                  38590000
386000     IF PS-PO-RCVR-ALL-STATS                                      38600000
386100         MOVE ASC-PO-NBR              TO DK-PO                    38610000
386200         MOVE ASC-RCVR                TO DK-REC-SEQ-NBR           38620000
386300     ELSE                                                         38630000
386400                                                                  38640000
386500     EVALUATE TRUE                                                38650000
386600         WHEN ASC-BULK-CASE                                       38660000
386700             SET PV-PKG-1-BC                                      38670000
386800                 PV-PKG-2-BC                                      38680000
386900                 PV-PKG-3-BC                                      38690000
386900                 PV-PKG-4-BC      TO TRUE                         38691000
387000         WHEN ASC-PREPACK                                         38692000
387100                 SET PV-PKG-1-PP                                  38693000
387200                     PV-PKG-2-PP                                  38694000
387300                     PV-PKG-3-PP                                  38695000
387300                     PV-PKG-4-PP      TO TRUE                     38696000
387400         WHEN ASC-PBS                                             38697000
387500                 SET PV-PKG-1-PBS                                 38698000
387600                     PV-PKG-2-PBS                                 38699000
387700                     PV-PKG-3-PBS                                 38700000
387700                     PV-PKG-4-PBS     TO TRUE                     38710000
387400         WHEN ASC-RFID                                            38720000
387500                 SET PV-PKG-1-RFID                                38730000
387600                     PV-PKG-2-RFID                                38740000
387700                     PV-PKG-3-RFID                                38750000
387700                     PV-PKG-4-RFID    TO TRUE                     38760000
387800         WHEN OTHER                                               38770000
387900                 SET PV-PKG-1-BC                                  38780000
388000                     PV-PKG-2-PP                                  38790000
388100                     PV-PKG-3-PBS                                 38800000
388100                     PV-PKG-4-RFID    TO TRUE                     38810000
388200     END-EVALUATE                                                 38820000
388300                                                                  38830000
388400     END-IF                                                       38840000
388500                                                                  38850000
388600     EVALUATE TRUE                                                38860000
388700         WHEN ASC-PASS                                            38870000
388800             SET PV-STAT-1-P                                      38880000
388900                 PV-STAT-2-P                                      38890000
389000                 PV-STAT-3-P                                      38900000
389100                 PV-STAT-4-P      TO TRUE                         38910000
389200         WHEN ASC-FAIL                                            38920000
389300             SET PV-STAT-1-F                                      38930000
389400                 PV-STAT-2-F                                      38940000
389500                 PV-STAT-3-F                                      38950000
389600                 PV-STAT-4-F      TO TRUE                         38960000
389700         WHEN ASC-IN-PROCESS                                      38970000
389800         WHEN ASC-OPEN                                            38980000
389900             SET PV-STAT-1-I                                      38990000
390000                 PV-STAT-2-I                                      39000000
390100                 PV-STAT-3-I                                      39010000
390200                 PV-STAT-4-I      TO TRUE                         39020000
390300         WHEN ASC-NOT-NEEDED                                      39030000
390400             SET PV-STAT-1-N                                      39040000
390500                 PV-STAT-2-N                                      39050000
390600                 PV-STAT-3-N                                      39060000
390700                 PV-STAT-4-N      TO TRUE                         39070000
390800         WHEN ASC-CLOSED                                          39080000
390900             SET PV-STAT-1-P                                      39090000
391000                 PV-STAT-2-F                                      39100000
391100                 PV-STAT-3-N      TO TRUE                         39110000
391200         WHEN ASC-ALL-TYPES                                       39120000
391300             SET PV-STAT-1-P                                      39130000
391400                 PV-STAT-2-F                                      39140000
391500                 PV-STAT-3-I                                      39150000
391600                 PV-STAT-4-N      TO TRUE                         39160000
391700         WHEN OTHER                                               39170000
391800             SET PV-STAT-1-P                                      39180000
391900                 PV-STAT-2-F                                      39190000
392000                 PV-STAT-3-I                                      39200000
392100                 PV-STAT-4-N      TO TRUE                         39210000
392200         END-EVALUATE.                                            39220000
392300                                                                  39230000
392400     EVALUATE TRUE                                                39240000
392500*                                                                 39250000
392600         WHEN (ASC-OPER-UNIT-ID EQUAL 'ALL ' OR                   39260000
392700              ASC-OPER-UNIT-ID EQUAL ' ALL') AND                  39270000
392800              ASC-SYSTEM                                          39280000
392900               SET PS-ALL-SYSTEM TO TRUE                          39290000
393000               IF ASC-AUDIT-STATUS     = 'O'                      39300000
393100                   SET PV-STAT-1-I                                39310000
393200                       PV-STAT-2-I                                39320000
393300                       PV-STAT-3-I                                39330000
393400                       PV-STAT-4-I      TO TRUE                   39340000
393500               ELSE                                               39350000
393600                   SET PV-STAT-1-P                                39360000
393700                       PV-STAT-2-F                                39370000
393800                       PV-STAT-3-N                                39380000
393900                       PV-STAT-4-N      TO TRUE                   39390000
394000               END-IF                                             39400000
394100*                                                                 39410000
394200         WHEN (ASC-OPER-UNIT-ID EQUAL 'ALL ' OR                   39420000
394300              ASC-OPER-UNIT-ID EQUAL ' ALL') AND                  39430000
394400              ASC-MANUAL                                          39440000
394500               SET PS-ALL-MANUAL TO TRUE                          39450000
394600               IF ASC-AUDIT-STATUS     = 'O'                      39460000
394700                   MOVE 'IP'        TO DK-MAN-AUD-STATUS-1        39470000
394800                   MOVE 'PP'        TO DK-MAN-AUD-STATUS-2        39480000
394900               ELSE                                               39490000
395000                   IF ASC-AUDIT-STATUS     = 'C'                  39500000
395100                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    39510000
395200                   ELSE                                           39520000
395300                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    39530000
395400                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    39540000
395500                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-3    39550000
395600                   END-IF                                         39560000
395700               END-IF                                             39570000
395800*                                                                 39580000
395900         WHEN (ASC-OPER-UNIT-ID EQUAL 'ALL ' OR                   39590000
396000              ASC-OPER-UNIT-ID EQUAL ' ALL') AND                  39600000
396100              ASC-ALL                                             39610000
396200               SET PS-ALL-ALL TO TRUE                             39620000
396300               IF ASC-AUDIT-STATUS     = 'O'                      39630000
396400                   MOVE 'IP'        TO DK-MAN-AUD-STATUS-1        39640000
396500                   MOVE 'PP'        TO DK-MAN-AUD-STATUS-2        39650000
396600                   SET PV-STAT-1-I                                39660000
396700                       PV-STAT-2-I                                39670000
396800                       PV-STAT-3-I                                39680000
396900                       PV-STAT-4-I      TO TRUE                   39690000
397000               ELSE                                               39700000
397100                   IF ASC-AUDIT-STATUS     = 'C'                  39710000
397200                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    39720000
397300                       SET PV-STAT-1-P                            39730000
397400                           PV-STAT-2-F                            39740000
397500                           PV-STAT-3-N                            39750000
397600                           PV-STAT-4-N      TO TRUE               39760000
397700                   ELSE                                           39770000
397800                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    39780000
397900                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    39790000
398000                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-3    39800000
398100                       SET PV-STAT-1-P                            39810000
398200                           PV-STAT-2-F                            39820000
398300                           PV-STAT-3-I                            39830000
398400                           PV-STAT-4-N      TO TRUE               39840000
398500                   END-IF                                         39850000
398600               END-IF                                             39860000
398700*                                                                 39870000
398800         WHEN ASC-PACKAGING-TYPE > SPACES AND                     39880000
398900              ASC-PROCESS-STATUS > SPACES AND                     39890000
399000              ASC-PO > 0 AND                                      39900000
399100              ASC-RECEIVER-SEQ > 0 AND                            39910000
399200              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               39920000
399300              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               39930000
399400              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  39940000
399500              ASC-SYSTEM                                          39950000
399600               MOVE ASC-PO                 TO DK-PO               39960000
399700               MOVE ASC-RECEIVER-SEQ       TO DK-REC-SEQ-NBR      39970000
399800               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      39980000
399900               SET PS-OPER-PO-RCVR TO TRUE                        39990000
400000*                                                                 40000000
400100         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40010000
400200              ASC-PROCESS-STATUS > SPACES AND                     40020000
400300              ASC-PO > 0 AND                                      40030000
400400              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               40040000
400500              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               40050000
400600              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  40060000
400700              ASC-SYSTEM                                          40070000
400800               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      40080000
400900               MOVE ASC-PO                 TO DK-PO               40090000
401000               SET PS-OPER-PO TO TRUE                             40100000
401100*                                                                 40110000
401200         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40120000
401300              ASC-PROCESS-STATUS > SPACES AND                     40130000
401400              ASC-PO > 0 AND                                      40140000
401500              ASC-RECEIVER-SEQ > 0 AND                            40150000
401600              ASC-SYSTEM                                          40160000
401700               MOVE ASC-PO                 TO DK-PO               40170000
401800               MOVE ASC-RECEIVER-SEQ       TO DK-REC-SEQ-NBR      40180000
401900               SET PS-PO-RCVR TO TRUE                             40190000
402000*                                                                 40200000
402100         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40210000
402200              ASC-PROCESS-STATUS > SPACES AND                     40220000
402300              ASC-PO > 0 AND                                      40230000
402400              ASC-SYSTEM                                          40240000
402500               MOVE ASC-PO                 TO DK-PO               40250000
402600               SET PS-PO TO TRUE                                  40260000
402700*                                                                 40270000
402800         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40280000
402900              ASC-PROCESS-STATUS > SPACES AND                     40290000
403000              ASC-ENT-ID-N > 0 AND                                40300000
403100              ASC-DEPT-NBR-N > 0 AND                              40310000
403200              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               40320000
403300              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               40330000
403400              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  40340000
403500              ASC-FROM-DATE-MM > 0 AND                            40350000
403600              ASC-FROM-DATE-DD > 0 AND                            40360000
403700              ASC-FROM-DATE-YY > 0 AND                            40370000
403800              ASC-SYSTEM                                          40380000
403900               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      40390000
404000               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           40400000
404100               MOVE ASC-DEPT-NBR-N         TO DK-DEPT-NBR         40410000
404200               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     40420000
404300               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     40430000
404400               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     40440000
404500               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  40450000
404600               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       40460000
404700               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       40470000
404800               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       40480000
404900               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    40490000
405000               SET PS-OPER-ENT-DEPT-DATE TO TRUE                  40500000
405100*                                                                 40510000
405200         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40520000
405300              ASC-PROCESS-STATUS > SPACES AND                     40530000
405400              ASC-ENT-ID-N > 0 AND                                40540000
405500              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               40550000
405600              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               40560000
405700              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  40570000
405800              ASC-FROM-DATE-MM > 0 AND                            40580000
405900              ASC-FROM-DATE-DD > 0 AND                            40590000
406000              ASC-FROM-DATE-YY > 0 AND                            40600000
406100              ASC-SYSTEM                                          40610000
406200               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      40620000
406300               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           40630000
406400               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     40640000
406500               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     40650000
406600               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     40660000
406700               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  40670000
406800               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       40680000
406900               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       40690000
407000               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       40700000
407100               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    40710000
407200               SET PS-OPER-ENT-DATE TO TRUE                       40720000
407300*                                                                 40730000
407400         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40740000
407500              ASC-PROCESS-STATUS > SPACES AND                     40750000
407600              ASC-ENT-ID-N > 0 AND                                40760000
407700              ASC-DEPT-NBR-N > 0 AND                              40770000
407800              ASC-FROM-DATE-MM > 0 AND                            40780000
407900              ASC-FROM-DATE-DD > 0 AND                            40790000
408000              ASC-FROM-DATE-YY > 0 AND                            40800000
408100              ASC-SYSTEM                                          40810000
408200               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           40820000
408300               MOVE ASC-DEPT-NBR-N         TO DK-DEPT-NBR         40830000
408400               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     40840000
408500               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     40850000
408600               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     40860000
408700               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  40870000
408800               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       40880000
408900               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       40890000
409000               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       40900000
409100               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    40910000
409200               SET PS-ENT-DEPT-DATE TO TRUE                       40920000
409300*                                                                 40930000
409400         WHEN ASC-PACKAGING-TYPE > SPACES AND                     40940000
409500              ASC-PROCESS-STATUS > SPACES AND                     40950000
409600              ASC-ENT-ID-N > 0 AND                                40960000
409700              ASC-FROM-DATE-MM > 0 AND                            40970000
409800              ASC-FROM-DATE-DD > 0 AND                            40980000
409900              ASC-FROM-DATE-YY > 0 AND                            40990000
410000              ASC-SYSTEM                                          41000000
410100               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           41010000
410200               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     41020000
410300               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     41030000
410400               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     41040000
410500               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  41050000
410600               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       41060000
410700               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       41070000
410800               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       41080000
410900               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    41090000
411000               SET PS-ENT-DATE TO TRUE                            41100000
411100*                                                                 41110000
411200         WHEN ASC-PACKAGING-TYPE > SPACES AND                     41120000
411300              ASC-PROCESS-STATUS > SPACES AND                     41130000
411400              ASC-ENT-ID-N > 0 AND                                41140000
411500              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               41150000
411600              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               41160000
411700              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  41170000
411800              ASC-SYSTEM                                          41180000
411900               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      41190000
412000               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           41200000
412100               SET PS-OPER-ENT TO TRUE                            41210000
412200*                                                                 41220000
412300         WHEN ASC-PACKAGING-TYPE > SPACES AND                     41230000
412400              ASC-PROCESS-STATUS > SPACES AND                     41240000
412500              ASC-ENT-ID-N > 0 AND                                41250000
412600              ASC-SYSTEM                                          41260000
412700               MOVE ASC-ENT-ID-N           TO DK-ENT-ID           41270000
412800               SET PS-ENT TO TRUE                                 41280000
412900*                                                                 41290000
413000         WHEN ASC-AUDIT-NBR > 0 AND                               41300000
413100              ASC-SYSTEM                                          41310000
413200               MOVE ASC-AUDIT-NBR          TO DK-AUDIT-NBR        41320000
413300               SET PS-AUDIT TO TRUE                               41330000
413400                                                                  41340000
413500         WHEN ASC-AUDIT-NBR > 0 AND                               41350000
413600              ASC-MANUAL                                          41360000
413700               MOVE ASC-AUDIT-NBR          TO DK-AUDIT-NBR        41370000
413800               SET PS-MAN-AUDIT TO TRUE                           41380000
413900                                                                  41390000
414000         WHEN ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               41400000
414100              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               41410000
414200              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  41420000
414300              ASC-AUDIT-STATUS > SPACES AND                       41430000
414400              ASC-FROM-DATE-MM > 0 AND                            41440000
414500              ASC-FROM-DATE-DD > 0 AND                            41450000
414600              ASC-FROM-DATE-YY > 0 AND                            41460000
414700              ASC-CARTON-ID NOT > ZEROES AND                      41470000
414800              ASC-MANUAL                                          41480000
414900               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      41490000
415000               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     41500000
415100               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     41510000
415200               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     41520000
415300               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  41530000
415400               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       41540000
415500               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       41550000
415600               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       41560000
415700               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    41570000
415800               IF ASC-AUDIT-STATUS     = 'A'                      41580000
415900                   SET PS-MAN-OPER-DTE TO TRUE                    41590000
416000               ELSE                                               41600000
416100                   SET PS-MAN-OPER-STAT-DTE TO TRUE               41610000
416200                   IF ASC-AUDIT-STATUS     = 'O'                  41620000
416300                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    41630000
416400                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    41640000
416500                       MOVE 'I'         TO DK-AUDIT-STATUS-1      41650000
416600                   ELSE                                           41660000
416700                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    41670000
416800                       MOVE 'P'         TO DK-AUDIT-STATUS-1      41680000
416900                       MOVE 'F'         TO DK-AUDIT-STATUS-2      41690000
417000                       MOVE 'N'         TO DK-AUDIT-STATUS-3      41700000
417100                   END-IF                                         41710000
417200               END-IF                                             41720000
417300                                                                  41730000
417400         WHEN ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               41740000
417500              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               41750000
417600              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  41760000
417700              ASC-AUDIT-STATUS > SPACES AND                       41770000
417800              ASC-CARTON-ID NOT > ZEROES AND                      41780000
417900              ASC-MANUAL                                          41790000
418000               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      41800000
418100               IF ASC-AUDIT-STATUS     = 'A'                      41810000
418200                   SET PS-MAN-OPER TO TRUE                        41820000
418300               ELSE                                               41830000
418400                   SET PS-MAN-OPER-STATUS TO TRUE                 41840000
418500                   IF ASC-AUDIT-STATUS = 'O'                      41850000
418600                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    41860000
418700                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    41870000
418800                       MOVE 'I'         TO DK-AUDIT-STATUS-1      41880000
418900                   ELSE                                           41890000
419000                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    41900000
419100                       MOVE 'P'         TO DK-AUDIT-STATUS-1      41910000
419200                       MOVE 'F'         TO DK-AUDIT-STATUS-2      41920000
419300                       MOVE 'N'         TO DK-AUDIT-STATUS-3      41930000
419400                   END-IF                                         41940000
419500               END-IF                                             41950000
419600                                                                  41960000
419700         WHEN ASC-AUDIT-NBR > 0 AND                               41970000
419800              ASC-ALL                                             41980000
419900               MOVE ASC-AUDIT-NBR          TO DK-AUDIT-NBR        41990000
420000               SET PS-ALL-AUDIT TO TRUE                           42000000
420100                                                                  42010000
420200         WHEN ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               42020000
420300              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               42030000
420400              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  42040000
420500              ASC-AUDIT-STATUS > SPACES AND                       42050000
420600              ASC-FROM-DATE-MM > 0 AND                            42060000
420700              ASC-FROM-DATE-DD > 0 AND                            42070000
420800              ASC-FROM-DATE-YY > 0 AND                            42080000
420900              ASC-CARTON-ID NOT > ZEROES AND                      42090000
421000              ASC-ALL                                             42100000
421100               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      42110000
421200               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     42120000
421300               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     42130000
421400               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     42140000
421500               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  42150000
421600               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       42160000
421700               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       42170000
421800               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       42180000
421900               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    42190000
422000               IF ASC-AUDIT-STATUS = 'A'                          42200000
422100                   SET PS-ALL-OPER-DTE TO TRUE                    42210000
422200               ELSE                                               42220000
422300                   SET PS-ALL-OPER-STAT-DTE TO TRUE               42230000
422400                   IF ASC-AUDIT-STATUS = 'O'                      42240000
422500                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    42250000
422600                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    42260000
422700                       MOVE 'I'         TO DK-AUDIT-STATUS-1      42270000
422800                   ELSE                                           42280000
422900                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    42290000
423000                       MOVE 'P'         TO DK-AUDIT-STATUS-1      42300000
423100                       MOVE 'F'         TO DK-AUDIT-STATUS-2      42310000
423200                       MOVE 'N'         TO DK-AUDIT-STATUS-3      42320000
423300                   END-IF                                         42330000
423400               END-IF                                             42340000
423500                                                                  42350000
423600         WHEN ASC-PACKAGING-TYPE > SPACES AND                     42360000
423700              ASC-PROCESS-STATUS > SPACES AND                     42370000
423800              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               42380000
423900              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               42390000
424000              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  42400000
424100              ASC-FROM-DATE-MM > 0 AND                            42410000
424200              ASC-FROM-DATE-DD > 0 AND                            42420000
424300              ASC-FROM-DATE-YY > 0 AND                            42430000
424400              ASC-CARTON-ID NOT > ZEROES AND                      42440000
424500              ASC-SYSTEM                                          42450000
424600               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      42460000
424700               MOVE ASC-FROM-DATE-MM       TO PV-FROM-DATE-MM     42470000
424800               MOVE ASC-FROM-DATE-DD       TO PV-FROM-DATE-DD     42480000
424900               MOVE ASC-FROM-DATE-YY       TO PV-FROM-DATE-YY     42490000
425000               MOVE PV-FROM-DATE-TIME  TO DK-DATE-FROM-TIMESTAMP  42500000
425100               MOVE ASC-TO-DATE-MM         TO PV-TO-DATE-MM       42510000
425200               MOVE ASC-TO-DATE-DD         TO PV-TO-DATE-DD       42520000
425300               MOVE ASC-TO-DATE-YY         TO PV-TO-DATE-YY       42530000
425400               MOVE PV-TO-DATE-TIME    TO DK-DATE-TO-TIMESTAMP    42540000
425500               IF ASC-PROCESS-STATUS = 'A'                        42550000
425600                   SET PS-OPER-DATE TO TRUE                       42560000
425700               ELSE                                               42570000
425800                   MOVE ASC-PROCESS-STATUS TO DK-AUDIT-STATUS-1   42580000
425900                   SET PS-OPER-STAT-DATE TO TRUE                  42590000
426000               END-IF                                             42600000
426100*                                                                 42610000
426200         WHEN ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               42620000
426300              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               42630000
426400              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  42640000
426500              ASC-AUDIT-STATUS > SPACES AND                       42650000
426600              ASC-CARTON-ID NOT > ZEROES       AND                42660000
426700              ASC-ALL                                             42670000
426800               MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID      42680000
426900               IF ASC-AUDIT-STATUS     = 'A'                      42690000
427000                   SET PS-ALL-OPER TO TRUE                        42700000
427100               ELSE                                               42710000
427200                   SET PS-ALL-OPER-STATUS TO TRUE                 42720000
427300                   IF ASC-AUDIT-STATUS = 'O'                      42730000
427400                       MOVE 'IP'        TO DK-MAN-AUD-STATUS-1    42740000
427500                       MOVE 'PP'        TO DK-MAN-AUD-STATUS-2    42750000
427600                       MOVE 'I'         TO DK-AUDIT-STATUS-1      42760000
427700                   ELSE                                           42770000
427800                       MOVE 'CM'        TO DK-MAN-AUD-STATUS-1    42780000
427900                       MOVE 'P'         TO DK-AUDIT-STATUS-1      42790000
428000                       MOVE 'F'         TO DK-AUDIT-STATUS-2      42800000
428100                       MOVE 'N'         TO DK-AUDIT-STATUS-3      42810000
428200                   END-IF                                         42820000
428300               END-IF                                             42830000
428400*                                                                 42840000
428500         WHEN ASC-PACKAGING-TYPE > SPACES AND                     42850000
428600              ASC-PROCESS-STATUS > SPACES AND                     42860000
428700              ASC-OPER-UNIT-ID NOT EQUAL 'ALL ' AND               42870000
428800              ASC-OPER-UNIT-ID NOT EQUAL ' ALL' AND               42880000
428900              ASC-OPER-UNIT-ID-N NOT EQUAL 0 AND                  42890000
429000              ASC-CARTON-ID NOT > ZEROES       AND                42900000
429100              ASC-SYSTEM                                          42910000
429200              MOVE ASC-OPER-UNIT-ID-N     TO DK-OPER-UNT-ID       42920000
429300              IF ASC-PROCESS-STATUS = 'A'                         42930000
429400                 SET PS-OPER TO TRUE                              42940000
429500              ELSE                                                42950000
429600                 SET PS-OPER-STAT TO TRUE                         42960000
429700              END-IF                                              42970000
429800*                                                                 42980000
429900         WHEN ASC-CARTON-ID    >  ZEROES  AND                     42990000
430000              ASC-CRTN-AUDT    =  ZEROES  AND                     43000000
430100              ASC-ALL                                             43010000
430200              MOVE ASC-CARTON-ID          TO  DK-CRTN-ID          43020000
430300              SET PS-ALL-CRTN             TO  TRUE                43030000
430400*                                                                 43040000
430500         WHEN ASC-CARTON-ID    >  ZEROES  AND                     43050000
430600              ASC-CRTN-AUDT    >  ZEROES  AND                     43060000
430700              ASC-ALL                                             43070000
430800              MOVE ASC-CARTON-ID          TO  DK-CRTN-ID          43080000
430900              MOVE ASC-CRTN-AUDT          TO  DK-AUDIT-NBR        43090000
431000              SET PS-ALL-CRTN-AUDT        TO  TRUE                43100000
431100*                                                                 43110000
431200         WHEN ASC-CARTON-ID    >  ZEROES  AND                     43120000
431300              ASC-CRTN-AUDT    =  ZEROES  AND                     43130000
431400              ASC-MANUAL                                          43140000
431500              MOVE ASC-CARTON-ID          TO  DK-CRTN-ID          43150000
431600              SET PS-MAN-CRTN             TO  TRUE                43160000
431700*                                                                 43170000
431800         WHEN ASC-CARTON-ID    >  ZEROES  AND                     43180000
431900              ASC-CRTN-AUDT    >  ZEROES  AND                     43190000
432000              ASC-MANUAL                                          43200000
432100              MOVE ASC-CARTON-ID          TO  DK-CRTN-ID          43210000
432200              MOVE ASC-CRTN-AUDT          TO  DK-AUDIT-NBR        43220000
432300              SET PS-MAN-CRTN-AUDT        TO  TRUE                43230000
432400     END-EVALUATE.                                                43240000
432500 EJECT                                                            43250000
432600*----------------------------------------------------------------*43260000
432700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *43270000
432800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *43280000
432900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *43290000
433000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *43300000
433100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *43310000
433200*                                                                *43320000
433300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *43330000
433400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *43340000
433500*    UPON INITIALIZATION.                                        *43350000
433600*----------------------------------------------------------------*43360000
433700                                                                  43370000
433800 4300-READ-ITEMS-FROM-DB.                                         43380000
433900                                                                  43390000
434000     PERFORM                                                      43400000
434100         VARYING PV-READ-COUNT                                    43410000
434200         FROM 1 BY 1                                              43420000
434300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    43430000
434400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         43440000
434500                                                                  43450000
434600         PERFORM 4310-FETCH                                       43460000
434700                                                                  43470000
434800         IF  ASC-ITEMS-LEFT-ON-DB                                 43480000
434900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                43490000
435000                 ADD +1            TO ASC-ITEM-SUB                43500000
435100             ELSE                                                 43510000
435200                 ADD +1            TO ASC-BLK-SUB                 43520000
435300                 MOVE +1           TO ASC-ITEM-SUB                43530000
435400                                                                  43540000
435500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         43550000
435600                     MOVE +1       TO ASC-BLK-SUB                 43560000
435700                     SET ASC-BLOCK-MODIFIED (1)                   43570000
435800                                   TO TRUE                        43580000
435900                     PERFORM 5100-WRITE-TEMP-STORAGE              43590000
436000                     MOVE ASC-BLOCK-ENTRIES                       43600000
436100                               (PC-MAX-BLOCKS-IN-ARRAY)           43610000
436200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 43620000
436300                     ADD +1        TO ASC-BLK-SUB                 43630000
436400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   43640000
436500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      43650000
436600                                   TO TRUE                        43660000
436700                 END-IF                                           43670000
436800             END-IF                                               43680000
436900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    43690000
437000             MOVE ASC-NUMBER-OF-ITEMS-READ                        43700000
437100                                   TO ASC-LIST-ITEM-NUMBER        43710000
437200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  43720000
437300*                                                                 43730000
437400             IF PS-MAN-AUDIT OR                                   43740000
437500                PS-MAN-OPER-DTE OR                                43750000
437600                PS-MAN-OPER-STAT-DTE OR                           43760000
437700                PS-MAN-OPER OR                                    43770000
437800                PS-MAN-OPER-STATUS OR                             43780000
437900                PS-MAN-CRTN OR                                    43790000
438000                PS-MAN-CRTN-AUDT OR                               43800000
438100                PS-ALL-MANUAL                                     43810000
438200                MOVE SUNAUD-AUD-CNTL-NBR TO ASC-TBL-AUDIT-NBR     43820000
438300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43830000
438400                                       DK-AUDIT-NBR               43840000
438500             ELSE                                                 43850000
438600                MOVE SUT00015-AUD-CNTL-NBR TO ASC-TBL-AUDIT-NBR   43860000
438700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43870000
438800                                       DK-AUDIT-NBR               43880000
438900             END-IF                                               43890000
439000*CLP 10/14/2013 BEGIN - PR5148D                                   43900000
11/15              INITIALIZE ASC-COUNT                                 43900100
      *VSH 10/14/2013 BEGIN - PR5148D                                   43900200
                   IF SUT00015-PKGNG-TYP-CDE = 'RF' AND                 43900300
                      SUT00015-PO-PREPK-ID       < 0                    43900400
      *               ITS A RFID AUDIT                                  43900500
                      PERFORM 4432-QC-RFID-COMB-COUNT                   43900600
                   END-IF                                               43900700
                   IF (SUT00015-AUD-CNTL-NBR      > 0 AND               43900800
                      (SUT00015-RWRK-AUD-CNTL-NBR > 0 OR ASC-COUNT > 0))43900900
      *VSH 10/14/2013 END - PR5148D                                     43901000
      *               ITS A QC AND RFID AUDIT                           43902000
                      SET ASC-MULTIPLE-AUD (ASC-BLK-SUB ASC-ITEM-SUB)   43903000
                                            TO TRUE                     43904000
                   ELSE                                                 43905000
                      SET ASC-NOT-MULTIPLE-AUD(ASC-BLK-SUB ASC-ITEM-SUB)43905100
                                            TO TRUE                     43905200
                   END-IF                                               43905300
                   IF SUT00015-PO-PREPK-ID       < 0                    43905400
      *               ITS A RFID AUDIT                                  43905500
                      SET ASC-RFID-AUD    (ASC-BLK-SUB ASC-ITEM-SUB)    43905600
                                            TO TRUE                     43905700
                   ELSE                                                 43905800
                      SET ASC-NOT-RFID-AUD(ASC-BLK-SUB ASC-ITEM-SUB)    43905900
                                            TO TRUE                     43906000
                   END-IF                                               43906100
439000*CLP 10/14/2013 END  - PR5148D                                    43906200
                                                                        43906300
439100             IF PV-SYS-MAN-IND = 'A'                              43906400
439200                 MOVE 'SYS'            TO ASC-TBL-SOURCE          43906500
439300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43906600
439400             ELSE                                                 43906700
439500                 IF SUNAUD-AUD-TYP-CDE = '01'                     43906800
439600                     MOVE '100'            TO ASC-TBL-SOURCE      43906900
439700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43907000
439800                 ELSE                                             43908000
439900                 IF SUNAUD-AUD-TYP-CDE = '02'                     43909000
440000                     MOVE 'SPT'            TO ASC-TBL-SOURCE      43910000
440100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43920000
440200                 ELSE                                             43930000
440300                     MOVE 'RWK'            TO ASC-TBL-SOURCE      43940000
440400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43950000
440500                 END-IF                                           43960000
440600                 END-IF                                           43970000
440700             END-IF                                               43980000
440800                                                                  43990000
440900             IF PS-MAN-AUDIT OR                                   44000000
441000                PS-MAN-OPER-DTE OR                                44010000
441100                PS-MAN-OPER-STAT-DTE OR                           44020000
441200                PS-MAN-OPER OR                                    44030000
441300                PS-MAN-OPER-STATUS OR                             44040000
441400                PS-MAN-CRTN OR                                    44050000
441500                PS-MAN-CRTN-AUDT OR                               44060000
441600                PS-ALL-MANUAL                                     44070000
441700                MOVE SUNAUD-OPER-UNT-ID    TO ASC-TBL-OPER-UNIT   44080000
441800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44090000
441900                MOVE SUATRN-TRN-NBR        TO PV-PO-NBR           44100000
442000                MOVE SUATRN-REC-SEQ-NBR    TO PV-RECEIVER         44110000
442100                MOVE PV-PO-RECEIVER        TO ASC-TBL-PO-RECEIVER 44120000
442200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44130000
442300                MOVE SUNAUD-AUD-STRT-TMST (3:2) TO PV-REQ-DATE-YY 44140000
442400                MOVE SUNAUD-AUD-STRT-TMST (6:2) TO PV-REQ-DATE-MM 44150000
442500                MOVE SUNAUD-AUD-STRT-TMST (9:2) TO PV-REQ-DATE-DD 44160000
442600                MOVE PV-REQ-DATE       TO  ASC-TBL-REQUEST-DATE   44170000
442700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44180000
442800                IF SUNAUD-AUD-STAT-CDE = 'IP' OR 'PP'             44190000
442900                    MOVE 'I'           TO ASC-TBL-PROCESS-ST-CDE  44200000
443000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44210000
443100                ELSE                                              44220000
443200                    MOVE 'R'           TO ASC-TBL-PROCESS-ST-CDE  44230000
443300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44240000
443400                END-IF                                            44250000
443500                MOVE SUNAUD-AUD-STRT-TMST (1:4)                   44260000
443600                                         TO PV-REQ-DATE-MDCY-CCYY 44270000
443700                MOVE SUNAUD-AUD-STRT-TMST (6:2)                   44280000
443800                                         TO PV-REQ-DATE-MDCY-MM   44290000
443900                MOVE SUNAUD-AUD-STRT-TMST (9:2)                   44300000
444000                                         TO PV-REQ-DATE-MDCY-DD   44310000
444100                MOVE PV-REQ-DATE-MDCY  TO  ASC-TBL-REQUEST-MDCY   44320000
444200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44330000
444300                MOVE SUNAUD-AUD-STRT-TMST (12:2)                  44340000
444400                                       TO PV-REQ-TIME-HR          44350000
444500                MOVE SUNAUD-AUD-STRT-TMST (15:2)                  44360000
444600                                       TO PV-REQ-TIME-MN          44370000
444700                MOVE PV-REQ-TIME       TO ASC-TBL-REQUEST-TIME    44380000
444800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44390000
444900             ELSE                                                 44400000
445000                MOVE SUT00015-OPER-UNT-ID  TO ASC-TBL-OPER-UNIT   44410000
445100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44420000
445200                MOVE SUT00015-PO-NBR       TO PV-PO-NBR           44430000
445300                MOVE SUT00015-RCVR-SEQ-NBR TO PV-RECEIVER         44440000
445400                MOVE PV-PO-RECEIVER        TO ASC-TBL-PO-RECEIVER 44450000
445500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44460000
445600                MOVE SUT00015-CRE-TMST (3:2)  TO PV-REQ-DATE-YY   44470000
445700                MOVE SUT00015-CRE-TMST (6:2)  TO PV-REQ-DATE-MM   44480000
445800                MOVE SUT00015-CRE-TMST (9:2)  TO PV-REQ-DATE-DD   44490000
445900                MOVE PV-REQ-DATE       TO  ASC-TBL-REQUEST-DATE   44500000
446000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44510000
446100                MOVE SUT00015-CRE-TMST (1:4)                      44520000
446200                                         TO PV-REQ-DATE-MDCY-CCYY 44530000
446300                MOVE SUT00015-CRE-TMST (6:2)                      44540000
446400                                         TO PV-REQ-DATE-MDCY-MM   44550000
446500                MOVE SUT00015-CRE-TMST (9:2)                      44560000
446600                                         TO PV-REQ-DATE-MDCY-DD   44570000
446700                MOVE PV-REQ-DATE-MDCY  TO  ASC-TBL-REQUEST-MDCY   44580000
446800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44590000
446900                MOVE SUT00015-CRE-TMST (12:2) TO PV-REQ-TIME-HR   44600000
447000                MOVE SUT00015-CRE-TMST (15:2) TO PV-REQ-TIME-MN   44610000
447100                MOVE PV-REQ-TIME       TO ASC-TBL-REQUEST-TIME    44620000
447200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44630000
447300                MOVE SUT00015-AUD-STAT-CDE                        44640000
447400                                       TO ASC-TBL-PROCESS-ST-CDE  44650000
447500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44660000
447600             END-IF                                               44670000
447700                                                                  44680000
447800             MOVE SUT00015-PKGNG-TYP-CDE                          44690000
447900                                         TO ASC-TBL-PKG-TYPE      44700000
448000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44710000
448100                                                                  44720000
448200             IF SUT00015-PKGNG-TYP-CDE = 'BC'                     44730000
448300                 MOVE SUT00015-PO-LNE-NBR  TO PV-LINE-PACK-NBR    44740000
448400                 STRING 'L-' DELIMITED BY SIZE                    44750000
448500                        PV-LINE-PACK-NBR DELIMITED BY SIZE        44760000
448600                                         INTO ASC-TBL-PACK-LINE   44770000
448700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44780000
448800             END-IF                                               44790000
448900                                                                  44800000
449000             IF SUT00015-PKGNG-TYP-CDE = 'PP'                     44810000
449100                 MOVE SUT00015-PO-PREPK-ID TO PV-LINE-PACK-NBR    44820000
449200                 STRING 'P-' DELIMITED BY SIZE                    44830000
449300                        PV-LINE-PACK-NBR DELIMITED BY SIZE        44840000
449400                                         INTO ASC-TBL-PACK-LINE   44850000
449500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44860000
449600             END-IF                                               44870000
449700                                                                  44880000
449800             IF SUT00015-PKGNG-TYP-CDE = 'PS'                     44890000
449900                MOVE PC-PBS TO ASC-TBL-PACK-LINE                  44900000
450000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44910000
450100             END-IF                                               44920000
450200                                                                  44930000
449800             IF SUT00015-PKGNG-TYP-CDE = 'RF'                     44940000
449900                MOVE PC-RFID TO ASC-TBL-PACK-LINE                 44950000
450000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44960000
450100             END-IF                                               44970000
450200*                                                                 44980000
450300             EVALUATE TRUE                                        44990000
450400               WHEN PS-NO-UPC-SKU-FND                             45000000
450500                  MOVE SPACES          TO ASC-TBL-SKU             45010000
450600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45020000
450700                                                                  45030000
450800               WHEN PS-MULTI-SKU-FND                              45040000
450900                  MOVE PC-MULTI        TO ASC-TBL-SKU             45050000
451000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45060000
451100                                                                  45070000
451200               WHEN OTHER                                         45080000
451300                  MOVE SUAUPC-SKU-NBR         TO PV-SKU-NBR       45090000
451400                  STRING XL001-DEPT-NBR-3CH   DELIMITED BY SIZE   45100000
451500                       , ' '                  DELIMITED BY SIZE   45110000
451600                       , XL001-SUB-CL-NBR-2CH DELIMITED BY SIZE   45120000
451700                       , ' '                  DELIMITED BY SIZE   45130000
451800                       , PV-SKU-NBR-X         DELIMITED BY SIZE   45140000
451900                                             INTO ASC-TBL-SKU     45150000
452000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45160000
452100             END-EVALUATE                                         45170000
452200                                                                  45180000
452300                                                                  45190000
452400             IF SUT00015-AUD-STAT-CDE = 'P'                       45200000
452500                 MOVE PC-PASS          TO ASC-TBL-PROCESS-STATUS  45210000
452600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45220000
452700             ELSE                                                 45230000
452800             IF SUT00015-AUD-STAT-CDE = 'F'                       45240000
452900                 MOVE PC-FAIL          TO ASC-TBL-PROCESS-STATUS  45250000
453000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45260000
453100             ELSE                                                 45270000
453200             IF SUT00015-AUD-STAT-CDE = 'I'                       45280000
453300                 IF PS-NO-UPC-SKU-FND                             45290000
453400                   MOVE 'PROMPT'         TO ASC-TBL-PROCESS-STATUS45300000
453500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45310000
453600                   MOVE 'R'            TO ASC-TBL-PROCESS-ST-CDE  45320000
453700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45330000
453800                 ELSE                                             45340000
453900                   MOVE PC-IN-PROC       TO ASC-TBL-PROCESS-STATUS45350000
454000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45360000
454100                 END-IF                                           45370000
454200             ELSE                                                 45380000
454300             IF SUT00015-AUD-STAT-CDE = 'N'                       45390000
454400                 MOVE PC-NOT-NEEDED    TO ASC-TBL-PROCESS-STATUS  45400000
454500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45410000
454600             ELSE                                                 45420000
454700             IF SUNAUD-AUD-STAT-CDE = 'IP' OR 'PP'                45430000
454800                 MOVE PC-IN-PROC       TO ASC-TBL-PROCESS-STATUS  45440000
454900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45450000
455000             ELSE                                                 45460000
455100                 MOVE PC-CLOSED        TO ASC-TBL-PROCESS-STATUS  45470000
455200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45480000
455300             END-IF                                               45490000
455400             END-IF                                               45500000
455500             END-IF                                               45510000
455600             END-IF                                               45520000
455700             END-IF                                               45530000
455800             MOVE SUT00015-DFRD-AUD-IND    TO ASC-TBL-DEFERRED-IND45540000
455900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45550000
456000             MOVE SUT00015-MOD-QTY-IND     TO ASC-TBL-MODIFIED-IND45560000
456100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45570000
456200         END-IF                                                   45580000
456300     END-PERFORM.                                                 45590000
456400                                                                  45600000
456500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          45610000
456600         MOVE +1               TO ASC-BLK-SUB                     45620000
456700         PERFORM 5100-WRITE-TEMP-STORAGE                          45630000
456800         ADD +1                TO ASC-BLK-SUB                     45640000
456900         PERFORM 5100-WRITE-TEMP-STORAGE                          45650000
457000                                                                  45660000
457100         MOVE 1                TO ASC-BLK-SUB                     45670000
457200                                  PV-BLOCK-NUMBER                 45680000
457300         PERFORM 4410-READ-TEMP-STORAGE                           45690000
457400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             45700000
457500             MOVE 2            TO ASC-BLK-SUB                     45710000
457600                                  PV-BLOCK-NUMBER                 45720000
457700             PERFORM 4410-READ-TEMP-STORAGE                       45730000
457800         END-IF                                                   45740000
457900     END-IF.                                                      45750000
458000 EJECT                                                            45760000
458100*----------------------------------------------------------------*45770000
458200*    FETCH THE MESSAGE CURSOR.                                   *45780000
458300*----------------------------------------------------------------*45790000
458400                                                                  45800000
458500 4310-FETCH.                                                      45810000
458600     INITIALIZE PS-UPC-SKU-SW.                                    45820000
      *CLP 10/14/2013 BEGIN - PR5148D                                   45830000
           INITIALIZE SUT00015-RWRK-AUD-CNTL-NBR.                       45840000
      *CLP 10/14/2013 END   - PR5148D                                   45850000
458700     EVALUATE TRUE                                                45860000
458800         WHEN PS-OPER-PO-RCVR                                     45870000
458900             EXEC SQL                                             45880000
459000                  FETCH OPER-PO-RCVR-CSR                          45890000
459100                  INTO  :PV-SYS-MAN-IND                           45900000
459200                     ,  :SUT00015-PO-NBR                          45910000
459300                     ,  :SUT00015-PO-LNE-NBR                      45920000
459400                     ,  :SUT00015-PO-PREPK-ID                     45930000
459500                     ,  :SUT00015-PKGNG-TYP-CDE                   45940000
459600                     ,  :SUT00015-OPER-UNT-ID                     45950000
459700                     ,  :SUT00015-RCVR-SEQ-NBR                    45960000
459800                     ,  :SUT00015-AUD-CNTL-NBR                    45970000
459900                     ,  :SUT00015-AUD-STAT-CDE                    45980000
460000                     ,  :SUT00015-DFRD-AUD-IND                    45990000
460100                     ,  :SUT00015-AUD-ERR-PCT                     46000000
460200                     ,  :SUT00015-CRE-TMST                        46010000
460300                     ,  :SUT00015-MOD-QTY-IND                     46020000
460400                     ,  :SUNAUD-AUD-STAT-CDE                      46030000
460500                     ,  :SUNAUD-AUD-TYP-CDE                       46040000
460600                     ,  :PV-CSR-SEQ-DATE                          46050000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  46060000
460700             END-EXEC                                             46070000
460800         WHEN PS-OPER-PO                                          46080000
460900             EXEC SQL                                             46090000
461000                  FETCH OPER-PO-CSR                               46100000
461100                  INTO  :PV-SYS-MAN-IND                           46110000
461200                     ,  :SUT00015-PO-NBR                          46120000
461300                     ,  :SUT00015-PO-LNE-NBR                      46130000
461400                     ,  :SUT00015-PO-PREPK-ID                     46140000
461500                     ,  :SUT00015-PKGNG-TYP-CDE                   46150000
461600                     ,  :SUT00015-OPER-UNT-ID                     46160000
461700                     ,  :SUT00015-RCVR-SEQ-NBR                    46170000
461800                     ,  :SUT00015-AUD-CNTL-NBR                    46180000
461900                     ,  :SUT00015-AUD-STAT-CDE                    46190000
462000                     ,  :SUT00015-DFRD-AUD-IND                    46200000
462100                     ,  :SUT00015-AUD-ERR-PCT                     46210000
462200                     ,  :SUT00015-CRE-TMST                        46220000
462300                     ,  :SUT00015-MOD-QTY-IND                     46230000
462400                     ,  :SUNAUD-AUD-STAT-CDE                      46240000
462500                     ,  :SUNAUD-AUD-TYP-CDE                       46250000
462600                     ,  :PV-CSR-SEQ-DATE                          46260000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  46261000
462700             END-EXEC                                             46262000
462800         WHEN PS-OPER                                             46263000
462900             EXEC SQL                                             46264000
463000                  FETCH OPER-CSR                                  46265000
463100                  INTO  :PV-SYS-MAN-IND                           46266000
463200                     ,  :SUT00015-PO-NBR                          46267000
463300                     ,  :SUT00015-PO-LNE-NBR                      46268000
463400                     ,  :SUT00015-PO-PREPK-ID                     46269000
463500                     ,  :SUT00015-PKGNG-TYP-CDE                   46270000
463600                     ,  :SUT00015-OPER-UNT-ID                     46280000
463700                     ,  :SUT00015-RCVR-SEQ-NBR                    46290000
463800                     ,  :SUT00015-AUD-CNTL-NBR                    46300000
463900                     ,  :SUT00015-AUD-STAT-CDE                    46310000
464000                     ,  :SUT00015-DFRD-AUD-IND                    46320000
464100                     ,  :SUT00015-AUD-ERR-PCT                     46330000
464200                     ,  :SUT00015-CRE-TMST                        46340000
464300                     ,  :SUT00015-MOD-QTY-IND                     46350000
464400                     ,  :SUNAUD-AUD-STAT-CDE                      46360000
464500                     ,  :SUNAUD-AUD-TYP-CDE                       46370000
464600                     ,  :PV-CSR-SEQ-DATE                          46380000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  46390000
464700             END-EXEC                                             46400000
464800         WHEN PS-OPER-STAT                                        46410000
464900             EXEC SQL                                             46420000
465000                  FETCH OPER-STATUS-CSR                           46430000
465100                  INTO  :PV-SYS-MAN-IND                           46440000
465200                     ,  :SUT00015-PO-NBR                          46450000
465300                     ,  :SUT00015-PO-LNE-NBR                      46460000
465400                     ,  :SUT00015-PO-PREPK-ID                     46470000
465500                     ,  :SUT00015-PKGNG-TYP-CDE                   46480000
465600                     ,  :SUT00015-OPER-UNT-ID                     46490000
465700                     ,  :SUT00015-RCVR-SEQ-NBR                    46500000
465800                     ,  :SUT00015-AUD-CNTL-NBR                    46510000
465900                     ,  :SUT00015-AUD-STAT-CDE                    46520000
466000                     ,  :SUT00015-DFRD-AUD-IND                    46530000
466100                     ,  :SUT00015-AUD-ERR-PCT                     46540000
466200                     ,  :SUT00015-CRE-TMST                        46550000
466300                     ,  :SUT00015-MOD-QTY-IND                     46560000
466400                     ,  :SUNAUD-AUD-STAT-CDE                      46570000
466500                     ,  :SUNAUD-AUD-TYP-CDE                       46580000
466600                     ,  :PV-CSR-SEQ-DATE                          46590000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  46600000
466700             END-EXEC                                             46610000
466800         WHEN PS-OPER-STAT-DATE                                   46620000
466900             EXEC SQL                                             46630000
467000                  FETCH OPER-STAT-DATE-CSR                        46640000
467100                  INTO  :PV-SYS-MAN-IND                           46650000
467200                     ,  :SUT00015-PO-NBR                          46660000
467300                     ,  :SUT00015-PO-LNE-NBR                      46670000
467400                     ,  :SUT00015-PO-PREPK-ID                     46680000
467500                     ,  :SUT00015-PKGNG-TYP-CDE                   46690000
467600                     ,  :SUT00015-OPER-UNT-ID                     46700000
467700                     ,  :SUT00015-RCVR-SEQ-NBR                    46710000
467800                     ,  :SUT00015-AUD-CNTL-NBR                    46720000
467900                     ,  :SUT00015-AUD-STAT-CDE                    46730000
468000                     ,  :SUT00015-DFRD-AUD-IND                    46740000
468100                     ,  :SUT00015-AUD-ERR-PCT                     46750000
468200                     ,  :SUT00015-CRE-TMST                        46760000
468300                     ,  :SUT00015-MOD-QTY-IND                     46770000
468400                     ,  :SUNAUD-AUD-STAT-CDE                      46780000
468500                     ,  :SUNAUD-AUD-TYP-CDE                       46790000
468600                     ,  :PV-CSR-SEQ-DATE                          46800000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  46810000
468700             END-EXEC                                             46820000
468800         WHEN PS-OPER-DATE                                        46830000
468900             EXEC SQL                                             46840000
469000                  FETCH OPER-DATE-CSR                             46850000
469100                  INTO  :PV-SYS-MAN-IND                           46860000
469200                     ,  :SUT00015-PO-NBR                          46870000
469300                     ,  :SUT00015-PO-LNE-NBR                      46880000
469400                     ,  :SUT00015-PO-PREPK-ID                     46890000
469500                     ,  :SUT00015-PKGNG-TYP-CDE                   46900000
469600                     ,  :SUT00015-OPER-UNT-ID                     46910000
469700                     ,  :SUT00015-RCVR-SEQ-NBR                    46920000
469800                     ,  :SUT00015-AUD-CNTL-NBR                    46930000
469900                     ,  :SUT00015-AUD-STAT-CDE                    46940000
470000                     ,  :SUT00015-DFRD-AUD-IND                    46950000
470100                     ,  :SUT00015-AUD-ERR-PCT                     46960000
470200                     ,  :SUT00015-CRE-TMST                        46970000
470300                     ,  :SUT00015-MOD-QTY-IND                     46980000
470400                     ,  :SUNAUD-AUD-STAT-CDE                      46990000
470500                     ,  :SUNAUD-AUD-TYP-CDE                       47000000
470600                     ,  :PV-CSR-SEQ-DATE                          47010000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  47020000
470700             END-EXEC                                             47030000
470800         WHEN PS-PO-RCVR                                          47040000
470900             EXEC SQL                                             47050000
471000                  FETCH PO-RECEIVER-CSR                           47060000
471100                  INTO  :PV-SYS-MAN-IND                           47070000
471200                     ,  :SUT00015-PO-NBR                          47080000
471300                     ,  :SUT00015-PO-LNE-NBR                      47090000
471400                     ,  :SUT00015-PO-PREPK-ID                     47100000
471500                     ,  :SUT00015-PKGNG-TYP-CDE                   47110000
471600                     ,  :SUT00015-OPER-UNT-ID                     47120000
471700                     ,  :SUT00015-RCVR-SEQ-NBR                    47130000
471800                     ,  :SUT00015-AUD-CNTL-NBR                    47140000
471900                     ,  :SUT00015-AUD-STAT-CDE                    47150000
472000                     ,  :SUT00015-DFRD-AUD-IND                    47160000
472100                     ,  :SUT00015-AUD-ERR-PCT                     47170000
472200                     ,  :SUT00015-CRE-TMST                        47180000
472300                     ,  :SUT00015-MOD-QTY-IND                     47190000
472400                     ,  :SUNAUD-AUD-STAT-CDE                      47200000
472500                     ,  :SUNAUD-AUD-TYP-CDE                       47210000
472600                     ,  :PV-CSR-SEQ-DATE                          47220000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  47230000
472700             END-EXEC                                             47240000
472800         WHEN PS-PO-RCVR-ALL-STATS                                47250000
472900             EXEC SQL                                             47260000
473000                  FETCH PO-RCVR-ALL-CSR                           47270000
473100                  INTO  :PV-SYS-MAN-IND                           47280000
473200                     ,  :SUT00015-PO-NBR                          47290000
473300                     ,  :SUT00015-PO-LNE-NBR                      47300000
473400                     ,  :SUT00015-PO-PREPK-ID                     47310000
473500                     ,  :SUT00015-PKGNG-TYP-CDE                   47320000
473600                     ,  :SUT00015-OPER-UNT-ID                     47330000
473700                     ,  :SUT00015-RCVR-SEQ-NBR                    47340000
473800                     ,  :SUT00015-AUD-CNTL-NBR                    47350000
473900                     ,  :SUT00015-AUD-STAT-CDE                    47360000
474000                     ,  :SUT00015-DFRD-AUD-IND                    47370000
474100                     ,  :SUT00015-AUD-ERR-PCT                     47380000
474200                     ,  :SUT00015-CRE-TMST                        47390000
474300                     ,  :SUT00015-MOD-QTY-IND                     47400000
474400                     ,  :SUNAUD-AUD-STAT-CDE                      47410000
474500                     ,  :SUNAUD-AUD-TYP-CDE                       47420000
474600                     ,  :PV-CSR-SEQ-DATE                          47430000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  47440000
474700             END-EXEC                                             47450000
474800         WHEN PS-PO                                               47460000
474900             EXEC SQL                                             47470000
475000                  FETCH PO-CSR                                    47480000
475100                  INTO  :PV-SYS-MAN-IND                           47490000
475200                     ,  :SUT00015-PO-NBR                          47500000
475300                     ,  :SUT00015-PO-LNE-NBR                      47510000
475400                     ,  :SUT00015-PO-PREPK-ID                     47520000
475500                     ,  :SUT00015-PKGNG-TYP-CDE                   47530000
475600                     ,  :SUT00015-OPER-UNT-ID                     47540000
475700                     ,  :SUT00015-RCVR-SEQ-NBR                    47550000
475800                     ,  :SUT00015-AUD-CNTL-NBR                    47560000
475900                     ,  :SUT00015-AUD-STAT-CDE                    47570000
476000                     ,  :SUT00015-DFRD-AUD-IND                    47580000
476100                     ,  :SUT00015-AUD-ERR-PCT                     47590000
476200                     ,  :SUT00015-CRE-TMST                        47600000
476300                     ,  :SUT00015-MOD-QTY-IND                     47610000
476400                     ,  :SUNAUD-AUD-STAT-CDE                      47620000
476500                     ,  :SUNAUD-AUD-TYP-CDE                       47630000
476600                     ,  :PV-CSR-SEQ-DATE                          47640000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  47650000
476700             END-EXEC                                             47660000
476800         WHEN PS-OPER-ENT-DEPT-DATE                               47670000
476900             EXEC SQL                                             47680000
477000                  FETCH OP-ENT-DPT-DAT-CSR                        47690000
477100                  INTO  :PV-SYS-MAN-IND                           47700000
477200                     ,  :SUT00015-PO-NBR                          47710000
477300                     ,  :SUT00015-PO-LNE-NBR                      47720000
477400                     ,  :SUT00015-PO-PREPK-ID                     47730000
477500                     ,  :SUT00015-PKGNG-TYP-CDE                   47740000
477600                     ,  :SUT00015-OPER-UNT-ID                     47750000
477700                     ,  :SUT00015-RCVR-SEQ-NBR                    47760000
477800                     ,  :SUT00015-AUD-CNTL-NBR                    47770000
477900                     ,  :SUT00015-AUD-STAT-CDE                    47780000
478000                     ,  :SUT00015-DFRD-AUD-IND                    47790000
478100                     ,  :SUT00015-AUD-ERR-PCT                     47800000
478200                     ,  :SUT00015-CRE-TMST                        47810000
478300                     ,  :SUT00015-MOD-QTY-IND                     47820000
478400                     ,  :SUNAUD-AUD-STAT-CDE                      47830000
478500                     ,  :SUNAUD-AUD-TYP-CDE                       47840000
478600                     ,  :PV-CSR-SEQ-DATE                          47850000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  47860000
478700             END-EXEC                                             47870000
478800         WHEN PS-OPER-ENT-DATE                                    47880000
478900             EXEC SQL                                             47890000
479000                  FETCH OPER-ENT-DATE-CSR                         47900000
479100                  INTO  :PV-SYS-MAN-IND                           47910000
479200                     ,  :SUT00015-PO-NBR                          47920000
479300                     ,  :SUT00015-PO-LNE-NBR                      47930000
479400                     ,  :SUT00015-PO-PREPK-ID                     47940000
479500                     ,  :SUT00015-PKGNG-TYP-CDE                   47950000
479600                     ,  :SUT00015-OPER-UNT-ID                     47960000
479700                     ,  :SUT00015-RCVR-SEQ-NBR                    47970000
479800                     ,  :SUT00015-AUD-CNTL-NBR                    47980000
479900                     ,  :SUT00015-AUD-STAT-CDE                    47990000
480000                     ,  :SUT00015-DFRD-AUD-IND                    48000000
480100                     ,  :SUT00015-AUD-ERR-PCT                     48010000
480200                     ,  :SUT00015-CRE-TMST                        48020000
480300                     ,  :SUT00015-MOD-QTY-IND                     48030000
480400                     ,  :SUNAUD-AUD-STAT-CDE                      48040000
480500                     ,  :SUNAUD-AUD-TYP-CDE                       48050000
480600                     ,  :PV-CSR-SEQ-DATE                          48060000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  48061000
480700             END-EXEC                                             48062000
480800         WHEN PS-ENT-DEPT-DATE                                    48063000
480900             EXEC SQL                                             48064000
481000                  FETCH ENT-DEPT-DATE-CSR                         48065000
481100                  INTO  :PV-SYS-MAN-IND                           48066000
481200                     ,  :SUT00015-PO-NBR                          48067000
481300                     ,  :SUT00015-PO-LNE-NBR                      48068000
481400                     ,  :SUT00015-PO-PREPK-ID                     48069000
481500                     ,  :SUT00015-PKGNG-TYP-CDE                   48070000
481600                     ,  :SUT00015-OPER-UNT-ID                     48080000
481700                     ,  :SUT00015-RCVR-SEQ-NBR                    48090000
481800                     ,  :SUT00015-AUD-CNTL-NBR                    48100000
481900                     ,  :SUT00015-AUD-STAT-CDE                    48110000
482000                     ,  :SUT00015-DFRD-AUD-IND                    48120000
482100                     ,  :SUT00015-AUD-ERR-PCT                     48130000
482200                     ,  :SUT00015-CRE-TMST                        48140000
482300                     ,  :SUT00015-MOD-QTY-IND                     48150000
482400                     ,  :SUNAUD-AUD-STAT-CDE                      48160000
482500                     ,  :SUNAUD-AUD-TYP-CDE                       48170000
482600                     ,  :PV-CSR-SEQ-DATE                          48180000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  48190000
482700             END-EXEC                                             48200000
482800         WHEN PS-ENT-DATE                                         48210000
482900             EXEC SQL                                             48220000
483000                  FETCH ENT-DATE-CSR                              48230000
483100                  INTO  :PV-SYS-MAN-IND                           48240000
483200                     ,  :SUT00015-PO-NBR                          48250000
483300                     ,  :SUT00015-PO-LNE-NBR                      48260000
483400                     ,  :SUT00015-PO-PREPK-ID                     48270000
483500                     ,  :SUT00015-PKGNG-TYP-CDE                   48280000
483600                     ,  :SUT00015-OPER-UNT-ID                     48290000
483700                     ,  :SUT00015-RCVR-SEQ-NBR                    48300000
483800                     ,  :SUT00015-AUD-CNTL-NBR                    48310000
483900                     ,  :SUT00015-AUD-STAT-CDE                    48320000
484000                     ,  :SUT00015-DFRD-AUD-IND                    48330000
484100                     ,  :SUT00015-AUD-ERR-PCT                     48340000
484200                     ,  :SUT00015-CRE-TMST                        48350000
484300                     ,  :SUT00015-MOD-QTY-IND                     48360000
484400                     ,  :SUNAUD-AUD-STAT-CDE                      48370000
484500                     ,  :SUNAUD-AUD-TYP-CDE                       48380000
484600                     ,  :PV-CSR-SEQ-DATE                          48390000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  48400000
484700             END-EXEC                                             48410000
484800         WHEN PS-OPER-ENT                                         48420000
484900             EXEC SQL                                             48430000
485000                  FETCH OPER-ENT-ID                               48440000
485100                  INTO  :PV-SYS-MAN-IND                           48450000
485200                     ,  :SUT00015-PO-NBR                          48460000
485300                     ,  :SUT00015-PO-LNE-NBR                      48470000
485400                     ,  :SUT00015-PO-PREPK-ID                     48480000
485500                     ,  :SUT00015-PKGNG-TYP-CDE                   48490000
485600                     ,  :SUT00015-OPER-UNT-ID                     48500000
485700                     ,  :SUT00015-RCVR-SEQ-NBR                    48510000
485800                     ,  :SUT00015-AUD-CNTL-NBR                    48520000
485900                     ,  :SUT00015-AUD-STAT-CDE                    48530000
486000                     ,  :SUT00015-DFRD-AUD-IND                    48540000
486100                     ,  :SUT00015-AUD-ERR-PCT                     48550000
486200                     ,  :SUT00015-CRE-TMST                        48560000
486300                     ,  :SUT00015-MOD-QTY-IND                     48570000
486400                     ,  :SUNAUD-AUD-STAT-CDE                      48580000
486500                     ,  :SUNAUD-AUD-TYP-CDE                       48590000
486600                     ,  :PV-CSR-SEQ-DATE                          48600000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  48610000
486700             END-EXEC                                             48620000
486800         WHEN PS-ENT                                              48630000
486900             EXEC SQL                                             48640000
487000                  FETCH ENT-CSR                                   48650000
487100                  INTO  :PV-SYS-MAN-IND                           48660000
487200                     ,  :SUT00015-PO-NBR                          48670000
487300                     ,  :SUT00015-PO-LNE-NBR                      48680000
487400                     ,  :SUT00015-PO-PREPK-ID                     48690000
487500                     ,  :SUT00015-PKGNG-TYP-CDE                   48700000
487600                     ,  :SUT00015-OPER-UNT-ID                     48710000
487700                     ,  :SUT00015-RCVR-SEQ-NBR                    48720000
487800                     ,  :SUT00015-AUD-CNTL-NBR                    48730000
487900                     ,  :SUT00015-AUD-STAT-CDE                    48740000
488000                     ,  :SUT00015-DFRD-AUD-IND                    48750000
488100                     ,  :SUT00015-AUD-ERR-PCT                     48760000
488200                     ,  :SUT00015-CRE-TMST                        48770000
488300                     ,  :SUT00015-MOD-QTY-IND                     48780000
488400                     ,  :SUNAUD-AUD-STAT-CDE                      48790000
488500                     ,  :SUNAUD-AUD-TYP-CDE                       48800000
488600                     ,  :PV-CSR-SEQ-DATE                          48810000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  48820000
488700             END-EXEC                                             48830000
488800         WHEN PS-AUDIT                                            48840000
488900             EXEC SQL                                             48850000
489000                  FETCH AUDIT-CSR                                 48860000
489100                  INTO  :PV-SYS-MAN-IND                           48870000
489200                     ,  :SUT00015-PO-NBR                          48880000
489300                     ,  :SUT00015-PO-LNE-NBR                      48890000
489400                     ,  :SUT00015-PO-PREPK-ID                     48900000
489500                     ,  :SUT00015-PKGNG-TYP-CDE                   48910000
489600                     ,  :SUT00015-OPER-UNT-ID                     48920000
489700                     ,  :SUT00015-RCVR-SEQ-NBR                    48930000
489800                     ,  :SUT00015-AUD-CNTL-NBR                    48940000
489900                     ,  :SUT00015-AUD-STAT-CDE                    48950000
490000                     ,  :SUT00015-DFRD-AUD-IND                    48960000
490100                     ,  :SUT00015-AUD-ERR-PCT                     48970000
490200                     ,  :SUT00015-CRE-TMST                        48980000
490300                     ,  :SUT00015-MOD-QTY-IND                     48990000
490400                     ,  :SUNAUD-AUD-STAT-CDE                      49000000
490500                     ,  :SUNAUD-AUD-TYP-CDE                       49010000
490600                     ,  :PV-CSR-SEQ-DATE                          49020000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  49030000
490700             END-EXEC                                             49040000
490800         WHEN PS-MAN-AUDIT                                        49050000
490900             EXEC SQL                                             49060000
491000                  FETCH MAN-AUDIT-CSR                             49070000
491100                  INTO  :PV-SYS-MAN-IND                           49080000
491200                     ,  :SUATRN-TRN-NBR                           49090000
491300                     ,  :SUT00015-PO-LNE-NBR                      49100000
491400                     ,  :SUT00015-PO-PREPK-ID                     49110000
491500                     ,  :SUNAUD-OPER-UNT-ID                       49120000
491600                     ,  :SUATRN-REC-SEQ-NBR                       49130000
491700                     ,  :SUNAUD-AUD-CNTL-NBR                      49140000
491800                     ,  :SUT00015-AUD-STAT-CDE                    49150000
491900                     ,  :SUT00015-DFRD-AUD-IND                    49160000
492000                     ,  :SUT00015-AUD-ERR-PCT                     49170000
492100                     ,  :SUNAUD-AUD-STRT-TMST                     49180000
492200                     ,  :SUNAUD-AUD-STAT-CDE                      49190000
492300                     ,  :SUNAUD-AUD-TYP-CDE                       49200000
492400                     ,  :PV-CSR-SEQ-DATE                          49210000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            49220000
492500             END-EXEC                                             49230000
492600         WHEN PS-MAN-OPER-DTE                                     49240000
492700             EXEC SQL                                             49250000
492800                  FETCH MAN-OPER-DTE-CSR                          49260000
492900                  INTO  :PV-SYS-MAN-IND                           49270000
493000                     ,  :SUATRN-TRN-NBR                           49280000
493100                     ,  :SUT00015-PO-LNE-NBR                      49290000
493200                     ,  :SUT00015-PO-PREPK-ID                     49300000
493300                     ,  :SUNAUD-OPER-UNT-ID                       49310000
493400                     ,  :SUATRN-REC-SEQ-NBR                       49320000
493500                     ,  :SUNAUD-AUD-CNTL-NBR                      49330000
493600                     ,  :SUT00015-AUD-STAT-CDE                    49340000
493700                     ,  :SUT00015-DFRD-AUD-IND                    49350000
493800                     ,  :SUT00015-AUD-ERR-PCT                     49360000
493900                     ,  :SUNAUD-AUD-STRT-TMST                     49370000
494000                     ,  :SUNAUD-AUD-STAT-CDE                      49380000
494100                     ,  :SUNAUD-AUD-TYP-CDE                       49390000
494200                     ,  :PV-CSR-SEQ-DATE                          49400000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            49410000
494300             END-EXEC                                             49420000
494400         WHEN PS-MAN-OPER-STAT-DTE                                49430000
494500             EXEC SQL                                             49440000
494600                  FETCH MAN-OP-STAT-DT-CSR                        49450000
494700                  INTO  :PV-SYS-MAN-IND                           49460000
494800                     ,  :SUATRN-TRN-NBR                           49470000
494900                     ,  :SUT00015-PO-LNE-NBR                      49480000
495000                     ,  :SUT00015-PO-PREPK-ID                     49490000
495100                     ,  :SUNAUD-OPER-UNT-ID                       49500000
495200                     ,  :SUATRN-REC-SEQ-NBR                       49510000
495300                     ,  :SUNAUD-AUD-CNTL-NBR                      49520000
495400                     ,  :SUT00015-AUD-STAT-CDE                    49530000
495500                     ,  :SUT00015-DFRD-AUD-IND                    49540000
495600                     ,  :SUT00015-AUD-ERR-PCT                     49550000
495700                     ,  :SUNAUD-AUD-STRT-TMST                     49560000
495800                     ,  :SUNAUD-AUD-STAT-CDE                      49570000
495900                     ,  :SUNAUD-AUD-TYP-CDE                       49580000
496000                     ,  :PV-CSR-SEQ-DATE                          49590000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            49600000
496100             END-EXEC                                             49610000
496200         WHEN PS-MAN-OPER                                         49620000
496300             EXEC SQL                                             49630000
496400                  FETCH MAN-OPER-CSR                              49640000
496500                  INTO  :PV-SYS-MAN-IND                           49650000
496600                     ,  :SUATRN-TRN-NBR                           49660000
496700                     ,  :SUT00015-PO-LNE-NBR                      49670000
496800                     ,  :SUT00015-PO-PREPK-ID                     49680000
496900                     ,  :SUNAUD-OPER-UNT-ID                       49690000
497000                     ,  :SUATRN-REC-SEQ-NBR                       49700000
497100                     ,  :SUNAUD-AUD-CNTL-NBR                      49710000
497200                     ,  :SUT00015-AUD-STAT-CDE                    49720000
497300                     ,  :SUT00015-DFRD-AUD-IND                    49730000
497400                     ,  :SUT00015-AUD-ERR-PCT                     49740000
497500                     ,  :SUNAUD-AUD-STRT-TMST                     49750000
497600                     ,  :SUNAUD-AUD-STAT-CDE                      49760000
497700                     ,  :SUNAUD-AUD-TYP-CDE                       49770000
497800                     ,  :PV-CSR-SEQ-DATE                          49780000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            49781000
497900             END-EXEC                                             49782000
498000         WHEN PS-MAN-OPER-STATUS                                  49783000
498100             EXEC SQL                                             49784000
498200                  FETCH MAN-OPER-STAT-CSR                         49785000
498300                  INTO  :PV-SYS-MAN-IND                           49786000
498400                     ,  :SUATRN-TRN-NBR                           49787000
498500                     ,  :SUT00015-PO-LNE-NBR                      49788000
498600                     ,  :SUT00015-PO-PREPK-ID                     49789000
498700                     ,  :SUNAUD-OPER-UNT-ID                       49790000
498800                     ,  :SUATRN-REC-SEQ-NBR                       49800000
498900                     ,  :SUNAUD-AUD-CNTL-NBR                      49810000
499000                     ,  :SUT00015-AUD-STAT-CDE                    49820000
499100                     ,  :SUT00015-DFRD-AUD-IND                    49830000
499200                     ,  :SUT00015-AUD-ERR-PCT                     49840000
499300                     ,  :SUNAUD-AUD-STRT-TMST                     49850000
499400                     ,  :SUNAUD-AUD-STAT-CDE                      49860000
499500                     ,  :SUNAUD-AUD-TYP-CDE                       49870000
499600                     ,  :PV-CSR-SEQ-DATE                          49880000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            49890000
499700             END-EXEC                                             49900000
499800         WHEN PS-ALL-AUDIT                                        49910000
499900             EXEC SQL                                             49920000
500000                  FETCH ALL-AUDIT-CSR                             49930000
500100                  INTO  :PV-SYS-MAN-IND                           49940000
500200                     ,  :SUT00015-PO-NBR                          49950000
500300                     ,  :SUT00015-PO-LNE-NBR                      49960000
500400                     ,  :SUT00015-PO-PREPK-ID                     49970000
500500                     ,  :SUT00015-PKGNG-TYP-CDE                   49980000
500600                     ,  :SUT00015-OPER-UNT-ID                     49990000
500700                     ,  :SUT00015-RCVR-SEQ-NBR                    50000000
500800                     ,  :SUT00015-AUD-CNTL-NBR                    50010000
500900                     ,  :SUT00015-AUD-STAT-CDE                    50020000
501000                     ,  :SUT00015-DFRD-AUD-IND                    50030000
501100                     ,  :SUT00015-AUD-ERR-PCT                     50040000
501200                     ,  :SUT00015-CRE-TMST                        50050000
501300                     ,  :SUT00015-MOD-QTY-IND                     50060000
501400                     ,  :SUNAUD-AUD-STAT-CDE                      50070000
501500                     ,  :SUNAUD-AUD-TYP-CDE                       50080000
501600                     ,  :PV-CSR-SEQ-DATE                          50090000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  50100000
501700             END-EXEC                                             50110000
501800         WHEN PS-ALL-OPER-DTE                                     50120000
501900             EXEC SQL                                             50130000
502000                  FETCH ALL-OPER-DTE-CSR                          50140000
502100                  INTO  :PV-SYS-MAN-IND                           50150000
502200                     ,  :SUT00015-PO-NBR                          50160000
502300                     ,  :SUT00015-PO-LNE-NBR                      50170000
502400                     ,  :SUT00015-PO-PREPK-ID                     50180000
502500                     ,  :SUT00015-PKGNG-TYP-CDE                   50190000
502600                     ,  :SUT00015-OPER-UNT-ID                     50200000
502700                     ,  :SUT00015-RCVR-SEQ-NBR                    50210000
502800                     ,  :SUT00015-AUD-CNTL-NBR                    50220000
502900                     ,  :SUT00015-AUD-STAT-CDE                    50230000
503000                     ,  :SUT00015-DFRD-AUD-IND                    50240000
503100                     ,  :SUT00015-AUD-ERR-PCT                     50250000
503200                     ,  :SUT00015-CRE-TMST                        50260000
503300                     ,  :SUT00015-MOD-QTY-IND                     50270000
503400                     ,  :SUNAUD-AUD-STAT-CDE                      50280000
503500                     ,  :SUNAUD-AUD-TYP-CDE                       50290000
503600                     ,  :PV-CSR-SEQ-DATE                          50300000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  50310000
503700             END-EXEC                                             50320000
503800         WHEN PS-ALL-OPER-STAT-DTE                                50330000
503900             EXEC SQL                                             50340000
504000                  FETCH ALL-OP-STAT-DT-CSR                        50350000
504100                  INTO  :PV-SYS-MAN-IND                           50360000
504200                     ,  :SUT00015-PO-NBR                          50370000
504300                     ,  :SUT00015-PO-LNE-NBR                      50380000
504400                     ,  :SUT00015-PO-PREPK-ID                     50390000
504500                     ,  :SUT00015-PKGNG-TYP-CDE                   50400000
504600                     ,  :SUT00015-OPER-UNT-ID                     50410000
504700                     ,  :SUT00015-RCVR-SEQ-NBR                    50420000
504800                     ,  :SUT00015-AUD-CNTL-NBR                    50430000
504900                     ,  :SUT00015-AUD-STAT-CDE                    50440000
505000                     ,  :SUT00015-DFRD-AUD-IND                    50450000
505100                     ,  :SUT00015-AUD-ERR-PCT                     50460000
505200                     ,  :SUT00015-CRE-TMST                        50470000
505300                     ,  :SUT00015-MOD-QTY-IND                     50480000
505400                     ,  :SUNAUD-AUD-STAT-CDE                      50490000
505500                     ,  :SUNAUD-AUD-TYP-CDE                       50500000
505600                     ,  :PV-CSR-SEQ-DATE                          50510000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  50520000
505700             END-EXEC                                             50530000
505800         WHEN PS-ALL-OPER                                         50540000
505900             EXEC SQL                                             50550000
506000                  FETCH ALL-OPER-CSR                              50560000
506100                  INTO  :PV-SYS-MAN-IND                           50570000
506200                     ,  :SUT00015-PO-NBR                          50580000
506300                     ,  :SUT00015-PO-LNE-NBR                      50590000
506400                     ,  :SUT00015-PO-PREPK-ID                     50600000
506500                     ,  :SUT00015-PKGNG-TYP-CDE                   50610000
506600                     ,  :SUT00015-OPER-UNT-ID                     50620000
506700                     ,  :SUT00015-RCVR-SEQ-NBR                    50630000
506800                     ,  :SUT00015-AUD-CNTL-NBR                    50640000
506900                     ,  :SUT00015-AUD-STAT-CDE                    50650000
507000                     ,  :SUT00015-DFRD-AUD-IND                    50660000
507100                     ,  :SUT00015-AUD-ERR-PCT                     50670000
507200                     ,  :SUT00015-CRE-TMST                        50680000
507300                     ,  :SUT00015-MOD-QTY-IND                     50690000
507400                     ,  :SUNAUD-AUD-STAT-CDE                      50700000
507500                     ,  :SUNAUD-AUD-TYP-CDE                       50710000
507600                     ,  :PV-CSR-SEQ-DATE                          50720000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  50730000
507700             END-EXEC                                             50740000
507800         WHEN PS-ALL-OPER-STATUS                                  50750000
507900             EXEC SQL                                             50760000
508000                  FETCH ALL-OPER-STAT-CSR                         50770000
508100                  INTO  :PV-SYS-MAN-IND                           50780000
508200                     ,  :SUT00015-PO-NBR                          50790000
508300                     ,  :SUT00015-PO-LNE-NBR                      50800000
508400                     ,  :SUT00015-PO-PREPK-ID                     50810000
508500                     ,  :SUT00015-PKGNG-TYP-CDE                   50820000
508600                     ,  :SUT00015-OPER-UNT-ID                     50830000
508700                     ,  :SUT00015-RCVR-SEQ-NBR                    50840000
508800                     ,  :SUT00015-AUD-CNTL-NBR                    50850000
508900                     ,  :SUT00015-AUD-STAT-CDE                    50860000
509000                     ,  :SUT00015-DFRD-AUD-IND                    50870000
509100                     ,  :SUT00015-AUD-ERR-PCT                     50880000
509200                     ,  :SUT00015-CRE-TMST                        50890000
509300                     ,  :SUT00015-MOD-QTY-IND                     50900000
509400                     ,  :SUNAUD-AUD-STAT-CDE                      50910000
509500                     ,  :SUNAUD-AUD-TYP-CDE                       50920000
509600                     ,  :PV-CSR-SEQ-DATE                          50930000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  50940000
509700             END-EXEC                                             50950000
509800         WHEN PS-ALL-CRTN                                         50960000
509900             EXEC SQL                                             50970000
510000                  FETCH ALL-CRTN-CSR                              50980000
510100                  INTO  :PV-SYS-MAN-IND                           50990000
510200                     ,  :SUT00015-PO-NBR                          51000000
510300                     ,  :SUT00015-PO-LNE-NBR                      51010000
510400                     ,  :SUT00015-PO-PREPK-ID                     51020000
510500                     ,  :SUT00015-PKGNG-TYP-CDE                   51030000
510600                     ,  :SUT00015-OPER-UNT-ID                     51040000
510700                     ,  :SUT00015-RCVR-SEQ-NBR                    51050000
510800                     ,  :SUT00015-AUD-CNTL-NBR                    51060000
510900                     ,  :SUT00015-AUD-STAT-CDE                    51070000
511000                     ,  :SUT00015-DFRD-AUD-IND                    51080000
511100                     ,  :SUT00015-AUD-ERR-PCT                     51090000
511200                     ,  :SUT00015-CRE-TMST                        51100000
511300                     ,  :SUT00015-MOD-QTY-IND                     51110000
511400                     ,  :SUNAUD-AUD-STAT-CDE                      51120000
511500                     ,  :SUNAUD-AUD-TYP-CDE                       51130000
511600                     ,  :PV-CSR-SEQ-DATE                          51140000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  51150000
511700             END-EXEC                                             51160000
511800         WHEN PS-ALL-CRTN-AUDT                                    51170000
511900             EXEC SQL                                             51180000
512000                  FETCH ALL-CRTN-AUDT-CSR                         51190000
512100                  INTO  :PV-SYS-MAN-IND                           51200000
512200                     ,  :SUT00015-PO-NBR                          51210000
512300                     ,  :SUT00015-PO-LNE-NBR                      51220000
512400                     ,  :SUT00015-PO-PREPK-ID                     51230000
512500                     ,  :SUT00015-PKGNG-TYP-CDE                   51240000
512600                     ,  :SUT00015-OPER-UNT-ID                     51250000
512700                     ,  :SUT00015-RCVR-SEQ-NBR                    51260000
512800                     ,  :SUT00015-AUD-CNTL-NBR                    51270000
512900                     ,  :SUT00015-AUD-STAT-CDE                    51280000
513000                     ,  :SUT00015-DFRD-AUD-IND                    51290000
513100                     ,  :SUT00015-AUD-ERR-PCT                     51300000
513200                     ,  :SUT00015-CRE-TMST                        51310000
513300                     ,  :SUT00015-MOD-QTY-IND                     51320000
513400                     ,  :SUNAUD-AUD-STAT-CDE                      51330000
513500                     ,  :SUNAUD-AUD-TYP-CDE                       51340000
513600                     ,  :PV-CSR-SEQ-DATE                          51350000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  51360000
513700             END-EXEC                                             51370000
513800         WHEN PS-MAN-CRTN                                         51380000
513900             EXEC SQL                                             51390000
514000                  FETCH MAN-CRTN-CSR                              51400000
514100                  INTO  :PV-SYS-MAN-IND                           51410000
514200                     ,  :SUATRN-TRN-NBR                           51420000
514300                     ,  :SUT00015-PO-LNE-NBR                      51430000
514400                     ,  :SUT00015-PO-PREPK-ID                     51440000
514500                     ,  :SUNAUD-OPER-UNT-ID                       51450000
514600                     ,  :SUATRN-REC-SEQ-NBR                       51460000
514700                     ,  :SUNAUD-AUD-CNTL-NBR                      51470000
514800                     ,  :SUT00015-AUD-STAT-CDE                    51480000
514900                     ,  :SUT00015-DFRD-AUD-IND                    51490000
515000                     ,  :SUT00015-AUD-ERR-PCT                     51500000
515100                     ,  :SUNAUD-AUD-STRT-TMST                     51510000
515200                     ,  :SUNAUD-AUD-STAT-CDE                      51520000
515300                     ,  :SUNAUD-AUD-TYP-CDE                       51530000
515400                     ,  :PV-CSR-SEQ-DATE                          51540000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  51541000
515500             END-EXEC                                             51542000
515600         WHEN PS-MAN-CRTN-AUDT                                    51543000
515700             EXEC SQL                                             51544000
515800                  FETCH MAN-CRTN-AUDT-CSR                         51545000
515900                  INTO  :PV-SYS-MAN-IND                           51546000
516000                     ,  :SUATRN-TRN-NBR                           51547000
516100                     ,  :SUT00015-PO-LNE-NBR                      51548000
516200                     ,  :SUT00015-PO-PREPK-ID                     51549000
516300                     ,  :SUNAUD-OPER-UNT-ID                       51550000
516400                     ,  :SUATRN-REC-SEQ-NBR                       51560000
516500                     ,  :SUNAUD-AUD-CNTL-NBR                      51570000
516600                     ,  :SUT00015-AUD-STAT-CDE                    51580000
516700                     ,  :SUT00015-DFRD-AUD-IND                    51590000
516800                     ,  :SUT00015-AUD-ERR-PCT                     51600000
516900                     ,  :SUNAUD-AUD-STRT-TMST                     51610000
517000                     ,  :SUNAUD-AUD-STAT-CDE                      51620000
517100                     ,  :SUNAUD-AUD-TYP-CDE                       51630000
517200                     ,  :PV-CSR-SEQ-DATE                          51640000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            51650000
517300             END-EXEC                                             51660000
517400         WHEN PS-ALL-SYSTEM                                       51670000
517500             EXEC SQL                                             51680000
517600                  FETCH ALL-SYSTEM-CSR                            51690000
517700                  INTO  :PV-SYS-MAN-IND                           51700000
517800                     ,  :SUT00015-PO-NBR                          51710000
517900                     ,  :SUT00015-PO-LNE-NBR                      51720000
518000                     ,  :SUT00015-PO-PREPK-ID                     51730000
518100                     ,  :SUT00015-PKGNG-TYP-CDE                   51740000
518200                     ,  :SUT00015-OPER-UNT-ID                     51750000
518300                     ,  :SUT00015-RCVR-SEQ-NBR                    51760000
518400                     ,  :SUT00015-AUD-CNTL-NBR                    51770000
518500                     ,  :SUT00015-AUD-STAT-CDE                    51780000
518600                     ,  :SUT00015-DFRD-AUD-IND                    51790000
518700                     ,  :SUT00015-AUD-ERR-PCT                     51800000
518800                     ,  :SUT00015-CRE-TMST                        51810000
518900                     ,  :SUT00015-MOD-QTY-IND                     51820000
519000                     ,  :SUNAUD-AUD-STAT-CDE                      51830000
519100                     ,  :SUNAUD-AUD-TYP-CDE                       51840000
519200                     ,  :PV-CSR-SEQ-DATE                          51850000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  51860000
519300             END-EXEC                                             51870000
519400         WHEN PS-ALL-MANUAL                                       51880000
519500             EXEC SQL                                             51890000
519600                  FETCH ALL-MANUAL-CSR                            51900000
519700                  INTO  :PV-SYS-MAN-IND                           51910000
519800                     ,  :SUATRN-TRN-NBR                           51920000
519900                     ,  :SUT00015-PO-LNE-NBR                      51930000
520000                     ,  :SUT00015-PO-PREPK-ID                     51940000
520100                     ,  :SUNAUD-OPER-UNT-ID                       51950000
520200                     ,  :SUATRN-REC-SEQ-NBR                       51960000
520300                     ,  :SUNAUD-AUD-CNTL-NBR                      51970000
520400                     ,  :SUT00015-AUD-STAT-CDE                    51980000
520500                     ,  :SUT00015-DFRD-AUD-IND                    51990000
520600                     ,  :SUT00015-AUD-ERR-PCT                     52000000
520700                     ,  :SUNAUD-AUD-STRT-TMST                     52010000
520800                     ,  :SUNAUD-AUD-STAT-CDE                      52020000
520900                     ,  :SUNAUD-AUD-TYP-CDE                       52030000
521000                     ,  :PV-CSR-SEQ-DATE                          52040000
                           ,  :PV-CSR-AUDIT-NBR :PV-NULL-IND            52050000
521100             END-EXEC                                             52060000
521200         WHEN PS-ALL-ALL                                          52070000
521300             EXEC SQL                                             52080000
521400                  FETCH ALL-ALL-CSR                               52090000
521500                  INTO  :PV-SYS-MAN-IND                           52100000
521600                     ,  :SUT00015-PO-NBR                          52110000
521700                     ,  :SUT00015-PO-LNE-NBR                      52120000
521800                     ,  :SUT00015-PO-PREPK-ID                     52130000
521900                     ,  :SUT00015-PKGNG-TYP-CDE                   52140000
522000                     ,  :SUT00015-OPER-UNT-ID                     52150000
522100                     ,  :SUT00015-RCVR-SEQ-NBR                    52160000
522200                     ,  :SUT00015-AUD-CNTL-NBR                    52170000
522300                     ,  :SUT00015-AUD-STAT-CDE                    52180000
522400                     ,  :SUT00015-DFRD-AUD-IND                    52190000
522500                     ,  :SUT00015-AUD-ERR-PCT                     52200000
522600                     ,  :SUT00015-CRE-TMST                        52210000
522700                     ,  :SUT00015-MOD-QTY-IND                     52220000
522800                     ,  :SUNAUD-AUD-STAT-CDE                      52230000
522900                     ,  :SUNAUD-AUD-TYP-CDE                       52240000
523000                     ,  :PV-CSR-SEQ-DATE                          52250000
460300                     ,  :SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND  52260000
523100             END-EXEC                                             52270000
523200     END-EVALUATE.                                                52280000
523300                                                                  52290000
523400     EVALUATE TRUE                                                52300000
523500         WHEN SQLCODE = ZERO                                      52310000
523600         WHEN SQLCODE = +100                                      52320000
523700              CONTINUE                                            52330000
523800         WHEN SQLWARN0 NOT = SPACE                                52340000
523900         WHEN SQLCODE NOT = ZERO                                  52350000
524000              MOVE '4310-FETCH-CURSOR'                            52360000
524100                               TO DP013-PARAGRAPH                 52370000
524200              MOVE 'FETCH AUDIT CURSOR'                           52380000
524300                               TO DP013-MESSAGE-TEXT (1)          52390000
524400              MOVE 'SUT00015'  TO DP013-DB2-TABLE-NAME (1)        52400000
524500              MOVE SQLCA       TO DP013-SQLCA                     52410000
524600              SET DP013-DB2-ABEND                                 52420000
524700                               TO TRUE                            52430000
524800              PERFORM DP013-0000-PROCESS-ABEND                    52440000
524900     END-EVALUATE.                                                52450000
525000                                                                  52460000
525100     IF  SQLCODE EQUAL +100                                       52470000
525200         SET ASC-NO-ITEMS-LEFT-ON-DB                              52480000
525300                                   TO TRUE                        52490000
525400     ELSE                                                         52500000
525500         IF PS-MAN-AUDIT OR                                       52510000
525600            PS-MAN-OPER-DTE OR                                    52520000
525700            PS-MAN-OPER-STAT-DTE OR                               52530000
525800            PS-MAN-OPER OR                                        52540000
525900            PS-MAN-OPER-STATUS OR                                 52550000
526000            PS-MAN-CRTN OR                                        52560000
526100            PS-MAN-CRTN-AUDT OR                                   52570000
526200            PS-ALL-MANUAL                                         52580000
526300            MOVE SUNAUD-AUD-CNTL-NBR   TO DK-AUDIT-NBR            52590000
526400         ELSE                                                     52600000
526500            MOVE SUT00015-AUD-CNTL-NBR TO DK-AUDIT-NBR            52610000
526600         END-IF                                                   52620000
526700         PERFORM 4320-SELECT-TSUAUPC                              52630000
526800     END-IF.                                                      52640000
526900*                                                                 52650000
527000*                                                                 52660000
527100 4320-SELECT-TSUAUPC.                                             52670000
527200     EXEC SQL                                                     52680000
527300         SELECT DISTINCT                                          52690000
527400                SKU_NBR                                           52700000
527500          INTO :SUAUPC-SKU-NBR                                    52710000
527600          FROM TSUAUPC                                            52720000
527700          WHERE AUD_CNTL_NBR      = :DK-AUDIT-NBR                 52730000
527800     END-EXEC.                                                    52740000
527900                                                                  52750000
528000     EVALUATE TRUE                                                52760000
528100         WHEN SQLCODE = ZERO                                      52770000
528200             PERFORM 4350-CALL-XLKUT001                           52780000
528300         WHEN SQLCODE = +100                                      52790000
528400             SET PS-NO-UPC-SKU-FND TO TRUE                        52800000
528500         WHEN SQLCODE = -811                                      52810000
528600             SET PS-MULTI-SKU-FND  TO TRUE                        52820000
528700         WHEN SQLWARN0 NOT = SPACES                               52830000
528800         WHEN SQLCODE < +0                                        52840000
528900         WHEN SQLCODE > ZERO                                      52850000
529000             MOVE '4320-SELECT-TSUAUPC'                           52860000
529100                             TO DP013-PARAGRAPH                   52870000
529200             MOVE 'SELECT TSUAUPC'                                52880000
529300                             TO DP013-MESSAGE-TEXT (1)            52890000
529400             MOVE SQLCA      TO DP013-SQLCA                       52900000
529500             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME (1)          52910000
529600             SET DP013-DB2-ABEND                                  52920000
529700                             TO TRUE                              52930000
529800             SET DP013-XCTL-DISPLAY-RESTART                       52940000
529900                             TO TRUE                              52950000
530000             PERFORM DP013-0000-PROCESS-ABEND                     52960000
530100     END-EVALUATE.                                                52970000
530200*                                                                 52980000
530300                                                                  52990000
530400 4350-CALL-XLKUT001.                                              53000000
530500                                                                  53010000
530600     INITIALIZE XL001-ITEM-COMMAREA                               53020000
530700     SET XL001-SELECT-VND-STYL                                    53030000
530800         XL001-BY-NUMERIC-SKU         TO TRUE.                    53040000
530900                                                                  53050000
531000     MOVE SUAUPC-SKU-NBR              TO XL001-KEY-SKU.           53060000
531100                                                                  53070000
531200     CALL XL001-VSM-PGM  USING DFHEIBLK                           53080000
531300                              XL001-COMMAREA                      53090000
531400                              XL001-ITEM-COMMAREA.                53100000
531500                                                                  53110000
531600     EVALUATE TRUE                                                53120000
531700         WHEN XL001-SUCCESSFUL                                    53130000
531800         WHEN XL001-SKU-NOT-FOUND                                 53140000
531900             CONTINUE                                             53150000
532000         WHEN XL001-SQL-ERROR                                     53160000
532100         WHEN XL001-INVALID-ACCESS                                53170000
532200             IF XL001-SKU-SQLCODE > 0                             53180000
532300                 MOVE XL001-SKU-SQLCODE  TO PV-SQL-CODE           53190000
532400                 MOVE ' SKU-SQLCODE'     TO PV-SQL-CODE-DESC      53200000
532500             ELSE                                                 53210000
532600             IF XL001-VND-STYL-SQLCODE > 0                        53220000
532700                 MOVE XL001-VND-STYL-SQLCODE  TO PV-SQL-CODE      53230000
532800                 MOVE 'VND-STYL-SQLCODE'      TO PV-SQL-CODE-DESC 53240000
532900             ELSE                                                 53250000
533000             IF XL001-SKU-STR-SQLCODE > 0                         53260000
533100                 MOVE XL001-SKU-STR-SQLCODE  TO PV-SQL-CODE       53270000
533200                 MOVE 'SKU-STR-SQLCODE'      TO PV-SQL-CODE-DESC  53280000
533300             ELSE                                                 53290000
533400             IF XL001-UPC-SQLCODE > 0                             53300000
533500                 MOVE XL001-UPC-SQLCODE      TO PV-SQL-CODE       53310000
533600                 MOVE 'UPC-SQLCODE'          TO PV-SQL-CODE-DESC  53320000
533700             ELSE                                                 53330000
533800             IF XL001-WEB-SKU-SQLCODE > 0                         53340000
533900                 MOVE XL001-WEB-SKU-SQLCODE  TO PV-SQL-CODE       53350000
534000                 MOVE 'WEB-SKU-SQLCODE'      TO PV-SQL-CODE-DESC  53360000
534100             END-IF                                               53370000
534200             END-IF                                               53380000
534300             END-IF                                               53390000
534400             END-IF                                               53400000
534500             END-IF                                               53410000
534600             MOVE '4350-CALL-XLKUT001'                            53420000
534700                             TO DP013-PARAGRAPH                   53430000
534800             STRING                                               53440000
534900                 'CALL XLUT0001'                                  53450000
535000                 ' XL001-RETURN-CODE = '                          53460000
535100                   XL001-RETURN-CODE                              53470000
535200                   ' '                                            53480000
535300                   PV-SQL-CODE-DESC                               53490000
535400                   ' = '                                          53500000
535500                   PV-SQL-CODE                                    53510000
535510                             DELIMITED BY SIZE                    53520000
535600                           INTO DP013-MESSAGE-TEXT (1)            53530000
535700             MOVE 'INVALID ACCESS'                                53540000
535800                             TO DP013-MESSAGE-TEXT (2)            53550000
535900             SET DP013-DB2-ABEND                                  53551000
536000                             TO TRUE                              53552000
536100             SET DP013-XCTL-DISPLAY-RESTART                       53553000
536200                             TO TRUE                              53554000
536300             PERFORM DP013-0000-PROCESS-ABEND                     53555000
536400         WHEN OTHER                                               53556000
536500             MOVE '4350-CALL-XLKUT001'                            53557000
536600                             TO DP013-PARAGRAPH                   53558000
536700             MOVE 'CALL XLUT0001'                                 53559000
536800                             TO DP013-MESSAGE-TEXT (1)            53560000
536900             MOVE 'OTHER ABEND'                                   53570000
537000                             TO DP013-MESSAGE-TEXT (2)            53580000
537100             SET DP013-DB2-ABEND                                  53590000
537200                             TO TRUE                              53600000
537300             SET DP013-XCTL-DISPLAY-RESTART                       53610000
537400                             TO TRUE                              53620000
537500             PERFORM DP013-0000-PROCESS-ABEND                     53630000
537600     END-EVALUATE.                                                53640000
537700                                                                  53650000
537800*                                                                 53660000
537900 EJECT                                                            53670000
538000*----------------------------------------------------------------*53680000
538100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *53690000
538200*----------------------------------------------------------------*53700000
538300                                                                  53710000
538400 4400-MOVE-COMMAREA-TO-SCREEN.                                    53720000
538500                                                                  53730000
538600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             53740000
538700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          53750000
538800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          53760000
538900             MOVE +1    TO ASC-BLK-SUB                            53770000
539000             PERFORM 5100-WRITE-TEMP-STORAGE                      53780000
539100             ADD +1     TO ASC-BLK-SUB                            53790000
539200             PERFORM 5100-WRITE-TEMP-STORAGE                      53800000
539300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             53810000
539400                 GIVING PV-BLOCK-NUMBER                           53820000
539500                 REMAINDER PV-REMAINDER                           53830000
539600             IF  PV-REMAINDER > ZERO                              53840000
539700                 ADD +1 TO PV-BLOCK-NUMBER                        53850000
539800             END-IF                                               53860000
539900             MOVE +1    TO ASC-BLK-SUB                            53870000
540000             PERFORM 4410-READ-TEMP-STORAGE                       53880000
540100             ADD +1     TO ASC-BLK-SUB                            53890000
540200                           PV-BLOCK-NUMBER                        53900000
540300             PERFORM 4410-READ-TEMP-STORAGE                       53910000
540400     END-IF.                                                      53920000
540500     MOVE +1            TO ASC-BLK-SUB.                           53930000
540600     COMPUTE ASC-ITEM-SUB =                                       53940000
540700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              53950000
540800         + PC-ITEMS-PER-PANEL).                                   53960000
540900*                                                                 53970000
541000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        53980000
541100         ADD +1         TO ASC-BLK-SUB                            53990000
541200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            54000000
541300     END-IF.                                                      54010000
541400*                                                                 54020000
541500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           54030000
541600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                54040000
541700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        54050000
541800     PERFORM 4420-FORMAT-LIST-LINES                               54060000
541900         VARYING PV-SUB                                           54070000
542000         FROM PC-ITEMS-PER-PANEL BY -1                            54080000
542100         UNTIL PV-SUB < +1.                                       54090000
542200*                                                                 54100000
542300*                                                                 54110000
542400     MOVE ASC-OPER-UNIT-ID-N       TO PV-OPER-UNIT-ID.            54120000
542500     MOVE PV-OPER-UNIT-ID          TO AOPRUNTO.                   54130000
542600     MOVE ASC-OPER-DESC            TO AOPRDSCO.                   54140000
542700                                                                  54150000
542800     IF ASC-FROM-DATE-MM > 0 AND                                  54160000
542900        ASC-FROM-DATE-DD > 0 AND                                  54170000
543000        ASC-FROM-DATE-YY > 0                                      54180000
543100         MOVE ASC-FROM-DATE-MM         TO PV-DISPLAY-DATE-MM      54190000
543200         MOVE ASC-FROM-DATE-DD         TO PV-DISPLAY-DATE-DD      54200000
543300         MOVE ASC-FROM-DATE-YY         TO PV-DISPLAY-DATE-YY      54210000
543400         MOVE PV-DISPLAY-DATE          TO AFRMDTEO                54220000
543500     ELSE                                                         54230000
543600         MOVE SPACES                   TO AFRMDTEO                54240000
543700     END-IF.                                                      54250000
543800                                                                  54260000
543900     EVALUATE TRUE                                                54270000
544000       WHEN ASC-PO > 0 AND                                        54280000
544100            ASC-RECEIVER-SEQ > 0                                  54290000
544200            MOVE ASC-PO                   TO PV-PO-NBR            54300000
544300            MOVE ASC-RECEIVER-SEQ         TO PV-RECEIVER          54310000
544400            MOVE PV-PO-RECEIVER           TO APORCVRO             54320000
544500            MOVE 'PO-RECEIVER.:'          TO ATITLE1O             54330000
544600       WHEN ASC-PO > 0                                            54340000
544700            MOVE ASC-PO                   TO PV-PO-NBR            54350000
544800            MOVE SPACES                   TO PV-DASH              54360000
544900            MOVE SPACES                   TO PV-RCVR-NUMBER-3POS  54370000
545000            MOVE PV-PO-RECEIVER           TO APORCVRO             54380000
545100            MOVE 'PO-RECEIVER.:'          TO ATITLE1O             54390000
545200       WHEN ASC-CARTON-ID > ZERO                                  54400000
545300            MOVE ASC-CARTON-ID   TO       APORCVRO                54410000
545400            MOVE 'CARTON......:'          TO ATITLE1O             54420000
545500       WHEN OTHER                                                 54430000
545600            MOVE SPACES                   TO APORCVRO             54440000
545700            MOVE 'PO-RECEIVER.:'          TO ATITLE1O             54450000
545800     END-EVALUATE                                                 54460000
545900                                                                  54470000
546000     IF ASC-TO-DATE-MM > 0 AND                                    54480000
546100        ASC-TO-DATE-DD > 0 AND                                    54490000
546200        ASC-TO-DATE-YY > 0                                        54500000
546300         MOVE ASC-TO-DATE-MM           TO PV-DISPLAY-DATE-MM      54510000
546400         MOVE ASC-TO-DATE-DD           TO PV-DISPLAY-DATE-DD      54520000
546500         MOVE ASC-TO-DATE-YY           TO PV-DISPLAY-DATE-YY      54530000
546600         MOVE PV-DISPLAY-DATE          TO ATODTEO                 54540000
546700     ELSE                                                         54550000
546800         MOVE SPACES                   TO ATODTEO                 54560000
546900     END-IF.                                                      54570000
547000                                                                  54580000
547100     IF ASC-ENT-ID-N > 0                                          54590000
547200         MOVE ASC-ENT-ID-N             TO PV-ENT-ID               54600000
547300         MOVE PV-ENT-ID                TO AVENDIDO                54610000
547400     ELSE                                                         54620000
547500         MOVE SPACES                   TO AVENDIDO                54630000
547600     END-IF.                                                      54640000
547700                                                                  54650000
547800     MOVE ASC-VENDOR-NAME          TO AVENDNMO.                   54660000
547900                                                                  54670000
548000     IF ASC-AUDIT-STATUS = 'I' OR 'O'                             54680000
548100         MOVE PC-OPEN                  TO AAUDSTAO                54690000
548200     ELSE                                                         54700000
548300         IF ASC-AUDIT-STATUS = 'P' OR 'F' OR 'N' OR 'C'           54710000
548400             MOVE PC-CLOSED                TO AAUDSTAO            54720000
548500         ELSE                                                     54730000
548600             MOVE PC-ALL                   TO AAUDSTAO            54740000
548700         END-IF                                                   54750000
548800     END-IF.                                                      54760000
548900                                                                  54770000
549000     IF ASC-DEPT-NBR-N > 0                                        54780000
549100         MOVE ASC-DEPT-NBR-N           TO PV-DEPT-NBR             54790000
549200         MOVE PV-DEPT-NBR              TO ADEPTO                  54800000
549300     ELSE                                                         54810000
549400         MOVE SPACES                   TO ADEPTO                  54820000
549500     END-IF.                                                      54830000
549600                                                                  54840000
549700     MOVE ASC-DEPARTMENT-DESC          TO ADPTDSCO.               54850000
549800                                                                  54860000
549900     EVALUATE  ASC-PROCESS-STATUS                                 54870000
550000         WHEN 'P'    MOVE PC-PASS        TO  APRCSTAO             54880000
550100         WHEN 'F'    MOVE PC-FAIL        TO  APRCSTAO             54890000
550200         WHEN 'I'    MOVE PC-IN-PROC     TO  APRCSTAO             54900000
550300         WHEN 'N'    MOVE PC-NOT-NEEDED  TO  APRCSTAO             54910000
550400         WHEN OTHER  MOVE PC-ALL         TO  APRCSTAO             54920000
550500     END-EVALUATE.                                                54930000
550600                                                                  54940000
550700     EVALUATE  ASC-PACKAGING-TYPE                                 54950000
550800         WHEN 'BC'   MOVE PC-BULK-CSEPK  TO  APKGTYPO             54960000
550900         WHEN 'PP'   MOVE PC-PREPACK     TO  APKGTYPO             54970000
551000         WHEN 'PS'   MOVE PC-PBS         TO  APKGTYPO             54980000
551000         WHEN 'RF'   MOVE PC-RFID        TO  APKGTYPO             54990000
551100         WHEN OTHER  MOVE PC-ALL         TO  APKGTYPO             55000000
551200     END-EVALUATE.                                                55010000
551300                                                                  55020000
551400**                                                                55030000
551500                                                                  55040000
551600     COMPUTE ASC-ITEMS-DISPLAYED =                                55050000
551700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          55060000
551800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    55070000
551900                                      ASTRTITO.                   55080000
552000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    55090000
552100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    55100000
552200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            55110000
552300                                   TO ASELITO.                    55120000
552400*                                                                 55130000
552500     IF  DP020-MSG-NUMBER-X = SPACE                               55140000
552600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  55150000
552700*            --- MORE ITEMS TO DISPLAY ----                       55160000
552800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            55170000
552900             SET DP020-MSG-INFORMATIONAL TO TRUE                  55180000
553000         END-IF                                                   55190000
553100     END-IF.                                                      55200000
553200*----------------------------------------------------------------*55210000
553300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *55220000
553400*----------------------------------------------------------------*55230000
553500                                                                  55240000
553600 4410-READ-TEMP-STORAGE.                                          55250000
553700                                                                  55260000
553800     EXEC CICS                                                    55270000
553900         READQ TS                                                 55280000
554000             QUEUE (ASC-LIST-QUEUE-NAME)                          55290000
554100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               55300000
554200             ITEM  (PV-BLOCK-NUMBER)                              55310000
554300             RESP  (PV-CICS-RESPONSE)                             55320000
554400     END-EXEC.                                                    55330000
554500                                                                  55340000
554600     IF  ((PV-CICS-RESPONSE = DFHRESP (NORMAL))                   55350000
554700       OR (PV-CICS-RESPONSE = DFHRESP (ITEMERR)))                 55360000
554800         CONTINUE                                                 55370000
554900     ELSE                                                         55380000
555000         SET DP013-CICS-ABEND     TO TRUE                         55390000
555100         SET DP013-NO-ROLLBACK    TO TRUE                         55400000
555200         MOVE '4410-READ-TEMP-STORAGE'                            55410000
555300                                  TO DP013-PARAGRAPH              55420000
555400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      55430000
555500                                  TO DP013-MESSAGE-TEXT(1)        55440000
555600         PERFORM DP013-0000-PROCESS-ABEND                         55450000
555700     END-IF.                                                      55460000
555800                                                                  55470000
555900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             55480000
556000*                                                                 55490000
556100     IF  PV-CICS-RESPONSE = DFHRESP (ITEMERR)                     55500000
556200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               55510000
556300     END-IF.                                                      55520000
556400 EJECT                                                            55530000
556500*----------------------------------------------------------------*55540000
556600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *55550000
556700*----------------------------------------------------------------*55560000
556800                                                                  55570000
556900 4420-FORMAT-LIST-LINES.                                          55580000
557000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      55590000
557100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                55600000
557200                                                                  55610000
557300         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           55620000
557400                                    MR-LINE-PACKA (PV-SUB)        55630000
557500                                                                  55640000
557600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           55650000
557700         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           55660000
557800         MOVE SPACE              TO MR-SELECTI (PV-SUB)           55670000
557900                                    MR-AUDIT-NBR-X (PV-SUB)       55680000
558000                                    MR-SOURCE (PV-SUB)            55690000
558100                                    MR-OPER-UNIT-X (PV-SUB)       55700000
558200                                    MR-PO-RECEIVER (PV-SUB)       55710000
558300                                    MR-REQUEST-DATE (PV-SUB)      55720000
558400                                    MR-LINE-PACK (PV-SUB)         55730000
558500                                    MR-SKU (PV-SUB)               55740000
558600                                    MR-REQUEST-DATE (PV-SUB)      55750000
558700                                    MR-PROCESS-STATUS (PV-SUB)    55760000
558800                                    MR-DEFERRED-IND (PV-SUB)      55770000
558900                                    MR-MODIFIED-IND (PV-SUB)      55780000
559000     ELSE                                                         55790000
559100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      55800000
559200                                                   > SPACE        55810000
559300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 55820000
559400                                 TO MR-SELECTI (PV-SUB)           55830000
559500         ELSE                                                     55840000
559600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      55850000
559700                                 TO MR-SELECTI (PV-SUB)           55860000
559800         END-IF                                                   55870000
559900*                                                                 55880000
560000         IF  DP030-SET-CURSOR-TRAILER                             55890000
560100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)55900000
560200                 > SPACE)                                         55910000
560300               OR (PV-SUB = 1))                                   55920000
560400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               55930000
560500                MOVE -1          TO MR-SELECTL (PV-SUB)           55940000
560600             END-IF                                               55950000
560700         END-IF                                                   55960000
560800*                                                                 55970000
560900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           55980000
561000             MOVE ASC-TBL-AUDIT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)    55990000
561100                                 TO MR-AUDIT-NBR (PV-SUB)         56000000
                                                                        56010000
561200             MOVE ASC-TBL-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)       56020000
561300                                 TO MR-SOURCE (PV-SUB)            56030000
561400             MOVE ASC-TBL-OPER-UNIT (ASC-BLK-SUB ASC-ITEM-SUB)    56040000
561500                                 TO MR-OPER-UNIT (PV-SUB)         56050000
561600             MOVE ASC-TBL-PO-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)  56060000
561700                                 TO MR-PO-RECEIVER (PV-SUB)       56070000
      *CLP 10/14/2013 BEGIN - PR5148D                                   56080000
                   EVALUATE TRUE                                        56090000
                       WHEN ASC-MULTIPLE-AUD (ASC-BLK-SUB ASC-ITEM-SUB) 56091000
571800                     MOVE DP015-YELLOW  TO MR-SOURCEC (PV-SUB)    56092000
                       WHEN OTHER                                       56093000
571800                     MOVE DP015-BLUE    TO MR-SOURCEC (PV-SUB)    56093100
                   END-EVALUATE                                         56093200
                                                                        56093300
      *CLP 10/14/2013 END   - PR5148D                                   56093400
                                                                        56093500
561800             IF ASC-TBL-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB) = 'SYS' 56093600
561900                 MOVE ASC-TBL-PACK-LINE (ASC-BLK-SUB ASC-ITEM-SUB)56093700
562000                                 TO MR-LINE-PACK (PV-SUB)         56093800
562100             ELSE                                                 56093900
562200                 MOVE SPACES     TO MR-LINE-PACK (PV-SUB)         56094000
562300             END-IF                                               56095000
      *CLP 10/14/2013 BEGIN - PR5148D                                   56096000
                   EVALUATE TRUE                                        56097000
                       WHEN ASC-RFID-AUD     (ASC-BLK-SUB ASC-ITEM-SUB) 56098000
571800                     MOVE PC-RFID  TO MR-LINE-PACK  (PV-SUB)      56099000
                   END-EVALUATE                                         56100000
      *CLP 10/14/2013 END   - PR5148D                                   56110000
562400             MOVE ASC-TBL-SKU (ASC-BLK-SUB ASC-ITEM-SUB)          56120000
562500                                 TO MR-SKU (PV-SUB)               56130000
562600                                                                  56140000
562700             IF ASC-TBL-REQUEST-DATE (ASC-BLK-SUB ASC-ITEM-SUB)   56150000
562800                                 = '09-09-99'                     56160000
562900                 MOVE SPACES     TO MR-REQUEST-DATE (PV-SUB)      56170000
563000             ELSE                                                 56180000
563100                 MOVE ASC-TBL-REQUEST-DATE                        56190000
563200                             (ASC-BLK-SUB ASC-ITEM-SUB)           56200000
563300                                 TO MR-REQUEST-DATE (PV-SUB)      56210000
563400             END-IF                                               56220000
563500                                                                  56230000
563600             EVALUATE TRUE                                        56240000
563700                 WHEN ASC-TBL-PROCESS-STATUS                      56250000
563800                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'PASS   '  56260000
563900                     MOVE 'PASS ' TO MR-PROCESS-STATUS (PV-SUB)   56270000
564000                 WHEN ASC-TBL-PROCESS-STATUS                      56280000
564100                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'FAIL   '  56290000
564200                     MOVE 'FAIL ' TO MR-PROCESS-STATUS (PV-SUB)   56300000
564300                 WHEN ASC-TBL-PROCESS-STATUS                      56310000
564400                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'PROMPT '  56320000
564500                     MOVE 'PRMPT' TO MR-PROCESS-STATUS (PV-SUB)   56330000
564600                 WHEN ASC-TBL-PROCESS-STATUS                      56340000
564700                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'IN PROC'  56350000
564800                     MOVE 'INPRC' TO MR-PROCESS-STATUS (PV-SUB)   56360000
564900                 WHEN ASC-TBL-PROCESS-STATUS                      56370000
565000                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'NOTNEED'  56380000
565100                     MOVE 'NONED' TO MR-PROCESS-STATUS (PV-SUB)   56390000
565200                 WHEN ASC-TBL-PROCESS-STATUS                      56400000
565300                          (ASC-BLK-SUB ASC-ITEM-SUB) = 'CLOSED '  56410000
565400                     MOVE 'CLOSD' TO MR-PROCESS-STATUS (PV-SUB)   56420000
565500                 WHEN OTHER                                       56430000
565600                     MOVE '     ' TO MR-PROCESS-STATUS (PV-SUB)   56440000
565700             END-EVALUATE                                         56450000
565800             IF  ASC-TBL-DEFERRED-IND (ASC-BLK-SUB ASC-ITEM-SUB)  56460000
565900                 = 'Y'                                            56470000
566000                 MOVE ASC-TBL-DEFERRED-IND                        56480000
566100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 56490000
566200                                 TO MR-DEFERRED-IND (PV-SUB)      56500000
566300             ELSE                                                 56510000
566400                 MOVE SPACES     TO MR-DEFERRED-IND (PV-SUB)      56520000
566500             END-IF                                               56530000
566600             IF  ASC-TBL-MODIFIED-IND (ASC-BLK-SUB ASC-ITEM-SUB)  56540000
566700                 = 'Y'                                            56550000
566800                 MOVE ASC-TBL-MODIFIED-IND                        56560000
566900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 56570000
567000                                 TO MR-MODIFIED-IND (PV-SUB)      56580000
567100             ELSE                                                 56590000
567200                 MOVE SPACES     TO MR-MODIFIED-IND (PV-SUB)      56600000
567300             END-IF                                               56610000
567400         END-IF                                                   56620000
567500     END-IF.                                                      56630000
567600     SUBTRACT +1 FROM ASC-ITEM-SUB                                56640000
567700     IF  ASC-ITEM-SUB < + 1                                       56650000
567800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  56660000
567900         MOVE +1                 TO ASC-BLK-SUB                   56670000
568000     END-IF.                                                      56680000
568100******************************************************************56690000
568200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **56700000
568300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **56710000
568400** ISSUE A WARNING.                                             **56720000
568500******************************************************************56730000
568600 4430-CHECK-FOR-BEGIN-AND-END.                                    56740000
568700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       56750000
568800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     56760000
568900*            -- NO END-OF-RANGE SPECFIED ---                      56770000
569000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            56780000
569100             SET DP020-MSG-WARNING TO TRUE                        56790000
569200             PERFORM 4431-POSITION-AT-WARNING                     56800000
569300         END-IF                                                   56810000
569400     ELSE                                                         56820000
569500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     56830000
569600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                56840000
569700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            56850000
569800             SET DP020-MSG-WARNING TO TRUE                        56860000
569900             PERFORM 4431-POSITION-AT-WARNING                     56870000
570000         END-IF                                                   56880000
570100     END-IF.                                                      56890000
570200******************************************************************56900000
570300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **56910000
570400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **56920000
570500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **56930000
570600** POSITION THE CURSOR THERE.                                   **56940000
570700******************************************************************56950000
570800 4431-POSITION-AT-WARNING.                                        56960000
570900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 56970000
571000                    - PV-TOP-ITEM + 1.                            56980000
571100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      56990000
571200         CONTINUE                                                 57000000
571300     ELSE                                                         57010000
571400         SET DP030-SET-CURSOR-APPL-1                              57020000
571500                                   TO TRUE                        57030000
571600         MOVE -1                   TO MR-SELECTL (PV-SUB)         57040000
571700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         57050000
571800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         57060000
571900     END-IF.                                                      57070000
572000*                                                                 57080000
572100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   57090000
572200                    - PV-TOP-ITEM + 1.                            57100000
572300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      57110000
572400         CONTINUE                                                 57120000
572500     ELSE                                                         57130000
572600         SET DP030-SET-CURSOR-APPL-1                              57140000
572700                                   TO TRUE                        57150000
572800         MOVE -1                   TO MR-SELECTL (PV-SUB)         57160000
572900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         57170000
573000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         57180000
573100     END-IF.                                                      57190000
573200 EJECT                                                            57200000
527000*                                                                 57210000
      *VSH 10/14/2013 BEGIN - PR5148D                                   57220000
         4432-QC-RFID-COMB-COUNT.                                       57230000
                                                                        57240000
           EXEC SQL                                                     57241000
               SELECT COUNT(*)                                          57242000
                INTO :ASC-COUNT :PV-NULL-IND                            57242100
                FROM SUT_PO_AUD_REQ                                     57242200
                WHERE RWRK_AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR        57242300
           END-EXEC.                                                    57242400
                                                                        57242500
           EVALUATE TRUE                                                57242600
               WHEN SQLCODE = ZERO                                      57242700
               WHEN SQLCODE = +100                                      57242800
               WHEN SQLCODE = -811                                      57242900
                   CONTINUE                                             57243000
               WHEN SQLWARN0 NOT = SPACES                               57244000
               WHEN SQLCODE < +0                                        57245000
               WHEN SQLCODE > ZERO                                      57246000
                   MOVE '4432-QC-RFID-COMB-COUNT'                       57247000
                                   TO DP013-PARAGRAPH                   57248000
                   MOVE 'SELECT SUT_PO_AUD_REQ'                         57249000
                                   TO DP013-MESSAGE-TEXT (1)            57250000
                   MOVE SQLCA      TO DP013-SQLCA                       57250100
                   MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME (1)   57250200
                   SET DP013-DB2-ABEND                                  57250300
                                   TO TRUE                              57250400
                   SET DP013-XCTL-DISPLAY-RESTART                       57250500
                                   TO TRUE                              57250600
                   PERFORM DP013-0000-PROCESS-ABEND                     57250700
           END-EVALUATE.                                                57250800
       EJECT                                                            57250900
      *VSH 10/14/2013 END - PR5148D                                     57251000
      *----------------------------------------------------------------*57252000
      * PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *57253000
573500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *57254000
573600* FOR THE SELECTED ITEMS QUEUE.                                  *57255000
573700*                                                                *57256000
573800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *57257000
573900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *57258000
574000* THE ARRAY IS FULL.                                             *57259000
574100*----------------------------------------------------------------*57260000
574200                                                                  57270000
574300 5000-PREPARE-SEL-QUEUE.                                          57280000
574400                                                                  57290000
574500     MOVE +1                   TO  ASC-BLK-SUB.                   57300000
574600     PERFORM 5100-WRITE-TEMP-STORAGE.                             57310000
574700     ADD +1                    TO  ASC-BLK-SUB.                   57320000
574800     PERFORM 5100-WRITE-TEMP-STORAGE.                             57330000
574900                                                                  57340000
575000     MOVE ASC-SEL-QUEUE-NAME   TO  SU024-SEL-QUEUE-NAME.          57350000
575100     PERFORM 6010-DELETE-SEL-QUEUE.                               57360000
575200                                                                  57370000
575300     SET ASC-UPDATE-TSQ        TO  TRUE.                          57380000
575400                                                                  57390000
575500     SET SU025-IDX             TO  1.                             57400000
575600     MOVE ZERO                 TO SU024-NUMBER-OF-TS-ITEMS.       57410000
575700     INITIALIZE SU025-SELECTED-ITEM-ARRAY.                        57420000
575800                                                                  57430000
575900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           57440000
576000             VARYING PV-ITEM                                      57450000
576100             FROM 1 BY 1                                          57460000
576200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     57470000
576300                                                                  57480000
576400     IF  SU025-IDX > 1                                            57490000
576500         PERFORM 5205-WRITE-SEL-QUEUE                             57500000
576600         ADD +1                TO SU024-NUMBER-OF-TS-ITEMS        57510000
576700     END-IF.                                                      57520000
576800 EJECT                                                            57530000
576900*----------------------------------------------------------------*57540000
577000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *57550000
577100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *57560000
577200*----------------------------------------------------------------*57570000
577300                                                                  57580000
577400 5100-WRITE-TEMP-STORAGE.                                         57590000
577500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     57600000
577600                                   TO PV-LIST-ITEM-NUMBER.        57610000
577700     COMPUTE PV-BLOCK-NUMBER =                                    57620000
577800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    57630000
577900                                                                  57640000
578000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             57650000
578100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             57660000
578200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      57670000
578300             PERFORM 5105-REWRITE-ASC-LISTQ                       57680000
578400         END-IF                                                   57690000
578500     ELSE                                                         57700000
578600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       57710000
578700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            57720000
578800         PERFORM 5110-WRITE-ASC-LISTQ                             57730000
578900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   57740000
579000     END-IF.                                                      57750000
579100                                                                  57760000
579200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             57770000
579300******************************************************************57780000
579400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **57790000
579500** SPECIFIC COMMAREA.                                           **57800000
579600******************************************************************57810000
579700 5105-REWRITE-ASC-LISTQ.                                          57820000
579800     EXEC CICS                                                    57830000
579900         WRITEQ TS                                                57840000
580000             QUEUE (ASC-LIST-QUEUE-NAME)                          57850000
580100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               57860000
580200             ITEM  (PV-BLOCK-NUMBER)                              57870000
580300             REWRITE                                              57880000
580400             RESP  (PV-CICS-RESPONSE)                             57890000
580500     END-EXEC.                                                    57900000
580600                                                                  57910000
580700     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       57920000
580800         CONTINUE                                                 57930000
580900     ELSE                                                         57940000
581000         SET DP013-CICS-ABEND            TO TRUE                  57950000
581100         SET DP013-NO-ROLLBACK           TO TRUE                  57960000
581200         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       57970000
581300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     57980000
581400                                         TO DP013-MESSAGE-TEXT(1) 57990000
581500         PERFORM DP013-0000-PROCESS-ABEND                         58000000
581600     END-IF.                                                      58010000
581700                                                                  58020000
581800******************************************************************58030000
581900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **58040000
582000** SPECIFIC COMMAREA.                                           **58050000
582100******************************************************************58060000
582200 5110-WRITE-ASC-LISTQ.                                            58070000
582300     EXEC CICS                                                    58080000
582400         WRITEQ TS                                                58090000
582500             QUEUE (ASC-LIST-QUEUE-NAME)                          58100000
582600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               58110000
582700             ITEM  (PV-BLOCK-NUMBER)                              58120000
582800             RESP  (PV-CICS-RESPONSE)                             58130000
582900     END-EXEC.                                                    58140000
583000     IF  PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                  58150000
583100         SET DP013-CICS-ABEND      TO TRUE                        58160000
583200         SET DP013-NO-ROLLBACK     TO TRUE                        58170000
583300         MOVE '5110-WRITE-ASC-LISTQ'                              58180000
583400                                   TO DP013-PARAGRAPH             58190000
583500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           58200000
583600                                   TO DP013-MESSAGE-TEXT(1)       58210000
583700         PERFORM DP013-0000-PROCESS-ABEND                         58220000
583800     END-IF.                                                      58230000
583900 EJECT                                                            58240000
584000*----------------------------------------------------------------*58250000
584100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *58260000
584200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *58270000
584300*----------------------------------------------------------------*58280000
584400                                                                  58290000
584500 5120-REWRITE-LIST-QUEUE.                                         58300000
584600     EXEC CICS                                                    58310000
584700          WRITEQ TS                                               58320000
584800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     58330000
584900              FROM    (SU025-SELECT-RECORD)                       58340000
585000              ITEM    (ASC-SEL-ITEM)                              58350000
585100              RESP    (PV-CICS-RESPONSE)                          58360000
585200              REWRITE                                             58370000
585300     END-EXEC.                                                    58380000
585400                                                                  58390000
585500     IF PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)                58400000
585600         SET DP013-CICS-ABEND                                     58410000
585700             DP013-NO-ROLLBACK     TO TRUE                        58420000
585800         MOVE '5120-REWRITE-LIST-QUEUE'                           58430000
585900                                   TO DP013-PARAGRAPH             58440000
586000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   58450000
586100                                   TO DP013-MESSAGE-TEXT (1)      58460000
586200         PERFORM DP013-0000-PROCESS-ABEND                         58470000
586300     END-IF.                                                      58480000
586400                                                                  58490000
586500                                                                  58500000
586600 5200-FILL-SEL-QUEUE-RECORD.                                      58510000
586700                                                                  58520000
586800     PERFORM 6112-READ-LIST-QUEUE.                                58530000
586900                                                                  58540000
587000     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   58550000
587100         PERFORM                                                  58560000
587200         VARYING LQW-IDX                                          58570000
587300         FROM 1 BY 1                                              58580000
587400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            58590000
587500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          58600000
587600                                                                  58610000
587700             IF  LQW-SELECT (LQW-IDX)                             58620000
587800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              58630000
587900                                 TO SU025-ITEM (SU025-IDX)        58640000
588000                 MOVE LQW-AUDIT-NBR (LQW-IDX)                     58650000
588100                                 TO SU025-AUDIT-NBR  (SU025-IDX)  58660000
588200                 MOVE LQW-SOURCE    (LQW-IDX)                     58670000
588300                                 TO SU025-SOURCE     (SU025-IDX)  58680000
588400                 MOVE LQW-OPER-UNIT (LQW-IDX)                     58690000
588500                                 TO SU024-OPER-UNIT-ID            58700000
588600                 MOVE LQW-PO-RECEIVER (LQW-IDX)                   58710000
588700                                 TO SU025-PO-RECEIVER(SU025-IDX)  58720000
588800                 MOVE LQW-PACK-LINE   (LQW-IDX)                   58730000
588900                                 TO SU025-PACK-LINE  (SU025-IDX)  58740000
589000                 MOVE LQW-PKG-TYPE    (LQW-IDX)                   58750000
589100                                 TO SU025-PKG-TYPE   (SU025-IDX)  58760000
589200                 MOVE LQW-SKU         (LQW-IDX)                   58770000
589300                                 TO SU025-SKU (SU025-IDX)         58780000
589400                 MOVE LQW-REQUEST-DATE (LQW-IDX)                  58790000
589500                                 TO SU025-REQUEST-DATE (SU025-IDX)58800000
589600                 MOVE LQW-REQUEST-MDCY (LQW-IDX)                  58810000
589700                                 TO SU025-REQUEST-MDCY (SU025-IDX)58820000
589800                 MOVE LQW-REQUEST-TIME (LQW-IDX)                  58830000
589900                                 TO SU025-REQUEST-TIME (SU025-IDX)58840000
590000                 MOVE LQW-PROCESS-STATUS (LQW-IDX)                58850000
590100                              TO SU025-PROCESS-STATUS (SU025-IDX) 58860000
590200                 MOVE LQW-PROCESS-ST-CDE (LQW-IDX)                58870000
590300                              TO SU025-PROCESS-ST-CDE (SU025-IDX) 58880000
590400                 MOVE LQW-DEFERRED-IND (LQW-IDX)                  58890000
590500                              TO SU025-DEFERRED-IND (SU025-IDX)   58900000
590600                 MOVE LQW-MODIFIED-IND (LQW-IDX)                  58910000
590700                              TO SU025-MODIFIED-IND (SU025-IDX)   58920000
590800                                                                  58930000
590900                 MOVE SPACE      TO SU025-ACTION-SW (SU025-IDX)   58940000
591000                 SET SU025-IDX UP BY 1                            58950000
591100                 IF  SU025-IDX > SU025-MAX-ITEMS                  58960000
591200                     PERFORM 5205-WRITE-SEL-QUEUE                 58970000
591300                     ADD +1        TO SU024-NUMBER-OF-TS-ITEMS    58980000
591400                     INITIALIZE SU025-SELECTED-ITEM-ARRAY         58990000
591500                     SET SU025-IDX TO  1                          59000000
591600                 END-IF                                           59010000
591700             END-IF                                               59020000
591800         END-PERFORM                                              59030000
591900     END-IF.                                                      59040000
592000                                                                  59050000
592100*----------------------------------------------------------------*59060000
592200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *59070000
592300*----------------------------------------------------------------*59080000
592400                                                                  59090000
592500 5205-WRITE-SEL-QUEUE.                                            59100000
592600                                                                  59110000
592700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            59120000
592800                                   TO SU025-SELECTED-ITEMS.       59130000
592900                                                                  59140000
593000     EXEC CICS                                                    59150000
593100          WRITEQ TS                                               59160000
593200              QUEUE (ASC-SEL-QUEUE-NAME)                          59170000
593300              FROM  (SU025-SELECT-RECORD)                         59180000
593400              ITEM  (PV-SEL-QUEUE-ITEM)                           59190000
593500              RESP  (PV-CICS-RESPONSE)                            59200000
593600     END-EXEC.                                                    59210000
593700                                                                  59220000
593800     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      59230000
593900         CONTINUE                                                 59240000
594000     ELSE                                                         59250000
594100         SET DP013-CICS-ABEND      TO TRUE                        59260000
594200         SET DP013-NO-ROLLBACK     TO TRUE                        59270000
594300         MOVE '5205-WRITE-SEL-QUEUE'                              59280000
594400                                   TO DP013-PARAGRAPH             59290000
594500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          59300000
594600                                   TO DP013-MESSAGE-TEXT(1)       59310000
594700         PERFORM DP013-0000-PROCESS-ABEND                         59320000
594800     END-IF.                                                      59330000
594900 EJECT                                                            59340000
595000******************************************************************59350000
595100** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **59360000
595200** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **59370000
595300** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **59380000
595400** THE USER.                                                    **59390000
595500******************************************************************59400000
595600 6000-REFRESH-PANEL-FROM-TEMP.                                    59410000
595700     IF  ASC-UPDATE-TSQ                                           59420000
595800         SET ASC-NO-TSQ-UPDATE TO TRUE                            59430000
595900         MOVE ZERO                 TO PV-SAVE-ITEM                59440000
596000                                      PV-SEL-QUEUE-ITEM           59450000
596100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        59460000
596200                                   TO PV-HOLD-SELECTED-ITEMS      59470000
596300         MOVE +1                   TO PV-ITEMS-PROCESSED          59480000
596400         PERFORM 6100-UPDATE-TSQ                                  59490000
596500             UNTIL PV-ITEMS-PROCESSED >                           59500000
596600                                     PV-HOLD-SELECTED-ITEMS       59510000
596700         PERFORM 6010-DELETE-SEL-QUEUE                            59520000
596800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         59530000
596900                    ASC-BLOCK-ENTRIES (2)                         59540000
597000     END-IF.                                                      59550000
597100                                                                  59560000
597200*----------------------------------------------------------------*59570000
597300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *59580000
597400*----------------------------------------------------------------*59590000
597500 6010-DELETE-SEL-QUEUE.                                           59600000
597600                                                                  59610000
597700     EXEC CICS                                                    59620000
597800         DELETEQ TS                                               59630000
597900             QUEUE (ASC-SEL-QUEUE-NAME)                           59640000
598000             RESP  (PV-CICS-RESPONSE)                             59650000
598100     END-EXEC.                                                    59660000
598200*                                                                 59670000
598300     IF ((PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                  59680000
598400        (PV-CICS-RESPONSE = DFHRESP(QIDERR)))                     59690000
598500         CONTINUE                                                 59700000
598600     ELSE                                                         59710000
598700         SET DP013-CICS-ABEND TO TRUE                             59720000
598800         SET DP013-NO-ROLLBACK TO TRUE                            59730000
598900         MOVE '6010-DELETE-SEL-QUEUE'                             59740000
599000                        TO DP013-PARAGRAPH                        59750000
599100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         59760000
599200                        TO DP013-MESSAGE-TEXT (1)                 59770000
599300         PERFORM DP013-0000-PROCESS-ABEND                         59780000
599400     END-IF.                                                      59790000
599500                                                                  59800000
599600*----------------------------------------------------------------*59810000
599700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *59820000
599800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *59830000
599900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *59840000
600000*    THE TEMP QUEUE.                                             *59850000
600100*----------------------------------------------------------------*59860000
600200                                                                  59870000
600300 6100-UPDATE-TSQ.                                                 59880000
600400                                                                  59890000
600500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             59900000
600600     PERFORM 6105-READ-SEL-QUEUE.                                 59910000
600700     PERFORM                                                      59920000
600800         VARYING SU025-IDX                                        59930000
600900         FROM 1 BY 1                                              59940000
601000         UNTIL ((PV-ITEMS-PROCESSED >                             59950000
601100                              PV-HOLD-SELECTED-ITEMS)             59960000
601200         OR (SU025-IDX GREATER THAN SU025-MAX-ITEMS))             59970000
601300         IF  SU025-ACTION-SW (SU025-IDX) > SPACE                  59980000
601400             PERFORM 6110-PROCESS-ITEMS                           59990000
601500         END-IF                                                   60000000
601600         ADD +1                TO PV-ITEMS-PROCESSED              60010000
601700     END-PERFORM.                                                 60020000
601800     PERFORM 6111-WRITE-LIST-QUEUE.                               60030000
601900*----------------------------------------------------------------*60040000
602000*    READ THE LIST QUEUE RECORD.                                 *60050000
602100*----------------------------------------------------------------*60060000
602200                                                                  60070000
602300 6105-READ-SEL-QUEUE.                                             60080000
602400                                                                  60090000
602500     EXEC CICS                                                    60100000
602600          READQ TS                                                60110000
602700              QUEUE (ASC-SEL-QUEUE-NAME)                          60120000
602800              INTO  (SU025-SELECT-RECORD)                         60130000
602900              ITEM  (PV-SEL-QUEUE-ITEM)                           60140000
603000              RESP  (PV-CICS-RESPONSE)                            60150000
603100     END-EXEC.                                                    60160000
603200*                                                                 60170000
603300     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      60180000
603400         CONTINUE                                                 60190000
603500     ELSE                                                         60200000
603600         SET DP013-CICS-ABEND      TO  TRUE                       60210000
603700         SET DP013-NO-ROLLBACK     TO  TRUE                       60220000
603800         MOVE '6105-READ-SEL-QUEUE'                               60230000
603900                                   TO  DP013-PARAGRAPH            60240000
604000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           60250000
604100                                   TO  DP013-MESSAGE-TEXT(1)      60260000
604200         PERFORM DP013-0000-PROCESS-ABEND                         60270000
604300     END-IF.                                                      60280000
604400 EJECT                                                            60290000
604500*----------------------------------------------------------------*60300000
604600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*60310000
604700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*60320000
604800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *60330000
604900*----------------------------------------------------------------*60340000
605000                                                                  60350000
605100 6110-PROCESS-ITEMS.                                              60360000
605200                                                                  60370000
605300     COMPUTE PV-ITEM = 1 + ((SU025-ITEM (SU025-IDX) - 1)          60380000
605400                     / PC-ITEMS-PER-PANEL).                       60390000
605500                                                                  60400000
605600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           60410000
605700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          60420000
605800             PERFORM 6111-WRITE-LIST-QUEUE                        60430000
605900         END-IF                                                   60440000
606000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    60450000
606100                                                                  60460000
606200         PERFORM 6112-READ-LIST-QUEUE                             60470000
606300         IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)           60480000
606400             CONTINUE                                             60490000
606500         END-IF                                                   60500000
606600     END-IF.                                                      60510000
606700                                                                  60520000
606800     COMPUTE PV-SUB = (SU025-ITEM (SU025-IDX)                     60530000
606900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              60540000
607000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         60550000
607100     MOVE LQW-SELECTED-SW (PV-SUB)                                60560000
607200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  60570000
607300                                                                  60580000
607400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                60590000
607500                                                                  60600000
607600*----------------------------------------------------------------*60610000
607700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *60620000
607800*----------------------------------------------------------------*60630000
607900                                                                  60640000
608000 6111-WRITE-LIST-QUEUE.                                           60650000
608100                                                                  60660000
608200     EXEC CICS                                                    60670000
608300         WRITEQ TS                                                60680000
608400             QUEUE (ASC-LIST-QUEUE-NAME)                          60690000
608500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     60700000
608600             ITEM  (PV-SAVE-ITEM)                                 60710000
608700             REWRITE                                              60720000
608800             RESP  (PV-CICS-RESPONSE)                             60730000
608900     END-EXEC.                                                    60740000
609000*                                                                 60750000
609100     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      60760000
609200         CONTINUE                                                 60770000
609300     ELSE                                                         60780000
609400         SET DP013-CICS-ABEND  TO  TRUE                           60790000
609500         SET DP013-NO-ROLLBACK TO  TRUE                           60800000
609600         MOVE '6111-WRITE-LIST-QUEUE'                             60810000
609700                               TO  DP013-PARAGRAPH                60820000
609800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  60830000
609900                               TO  DP013-MESSAGE-TEXT(1)          60840000
610000         PERFORM DP013-0000-PROCESS-ABEND                         60850000
610100     END-IF.                                                      60860000
610200                                                                  60870000
610300 EJECT                                                            60880000
610400*----------------------------------------------------------------*60890000
610500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*60900000
610600*----------------------------------------------------------------*60910000
610700                                                                  60920000
610800 6112-READ-LIST-QUEUE.                                            60930000
610900                                                                  60940000
611000     EXEC CICS                                                    60950000
611100         READQ TS                                                 60960000
611200             QUEUE (ASC-LIST-QUEUE-NAME)                          60970000
611300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     60980000
611400             ITEM  (PV-ITEM)                                      60990000
611500             RESP  (PV-CICS-RESPONSE)                             61000000
611600     END-EXEC.                                                    61010000
611700*                                                                 61020000
611800     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      61030000
611900         CONTINUE                                                 61040000
612000     ELSE                                                         61050000
612100         SET DP013-CICS-ABEND        TO TRUE                      61060000
612200         SET DP013-NO-ROLLBACK       TO TRUE                      61070000
612300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           61080000
612400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    61090000
612500                                     TO DP013-MESSAGE-TEXT(1)     61100000
612600         PERFORM DP013-0000-PROCESS-ABEND                         61110000
612700     END-IF.                                                      61120000
612800                                                                  61130000
612900*----------------------------------------------------------------*61140000
613000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *61150000
613100*----------------------------------------------------------------*61160000
613200                                                                  61170000
613300 9100-READ-SEL-QUEUE.                                             61180000
613400     EXEC CICS                                                    61190000
613500         READQ TS                                                 61200000
613600             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        61210000
613700             INTO  (SU025-SELECT-RECORD)                          61220000
613800             ITEM  (ASC-SEL-ITEM)                                 61230000
613900             RESP  (PV-CICS-RESPONSE)                             61240000
614000     END-EXEC.                                                    61250000
614100                                                                  61260000
614200     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   61270000
614300         CONTINUE                                                 61280000
614400     ELSE                                                         61290000
614500         SET DP013-LOGIC-ABEND                                    61300000
614600             DP013-NO-ROLLBACK     TO TRUE                        61310000
614700         MOVE '9100-READ-SEL-QUEUE'                               61320000
614800                                   TO DP013-PARAGRAPH             61330000
614900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   61340000
615000                                   TO DP013-MESSAGE-TEXT (1)      61350000
615100         PERFORM DP013-0000-PROCESS-ABEND                         61360000
615200     END-IF.                                                      61370000
615300*----------------------------------------------------------------*61380000
615400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *61390000
615500*----------------------------------------------------------------*61400000
615600 9200-REWRITE-LIST-QUEUE.                                         61410000
615700     EXEC CICS                                                    61420000
615800          WRITEQ TS                                               61430000
615900              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      61440000
616000              FROM   (SU025-SELECT-RECORD)                        61450000
616100              ITEM   (ASC-SEL-ITEM)                               61460000
616200              RESP   (PV-CICS-RESPONSE)                           61470000
616300              REWRITE                                             61480000
616400     END-EXEC.                                                    61490000
616500                                                                  61500000
616600     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               61510000
616700         SET DP013-CICS-ABEND                                     61520000
616800             DP013-NO-ROLLBACK     TO TRUE                        61530000
616900         MOVE '9200-REWRITE-LIST-QUEUE'                           61540000
617000                                   TO DP013-PARAGRAPH             61550000
617100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   61560000
617200                                   TO DP013-MESSAGE-TEXT (1)      61570000
617300         PERFORM DP013-0000-PROCESS-ABEND                         61580000
617400     END-IF.                                                      61590000
617500                                                                  61600000
617600 EJECT                                                            61610000
617700*----------------------------------------------------------------*61620000
617800*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *61630000
617900*    AND THE ERROR SWITCHES.                                     *61640000
618000*----------------------------------------------------------------*61650000
618100 9900-SOFT-ABORT.                                                 61660000
618200     SET PS-ERROR         TO TRUE.                                61670000
618300     SET DP020-MSG-FATAL  TO TRUE.                                61680000
618400     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    61690000
618500     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       61700000
618600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          61710000
618700     PERFORM 0001-CALL-CICS-ARCH-API.                             61720000
618800                                                                  61730000
618900******************************************************************61740000
619000 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  61750000
619100                                                                  61760000
619200     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           61770000
619300     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          61780000
619400     INITIALIZE DP013-SRC-TASK-NUMBER                             61790000
619500                DP013-STACK.                                      61800000
619600     SET DP013-LINK-RETURN            TO TRUE.                    61810000
619700                                                                  61820000
619800     EXEC CICS                                                    61830000
619900         LINK                                                     61840000
620000             PROGRAM   (DP013-NAME)                               61850000
620100             COMMAREA  (DP013-PARAMETERS)                         61860000
620200             LENGTH    (DP013-LENGTH)                             61870000
620300     END-EXEC.                                                    61880000
620400/                                                                 61890000
620500*----------------------------------------------------------------*61900000
620600*    ABEND PROCESSOR MODULE                                      *61910000
620700*----------------------------------------------------------------*61920000
620800                                                                  61930000
620900     COPY DPPD013.                                                61940000
