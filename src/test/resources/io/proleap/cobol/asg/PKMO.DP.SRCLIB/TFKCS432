      *-----------------------*                                         00010040
       IDENTIFICATION DIVISION.                                         00020040
      *-----------------------*                                         00030040
       PROGRAM-ID.    TFKCS432.                                         00040040
       AUTHOR.        JACK KRAMER.                                      00050040
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060040
       DATE-WRITTEN.  SEPTEMBER 1996.                                   00070040
       DATE-COMPILED.                                                   00080040
      *----------------------------------------------------------------*00090040
      *    P432 - TRANSFER VOID                                        *00100040
      *                                                                *00110040
      *    THIS PROGRAM DISPLAYS HEADER INFORMATION FOR A SELECTED     *00120040
      *    TRANSFER AND ALLOWS THAT TRANSFER TO BE VOIDED.             *00130040
111703******************************************************************00141041
111703* 11/17/2003 - RAY GRAF                                           00142041
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00143044
111703*     REJECT SORT1 ITEMS FOR DEF/DAM SORT 2 TRANSFER TYPE         00143145
111703*     REJECT SORT2 ITEMS FOR DEF/DAM SORT 1 TRANSFER TYPE         00143245
111703*     REJECT DEPT 127 AND 427 FOR EITHER DEF/DAM TRANSFER TYPE    00143343
111703*         WHEN THE 'TO' STORE IS 811 (FINDLAY)                    00143443
111703******************************************************************00144041
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00145046
080204**     REMOVE REFERENCE TO PV-PRINTER-DEST.                       00146046
080204**     CHANGE TINVPAR TO ACCESS LOC_NBR.                          00146146
      ***************************************************************** 00147046
100404**DATE:10/14/2004 RAY GRAF                                        00148049
100404**     EXPAND STORE NUMBER.  MAKE DOMAIN COMPLIANT.               00149048
      ***************************************************************** 00149148
051705*  DATE 05/17/05 RAY GRAF                                         00149252
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00149352
051705******************************************************************00149452
022212*  DATE 02/22/12 CHERI PARMLEY             PRJ#3403               00149655
022212*  COMPILE DUE TO CHANGES TO TTFITEM                              00149754
022212******************************************************************00149854
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00149956
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00150056
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00150156
CICS  *-----------------------------------------------------------------00150256
                                                                        00151040
       ENVIRONMENT DIVISION.                                            00160040
                                                                        00170040
       DATA DIVISION.                                                   00180040
                                                                        00190040
       WORKING-STORAGE SECTION.                                         00200040
                                                                        00210040
       01  DK-DB2-KEYS.                                                 00220040
           05  DK-STORE-NBR             PIC S9(04)  COMP  VALUE +0.     00230040
080204     05  DK-STORE-NBR-9           PIC S9(04)  COMP  VALUE +0.     00240047
           05  DK-FROM-STORE            PIC S9(04)  COMP  VALUE +0.     00260040
           05  DK-XFER-SEQ-NBR          PIC S9(09)  COMP  VALUE +0.     00270040
           05  DK-XFER-DKEY-ID          PIC S9(09)  COMP  VALUE +0.     00280040
      *                                                                 00290040
       01  PC-PROGRAM-CONSTANTS.                                        00300040
           05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TFKCS432'.  00310040
           05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TF432A  '.  00320040
           05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TFKM432 '.  00330040
           05  PC-TRAILER-CONTAINER     PIC  X(02)  VALUE '04'.         00340040
           05  PC-COMPLETE-STATUS       PIC  X(02)  VALUE 'CM'.         00350040
           05  PC-POSITIVE-STATUS       PIC  X(02)  VALUE 'PR'.         00360040
           05  PC-ASSUMPTIVE-STATUS     PIC  X(02)  VALUE 'AR'.         00370040
           05  PC-VOID-STATUS           PIC  X(02)  VALUE 'VD'.         00380040
111703*    05  PC-XFER-DEFECTIVE        PIC  X(02)  VALUE  '01'.        00390042
111703     05  PC-DEFECTIVE-DAMAGE-SORT1 PIC  X(02)  VALUE  '00'.       00391044
111703     05  PC-DEFECTIVE-DAMAGE-SORT2 PIC  X(02)  VALUE  '01'.       00392044
           05  PC-XFER-CALLBACK         PIC  X(02)  VALUE  '02'.        00400040
           05  PC-XFER-BALANCE-CORP     PIC  X(02)  VALUE  '03'.        00410040
           05  PC-XFER-BALANCE-STORE    PIC  X(02)  VALUE  '04'.        00420040
           05  PC-XFER-CUSTOMER         PIC  X(02)  VALUE  '05'.        00430040
           05  PC-XFER-NON-RETAIL       PIC  X(02)  VALUE  '06'.        00440040
           05  PC-XFER-OFFSITE-STORAGE  PIC  X(02)  VALUE  '07'.        00450040
           05  PC-HAND-CARRY            PIC  X(02)  VALUE  '05'.        00460040
           05  PC-YES                   PIC  X(01)  VALUE  'Y'.         00470040
           05  PC-NO                    PIC  X(01)  VALUE  'N'.         00480040
           05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00490040
                                                    COMP.               00500040
051705*    05  PC-MAX-DATE                 PIC X(10) VALUE '9999-09-09'.00510052
051705*    05  PC-MIN-DATE                 PIC X(10) VALUE '0001-01-01'.00520052
           05  PC-INTER-APPL-CODES.                                     00530040
               10  PC-INTER-APPL-CRIT-SPEC                              00540040
                                        PIC  X(01)  VALUE '1'.          00550040
               10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00560040
           05  PC-TSYMSG-NUMBERS.                                       00570040
               10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00580040
               10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00590040
               10  PC-TSYMSG-01402      PIC  9(05)  VALUE  01402.       00600040
               10  PC-TSYMSG-01404      PIC  9(05)  VALUE  01404.       00610040
               10  PC-TSYMSG-01615            PIC  9(05)  VALUE 01615.  00620040
               10  PC-TSYMSG-01659            PIC  9(05)  VALUE 01659.  00630040
           05  PC-TRAILER-SEAL-LITERAL  PIC X(15)   VALUE               00640040
                     'TRAILER SEAL..:'.                                 00650040
           05  PC-ATTENTION-LITERAL     PIC X(15)   VALUE               00660040
                     'ATTENTION TO..:'.                                 00670040
           05  PC-CUSTOMER-LITERAL      PIC X(15)   VALUE               00680040
                     'CUSTOMER NAME.:'.                                 00690040
           05  PC-LARGE-TOTE-LITERAL    PIC X(15)   VALUE               00700040
                     'LG TOTE SEAL..:'.                                 00710040
           05  PC-SMALL-TOTE-LITERAL    PIC X(16)   VALUE               00720040
                     'SM TOTE SEAL...:'.                                00730040
           05  PC-CALLBACK-LITERAL      PIC X(16)   VALUE               00740040
                     'CALLBACK NO....:'.                                00750040
           05  PC-APPROVAL-LITERAL      PIC X(16)   VALUE               00760040
                     'APPROVAL NO....:'.                                00770040
           05  PC-REQUESTED-BY-LITERAL  PIC X(16)   VALUE               00780040
                     'REQUESTED BY...:'.                                00790040
           05  PC-TRAILER-NBR-LITERAL   PIC X(16)   VALUE               00800040
                     'TRAILER NO.....:'.                                00810040
      *                                                                 00820040
       01  PS-PROGRAM-SWITCHES.                                         00830040
           05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00840040
               88  PS-NO-ERROR                             VALUE 'Y'.   00850040
               88  PS-ERROR                                VALUE 'N'.   00860040
           05  PS-TRANSFER-FOUND-SW     PIC X.                          00870040
               88  PS-TRANSFER-FOUND             VALUE 'Y'.             00880040
               88  PS-TRANSFER-NOT-FOUND         VALUE 'N'.             00890040
           05  PS-POSTINGS-IND          PIC  X(01)  VALUE 'N'.          00900040
               88  PS-MORE-POSTINGS                 VALUE 'N'.          00910040
               88  PS-END-OF-POSTINGS               VALUE 'Y'.          00920040
051705*    05  PS-INVENTORY-ERROR-SW     PIC X.                         00930052
051705*        88  PS-INVENTORY-ERROR            VALUE 'Y'.             00940052
051705*        88  PS-NO-INVENTORY-ERROR         VALUE 'N'.             00950052
      *                                                                 00960040
       01  VF-VARCHAR-FIELDS.                                           00970040
           05  VF-VARCHAR-SW                  PIC X(01)  VALUE ' '.     00980040
               88  VF-VARCHAR-BEGIN                      VALUE 'B'.     00990040
               88  VF-VARCHAR-END                        VALUE 'E'.     01000040
           05  VF-VARCHAR-WORK-FIELD.                                   01010040
               10  VF-VARCHAR                 OCCURS 320 TIMES          01020040
                                              INDEXED BY VF-IND         01030040
                                              PIC X.                    01040040
      *                                                                 01050040
       01  PV-PROGRAM-VARIABLES.                                        01060040
           05  PV-CURRENT-TIMESTAMP     PIC X(26).                      01070040
           05  PV-XFER-STAT-CDE         PIC X(02)     VALUE SPACE.      01080040
           05  PV-XFER-QTY              PIC S9(07)    VALUE +0 COMP-3.  01090040
           05  PV-XFER-PRICE            PIC S9(09)V99 VALUE +0 COMP-3.  01100040
           05  PV-RCVD-QTY              PIC S9(07)    VALUE +0 COMP-3.  01110040
           05  PV-RCVD-PRICE            PIC S9(09)V99 VALUE +0 COMP-3.  01120040
           05  PV-XFER-LNE-NBR          PIC S9(04)    VALUE +0 COMP.    01130040
           05  PV-RTL-PRICE             PIC S9(07)V99 VALUE +0 COMP-3.  01140040
           05  PV-QTY                   PIC S9(04)    VALUE +0 COMP.    01150040
           05  PV-TO-STR-NBR            PIC S9(04)    VALUE +0 COMP.    01160040
           05  PV-FRM-STR-NBR           PIC S9(04)    VALUE +0 COMP.    01170040
           05  PV-PRCG-CDE              PIC X(02)     VALUE SPACE.      01180040
           05  PV-SUB                   PIC S9(04)  VALUE +0            01190040
                                                    COMP SYNC.          01200040
           05  PV-XFER-QTY-IND          PIC S9(04)  VALUE +0            01210040
                                                    COMP SYNC.          01220040
           05  PV-XFER-PRICE-IND        PIC S9(04)  VALUE +0            01230040
                                                    COMP SYNC.          01240040
           05  PV-RCVD-QTY-IND          PIC S9(04)  VALUE +0            01250040
                                                    COMP SYNC.          01260040
           05  PV-RCVD-PRICE-IND        PIC S9(04)  VALUE +0            01270040
                                                    COMP SYNC.          01280040
           05  PV-RETRY-COUNT           PIC S9(04)  VALUE +0            01290040
                                                    COMP SYNC.          01300040
           05  PV-PSTG-SEQ-NBR          PIC S9(04)  VALUE ZEROS         01310040
                                                    COMP SYNC.          01320040
           05  PV-NULL-IND              PIC S9(04)  VALUE ZEROS         01330040
                                                    COMP SYNC.          01340040
           05  PV-DISPLAY-XFER-DKEY-ID  PIC  9(09)  VALUE ZEROS.        01350040
           05  PV-DISPLAY-XFER-LNE-NBR  PIC  9(04)  VALUE ZEROS.        01360040
           05  PV-DISPLAY-PSTG-SEQ-NBR  PIC  9(04)  VALUE ZEROS.        01370040
           05  PV-PHONE                 PIC 9999BB999B9999.             01410040
           05  FILLER REDEFINES PV-PHONE.                               01420040
               10  PV-PHONE-LIT1        PIC X.                          01430040
               10                       PIC X(03).                      01440040
               10  PV-PHONE-LIT2        PIC X(02).                      01450040
               10                       PIC X(03).                      01460040
               10  PV-PHONE-LIT3        PIC X.                          01470040
               10                       PIC X(04).                      01480040
           05  PV-XFER-NBR.                                             01490040
100404*        10  PV-FROM-STORE              PIC 9(03).                01500048
100404         10  PV-FROM-STORE              PIC 9(04).                01501051
               10                             PIC X(01)    VALUE '-'.   01510040
               10  PV-SEQ-NBR                 PIC 9(06).                01520040
           05  PV-DATE.                                                 01530040
               10  PV-MONTH             PIC 9(02).                      01540040
               10                       PIC X      VALUE '/'.           01550040
               10  PV-DAY               PIC 9(02).                      01560040
               10                       PIC X      VALUE '/'.           01570040
               10  PV-YEAR              PIC 9(04).                      01580040
           05  PV-STATE-ZIP.                                            01590040
               10  PV-STATE             PIC X(02).                      01600040
               10                       PIC X      VALUE SPACE.         01610040
               10  PV-ZIP               PIC 9(05).                      01620040
               10  PV-ZIP-EXTENSION.                                    01630040
                   15  PV-ZIP-DASH      PIC X.                          01640040
                   15  PV-ZIP-EXT       PIC 9(04).                      01650040
051705*    05  PV-MAX-FINCL-BK-DTE            PIC  X(10)  VALUE SPACE.  01660052
051705*    05  PV-FR-STR-INV-DTE              PIC  X(10)  VALUE SPACE.  01670052
051705*    05  PV-TO-STR-INV-DTE              PIC  X(10)  VALUE SPACE.  01680052
051705*    05  PV-XFER-INV-CTOFF-DTE          PIC  X(10)  VALUE SPACE.  01690052
051705*    05  PV-LY-INV-CTOFF-DTE            PIC  X(10)  VALUE SPACE.  01700052
051705*    05  PV-MAX-PLND-INV-DTE            PIC  X(10)  VALUE SPACE.  01710052
051705*    05  PV-PHY-INV-PERD-IND            PIC  X(10)  VALUE SPACE.  01720052
051705*    05  PV-CURRENT-DATE                PIC X(10).                01730052
051705*    05  PV-COMPARE-DATE                PIC X(10).                01740052
051705*    05  PV-HOLD-INVENTORY-IND           PIC X(01)   VALUE 'N'.   01750052
051705*        88  PV-HOLD-PHYSICAL-COUNT                  VALUE 'Y'.   01760052
051705*        88  PV-HOLD-FAKE-INVENTORY                  VALUE 'F'.   01770052
051705*        88  PV-HOLD-NO-INVENTORY                    VALUE 'N'.   01780052
051705*    05  PV-FR-INVENTORY-IND             PIC X(01)   VALUE 'N'.   01790052
051705*        88  PV-FR-PHYSICAL-COUNT                    VALUE 'Y'.   01800052
051705*        88  PV-FR-FAKE-INVENTORY                    VALUE 'F'.   01810052
051705*        88  PV-FR-NO-INVENTORY                      VALUE 'N'.   01820052
051705*    05  PV-TO-INVENTORY-IND             PIC X(01)   VALUE 'N'.   01830052
051705*        88  PV-TO-PHYSICAL-COUNT                    VALUE 'Y'.   01840052
051705*        88  PV-TO-FAKE-INVENTORY                    VALUE 'F'.   01850052
051705*        88  PV-TO-NO-INVENTORY                      VALUE 'N'.   01860052
           EJECT                                                        01870040
      *----------------------------------------------------------------*01880040
      *    MAP LAYOUT                                                  *01890040
      *----------------------------------------------------------------*01900040
                                                                        01910040
           COPY TFKM432.                                                01920040
      *                                                                 01930040
       EJECT                                                            01940040
      ******************************************************************01950040
      *  ** NOTE **                                                    *01960040
      *      THE FOLLOWING IS A REDEFINITION OF THE TFKM432 MAP DSECT. *01970040
      *  ANY CHANGES TO THE MAP/DSECT MUST ALSO BE REFLECTED IN THIS   *01980040
      *  REDEFINITION.                                                 *01990040
      *  THE SCREEN IS OUTPUT ONLY AND DISPLAYS VARYING FIELDS         *02000040
      *  DEPENDING ON THE TRANSFER TYPE AND CONTAINER TYPE.            *02010040
      ******************************************************************02020040
      *                                                                 02030040
       01  MR-MAP-REDEFINITION                REDEFINES  TF432AO.       02040040
           05  FILLER                         PIC  X(12).               02050040
      *                                                                 02060040
           05  MR-XFER-NBR-LEN                PIC S9(04) COMP.          02070040
           05  MR-XFER-NBR-FLAG               PIC  X(01).               02080040
           05  MR-XFER-NBR-ATTRIB REDEFINES MR-XFER-NBR-FLAG            02090040
                                              PIC  X(01).               02100040
           05  MR-XFER-NBR-COLOR              PIC  X(01).               02110040
           05  MR-XFER-NBR-HILITE             PIC  X(01).               02120040
           05  MR-XFER-NBR.                                             02130040
100404*        10  MR-XFER-FROM-STORE         PIC  999.                 02140048
100404         10  MR-XFER-FROM-STORE         PIC  9(4).                02141050
               10  MR-XFER-NBR-DASH           PIC  X.                   02150040
               10  MR-XFER-SEQ-NBR            PIC  9(06).               02160040
      *                                                                 02170040
           05  MR-TO-NBR-LEN               PIC S9(04) COMP.             02180040
           05  MR-TO-NBR-FLAG              PIC  X(01).                  02190040
           05  MR-TO-NBR-ATTRIB REDEFINES MR-TO-NBR-FLAG                02200040
                                              PIC  X(01).               02210040
           05  MR-TO-NBR-COLOR                PIC  X(01).               02220040
           05  MR-TO-NBR-HILITE               PIC  X(01).               02230040
100404*    05  MR-TO-NBR                      PIC  X(03).               02240048
100404     05  MR-TO-NBR                      PIC  X(04).               02241050
      *                                                                 02250040
           05  MR-TO-NAME-LEN              PIC S9(04) COMP.             02260040
           05  MR-TO-NAME-FLAG             PIC  X(01).                  02270040
           05  MR-TO-NAME-ATTRIB REDEFINES MR-TO-NAME-FLAG              02280040
                                              PIC  X(01).               02290040
           05  MR-TO-NAME-COLOR               PIC  X(01).               02300040
           05  MR-TO-NAME-HILITE              PIC  X(01).               02310040
           05  MR-TO-NAME                     PIC  X(10).               02320040
      *                                                                 02330040
           05  MR-STATUS-LEN                  PIC S9(04) COMP.          02340040
           05  MR-STATUS-FLAG                 PIC  X(01).               02350040
           05  MR-STATUS-ATTRIB REDEFINES MR-STATUS-FLAG                02360040
                                              PIC  X(01).               02370040
           05  MR-STATUS-COLOR                PIC  X(01).               02380040
           05  MR-STATUS-HILITE               PIC  X(01).               02390040
           05  MR-STATUS                      PIC  X(20).               02400040
      *                                                                 02410040
           05  MR-LIN5-LITERAL-LEN            PIC S9(04) COMP.          02420040
           05  MR-LIN5-LITERAL-FLAG           PIC  X(01).               02430040
           05  MR-LIN5-LITERAL-ATTRIB REDEFINES MR-LIN5-LITERAL-FLAG    02440040
                                              PIC  X(01).               02450040
           05  MR-LIN5-LITERAL-COLOR          PIC  X(01).               02460040
           05  MR-LIN5-LITERAL-HILITE         PIC  X(01).               02470040
           05  MR-LIN5-LITERAL                PIC  X(16).               02480040
      *                                                                 02490040
           05  MR-LIN5-FIELD-LEN              PIC S9(04) COMP.          02500040
           05  MR-LIN5-FIELD-FLAG             PIC  X(01).               02510040
           05  MR-LIN5-FIELD-ATTRIB REDEFINES MR-LIN5-FIELD-FLAG        02520040
                                              PIC  X(01).               02530040
           05  MR-LIN5-FIELD-COLOR            PIC  X(01).               02540040
           05  MR-LIN5-FIELD-HILITE           PIC  X(01).               02550040
           05  MR-LIN5-FIELD                  PIC  X(22).               02560040
      *                                                                 02570040
           05  MR-XFER-TYPE-LEN               PIC S9(04) COMP.          02580040
           05  MR-XFER-TYPE-FLAG              PIC  X(01).               02590040
           05  MR-XFER-TYPE-ATTRIB REDEFINES MR-XFER-TYPE-FLAG          02600040
                                              PIC  X(01).               02610040
           05  MR-XFER-TYPE-COLOR             PIC  X(01).               02620040
           05  MR-XFER-TYPE-HILITE            PIC  X(01).               02630040
           05  MR-XFER-TYPE                   PIC  X(02).               02640040
      *                                                                 02650040
           05  MR-XFER-DESC-LEN               PIC S9(04) COMP.          02660040
           05  MR-XFER-DESC-FLAG              PIC  X(01).               02670040
           05  MR-XFER-DESC-ATTRIB REDEFINES MR-XFER-DESC-FLAG          02680040
                                              PIC  X(01).               02690040
           05  MR-XFER-DESC-COLOR             PIC  X(01).               02700040
           05  MR-XFER-DESC-HILITE            PIC  X(01).               02710040
           05  MR-XFER-DESC                   PIC  X(19).               02720040
      *                                                                 02730040
           05  MR-CONTAINER-TYPE-LEN          PIC S9(04) COMP.          02740040
           05  MR-CONTAINER-TYPE-FLAG         PIC  X(01).               02750040
           05  MR-CONTAINER-TYPE-ATTRIB REDEFINES MR-CONTAINER-TYPE-FLAG02760040
                                              PIC  X(01).               02770040
           05  MR-CONTAINER-TYPE-COLOR        PIC  X(01).               02780040
           05  MR-CONTAINER-TYPE-HILITE       PIC  X(01).               02790040
           05  MR-CONTAINER-TYPE              PIC  X(02).               02800040
      *                                                                 02810040
           05  MR-CONTAINER-DESC-LEN          PIC S9(04) COMP.          02820040
           05  MR-CONTAINER-DESC-FLAG         PIC  X(01).               02830040
           05  MR-CONTAINER-DESC-ATTRIB REDEFINES MR-CONTAINER-DESC-FLAG02840040
                                              PIC  X(01).               02850040
           05  MR-CONTAINER-DESC-COLOR        PIC  X(01).               02860040
           05  MR-CONTAINER-DESC-HILITE       PIC  X(01).               02870040
           05  MR-CONTAINER-DESC              PIC  X(18).               02880040
      *                                                                 02890040
           05  MR-LIN7-LITERAL1-LEN           PIC S9(04) COMP.          02900040
           05  MR-LIN7-LITERAL1-FLAG          PIC  X(01).               02910040
           05  MR-LIN7-LITERAL1-ATTRIB REDEFINES  MR-LIN7-LITERAL1-FLAG 02920040
                                              PIC  X(01).               02930040
           05  MR-LIN7-LITERAL1-COLOR         PIC  X(01).               02940040
           05  MR-LIN7-LITERAL1-HILITE        PIC  X(01).               02950040
           05  MR-LIN7-LITERAL1               PIC  X(15).               02960040
      *                                                                 02970040
           05  MR-LIN7-FIELD1-LEN             PIC S9(04) COMP.          02980040
           05  MR-LIN7-FIELD1-FLAG            PIC  X(01).               02990040
           05  MR-LIN7-FIELD1-ATTRIB REDEFINES MR-LIN7-FIELD1-FLAG      03000040
                                              PIC  X(01).               03010040
           05  MR-LIN7-FIELD1-COLOR           PIC  X(01).               03020040
           05  MR-LIN7-FIELD1-HILITE          PIC  X(01).               03030040
           05  MR-LIN7-FIELD1.                                          03040040
               10  MR-LIN7-SEAL1              PIC X(07).                03050040
               10                             PIC X.                    03060040
               10  MR-LIN7-SEAL2              PIC X(07).                03070040
      *                                                                 03080040
           05  MR-LIN7-LITERAL2-LEN           PIC S9(04) COMP.          03090040
           05  MR-LIN7-LITERAL2-FLAG          PIC  X(01).               03100040
           05  MR-LIN7-LITERAL2-ATTRIB REDEFINES  MR-LIN7-LITERAL2-FLAG 03110040
                                              PIC  X(01).               03120040
           05  MR-LIN7-LITERAL2-COLOR         PIC  X(01).               03130040
           05  MR-LIN7-LITERAL2-HILITE        PIC  X(01).               03140040
           05  MR-LIN7-LITERAL2               PIC  X(16).               03150040
      *                                                                 03160040
           05  MR-LIN7-FIELD2-LEN             PIC S9(04) COMP.          03170040
           05  MR-LIN7-FIELD2-FLAG            PIC  X(01).               03180040
           05  MR-LIN7-FIELD2-ATTRIB REDEFINES MR-LIN7-FIELD2-FLAG      03190040
                                              PIC  X(01).               03200040
           05  MR-LIN7-FIELD2-COLOR           PIC  X(01).               03210040
           05  MR-LIN7-FIELD2-HILITE          PIC  X(01).               03220040
           05  MR-LIN7-FIELD2                 PIC  X(08).               03230040
      *                                                                 03240040
           05  MR-LIN8-LITERAL-LEN            PIC S9(04) COMP.          03250040
           05  MR-LIN8-LITERAL-FLAG           PIC  X(01).               03260040
           05  MR-LIN8-LITERAL-ATTRIB REDEFINES   MR-LIN8-LITERAL-FLAG  03270040
                                              PIC  X(01).               03280040
           05  MR-LIN8-LITERAL-COLOR          PIC  X(01).               03290040
           05  MR-LIN8-LITERAL-HILITE         PIC  X(01).               03300040
           05  MR-LIN8-LITERAL                PIC  X(15).               03310040
      *                                                                 03320040
           05  MR-LIN8-FIELD-LEN              PIC S9(04) COMP.          03330040
           05  MR-LIN8-FIELD-FLAG             PIC  X(01).               03340040
           05  MR-LIN8-FIELD-ATTRIB REDEFINES MR-LIN8-FIELD-FLAG        03350040
                                              PIC  X(01).               03360040
           05  MR-LIN8-FIELD-COLOR            PIC  X(01).               03370040
           05  MR-LIN8-FIELD-HILITE           PIC  X(01).               03380040
           05  MR-LIN8-FIELD                  PIC  X(20).               03390040
      *                                                                 03400040
           05  MR-PHONE-LITERAL-LEN           PIC S9(04) COMP.          03410040
           05  MR-PHONE-LITERAL-FLAG          PIC  X(01).               03420040
           05  MR-PHONE-LITERAL-ATTRIB REDEFINES MR-PHONE-LITERAL-FLAG  03430040
                                              PIC  X(01).               03440040
           05  MR-PHONE-LITERAL-COLOR         PIC  X(01).               03450040
           05  MR-PHONE-LITERAL-HILITE        PIC  X(01).               03460040
           05  MR-PHONE-LITERAL               PIC  X(16).               03470040
      *                                                                 03480040
           05  MR-PHONE-LEN                   PIC S9(04) COMP.          03490040
           05  MR-PHONE-FLAG                  PIC  X(01).               03500040
           05  MR-PHONE-ATTRIB REDEFINES MR-PHONE-FLAG                  03510040
                                              PIC  X(01).               03520040
           05  MR-PHONE-COLOR                 PIC  X(01).               03530040
           05  MR-PHONE-HILITE                PIC  X(01).               03540040
           05  MR-PHONE                       PIC  X(14).               03550040
      *                                                                 03560040
           05  MR-ADDR-LITERAL-LEN            PIC S9(04) COMP.          03570040
           05  MR-ADDR-LITERAL-FLAG           PIC  X(01).               03580040
           05  MR-ADDR-LITERAL-ATTRIB REDEFINES MR-ADDR-LITERAL-FLAG    03590040
                                              PIC  X(01).               03600040
           05  MR-ADDR-LITERAL-COLOR          PIC  X(01).               03610040
           05  MR-ADDR-LITERAL-HILITE         PIC  X(01).               03620040
           05  MR-ADDR-LITERAL                PIC  X(12).               03630040
      *                                                                 03640040
           05  MR-ADDR-LEN                    PIC S9(04) COMP.          03650040
           05  MR-ADDR-FLAG                   PIC  X(01).               03660040
           05  MR-ADDR-ATTRIB REDEFINES MR-ADDR-FLAG                    03670040
                                              PIC  X(01).               03680040
           05  MR-ADDR-COLOR                  PIC  X(01).               03690040
           05  MR-ADDR-HILITE                 PIC  X(01).               03700040
           05  MR-ADDR                        PIC  X(20).               03710040
      *                                                                 03720040
           05  MR-CITY-LITERAL-LEN         PIC S9(04) COMP.             03730040
           05  MR-CITY-LITERAL-FLAG        PIC  X(01).                  03740040
           05  MR-CITY-LITERAL-ATTRIB REDEFINES MR-CITY-LITERAL-FLAG    03750040
                                              PIC  X(01).               03760040
           05  MR-CITY-LITERAL-COLOR          PIC  X(01).               03770040
           05  MR-CITY-LITERAL-HILITE         PIC  X(01).               03780040
           05  MR-CITY-LITERAL                PIC  X(13).               03790040
      *                                                                 03800040
           05  MR-CITY-LEN                    PIC S9(04) COMP.          03810040
           05  MR-CITY-FLAG                   PIC  X(01).               03820040
           05  MR-CITY-ATTRIB REDEFINES MR-CITY-FLAG                    03830040
                                              PIC  X(01).               03840040
           05  MR-CITY-COLOR                  PIC  X(01).               03850040
           05  MR-CITY-HILITE                 PIC  X(01).               03860040
           05  MR-CITY                        PIC  X(20).               03870040
      *                                                                 03880040
           05  MR-STATE-LITERAL-LEN        PIC S9(04) COMP.             03890040
           05  MR-STATE-LITERAL-FLAG       PIC  X(01).                  03900040
           05  MR-STATE-LITERAL-ATTRIB REDEFINES MR-STATE-LITERAL-FLAG  03910040
                                              PIC  X(01).               03920040
           05  MR-STATE-LITERAL-COLOR         PIC  X(01).               03930040
           05  MR-STATE-LITERAL-HILITE        PIC  X(01).               03940040
           05  MR-STATE-LITERAL               PIC  X(13).               03950040
      *                                                                 03960040
           05  MR-STATE-ZIP-LEN               PIC S9(04) COMP.          03970040
           05  MR-STATE-ZIP-FLAG              PIC  X(01).               03980040
           05  MR-STATE-ZIP-ATTRIB REDEFINES MR-STATE-ZIP-FLAG          03990040
                                              PIC  X(01).               04000040
           05  MR-STATE-ZIP-COLOR             PIC  X(01).               04010040
           05  MR-STATE-ZIP-HILITE            PIC  X(01).               04020040
           05  MR-STATE-ZIP                   PIC  X(13).               04030040
      *                                                                 04040040
           05  MR-FROM-NBR-LEN             PIC S9(04) COMP.             04050040
           05  MR-FROM-NBR-FLAG            PIC  X(01).                  04060040
           05  MR-FROM-NBR-ATTRIB REDEFINES MR-FROM-NBR-FLAG            04070040
                                              PIC  X(01).               04080040
           05  MR-FROM-NBR-COLOR              PIC  X(01).               04090040
           05  MR-FROM-NBR-HILITE             PIC  X(01).               04100040
100404*    05  MR-FROM-NBR                    PIC  X(03).               04110048
100404     05  MR-FROM-NBR                    PIC  X(04).               04111050
      *                                                                 04120040
           05  MR-FROM-NAME-LEN            PIC S9(04) COMP.             04130040
           05  MR-FROM-NAME-FLAG           PIC  X(01).                  04140040
           05  MR-FROM-NAME-ATTRIB REDEFINES MR-FROM-NAME-FLAG          04150040
                                              PIC  X(01).               04160040
           05  MR-FROM-NAME-COLOR             PIC  X(01).               04170040
           05  MR-FROM-NAME-HILITE            PIC  X(01).               04180040
           05  MR-FROM-NAME                   PIC  X(10).               04190040
      *                                                                 04200040
           05  MR-FROM-SCAN-LEN            PIC S9(04) COMP.             04210040
           05  MR-FROM-SCAN-FLAG           PIC  X(01).                  04220040
           05  MR-FROM-SCAN-ATTRIB REDEFINES MR-FROM-SCAN-FLAG          04230040
                                              PIC  X(01).               04240040
           05  MR-FROM-SCAN-COLOR             PIC  X(01).               04250040
           05  MR-FROM-SCAN-HILITE            PIC  X(01).               04260040
           05  MR-FROM-SCAN                   PIC  X(01).               04270040
      *                                                                 04280040
           05  MR-COMP-BY-LEN              PIC S9(04) COMP.             04290040
           05  MR-COMP-BY-FLAG             PIC  X(01).                  04300040
           05  MR-COMP-BY-ATTRIB REDEFINES MR-COMP-BY-FLAG              04310040
                                              PIC  X(01).               04320040
           05  MR-COMP-BY-COLOR               PIC  X(01).               04330040
           05  MR-COMP-BY-HILITE              PIC  X(01).               04340040
           05  MR-COMP-BY                     PIC  X(22).               04350040
      *                                                                 04360040
           05  MR-COMP-DATE-LEN            PIC S9(04) COMP.             04370040
           05  MR-COMP-DATE-FLAG           PIC  X(01).                  04380040
           05  MR-COMP-DATE-ATTRIB REDEFINES MR-COMP-DATE-FLAG          04390040
                                              PIC  X(01).               04400040
           05  MR-COMP-DATE-COLOR             PIC  X(01).               04410040
           05  MR-COMP-DATE-HILITE            PIC  X(01).               04420040
           05  MR-COMP-DATE                   PIC  X(10).               04430040
      *                                                                 04440040
           05  MR-COMP-QTY-LEN             PIC S9(04) COMP.             04450040
           05  MR-COMP-QTY-FLAG            PIC  X(01).                  04460040
           05  MR-COMP-QTY-ATTRIB REDEFINES MR-COMP-QTY-FLAG            04470040
                                              PIC  X(01).               04480040
           05  MR-COMP-QTY-COLOR              PIC  X(01).               04490040
           05  MR-COMP-QTY-HILITE             PIC  X(01).               04500040
           05  MR-COMP-QTY                    PIC  ZZZZ9.               04510040
      *                                                                 04520040
           05  MR-COMP-LITERAL-LEN            PIC S9(04) COMP.          04530040
           05  MR-COMP-LITERAL-FLAG           PIC  X(01).               04540040
           05  MR-COMP-LITERAL-ATTRIB REDEFINES MR-COMP-LITERAL-FLAG    04550040
                                              PIC  X(01).               04560040
           05  MR-COMP-LITERAL-COLOR          PIC  X(01).               04570040
           05  MR-COMP-LITERAL-HILITE         PIC  X(01).               04580040
           05  MR-COMP-LITERAL                PIC  X(16).               04590040
      *                                                                 04600040
           05  MR-COMP-RETAIL-LEN             PIC S9(04) COMP.          04610040
           05  MR-COMP-RETAIL-FLAG            PIC  X(01).               04620040
           05  MR-COMP-RETAIL-ATTRIB REDEFINES MR-COMP-RETAIL-FLAG      04630040
                                              PIC  X(01).               04640040
           05  MR-COMP-RETAIL-COLOR           PIC  X(01).               04650040
           05  MR-COMP-RETAIL-HILITE          PIC  X(01).               04660040
           05  MR-COMP-RETAIL                 PIC  Z(06).99.            04670040
                                                                        04680040
           05  MR-USERID-L           PIC S9(04) COMP.                   04690040
           05  MR-USERID-A           PIC  X(01).                        04700040
           05  MR-USERID-C           PIC  X(01).                        04710040
           05  MR-USERID-H           PIC  X(01).                        04720040
           05  MR-USERID             PIC  X(08).                        04730040
                                                                        04740040
           05  MR-COMMENTS-AREA OCCURS 4 TIMES.                         04750040
               10  MR-COMMENT-L      PIC S9(04) COMP.                   04760040
               10  MR-COMMENT-A      PIC  X(01).                        04770040
               10  MR-COMMENT-C      PIC  X(01).                        04780040
               10  MR-COMMENT-H      PIC  X(01).                        04790040
               10  MR-COMMENT        PIC  X(79).                        04800040
      *                                                                 04810040
      *                                                                 04820040
       EJECT                                                            04830040
      *----------------------------------------------------------------*04840040
      *    ATTRIBUTE SETTINGS COPYBOOK.                                *04850040
      *----------------------------------------------------------------*04860040
                                                                        04870040
           COPY DPWS015.                                                04880040
                                                                        04890040
      *----------------------------------------------------------------*04900040
      *    FUNCTION KEYS COPYBOOK                                      *04910040
      *----------------------------------------------------------------*04920040
                                                                        04930040
           COPY DPWS016.                                                04940040
                                                                        04950040
       EJECT                                                            04960040
      **--------------------------------------------------------------**04970040
      ** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **04980040
      ** SUB-ROUTINE (DPKUT100).                                      **04990040
      **--------------------------------------------------------------**05000040
           COPY DPWS010I.                                               05010040
       EJECT                                                            05020040
      **--------------------------------------------------------------**05030040
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*05040040
      ** APPLICATION PROGRAMMING INTERFACE MODULE.                    **05050056
      **--------------------------------------------------------------**05060040
           COPY DPWS030.                                                05070040
CICS       COPY DPWS930.                                                05071056
       EJECT                                                            05080040
      **--------------------------------------------------------------**05090040
      *    STANDARD COMMAREA.                                           05100040
      **--------------------------------------------------------------**05110040
                                                                        05120040
           COPY DPWS020.                                                05130040
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05140040
                                                                        05150040
      ***************************************************************** 05160040
      *    INTER-APPLICATION COMMAREA.                                  05170040
      ***************************************************************** 05180040
                                                                        05190040
               10  INTER-APPL-COMM-AREA PIC X(200).                     05200040
           COPY TFWS001.                                                05210040
      ***************************************************************** 05220040
      *    SPECIFIC COMMMAREA FOR TFKCS432.                             05230040
      ***************************************************************** 05240040
               10  ASC-SPECIFIC-COMMAREA.                               05250040
                   15  ASC-XFER-NBR.                                    05260040
100404*                20  ASC-XFER-FROM-STORE   PIC 9(03).             05270048
100404                 20  ASC-XFER-FROM-STORE   PIC 9(04).             05271050
                       20  ASC-XFER-SEQ-NBR      PIC 9(06).             05280040
                   15  ASC-XFER-STATUS           PIC X(02).             05290040
                   15  ASC-XFER-STATUS-DESC      PIC X(20).             05300040
                   15  ASC-XFER-TYPE             PIC X(02).             05310040
                   15  ASC-XFER-DKEY-ID          PIC S9(09) COMP.       05320040
                   15  ASC-XFER-DESC             PIC X(19).             05330040
                   15  ASC-ENTRY-METHOD          PIC X(02).             05340040
                       88  ASC-ENTRY-SCANNED          VALUE '01'.       05350040
                   15  ASC-CALLBACK-NBR          PIC 9(04).             05360040
                   15  ASC-APPROVAL-NBR          PIC 9(09).             05370040
                   15  ASC-CONTAINER-TYPE        PIC X(02).             05380040
                   15  ASC-CONTAINER-DESC        PIC X(20).             05390040
                   15  ASC-LARGE-TOTE-SEAL1      PIC X(07).             05400040
                   15  ASC-LARGE-TOTE-SEAL2      PIC X(07).             05410040
                   15  ASC-SMALL-TOTE-SEAL       PIC X(07).             05420040
                   15  ASC-TRAILER-NBR           PIC X(08).             05430040
                   15  ASC-TRAILER-SEAL          PIC X(07).             05440040
                   15  ASC-CUST-NAME             PIC X(20).             05450040
                   15  ASC-CUST-ADDRESS          PIC X(20).             05460040
                   15  ASC-CUST-PHONE            PIC 9(10).             05470040
                   15  ASC-CUST-CITY             PIC X(20).             05480040
                   15  ASC-CUST-STATE            PIC X(02).             05490040
                   15  ASC-CUST-ZIP              PIC 9(05).             05500040
                   15  ASC-CUST-ZIP-EXT          PIC 9(04).             05510040
100404*            15  ASC-FROM-STORE-NBR        PIC 9(03).             05520048
100404             15  ASC-FROM-STORE-NBR        PIC 9(04).             05521050
                   15  ASC-FROM-STORE-NAME       PIC X(10).             05530040
                   15  ASC-ATTENTION.                                   05540040
                       20  ASC-ATTENTION-INIT    PIC X(01).             05550040
                       20                        PIC X(01).             05560040
                       20  ASC-ATTENTION-NAME    PIC X(20).             05570040
                   15  ASC-REQUESTOR.                                   05580040
                       20  ASC-REQUESTOR-INIT    PIC X(01).             05590040
                       20                        PIC X(01).             05600040
                       20  ASC-REQUESTOR-NAME    PIC X(20).             05610040
                   15  ASC-COMPLETED-BY.                                05620040
                       20  ASC-COMPLETED-INIT    PIC X(01).             05630040
                       20                        PIC X(01).             05640040
                       20  ASC-COMPLETED-NAME    PIC X(20).             05650040
                   15  ASC-COMPLETION-DATE.                             05660040
                       20  ASC-COMP-YEAR         PIC 9(04).             05670040
                       20                        PIC X(01).             05680040
                       20  ASC-COMP-MONTH        PIC 9(02).             05690040
                       20                        PIC X(01).             05700040
                       20  ASC-COMP-DAY          PIC 9(02).             05710040
                   15  ASC-CMPLT-DATE  REDEFINES                        05720040
                       ASC-COMPLETION-DATE       PIC X(10).             05730040
                   15  ASC-COMPLETED-QTY         PIC 9(05).             05740040
                   15  ASC-COMPLETED-RETAIL      PIC 9(06)V99.          05750040
100404*            15  ASC-TO-STORE-NBR          PIC 9(03).             05760048
100404             15  ASC-TO-STORE-NBR          PIC 9(04).             05761050
                   15  ASC-TO-STORE-NAME         PIC X(10).             05770040
                   15  ASC-COMMENT-ARRAY.                               05780040
                       20  ASC-COMMENT OCCURS 4 TIMES  PIC X(79).       05790040
           EJECT                                                        05800040
      *----------------------------------------------------------------*05810040
      *    ABEND PROCESSING COPYBOOK.                                  *05820040
      *----------------------------------------------------------------*05830040
                                                                        05840040
           COPY DPWS013.                                                05850040
                                                                        05860040
           EJECT                                                        05870040
                                                                        05880040
      *    DB2 AREA FOR TTFMSTR (TRANSFER TABLE)                        05890040
                                                                        05900040
           EXEC SQL                                                     05910040
                INCLUDE TTFMSTR                                         05920040
           END-EXEC.                                                    05930040
                                                                        05940040
      *    DB2 AREA FOR TTFITEM  (TRANSFER ITEM TABLE)                  05950040
                                                                        05960040
           EXEC SQL                                                     05970040
                INCLUDE TTFITEM                                         05980040
           END-EXEC.                                                    05990040
                                                                        06000040
      *    DB2 AREA FOR TTFTYCD  (TRANSFER TYPE TABLE)                  06010040
                                                                        06020040
           EXEC SQL                                                     06030040
                INCLUDE TTFTYCD                                         06040040
           END-EXEC.                                                    06050040
                                                                        06060040
      *    DB2 AREA FOR TTFSTAT  (TRANSFER STATUS TABLE)                06070040
                                                                        06080040
           EXEC SQL                                                     06090040
                INCLUDE TTFSTAT                                         06100040
           END-EXEC.                                                    06110040
                                                                        06120040
      *    DB2 AREA FOR TTFSTCD  (TRANSFER STATUS CODE TABLE)           06130040
                                                                        06140040
           EXEC SQL                                                     06150040
                INCLUDE TTFSTCD                                         06160040
           END-EXEC.                                                    06170040
                                                                        06180040
      *    DB2 AREA FOR TTFCUST  (TRANSFER CUSTOMER TABLE)              06190040
                                                                        06200040
           EXEC SQL                                                     06210040
                INCLUDE TTFCUST                                         06220040
           END-EXEC.                                                    06230040
                                                                        06240040
      *    DB2 AREA FOR TTFSHCT  (CONTAINER CODE TABLE)                 06250040
                                                                        06260040
           EXEC SQL                                                     06270040
                INCLUDE TTFSHCT                                         06280040
           END-EXEC.                                                    06290040
                                                                        06300040
      *    DB2 AREA FOR TTFITPS  (TRANSFER POSTING TABLE)               06310040
                                                                        06320040
           EXEC SQL                                                     06330040
                INCLUDE TTFITPS                                         06340040
           END-EXEC.                                                    06350040
                                                                        06360040
100404*    DB2 AREA FOR XST_LOC (STORE TABLE)                           06370048
                                                                        06380040
           EXEC SQL                                                     06390040
100404          INCLUDE XST00001                                        06400048
           END-EXEC.                                                    06410040
                                                                        06420040
051705*---------------------------------------------------------------* 06430052
051705*    DB2 AREA FOR TRANSFER CONTROL TABLE                        * 06440052
051705*---------------------------------------------------------------* 06450052
051705*    EXEC SQL                                                     06460052
051705*         INCLUDE TTFCNTL                                         06470052
051705*    END-EXEC.                                                    06480052
051705*---------------------------------------------------------------* 06490052
051705*    DB2 AREA FOR INVENTORY PARAMETERS TABLE                    * 06500052
051705*---------------------------------------------------------------* 06510052
051705*    EXEC SQL                                                     06520052
051705*         INCLUDE TINVPAR                                         06530052
051705*    END-EXEC.                                                    06540052
                                                                        06550040
      *    DB2 AREA FOR COMMUNICATIONS                                  06560040
                                                                        06570040
           EXEC SQL                                                     06580040
                INCLUDE SQLCA                                           06590040
           END-EXEC.                                                    06600040
      *---------------------------------------------------------------* 06610040
      *    CURSOR TO OBTAIN ITEM POSTINGS.                            * 06620040
      *---------------------------------------------------------------* 06630040
           EXEC SQL                                                     06640040
                DECLARE POSTING_CSR CURSOR                              06650040
                FOR SELECT                                              06660040
                      XFER_LNE_NBR                                      06670040
                    , FRM_PSTG_STR_NBR                                  06680040
                    , TO_PSTG_STR_NBR                                   06690040
                    , ITM_RTL_PRCE_AMT                                  06700040
                    , ITM_QTY                                           06710040
                    , EXTL_SYS_PRCG_CDE                                 06720040
                FROM                                                    06730040
                      TTFITPS                                           06740040
                WHERE                                                   06750040
                      XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND         06760040
                      ADJ_RSN_CDE    NOT IN (:PC-VOID-STATUS)           06770040
100404          WITH UR                                                 06771048
           END-EXEC.                                                    06780040
                                                                        06790040
                                                                        06800040
       EJECT                                                            06810040
       LINKAGE SECTION.                                                 06820040
                                                                        06830040
       01  DFHCOMMAREA.                                                 06840040
           05  FILLER                         OCCURS  1 TO 4072 TIMES   06850040
                                              DEPENDING ON EIBCALEN.    06860040
               10  FILLER                     PIC X.                    06870040
                                                                        06880040
                                                                        06890040
       PROCEDURE DIVISION.                                              06900040
      ***************************************************************** 06910040
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 06920040
      ** THE SETUP AND PERFORM OF PARAGRAPH 001-CALL-CICS-ARCH-API   ** 06930040
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 06940040
      **                                                             ** 06950040
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 06960040
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 06970040
      ***************************************************************** 06980040
       0000-MAIN-MODULE.                                                06990040
           INITIALIZE DP030-CICS-API-FIELDS.                            07000040
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07010040
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07020040
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07030040
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07040040
           MOVE LENGTH OF TF432AI        TO DP030-MAP-LENGTH (1).       07050040
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07060040
           PERFORM 0001-CALL-CICS-ARCH-API.                             07070040
      *                                                                 07080040
           PERFORM 1000-CONTROL-PROCESSING                              07090040
      *                                                                 07100040
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07110040
           PERFORM 0001-CALL-CICS-ARCH-API.                             07120040
                                                                        07130040
       0001-CALL-CICS-ARCH-API.                                         07140040
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07150056
                                          DFHCOMMAREA                   07160056
                                          DP030-CICS-API-FIELDS         07170056
                                          DP020-STANDARD-COMMAREA       07180056
                                          TF432AI.                      07190056
      *                                                                 07200040
           IF  DP030-RC-CALL-SUCCESSFUL                                 07210040
               CONTINUE                                                 07220040
           ELSE                                                         07230040
               SET DP013-NO-ROLLBACK                                    07240040
                   DP013-XCTL-DISPLAY-RESTART                           07250040
                   DP013-CICS-ABEND      TO TRUE                        07260040
               MOVE 'BEFORE 0000-MAIN-MODULE'                           07270040
                                         TO DP013-PARAGRAPH             07280040
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07281056
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07282056
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07310040
               PERFORM DP013-0000-PROCESS-ABEND                         07320040
           END-IF.                                                      07330040
       EJECT                                                            07340040
      *----------------------------------------------------------------*07350040
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07360040
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07370040
      *----------------------------------------------------------------*07380040
                                                                        07390040
       1000-CONTROL-PROCESSING.                                         07400040
                                                                        07410040
           EVALUATE TRUE                                                07420040
               WHEN DP020-NEXT-ACT-INITIAL                              07430040
                    SET PS-TRANSFER-NOT-FOUND         TO TRUE           07440040
                    PERFORM 1100-FIND-OBJECT-KEYS                       07450040
                    PERFORM 4000-BUILD-INITIAL-PANEL                    07460040
                    IF PS-TRANSFER-NOT-FOUND                            07470040
                        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           07480040
                        MOVE PC-TSYMSG-00148                            07490040
                                         TO DP020-MSG-NUMBER            07500040
                        SET DP020-MSG-WARNING TO TRUE                   07510040
051705*             ELSE                                                07520052
051705*                 IF PS-INVENTORY-ERROR                           07530052
051705*                    SET DP020-MSG-FATAL                          07540052
051705*                        DP020-NEXT-ACT-APPL-ERROR  TO TRUE       07550052
051705*                 END-IF                                          07560052
                    END-IF                                              07570040
                                                                        07580040
               WHEN DP020-NEXT-ACT-READ-MAP                             07590040
                   PERFORM 2000-PROCESS-PANEL                           07600040
                                                                        07610040
               WHEN DP020-NEXT-ACT-RETURN                               07620040
                   PERFORM 3200-RESET-ATTRIBUTES                        07630040
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07640040
                                                                        07650040
               WHEN OTHER                                               07660040
                   SET DP013-LOGIC-ABEND TO TRUE                        07670040
                   SET DP013-NO-ROLLBACK TO TRUE                        07680040
                   MOVE '1000-CONTROL-PROCESSING'                       07690040
                                         TO DP013-PARAGRAPH             07700040
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07710040
                                         TO DP013-MESSAGE-TEXT(1)       07720040
                   MOVE DP020-NEXT-APPL-ACTIVITY                        07730040
                                         TO DP013-MESSAGE-TEXT(2)       07740040
                   PERFORM DP013-0000-PROCESS-ABEND                     07750040
           END-EVALUATE.                                                07760040
      ******************************************************************07770040
      ** DETERMINE THE TRANSFER TO BE DISPLAYED BASED ON THE          **07780040
      ** INTER-APPLICATION AREA.                                      **07790040
      ******************************************************************07800040
       1100-FIND-OBJECT-KEYS.                                           07810040
           MOVE SPACES                TO ASC-SPECIFIC-COMMAREA.         07820040
           IF TF001-XFER-NBR > ZERO                                     07830040
               MOVE TF001-XFER-NBR    TO ASC-XFER-NBR                   07840040
           ELSE                                                         07850040
               MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER                 07860040
               SET DP020-MSG-FATAL                                      07870040
                   DP020-NEXT-ACT-APPL-ERROR                            07880040
                                         TO TRUE                        07890040
           END-IF.                                                      07900040
                                                                        07910040
      *----------------------------------------------------------------*07920040
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07930040
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07940040
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07950040
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07960040
      * FUNCTION KEYS CAN GET THIS FAR.                                *07970040
      *----------------------------------------------------------------*07980040
                                                                        07990040
       2000-PROCESS-PANEL.                                              08000040
                                                                        08010040
           EVALUATE TRUE                                                08020040
                                                                        08030040
               WHEN DP020-SRC-AID = DP016-CLEAR                         08040040
                   PERFORM 3200-RESET-ATTRIBUTES                        08050040
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08060040
                                                                        08070040
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08080040
                   MOVE ASC-XFER-SEQ-NBR       TO PV-SEQ-NBR            08090040
                   MOVE ASC-XFER-FROM-STORE    TO PV-FROM-STORE         08100040
                   MOVE SPACES                 TO ASC-SPECIFIC-COMMAREA 08110040
                   MOVE PV-SEQ-NBR             TO ASC-XFER-SEQ-NBR      08120040
                   MOVE PV-FROM-STORE          TO ASC-XFER-FROM-STORE   08130040
                   PERFORM 4000-BUILD-INITIAL-PANEL                     08140040
                                                                        08150040
               WHEN OTHER                                               08160040
                  PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                  08170040
                  PERFORM 3000-EDIT-DATA-IN-COMMAREA                    08180040
                  IF  PS-NO-ERROR                                       08190040
                      SET DP030-CONTINUE-GO   TO TRUE                   08200040
                      PERFORM 2100-CHECK-FUNCTION-KEY                   08210040
                  ELSE                                                  08220040
                      SET DP030-OVERRIDE-GO   TO TRUE                   08230040
                  END-IF                                                08240040
           END-EVALUATE.                                                08250040
      *----------------------------------------------------------------*08260040
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *08270040
      * FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *08280040
      * FROM THE CICS ARCHITECTURE API.                                *08290040
      *----------------------------------------------------------------*08300040
                                                                        08310040
       2100-CHECK-FUNCTION-KEY.                                         08320040
           EVALUATE TRUE                                                08330040
                                                                        08340040
      *---  VOID  --------------------------------------------------*   08350040
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08360040
                   PERFORM 5500-SELECT-CURR-XFER-STATUS                 08370040
                   IF TFSTAT-XFER-STAT-CDE NOT =                        08380040
                                             PC-COMPLETE-STATUS    AND  08390040
                      TFSTAT-XFER-STAT-CDE NOT =                        08400040
                                             PC-ASSUMPTIVE-STATUS       08410040
                      SET DP030-OVERRIDE-GO                             08420040
                          DP020-MSG-FATAL          TO TRUE              08430040
      *           -- CANNOT VOID TRANSFER WITH THIS STATUS --           08440040
                               MOVE TFSTCD-XFER-STAT-DESC               08450040
                                                   TO  DP020-MSG-TEXT   08460040
                               MOVE PC-TSYMSG-01402                     08470040
                                                   TO DP020-MSG-NUMBER  08480040
                   ELSE                                                 08490040
                       PERFORM 6000-VOID-TRANSFER                       08500040
                       MOVE ASC-XFER-FROM-STORE    TO PV-FROM-STORE     08510040
                       MOVE ASC-XFER-SEQ-NBR       TO PV-SEQ-NBR        08520040
                       MOVE PV-XFER-NBR            TO DP020-MSG-TEXT    08530040
      *    --- SUCCESSFULLY VOIDED TRANSFER &VAR ---                    08540040
                       MOVE PC-TSYMSG-01404        TO DP020-MSG-NUMBER  08550040
                       SET DP020-MSG-INFORMATIONAL TO TRUE              08560040
                   END-IF                                               08570040
                                                                        08580040
               WHEN DP020-SRC-AID = DP016-ENTER                         08590040
                   PERFORM 3200-RESET-ATTRIBUTES                        08600040
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08610040
                                                                        08620040
               WHEN OTHER                                               08630040
                   SET DP013-NO-ROLLBACK                                08640040
                       DP013-XCTL-DISPLAY-RESTART                       08650040
                       DP013-CICS-ABEND  TO TRUE                        08660040
                   MOVE '2100-CHECK-FUNCTION-KEY'                       08670040
                                         TO DP013-PARAGRAPH             08680040
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08690040
                                         TO DP013-MESSAGE-TEXT (1)      08700040
                   PERFORM DP013-0000-PROCESS-ABEND                     08710040
           END-EVALUATE.                                                08720040
                                                                        08730040
       EJECT                                                            08740040
      ******************************************************************08750040
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **08760040
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **08770040
      ******************************************************************08780040
       2200-MOVE-SCREEN-TO-COMMAREA.                                    08790040
                                                                        08800040
           PERFORM 2210-MOVE-LINES-TO-COMMAREA                          08810040
               VARYING PV-SUB                                           08820040
               FROM 1 BY 1                                              08830040
               UNTIL PV-SUB > 4.                                        08840040
      ******************************************************************08850040
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**08860040
      ******************************************************************08870040
       2210-MOVE-LINES-TO-COMMAREA.                                     08880040
           IF  MR-COMMENT-L (PV-SUB) > ZERO                             08890040
               MOVE MR-COMMENT (PV-SUB)                                 08900040
                                         TO ASC-COMMENT (PV-SUB)        08910040
           ELSE                                                         08920040
               IF  MR-COMMENT-A (PV-SUB) = DP015-ERASE-EOF              08930040
                       MOVE SPACE        TO ASC-COMMENT (PV-SUB)        08940040
               END-IF                                                   08950040
           END-IF.                                                      08960040
                                                                        08970040
      ******************************************************************08980040
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **08990040
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **09000040
      ******************************************************************09010040
       3000-EDIT-DATA-IN-COMMAREA.                                      09020040
           SET PS-NO-ERROR                 TO TRUE.                     09030040
           PERFORM 3200-RESET-ATTRIBUTES.                               09040040
           IF ASC-COMMENT-ARRAY NOT > SPACES                            09050040
               MOVE -1                     TO MR-COMMENT-L (1)          09060040
               MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          09070040
               SET DP020-MSG-FATAL                                      09080040
                   PS-ERROR                                             09090040
                   DP030-SET-CURSOR-APPL-1 TO TRUE                      09100040
           END-IF.                                                      09110040
       EJECT                                                            09120040
      *----------------------------------------------------------------*09130040
      *    RESET ATTRIBUTES.                                           *09140040
      *----------------------------------------------------------------*09150040
                                                                        09160040
       3200-RESET-ATTRIBUTES.                                           09170040
                                                                        09180040
           PERFORM                                                      09190040
               VARYING PV-SUB                                           09200040
               FROM 1 BY 1                                              09210040
               UNTIL PV-SUB > 4                                         09220040
               MOVE DP015-UNP-ALP-NOR-OFF                               09230040
                                         TO MR-COMMENT-A (PV-SUB)       09240040
               MOVE DP015-GREEN          TO MR-COMMENT-C (PV-SUB)       09250040
               MOVE DP015-UNDERLINE      TO MR-COMMENT-H (PV-SUB)       09260040
           END-PERFORM.                                                 09270040
           MOVE -1                       TO MR-COMMENT-L (1).           09280040
           SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       09290040
                                                                        09300040
       EJECT                                                            09310040
      *                                                                 09320040
      *----------------------------------------------------------------*09330040
      *    READ THE TABLES FOR THE TRANSFER NUMBER TO BE DISPLAYED.    *09340040
      *----------------------------------------------------------------*09350040
                                                                        09360040
       4000-BUILD-INITIAL-PANEL.                                        09370040
           SET DP030-SET-CURSOR-TRAILER  TO TRUE                        09380040
           MOVE ASC-XFER-SEQ-NBR         TO DK-XFER-SEQ-NBR.            09390040
           MOVE ASC-XFER-FROM-STORE      TO DK-FROM-STORE.              09400040
           PERFORM 4100-GET-TRANSFER.                                   09410040
           IF PS-TRANSFER-FOUND                                         09420040
051705*        SET PS-NO-INVENTORY-ERROR  TO TRUE                       09430052
051705*        IF ASC-XFER-TYPE NOT = PC-XFER-NON-RETAIL  AND           09440052
051705*           ASC-XFER-TYPE NOT = PC-XFER-OFFSITE-STORAGE           09450052
051705*            PERFORM 4300-CHECK-INVENTORY-CUTOFF                  09460052
051705*        END-IF                                                   09470052
051705*        IF PS-NO-INVENTORY-ERROR                                 09480052
                   PERFORM 3200-RESET-ATTRIBUTES                        09490040
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09500040
051705*        END-IF                                                   09510052
051705     END-IF.                                                      09520053
                                                                        09530040
      *----------------------------------------------------------------*09540040
      * SELECT DATA FROM THE TRANSFER TABLES                            09550040
      *----------------------------------------------------------------*09560040
       4100-GET-TRANSFER.                                               09570040
           PERFORM                                                      09580040
               WITH TEST AFTER                                          09590040
               VARYING PV-RETRY-COUNT                                   09600040
               FROM 1 BY 1                                              09610040
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 09620040
                         OR (SQLCODE = ZERO)                            09630040
                         OR (SQLCODE = +100))                           09640040
      *                                                                 09650040
               EXEC SQL                                                 09660040
                   SELECT X.XFER_DKEY_ID                                09670040
                         ,X.ENTR_MTHD_TYP_CDE                           09680040
                         ,X.XFER_TYP_CDE                                09690040
                         ,X.CONTNR_TYP_CDE                              09700040
                         ,X.FR_STR_NBR                                  09710040
                         ,X.TO_STR_NBR                                  09720040
                         ,X.CMPT_XFER_END_TMST                          09730040
                         ,X.CPLD_INIT_1ST_NM                            09740040
                         ,X.CPLD_LAST_NM                                09750040
                         ,X.LG_TTE_1ST_SEAL_ID                          09760040
                         ,X.LG_TTE_2ND_SEAL_ID                          09770040
                         ,X.SM_TTE_BAG_SEAL_ID                          09780040
                         ,X.TRLR_NBR                                    09790040
                         ,X.TRLR_SEAL_ID                                09800040
                         ,X.CLBK_NBR                                    09810040
                         ,X.STK_BAL_APVL_NBR                            09820040
                         ,X.RQSTR_INIT_1ST_NM                           09830040
                         ,X.RQSTR_LAST_NM                               09840040
                         ,X.ATTN_INIT_1ST_NM                            09850040
                         ,X.ATTN_LAST_NM                                09860040
                         ,CT.CONTNR_TYP_DESC                            09870040
                         ,XT.TYP_1ST_LNE_DESC                           09880040
                         ,XT.TYP_2ND_LNE_DESC                           09890040
                         ,S.XFER_STAT_CDE                               09900040
                         ,SC.XFER_STAT_DESC                             09910040
                   INTO   :TFMSTR-XFER-DKEY-ID                          09920040
                         ,:TFMSTR-ENTR-MTHD-TYP-CDE                     09930040
                         ,:TFMSTR-XFER-TYP-CDE                          09940040
                         ,:TFMSTR-CONTNR-TYP-CDE                        09950040
                         ,:TFMSTR-FR-STR-NBR                            09960040
                         ,:TFMSTR-TO-STR-NBR                            09970040
                         ,:TFMSTR-CMPT-XFER-END-TMST                    09980040
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      09990040
                         ,:TFMSTR-CPLD-LAST-NM                          10000040
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    10010040
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    10020040
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    10030040
                         ,:TFMSTR-TRLR-NBR                              10040040
                         ,:TFMSTR-TRLR-SEAL-ID                          10050040
                         ,:TFMSTR-CLBK-NBR                              10060040
                         ,:TFMSTR-STK-BAL-APVL-NBR                      10070040
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     10080040
                         ,:TFMSTR-RQSTR-LAST-NM                         10090040
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      10100040
                         ,:TFMSTR-ATTN-LAST-NM                          10110040
                         ,:TFSHCT-CONTNR-TYP-DESC                       10120040
                         ,:TFTYCD-TYP-1ST-LNE-DESC                      10130040
                         ,:TFTYCD-TYP-2ND-LNE-DESC                      10140040
                         ,:TFSTAT-XFER-STAT-CDE                         10150040
                         ,:TFSTCD-XFER-STAT-DESC                        10160040
                   FROM   TTFMSTR X                                     10170040
                         ,TTFSHCT CT                                    10180040
                         ,TTFTYCD XT                                    10190040
                         ,TTFSTAT S                                     10200040
                         ,TTFSTCD SC                                    10210040
                   WHERE  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND   10220040
                          X.FR_STR_NBR     = :DK-FROM-STORE       AND   10230040
                          S.XFER_DKEY_ID   = X.XFER_DKEY_ID       AND   10240040
                          X.CONTNR_TYP_CDE = CT.CONTNR_TYP_CDE    AND   10250040
                          X.XFER_TYP_CDE   = XT.XFER_TYP_CDE      AND   10260040
                          S.XFER_STAT_CDE  = SC.XFER_STAT_CDE     AND   10270040
                          S.XFER_STAT_TMST =                            10280040
                  (SELECT                                               10290040
                   MAX(S.XFER_STAT_TMST)                                10300040
                   FROM TTFSTAT S                                       10310040
                       ,TTFMSTR X                                       10320040
                   WHERE  X.XFER_SEQ_NBR   = :DK-XFER-SEQ-NBR     AND   10330040
                          X.FR_STR_NBR     = :DK-FROM-STORE       AND   10340040
                          S.XFER_DKEY_ID   = X.XFER_DKEY_ID       AND   10350040
                          S.XFER_STAT_CDE  IN ('PR', 'AR', 'CM', 'VD')) 10360040
               END-EXEC                                                 10370040
                                                                        10380040
               EVALUATE TRUE                                            10390040
                   WHEN SQLCODE = ZERO                                  10400040
                      SET PS-TRANSFER-FOUND     TO TRUE                 10410040
                      MOVE TFMSTR-XFER-DKEY-ID  TO ASC-XFER-DKEY-ID     10420040
                      MOVE TFMSTR-ENTR-MTHD-TYP-CDE                     10430040
                                                TO ASC-ENTRY-METHOD     10440040
                      MOVE TFMSTR-XFER-TYP-CDE  TO ASC-XFER-TYPE        10450040
                      MOVE TFMSTR-CONTNR-TYP-CDE TO ASC-CONTAINER-TYPE  10460040
                      MOVE TFMSTR-FR-STR-NBR    TO ASC-FROM-STORE-NBR   10470040
                      MOVE TFMSTR-TO-STR-NBR    TO ASC-TO-STORE-NBR     10480040
                      MOVE TFMSTR-CMPT-XFER-END-TMST                    10490040
                                                TO ASC-COMPLETION-DATE  10500040
                      MOVE SPACES               TO ASC-COMPLETED-BY     10510040
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      10520040
                                                TO ASC-COMPLETED-INIT   10530040
                      MOVE TFMSTR-CPLD-LAST-NM  TO ASC-COMPLETED-NAME   10540040
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    10550040
                                                TO ASC-LARGE-TOTE-SEAL1 10560040
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    10570040
                                                TO ASC-LARGE-TOTE-SEAL2 10580040
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    10590040
                                                TO ASC-SMALL-TOTE-SEAL  10600040
                      MOVE TFMSTR-TRLR-NBR      TO ASC-TRAILER-NBR      10610040
                      MOVE TFMSTR-TRLR-SEAL-ID  TO ASC-TRAILER-SEAL     10620040
                      MOVE TFMSTR-CLBK-NBR      TO ASC-CALLBACK-NBR     10630040
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      10640040
                                                TO ASC-APPROVAL-NBR     10650040
                      MOVE SPACES               TO ASC-REQUESTOR        10660040
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     10670040
                                                TO ASC-REQUESTOR-INIT   10680040
                      MOVE TFMSTR-RQSTR-LAST-NM TO ASC-REQUESTOR-NAME   10690040
                      MOVE SPACES               TO ASC-ATTENTION        10700040
                      MOVE TFMSTR-ATTN-INIT-1ST-NM                      10710040
                                                TO ASC-ATTENTION-INIT   10720040
                      MOVE TFMSTR-ATTN-LAST-NM  TO ASC-ATTENTION-NAME   10730040
                      MOVE TFSHCT-CONTNR-TYP-DESC                       10740040
                                                TO ASC-CONTAINER-DESC   10750040
                      IF TFTYCD-TYP-2ND-LNE-DESC = SPACES               10760040
                          MOVE TFTYCD-TYP-1ST-LNE-DESC                  10770040
                                         TO ASC-XFER-DESC               10780040
                      ELSE                                              10790040
                          STRING                                        10800040
                              TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 10810040
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 10820040
                                         INTO ASC-XFER-DESC             10830040
                      END-IF                                            10840040
                      MOVE TFSTAT-XFER-STAT-CDE                         10850040
                                                TO ASC-XFER-STATUS      10860040
                      MOVE TFSTCD-XFER-STAT-DESC                        10870040
                                                TO ASC-XFER-STATUS-DESC 10880040
                      PERFORM 5000-GET-STORE-NAMES                      10890040
                      PERFORM 5300-READ-TRANSFER-ITEM                   10900040
                      IF ASC-XFER-TYPE = PC-XFER-CUSTOMER               10910040
                          PERFORM 5400-READ-CUSTOMER                    10920040
                      END-IF                                            10930040
                   WHEN SQLCODE = +100                                  10940040
                   WHEN SQLCODE = -904                                  10950040
                   WHEN SQLCODE = -913                                  10960040
                       CONTINUE                                         10970040
                   WHEN OTHER                                           10980048
                       MOVE '4100-GET-TRANSFER'                         11010040
                                         TO DP013-PARAGRAPH             11020040
                       MOVE 'SELECT TRANSFER DATA'                      11030040
                                         TO DP013-MESSAGE-TEXT (1)      11040040
                       MOVE SQLCA        TO DP013-SQLCA                 11050040
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    11060040
                       MOVE 'TTFSHCT'    TO DP013-DB2-TABLE-NAME (2)    11070040
                       MOVE 'TTFTYCD'    TO DP013-DB2-TABLE-NAME (3)    11080040
                       SET DP013-DB2-ABEND                              11090040
                           DP013-XCTL-DISPLAY-RESTART                   11100040
                                         TO TRUE                        11110040
                       PERFORM DP013-0000-PROCESS-ABEND                 11120040
               END-EVALUATE                                             11130040
           END-PERFORM.                                                 11140040
      *                                                                 11150040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          11160040
               MOVE '4100-GET-TRANSFER'                                 11170040
                                         TO DP013-PARAGRAPH             11180040
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11190040
                                         TO DP013-MESSAGE-TEXT (1)      11200040
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      11210040
               MOVE SQLCA                TO DP013-SQLCA                 11220040
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    11230040
               MOVE 'TTFSHCT'            TO DP013-DB2-TABLE-NAME (2)    11240040
               MOVE 'TTFTYCD'            TO DP013-DB2-TABLE-NAME (3)    11250040
               SET DP013-DB2-ABEND                                      11260040
                   DP013-XCTL-DISPLAY-RESTART                           11270040
                                         TO TRUE                        11280040
               PERFORM DP013-0000-PROCESS-ABEND                         11290040
           END-IF.                                                      11300040
       EJECT                                                            11310040
051705*----------------------------------------------------------------*11320052
051705*  CHECK IF PHYSICAL INVENTORY IS ACTIVE.                         11330052
051705*----------------------------------------------------------------*11340052
051705*4300-CHECK-INVENTORY-CUTOFF.                                     11350052
051705*    EXEC SQL                                                     11360052
051705*        SET  :PV-CURRENT-DATE       =  CURRENT DATE              11370052
051705*    END-EXEC.                                                    11380052
051705*                                                                 11390052
051705*    EVALUATE TRUE                                                11400052
051705*        WHEN SQLWARN0 NOT = SPACES                               11410052
051705*        WHEN SQLCODE < ZERO                                      11420052
051705*        WHEN SQLCODE > ZERO                                      11430052
051705*            MOVE '4300-CHECK-INVENTORY-CUTOFF'                   11440052
051705*                                      TO DP013-PARAGRAPH         11450052
051705*            MOVE 'SELECT THE CURRENT DATE'                       11460052
051705*                                      TO DP013-MESSAGE-TEXT (1)  11470052
051705*            MOVE SQLCA                TO DP013-SQLCA             11480052
051705*            SET DP013-DB2-ABEND                                  11490052
051705*                DP013-NO-ROLLBACK     TO TRUE                    11500052
051705*            PERFORM DP013-0000-PROCESS-ABEND                     11510052
051705*    END-EVALUATE.                                                11520052
051705*    MOVE ASC-FROM-STORE-NBR        TO DK-STORE-NBR-9.            11530052
051705*    PERFORM 7800-GET-STORE-XFER-CTOFF-DTE.                       11540052
051705*    MOVE INVPAR-XFER-INV-CTOFF-DTE  TO PV-LY-INV-CTOFF-DTE       11550052
051705*    MOVE ASC-TO-STORE-NBR          TO DK-STORE-NBR-9.            11560052
051705*    PERFORM 7800-GET-STORE-XFER-CTOFF-DTE.                       11570052
051705*    IF INVPAR-XFER-INV-CTOFF-DTE > PV-LY-INV-CTOFF-DTE           11580052
051705*        MOVE INVPAR-XFER-INV-CTOFF-DTE                           11590052
051705*                                   TO PV-LY-INV-CTOFF-DTE        11600052
051705*    END-IF.                                                      11610052
051705*    IF ASC-CMPLT-DATE <= PV-LY-INV-CTOFF-DTE                     11620052
051705*        SET PS-INVENTORY-ERROR         TO TRUE                   11630052
051705* -- CANNOT PROCESS BEFORE INVENTORY TRANSFER - CALL INV CONTROL  11640052
051705*        MOVE PC-TSYMSG-01615   TO DP020-MSG-NUMBER               11650052
051705*    ELSE                                                         11660052
051705*        PERFORM 7500-READ-CONTROL-TABLE                          11670052
051705*        IF PV-PHY-INV-PERD-IND = PC-YES                          11680052
051705*            MOVE ASC-FROM-STORE-NBR    TO DK-STORE-NBR-9         11690052
051705*            PERFORM 7600-GET-STR-PLND-INV-DTE                    11700052
051705*            MOVE INVPAR-PLND-INV-DTE   TO PV-FR-STR-INV-DTE      11710052
051705*            MOVE PV-HOLD-INVENTORY-IND TO PV-FR-INVENTORY-IND    11720052
051705*   IF THE FROM STORE IS NOT TAKING INVENTORY, CHECK THE TO STORE.11730052
051705*   IF THE TO STORE IS TAKING INVENTORY, USE THE TO STORE DATE FOR11740052
051705*   THE COMPARISON                                                11750052
051705*   IF NEITHER STORE IS TAKING INVENTORY, BYPASS THE CHECK        11760052
051705*            IF PV-FR-NO-INVENTORY                                11770052
051705*                MOVE ASC-TO-STORE-NBR  TO DK-STORE-NBR-9         11780052
051705*                PERFORM 7600-GET-STR-PLND-INV-DTE                11790052
051705*                MOVE INVPAR-PLND-INV-DTE  TO PV-TO-STR-INV-DTE   11800052
051705*                MOVE PV-HOLD-INVENTORY-IND                       11810052
051705*                                          TO PV-TO-INVENTORY-IND 11820052
051705*                IF PV-TO-NO-INVENTORY                            11830052
051705*                    CONTINUE                                     11840052
051705*                ELSE                                             11850052
051705*                    MOVE PV-TO-STR-INV-DTE                       11860052
051705*                                     TO PV-FR-STR-INV-DTE        11870052
051705*                    IF ASC-CONTAINER-TYPE = PC-HAND-CARRY        11880052
051705*                        MOVE PV-FR-STR-INV-DTE                   11890052
051705*                                             TO PV-COMPARE-DATE  11900052
051705*                    ELSE                                         11910052
051705*                        MOVE PV-XFER-INV-CTOFF-DTE               11920052
051705*                                             TO PV-COMPARE-DATE  11930052
051705*                    END-IF                                       11940052
051705*                    PERFORM 4310-INVENTORY-LOGIC                 11950052
051705*                END-IF                                           11960052
051705*            END-IF                                               11970052
051705*        END-IF                                                   11980052
051705*    END-IF.                                                      11990052
051705*----------------------------------------------------------------*12000052
051705* PERFORM PHYSICAL INVENTORY LOGIC                               *12010052
051705*----------------------------------------------------------------*12020052
051705*4310-INVENTORY-LOGIC.                                            12030052
051705*    IF ASC-CMPLT-DATE <= PV-COMPARE-DATE                         12040052
051705*        IF PV-CURRENT-DATE > PV-MAX-FINCL-BK-DTE                 12050052
051705*            SET PS-INVENTORY-ERROR         TO TRUE               12060052
051705* -- CANNOT PROCESS BEFORE INVENTORY TRANSFER - CALL INV CONTROL  12070052
051705*            MOVE PC-TSYMSG-01615   TO DP020-MSG-NUMBER           12080052
051705*        END-IF                                                   12090052
051705*    END-IF.                                                      12100052
051705*EJECT                                                            12110052
      *----------------------------------------------------------------*12120040
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12130040
      *----------------------------------------------------------------*12140040
                                                                        12150040
       4400-MOVE-COMMAREA-TO-SCREEN.                                    12160040
           MOVE ASC-XFER-STATUS-DESC     TO MR-STATUS.                  12170040
           MOVE ASC-XFER-TYPE            TO MR-XFER-TYPE.               12180040
           MOVE ASC-XFER-SEQ-NBR         TO MR-XFER-SEQ-NBR.            12190040
           MOVE '-'                      TO MR-XFER-NBR-DASH.           12200040
           MOVE ASC-XFER-FROM-STORE      TO MR-XFER-FROM-STORE.         12210040
           MOVE ASC-XFER-DESC            TO MR-XFER-DESC.               12220040
           MOVE ASC-CONTAINER-TYPE       TO MR-CONTAINER-TYPE.          12230040
           MOVE ASC-CONTAINER-DESC       TO MR-CONTAINER-DESC.          12240040
           MOVE ASC-FROM-STORE-NBR       TO MR-FROM-NBR.                12250040
           MOVE ASC-FROM-STORE-NAME      TO MR-FROM-NAME.               12260040
           IF   ASC-ENTRY-SCANNED                                       12270040
              MOVE 'Y'                   TO MR-FROM-SCAN                12280040
           ELSE                                                         12290040
              MOVE 'N'                   TO MR-FROM-SCAN                12300040
           END-IF                                                       12310040
           MOVE ASC-COMPLETED-BY         TO MR-COMP-BY.                 12320040
           MOVE ASC-COMPLETED-QTY        TO MR-COMP-QTY.                12330040
           MOVE ASC-TO-STORE-NBR         TO MR-TO-NBR.                  12340040
           MOVE ASC-TO-STORE-NAME        TO MR-TO-NAME.                 12350040
           MOVE ASC-COMP-YEAR            TO PV-YEAR.                    12360040
           MOVE ASC-COMP-MONTH           TO PV-MONTH.                   12370040
           MOVE ASC-COMP-DAY             TO PV-DAY.                     12380040
           MOVE PV-DATE                  TO MR-COMP-DATE.               12390040
           MOVE DP020-USERID             TO MR-USERID.                  12400040
           PERFORM                                                      12410040
               VARYING PV-SUB                                           12420040
               FROM 1 BY 1                                              12430040
               UNTIL PV-SUB > 4                                         12440040
               MOVE ASC-COMMENT (PV-SUB) TO MR-COMMENT (PV-SUB)         12450040
           END-PERFORM.                                                 12460040
           EVALUATE ASC-XFER-TYPE                                       12470040
111703*        WHEN PC-XFER-DEFECTIVE                                   12480041
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           12481044
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           12482044
               WHEN PC-XFER-BALANCE-STORE                               12490040
                   MOVE DP015-ASK-DRK-OFF                               12500040
                                         TO MR-LIN5-LITERAL-ATTRIB      12510040
                                            MR-LIN5-FIELD-ATTRIB        12520040
                                            MR-LIN8-LITERAL-ATTRIB      12530040
                                            MR-LIN8-FIELD-ATTRIB        12540040
                                            MR-PHONE-LITERAL-ATTRIB     12550040
                                            MR-PHONE-ATTRIB             12560040
                                            MR-ADDR-LITERAL-ATTRIB      12570040
                                            MR-ADDR-ATTRIB              12580040
                                            MR-CITY-LITERAL-ATTRIB      12590040
                                            MR-CITY-ATTRIB              12600040
                                            MR-STATE-LITERAL-ATTRIB     12610040
                                            MR-STATE-ZIP-ATTRIB         12620040
                   MOVE ASC-COMPLETED-RETAIL                            12630040
                                         TO MR-COMP-RETAIL              12640040
               WHEN PC-XFER-CALLBACK                                    12650040
                   MOVE PC-CALLBACK-LITERAL                             12660040
                                         TO MR-LIN5-LITERAL             12670040
                   MOVE ASC-CALLBACK-NBR TO MR-LIN5-FIELD               12680040
                   MOVE DP015-ASK-DRK-OFF                               12690040
                                         TO MR-LIN8-LITERAL-ATTRIB      12700040
                                            MR-LIN8-FIELD-ATTRIB        12710040
                                            MR-PHONE-LITERAL-ATTRIB     12720040
                                            MR-PHONE-ATTRIB             12730040
                                            MR-ADDR-LITERAL-ATTRIB      12740040
                                            MR-ADDR-ATTRIB              12750040
                                            MR-CITY-LITERAL-ATTRIB      12760040
                                            MR-CITY-ATTRIB              12770040
                                            MR-STATE-LITERAL-ATTRIB     12780040
                                            MR-STATE-ZIP-ATTRIB         12790040
                   MOVE ASC-COMPLETED-RETAIL                            12800040
                                         TO MR-COMP-RETAIL              12810040
               WHEN PC-XFER-BALANCE-CORP                                12820040
                   MOVE PC-APPROVAL-LITERAL                             12830040
                                         TO MR-LIN5-LITERAL             12840040
                   MOVE ASC-APPROVAL-NBR TO MR-LIN5-FIELD               12850040
                   MOVE DP015-ASK-DRK-OFF                               12860040
                                         TO MR-LIN8-LITERAL-ATTRIB      12870040
                                            MR-LIN8-FIELD-ATTRIB        12880040
                                            MR-PHONE-LITERAL-ATTRIB     12890040
                                            MR-PHONE-ATTRIB             12900040
                                            MR-ADDR-LITERAL-ATTRIB      12910040
                                            MR-ADDR-ATTRIB              12920040
                                            MR-CITY-LITERAL-ATTRIB      12930040
                                            MR-CITY-ATTRIB              12940040
                                            MR-STATE-LITERAL-ATTRIB     12950040
                                            MR-STATE-ZIP-ATTRIB         12960040
                   MOVE ASC-COMPLETED-RETAIL                            12970040
                                         TO MR-COMP-RETAIL              12980040
               WHEN PC-XFER-NON-RETAIL                                  12990040
                   MOVE PC-REQUESTED-BY-LITERAL                         13000040
                                         TO MR-LIN5-LITERAL             13010040
                   MOVE ASC-REQUESTOR    TO MR-LIN5-FIELD               13020040
                   MOVE PC-ATTENTION-LITERAL                            13030040
                                         TO MR-LIN8-LITERAL             13040040
                   MOVE ASC-ATTENTION    TO MR-LIN8-FIELD               13050040
                   MOVE DP015-ASK-DRK-OFF                               13060040
                                         TO MR-PHONE-LITERAL-ATTRIB     13070040
                                            MR-PHONE-ATTRIB             13080040
                                            MR-ADDR-LITERAL-ATTRIB      13090040
                                            MR-ADDR-ATTRIB              13100040
                                            MR-CITY-LITERAL-ATTRIB      13110040
                                            MR-CITY-ATTRIB              13120040
                                            MR-STATE-LITERAL-ATTRIB     13130040
                                            MR-STATE-ZIP-ATTRIB         13140040
               WHEN PC-XFER-CUSTOMER                                    13150040
                   MOVE PC-REQUESTED-BY-LITERAL                         13160040
                                         TO MR-LIN5-LITERAL             13170040
                   MOVE ASC-REQUESTOR    TO MR-LIN5-FIELD               13180040
                   MOVE PC-CUSTOMER-LITERAL                             13190040
                                         TO MR-LIN8-LITERAL             13200040
                   MOVE ASC-CUST-NAME    TO MR-LIN8-FIELD               13210040
                   IF ASC-CUST-PHONE > ZERO                             13220040
                       MOVE ASC-CUST-PHONE   TO PV-PHONE                13230040
                       MOVE '('              TO PV-PHONE-LIT1           13240040
                       MOVE ')-'             TO PV-PHONE-LIT2           13250040
                       MOVE '-'              TO PV-PHONE-LIT3           13260040
                       MOVE PV-PHONE     TO MR-PHONE                    13270040
                   END-IF                                               13280040
                   MOVE ASC-CUST-ADDRESS TO MR-ADDR                     13290040
                   MOVE ASC-CUST-CITY    TO MR-CITY                     13300040
                   MOVE ASC-CUST-STATE   TO PV-STATE                    13310040
                   IF ASC-CUST-ZIP > 0                                  13320040
                       MOVE ASC-CUST-ZIP TO PV-ZIP                      13330040
                       IF ASC-CUST-ZIP-EXT > 0                          13340040
                           MOVE ASC-CUST-ZIP-EXT TO PV-ZIP-EXT          13350040
                           MOVE '-'              TO PV-ZIP-DASH         13360040
                       ELSE                                             13370040
                           MOVE SPACES TO PV-ZIP-EXTENSION              13380040
                       END-IF                                           13390040
                   END-IF                                               13400040
                   MOVE PV-STATE-ZIP     TO MR-STATE-ZIP                13410040
                   MOVE ASC-COMPLETED-RETAIL                            13420040
                                         TO MR-COMP-RETAIL              13430040
           END-EVALUATE.                                                13440040
           EVALUATE ASC-CONTAINER-TYPE                                  13450040
               WHEN PC-TRAILER-CONTAINER                                13460040
                   MOVE PC-TRAILER-SEAL-LITERAL                         13470040
                                         TO MR-LIN7-LITERAL1            13480040
                   MOVE PC-TRAILER-NBR-LITERAL                          13490040
                                         TO MR-LIN7-LITERAL2            13500040
                   MOVE ASC-TRAILER-SEAL TO MR-LIN7-FIELD1              13510040
                   MOVE ASC-TRAILER-NBR  TO MR-LIN7-FIELD2              13520040
               WHEN OTHER                                               13530040
                   MOVE PC-LARGE-TOTE-LITERAL                           13540040
                                         TO MR-LIN7-LITERAL1            13550040
                   MOVE PC-SMALL-TOTE-LITERAL                           13560040
                                         TO MR-LIN7-LITERAL2            13570040
                   MOVE ASC-LARGE-TOTE-SEAL1                            13580040
                                         TO MR-LIN7-SEAL1               13590040
                   MOVE ASC-LARGE-TOTE-SEAL2                            13600040
                                         TO MR-LIN7-SEAL2               13610040
                   MOVE ASC-SMALL-TOTE-SEAL                             13620040
                                         TO MR-LIN7-FIELD2              13630040
           END-EVALUATE.                                                13640040
                                                                        13650040
       EJECT                                                            13660040
       5000-GET-STORE-NAMES.                                            13670040
           MOVE ASC-FROM-STORE-NBR       TO DK-STORE-NBR.               13680040
           PERFORM 5100-READ-XST-LOC.                                   13690048
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-FROM-STORE-NAME.        13700048
           MOVE ASC-TO-STORE-NBR         TO DK-STORE-NBR.               13710040
           PERFORM 5100-READ-XST-LOC.                                   13720048
100404     MOVE XST00001-LOC-10-ABBR-NM  TO ASC-TO-STORE-NAME.          13730048
       EJECT                                                            13740040
      *----------------------------------------------------------------*13750040
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *13760040
      *----------------------------------------------------------------*13770040
100404 5100-READ-XST-LOC.                                               13780048
           PERFORM WITH TEST AFTER                                      13790040
               VARYING PV-RETRY-COUNT                                   13800040
               FROM 1 BY 1                                              13810040
               UNTIL (PV-RETRY-COUNT > PC-MAX-RETRIES)                  13820040
                    OR SQLCODE = ZERO                                   13830040
                    OR SQLCODE = +100                                   13840040
               EXEC SQL                                                 13850040
100404             SELECT LOC_10_ABBR_NM                                13851048
100404                 INTO :XST00001-LOC-10-ABBR-NM                    13852048
100404                 FROM XST_LOC                                     13853048
100404                 WHERE (LOC_NBR  = :DK-STORE-NBR)                 13854048
               END-EXEC                                                 13900040
               EVALUATE TRUE                                            13910040
                   WHEN SQLCODE = ZERO                                  13920040
                   WHEN SQLCODE = -904                                  13930040
                   WHEN SQLCODE = -913                                  13940040
                       CONTINUE                                         13950040
                   WHEN SQLCODE = +100                                  13960040
100404                 MOVE 'INVALID'     TO XST00001-LOC-10-ABBR-NM    13970048
                   WHEN OTHER                                           13980048
100404                 MOVE '5100-READ-XST-LOC'                         14010048
                                         TO DP013-PARAGRAPH             14020040
100404                 MOVE 'SELECT A ROW FROM XST_LOC'                 14030048
                                         TO DP013-MESSAGE-TEXT (1)      14040040
                       MOVE SQLCA        TO DP013-SQLCA                 14050040
100404                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)    14060048
                       SET DP013-DB2-ABEND                              14070040
                           DP013-XCTL-DISPLAY-RESTART                   14080040
                                         TO TRUE                        14090040
                       PERFORM DP013-0000-PROCESS-ABEND                 14100040
               END-EVALUATE                                             14110040
           END-PERFORM.                                                 14120040
      *                                                                 14130040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          14140040
100404         MOVE '5100-READ-XST-LOC'                                 14150048
                                         TO DP013-PARAGRAPH             14160040
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14170040
                                         TO DP013-MESSAGE-TEXT (1)      14180040
100404         MOVE 'A ROW FROM XST_LOC' TO DP013-MESSAGE-TEXT (2)      14190048
               MOVE SQLCA                TO DP013-SQLCA                 14200040
100404         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)    14210048
               SET DP013-DB2-ABEND                                      14220040
                   DP013-XCTL-DISPLAY-RESTART                           14230040
                                         TO TRUE                        14240040
               PERFORM DP013-0000-PROCESS-ABEND                         14250040
           END-IF.                                                      14260040
       EJECT                                                            14270040
      *----------------------------------------------------------------*14280040
      *  GET THE TOTAL XFER QTY & PRICE.                               *14290040
      *----------------------------------------------------------------*14300040
       5300-READ-TRANSFER-ITEM.                                         14310040
           PERFORM WITH TEST AFTER                                      14320040
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       14330040
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  14340040
                    OR SQLCODE = ZERO                                   14350040
                    OR SQLCODE = +100                                   14360040
               EXEC SQL                                                 14370040
                   SELECT SUM(XFER_PRIC_AMT * XFER_QTY)                 14380040
                         ,SUM(XFER_QTY)                                 14390040
                       INTO :PV-XFER-PRICE                              14400040
                            :PV-XFER-PRICE-IND                          14410040
                           ,:PV-XFER-QTY                                14420040
                            :PV-XFER-QTY-IND                            14430040
                       FROM TTFITEM                                     14440040
                       WHERE XFER_DKEY_ID  = :ASC-XFER-DKEY-ID          14450040
               END-EXEC                                                 14460040
               EVALUATE TRUE                                            14470040
                   WHEN SQLCODE = ZERO                                  14480040
                   WHEN SQLCODE = +100                                  14490040
                   WHEN SQLCODE = -904                                  14500040
                   WHEN SQLCODE = -913                                  14510040
                       CONTINUE                                         14520040
                   WHEN OTHER                                           14530048
                       MOVE '5300-READ-TRANSFER-ITEM'                   14560040
                                         TO DP013-PARAGRAPH             14570040
                       MOVE 'SUMMARIZE DATA FROM TTFITEM'               14580040
                                         TO DP013-MESSAGE-TEXT (1)      14590040
                       MOVE SQLCA        TO DP013-SQLCA                 14600040
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)    14610040
                       SET DP013-DB2-ABEND                              14620040
                           DP013-XCTL-DISPLAY-RESTART                   14630040
                                         TO TRUE                        14640040
                       PERFORM DP013-0000-PROCESS-ABEND                 14650040
               END-EVALUATE                                             14660040
           END-PERFORM.                                                 14670040
      *                                                                 14680040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          14690040
               MOVE '5300-READ-TRANSFER-ITEM'                           14700040
                                         TO DP013-PARAGRAPH             14710040
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14720040
                                         TO DP013-MESSAGE-TEXT (1)      14730040
               MOVE 'DATA FROM TTFITEM'  TO DP013-MESSAGE-TEXT (2)      14740040
               MOVE SQLCA                TO DP013-SQLCA                 14750040
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (1)    14760040
               SET DP013-DB2-ABEND                                      14770040
                   DP013-XCTL-DISPLAY-RESTART                           14780040
                                         TO TRUE                        14790040
               PERFORM DP013-0000-PROCESS-ABEND                         14800040
           END-IF.                                                      14810040
           IF SQLCODE = +100                                            14820040
               MOVE ZEROES                TO ASC-COMPLETED-RETAIL       14830040
                                             ASC-COMPLETED-QTY          14840040
           ELSE                                                         14850040
                   MOVE PV-XFER-PRICE                                   14860040
                                          TO ASC-COMPLETED-RETAIL       14870040
                   MOVE PV-XFER-QTY                                     14880040
                                          TO ASC-COMPLETED-QTY          14890040
           END-IF.                                                      14900040
       EJECT                                                            14910040
      *----------------------------------------------------------------*14920040
      *  GET THE CUSTOMER INFORMATION FOR CUSTOMER TRANSFERS.          *14930040
      *----------------------------------------------------------------*14940040
       5400-READ-CUSTOMER.                                              14950040
           PERFORM WITH TEST AFTER                                      14960040
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       14970040
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  14980040
                    OR SQLCODE = ZERO                                   14990040
                    OR SQLCODE = +100                                   15000040
               EXEC SQL                                                 15010040
                   SELECT CUST_NM                                       15020040
                         ,CUST_1ST_LNE_ADDR                             15030040
                         ,CTY_NM                                        15040040
                         ,ST_CDE                                        15050040
                         ,ZIP_CDE                                       15060040
                         ,ZIP_EXT_CDE                                   15070040
                         ,PHN_NBR                                       15080040
                       INTO :TFCUST-CUST-NM                             15090040
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   15100040
                           ,:TFCUST-CTY-NM                              15110040
                           ,:TFCUST-ST-CDE                              15120040
                           ,:TFCUST-ZIP-CDE                             15130040
                           ,:TFCUST-ZIP-EXT-CDE                         15140040
                           ,:TFCUST-PHN-NBR                             15150040
                       FROM TTFCUST                                     15160040
                       WHERE XFER_DKEY_ID  = :ASC-XFER-DKEY-ID          15170040
               END-EXEC                                                 15180040
               EVALUATE TRUE                                            15190040
                   WHEN SQLCODE = ZERO                                  15200040
                       MOVE TFCUST-CUST-NM                              15210040
                                          TO ASC-CUST-NAME              15220040
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    15230040
                                          TO ASC-CUST-ADDRESS           15240040
                       MOVE TFCUST-CTY-NM                               15250040
                                          TO ASC-CUST-CITY              15260040
                       MOVE TFCUST-ST-CDE                               15270040
                                          TO ASC-CUST-STATE             15280040
                       MOVE TFCUST-ZIP-CDE                              15290040
                                          TO ASC-CUST-ZIP               15300040
                       MOVE TFCUST-ZIP-EXT-CDE                          15310040
                                          TO ASC-CUST-ZIP-EXT           15320040
                       MOVE TFCUST-PHN-NBR                              15330040
                                          TO ASC-CUST-PHONE             15340040
                   WHEN SQLCODE = -904                                  15350040
                   WHEN SQLCODE = -913                                  15360040
                       CONTINUE                                         15370040
                   WHEN SQLCODE = +100                                  15380040
                       MOVE 'NOT FOUND'   TO ASC-CUST-NAME              15390040
                   WHEN OTHER                                           15400048
                       MOVE '5400-READ-CUSTOMER'                        15430040
                                         TO DP013-PARAGRAPH             15440040
                       MOVE 'READ DATA FROM TTFCUST'                    15450040
                                         TO DP013-MESSAGE-TEXT (1)      15460040
                       MOVE SQLCA        TO DP013-SQLCA                 15470040
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    15480040
                       SET DP013-DB2-ABEND                              15490040
                           DP013-XCTL-DISPLAY-RESTART                   15500040
                                         TO TRUE                        15510040
                       PERFORM DP013-0000-PROCESS-ABEND                 15520040
               END-EVALUATE                                             15530040
           END-PERFORM.                                                 15540040
      *                                                                 15550040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          15560040
               MOVE '5400-READ-CUSTOMER'                                15570040
                                         TO DP013-PARAGRAPH             15580040
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15590040
                                         TO DP013-MESSAGE-TEXT (1)      15600040
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      15610040
               MOVE SQLCA                TO DP013-SQLCA                 15620040
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    15630040
               SET DP013-DB2-ABEND                                      15640040
                   DP013-XCTL-DISPLAY-RESTART                           15650040
                                         TO TRUE                        15660040
               PERFORM DP013-0000-PROCESS-ABEND                         15670040
           END-IF.                                                      15680040
           EJECT                                                        15690040
      ******************************************************************15700040
      *    SELECT THE CURRENT TTFSTAT TABLE ROW FOR A TRANSFER NUMBER.  15710040
      ******************************************************************15720040
       5500-SELECT-CURR-XFER-STATUS.                                    15730040
                                                                        15740040
           MOVE ASC-XFER-DKEY-ID         TO  TFSTAT-XFER-DKEY-ID.       15750040
                                                                        15760040
           PERFORM                                                      15770040
               WITH TEST AFTER                                          15780040
               VARYING PV-RETRY-COUNT                                   15790040
               FROM 1 BY 1                                              15800040
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 15810040
                   OR (SQLCODE = +0)                                    15820040
                   OR (SQLCODE = +100))                                 15830040
                                                                        15840040
               EXEC SQL                                                 15850040
                   SELECT  A.XFER_STAT_CDE,                             15860040
                           B.XFER_STAT_DESC                             15870040
                     INTO  :TFSTAT-XFER-STAT-CDE,                       15880040
                           :TFSTCD-XFER-STAT-DESC                       15890040
                     FROM  TTFSTAT  A,                                  15900040
                           TTFSTCD  B                                   15910040
                     WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID          15920040
                       AND   A.XFER_STAT_CDE  =  B.XFER_STAT_CDE        15930040
                       AND XFER_STAT_TMST =                             15940040
                           (SELECT MAX (XFER_STAT_TMST)                 15950040
                             FROM TTFSTAT                               15960040
                            WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID)  15970040
               END-EXEC                                                 15980040
                                                                        15990040
               EVALUATE TRUE                                            16000040
                   WHEN SQLCODE = +0                                    16010040
                        MOVE TFSTAT-XFER-STAT-CDE   TO PV-XFER-STAT-CDE 16020040
                   WHEN SQLCODE = +100                                  16030040
                        MOVE SPACES     TO TFSTAT-XFER-STAT-CDE         16040040
                   WHEN SQLCODE = -904                                  16050040
                   WHEN SQLCODE = -913                                  16060040
                        CONTINUE                                        16070040
                                                                        16080040
                   WHEN OTHER                                           16090048
                        MOVE '5500-SELECT-CURR-XFER-STATUS'             16120040
                                        TO DP013-PARAGRAPH              16130040
                        MOVE 'UNSUCCESSFUL SELECT'                      16140040
                                        TO DP013-MESSAGE-TEXT (1)       16150040
                        MOVE SQLCA      TO DP013-SQLCA                  16160040
                        MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)     16170040
                        MOVE 'TTFSTCD'  TO DP013-DB2-TABLE-NAME (2)     16180040
                        SET DP013-DB2-ABEND                             16190040
                            DP013-XCTL-DISPLAY-RESTART                  16200040
                                        TO TRUE                         16210040
                        PERFORM DP013-0000-PROCESS-ABEND                16220040
               END-EVALUATE                                             16230040
           END-PERFORM.                                                 16240040
                                                                        16250040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          16260040
               MOVE '5500-SELECT-CURR-XFER-STATUS'                      16270040
                                        TO DP013-PARAGRAPH              16280040
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   16290040
                                        TO DP013-MESSAGE-TEXT (1)       16300040
               MOVE SQLCA               TO DP013-SQLCA                  16310040
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)     16320040
               MOVE 'TTFSTCD'           TO DP013-DB2-TABLE-NAME (2)     16330040
               SET DP013-DB2-ABEND                                      16340040
                   DP013-XCTL-DISPLAY-RESTART                           16350040
                                        TO TRUE                         16360040
               PERFORM DP013-0000-PROCESS-ABEND                         16370040
           END-IF.                                                      16380040
                                                                        16390040
           EJECT                                                        16400040
      ******************************************************************16410040
      *    INSERT A NEW TRANSFER STATUS TABLE ROW WITH A VOID STATUS    16420040
      ******************************************************************16430040
       6000-VOID-TRANSFER.                                              16440040
                                                                        16450040
           EXEC SQL                                                     16460040
               SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           16470040
           END-EXEC.                                                    16480040
           MOVE ASC-XFER-DKEY-ID    TO DK-XFER-DKEY-ID.                 16490040
           PERFORM 7000-INSERT-VOID-STATUS.                             16500040
           IF PV-XFER-STAT-CDE = PC-ASSUMPTIVE-STATUS                   16510040
               PERFORM 6010-OPEN-POSTING-CSR                            16520040
               PERFORM 6020-FETCH-POSTING-CSR                           16530040
               PERFORM 6100-INSERT-POSTINGS                             16540040
                   UNTIL PS-END-OF-POSTINGS                             16550040
               PERFORM 6030-CLOSE-POSTING-CSR                           16560040
           END-IF.                                                      16570040
      *----------------------------------------------------------------*16580040
      *  OPEN THE POSTING CURSOR.                                      *16590040
      *----------------------------------------------------------------*16600040
       6010-OPEN-POSTING-CSR.                                           16610040
           EXEC SQL                                                     16620040
               OPEN POSTING_CSR                                         16630040
           END-EXEC.                                                    16640040
                                                                        16650040
           EVALUATE TRUE                                                16660040
               WHEN SQLCODE = ZERO                                      16670040
                   CONTINUE                                             16680040
               WHEN OTHER                                               16690048
                   MOVE '6010-OPEN-POSTING-CSR'                         16720040
                                             TO DP013-PARAGRAPH         16730040
                   MOVE 'OPEN THE POSTING_CSR CURSOR'                   16740040
                                             TO DP013-MESSAGE-TEXT (1)  16750040
                   MOVE SQLCA                TO DP013-SQLCA             16760040
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)16770040
                   SET DP013-DB2-ABEND                                  16780040
                       DP013-XCTL-DISPLAY-RESTART                       16790040
                                             TO TRUE                    16800040
                   PERFORM DP013-0000-PROCESS-ABEND                     16810040
           END-EVALUATE.                                                16820040
      *                                                                 16830040
      *----------------------------------------------------------------*16840040
      *  READ A ROW FROM THE TRANSFER POSTING TABLE.                   *16850040
      *----------------------------------------------------------------*16860040
       6020-FETCH-POSTING-CSR.                                          16870040
           INITIALIZE DCLTTFITPS.                                       16880040
                                                                        16890040
           PERFORM WITH TEST AFTER                                      16900040
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       16910040
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  16920040
                    OR SQLCODE = ZERO                                   16930040
                    OR SQLCODE = +100                                   16940040
                                                                        16950040
               EXEC SQL                                                 16960040
                   FETCH  POSTING_CSR                                   16970040
                    INTO  :TFITPS-XFER-LNE-NBR                          16980040
                        , :TFITPS-FRM-PSTG-STR-NBR                      16990040
                        , :TFITPS-TO-PSTG-STR-NBR                       17000040
                        , :TFITPS-ITM-RTL-PRCE-AMT                      17010040
                        , :TFITPS-ITM-QTY                               17020040
                        , :TFITPS-EXTL-SYS-PRCG-CDE                     17030040
               END-EXEC                                                 17040040
                                                                        17050040
               EVALUATE TRUE                                            17060040
                   WHEN SQLCODE = -904                                  17070040
                   WHEN SQLCODE = -913                                  17080040
                   WHEN SQLCODE = ZERO                                  17090040
                       CONTINUE                                         17100040
                   WHEN SQLCODE = +100                                  17110040
                       SET PS-END-OF-POSTINGS    TO TRUE                17120040
                   WHEN OTHER                                           17130048
                       MOVE '6020-FETCH-POSTING-CSR'                    17160040
                                             TO DP013-PARAGRAPH         17170040
                       MOVE 'FETCH POSTING_CSR'                         17180040
                                             TO DP013-MESSAGE-TEXT (1)  17190040
                       MOVE 'FOR XFER_DKEY_ID: '                        17200040
                                             TO DP013-MESSAGE-TEXT (2)  17210040
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 17220040
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     17230040
                                             TO DP013-MESSAGE-TEXT (3)  17240040
                       MOVE SQLCA            TO DP013-SQLCA             17250040
                       MOVE 'TTFITPS'        TO DP013-DB2-TABLE-NAME (1)17260040
                       SET DP013-DB2-ABEND                              17270040
                           DP013-XCTL-DISPLAY-RESTART                   17280040
                                         TO TRUE                        17290040
                       PERFORM DP013-0000-PROCESS-ABEND                 17300040
               END-EVALUATE                                             17310040
           END-PERFORM.                                                 17320040
      *                                                                 17330040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          17340040
                   MOVE '6020-FETCH-POSTING-CSR'                        17350040
                                             TO DP013-PARAGRAPH         17360040
                   MOVE 'FETCH POSTING_CSR' TO DP013-MESSAGE-TEXT (1)   17370040
                   MOVE 'FOR XFER_DKEY_ID: ' TO DP013-MESSAGE-TEXT (2)  17380040
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 17390040
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         17400040
                                             TO DP013-MESSAGE-TEXT (3)  17410040
                   MOVE SQLCA                TO DP013-SQLCA             17420040
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)17430040
                   SET DP013-DB2-ABEND                                  17440040
                       DP013-XCTL-DISPLAY-RESTART                       17450040
                                             TO TRUE                    17460040
                   PERFORM DP013-0000-PROCESS-ABEND                     17470040
           END-IF.                                                      17480040
      *                                                                 17490040
           IF SQLCODE = ZERO                                            17500040
               MOVE TFITPS-XFER-LNE-NBR       TO PV-XFER-LNE-NBR        17510040
               MOVE TFITPS-FRM-PSTG-STR-NBR   TO PV-FRM-STR-NBR         17520040
               MOVE TFITPS-TO-PSTG-STR-NBR    TO PV-TO-STR-NBR          17530040
               MOVE TFITPS-ITM-RTL-PRCE-AMT   TO PV-RTL-PRICE           17540040
               MOVE TFITPS-ITM-QTY            TO PV-QTY                 17550040
               MOVE TFITPS-EXTL-SYS-PRCG-CDE  TO PV-PRCG-CDE            17560040
           END-IF.                                                      17570040
      *                                                                 17580040
      *----------------------------------------------------------------*17590040
      * CLOSE THE TRANSFER POSTING CURSOR.                             *17600040
      *----------------------------------------------------------------*17610040
       6030-CLOSE-POSTING-CSR.                                          17620040
           EXEC SQL                                                     17630040
               CLOSE POSTING_CSR                                        17640040
           END-EXEC.                                                    17650040
                                                                        17660040
           EVALUATE TRUE                                                17670040
               WHEN SQLCODE = ZERO                                      17680040
                   CONTINUE                                             17690040
               WHEN OTHER                                               17700048
                   MOVE '6030-CLOSE-POSTING-CSR'                        17730040
                                             TO DP013-PARAGRAPH         17740040
                   MOVE 'CLOSE THE POSTING_CSR CURSOR'                  17750040
                                             TO DP013-MESSAGE-TEXT (1)  17760040
                   MOVE SQLCA                TO DP013-SQLCA             17770040
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)17780040
                   SET DP013-DB2-ABEND                                  17790040
                       DP013-XCTL-DISPLAY-RESTART                       17800040
                                             TO TRUE                    17810040
                   PERFORM DP013-0000-PROCESS-ABEND                     17820040
           END-EVALUATE.                                                17830040
      *----------------------------------------------------------------*17840040
      *  SET UP DATA TO BE INSERTED INTO THE ITEM RECEIPT TABLE        *17850040
      *----------------------------------------------------------------*17860040
       6100-INSERT-POSTINGS.                                            17870040
           INITIALIZE DCLTTFITPS.                                       17880040
           MOVE PV-XFER-LNE-NBR          TO TFITPS-XFER-LNE-NBR.        17890040
           MOVE PV-RTL-PRICE             TO TFITPS-ITM-RTL-PRCE-AMT.    17900040
           MOVE PV-QTY                   TO TFITPS-ITM-QTY.             17910040
           MOVE PV-TO-STR-NBR            TO TFITPS-FRM-PSTG-STR-NBR.    17920040
           MOVE PV-FRM-STR-NBR           TO TFITPS-TO-PSTG-STR-NBR.     17930040
           MOVE PV-PRCG-CDE              TO TFITPS-EXTL-SYS-PRCG-CDE    17940040
           MOVE DP020-USERID             TO TFITPS-ADJ-BY-USR-ID.       17950040
           PERFORM 6200-SELECT-MAX-PSTG-SEQ-NBR.                        17960040
           PERFORM 6300-INSERT-ADJUSTMENT-ROW.                          17970040
           PERFORM 6020-FETCH-POSTING-CSR.                              17980040
      *----------------------------------------------------------------*17990040
      *  GET THE MAXIMUM POSTING SEQUENCE NUMBER FOR THIS LINE NUMBER. *18000040
      *----------------------------------------------------------------*18010040
       6200-SELECT-MAX-PSTG-SEQ-NBR.                                    18020040
           INITIALIZE PV-PSTG-SEQ-NBR.                                  18030040
                                                                        18040040
           PERFORM WITH TEST AFTER                                      18050040
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       18060040
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  18070040
                    OR SQLCODE = ZERO                                   18080040
                                                                        18090040
               EXEC SQL                                                 18100040
                   SELECT  MAX(PSTG_SEQ_NBR)                            18110040
                     INTO  :PV-PSTG-SEQ-NBR                             18120040
                               :PV-NULL-IND                             18130040
                     FROM  TTFITPS                                      18140040
                     WHERE  (XFER_DKEY_ID  =  :DK-XFER-DKEY-ID          18150040
                      AND   XFER_LNE_NBR  =  :TFITPS-XFER-LNE-NBR)      18160040
               END-EXEC                                                 18170040
                                                                        18180040
               EVALUATE TRUE                                            18190040
                   WHEN SQLCODE = -904                                  18200040
                   WHEN SQLCODE = -913                                  18210040
                   WHEN SQLCODE = ZERO                                  18220040
                       CONTINUE                                         18230040
                   WHEN OTHER                                           18240048
                       MOVE '6200-SELECT-MAX-PSTG-SEQ-NBR'              18270040
                                             TO DP013-PARAGRAPH         18280040
                       MOVE 'SELECT MAX(PSTG_SEQ_NBR) FOR XFER_DKEY_ID:'18290040
                                             TO DP013-MESSAGE-TEXT (1)  18300040
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 18310040
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     18320040
                                             TO DP013-MESSAGE-TEXT (2)  18330040
                       MOVE SQLCA            TO DP013-SQLCA             18340040
                       MOVE 'TTFITPS'        TO DP013-DB2-TABLE-NAME (1)18350040
                       SET DP013-DB2-ABEND                              18360040
                           DP013-XCTL-DISPLAY-RESTART                   18370040
                                         TO TRUE                        18380040
                       PERFORM DP013-0000-PROCESS-ABEND                 18390040
               END-EVALUATE                                             18400040
           END-PERFORM.                                                 18410040
      *                                                                 18420040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          18430040
               MOVE '6200-SELECT-MAX-PSTG-SEQ-NBR'                      18440040
                                         TO DP013-PARAGRAPH             18450040
               MOVE 'SELECT MAX(PSTG_SEQ_NBR) FOR XFER_DKEY_ID: '       18460040
                                         TO DP013-MESSAGE-TEXT (1)      18470040
               MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID     18480040
               MOVE PV-DISPLAY-XFER-DKEY-ID                             18490040
                                         TO DP013-MESSAGE-TEXT (2)      18500040
               MOVE SQLCA                TO DP013-SQLCA                 18510040
               MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)    18520040
               SET DP013-DB2-ABEND                                      18530040
                   DP013-XCTL-DISPLAY-RESTART                           18540040
                                         TO TRUE                        18550040
               PERFORM DP013-0000-PROCESS-ABEND                         18560040
           END-IF.                                                      18570040
      *                                                                 18580040
      *----------------------------------------------------------------*18590040
      *  INSERT A ROW IN THE ITEM POSTING TABLE.                       *18600040
      *----------------------------------------------------------------*18610040
       6300-INSERT-ADJUSTMENT-ROW.                                      18620040
           COMPUTE TFITPS-PSTG-SEQ-NBR  =                               18630040
               PV-PSTG-SEQ-NBR + 1.                                     18640040
                                                                        18650040
           PERFORM WITH TEST AFTER                                      18660040
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       18670040
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  18680040
                    OR SQLCODE = ZERO                                   18690040
                                                                        18700040
               EXEC SQL                                                 18710040
                   INSERT INTO TTFITPS                                  18720040
                       (XFER_DKEY_ID,                                   18730040
                        XFER_LNE_NBR,                                   18740040
                        PSTG_SEQ_NBR,                                   18750040
                        XFER_RCPT_TMST,                                 18760040
                        ADJ_RSN_CDE,                                    18770040
                        ITM_PSTG_PRPD_TMST,                             18780040
                        FRM_PSTG_STR_NBR,                               18790040
                        TO_PSTG_STR_NBR,                                18800040
                        ITM_RTL_PRCE_AMT,                               18810040
                        ITM_QTY,                                        18820040
                        EXTL_SYS_PRCG_CDE,                              18830040
                        ADJ_BY_USR_ID)                                  18840040
                   VALUES                                               18850040
                       (:DK-XFER-DKEY-ID,                               18860040
                        :TFITPS-XFER-LNE-NBR,                           18870040
                        :TFITPS-PSTG-SEQ-NBR,                           18880040
                        :PV-CURRENT-TIMESTAMP,                          18890040
                        :PC-VOID-STATUS,                                18900040
                        :PV-CURRENT-TIMESTAMP,                          18910040
                        :TFITPS-FRM-PSTG-STR-NBR,                       18920040
                        :TFITPS-TO-PSTG-STR-NBR,                        18930040
                        :TFITPS-ITM-RTL-PRCE-AMT,                       18940040
                        :TFITPS-ITM-QTY,                                18950040
                        :TFITPS-EXTL-SYS-PRCG-CDE,                      18960040
                        :TFITPS-ADJ-BY-USR-ID)                          18970040
               END-EXEC                                                 18980040
                                                                        18990040
               EVALUATE TRUE                                            19000040
                   WHEN SQLCODE = -904                                  19010040
                   WHEN SQLCODE = -913                                  19020040
                   WHEN SQLCODE = ZERO                                  19030040
                       CONTINUE                                         19040040
                   WHEN OTHER                                           19050048
                       MOVE '6300-INSERT-ADJUSTMENT-ROW'                19080040
                                             TO DP013-PARAGRAPH         19090040
                       MOVE 'INSERT ADJUSTMENT FOR XFER_DKEY_ID/XFER_LNE19100040
      -                '_NBR/PSTG_SEQ_NBR: ' TO DP013-MESSAGE-TEXT (1)  19110040
                       MOVE DK-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID 19120040
                       MOVE PV-DISPLAY-XFER-DKEY-ID                     19130040
                                             TO DP013-MESSAGE-TEXT (2)  19140040
                       MOVE TFITEM-XFER-LNE-NBR                         19150040
                                             TO PV-DISPLAY-XFER-LNE-NBR 19160040
                       MOVE PV-DISPLAY-XFER-LNE-NBR                     19170040
                                             TO DP013-MESSAGE-TEXT (3)  19180040
                       MOVE PV-PSTG-SEQ-NBR  TO PV-DISPLAY-PSTG-SEQ-NBR 19190040
                       MOVE PV-DISPLAY-PSTG-SEQ-NBR                     19200040
                                             TO DP013-MESSAGE-TEXT (4)  19210040
                       MOVE SQLCA            TO DP013-SQLCA             19220040
                       MOVE 'TTFITPS'        TO DP013-DB2-TABLE-NAME (1)19230040
                       SET DP013-DB2-ABEND                              19240040
                           DP013-XCTL-DISPLAY-RESTART                   19250040
                                         TO TRUE                        19260040
                       PERFORM DP013-0000-PROCESS-ABEND                 19270040
               END-EVALUATE                                             19280040
           END-PERFORM.                                                 19290040
      *                                                                 19300040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          19310040
                   MOVE '6300-INSERT-ADJUSTMENT-ROW'                    19320040
                                             TO DP013-PARAGRAPH         19330040
                   MOVE 'INSERT ADJUSTMENT FOR XFER_DKEY_ID/XFER_LNE_NBR19340040
      -                 '/PSTG_SEQ_NBR: '    TO DP013-MESSAGE-TEXT (1)  19350040
                   MOVE DK-XFER-DKEY-ID      TO PV-DISPLAY-XFER-DKEY-ID 19360040
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         19370040
                                             TO DP013-MESSAGE-TEXT (2)  19380040
                   MOVE TFITEM-XFER-LNE-NBR  TO PV-DISPLAY-XFER-LNE-NBR 19390040
                   MOVE PV-DISPLAY-XFER-LNE-NBR                         19400040
                                             TO DP013-MESSAGE-TEXT (3)  19410040
                   MOVE PV-PSTG-SEQ-NBR      TO PV-DISPLAY-PSTG-SEQ-NBR 19420040
                   MOVE PV-DISPLAY-PSTG-SEQ-NBR                         19430040
                                             TO DP013-MESSAGE-TEXT (4)  19440040
                   MOVE SQLCA                TO DP013-SQLCA             19450040
                   MOVE 'TTFITPS'            TO DP013-DB2-TABLE-NAME (1)19460040
               SET DP013-DB2-ABEND                                      19470040
                   DP013-XCTL-DISPLAY-RESTART                           19480040
                                         TO TRUE                        19490040
               PERFORM DP013-0000-PROCESS-ABEND                         19500040
           END-IF.                                                      19510040
      ******************************************************************19520040
      *    INSERT A NEW TRANSFER STATUS TABLE ROW WITH A VOID STATUS    19530040
      ******************************************************************19540040
       7000-INSERT-VOID-STATUS.                                         19550040
           INITIALIZE DCLTTFSTAT.                                       19560040
           MOVE ASC-XFER-DKEY-ID           TO TFSTAT-XFER-DKEY-ID.      19570040
           MOVE PC-VOID-STATUS             TO TFSTAT-XFER-STAT-CDE.     19580040
           MOVE DP020-USERID               TO TFSTAT-CMNT-BY-USR-ID.    19590040
           MOVE ASC-COMMENT-ARRAY          TO TFSTAT-CMNT-TXT-TEXT      19600040
                                              VF-VARCHAR-WORK-FIELD.    19610040
           SET VF-IND                      TO +320.                     19620040
           PERFORM 7050-PROCESS-VARCHAR.                                19630040
           SET TFSTAT-CMNT-TXT-LEN         TO VF-IND.                   19640040
                                                                        19650040
           PERFORM                                                      19660040
               WITH TEST AFTER                                          19670040
               VARYING PV-RETRY-COUNT                                   19680040
               FROM 1 BY 1                                              19690040
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 19700040
                   OR (SQLCODE = +0))                                   19710040
                                                                        19720040
               EXEC SQL                                                 19730040
                   INSERT INTO TTFSTAT                                  19740040
                          ( XFER_DKEY_ID                                19750040
                           ,XFER_STAT_TMST                              19760040
                           ,XFER_STAT_CDE                               19770040
                           ,CMNT_BY_USR_ID                              19780040
                           ,CMNT_TXT)                                   19790040
                   VALUES ( :TFSTAT-XFER-DKEY-ID                        19800040
                           ,:PV-CURRENT-TIMESTAMP                       19810040
                           ,:TFSTAT-XFER-STAT-CDE                       19820040
                           ,:TFSTAT-CMNT-BY-USR-ID                      19830040
                           ,:TFSTAT-CMNT-TXT)                           19840040
               END-EXEC                                                 19850040
                                                                        19860040
               EVALUATE TRUE                                            19870040
                   WHEN SQLCODE = +0                                    19880040
                   WHEN SQLCODE = -904                                  19890040
                   WHEN SQLCODE = -913                                  19900040
                        CONTINUE                                        19910040
                                                                        19920040
                   WHEN OTHER                                           19930048
                        MOVE '7000-INSERT-VOID-STATUS'                  19960040
                                        TO DP013-PARAGRAPH              19970040
                        MOVE 'UNSUCCESSFUL INSERT'                      19980040
                                        TO DP013-MESSAGE-TEXT (1)       19990040
                        MOVE SQLCA      TO DP013-SQLCA                  20000040
                        MOVE 'TTFSTAT ' TO DP013-DB2-TABLE-NAME (1)     20010040
                        SET DP013-DB2-ABEND                             20020040
                            DP013-XCTL-DISPLAY-RESTART                  20030040
                                        TO TRUE                         20040040
                        PERFORM DP013-0000-PROCESS-ABEND                20050040
               END-EVALUATE                                             20060040
           END-PERFORM.                                                 20070040
                                                                        20080040
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          20090040
               MOVE '7000-INSERT-VOID-STATUS'                           20100040
                                        TO DP013-PARAGRAPH              20110040
               MOVE 'MAX RETRIES EXCEEDED FOR INSERT'                   20120040
                                        TO DP013-MESSAGE-TEXT (1)       20130040
               MOVE SQLCA               TO DP013-SQLCA                  20140040
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)     20150040
               SET DP013-DB2-ABEND                                      20160040
                   DP013-XCTL-DISPLAY-RESTART                           20170040
                                        TO TRUE                         20180040
               PERFORM DP013-0000-PROCESS-ABEND                         20190040
           END-IF.                                                      20200040
                                                                        20210040
           EJECT                                                        20220040
      *----------------------------------------------------------------*20230040
      *  DETERMINE THE LENGTH OF THE VARCHAR FIELD.                    *20240040
      *----------------------------------------------------------------*20250040
       7050-PROCESS-VARCHAR.                                            20260040
           IF VF-VARCHAR-WORK-FIELD = SPACES                            20270040
               SET VF-IND                     TO +1                     20280040
               SET VF-IND                     DOWN BY +1                20290040
           ELSE                                                         20300040
               SET VF-VARCHAR-BEGIN           TO TRUE                   20310040
               PERFORM                                                  20320040
                 UNTIL VF-VARCHAR-END                                   20330040
                   IF VF-VARCHAR (VF-IND) = ' '                         20340040
                       IF VF-IND > +0                                   20350040
                           SET VF-IND         DOWN BY +1                20360040
                       ELSE                                             20370040
                           SET VF-VARCHAR-END TO TRUE                   20380040
                       END-IF                                           20390040
                   ELSE                                                 20400040
                       SET VF-VARCHAR-END     TO TRUE                   20410040
                   END-IF                                               20420040
               END-PERFORM                                              20430040
           END-IF.                                                      20440040
051705*----------------------------------------------------------------*20450052
051705*    GET THE PHYSICAL INVENTORY PERIOD INDICATOR FROM TTFCNTL    *20460052
051705*----------------------------------------------------------------*20470052
051705*7500-READ-CONTROL-TABLE.                                         20480052
051705*    PERFORM                                                      20490052
051705*        WITH TEST AFTER                                          20500052
051705*        VARYING PV-RETRY-COUNT                                   20510052
051705*        FROM 1 BY 1                                              20520052
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 20530052
051705*            OR (SQLCODE = +0))                                   20540052
051705*        EXEC SQL                                                 20550052
051705*            SELECT PHY_INV_PERD_IND                              20560052
051705*                  ,XFER_INV_CTOFF_DTE                            20570052
051705*                  ,MAX_PLND_INV_DTE                              20580052
051705*                  ,MAX_FINCL_BK_DTE                              20590052
051705*             INTO :TFCNTL-PHY-INV-PERD-IND                       20600052
051705*                 ,:TFCNTL-XFER-INV-CTOFF-DTE                     20610052
051705*                 ,:TFCNTL-MAX-PLND-INV-DTE                       20620052
051705*                 ,:TFCNTL-MAX-FINCL-BK-DTE                       20630052
051705*             FROM TTFCNTL                                        20640052
051705*        END-EXEC                                                 20650052
051705*        EVALUATE TRUE                                            20660052
051705*            WHEN SQLCODE = ZERO                                  20670052
051705*                  MOVE TFCNTL-PHY-INV-PERD-IND                   20680052
051705*                                    TO PV-PHY-INV-PERD-IND       20690052
051705*                  MOVE TFCNTL-XFER-INV-CTOFF-DTE                 20700052
051705*                                    TO PV-XFER-INV-CTOFF-DTE     20710052
051705*                  MOVE TFCNTL-MAX-PLND-INV-DTE                   20720052
051705*                                    TO PV-MAX-PLND-INV-DTE       20730052
051705*                  MOVE TFCNTL-MAX-FINCL-BK-DTE                   20740052
051705*                                    TO PV-MAX-FINCL-BK-DTE       20750052
051705*            WHEN SQLCODE = -904                                  20760052
051705*            WHEN SQLCODE = -913                                  20770052
051705*                CONTINUE                                         20780052
051705*            WHEN OTHER                                           20790052
051705*                MOVE '7500-READ-CONTROL-TABLE'                   20820052
051705*                                  TO DP013-PARAGRAPH             20830052
051705*                MOVE 'GET THE PHYSICAL INV. PERIOD INDICATOR'    20840052
051705*                                      TO DP013-MESSAGE-TEXT (1)  20850052
051705*                MOVE SQLCA            TO DP013-SQLCA             20860052
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)20870052
051705*                SET DP013-DB2-ABEND                              20880052
051705*                DP013-XCTL-DISPLAY-RESTART                       20890052
051705*                                     TO TRUE                     20900052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 20910052
051705*        END-EVALUATE                                             20920052
051705*    END-PERFORM.                                                 20930052
051705*                                                                 20940052
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          20950052
051705*                MOVE '7500-READ-CONTROL-TABLE'                   20960052
051705*                                  TO DP013-PARAGRAPH             20970052
051705*                MOVE 'MAX RETRIES EXCEEDED READING '             20980052
051705*                                      TO DP013-MESSAGE-TEXT (1)  20990052
051705*                MOVE SQLCA            TO DP013-SQLCA             21000052
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)21010052
051705*                SET DP013-DB2-ABEND                              21020052
051705*                DP013-XCTL-DISPLAY-RESTART                       21030052
051705*                                     TO TRUE                     21040052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 21050052
051705*    END-IF.                                                      21060052
051705*EJECT                                                            21070052
051705*----------------------------------------------------------------*21080052
051705*    GET THE MAX PLANNED INVENTORY DATE FOR THIS STORE           *21090052
051705*----------------------------------------------------------------*21100052
051705*7600-GET-STR-PLND-INV-DTE.                                       21110052
051705*    PERFORM                                                      21120052
051705*        WITH TEST AFTER                                          21130052
051705*        VARYING PV-RETRY-COUNT                                   21140052
051705*        FROM 1 BY 1                                              21150052
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 21160052
051705*            OR (SQLCODE = +0)                                    21170052
051705*            OR (SQLCODE = +100))                                 21180052
051705*        EXEC SQL                                                 21190052
051705*            SELECT A.PLND_INV_DTE                                21200052
051705*                  ,A.ACTL_FIN_BK_DTE                             21210052
051705*                  ,A.SCHD_PHY_CNT_IND                            21220052
051705*             INTO :INVPAR-PLND-INV-DTE                           21230052
051705*                 ,:INVPAR-ACTL-FIN-BK-DTE                        21240052
051705*                 ,:INVPAR-SCHD-PHY-CNT-IND                       21250052
051705*             FROM TINVPAR A                                      21260052
051705*            WHERE  A.LOC_NBR      = :DK-STORE-NBR-9          AND 21270052
051705*                   A.PLND_INV_DTE < :PC-MAX-DATE                 21280052
051705*              AND  A.PLND_INV_DTE =                              21290052
051705*                   (SELECT MAX(PLND_INV_DTE)                     21300052
051705*                     FROM TINVPAR B                              21310052
051705*                    WHERE  B.LOC_NBR    = :DK-STORE-NBR-9    AND 21320052
051705*                           B.ACTL_FIN_BK_DTE = :PC-MAX-DATE  AND 21330052
051705*                           PLND_INV_DTE < :PC-MAX-DATE)          21340052
051705*        END-EXEC                                                 21350052
051705*        EVALUATE TRUE                                            21360052
051705*            WHEN SQLCODE = ZERO                                  21370052
051705*                IF INVPAR-SCHD-PHY-CNT-IND = PC-YES              21380052
051705*                    SET PV-HOLD-PHYSICAL-COUNT TO TRUE           21390052
051705*                ELSE                                             21400052
051705*                    IF INVPAR-ACTL-FIN-BK-DTE = PC-MAX-DATE      21410052
051705*                        SET PV-HOLD-FAKE-INVENTORY   TO TRUE     21420052
051705*                    ELSE                                         21430052
051705*                        SET PV-HOLD-NO-INVENTORY   TO TRUE       21440052
051705*                    END-IF                                       21450052
051705*                END-IF                                           21460052
051705*            WHEN SQLCODE = +100                                  21470052
051705*                MOVE PV-CURRENT-DATE TO INVPAR-PLND-INV-DTE      21480052
051705*                SET PV-HOLD-NO-INVENTORY   TO TRUE               21490052
051705*            WHEN SQLCODE = -904                                  21500052
051705*            WHEN SQLCODE = -913                                  21510052
051705*                CONTINUE                                         21520052
051705*            WHEN OTHER                                           21530052
051705*                MOVE '7600-GET-STR-PLND-INV-DTE'                 21560052
051705*                                  TO DP013-PARAGRAPH             21570052
051705*                MOVE 'GET THE PLANNED INVENTORY DATE FOR STORE:' 21580052
051705*                                      TO DP013-MESSAGE-TEXT (1)  21590052
051705*                MOVE DK-STORE-NBR-9                              21600052
051705*                                      TO DP013-MESSAGE-TEXT (2)  21610052
051705*                MOVE SQLCA            TO DP013-SQLCA             21620052
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)21630052
051705*                SET DP013-DB2-ABEND                              21640052
051705*                DP013-XCTL-DISPLAY-RESTART                       21650052
051705*                                     TO TRUE                     21660052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 21670052
051705*        END-EVALUATE                                             21680052
051705*    END-PERFORM.                                                 21690052
051705*                                                                 21700052
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          21710052
051705*                MOVE '7600-GET-STR-PLND-INV-DTE'                 21720052
051705*                                  TO DP013-PARAGRAPH             21730052
051705*                MOVE 'MAX RETRIES EXCEEDED READING FOR STORE:'   21740052
051705*                                      TO DP013-MESSAGE-TEXT (1)  21750052
051705*                MOVE DK-STORE-NBR-9                              21760052
051705*                                      TO DP013-MESSAGE-TEXT (2)  21770052
051705*                MOVE SQLCA            TO DP013-SQLCA             21780052
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)21790052
051705*                SET DP013-DB2-ABEND                              21800052
051705*                DP013-XCTL-DISPLAY-RESTART                       21810052
051705*                                     TO TRUE                     21820052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 21830052
051705*    END-IF.                                                      21840052
051705*----------------------------------------------------------------*21850052
051705*    GET THE MAX XFER INVENTORY CUTOFF DATE FOR THIS STORE       *21860052
051705*----------------------------------------------------------------*21870052
051705*7800-GET-STORE-XFER-CTOFF-DTE.                                   21880052
051705*    PERFORM                                                      21890052
051705*        WITH TEST AFTER                                          21900052
051705*        VARYING PV-RETRY-COUNT                                   21910052
051705*        FROM 1 BY 1                                              21920052
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 21930052
051705*            OR (SQLCODE = +0)                                    21940052
051705*            OR (SQLCODE = +100))                                 21950052
051705*        EXEC SQL                                                 21960052
051705*            SELECT MAX(XFER_INV_CTOFF_DTE)                       21970052
051705*                INTO :INVPAR-XFER-INV-CTOFF-DTE                  21980052
051705*                     :PV-NULL-IND                                21990052
051705*                FROM TINVPAR                                     22000052
051705*                WHERE  LOC_NBR    = :DK-STORE-NBR-9              22010052
051705*        END-EXEC                                                 22020052
051705*        EVALUATE TRUE                                            22030052
051705*            WHEN SQLCODE = ZERO                                  22040052
051705*            WHEN SQLCODE = -904                                  22050052
051705*            WHEN SQLCODE = -913                                  22060052
051705*                CONTINUE                                         22070052
051705*            WHEN SQLCODE = +100                                  22080052
051705*                MOVE PC-MIN-DATE   TO INVPAR-XFER-INV-CTOFF-DTE  22090052
051705*            WHEN OTHER                                           22100052
051705*                MOVE '7800-GET-STORE-XFER-CTOFF-DTE'             22130052
051705*                                  TO DP013-PARAGRAPH             22140052
051705*                MOVE 'GET THE TRANSFER CUTOFF DATE FOR STORE:'   22150052
051705*                                      TO DP013-MESSAGE-TEXT (1)  22160052
051705*                MOVE DK-STORE-NBR-9                              22170052
051705*                                      TO DP013-MESSAGE-TEXT (2)  22180052
051705*                MOVE SQLCA            TO DP013-SQLCA             22190052
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)22200052
051705*                SET DP013-DB2-ABEND                              22210052
051705*                DP013-XCTL-DISPLAY-RESTART                       22220052
051705*                                     TO TRUE                     22230052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 22240052
051705*        END-EVALUATE                                             22250052
051705*    END-PERFORM.                                                 22260052
051705*                                                                 22270052
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          22280052
051705*                MOVE '7800-GET-STORE-XFER-CTOFF-DTE'             22290052
051705*                                  TO DP013-PARAGRAPH             22300052
051705*                MOVE 'MAX RETRIES EXCEEDED READING FOR STORE:'   22310052
051705*                                      TO DP013-MESSAGE-TEXT (1)  22320052
051705*                MOVE DK-STORE-NBR-9                              22330052
051705*                                      TO DP013-MESSAGE-TEXT (2)  22340052
051705*                MOVE SQLCA            TO DP013-SQLCA             22350052
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)22360052
051705*                SET DP013-DB2-ABEND                              22370052
051705*                DP013-XCTL-DISPLAY-RESTART                       22380052
051705*                                     TO TRUE                     22390052
051705*                PERFORM DP013-0000-PROCESS-ABEND                 22400052
051705*    END-IF.                                                      22410052
051705*    IF PV-NULL-IND < 0                                           22420052
051705*        MOVE PC-MIN-DATE             TO INVPAR-XFER-INV-CTOFF-DTE22430052
051705*    END-IF.                                                      22440052
      *----------------------------------------------------------------*22450040
      *    ABEND PROCESSOR MODULE                                      *22460040
      *----------------------------------------------------------------*22470040
                                                                        22480040
           COPY DPPD013.                                                22490040
