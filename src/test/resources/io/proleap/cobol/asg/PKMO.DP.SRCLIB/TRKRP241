000100 IDENTIFICATION DIVISION.                                         00010080
000200                                                                  00020080
000300 PROGRAM-ID.    TRKRP241.                                         00030080
000400 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00040080
000500 INSTALLATION.  KOHLS.                                            00050080
000600 DATE-WRITTEN   DECEMBER 1998.                                    00060080
000700 DATE-COMPILED.                                                   00070080
000800                                                                  00080080
000900 ENVIRONMENT DIVISION.                                            00090080
001000                                                                  00100080
001100 CONFIGURATION SECTION.                                           00110080
001200                                                                  00120080
001300 SOURCE-COMPUTER.        IBM-3090.                                00130080
001400 OBJECT-COMPUTER.        IBM-3090.                                00140080
001500                                                                  00150080
001600 INPUT-OUTPUT SECTION.                                            00160080
001700                                                                  00170080
001800 FILE-CONTROL.                                                    00180080
001900                                                                  00190080
002000     SELECT ERROR-FILE                                            00200080
002100         ASSIGN TO INP01.                                         00210080
002200                                                                  00220080
002300     SELECT ERROR-REPORT-FILE                                     00230080
002400         ASSIGN TO RPT01.                                         00240080
002500                                                                  00250080
002510     SELECT ERRORS-ONLY-REPORT-FILE                               00251088
002520         ASSIGN TO OUT01.                                         00252099
002530                                                                  00253088
002600******************************************************************00260080
002700 DATA DIVISION.                                                   00270080
002800******************************************************************00280080
002900                                                                  00290080
003000 FILE SECTION.                                                    00300080
003100                                                                  00310080
003200 FD  ERROR-FILE                                                   00320080
003300     RECORDING MODE IS F                                          00330080
003400     LABEL RECORDS ARE STANDARD                                   00340080
003500     BLOCK CONTAINS 0 RECORDS.                                    00350080
003600                                                                  00360080
003700 01  ERROR-RECORD                     PIC  X(508).                00370080
003800                                                                  00380080
003900                                                                  00390080
004000 FD  ERROR-REPORT-FILE                                            00400080
004100     RECORDING MODE IS F                                          00410080
004200     LABEL RECORDS ARE STANDARD                                   00420080
004300     BLOCK CONTAINS 0 RECORDS.                                    00430080
004400                                                                  00440080
004500 01  ERROR-REPORT-RECORD              PIC  X(132).                00450080
004600                                                                  00460080
004610 FD  ERRORS-ONLY-REPORT-FILE                                      00461086
004620     RECORDING MODE IS F                                          00462086
004630     LABEL RECORDS ARE STANDARD                                   00463086
004640     BLOCK CONTAINS 0 RECORDS.                                    00464086
004650                                                                  00465086
004660 01  ERR-ONLY-REPORT-REC              PIC  X(80).                 00466099
004670                                                                  00467086
004700                                                                  00470080
004800*----------------------------------------------------------------*00480080
004900 WORKING-STORAGE SECTION.                                         00490080
005000*----------------------------------------------------------------*00500080
005100                                                                  00510080
005200*----------------------------------------------------------------*00520080
005300***  WORK FIELDS FOR THE ERROR REPORT                             00530080
005400*----------------------------------------------------------------*00540080
005500     COPY TRRD241.                                                00550080
005600                                                                  00560080
005700 01  PS-PROGRAM-SWITCHES.                                         00570080
005800     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)   VALUE SPACES.    00580080
005900         88  PS-EOF-ERROR-FILE                   VALUE 'Y'.       00590080
006000     05  PS-DETAIL-LINES-PRESENT    PIC  X(01)   VALUE SPACES.    00600080
006100         88  PS-DETAIL-LINES-PRESENT-YES         VALUE 'Y'.       00610080
006200         88  PS-DETAIL-LINES-PRESENT-NO          VALUE 'N'.       00620080
006300                                                                  00630080
006400 01 PC-PROGRAM-CONSTANTS.                                         00640080
006500     05  PC-PAGE-SIZE-054           PIC S9(04)   VALUE +054       00650080
006600                                                  COMP SYNC.      00660080
006700     05  PC-PAGE-SIZE-060           PIC S9(04)   VALUE +060       00670080
006800                                                  COMP SYNC.      00680080
006900     05  PC-HEADING-SIZE            PIC S9(04)   VALUE +6         00690080
007000                                                  COMP SYNC.      00700080
007100     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)   VALUE            00710080
007200         'TRKRP241'.                                              00720080
007300                                                                  00730080
007400 01  PV-PROGRAM-VARIABLES.                                        00740080
007500     05  PV-LINES-USED              PIC S9(04)   VALUE ZERO       00750080
007600                                                  COMP SYNC.      00760080
007700     05  PV-BLANK-LINE              PIC  X(132)  VALUE SPACES.    00770080
007710     05  PV-BLANK-LINE-80           PIC  X(80)   VALUE SPACES.    00771099
007800     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)  VALUE ZEROES.    00780080
007900     05  PV-PAGE-COUNT              PIC  9(05)   VALUE ZERO.      00790080
007910     05  PV-PAGE-COUNT-2            PIC  9(05)   VALUE ZERO.      00791093
008000     05  PV-PREV-ENTRY              PIC  X(12)                    00800080
008100                                           VALUE 'INITIALVALUE'.  00810080
008200                                                                  00820080
008300 01  SD-SYSTEM-DATE.                                              00830080
008400     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00840080
008500     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00850080
008600     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00860080
008700                                                                  00870080
008800 01  ST-SYSTEM-TIME.                                              00880080
008900     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00890080
009000     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00900080
009100     05  FILLER                     PIC  9(04)   VALUE ZERO.      00910080
009200                                                                  00920080
009300 01  PV-WORK-DATE.                                                00930080
009400     05  FILLER                     PIC  9(02)   VALUE ZERO.      00940080
009500     05  PV-WORK-YY                 PIC  9(02)   VALUE ZERO.      00950080
009600     05  PV-WORK-MM                 PIC  9(02)   VALUE ZERO.      00960080
009700     05  PV-WORK-DD                 PIC  9(02)   VALUE ZERO.      00970080
009800                                                                  00980080
009900 01  PV-WORK-TIME.                                                00990080
010000     05  PV-WORK-HOUR               PIC  9(02)   VALUE ZERO.      01000080
010100     05  PV-WORK-MINUTE             PIC  9(02)   VALUE ZERO.      01010080
010200                                                                  01020080
010300 01  PV-DEFAULT-DATE.                                             01030080
010400     05  PV-DEFAULT-CC              PIC  9(02)   VALUE ZERO.      01040080
010500     05  PV-DEFAULT-YY              PIC  9(02)   VALUE 01.        01050080
010600     05  PV-DEFAULT-MM              PIC  9(02)   VALUE 01.        01060080
010700     05  PV-DEFAULT-DD              PIC  9(02)   VALUE 01.        01070080
010800                                                                  01080080
010900 01  PV-DEFAULT-TIME.                                             01090080
011000     05  PV-DEFAULT-HOUR            PIC  9(02)   VALUE ZERO.      01100080
011100     05  PV-DEFAULT-MINUTE          PIC  9(02)   VALUE ZERO.      01110080
011200                                                                  01120080
011300 01  PV-EDIT-DATE.                                                01130080
011400     05  FILLER                     PIC  X(02)   VALUE ZERO.      01140080
011500     05  FILLER                     PIC  X(01)   VALUE '/'.       01150080
011600     05  FILLER                     PIC  X(02)   VALUE ZERO.      01160080
011700     05  FILLER                     PIC  X(01)   VALUE '/'.       01170080
011800     05  FILLER                     PIC  X(02)   VALUE ZERO.      01180080
011900                                                                  01190080
012000 01  PV-EDIT-TIME.                                                01200080
012100     05  FILLER                     PIC  X(02)   VALUE SPACES.    01210080
012200     05  FILLER                     PIC  X(01)   VALUE ':'.       01220080
012300     05  FILLER                     PIC  X(02)   VALUE SPACES.    01230080
012400                                                                  01240080
012500 01  PV-DISP-DATE.                                                01250080
012600     05  PV-DISP-MM                 PIC  9(02)   VALUE ZERO.      01260080
012700     05  FILLER                     PIC  X(01)   VALUE SPACE.     01270080
012800     05  PV-DISP-DD                 PIC  9(02)   VALUE ZERO.      01280080
012900     05  FILLER                     PIC  X(01)   VALUE SPACE.     01290080
013000     05  PV-DISP-YY                 PIC  9(02)   VALUE ZERO.      01300080
013100                                                                  01310080
013200 01  PV-DISP-TIME.                                                01320080
013300     05  PV-DISP-HOUR               PIC  9(02)   VALUE ZERO.      01330080
013400     05  FILLER                     PIC  X(01)   VALUE SPACE.     01340080
013500     05  PV-DISP-MINUTE             PIC  9(02)   VALUE ZERO.      01350080
013600                                                                  01360080
013700*----------------------------------------------------------------*01370080
013800***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01380080
013900*----------------------------------------------------------------*01390080
014000     COPY DPWS132O.                                               01400080
014100                                                                  01410080
014200 01  HL1-HEADING-LINE-1.                                          01420080
014300     05  FILLER                      PIC  X(02)  VALUE SPACES.    01430080
014400     05  HL1-TRANS-DATE.                                          01440080
014500         10 HL-TRANS-MM              PIC  X(02)  VALUE SPACES.    01450080
014600         10 FILLER                   PIC  X(01)  VALUE '/'.       01460080
014700         10 HL-TRANS-DD              PIC  X(02)  VALUE SPACES.    01470080
014800         10 FILLER                   PIC  X(01)  VALUE '/'.       01480080
014900         10 HL-TRANS-YY              PIC  X(02)  VALUE SPACES.    01490080
015000     05  FILLER                      PIC  X(02)  VALUE SPACES.    01500080
015100     05  HL1-TRANS-TIME.                                          01510080
015200         10 HL-TRANS-TIME-HH         PIC  X(02)  VALUE SPACES.    01520080
015300         10 FILLER                   PIC  X(01)  VALUE ':'.       01530080
015400         10 HL-TRANS-TIME-MM         PIC  X(02)  VALUE SPACES.    01540080
015500     05  FILLER                      PIC  X(01)  VALUE SPACES.    01550080
015600     05  FILLER                      PIC  X(13)  VALUE            01560080
015700         'TRANSMIT DATE'.                                         01570080
015800     05  FILLER                      PIC  X(16)  VALUE SPACES.    01580080
015900     05  FILLER                      PIC  X(38)  VALUE            01590080
016000         '     EI CUSTOMS BROKER LOAD ERRORS    '.                01600080
016100     05  FILLER                      PIC  X(16)  VALUE SPACES.    01610080
016200     05  FILLER                      PIC  X(07)  VALUE            01620080
016300         'FILE ID'.                                               01630080
016400     05  FILLER                      PIC  X(02)  VALUE SPACES.    01640080
016500     05  HL1-FILE-ID                 PIC  X(09)  VALUE SPACES.    01650080
016600     05  FILLER                      PIC  X(13)  VALUE SPACES.    01660080
016700                                                                  01670080
016800 01  HL2-HEADING-LINE-2.                                          01680080
016900         10 FILLER                   PIC  X(02)  VALUE SPACES.    01690080
017000     05  HL2-LOAD-DATE.                                           01700080
017100         10 HL-LOAD-MM               PIC  X(02)  VALUE SPACES.    01710080
017200         10 FILLER                   PIC  X(01)  VALUE '/'.       01720080
017300         10 HL-LOAD-DD               PIC  X(02)  VALUE SPACES.    01730080
017400         10 FILLER                   PIC  X(01)  VALUE '/'.       01740080
017500         10 HL-LOAD-YY               PIC  X(02)  VALUE SPACES.    01750080
017600     05  FILLER                      PIC  X(02)  VALUE SPACES.    01760080
017700     05  HL2-LOAD-TIME.                                           01770080
017800         10 HL-LOAD-TIME-HH          PIC  X(02)  VALUE SPACES.    01780080
017900         10 FILLER                   PIC  X(01)  VALUE ':'.       01790080
018000         10 HL-LOAD-TIME-MM          PIC  X(02)  VALUE SPACES.    01800080
018100     05  FILLER                      PIC  X(01)  VALUE SPACES.    01810080
018200     05  FILLER                      PIC  X(13)  VALUE            01820080
018300         'LOAD DATE    '.                                         01830080
018400     05  FILLER                      PIC  X(16)  VALUE SPACES.    01840080
018500     05  FILLER                      PIC  X(38)  VALUE SPACES.    01850080
018600     05  FILLER                      PIC  X(16)  VALUE SPACES.    01860080
018700     05  HL2-EXPEDITOR               PIC  X(30)  VALUE SPACES.    01870080
018800     05  FILLER                      PIC  X(01)  VALUE SPACES.    01880080
018900                                                                  01890080
019000 01  HL3-HEADING-LINE-3.                                          01900080
019100     05  FILLER                      PIC  X(02)  VALUE SPACES.    01910080
019200     05  FILLER                      PIC  X(08)  VALUE            01920080
019300         'ENTRY ID'.                                              01930080
019400     05  FILLER                      PIC  X(12)  VALUE SPACES.    01940080
019500     05  FILLER                      PIC  X(23)  VALUE            01950080
019600         'BROKER REFERENCE NUMBER'.                               01960080
019700     05  FILLER                      PIC  X(10)  VALUE SPACES.    01970080
019800     05  FILLER                      PIC  X(30)  VALUE            01980080
019900         'PORT OF ENTRY                 '.                        01990080
020000     05  FILLER                      PIC  X(47) VALUE SPACES.     02000080
020100                                                                  02010080
020200 01  HL4-HEADING-LINE-4.                                          02020080
020300     05  FILLER                      PIC  X(02)  VALUE SPACES.    02030080
020400     05  HL4-HEAD-ENTRY-ID           PIC  X(12)  VALUE SPACES.    02040080
020500     05  FILLER                      PIC  X(08)  VALUE SPACES.    02050080
020600     05  HL4-HEAD-BROKER-REF         PIC  X(15)  VALUE SPACES.    02060080
020700     05  FILLER                      PIC  X(18)  VALUE SPACES.    02070080
020800     05  HL4-HEAD-POE-NM             PIC  X(30)  VALUE SPACES.    02080080
020900     05  FILLER                      PIC  X(47)  VALUE SPACES.    02090080
021000                                                                  02100080
021010 01  HL1-HEADING-EMAIL-1.                                         02101095
021020     05  FILLER                      PIC  X(02)  VALUE SPACES.    02102095
021030     05  HL1-TRANS-DATE-EM.                                       02103095
021040         10 HL-TRANS-MM-EM           PIC  X(02)  VALUE SPACES.    02104095
021050         10 FILLER                   PIC  X(01)  VALUE '/'.       02105095
021060         10 HL-TRANS-DD-EM           PIC  X(02)  VALUE SPACES.    02106095
021070         10 FILLER                   PIC  X(01)  VALUE '/'.       02107095
021080         10 HL-TRANS-YY-EM           PIC  X(02)  VALUE SPACES.    02108095
021090     05  FILLER                      PIC  X(02)  VALUE SPACES.    02109095
021091     05  HL1-TRANS-TIME.                                          02109195
021092         10 HL-TRANS-TIME-HH-EM      PIC  X(02)  VALUE SPACES.    02109295
021093         10 FILLER                   PIC  X(01)  VALUE ':'.       02109395
021094         10 HL-TRANS-TIME-MM-EM      PIC  X(02)  VALUE SPACES.    02109495
021095     05  FILLER                      PIC  X(01)  VALUE SPACES.    02109595
021096     05  FILLER                      PIC  X(13)  VALUE            02109695
021097         'TRANSMIT DATE'.                                         02109795
021101     05  FILLER                      PIC  X(08)  VALUE SPACES.    02110195
021102     05  FILLER                      PIC  X(07)  VALUE            02110295
021103         'FILE ID'.                                               02110395
021104     05  FILLER                      PIC  X(02)  VALUE SPACES.    02110495
021105     05  HL1-FILE-ID-EM              PIC  X(09)  VALUE SPACES.    02110595
021106     05  FILLER                      PIC  X(13)  VALUE SPACES.    02110695
021107                                                                  02110795
021108 01  HL2-HEADING-EMAIL-2.                                         02110895
021109     05  FILLER                      PIC  X(02)  VALUE SPACES.    02110995
021110     05  FILLER                      PIC  X(08)  VALUE            02111095
021111         'ENTRY ID'.                                              02111195
021112     05  FILLER                      PIC  X(12)  VALUE SPACES.    02111295
021113     05  FILLER                      PIC  X(23)  VALUE            02111395
021114         'BROKER REFERENCE NUMBER'.                               02111495
021115     05  FILLER                      PIC  X(03)  VALUE SPACES.    02111597
021116     05  FILLER                      PIC  X(25)  VALUE            02111695
021117         'PORT OF ENTRY            '.                             02111795
021119                                                                  02111995
021120 01  HL3-HEADING-EMAIL-3.                                         02112095
021121     05  FILLER                      PIC  X(02)  VALUE SPACES.    02112195
021122     05  HL3-HEAD-ENTRY-ID-EM        PIC  X(12)  VALUE SPACES.    02112295
021123     05  FILLER                      PIC  X(08)  VALUE SPACES.    02112395
021124     05  HL3-HEAD-BROKER-REF-EM      PIC  X(15)  VALUE SPACES.    02112495
021125     05  FILLER                      PIC  X(11)  VALUE SPACES.    02112599
021126     05  HL3-HEAD-POE-NM-EM          PIC  X(30)  VALUE SPACES.    02112699
021128                                                                  02112895
021130***************************************************************   02113080
021200*  DETAIL LINES                                                   02120080
021300 01  DL-COMMON-HEADING-1.                                         02130080
021400     05  FILLER                      PIC  X(02)  VALUE SPACES.    02140080
021500     05  FILLER                      PIC  X(20)  VALUE            02150080
021600         'RECD   TRN   POE    '.                                  02160080
021700     05  FILLER                      PIC  X(110) VALUE SPACES.    02170099
021800                                                                  02180080
021900 01  DL-COMMON-HEADING-2.                                         02190080
022000     05  DL-TYPE-LITS.                                            02200080
022100         10 FILLER                   PIC  X(02)  VALUE SPACES.    02210080
022200         10 FILLER                   PIC  X(20)  VALUE            02220080
022300         'TYPE   TYPE  CODE   '.                                  02230080
022400         10 DL2-DETAIL-LIT           PIC  X(110) VALUE SPACES.    02240080
022500                                                                  02250080
022600 01  DL-TYPE-HEADINGS.                                            02260080
022700     05  DL-ENF-HDR.                                              02270080
022800         10  FILLER                   PIC  X(19)  VALUE           02280080
022900             'CUSTOM ENTRY FILED '.                               02290080
023000         10  FILLER                   PIC  X(07)  VALUE SPACES.   02300080
023100         10  FILLER                   PIC  X(30)  VALUE           02310080
023200             'ENTRY TYPE DESCRIPTION        '.                    02320080
023300         10  FILLER                   PIC  X(04)  VALUE SPACES.   02330080
023400         10  FILLER                   PIC  X(09)  VALUE           02340080
023500             'TRIP TYPE'.                                         02350080
023600     05  DL-ENFPO-HDR.                                            02360080
023700         10  FILLER   PIC X(09)  VALUE 'PO NUMBER'.               02370080
023800         10  FILLER   PIC X(17)  VALUE SPACES.                    02380080
023900         10  FILLER   PIC X(18)  VALUE 'EXTERNAL REFERENCE'.      02390080
024000         10  FILLER   PIC X(05)  VALUE SPACES.                    02400080
024100         10  FILLER   PIC X(06)  VALUE 'PO FOB'.                  02410080
024200     05  DL-ENFCON-HDR                PIC X(110)  VALUE           02420080
024300         'CONTAINER ID       '.                                   02430080
024400     05  DL-DOP-HDR                   PIC X(110)  VALUE           02440080
024500        'CONTAINER ID              DELIVERY ORDER CREATED'.       02450080
024600     05  DL-ENFBOL-HDR.                                           02460080
024700         10 FILLER                    PIC X(21)   VALUE           02470080
024800           'MASTER BILL OF LADING'.                               02480080
024900         10 FILLER                    PIC X(12)   VALUE SPACES.   02490080
025000         10 FILLER                    PIC X(20)   VALUE           02500080
025100           'HOUSE BILL OF LADING'.                                02510080
025200         10 FILLER                    PIC X(18)   VALUE SPACES.   02520080
025300         10 FILLER                    PIC X(12)   VALUE           02530080
025400           'CARRIER SCAC'.                                        02540080
025500         10 FILLER                    PIC X(27)   VALUE SPACES.   02550080
025600     05  DL-EXD-HDR                   PIC X(110)  VALUE           02560080
025700         'CUSTOMS EXAM'.                                          02570080
025800     05  DL-REJ-HDR                   PIC X(110)  VALUE           02580080
025900         'CUSTOMS REJECTIONS'.                                    02590080
026000     05  DL-ECR-HDR                   PIC X(110)  VALUE           02600080
026100         'ESTIMATED CUSTOMS CLEARANCE'.                           02610080
026200     05  DL-RLS-HDR                   PIC X(110)  VALUE           02620080
026300         'ACTUAL CUSTOMS CLEARANCE'.                              02630080
026400     05  DL-LIQ-HDR                   PIC X(110)  VALUE           02640080
026500         'CUSTOMS LIQUIDATION'.                                   02650080
026600     05  DL-LSU-HDR                   PIC X(110)  VALUE           02660080
026700         'CUSTOMS LIQUIDATION SUSPENSION'.                        02670080
026800                                                                  02680080
026900 01  DL-DETAIL-LINE-1.                                            02690080
027000     05  FILLER                       PIC X(02) VALUE SPACES.     02700080
027100     05  DL1-REC-TYPE                 PIC X(06) VALUE SPACES.     02710080
027200     05  FILLER                       PIC X(03) VALUE SPACES.     02720080
027300     05  DL1-TRN-TYPE                 PIC X(01) VALUE SPACES.     02730080
027400     05  FILLER                       PIC X(03) VALUE SPACES.     02740080
027500     05  DL1-POE-CODE                 PIC X(04) VALUE SPACES.     02750080
027600     05  FILLER                       PIC X(03) VALUE SPACES.     02760080
027700     05  DL1-TEXT                     PIC X(110) VALUE SPACES.    02770080
027800                                                                  02780080
027900 01  DL-ERROR-LINES.                                              02790080
028000     05  DL-ENF-LINE.                                             02800080
028100         10  DL-ENF-DATE              PIC X(08) VALUE SPACE.      02810080
028200         10  FILLER                   PIC X(04) VALUE SPACE.      02820080
028300         10  DL-ENF-TIME              PIC X(05) VALUE SPACE.      02830080
028400         10  FILLER                   PIC X(09) VALUE SPACE.      02840080
028500         10  HL4-HEAD-ENTRY-DESC      PIC X(30) VALUE SPACES.     02850080
028600         10  FILLER                   PIC X(08) VALUE SPACES.     02860080
028700         10  HL4-HEAD-TRIP-TYPE-CDE   PIC X(01) VALUE SPACES.     02870080
028800         10  FILLER                   PIC X(10) VALUE SPACES.     02880080
028900                                                                  02890080
029000     05  DL-ENFPO-LINE.                                           02900080
029100         10  DL-ENFPO-PO              PIC 999999999.              02910080
029200         10  FILLER                   PIC X(17) VALUE SPACE.      02920080
029300         10  DL-ENFPO-EXTL-REF-NBR    PIC X(15) VALUE SPACE.      02930080
029400         10  FILLER                   PIC X(08) VALUE SPACE.      02940080
029500         10  DL-ENFPO-FOB-CDE         PIC X(03) VALUE SPACE.      02950080
029600                                                                  02960080
029700     05  DL-ENFCON-LINE.                                          02970080
029800         10  DL-ENFCON-CONTAINER      PIC X(15) VALUE SPACES.     02980080
029900                                                                  02990080
030000     05  DL-ENFBOL-LINE.                                          03000080
030100         10  DL-ENFBOL-MASTER-BOL     PIC X(30) VALUE SPACES.     03010080
030200         10  FILLER                   PIC X(03) VALUE SPACES.     03020080
030300         10  DL-ENFBOL-HOUSE-BOL      PIC X(30) VALUE SPACES.     03030080
030400         10  FILLER                   PIC X(08) VALUE SPACES.     03040080
030500         10  DL-ENFBOL-CARR-SCAC-ID   PIC X(04) VALUE SPACES.     03050080
030600                                                                  03060080
030700     05  DL-DOP-LINE.                                             03070080
030800         10  DL-DOP-CONTAINER         PIC X(15) VALUE SPACE.      03080080
030900         10  FILLER                   PIC X(11) VALUE SPACE.      03090080
031000         10  DL-DOP-DELY-SNT-DTE      PIC X(08) VALUE SPACE.      03100080
031100         10  FILLER                   PIC X(03) VALUE SPACE.      03110080
031200         10  DL-DOP-DELY-SNT-TM       PIC X(05) VALUE SPACE.      03120080
031300                                                                  03130080
031400     05  DL-EXD-LINE.                                             03140080
031500         10  DL-EXD-DATE              PIC X(08) VALUE SPACES.     03150080
031600         10  FILLER                   PIC X(04) VALUE SPACE.      03160080
031700         10  DL-EXD-TIME              PIC X(05) VALUE SPACES.     03170080
031800                                                                  03180080
031900     05  DL-REJ-LINE.                                             03190080
032000         10  DL-REJ-DATE              PIC X(08) VALUE SPACES.     03200080
032100         10  FILLER                   PIC X(04) VALUE SPACE.      03210080
032200         10  DL-REJ-TIME              PIC X(05) VALUE SPACES.     03220080
032300         10  FILLER                   PIC X(16) VALUE SPACES.     03230080
032400         10  DL-REJ-DESC              PIC X(30) VALUE SPACES.     03240080
032500                                                                  03250080
032600     05  DL-ECR-LINE.                                             03260080
032700         10  DL-ECR-DATE              PIC X(08) VALUE SPACES.     03270080
032800         10  FILLER                   PIC X(04) VALUE SPACE.      03280080
032900         10  DL-ECR-TIME              PIC X(05) VALUE SPACES.     03290080
033000                                                                  03300080
033100     05  DL-RLS-LINE.                                             03310080
033200         10  DL-RLS-DATE              PIC X(08) VALUE SPACES.     03320080
033300         10  FILLER                   PIC X(04) VALUE SPACE.      03330080
033400         10  DL-RLS-TIME              PIC X(05) VALUE SPACES.     03340080
033500                                                                  03350080
033600     05  DL-LIQ-LINE.                                             03360080
033700         10  DL-LIQ-DATE              PIC X(08) VALUE SPACES.     03370080
033800         10  FILLER                   PIC X(04) VALUE SPACE.      03380080
033900         10  DL-LIQ-TIME              PIC X(05) VALUE SPACES.     03390080
034000                                                                  03400080
034100     05  DL-LSU-LINE.                                             03410080
034200         10  DL-LSU-DATE              PIC X(08) VALUE SPACES.     03420080
034300         10  FILLER                   PIC X(04) VALUE SPACE.      03430080
034400         10  DL-LSU-TIME              PIC X(05) VALUE SPACES.     03440080
034500         10  FILLER                   PIC X(16) VALUE SPACES.     03450080
034600         10  DL-LSU-DESC              PIC X(30) VALUE SPACES.     03460080
034700                                                                  03470080
034800 01  DL-HEADING-DATA-IN-ERROR.                                    03480080
034900     05  FILLER                      PIC  X(22)  VALUE SPACES.    03490080
035000     05  FILLER                      PIC  X(13)  VALUE            03500080
035100         'DATA IN ERROR'.                                         03510080
035200     05  FILLER                      PIC  X(13)  VALUE SPACES.    03520080
035300     05  FILLER                      PIC  X(10)  VALUE            03530080
035400         'DATA VALUE'.                                            03540080
035500     05  FILLER                      PIC  X(13)  VALUE SPACES.    03550080
035600     05  FILLER                      PIC  X(04)  VALUE            03560080
035700         'TYPE'.                                                  03570080
035800     05  FILLER                      PIC  X(03)  VALUE SPACES.    03580080
035900     05  FILLER                      PIC  X(07)  VALUE            03590080
036000         'MESSAGE'.                                               03600080
036100     05  FILLER                      PIC  X(47)  VALUE SPACES.    03610080
036200                                                                  03620080
036300 01  DLE-DATA-IN-ERROR-LINE.                                      03630080
036400     05  FILLER                      PIC  X(02)  VALUE SPACES.    03640080
036500     05  DLE-REC-TYPE                PIC  X(03)  VALUE SPACES.    03650080
036600     05  FILLER                      PIC  X(17)  VALUE SPACES.    03660080
036700     05  DLE-DATA-IN-ERROR           PIC  X(15)  VALUE SPACES.    03670080
036800     05  FILLER                      PIC  X(11)  VALUE SPACES.    03680080
036900     05  DLE-DATA-VALUE              PIC  X(20)  VALUE SPACES.    03690080
037000     05  FILLER                      PIC  X(03)  VALUE SPACES.    03700080
037100     05  DLE-TYPE                    PIC  X(03)  VALUE SPACES.    03710080
037200     05  FILLER                      PIC  X(04)  VALUE SPACES.    03720080
037300     05  DLE-MESSAGE                 PIC  X(54)  VALUE SPACES.    03730080
037400                                                                  03740080
037410 01  DL-HEADING-DATA-IN-ERR-EM.                                   03741098
037420     05  FILLER                      PIC  X(02)  VALUE SPACES.    03742099
037430     05  FILLER                      PIC  X(13)  VALUE            03743098
037440         'DATA IN ERROR'.                                         03744098
037450     05  FILLER                      PIC  X(13)  VALUE SPACES.    03745098
037460     05  FILLER                      PIC  X(10)  VALUE            03746098
037470         'DATA VALUE'.                                            03747098
037480     05  FILLER                      PIC  X(13)  VALUE SPACES.    03748098
037490     05  FILLER                      PIC  X(04)  VALUE            03749098
037491         'TYPE'.                                                  03749198
037492     05  FILLER                      PIC  X(23)  VALUE SPACES.    03749299
037496                                                                  03749698
037497 01  DLE-DATA-IN-ERR-LINE-EM.                                     03749798
037498     05  FILLER                      PIC  X(02)  VALUE SPACES.    03749898
037501     05  DLE-DATA-IN-ERROR-EM        PIC  X(15)  VALUE SPACES.    03750199
037502     05  FILLER                      PIC  X(11)  VALUE SPACES.    03750298
037503     05  DLE-DATA-VALUE-EM           PIC  X(20)  VALUE SPACES.    03750399
037504     05  FILLER                      PIC  X(03)  VALUE SPACES.    03750498
037505     05  DLE-TYPE-EM                 PIC  X(03)  VALUE SPACES.    03750599
037506     05  FILLER                      PIC  X(58)  VALUE SPACES.    03750699
037508                                                                  03750898
037509 01  DLE-DATA-IN-ERR-MESS-EM.                                     03750999
037510     05  FILLER                      PIC  X(02)  VALUE SPACES.    03751099
037511     05  FILLER                      PIC  X(10)  VALUE            03751199
037512         'MESSAGE..:'.                                            03751299
037514     05  FILLER                      PIC  X(03)  VALUE SPACES.    03751499
037519     05  DLE-MESSAGE-EM              PIC  X(54)  VALUE SPACES.    03751999
037520     05  FILLER                      PIC  X(13)  VALUE SPACES.    03752099
037521                                                                  03752199
037522 01  DL-DETAIL-LINE-1-EM.                                         03752299
037523     05  FILLER                       PIC X(02) VALUE SPACES.     03752399
037524     05  DL1-REC-TYPE-EM              PIC X(06) VALUE SPACES.     03752499
037525     05  FILLER                       PIC X(03) VALUE SPACES.     03752599
037526     05  DL1-TRN-TYPE-EM              PIC X(01) VALUE SPACES.     03752699
037527     05  FILLER                       PIC X(03) VALUE SPACES.     03752799
037528     05  DL1-POE-CODE-EM              PIC X(04) VALUE SPACES.     03752899
037529     05  FILLER                       PIC X(03) VALUE SPACES.     03752999
037530     05  DL1-TEXT-EM                  PIC X(58) VALUE SPACES.     03753099
037540***************************************************************   03754099
037600                                                                  03760080
037700 01  ER-END-OF-REPORT-LINE.                                       03770080
037800     05  FILLER                     PIC  X(54)   VALUE SPACES.    03780080
037900     05  FILLER                     PIC  X(25)   VALUE            03790080
038000         '***** END OF REPORT *****'.                             03800080
038100     05  FILLER                     PIC  X(53)   VALUE SPACES.    03810080
038200                                                                  03820080
038300 01  EP-EMPTY-REPORT-LINE.                                        03830080
038400     05  FILLER                     PIC  X(25)   VALUE            03840080
038500         '******* NO DATA *********'.                             03850080
038600     05  FILLER                     PIC  X(107)  VALUE SPACES.    03860080
038700                                                                  03870080
038800 01  EP-NO-ERRORS-TO-REPORT-LINE.                                 03880080
038900     05  FILLER                     PIC  X(11)   VALUE SPACES.    03890080
039000     05  FILLER                     PIC  X(54)   VALUE            03900080
039100         '** NO ERRORS TO REPORT **'.                             03910080
039200     05  FILLER                     PIC  X(096)  VALUE SPACES.    03920080
039300/                                                                 03930080
039400 PROCEDURE DIVISION.                                              03940080
039500                                                                  03950080
039600*----------------------------------------------------------------*03960080
039700* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     03970080
039800*      PROGRAM.                                                   03980080
039900*----------------------------------------------------------------*03990080
040000 0000-PROGRAM-MAINLINE.                                           04000080
040100                                                                  04010080
040200     PERFORM 1000-INITIALIZE.                                     04020080
040300                                                                  04030080
040400     IF PS-EOF-ERROR-FILE                                         04040080
040500        CONTINUE                                                  04050080
040600     ELSE                                                         04060080
040700        PERFORM 2000-PROCESS-REPORT-DATA                          04070080
040800          UNTIL PS-EOF-ERROR-FILE                                 04080080
040900         IF PS-DETAIL-LINES-PRESENT-NO                            04090080
041000*          ******* TKMA508 05-03-1999 ************************    04100080
041100*          * ERROR HEADERS ARE AUTOMATICALLY CREATED BY THE       04110080
041200*          * EDIT PROGRAMS EVEN IF THERE ARE NO ERRORS. WHEN      04120080
041300*          * JUST HEADERS ARE SENT, PRINT THE HEADERS WITH A      04130080
041400*          * 'NO ERRORS TO REPORT' MSG, BUT ONLY DO THAT ONCE.    04140080
041500*          ***************************************************    04150080
041600           PERFORM 8000-WRITE-HEADINGS                            04160080
041700           WRITE ERROR-REPORT-RECORD                              04170080
041800              FROM EP-NO-ERRORS-TO-REPORT-LINE                    04180080
041900               AFTER ADVANCING 2 LINES                            04190080
042000         END-IF                                                   04200080
042100     END-IF.                                                      04210080
042200                                                                  04220080
042300     PERFORM 9000-EOJ-ROUTINE.                                    04230080
042400                                                                  04240080
042500     GOBACK.                                                      04250080
042600                                                                  04260080
042700 1000-INITIALIZE.                                                 04270080
042800                                                                  04280080
042900     OPEN INPUT  ERROR-FILE                                       04290080
043000          OUTPUT ERROR-REPORT-FILE                                04300086
043010                 ERRORS-ONLY-REPORT-FILE.                         04301086
043100                                                                  04310080
043200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04320080
043300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04330080
043400                                                                  04340080
043500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04350080
043600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04360080
043700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04370080
043800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04380080
043900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04390080
044000                                                                  04400080
044100     MOVE PC-CURRENT-PROGRAM-NAME                                 04410080
044200                                 TO DP132O-PROGRAM-NAME.          04420080
044300                                                                  04430080
044400     MOVE 1                      TO DP132O-REPORT-NUMBER.         04440080
044500                                                                  04450080
044600     PERFORM 7000-READ-ERROR-FILE.                                04460080
044700                                                                  04470080
044800     IF PS-EOF-ERROR-FILE                                         04480080
044900        PERFORM  8000-WRITE-HEADINGS                              04490080
045000        WRITE ERROR-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE       04500080
045100            AFTER ADVANCING 2 LINES                               04510080
045200     END-IF.                                                      04520080
045300/                                                                 04530080
045400****************************************************************  04540080
045500*  PROCESSING FOR ERROR RECORDS.                                  04550080
045600******************************************************************04560080
045700                                                                  04570080
045800 2000-PROCESS-REPORT-DATA.                                        04580080
045900                                                                  04590080
046000     IF TR241-REC-TYP-HDR-CDE-HDR                                 04600080
046100         PERFORM 3000-FORMAT-HEADINGS                             04610080
046200     ELSE                                                         04620080
046300*      **********************************************             04630080
046400*      *  CHECK FOR A CONTROL BREAK ON CUSTOMER ID. *             04640080
046500*      **********************************************             04650080
046600       IF TR241-CSTM-ENTR-ID     NOT =    PV-PREV-ENTRY           04660080
046623          PERFORM 8000-WRITE-HEADINGS                             04662387
046624          IF TR241-ERROR-TYPE = 'ERR'                             04662487
046625             PERFORM 8000A-WRITE-HEADINGS                         04662587
046626          END-IF                                                  04662687
046800          MOVE TR241-CSTM-ENTR-ID          TO HL4-HEAD-ENTRY-ID   04680082
046810                                              HL3-HEAD-ENTRY-ID-EM04681095
046900                                              PV-PREV-ENTRY       04690082
047000          IF TR241-ENF-ENTR-TYP-DESC  = SPACES                    04700082
047100            MOVE TR241-ENF-ENTR-TYP-CDE    TO HL4-HEAD-ENTRY-DESC 04710082
047200          ELSE                                                    04720082
047300            MOVE TR241-ENF-ENTR-TYP-DESC   TO HL4-HEAD-ENTRY-DESC 04730082
047400          END-IF                                                  04740082
047500          MOVE TR241-BKR-REF-NBR        TO HL4-HEAD-BROKER-REF    04750095
047510                                           HL3-HEAD-BROKER-REF-EM 04751095
047600          MOVE TR241-POE-NM                TO HL4-HEAD-POE-NM     04760082
047610                                              HL3-HEAD-POE-NM-EM  04761095
047700          MOVE TR241-ENF-MOM-TRIP-TYP-CDE                         04770082
047800                                TO HL4-HEAD-TRIP-TYPE-CDE         04780080
047801          PERFORM 8010-WRITE-ENTRY-ID-HEADINGS                    04780187
047810          IF TR241-ERROR-TYPE = 'ERR'                             04781087
047900           PERFORM 8010A-WRITE-ENTRY-ID-HEADINGS                  04790087
047901          END-IF                                                  04790187
048000       END-IF                                                     04800080
048100     END-IF.                                                      04810080
048200                                                                  04820080
048300     EVALUATE TRUE                                                04830080
048400       WHEN TR241-REC-TYP-ENF-CD-ENF                              04840080
048500           PERFORM 3100-ENF                                       04850080
048600       WHEN TR241-REC-TYP-ENFBOL-CD-ENFBOL                        04860080
048700           PERFORM 3200-ENFBOL                                    04870080
048800       WHEN TR241-REC-TYP-ENFCON-CD-ENFCON                        04880080
048900           PERFORM 3300-ENFCON                                    04890080
049000       WHEN TR241-REC-TYP-ENFPO-CDE-ENFPO                         04900080
049100           PERFORM 3400-ENFPO                                     04910080
049200       WHEN TR241-REC-TYP-DOP-CD-DOP                              04920080
049300           PERFORM 3450-DOP                                       04930080
049400       WHEN TR241-REC-TYP-EXD-CDE-EXD                             04940080
049500           PERFORM 3500-EXD                                       04950080
049600       WHEN TR241-REC-TYP-REJ-CDE-REJ                             04960080
049700           PERFORM 3600-REJ                                       04970080
049800       WHEN TR241-REC-TYP-ECR-CDE-ECR                             04980080
049900           PERFORM 3700-ECR                                       04990080
050000       WHEN TR241-REC-TYP-RLS-CDE-RLS                             05000080
050100           PERFORM 3800-RLS                                       05010080
050200       WHEN TR241-REC-TYP-LIQ-CDE-LIQ                             05020080
050300           PERFORM 3900-LIQ                                       05030080
050400       WHEN TR241-REC-TYP-LSU-CDE-LSU                             05040080
050500           PERFORM 3950-LSU                                       05050080
050600*      **********************************************             05060080
050700*      * FOR MLT RECORDS - JUST PRINT WARNING LINE. *             05070080
050800*      **********************************************             05080080
050900       WHEN TR241-REC-TYP-MLT-CDE-MLT                             05090080
051000           CONTINUE                                               05100080
051100     END-EVALUATE.                                                05110080
051200                                                                  05120080
051300     IF TR241-REC-TYP-HDR-CDE-HDR                                 05130080
051400         CONTINUE                                                 05140080
051500     ELSE                                                         05150080
051600         IF PV-LINES-USED >= PC-PAGE-SIZE-054                     05160080
051601            PERFORM 8000-WRITE-HEADINGS                           05160187
051602            PERFORM 8010-WRITE-ENTRY-ID-HEADINGS                  05160287
051610            IF TR241-ERROR-TYPE = 'ERR'                           05161091
051611               PERFORM 8000A-WRITE-HEADINGS                       05161187
051612               PERFORM 8010A-WRITE-ENTRY-ID-HEADINGS              05161287
051810            END-IF                                                05181085
051900         END-IF                                                   05190080
052000*        **********************************************           05200080
052100*        * FOR MLT RECORDS - JUST PRINT WARNING LINE. *           05210080
052200*        **********************************************           05220080
052300         IF TR241-REC-TYP-MLT-CDE-MLT                             05230080
052400            PERFORM 8070-WRITE-WRN-ONLY                           05240087
052500         ELSE                                                     05250080
052510            PERFORM 8050-WRITE-DTL-HDRS                           05251087
052520            PERFORM 8060-WRITE-DTL-LINES                          05252087
052600            IF TR241-ERROR-TYPE = 'ERR'                           05260092
052610              PERFORM 8050A-WRITE-DTL-HDRS                        05261087
052620              PERFORM 8060A-WRITE-DTL-LINES                       05262087
053100            END-IF                                                05310080
053200         END-IF                                                   05320080
053300     END-IF.                                                      05330080
053400                                                                  05340080
053500     PERFORM 7000-READ-ERROR-FILE.                                05350080
053600/                                                                 05360080
053700 3000-FORMAT-HEADINGS.                                            05370080
053800                                                                  05380080
053900     MOVE TR241-HDR-CONSOL-TRNS-DTE (5:2)                         05390080
054000                                      TO HL-TRANS-MM              05400095
054010                                         HL-TRANS-MM-EM.          05401095
054100     MOVE TR241-HDR-CONSOL-TRNS-DTE (7:2)                         05410080
054200                                      TO HL-TRANS-DD              05420095
054210                                         HL-TRANS-DD-EM.          05421095
054300     MOVE TR241-HDR-CONSOL-TRNS-DTE (3:2)                         05430080
054400                                      TO HL-TRANS-YY              05440095
054410                                         HL-TRANS-YY-EM.          05441095
054500     MOVE TR241-HDR-CONSOL-TRNS-TM (1:2)                          05450080
054600                                      TO HL-TRANS-TIME-HH         05460095
054610                                         HL-TRANS-TIME-HH-EM.     05461095
054700     MOVE TR241-HDR-CONSOL-TRNS-TM (3:2)                          05470080
054800                                      TO HL-TRANS-TIME-MM         05480096
054810                                         HL-TRANS-TIME-MM-EM.     05481095
054900                                                                  05490080
055000     MOVE TR241-HDR-CONSOL-FIL-ID     TO HL1-FILE-ID              05500095
055100                                         HL1-FILE-ID-EM.          05510095
055110                                                                  05511095
055200     MOVE TR241-HDR-LOAD-DTE (5:2)    TO HL-LOAD-MM.              05520080
055300     MOVE TR241-HDR-LOAD-DTE (7:2)    TO HL-LOAD-DD.              05530080
055400     MOVE TR241-HDR-LOAD-DTE (3:2)    TO HL-LOAD-YY.              05540080
055500     MOVE TR241-HDR-LOAD-TM (1:2)     TO HL-LOAD-TIME-HH.         05550080
055600     MOVE TR241-HDR-LOAD-TM (3:2)     TO HL-LOAD-TIME-MM.         05560080
055700                                                                  05570080
055800     MOVE TR241-HDR-CONSOL-ENTNME     TO HL2-EXPEDITOR.           05580080
055900     SET PS-DETAIL-LINES-PRESENT-NO   TO TRUE.                    05590080
056000                                                                  05600080
056100/                                                                 05610080
056200 3100-ENF.                                                        05620080
056300                                                                  05630080
056400     MOVE DL-ENF-HDR                  TO DL2-DETAIL-LIT           05640080
056500     MOVE TR241-ENF-FILD-DTE          TO PV-WORK-DATE             05650080
056600     MOVE TR241-ENF-FILD-TM           TO PV-WORK-TIME             05660080
056700     PERFORM 4000-FORMAT-DATE-TIME.                               05670080
056800     MOVE PV-DISP-DATE                TO DL-ENF-DATE              05680080
056900     MOVE PV-DISP-TIME                TO DL-ENF-TIME              05690080
057000     MOVE DL-ENF-LINE                 TO DL1-TEXT                 05700099
057100                                         DL1-TEXT-EM.             05710099
057200 3200-ENFBOL.                                                     05720080
057300                                                                  05730080
057400     MOVE DL-ENFBOL-HDR               TO DL2-DETAIL-LIT           05740080
057500     MOVE TR241-ENFBOL-MSTR-BOL-NBR   TO DL-ENFBOL-MASTER-BOL.    05750080
057600     MOVE TR241-ENFBOL-HSE-BOL-NBR    TO DL-ENFBOL-HOUSE-BOL.     05760080
057700     MOVE TR241-ENFBOL-CARR-SCAC-ID   TO DL-ENFBOL-CARR-SCAC-ID.  05770080
057800     MOVE DL-ENFBOL-LINE              TO DL1-TEXT                 05780099
057900                                         DL1-TEXT-EM.             05790099
058000 3300-ENFCON.                                                     05800080
058100     MOVE DL-ENFCON-HDR               TO DL2-DETAIL-LIT           05810080
058200     MOVE TR241-ENFCON-CONTNR-ID      TO DL-ENFCON-CONTAINER      05820080
058300     MOVE DL-ENFCON-LINE              TO DL1-TEXT                 05830099
058400                                         DL1-TEXT-EM.             05840099
058500 3400-ENFPO.                                                      05850080
058600                                                                  05860080
058700     MOVE DL-ENFPO-HDR                TO DL2-DETAIL-LIT           05870080
058800     MOVE TR241-ENFPO-PO-NBR          TO DL-ENFPO-PO              05880080
058900     MOVE TR241-ENFPO-EXTL-REF-NBR    TO DL-ENFPO-EXTL-REF-NBR    05890080
059000     MOVE TR241-ENFPO-FOB-CDE         TO DL-ENFPO-FOB-CDE         05900080
059100     MOVE DL-ENFPO-LINE               TO DL1-TEXT                 05910099
059200                                         DL1-TEXT-EM.             05920099
059300 3450-DOP.                                                        05930080
059400                                                                  05940080
059500     MOVE DL-DOP-HDR                  TO DL2-DETAIL-LIT.          05950080
059600     MOVE TR241-DOP-CONTNR-ID         TO DL-DOP-CONTAINER.        05960080
059700     MOVE TR241-DOP-DELY-SNT-DTE      TO PV-WORK-DATE.            05970080
059800     MOVE TR241-DOP-DELY-SNT-TM       TO PV-WORK-TIME.            05980080
059900     PERFORM 4000-FORMAT-DATE-TIME.                               05990080
060000     MOVE PV-DISP-DATE                TO DL-DOP-DELY-SNT-DTE.     06000080
060100     MOVE PV-DISP-TIME                TO DL-DOP-DELY-SNT-TM.      06010080
060200     MOVE DL-DOP-LINE                 TO DL1-TEXT                 06020099
060300                                         DL1-TEXT-EM.             06030099
060400                                                                  06040080
060500 3500-EXD.                                                        06050080
060600                                                                  06060080
060700     MOVE DL-EXD-HDR                  TO DL2-DETAIL-LIT           06070080
060800     MOVE TR241-EXD-EXM-DTE           TO PV-WORK-DATE             06080080
060900     MOVE TR241-EXD-EXM-TM            TO PV-WORK-TIME             06090080
061000     PERFORM 4000-FORMAT-DATE-TIME.                               06100080
061100     MOVE PV-DISP-DATE                TO DL-EXD-DATE              06110080
061200     MOVE PV-DISP-TIME                TO DL-EXD-TIME              06120080
061300     MOVE DL-EXD-LINE                 TO DL1-TEXT                 06130099
061400                                         DL1-TEXT-EM.             06140099
061500 3600-REJ.                                                        06150080
061600                                                                  06160080
061700     MOVE DL-REJ-HDR                  TO DL2-DETAIL-LIT.          06170080
061800     MOVE TR241-REJ-REJ-DTE           TO PV-WORK-DATE.            06180080
061900     MOVE TR241-REJ-REJ-TM            TO PV-WORK-TIME.            06190080
062000     PERFORM 4000-FORMAT-DATE-TIME.                               06200080
062100     MOVE PV-DISP-DATE                TO DL-REJ-DATE.             06210080
062200     MOVE PV-DISP-TIME                TO DL-REJ-TIME.             06220080
062300     MOVE TR241-REJ-REJ-DESC          TO DL-REJ-DESC.             06230080
062400     MOVE DL-REJ-LINE                 TO DL1-TEXT                 06240099
062500                                         DL1-TEXT-EM.             06250099
062600 3700-ECR.                                                        06260080
062700                                                                  06270080
062800     MOVE DL-ECR-HDR                  TO DL2-DETAIL-LIT           06280080
062900     MOVE TR241-ECR-EST-CLR-DTE       TO PV-WORK-DATE             06290080
063000     MOVE TR241-ECR-EST-CLR-TM        TO PV-WORK-TIME             06300080
063100     PERFORM 4000-FORMAT-DATE-TIME.                               06310080
063200     MOVE PV-DISP-DATE                TO DL-ECR-DATE              06320080
063300     MOVE PV-DISP-TIME                TO DL-ECR-TIME              06330080
063400     MOVE DL-ECR-LINE                 TO DL1-TEXT                 06340099
063500                                         DL1-TEXT-EM.             06350099
063600 3800-RLS.                                                        06360080
063700                                                                  06370080
063800     MOVE DL-RLS-HDR                  TO DL2-DETAIL-LIT           06380080
063900     MOVE TR241-RLS-ACTL-CLR-DTE      TO PV-WORK-DATE             06390080
064000     MOVE TR241-RLS-ACTL-CLR-TM       TO PV-WORK-TIME             06400080
064100     PERFORM 4000-FORMAT-DATE-TIME.                               06410080
064200     MOVE PV-DISP-DATE                TO DL-RLS-DATE              06420080
064300     MOVE PV-DISP-TIME                TO DL-RLS-TIME              06430080
064400     MOVE DL-RLS-LINE                 TO DL1-TEXT                 06440099
064500                                         DL1-TEXT-EM.             06450099
064600 3900-LIQ.                                                        06460080
064700                                                                  06470080
064800     MOVE DL-LIQ-HDR                  TO DL2-DETAIL-LIT           06480080
064900     MOVE TR241-LIQ-LQDN-DTE          TO PV-WORK-DATE             06490080
065000     MOVE TR241-LIQ-LQDN-TM           TO PV-WORK-TIME             06500080
065100     PERFORM 4000-FORMAT-DATE-TIME.                               06510080
065200     MOVE PV-DISP-DATE                TO DL-LIQ-DATE              06520080
065300     MOVE PV-DISP-TIME                TO DL-LIQ-TIME              06530080
065400     MOVE DL-LIQ-LINE                 TO DL1-TEXT                 06540099
065500                                         DL1-TEXT-EM.             06550099
065600 3950-LSU.                                                        06560080
065700                                                                  06570080
065800     MOVE DL-LSU-HDR                  TO DL2-DETAIL-LIT           06580080
065900     MOVE TR241-LSU-LQDN-SSPNN-DTE    TO PV-WORK-DATE             06590080
066000     MOVE TR241-LSU-LQDN-SSPNN-TM     TO PV-WORK-TIME             06600080
066100     PERFORM 4000-FORMAT-DATE-TIME.                               06610080
066200     MOVE PV-DISP-DATE                TO DL-LSU-DATE              06620080
066300     MOVE PV-DISP-TIME                TO DL-LSU-TIME              06630080
066400     MOVE TR241-LSU-LQDN-SSPNN-DESC   TO DL-LSU-DESC              06640080
066500     MOVE DL-LSU-LINE                 TO DL1-TEXT                 06650099
066600                                         DL1-TEXT-EM.             06660099
066700                                                                  06670080
066800 4000-FORMAT-DATE-TIME.                                           06680080
066900                                                                  06690080
067000     IF PV-WORK-DATE = PV-DEFAULT-DATE OR SPACES                  06700080
067100       MOVE SPACES                     TO PV-DISP-DATE            06710080
067200     ELSE                                                         06720080
067300       MOVE PV-EDIT-DATE                TO PV-DISP-DATE           06730080
067400       MOVE PV-WORK-YY                  TO PV-DISP-YY             06740080
067500       MOVE PV-WORK-MM                  TO PV-DISP-MM             06750080
067600       MOVE PV-WORK-DD                  TO PV-DISP-DD             06760080
067700     END-IF.                                                      06770080
067800                                                                  06780080
067900     IF PV-WORK-TIME = PV-DEFAULT-TIME OR SPACES OR               06790080
068000        PV-WORK-DATE = PV-DEFAULT-DATE OR SPACES                  06800080
068100       MOVE SPACES                     TO PV-DISP-TIME            06810080
068200     ELSE                                                         06820080
068300       MOVE PV-EDIT-TIME                TO PV-DISP-TIME           06830080
068400       MOVE PV-WORK-HOUR                TO PV-DISP-HOUR           06840080
068500       MOVE PV-WORK-MINUTE              TO PV-DISP-MINUTE         06850080
068600     END-IF.                                                      06860080
068700/                                                                 06870080
068800 7000-READ-ERROR-FILE.                                            06880080
068900                                                                  06890080
069000     READ ERROR-FILE                                              06900080
069100        INTO TR241-RECORD                                         06910080
069200           AT END                                                 06920080
069300              SET PS-EOF-ERROR-FILE TO TRUE                       06930080
069400     END-READ.                                                    06940080
069500/                                                                 06950080
069600 8000-WRITE-HEADINGS.                                             06960080
069700     DISPLAY '8000-WRITE-HEADINGS'                                06970080
069800     ADD 1                TO PV-PAGE-COUNT.                       06980080
069900     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  06990080
070000                                                                  07000080
070100     WRITE ERROR-REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS07010080
070200        AFTER ADVANCING PAGE.                                     07020080
070300                                                                  07030080
070400     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       07040080
070500                                                                  07050080
070600     WRITE ERROR-REPORT-RECORD FROM HL1-HEADING-LINE-1            07060080
070700        AFTER ADVANCING 1 LINE.                                   07070080
070800                                                                  07080080
070900     WRITE ERROR-REPORT-RECORD FROM HL2-HEADING-LINE-2            07090080
071000        AFTER ADVANCING 1 LINE.                                   07100080
071100                                                                  07110080
071200     WRITE ERROR-REPORT-RECORD FROM HL3-HEADING-LINE-3            07120080
071300        AFTER ADVANCING 2 LINES.                                  07130080
071400                                                                  07140080
071410 8000A-WRITE-HEADINGS.                                            07141087
071420     DISPLAY '8000-WRITE-HEADINGS'                                07142087
071430     ADD 1                TO PV-PAGE-COUNT-2.                     07143093
071440*    MOVE PV-PAGE-COUNT-2 TO DP132O-PAGE-NUMBER.                  07144099
071450                                                                  07145087
071460*    WRITE ERR-ONLY-REPORT-REC FROM DP132O-STANDRD-HEADER-132-COLS07146095
071470*       AFTER ADVANCING PAGE.                                     07147095
071480                                                                  07148087
071490     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       07149087
071491                                                                  07149187
071492     WRITE ERR-ONLY-REPORT-REC FROM HL1-HEADING-EMAIL-1           07149295
071493*       AFTER ADVANCING 1 LINE.                                   07149399
071494                                                                  07149487
071495     WRITE ERR-ONLY-REPORT-REC FROM HL2-HEADING-EMAIL-2.          07149599
071496*       AFTER ADVANCING 1 LINE.                                   07149699
071497                                                                  07149787
071499*    WRITE ERR-ONLY-REPORT-REC FROM HL3-HEADING-EMAIL-3           07149999
071500*       AFTER ADVANCING 2 LINES.                                  07150099
071501                                                                  07150187
071510 8010-WRITE-ENTRY-ID-HEADINGS.                                    07151087
071600                                                                  07160080
071700     WRITE ERROR-REPORT-RECORD FROM HL3-HEADING-EMAIL-3           07170099
071800        AFTER ADVANCING 1 LINE.                                   07180080
071900                                                                  07190080
072000     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07200080
072100                                                                  07210080
072110 8010A-WRITE-ENTRY-ID-HEADINGS.                                   07211087
072120                                                                  07212087
072130     WRITE ERR-ONLY-REPORT-REC FROM HL3-HEADING-EMAIL-3           07213099
072140        AFTER ADVANCING 1 LINE.                                   07214087
072150                                                                  07215087
072160     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07216087
072170                                                                  07217087
072200 8050-WRITE-DTL-HDRS.                                             07220080
072300                                                                  07230080
072400     WRITE ERROR-REPORT-RECORD FROM DL-COMMON-HEADING-1           07240080
072500                 AFTER ADVANCING 2 LINES                          07250080
072600     WRITE ERROR-REPORT-RECORD FROM DL-COMMON-HEADING-2           07260080
072700                 AFTER ADVANCING 1 LINE.                          07270080
072800     ADD 4                            TO PV-LINES-USED.           07280080
072900                                                                  07290080
072910 8050A-WRITE-DTL-HDRS.                                            07291087
072920                                                                  07292087
072930     WRITE ERR-ONLY-REPORT-REC FROM DL-COMMON-HEADING-1           07293087
072940                 AFTER ADVANCING 1 LINES                          07294099
072950     WRITE ERR-ONLY-REPORT-REC FROM DL-COMMON-HEADING-2           07295087
072960                 AFTER ADVANCING 1 LINE.                          07296087
072970     ADD 4                            TO PV-LINES-USED.           07297087
072980                                                                  07298087
073000 8060-WRITE-DTL-LINES.                                            07300080
073100                                                                  07310080
073200     SET PS-DETAIL-LINES-PRESENT-YES TO TRUE.                     07320080
073300                                                                  07330080
073400     MOVE TR241-REC-TYP-HDR-CDE       TO DL1-REC-TYPE             07340080
073500     MOVE TR241-TRN-TYP               TO DL1-TRN-TYPE             07350080
073600     MOVE TR241-POE-STD-EDI-CDE       TO DL1-POE-CODE.            07360080
073700     MOVE SPACES                      TO DLE-REC-TYPE.            07370080
073800     MOVE TR241-DATA-IN-ERROR         TO DLE-DATA-IN-ERROR        07380080
073900     MOVE TR241-DATA-VALUE            TO DLE-DATA-VALUE           07390080
074000     MOVE TR241-ERROR-TYPE            TO DLE-TYPE                 07400080
074100     MOVE TR241-ERROR-MSG             TO DLE-MESSAGE.             07410099
074200                                                                  07420080
074300     WRITE ERROR-REPORT-RECORD FROM DL-DETAIL-LINE-1              07430080
074400                 AFTER ADVANCING 1 LINES.                         07440080
074500     WRITE ERROR-REPORT-RECORD FROM DL-HEADING-DATA-IN-ERROR      07450080
074600                 AFTER ADVANCING 2 LINES.                         07460080
074700     WRITE ERROR-REPORT-RECORD FROM DLE-DATA-IN-ERROR-LINE        07470080
074800                 AFTER ADVANCING 1 LINES.                         07480080
074900     ADD 2                            TO PV-LINES-USED.           07490080
075000                                                                  07500080
075010 8060A-WRITE-DTL-LINES.                                           07501087
075020                                                                  07502087
075030     SET PS-DETAIL-LINES-PRESENT-YES TO TRUE.                     07503087
075040                                                                  07504087
075050     MOVE TR241-REC-TYP-HDR-CDE       TO DL1-REC-TYPE-EM          07505099
075060     MOVE TR241-TRN-TYP               TO DL1-TRN-TYPE-EM          07506099
075070     MOVE TR241-POE-STD-EDI-CDE       TO DL1-POE-CODE-EM          07507099
075080     MOVE SPACES                      TO DLE-REC-TYPE             07508099
075090     MOVE TR241-DATA-IN-ERROR         TO DLE-DATA-IN-ERROR-EM     07509099
075091     MOVE TR241-DATA-VALUE            TO DLE-DATA-VALUE-EM        07509199
075092     MOVE TR241-ERROR-TYPE            TO DLE-TYPE-EM              07509299
075093     MOVE TR241-ERROR-MSG             TO DLE-MESSAGE-EM.          07509399
075094                                                                  07509487
075095     WRITE ERR-ONLY-REPORT-REC FROM DL-DETAIL-LINE-1-EM           07509599
075096*                AFTER ADVANCING 1 LINES.                         07509699
075097     WRITE ERR-ONLY-REPORT-REC FROM DL-HEADING-DATA-IN-ERR-EM     07509798
075099*                AFTER ADVANCING 1 LINES.                         07509999
075100     WRITE ERR-ONLY-REPORT-REC FROM DLE-DATA-IN-ERR-LINE-EM       07510098
075101*                AFTER ADVANCING 1 LINES.                         07510199
075102     WRITE ERR-ONLY-REPORT-REC FROM DLE-DATA-IN-ERR-MESS-EM       07510299
075103*                AFTER ADVANCING 1 LINES.                         07510399
075104     WRITE ERR-ONLY-REPORT-REC FROM PV-BLANK-LINE-80.             07510499
075105*                AFTER ADVANCING 1 LINES.                         07510599
075106     ADD 2                            TO PV-LINES-USED.           07510699
075107                                                                  07510799
075110**********************************************                    07511087
075200* FOR MLT RECORDS - JUST PRINT WARNING LINE. *                    07520080
075300**********************************************                    07530080
075400 8070-WRITE-WRN-ONLY.                                             07540080
075500                                                                  07550080
075600     SET PS-DETAIL-LINES-PRESENT-YES TO TRUE.                     07560080
075700                                                                  07570080
075800     MOVE TR241-REC-TYP-HDR-CDE       TO DL1-REC-TYPE.            07580080
075900     MOVE TR241-DATA-IN-ERROR         TO DLE-DATA-IN-ERROR.       07590080
076000     MOVE TR241-DATA-VALUE            TO DLE-DATA-VALUE.          07600080
076100     MOVE TR241-ERROR-TYPE            TO DLE-TYPE.                07610080
076200     MOVE TR241-ERROR-MSG             TO DLE-MESSAGE.             07620080
076300     MOVE SPACES                      TO DLE-REC-TYPE.            07630080
076400                                                                  07640080
076500     IF TR241-MLT-WRN-TYP-ENTRID                                  07650080
076600        MOVE '***'                    TO DLE-REC-TYPE             07660080
076700        IF DLE-DATA-IN-ERROR = '***            '                  07670080
076800          WRITE ERROR-REPORT-RECORD FROM DLE-DATA-IN-ERROR-LINE   07680080
076900              AFTER ADVANCING 1 LINES                             07690080
077000          ADD 1                          TO PV-LINES-USED         07700080
077100        ELSE                                                      07710080
077200          WRITE ERROR-REPORT-RECORD FROM DLE-DATA-IN-ERROR-LINE   07720080
077300                 AFTER ADVANCING 4 LINES                          07730080
077400          ADD 4                          TO PV-LINES-USED         07740080
077500        END-IF                                                    07750080
077600     ELSE                                                         07760080
077700        WRITE ERROR-REPORT-RECORD FROM DLE-DATA-IN-ERROR-LINE     07770080
077800                 AFTER ADVANCING 1 LINES                          07780080
077900        ADD 1                            TO PV-LINES-USED         07790080
078000     END-IF.                                                      07800080
078100                                                                  07810080
078200 9000-EOJ-ROUTINE.                                                07820080
078300                                                                  07830080
078400     IF PV-LINES-USED > PC-PAGE-SIZE-060                          07840080
078500         PERFORM 8000-WRITE-HEADINGS                              07850080
078510         PERFORM 8000A-WRITE-HEADINGS                             07851087
078600     END-IF                                                       07860080
078700                                                                  07870080
078800     WRITE ERROR-REPORT-RECORD FROM ER-END-OF-REPORT-LINE         07880080
078900            AFTER ADVANCING 2 LINES                               07890080
079000                                                                  07900080
079100     CLOSE ERROR-FILE                                             07910080
079200           ERROR-REPORT-FILE                                      07920086
079300           ERRORS-ONLY-REPORT-FILE.                               07930086
