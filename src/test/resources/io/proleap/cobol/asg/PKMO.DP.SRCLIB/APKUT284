000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT284.                                        00020000
000300 AUTHOR.         NANCY EILBES.                                    00030000
000400 DATE-WRITTEN.   MAY 2022.                                        00040002
000500 DATE-COMPILED.                                                   00050000
000600******************************************************************00060000
000700*    COBOL 2                                                     *00070000
000800*     REFORMATS APRD042 RECORD TO TEXT FORMAT                    *00080000
000900*                                                                *00090000
001000* INPUT:                                                         *00100000
001100*  1. UNJOURNALIZED RECEIPT EXTRACT     COPYBOOK APRD042         *00110000
001200*                                                                *00120000
001300* OUTPUT:                                                        *00130000
001400*  1. TEXT FILE                                                  *00140000
001500*                                                                *00150000
001510*----------------------------------------------------------------*00151000
001520* CHANGE LOG:                                                    *00152000
001530* DATE  05/09/2022                                               *00153001
001540*     CHANGE MADE: INITIAL IMPLEMENTATION.                       *00154000
001550*     MADE BY: NANCY EILBES            WR/IR #: CHG0269842       *00155001
001600******************************************************************00160000
001700   EJECT                                                          00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250000
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  IN-FILE                                                      00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     DATA RECORD IS UNJRNL-IN-REC.                                00350000
003600 01  IN-REC.                                                      00360000
003700     05  FILLER                       PIC  X(120).                00370000
003800                                                                  00380000
003900 FD  OUT-FILE                                                     00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     DATA RECORD IS UNJRNL-OUT-REC.                               00430000
004400 01  OUT-REC.                                                     00440000
004500     05  FILLER                       PIC  X(120).                00450000
004600                                                                  00460000
004700 EJECT                                                            00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500000
005100     88  IN-EOF                                 VALUE 'Y'.        00510000
005200 01  TEXT-RECORD.                                                 00520000
005630     05  OUT-PO-NBR                   PIC X(09).                  00563000
005631     05  FILLER4                      PIC X     VALUE SPACES.     00563100
005633     05  FILLER5                      PIC X     VALUE SPACES.     00563300
005634     05  OUT-CALCD-VRFD-COST-AMT      PIC -----------.99.         00563400
005637     05  FILLER7                      PIC X     VALUE SPACES.     00563700
005640     05  OUT-PO-TYP-CDE               PIC X(2).                   00564000
005650     05  FILLER9                      PIC X     VALUE SPACES.     00565000
005670     05  FILLER                       PIC X(2)  VALUE SPACES.     00567000
005680                                                                  00568000
005690     COPY APRD042.                                                00569000
005700                                                                  00570000
005800 EJECT                                                            00580000
005900 PROCEDURE DIVISION.                                              00590000
006000 A100-MAIN.                                                       00600000
006100                                                                  00610000
006200     PERFORM B100-INITIALIZE.                                     00620000
006300                                                                  00630000
006400     PERFORM B200-PROCESS                                         00640000
006500         UNTIL IN-EOF.                                            00650000
006600                                                                  00660000
006700     GOBACK.                                                      00670000
006800 EJECT                                                            00680000
006900*----------------------------------------------------------------*00690000
007000*    INITIALIZATION PROCESSING                                   *00700000
007100*    CALLED FROM A100-MAIN                                       *00710000
007200*----------------------------------------------------------------*00720000
007300 B100-INITIALIZE.                                                 00730000
007400                                                                  00740000
007500     OPEN INPUT  IN-FILE                                          00750000
007600          OUTPUT OUT-FILE.                                        00760000
007700                                                                  00770000
007800     PERFORM R100-READ-INPUT.                                     00780000
007900                                                                  00790000
008000 B200-PROCESS.                                                    00800000
008100                                                                  00810000
008500     MOVE AP042-PO-NBR              TO OUT-PO-NBR.                00850000
008600     MOVE AP042-CALCD-VRFD-COST-AMT TO OUT-CALCD-VRFD-COST-AMT.   00860000
009000     MOVE AP042-PO-TYP-CDE          TO OUT-PO-TYP-CDE.            00900000
009900     PERFORM W100-WRITE-OUTPUT.                                   00990000
010000                                                                  01000000
010100     PERFORM R100-READ-INPUT.                                     01010000
010200                                                                  01020000
010300 R100-READ-INPUT.                                                 01030000
010400                                                                  01040000
010500                                                                  01050000
010600     READ IN-FILE INTO AP042-EXTRACT-FILE                         01060000
010700         AT END SET IN-EOF TO TRUE.                               01070000
010800                                                                  01080000
010900                                                                  01090000
011000 W100-WRITE-OUTPUT.                                               01100000
011100                                                                  01110000
011200     WRITE OUT-REC FROM TEXT-RECORD.                              01120000
011300                                                                  01130000
