000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.   TRKUP255.                                                  
000600 AUTHOR.       MARGARET MORRISON.                                         
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                                   
000800 DATE-WRITTEN. AUGUST 1998.                                               
000900 DATE-COMPILED.                                                           
001000                                                                          
001100******************************************************************        
001200*  THIS PROGRAM UPDATES THE CONTAINER MANIFEST TABLE (TIMCNTK)   *        
001300*  WITH VESSEL/VOYAGE DELIVERY DATA THAT HAS BEEN EDITED BY      *        
001400*  PROGRAM TRKUT250.  THE PROGRAM ALSO CREATES A DB2 WORK TABLE  *        
001500*  THAT CONTAINS ERROR AND DETAIL RECORDS THAT WILL BE PASSED TO *        
001600*  THE DETAIL AND ERROR REPORT PROGRAMS.                         *        
001700******************************************************************        
002400******************************************************************        
002401*  11/05/2003 TKMA643 - VISWA KARUTURI                           *        
002402*     REMOVED LOGIC THAT PERTAINS TO COLUMNS FRGT_CHRG_AMT,      *        
002403*     CONSLR_CHRG_AMT,EXTL_REF_NBR AND ADDED DOC_RCVD_ORGN_TMST, *        
002404*     MOM_FOB_CDE, FDR_FOB_CDE, MOM_POR_CDE AND FDR_POR_CDE.     *        
      * ****************************************************************        
      * CHANGE DESCRIPTION                                                      
      * ****************************************************************        
      * DATE  07/01/2010                                                        
      *  CHANGE MADE: ADDED THE NEW RECORD TYPE 'ARVDCN' WHICH WOULD            
      *  CONTAIN INFORMATION PERTAINING TO THE ARRIVAL OF CONTAINERS AT         
      *  THE DECONSOLIDATOR. THIS IS BEING DONE AS PART OF THE IMPORT           
      *  REPLENISHMENT PROJECT 2010.                                            
      * MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                          
      * CHANGES TAGGED AS MS 07/01/2010                                         
002405******************************************************************        
002406******************************************************************        
002407 ENVIRONMENT DIVISION.                                                    
002408******************************************************************        
002409                                                                          
002410 CONFIGURATION SECTION.                                                   
002411                                                                          
002412 SOURCE-COMPUTER.        IBM-3090.                                        
002500 OBJECT-COMPUTER.        IBM-3090.                                        
002600                                                                          
002700 INPUT-OUTPUT SECTION.                                                    
002800                                                                          
002900 FILE-CONTROL.                                                            
003000                                                                          
003100     SELECT TR028-DELIVERY-FILE                                           
003200         ASSIGN TO INP01.                                                 
003300                                                                          
003400******************************************************************        
003500 DATA DIVISION.                                                           
003600******************************************************************        
003700                                                                          
003800 FILE SECTION.                                                            
003900                                                                          
004000 FD  TR028-DELIVERY-FILE                                                  
004100     RECORDING MODE IS F                                                  
004200     LABEL RECORDS ARE STANDARD                                           
004300     BLOCK CONTAINS 0 RECORDS.                                            
004400                                                                          
004500 01  TR028-DELIVERY-RECORD           PIC X(300).                          
004600                                                                          
004700******************************************************************        
004800 WORKING-STORAGE SECTION.                                                 
004900******************************************************************        
005000                                                                          
005100******************************************************************        
005200*  DB2 FORMATTED MESSAGE AREA                                             
005300******************************************************************        
005400     COPY DPWS004.                                                        
005500                                                                          
005600******************************************************************        
005700*  COMMUNICATIONS AREA FOR DB2                                            
005800******************************************************************        
005900     EXEC SQL                                                             
006000          INCLUDE SQLCA                                                   
006100     END-EXEC.                                                            
006200                                                                          
006300******************************************************************        
006400*  DB2 TABLE DECLARATION - IMPORT CONTAINER MANIFEST TABLE.               
006500*      (TIMCNTK)                                                          
006600******************************************************************        
006700     EXEC SQL                                                             
006800          INCLUDE TIMCNTK                                                 
006900     END-EXEC.                                                            
007000                                                                          
007100******************************************************************        
007200*  DB2 TABLE DECLARATION - IMPORT CONTAINER MANIFEST AUDIT TABLE.         
007300*      (TAUCNTK)                                                          
007400******************************************************************        
007500     EXEC SQL                                                             
007600          INCLUDE TAUCNTK                                                 
007700     END-EXEC.                                                            
007800                                                                          
007900******************************************************************        
008000*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO TABLE.                     
008100*      (TIMCNPO)                                                          
008200******************************************************************        
008300     EXEC SQL                                                             
008400          INCLUDE TIMCNPO                                                 
008500     END-EXEC.                                                            
008600                                                                          
008700******************************************************************        
008800*  DB2 TABLE DECLARATION - IMPORT CONTAINER PO AUDIT TABLE.               
008900*      (TAUCNPO)                                                          
009000******************************************************************        
009100     EXEC SQL                                                             
009200          INCLUDE TAUCNPO                                                 
009300     END-EXEC.                                                            
009400                                                                          
009500******************************************************************        
009600*  DB2 TABLE DECLARATION - DETAIL AND ERROR REPORT WORK TABLE.            
009700*      (TOUTTR9)                                                          
009800******************************************************************        
009900     EXEC SQL                                                             
010000          INCLUDE TOUTTR9                                                 
010100     END-EXEC.                                                            
010200                                                                          
010300******************************************************************        
010400*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)        
010500*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
010600*  INTERVALS.                                                             
010700******************************************************************        
010800     EXEC SQL                                                             
010900         INCLUDE TCKRSTCN                                                 
011000     END-EXEC.                                                            
011100                                                                          
011200******************************************************************        
011300*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF)         
011400*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
011500*  INTERVALS.                                                             
011600******************************************************************        
011700     EXEC SQL                                                             
011800         INCLUDE TCKRSTIN                                                 
011900     END-EXEC.                                                            
012000                                                                          
011700******************************************************************01120018
011800*  DB2 TABLE DECLARATION - MQ SERIES  WORK TABLE FOR SCM                18
011900*  TRTW_DELY_CKPR                                                 01140018
012000******************************************************************01160018
012100     EXEC SQL                                                     01170018
012200         INCLUDE TRT00041                                         01180018
012300     END-EXEC.                                                    01190018
012400                                                                  01200018
012100******************************************************************        
012200*   EDITED IMPORT VESSEL/VOYAGE DELIVERY DATA RECORD LAYOUT.              
012300******************************************************************        
012400     COPY TRRD028.                                                        
012500 EJECT                                                                    
012600                                                                          
012700******************************************************************        
012800*  VESSEL/VOYAGE DELIVERY DATA DETAIL/ERROR REPORT RECORD.       *        
012900*  USED TO FORMAT THE DETAIL/ERROR REPORT RECORDS.  LATER THIS   *        
013000*  TABLE IS DUMPED TO A FLAT FILE AND SORTED WITH THE DETAIL/    *        
013100*  ERROR FILE FROM THE EDIT PROGRAM.  THE SORTED FILE IS USED AS *        
013200*  INPUT TO THE ERROR AND DETAIL REPORT PROGRAMS WHICH CREATE AN *        
013300*  ERROR AND A DETAIL REPORT OF VESSEL/VOYAGE DELIVERY DATA.     *        
013400******************************************************************        
013500     COPY TRRD251.                                                        
013600 EJECT                                                                    
023500******************************************************************        
023600*    SUPPLY CHAIN MANAGEMENT MQ MESSAGE RECORD                            
023700******************************************************************        
023800     COPY TRRD405.                                                        
016300 EJECT                                                            01360018
013700                                                                          
013800 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
013900                                                   COMP SYNC.             
014000 01  PA-PROGRAM-ACCUMULATORS.                                             
014100     05  PA-TOTALS.                                                       
014200         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0               
014300                                                     COMP-3.              
014400         10 PA-TOT-EDI-RECS-READ      PIC  S9(13)  VALUE +0               
014500                                                     COMP-3.              
014600         10 PA-TOTAL-RECS-LOADED      PIC  S9(13)  VALUE +0               
014700                                                     COMP-3.              
014800         10 PA-TOT-DPU-RECS-READ      PIC  S9(13)  VALUE +0               
014900                                                     COMP-3.              
015000         10 PA-TOT-DLV-RECS-READ      PIC  S9(13)  VALUE +0               
015100                                                     COMP-3.              
      * MS 07/01/2010                                                           
               10 PA-TOT-ARVDCN-RECS-READ   PIC  S9(13)  VALUE +0               
                                                           COMP-3.              
015200         10 PA-TOT-DVN-RECS-READ      PIC  S9(13)  VALUE +0               
015300                                                     COMP-3.              
015400         10 PA-TOT-CRP-RECS-READ      PIC  S9(13)  VALUE +0               
015500                                                     COMP-3.              
015600         10 PA-TOT-RTN-RECS-READ      PIC  S9(13)  VALUE +0               
015700                                                     COMP-3.              
015800         10 PA-TOT-DPURD-RECS-READ    PIC  S9(13)  VALUE +0               
015900                                                     COMP-3.              
016000         10 PA-TOT-DLVRD-RECS-READ    PIC  S9(13)  VALUE +0               
016100                                                     COMP-3.              
      * MS 07/01/2010                                                           
               10 PA-TOT-ARVDRD-RECS-READ   PIC  S9(13)  VALUE +0               
                                                           COMP-3.              
016200         10 PA-TOT-DVNRD-RECS-READ    PIC  S9(13)  VALUE +0               
016300                                                     COMP-3.              
016400         10 PA-TOT-CRPRD-RECS-READ    PIC  S9(13)  VALUE +0               
016500                                                     COMP-3.              
016600         10 PA-TOT-RTNRD-RECS-READ    PIC  S9(13)  VALUE +0               
016700                                                     COMP-3.              
016800         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0               
016900                                                     COMP-3.              
017000         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0               
017100                                                     COMP-3.              
017200         10 PA-TOT-TRN-TYP-A          PIC  S9(13)  VALUE +0               
017300                                                     COMP-3.              
017400         10 PA-TOT-TRN-TYP-C          PIC  S9(13)  VALUE +0               
017500                                                     COMP-3.              
017600         10 PA-TOT-TRN-TYP-D          PIC  S9(13)  VALUE +0               
017700                                                     COMP-3.              
017800         10 PA-TOTAL-RECS-READ        PIC  S9(13)  VALUE +0               
017900                                                     COMP-3.              
018000         10 PA-TOT-RECS-INSERTED      PIC  S9(13)  VALUE +0               
018100                                                     COMP-3.              
018200         10 PA-TOT-RECS-AUDITED       PIC  S9(13)  VALUE +0               
018300                                                     COMP-3.              
018400         10 PA-TOT-CNTK-RECS-SELECT   PIC  S9(13)  VALUE +0               
018500                                                     COMP-3.              
018600         10 PA-TOT-ACNTK-INSERTS      PIC  S9(13)  VALUE +0               
018700                                                     COMP-3.              
018800         10 PA-TOT-ACNPO-INSERTS      PIC  S9(13)  VALUE +0               
018900                                                     COMP-3.              
019000         10 PA-TOT-CNTK-DELETES       PIC  S9(13)  VALUE +0               
019100                                                     COMP-3.              
019200         10 PA-TOT-RECS-UPDATED       PIC  S9(13)  VALUE +0               
019300                                                     COMP-3.              
019400         10 PA-TOT-CNTK-UPDATES       PIC  S9(13)  VALUE +0               
019500                                                     COMP-3.              
019600         10 PA-TOT-CNPO-UPDATES       PIC  S9(13)  VALUE +0               
019700                                                     COMP-3.              
019800                                                                          
019900 01  PS-PROGRAM-SWITCHES.                                                 
020000     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.           
020100         88  PS-END-OF-INPUT                         VALUE 'Y'.           
020200         88  PS-END-OF-INPUT-NO                      VALUE 'N'.           
020300     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.           
020400         88  NORMAL-RUN                              VALUE '0'.           
020500         88  RESTART-RUN                             VALUE '9'.           
020600     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.           
020700         88  COMMITS-TAKEN                           VALUE 'T'.           
020800         88  NO-COMMITS-TAKEN                        VALUE 'N'.           
020900     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.           
021000         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.           
021100         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.           
021200     05  PS-CNTK-FOUND-SW              PIC  X(01)    VALUE 'N'.           
021300         88  PS-CNTK-FOUND                           VALUE 'Y'.           
021400         88  PS-CNTK-FOUND-NO                        VALUE 'N'.           
021500     05 PS-EXTERNAL-REF-FOUND-SW       PIC  X(01)    VALUE 'N'.           
021600         88 PS-EXTERNAL-REF-FOUND                    VALUE 'Y'.           
021700         88 PS-EXTERNAL-REF-FOUND-NO                 VALUE 'N'.           
021800     05  PS-GOOD-CNTK-UPDATE-SW        PIC  X(01)    VALUE 'N'.           
021900         88  PS-GOOD-CNTK-UPDATE                     VALUE 'Y'.           
022000         88  PS-GOOD-CNTK-UPDATE-NO                  VALUE 'N'.           
022100     05  PS-GOOD-CNTK-INSERT-SW        PIC  X(01)    VALUE 'N'.           
022200         88  PS-GOOD-CNTK-INSERT                     VALUE 'Y'.           
022300         88  PS-GOOD-CNTK-INSERT-NO                  VALUE 'N'.           
022400     05  PS-GOOD-CNTK-DELETE-SW        PIC  X(01)    VALUE 'N'.           
022500         88  PS-GOOD-CNTK-DELETE                     VALUE 'Y'.           
022600         88  PS-GOOD-CNTK-DELETE-NO                  VALUE 'N'.           
022400     05  PS-ADD-ALREADY-DONE-SW        PIC  X(01)    VALUE 'N'.           
022500         88  PS-ADD-ALREADY-DONE-YES                 VALUE 'Y'.           
022600         88  PS-ADD-ALREADY-DONE-NO                  VALUE 'N'.           
022700     05  PS-NEW-CONTAINER-KEY-SW       PIC X(01)     VALUE 'N'.           
022800         88  PS-NEW-CONTAINER-KEY                    VALUE 'Y'.           
022900         88  PS-NEW-CONTAINER-KEY-NO                 VALUE 'N'.           
023000     05  PS-NEW-PO-KEY-SW              PIC X(01)     VALUE 'N'.           
023100         88  PS-NEW-PO-KEY                           VALUE 'Y'.           
023200         88  PS-NEW-PO-KEY-NO                        VALUE 'N'.           
023300     05  PS-GOOD-RECORD-SW             PIC X(01)     VALUE 'N'.           
023400         88  PS-GOOD-RECORD                          VALUE 'Y'.           
023500         88  PS-GOOD-RECORD-NO                       VALUE 'N'.           
023600     05 PS-VALID-POE-NAME-SW           PIC X(01)     VALUE 'N'.           
023700         88  PS-VALID-POE-NAME                       VALUE 'Y'.           
023800         88  PS-VALID-POE-NAME-NO                    VALUE 'N'.           
023900     05  PS-GOOD-CNPO-UPDATE-SW        PIC  X(01)    VALUE 'N'.           
024000         88  PS-GOOD-CNPO-UPDATE                     VALUE 'Y'.           
024100         88  PS-GOOD-CNPO-UPDATE-NO                  VALUE 'N'.           
024200                                                                          
024300 01  PC-PROGRAM-CONSTANTS.                                                
024400     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE                  
024500         'TRKUP255'.                                                      
024600     05  PC-10                       PIC X(02)     VALUE '10'.            
024700     05  PC-20                       PIC X(02)     VALUE '20'.            
024800     05  PC-30                       PIC X(02)     VALUE '30'.            
024900     05  PC-40                       PIC X(02)     VALUE '40'.            
025000     05  PC-50                       PIC X(02)     VALUE '50'.            
025100     05  PC-60                       PIC X(02)     VALUE '60'.            
025200     05  PC-70                       PIC X(02)     VALUE '70'.            
025300     05  PC-A                        PIC X(01)     VALUE 'A'.             
025400     05  PC-C                        PIC X(01)     VALUE 'C'.             
025500     05  PC-D                        PIC X(01)     VALUE 'D'.             
025600     05  PC-E                        PIC X(01)     VALUE 'E'.             
025700     05  PC-O                        PIC X(01)     VALUE 'O'.             
025800     05  PC-U                        PIC X(01)     VALUE 'U'.             
025900     05  PC-Y                        PIC X(01)     VALUE 'Y'.             
026000     05  PC-DPU                      PIC X(06)     VALUE 'DPU   '.        
026100     05  PC-DLV                      PIC X(06)     VALUE 'DLV   '.        
026200     05  PC-DVN                      PIC X(06)     VALUE 'DVN   '.        
026300     05  PC-CRP                      PIC X(06)     VALUE 'CRP   '.        
026400     05  PC-RTN                      PIC X(06)     VALUE 'RTN   '.        
026500     05  PC-DPURDD                   PIC X(06)     VALUE 'DPURDD'.        
026600     05  PC-DLVRDD                   PIC X(06)     VALUE 'DLVRDD'.        
026700     05  PC-DVNRDD                   PIC X(06)     VALUE 'DVNRDD'.        
026800     05  PC-CRPRDD                   PIC X(06)     VALUE 'CRPRDD'.        
026900     05  PC-RTNRDD                   PIC X(06)     VALUE 'RTNRDD'.        
      * MS 07/01/2010                                                           
           05  PC-ARVDCN                   PIC X(06)     VALUE 'ARVDCN'.        
           05  PC-ARVDRD                   PIC X(06)     VALUE 'ARVDRD'.        
027000     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.           
027100     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.           
027200     05  PC-DASH                     PIC X(01)     VALUE '-'.             
027300     05  PC-DECIMAL                  PIC X(01)     VALUE '.'.             
027400     05  PC-DEFAULT-TMST             PIC X(26)     VALUE                  
027500                                     '0001-01-01-00.00.00.000000'.        
027600     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5               
027700                                                     COMP-3.              
027800     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.             
027900     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.             
028000                                                                          
028100 01  PV-PROGRAM-VARIABLES.                                                
028200     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.          
028300                                                                          
028400     05 PV-PREV-KEY.                                                      
028500        10 PV-PREV-KEY-TRN-TYP          PIC X(01).                        
028600        10 PV-PREV-KEY-REC-TYP-CDE      PIC X(06).                        
028700        10 PV-PREV-KEY-SEQ-NBR          PIC X(02).                        
028800        10 PV-PREV-KEY-3RD-PARTY-CDE    PIC X(06).                        
028900        10 PV-PREV-KEY-CONTNR-ID        PIC X(12).                        
029000        10 PV-PREV-KEY-EXTL-REF-NBR     PIC X(15).                        
029100        10 PV-PREV-KEY-PO-NBR           PIC 9(09).                        
029200                                                                          
029300     05 PV-HLD-FOR-TIMCNTK-INSERT.                                        
029400        10 PV-HLD-CONTNR-ID             PIC X(12).                        
029500        10 PV-HLD-CONTNR-SEQ-NBR        PIC S9(4) COMP.                   
029700        10 PV-HLD-DO-RCVD-TMST          PIC X(26).                        
029800        10 PV-HLD-CONTNR-PU-TMST        PIC X(26).                        
029900        10 PV-HLD-DVN-TMST              PIC X(26).                        
030000        10 PV-HLD-BKR-FRGT-RLSE-TMST    PIC X(26).                        
030100        10 PV-HLD-RET-TMST              PIC X(26).                        
030200        10 PV-HLD-DCONSLR-SCAC-ID       PIC X(4).                         
030300        10 PV-HLD-PO-NBR                PIC S9(9) COMP.                   
029500        10 PV-HLD-ORGN-SHPD-FR-CDE      PIC X(3).                         
      * MS 07/01/2010                                                           
              10 PV-HLD-DCONSLR-ARR-TMST      PIC X(26).                        
030400                                                                          
030500     05 PV-HLD-FOR-TIMCNPO-UPDATE.                                        
030600        10 PV-HLD-DO-RCVD-CDE           PIC X(01).                        
030700        10 PV-HLD-CONTNR-PU-CDE         PIC X(01).                        
030800        10 PV-HLD-DVN-CDE               PIC X(01).                        
030900        10 PV-HLD-BKR-FRGT-RLSE-CDE     PIC X(01).                        
031000        10 PV-HLD-DCONSLR-RET-CDE       PIC X(01).                        
      * MS 07/01/2010                                                           
              10 PV-HLD-DCONSLR-ARR-IND       PIC X(01).                        
031100                                                                          
031200     05  PV-EDI-RECORDS              PIC  X(03).                          
031300         88  EDI-RECORD                            VALUE 'CTT',           
031400                                                         'IEA',           
031500                                                         'ISA'.           
031600         88  EDI-IEA-RECORD                        VALUE 'IEA'.           
031700                                                                          
031800     05  PV-RECORD-TYP               PIC X(06).                           
031900         88  PV-RECORD-TYP-DPU                     VALUE 'DPU   '.        
032000         88  PV-RECORD-TYP-DLV                     VALUE 'DLV   '.        
032100         88  PV-RECORD-TYP-DVN                     VALUE 'DVN   '.        
032200         88  PV-RECORD-TYP-CRP                     VALUE 'CRP   '.        
032300         88  PV-RECORD-TYP-RTN                     VALUE 'RTN   '.        
032400                                                                          
032500     05  PV-TMST                     PIC X(26)     VALUE SPACES.          
032600     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.          
032700     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.          
032800     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0               
032900                                                    COMP SYNC.            
033000     05  PV-CONTAINER-CNT            PIC S9(09)    VALUE +0               
033100                                                    COMP-3.               
033200                                                                          
033300     05  PV-FORMAT-TMST.                                                  
033400         10  PV-FORMAT-TMST-DTE.                                          
033500             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.          
033600             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.             
033700             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.          
033800             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.             
033900             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.          
034000             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.             
034100         10  PV-FORMAT-TMST-TM.                                           
034200             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.          
034300             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.             
034400             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.          
034500             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE                  
034600                                                     '.00.000000'.        
034700     05  PV-REFORMAT-TMST.                                                
034800         10  PV-REFORMAT-TMST-DTE.                                        
034900             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.        
035000             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.        
035100             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.        
035200         10  PV-REFORMAT-TMST-TM.                                         
035300             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.        
035400             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.        
035500                                                                          
035600     05  PV-REFORMAT-TO-DB2-DTE.                                          
035700         10  PV-REFORMAT-TO-DB2-CY    PIC X(04)  VALUE SPACES.            
035800         10  PV-REFORMAT-TODB2-DASH1  PIC X(01)  VALUE '-'.               
035900         10  PV-REFORMAT-TO-DB2-MM    PIC X(02)  VALUE SPACES.            
036000         10  PV-REFORMAT-TODB2-DASH2  PIC X(01)  VALUE '-'.               
036100         10  PV-REFORMAT-TO-DB2-DD    PIC X(02)  VALUE SPACES.            
036200                                                                          
036300     05  PV-REFORMAT-10BYTE-FIELD     PIC X(10)  VALUE SPACES.            
036400                                                                          
036500 01  CKPT-RESTART-INFO.                                                   
036600     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.             
036700         88  INPUT-DELIVERY-FILE                   VALUE 'I'.             
036800     05  CR-DELIVERY-RECS-WORKED     PIC 9(09)     VALUE ZERO.            
036900                                                                          
037000******************************************************************        
037100 LINKAGE SECTION.                                                         
037200******************************************************************        
037300                                                                          
037400 EJECT                                                                    
037500******************************************************************        
037600 PROCEDURE DIVISION.                                                      
037700******************************************************************        
037800*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *        
037900******************************************************************        
038000 0000-PROGRAM-MAINLINE.                                                   
038100                                                                          
038200     PERFORM 1000-INITIALIZE.                                             
038300                                                                          
038400     PERFORM 2000-PROCESS-DELIVERY-RECORDS                                
038500         UNTIL PS-END-OF-INPUT.                                           
038600                                                                          
038700     PERFORM 8000-EOJ-ROUTINE.                                            
038800     STOP RUN.                                                            
038900                                                                          
039000******************************************************************        
039100*  OPEN FILES, INITIALIZE FIELDS, AND DOES OTHER BEGINNING OF    *        
039200*  JOB PROCESSES.                                                *        
039300******************************************************************        
039400 1000-INITIALIZE.                                                         
039500                                                                          
039600     OPEN INPUT TR028-DELIVERY-FILE.                                      
039700                                                                          
039800     PERFORM 4000-GET-CHECKPOINT-CNTL.                                    
039900     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                          
040000                                                                          
040100     IF RESTART-RUN                                                       
040200         PERFORM 4110-CHECKPOINT-RESTART                                  
040300     ELSE                                                                 
040400         PERFORM 1010-CONTINUE-INITIALIZE                                 
040500     END-IF.                                                              
040600                                                                          
040700     PERFORM 4020-SET-COMMIT-TIME.                                        
040800                                                                          
040900                                                                          
041000 1010-CONTINUE-INITIALIZE.                                                
041100                                                                          
041200     INITIALIZE  TR028-REC-TYP-DPU.                                       
041300                                                                          
041400     SET PS-GOOD-RECORD-NO TO TRUE.                                       
041500     PERFORM 6000-READ-DELIVERY-FILE                                      
041600         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                         
041700                                                                          
041800     IF PS-END-OF-INPUT                                                   
041900         CONTINUE                                                         
042000     ELSE                                                                 
042100         MOVE TR028-DPU-REC-KEY                                           
042200                TO PV-PREV-KEY                                            
042300     END-IF.                                                              
042400                                                                          
042500******************************************************************        
042600* MAIN PROCESSING PARAGRAPH.                                     *        
042700******************************************************************        
042800                                                                          
      * MS 07/01/2010                                                           
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.             
                                                                                
042900 2000-PROCESS-DELIVERY-RECORDS.                                           
043000                                                                          
043100     MOVE TR028-DPU-CONTNR-ID      TO IMCNPO-CONTNR-ID.                   
043300     MOVE TR028-DPU-PO-NBR         TO IMCNPO-PO-NBR.                      
043400     PERFORM 7000-SELECT-TIMCNTK.                                         
043500     PERFORM 7200-SELECT-TIMCNPO.                                         
043600                                                                          
043700     EVALUATE TRUE                                                        
043800                                                                          
043900      WHEN PS-CNTK-FOUND                                                  
044000                                                                          
044100         EVALUATE TR028-DPU-REC-TYP-CDE                                   
044200                                                                          
044300          WHEN PC-DPU                                                     
044400          WHEN PC-DLV                                                     
044500          WHEN PC-DVN                                                     
044600          WHEN PC-CRP                                                     
044700          WHEN PC-RTN                                                     
                WHEN PC-ARVDCN                                                  
044800             PERFORM 5100-MOVE-TIMCNTK-TO-TAUCNTK                         
044900             PERFORM 5110-MOVE-TIMCNPO-TO-TAUCNPO                         
045000             PERFORM 5200-MOVE-TIMCNTK-TO-HOLD                            
045010             PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                            
045100             SET PS-NEW-CONTAINER-KEY-NO                                  
045200                 PS-NEW-PO-KEY-NO                                         
045300                 PS-GOOD-CNPO-UPDATE-NO                                   
045400                 PS-GOOD-CNTK-UPDATE-NO                                   
045500                 PS-GOOD-CNTK-INSERT-NO                                   
045600                 PS-GOOD-CNTK-DELETE-NO         TO TRUE                   
045700             PERFORM 2100-ADD-UPDATE-DELETE                               
045800                UNTIL  PS-NEW-CONTAINER-KEY   OR                          
045900                       PS-END-OF-INPUT                                    
046000                                                                          
046100             IF PS-GOOD-CNTK-UPDATE   OR                                  
046200                PS-GOOD-CNTK-INSERT   OR                                  
046300                PS-GOOD-CNTK-DELETE                                       
046400               PERFORM 7030-INSERT-TAUCNTK                                
046500               PERFORM 7010-UPDATE-TIMCNTK                                
046600               ADD +1 TO PA-TOT-CNTK-UPDATES                              
046700                         PA-TOT-RECS-UPDATED                              
046800             END-IF                                                       
046900                                                                          
047000          WHEN PC-DPURDD                                                  
047100          WHEN PC-DLVRDD                                                  
047200          WHEN PC-DVNRDD                                                  
047300          WHEN PC-CRPRDD                                                  
047400          WHEN PC-RTNRDD                                                  
                WHEN PC-ARVDRD                                                  
047500             PERFORM 7999-SET-CURRENT-TMST                                
047600             PERFORM 5200-MOVE-TIMCNTK-TO-HOLD                            
047610             PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                            
047700             SET PS-NEW-CONTAINER-KEY-NO                                  
047800                 PS-NEW-PO-KEY-NO                                         
047900                 PS-GOOD-CNPO-UPDATE-NO                                   
048000                 PS-GOOD-CNTK-UPDATE-NO                                   
048100                 PS-GOOD-CNTK-INSERT-NO                                   
048200                 PS-GOOD-CNTK-DELETE-NO         TO TRUE                   
048300             PERFORM 2100-ADD-UPDATE-DELETE                               
048400                UNTIL  PS-NEW-CONTAINER-KEY   OR                          
048500                       PS-END-OF-INPUT                                    
048600                                                                          
048700             IF PS-GOOD-CNTK-UPDATE   OR                                  
048800                PS-GOOD-CNTK-INSERT   OR                                  
048900                PS-GOOD-CNTK-DELETE                                       
049000               PERFORM 7010-UPDATE-TIMCNTK                                
049100               ADD +1 TO PA-TOT-CNTK-UPDATES                              
049200                         PA-TOT-RECS-UPDATED                              
049300             END-IF                                                       
049400          END-EVALUATE                                                    
049500                                                                          
049600      WHEN PS-CNTK-FOUND-NO                                               
049700                                                                          
049800         PERFORM 6307-CONTAINER-NOT-FOUND-ERROR                           
               PERFORM 2500-PROCESS-ERROR-RECORD                                
050100     END-EVALUATE.                                                        
050200                                                                          
050300     PERFORM 4100-COMMIT-CHECK.                                           
050400                                                                          
050500 EJECT                                                                    
050600******************************************************************        
050700* PROCESS ADDS AND CHANGES UNTIL THERE'S A NEW CONTAINER ROW.    *        
050800******************************************************************        
050900                                                                          
      * MS 07/01/2010                                                           
      * ADDED THE CHECKS FOR ARVDCN TYPE OF RECORDS.                            
                                                                                
051000 2100-ADD-UPDATE-DELETE.                                                  
051100                                                                          
051200     EVALUATE TRUE                                                        
051300                                                                          
051400         WHEN TR028-DPU-TRN-TYP-ADD                                       
051500            ADD +1 TO PA-TOT-TRN-TYP-A                                    
051600            PERFORM 2300-MOVE-TO-TIMCNTK-DCLGEN                           
051400            PERFORM 2620-ADD-SCM-ARRIVAL-MSG                      04780018
051700                                                                          
051800         WHEN TR028-DPU-TRN-TYP-CHG                                       
051900            ADD +1 TO PA-TOT-TRN-TYP-C                                    
052000            PERFORM 2300-MOVE-TO-TIMCNTK-DCLGEN                           
051400            PERFORM 2625-CHG-SCM-ARRIVAL-MSG                      04780018
052100                                                                          
052200         WHEN TR028-DPU-TRN-TYP-DEL                                       
052300            ADD +1 TO PA-TOT-TRN-TYP-D                                    
052400            PERFORM 2400-MOVE-TO-TIMCNTK-DCLGEN-D                         
051400            PERFORM 2630-DEL-SCM-ARRIVAL-MSG                      04780018
052500                                                                          
052600     END-EVALUATE.                                                        
052700                                                                          
      *         DISPLAY '**************************************'                
      *         DISPLAY '**2100-ADD-UPDATE-DELETE.'                             
      *     DISPLAY '** PS-GOOD-CNTK-INSERT-SW=' PS-GOOD-CNTK-INSERT-SW         
      *     DISPLAY '** PS-GOOD-CNPO-UPDATE-SW=' PS-GOOD-CNPO-UPDATE-SW         
      *     DISPLAY '** PS-ADD-ALREADY-DONE-SW=' PS-ADD-ALREADY-DONE-SW         
      *     DISPLAY '** TR028-DPU-TRN-TYP=' TR028-DPU-TRN-TYP                   
      *         DISPLAY '** TR028-DPU-PO-NBR=' TR028-DPU-PO-NBR                 
      *     DISPLAY '** TR028-DPU-EXTL-REF-NBR=' TR028-DPU-EXTL-REF-NBR         
      *         DISPLAY '** TR028-DPU-CONTNR-ID=' TR028-DPU-CONTNR-ID           
      *     DISPLAY '** TR028-DPU-REC-TYP-CDE=' TR028-DPU-REC-TYP-CDE           
      *         DISPLAY '** PROGRAM = TRKUP255               **'                
      *         DISPLAY '**************************************'                
                                                                                
                 EVALUATE TRUE                                                  
                                                                                
                    WHEN PS-ADD-ALREADY-DONE-YES                                
                       PERFORM 6308-ADD-SNT-SHOULD-BE-CHG-ERR                   
                       PERFORM 5000-MOVE-RPT-FIELDS                             
                       PERFORM 7300-INSERT-TOUTTR9-RPT                          
                       ADD -1 TO PA-TOT-TRN-TYP-A                               
                                 PA-TOT-CNPO-UPDATES                            
                                 PA-TOT-RECS-UPDATED                            
                                 PA-TOT-ACNPO-INSERTS                           
                                 PA-TOT-RECS-AUDITED                            
                       SET PS-ADD-ALREADY-DONE-NO TO TRUE                       
                    WHEN OTHER                                                  
                      INITIALIZE TR251-RECORD                                   
                      MOVE PC-D  TO TR251-RPT-TYP                               
                      PERFORM 5000-MOVE-RPT-FIELDS                              
                      PERFORM 7300-INSERT-TOUTTR9-RPT                           
                                                                                
                 END-EVALUATE.                                                  
                                                                                
053300     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
053400                                                                          
053500     SET PS-GOOD-RECORD-NO TO TRUE.                                       
053600     PERFORM 6000-READ-DELIVERY-FILE                                      
053700         UNTIL PS-GOOD-RECORD OR                                          
053800               PS-END-OF-INPUT.                                           
053900                                                                          
054000                                                                          
054100     PERFORM 2610-CHECK-FOR-CONTROL-BRK.                                  
054200                                                                          
054300     IF PS-NEW-PO-KEY  OR  PS-NEW-CONTAINER-KEY  OR                       
054400        PS-END-OF-INPUT                                                   
054500       IF PS-GOOD-CNPO-UPDATE                                             
054600         EVALUATE PV-PREV-KEY-REC-TYP-CDE                                 
054700          WHEN PC-DPU                                                     
054800          WHEN PC-DLV                                                     
                WHEN PC-ARVDCN                                                  
054900          WHEN PC-DVN                                                     
055000          WHEN PC-CRP                                                     
055100          WHEN PC-RTN                                                     
055200             PERFORM 7210-INSERT-TAUCNPO                                  
055300         END-EVALUATE                                                     
055400         PERFORM 7020-UPDATE-TIMCNPO                                      
055500         ADD +1 TO PA-TOT-CNPO-UPDATES                                    
055600                   PA-TOT-RECS-UPDATED                                    
055700       END-IF                                                             
055800       IF PS-NEW-PO-KEY  AND PS-NEW-CONTAINER-KEY-NO  AND                 
055900          PS-END-OF-INPUT-NO                                              
056000         SET PS-NEW-PO-KEY-NO                                             
056100             PS-GOOD-CNPO-UPDATE-NO   TO TRUE                             
056200         PERFORM 5110-MOVE-TIMCNPO-TO-TAUCNPO                             
056300         PERFORM 5210-MOVE-TIMCNPO-TO-HOLD                                
056400       END-IF                                                             
056500     END-IF.                                                              
056600                                                                          
056700                                                                          
056800*****************************************************************         
056900* SETUP THE DCLGEN FIELDS PRIOR TO UPDATE BY MOVING THE FIELDS  *         
057000* THAT ARE UNIQUE TO EACH RECORD TYPE.                          *         
057100*****************************************************************         
057200                                                                          
      * MS 07/01/2010                                                           
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.             
                                                                                
057300 2300-MOVE-TO-TIMCNTK-DCLGEN.                                             
057400                                                                          
057400*    SET PS-ADD-ALREADY-DONE-NO TO TRUE.                                  
057500                                                                          
057600*    *-------------------------------------------------*                  
057700*    * DATE LOGIC APPLYS TO SPECIFIC RECORD TYPES      *                  
057800*    *-------------------------------------------------*                  
057900     EVALUATE TR028-DPU-REC-TYP-CDE                                       
058000                                                                          
058100*        -----------------------------------------------                  
058200         WHEN PC-DPU                                                      
058300         WHEN PC-DPURDD                                                   
058400                                                                          
058500             MOVE TR028-DPU-DELY-ORD-RCVD-DTE (1:4) TO                    
058600                   PV-FORMAT-TMST-DTE-CY                                  
058700             MOVE TR028-DPU-DELY-ORD-RCVD-DTE (5:2) TO                    
058800                   PV-FORMAT-TMST-DTE-MM                                  
058900             MOVE TR028-DPU-DELY-ORD-RCVD-DTE (7:2) TO                    
059000                   PV-FORMAT-TMST-DTE-DD                                  
059100             MOVE TR028-DPU-DELY-ORD-RCVD-TM (1:2)  TO                    
059200                   PV-FORMAT-TMST-TM-HH                                   
059300             MOVE TR028-DPU-DELY-ORD-RCVD-TM (3:2)  TO                    
059400                   PV-FORMAT-TMST-TM-MM                                   
059500                                                                          
059600            IF PV-HLD-DO-RCVD-CDE = SPACES                                
059700              MOVE PC-Y               TO PV-HLD-DO-RCVD-CDE               
059800              SET PS-GOOD-CNPO-UPDATE      TO TRUE                        
                  ELSE                                                          
                    IF TR028-DPU-TRN-TYP-ADD                                    
                      SET PS-ADD-ALREADY-DONE-YES TO TRUE                       
                    END-IF                                                      
059900            END-IF                                                        
060000                                                                          
060100            IF TR028-DPU-TRN-TYP-ADD                                      
060200              IF PV-HLD-DO-RCVD-TMST = PC-DEFAULT-TMST                    
060300                MOVE PV-FORMAT-TMST   TO PV-HLD-DO-RCVD-TMST              
060400                SET PS-GOOD-CNTK-INSERT    TO TRUE                        
060500              END-IF                                                      
060600            END-IF                                                        
060700                                                                          
060800            IF TR028-DPU-TRN-TYP-CHG                                      
060900              IF PV-HLD-DO-RCVD-TMST NOT =   PV-FORMAT-TMST               
061000                MOVE PV-FORMAT-TMST   TO PV-HLD-DO-RCVD-TMST              
061100                SET PS-GOOD-CNTK-UPDATE    TO TRUE                        
061200              END-IF                                                      
061300            END-IF                                                        
061400                                                                          
061500*        -----------------------------------------------                  
061600         WHEN PC-DLV                                                      
061700         WHEN PC-DLVRDD                                                   
061800                                                                          
061900             MOVE TR028-DLV-CONTNR-PCKUP-DTE (1:4) TO                     
062000                   PV-FORMAT-TMST-DTE-CY                                  
062100             MOVE TR028-DLV-CONTNR-PCKUP-DTE (5:2) TO                     
062200                   PV-FORMAT-TMST-DTE-MM                                  
062300             MOVE TR028-DLV-CONTNR-PCKUP-DTE (7:2) TO                     
062400                   PV-FORMAT-TMST-DTE-DD                                  
062500             MOVE TR028-DLV-CONTNR-PCKUP-TM (1:2)   TO                    
062600                   PV-FORMAT-TMST-TM-HH                                   
062700             MOVE TR028-DLV-CONTNR-PCKUP-TM (3:2)   TO                    
062800                   PV-FORMAT-TMST-TM-MM                                   
062900                                                                          
063000            IF PV-HLD-CONTNR-PU-CDE = SPACES                              
063100              MOVE PC-Y               TO PV-HLD-CONTNR-PU-CDE             
063200              SET PS-GOOD-CNPO-UPDATE      TO TRUE                        
                  ELSE                                                          
                    IF TR028-DPU-TRN-TYP-ADD                                    
                      SET PS-ADD-ALREADY-DONE-YES TO TRUE                       
                    END-IF                                                      
063300            END-IF                                                        
063400                                                                          
063500            IF TR028-DPU-TRN-TYP-ADD                                      
063600              IF PV-HLD-CONTNR-PU-TMST = PC-DEFAULT-TMST                  
063700                MOVE PV-FORMAT-TMST   TO PV-HLD-CONTNR-PU-TMST            
063800                SET PS-GOOD-CNTK-INSERT    TO TRUE                        
063900              END-IF                                                      
064000            END-IF                                                        
064100                                                                          
064200            IF TR028-DPU-TRN-TYP-CHG                                      
064300              IF PV-HLD-CONTNR-PU-TMST NOT = PV-FORMAT-TMST               
064400                MOVE PV-FORMAT-TMST   TO PV-HLD-CONTNR-PU-TMST            
064500                SET PS-GOOD-CNTK-UPDATE    TO TRUE                        
064600              END-IF                                                      
064700            END-IF                                                        
064800                                                                          
      *        -----------------------------------------------                  
               WHEN PC-ARVDCN                                                   
               WHEN PC-ARVDRD                                                   
                   MOVE TR028-ARVDCN-ARRIVE-DECON-DTE (1:4) TO                  
                        PV-FORMAT-TMST-DTE-CY                                   
                   MOVE TR028-ARVDCN-ARRIVE-DECON-DTE (5:2) TO                  
                        PV-FORMAT-TMST-DTE-MM                                   
                   MOVE TR028-ARVDCN-ARRIVE-DECON-DTE (7:2) TO                  
                        PV-FORMAT-TMST-DTE-DD                                   
                   MOVE TR028-ARVDCN-ARRIVE-DECON-TM (1:2)  TO                  
                        PV-FORMAT-TMST-TM-HH                                    
                   MOVE TR028-ARVDCN-ARRIVE-DECON-TM (3:2)  TO                  
                        PV-FORMAT-TMST-TM-MM                                    
                   IF PV-HLD-DCONSLR-ARR-IND = SPACES                           
                      MOVE PC-Y                TO PV-HLD-DCONSLR-ARR-IND        
                      SET PS-GOOD-CNPO-UPDATE        TO TRUE                    
                   ELSE                                                         
                      IF TR028-DPU-TRN-TYP-ADD                                  
                         SET PS-ADD-ALREADY-DONE-YES TO TRUE                    
                      END-IF                                                    
                   END-IF                                                       
                   IF TR028-DPU-TRN-TYP-ADD                                     
                      IF PV-HLD-DCONSLR-ARR-TMST = PC-DEFAULT-TMST              
                         MOVE PV-FORMAT-TMST  TO PV-HLD-DCONSLR-ARR-TMST        
                         SET PS-GOOD-CNTK-INSERT     TO TRUE                    
                      END-IF                                                    
                   END-IF                                                       
                   IF TR028-DPU-TRN-TYP-CHG                                     
                      IF PV-HLD-DCONSLR-ARR-TMST NOT = PV-FORMAT-TMST           
                         MOVE PV-FORMAT-TMST  TO PV-HLD-DCONSLR-ARR-TMST        
                         SET PS-GOOD-CNTK-UPDATE     TO TRUE                    
                      END-IF                                                    
                   END-IF                                                       
064900*        -----------------------------------------------                  
065000         WHEN PC-DVN                                                      
065100         WHEN PC-DVNRDD                                                   
065200                                                                          
065300             MOVE TR028-DVN-CONTNR-DEVAN-DTE (1:4)  TO                    
065400                   PV-FORMAT-TMST-DTE-CY                                  
065500             MOVE TR028-DVN-CONTNR-DEVAN-DTE (5:2)  TO                    
065600                   PV-FORMAT-TMST-DTE-MM                                  
065700             MOVE TR028-DVN-CONTNR-DEVAN-DTE (7:2)  TO                    
065800                   PV-FORMAT-TMST-DTE-DD                                  
065900             MOVE TR028-DVN-CONTNR-DEVAN-TM (1:2)   TO                    
066000                   PV-FORMAT-TMST-TM-HH                                   
066100             MOVE TR028-DVN-CONTNR-DEVAN-TM (3:2)   TO                    
066200                   PV-FORMAT-TMST-TM-MM                                   
066300                                                                          
066400            IF PV-HLD-DVN-CDE     = SPACES                                
066500              MOVE PC-Y               TO PV-HLD-DVN-CDE                   
066600              SET PS-GOOD-CNPO-UPDATE      TO TRUE                        
                  ELSE                                                          
                    IF TR028-DPU-TRN-TYP-ADD                                    
                      SET PS-ADD-ALREADY-DONE-YES TO TRUE                       
                    END-IF                                                      
066700            END-IF                                                        
066800                                                                          
066900            IF TR028-DPU-TRN-TYP-ADD                                      
067000              IF PV-HLD-DVN-TMST = PC-DEFAULT-TMST                        
067100                MOVE PV-FORMAT-TMST   TO PV-HLD-DVN-TMST                  
067200                SET PS-GOOD-CNTK-INSERT    TO TRUE                        
067300              END-IF                                                      
067400            END-IF                                                        
067500                                                                          
067600            IF TR028-DPU-TRN-TYP-CHG                                      
067700              IF PV-HLD-DVN-TMST NOT = PV-FORMAT-TMST                     
067800                MOVE PV-FORMAT-TMST   TO PV-HLD-DVN-TMST                  
067900                SET PS-GOOD-CNTK-UPDATE    TO TRUE                        
068000              END-IF                                                      
068100            END-IF                                                        
068200                                                                          
068300*        -----------------------------------------------                  
068400         WHEN PC-CRP                                                      
068500         WHEN PC-CRPRDD                                                   
068600                                                                          
068700             MOVE TR028-CRP-FRGT-RLSE-DTE (1:4)   TO                      
068800                   PV-FORMAT-TMST-DTE-CY                                  
068900             MOVE TR028-CRP-FRGT-RLSE-DTE (5:2)   TO                      
069000                   PV-FORMAT-TMST-DTE-MM                                  
069100             MOVE TR028-CRP-FRGT-RLSE-DTE (7:2)   TO                      
069200                   PV-FORMAT-TMST-DTE-DD                                  
069300             MOVE TR028-CRP-FRGT-RLSE-TM (1:2)    TO                      
069400                   PV-FORMAT-TMST-TM-HH                                   
069500             MOVE TR028-CRP-FRGT-RLSE-TM (3:2)    TO                      
069600                   PV-FORMAT-TMST-TM-MM                                   
069700                                                                          
069800            IF PV-HLD-BKR-FRGT-RLSE-CDE = SPACES                          
069900              MOVE PC-Y              TO PV-HLD-BKR-FRGT-RLSE-CDE          
070000              SET PS-GOOD-CNPO-UPDATE      TO TRUE                        
                  ELSE                                                          
                    IF TR028-DPU-TRN-TYP-ADD                                    
                      SET PS-ADD-ALREADY-DONE-YES TO TRUE                       
                    END-IF                                                      
070100            END-IF                                                        
070200                                                                          
070300            IF TR028-CRP-TRN-TYP-ADD                                      
070400              IF PV-HLD-BKR-FRGT-RLSE-TMST = PC-DEFAULT-TMST              
070500                MOVE PV-FORMAT-TMST  TO PV-HLD-BKR-FRGT-RLSE-TMST         
070600                SET PS-GOOD-CNTK-INSERT    TO TRUE                        
070700              END-IF                                                      
070800            END-IF                                                        
070900                                                                          
071000            IF TR028-CRP-TRN-TYP-CHG                                      
071100              IF PV-HLD-BKR-FRGT-RLSE-TMST NOT = PV-FORMAT-TMST           
071200                MOVE PV-FORMAT-TMST  TO PV-HLD-BKR-FRGT-RLSE-TMST         
071300                SET PS-GOOD-CNTK-UPDATE    TO TRUE                        
071400              END-IF                                                      
071500            END-IF                                                        
071600*        -----------------------------------------------                  
071700         WHEN PC-RTN                                                      
071800         WHEN PC-RTNRDD                                                   
071900                                                                          
072000             MOVE TR028-RTN-CONTNR-RETURN-DTE (1:4)   TO                  
072100                   PV-FORMAT-TMST-DTE-CY                                  
072200             MOVE TR028-RTN-CONTNR-RETURN-DTE (5:2)   TO                  
072300                   PV-FORMAT-TMST-DTE-MM                                  
072400             MOVE TR028-RTN-CONTNR-RETURN-DTE (7:2)   TO                  
072500                   PV-FORMAT-TMST-DTE-DD                                  
072600             MOVE TR028-RTN-CONTNR-RETURN-TM (1:2)    TO                  
072700                   PV-FORMAT-TMST-TM-HH                                   
072800             MOVE TR028-RTN-CONTNR-RETURN-TM (3:2)    TO                  
072900                   PV-FORMAT-TMST-TM-MM                                   
073000                                                                          
073100            IF PV-HLD-DCONSLR-RET-CDE = SPACES                            
073200              MOVE PC-Y               TO PV-HLD-DCONSLR-RET-CDE           
073300              SET PS-GOOD-CNPO-UPDATE      TO TRUE                        
                  ELSE                                                          
                    IF TR028-DPU-TRN-TYP-ADD                                    
                      SET PS-ADD-ALREADY-DONE-YES TO TRUE                       
                    END-IF                                                      
073400            END-IF                                                        
073500                                                                          
073600            IF TR028-RTN-TRN-TYP-ADD                                      
073700              IF PV-HLD-RET-TMST = PC-DEFAULT-TMST                        
073800                MOVE PV-FORMAT-TMST   TO PV-HLD-RET-TMST                  
073900                SET PS-GOOD-CNTK-INSERT    TO TRUE                        
074000              END-IF                                                      
074100            END-IF                                                        
074200                                                                          
074300            IF TR028-RTN-TRN-TYP-CHG                                      
074400              IF PV-HLD-RET-TMST NOT = PV-FORMAT-TMST                     
074500                MOVE PV-FORMAT-TMST   TO PV-HLD-RET-TMST                  
074600                SET PS-GOOD-CNTK-UPDATE    TO TRUE                        
074700              END-IF                                                      
074800            END-IF                                                        
074900                                                                          
075000     END-EVALUATE.                                                        
075100                                                                          
075200*    *-------------------------------------------------*                  
075300*    * SCAC LOGIC APPLYS TO ALL RECORD TYPES           *                  
075400*    *-------------------------------------------------*                  
076200                                                                          
076210     IF TR028-DPU-TRN-TYP-ADD                                             
076220       IF PV-HLD-DCONSLR-SCAC-ID                                          
076221                      NOT =   TR028-DPU-DCONSLR-SCAC-ID                   
076230         MOVE TR028-DPU-DCONSLR-SCAC-ID                                   
076240                              TO PV-HLD-DCONSLR-SCAC-ID                   
076250         SET PS-GOOD-CNTK-INSERT    TO TRUE                               
076260       END-IF                                                             
076270     END-IF.                                                              
076280                                                                          
076300     IF TR028-DPU-TRN-TYP-CHG                                             
076400       IF PV-HLD-DCONSLR-SCAC-ID                                          
076500                      NOT =   TR028-DPU-DCONSLR-SCAC-ID                   
076600         MOVE TR028-DPU-DCONSLR-SCAC-ID                                   
076700                              TO PV-HLD-DCONSLR-SCAC-ID                   
076800         SET PS-GOOD-CNTK-UPDATE    TO TRUE                               
076900       END-IF                                                             
077000     END-IF.                                                              
077100                                                                          
077200 EJECT                                                                    
077300*****************************************************************         
077400* SETUP THE DCLGEN FIELDS PRIOR TO DELETE BY DEFAULTS TO THE    *         
077500* FIELDS THAT ARE UNIQUE TO EACH RECORD TYPE.                   *         
077600*****************************************************************         
077700                                                                          
      * MS 07/01/2010                                                           
      * ADDED THE CHECKS FOR ARVDCN TYPE OF RECORDS.                            
                                                                                
077800 2400-MOVE-TO-TIMCNTK-DCLGEN-D.                                           
077900                                                                          
078000     EVALUATE TR028-DPU-REC-TYP-CDE                                       
078100                                                                          
078200*        ---------------------------------------------------              
078300         WHEN PC-DPU                                                      
078400                                                                          
078500             IF PV-HLD-DO-RCVD-CDE NOT = SPACES                           
078600               MOVE SPACES                TO PV-HLD-DO-RCVD-CDE           
078700               SET PS-GOOD-CNPO-UPDATE    TO TRUE                         
078800             END-IF                                                       
078900                                                                          
079000             IF PV-HLD-DO-RCVD-TMST    NOT =  PC-DEFAULT-TMST             
079100               PERFORM 7040-SELECT-DO-RCVD-COUNT                          
079200               IF PV-CONTAINER-CNT = ZERO                                 
079300                 MOVE  PC-DEFAULT-TMST   TO PV-HLD-DO-RCVD-TMST           
079400                 SET PS-GOOD-CNTK-DELETE TO TRUE                          
079500               END-IF                                                     
079600             END-IF                                                       
079700                                                                          
079800*        ---------------------------------------------------              
079900         WHEN PC-DLV                                                      
080000                                                                          
080100             IF PV-HLD-CONTNR-PU-CDE NOT = SPACES                         
080200               MOVE SPACES                TO PV-HLD-CONTNR-PU-CDE         
080300               SET PS-GOOD-CNPO-UPDATE    TO TRUE                         
080400             END-IF                                                       
080500                                                                          
080600             IF PV-HLD-CONTNR-PU-TMST    NOT =  PC-DEFAULT-TMST           
080700               PERFORM 7050-SELECT-CONTNR-PU-COUNT                        
080800               IF PV-CONTAINER-CNT = ZERO                                 
080900                 MOVE  PC-DEFAULT-TMST   TO PV-HLD-CONTNR-PU-TMST         
081000                 SET PS-GOOD-CNTK-DELETE TO TRUE                          
081100               END-IF                                                     
081200             END-IF                                                       
081300                                                                          
      *        ---------------------------------------------------              
               WHEN PC-ARVDCN                                                   
                                                                                
                   IF PV-HLD-DCONSLR-ARR-IND NOT = SPACES                       
                     MOVE SPACES               TO PV-HLD-DCONSLR-ARR-IND        
                     SET PS-GOOD-CNPO-UPDATE   TO TRUE                          
                   END-IF                                                       
                                                                                
                   IF PV-HLD-DCONSLR-ARR-TMST    NOT =  PC-DEFAULT-TMST         
                     PERFORM 7055-SELECT-DCONSLR-ARRIVE-CNT                     
                     IF PV-CONTAINER-CNT = ZERO                                 
                       MOVE  PC-DEFAULT-TMST TO PV-HLD-DCONSLR-ARR-TMST         
                       SET PS-GOOD-CNTK-DELETE TO TRUE                          
                     END-IF                                                     
                   END-IF                                                       
                                                                                
                                                                                
081400*        ---------------------------------------------------              
081500         WHEN PC-DVN                                                      
081600                                                                          
081700             IF PV-HLD-DVN-CDE NOT = SPACES                               
081800               MOVE SPACES                TO PV-HLD-DVN-CDE               
081900               SET PS-GOOD-CNPO-UPDATE    TO TRUE                         
082000             END-IF                                                       
082100                                                                          
082200             IF PV-HLD-DVN-TMST    NOT =  PC-DEFAULT-TMST                 
082300               PERFORM 7060-SELECT-DVN-COUNT                              
082400               IF PV-CONTAINER-CNT = ZERO                                 
082500                 MOVE  PC-DEFAULT-TMST   TO PV-HLD-DVN-TMST               
082600                 SET PS-GOOD-CNTK-DELETE TO TRUE                          
082700               END-IF                                                     
082800             END-IF                                                       
082900                                                                          
083000*        ---------------------------------------------------              
083100         WHEN PC-CRP                                                      
083200                                                                          
083300             IF PV-HLD-BKR-FRGT-RLSE-CDE NOT = SPACES                     
083400               MOVE SPACES             TO PV-HLD-BKR-FRGT-RLSE-CDE        
083500               SET PS-GOOD-CNPO-UPDATE TO TRUE                            
083600             END-IF                                                       
083700                                                                          
083800             IF PV-HLD-BKR-FRGT-RLSE-TMST  NOT =  PC-DEFAULT-TMST         
083900               PERFORM 7070-SELECT-BKR-FRGT-COUNT                         
084000               IF PV-CONTAINER-CNT = ZERO                                 
084100                 MOVE  PC-DEFAULT-TMST   TO                               
084200                                        PV-HLD-BKR-FRGT-RLSE-TMST         
084300                 SET PS-GOOD-CNTK-DELETE TO TRUE                          
084400               END-IF                                                     
084500             END-IF                                                       
084600                                                                          
084700*        ---------------------------------------------------              
084800         WHEN PC-RTN                                                      
084900                                                                          
085000             IF PV-HLD-DCONSLR-RET-CDE NOT = SPACES                       
085100               MOVE SPACES               TO PV-HLD-DCONSLR-RET-CDE        
085200               SET PS-GOOD-CNPO-UPDATE   TO TRUE                          
085300             END-IF                                                       
085400                                                                          
085500             IF PV-HLD-RET-TMST    NOT =  PC-DEFAULT-TMST                 
085600               PERFORM 7080-SELECT-DCONSLR-RET-COUNT                      
085700               IF PV-CONTAINER-CNT = ZERO                                 
085800                 MOVE  PC-DEFAULT-TMST   TO PV-HLD-RET-TMST               
085900                 SET PS-GOOD-CNTK-DELETE TO TRUE                          
086000               END-IF                                                     
086100             END-IF                                                       
086200                                                                          
086300     END-EVALUATE.                                                        
086400                                                                          
086500*    *-------------------------------------------------*                  
086600*    * SCAC LOGIC APPLYS TO ALL RECORD TYPES           *                  
086700*    *   WE DON'T KNOW WHICH RECORD THE DECON SCAC     *                  
086800*    *   CAME IN ON, SO ONLY DELETE IF ALL 5 DATES     *                  
086900*    *   GONE.                                         *                  
087000*    *-------------------------------------------------*                  
087100                                                                          
087200     IF PV-HLD-DCONSLR-SCAC-ID    NOT =  SPACES     AND                   
087300      PV-HLD-DO-RCVD-TMST    = PC-DEFAULT-TMST      AND                   
087400      PV-HLD-CONTNR-PU-TMST  = PC-DEFAULT-TMST      AND                   
087500      PV-HLD-DVN-TMST        = PC-DEFAULT-TMST      AND                   
087600      PV-HLD-BKR-FRGT-RLSE-TMST = PC-DEFAULT-TMST   AND                   
087700      PV-HLD-RET-TMST        = PC-DEFAULT-TMST                            
087800        MOVE SPACES   TO PV-HLD-DCONSLR-SCAC-ID                           
087900        SET PS-GOOD-CNTK-DELETE TO TRUE                                   
088000     END-IF.                                                              
088100                                                                          
088200 EJECT                                                                    
088300******************************************************************        
088400* PROCESS ERROR RECORD FROM SELECTING CONTAINER.                 *        
088500******************************************************************        
088600                                                                          
088700 2500-PROCESS-ERROR-RECORD.                                               
088800                                                                          
088900     PERFORM 5000-MOVE-RPT-FIELDS.                                        
089000     PERFORM 7300-INSERT-TOUTTR9-RPT.                                     
089100     SET PS-GOOD-RECORD-NO TO TRUE.                                       
089200     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
089300     PERFORM 6000-READ-DELIVERY-FILE                                      
089400         UNTIL PS-GOOD-RECORD  OR                                         
089500               PS-END-OF-INPUT.                                           
089600     PERFORM 2610-CHECK-FOR-CONTROL-BRK.                                  
089700                                                                          
089800******************************************************************        
089900* BEFORE NEXT READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY *        
090000* HAVE, MOVE NEW FIELDS TO HOLD.                                 *        
090100******************************************************************        
090200                                                                          
090300 2600-CHECK-HOLD-FIELDS.                                                  
090400                                                                          
090500     IF PV-PREV-KEY-TRN-TYP        = TR028-DPU-TRN-TYP                    
090600      AND PV-PREV-KEY-CONTNR-ID    = TR028-DPU-CONTNR-ID                  
090800      AND PV-PREV-KEY-PO-NBR       = TR028-DPU-PO-NBR                     
090900         CONTINUE                                                         
091000     ELSE                                                                 
091100        MOVE TR028-DPU-REC-KEY    TO PV-PREV-KEY                          
091200     END-IF.                                                              
091300                                                                          
091400******************************************************************        
091500* AFTER READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY HAVE, *        
091600* SELECT TIMCNTK ONLY TO SEE IF THERE IS A NEW CONTAINER ROW.    *        
091700* EVEN THOUGH THE KEY, WHICH INCLUDES THE PO NUMBER, HAS CHANGED,*        
091800* THE CONTAINER ROW MAY BE THE SAME BECAUSE MULTIPLE PO'S MAY BE *        
091900* ON THE SAME CONTAINER.  OR IT MAY BE THAT JUST THE TRAN TYPE   *        
092000* HAS CHANGED, IN WHICH CASE, YOU DON'T HAVE TO DO A SELECT HERE *        
092100* TO INDICATE THAT THE KEY HAS CHANGED.                          *        
092200******************************************************************        
092300                                                                          
092400 2610-CHECK-FOR-CONTROL-BRK.                                              
092500                                                                          
092600     EVALUATE TRUE                                                        
092700                                                                          
092800      WHEN  PS-END-OF-INPUT                                               
092900         CONTINUE                                                         
093000                                                                          
093100      WHEN TR028-DPU-CONTNR-ID     NOT =  PV-PREV-KEY-CONTNR-ID           
093300      WHEN TR028-DPU-PO-NBR        NOT =  PV-PREV-KEY-PO-NBR              
093400                                                                          
093500       SET  PS-NEW-PO-KEY            TO TRUE                              
093600       MOVE TR028-DPU-CONTNR-ID      TO IMCNPO-CONTNR-ID                  
093800       MOVE TR028-DPU-PO-NBR         TO IMCNPO-PO-NBR                     
093900       PERFORM 7000-SELECT-TIMCNTK                                        
094000       PERFORM 7200-SELECT-TIMCNPO                                        
094100                                                                          
094200         EVALUATE TRUE                                                    
094300           WHEN PS-CNTK-FOUND-NO                                          
094400             SET  PS-NEW-CONTAINER-KEY TO TRUE                            
094500           WHEN PS-CNTK-FOUND                                             
094600             IF IMCNTK-CONTNR-SEQ-NBR  = PV-HLD-CONTNR-SEQ-NBR            
094700               AND IMCNTK-CONTNR-ID    = PV-HLD-CONTNR-ID                 
094800               AND TR028-DPU-TRN-TYP   = PV-PREV-KEY-TRN-TYP              
094900              CONTINUE                                                    
095000             ELSE                                                         
095100              SET  PS-NEW-CONTAINER-KEY    TO TRUE                        
095200             END-IF                                                       
095300         END-EVALUATE                                                     
095400                                                                          
095500      WHEN TR028-DPU-TRN-TYP       NOT =  PV-PREV-KEY-TRN-TYP             
095600         SET  PS-NEW-CONTAINER-KEY    TO TRUE                             
095700                                                                          
095800     END-EVALUATE.                                                        
095900                                                                          
089500******************************************************************08560024
089600*    FORMAT MQ ADD MESSAGE                                       *08570018
089700******************************************************************08580018
                                                                                
      * MS 07/01/2010                                                           
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.             
                                                                                
089800 2620-ADD-SCM-ARRIVAL-MSG.                                        08590018
           IF TR028-CRP-TRN-TYP-ADD                                             
            IF TR028-CRP-REC-TYP-CDE-CRP                                        
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'A'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR AVAIL FOR PICKUP'   TO TR405-EVENT-TYP                
             MOVE TR028-CRP-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-CRP-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-CRP-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-CRP-FRGT-RLSE-DTE     TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
           ELSE                                                                 
            IF TR028-DLV-REC-TYP-CDE-DLV                                        
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'A'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR PICKED UP'          TO TR405-EVENT-TYP                
             MOVE TR028-DLV-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DLV-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DLV-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DLV-CONTNR-PCKUP-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
            ELSE                                                                
            IF TR028-ARVDCN-REC-TYP-CD-ARVDCN                                   
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'A'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR ARRIVED AT DECON'   TO TR405-EVENT-TYP                
             MOVE TR028-ARVDCN-PO-NBR            TO TR405-PO-NBR                
             MOVE TR028-ARVDCN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
             MOVE TR028-ARVDCN-CONTNR-ID         TO TR405-CONTNR-ID             
             MOVE TR028-ARVDCN-ARRIVE-DECON-DTE  TO TR405-EVENT-DTE             
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
            ELSE                                                                
            IF TR028-DVN-REC-TYP-CDE-DVN                                        
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'A'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR DEVANNED'           TO TR405-EVENT-TYP                
             MOVE TR028-DVN-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DVN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DVN-CONTNR-DEVAN-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
            ELSE                                                                
             IF TR028-CRPRD-REC-TYP-CDE-CRPRDD                                  
              INITIALIZE TR405-MESSAGE-LAYOUT                                   
              MOVE 'A'                           TO TR405-ACTN-CDE              
              MOVE 'CONTNR AVAIL FOR PICKUP'     TO TR405-EVENT-TYP             
              MOVE TR028-CRPRD-PO-NBR            TO TR405-PO-NBR                
              MOVE TR028-CRPRD-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
              MOVE TR028-CRPRD-CONTNR-ID         TO TR405-CONTNR-ID             
              MOVE TR028-CRPRD-FRGT-RLSE-DTE     TO TR405-EVENT-DTE             
              MOVE PV-HLD-CONTNR-SEQ-NBR         TO TR405-CONTNR-SEQ-NBR        
              MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE        
              MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT              
              PERFORM 7500-INSERT-SCM-MESSAGE                                   
            ELSE                                                                
             IF TR028-DLVRD-REC-TYP-CDE-DLVRDD                                  
              INITIALIZE TR405-MESSAGE-LAYOUT                                   
              MOVE 'A'                           TO TR405-ACTN-CDE              
              MOVE 'CONTNR PICKED UP'            TO TR405-EVENT-TYP             
              MOVE TR028-DLVRD-PO-NBR            TO TR405-PO-NBR                
              MOVE TR028-DLVRD-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
              MOVE TR028-DLVRD-CONTNR-ID         TO TR405-CONTNR-ID             
              MOVE TR028-DLVRD-CONTNR-PCKUP-DTE  TO TR405-EVENT-DTE             
              MOVE PV-HLD-CONTNR-SEQ-NBR         TO TR405-CONTNR-SEQ-NBR        
              MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE        
              MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT              
              PERFORM 7500-INSERT-SCM-MESSAGE                                   
             ELSE                                                               
             IF TR028-ARVDRD-REC-TYP-CD-ARVDRD                                  
              INITIALIZE TR405-MESSAGE-LAYOUT                                   
              MOVE 'A'                           TO TR405-ACTN-CDE              
              MOVE 'CONTNR ARRIVED AT DECON'     TO TR405-EVENT-TYP             
              MOVE TR028-ARVDRD-PO-NBR           TO TR405-PO-NBR                
              MOVE TR028-ARVDRD-EXTL-REF-NBR     TO TR405-EXTL-REF-NBR          
              MOVE TR028-ARVDRD-CONTNR-ID        TO TR405-CONTNR-ID             
              MOVE TR028-ARVDRD-ARRIVE-DECON-DTE TO TR405-EVENT-DTE             
              MOVE PV-HLD-CONTNR-SEQ-NBR         TO TR405-CONTNR-SEQ-NBR        
              MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE        
              MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT              
              PERFORM 7500-INSERT-SCM-MESSAGE                                   
             ELSE                                                               
             IF TR028-DVNRD-REC-TYP-CDE-DVNRDD                                  
              INITIALIZE TR405-MESSAGE-LAYOUT                                   
              MOVE 'A'                           TO TR405-ACTN-CDE              
              MOVE 'CONTNR DEVANNED'             TO TR405-EVENT-TYP             
              MOVE TR028-DVNRD-PO-NBR            TO TR405-PO-NBR                
              MOVE TR028-DVNRD-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
              MOVE TR028-DVNRD-CONTNR-ID         TO TR405-CONTNR-ID             
              MOVE TR028-DVNRD-CONTNR-DEVAN-DTE  TO TR405-EVENT-DTE             
              MOVE PV-HLD-CONTNR-SEQ-NBR         TO TR405-CONTNR-SEQ-NBR        
              MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE        
              MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT              
              PERFORM 7500-INSERT-SCM-MESSAGE.                                  
                                                                                
089500******************************************************************08560024
089600*    FORMAT MQ CHG MESSAGE                                       *08570018
089700******************************************************************08580018
                                                                                
      * MS 07/01/2010                                                           
      * ADDED THE CHECKS FOR ARVDCN TYPE OF RECORDS.                            
                                                                                
089800 2625-CHG-SCM-ARRIVAL-MSG.                                        08590018
           IF TR028-CRP-TRN-TYP-CHG                                             
            IF TR028-CRP-REC-TYP-CDE = 'CRP'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'CONTNR AVAIL FOR PICKUP'   TO TR405-EVENT-TYP                
             MOVE TR028-CRP-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-CRP-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-CRP-FRGT-RLSE-DTE     TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             IF PV-FORMAT-TMST-DTE (1:10) NOT =                                 
                                   IMCNTK-BKR-FRGT-RLSE-TMST (1:10)             
               IF PV-FORMAT-TMST-DTE (1:10) = PC-DEFAULT-TMST (1:10)            
                 MOVE 'D'                         TO TR405-ACTN-CDE             
                 MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT           
                 PERFORM 7500-INSERT-SCM-MESSAGE                                
               ELSE                                                             
                 IF IMCNTK-BKR-FRGT-RLSE-TMST = PC-DEFAULT-TMST                 
                   MOVE 'A'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 ELSE                                                           
                   MOVE 'C'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 END-IF                                                         
               END-IF                                                           
             END-IF                                                             
           ELSE                                                                 
            IF TR028-CRP-REC-TYP-CDE = 'DLV'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'CONTNR PICKED UP'          TO TR405-EVENT-TYP                
             MOVE TR028-DLV-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DLV-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DLV-CONTNR-PCKUP-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             IF PV-FORMAT-TMST-DTE (1:10) NOT =                                 
                                   IMCNTK-CONTNR-PU-TMST (1:10)                 
               IF PV-FORMAT-TMST-DTE (1:10) = PC-DEFAULT-TMST (1:10)            
                 MOVE 'D'                         TO TR405-ACTN-CDE             
                 MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT           
                 PERFORM 7500-INSERT-SCM-MESSAGE                                
               ELSE                                                             
                 IF IMCNTK-CONTNR-PU-TMST = PC-DEFAULT-TMST                     
                   MOVE 'A'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 ELSE                                                           
                   MOVE 'C'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 END-IF                                                         
               END-IF                                                           
             END-IF                                                             
            ELSE                                                                
            IF TR028-CRP-REC-TYP-CDE = 'ARVDCN'                                 
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'CONTNR ARRIVED AT DECON'      TO TR405-EVENT-TYP             
             MOVE TR028-ARVDCN-PO-NBR            TO TR405-PO-NBR                
             MOVE TR028-ARVDCN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
             MOVE TR028-DVN-CONTNR-ID            TO TR405-CONTNR-ID             
             MOVE TR028-ARVDCN-ARRIVE-DECON-DTE  TO TR405-EVENT-DTE             
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             IF PV-FORMAT-TMST-DTE (1:10) NOT =                                 
                                    IMCNTK-DCONSLR-DELY-TMST(1:10)              
                IF PV-FORMAT-TMST-DTE (1:10) = PC-DEFAULT-TMST (1:10)           
                   MOVE 'D'                      TO TR405-ACTN-CDE              
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                ELSE                                                            
                   IF IMCNTK-DCONSLR-DELY-TMST = PC-DEFAULT-TMST                
                      MOVE 'A'                   TO TR405-ACTN-CDE              
                      MOVE TR405-MESSAGE-LAYOUT  TO                             
                                                 TRT00041-CKPR-REC-1-TXT        
                      PERFORM 7500-INSERT-SCM-MESSAGE                           
                   ELSE                                                         
                      MOVE 'C'                   TO TR405-ACTN-CDE              
                      MOVE TR405-MESSAGE-LAYOUT  TO                             
                                                 TRT00041-CKPR-REC-1-TXT        
                      PERFORM 7500-INSERT-SCM-MESSAGE                           
                   END-IF                                                       
                 END-IF                                                         
             END-IF                                                             
            ELSE                                                                
            IF TR028-CRP-REC-TYP-CDE = 'DVN'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'CONTNR DEVANNED'           TO TR405-EVENT-TYP                
             MOVE TR028-DVN-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DVN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DVN-CONTNR-DEVAN-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             IF PV-FORMAT-TMST-DTE (1:10) NOT =                                 
                                   IMCNTK-DVN-TMST (1:10)                       
               IF PV-FORMAT-TMST-DTE (1:10) = PC-DEFAULT-TMST (1:10)            
                 MOVE 'D'                         TO TR405-ACTN-CDE             
                 MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT           
                 PERFORM 7500-INSERT-SCM-MESSAGE                                
               ELSE                                                             
                 IF IMCNTK-DVN-TMST = PC-DEFAULT-TMST                           
                   MOVE 'A'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 ELSE                                                           
                   MOVE 'C'                         TO TR405-ACTN-CDE           
                   MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT         
                   PERFORM 7500-INSERT-SCM-MESSAGE                              
                 END-IF                                                         
               END-IF                                                           
             END-IF.                                                            
                                                                                
089500******************************************************************08560024
089600*    FORMAT MQ DEL MESSAGE                                       *08570018
089700******************************************************************08580018
                                                                                
      * MS 07/01/2010                                                           
      * ADDED CHECKS FOR ARVDCN TYPE OF RECORDS.                                
                                                                                
089800 2630-DEL-SCM-ARRIVAL-MSG.                                        08590018
           IF TR028-CRP-TRN-TYP-DEL                                             
            IF TR028-CRP-REC-TYP-CDE = 'CRP'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'D'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR AVAIL FOR PICKUP'   TO TR405-EVENT-TYP                
             MOVE TR028-CRP-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-CRP-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-CRP-FRGT-RLSE-DTE     TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
           ELSE                                                                 
            IF TR028-CRP-REC-TYP-CDE = 'DLV'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'D'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR PICKED UP'          TO TR405-EVENT-TYP                
             MOVE TR028-DLV-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DLV-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DLV-CONTNR-PCKUP-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
            ELSE                                                                
            IF TR028-CRP-REC-TYP-CDE = 'ARVDCN'                                 
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'D'                            TO TR405-ACTN-CDE              
             MOVE 'CONTNR ARRIVED AT DECON'      TO TR405-EVENT-TYP             
             MOVE TR028-ARVDCN-PO-NBR            TO TR405-PO-NBR                
             MOVE TR028-ARVDCN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR          
             MOVE TR028-DVN-CONTNR-ID            TO TR405-CONTNR-ID             
             MOVE TR028-ARVDCN-ARRIVE-DECON-DTE  TO TR405-EVENT-DTE             
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE                                    
            ELSE                                                                
            IF TR028-CRP-REC-TYP-CDE = 'DVN'                                    
             INITIALIZE TR405-MESSAGE-LAYOUT                                    
             MOVE 'D'                         TO TR405-ACTN-CDE                 
             MOVE 'CONTNR DEVANNED'           TO TR405-EVENT-TYP                
             MOVE TR028-DVN-PO-NBR            TO TR405-PO-NBR                   
             MOVE TR028-DVN-EXTL-REF-NBR      TO TR405-EXTL-REF-NBR             
             MOVE TR028-DVN-CONTNR-ID         TO TR405-CONTNR-ID                
             MOVE TR028-DVN-CONTNR-DEVAN-DTE  TO TR405-EVENT-DTE                
             MOVE PV-HLD-CONTNR-SEQ-NBR       TO TR405-CONTNR-SEQ-NBR           
             MOVE PV-HLD-ORGN-SHPD-FR-CDE     TO TR405-ORGN-SHPD-FR-CDE         
             MOVE TR405-MESSAGE-LAYOUT TO TRT00041-CKPR-REC-1-TXT               
             PERFORM 7500-INSERT-SCM-MESSAGE.                                   
096000******************************************************************        
096100*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *        
096200******************************************************************        
096300 4000-GET-CHECKPOINT-CNTL.                                                
096400                                                                          
096500     PERFORM WITH TEST AFTER                                              
096600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
096700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                     
096800                 SQLCODE = ZERO                                           
096900                                                                          
097000         EXEC SQL                                                         
097100           SELECT  CKPT_STAT_CODE                                         
097200             INTO :PV-CKPT-STAT-CODE                                      
097300             FROM  TCKRSTCNTL                                             
097400            WHERE  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                   
097500         END-EXEC                                                         
097600                                                                          
097700         EVALUATE TRUE                                                    
097800             WHEN SQLCODE = ZERO                                          
097900             WHEN SQLCODE = -904                                          
098000             WHEN SQLCODE = -913                                          
098100                  CONTINUE                                                
098200                                                                          
098300             WHEN SQLWARN0 NOT EQUAL SPACE                                
098400             WHEN SQLCODE NOT EQUAL ZERO                                  
098500                 DISPLAY '**************************************'         
098600                 DISPLAY '** ABEND                            **'         
098700                 DISPLAY '** PROGRAM = TRKUP255               **'         
098800                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **'         
098900                 DISPLAY '**                  CNTL            **'         
099000                 DISPLAY '** SELECT FROM TCKRSTCNTL           **'         
099100                 DISPLAY '**CKPT-STAT-CODE ='                             
099200                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE           
099300                 DISPLAY '**************************************'         
099400                 PERFORM 9100-SQL-ABEND                                   
099500         END-EVALUATE                                                     
099600     END-PERFORM.                                                         
099700                                                                          
099800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
099900         SQLCODE NOT = ZERO                                               
100000         DISPLAY '****************************************'               
100100         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'               
100200         DISPLAY '** FROM TCKRSTCNTL                    **'               
100300         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'               
100400         DISPLAY '****************************************'               
100500         PERFORM 9100-SQL-ABEND                                           
100600     END-IF.                                                              
100700                                                                          
100800 EJECT                                                                    
100900                                                                          
101000******************************************************************        
101100*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *        
101200******************************************************************        
101300 4010-GET-CHECKPOINT-INFO.                                                
101400                                                                          
101500     PERFORM                                                              
101600         WITH TEST AFTER                                                  
101700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
101800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
101900                 SQLCODE = ZERO                                           
102000                                                                          
102100         EXEC SQL                                                         
102200           SELECT WORK_STRG_DESC                                          
102300           INTO :TCKRSTINF-WORK-STRG-DESC                                 
102400           FROM TCKRSTINF                                                 
102500           WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                     
102600         END-EXEC                                                         
102700                                                                          
102800         EVALUATE TRUE                                                    
102900             WHEN SQLCODE = ZERO                                          
103000             WHEN SQLCODE = -904                                          
103100             WHEN SQLCODE = -913                                          
103200                  CONTINUE                                                
103300                                                                          
103400             WHEN SQLWARN0 NOT EQUAL SPACE                                
103500             WHEN SQLCODE NOT EQUAL ZERO                                  
103600                 DISPLAY '**************************************'         
103700                 DISPLAY '** ABEND                            **'         
103800                 DISPLAY '** PROGRAM = TRKUP255               **'         
103900                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **'         
104000                 DISPLAY '**                  INFO            **'         
104100                 DISPLAY '** SELECT FROM TCKRSTINF            **'         
104200                 DISPLAY '**************************************'         
104300                 PERFORM 9100-SQL-ABEND                                   
104400         END-EVALUATE                                                     
104500     END-PERFORM.                                                         
104600                                                                          
104700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
104800         SQLCODE NOT = ZERO                                               
104900         DISPLAY '****************************************'               
105000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
105100         DISPLAY '** SELECT FROM TCKRSTINF              **'               
105200         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'               
105300         DISPLAY '****************************************'               
105400         PERFORM 9100-SQL-ABEND                                           
105500     END-IF.                                                              
105600                                                                          
105700 EJECT                                                                    
105800******************************************************************        
105900*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *        
106000******************************************************************        
106100 4020-SET-COMMIT-TIME.                                                    
106200                                                                          
106300      EXEC SQL                                                            
106400          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
106500          INTO :PV-HOLD-TMST                                              
106600          FROM TCKRSTCNTL                                                 
106700          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                      
106800      END-EXEC.                                                           
106900                                                                          
107000     EVALUATE TRUE                                                        
107100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
107200         WHEN SQLCODE NOT EQUAL ZERO                                      
107300     DISPLAY '**********************************'                         
107400     DISPLAY '** ABEND **'                                                
107500     DISPLAY '** PROGRAM = TRKUP255 **'                                   
107600     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'                      
107700     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'                     
107800     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID                 
107900     DISPLAY 'IMCNTK CNTR SEQ NBR   = '                                   
108000                IMCNTK-CONTNR-SEQ-NBR                                     
108100     DISPLAY 'DELIVERY INPUT COUNT   = ' PA-TOTAL-RECS-READ               
108200     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES              
108300     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES              
108400     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS             
108500     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS             
108600     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
108700     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
108800     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
108900     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
109000     DISPLAY '**********************************'                         
109100                                                                          
109200             PERFORM 9100-SQL-ABEND                                       
109300     END-EVALUATE.                                                        
109400                                                                          
109500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
109600         SQLCODE NOT = ZERO                                               
109700         DISPLAY '****************************************'               
109800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
109900         DISPLAY '** SELECT FROM TCKRSTCNTL             **'               
110000         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'               
110100         DISPLAY '****************************************'               
110200         PERFORM 9100-SQL-ABEND                                           
110300     END-IF.                                                              
110400                                                                          
110500 EJECT                                                                    
110600******************************************************************        
110700*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *        
110800******************************************************************        
110900 4100-COMMIT-CHECK.                                                       
111000                                                                          
111100     EXEC SQL                                                             
111200       SET :PV-TMST = CURRENT TIMESTAMP                                   
111300     END-EXEC.                                                            
111400                                                                          
111500     EVALUATE TRUE                                                        
111600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
111700         WHEN SQLCODE NOT EQUAL ZERO                                      
111800     DISPLAY '**********************************'                         
111900     DISPLAY '** ABEND **'                                                
112000     DISPLAY '** PROGRAM = TRKUP255***'                                   
112100     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                         
112200     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                          
112300     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID                 
112400     DISPLAY 'IMCNTK CNTR SEQ NBR   = '                                   
112500                IMCNTK-CONTNR-SEQ-NBR                                     
112600     DISPLAY 'DELIVERY INPUT COUNT   = ' PA-TOTAL-RECS-READ               
112700     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES              
112800     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES              
112900     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS             
113000     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS             
113100     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
113200     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
113300     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
113400     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
113500     DISPLAY '**********************************'                         
113600                                                                          
113700             PERFORM 9100-SQL-ABEND                                       
113800     END-EVALUATE.                                                        
113900                                                                          
114000     IF PV-TMST > PV-HOLD-TMST                                            
114100         IF NO-COMMITS-TAKEN                                              
114200             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE                 
114300             PERFORM 4200-UPDATE-TCKRSTCNTL                               
114400             SET COMMITS-TAKEN TO TRUE                                    
114500         END-IF                                                           
114600        PERFORM 4210-UPDATE-TCKRSTINF                                     
114700        PERFORM 4300-COMMIT                                               
114800        DISPLAY 'COMMIT TAKEN AT '                                        
114900        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)        
115000         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)        
115100        DISPLAY 'IMCNTK CONTAINER ID    = ' PV-HLD-CONTNR-ID              
115200        DISPLAY 'IMCNTK CNTR SEQ NBR    = '                               
115300                                         PV-HLD-CONTNR-SEQ-NBR            
115400        DISPLAY 'DELIVERY INPUT COUNT   = ' PA-TOTAL-RECS-READ            
115500        DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES           
115600        DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES           
115700        DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS          
115800        DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS          
115900        DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS              
116000        DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED          
116100        DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT          
116200        DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT         
116300        DISPLAY '**********************************'                      
116400        PERFORM 4020-SET-COMMIT-TIME                                      
116500     END-IF.                                                              
116600                                                                          
116700 EJECT                                                                    
116800******************************************************************        
116900*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *        
117000******************************************************************        
117100 4110-CHECKPOINT-RESTART.                                                 
117200                                                                          
117300     PERFORM 4010-GET-CHECKPOINT-INFO.                                    
117400     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.             
117500                                                                          
117600     DISPLAY '***********************************************'.           
117700     DISPLAY '** TRKUP255 CHECKPOINT RESTART **'.                         
117800     DISPLAY '** DELIVERY RECS BYPASSED ON RESTART = '.                   
117900     DISPLAY  CR-DELIVERY-RECS-WORKED.                                    
118000     DISPLAY '***********************************************'.           
118100                                                                          
118200     IF INPUT-DELIVERY-FILE                                               
118300         PERFORM 6000-READ-DELIVERY-FILE                                  
118400             CR-DELIVERY-RECS-WORKED TIMES                                
118500     ELSE                                                                 
118600         MOVE CR-DELIVERY-RECS-WORKED TO PA-TOTAL-RECS-READ               
118700         SET PS-END-OF-INPUT TO TRUE                                      
118800     END-IF.                                                              
118900                                                                          
119000 EJECT                                                                    
119100******************************************************************        
119200*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *        
119300*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *        
119400******************************************************************        
119500 4200-UPDATE-TCKRSTCNTL.                                                  
119600                                                                          
119700     PERFORM WITH TEST AFTER                                              
119800             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
119900             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
120000                     SQLCODE = ZERO                                       
120100                                                                          
120200         EXEC SQL                                                         
120300             UPDATE TCKRSTCNTL                                            
120400             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE                      
120500             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
120600         END-EXEC                                                         
120700                                                                          
120800         EVALUATE TRUE                                                    
120900             WHEN SQLCODE = ZERO                                          
121000             WHEN SQLCODE = -904                                          
121100             WHEN SQLCODE = -913                                          
121200                  CONTINUE                                                
121300                                                                          
121400             WHEN SQLWARN0 NOT EQUAL SPACE                                
121500             WHEN SQLCODE NOT EQUAL ZERO                                  
121600                 DISPLAY '**************************************'         
121700                 DISPLAY '** ABEND                            **'         
121800                 DISPLAY '** PROGRAM = TRKUP255               **'         
121900                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*'         
122000                 DISPLAY '** UPDATE TCKRSTCNTL                **'         
122100                 DISPLAY '**' PV-CKPT-STAT-CODE                           
122200                 DISPLAY '**************************************'         
122300                 PERFORM 9100-SQL-ABEND                                   
122400         END-EVALUATE                                                     
122500     END-PERFORM.                                                         
122600                                                                          
122700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
122800         SQLCODE NOT = ZERO                                               
122900         DISPLAY '****************************************'               
123000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
123100         DISPLAY '** UPDATE TO TCKRSTCNTL               **'               
123200         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'               
123300         DISPLAY '**' PV-CKPT-STAT-CODE                                   
123400         DISPLAY '****************************************'               
123500         PERFORM 9100-SQL-ABEND                                           
123600     END-IF.                                                              
123700                                                                          
123800 EJECT                                                                    
123900******************************************************************        
124000*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *        
124100*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *        
124200*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *        
124300******************************************************************        
124400 4210-UPDATE-TCKRSTINF.                                                   
124500                                                                          
124600     MOVE PA-TOTAL-RECS-READ  TO CR-DELIVERY-RECS-WORKED.                 
124700     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.           
124800     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.            
124900                                                                          
125000     PERFORM WITH TEST AFTER                                              
125100             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
125200             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
125300                     SQLCODE = ZERO                                       
125400                                                                          
125500         EXEC SQL                                                         
125600             UPDATE TCKRSTINF                                             
125700             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC             
125800             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
125900         END-EXEC                                                         
126000                                                                          
126100         EVALUATE TRUE                                                    
126200             WHEN SQLCODE = ZERO                                          
126300             WHEN SQLCODE = -904                                          
126400             WHEN SQLCODE = -913                                          
126500                  CONTINUE                                                
126600                                                                          
126700             WHEN SQLWARN0 NOT EQUAL SPACE                                
126800             WHEN SQLCODE NOT EQUAL ZERO                                  
126900                 DISPLAY '**************************************'         
127000                 DISPLAY '** ABEND                            **'         
127100                 DISPLAY '** PROGRAM = TRKUP255               **'         
127200                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**'         
127300                 DISPLAY '** UPDATE TCKRSTINF                 **'         
127400                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    
127500                 DISPLAY '**************************************'         
127600                 PERFORM 9100-SQL-ABEND                                   
127700         END-EVALUATE                                                     
127800     END-PERFORM.                                                         
127900                                                                          
128000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
128100         SQLCODE NOT = ZERO                                               
128200         DISPLAY '****************************************'               
128300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
128400         DISPLAY '** UPDATE TCKRSTINF                   **'               
128500         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'               
128600         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                            
128700         DISPLAY '****************************************'               
128800         PERFORM 9100-SQL-ABEND                                           
128900     END-IF.                                                              
129000                                                                          
129100 EJECT                                                                    
129200******************************************************************        
129300*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *        
129400*  COMPLETED.                                                    *        
129500******************************************************************        
129600 4300-COMMIT.                                                             
129700                                                                          
129800     EXEC SQL                                                             
129900         COMMIT                                                           
130000     END-EXEC.                                                            
130100                                                                          
130200     EVALUATE TRUE                                                        
130300         WHEN SQLWARN0 NOT EQUAL SPACE                                    
130400         WHEN SQLCODE NOT EQUAL ZERO                                      
130500     DISPLAY '**********************************'                         
130600     DISPLAY 'IMCNTK CONTAINER ID    = ' IMCNTK-CONTNR-ID                 
130700     DISPLAY 'IMCNTK CNTR SEQ NBR    = '                                  
130800                                         IMCNTK-CONTNR-SEQ-NBR            
130900     DISPLAY 'DELIVERY INPUT COUNT   = ' PA-TOTAL-RECS-READ               
131000     DISPLAY 'CNTK RECS UPDATE COUNT = ' PA-TOT-CNTK-UPDATES              
131100     DISPLAY 'CNPO RECS UPDATE COUNT = ' PA-TOT-CNPO-UPDATES              
131200     DISPLAY 'ACNTK REC INSERT COUNT = ' PA-TOT-ACNTK-INSERTS             
131300     DISPLAY 'ACNPO REC INSERT COUNT = ' PA-TOT-ACNPO-INSERTS             
131400     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
131500     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
131600     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
131700     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
131800     DISPLAY '**********************************'                         
131900     DISPLAY '** ABEND                        **'                         
132000     DISPLAY '** PROGRAM = TRKUP255           **'                         
132100     DISPLAY '** PARAGRAPH = 4300-COMMIT      **'                         
132200     DISPLAY '** UNSUCCESSFUL COMMIT          **'                         
132300     DISPLAY '**********************************'                         
132400             PERFORM 9100-SQL-ABEND                                       
132500         WHEN SQLCODE EQUAL ZERO                                          
132600             ADD +1 TO PA-TOTAL-COMMITS                                   
132700     END-EVALUATE.                                                        
132800                                                                          
132900 EJECT                                                                    
133000*****************************************************************         
133100* SETUP THE TR251 RECORD BY MOVING FIELDS THAT ARE INCLUDED IN  *         
133200* BOTH DETAIL AND ERROR RECORDS.                                *         
133300*****************************************************************         
133400                                                                          
      * MS 07/01/2010                                                           
      * ADDED PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.                 
                                                                                
133500 5000-MOVE-RPT-FIELDS.                                                    
133600                                                                          
133700     MOVE TR028-DPU-TRN-TYP        TO TR251-TRN-TYP.                      
133800     MOVE TR028-DPU-CONTNR-ID      TO TR251-CONTNR-ID.                    
133900     MOVE TR028-DPU-EXTL-REF-NBR   TO TR251-EXTL-REF-NBR.                 
134000     MOVE TR028-DPU-PO-NBR         TO TR251-PO-NBR.                       
134100                                                                          
134200     EVALUATE TR028-DPU-REC-TYP-CDE                                       
134300                                                                          
134400*        ---------------------------------------------------              
134500         WHEN PC-DPU                                                      
134600                                                                          
134700             MOVE TR028-DPU-PROCESS-SEQ-NBR                               
134800                        TO TR251-PROCESS-SEQ-NBR                          
134810             MOVE TR028-DPU-DAT-SRC-ENT-ID                                
134820                        TO TR251-DAT-SRC-ENT-ID                           
134900             MOVE TR028-DPU-REC-TYP-CDE                                   
135000                        TO TR251-REC-TYP-DPU-CDE                          
135100             MOVE TR028-DPU-SEQ-NBR                                       
135200                        TO TR251-DPU-SEQ-NBR                              
135300             MOVE TR028-DPU-IMPRT-VEH-NM                                  
135400                        TO TR251-DPU-IMPRT-VEH-NM                         
135500             MOVE TR028-DPU-DELY-ORD-RCVD-DTE                             
135600                        TO TR251-DPU-DELY-ORD-RCVD-DTE                    
135700             MOVE TR028-DPU-DELY-ORD-RCVD-TM                              
135800                        TO TR251-DPU-DELY-ORD-RCVD-TM                     
135900                                                                          
136000             MOVE TR028-DPU-DCONSLR-SCAC-ID                               
136100                        TO TR251-DCONSLR-SCAC-ID                          
136200             MOVE TR028-DPU-POE-NM                                        
136300                        TO TR251-POE-NM                                   
136400                                                                          
136500*        ---------------------------------------------------              
136600         WHEN PC-DPURDD                                                   
136700                                                                          
136800             MOVE TR028-DPURD-PROCESS-SEQ-NBR                             
136900                        TO TR251-PROCESS-SEQ-NBR                          
136910             MOVE TR028-DPURD-DAT-SRC-ENT-ID                              
136920                        TO TR251-DAT-SRC-ENT-ID                           
137000             MOVE TR028-DPURD-REC-TYP-CDE                                 
137100                        TO TR251-REC-TYP-DPURD-CDE                        
137200             MOVE TR028-DPURD-SEQ-NBR                                     
137300                        TO TR251-DPURD-SEQ-NBR                            
137400             MOVE TR028-DPURD-IMPRT-VEH-NM                                
137500                        TO TR251-DPURD-IMPRT-VEH-NM                       
137600             MOVE TR028-DPURD-DELY-ORD-RCVD-DTE                           
137700                        TO TR251-DPURD-DELY-ORD-RCVD-DTE                  
137800             MOVE TR028-DPURD-DELY-ORD-RCVD-TM                            
137900                        TO TR251-DPURD-DELY-ORD-RCVD-TM                   
138000                                                                          
138100             MOVE TR028-DPURD-DCONSLR-SCAC-ID                             
138200                        TO TR251-DCONSLR-SCAC-ID                          
138300             MOVE TR028-DPURD-POE-NM                                      
138400                        TO TR251-POE-NM                                   
138500                                                                          
138600*        ---------------------------------------------------              
138700         WHEN PC-DLV                                                      
138800                                                                          
138900             MOVE TR028-DLV-PROCESS-SEQ-NBR                               
139000                        TO TR251-PROCESS-SEQ-NBR                          
139010             MOVE TR028-DLV-DAT-SRC-ENT-ID                                
139020                        TO TR251-DAT-SRC-ENT-ID                           
139100             MOVE TR028-DLV-REC-TYP-CDE                                   
139200                        TO TR251-REC-TYP-DLV-CDE                          
139300             MOVE TR028-DLV-SEQ-NBR                                       
139400                        TO TR251-DLV-SEQ-NBR                              
139500             MOVE TR028-DLV-IMPRT-VEH-NM                                  
139600                        TO TR251-DLV-IMPRT-VEH-NM                         
139700             MOVE TR028-DLV-CONTNR-PCKUP-DTE                              
139800                        TO TR251-DLV-CONTNR-PCKUP-DTE                     
139900             MOVE TR028-DLV-CONTNR-PCKUP-TM                               
140000                        TO TR251-DLV-CONTNR-PCKUP-TM                      
140100                                                                          
140200             MOVE TR028-DLV-DCONSLR-SCAC-ID                               
140300                        TO TR251-DCONSLR-SCAC-ID                          
140400             MOVE TR028-DLV-POE-NM                                        
140500                        TO TR251-POE-NM                                   
140600                                                                          
140700*        ---------------------------------------------------              
140800         WHEN PC-DLVRDD                                                   
140900                                                                          
141000             MOVE TR028-DLVRD-PROCESS-SEQ-NBR                             
141100                        TO TR251-PROCESS-SEQ-NBR                          
141110             MOVE TR028-DLVRD-DAT-SRC-ENT-ID                              
141120                        TO TR251-DAT-SRC-ENT-ID                           
141200             MOVE TR028-DLVRD-REC-TYP-CDE                                 
141300                        TO TR251-REC-TYP-DLVRD-CDE                        
141400             MOVE TR028-DLVRD-SEQ-NBR                                     
141500                        TO TR251-DLVRD-SEQ-NBR                            
141600             MOVE TR028-DLVRD-IMPRT-VEH-NM                                
141700                        TO TR251-DLVRD-IMPRT-VEH-NM                       
141800             MOVE TR028-DLVRD-CONTNR-PCKUP-DTE                            
141900                        TO TR251-DLVRD-CONTNR-PCKUP-DTE                   
142000             MOVE TR028-DLVRD-CONTNR-PCKUP-TM                             
142100                        TO TR251-DLVRD-CONTNR-PCKUP-TM                    
142200                                                                          
142300             MOVE TR028-DLVRD-DCONSLR-SCAC-ID                             
142400                        TO TR251-DCONSLR-SCAC-ID                          
142500             MOVE TR028-DLVRD-POE-NM                                      
142600                        TO TR251-POE-NM                                   
142700                                                                          
      *        ---------------------------------------------------              
               WHEN PC-ARVDCN                                                   
                   MOVE TR028-ARVDCN-PROCESS-SEQ-NBR                            
                              TO TR251-PROCESS-SEQ-NBR                          
                   MOVE TR028-ARVDCN-DAT-SRC-ENT-ID                             
                              TO TR251-DAT-SRC-ENT-ID                           
                   MOVE TR028-ARVDCN-REC-TYP-CDE                                
                              TO TR251-REC-TYP-ARVDCN-CDE                       
                   MOVE TR028-ARVDCN-SEQ-NBR                                    
                              TO TR251-ARVDCN-SEQ-NBR                           
                   MOVE TR028-ARVDCN-IMPRT-VEH-NM                               
                              TO TR251-ARVDCN-IMPRT-VEH-NM                      
                   MOVE TR028-ARVDCN-ARRIVE-DECON-DTE                           
                              TO TR251-ARVDCN-ARRIVE-DECON-DTE                  
                   MOVE TR028-ARVDCN-ARRIVE-DECON-TM                            
                              TO TR251-ARVDCN-ARRIVE-DECON-TM                   
                   MOVE TR028-ARVDCN-DCONSLR-SCAC-ID                            
                              TO TR251-DCONSLR-SCAC-ID                          
                   MOVE TR028-ARVDCN-POE-NM                                     
                              TO TR251-POE-NM                                   
                                                                                
      *        ---------------------------------------------------              
               WHEN PC-ARVDRD                                                   
                   MOVE TR028-ARVDRD-PROCESS-SEQ-NBR                            
                              TO TR251-PROCESS-SEQ-NBR                          
                   MOVE TR028-ARVDRD-DAT-SRC-ENT-ID                             
                              TO TR251-DAT-SRC-ENT-ID                           
                   MOVE TR028-ARVDRD-REC-TYP-CDE                                
                              TO TR251-REC-TYP-ARVDRD-CDE                       
                   MOVE TR028-ARVDRD-SEQ-NBR                                    
                              TO TR251-ARVDRD-SEQ-NBR                           
                   MOVE TR028-ARVDRD-IMPRT-VEH-NM                               
                              TO TR251-ARVDRD-IMPRT-VEH-NM                      
                   MOVE TR028-ARVDRD-ARRIVE-DECON-DTE                           
                              TO TR251-ARVDRD-ARRIVE-DECON-DTE                  
                   MOVE TR028-ARVDRD-ARRIVE-DECON-TM                            
                              TO TR251-ARVDRD-ARRIVE-DECON-TM                   
                   MOVE TR028-ARVDRD-DCONSLR-SCAC-ID                            
                              TO TR251-DCONSLR-SCAC-ID                          
                   MOVE TR028-ARVDRD-POE-NM                                     
                              TO TR251-POE-NM                                   
                                                                                
142800*        ---------------------------------------------------              
142900         WHEN PC-DVN                                                      
143000             MOVE TR028-DVN-PROCESS-SEQ-NBR                               
143100                        TO TR251-PROCESS-SEQ-NBR                          
143110             MOVE TR028-DVN-DAT-SRC-ENT-ID                                
143120                        TO TR251-DAT-SRC-ENT-ID                           
143200             MOVE TR028-DVN-REC-TYP-CDE                                   
143300                        TO TR251-REC-TYP-DVN-CDE                          
143400             MOVE TR028-DVN-SEQ-NBR                                       
143500                        TO TR251-DVN-SEQ-NBR                              
143600             MOVE TR028-DVN-IMPRT-VEH-NM                                  
143700                        TO TR251-DVN-IMPRT-VEH-NM                         
143800             MOVE TR028-DVN-CONTNR-DEVAN-DTE                              
143900                        TO TR251-DVN-CONTNR-DEVAN-DTE                     
144000             MOVE TR028-DVN-CONTNR-DEVAN-TM                               
144100                        TO TR251-DVN-CONTNR-DEVAN-TM                      
144200             MOVE TR028-DVN-DCONSLR-SCAC-ID                               
144300                        TO TR251-DCONSLR-SCAC-ID                          
144400             MOVE TR028-DVN-POE-NM                                        
144500                        TO TR251-POE-NM                                   
144600                                                                          
144700*        ---------------------------------------------------              
144800         WHEN PC-DVNRDD                                                   
144900             MOVE TR028-DVNRD-PROCESS-SEQ-NBR                             
145000                        TO TR251-PROCESS-SEQ-NBR                          
145010             MOVE TR028-DVNRD-DAT-SRC-ENT-ID                              
145020                        TO TR251-DAT-SRC-ENT-ID                           
145100             MOVE TR028-DVNRD-REC-TYP-CDE                                 
145200                        TO TR251-REC-TYP-DVNRD-CDE                        
145300             MOVE TR028-DVNRD-SEQ-NBR                                     
145400                        TO TR251-DVNRD-SEQ-NBR                            
145500             MOVE TR028-DVNRD-IMPRT-VEH-NM                                
145600                        TO TR251-DVNRD-IMPRT-VEH-NM                       
145700             MOVE TR028-DVNRD-CONTNR-DEVAN-DTE                            
145800                        TO TR251-DVNRD-CONTNR-DEVAN-DTE                   
145900             MOVE TR028-DVNRD-CONTNR-DEVAN-TM                             
146000                        TO TR251-DVNRD-CONTNR-DEVAN-TM                    
146100             MOVE TR028-DVNRD-DCONSLR-SCAC-ID                             
146200                        TO TR251-DCONSLR-SCAC-ID                          
146300             MOVE TR028-DVNRD-POE-NM                                      
146400                        TO TR251-POE-NM                                   
146500                                                                          
146600*        ---------------------------------------------------              
146700         WHEN PC-CRP                                                      
146800             MOVE TR028-CRP-PROCESS-SEQ-NBR                               
146900                        TO TR251-PROCESS-SEQ-NBR                          
146910             MOVE TR028-CRP-DAT-SRC-ENT-ID                                
146920                        TO TR251-DAT-SRC-ENT-ID                           
147000             MOVE TR028-CRP-REC-TYP-CDE                                   
147100                        TO TR251-REC-TYP-CRP-CDE                          
147200             MOVE TR028-CRP-SEQ-NBR                                       
147300                        TO TR251-CRP-SEQ-NBR                              
147400             MOVE TR028-CRP-IMPRT-VEH-NM                                  
147500                        TO TR251-CRP-IMPRT-VEH-NM                         
147600             MOVE TR028-CRP-FRGT-RLSE-DTE                                 
147700                        TO TR251-CRP-FRGT-RLSE-DTE                        
147800             MOVE TR028-CRP-FRGT-RLSE-TM                                  
147900                        TO TR251-CRP-FRGT-RLSE-TM                         
148000             MOVE TR028-CRP-DCONSLR-SCAC-ID                               
148100                        TO TR251-DCONSLR-SCAC-ID                          
148200             MOVE TR028-CRP-POE-NM                                        
148300                        TO TR251-POE-NM                                   
148400                                                                          
148500*        ---------------------------------------------------              
148600         WHEN PC-CRPRDD                                                   
148700             MOVE TR028-CRPRD-PROCESS-SEQ-NBR                             
148800                        TO TR251-PROCESS-SEQ-NBR                          
148810             MOVE TR028-CRPRD-DAT-SRC-ENT-ID                              
148820                        TO TR251-DAT-SRC-ENT-ID                           
148900             MOVE TR028-CRPRD-REC-TYP-CDE                                 
149000                        TO TR251-REC-TYP-CRPRD-CDE                        
149100             MOVE TR028-CRPRD-SEQ-NBR                                     
149200                        TO TR251-CRPRD-SEQ-NBR                            
149300             MOVE TR028-CRPRD-IMPRT-VEH-NM                                
149400                        TO TR251-CRPRD-IMPRT-VEH-NM                       
149500             MOVE TR028-CRPRD-FRGT-RLSE-DTE                               
149600                        TO TR251-CRPRD-FRGT-RLSE-DTE                      
149700             MOVE TR028-CRPRD-FRGT-RLSE-TM                                
149800                        TO TR251-CRPRD-FRGT-RLSE-TM                       
149900             MOVE TR028-CRP-DCONSLR-SCAC-ID                               
150000                        TO TR251-DCONSLR-SCAC-ID                          
150100             MOVE TR028-CRP-POE-NM                                        
150200                        TO TR251-POE-NM                                   
150300                                                                          
150400*        ---------------------------------------------------              
150500         WHEN PC-RTN                                                      
150600             MOVE TR028-RTN-PROCESS-SEQ-NBR                               
150700                        TO TR251-PROCESS-SEQ-NBR                          
150710             MOVE TR028-RTN-DAT-SRC-ENT-ID                                
150720                        TO TR251-DAT-SRC-ENT-ID                           
150800             MOVE TR028-RTN-REC-TYP-CDE                                   
150900                        TO TR251-REC-TYP-RTN-CDE                          
151000             MOVE TR028-RTN-SEQ-NBR                                       
151100                        TO TR251-RTN-SEQ-NBR                              
151200             MOVE TR028-RTN-IMPRT-VEH-NM                                  
151300                        TO TR251-RTN-IMPRT-VEH-NM                         
151400             MOVE TR028-RTN-CONTNR-RETURN-DTE                             
151500                        TO TR251-RTN-CONTNR-RETURN-DTE                    
151600             MOVE TR028-RTN-CONTNR-RETURN-TM                              
151700                        TO TR251-RTN-CONTNR-RETURN-TM                     
151800             MOVE TR028-RTN-DCONSLR-SCAC-ID                               
151900                        TO TR251-DCONSLR-SCAC-ID                          
152000             MOVE TR028-RTN-POE-NM                                        
152100                        TO TR251-POE-NM                                   
152200                                                                          
152300*        ---------------------------------------------------              
152400         WHEN PC-RTNRDD                                                   
152500             MOVE TR028-RTNRD-PROCESS-SEQ-NBR                             
152600                        TO TR251-PROCESS-SEQ-NBR                          
152610             MOVE TR028-RTNRD-DAT-SRC-ENT-ID                              
152620                        TO TR251-DAT-SRC-ENT-ID                           
152700             MOVE TR028-RTNRD-REC-TYP-CDE                                 
152800                        TO TR251-REC-TYP-RTNRD-CDE                        
152900             MOVE TR028-RTNRD-SEQ-NBR                                     
153000                        TO TR251-RTNRD-SEQ-NBR                            
153100             MOVE TR028-RTNRD-IMPRT-VEH-NM                                
153200                        TO TR251-RTNRD-IMPRT-VEH-NM                       
153300             MOVE TR028-RTNRD-CONTNR-RETURN-DTE                           
153400                        TO TR251-RTNRD-CONTNR-RETURN-DTE                  
153500             MOVE TR028-RTNRD-CONTNR-RETURN-TM                            
153600                        TO TR251-RTNRD-CONTNR-RETURN-TM                   
153700             MOVE TR028-RTNRD-DCONSLR-SCAC-ID                             
153800                        TO TR251-DCONSLR-SCAC-ID                          
153900             MOVE TR028-RTNRD-POE-NM                                      
154000                        TO TR251-POE-NM                                   
154100                                                                          
154200     END-EVALUATE.                                                        
154300                                                                          
154400 EJECT                                                                    
154500******************************************************************        
154600* SETUP THE TAUCNTK DCLGEN FIELDS PRIOR TO INSERT.               *        
154700******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED FIELD MOVEMENT FOR THE DCONSLR_DELY_TMST.                         
                                                                                
154800 5100-MOVE-TIMCNTK-TO-TAUCNTK.                                            
154900                                                                          
155000     INITIALIZE DCLTAUCNTK.                                               
155100                                                                          
155200     MOVE IMCNTK-CONTNR-ID          TO AUCNTK-CONTNR-ID.                  
155300     MOVE IMCNTK-CONTNR-SEQ-NBR     TO AUCNTK-CONTNR-SEQ-NBR.             
155500     MOVE IMCNTK-CONSLR-SCAC-ID     TO AUCNTK-CONSLR-SCAC-ID.             
155600     MOVE IMCNTK-MOM-IMPRT-TRIP-ID  TO AUCNTK-MOM-IMPRT-TRIP-ID.          
155700     MOVE IMCNTK-MOM-DPRTR-TMST     TO AUCNTK-MOM-DPRTR-TMST.             
155800     MOVE IMCNTK-MOM-POE-DELY-TMST  TO AUCNTK-MOM-POE-DELY-TMST.          
155900     MOVE IMCNTK-MOM-CARR-SCAC-ID   TO AUCNTK-MOM-CARR-SCAC-ID.           
156000     MOVE IMCNTK-MOM-POL-CDE        TO AUCNTK-MOM-POL-CDE.                
156100     MOVE IMCNTK-MOM-IMPRT-VEH-NM   TO AUCNTK-MOM-IMPRT-VEH-NM.           
156200     MOVE IMCNTK-MOM-TRIP-TYP-CDE   TO AUCNTK-MOM-TRIP-TYP-CDE.           
156300     MOVE IMCNTK-MOM-DEST-POE-CDE   TO AUCNTK-MOM-DEST-POE-CDE.           
156400     MOVE IMCNTK-FDR-IMPRT-TRIP-ID  TO AUCNTK-FDR-IMPRT-TRIP-ID.          
156500     MOVE IMCNTK-FDR-DPRTR-TMST     TO AUCNTK-FDR-DPRTR-TMST.             
156600     MOVE IMCNTK-FDR-POE-DELY-TMST  TO AUCNTK-FDR-POE-DELY-TMST.          
156700     MOVE IMCNTK-FDR-CARR-SCAC-ID   TO AUCNTK-FDR-CARR-SCAC-ID.           
156800     MOVE IMCNTK-FDR-POL-CDE        TO AUCNTK-FDR-POL-CDE.                
156900     MOVE IMCNTK-FDR-IMPRT-VEH-NM   TO AUCNTK-FDR-IMPRT-VEH-NM.           
157000     MOVE IMCNTK-FDR-TRIP-TYP-CDE   TO AUCNTK-FDR-TRIP-TYP-CDE.           
157100     MOVE IMCNTK-FDR-DEST-POE-CDE   TO AUCNTK-FDR-DEST-POE-CDE.           
157200     MOVE IMCNTK-SIZE-CDE           TO AUCNTK-SIZE-CDE.                   
157300     MOVE IMCNTK-CART-CNT           TO AUCNTK-CART-CNT.                   
157400     MOVE IMCNTK-CBMT-QTY           TO AUCNTK-CBMT-QTY.                   
157500     MOVE IMCNTK-WT-KGRM-QTY        TO AUCNTK-WT-KGRM-QTY.                
157600     MOVE IMCNTK-UNT-QTY            TO AUCNTK-UNT-QTY.                    
157900     MOVE IMCNTK-ORGN-SHPD-FR-CDE   TO AUCNTK-ORGN-SHPD-FR-CDE.           
158000     MOVE IMCNTK-ORGN-SHPD-TO-CDE   TO AUCNTK-ORGN-SHPD-TO-CDE.           
158100     MOVE IMCNTK-EST-LBD-NM         TO AUCNTK-EST-LBD-NM.                 
158200     MOVE IMCNTK-EST-LBD-TMST       TO AUCNTK-EST-LBD-TMST.               
158300     MOVE IMCNTK-RISU-DO-RSN-CDE    TO AUCNTK-RISU-DO-RSN-CDE.            
158400     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO AUCNTK-BKR-FRGT-RLSE-TMST.         
158500     MOVE IMCNTK-DO-TO-DCONSLR-TMST TO AUCNTK-DO-TO-DCONSLR-TMST.         
158600     MOVE IMCNTK-DO-RCVD-TMST       TO AUCNTK-DO-RCVD-TMST.               
158700     MOVE IMCNTK-CONTNR-PU-TMST     TO AUCNTK-CONTNR-PU-TMST.             
158800     MOVE IMCNTK-DAT-SRC-ENT-ID     TO AUCNTK-DAT-SRC-ENT-ID.             
158900     MOVE IMCNTK-LAST-UPD-BY-USR-ID TO AUCNTK-LAST-UPD-BY-USR-ID.         
159000     MOVE IMCNTK-LAST-UPD-TMST      TO AUCNTK-LAST-UPD-TMST.              
159100     MOVE IMCNTK-ACTL-POE-DELY-TMST TO AUCNTK-ACTL-POE-DELY-TMST.         
159200     MOVE IMCNTK-ACTL-DEST-POE-CDE  TO AUCNTK-ACTL-DEST-POE-CDE.          
159300     MOVE IMCNTK-ACTL-LBD-TMST      TO AUCNTK-ACTL-LBD-TMST.              
159400     MOVE IMCNTK-ACTL-LBD-NM        TO AUCNTK-ACTL-LBD-NM.                
159500     MOVE IMCNTK-DVN-TMST           TO AUCNTK-DVN-TMST.                   
159600     MOVE IMCNTK-DCONSLR-SCAC-ID    TO AUCNTK-DCONSLR-SCAC-ID.            
159700     MOVE IMCNTK-DCONSLR-RET-TMST   TO AUCNTK-DCONSLR-RET-TMST.           
159800     MOVE IMCNTK-MOM-FOB-CDE        TO AUCNTK-MOM-FOB-CDE.                
159900     MOVE IMCNTK-FDR-FOB-CDE        TO AUCNTK-FDR-FOB-CDE.                
160000     MOVE IMCNTK-MOM-POR-CDE        TO AUCNTK-MOM-POR-CDE.                
160001     MOVE IMCNTK-FDR-POR-CDE        TO AUCNTK-FDR-POR-CDE.                
           MOVE IMCNTK-DCONSLR-DELY-TMST  TO AUCNTK-DCONSLR-DELY-TMST.          
160002                                                                          
160003     IF TR028-DPU-TRN-TYP = PC-D                                          
160004         MOVE PC-D                  TO AUCNTK-AUD-FUNC-CDE                
160100     ELSE                                                                 
160200         MOVE PC-U                  TO AUCNTK-AUD-FUNC-CDE                
160300     END-IF.                                                              
160400                                                                          
160500     PERFORM 7999-SET-CURRENT-TMST.                                       
160600     MOVE PV-CURRENT-TMST           TO AUCNTK-AUD-TMST.                   
160700                                                                          
160800******************************************************************        
160900* SETUP THE TAUCNPO DCLGEN FIELDS PRIOR TO INSERT.               *        
161000******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED FIELD MOVEMENT FOR THE DCONSLR_DELY_CDE.                          
                                                                                
161100 5110-MOVE-TIMCNPO-TO-TAUCNPO.                                            
161200                                                                          
161300     INITIALIZE DCLTAUCNPO.                                               
161400                                                                          
161500     MOVE IMCNPO-CONTNR-ID          TO AUCNPO-CONTNR-ID.                  
161600     MOVE IMCNPO-CONTNR-SEQ-NBR     TO AUCNPO-CONTNR-SEQ-NBR.             
161700     MOVE IMCNPO-PO-NBR             TO AUCNPO-PO-NBR.                     
161800     MOVE IMCNPO-CSTM-ENTR-ID       TO AUCNPO-CSTM-ENTR-ID.               
161900     MOVE IMCNPO-MSTR-BOL-NBR       TO AUCNPO-MSTR-BOL-NBR.               
162000     MOVE IMCNPO-HSE-BOL-NBR        TO AUCNPO-HSE-BOL-NBR.                
162100     MOVE IMCNPO-LTR-OF-CR-NBR      TO AUCNPO-LTR-OF-CR-NBR.              
162200     MOVE IMCNPO-PO-RCVD-DELY-TMST  TO AUCNPO-PO-RCVD-DELY-TMST.          
162300     MOVE IMCNPO-PO-C-O-PROD-CDE    TO AUCNPO-PO-C-O-PROD-CDE.            
162400     MOVE IMCNPO-PO-CART-CNT        TO AUCNPO-PO-CART-CNT.                
162500     MOVE IMCNPO-PO-CBMT-QTY        TO AUCNPO-PO-CBMT-QTY.                
162600     MOVE IMCNPO-PO-WT-KGRM-QTY     TO AUCNPO-PO-WT-KGRM-QTY.             
162700     MOVE IMCNPO-PO-UNT-QTY         TO AUCNPO-PO-UNT-QTY.                 
163000     MOVE IMCNPO-LAST-UPD-BY-USR-ID TO AUCNPO-LAST-UPD-BY-USR-ID.         
163100     MOVE IMCNPO-LAST-UPD-TMST      TO AUCNPO-LAST-UPD-TMST.              
163200     MOVE IMCNPO-EXTL-REF-NBR       TO AUCNPO-EXTL-REF-NBR.               
163300     MOVE IMCNPO-BKR-FRGT-RLSE-CDE  TO AUCNPO-BKR-FRGT-RLSE-CDE.          
163400     MOVE IMCNPO-DO-RCVD-CDE        TO AUCNPO-DO-RCVD-CDE.                
163500     MOVE IMCNPO-CONTNR-PU-CDE      TO AUCNPO-CONTNR-PU-CDE.              
163600     MOVE IMCNPO-ACTL-POE-DELY-CDE  TO AUCNPO-ACTL-POE-DELY-CDE.          
163700     MOVE IMCNPO-DVN-CDE            TO AUCNPO-DVN-CDE.                    
163800     MOVE IMCNPO-DCONSLR-RET-CDE    TO AUCNPO-DCONSLR-RET-CDE.            
163810     MOVE IMCNPO-SPLT-XMIT-CDE      TO AUCNPO-SPLT-XMIT-CDE.              
163820     MOVE IMCNPO-DOC-RCVD-ORGN-TMST TO AUCNPO-DOC-RCVD-ORGN-TMST.         
           MOVE IMCNPO-DCONSLR-DELY-CDE   TO AUCNPO-DCONSLR-DELY-CDE.           
163900                                                                          
164000     IF TR028-DPU-TRN-TYP = PC-D                                          
164100         MOVE PC-D                  TO AUCNPO-AUD-FUNC-CDE                
164200     ELSE                                                                 
164300         MOVE PC-U                  TO AUCNPO-AUD-FUNC-CDE                
164400     END-IF.                                                              
164500                                                                          
164600     MOVE PV-CURRENT-TMST           TO AUCNPO-AUD-TMST.                   
164700                                                                          
164800******************************************************************        
164900* SETUP THE HOLD FIELDS PRIOR TO ADD UPDATE PROCESSING           *        
165000******************************************************************        
165100                                                                          
      * MS 07/01/2010                                                           
      * MOVEMENT OF DCONSLR_DELY_TMST TO THE WORKING STORAGE VARIABLE.          
                                                                                
165200 5200-MOVE-TIMCNTK-TO-HOLD.                                               
165300                                                                          
165400     MOVE IMCNTK-CONTNR-ID                                                
165500                          TO PV-HLD-CONTNR-ID.                            
165600     MOVE IMCNTK-CONTNR-SEQ-NBR                                           
165700                          TO PV-HLD-CONTNR-SEQ-NBR.                       
165600     MOVE IMCNTK-ORGN-SHPD-FR-CDE                                         
165700                          TO PV-HLD-ORGN-SHPD-FR-CDE.                     
166100     MOVE IMCNTK-DO-RCVD-TMST                                             
166200                          TO PV-HLD-DO-RCVD-TMST.                         
166300     MOVE IMCNTK-CONTNR-PU-TMST                                           
166400                          TO PV-HLD-CONTNR-PU-TMST.                       
166500     MOVE IMCNTK-DCONSLR-SCAC-ID                                          
166600                          TO PV-HLD-DCONSLR-SCAC-ID.                      
166700     MOVE IMCNTK-DVN-TMST                                                 
166800                          TO PV-HLD-DVN-TMST.                             
166900     MOVE IMCNTK-BKR-FRGT-RLSE-TMST                                       
167000                          TO PV-HLD-BKR-FRGT-RLSE-TMST.                   
167100     MOVE IMCNTK-DCONSLR-RET-TMST                                         
167200                          TO PV-HLD-RET-TMST.                             
           MOVE IMCNTK-DCONSLR-DELY-TMST                                        
                                TO PV-HLD-DCONSLR-ARR-TMST.                     
168320 EJECT                                                                    
168400                                                                          
168401******************************************************************        
168402* SETUP THE HOLD FIELDS PRIOR TO ADD UPDATE PROCESSING           *        
168403******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * MOVEMENT OF THE DCONSLR_DELY_CDE TO WORKING STORAGE VARIABLE.           
                                                                                
168410 5210-MOVE-TIMCNPO-TO-HOLD.                                               
168420                                                                          
168430     MOVE IMCNPO-CONTNR-ID                                                
168440                          TO PV-HLD-CONTNR-ID.                            
168450     MOVE IMCNPO-CONTNR-SEQ-NBR                                           
168460                          TO PV-HLD-CONTNR-SEQ-NBR.                       
168470     MOVE IMCNPO-PO-NBR   TO PV-HLD-PO-NBR.                               
168501     MOVE IMCNPO-BKR-FRGT-RLSE-CDE                                        
168502                          TO PV-HLD-BKR-FRGT-RLSE-CDE.                    
168503     MOVE IMCNPO-DO-RCVD-CDE                                              
168504                          TO PV-HLD-DO-RCVD-CDE.                          
168505     MOVE IMCNPO-CONTNR-PU-CDE                                            
168506                          TO PV-HLD-CONTNR-PU-CDE.                        
168507     MOVE IMCNPO-DVN-CDE  TO PV-HLD-DVN-CDE.                              
168508     MOVE IMCNPO-DCONSLR-RET-CDE                                          
168509                          TO PV-HLD-DCONSLR-RET-CDE.                      
           MOVE IMCNPO-DCONSLR-DELY-CDE                                         
                                TO PV-HLD-DCONSLR-ARR-IND.                      
168510                                                                          
168520******************************************************************        
168600* READ THE VESSEL-VOYAGE DELIVERY FILE.                          *        
168700******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.                 
                                                                                
168800 6000-READ-DELIVERY-FILE.                                                 
168900                                                                          
169000     READ TR028-DELIVERY-FILE                                             
169100         INTO TR028-REC-TYP-DPU                                           
169200         AT END                                                           
169300           SET PS-END-OF-INPUT TO TRUE.                                   
169400                                                                          
169500     IF PS-END-OF-INPUT                                                   
169600         CONTINUE                                                         
169700     ELSE                                                                 
169800         MOVE TR028-REC-TYP-DPU (1:3)   TO PV-EDI-RECORDS                 
169900         IF EDI-RECORD                                                    
170000             ADD +1 TO PA-TOT-EDI-RECS-READ                               
170100                       PA-TOTAL-RECS-READ                                 
170200         ELSE                                                             
170300             SET PS-GOOD-RECORD TO TRUE                                   
170400             ADD +1 TO PA-TOTAL-RECS-READ                                 
170500             EVALUATE TR028-DPU-REC-TYP-CDE                               
170600                 WHEN PC-DPU                                              
170700                    ADD +1 TO PA-TOT-DPU-RECS-READ                        
170800                 WHEN PC-DLV                                              
170900                    ADD +1 TO PA-TOT-DLV-RECS-READ                        
                       WHEN PC-ARVDCN                                           
                          ADD +1 TO PA-TOT-ARVDCN-RECS-READ                     
171000                 WHEN PC-DVN                                              
171100                    ADD +1 TO PA-TOT-DVN-RECS-READ                        
171200                 WHEN PC-CRP                                              
171300                    ADD +1 TO PA-TOT-CRP-RECS-READ                        
171400                 WHEN PC-RTN                                              
171500                    ADD +1 TO PA-TOT-RTN-RECS-READ                        
171600                 WHEN PC-DPURDD                                           
171700                    ADD +1 TO PA-TOT-DPURD-RECS-READ                      
171800                 WHEN PC-DLVRDD                                           
171900                    ADD +1 TO PA-TOT-DLVRD-RECS-READ                      
                       WHEN PC-ARVDRD                                           
                          ADD +1 TO PA-TOT-ARVDRD-RECS-READ                     
172000                 WHEN PC-DVNRDD                                           
172100                    ADD +1 TO PA-TOT-DVNRD-RECS-READ                      
172200                 WHEN PC-CRPRDD                                           
172300                    ADD +1 TO PA-TOT-CRPRD-RECS-READ                      
172400                 WHEN PC-RTNRDD                                           
172500                    ADD +1 TO PA-TOT-RTNRD-RECS-READ                      
172600             END-EVALUATE                                                 
172700         END-IF                                                           
172800     END-IF.                                                              
172900                                                                          
173000                                                                          
173100*****************************************************************         
173200* LOAD THE ERROR FIELDS WHEN CONTAINER ON TIMCNTK DOES NOT MATCH*         
173300* WHAT THE CONSOLIDATOR HAS SENT.                               *         
173400*****************************************************************         
173500                                                                          
173600 6307-CONTAINER-NOT-FOUND-ERROR.                                          
173700                                                                          
173800     MOVE PC-E                  TO TR251-RPT-TYP.                         
173900     MOVE 'CONTNR ID'           TO TR251-DATA-IN-ERROR.                   
174000     MOVE TR028-DPU-CONTNR-ID   TO TR251-DATA-VALUE.                      
174100     MOVE PC-ERROR              TO TR251-ERROR-TYPE.                      
174200                                                                          
175600     EVALUATE TR028-DPU-TRN-TYP                                           
175700         WHEN PC-A                                                        
175800             MOVE                                                         
175900                'ADD SENT - CONT/PO NOT FND - NOT PROCESSED'              
176000                     TO TR251-ERROR-MSG                                   
176100         WHEN PC-C                                                        
176200             MOVE                                                         
176300                'CHANGE SENT - CONT/PO NOT FND - NOT PROCESSED'           
176400                     TO TR251-ERROR-MSG                                   
176500         WHEN PC-D                                                        
176600             MOVE                                                         
176700                'DELETE SENT - CONT/PO NOT FND - NOT PROCESSED'           
176800                     TO TR251-ERROR-MSG                                   
176900     END-EVALUATE.                                                        
177000                                                                          
179000******************************************************************        
179000******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED CHECK FOR ARVDCN AND ARVDRD TYPE OF RECORD.                       
                                                                                
       6308-ADD-SNT-SHOULD-BE-CHG-ERR.                                          
                                                                                
           INITIALIZE TR251-RECORD                                              
173800     MOVE PC-E                  TO TR251-RPT-TYP.                         
173900     MOVE 'CONTNR ID'           TO TR251-DATA-IN-ERROR.                   
174000     MOVE TR028-DPU-CONTNR-ID   TO TR251-DATA-VALUE.                      
174100     MOVE PC-ERROR              TO TR251-ERROR-TYPE.                      
174200                                                                          
      *         DISPLAY '**************************************'                
      *         DISPLAY '** 6308-ADD-SNT-SHOULD-BE-CHG-ERR'                     
      *         DISPLAY '** TR028-DPU-TRN-TYP=' TR028-DPU-TRN-TYP               
      *       DISPLAY '** TR028-DPU-REC-TYP-CDE=' TR028-DPU-REC-TYP-CDE         
      *         DISPLAY '** TR028-DPU-PO-NBR=' TR028-DPU-PO-NBR                 
      *     DISPLAY '** TR028-DPU-EXTL-REF-NBR=' TR028-DPU-EXTL-REF-NBR         
      *         DISPLAY '** TR028-DPU-CONTNR-ID=' TR028-DPU-CONTNR-ID           
      *     DISPLAY '** TR028-DPU-REC-TYP-CDE=' TR028-DPU-REC-TYP-CDE           
      *         DISPLAY '** PROGRAM = TRKUP255               **'                
      *         DISPLAY '**************************************'                
175600     EVALUATE TR028-DPU-TRN-TYP                                           
175700         WHEN PC-A                                                        
                 EVALUATE TR028-DPU-REC-TYP-CDE                                 
                   WHEN PC-DPU                                                  
                   WHEN PC-DPURDD                                               
175800               MOVE                                                       
175900                  'ADD SENT - DO RCVD DATE FOUND - NOT PROCESSED'         
176000                       TO TR251-ERROR-MSG                                 
175800             WHEN PC-DLV                                                  
175800             WHEN PC-DLVRDD                                               
175800               MOVE                                                       
175900             'ADD SENT - CNTNR PCK-UP DATE FOUND - NOT PROCESSED'         
176000                       TO TR251-ERROR-MSG                                 
                   WHEN PC-ARVDCN                                               
                   WHEN PC-ARVDRD                                               
                     MOVE                                                       
                     'ADD SENT - DECON ARRIV DATE FOUND - NOT PROCESSED'        
                             TO TR251-ERROR-MSG                                 
175900             WHEN PC-DVN                                                  
175900             WHEN PC-DVNRDD                                               
175800               MOVE                                                       
175900                  'ADD SENT - DEVAN DATE FOUND - NOT PROCESSED'           
176000                       TO TR251-ERROR-MSG                                 
176000             WHEN PC-CRP                                                  
176000             WHEN PC-CRPRDD                                               
175800               MOVE                                                       
175900              'ADD SENT-CNTNR RDY 4 PCKUP DTE FOUND-NOT PROCESSED'        
176000                       TO TR251-ERROR-MSG                                 
176000             WHEN PC-RTN                                                  
176000             WHEN PC-RTNRDD                                               
175800               MOVE                                                       
175900              'ADD SENT-CNTNR RETURNED DATE FOUND - NOT PROCESSED'        
176000                       TO TR251-ERROR-MSG                                 
                 END-EVALUATE                                                   
176900     END-EVALUATE.                                                        
177000                                                                          
179000******************************************************************        
179100* JOIN IMPORT CONTAINER MANIFEST TABLE (TIMCNTK)* TO CONTAINER PO         
179200* TABLE (TIMCNPO)                                                         
 79300******************************************************************        
179400                                                                          
      * MS 07/01/2010                                                           
      * ADDED FIELD DCONSLR_DELY_TMST                                           
                                                                                
179500 7000-SELECT-TIMCNTK.                                                     
179600                                                                          
179700     PERFORM                                                              
179800         WITH TEST AFTER                                                  
179900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
180000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
180100                 SQLCODE = ZERO                     OR                    
180200                 SQLCODE = +100                     OR                    
180300                 SQLCODE = -811                                           
180400                                                                          
180500         EXEC SQL                                                         
180600             SELECT A.CONTNR_ID,                                          
180700                    A.CONTNR_SEQ_NBR,                                     
180900                    A.CONSLR_SCAC_ID,                                     
181000                    A.MOM_IMPRT_TRIP_ID,                                  
181100                    A.MOM_DPRTR_TMST,                                     
181200                    A.MOM_POE_DELY_TMST,                                  
181300                    A.MOM_CARR_SCAC_ID,                                   
181400                    A.MOM_POL_CDE,                                        
181500                    A.MOM_IMPRT_VEH_NM,                                   
181600                    A.MOM_TRIP_TYP_CDE,                                   
181700                    A.MOM_DEST_POE_CDE,                                   
181800                    A.FDR_IMPRT_TRIP_ID,                                  
181900                    A.FDR_DPRTR_TMST,                                     
182000                    A.FDR_POE_DELY_TMST,                                  
182100                    A.FDR_CARR_SCAC_ID,                                   
182200                    A.FDR_POL_CDE,                                        
182300                    A.FDR_IMPRT_VEH_NM,                                   
182400                    A.FDR_TRIP_TYP_CDE,                                   
182500                    A.FDR_DEST_POE_CDE,                                   
182600                    A.SIZE_CDE,                                           
182700                    A.CART_CNT,                                           
182800                    A.CBMT_QTY,                                           
182900                    A.WT_KGRM_QTY,                                        
183000                    A.UNT_QTY,                                            
183300                    A.ORGN_SHPD_FR_CDE,                                   
183400                    A.ORGN_SHPD_TO_CDE,                                   
183500                    A.EST_LBD_NM,                                         
183600                    A.EST_LBD_TMST,                                       
183700                    A.RISU_DO_RSN_CDE,                                    
183800                    A.BKR_FRGT_RLSE_TMST,                                 
183900                    A.DO_TO_DCONSLR_TMST,                                 
184000                    A.DO_RCVD_TMST,                                       
184100                    A.CONTNR_PU_TMST,                                     
184200                    A.DAT_SRC_ENT_ID,                                     
184300                    A.CRE_BY_USR_ID,                                      
184400                    A.CRE_TMST,                                           
184500                    A.LAST_UPD_BY_USR_ID,                                 
184600                    A.LAST_UPD_TMST,                                      
184700                    A.ACTL_POE_DELY_TMST,                                 
184800                    A.ACTL_DEST_POE_CDE,                                  
184900                    A.ACTL_LBD_NM,                                        
185000                    A.ACTL_LBD_TMST,                                      
185100                    A.DVN_TMST,                                           
185200                    A.DCONSLR_SCAC_ID,                                    
185300                    A.DCONSLR_RET_TMST,                                   
185400                    A.MOM_FOB_CDE,                                        
185500                    A.FDR_FOB_CDE,                                        
185600                    A.MOM_POR_CDE,                                        
                          A.FDR_POR_CDE,                                        
                          A.DCONSLR_DELY_TMST                                   
185602              INTO :IMCNTK-CONTNR-ID,                                     
185603                   :IMCNTK-CONTNR-SEQ-NBR,                                
185700                   :IMCNTK-CONSLR-SCAC-ID,                                
185800                   :IMCNTK-MOM-IMPRT-TRIP-ID,                             
185900                   :IMCNTK-MOM-DPRTR-TMST,                                
186000                   :IMCNTK-MOM-POE-DELY-TMST,                             
186100                   :IMCNTK-MOM-CARR-SCAC-ID,                              
186200                   :IMCNTK-MOM-POL-CDE,                                   
186300                   :IMCNTK-MOM-IMPRT-VEH-NM,                              
186400                   :IMCNTK-MOM-TRIP-TYP-CDE,                              
186500                   :IMCNTK-MOM-DEST-POE-CDE,                              
186600                   :IMCNTK-FDR-IMPRT-TRIP-ID,                             
186700                   :IMCNTK-FDR-DPRTR-TMST,                                
186800                   :IMCNTK-FDR-POE-DELY-TMST,                             
186900                   :IMCNTK-FDR-CARR-SCAC-ID,                              
187000                   :IMCNTK-FDR-POL-CDE,                                   
187100                   :IMCNTK-FDR-IMPRT-VEH-NM,                              
187200                   :IMCNTK-FDR-TRIP-TYP-CDE,                              
187300                   :IMCNTK-FDR-DEST-POE-CDE,                              
187400                   :IMCNTK-SIZE-CDE,                                      
187500                   :IMCNTK-CART-CNT,                                      
187600                   :IMCNTK-CBMT-QTY,                                      
187700                   :IMCNTK-WT-KGRM-QTY,                                   
187800                   :IMCNTK-UNT-QTY,                                       
188100                   :IMCNTK-ORGN-SHPD-FR-CDE,                              
188200                   :IMCNTK-ORGN-SHPD-TO-CDE,                              
188300                   :IMCNTK-EST-LBD-NM,                                    
188400                   :IMCNTK-EST-LBD-TMST,                                  
188500                   :IMCNTK-RISU-DO-RSN-CDE,                               
188600                   :IMCNTK-BKR-FRGT-RLSE-TMST,                            
188700                   :IMCNTK-DO-TO-DCONSLR-TMST,                            
188800                   :IMCNTK-DO-RCVD-TMST,                                  
188900                   :IMCNTK-CONTNR-PU-TMST,                                
189000                   :IMCNTK-DAT-SRC-ENT-ID,                                
189100                   :IMCNTK-CRE-BY-USR-ID,                                 
189200                   :IMCNTK-CRE-TMST,                                      
189300                   :IMCNTK-LAST-UPD-BY-USR-ID,                            
189400                   :IMCNTK-LAST-UPD-TMST,                                 
189500                   :IMCNTK-ACTL-POE-DELY-TMST,                            
189600                   :IMCNTK-ACTL-DEST-POE-CDE,                             
189700                   :IMCNTK-ACTL-LBD-NM,                                   
189800                   :IMCNTK-ACTL-LBD-TMST,                                 
189900                   :IMCNTK-DVN-TMST,                                      
190000                   :IMCNTK-DCONSLR-SCAC-ID,                               
190100                   :IMCNTK-DCONSLR-RET-TMST,                              
190200                   :IMCNTK-MOM-FOB-CDE,                                   
190300                   :IMCNTK-FDR-FOB-CDE,                                   
190400                   :IMCNTK-MOM-POR-CDE,                                   
                         :IMCNTK-FDR-POR-CDE,                                   
                         :IMCNTK-DCONSLR-DELY-TMST                              
190402               FROM TIMCNTK A                                             
190403                  , TIMCNPO B                                             
190404              WHERE B.PO_NBR           = :IMCNPO-PO-NBR                   
190500                AND B.CONTNR_ID        = :IMCNPO-CONTNR-ID                
190700                AND A.CONTNR_ID        = B.CONTNR_ID                      
190800                AND A.CONTNR_SEQ_NBR   = B.CONTNR_SEQ_NBR                 
190900         END-EXEC                                                         
191000                                                                          
191100         EVALUATE TRUE                                                    
191200             WHEN SQLCODE = ZERO                                          
191300             WHEN SQLCODE = -811                                          
191400                 SET PS-CNTK-FOUND TO TRUE                                
191500                 ADD +1 TO PA-TOT-CNTK-RECS-SELECT                        
191600                                                                          
191700             WHEN SQLCODE = +100                                          
191800                 SET PS-CNTK-FOUND-NO TO TRUE                             
191900                                                                          
192000             WHEN SQLCODE = -904                                          
192100             WHEN SQLCODE = -913                                          
192200                 CONTINUE                                                 
192300                                                                          
192400             WHEN SQLWARN0 NOT EQUAL SPACE                                
192500             WHEN SQLCODE NOT EQUAL ZERO                                  
192600                 DISPLAY '**************************************'         
192700                 DISPLAY '** ABEND                            **'         
192800                 DISPLAY '** PROGRAM = TRKUP255               **'         
192900                 DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK  **'         
193000                 DISPLAY '** SELECT TIMCNTK                   **'         
193100                 DISPLAY '**************************************'         
193200                 DISPLAY '** CONTNR ID          '                         
193300                                    IMCNTK-CONTNR-ID                      
193600                 DISPLAY '** TR028-DPU-PO-NBR        '                    
193700                                    TR028-DPU-PO-NBR                      
193800                 DISPLAY '**************************************'         
193900                 PERFORM 9100-SQL-ABEND                                   
194000         END-EVALUATE                                                     
194100     END-PERFORM.                                                         
194200                                                                          
194300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
194400         (SQLCODE NOT = ZERO  AND                                         
194500          SQLCODE NOT = +100  AND                                         
194600          SQLCODE NOT = -811)                                             
194700                                                                          
194800         DISPLAY '****************************************'               
194900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
195000         DISPLAY '** SELECT FROM TIMCNTK                **'               
195100         DISPLAY '** PARAGRAPH = 7000-SELECT-TIMCNTK    **'               
195200                 DISPLAY '** CONTNR ID          '                         
195300                                    IMCNTK-CONTNR-ID                      
195600                 DISPLAY '** TR028-DPU-PO-NBR        '                    
195700                                    TR028-DPU-PO-NBR                      
195800         DISPLAY '****************************************'               
195900         PERFORM 9100-SQL-ABEND                                           
196000     END-IF.                                                              
196100                                                                          
196200 EJECT                                                                    
196300******************************************************************        
196400*  UPDATE THE IMPORT CONTAINER MANIFEST TABLE  (TIMCNTK).        *        
196500******************************************************************        
      * MS 07/01/2010                                                           
      * ADDED DCONSLR_DELY_TMST                                                 
                                                                                
196600 7010-UPDATE-TIMCNTK.                                                     
196700                                                                          
196800     PERFORM                                                              
196900         WITH TEST AFTER                                                  
197000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
197100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
197200                 SQLCODE = ZERO                     OR                    
197300                 SQLCODE = +100                                           
197400                                                                          
197500         EXEC SQL                                                         
197600             UPDATE TIMCNTK                                               
197700             SET DO_RCVD_TMST       = :PV-HLD-DO-RCVD-TMST                
197800                ,CONTNR_PU_TMST     = :PV-HLD-CONTNR-PU-TMST              
197900                ,DVN_TMST           = :PV-HLD-DVN-TMST                    
198000                ,DCONSLR_SCAC_ID    = :PV-HLD-DCONSLR-SCAC-ID             
198100                ,BKR_FRGT_RLSE_TMST = :PV-HLD-BKR-FRGT-RLSE-TMST          
198200                ,DCONSLR_RET_TMST   = :PV-HLD-RET-TMST                    
                      ,DCONSLR_DELY_TMST  = :PV-HLD-DCONSLR-ARR-TMST            
198300                ,LAST_UPD_BY_USR_ID = :PC-CURRENT-PROGRAM-NAME            
198400                ,LAST_UPD_TMST      = :PV-CURRENT-TMST                    
198500              WHERE CONTNR_ID       = :PV-HLD-CONTNR-ID                   
198600                AND CONTNR_SEQ_NBR  = :PV-HLD-CONTNR-SEQ-NBR              
198700         END-EXEC                                                         
198800                                                                          
198900         EVALUATE TRUE                                                    
199000             WHEN SQLCODE = ZERO                                          
199100                 SET PS-GOOD-CNTK-UPDATE TO TRUE                          
199200                                                                          
199300             WHEN SQLCODE = -904                                          
199400             WHEN SQLCODE = -913                                          
199500                 CONTINUE                                                 
199600                                                                          
199700             WHEN SQLWARN0 NOT EQUAL SPACE                                
199800             WHEN SQLCODE NOT EQUAL ZERO                                  
199900                 DISPLAY '**************************************'         
200000                 DISPLAY '** ABEND                            **'         
200100                 DISPLAY '** PROGRAM = TRKUP255               **'         
200200                 DISPLAY '** PARAGRAPH = 7010-UPDATE-TIMCNTK  **'         
200300                 DISPLAY '** UPDATE TIMCNTK                   **'         
200400                 DISPLAY '** CONTNR ID       = '                          
200500                 DISPLAY            IMCNTK-CONTNR-ID                      
200600                 DISPLAY '** CONTNR SEQ NBR  = '                          
200700                 DISPLAY            IMCNTK-CONTNR-SEQ-NBR                 
200800                 DISPLAY '**************************************'         
200900                 PERFORM 9100-SQL-ABEND                                   
201000         END-EVALUATE                                                     
201100     END-PERFORM.                                                         
201200                                                                          
201300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
201400         (SQLCODE NOT = ZERO AND                                          
201500          SQLCODE NOT = +100)                                             
201600         DISPLAY '****************************************'               
201700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
201800         DISPLAY '** UPDATE FROM TIMCNTK                **'               
201900         DISPLAY '** PARAGRAPH = 7010-UPDATE-TIMCNTK    **'               
202000         DISPLAY '** CONTNR ID       = '                                  
202100         DISPLAY            IMCNTK-CONTNR-ID                              
202200         DISPLAY '** CONTNR SEQ NBR  = '                                  
202300         DISPLAY            IMCNTK-CONTNR-SEQ-NBR                         
202400         DISPLAY '****************************************'               
202500         PERFORM 9100-SQL-ABEND                                           
202600     END-IF.                                                              
202700                                                                          
202800 EJECT                                                                    
202900                                                                          
203000******************************************************************        
203100*  UPDATE THE IMPORT CONTAINER PURCHASE ORDER TABLE (TIMCNPO).   *        
203200******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED DCONSLR_DELY_CDE                                                  
                                                                                
203300 7020-UPDATE-TIMCNPO.                                                     
203400                                                                          
203500     PERFORM                                                              
203600         WITH TEST AFTER                                                  
203700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
203800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
203900                 SQLCODE = ZERO                                           
204000                                                                          
204100         EXEC SQL                                                         
204200             UPDATE TIMCNPO                                               
204300              SET BKR_FRGT_RLSE_CDE = :PV-HLD-BKR-FRGT-RLSE-CDE           
204400                 ,DO_RCVD_CDE       = :PV-HLD-DO-RCVD-CDE                 
204500                 ,CONTNR_PU_CDE     = :PV-HLD-CONTNR-PU-CDE               
204600                 ,DVN_CDE           = :PV-HLD-DVN-CDE                     
204700                 ,DCONSLR_RET_CDE   = :PV-HLD-DCONSLR-RET-CDE             
                       ,DCONSLR_DELY_CDE  = :PV-HLD-DCONSLR-ARR-IND             
204800                ,LAST_UPD_BY_USR_ID = :PC-CURRENT-PROGRAM-NAME            
204900                ,LAST_UPD_TMST      = :PV-CURRENT-TMST                    
205000              WHERE CONTNR_ID       = :PV-HLD-CONTNR-ID                   
205100                AND CONTNR_SEQ_NBR  = :PV-HLD-CONTNR-SEQ-NBR              
205200                AND PO_NBR          = :PV-HLD-PO-NBR                      
205400         END-EXEC                                                         
205500                                                                          
205600         EVALUATE TRUE                                                    
205700             WHEN SQLCODE = ZERO                                          
205800                 SET PS-GOOD-CNPO-UPDATE TO TRUE                          
205900                                                                          
206000             WHEN SQLCODE = -904                                          
206100             WHEN SQLCODE = -913                                          
206200                 CONTINUE                                                 
206300                                                                          
206400             WHEN OTHER                                                   
206500                 DISPLAY '**************************************'         
206600                 DISPLAY '** ABEND                            **'         
206700                 DISPLAY '** PROGRAM = TRKUP255               **'         
206800                 DISPLAY '** PARAGRAPH = 7020-UPDATE-TIMCNPO  **'         
206900                 DISPLAY '** UPDATE TIMCNPO                   **'         
207000                 DISPLAY '** CONTNR ID       = '                          
207100                 DISPLAY            PV-HLD-CONTNR-ID                      
207200                 DISPLAY '** PO NBR          = '                          
207300                 DISPLAY            PV-HLD-PO-NBR                         
207600                 DISPLAY '**************************************'         
207700                 PERFORM 9100-SQL-ABEND                                   
207800         END-EVALUATE                                                     
207900     END-PERFORM.                                                         
208000                                                                          
208100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
208200          SQLCODE NOT = ZERO                                              
208300         DISPLAY '****************************************'               
208400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
208500         DISPLAY '** UPDATE FROM TIMCNPO                **'               
208600         DISPLAY '** PARAGRAPH = 7020-UPDATE-TIMCNPO    **'               
208700         DISPLAY '** CONTNR ID       = '                                  
208800         DISPLAY            PV-HLD-CONTNR-ID                              
208900         DISPLAY '** PO NBR          = '                                  
209000         DISPLAY            PV-HLD-PO-NBR                                 
209300         DISPLAY '****************************************'               
209400         PERFORM 9100-SQL-ABEND                                           
209500     END-IF.                                                              
209600                                                                          
209700 EJECT                                                                    
209800                                                                          
209900******************************************************************        
210000* INSERT A ROW INTO THE CONTAINER AUDIT TABLE  (TAUCNTK).        *        
210100******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED DCONSLR_DELY_TMST                                                 
                                                                                
210200 7030-INSERT-TAUCNTK.                                                     
210300                                                                          
210400     PERFORM                                                              
210500         WITH TEST AFTER                                                  
210600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
210700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
210800                 SQLCODE = ZERO                                           
210900                                                                          
211000         EXEC SQL                                                         
211100             INSERT INTO TAUCNTK                                          
211200                   (CONTNR_ID,                                            
211300                    CONTNR_SEQ_NBR,                                       
211500                    CONSLR_SCAC_ID,                                       
211600                    MOM_IMPRT_TRIP_ID,                                    
211700                    MOM_DPRTR_TMST,                                       
211800                    MOM_POE_DELY_TMST,                                    
211900                    MOM_CARR_SCAC_ID,                                     
212000                    MOM_POL_CDE,                                          
212100                    MOM_IMPRT_VEH_NM,                                     
212200                    MOM_TRIP_TYP_CDE,                                     
212300                    MOM_DEST_POE_CDE,                                     
212400                    FDR_IMPRT_TRIP_ID,                                    
212500                    FDR_DPRTR_TMST,                                       
212600                    FDR_POE_DELY_TMST,                                    
212700                    FDR_CARR_SCAC_ID,                                     
212800                    FDR_POL_CDE,                                          
212900                    FDR_IMPRT_VEH_NM,                                     
213000                    FDR_TRIP_TYP_CDE,                                     
213100                    FDR_DEST_POE_CDE,                                     
213200                    SIZE_CDE,                                             
213300                    CART_CNT,                                             
213400                    CBMT_QTY,                                             
213500                    WT_KGRM_QTY,                                          
213600                    UNT_QTY,                                              
213900                    ORGN_SHPD_FR_CDE,                                     
214000                    ORGN_SHPD_TO_CDE,                                     
214100                    EST_LBD_NM,                                           
214200                    EST_LBD_TMST,                                         
214300                    RISU_DO_RSN_CDE,                                      
214400                    BKR_FRGT_RLSE_TMST,                                   
214500                    DO_TO_DCONSLR_TMST,                                   
214600                    DO_RCVD_TMST,                                         
214700                    CONTNR_PU_TMST,                                       
214800                    DAT_SRC_ENT_ID,                                       
214900                    LAST_UPD_BY_USR_ID,                                   
215000                    LAST_UPD_TMST,                                        
215100                    AUD_FUNC_CDE,                                         
215200                    AUD_TMST,                                             
215300                    ACTL_POE_DELY_TMST,                                   
215400                    ACTL_DEST_POE_CDE,                                    
215500                    ACTL_LBD_NM,                                          
215600                    ACTL_LBD_TMST,                                        
215700                    DVN_TMST,                                             
215800                    DCONSLR_RET_TMST,                                     
215900                    DCONSLR_SCAC_ID,                                      
216000                    MOM_FOB_CDE,                                          
216100                    FDR_FOB_CDE,                                          
216200                    MOM_POR_CDE,                                          
                          FDR_POR_CDE,                                          
                          DCONSLR_DELY_TMST)                                    
216202             VALUES                                                       
216203                  (:AUCNTK-CONTNR-ID,                                     
216204                   :AUCNTK-CONTNR-SEQ-NBR,                                
216400                   :AUCNTK-CONSLR-SCAC-ID,                                
216500                   :AUCNTK-MOM-IMPRT-TRIP-ID,                             
216600                   :AUCNTK-MOM-DPRTR-TMST,                                
216700                   :AUCNTK-MOM-POE-DELY-TMST,                             
216800                   :AUCNTK-MOM-CARR-SCAC-ID,                              
216900                   :AUCNTK-MOM-POL-CDE,                                   
217000                   :AUCNTK-MOM-IMPRT-VEH-NM,                              
217100                   :AUCNTK-MOM-TRIP-TYP-CDE,                              
217200                   :AUCNTK-MOM-DEST-POE-CDE,                              
217300                   :AUCNTK-FDR-IMPRT-TRIP-ID,                             
217400                   :AUCNTK-FDR-DPRTR-TMST,                                
217500                   :AUCNTK-FDR-POE-DELY-TMST,                             
217600                   :AUCNTK-FDR-CARR-SCAC-ID,                              
217700                   :AUCNTK-FDR-POL-CDE,                                   
217800                   :AUCNTK-FDR-IMPRT-VEH-NM,                              
217900                   :AUCNTK-FDR-TRIP-TYP-CDE,                              
218000                   :AUCNTK-FDR-DEST-POE-CDE,                              
218100                   :AUCNTK-SIZE-CDE,                                      
218200                   :AUCNTK-CART-CNT,                                      
218300                   :AUCNTK-CBMT-QTY,                                      
218400                   :AUCNTK-WT-KGRM-QTY,                                   
218500                   :AUCNTK-UNT-QTY,                                       
218800                   :AUCNTK-ORGN-SHPD-FR-CDE,                              
218900                   :AUCNTK-ORGN-SHPD-TO-CDE,                              
219000                   :AUCNTK-EST-LBD-NM,                                    
219100                   :AUCNTK-EST-LBD-TMST,                                  
219200                   :AUCNTK-RISU-DO-RSN-CDE,                               
219300                   :AUCNTK-BKR-FRGT-RLSE-TMST,                            
219400                   :AUCNTK-DO-TO-DCONSLR-TMST,                            
219500                   :AUCNTK-DO-RCVD-TMST,                                  
219600                   :AUCNTK-CONTNR-PU-TMST,                                
219700                   :AUCNTK-DAT-SRC-ENT-ID,                                
219800                   :AUCNTK-LAST-UPD-BY-USR-ID,                            
219900                   :AUCNTK-LAST-UPD-TMST,                                 
220000                   :AUCNTK-AUD-FUNC-CDE,                                  
220100                   :AUCNTK-AUD-TMST,                                      
220200                   :AUCNTK-ACTL-POE-DELY-TMST,                            
220300                   :AUCNTK-ACTL-DEST-POE-CDE,                             
220400                   :AUCNTK-ACTL-LBD-NM,                                   
220500                   :AUCNTK-ACTL-LBD-TMST,                                 
220600                   :AUCNTK-DVN-TMST,                                      
220700                   :AUCNTK-DCONSLR-RET-TMST,                              
220800                   :AUCNTK-DCONSLR-SCAC-ID,                               
220900                   :AUCNTK-MOM-FOB-CDE,                                   
221000                   :AUCNTK-FDR-FOB-CDE,                                   
221100                   :AUCNTK-MOM-POR-CDE,                                   
                         :AUCNTK-FDR-POR-CDE,                                   
                         :AUCNTK-DCONSLR-DELY-TMST)                             
221102         END-EXEC                                                         
221103                                                                          
221104         EVALUATE TRUE                                                    
221200             WHEN SQLCODE = ZERO                                          
221300                 ADD +1 TO PA-TOT-ACNTK-INSERTS                           
221400                 ADD +1 TO PA-TOT-RECS-AUDITED                            
221500                                                                          
221600             WHEN SQLCODE = -904                                          
221700             WHEN SQLCODE = -913                                          
221800                 CONTINUE                                                 
221900                                                                          
222000             WHEN SQLWARN0 NOT EQUAL SPACE                                
222100             WHEN SQLCODE NOT EQUAL ZERO                                  
222200                 DISPLAY '**************************************'         
222300                 DISPLAY '** ABEND                            **'         
222400                 DISPLAY '** PROGRAM = TRKUP255               **'         
222500                 DISPLAY '** PARAGRAPH = 7030-INSERT-TAUCNTK  **'         
222600                 DISPLAY '** INSERT INTO TAUCNTK              **'         
222700                 DISPLAY '** AUCNTK-CONTNR-ID = '                         
222800                 DISPLAY                   AUCNTK-CONTNR-ID               
222900                 DISPLAY '** CONTNR SEQ NBR  = '                          
223000                 DISPLAY                   AUCNTK-CONTNR-SEQ-NBR          
223100                 DISPLAY '**************************************'         
223200                 PERFORM 9100-SQL-ABEND                                   
223300         END-EVALUATE                                                     
223400     END-PERFORM.                                                         
223500                                                                          
223600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
223700         SQLCODE NOT = ZERO                                               
223800         DISPLAY '****************************************'               
223900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
224000         DISPLAY '** INSERT TO TAUCNTK                  **'               
224100         DISPLAY '** PARAGRAPH = 7030-INSERT-TAUCNTK    **'               
224200         DISPLAY '** AUCNTK-CONTNR-ID = ' AUCNTK-CONTNR-ID                
224300         DISPLAY '** CONTNR SEQ NBR  = '                                  
224400         DISPLAY                   AUCNTK-CONTNR-SEQ-NBR                  
224500         DISPLAY '****************************************'               
224600         PERFORM 9100-SQL-ABEND                                           
224700     END-IF.                                                              
224800                                                                          
224900 EJECT                                                                    
225000******************************************************************        
225100*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *        
225200*  CONTAINER WITH DO RCVD DATES.                                 *        
225300******************************************************************        
225400 7040-SELECT-DO-RCVD-COUNT.                                               
225500                                                                          
225600     PERFORM                                                              
225700         WITH TEST AFTER                                                  
225800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
225900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
226000                 SQLCODE = ZERO                                           
226100                                                                          
226200         EXEC SQL                                                         
226300             SELECT  COUNT(*)                                             
226400               INTO :PV-CONTAINER-CNT                                     
226500               FROM  TIMCNPO                                              
226600              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
226700                AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
226800                AND  PO_NBR            <> :PV-HLD-PO-NBR                  
227000                AND  DO_RCVD_CDE        = 'Y'                             
227100         END-EXEC                                                         
227200                                                                          
227300         EVALUATE TRUE                                                    
227400             WHEN SQLCODE = ZERO                                          
227500                 CONTINUE                                                 
227600                                                                          
227700             WHEN SQLCODE = -904                                          
227800             WHEN SQLCODE = -913                                          
227900                 CONTINUE                                                 
228000                                                                          
228100             WHEN OTHER                                                   
228200                 DISPLAY '**************************************'         
228300                 DISPLAY '** ABEND                            **'         
228400                 DISPLAY '** PROGRAM = TRKUP255               **'         
228500                 DISPLAY '** PARAGRAPH = '                                
228600                         '7040-SELECT-DO-RCVD-COUNT'                      
228700                 DISPLAY '** SELECT COUNT ON TIMCNPO          **'         
228800                 DISPLAY '** CONTNR ID       = '                          
228900                 DISPLAY            PV-HLD-CONTNR-ID                      
229000                 DISPLAY '** PO NBR          = '                          
229100                 DISPLAY            PV-HLD-PO-NBR                         
229400                 DISPLAY '**************************************'         
229500                 PERFORM 9100-SQL-ABEND                                   
229600         END-EVALUATE                                                     
229700     END-PERFORM.                                                         
229800                                                                          
229900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
230000          SQLCODE NOT = ZERO                                              
230100         DISPLAY '****************************************'               
230200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
230300         DISPLAY '** SELECT COUNT ON TIMCNPO            **'               
230400         DISPLAY '** PARAGRAPH = '                                        
230500                 '7040-SELECT-DO-RCVD-COUNT'                              
230600         DISPLAY '** CONTNR ID       = '                                  
230700         DISPLAY            PV-HLD-CONTNR-ID                              
230800         DISPLAY '** PO NBR          = '                                  
230900         DISPLAY            PV-HLD-PO-NBR                                 
231200         DISPLAY '****************************************'               
231300         PERFORM 9100-SQL-ABEND                                           
231400     END-IF.                                                              
231500                                                                          
231600 EJECT                                                                    
231700                                                                          
231800******************************************************************        
231900*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *        
232000*  CONTAINER WITH CONTNR PU DATES.                               *        
232100******************************************************************        
232200 7050-SELECT-CONTNR-PU-COUNT.                                             
232300                                                                          
232400     PERFORM                                                              
232500         WITH TEST AFTER                                                  
232600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
232700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
232800                 SQLCODE = ZERO                                           
232900                                                                          
233000         EXEC SQL                                                         
233100             SELECT  COUNT(*)                                             
233200               INTO :PV-CONTAINER-CNT                                     
233300               FROM  TIMCNPO                                              
233400              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
233500                AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
233600                AND  PO_NBR            <> :PV-HLD-PO-NBR                  
233800                AND  CONTNR_PU_CDE      = 'Y'                             
233900         END-EXEC                                                         
234000                                                                          
234100         EVALUATE TRUE                                                    
234200             WHEN SQLCODE = ZERO                                          
234300                 CONTINUE                                                 
234400                                                                          
234500             WHEN SQLCODE = -904                                          
234600             WHEN SQLCODE = -913                                          
234700                 CONTINUE                                                 
234800                                                                          
234900             WHEN OTHER                                                   
235000                 DISPLAY '**************************************'         
235100                 DISPLAY '** ABEND                            **'         
235200                 DISPLAY '** PROGRAM = TRKUP255               **'         
235300                 DISPLAY '** PARAGRAPH = '                                
235400                         '7050-SELECT-CONTNR-PU-COUNT'                    
235500                 DISPLAY '** SELECT COUNT ON TIMCNPO          **'         
235600                 DISPLAY '** CONTNR ID       = '                          
235700                 DISPLAY            PV-HLD-CONTNR-ID                      
235800                 DISPLAY '** PO NBR          = '                          
235900                 DISPLAY            PV-HLD-PO-NBR                         
236200                 DISPLAY '**************************************'         
236300                 PERFORM 9100-SQL-ABEND                                   
236400         END-EVALUATE                                                     
236500     END-PERFORM.                                                         
236600                                                                          
236700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
236800          SQLCODE NOT = ZERO                                              
236900         DISPLAY '****************************************'               
237000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
237100         DISPLAY '** SELECT COUNT ON TIMCNPO            **'               
237200         DISPLAY '** PARAGRAPH = '                                        
237300                 '7050-SELECT-CONTNR-PU-COUNT'                            
237400         DISPLAY '** CONTNR ID       = '                                  
237500         DISPLAY            PV-HLD-CONTNR-ID                              
237600         DISPLAY '** PO NBR          = '                                  
237700         DISPLAY            PV-HLD-PO-NBR                                 
238000         DISPLAY '****************************************'               
238100         PERFORM 9100-SQL-ABEND                                           
238200     END-IF.                                                              
238300                                                                          
238400 EJECT                                                                    
238500                                                                          
      * MS 07/01/2010 BEG                                                       
      * TO GET THE COUNT AT THE ARRIVAL OF THE DECONSOLIDATOR.                  
                                                                                
       7055-SELECT-DCONSLR-ARRIVE-CNT.                                          
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
               UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
                       SQLCODE = ZERO                                           
           EXEC SQL                                                             
                   SELECT  COUNT(*)                                             
                     INTO :PV-CONTAINER-CNT                                     
                     FROM  TIMCNPO                                              
                    WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
                      AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
                      AND  PO_NBR            <> :PV-HLD-PO-NBR                  
                      AND  DCONSLR_DELY_CDE   = 'Y'                             
           END-EXEC                                                             
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN SQLCODE = -904                                              
               WHEN SQLCODE = -913                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   DISPLAY '**************************************'             
                   DISPLAY '** ABEND                            **'             
                   DISPLAY '** PROGRAM = TRKUP255               **'             
                   DISPLAY '** PARAGRAPH = '                                    
                           '7055-SELECT-DCONSLR-ARRIVE-COUNT'                   
                   DISPLAY '** SELECT COUNT ON TIMCNPO          **'             
                   DISPLAY '** CONTNR ID       = '                              
                   DISPLAY            PV-HLD-CONTNR-ID                          
                   DISPLAY '** PO NBR          = '                              
                   DISPLAY            PV-HLD-PO-NBR                             
                   DISPLAY '**************************************'             
                   PERFORM 9100-SQL-ABEND                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
                SQLCODE NOT = ZERO                                              
                DISPLAY '****************************************'              
                DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'              
                DISPLAY '** SELECT COUNT ON TIMCNPO            **'              
                DISPLAY '** PARAGRAPH = '                                       
                        '7055-SELECT-DCONSLR-ARRIVE-COUNT '                     
                DISPLAY '** CONTNR ID       = '                                 
                DISPLAY            PV-HLD-CONTNR-ID                             
                DISPLAY '** PO NBR          = '                                 
                DISPLAY            PV-HLD-PO-NBR                                
                DISPLAY '****************************************'              
                PERFORM 9100-SQL-ABEND                                          
           END-IF.                                                              
                                                                                
       EJECT                                                                    
      * MS 07/01/2010 END                                                       
238600******************************************************************        
238700*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *        
238800*  CONTAINER WITH DVN DATES.                                     *        
238900******************************************************************        
239000 7060-SELECT-DVN-COUNT.                                                   
239100                                                                          
239200     PERFORM                                                              
239300         WITH TEST AFTER                                                  
239400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
239500         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
239600                 SQLCODE = ZERO                                           
239700                                                                          
239800         EXEC SQL                                                         
239900             SELECT  COUNT(*)                                             
240000               INTO :PV-CONTAINER-CNT                                     
240100               FROM  TIMCNPO                                              
240200              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
240300                AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
240400                AND  PO_NBR            <> :PV-HLD-PO-NBR                  
240600                AND  DVN_CDE            = 'Y'                             
240700         END-EXEC                                                         
240800                                                                          
240900         EVALUATE TRUE                                                    
241000             WHEN SQLCODE = ZERO                                          
241100                 CONTINUE                                                 
241200                                                                          
241300             WHEN SQLCODE = -904                                          
241400             WHEN SQLCODE = -913                                          
241500                 CONTINUE                                                 
241600                                                                          
241700             WHEN OTHER                                                   
241800                 DISPLAY '**************************************'         
241900                 DISPLAY '** ABEND                            **'         
242000                 DISPLAY '** PROGRAM = TRKUP255               **'         
242100                 DISPLAY '** PARAGRAPH = '                                
242200                         '7060-SELECT-DVN-COUNT'                          
242300                 DISPLAY '** SELECT COUNT ON TIMCNPO          **'         
242400                 DISPLAY '** CONTNR ID       = '                          
242500                 DISPLAY            PV-HLD-CONTNR-ID                      
242600                 DISPLAY '** PO NBR          = '                          
242700                 DISPLAY            PV-HLD-PO-NBR                         
243000                 DISPLAY '**************************************'         
243100                 PERFORM 9100-SQL-ABEND                                   
243200         END-EVALUATE                                                     
243300     END-PERFORM.                                                         
243400                                                                          
243500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
243600          SQLCODE NOT = ZERO                                              
243700         DISPLAY '****************************************'               
243800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
243900         DISPLAY '** SELECT COUNT ON TIMCNPO            **'               
244000         DISPLAY '** PARAGRAPH = '                                        
244100                 '7060-SELECT-DVN-COUNT'                                  
244200         DISPLAY '** CONTNR ID       = '                                  
244300         DISPLAY            PV-HLD-CONTNR-ID                              
244400         DISPLAY '** PO NBR          = '                                  
244500         DISPLAY            PV-HLD-PO-NBR                                 
244800         DISPLAY '****************************************'               
244900         PERFORM 9100-SQL-ABEND                                           
245000     END-IF.                                                              
245100                                                                          
245200 EJECT                                                                    
245300                                                                          
245400******************************************************************        
245500*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *        
245600*  CONTAINER WITH BKR FRGT RLSE DATES.                           *        
245700******************************************************************        
245800 7070-SELECT-BKR-FRGT-COUNT.                                              
245900                                                                          
246000     PERFORM                                                              
246100         WITH TEST AFTER                                                  
246200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
246300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
246400                 SQLCODE = ZERO                                           
246500                                                                          
246600         EXEC SQL                                                         
246700             SELECT  COUNT(*)                                             
246800               INTO :PV-CONTAINER-CNT                                     
246900               FROM  TIMCNPO                                              
247000              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
247100                AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
247200                AND  PO_NBR            <> :PV-HLD-PO-NBR                  
247400                AND  BKR_FRGT_RLSE_CDE  = 'Y'                             
247500         END-EXEC                                                         
247600                                                                          
247700         EVALUATE TRUE                                                    
247800             WHEN SQLCODE = ZERO                                          
247900                 CONTINUE                                                 
248000                                                                          
248100             WHEN SQLCODE = -904                                          
248200             WHEN SQLCODE = -913                                          
248300                 CONTINUE                                                 
248400                                                                          
248500             WHEN OTHER                                                   
248600                 DISPLAY '**************************************'         
248700                 DISPLAY '** ABEND                            **'         
248800                 DISPLAY '** PROGRAM = TRKUP255               **'         
248900                 DISPLAY '** PARAGRAPH = '                                
249000                         '7070-SELECT-BKR-FRGT-COUNT'                     
249100                 DISPLAY '** SELECT COUNT ON TIMCNPO          **'         
249200                 DISPLAY '** CONTNR ID       = '                          
249300                 DISPLAY            PV-HLD-CONTNR-ID                      
249400                 DISPLAY '** PO NBR          = '                          
249500                 DISPLAY            PV-HLD-PO-NBR                         
249800                 DISPLAY '**************************************'         
249900                 PERFORM 9100-SQL-ABEND                                   
250000         END-EVALUATE                                                     
250100     END-PERFORM.                                                         
250200                                                                          
250300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
250400          SQLCODE NOT = ZERO                                              
250500         DISPLAY '****************************************'               
250600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
250700         DISPLAY '** SELECT COUNT ON TIMCNPO            **'               
250800         DISPLAY '** PARAGRAPH = '                                        
250900                 '7070-SELECT-BKR-FRGT-COUNT'                             
251000         DISPLAY '** CONTNR ID       = '                                  
251100         DISPLAY            PV-HLD-CONTNR-ID                              
251200         DISPLAY '** PO NBR          = '                                  
251300         DISPLAY            PV-HLD-PO-NBR                                 
251600         DISPLAY '****************************************'               
251700         PERFORM 9100-SQL-ABEND                                           
251800     END-IF.                                                              
251900                                                                          
252000 EJECT                                                                    
252100                                                                          
252200******************************************************************        
252300*  CHECK IF THERE ARE MORE PURCHASE ORDERS ASSIGNED TO A         *        
252400*  CONTAINER WITH DCONLSR RET DATES.                             *        
252500******************************************************************        
252600 7080-SELECT-DCONSLR-RET-COUNT.                                           
252700                                                                          
252800     PERFORM                                                              
252900         WITH TEST AFTER                                                  
253000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
253100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
253200                 SQLCODE = ZERO                                           
253300                                                                          
253400         EXEC SQL                                                         
253500             SELECT  COUNT(*)                                             
253600               INTO :PV-CONTAINER-CNT                                     
253700               FROM  TIMCNPO                                              
253800              WHERE  CONTNR_ID          = :PV-HLD-CONTNR-ID               
253900                AND  CONTNR_SEQ_NBR     = :PV-HLD-CONTNR-SEQ-NBR          
254000                AND  PO_NBR            <> :PV-HLD-PO-NBR                  
254200                AND  DCONSLR_RET_CDE    = 'Y'                             
254300         END-EXEC                                                         
254400                                                                          
254500         EVALUATE TRUE                                                    
254600             WHEN SQLCODE = ZERO                                          
254700                 CONTINUE                                                 
254800                                                                          
254900             WHEN SQLCODE = -904                                          
255000             WHEN SQLCODE = -913                                          
255100                 CONTINUE                                                 
255200                                                                          
255300             WHEN OTHER                                                   
255400                 DISPLAY '**************************************'         
255500                 DISPLAY '** ABEND                            **'         
255600                 DISPLAY '** PROGRAM = TRKUP255               **'         
255700                 DISPLAY '** PARAGRAPH = '                                
255800                         '7080-SELECT-DCONSLR-RET-COUNT'                  
255900                 DISPLAY '** SELECT COUNT ON TIMCNPO          **'         
256000                 DISPLAY '** CONTNR ID       = '                          
256100                 DISPLAY            PV-HLD-CONTNR-ID                      
256200                 DISPLAY '** PO NBR          = '                          
256300                 DISPLAY            PV-HLD-PO-NBR                         
256600                 DISPLAY '**************************************'         
256700                 PERFORM 9100-SQL-ABEND                                   
256800         END-EVALUATE                                                     
256900     END-PERFORM.                                                         
257000                                                                          
257100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
257200          SQLCODE NOT = ZERO                                              
257300         DISPLAY '****************************************'               
257400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
257500         DISPLAY '** SELECT COUNT ON TIMCNPO            **'               
257600         DISPLAY '** PARAGRAPH = '                                        
257700                 '7080-SELECT-DCONSLR-RET-COUNT'                          
257800         DISPLAY '** CONTNR ID       = '                                  
257900         DISPLAY            PV-HLD-CONTNR-ID                              
258000         DISPLAY '** PO NBR          = '                                  
258100         DISPLAY            PV-HLD-PO-NBR                                 
258400         DISPLAY '****************************************'               
258500         PERFORM 9100-SQL-ABEND                                           
258600     END-IF.                                                              
258700                                                                          
258800 EJECT                                                                    
258900                                                                          
259000******************************************************************        
259100* JOIN IMPORT CONTAINER MANIFEST TABLE (TIMCNTK) TO CONTAINER PO *        
259200* TABLE (TIMCNPO) TO RETRIEVE TIMCNPO DATA                       *        
259300******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED DCONSLR_DELY_CDE                                                  
                                                                                
259400 7200-SELECT-TIMCNPO.                                                     
259500                                                                          
259600     PERFORM                                                              
259700         WITH TEST AFTER                                                  
259800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
259900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
260000                 SQLCODE = ZERO                     OR                    
260100                 SQLCODE = +100                     OR                    
260200                 SQLCODE = -811                                           
260300                                                                          
260400         EXEC SQL                                                         
260500             SELECT B.CONTNR_ID                                           
260600                   ,B.CONTNR_SEQ_NBR                                      
260700                   ,B.PO_NBR                                              
260800                   ,B.CSTM_ENTR_ID                                        
260900                   ,B.MSTR_BOL_NBR                                        
261000                   ,B.HSE_BOL_NBR                                         
261100                   ,B.LTR_OF_CR_NBR                                       
261200                   ,B.PO_RCVD_DELY_TMST                                   
261300                   ,B.PO_C_O_PROD_CDE                                     
261400                   ,B.PO_CART_CNT                                         
261500                   ,B.PO_CBMT_QTY                                         
261600                   ,B.PO_WT_KGRM_QTY                                      
261700                   ,B.PO_UNT_QTY                                          
262000                   ,B.CRE_BY_USR_ID                                       
262100                   ,B.CRE_TMST                                            
262200                   ,B.LAST_UPD_BY_USR_ID                                  
262300                   ,B.LAST_UPD_TMST                                       
262400                   ,B.EXTL_REF_NBR                                        
262500                   ,B.BKR_FRGT_RLSE_CDE                                   
262600                   ,B.DO_RCVD_CDE                                         
262700                   ,B.CONTNR_PU_CDE                                       
262800                   ,B.ACTL_POE_DELY_CDE                                   
262900                   ,B.DVN_CDE                                             
263000                   ,B.DCONSLR_RET_CDE                                     
263010                   ,B.SPLT_XMIT_CDE                                       
263020                   ,B.DOC_RCVD_ORGN_TMST                                  
                         ,B.DCONSLR_DELY_CDE                                    
263100              INTO :IMCNPO-CONTNR-ID                                      
263200                  ,:IMCNPO-CONTNR-SEQ-NBR                                 
263300                  ,:IMCNPO-PO-NBR                                         
263400                  ,:IMCNPO-CSTM-ENTR-ID                                   
263500                  ,:IMCNPO-MSTR-BOL-NBR                                   
263600                  ,:IMCNPO-HSE-BOL-NBR                                    
263700                  ,:IMCNPO-LTR-OF-CR-NBR                                  
263800                  ,:IMCNPO-PO-RCVD-DELY-TMST                              
263900                  ,:IMCNPO-PO-C-O-PROD-CDE                                
264000                  ,:IMCNPO-PO-CART-CNT                                    
264100                  ,:IMCNPO-PO-CBMT-QTY                                    
264200                  ,:IMCNPO-PO-WT-KGRM-QTY                                 
264300                  ,:IMCNPO-PO-UNT-QTY                                     
264600                  ,:IMCNPO-CRE-BY-USR-ID                                  
264700                  ,:IMCNPO-CRE-TMST                                       
264800                  ,:IMCNPO-LAST-UPD-BY-USR-ID                             
264900                  ,:IMCNPO-LAST-UPD-TMST                                  
265000                  ,:IMCNPO-EXTL-REF-NBR                                   
265100                  ,:IMCNPO-BKR-FRGT-RLSE-CDE                              
265200                  ,:IMCNPO-DO-RCVD-CDE                                    
265300                  ,:IMCNPO-CONTNR-PU-CDE                                  
265400                  ,:IMCNPO-ACTL-POE-DELY-CDE                              
265500                  ,:IMCNPO-DVN-CDE                                        
265600                  ,:IMCNPO-DCONSLR-RET-CDE                                
265610                  ,:IMCNPO-SPLT-XMIT-CDE                                  
265620                  ,:IMCNPO-DOC-RCVD-ORGN-TMST                             
                        ,:IMCNPO-DCONSLR-DELY-CDE                               
265700               FROM TIMCNTK A                                             
265800                  , TIMCNPO B                                             
265900              WHERE B.PO_NBR           = :IMCNPO-PO-NBR                   
266000                AND B.CONTNR_ID        = :IMCNPO-CONTNR-ID                
266200                AND A.CONTNR_ID        = B.CONTNR_ID                      
266300                AND A.CONTNR_SEQ_NBR   = B.CONTNR_SEQ_NBR                 
266400         END-EXEC                                                         
266500                                                                          
266600         EVALUATE TRUE                                                    
266700             WHEN SQLCODE = ZERO                                          
266800             WHEN SQLCODE = -811                                          
266900                 SET PS-CNTK-FOUND TO TRUE                                
267000                                                                          
267100             WHEN SQLCODE = +100                                          
267200                 SET PS-CNTK-FOUND-NO TO TRUE                             
267300                                                                          
267400             WHEN SQLCODE = -904                                          
267500             WHEN SQLCODE = -913                                          
267600                 CONTINUE                                                 
267700                                                                          
267800             WHEN OTHER                                                   
267900                 DISPLAY '**************************************'         
268000                 DISPLAY '** ABEND                            **'         
268100                 DISPLAY '** PROGRAM = TRKUP255               **'         
268200                 DISPLAY '** PARAGRAPH = 7200-SELECT-TIMCNPO  **'         
268300                 DISPLAY '** SELECT TIMCNPO                   **'         
268400                 DISPLAY '**************************************'         
268500                 DISPLAY '** CONTNR ID          '                         
268600                                    IMCNTK-CONTNR-ID                      
268900                 DISPLAY '** TR028-DPU-PO-NBR        '                    
269000                                    TR028-DPU-PO-NBR                      
269100                 DISPLAY '**************************************'         
269200                 PERFORM 9100-SQL-ABEND                                   
269300         END-EVALUATE                                                     
269400     END-PERFORM.                                                         
269500                                                                          
269600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
269700         (SQLCODE NOT = ZERO  AND                                         
269800          SQLCODE NOT = +100  AND                                         
269900          SQLCODE NOT = -811)                                             
270000                                                                          
270100         DISPLAY '****************************************'               
270200         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
270300         DISPLAY '** SELECT FROM TIMCNTK                **'               
270400         DISPLAY '** PARAGRAPH = 7200-SELECT-TIMCNPO    **'               
270500                 DISPLAY '** CONTNR ID          '                         
270600                                    IMCNTK-CONTNR-ID                      
270900                 DISPLAY '** TR028-DPU-PO-NBR        '                    
271000                                    TR028-DPU-PO-NBR                      
271100         DISPLAY '****************************************'               
271200         PERFORM 9100-SQL-ABEND                                           
271300     END-IF.                                                              
271400                                                                          
271500 EJECT                                                                    
271600******************************************************************        
271700* INSERT A ROW INTO THE CONTAINER PO AUDIT TABLE (TAUCNPO).      *        
271800******************************************************************        
                                                                                
      * MS 07/01/2010                                                           
      * ADDED DCONSLR_DELY_CDE                                                  
                                                                                
271900 7210-INSERT-TAUCNPO.                                                     
272000                                                                          
272100     PERFORM                                                              
272200         WITH TEST AFTER                                                  
272300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
272400         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
272500                 SQLCODE = ZERO                                           
272600                                                                          
272700         EXEC SQL                                                         
272800             INSERT INTO TAUCNPO                                          
272900                   ( CONTNR_ID                                            
273000                    ,CONTNR_SEQ_NBR                                       
273100                    ,PO_NBR                                               
273200                    ,CSTM_ENTR_ID                                         
273300                    ,MSTR_BOL_NBR                                         
273400                    ,HSE_BOL_NBR                                          
273500                    ,LTR_OF_CR_NBR                                        
273600                    ,PO_RCVD_DELY_TMST                                    
273700                    ,PO_C_O_PROD_CDE                                      
273800                    ,PO_CART_CNT                                          
273900                    ,PO_CBMT_QTY                                          
274000                    ,PO_WT_KGRM_QTY                                       
274100                    ,PO_UNT_QTY                                           
274400                    ,LAST_UPD_BY_USR_ID                                   
274500                    ,LAST_UPD_TMST                                        
274600                    ,AUD_FUNC_CDE                                         
274700                    ,AUD_TMST                                             
274800                    ,EXTL_REF_NBR                                         
274900                    ,BKR_FRGT_RLSE_CDE                                    
275000                    ,DO_RCVD_CDE                                          
275100                    ,CONTNR_PU_CDE                                        
275200                    ,ACTL_POE_DELY_CDE                                    
275300                    ,DVN_CDE                                              
275400                    ,DCONSLR_RET_CDE                                      
275410                    ,SPLT_XMIT_CDE                                        
                          ,DOC_RCVD_ORGN_TMST                                   
                          ,DCONSLR_DELY_CDE)                                    
275500             VALUES                                                       
275600                    (:AUCNPO-CONTNR-ID                                    
275700                    ,:AUCNPO-CONTNR-SEQ-NBR                               
275800                    ,:AUCNPO-PO-NBR                                       
275900                    ,:AUCNPO-CSTM-ENTR-ID                                 
276000                    ,:AUCNPO-MSTR-BOL-NBR                                 
276100                    ,:AUCNPO-HSE-BOL-NBR                                  
276200                    ,:AUCNPO-LTR-OF-CR-NBR                                
276300                    ,:AUCNPO-PO-RCVD-DELY-TMST                            
276400                    ,:AUCNPO-PO-C-O-PROD-CDE                              
276500                    ,:AUCNPO-PO-CART-CNT                                  
276600                    ,:AUCNPO-PO-CBMT-QTY                                  
276700                    ,:AUCNPO-PO-WT-KGRM-QTY                               
276800                    ,:AUCNPO-PO-UNT-QTY                                   
277100                    ,:AUCNPO-LAST-UPD-BY-USR-ID                           
277200                    ,:AUCNPO-LAST-UPD-TMST                                
277300                    ,:AUCNPO-AUD-FUNC-CDE                                 
277400                    ,:AUCNPO-AUD-TMST                                     
277500                    ,:AUCNPO-EXTL-REF-NBR                                 
277600                    ,:AUCNPO-BKR-FRGT-RLSE-CDE                            
277700                    ,:AUCNPO-DO-RCVD-CDE                                  
277800                    ,:AUCNPO-CONTNR-PU-CDE                                
277900                    ,:AUCNPO-ACTL-POE-DELY-CDE                            
278000                    ,:AUCNPO-DVN-CDE                                      
278100                    ,:AUCNPO-DCONSLR-RET-CDE                              
278110                    ,:AUCNPO-SPLT-XMIT-CDE                                
                          ,:AUCNPO-DOC-RCVD-ORGN-TMST                           
                          ,:AUCNPO-DCONSLR-DELY-CDE)                            
278200                                                                          
278300         END-EXEC                                                         
278400                                                                          
278500         EVALUATE TRUE                                                    
278600             WHEN SQLCODE = ZERO                                          
278700                 ADD +1 TO PA-TOT-ACNPO-INSERTS                           
278800                 ADD +1 TO PA-TOT-RECS-AUDITED                            
278900                                                                          
279000             WHEN SQLCODE = -904                                          
279100             WHEN SQLCODE = -913                                          
279200                 CONTINUE                                                 
279300                                                                          
279400             WHEN OTHER                                                   
279500                 DISPLAY '**************************************'         
279600                 DISPLAY '** ABEND                            **'         
279700                 DISPLAY '** PROGRAM = TRKUP255               **'         
279800                 DISPLAY '** PARAGRAPH = 7210-INSERT-TAUCNPO  **'         
279900                 DISPLAY '** INSERT INTO TAUCNPO              **'         
280000                 DISPLAY '** AUCNPO-CONTNR-ID = '                         
280100                 DISPLAY                   AUCNPO-CONTNR-ID               
280200                 DISPLAY '** CONTNR SEQ NBR  = '                          
280300                 DISPLAY                   AUCNPO-CONTNR-SEQ-NBR          
280400                 DISPLAY '** CONTNR PO NBR   = '                          
280500                 DISPLAY                   AUCNPO-PO-NBR                  
280800                 DISPLAY '**************************************'         
280900                 PERFORM 9100-SQL-ABEND                                   
281000         END-EVALUATE                                                     
281100     END-PERFORM.                                                         
281200                                                                          
281300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
281400         SQLCODE NOT = ZERO                                               
281500         DISPLAY '****************************************'               
281600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
281700         DISPLAY '** INSERT TO TAUCNPO                  **'               
281800         DISPLAY '** PARAGRAPH = 7210-INSERT-TAUCNPO    **'               
281900         DISPLAY '** AUCNPO-CONTNR-ID = ' AUCNPO-CONTNR-ID                
282000         DISPLAY '** CONTNR SEQ NBR   = '                                 
282100         DISPLAY                     AUCNPO-CONTNR-SEQ-NBR                
282200         DISPLAY '** CONTNR PO NBR    = '                                 
282300         DISPLAY                     AUCNPO-PO-NBR                        
282600         DISPLAY '****************************************'               
282700         PERFORM 9100-SQL-ABEND                                           
282800     END-IF.                                                              
282900                                                                          
283000 EJECT                                                                    
283100******************************************************************        
283200* INSERT A ROW INTO THE DB2 WORK TABLE (TOUTTR9).                *        
283300******************************************************************        
283400 7300-INSERT-TOUTTR9-RPT.                                                 
283500                                                                          
283600     MOVE TR241-DLV-RPT-PAR-1-ODR                                         
283601                                TO OUTTR9-DELY-PARM-1-ODR.                
283610     MOVE TR241-DLV-RPT-PAR-2-ODR                                         
283611                                TO OUTTR9-DELY-PARM-2-ODR.                
283620                                                                          
283800     IF TR251-RPT-TYP = PC-D                                              
283900        ADD +1                  TO PA-TOTAL-DETAIL-COUNT                  
284000        ADD +1                  TO PA-TOTAL-RECS-LOADED                   
284100     ELSE                                                                 
284200        ADD +1                  TO PA-TOTAL-ERROR-COUNT                   
284300        ADD +1                  TO PA-TOTAL-RECS-LOADED                   
284400     END-IF.                                                              
284500                                                                          
284600       PERFORM                                                            
284700         WITH TEST AFTER                                                  
284800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
284900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
285000                 SQLCODE = ZERO                                           
285100                                                                          
285200     EXEC SQL                                                             
285300         INSERT INTO TOUTTR9                                              
285400             (DELY_PARM_1_ODR                                             
285410             ,DELY_PARM_2_ODR)                                            
285500            VALUES  (:OUTTR9-DELY-PARM-1-ODR                              
285510                    ,:OUTTR9-DELY-PARM-2-ODR)                             
285600     END-EXEC                                                             
285700                                                                          
285800         EVALUATE TRUE                                                    
285900             WHEN SQLCODE = ZERO                                          
286000                 CONTINUE                                                 
286100                                                                          
286200             WHEN SQLCODE = -904                                          
286300             WHEN SQLCODE = -913                                          
286400                 CONTINUE                                                 
286500                                                                          
286600             WHEN SQLWARN0 NOT EQUAL SPACE                                
286700             WHEN SQLCODE NOT EQUAL ZERO                                  
286800                 DISPLAY '**************************************'         
286900                 DISPLAY '** ABEND                            **'         
287000                 DISPLAY '** PROGRAM = TRKUP255               **'         
287100              DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR9-RPT **'         
287200                 DISPLAY '** INSERT INTO TOUTTR9              **'         
287300                 DISPLAY '** TR251-CONTNR-ID = ' TR251-CONTNR-ID          
287400                 DISPLAY '** CONTNR ID          '                         
287500                                    IMCNTK-CONTNR-ID                      
287800                 DISPLAY '** TR028-DPU-PO-NBR        '                    
287900                                    TR028-DPU-PO-NBR                      
288000                 DISPLAY '**************************************'         
288100                 PERFORM 9100-SQL-ABEND                                   
288200         END-EVALUATE                                                     
288300     END-PERFORM.                                                         
288400                                                                          
288500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
288600         (SQLCODE NOT = ZERO)                                             
288700        DISPLAY '****************************************'                
288800        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'            
288900        DISPLAY '** INSERT TO TOUTTR9                      **'            
289000        DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR9-RPT    **'            
289100        DISPLAY '** TR251-CONTNR-ID = ' TR251-CONTNR-ID                   
289200        DISPLAY '** TR251-PROCESS-SEQ-NBR = '                             
289300        DISPLAY                TR251-PROCESS-SEQ-NBR                      
289400        DISPLAY '****************************************'                
289500      PERFORM 9100-SQL-ABEND                                              
289600     END-IF.                                                              
289700                                                                          
289800 EJECT                                                                    
289900******************************************************************        
290000* SELECT IMPORT CONTAINER MANIFEST TABLE (TIMCNTK) WITHOUT USING          
290100* EXTERNAL REF NUMBER ON JOIN TO TIMCNPO.  IF A ROW IS FOUND,             
290200* YOU HAD A BAD EXTERNAL REF NUMBER ON THE ORIGINAL SELECT.               
290300******************************************************************        
290400                                                                          
290500 7400-ERROR-SELECT-TIMCNTK.                                               
290600                                                                          
290700       EXEC SQL                                                           
290800           SELECT A.CONTNR_ID                                             
290900            INTO :IMCNTK-CONTNR-ID                                        
291000             FROM TIMCNTK A                                               
291100                , TIMCNPO B                                               
291200            WHERE B.PO_NBR           = :IMCNPO-PO-NBR                     
291300              AND B.CONTNR_ID        = :IMCNTK-CONTNR-ID                  
291400              AND A.CONTNR_ID        = B.CONTNR_ID                        
291500              AND A.CONTNR_SEQ_NBR   = B.CONTNR_SEQ_NBR                   
291600       END-EXEC                                                           
291700                                                                          
291800       EVALUATE TRUE                                                      
291900           WHEN SQLCODE = ZERO                                            
292000           WHEN SQLCODE = -811                                            
292100               SET PS-EXTERNAL-REF-FOUND-NO  TO TRUE                      
292200                                                                          
292300           WHEN SQLCODE = +100                                            
292400               CONTINUE                                                   
292500                                                                          
292600           WHEN SQLWARN0 NOT EQUAL SPACE                                  
292700           WHEN SQLCODE NOT EQUAL ZERO                                    
292800               DISPLAY '**************************************'           
292900               DISPLAY '** ABEND                            **'           
293000               DISPLAY '** PROGRAM = TRKUP255               **'           
293100               DISPLAY '** PARAGRAPH = 7400-ERROR-SELECT-TIMCNTK'         
293200               DISPLAY '** SELECT TIMCNTK                   **'           
293300               DISPLAY '**************************************'           
293400               DISPLAY '** CONTNR ID          '                           
293500                                  IMCNTK-CONTNR-ID                        
293600               DISPLAY '** TR028-DPU-PO-NBR        '                      
293700                                  TR028-DPU-PO-NBR                        
293800               DISPLAY '**************************************'           
293900               PERFORM 9100-SQL-ABEND                                     
294000                                                                          
294100       END-EVALUATE.                                                      
294200                                                                          
294300 EJECT                                                                    
291300******************************************************************        
291400* INSERT ROW INTO TRTW_DELY_CKPR,  THE DB2 WORK TABLE FOR THE    *        
291500* TR405 MQ MESSAGE.                                              *        
291600******************************************************************        
291700 7500-INSERT-SCM-MESSAGE.                                                 
291800                                                                          
291900     PERFORM                                                              
292000         WITH TEST AFTER                                                  
292100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
292200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
292300                 SQLCODE = ZERO                                           
292400                                                                          
292500         EXEC SQL                                                         
292600              INSERT INTO TRTW_DELY_CKPR                                  
292700                  (CKPR_REC_1_TXT)                                        
292900                 VALUES  (:TRT00041-CKPR-REC-1-TXT)                       
293100         END-EXEC                                                         
293200                                                                          
293300         EVALUATE TRUE                                                    
293400                                                                          
293500             WHEN SQLCODE = ZERO                                          
293600                 CONTINUE                                                 
293700                                                                          
293800             WHEN SQLWARN0 NOT EQUAL SPACE                                
293900             WHEN SQLCODE NOT EQUAL ZERO                                  
294000                 DISPLAY '**************************************'         
294100                 DISPLAY '** ABEND                            **'         
294200                 DISPLAY '** PROGRAM = TRKUP255               **'         
294300                 DISPLAY '** PARAGRAPH = 7500-INSERT-SCM-     **'         
294400                 DISPLAY '**                  MESSAGE         **'         
294500                 DISPLAY '** INSERT TRTW_DELY_CKPR            **'         
294600                 DISPLAY '** TRT00041-RECORD = '                          
294700                 DISPLAY '*'           TRT00041-CKPR-REC-1-TXT            
294800                 DISPLAY '**************************************'         
294900                 PERFORM 9100-SQL-ABEND                                   
295000         END-EVALUATE                                                     
295100     END-PERFORM.                                                         
295200                                                                          
295300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
295400         SQLCODE NOT = ZERO                                               
295500         DISPLAY '****************************************'               
295600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
295700         DISPLAY '** INSERT INTO TRTW_DELY_CKPR         **'               
295800         DISPLAY '** PARAGRAPH = 7500-INSERT-SCM-MESSAGE**'               
295900         DISPLAY '** TRT00041-RECORD = '                                  
296000         DISPLAY '*'           TRT00041-CKPR-REC-1-TXT                    
296100         DISPLAY '****************************************'               
296200         PERFORM 9100-SQL-ABEND                                           
296300     END-IF.                                                              
296400                                                                          
296500                                                                  23620018
296600 EJECT                                                            23630018
294400******************************************************************        
294500* SET THE CURRENT TIMESTAMP.                                     *        
294600******************************************************************        
294700 7999-SET-CURRENT-TMST.                                                   
294800                                                                          
294900          EXEC SQL                                                        
295000              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                    
295100          END-EXEC                                                        
295200                                                                          
295300         EVALUATE TRUE                                                    
295400             WHEN SQLCODE = ZERO                                          
295500                 CONTINUE                                                 
295600                                                                          
295700             WHEN SQLWARN0 NOT EQUAL SPACE                                
295800             WHEN SQLCODE NOT EQUAL ZERO                                  
295900                 DISPLAY '**************************************'         
296000                 DISPLAY '** ABEND                            **'         
296100                 DISPLAY '** PROGRAM = TRKUP255               **'         
296200                 DISPLAY '** PARAGRAPH = 7999-SET-CURRENT-TMST**'         
296300                 DISPLAY '** SET CURRENT TIMESTAMP            **'         
296400                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST           
296500                 DISPLAY '**************************************'         
296600                 PERFORM 9100-SQL-ABEND                                   
296700         END-EVALUATE.                                                    
296800                                                                          
296900 EJECT                                                                    
297000******************************************************************        
297100* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *        
297200* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *        
297300* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *        
297400* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *        
297500* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *        
297600* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*        
297700* NO RETURN CODE OR MESSAGE IS SENT.                             *        
297800******************************************************************        
297900 8000-EOJ-ROUTINE.                                                        
298000                                                                          
298100     PERFORM 4300-COMMIT.                                                 
298200     DISPLAY 'COMMIT TAKEN AT '.                                          
298300     DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)           
298400      '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2).          
298500                                                                          
298600     CLOSE TR028-DELIVERY-FILE.                                           
298700                                                                          
298800     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.                      
298900     PERFORM 4200-UPDATE-TCKRSTCNTL.                                      
299000                                                                          
299100     DISPLAY '**************************************'.                    
299200     DISPLAY '** TRKUP255 SUMMARY **'.                                    
299300     DISPLAY 'TOTAL EDI RECORDS        ' PA-TOT-EDI-RECS-READ.            
299400     DISPLAY 'TOTAL DPU RECORDS        ' PA-TOT-DPU-RECS-READ.            
299500     DISPLAY 'TOTAL DLV RECORDS        ' PA-TOT-DLV-RECS-READ.            
           DISPLAY 'TOTAL ARVDCN RECORDS     ' PA-TOT-ARVDCN-RECS-READ.         
299600     DISPLAY 'TOTAL DVN RECORDS        ' PA-TOT-DVN-RECS-READ.            
299700     DISPLAY 'TOTAL CRP RECORDS        ' PA-TOT-CRP-RECS-READ.            
299800     DISPLAY 'TOTAL RTN RECORDS        ' PA-TOT-RTN-RECS-READ.            
299900     DISPLAY 'TOTAL DPURD RECORDS      ' PA-TOT-DPURD-RECS-READ.          
300000     DISPLAY 'TOTAL DLVRD RECORDS      ' PA-TOT-DLVRD-RECS-READ.          
           DISPLAY 'TOTAL ARVDRD RECORDS     ' PA-TOT-ARVDRD-RECS-READ.         
300100     DISPLAY 'TOTAL DVNRD RECORDS      ' PA-TOT-DVNRD-RECS-READ.          
300200     DISPLAY 'TOTAL CRPRD RECORDS      ' PA-TOT-CRPRD-RECS-READ.          
300300     DISPLAY 'TOTAL RTNRD RECORDS      ' PA-TOT-RTNRD-RECS-READ.          
300400     DISPLAY 'TOTAL RECORDS READ       ' PA-TOTAL-RECS-READ.              
300500     DISPLAY '**************************************'.                    
300600*                                                                         
300700     DISPLAY 'TOTAL ADD    TRANS     = ' PA-TOT-TRN-TYP-A.                
300800     DISPLAY 'TOTAL CHANGE TRANS     = ' PA-TOT-TRN-TYP-C.                
300900     DISPLAY 'TOTAL DELETE TRANS     = ' PA-TOT-TRN-TYP-D.                
301000     DISPLAY '**************************************'.                    
301100*                                                                         
301200     DISPLAY 'TOTAL CNTK UPDATE COUNT = ' PA-TOT-CNTK-UPDATES.            
301300     DISPLAY 'TOTAL CNPO UPDATE COUNT = ' PA-TOT-CNPO-UPDATES.            
301400*    DISPLAY 'TOTAL RECORDS UPDATED   = ' PA-TOT-RECS-UPDATED.            
301500     DISPLAY '**************************************'.                    
301600*                                                                         
301700     DISPLAY 'TOTAL CNTK AUDIT COUNT = ' PA-TOT-ACNTK-INSERTS.            
301800     DISPLAY 'TOTAL CNPO AUDIT COUNT = ' PA-TOT-ACNPO-INSERTS.            
301900*    DISPLAY 'TOTAL RECORDS AUDITED  = ' PA-TOT-RECS-AUDITED.             
302000     DISPLAY '**************************************'.                    
302100*                                                                         
302200     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.                
302300*                                                                         
302400     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.            
302500     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.           
302600     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED.            
302700     DISPLAY '**************************************'.                    
302800                                                                          
302900 EJECT                                                                    
303000******************************************************************        
303100* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *        
303200* ERROR OR WARNING CODE OCCURS.                                  *        
303300******************************************************************        
303400 9100-SQL-ABEND.                                                          
303500******************************************************************        
303600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *        
303700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *        
303800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *        
303900* FORMAT.                                                        *        
304000******************************************************************        
304100                                                                          
304200     COPY DPPD004.                                                        
304300                                                                          
304400     DISPLAY 'CONTNR ABEND     '  TR028-DPU-CONTNR-ID.                    
304500     DISPLAY 'CONTAINER SEQUENCE NBR  '                                   
304600                                TR028-DPU-SEQ-NBR.                        
304700     MOVE +4013 TO ABEND-CODE.                                            
304800     CALL 'ILBOABN0' USING ABEND-CODE.                                    
