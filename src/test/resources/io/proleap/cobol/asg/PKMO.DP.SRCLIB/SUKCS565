000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS565.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  AUGUST, 2001.                                     00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S565 - SHIPPING DOOR STATUS  - SML CARTON DETAIL LIST      * 00100000
001100*---------------------------------------------------------------* 00110000
001110* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00111050
001120* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112051
001130* MAKING THE CALL DYNAMIC VS STATIC.                              00113051
001131*                                                                 00113156
001132* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00113252
001133* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00113352
001140*---------------------------------------------------------------* 00114051
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-TRLR-SRL-NBR                PIC S9(09) COMP.          00170000
001800     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00180000
001900     05  DK-KOHLS-BARCODE.                                        00190000
002000         10   FILLER                    PIC X(02)  VALUE '00'.    00200000
002100         10   DK-KOHLS-18               PIC X(18)  VALUE SPACES.  00210000
002200         10   FILLER                    PIC X(02)  VALUE SPACES.  00220000
002300     05  DK-KOHLS-BRCDE REDEFINES DK-KOHLS-BARCODE                00230000
002400                                        PIC X(22).                00240000
002500     05  DK-CRE-DATE.                                             00250000
002600         10   DK-TMST-CCYY              PIC X(04).                00260000
002700         10   FILLER                    PIC X(01).                00270000
002800         10   DK-TMST-MM                PIC X(02).                00280000
002900         10   FILLER                    PIC X(01).                00290000
003000         10   DK-TMST-DD                PIC X(02).                00300000
003100     05  DK-CRE-TIME.                                             00310000
003200         10   DK-TMST-HRS               PIC X(02).                00320000
003300         10   FILLER                    PIC X(01).                00330000
003400         10   DK-TMST-MIN               PIC X(02).                00340000
003500         10   FILLER                    PIC X(01).                00350000
003600         10   DK-TMST-SEC               PIC X(02).                00360000
003700     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00370000
003800                                                    COMP.         00380000
003900     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00390000
004000                                                    COMP.         00400000
004100     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00410000
004200     05  DK-TRN-NBR-N REDEFINES DK-PO-TRN-NBR.                    00420000
004300         10  DK-TRN-NBR-X               PIC X(09).                00430000
004400     05  DK-TRN-NBR-9.                                            00440000
004500         10  FILLER                       PIC X(01) VALUE SPACES. 00450000
004600         10  DK-TRN-NBR-8                 PIC X(08) VALUE SPACES. 00460000
004700                                                                  00470000
004800     05  DK-PO-RCVR-NBR-N                 PIC 9(09) VALUE ZEROES. 00480000
004900     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00490000
005000         10  DK-RCVR-NBR-X                PIC X(09).              00500000
005100     05  DK-RCVR-NBR-9.                                           00510000
005200         10  FILLER                       PIC X(05) VALUE SPACES. 00520055
005300         10  DK-RCVR-NBR-3                PIC X(04) VALUE SPACES. 00530055
005400                                                                  00540000
005500     05  DK-PO-RCVR.                                              00550000
005600         10  DK-TRN-NBR                   PIC X(08) VALUE SPACES. 00560000
005700         10  FILLER                       PIC X(01) VALUE '-'.    00570000
005800         10  DK-RCVR-NBR                  PIC X(04) VALUE SPACES. 00580055
005810     05  DK-PULL-NBR.                                             00581031
005820         10  DK-PULL                      PIC Z(09) VALUE ZEROES. 00582031
005830         10  DK-PULL-CS                   PIC X(03) VALUE '-CS'.  00583031
005900                                                                  00590000
006000     05  DK-SHPD-QTY                      PIC Z(05) VALUE ZEROES. 00600000
006100     05  DK-SHPD-QTY-X REDEFINES DK-SHPD-QTY                      00610000
006200                                          PIC X(05).              00620000
006300                                                                  00630000
006400 01  PC-PROGRAM-CONSTANTS.                                        00640000
006500     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU565A  '.  00650000
006600     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM565'.   00660000
006700     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS565'.  00670000
006800     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00680000
006900     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00690000
007000     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00700000
007100     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00710000
007200     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00720000
007300                                               COMP SYNC.         00730000
007400     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00740000
007500                                               COMP SYNC.         00750000
007600     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00760000
007700                                               COMP-3.            00770000
007800     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00780000
007900                                               COMP SYNC.         00790000
008000     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00800000
008100                                               COMP-3.            00810000
008200     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00820000
008300     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00830000
008400     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00840000
008500     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00850000
008600     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00860000
008700     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00870000
008800                                               COMP.              00880000
008900     05  PC-01                     PIC  X(02)  VALUE '01'.        00890000
009000     05  PC-A                      PIC  X(01)  VALUE 'A'.         00900000
009100                                                                  00910051
009200*----------------------------------------------------------------*00920000
009300*  SYSTEM MESSAGES                                               *00930000
009400*----------------------------------------------------------------*00940000
009500*   00005 = INVALID VALUE                                        *00950000
009600*   00008 = MUST BE NUMERIC                                      *00960000
009700*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00970000
009800*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00980000
009900*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00990000
010000*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01000000
010100*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01010000
010200*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01020000
010300*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01030000
010400*   00069 - TOP OF LIST                                          *01040000
010500*   00070 - BOTTOM OF LIST                                       *01050000
010600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01060000
010700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01070000
010800*   00279 - MORE ITEMS TO DISPLAY                                *01080000
010900*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01090000
011000*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01100000
011100*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01110000
011200*   99901 = INVALID COMMAND WAS ENTERED                          *01120000
011300*----------------------------------------------------------------*01130000
011400     05  PC-TSYMSG-NUMBERS.                                       01140000
011500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01150000
011600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01160000
011700         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01170000
011800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01180000
011900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01190000
012000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01200000
012100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01210000
012200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01220000
012300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01230000
012400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01240000
012500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01250000
012600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01260000
012700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01270000
012800         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01280000
012900         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01290000
013000         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01300000
013100         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01310000
013200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01320000
013300         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01330000
013400         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01340000
013500*                                                                 01350000
013600 01  PS-PROGRAM-SWITCHES.                                         01360000
013700     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01370000
013800         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01380000
013900         88  PS-BLOCK-ERROR                         VALUE 'N'.    01390000
014000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01400000
014100         88  PS-NO-ERROR                            VALUE 'Y'.    01410000
014200         88  PS-ERROR                               VALUE 'N'.    01420000
014300     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01430000
014400         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01440000
014500         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01450000
014600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01460000
014700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01470000
014800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01480000
014900     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01490000
015000         88  PS-DONE                                VALUE 'Y'.    01500000
015100         88  PS-NOT-DONE                            VALUE 'N'.    01510000
015200     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01520000
015300         88  PS-LIST-END                            VALUE  'Y'.   01530000
015400         88  PS-NO-LIST-END                         VALUE  'N'.   01540000
015500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01550000
015600         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01560000
015700         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01570000
015800*                                                                 01580000
015900 01  PV-PROGRAM-VARIABLES.                                        01590000
016001     05  PV-DISPLAY-PARENT               PIC  9(18)  VALUE  0.    01600120
016010     05  PV-DISPLAY-ORIG                 PIC  9(18)  VALUE  0.    01601008
016100     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01610000
016200                                                     COMP SYNC.   01620000
016300     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01630000
016400     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01640000
016500     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01650000
016600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01660000
016700                                        COMP SYNC.                01670000
016800     05  PV-SUB                         PIC S9(04)  VALUE +0      01680000
016900                                                    COMP SYNC.    01690000
017000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01720000
017300                                                    COMP-3.       01730000
017400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01740000
017500                                                    COMP-3.       01750000
017600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01760000
017700                                                    COMP-3.       01770000
017800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01780000
017900                                                    COMP-3.       01790000
018000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01800000
018100                                                    COMP-3.       01810000
018200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01820000
018300                                                    COMP-3.       01830000
018400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01840000
018500                                                    COMP-3.       01850000
018600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01860000
018700                                                    COMP SYNC.    01870000
018800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01880000
018900                                                    COMP SYNC.    01890000
019000     05  PV-ITEM                        PIC S9(04)  VALUE +0      01900000
019100                                                    COMP SYNC.    01910000
019200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01920000
019300                                                    COMP SYNC.    01930000
019400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01940000
019500                                                    COMP SYNC.    01950000
019600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01960000
019700                                                    COMP SYNC.    01970000
019800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01980000
019900                                                    COMP SYNC.    01990000
020000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02000000
020100                                                    COMP SYNC.    02010000
020200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02020000
020300                                                    COMP SYNC.    02030000
020400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02040000
020500                                                    COMP SYNC.    02050000
020600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02060000
020700                                                    COMP SYNC.    02070000
020800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02080000
020900                                                    COMP SYNC.    02090000
021000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02100000
021100                                                    COMP SYNC.    02110000
021200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02120000
021300                                                    COMP SYNC.    02130000
021400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02140000
021500                                                    COMP SYNC.    02150000
021600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02160000
021700                                                    COMP SYNC.    02170000
021800     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02180000
021900                                                    COMP.         02190000
022000     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02200000
022100                                                    COMP.         02210000
022200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02220000
022300                                                    COMP.         02230000
022310     05  PV-STR-SCAN-COUNT              PIC S9(09)  VALUE +0      02231046
022320                                                    COMP.         02232046
022400     05  PV-SOFT-ABORT-MSG.                                       02240000
022500         10  FILLER            PIC X(12) VALUE ' SUKCS565 - '.    02250000
022600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02260000
022700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02270000
022800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02280000
022900         10  PV-SOFT-PARAGRAPH PIC X(30).                         02290000
023000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02300000
023100                                                     COMP SYNC.   02310000
023200     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02320000
023300     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02330000
023400     05  PV-CICS-MSG-HOLD.                                        02340000
023500         10  FILLER                      PIC  X(01)  VALUE SPACE. 02350000
023600         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02360000
023700     05  PV-CICS-MSG-HOLD2.                                       02370000
023800         10  FILLER                      PIC  X(01)  VALUE SPACE. 02380000
023900         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02390000
024000     05  PV-TASK                         PIC 9999.                02400000
024100     05  PV-SHIPT-UNT-ID                 PIC 9(18).               02410000
024200     05  PV-SOURCE                       PIC X(01).               02420000
024300                                                                  02430000
024400     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02440000
024500     05  PV-TMST-R REDEFINES  PV-TMST.                            02450000
024600         10   PV-TMST-CCYY              PIC X(04).                02460000
024700         10   FILLER                    PIC X(01).                02470000
024800         10   PV-TMST-MM                PIC X(02).                02480000
024900         10   FILLER                    PIC X(01).                02490000
025000         10   PV-TMST-DD                PIC X(02).                02500000
025100         10   FILLER                    PIC X(01).                02510000
025200         10   PV-TMST-HRS               PIC X(02).                02520000
025300         10   FILLER                    PIC X(01).                02530000
025400         10   PV-TMST-MIN               PIC X(02).                02540000
025500         10   FILLER                    PIC X(01).                02550000
025600         10   PV-TMST-SEC               PIC X(02).                02560000
025700         10   FILLER                    PIC X(07).                02570000
025800     05  PV-DATE-DISPLAY.                                         02580000
025900         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02590000
026000         10   PV-SLASH-1                PIC X(01)   VALUE '/'.    02600000
026100         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02610000
026200         10   PV-SLASH-2                PIC X(01)   VALUE '/'.    02620000
026300         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 02630000
026400     05  PV-TIME-DISPLAY.                                         02640000
026500         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 02650000
026600         10   PV-SEMICOLON-1            PIC X(01)   VALUE ':'.    02660000
026700         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 02670000
026800         10   PV-SEMICOLON-2            PIC X(01)   VALUE ':'.    02680000
026900         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 02690000
027000     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02700000
027100     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02710000
027200     05  PV-SEL-TERM-ID                  PIC  X(04).              02720000
027300     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02730000
027400     05  PV-SEL-SEQ                      PIC  9(01).              02740000
027500     05  PV-SHPD-QTY                     PIC S9(9)V COMP-3.       02750000
027600     05  PV-SHPD-QTY-N                   PIC Z(05).               02760000
027700     05  PV-SHPD-QTY-X REDEFINES PV-SHPD-QTY-N                    02770000
027800                                         PIC X(05).               02780000
027900                                                                  02790000
028000     05  PV-CARTON-MSG.                                           02800000
028100         10  FILLER                   PIC X(01) VALUE SPACE.      02810000
028200         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 02820000
028300         10  FILLER                   PIC X(01) VALUE '-'.        02830000
028400         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     02840000
028500         10  FILLER                   PIC X(05) VALUE ' REC='.    02850000
028600         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     02860000
028700         10  FILLER                   PIC X(10)                   02870000
028800                             VALUE ' CTN STAT='.                  02880000
028900         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     02890000
029000         10  FILLER                   PIC X(01) VALUE '/'.        02900051
029100         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     02910000
029200         10  FILLER                   PIC X(05) VALUE ' SER='.    02920000
029300         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     02930000
029400         10  FILLER                   PIC X(06) VALUE ' TRIP='.   02940000
029500         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     02950000
029600         10  FILLER                   PIC X(06) VALUE ' STAT='.   02960000
029700         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     02970000
029800         10  FILLER                   PIC X(06) VALUE ' USER='.   02980000
029900         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     02990000
029901                                                                  02990156
029910     05  PV-WORK-DEPT-NBR-N           PIC 9(04).                  02991057
029911     05  PV-WORK-DEPT-NBR-R REDEFINES PV-WORK-DEPT-NBR-N.         02991157
029920         10  FILLER                   PIC X(01).                  02992056
029921         10  PV-WORK-DEPT-2-4         PIC X(03).                  02992156
029940     05  PV-WORK-SUB-CL-NBR-N         PIC 9(04).                  02994057
029941     05  PV-WORK-SUB-CL-NBR-R REDEFINES PV-WORK-SUB-CL-NBR-N.     02994158
029942         10  FILLER                   PIC X(01).                  02994257
029950         10  PV-WORK-SUB-CL-2-4       PIC X(03).                  02995056
030000                                                                  03000000
030100******************************************************************03010000
030200* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03020049
030300******************************************************************03030000
030400     COPY PCWS046.                                                03040000
030500                                                                  03050051
030600******************************************************************03060000
030700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03070000
030800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03080000
030900**  APPLICATION-SPECIFIC COMMAREA.                              **03090000
031000******************************************************************03100000
031100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03110000
031200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03120000
031300     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03130000
031400                                        INDEXED BY LQW-IDX.       03140000
031500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03150000
031600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03160000
031700         10  LQW-SELECTED-SW            PIC  X(01).               03170000
031800             88  LQW-SELECT                         VALUE 'S'.    03180000
031900             88  LQW-DESELECT                       VALUE ' '.    03190000
032000         10  LQW-ACTION                 PIC  X(03).               03200000
032100             88  LQW-DEL                            VALUE 'DEL'.  03210000
032200             88  LQW-INQ                            VALUE 'INQ'.  03220000
032300             88  LQW-UPD                            VALUE 'UPD'.  03230000
032400             88  LQW-ERR                            VALUE 'ERR'.  03240000
032500         10  LQW-PO-RCVR                PIC  X(13).               03250054
032600         10  LQW-LINE-NBR               PIC  9(03).               03260056
032700         10  LQW-DEPT-NBR               PIC  X(03).               03270056
032800         10  LQW-CLASS                  PIC  X(03).               03280056
032900         10  LQW-SKU-NBR                PIC  9(08).               03290000
033000         10  LQW-SKU-DESC               PIC  X(19).               03300000
033100         10  LQW-UPC-NBR                PIC  9(15).               03310000
033200         10  LQW-QTY                    PIC  9(05).               03320000
033300                                                                  03330000
033400*---------------------------------------------------------------* 03340000
033500* SELECTON QUEUE LAYOUT                                         * 03350000
033600*---------------------------------------------------------------* 03360000
033700     COPY SUWS010.                                                03370000
033800                                                                  03380000
033900*---------------------------------------------------------------* 03390000
034000*    MAP LAYOUT                                                 * 03400000
034100*---------------------------------------------------------------* 03410000
034200     COPY SUKM565.                                                03420000
034300                                                                  03430051
034400 01  MR-OCCURS-LAYOUT                   REDEFINES  SU565AO.       03440000
034500     05  FILLER                         PIC X(352).               03450041
034600     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03460000
035800                                                                  03580000
035900         10  MR-PO-RCVRL                PIC S9(04) COMP.          03590000
036000         10  MR-PO-RCVRA                PIC  X(01).               03600000
036100         10  MR-PO-RCVRC                PIC  X(01).               03610000
036200         10  MR-PO-RCVRH                PIC  X(01).               03620000
036300         10  MR-PO-RCVR                 PIC  X(13).               03630053
036400                                                                  03640000
036500         10  MR-LINE-NBRL               PIC S9(04) COMP.          03650000
036600         10  MR-LINE-NBRA               PIC  X(01).               03660000
036700         10  MR-LINE-NBRC               PIC  X(01).               03670000
036800         10  MR-LINE-NBRH               PIC  X(01).               03680000
036900         10  MR-LINE-NBR                PIC  X(03).               03690053
037000                                                                  03700000
037100         10  MR-DEPT-NBRL               PIC S9(04) COMP.          03710000
037200         10  MR-DEPT-NBRA               PIC  X(01).               03720000
037300         10  MR-DEPT-NBRC               PIC  X(01).               03730000
037400         10  MR-DEPT-NBRH               PIC  X(01).               03740000
037500         10  MR-DEPT-NBR                PIC  X(03).               03750053
037600                                                                  03760000
037700         10  MR-CLASSL                  PIC S9(04) COMP.          03770000
037800         10  MR-CLASSA                  PIC  X(01).               03780000
037900         10  MR-CLASSC                  PIC  X(01).               03790000
038000         10  MR-CLASSH                  PIC  X(01).               03800000
038100         10  MR-CLASS                   PIC  X(03).               03810053
038200                                                                  03820000
038300         10  MR-SKU-NBRL                PIC S9(04) COMP.          03830000
038400         10  MR-SKU-NBRA                PIC  X(01).               03840000
038500         10  MR-SKU-NBRC                PIC  X(01).               03850000
038600         10  MR-SKU-NBRH                PIC  X(01).               03860000
038700         10  MR-SKU-NBR                 PIC  X(08).               03870000
038800                                                                  03880000
038900         10  MR-SKU-DESCL               PIC S9(04) COMP.          03890000
039000         10  MR-SKU-DESCA               PIC  X(01).               03900000
039100         10  MR-SKU-DESCC               PIC  X(01).               03910000
039200         10  MR-SKU-DESCH               PIC  X(01).               03920000
039300         10  MR-SKU-DESC                PIC  X(21).               03930053
039400                                                                  03940000
039500         10  MR-UPC-NBRL                PIC S9(04) COMP.          03950000
039600         10  MR-UPC-NBRA                PIC  X(01).               03960000
039700         10  MR-UPC-NBRC                PIC  X(01).               03970000
039800         10  MR-UPC-NBRH                PIC  X(01).               03980000
039900         10  MR-UPC-NBR                 PIC  X(15).               03990000
040000                                                                  04000000
040100         10  MR-QTYL                    PIC S9(04) COMP.          04010000
040200         10  MR-QTYA                    PIC  X(01).               04020000
040300         10  MR-QTYC                    PIC  X(01).               04030000
040400         10  MR-QTYH                    PIC  X(01).               04040000
040500         10  MR-QTY                     PIC  X(05).               04050000
040600                                                                  04060000
040700*---------------------------------------------------------------* 04070000
040800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04080000
040900*---------------------------------------------------------------* 04090000
041000     COPY DPWS015.                                                04100000
041100                                                                  04110000
041200*---------------------------------------------------------------* 04120000
041300*    FUNCTION KEYS COPYBOOK.                                    * 04130000
041400*---------------------------------------------------------------* 04140000
041500     COPY DPWS016.                                                04150000
041600                                                                  04160000
041700*---------------------------------------------------------------* 04170000
041800*    NUMERIC EDIT LAYOUT.                                       * 04180000
041900*---------------------------------------------------------------* 04190000
042000     COPY DPWS010I.                                               04200000
042100                                                                  04210000
042200*----------------------------------------------------------------*04220000
042300**  SECURITY SUBROUTINE PARAMETERS                                04230000
042400*----------------------------------------------------------------*04240000
042500     COPY DPWS008.                                                04250000
042600                                                                  04260000
042700*---------------------------------------------------------------* 04270000
042800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04280052
042900*---------------------------------------------------------------* 04290000
043000     COPY DPWS030.                                                04300000
043010     COPY DPWS930.                                                04301052
043100                                                                  04310000
043200*---------------------------------------------------------------* 04320000
043300*    STANDARD COMMAREA.                                         * 04330000
043400*---------------------------------------------------------------* 04340000
043500     COPY DPWS020.                                                04350000
043600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04360000
043700                                                                  04370000
043800*---------------------------------------------------------------* 04380000
043900* INTER-APPLICATION COMMAREA.                                   * 04390000
044000*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04400000
044100*             SPEC SCREEN.                                      * 04410000
044200*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04420000
044300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04430000
044400*---------------------------------------------------------------* 04440000
044500                                                                  04450000
044600         10  INTER-APPL-COMM-AREA       PIC X(200).               04460000
044700     COPY SUWS008.                                                04470000
044800     COPY SUWS009.                                                04480000
044900*---------------------------------------------------------------* 04490000
045000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04500000
045100*---------------------------------------------------------------* 04510000
045200         10  ASC-SPECIFIC-COMMAREA.                               04520000
045300             15  ASC-OPER-UNT-ID             PIC  X(04).          04530000
045400             15  ASC-OPER-UNT-ID-N REDEFINES                      04540000
045500                     ASC-OPER-UNT-ID         PIC  9(04).          04550000
045600             15  ASC-OPER-UNT-NAME           PIC  X(24).          04560000
045700             15  ASC-DOOR-ID                 PIC  X(04).          04570000
045800             15  ASC-DOOR-ID-R  REDEFINES ASC-DOOR-ID.            04580000
045900                 20  ASC-DOOR-ID-N           PIC  9(04).          04590000
046000             15  ASC-TRLR-SRL-NMBR           PIC  9(10).          04600005
046100             15  ASC-SCAC-CODE               PIC  X(04).          04610006
046200             15  ASC-DOOR-DESC               PIC  X(11).          04620006
046300             15  ASC-TRLR-ID                 PIC  X(12).          04630006
046400             15  ASC-STR-NBR-X               PIC  X(04).          04640006
046500             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           04650006
046600                 20  ASC-STR-NBR             PIC  9(04).          04660006
046700             15  ASC-STORE-NAME              PIC  X(20).          04670006
046800             15  ASC-OUTBOUND-TRIP-ID        PIC  9(09).          04680006
046900             15  ASC-DOOR-TYP-CDE            PIC  X(02).          04690000
047000             15  ASC-TRLR-SEAL               PIC  X(20).          04700000
047100             15  ASC-DOOR-SLOT-DESC          PIC  X(25).          04710000
047200             15  ASC-DOOR-SLOT               PIC  X(06).          04720000
047300             15  ASC-STATUS-DATE             PIC  X(10).          04730000
047400             15  ASC-STATUS-TIME             PIC  X(05).          04740000
047500             15  ASC-USER-ID                 PIC  X(08).          04750000
047600             15  ASC-SML-NBR                 PIC  9(18).          04760000
047700             15  ASC-CREATE-ID               PIC  X(03).          04770000
047800             15  ASC-PO-RCVR-NBR             PIC  X(13).          04780054
047900             15  ASC-STATUS                  PIC  X(07).          04790000
048000             15  ASC-DEPT-NMBR               PIC S9(04)V COMP-3.  04800000
048100             15  ASC-CLASS-NMBR              PIC S9(04)V COMP-3.  04810000
048200             15  ASC-SKU-NMBR                PIC S9(08)V COMP-3.  04820000
048300             15  ASC-SKU-DESCRIPT            PIC  X(19).          04830000
048400             15  ASC-CRTN-STAT-DESC          PIC  X(19).          04840000
048500             15  ASC-CARTON-STATUS           PIC  X(02).          04850000
048600             15  ASC-TRIP-STATUS             PIC  X(02).          04860000
048700             15  ASC-TRLR-STATUS             PIC  X(10).          04870000
048800             15  ASC-FROM-SMOOTHING-IND      PIC  X(1).           04880042
048900                 88  ASC-FROM-SMOOTHING                VALUE 'Y'. 04890000
048910             15  ASC-STR-SCAN                PIC  X(4).           04891042
048920             15  ASC-STR-SCAN-MULT-SW        PIC  X(1).           04892048
048931                 88  ASC-STR-SCAN-MULT-NO         VALUE 'N'.      04893147
048940                 88  ASC-STR-SCAN-MULT            VALUE 'Y'.      04894047
049000             15  FILLER                      PIC  X(019).         04900054
049100*-----------------------------------------------------------------04910000
049200             15  ASC-BLK-SUB                  PIC S9(04) COMP     04920000
049300                                                         SYNC.    04930000
049400             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04940000
049500                                                         SYNC.    04950000
049600             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04960000
049700             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04970000
049800             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04980000
049900             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04990000
050000             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05000000
050100             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05010000
050200                                                         SYNC.    05020000
050300             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05030000
050400             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05040000
050500             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05050000
050600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05060000
050700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05070000
050800             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05080000
050900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05090000
051000                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05100000
051100             15  ASC-LIST-QUEUE-NAME.                             05110000
051200                 20  ASC-LIST-TERM-ID         PIC  X(04).         05120000
051300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05130000
051400                 20  ASC-LIST-SEQ             PIC  9(01).         05140000
051500                                                                  05150000
051600             15  ASC-START-ITEM-REQUEST.                          05160000
051700                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05170000
051800                                                                  05180000
051900             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05190000
052000             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05200000
052100             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05210000
052200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05220000
052300             15  ASC-SEL-QUEUE-NAME-IN.                           05230000
052400                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05240000
052500                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05250000
052600                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05260000
052700             15  ASC-SEL-QUEUE-NAME-OUT.                          05270000
052800                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         05280000
052900                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  05290000
053000                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         05300000
053100             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05310000
053200                                                                  05320000
053300*-----------------------------------------------------------------05330000
053400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05340000
053500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05350000
053600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05360000
053700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05370000
053800                                                                  05380000
053900                 20  ASC-ITEM-ARRAY.                              05390000
054000                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05400000
054100                         30  ASC-LIST-ITEM-NUMBER                 05410000
054200                                                     PIC S9(09)   05420000
054300                                                     COMP-3.      05430000
054400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05440000
054500                             88  ASC-VALID-SELECT    VALUE ' '    05450000
054600                                                           'S'    05460000
054700                                                           'B'    05470000
054800                                                           'E'.   05480000
054900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05490000
055000                             88  ASC-TEMP-SELECT     VALUE 'S'.   05500000
055100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05510000
055200                             88  ASC-TEMP-END        VALUE 'E'.   05520000
055300                         30  ASC-SELECTED-SW         PIC  X(01).  05530000
055400                             88  ASC-NO-SELECT       VALUE ' '.   05540000
055500                             88  ASC-SELECT          VALUE 'S'.   05550000
055600                             88  ASC-BEGIN           VALUE 'B'.   05560000
055700                             88  ASC-END             VALUE 'E'.   05570000
055800                         30  ASC-ACTION              PIC  X(03).  05580000
055900                         30  ASC-PO-RCVR             PIC  X(13).  05590055
056000                         30  ASC-LINE-NBR            PIC  9(03).  05600056
056100                         30  ASC-DEPT-NBR            PIC  X(03).  05610056
056200                         30  ASC-CLASS               PIC  X(03).  05620056
056300                         30  ASC-SKU-NBR             PIC  9(08).  05630000
056400                         30  ASC-SKU-DESC            PIC  X(21).  05640056
056500                         30  ASC-UPC-NBR             PIC  9(15).  05650000
056600                         30  ASC-QTY                 PIC  9(05).  05660000
056700                                                                  05670000
056800*---------------------------------------------------------------* 05680000
056900*    ABEND PROCESSING COPYBOOK.                                 * 05690000
057000*---------------------------------------------------------------* 05700000
057100     COPY DPWS013.                                                05710000
057200                                                                  05720000
057300                                                                  05730000
057400*---------------------------------------------------------------* 05740000
057500*    TSUOBSC - TRIP STATUS DESCRIPTION TABLE                    * 05750000
057600*---------------------------------------------------------------* 05760000
057700     EXEC SQL                                                     05770000
057800          INCLUDE TSUOBSC                                         05780000
057900     END-EXEC.                                                    05790000
058000                                                                  05800000
058100*---------------------------------------------------------------* 05810000
058200*    TCNTRID - TRAILER ID TABLE                                 * 05820000
058300*---------------------------------------------------------------* 05830000
058400     EXEC SQL                                                     05840000
058500          INCLUDE TCNTRID                                         05850000
058600     END-EXEC.                                                    05860000
058700                                                                  05870000
058710*---------------------------------------------------------------* 05871006
058720*    TCNDRTY - DOOR TYPE DESCRIPTION TABLE                      * 05872000
058730*---------------------------------------------------------------* 05873000
058740     EXEC SQL                                                     05874000
058750          INCLUDE TCNDRTY                                         05875000
058760     END-EXEC.                                                    05876000
058770                                                                  05877000
058780*---------------------------------------------------------------* 05878000
058790*    TSHUUPC                                                      05879000
058800*---------------------------------------------------------------* 05880000
058900     EXEC SQL                                                     05890000
059000          INCLUDE TSHUUPC                                         05900000
059100     END-EXEC.                                                    05910000
059200                                                                  05920000
059300*---------------------------------------------------------------* 05930000
059400*    SUT_OTBND_CART - SHIP UNIT TABLE                             05940000
059500*---------------------------------------------------------------* 05950000
059600     EXEC SQL                                                     05960000
059700          INCLUDE SUT00024                                        05970000
059800     END-EXEC.                                                    05980000
059900                                                                  05990000
060000                                                                  06000000
060100*---------------------------------------------------------------* 06010000
060200*    SUT_OTBND_UPC - SHIP UNIT & UPC TABLE                        06020000
060300*---------------------------------------------------------------* 06030000
060400     EXEC SQL                                                     06040000
060500          INCLUDE SUT00028                                        06050000
060600     END-EXEC.                                                    06060000
060700                                                                  06070000
060800*---------------------------------------------------------------* 06080000
060900*    XLV_SKU VIEW                                                 06090000
061000*---------------------------------------------------------------* 06100000
061100     EXEC SQL                                                     06110000
061200          INCLUDE XLV00000                                        06120000
061300     END-EXEC.                                                    06130000
061400                                                                  06140000
061500*---------------------------------------------------------------* 06150000
061600*    XLV_VND_STYL VIEW                                            06160000
061700*---------------------------------------------------------------* 06170000
061800     EXEC SQL                                                     06180000
061900          INCLUDE XLV00001                                        06190000
062000     END-EXEC.                                                    06200000
062100                                                                  06210000
062200*---------------------------------------------------------------* 06220000
062300*    XLV_UPC VIEW                                                 06230000
062400*---------------------------------------------------------------* 06240000
062500     EXEC SQL                                                     06250000
062600          INCLUDE XLV00003                                        06260000
062700     END-EXEC.                                                    06270000
062800                                                                  06280000
062900*---------------------------------------------------------------* 06290000
063000*    XLT_UPC TABLE                                                06300000
063100*---------------------------------------------------------------* 06310000
063200     EXEC SQL                                                     06320000
063300          INCLUDE XLT00006                                        06330000
063400     END-EXEC.                                                    06340000
063500                                                                  06350000
063600*---------------------------------------------------------------* 06360000
063700*    SUT_OTBND_VND                                                06370000
063800*---------------------------------------------------------------* 06380000
063900     EXEC SQL                                                     06390000
064000          INCLUDE SUT00026                                        06400000
064100     END-EXEC.                                                    06410000
064200                                                                  06420000
064300*---------------------------------------------------------------* 06430000
064400*    TPKSLIP                                                      06440000
064500*---------------------------------------------------------------* 06450000
064600     EXEC SQL                                                     06460000
064700          INCLUDE TPKSLIP                                         06470000
064800     END-EXEC.                                                    06480000
064900                                                                  06490000
064910*---------------------------------------------------------------* 06491042
064920*    SUT_OTBND_STR_SCN                                            06492042
064930*---------------------------------------------------------------* 06493042
064940     EXEC SQL                                                     06494042
064950          INCLUDE SUT00121                                        06495042
064960     END-EXEC.                                                    06496042
064970                                                                  06497042
065000*---------------------------------------------------------------* 06500000
065100                                                                  06510000
065200*---------------------------------------------------------------* 06520000
065300*    CARTON DETAIL CURSOR                                         06530000
065400*    THE 'A',AND 'B' PARTS OF THE CURSOR WILL SELECT AGAINST      06540000
065500*    OUTBOUND TABLES.                                             06550000
065600*    THE 'C' UNION WILL SELECT DATA FROM THE INBOUND TABLES       06560000
065700*    (TSHUUPC) . THIS IS VALID AND OCCURS WHEN THE ASSOCIATE      06570000
065800*    SELECTS THE VENDOR CARTON TO DISPLAY FROM SMOOTHING.         06580000
065900*---------------------------------------------------------------* 06590000
066000     EXEC SQL                                                     06600000
066100          DECLARE CRTN-DETL-CSR CURSOR FOR                        06610000
066200              SELECT 'A'                                          06620000
066300                   ,  A.TRN_NBR                                   06630000
066400                     ,A.RCVR_SEQ_NBR                              06640000
066500                     ,A.TRN_LNE_NBR                               06650000
066600                     ,A.UPC_NBR                                   06660000
066700                     ,A.SHPD_UNT_QTY                              06670000
066800                     ,XVSTYL.DEPT_NBR                             06680000
066900                     ,XVSTYL.SUB_CL_NBR                           06690000
067000                     ,XSKU.SKU_NBR                                06700000
067100                     ,XSKU.SKU_DESC                               06710000
067200                FROM  SUT_OTBND_UPC A                             06720000
067300                     ,XLT_UPC      XUPC                           06730000
067400                     ,XLV_SKU      XSKU                           06740000
067500                     ,XLV_VND_STYL XVSTYL                         06750000
067600               WHERE                                              06760000
067700                      A.UPC_NBR           = XUPC.UPC_NBR          06770000
067800                 AND  XUPC.INTR_UPC_ID    = XSKU.INTR_UPC_ID      06780000
067900                 AND  XSKU.STYL_ID        = XVSTYL.STYL_ID        06790000
068000                                                                  06800000
068100                 AND  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID      06810000
068200                 AND  NOT XSKU.SKU_STAT_CDE IN ('00', '98')       06820000
068300                                                                  06830000
068400             UNION                                                06840000
068500                                                                  06850000
068600              SELECT 'B'                                          06860000
068700                 ,    OTB.TRN_NBR                                 06870000
068800                 ,    OTB.RCVR_SEQ_NBR                            06880000
068900                 ,    OTB.TRN_LNE_NBR                             06890000
069000                 ,    OTB.UPC_NBR                                 06900000
069100                 ,    OTB.SHPD_UNT_QTY                            06910000
069200                 ,    XVSTYL.DEPT_NBR                             06920000
069300                 ,    XVSTYL.SUB_CL_NBR                           06930000
069400                 ,    XSKU.SKU_NBR                                06940000
069500                 ,    XSKU.SKU_DESC                               06950000
069600                FROM                                              06960000
069700                      SUT_OTBND_CART    CART                      06970000
069800                 ,    SUT_OTBND_UPC     OTB                       06980000
069900                 ,    XLT_UPC           XUPC                      06990000
070000                 ,    XLV_SKU           XSKU                      07000000
070100                 ,    XLV_VND_STYL      XVSTYL                    07010000
070200               WHERE                                              07020000
070300                      CART.SHIPT_UNT_ID     = OTB.SHIPT_UNT_ID    07030000
070400                 AND  OTB.UPC_NBR           = XUPC.UPC_NBR        07040000
070500                 AND  XUPC.INTR_UPC_ID      = XSKU.INTR_UPC_ID    07050000
070600                 AND  XSKU.STYL_ID          = XVSTYL.STYL_ID      07060000
070700                                                                  07070000
070800                 AND  CART.ORIG_CART_ID     = :DK-SHIPT-UNT-ID    07080000
070900                 AND  CART.CART_SRC_CDE     IN ('ASN','RCV')      07090000
071000                 AND  NOT XSKU.SKU_STAT_CDE IN ('00', '98')       07100000
071100             UNION                                                07110000
071200              SELECT 'C'                                          07120000
071300                 ,    A.TRN_NBR                                   07130000
071400                 ,    A.RCVR_SEQ_NBR                              07140000
071500                 ,    A.TRN_LNE_NBR                               07150000
071600                 ,    A.UPC_NBR                                   07160000
071700                 ,    A.SHPD_UNT_QTY                              07170000
071800                 ,    0                                           07180000
071900                 ,    0                                           07190000
072000                 ,    0                                           07200000
072100                 ,    ' '                                         07210000
072200             FROM SUT_OTBND_UPC A                                 07220000
072300             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              07230000
072400               AND NOT EXISTS                                     07240000
072500              (SELECT  *                                          07250000
072600                 FROM XLT_UPC B                                   07260000
072700                 WHERE A.UPC_NBR = B.UPC_NBR)                     07270000
072800                                                                  07280000
072900             UNION                                                07290000
073000              SELECT 'D'                                          07300000
073100                 ,    B.TRN_NBR                                   07310000
073200                 ,    B.RCVR_SEQ_NBR                              07320000
073300                 ,    B.TRN_LNE_NBR                               07330000
073400                 ,    B.UPC_NBR                                   07340000
073500                 ,    B.SHPD_UNT_QTY                              07350000
073600                 ,    0                                           07360000
073700                 ,    0                                           07370000
073800                 ,    0                                           07380000
073900                 ,    ' '                                         07390000
074000             FROM SUT_OTBND_CART A                                07400000
074100                , SUT_OTBND_UPC B                                 07410000
074200             WHERE A.ORIG_CART_ID = :DK-SHIPT-UNT-ID              07420000
074300               AND A.SHIPT_UNT_ID <> A.ORIG_CART_ID               07430005
074310               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                07431005
074400               AND NOT EXISTS                                     07440000
074500              (SELECT  *                                          07450000
074600                 FROM XLT_UPC C                                   07460000
074700                 WHERE B.UPC_NBR = C.UPC_NBR)                     07470000
074800                                                                  07480000
074900     END-EXEC.                                                    07490000
075000                                                                  07500000
075100     EXEC SQL                                                     07510000
075200          DECLARE CRTN-DETL-INBD-CSR CURSOR FOR                   07520000
075300                                                                  07530000
075400              SELECT 'C'                                          07540000
075500                   ,  A.TRN_NBR                                   07550000
075600                     ,A.RCVR_SEQ_NBR                              07560000
075700                     ,A.TRN_LNE_NBR                               07570000
075800                     ,A.UPC_NBR                                   07580000
075900                     ,A.SHPD_QTY                                  07590000
076000                     ,XVSTYL.DEPT_NBR                             07600000
076100                     ,XVSTYL.SUB_CL_NBR                           07610000
076200                     ,XSKU.SKU_NBR                                07620000
076300                     ,XSKU.SKU_DESC                               07630000
076400                FROM  TSHUUPC      A                              07640000
076500                     ,XLT_UPC      XUPC                           07650000
076600                     ,XLV_SKU      XSKU                           07660000
076700                     ,XLV_VND_STYL XVSTYL                         07670000
076800               WHERE                                              07680000
076900                      A.UPC_NBR           = XUPC.UPC_NBR          07690000
077000                 AND  XUPC.INTR_UPC_ID    = XSKU.INTR_UPC_ID      07700000
077100                 AND  XSKU.STYL_ID        = XVSTYL.STYL_ID        07710000
077200                                                                  07720000
077300                 AND  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID      07730000
077400                 AND NOT XSKU.SKU_STAT_CDE IN ('00', '98')        07740000
077500             UNION                                                07750000
077600              SELECT 'D'                                          07760000
077700                   ,  A.TRN_NBR                                   07770000
077800                     ,A.RCVR_SEQ_NBR                              07780000
077900                     ,A.TRN_LNE_NBR                               07790000
078000                     ,A.UPC_NBR                                   07800000
078100                     ,A.SHPD_QTY                                  07810000
078200                     ,0                                           07820000
078300                     ,0                                           07830000
078400                     ,0                                           07840000
078500                     ,' '                                         07850000
078600                FROM  TSHUUPC      A                              07860000
078700               WHERE  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID      07870000
078800               AND NOT EXISTS                                     07880000
078900                  (SELECT  *                                      07890000
079000                     FROM XLT_UPC B                               07900000
079100                     WHERE A.UPC_NBR = B.UPC_NBR)                 07910000
079200               ORDER BY  2,3,4,7,8,9                              07920000
079300     END-EXEC.                                                    07930000
079400*---------------------------------------------------------------* 07940000
079500*    DB2 AREA FOR COMMUNICATIONS                                * 07950000
079600*---------------------------------------------------------------* 07960000
079700     EXEC SQL                                                     07970000
079800          INCLUDE SQLCA                                           07980000
079900     END-EXEC.                                                    07990000
080000                                                                  08000000
080100*-----------------------------------------------------------------08010000
080200 LINKAGE SECTION.                                                 08020000
080300                                                                  08030000
080400 01  DFHCOMMAREA.                                                 08040000
080500     05  FILLER                         OCCURS  1 TO 4072 TIMES   08050000
080600                                        DEPENDING ON EIBCALEN.    08060000
080700         10  FILLER                     PIC X.                    08070000
080800                                                                  08080000
080900                                                                  08090000
081000 PROCEDURE DIVISION.                                              08100000
081100******************************************************************08110000
081200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08120000
081300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08130000
081400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08140000
081500******************************************************************08150000
081600 0000-MAIN-MODULE.                                                08160000
081700     INITIALIZE DP030-CICS-API-FIELDS.                            08170000
081800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08180000
081900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08190000
082000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08200000
082100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08210000
082200     MOVE LENGTH OF SU565AI        TO DP030-MAP-LENGTH (1).       08220000
082300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08230000
082400     PERFORM 0001-CALL-CICS-ARCH-API.                             08240000
082500                                                                  08250051
082600     PERFORM 1000-CONTROL-PROCESSING                              08260000
082700                                                                  08270051
082800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08280000
082900     PERFORM 0001-CALL-CICS-ARCH-API.                             08290000
083000                                                                  08300000
083100******************************************************************08310000
083200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08320000
083300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08330000
083400******************************************************************08340000
083500 0001-CALL-CICS-ARCH-API.                                         08350000
083600*    CALL 'DPKCS030' USING DFHEIBLK                               08360052
083610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08361052
083700                           DFHCOMMAREA                            08370000
083800                           DP030-CICS-API-FIELDS                  08380000
083900                           DP020-STANDARD-COMMAREA                08390000
084000                           SU565AI.                               08400000
084100                                                                  08410051
084200     IF  DP030-RC-CALL-SUCCESSFUL                                 08420000
084300         CONTINUE                                                 08430000
084400     ELSE                                                         08440000
084500         SET DP013-NO-ROLLBACK                                    08450000
084600             DP013-XCTL-DISPLAY-RESTART                           08460000
084700             DP013-CICS-ABEND      TO TRUE                        08470000
084800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        08480000
084900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX08490052
085000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      08500052
085010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O08501052
085020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08502052
085100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08510000
085200         PERFORM DP013-0000-PROCESS-ABEND                         08520000
085300     END-IF.                                                      08530000
085400                                                                  08540000
085500*----------------------------------------------------------------*08550000
085600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08560000
085700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08570000
085800*                                                                *08580000
085900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08590000
086000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08600000
086100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08610000
086200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08620000
086300*----------------------------------------------------------------*08630000
086400 1000-CONTROL-PROCESSING.                                         08640000
086500                                                                  08650000
086600     EVALUATE TRUE                                                08660000
086700         WHEN DP020-NEXT-ACT-INITIAL                              08670000
086800             INITIALIZE ASC-SPECIFIC-COMMAREA                     08680000
086900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08690000
087000                                      ASC-SEL-TERM-ID-OUT         08700000
087100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   08710000
087200                                        ASC-SEL-TASK-NUMBER-OUT   08720000
087300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              08730000
087400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             08740000
087500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08750000
087600             PERFORM 4000-BUILD-INITIAL-PANEL                     08760000
087700                                                                  08770000
087800         WHEN DP020-NEXT-ACT-READ-MAP                             08780000
087900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08790000
088000             PERFORM 2000-PROCESS-PANEL                           08800000
088100                                                                  08810000
088200         WHEN DP020-NEXT-ACT-RETURN                               08820000
088300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08830000
088400             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               08840000
088500             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08850000
088600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08860000
088700                                                                  08870000
088800         WHEN OTHER                                               08880000
088900             SET DP013-LOGIC-ABEND TO TRUE                        08890000
089000             SET DP013-NO-ROLLBACK TO TRUE                        08900000
089100             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    08910000
089200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08920000
089300                                   TO DP013-MESSAGE-TEXT(1)       08930000
089400             PERFORM DP013-0000-PROCESS-ABEND                     08940000
089500     END-EVALUATE.                                                08950000
089600                                                                  08960000
089700*----------------------------------------------------------------*08970000
089800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08980000
089900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08990000
090000*----------------------------------------------------------------*09000000
090100 1100-PROCESS-INTER-APPL-COMM.                                    09010000
090200                                                                  09020000
090300     SET PS-COMMAREA-VALID         TO TRUE.                       09030000
090400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09040000
090500                                                                  09050000
090600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          09060000
090700         MOVE SU008-SML-NBR       TO ASC-SML-NBR                  09070000
090800         MOVE SU008-OPER-UNT-ID   TO ASC-OPER-UNT-ID-N            09080000
090900         MOVE SU008-DOOR-ID       TO ASC-DOOR-ID                  09090000
091000         MOVE SU008-TRLR-SRL-NBR  TO ASC-TRLR-SRL-NMBR            09100000
091100         MOVE SU008-SCAC-CDE      TO ASC-SCAC-CODE                09110000
091200         MOVE SU008-DEST-STR-NBR  TO ASC-STR-NBR                  09120000
091300         MOVE SU008-TRIP-ID       TO ASC-OUTBOUND-TRIP-ID         09130000
091400         MOVE SU008-TRLR-SEAL-NBR TO ASC-TRLR-SEAL                09140000
091500         MOVE SU008-CREATE-ID     TO ASC-CREATE-ID                09150000
091600     ELSE                                                         09160000
091700         SET ASC-USE-SELECTION-QUEUE TO TRUE                      09170000
091800         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   09180000
091900                                      ASC-NUMBER-OF-SELECTED-ITEMS09190000
092000         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  09200000
092100         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   09210000
092200         MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID-N       09220000
092300         MOVE SU009-TRLR-SRL-NBR       TO ASC-TRLR-SRL-NMBR       09230000
092400         MOVE SU009-TRIP-ID            TO ASC-OUTBOUND-TRIP-ID    09240000
092500         MOVE SU009-SCAC-CDE           TO ASC-SCAC-CODE           09250000
092600         PERFORM 1120-PREPARE-LIST-ENTRY                          09260000
092700     END-IF.                                                      09270000
092800                                                                  09280000
092900     IF DP020-INT-APPL-FORMAT-IND = 3                             09290000
093000        SET ASC-FROM-SMOOTHING TO TRUE                            09300000
093100     END-IF.                                                      09310000
093200                                                                  09320000
093300*----------------------------------------------------------------*09330000
093400 1101-GET-CARTON-INFO.                                            09340000
093500*----------------------------------------------------------------*09350000
093600     INITIALIZE  PC046-COMMAREA-REC.                              09360000
093700     MOVE ASC-SML-NBR        TO  PC046-CARTON-ID.                 09370000
093800                                                                  09380000
093900                                                                  09390000
094000     CALL PC046-CARTON-STATUS-MODULE                              09400000
094100          USING DFHEIBLK                                          09410000
094200          PC046-COMMAREA                                          09420000
094300          PC046-COMMAREA-REC                                      09430000
094400     END-CALL                                                     09440000
094500                                                                  09450000
094600     PERFORM 1101A-VALIDATE-STATUS-CALL.                          09460000
094700                                                                  09470000
094800*----------------------------------------------------------------*09480000
094900* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*09490000
095000*----------------------------------------------------------------*09500000
095100 1101A-VALIDATE-STATUS-CALL.                                      09510000
095200                                                                  09520000
095300     INITIALIZE   ASC-STR-NBR                                     09530000
095400                  ASC-DOOR-ID                                     09540000
095500                  ASC-SCAC-CODE                                   09550000
095600                  ASC-TRLR-SRL-NMBR                               09560000
095700                  ASC-TRIP-STATUS                                 09570000
095800                  ASC-OUTBOUND-TRIP-ID                            09580000
095900                  ASC-CREATE-ID                                   09590000
096000                  ASC-CARTON-STATUS                               09600000
096100                  ASC-CRTN-STAT-DESC.                             09610000
096200                                                                  09620000
096300     IF  PC046-SUCCESSFUL                                         09630000
096400         MOVE  PC046-DEST-OPER-UNT-ID  TO  ASC-STR-NBR            09640000
096500         MOVE  PC046-DOOR-ID           TO  ASC-DOOR-ID            09650000
096600         MOVE  PC046-DOOR-TYP-CDE      TO  ASC-DOOR-TYP-CDE       09660000
096700         MOVE  PC046-SCAC              TO  ASC-SCAC-CODE          09670000
096800         MOVE  PC046-TRLR-SRL          TO  ASC-TRLR-SRL-NMBR      09680000
096900         MOVE  PC046-TRIP-STATUS       TO  ASC-TRIP-STATUS        09690000
097000         MOVE  PC046-OTBD-TRIP-ID      TO  ASC-OUTBOUND-TRIP-ID   09700000
097100         MOVE  PC046-SHPUNT-SRC-ID     TO  ASC-CREATE-ID          09710000
097200         MOVE  PC046-CRTN-STATUS       TO  ASC-CARTON-STATUS      09720000
097300         MOVE  PC046-CRTN-STAT-DESC    TO  ASC-CRTN-STAT-DESC     09730000
097400         IF PC046-SHPUNT-SRC-ID = 'FXR' OR 'RDM'                  09740000
097500            IF  PC046-TRN-NBR  >  0                               09750000
097600                MOVE PC046-TRN-NBR      TO  ASC-PO-RCVR-NBR       09760000
097700            ELSE                                                  09770000
097712                MOVE 'UNKNOWN    '      TO  ASC-PO-RCVR-NBR       09771216
097720            END-IF                                                09772000
097730         END-IF                                                   09773000
097740     ELSE                                                         09774000
097750         SET  PS-ERROR       TO  TRUE                             09775000
097760         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       09776000
097770     END-IF.                                                      09777000
097780                                                                  09778000
097790*-----------------------------------------------------------------09779000
097800*  PREPARE LIST ENTRY                                             09780000
097900*-----------------------------------------------------------------09790000
098000 1120-PREPARE-LIST-ENTRY.                                         09800000
098100                                                                  09810000
098200     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                09820000
098300     MOVE ZERO                     TO ASC-SEL-ITEM.               09830000
098400     PERFORM 1130-GET-NEXT-RECORD.                                09840000
098500                                                                  09850000
098600*-----------------------------------------------------------------09860000
098700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*09870000
098800*-----------------------------------------------------------------09880000
098900 1130-GET-NEXT-RECORD.                                            09890000
099000     ADD +1                       TO ASC-SEL-SUB.                 09900000
099100                                                                  09910000
099200     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            09920000
099300         ADD +1                   TO ASC-SEL-ITEM                 09930000
099400         MOVE +1                  TO ASC-SEL-SUB                  09940000
099500     END-IF.                                                      09950000
099600                                                                  09960000
099700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09970000
099800         PERFORM 9100-READ-SEL-QUEUE                              09980000
099900         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      09990000
100000             MOVE SU010-SML (ASC-SEL-SUB)       TO ASC-SML-NBR    10000000
100100             MOVE SU010-CREATE (ASC-SEL-SUB)    TO ASC-CREATE-ID  10010000
100200             MOVE SU010-DEST-NBR  (ASC-SEL-SUB) TO ASC-STR-NBR    10020000
100300             IF  SU010-PO-RCVR (ASC-SEL-SUB)  >  SPACES  AND      10030000
100400                 SU010-PO-RCVR (ASC-SEL-SUB)  >  ZEROES           10040000
100500               MOVE SU010-PO-RCVR (ASC-SEL-SUB) TO ASC-PO-RCVR-NBR10050000
100600             ELSE                                                 10060000
100700               MOVE 'UNKNOWN    '      TO  ASC-PO-RCVR-NBR        10070000
100800             END-IF                                               10080000
100900             MOVE SU010-LOAD-STATUS (ASC-SEL-SUB) TO ASC-STATUS   10090000
101000             MOVE SU010-STAT-DATE (ASC-SEL-SUB) TO ASC-STATUS-DATE10100000
101100             MOVE SU010-STAT-TIME (ASC-SEL-SUB) TO ASC-STATUS-TIME10110000
101200             IF  ASC-TRLR-SRL-NMBR = ZERO                         10120000
101300                 MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)            10130000
101400                                              TO ASC-TRLR-SRL-NMBR10140000
101500             END-IF                                               10150000
101600             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  10160000
101700             PERFORM 9200-REWRITE-SEL-QUEUE                       10170000
101800         ELSE                                                     10180000
101900             SUBTRACT +1 FROM ASC-SEL-SUB                         10190000
102000             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10200000
102100             SET DP020-MSG-INFORMATIONAL                          10210000
102200                 PS-LIST-END             TO TRUE                  10220000
102300         END-IF                                                   10230000
102400     ELSE                                                         10240000
102500         SUBTRACT +1 FROM ASC-SEL-ITEM                            10250000
102600         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  10260000
102700         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             10270000
102800         SET DP020-MSG-INFORMATIONAL                              10280000
102900             PS-LIST-END             TO TRUE                      10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200*----------------------------------------------------------------*10320000
103300*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *10330000
103400*    PROCESSED.                                                  *10340000
103500*----------------------------------------------------------------*10350000
103600 1140-GET-PREV-RECORD.                                            10360000
103700     SUBTRACT +1 FROM ASC-SEL-SUB.                                10370000
103800                                                                  10380000
103900     IF  ASC-SEL-SUB < +1                                         10390000
104000         SUBTRACT +1 FROM ASC-SEL-ITEM                            10400000
104100         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  10410000
104200     END-IF.                                                      10420000
104300                                                                  10430000
104400     IF  ASC-SEL-ITEM > ZERO                                      10440000
104500         PERFORM 9100-READ-SEL-QUEUE                              10450000
104600         MOVE SU010-SML (ASC-SEL-SUB)        TO ASC-SML-NBR       10460000
104700         MOVE SU010-CREATE (ASC-SEL-SUB)     TO ASC-CREATE-ID     10470000
104800         MOVE SU010-DEST-NBR  (ASC-SEL-SUB)  TO ASC-STR-NBR       10480000
104900         IF  SU010-PO-RCVR (ASC-SEL-SUB)  >  SPACES  AND          10490000
105000             SU010-PO-RCVR (ASC-SEL-SUB)  >  ZEROES               10500000
105100            MOVE SU010-PO-RCVR (ASC-SEL-SUB) TO ASC-PO-RCVR-NBR   10510000
105110         ELSE                                                     10511000
105111            MOVE 'UNKNOWN    '      TO  ASC-PO-RCVR-NBR           10511100
105112         END-IF                                                   10511200
105113         MOVE SU010-LOAD-STATUS (ASC-SEL-SUB) TO ASC-STATUS       10511300
105114         MOVE SU010-STAT-DATE (ASC-SEL-SUB)  TO ASC-STATUS-DATE   10511400
105115         MOVE SU010-STAT-TIME (ASC-SEL-SUB)  TO ASC-STATUS-TIME   10511500
105116         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      10511600
105117         PERFORM 9200-REWRITE-SEL-QUEUE                           10511700
105118     ELSE                                                         10511800
105119         MOVE +1                  TO ASC-SEL-ITEM                 10511900
105120                                     ASC-SEL-SUB                  10512000
105130         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             10513000
105140         SET DP020-MSG-INFORMATIONAL                              10514000
105150             PS-LIST-END             TO TRUE                      10515000
105160     END-IF.                                                      10516000
105170                                                                  10517000
105180*----------------------------------------------------------------*10518000
105190* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10519000
105200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10520000
105300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10530000
105400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10540000
105500* FUNCTION KEYS CAN GET THIS FAR.                                *10550000
105600*----------------------------------------------------------------*10560000
105700 2000-PROCESS-PANEL.                                              10570000
105800     EVALUATE TRUE                                                10580000
105900         WHEN DP020-SRC-AID = DP016-CLEAR                         10590000
106000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10600000
106100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10610000
106200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10620000
106300                                                                  10630000
106400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10640000
106500             PERFORM 2050-DELETE-LIST-QUEUE                       10650000
106600             PERFORM 4000-BUILD-INITIAL-PANEL                     10660000
106700                                                                  10670000
106800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10680000
106900             IF  ASC-USE-SELECTION-QUEUE                          10690000
107000                 PERFORM 1130-GET-NEXT-RECORD                     10700000
107100                 IF PS-LIST-END                                   10710000
107200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10720000
107300                     SET PS-NO-LIST-END TO TRUE                   10730000
107400                 ELSE                                             10740000
107500                     PERFORM 2050-DELETE-LIST-QUEUE               10750000
107600                     PERFORM 3200-RESET-ATTRIBUTES                10760000
107700                     PERFORM 4000-BUILD-INITIAL-PANEL             10770000
107800                 END-IF                                           10780000
107900              ELSE                                                10790000
108000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10800000
108100*                --- BOTTOM OF LIST ---                           10810000
108200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         10820000
108300                 SET DP020-MSG-INFORMATIONAL TO TRUE              10830000
108400             END-IF                                               10840000
108500                                                                  10850000
108600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10860000
108700             IF  ASC-USE-SELECTION-QUEUE                          10870000
108800                 PERFORM 1140-GET-PREV-RECORD                     10880000
108900                 IF PS-LIST-END                                   10890000
109000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10900000
109100                     SET PS-NO-LIST-END TO TRUE                   10910000
109200                 ELSE                                             10920000
109300                     PERFORM 2050-DELETE-LIST-QUEUE               10930000
109400                     PERFORM 3200-RESET-ATTRIBUTES                10940000
109500                     PERFORM 4000-BUILD-INITIAL-PANEL             10950000
109600                 END-IF                                           10960000
109700             ELSE                                                 10970000
109800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10980000
109900                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         10990000
110000                 SET DP020-MSG-INFORMATIONAL TO TRUE              11000000
110100             END-IF                                               11010000
110200                                                                  11020000
110300         WHEN OTHER                                               11030000
110400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11040000
110500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11050000
110600                                                                  11060000
110700             IF  PS-NO-ERROR                                      11070000
110800                 SET DP030-CONTINUE-GO TO TRUE                    11080000
110900                 PERFORM 2100-CHECK-FUNCTION-KEY                  11090000
111000             ELSE                                                 11100000
111100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11110000
111200                 SET DP030-OVERRIDE-GO TO TRUE                    11120000
111300             END-IF                                               11130000
111400     END-EVALUATE.                                                11140000
111500                                                                  11150000
111600*----------------------------------------------------------------*11160000
111700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11170000
111800*----------------------------------------------------------------*11180000
111900 2050-DELETE-LIST-QUEUE.                                          11190000
112000                                                                  11200000
112100     EXEC CICS                                                    11210000
112200         DELETEQ TS                                               11220000
112300             QUEUE (ASC-LIST-QUEUE-NAME)                          11230000
112400             RESP  (PV-CICS-RESP)                                 11240000
112500     END-EXEC.                                                    11250000
112600                                                                  11260000
112700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11270000
112800        (PV-CICS-RESP = DFHRESP(QIDERR))                          11280000
112900         CONTINUE                                                 11290000
113000     ELSE                                                         11300000
113100         SET DP013-CICS-ABEND      TO TRUE                        11310000
113200         SET DP013-NO-ROLLBACK     TO TRUE                        11320000
113300                                                                  11330000
113400         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         11340000
113500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11350000
113600                                   TO DP013-MESSAGE-TEXT (1)      11360000
113700         PERFORM DP013-0000-PROCESS-ABEND                         11370000
113800     END-IF.                                                      11380000
113900                                                                  11390000
114000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11400000
114100                                                                  11410000
114200*----------------------------------------------------------------*11420000
114300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11430000
114400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11440000
114500* CICS ARCHITECTURE API.                                         *11450000
114600*----------------------------------------------------------------*11460000
114700 2100-CHECK-FUNCTION-KEY.                                         11470000
114800                                                                  11480000
114900     EVALUATE TRUE                                                11490000
115000                                                                  11500051
115100* F6 - FIRST PAGE                                                 11510000
115200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11520000
115300             MOVE +1               TO PV-TOP-ITEM                 11530000
115400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11540000
115500                                                                  11550051
115600* F7 - PREVIOUS PAGE                                              11560000
115700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11570000
115800             PERFORM 2110-BROWSE-BACKWARD                         11580000
115900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11590000
116000                                                                  11600051
116100* F8 - NEXT PAGE                                                  11610000
116200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11620000
116300             PERFORM 2120-BROWSE-FORWARD                          11630000
116400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11640000
116500                                                                  11650051
116600* ENTER KEY                                                       11660000
116700         WHEN DP020-SRC-AID = DP016-ENTER                         11670000
116800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11680000
116900             IF  PS-ERROR                                         11690000
117000                 CONTINUE                                         11700000
117100             ELSE                                                 11710000
117200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11720000
117300             END-IF                                               11730000
117400                                                                  11740051
117500* F18 - SML CRTN PACKED DETAIL                                    11750000
117600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11760000
117700             INITIALIZE SU008-INTER-APPL-COMMAREA                 11770000
117800             MOVE ASC-SML-NBR   TO SU008-SML-NBR                  11780000
117900                                                                  11790051
118000* F23 - TRAILER HISTORY SCREEN                                    11800000
118100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11810000
118200             IF ASC-OUTBOUND-TRIP-ID > 0                          11820004
118300                 MOVE DP020-LOCATION-NBR   TO SU008-OPER-UNT-ID   11830003
118310                 MOVE ASC-OUTBOUND-TRIP-ID TO SU008-TRIP-ID       11831003
118400                 MOVE ASC-TRLR-SRL-NMBR    TO SU008-TRLR-SRL-NBR  11840003
118500                 MOVE ASC-SCAC-CODE        TO SU008-SCAC-CDE      11850003
118600                 MOVE ASC-TRLR-ID          TO SU008-TRLR-ID       11860003
118700             ELSE                                                 11870004
118800                 SET DP030-OVERRIDE-GO TO TRUE                    11880004
118900                 MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER         11890004
119000                 SET DP020-MSG-WARNING TO TRUE                    11900004
119100             END-IF                                               11910004
119200                                                                  11920051
119300* F24 - MANIFEST REPORT                                           11930000
119400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11940000
119500             MOVE ASC-SML-NBR         TO SU008-SML-NBR            11950000
119600             MOVE DP020-LOCATION-NBR  TO SU008-OPER-UNT-ID        11960000
119610                                                                  11961051
119620         WHEN OTHER                                               11962000
119630             SET DP013-NO-ROLLBACK                                11963000
119640                 DP013-XCTL-DISPLAY-RESTART                       11964000
119650                 DP013-CICS-ABEND  TO TRUE                        11965000
119660             MOVE '2100-CHECK-FUNCTION-KEY'                       11966000
119670                                   TO DP013-PARAGRAPH             11967000
119680             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11968000
119690                                   TO DP013-MESSAGE-TEXT (1)      11969000
119700             PERFORM DP013-0000-PROCESS-ABEND                     11970000
119800     END-EVALUATE.                                                11980000
119900                                                                  11990051
120000*----------------------------------------------------------------*12000000
120100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12010000
120200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12020000
120300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12030000
120400*    MESSAGE.                                                    *12040000
120500*----------------------------------------------------------------*12050000
120600 2110-BROWSE-BACKWARD.                                            12060000
120700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12070000
120800         GIVING PV-TOP-ITEM.                                      12080000
120900                                                                  12090051
121000     IF  ((PV-TOP-ITEM < +1)                                      12100000
121100       OR (PV-TOP-ITEM = +1))                                     12110000
121200         MOVE +1                   TO PV-TOP-ITEM                 12120000
121300*        -- TOP OF LIST --                                        12130000
121400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12140000
121500         SET DP020-MSG-INFORMATIONAL TO TRUE                      12150000
121600     END-IF.                                                      12160000
121700                                                                  12170000
121800*----------------------------------------------------------------*12180000
121900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12190000
122000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12200000
122100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12210000
122200*----------------------------------------------------------------*12220000
122300 2120-BROWSE-FORWARD.                                             12230000
122400                                                                  12240000
122500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12250000
122600         GIVING PV-TOP-ITEM.                                      12260000
122700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12270000
122800         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12280000
122900*        -- BOTTOM OF LIST --                                     12290000
123000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12300000
123100         SET DP020-MSG-INFORMATIONAL  TO TRUE                     12310000
123200     ELSE                                                         12320000
123300         COMPUTE PV-BOTTOM-ITEM =                                 12330000
123400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12340000
123500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12350000
123600*            -- BOTTOM OF LIST --                                 12360000
123700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12370000
123800             SET DP020-MSG-INFORMATIONAL TO TRUE                  12380000
123900         END-IF                                                   12390000
124000     END-IF.                                                      12400000
124100                                                                  12410000
124200*----------------------------------------------------------------*12420000
124300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12430000
124400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12440000
124500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12450000
124600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12460000
124700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12470000
124800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12480000
124900*----------------------------------------------------------------*12490000
125000 2130-CHECK-FOR-JUMP-BROWSE.                                      12500000
125100     SET PS-NO-ERROR               TO TRUE.                       12510000
125200     IF (ASC-START-ITEM-REQUEST = SPACE)                          12520000
125300         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12530000
125400     ELSE                                                         12540000
125500         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     12550000
125600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12560000
125700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12570000
125800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12580000
125900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12590051
125910              USING DP010I-NUMERIC-EDIT-AREA                      12591051
126000                                                                  12600000
126100         IF  NOT DP010I-ERROR-DETECTED                            12610000
126200             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N12620000
126300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12630000
126400                 IF  ASC-START-ITEM-REQUEST-N >                   12640000
126500                                          ASC-NUMBER-OF-ITEMS-READ12650000
126600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12660000
126700                     COMPUTE PV-TOP-ITEM =                        12670000
126800                             ASC-NUMBER-OF-ITEMS-READ             12680000
126900                             - PC-ITEMS-PER-PANEL + 1             12690000
127000                     IF  PV-TOP-ITEM < +1                         12700000
127100                         MOVE +1   TO PV-TOP-ITEM                 12710000
127200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12720000
127300                         SET DP020-MSG-INFORMATIONAL TO TRUE      12730000
127400                     END-IF                                       12740000
127500                 ELSE                                             12750000
127600                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 12760000
127700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12770000
127800                     COMPUTE PV-BOTTOM-ITEM =                     12780000
127900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12790000
128000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12800000
128100*                        -- BOTTOM OF LIST --                     12810000
128200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12820000
128300                         SET DP020-MSG-INFORMATIONAL TO TRUE      12830000
128400                     END-IF                                       12840000
128500                 END-IF                                           12850000
128600             ELSE                                                 12860000
128700*                --- VALUE OUT OF RANGE ----                      12870000
128800                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        12880000
128900                 MOVE -1           TO ASTRTITL                    12890000
129000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12900000
129100                 MOVE DP015-REVERSE TO ASTRTITH                   12910000
129200                 MOVE DP015-RED    TO ASTRTITC                    12920000
129300                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           12930000
129400                 SET DP020-MSG-FATAL                              12940000
129500                     PS-ERROR        TO TRUE                      12950000
129600             END-IF                                               12960000
129700         ELSE                                                     12970000
129800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12980000
129900             MOVE -1               TO ASTRTITL                    12990000
130000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13000000
130100             MOVE DP015-REVERSE    TO ASTRTITH                    13010000
130200             MOVE DP015-RED        TO ASTRTITC                    13020000
130300             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               13030000
130400             SET DP020-MSG-FATAL   TO TRUE                        13040000
130500             SET PS-ERROR          TO TRUE                        13050000
130600         END-IF                                                   13060000
130700     END-IF.                                                      13070000
130800                                                                  13080000
130900******************************************************************13090000
131000** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13100000
131100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13110000
131200******************************************************************13120000
131300 2200-MOVE-SCREEN-TO-COMMAREA.                                    13130000
131400                                                                  13140000
131500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13150000
131600     MOVE +1                       TO PV-SUB.                     13160000
131700                                                                  13170051
131800     PERFORM 3100-SET-SUBSCRIPTS.                                 13180000
131900     IF  ASTRTITL > ZERO                                          13190000
132000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13200000
132100     ELSE                                                         13210000
132200         IF  ASTRTITF = DP015-ERASE-EOF                           13220000
132300             INITIALIZE ASC-START-ITEM-REQUEST                    13230000
132400         END-IF                                                   13240000
132500     END-IF.                                                      13250000
132600                                                                  13260000
132700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13270000
132800         VARYING PV-SUB                                           13280000
132900         FROM 1 BY 1                                              13290000
133000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13300000
133100******************************************************************13310000
133200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13320000
133300******************************************************************13330000
133400 2210-MOVE-LINES-TO-COMMAREA.                                     13340000
133500     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE                 13350000
133600     MOVE SPACE        TO ASC-TEMP-SELECTED-SW                    13360000
133700                          (ASC-BLK-SUB, ASC-ITEM-SUB)             13370000
133800                                                                  13380000
133900     ADD +1                        TO ASC-ITEM-SUB.               13390000
134000                                                                  13400000
134100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13410000
134200         ADD +1                    TO ASC-BLK-SUB                 13420000
134300         MOVE +1                   TO ASC-ITEM-SUB                13430000
134400     END-IF.                                                      13440000
134500******************************************************************13450000
134600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13460000
134700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13470000
134800******************************************************************13480000
134900 3000-EDIT-DATA-IN-COMMAREA.                                      13490000
135000     SET PS-NO-ERROR               TO TRUE.                       13500000
135100     PERFORM 3200-RESET-ATTRIBUTES.                               13510000
135200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13520000
135300                                                                  13530000
135400                                                                  13540051
135500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13550000
135600* EDITTING IS DONE FROM THE BOTTOM UP.                            13560000
135700                                                                  13570051
135800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13580000
135900         ASC-ITEMS-DISPLAYED - 1.                                 13590000
136000     PERFORM 3100-SET-SUBSCRIPTS.                                 13600000
136100                                                                  13610051
136200     IF  PS-NO-ERROR                                              13620000
136300         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        13630000
136400     END-IF.                                                      13640000
136500                                                                  13650000
136600     IF  PS-NO-ERROR                                              13660000
136700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13670000
136800     END-IF.                                                      13680000
136900                                                                  13690051
137000     IF  ((PS-NO-ERROR)                                           13700000
137100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   13710000
137200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    13720000
137300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  13730000
137400     END-IF.                                                      13740000
137500                                                                  13750000
137600*----------------------------------------------------------------*13760000
137700*   3005-EDIT-COMMAREA-BLOCKS                                    *13770000
137800*----------------------------------------------------------------*13780000
137900 3005-EDIT-COMMAREA-BLOCKS.                                       13790000
138000     MOVE +1                       TO PV-BLOCK-NUMBER.            13800000
138100     MOVE +1                       TO ASC-BLK-SUB.                13810000
138200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               13820000
138300                                                                  13830000
138400     COMPUTE PV-BLOCK-NUMBER  =                                   13840000
138500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 13850000
138600            PC-ITEMS-PER-PANEL.                                   13860000
138700                                                                  13870000
138800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          13880000
138900                                                                  13890000
139000     PERFORM                                                      13900000
139100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          13910000
139200          OR PS-ERROR                                             13920000
139300          OR PS-BLOCK-ERROR                                       13930000
139400                                                                  13940000
139500             COMPUTE PV-ITEMS-HOLD  =                             13950000
139600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        13960000
139700                     PC-ITEMS-PER-PANEL - 1                       13970000
139800                                                                  13980000
139900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       13990000
140000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               14000000
140100                     FROM  PV-ITEMS-HOLD                          14010000
140200                   GIVING  PV-ITEMS-DIFF                          14020000
140300                 SUBTRACT  PV-ITEMS-DIFF                          14030000
140400                     FROM  PC-ITEMS-PER-PANEL                     14040000
140500                   GIVING  PV-ITEMS-HOLD                          14050000
140600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              14060000
140700                                              ASC-ITEM-SUB        14070000
140800                                              ASC-ITEMS-DISPLAYED 14080000
140900             ELSE                                                 14090000
141000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              14100000
141100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        14110000
141200             END-IF                                               14120000
141300                                                                  14130000
141400             PERFORM 3300-EDIT-SELECTIONS                         14140000
141500                     VARYING PV-SUB                               14150000
141600                        FROM PV-SUB BY -1                         14160000
141700                       UNTIL PV-SUB < +1                          14170000
141800                                                                  14180000
141900             MOVE +1               TO ASC-BLK-SUB                 14190000
142000                                                                  14200000
142100             PERFORM 5105-REWRITE-ASC-LISTQ                       14210000
142200                                                                  14220000
142300             MOVE +1                TO ASC-BLK-SUB                14230000
142400                                                                  14240000
142500             IF  PS-BLOCK-ERROR                                   14250000
142600                 SET  PS-ERROR     TO TRUE                        14260000
142700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        14270000
142800                                   TO PV-TOP-ITEM                 14280000
142900             ELSE                                                 14290000
143000                 ADD  +1           TO PV-BLOCK-NUMBER             14300000
143100                 IF  PV-BLOCK-NUMBER >                            14310000
143200                     ASC-HIGHEST-BLOCK-WRITTEN                    14320000
143300                     MOVE +2       TO ASC-BLK-SUB                 14330000
143400                     PERFORM 4410-READ-TEMP-STORAGE               14340000
143500                     MOVE +1       TO ASC-BLK-SUB                 14350000
143600                 ELSE                                             14360000
143700                     PERFORM 4410-READ-TEMP-STORAGE               14370000
143800                     ADD  +1        TO PV-BLOCK-NUMBER            14380000
143900                     MOVE +2        TO ASC-BLK-SUB                14390000
144000                     PERFORM 4410-READ-TEMP-STORAGE               14400000
144100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            14410000
144200                     MOVE +1        TO ASC-BLK-SUB                14420000
144300                 END-IF                                           14430000
144400             END-IF                                               14440000
144500     END-PERFORM.                                                 14450000
144600                                                                  14460000
144700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            14470000
144800         PS-ERROR                   OR                            14480000
144900         PS-BLOCK-ERROR                                           14490000
145000         CONTINUE                                                 14500000
145100     ELSE                                                         14510000
145200         MOVE +1                 TO PV-BLOCK-NUMBER               14520000
145300         MOVE +1                 TO ASC-BLK-SUB                   14530000
145400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  14540000
145500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           14550000
145600         PERFORM 4410-READ-TEMP-STORAGE                           14560000
145700                                                                  14570000
145800         PERFORM                                                  14580000
145900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              14590000
146000              OR PS-ERROR                                         14600000
146100              OR PS-BLOCK-ERROR                                   14610000
146200                                                                  14620000
146300                 COMPUTE PV-ITEMS-HOLD  =                         14630000
146400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    14640000
146500                         PC-ITEMS-PER-PANEL - 1                   14650000
146600                                                                  14660000
146700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     14670000
146800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           14680000
146900                         FROM  PV-ITEMS-HOLD                      14690000
147000                       GIVING  PV-ITEMS-DIFF                      14700000
147100                     SUBTRACT  PV-ITEMS-DIFF                      14710000
147200                         FROM  PC-ITEMS-PER-PANEL                 14720000
147300                       GIVING  PV-ITEMS-HOLD                      14730000
147400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            14740000
147500                                                ASC-ITEM-SUB      14750000
147600                                               ASC-ITEMS-DISPLAYED14760000
147700                 ELSE                                             14770000
147800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          14780000
147900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    14790000
148000                 END-IF                                           14800000
148100                                                                  14810000
148200                 PERFORM 3300-EDIT-SELECTIONS                     14820000
148300                         VARYING PV-SUB                           14830000
148400                            FROM PV-SUB BY -1                     14840000
148500                           UNTIL PV-SUB < +1                      14850000
148600                                                                  14860000
148700                 MOVE +1               TO ASC-BLK-SUB             14870000
148800                                                                  14880000
148900                 PERFORM 5105-REWRITE-ASC-LISTQ                   14890000
149000                                                                  14900000
149100                 MOVE +1                TO ASC-BLK-SUB            14910000
149200                                                                  14920000
149300                 IF  PS-BLOCK-ERROR                               14930000
149400                     SET  PS-ERROR     TO TRUE                    14940000
149500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    14950000
149600                                       TO PV-TOP-ITEM             14960000
149700                 ELSE                                             14970000
149800                     ADD  +1            TO PV-BLOCK-NUMBER        14980000
149900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      14990000
150000                         MOVE +2        TO ASC-BLK-SUB            15000000
150100                         PERFORM 4410-READ-TEMP-STORAGE           15010000
150200                         MOVE +1        TO ASC-BLK-SUB            15020000
150300                     ELSE                                         15030000
150400                         PERFORM 4410-READ-TEMP-STORAGE           15040000
150500                         ADD  +1        TO PV-BLOCK-NUMBER        15050000
150600                         MOVE +2        TO ASC-BLK-SUB            15060000
150700                         PERFORM 4410-READ-TEMP-STORAGE           15070000
150800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        15080000
150900                         MOVE +1        TO ASC-BLK-SUB            15090000
151000                     END-IF                                       15100000
151100                 END-IF                                           15110000
151200     END-PERFORM.                                                 15120000
151300                                                                  15130000
151400*----------------------------------------------------------------*15140000
151500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15150000
151600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15160000
151700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15170000
151800*                                                                *15180000
151900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15190000
152000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15200000
152100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15210000
152200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15220000
152300*----------------------------------------------------------------*15230000
152400 3100-SET-SUBSCRIPTS.                                             15240000
152500                                                                  15250000
152600     COMPUTE ASC-ITEM-SUB =                                       15260000
152700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15270000
152800                                                                  15280000
152900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15290000
153000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15300000
153100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15310000
153200     ELSE                                                         15320000
153300         MOVE +1                     TO ASC-BLK-SUB               15330000
153400     END-IF.                                                      15340000
153500******************************************************************15350000
153600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15360000
153700******************************************************************15370000
153800 3200-RESET-ATTRIBUTES.                                           15380000
153900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15390000
154000     MOVE DP015-GREEN              TO ASTRTITC.                   15400000
154100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15410000
154200                                                                  15420000
154300******************************************************************15430000
154400** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **15440000
154500** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **15450000
154600** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **15460000
154700** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **15470000
154800******************************************************************15480000
154900 3300-EDIT-SELECTIONS.                                            15490000
155000     EVALUATE TRUE                                                15500000
155100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15510000
155200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         15520000
155300                 CONTINUE                                         15530000
155400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         15540000
155500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15550000
155600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   15560000
155700                 MOVE ASC-TEMP-SELECTED-SW                        15570000
155800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15580000
155900                                TO ASC-SELECTED-SW                15590000
156000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15600000
156100             END-IF                                               15610000
156200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15620000
156300                 = SPACE                                          15630000
156400             EVALUATE TRUE                                        15640000
156500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       15650000
156600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS15660000
156700                     MOVE SPACE TO ASC-SELECTED-SW                15670000
156800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15680000
156900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        15690000
157000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    15700000
157100                     MOVE SPACE TO ASC-SELECTED-SW                15710000
157200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15720000
157300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          15730000
157400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      15740000
157500                     MOVE SPACE TO ASC-SELECTED-SW                15750000
157600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15760000
157700             END-EVALUATE                                         15770000
157800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           15780000
157900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15790000
158000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15800000
158100             END-IF                                               15810000
158200             PERFORM 3310-EDIT-RANGE                              15820000
158300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             15830000
158400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15840000
158500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15850000
158600             END-IF                                               15860000
158700             PERFORM 3310-EDIT-RANGE                              15870000
158800         WHEN OTHER                                               15880000
158900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           15890000
159000             SET DP020-MSG-FATAL    TO TRUE                       15900000
159100             MOVE -1                TO ASTRTITL                   15910000
159200             SET DP030-SET-CURSOR-APPL-1                          15920000
159300                                    TO TRUE                       15930000
159400             SET PS-ERROR TO TRUE                                 15940000
159500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15950000
159600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15960000
159700                 MOVE SPACE         TO ASC-SELECTED-SW            15970000
159800                                        (ASC-BLK-SUB ASC-ITEM-SUB)15980000
159900             END-IF                                               15990000
160000     END-EVALUATE.                                                16000000
160100                                                                  16010000
160200     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 16020000
160300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16030000
160400     IF  ASC-ITEM-SUB < 1                                         16040000
160500         SUBTRACT +1 FROM ASC-BLK-SUB                             16050000
160600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                16060000
160700     END-IF.                                                      16070000
160800                                                                  16080000
160900******************************************************************16090000
161000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16100000
161100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16110000
161200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16120000
161300** THE ENDING.                                                  **16130000
161400******************************************************************16140000
161500 3310-EDIT-RANGE.                                                 16150000
161600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16160000
161700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16170000
161800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16180000
161900                                   TO ASC-SELECTED-SW             16190000
162000                                        (ASC-BLK-SUB ASC-ITEM-SUB)16200000
162100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16210000
162200         ELSE                                                     16220000
162300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16230000
162400                 CONTINUE                                         16240000
162500             ELSE                                                 16250000
162600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16260000
162700                 MOVE PC-TSYMSG-00054                             16270000
162800                                       TO DP020-MSG-NUMBER        16280000
162900                 MOVE -1               TO ASTRTITL                16290000
163000                 SET DP020-MSG-FATAL                              16300000
163100                     DP030-SET-CURSOR-APPL-1                      16310000
163200                     PS-ERROR          TO TRUE                    16320000
163300             END-IF                                               16330000
163400         END-IF                                                   16340000
163500     ELSE                                                         16350000
163600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16360000
163700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16370000
163800                                   TO ASC-SELECTED-SW             16380000
163900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16390000
164000             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16400000
164100         ELSE                                                     16410000
164200             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16420000
164300                 CONTINUE                                         16430000
164400             ELSE                                                 16440000
164500*                -- ONLY ONE END-OF-RANGE ALLOWED --              16450000
164600                 MOVE PC-TSYMSG-00055                             16460000
164700                                        TO DP020-MSG-NUMBER       16470000
164800                 MOVE -1                TO ASTRTITL               16480000
164900                 SET DP020-MSG-FATAL                              16490000
165000                     DP030-SET-CURSOR-APPL-1                      16500000
165100                     PS-ERROR           TO TRUE                   16510000
165200             END-IF                                               16520000
165300         END-IF                                                   16530000
165400     END-IF.                                                      16540000
165500*                                                                 16550000
165600******************************************************************16560000
165700** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **16570000
165800** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **16580000
165900******************************************************************16590000
166000 3400-CHECK-RANGE-SEQUENCE.                                       16600000
166100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       16610000
166200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      16620000
166300       AND  ASC-START-OF-SELECTED-RANGE >                         16630000
166400                                         ASC-END-OF-SELECTED-RANGE16640000
166500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                16650000
166600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 16660000
166700         SET DP020-MSG-FATAL TO TRUE                              16670000
166800         SET PS-ERROR TO TRUE                                     16680000
166900         PERFORM 3410-POSITION-AT-ERROR                           16690000
167000     END-IF.                                                      16700000
167100******************************************************************16710000
167200** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **16720000
167300** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **16730000
167400** SHOULD BE POSITIONED ON A RANGE ERROR.                       **16740000
167500******************************************************************16750000
167600 3410-POSITION-AT-ERROR.                                          16760000
167700     SET DP030-SET-CURSOR-APPL-1                                  16770000
167800                                   TO TRUE.                       16780000
167900     MOVE -1                       TO ASTRTITL                    16790000
168000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 16800000
168100                    - PV-TOP-ITEM + 1.                            16810000
168200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16820000
168300         CONTINUE                                                 16830000
168400     END-IF.                                                      16840000
168500                                                                  16850051
168600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   16860000
168700                    - PV-TOP-ITEM + 1.                            16870000
168800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16880000
168900         CONTINUE                                                 16890000
169000     END-IF.                                                      16900000
169100                                                                  16910000
169200*----------------------------------------------------------------*16920000
169300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *16930000
169400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *16940000
169500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *16950000
169600*----------------------------------------------------------------*16960000
169700 3500-MARK-RANGE-AS-SELECTED.                                     16970000
169800     MOVE +1                       TO  ASC-BLK-SUB.               16980000
169900     PERFORM 3510-MARK-SELECTED-INDS                              16990000
170000         VARYING ASC-ITEM-SUB                                     17000000
170100         FROM 1 BY 1                                              17010000
170200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17020000
170300                                                                  17030000
170400     ADD +1                        TO ASC-BLK-SUB.                17040000
170500     PERFORM 3510-MARK-SELECTED-INDS                              17050000
170600         VARYING ASC-ITEM-SUB                                     17060000
170700         FROM 1 BY 1                                              17070000
170800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17080000
170900                                                                  17090000
171000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17100000
171100                                   TO  PV-LIST-ITEM-NUMBER.       17110000
171200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17120000
171300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17130000
171400               PC-ITEMS-PER-PANEL).                               17140000
171500                                                                  17150000
171600     MOVE ASC-START-OF-SELECTED-RANGE                             17160000
171700                                   TO PV-START-OF-SELECTED-RANGE. 17170000
171800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17180000
171900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17190000
172000               PC-ITEMS-PER-PANEL).                               17200000
172100                                                                  17210000
172200     MOVE ASC-END-OF-SELECTED-RANGE                               17220000
172300                                   TO  PV-END-OF-SELECTED-RANGE.  17230000
172400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17240000
172500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17250000
172600               PC-ITEMS-PER-PANEL).                               17260000
172700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17270000
172800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17280000
172900                                                                  17290000
173000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17300000
173100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17310000
173200         MOVE +1                   TO ASC-BLK-SUB                 17320000
173300         PERFORM 5100-WRITE-TEMP-STORAGE                          17330000
173400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17340000
173500             PV-FIRST-BLOCK-IN-ARRAY - 1                          17350000
173600                                                                  17360000
173700         PERFORM                                                  17370000
173800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17380000
173900                   PV-PREV-BLOCK-IN-ARRAY                         17390000
174000             MOVE PV-FIRST-BLOCK-IN-RANGE                         17400000
174100                                   TO PV-BLOCK-NUMBER             17410000
174200             PERFORM 4410-READ-TEMP-STORAGE                       17420000
174300             PERFORM 3510-MARK-SELECTED-INDS                      17430000
174400                 VARYING ASC-ITEM-SUB                             17440000
174500                 FROM 1 BY 1                                      17450000
174600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17460000
174700             PERFORM 5100-WRITE-TEMP-STORAGE                      17470000
174800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     17480000
174900         END-PERFORM                                              17490000
175000                                                                  17500000
175100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17510000
175200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17520000
175300         PERFORM                                                  17530000
175400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17540000
175500                   PV-LAST-BLOCK-IN-RANGE                         17550000
175600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17560000
175700                                   TO PV-BLOCK-NUMBER             17570000
175800             PERFORM 4410-READ-TEMP-STORAGE                       17580000
175900             PERFORM 3510-MARK-SELECTED-INDS                      17590000
176000                 VARYING ASC-ITEM-SUB                             17600000
176100                 FROM 1 BY 1                                      17610000
176200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17620000
176300             PERFORM 5100-WRITE-TEMP-STORAGE                      17630000
176400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17640000
176500         END-PERFORM                                              17650000
176600                                                                  17660000
176700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17670000
176800                                   TO PV-BLOCK-NUMBER             17680000
176900         PERFORM 4410-READ-TEMP-STORAGE                           17690000
177000     END-IF.                                                      17700000
177100                                                                  17710000
177200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 17720000
177300                                      ASC-END-OF-SELECTED-RANGE.  17730000
177400                                                                  17740000
177500*----------------------------------------------------------------*17750000
177600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *17760000
177700*----------------------------------------------------------------*17770000
177800 3510-MARK-SELECTED-INDS.                                         17780000
177900                                                                  17790000
178000     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17800000
178100                                ASC-ITEM-SUB) >                   17810000
178200         ASC-START-OF-SELECTED-RANGE)                             17820000
178300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17830000
178400                                ASC-ITEM-SUB) =                   17840000
178500         ASC-START-OF-SELECTED-RANGE)                             17850000
178600                                                                  17860000
178700         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17870000
178800                                    ASC-ITEM-SUB) <               17880000
178900             ASC-END-OF-SELECTED-RANGE)                           17890000
179000         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17900000
179100                                    ASC-ITEM-SUB) =               17910000
179200             ASC-END-OF-SELECTED-RANGE)                           17920000
179300                                                                  17930000
179400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17940000
179500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   17950000
179600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   17960000
179700                               TO TRUE                            17970000
179800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              17980000
179900                               TO TRUE                            17990000
180000                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18000000
180100             END-IF                                               18010000
180200         END-IF                                                   18020000
180300     END-IF.                                                      18030000
180400                                                                  18040000
180500*----------------------------------------------------------------*18050000
180600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18060000
180700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18070000
180800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18080000
180900*    DISPLAY THE PANEL TO USER.                                  *18090000
181000*----------------------------------------------------------------*18100000
181100 4000-BUILD-INITIAL-PANEL.                                        18110000
181200                                                                  18120000
181300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18130000
181400                                 ASC-BLOCK-ENTRIES (2).           18140000
181500     MOVE +1                 TO ASC-BLK-SUB.                      18150000
181600     SET ASC-ITEMS-LEFT-ON-DB                                     18160000
181700                             TO TRUE.                             18170000
181800                                                                  18180000
181900     MOVE +0                 TO ASC-ITEM-SUB                      18190000
182000                                ASC-NUMBER-OF-ITEMS-READ          18200000
182100                                ASC-NUMBER-OF-SELECTED-ITEMS      18210000
182200                                ASC-HIGHEST-BLOCK-WRITTEN         18220000
182300                                ASC-START-OF-SELECTED-RANGE       18230000
182400                                ASC-END-OF-SELECTED-RANGE         18240000
182500                                ASC-ITEM-AT-TOP-OF-PANEL.         18250000
182600                                                                  18260000
182700     EVALUATE ASC-CREATE-ID                                       18270000
182800         WHEN 'ASN'                                               18280000
182900             MOVE  'CREATED IN ASN      '  TO ACREATEO            18290000
183000         WHEN 'CKN'                                               18300000
183100             MOVE  'CREATED IN CHECK-IN '  TO ACREATEO            18310000
183200         WHEN 'P2L'                                               18320000
183300             MOVE  'CREATED IN PCK-2-LTE'  TO ACREATEO            18330000
183400         WHEN 'JWL'                                               18340000
183500             MOVE  'CREATED IN FINE JWLY'  TO ACREATEO            18350000
183600         WHEN 'RDM'                                               18360000
183700             MOVE  'CREATED IN RDM      '  TO ACREATEO            18370000
183800         WHEN 'RCV'                                               18380000
183900             MOVE  'CREATED IN RECEIVING'  TO ACREATEO            18390000
184000         WHEN 'SMO'                                               18400000
184100             MOVE  'CREATED IN SMOOTHING'  TO ACREATEO            18410000
184200         WHEN 'FXR'                                               18420000
184300             MOVE  'CREATED IN FAST XFER'  TO ACREATEO            18430000
184400         WHEN 'MST'                                               18440000
184500             MOVE  'CREATED IN MSTR CRTN'  TO ACREATEO            18450000
184600         WHEN 'MSC'                                               18460000
184700             MOVE  'CREATD IN CRTN BUILD'  TO ACREATEO            18470000
184800         WHEN 'CPS'                                               18480000
184900             MOVE  'CREATED IN CASE PACK'  TO ACREATEO            18490000
185000         WHEN 'DMG'                                               18500000
185100             MOVE  'CREATED IN CRTN ADJ '  TO ACREATEO            18510000
185110         WHEN 'WMC'                                               18511007
185120             MOVE  'CREATED IN WMOS MANL'  TO ACREATEO            18512006
185130         WHEN 'WMU'                                               18513007
185140             MOVE  'CREATED IN WMOS U128'  TO ACREATEO            18514006
185141         WHEN '3WD'                                               18514151
185142             MOVE  'CREATD 3RD PRTY WHSE'  TO ACREATEO            18514251
185150         WHEN OTHER                                               18515006
185160             MOVE  ASC-CREATE-ID           TO ACREATEO            18516006
185400     END-EVALUATE.                                                18540000
185500                                                                  18550000
185600     MOVE ASC-SML-NBR  TO DK-SHIPT-UNT-ID.                        18560000
185700     PERFORM 4010-OPEN-CURSOR.                                    18570000
185800     PERFORM 4300-READ-ITEMS-FROM-DB.                             18580000
185900     PERFORM 4020-CLOSE-CURSOR.                                   18590000
186000                                                                  18600000
186100     MOVE +1                   TO  PV-TOP-ITEM.                   18610000
186200                                                                  18620000
186300*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        18630000
186400*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   18640000
186500*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      18650000
186600*    THE ORIGINAL SCREEN.                                         18660000
186610                                                                  18661051
186700     EVALUATE TRUE                                                18670000
186800         WHEN SU010-SELECTED-ITEMS > 1                            18680000
186900             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18690000
187000                 SET DP020-MSG-WARNING TO  TRUE                   18700000
187100                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18710000
187200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18720000
187300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18730000
187400             ELSE                                                 18740000
187500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18750000
187600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18760000
187700             END-IF                                               18770000
187800         WHEN OTHER                                               18780000
187900             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18790000
188000                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            18800000
188100                 SET DP020-MSG-FATAL   TO  TRUE                   18810000
188200                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18820000
188300             ELSE                                                 18830000
188400                 MOVE -1               TO ASTRTITL                18840000
188500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18850000
188600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18860000
188700             END-IF                                               18870000
188800     END-EVALUATE.                                                18880000
188900                                                                  18890000
189000*----------------------------------------------------------------*18900000
189100* OPEN THE CURSOR                                                 18910000
189200*----------------------------------------------------------------*18920000
189300 4010-OPEN-CURSOR.                                                18930000
189400                                                                  18940000
189500                                                                  18950000
189600     PERFORM                                                      18960000
189700         WITH TEST AFTER                                          18970000
189800         VARYING PV-RETRY-COUNTER                                 18980000
189900         FROM 1 BY 1                                              18990000
190000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19000000
190100                   OR (SQLCODE = ZERO))                           19010000
190200                                                                  19020000
190300         IF ASC-FROM-SMOOTHING AND                                19030000
190400            ASC-CREATE-ID = 'ASN'                                 19040000
190500             EXEC SQL                                             19050000
190600                  OPEN CRTN-DETL-INBD-CSR                         19060000
190700             END-EXEC                                             19070000
190800         ELSE                                                     19080000
190900             EXEC SQL                                             19090000
191000                  OPEN CRTN-DETL-CSR                              19100000
191100             END-EXEC                                             19110000
191200         END-IF                                                   19120000
191300                                                                  19130000
192700         EVALUATE TRUE                                            19270000
192800             WHEN SQLCODE = ZERO                                  19280000
192900             WHEN SQLCODE = -904                                  19290000
193000             WHEN SQLCODE = -913                                  19300000
193100                 CONTINUE                                         19310000
193200             WHEN SQLWARN0 NOT = SPACES                           19320000
193300             WHEN SQLCODE < ZERO                                  19330000
193400             WHEN SQLCODE > ZERO                                  19340000
193500                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       19350000
193600                 MOVE 'OPEN CURSOR PROBLEM    - '                 19360000
193700                                   TO DP013-MESSAGE-TEXT (1)      19370000
193800                 MOVE SQLCA        TO DP013-SQLCA                 19380000
193900                 MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)    19390000
194000                 SET DP013-DB2-ABEND                              19400000
194100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19410000
194200                 PERFORM DP013-0000-PROCESS-ABEND                 19420000
194300         END-EVALUATE                                             19430000
194400     END-PERFORM.                                                 19440000
194500                                                                  19450051
194600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19460000
194700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19470000
194800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19480000
194900                                   TO DP013-MESSAGE-TEXT (1)      19490000
195000         MOVE SQLCA                TO DP013-SQLCA                 19500000
195100         MOVE 'SUT00028'           TO DP013-DB2-TABLE-NAME (1)    19510000
195200         SET DP013-DB2-ABEND                                      19520000
195300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19530000
195400         PERFORM DP013-0000-PROCESS-ABEND                         19540000
195500     END-IF.                                                      19550000
195600                                                                  19560000
195700*----------------------------------------------------------------*19570000
195800* CLOSE THE CURSOR.                                               19580000
195900*----------------------------------------------------------------*19590000
196000 4020-CLOSE-CURSOR.                                               19600000
196100                                                                  19610000
196200      IF ASC-FROM-SMOOTHING AND                                   19620000
196300         ASC-CREATE-ID = 'ASN'                                    19630000
196400                                                                  19640000
196500         EXEC SQL                                                 19650000
196600              CLOSE CRTN-DETL-INBD-CSR                            19660000
196700         END-EXEC                                                 19670000
196800     ELSE                                                         19680000
196900         EXEC SQL                                                 19690000
197000              CLOSE CRTN-DETL-CSR                                 19700000
197100         END-EXEC                                                 19710000
197200     END-IF.                                                      19720000
197300                                                                  19730000
197400     EVALUATE TRUE                                                19740000
197500         WHEN SQLCODE = ZERO                                      19750000
197600         WHEN SQLCODE = +100                                      19760000
197700             CONTINUE                                             19770000
197800         WHEN SQLWARN0 NOT = SPACES                               19780000
197900         WHEN SQLCODE < ZERO                                      19790000
198000         WHEN SQLCODE > ZERO                                      19800000
198100             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          19810000
198200             MOVE 'CLOSE CURSOR PROBLEM   '                       19820000
198300                               TO DP013-MESSAGE-TEXT (1)          19830000
198400             MOVE SQLCA        TO DP013-SQLCA                     19840000
198500             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        19850000
198600             SET DP013-DB2-ABEND                                  19860000
198700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19870000
198800             PERFORM DP013-0000-PROCESS-ABEND                     19880000
198900     END-EVALUATE.                                                19890000
199000                                                                  19900000
199100*----------------------------------------------------------------*19910000
199200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *19920000
199300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *19930000
199400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *19940000
199500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *19950000
199600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *19960000
199700*                                                                *19970000
199800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *19980000
199900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *19990000
200000*    UPON INITIALIZATION.                                        *20000000
200100*----------------------------------------------------------------*20010000
200200 4300-READ-ITEMS-FROM-DB.                                         20020000
200300                                                                  20030000
200400     PERFORM                                                      20040000
200500         VARYING PV-READ-COUNT                                    20050000
200600         FROM 1 BY 1                                              20060000
200700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20070000
200800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20080000
200900                                                                  20090000
201000         PERFORM 4310-FETCH                                       20100000
201100                                                                  20110000
201200         IF  ASC-ITEMS-LEFT-ON-DB                                 20120000
201300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20130000
201400                 ADD +1            TO ASC-ITEM-SUB                20140000
201500             ELSE                                                 20150000
201600                 ADD +1            TO ASC-BLK-SUB                 20160000
201700                 MOVE +1           TO ASC-ITEM-SUB                20170000
201800                                                                  20180000
201900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20190000
202000                     MOVE +1       TO ASC-BLK-SUB                 20200000
202100                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           20210000
202200                     PERFORM 5100-WRITE-TEMP-STORAGE              20220000
202300                     MOVE ASC-BLOCK-ENTRIES                       20230000
202400                                   (PC-MAX-BLOCKS-IN-ARRAY)       20240000
202500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20250000
202600                     ADD +1        TO ASC-BLK-SUB                 20260000
202700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20270000
202800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20280000
202900                                                          TO TRUE 20290000
203000                 END-IF                                           20300000
203100             END-IF                                               20310000
203200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20320000
203300             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          20330000
203400             MOVE ASC-NUMBER-OF-ITEMS-READ                        20340000
203500                                   TO ASC-LIST-ITEM-NUMBER        20350000
203600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20360000
203700             IF ASC-CREATE-ID = 'RDM' OR 'FXR' OR                 20370000
203800                  ASC-FROM-SMOOTHING                              20380000
203900                 MOVE SUT00028-TRN-NBR    TO DK-PO-TRN-NBR        20390000
204000                 MOVE DK-TRN-NBR-X        TO DK-PO-RCVR           20400000
204020                 IF ASC-CREATE-ID = 'RDM'                         20402031
204030                     MOVE SUT00028-TRN-NBR TO DK-PULL             20403031
204050                     MOVE DK-PULL-NBR      TO DK-PO-RCVR          20405031
204090                 END-IF                                           20409031
204100             ELSE                                                 20410000
204200                 MOVE SUT00028-TRN-NBR    TO DK-PO-TRN-NBR        20420000
204300                 MOVE DK-TRN-NBR-X        TO DK-TRN-NBR-9         20430000
204400                 MOVE DK-TRN-NBR-8        TO DK-TRN-NBR           20440000
204500                 MOVE SUT00028-RCVR-SEQ-NBR TO DK-PO-RCVR-NBR-N   20450000
204600                                                                  20460000
204700                 IF  SUT00028-RCVR-SEQ-NBR = 0                    20470000
204800                     PERFORM 4305-GET-RCVR-SEQ                    20480000
204900                 END-IF                                           20490000
205000                 MOVE DK-RCVR-NBR-X       TO DK-RCVR-NBR-9        20500000
205100                 MOVE DK-RCVR-NBR-3       TO DK-RCVR-NBR          20510000
205200             END-IF                                               20520000
205300                                                                  20530000
205410             IF ( ASC-CREATE-ID    = 'RDM' OR 'FXR' ) AND         20541023
205500                 SUT00028-TRN-NBR  =  0                           20550000
205600                 MOVE  'UNKNOWN   '  TO                           20560000
205700                           ASC-PO-RCVR (ASC-BLK-SUB ASC-ITEM-SUB) 20570000
205800             ELSE                                                 20580000
205900                 MOVE DK-PO-RCVR  TO                              20590000
206000                           ASC-PO-RCVR (ASC-BLK-SUB ASC-ITEM-SUB) 20600000
206110             END-IF                                               20611026
206200                                                                  20620000
206300             MOVE SUT00028-TRN-LNE-NBR TO                         20630000
206400                          ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 20640000
206500             MOVE SUT00028-UPC-NBR TO                             20650000
206600                           ASC-UPC-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 20660000
206700             MOVE SUT00028-SHPD-UNT-QTY TO                        20670000
206800                               ASC-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 20680000
206900             MOVE XLV00001-DEPT-NBR TO PV-WORK-DEPT-NBR-N         20690057
206910             MOVE PV-WORK-DEPT-2-4  TO                            20691056
207000                          ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 20700000
207100             MOVE XLV00001-SUB-CL-NBR TO PV-WORK-SUB-CL-NBR-N     20710057
207110             MOVE PV-WORK-SUB-CL-2-4  TO                          20711056
207200                             ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) 20720000
207300             MOVE XLV00000-SKU-NBR TO                             20730000
207400                           ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 20740000
207500             MOVE XLV00000-SKU-DESC TO                            20750000
207600                          ASC-SKU-DESC (ASC-BLK-SUB ASC-ITEM-SUB) 20760000
207700         END-IF                                                   20770000
207800     END-PERFORM.                                                 20780000
207900                                                                  20790000
208000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20800000
208100         MOVE +1               TO ASC-BLK-SUB                     20810000
208200         PERFORM 5100-WRITE-TEMP-STORAGE                          20820000
208300         ADD +1                TO ASC-BLK-SUB                     20830000
208400         PERFORM 5100-WRITE-TEMP-STORAGE                          20840000
208500                                                                  20850000
208600         MOVE 1                TO ASC-BLK-SUB                     20860000
208700                                  PV-BLOCK-NUMBER                 20870000
208800         PERFORM 4410-READ-TEMP-STORAGE                           20880000
208900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20890000
209000             MOVE 2            TO ASC-BLK-SUB                     20900000
209100                                  PV-BLOCK-NUMBER                 20910000
209200             PERFORM 4410-READ-TEMP-STORAGE                       20920000
209300         END-IF                                                   20930000
209400     END-IF.                                                      20940000
209500                                                                  20950000
209600                                                                  20960000
209700*----------------------------------------------------------------*20970000
209800*   GET RCVR SEQ FOR CARTONS CREATED BY ASN                      *20980000
209900*----------------------------------------------------------------*20990000
210000 4305-GET-RCVR-SEQ.                                               21000000
210100     MOVE ASC-SML-NBR  TO DK-KOHLS-18.                            21010000
210200                                                                  21020000
210300     EXEC SQL                                                     21030000
210400          SELECT  B.REC_SEQ_NBR                                   21040000
210500            INTO  :PKSLIP-REC-SEQ-NBR                             21050000
210600            FROM  SUT_OTBND_VND A                                 21060000
210700                 ,TPKSLIP  B                                      21070000
210800           WHERE  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID          21080000
210900             AND  A.PO_NBR            = B.PO_NBR                  21090000
211000             AND  A.PKSL_SEQ_NBR      = B.SEQ_NBR                 21100000
211100             AND  B.VER_STAT_CDE      = 'A'                       21110000
211200       END-EXEC.                                                  21120000
211300                                                                  21130000
211400     EVALUATE TRUE                                                21140000
211500         WHEN SQLCODE = ZERO                                      21150000
211600             MOVE PKSLIP-REC-SEQ-NBR TO DK-PO-RCVR-NBR-N          21160000
211700         WHEN SQLCODE = +100                                      21170000
211800              CONTINUE                                            21180000
211900         WHEN SQLWARN0 NOT = SPACE                                21190000
212000         WHEN SQLCODE NOT = ZERO                                  21200000
212100              MOVE '4305-GET-RCVR-SEQ' TO DP013-PARAGRAPH         21210000
212200              MOVE 'GET RECV FROM PACKSLIP'                       21220000
212300                               TO DP013-MESSAGE-TEXT (1)          21230000
212400              MOVE SQLCA       TO DP013-SQLCA                     21240000
212500              MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)       21250000
212600              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (1)       21260000
212700              SET DP013-DB2-ABEND TO TRUE                         21270000
212800              PERFORM DP013-0000-PROCESS-ABEND                    21280000
212900     END-EVALUATE.                                                21290000
213000                                                                  21300000
213100                                                                  21310000
213200*----------------------------------------------------------------*21320000
213300*    FETCH THE CURSOR                                             21330000
213400*----------------------------------------------------------------*21340000
213500 4310-FETCH.                                                      21350000
213600      IF ASC-FROM-SMOOTHING AND                                   21360000
213700         ASC-CREATE-ID = 'ASN'                                    21370000
213800                                                                  21380000
213900          EXEC SQL                                                21390000
214000              FETCH CRTN-DETL-INBD-CSR                            21400000
214100              INTO  :PV-SOURCE                                    21410000
214200                  , :SUT00028-TRN-NBR                             21420000
214300                   ,:SUT00028-RCVR-SEQ-NBR                        21430000
214400                   ,:SUT00028-TRN-LNE-NBR                         21440000
214500                   ,:SUT00028-UPC-NBR                             21450000
214600                   ,:SUT00028-SHPD-UNT-QTY                        21460000
214700                   ,:XLV00001-DEPT-NBR                            21470000
214800                   ,:XLV00001-SUB-CL-NBR                          21480000
214900                   ,:XLV00000-SKU-NBR                             21490000
215000                   ,:XLV00000-SKU-DESC                            21500000
215100          END-EXEC                                                21510000
215200                                                                  21520000
215300      ELSE                                                        21530000
215400          EXEC SQL                                                21540000
215500              FETCH CRTN-DETL-CSR                                 21550000
215600              INTO  :PV-SOURCE                                    21560000
215700                  , :SUT00028-TRN-NBR                             21570000
215800                   ,:SUT00028-RCVR-SEQ-NBR                        21580000
215900                   ,:SUT00028-TRN-LNE-NBR                         21590000
216000                   ,:SUT00028-UPC-NBR                             21600000
216100                   ,:SUT00028-SHPD-UNT-QTY                        21610000
216200                   ,:XLV00001-DEPT-NBR                            21620000
216300                   ,:XLV00001-SUB-CL-NBR                          21630000
216400                   ,:XLV00000-SKU-NBR                             21640000
216500                   ,:XLV00000-SKU-DESC                            21650000
216600          END-EXEC                                                21660000
216700      END-IF.                                                     21670000
217700                                                                  21770000
217800     EVALUATE TRUE                                                21780000
217900         WHEN SQLCODE = ZERO                                      21790000
218000         WHEN SQLCODE = +100                                      21800000
218100              CONTINUE                                            21810000
218200         WHEN SQLWARN0 NOT = SPACE                                21820000
218300         WHEN SQLCODE NOT = ZERO                                  21830000
218400              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         21840000
218500              MOVE 'FETCH CURSOR PROBLEM '                        21850000
218600                               TO DP013-MESSAGE-TEXT (1)          21860000
218700              MOVE SQLCA       TO DP013-SQLCA                     21870000
218800              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       21880000
218900              SET DP013-DB2-ABEND TO TRUE                         21890000
219000              PERFORM DP013-0000-PROCESS-ABEND                    21900000
219100     END-EVALUATE.                                                21910000
219200                                                                  21920000
219300     IF  SQLCODE EQUAL +100                                       21930000
219400         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      21940000
219500     END-IF.                                                      21950000
219600                                                                  21960000
219700*----------------------------------------------------------------*21970000
219800* RETRIEVE CREATE DATE/TIME FROM SUT_OTBND_CART TABLE             21980000
219900*----------------------------------------------------------------*21990000
220000 4320-GET-DATE-TIME.                                              22000000
220010     INITIALIZE DCLSUT00024.                                      22001015
220020                                                                  22002015
220100     MOVE ASC-SML-NBR  TO DK-SHIPT-UNT-ID.                        22010000
220200     EXEC SQL                                                     22020000
220300          SELECT CRE_DTE                                          22030000
220400                ,CRE_TM                                           22040000
220500                ,ACTV_IND                                         22050000
220600                ,PRNT_CART_ID                                     22060000
220610                ,ORIG_CART_ID                                     22061008
220700          INTO  :SUT00024-CRE-DTE                                 22070000
220800               ,:SUT00024-CRE-TM                                  22080000
220900               ,:SUT00024-ACTV-IND                                22090000
221000               ,:SUT00024-PRNT-CART-ID                            22100000
221010               ,:SUT00024-ORIG-CART-ID                            22101008
221100           FROM  SUT_OTBND_CART                                   22110000
221200          WHERE  SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                22120000
221300     END-EXEC                                                     22130000
221400     EVALUATE TRUE                                                22140000
221500         WHEN SQLCODE = ZERO                                      22150000
221600             MOVE SUT00024-CRE-DTE TO DK-CRE-DATE                 22160000
221700             MOVE SUT00024-CRE-TM TO  DK-CRE-TIME                 22170000
221800             MOVE DK-TMST-CCYY    TO  PV-DISPLAY-CCYY             22180000
221900             MOVE DK-TMST-MM      TO  PV-DISPLAY-MM               22190000
222000             MOVE DK-TMST-DD      TO  PV-DISPLAY-DD               22200000
222100             MOVE DK-TMST-HRS     TO  PV-DISPLAY-HRS              22210000
222200             MOVE DK-TMST-MIN     TO  PV-DISPLAY-MIN              22220000
222300             MOVE DK-TMST-SEC     TO  PV-DISPLAY-SEC              22230000
222400         WHEN SQLCODE = +100                                      22240000
222500             PERFORM 4325-GET-DATE-TIME                           22250000
222600         WHEN SQLWARN0 NOT = SPACE                                22260000
222700         WHEN SQLCODE NOT = ZERO                                  22270000
222800              MOVE '4320-GET-DATE-TIME   ' TO DP013-PARAGRAPH     22280000
222900              MOVE 'GET SHPUNT DATE & TIME '                      22290000
223000                               TO DP013-MESSAGE-TEXT (1)          22300000
223100              MOVE SQLCA       TO DP013-SQLCA                     22310000
223200              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       22320000
223300              SET DP013-DB2-ABEND TO TRUE                         22330000
223400              PERFORM DP013-0000-PROCESS-ABEND                    22340000
223500     END-EVALUATE.                                                22350000
223600                                                                  22360000
223700*----------------------------------------------------------------*22370000
223800 4325-GET-DATE-TIME.                                              22380000
223900                                                                  22390000
224000     EXEC SQL                                                     22400000
224100          SELECT CRE_DTE                                          22410000
224200                ,CRE_TM                                           22420000
224300                ,ACTV_IND                                         22430000
224400          INTO  :SUT00024-CRE-DTE                                 22440000
224500               ,:SUT00024-CRE-TM                                  22450000
224600               ,:SUT00024-ACTV-IND                                22460000
224700           FROM  SUT_OTBND_CART                                   22470000
224800          WHERE  ORIG_CART_ID  =  :DK-SHIPT-UNT-ID                22480000
224900     END-EXEC.                                                    22490000
225000                                                                  22500000
225100     EVALUATE TRUE                                                22510000
225200         WHEN SQLCODE = ZERO                                      22520000
225300             MOVE SUT00024-CRE-DTE TO DK-CRE-DATE                 22530000
225400             MOVE SUT00024-CRE-TM TO  DK-CRE-TIME                 22540000
225500             MOVE DK-TMST-CCYY    TO  PV-DISPLAY-CCYY             22550000
225600             MOVE DK-TMST-MM      TO  PV-DISPLAY-MM               22560000
225700             MOVE DK-TMST-DD      TO  PV-DISPLAY-DD               22570000
225800             MOVE DK-TMST-HRS     TO  PV-DISPLAY-HRS              22580000
225900             MOVE DK-TMST-MIN     TO  PV-DISPLAY-MIN              22590000
226000             MOVE DK-TMST-SEC     TO  PV-DISPLAY-SEC              22600000
226100         WHEN SQLCODE = +100                                      22610000
226200             MOVE SPACES TO PV-DATE-DISPLAY                       22620000
226300                            PV-TIME-DISPLAY                       22630000
226400         WHEN SQLWARN0 NOT = SPACE                                22640000
226500         WHEN SQLCODE NOT = ZERO                                  22650000
226600              MOVE '4325-GET-DATE-TIME   ' TO DP013-PARAGRAPH     22660000
226700              MOVE 'GET SHPUNT DATE & TIME '                      22670000
226800                               TO DP013-MESSAGE-TEXT (1)          22680000
226900              MOVE SQLCA       TO DP013-SQLCA                     22690000
227000              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       22700000
227100              SET DP013-DB2-ABEND TO TRUE                         22710000
227200              PERFORM DP013-0000-PROCESS-ABEND                    22720000
227300     END-EVALUATE.                                                22730000
227400                                                                  22740000
227500                                                                  22750000
227600*----------------------------------------------------------------*22760000
227700* RETRIEVE TRIP STATUS DESCRIPTION FROM TSUOBSC                   22770000
227800*----------------------------------------------------------------*22780000
227900 4330-GET-TRIP-STATUS.                                            22790000
228000     EXEC SQL                                                     22800000
228100          SELECT STAT_SHRT_DESC                                   22810000
228200          INTO  :SUOBSC-STAT-SHRT-DESC                            22820000
228300           FROM  TSUOBSC                                          22830000
228400          WHERE  TRIP_STAT_CDE = :ASC-TRIP-STATUS                 22840000
228500     END-EXEC                                                     22850000
228600     EVALUATE TRUE                                                22860000
228700         WHEN SQLCODE = ZERO                                      22870000
228800             MOVE SUOBSC-STAT-SHRT-DESC TO ASC-TRLR-STATUS        22880000
228900         WHEN SQLCODE = +100                                      22890000
229000             MOVE SPACES TO ASC-TRLR-STATUS                       22900000
229100         WHEN SQLWARN0 NOT = SPACE                                22910000
229200         WHEN SQLCODE NOT = ZERO                                  22920000
229300              MOVE '4330-GET-TRIP-STATUS ' TO DP013-PARAGRAPH     22930000
229400              MOVE 'GET TRIP STATUS '                             22940000
229500                               TO DP013-MESSAGE-TEXT (1)          22950000
229600              MOVE SQLCA       TO DP013-SQLCA                     22960000
229700              MOVE 'TSUOBSC '   TO DP013-DB2-TABLE-NAME (1)       22970000
229800              SET DP013-DB2-ABEND TO TRUE                         22980000
229900              PERFORM DP013-0000-PROCESS-ABEND                    22990000
230000     END-EVALUATE.                                                23000000
230100                                                                  23010000
230101*----------------------------------------------------------------*23010142
230102* GET STORE SCAN CODE                                             23010242
230104*----------------------------------------------------------------*23010442
230110 4340-GET-STORE-SCAN-CDE.                                         23011042
230130                                                                  23013042
230142     MOVE ASC-SML-NBR                  TO SUT00121-SHIPT-UNT-ID   23014242
230143                                                                  23014342
230144     EXEC SQL                                                     23014442
230145          SELECT SCN_TYP_CDE                                      23014542
230146          INTO  :SUT00121-SCN-TYP-CDE                             23014642
230147           FROM  SUT_OTBND_STR_SCN A                              23014742
230148          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           23014842
230149            AND A.CRE_TMST IN                                     23014942
230150                (SELECT MAX(B.CRE_TMST)                           23015042
230151                   FROM SUT_OTBND_STR_SCN B                       23015142
230152                  WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID         23015242
230153                    AND NOT B.SCN_TYP_CDE  =  'SSMS'              23015344
230154                )                                                 23015444
230155     END-EXEC.                                                    23015544
230200     EVALUATE TRUE                                                23020042
230201         WHEN SQLCODE = ZERO                                      23020142
230202             MOVE SUT00121-SCN-TYP-CDE   TO  ASC-STR-SCAN         23020242
230203                                             ASTSCNO              23020343
230204             PERFORM 4345-CHECK-MULT-STR-SCN                      23020445
230210         WHEN SQLCODE = +100                                      23021042
230211             MOVE SPACES                 TO  ASC-STR-SCAN         23021142
230212         WHEN SQLWARN0 NOT = SPACE                                23021242
230213         WHEN SQLCODE NOT = ZERO                                  23021342
230214              MOVE '4340-GET-STORE-SCAN-CDE'                      23021442
230215                                         TO DP013-PARAGRAPH       23021542
230216              MOVE 'GET THE STORE SCAN CODE '                     23021642
230217                               TO DP013-MESSAGE-TEXT (1)          23021742
230218              MOVE SQLCA       TO DP013-SQLCA                     23021842
230219              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       23021942
230220              SET DP013-DB2-ABEND TO TRUE                         23022042
230221              PERFORM DP013-0000-PROCESS-ABEND                    23022142
230222     END-EVALUATE.                                                23022242
230223                                                                  23022342
230224                                                                  23022445
230225*----------------------------------------------------------------*23022545
230226* CHECK IF CARTON SCANNED MULTIPLE TIMES                          23022645
230228*----------------------------------------------------------------*23022845
230229 4345-CHECK-MULT-STR-SCN.                                         23022945
230230                                                                  23023045
230233     EXEC SQL                                                     23023345
230234          SELECT COUNT(*)                                         23023445
230235          INTO  :PV-STR-SCAN-COUNT                                23023545
230236           FROM  SUT_OTBND_STR_SCN A                              23023645
230237          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           23023745
230244     END-EXEC.                                                    23024445
230245     EVALUATE TRUE                                                23024545
230246         WHEN SQLCODE = ZERO                                      23024645
230247              IF  PV-STR-SCAN-COUNT  >  1                         23024745
230248                  SET  ASC-STR-SCAN-MULT  TO  TRUE                23024845
230249              ELSE                                                23024945
230250                  SET  ASC-STR-SCAN-MULT-NO  TO TRUE              23025045
230251              END-IF                                              23025148
230252                                                                  23025245
230253              IF  ASC-STR-SCAN-MULT                               23025345
230254                  MOVE DP015-RED     TO      ASTSCNC              23025445
230255              ELSE                                                23025545
230256                  MOVE DP015-BLUE    TO      ASTSCNC              23025645
230257              END-IF                                              23025745
230258                                                                  23025845
230259         WHEN SQLCODE = +100                                      23025945
230260              MOVE DP015-BLUE    TO      ASTSCNC                  23026045
230262         WHEN SQLWARN0 NOT = SPACE                                23026245
230263         WHEN SQLCODE NOT = ZERO                                  23026345
230264              MOVE '4345-CHECK-MULT-STR-SCN'                      23026445
230265                                         TO DP013-PARAGRAPH       23026545
230266              MOVE 'CHECK IF MULTIPLE STORE SCANS'                23026645
230267                               TO DP013-MESSAGE-TEXT (1)          23026745
230268              MOVE SQLCA       TO DP013-SQLCA                     23026845
230269              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       23026945
230270              SET DP013-DB2-ABEND TO TRUE                         23027045
230271              PERFORM DP013-0000-PROCESS-ABEND                    23027145
230272     END-EVALUATE.                                                23027245
230273                                                                  23027345
230274                                                                  23027445
230280*----------------------------------------------------------------*23028045
230300* GET TOTAL CARTON QUANTITY FROM SUT_OTBND_UPC                    23030000
230400*----------------------------------------------------------------*23040000
230500 4350-GET-SHPD-QTY.                                               23050000
230600     EXEC SQL                                                     23060000
230700          SELECT SUM(SHPD_UNT_QTY)                                23070000
230800          INTO  :PV-SHPD-QTY                                      23080000
230900           FROM  SUT_OTBND_UPC                                    23090000
231000          WHERE  SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                  23100000
231100     END-EXEC                                                     23110000
231200     EVALUATE TRUE                                                23120000
231300         WHEN SQLCODE = ZERO                                      23130000
231400             CONTINUE                                             23140000
231500         WHEN SQLCODE = +100                                      23150000
231600         WHEN SQLWARN0 NOT = SPACE                                23160000
231700         WHEN SQLCODE NOT = ZERO                                  23170000
231800             MOVE ZEROES          TO   PV-SHPD-QTY                23180000
231900     END-EVALUATE.                                                23190000
232000                                                                  23200000
232100*----------------------------------------------------------------*23210000
232200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23220000
232300*----------------------------------------------------------------*23230000
232400 4400-MOVE-COMMAREA-TO-SCREEN.                                    23240000
232500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23250000
232600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23260000
232700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23270000
232800             MOVE +1    TO ASC-BLK-SUB                            23280000
232900             PERFORM 5100-WRITE-TEMP-STORAGE                      23290000
233000             ADD +1     TO ASC-BLK-SUB                            23300000
233100             PERFORM 5100-WRITE-TEMP-STORAGE                      23310000
233200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23320000
233300                 GIVING PV-BLOCK-NUMBER                           23330000
233400                 REMAINDER PV-REMAINDER                           23340000
233500             IF  PV-REMAINDER > ZERO                              23350000
233600                 ADD +1 TO PV-BLOCK-NUMBER                        23360000
233700             END-IF                                               23370000
233800             MOVE +1    TO ASC-BLK-SUB                            23380000
233900             PERFORM 4410-READ-TEMP-STORAGE                       23390000
234000             ADD +1     TO ASC-BLK-SUB                            23400000
234100                           PV-BLOCK-NUMBER                        23410000
234200             PERFORM 4410-READ-TEMP-STORAGE                       23420000
234300     END-IF.                                                      23430000
234400     MOVE +1            TO ASC-BLK-SUB.                           23440000
234500     COMPUTE ASC-ITEM-SUB =                                       23450000
234600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23460000
234700         + PC-ITEMS-PER-PANEL).                                   23470000
234800                                                                  23480051
234900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23490000
235000         ADD +1         TO ASC-BLK-SUB                            23500000
235100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23510000
235200     END-IF.                                                      23520000
235300                                                                  23530051
235400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23540000
235500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23550000
235600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23560000
235700     PERFORM 4420-FORMAT-LIST-LINES                               23570000
235800         VARYING PV-SUB                                           23580000
235900         FROM PC-ITEMS-PER-PANEL BY -1                            23590000
236000         UNTIL PV-SUB < +1.                                       23600000
236100                                                                  23610051
236200     COMPUTE ASC-ITEMS-DISPLAYED =                                23620000
236300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23630000
236400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23640000
236500                                      ASTRTITO.                   23650000
236600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23660000
236700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23670000
236800                                                                  23680000
236900     PERFORM 4320-GET-DATE-TIME.                                  23690000
237000     IF SUT00024-PRNT-CART-ID  =  DK-SHIPT-UNT-ID OR              23700000
237100        SUT00024-PRNT-CART-ID  =  0                               23710014
237200         MOVE SPACES           TO AMSTO                           23720000
237300                                  AMSTNBRO                        23730000
237400     ELSE                                                         23740000
237500         MOVE 'MASTER SML.:'     TO AMSTO                         23750000
237600         MOVE SUT00024-PRNT-CART-ID  TO PV-DISPLAY-PARENT         23760000
237700         MOVE PV-DISPLAY-PARENT  TO AMSTNBRO                      23770000
237800                                                                  23780000
237900     END-IF                                                       23790000
237901                                                                  23790108
237910     IF SUT00024-ORIG-CART-ID  =  DK-SHIPT-UNT-ID OR              23791008
237920        SUT00024-ORIG-CART-ID  =  0                               23792008
237930         MOVE SPACES           TO ASRLO                           23793009
237940                                  ASRLNBRO                        23794009
237950     ELSE                                                         23795008
237960         MOVE 'SERIAL SHIP CODE:'    TO ASRLO                     23796009
237970         MOVE SUT00024-ORIG-CART-ID  TO PV-DISPLAY-ORIG           23797008
237980         MOVE PV-DISPLAY-ORIG        TO ASRLNBRO                  23798009
237990                                                                  23799008
237991     END-IF                                                       23799108
237992                                                                  23799208
238000     STRING PV-DATE-DISPLAY DELIMITED BY SIZE                     23800000
238100               ' '          DELIMITED BY SIZE                     23810000
238200            PV-TIME-DISPLAY DELIMITED BY SIZE                     23820000
238300                     INTO ADATTIMO.                               23830000
238400                                                                  23840000
238500     PERFORM 4350-GET-SHPD-QTY.                                   23850000
238600     MOVE PV-SHPD-QTY          TO  PV-SHPD-QTY-N.                 23860000
238700     MOVE PV-SHPD-QTY-X        TO  ATOTQTYO.                      23870000
238800                                                                  23880000
238900     MOVE ASC-SML-NBR          TO  ASMLO.                         23890000
239000     IF ASC-SML-NBR > ZERO                                        23900000
239100         PERFORM 1101-GET-CARTON-INFO                             23910000
239200     END-IF.                                                      23920000
239300                                                                  23930000
239400     EVALUATE ASC-CREATE-ID                                       23940000
239500         WHEN 'ASN'                                               23950000
239600             MOVE  'CREATED IN ASN      '  TO ACREATEO            23960000
239700         WHEN 'CKN'                                               23970000
239800             MOVE  'CREATED IN CHECK-IN '  TO ACREATEO            23980000
239900         WHEN 'P2L'                                               23990000
240000             MOVE  'CREATED IN PCK-2-LTE'  TO ACREATEO            24000000
240100         WHEN 'JWL'                                               24010000
240200             MOVE  'CREATED IN FINE JWLY'  TO ACREATEO            24020000
240300         WHEN 'RDM'                                               24030000
240400             MOVE  'CREATED IN RDM      '  TO ACREATEO            24040000
240500         WHEN 'RCV'                                               24050000
240600             MOVE  'CREATED IN RECEIVING'  TO ACREATEO            24060000
240700         WHEN 'SMO'                                               24070000
240800             MOVE  'CREATED IN SMOOTHING'  TO ACREATEO            24080000
240900         WHEN 'FXR'                                               24090000
241000             MOVE  'CREATED IN FAST XFER'  TO ACREATEO            24100000
241100         WHEN 'MST'                                               24110000
241200             MOVE  'CREATED IN MSTR CRTN'  TO ACREATEO            24120000
241300         WHEN 'MSC'                                               24130000
241400             MOVE  'CREATD IN CRTN BUILD'  TO ACREATEO            24140000
241500         WHEN 'CPS'                                               24150000
241600             MOVE  'CREATED IN CASE PACK'  TO ACREATEO            24160000
241700         WHEN 'DMG'                                               24170000
241800             MOVE  'CREATED IN CRTN ADJ '  TO ACREATEO            24180000
241810         WHEN 'WMC'                                               24181007
241820             MOVE  'CREATED IN WMOS MANL'  TO ACREATEO            24182006
241830         WHEN 'WMU'                                               24183007
241840             MOVE  'CREATED IN WMOS U128'  TO ACREATEO            24184006
241850         WHEN '3WD'                                               24185051
241860             MOVE  'CREATD 3RD PRTY WHSE'  TO ACREATEO            24186051
241900         WHEN OTHER                                               24190000
242000             MOVE  ASC-CREATE-ID           TO ACREATEO            24200006
242100     END-EVALUATE.                                                24210000
242200                                                                  24220000
242300     MOVE ASC-STR-NBR-X        TO  ADESTO.                        24230000
242400     MOVE ASC-DOOR-ID          TO  ADOORO.                        24240000
242410     MOVE ASC-STR-SCAN         TO  ASTSCNO.                       24241042
242500     IF ASC-TRIP-STATUS NOT = SPACES                              24250000
242600         PERFORM 4330-GET-TRIP-STATUS                             24260000
242700         MOVE ASC-TRLR-STATUS TO  ATRLSTAO                        24270000
242800     ELSE                                                         24280000
242900         MOVE SPACES          TO  ATRLSTAO                        24290000
243000     END-IF.                                                      24300000
243100     MOVE ASC-CRTN-STAT-DESC  TO  ACTNSTAO.                       24310000
243200                                                                  24320000
243300***IF THE CARTON IS INACTIVE, MAKE THE DESCRIPTION YELLOW.        24330000
243400     IF ASC-CARTON-STATUS = '02'                                  24340000
243500         MOVE DP015-YELLOW            TO ACTNSTAC                 24350000
243600     ELSE                                                         24360000
243700         MOVE DP015-BLUE              TO ACTNSTAC                 24370000
243800     END-IF.                                                      24380000
243900                                                                  24390000
244000     IF  ASC-OUTBOUND-TRIP-ID > 0                                 24400000
244100         MOVE ASC-OUTBOUND-TRIP-ID TO  ATRIPO                     24410000
244200     ELSE                                                         24420000
244210         MOVE SPACES               TO  ATRIPO                     24421000
244220     END-IF.                                                      24422000
244230                                                                  24423000
244240     IF ASC-DOOR-TYP-CDE > SPACES                                 24424000
244250         EXEC SQL                                                 24425000
244260              SELECT DOOR_TYP_CDE_DESC                            24426000
244270              INTO  :ASC-DOOR-DESC                                24427000
244280               FROM  TCNDRTY                                      24428000
244290              WHERE  DOOR_TYP_CDE = :ASC-DOOR-TYP-CDE             24429000
244300         END-EXEC                                                 24430000
244310         EVALUATE TRUE                                            24431000
244311             WHEN SQLCODE = ZERO                                  24431100
244312                 MOVE ASC-DOOR-DESC   TO  ADOORTYO                24431200
244313             WHEN SQLCODE = +100                                  24431300
244314             WHEN SQLWARN0 NOT = SPACE                            24431400
244315             WHEN SQLCODE NOT = ZERO                              24431500
244316                 MOVE SPACES          TO   ADOORTYO               24431600
244317         END-EVALUATE                                             24431700
244318     END-IF.                                                      24431800
244319                                                                  24431900
244320     IF ASC-TRLR-SRL-NMBR > ZEROES                                24432000
244321         IF ASC-SCAC-CODE = SPACES                                24432101
244322             MOVE ASC-TRLR-SRL-NMBR          TO  DK-TRLR-SRL-NBR  24432236
244330             EXEC SQL                                             24433001
244340                  SELECT SCAC_CDE                                 24434001
244341                       , TRLR_ID                                  24434135
244350                  INTO  :ASC-SCAC-CODE                            24435001
244351                       ,:ASC-TRLR-ID                              24435135
244360                   FROM  TCNTRID                                  24436001
244370                  WHERE  TRLR_SRL_NBR = :DK-TRLR-SRL-NBR          24437001
244380             END-EXEC                                             24438001
244390             EVALUATE TRUE                                        24439001
244400                 WHEN SQLCODE = ZERO                              24440001
244500                     MOVE ASC-SCAC-CODE      TO  ASCACO           24450001
244510                     MOVE ASC-TRLR-ID        TO  ATRLNBRO         24451036
244600                     MOVE ASC-TRLR-SRL-NMBR  TO  ATRLSRLO         24460032
244800                 WHEN SQLCODE = +100                              24480001
244900                 WHEN SQLWARN0 NOT = SPACE                        24490001
245000                 WHEN SQLCODE NOT = ZERO                          24500001
245100                     MOVE SPACES             TO  ASCACO           24510036
245200                                                 ATRLNBRO         24520036
245210                                                 ATRLSRLO         24521036
245300             END-EVALUATE                                         24530001
245310         ELSE                                                     24531001
245311             MOVE ASC-TRLR-SRL-NMBR          TO  DK-TRLR-SRL-NBR  24531136
245312             EXEC SQL                                             24531236
245313                  SELECT TRLR_ID                                  24531336
245315                  INTO  :ASC-TRLR-ID                              24531536
245316                   FROM  TCNTRID                                  24531636
245317                  WHERE  TRLR_SRL_NBR = :DK-TRLR-SRL-NBR          24531736
245318             END-EXEC                                             24531836
245319             EVALUATE TRUE                                        24531936
245320                 WHEN SQLCODE = ZERO                              24532036
245321                     MOVE ASC-SCAC-CODE      TO  ASCACO           24532136
245322                     MOVE ASC-TRLR-ID        TO  ATRLNBRO         24532236
245323                     MOVE ASC-TRLR-SRL-NMBR  TO  ATRLSRLO         24532336
245325                 WHEN SQLCODE = +100                              24532536
245326                 WHEN SQLWARN0 NOT = SPACE                        24532636
245327                 WHEN SQLCODE NOT = ZERO                          24532736
245328                     MOVE SPACES          TO   ASCACO             24532836
245329                                               ATRLNBRO           24532936
245330                                               ATRLSRLO           24533036
245331             END-EVALUATE                                         24533136
245400         END-IF                                                   24540001
245410     ELSE                                                         24541001
245500         MOVE SPACES    TO   ASCACO                               24550000
245600                             ATRLNBRO                             24560036
245610                             ATRLSRLO                             24561036
245700     END-IF.                                                      24570000
245800                                                                  24580000
245820     PERFORM 4340-GET-STORE-SCAN-CDE.                             24582042
245840                                                                  24584042
245900     IF  DP020-MSG-NUMBER-X = SPACE                               24590000
246000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  24600000
246100*            --- MORE ITEMS TO DISPLAY ----                       24610000
246200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            24620000
246300             SET DP020-MSG-INFORMATIONAL TO TRUE                  24630000
246400         END-IF                                                   24640000
246500     END-IF.                                                      24650000
246600                                                                  24660000
246700*----------------------------------------------------------------*24670000
246800*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *24680000
246900*----------------------------------------------------------------*24690000
247000 4410-READ-TEMP-STORAGE.                                          24700000
247100                                                                  24710000
247200     EXEC CICS                                                    24720000
247300         READQ TS                                                 24730000
247400             QUEUE (ASC-LIST-QUEUE-NAME)                          24740000
247500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24750000
247600             ITEM  (PV-BLOCK-NUMBER)                              24760000
247700             RESP  (PV-CICS-RESP)                                 24770000
247800     END-EXEC.                                                    24780000
247900                                                                  24790000
248000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       24800000
248100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24810000
248200         CONTINUE                                                 24820000
248300     ELSE                                                         24830000
248400         SET DP013-CICS-ABEND     TO TRUE                         24840000
248500         SET DP013-NO-ROLLBACK    TO TRUE                         24850000
248600         MOVE '4410-READ-TEMP-STORAGE'                            24860000
248700                                  TO DP013-PARAGRAPH              24870000
248800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24880000
248900                                  TO DP013-MESSAGE-TEXT(1)        24890000
249000         PERFORM DP013-0000-PROCESS-ABEND                         24900000
249100     END-IF.                                                      24910000
249200                                                                  24920000
249300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24930000
249400                                                                  24940051
249500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24950000
249600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24960000
249700     END-IF.                                                      24970000
249800                                                                  24980000
249900*----------------------------------------------------------------*24990000
250000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25000000
250100*----------------------------------------------------------------*25010000
250200 4420-FORMAT-LIST-LINES.                                          25020000
250300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25030000
250400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25040000
250800         MOVE SPACE              TO MR-PO-RCVR (PV-SUB)           25080000
250900                                    MR-LINE-NBR (PV-SUB)          25090000
251000                                    MR-DEPT-NBR (PV-SUB)          25100000
251100                                    MR-CLASS (PV-SUB)             25110000
251200                                    MR-SKU-NBR (PV-SUB)           25120000
251300                                    MR-SKU-DESC (PV-SUB)          25130000
251400                                    MR-UPC-NBR (PV-SUB)           25140000
251500                                    MR-QTY (PV-SUB)               25150000
251600     ELSE                                                         25160000
252500         IF  DP030-SET-CURSOR-TRAILER                             25250000
252600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)25260000
252700                 > SPACE)                                         25270000
252800               OR (PV-SUB = 1))                                   25280000
252900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               25290000
253000                MOVE -1               TO ASTRTITL                 25300000
253100             END-IF                                               25310000
253200         END-IF                                                   25320000
253300                                                                  25330051
253400         MOVE ASC-PO-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)              25340000
253500                                           TO MR-PO-RCVR (PV-SUB) 25350000
253600         MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             25360000
253700                                          TO MR-LINE-NBR (PV-SUB) 25370000
253800         MOVE ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             25380000
253900                                          TO MR-DEPT-NBR (PV-SUB) 25390000
254000         MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)                25400000
254100                                             TO MR-CLASS (PV-SUB) 25410000
254200         MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              25420000
254300                                           TO MR-SKU-NBR (PV-SUB) 25430000
254400         MOVE ASC-SKU-DESC (ASC-BLK-SUB ASC-ITEM-SUB)             25440000
254500                                          TO MR-SKU-DESC (PV-SUB) 25450000
254600         MOVE ASC-UPC-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              25460000
254700                                           TO MR-UPC-NBR (PV-SUB) 25470000
254800         MOVE ASC-QTY (ASC-BLK-SUB ASC-ITEM-SUB) TO DK-SHPD-QTY   25480000
254900         MOVE DK-SHPD-QTY-X                    TO MR-QTY (PV-SUB) 25490000
255000     END-IF.                                                      25500000
255100     SUBTRACT +1 FROM ASC-ITEM-SUB                                25510000
255200     IF  ASC-ITEM-SUB < + 1                                       25520000
255300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25530000
255400         MOVE +1                 TO ASC-BLK-SUB                   25540000
255500     END-IF.                                                      25550000
255600                                                                  25560000
255700******************************************************************25570000
255800** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **25580000
255900** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **25590000
256000** ISSUE A WARNING.                                             **25600000
256100******************************************************************25610000
256200 4430-CHECK-FOR-BEGIN-AND-END.                                    25620000
256300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25630000
256400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25640000
256500*            -- NO END-OF-RANGE SPECFIED ---                      25650000
256600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            25660000
256700             SET DP020-MSG-WARNING TO TRUE                        25670000
256800             PERFORM 4431-POSITION-AT-WARNING                     25680000
256900         END-IF                                                   25690000
257000     ELSE                                                         25700000
257100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     25710000
257200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                25720000
257300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            25730000
257400             SET DP020-MSG-WARNING TO TRUE                        25740000
257500             PERFORM 4431-POSITION-AT-WARNING                     25750000
257600         END-IF                                                   25760000
257700     END-IF.                                                      25770000
257800******************************************************************25780000
257900** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25790000
258000** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25800000
258100** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25810000
258200** POSITION THE CURSOR THERE.                                   **25820000
258300******************************************************************25830000
258400 4431-POSITION-AT-WARNING.                                        25840000
258500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25850000
258600                    - PV-TOP-ITEM + 1.                            25860000
258700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25870000
258800         CONTINUE                                                 25880000
258900     ELSE                                                         25890000
259000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25900000
259100         MOVE -1                    TO ASTRTITL                   25910000
259200     END-IF.                                                      25920000
259300                                                                  25930051
259400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25940000
259500                    - PV-TOP-ITEM + 1.                            25950000
259600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25960000
259700         CONTINUE                                                 25970000
259800     ELSE                                                         25980000
259900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      25990000
260000         MOVE -1                   TO ASTRTITL                    26000000
260100     END-IF.                                                      26010000
260200                                                                  26020000
260300*----------------------------------------------------------------*26030000
260400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *26040000
260500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *26050000
260600* FOR THE SELECTED ITEMS QUEUE.                                  *26060000
260700*                                                                *26070000
260800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *26080000
260900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *26090000
261000* THE ARRAY IS FULL.                                             *26100000
261100*----------------------------------------------------------------*26110000
261200 5000-PREPARE-SEL-QUEUE.                                          26120000
261300                                                                  26130000
261400     MOVE +1                   TO  ASC-BLK-SUB.                   26140000
261500     PERFORM 5100-WRITE-TEMP-STORAGE.                             26150000
261600     ADD +1                    TO  ASC-BLK-SUB.                   26160000
261700     PERFORM 5100-WRITE-TEMP-STORAGE.                             26170000
261800                                                                  26180000
261900     MOVE ASC-SEL-QUEUE-NAME-OUT TO  SU009-SEL-QUEUE-NAME.        26190000
262000     PERFORM 6010-DELETE-SEL-QUEUE.                               26200000
262100                                                                  26210000
262200     SET ASC-UPDATE-TSQ        TO  TRUE.                          26220000
262300                                                                  26230000
262400     SET SU010-IDX             TO  1.                             26240000
262500     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       26250000
262600     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        26260000
262700                                                                  26270000
262800     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           26280000
262900             VARYING PV-ITEM                                      26290000
263000             FROM 1 BY 1                                          26300000
263100             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     26310000
263200                                                                  26320000
263300     IF  SU010-IDX > 1                                            26330000
263400         PERFORM 5205-WRITE-SEL-QUEUE                             26340000
263500         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        26350000
263600     END-IF.                                                      26360000
263700*----------------------------------------------------------------*26370000
263800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *26380000
263900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *26390000
264000*----------------------------------------------------------------*26400000
264100 5100-WRITE-TEMP-STORAGE.                                         26410000
264200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     26420000
264300                                   TO PV-LIST-ITEM-NUMBER.        26430000
264400     COMPUTE PV-BLOCK-NUMBER =                                    26440000
264500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    26450000
264600                                                                  26460000
264700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             26470000
264800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             26480000
264900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      26490000
265000             PERFORM 5105-REWRITE-ASC-LISTQ                       26500000
265100         END-IF                                                   26510000
265200     ELSE                                                         26520000
265300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       26530000
265400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            26540000
265500         PERFORM 5110-WRITE-ASC-LISTQ                             26550000
265600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   26560000
265700     END-IF.                                                      26570000
265800                                                                  26580000
265900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26590000
266000                                                                  26600000
266100******************************************************************26610000
266200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **26620000
266300** SPECIFIC COMMAREA.                                           **26630000
266400******************************************************************26640000
266500 5105-REWRITE-ASC-LISTQ.                                          26650000
266600     EXEC CICS                                                    26660000
266700         WRITEQ TS                                                26670000
266800             QUEUE (ASC-LIST-QUEUE-NAME)                          26680000
266900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26690000
267000             ITEM  (PV-BLOCK-NUMBER)                              26700000
267100             REWRITE                                              26710000
267200             RESP  (PV-CICS-RESP)                                 26720000
267300     END-EXEC.                                                    26730000
267400                                                                  26740000
267500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26750000
267600         CONTINUE                                                 26760000
267700     ELSE                                                         26770000
267800         SET DP013-CICS-ABEND            TO TRUE                  26780000
267900         SET DP013-NO-ROLLBACK           TO TRUE                  26790000
268000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26800000
268100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26810000
268200                                         TO DP013-MESSAGE-TEXT(1) 26820000
268300         PERFORM DP013-0000-PROCESS-ABEND                         26830000
268400     END-IF.                                                      26840000
268500                                                                  26850000
268600******************************************************************26860000
268700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26870000
268800** SPECIFIC COMMAREA.                                           **26880000
268900******************************************************************26890000
269000 5110-WRITE-ASC-LISTQ.                                            26900000
269100     EXEC CICS                                                    26910000
269200         WRITEQ TS                                                26920000
269300             QUEUE (ASC-LIST-QUEUE-NAME)                          26930000
269400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26940000
269500             ITEM  (PV-BLOCK-NUMBER)                              26950000
269600             RESP  (PV-CICS-RESP)                                 26960000
269700     END-EXEC.                                                    26970000
269800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26980000
269900         SET DP013-CICS-ABEND      TO TRUE                        26990000
270000         SET DP013-NO-ROLLBACK     TO TRUE                        27000000
270100         MOVE '5110-WRITE-ASC-LISTQ'                              27010000
270200                                   TO DP013-PARAGRAPH             27020000
270300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           27030000
270400                                   TO DP013-MESSAGE-TEXT(1)       27040000
270500         PERFORM DP013-0000-PROCESS-ABEND                         27050000
270600     END-IF.                                                      27060000
270700                                                                  27070000
270800*----------------------------------------------------------------*27080000
270900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *27090000
271000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *27100000
271100*----------------------------------------------------------------*27110000
271200 5200-FILL-SEL-QUEUE-RECORD.                                      27120000
271300                                                                  27130000
271400     PERFORM 6112-READ-LIST-QUEUE.                                27140000
271500                                                                  27150000
271600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27160000
271700         PERFORM                                                  27170000
271800         VARYING LQW-IDX                                          27180000
271900         FROM 1 BY 1                                              27190000
272000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            27200000
272100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          27210000
272200                                                                  27220000
272300             IF  LQW-SELECT (LQW-IDX)                             27230000
272400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              27240000
272500                                   TO SU010-ITEM (SU010-IDX)      27250000
272600                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 27260000
272700                                                                  27270000
272800                 MOVE LQW-PO-RCVR (LQW-IDX)                       27280000
272900                                     TO SU010-PO-RCVR (SU010-IDX) 27290000
273000                                                                  27300000
273100                 SET SU010-IDX UP BY 1                            27310000
273200                 IF  SU010-IDX > SU010-MAX-ITEMS                  27320000
273300                     PERFORM 5205-WRITE-SEL-QUEUE                 27330000
273400                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    27340000
273500                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         27350000
273600                     SET SU010-IDX TO  1                          27360000
273700                 END-IF                                           27370000
273800             END-IF                                               27380000
273900         END-PERFORM                                              27390000
274000     END-IF.                                                      27400000
274100                                                                  27410000
274200*----------------------------------------------------------------*27420000
274300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27430000
274400*----------------------------------------------------------------*27440000
274500 5205-WRITE-SEL-QUEUE.                                            27450000
274600                                                                  27460000
274700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27470000
274800                                   TO SU010-SELECTED-ITEMS.       27480000
274900                                                                  27490000
275000     EXEC CICS                                                    27500000
275100          WRITEQ TS                                               27510000
275200              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      27520000
275300              FROM  (SU010-SELECT-RECORD)                         27530000
275400              ITEM  (PV-SEL-QUEUE-ITEM)                           27540000
275500              RESP  (PV-CICS-RESP)                                27550000
275600     END-EXEC.                                                    27560000
275700                                                                  27570000
275800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27580000
275900         CONTINUE                                                 27590000
276000     ELSE                                                         27600000
276100         SET DP013-CICS-ABEND      TO TRUE                        27610000
276200         SET DP013-NO-ROLLBACK     TO TRUE                        27620000
276300         MOVE '5205-WRITE-SEL-QUEUE'                              27630000
276400                                   TO DP013-PARAGRAPH             27640000
276500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27650000
276600                                   TO DP013-MESSAGE-TEXT(1)       27660000
276700         PERFORM DP013-0000-PROCESS-ABEND                         27670000
276800     END-IF.                                                      27680000
276900******************************************************************27690000
277000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27700000
277100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27710000
277200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27720000
277300** THE USER.                                                    **27730000
277400******************************************************************27740000
277500 6000-REFRESH-PANEL-FROM-TEMP.                                    27750000
277600     IF  ASC-UPDATE-TSQ                                           27760000
277700         SET ASC-NO-TSQ-UPDATE TO TRUE                            27770000
277800         MOVE ZERO                 TO PV-SAVE-ITEM                27780000
277900                                      PV-SEL-QUEUE-ITEM           27790000
278000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27800000
278100                                   TO PV-HOLD-SELECTED-ITEMS      27810000
278200         MOVE +1                   TO PV-ITEMS-PROCESSED          27820000
278300         PERFORM 6100-UPDATE-TSQ                                  27830000
278400             UNTIL PV-ITEMS-PROCESSED >                           27840000
278500                                     PV-HOLD-SELECTED-ITEMS       27850000
278600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27860000
278700                    ASC-BLOCK-ENTRIES (2)                         27870000
278800     END-IF.                                                      27880000
278900                                                                  27890000
279000*----------------------------------------------------------------*27900000
279100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27910000
279200*----------------------------------------------------------------*27920000
279300 6010-DELETE-SEL-QUEUE.                                           27930000
279400                                                                  27940000
279500     EXEC CICS                                                    27950000
279600         DELETEQ TS                                               27960000
279700             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       27970000
279800             RESP  (PV-CICS-RESP)                                 27980000
279900     END-EXEC.                                                    27990000
280000                                                                  28000051
280100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      28010000
280200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         28020000
280300         CONTINUE                                                 28030000
280400     ELSE                                                         28040000
280500         SET DP013-CICS-ABEND TO TRUE                             28050000
280600         SET DP013-NO-ROLLBACK TO TRUE                            28060000
280700         MOVE '6010-DELETE-SEL-QUEUE'                             28070000
280800                        TO DP013-PARAGRAPH                        28080000
280900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         28090000
281000                        TO DP013-MESSAGE-TEXT (1)                 28100000
281100         PERFORM DP013-0000-PROCESS-ABEND                         28110000
281200     END-IF.                                                      28120000
281300                                                                  28130000
281400*----------------------------------------------------------------*28140000
281500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28150000
281600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28160000
281700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28170000
281800*    THE TEMP QUEUE.                                             *28180000
281900*----------------------------------------------------------------*28190000
282000 6100-UPDATE-TSQ.                                                 28200000
282100                                                                  28210000
282200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             28220000
282300     PERFORM 6150-READ-SEL-QUEUE.                                 28230000
282400     PERFORM                                                      28240000
282500         VARYING SU010-IDX                                        28250000
282600         FROM 1 BY 1                                              28260000
282700         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     28270000
282800         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             28280000
282900         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  28290000
283000             PERFORM 6110-PROCESS-ITEMS                           28300000
283100         END-IF                                                   28310000
283200         ADD +1                TO PV-ITEMS-PROCESSED              28320000
283300     END-PERFORM.                                                 28330000
283400     PERFORM 6111-WRITE-LIST-QUEUE.                               28340000
283500                                                                  28350000
283600*----------------------------------------------------------------*28360000
283700*    READ THE LIST QUEUE RECORD.                                 *28370000
283800*----------------------------------------------------------------*28380000
283900 6150-READ-SEL-QUEUE.                                             28390000
284000                                                                  28400000
284100     EXEC CICS                                                    28410000
284200          READQ TS                                                28420000
284300              QUEUE (ASC-SEL-QUEUE-NAME-IN)                       28430000
284400              INTO  (SU010-SELECT-RECORD)                         28440000
284500              ITEM  (PV-SEL-QUEUE-ITEM)                           28450000
284600              RESP  (PV-CICS-RESP)                                28460000
284700     END-EXEC.                                                    28470000
284800                                                                  28480051
284900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28490000
285000         CONTINUE                                                 28500000
285100     ELSE                                                         28510000
285200         SET DP013-CICS-ABEND      TO  TRUE                       28520000
285300         SET DP013-NO-ROLLBACK     TO  TRUE                       28530000
285400         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           28540000
285500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28550000
285600                                   TO  DP013-MESSAGE-TEXT(1)      28560000
285700         PERFORM DP013-0000-PROCESS-ABEND                         28570000
285800     END-IF.                                                      28580000
285900                                                                  28590000
286000*----------------------------------------------------------------*28600000
286100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28610000
286200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28620000
286300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28630000
286400*----------------------------------------------------------------*28640000
286500 6110-PROCESS-ITEMS.                                              28650000
286600                                                                  28660000
286700     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          28670000
286800                     / PC-ITEMS-PER-PANEL).                       28680000
286900                                                                  28690000
287000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28700000
287100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28710000
287200             PERFORM 6111-WRITE-LIST-QUEUE                        28720000
287300         END-IF                                                   28730000
287400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28740000
287500                                                                  28750000
287600         PERFORM 6112-READ-LIST-QUEUE                             28760000
287700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28770000
287800             CONTINUE                                             28780000
287900         END-IF                                                   28790000
288000     END-IF.                                                      28800000
288100                                                                  28810000
288200     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     28820000
288300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28830000
288400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28840000
288500     MOVE LQW-SELECTED-SW (PV-SUB)                                28850000
288600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28860000
288700                                                                  28870000
288800     EVALUATE TRUE                                                28880000
288900         WHEN SU010-INQ (SU010-IDX)                               28890000
289000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28900000
289100                                                                  28910000
289200         WHEN SU010-UPD (SU010-IDX)                               28920000
289300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28930000
289400                                                                  28940000
289500         WHEN SU010-DEL (SU010-IDX)                               28950000
289600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28960000
289700                                                                  28970000
289800         WHEN SU010-ERR (SU010-IDX)                               28980000
289900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28990000
290000     END-EVALUATE.                                                29000000
290100                                                                  29010000
290200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29020000
290300                                                                  29030000
290400*----------------------------------------------------------------*29040000
290500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *29050000
290600*----------------------------------------------------------------*29060000
290700 6111-WRITE-LIST-QUEUE.                                           29070000
290800                                                                  29080000
290900     EXEC CICS                                                    29090000
291000         WRITEQ TS                                                29100000
291100             QUEUE (ASC-LIST-QUEUE-NAME)                          29110000
291200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29120000
291300             ITEM  (PV-SAVE-ITEM)                                 29130000
291400             REWRITE                                              29140000
291500             RESP  (PV-CICS-RESP)                                 29150000
291600     END-EXEC.                                                    29160000
291700                                                                  29170051
291800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29180000
291900         CONTINUE                                                 29190000
292000     ELSE                                                         29200000
292100         SET DP013-CICS-ABEND  TO  TRUE                           29210000
292200         SET DP013-NO-ROLLBACK TO  TRUE                           29220000
292300         MOVE '6111-WRITE-LIST-QUEUE'                             29230000
292400                               TO  DP013-PARAGRAPH                29240000
292500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  29250000
292600                               TO  DP013-MESSAGE-TEXT(1)          29260000
292700         PERFORM DP013-0000-PROCESS-ABEND                         29270000
292800     END-IF.                                                      29280000
292900                                                                  29290000
293000*----------------------------------------------------------------*29300000
293100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29310000
293200*----------------------------------------------------------------*29320000
293300 6112-READ-LIST-QUEUE.                                            29330000
293400                                                                  29340000
293500     EXEC CICS                                                    29350000
293600         READQ TS                                                 29360000
293700             QUEUE (ASC-LIST-QUEUE-NAME)                          29370000
293800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29380000
293900             ITEM  (PV-ITEM)                                      29390000
294000             RESP  (PV-CICS-RESP)                                 29400000
294100     END-EXEC.                                                    29410000
294200                                                                  29420051
294300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29430000
294400         CONTINUE                                                 29440000
294500     ELSE                                                         29450000
294600         SET DP013-CICS-ABEND        TO TRUE                      29460000
294700         SET DP013-NO-ROLLBACK       TO TRUE                      29470000
294800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29480000
294900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29490000
295000                                     TO DP013-MESSAGE-TEXT(1)     29500000
295100         PERFORM DP013-0000-PROCESS-ABEND                         29510000
295200     END-IF.                                                      29520000
295300                                                                  29530000
295400                                                                  29540051
295500 8000-WRITE-CSSL.                                                 29550000
295600                                                                  29560000
295700     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH       29570000
295800     EXEC CICS                                                    29580000
295900         WRITEQ TD                                                29590000
296000         QUEUE  ('CSSL')                                          29600000
296100         FROM  (PV-CICS-MSG-AREA)                                 29610000
296200         LENGTH  (PV-COMMAREA-LENGTH)                             29620000
296300         RESP  (PV-CICS-RESP)                                     29630000
296400     END-EXEC.                                                    29640000
296500*-----------------------------------------------------------------29650000
296600*  READ THE LIST QUEUE RECORD                                     29660000
296700*-----------------------------------------------------------------29670000
296800 9100-READ-SEL-QUEUE.                                             29680000
296900                                                                  29690000
297000     EXEC CICS                                                    29700000
297100         READQ TS                                                 29710000
297200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        29720000
297300             INTO  (SU010-SELECT-RECORD)                          29730000
297400             ITEM  (ASC-SEL-ITEM)                                 29740000
297500             RESP  (PV-CICS-RESP)                                 29750000
297600     END-EXEC.                                                    29760000
297700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        29770000
297800         CONTINUE                                                 29780000
297900     ELSE                                                         29790000
298000         SET DP013-LOGIC-ABEND                                    29800000
298100             DP013-NO-ROLLBACK   TO   TRUE                        29810000
298200         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          29820000
298300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   29830000
298400                                 TO   DP013-MESSAGE-TEXT (1)      29840000
298500         PERFORM DP013-0000-PROCESS-ABEND                         29850000
298600     END-IF.                                                      29860000
298700                                                                  29870000
298800*-----------------------------------------------------------------29880000
298900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29890000
299000*-----------------------------------------------------------------29900000
299100 9200-REWRITE-SEL-QUEUE.                                          29910000
299200                                                                  29920000
299300     EXEC CICS                                                    29930000
299400          WRITEQ TS                                               29940000
299500              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      29950000
299600              FROM   (SU010-SELECT-RECORD)                        29960000
299700              ITEM   (ASC-SEL-ITEM)                               29970000
299800              RESP   (PV-CICS-RESP)                               29980000
299900              REWRITE                                             29990000
300000     END-EXEC.                                                    30000000
300100                                                                  30010000
300200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30020000
300300         SET DP013-CICS-ABEND                                     30030000
300400             DP013-NO-ROLLBACK     TO TRUE                        30040000
300500         MOVE '9200-REWRITE-SEL-QUEUE'                            30050000
300600                                   TO DP013-PARAGRAPH             30060000
300700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30070000
300800                                   TO DP013-MESSAGE-TEXT (1)      30080000
300900         PERFORM DP013-0000-PROCESS-ABEND                         30090000
301000     END-IF.                                                      30100000
301100                                                                  30110000
301200*----------------------------------------------------------------*30120000
301300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *30130000
301400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *30140000
301500*----------------------------------------------------------------*30150000
301600 9900-SOFT-ABORT.                                                 30160000
301700                                                                  30170000
301800     EXEC CICS SYNCPOINT                                          30180000
301900          ROLLBACK                                                30190000
302000     END-EXEC.                                                    30200000
302100                                                                  30210000
302200     SET  PS-ERROR                                                30220000
302300          PS-SOFT-ABORT-ERROR                                     30230000
302400          DP020-MSG-FATAL       TO  TRUE.                         30240000
302500                                                                  30250000
302600                                                                  30260000
302700 9904-WRITE-CRTN-MODULE-MSG.                                      30270000
302800                                                                  30280000
302900     MOVE '1100'                      TO  PV-CTN-PARA             30290000
303000     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          30300000
303100     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           30310000
303200     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        30320000
303300     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      30330000
303400     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             30340000
303500     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        30350000
303600     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      30360000
303700                                                                  30370000
303800     EXEC CICS                                                    30380000
303900         WRITEQ TD                                                30390000
304000             QUEUE  ('CSSL')                                      30400000
304100             FROM   (PV-CARTON-MSG)                               30410000
304200             RESP   (PV-CICS-RESPONSE)                            30420000
304300     END-EXEC.                                                    30430000
304400                                                                  30440000
304500     EXEC CICS                                                    30450000
304600         WRITEQ TD                                                30460000
304700             QUEUE  ('CSSL')                                      30470000
304800             FROM   (PC046-CRA-RET-MSG)                           30480000
304900             RESP   (PV-CICS-RESPONSE)                            30490000
305000     END-EXEC.                                                    30500000
305100                                                                  30510000
305200*----------------------------------------------------------------*30520000
305300*    ABEND PROCESSOR MODULE                                      *30530000
305400*----------------------------------------------------------------*30540000
305500                                                                  30550000
305600     COPY DPPD013.                                                30560000
