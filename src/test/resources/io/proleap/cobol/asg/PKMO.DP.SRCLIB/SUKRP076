000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP076.                                00050000
000600 AUTHOR.                 BARB SCHULTZ.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MARCH, 2017                              00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100*                                                                 00110000
001200***************************************************************** 00120000
001300*                                                               * 00130000
001400*  THIS PROGRAM WILL CREATE THE MISLOADED CARTONS REPORTS.      * 00140000
001700*                                                               * 00170000
001900***************************************************************** 00190000
002000*                                                                 00200000
002100***************************************************************** 00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300***************************************************************** 00230000
002400                                                                  00240000
002500 CONFIGURATION SECTION.                                           00250000
002600                                                                  00260000
002700 SOURCE-COMPUTER.        IBM-3090.                                00270000
002800 OBJECT-COMPUTER.        IBM-3090.                                00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100                                                                  00310000
003200 FILE-CONTROL.                                                    00320000
003300*                                                                 00330000
003400     SELECT SU-FILE                                               00340000
003500         ASSIGN TO INP01.                                         00350000
003600                                                                  00360000
003700     SELECT SU-DTL-REPORT-FILE                                    00370000
003800         ASSIGN TO RPT01.                                         00380000
003900                                                                  00390000
003910     SELECT SU-SUM-REPORT-FILE                                    00391058
003920         ASSIGN TO RPT02.                                         00392004
003930                                                                  00393000
004000*                                                                 00400000
004100***************************************************************** 00410000
004200 DATA DIVISION.                                                   00420000
004300***************************************************************** 00430000
004400*                                                                 00440000
004500 FILE SECTION.                                                    00450000
004600*                                                                 00460000
004700 FD  SU-FILE                                                      00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0 RECORDS                                     00490000
005000     RECORD CONTAINS 131 CHARACTERS                               00500009
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     DATA RECORD IS SU-RECORD.                                    00520000
005300 01  SU-RECORD                       PIC X(131).                  00530009
005400                                                                  00540000
005500 FD  SU-DTL-REPORT-FILE                                           00550000
005600     RECORDING MODE IS F                                          00560000
005700     BLOCK CONTAINS 0  RECORDS                                    00570000
005800     RECORD CONTAINS 200 CHARACTERS                               00580008
005900     LABEL RECORDS ARE OMITTED                                    00590000
006000     DATA RECORD IS SU-DTL-REPORT-RECORD.                         00600000
006100 01  SU-DTL-REPORT-RECORD            PIC X(200).                  00610000
006101                                                                  00610100
006110 FD  SU-SUM-REPORT-FILE                                           00611000
006120     RECORDING MODE IS F                                          00612000
006130     BLOCK CONTAINS 0  RECORDS                                    00613000
006140     RECORD CONTAINS 132 CHARACTERS                               00614000
006150     LABEL RECORDS ARE OMITTED                                    00615000
006160     DATA RECORD IS SU-SUM-REPORT-RECORD.                         00616016
006170 01  SU-SUM-REPORT-RECORD            PIC X(132).                  00617000
006200*                                                                 00620000
006300*                                                                 00630000
006400 WORKING-STORAGE SECTION.                                         00640000
006500*                                                                 00650000
006600 01 WS-CALC-FIELDS.                                               00660000
006700    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         00670000
006800                                                   VALUE ZEROS.   00680000
006900    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         00690000
007000                                                   VALUE ZEROS.   00700000
007100*                                                                 00710000
007200 01  PROGRAM-SWITCHES.                                            00720000
007300     05  PS-END-OF-FILE-SW           PIC X(03)     VALUE 'N'.     00730000
007400         88  PS-END-OF-FILE                        VALUE 'Y'.     00740000
007500     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00750000
007600         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00760000
007700         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00770000
007800     05  PS-END-OF-CURSOR-SW         PIC X(03)     VALUE 'N'.     00780000
007900         88 PS-END-OF-CURSOR                       VALUE 'Y'.     00790000
008000         88 PS-NOT-END-OF-CURSOR                   VALUE 'N'.     00800000
008100     05  PS-END-OF-TABLE-SW          PIC X(03)     VALUE 'N'.     00810000
008200         88 PS-END-OF-TABLE                        VALUE 'Y'.     00820000
008300         88 PS-NOT-END-OF-TABLE                    VALUE 'N'.     00830000
008400*                                                                 00840000
008500*                                                                 00850000
008600 01  PC-CONSTANTS.                                                00860000
008700     05  PC-1                        PIC S9(03)    VALUE +1       00870000
008800                                                   COMP-3.        00880000
008900     05  PC-2                        PIC S9(03)    VALUE +2       00890000
009000                                                   COMP-3.        00900000
009100     05  PC-9                        PIC S9(03)    VALUE +9       00910000
009200                                                   COMP-3.        00920000
009300     05  PC-10                       PIC S9(03)    VALUE +10      00930000
009400                                                   COMP-3.        00940000
009500     05  PC-55                       PIC S9(03)    VALUE +55      00950000
009600                                                   COMP-3.        00960000
009700     05  PC-60                       PIC S9(03)    VALUE +60      00970000
009800                                                   COMP-3.        00980000
009801                                                                  00980172
009802* DMH 11/20/17 - BEGIN                                            00980272
009810     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         00981072
009820                                                COMP-3.           00982072
009830* DMH 11/20/17 - BEGIN                                            00983072
009840                                                                  00984072
009900     05  PC-REPORT.                                               00990004
009910         10  PC-PROGRAM-NAME         PIC  X(08)    VALUE          00991004
010000             'SUKRP076'.                                          01000004
010010         10  PC-PROG-FILLER          PIC  X(01)    VALUE '-'.     01001004
010100         10  PC-REPORT-NBR           PIC  9(01).                  01010004
010110             88  PC-DETAIL-RPT-NBR   VALUE 1.                     01011004
010120             88  PC-SUM-RPT-NBR      VALUE 2.                     01012004
010200*                                                                 01020000
010300 01 PC-PROGRAM-VARIABLES.                                         01030000
010310     05  PV-UNIT-RETAIL              PIC 9(05)V99  VALUE ZEROS.   01031056
010320     05  PV-UNIT-RETAIL-QTY          PIC 9(05)V99  VALUE ZEROS.   01032056
010410     05  PV-LINE-COUNT               PIC S9(03)    VALUE ZERO     01041072
010500                                                   COMP-3.        01050000
010510     05  PV-LINE-COUNT-RPT2          PIC S9(03)    VALUE ZERO     01051072
010520                                                   COMP-3.        01052072
010600     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01060000
010700                                                   COMP-3.        01070000
010800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01080000
010900                                                   COMP SYNC.     01090000
011000     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  01100000
011100     05  PV-DB2-OPERATION-MSG-1      PIC X(60)     VALUE SPACES.  01110000
011200     05  PV-DB2-OPERATION-MSG-2      PIC X(60)     VALUE SPACES.  01120000
011300     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  01130000
011400     05  PV-SQLCODE                  PIC Z(8)9-.                  01140000
011500                                                                  01150000
011600     05  PV-SAVE-FIELDS.                                          01160000
011700         10  PV-SAVE-LOC             PIC 9(04)     VALUE ZEROS.   01170000
012000         10  PV-PREV-SKU             PIC 9(08)     VALUE ZEROS.   01200000
012200                                                                  01220000
012300     05  PV-REPORT-FIELDS.                                        01230000
012400         10  PV-STORE-NMBR           PIC 9(04)     VALUE ZEROS.   01240000
012500         10  PV-RPT-STORE-NAME       PIC X(25)     VALUE SPACES.  01250006
012600         10  PV-RPT-TOTAL-UNITS      PIC 9(09)     VALUE ZEROS.   01260009
012700         10  PV-RPT-TOTAL-RETAIL     PIC 9(07)V99  VALUE ZEROS.   01270009
012800                                                                  01280000
012900     05  PV-REPORT-TOTALS.                                        01290000
013000         10  PV-TOTAL-UNITS          PIC 9(09)     VALUE ZEROS.   01300010
013100         10  PV-TOTAL-RETAIL         PIC 9(07)V99  VALUE ZEROS.   01310010
013200                                                                  01320000
013300     05  PV-SUMMARY-TOTALS.                                       01330000
013400         10  PV-ST-SKU-TOT           PIC S9(09)    VALUE ZEROS.   01340000
013500         10  PV-ST-UNITS             PIC S9(09)    VALUE ZEROS.   01350000
013600         10  PV-ST-RETAIL            PIC S9(09)V99 VALUE ZEROS.   01360000
013700                                                                  01370000
013800     05  PV-DATE-DDMMYY.                                          01380000
013900         10  PV-DATE-DD              PIC  X(02).                  01390000
014000         10  PV-DATE-SLASH-1         PIC  X(01).                  01400000
014100         10  PV-DATE-MM              PIC  X(02).                  01410000
014200         10  PV-DATE-SLASH-2         PIC  X(01).                  01420000
014300         10  PV-DATE-YY              PIC  X(04).                  01430000
014400     05  PV-TODAYS-DATE.                                          01440000
014500         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZEROS.   01450000
014600         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01460000
014700         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01470000
014800     05  PV-TODAYS-TIME.                                          01480000
014900         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01490000
015000         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01500000
015100         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01510000
015200         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01520000
015300     05  PV-FORMAT-DATE.                                          01530000
015400         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01540000
015500         10  FILLER                  PIC  X(01)    VALUE '/'.     01550000
015600         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01560000
015700         10  FILLER                  PIC  X(01)    VALUE '/'.     01570000
015800         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01580000
015801                                                                  01580161
015802* DMH - 08/23/17 BEGIN                                            01580261
015803     05  PV-NULL-IND                 PIC S9(04)    VALUE ZEROS    01580361
015804                                                    COMP SYNC.    01580461
015805     05  PV-SML                      PIC  X(18)    VALUE SPACES.  01580564
015806     05  PV-SCN-LOC-CARTON-COUNT     PIC  9(06)    VALUE ZEROES.  01580664
015807     05  PV-ST-CARTON-COUNT          PIC  9(09)    VALUE ZEROS.   01580769
015830* DMH - 08/23/17 END                                              01583061
015900                                                                  01590000
016000 01  CORPORATE-SUMMARY-TABLE.                                     01600000
016100     05  SUMMARY-TABLE  OCCURS 9999 TIMES INDEXED BY SC-IDX.      01610053
016200         10  SUMMARY-SCLOC-NBR       PIC  9(04).                  01620006
016300         10  SUMMARY-SCLOC-NAME      PIC  X(25).                  01630006
016310         10  SUMMARY-BTCH-NBR        PIC  X(04).                  01631007
016330         10  SUMMARY-DATE            PIC  X(10).                  01633054
016400         10  SUMMARY-SKU-CNT         PIC  9(09).                  01640000
016500         10  SUMMARY-TOTAL-UNITS     PIC  9(09).                  01650009
016600         10  SUMMARY-TOTAL-RETAIL    PIC  9(09)V99.               01660009
016700         10  SUMMARY-LOC-TYPE-CDE    PIC  X(02).                  01670000
016701* DMH 08/23/17 BEGIN                                              01670161
016710         10  SUMMARY-DC-NBR          PIC  9(04).                  01671061
016711         10  SUMMARY-CARTON-COUNT    PIC  9(07).                  01671161
016720* DMH 08/23/17 END                                                01672061
016800                                                                  01680000
016900*   RECORD LAYOUT FOR INPUT FILE                                  01690000
017000     COPY SURD151.                                                01700005
017100                                                                  01710000
017200*   RECORD LAYOUT FOR CALLING XLKUT071                            01720000
017300     COPY XLWS071.                                                01730000
017400                                                                  01740000
017500                                                                  01750000
017600******************************************************************01760000
017700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01770000
017800******************************************************************01780000
017900     COPY DPWS132O.                                               01790000
018000*                                                                 01800000
018010******************************************************************01801000
018020*  WORK FIELDS FOR PRINTING A 200 CHARACTER REPORT.               01802000
018030******************************************************************01803000
018040     COPY DPWS200O.                                               01804000
018050*                                                                 01805000
018100 01  WS-BATCH-PROC-DATE.                                          01810000
018200     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACES.  01820000
018300     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACES.  01830000
018400     05  FILLER                      PIC X(01)     VALUE SPACES.  01840000
018500     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACES.  01850000
018600     05  FILLER                      PIC X(01)     VALUE SPACES.  01860000
018700     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACES.  01870000
018800*                                                                 01880000
018900*                                                                 01890000
019000 01  HEADING-LINE1.                                               01900000
019100     05  FILLER                  PIC  X(81)    VALUE SPACES.      01910047
019200     05  FILLER                  PIC  X(29)    VALUE              01920002
019300         'MISLOADED CARTONS REPORT FOR '.                         01930000
019400     05  HL1-BTCH-PRC-DTE.                                        01940000
019500         10  HL1-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      01950000
019600         10  FILLER              PIC  X(01)    VALUE '/'.         01960000
019700         10  HL1-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      01970000
019800         10  FILLER              PIC  X(01)    VALUE '/'.         01980000
019900         10  HL1-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      01990000
020000         10  HL1-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      02000000
020100     05  FILLER                  PIC  X(26)    VALUE SPACES.      02010023
020200*                                                                 02020000
020300 01  HEADING-LINE2.                                               02030000
020400     05  FILLER                  PIC  X(90)    VALUE SPACES.      02040047
020500     05  FILLER                  PIC  X(15)    VALUE              02050000
020600         'BATCH NUMBER:  '.                                       02060000
020700     05  HL2-BTCH-NBR            PIC  9(04)    VALUE ZEROS.       02070013
020800     05  FILLER                  PIC  X(50)    VALUE SPACES.      02080023
020900*                                                                 02090000
021000 01  HEADING-LINE3.                                               02100000
021100     05  FILLER                  PIC  X(01)    VALUE SPACES.      02110000
021200     05  FILLER                  PIC  X(16)    VALUE              02120000
021300         'SCAN LOCATION:  '.                                      02130000
021400     05  HL3-SCAN-LOC            PIC  ZZ99     VALUE ZEROS.       02140006
021500     05  FILLER                  PIC  X(01)    VALUE SPACES.      02150000
021600     05  HL3-STORE-NAME          PIC  X(25)    VALUE SPACES.      02160006
021700     05  FILLER                  PIC  X(87)    VALUE SPACES.      02170000
021800                                                                  02180000
021900 01  HEADING-LINE4.                                               02190000
022100     05  FILLER                  PIC  X(09)    VALUE              02210027
022200         'SCAN BTCH'.                                             02220027
022300     05  FILLER                  PIC  X(25)    VALUE SPACES.      02230028
022400     05  FILLER                  PIC  X(03)    VALUE              02240000
022500         'SML'.                                                   02250000
022600     05  FILLER                  PIC  X(13)    VALUE SPACES.      02260028
022700     05  FILLER                  PIC  X(11)    VALUE              02270000
022800         'SML    SCAN'.                                           02280000
022900     05  FILLER                  PIC  X(10)    VALUE SPACES.      02290000
023000     05  FILLER                  PIC  X(04)    VALUE              02300000
023100         'ORIG'.                                                  02310000
023200     05  FILLER                  PIC  X(05)    VALUE SPACES.      02320029
023300     05  FILLER                  PIC  X(27)    VALUE              02330000
023400         'DEPT   MAJOR    SUB     SKU'.                           02340000
023500     05  FILLER                  PIC  X(15)    VALUE SPACES.      02350040
023600     05  FILLER                  PIC  X(03)    VALUE              02360000
023700         'SKU'.                                                   02370000
023800     05  FILLER                  PIC  X(28)    VALUE SPACES.      02380038
023900     05  FILLER                  PIC  X(39)    VALUE              02390035
024000         'RCVR SEQ   LINE   NBR OF      RETAIL'.                  02400038
024200                                                                  02420000
024300 01  HEADING-LINE5.                                               02430000
024500     05  FILLER                  PIC  X(17)    VALUE              02450027
024600         'LOC  NBR     DATE'.                                     02460027
024700     05  FILLER                  PIC  X(06)    VALUE SPACES.      02470000
024800     05  FILLER                  PIC  X(18)    VALUE              02480027
024900         'STORE      NUMBER'.                                     02490000
025000     05  FILLER                  PIC  X(09)    VALUE SPACES.      02500000
025100     05  FILLER                  PIC  X(13)    VALUE              02510000
025200         'TYPE  TRIP ID'.                                         02520000
025300     05  FILLER                  PIC  X(06)    VALUE SPACES.      02530031
025400     05  FILLER                  PIC  X(38)    VALUE              02540033
025500         'TRIP ID    NBR    CLASS   CLASS    NBR'.                02550031
025600     05  FILLER                  PIC  X(11)    VALUE SPACES.      02560040
025700     05  FILLER                  PIC  X(11)    VALUE              02570000
025800         'DESCRIPTION'.                                           02580000
025900     05  FILLER                  PIC  X(16)    VALUE SPACES.      02590033
025910     05  FILLER                  PIC  X(31)    VALUE              02591039
025920         'PO NBR     NBR     NBR    UNITS'.                       02592038
025930     05  FILLER                  PIC  X(08)    VALUE SPACES.      02593000
025940     05  FILLER                  PIC  X(06)    VALUE              02594033
025950         'VALUE'.                                                 02595033
026000                                                                  02600000
028400*                                                                 02840000
028500******************************************************************02850000
028600*    THESE LINES WILL BE USED FOR THE SUMMARY REPORT.            *02860000
028700******************************************************************02870000
028710 01  HEADING-LINE7.                                               02871002
028720     05  FILLER                  PIC  X(43)    VALUE SPACES.      02872046
028730     05  FILLER                  PIC  X(37)    VALUE              02873025
028740         'MISLOADED CARTONS SUMMARY REPORT FOR '.                 02874002
028750     05  HL7-BTCH-PRC-DTE.                                        02875010
028760         10  HL7-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      02876010
028770         10  FILLER              PIC  X(01)    VALUE '/'.         02877002
028780         10  HL7-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      02878010
028790         10  FILLER              PIC  X(01)    VALUE '/'.         02879002
028791         10  HL7-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      02879110
028792         10  HL7-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      02879210
028793     05  FILLER                  PIC  X(36)    VALUE SPACES.      02879325
029300*                                                                 02930000
029400 01  HEADING-LINE8.                                               02940000
029500     05  FILLER                  PIC  X(36)    VALUE SPACES.      02950042
029510* DMH - 08/23/17 BEGIN                                            02951062
029600     05  FILLER                  PIC  X(04)    VALUE              02960002
029700         ' DC '.                                                  02970062
029800     05  FILLER                  PIC  X(03)    VALUE SPACES.      02980062
029801* DMH - 08/23/17 END                                              02980162
029810     05  FILLER                  PIC  X(04)    VALUE              02981062
029820         'BTCH'.                                                  02982062
029830     05  FILLER                  PIC  X(19)    VALUE SPACES.      02983062
029840* DMH - 08/23/17 BEGIN                                            02984062
029900     05  FILLER                  PIC  X(07)    VALUE              02990062
030000         ' CARTON'.                                               03000062
030100     05  FILLER                  PIC  X(05)    VALUE SPACES.      03010062
030101* DMH - 08/23/17 END                                              03010162
030102     05  FILLER                  PIC  X(09)    VALUE              03010262
030103         'NUMBER OF'.                                             03010362
030104     05  FILLER                  PIC  X(06)    VALUE SPACES.      03010462
030110     05  FILLER                  PIC  X(09)    VALUE              03011002
030120         'NUMBER OF'.                                             03012002
030130     05  FILLER                  PIC  X(12)    VALUE SPACES.      03013002
030200     05  FILLER                  PIC  X(06)    VALUE              03020002
030300         'RETAIL'.                                                03030002
030800*                                                                 03080000
030900 01  HEADING-LINE9.                                               03090000
031100     05  FILLER                  PIC  X(15)    VALUE              03110002
031200         'SCAN   LOCATION'.                                       03120002
031300     05  FILLER                  PIC  X(21)    VALUE SPACE.       03130042
031400* DMH - 08/23/17 BEGIN                                            03140062
031800     05  FILLER                  PIC  X(04)    VALUE              03180062
031900         ' NBR'.                                                  03190062
032000     05  FILLER                  PIC  X(03)    VALUE SPACES.      03200062
032001* DMH - 08/23/17 END                                              03200162
032010     05  FILLER                  PIC  X(03)    VALUE              03201062
032020         'NBR'.                                                   03202062
032030     05  FILLER                  PIC  X(06)    VALUE SPACES.      03203062
032100     05  FILLER                  PIC  X(04)    VALUE              03210002
032200         'DATE'.                                                  03220002
032300     05  FILLER                  PIC  X(11)    VALUE SPACES.      03230062
032301* DMH - 08/23/17 BEGIN                                            03230162
032302     05  FILLER                  PIC  X(05)    VALUE              03230262
032303         'COUNT'.                                                 03230362
032304     05  FILLER                  PIC  X(08)    VALUE SPACES.      03230471
032305* DMH - 08/23/17 END                                              03230562
032310     05  FILLER                  PIC  X(03)    VALUE              03231003
032320         'SKU'.                                                   03232003
032330     05  FILLER                  PIC  X(01)    VALUE              03233003
032331         "'".                                                     03233103
032332     05  FILLER                  PIC  X(01)    VALUE              03233203
032333         'S'.                                                     03233303
032334     05  FILLER                  PIC  X(10)    VALUE SPACES.      03233403
032340     05  FILLER                  PIC  X(05)    VALUE              03234002
032350         'UNITS'.                                                 03235002
032360     05  FILLER                  PIC  X(14)    VALUE SPACES.      03236002
032370     05  FILLER                  PIC  X(05)    VALUE              03237002
032380         'VALUE'.                                                 03238002
032390     05  FILLER                  PIC  X(39)    VALUE SPACES.      03239002
032400*                                                                 03240000
032500 01  REPORT-DETAIL-LINE.                                          03250000
032900     05  DL1-SCAN-LOC            PIC  ZZ99     VALUE ZEROES.      03290008
033000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03300002
033200     05  DL1-BTCH-NBR            PIC  X(04)    VALUE SPACES.      03320002
033300     05  FILLER                  PIC  X(01)    VALUE SPACES.      03330002
033500     05  DL1-DATE                PIC  X(10)    VALUE SPACES.      03350002
033510     05  FILLER                  PIC  X(03)    VALUE SPACES.      03351002
033600     05  DL1-ORIG-STORE          PIC  X(04)    VALUE SPACES.      03360002
033800     05  FILLER                  PIC  X(02)    VALUE SPACES.      03380002
033900     05  DL1-SML-NUMBER          PIC  X(18)    VALUE SPACES.      03390002
034000     05  FILLER                  PIC  X(03)    VALUE SPACES.      03400002
034100     05  DL1-SML-TYPE            PIC  X(03)    VALUE SPACES.      03410002
034200     05  FILLER                  PIC  X(03)    VALUE SPACES.      03420002
034400     05  DL1-SCAN-TRIP-ID        PIC  X(09)    VALUE SPACES.      03440002
034500     05  FILLER                  PIC  X(03)    VALUE SPACES.      03450002
034700     05  DL1-ORIG-TRIP-ID        PIC  X(09)    VALUE SPACES.      03470002
034710     05  FILLER                  PIC  X(03)    VALUE SPACES.      03471002
034800     05  DL1-DEPT-NBR            PIC  X(04)    VALUE SPACES.      03480002
034900     05  FILLER                  PIC  X(04)    VALUE SPACES.      03490029
035000     05  DL1-MAJOR-CLASS         PIC  X(04)    VALUE SPACES.      03500002
035100     05  FILLER                  PIC  X(04)    VALUE SPACES.      03510030
035110     05  DL1-SUB-CLASS           PIC  X(04)    VALUE SPACES.      03511002
035120     05  FILLER                  PIC  X(02)    VALUE SPACES.      03512036
035130     05  DL1-SKU-NBR             PIC  X(08)    VALUE SPACES.      03513002
035140     05  FILLER                  PIC  X(02)    VALUE SPACES.      03514040
035200     05  DL1-SKU-DESC            PIC  X(30)    VALUE SPACES.      03520002
035300     05  FILLER                  PIC  X(01)    VALUE SPACES.      03530036
035400     05  DL1-PO-NBR              PIC  Z99999999 VALUE ZEROES.     03540007
035600     05  FILLER                  PIC  X(04)    VALUE SPACES.      03560034
035700     05  DL1-RCVR-SEQ-NBR        PIC  ZZZ9     VALUE ZEROES.      03570007
035810     05  FILLER                  PIC  X(04)    VALUE SPACES.      03581034
035820     05  DL1-LINE-NBR            PIC  ZZZ9     VALUE ZEROES.      03582007
035830     05  FILLER                  PIC  X(04)    VALUE SPACES.      03583034
035840     05  DL1-NBR-OF-UNITS        PIC  ZZZ9     VALUE ZEROES.      03584008
035850     05  FILLER                  PIC  X(04)    VALUE SPACES.      03585034
035860     05  DL1-RETAIL-VALUE        PIC  ZZZ,ZZZ.99 VALUE ZEROES.    03586007
036000*                                                                 03600000
036100 01  REPORT-TOTALS-LINE.                                          03610003
036200     05  FILLER                  PIC  X(67)    VALUE SPACES.      03620003
036300     05  FILLER                  PIC  X(29)    VALUE              03630003
036400         'SCAN LOCATION TOTALS:        '.                         03640003
036500     05  TL1-TOTAL-UNITS         PIC  ZZZ,ZZZ,ZZ9                 03650003
036600         VALUE ZEROS.                                             03660003
036700     05  FILLER                  PIC  X(07)    VALUE SPACES.      03670003
036800     05  TL1-TOTAL-RETAIL        PIC  Z,ZZZ,ZZZ.99                03680003
036900         VALUE ZEROS.                                             03690000
037000     05  FILLER                  PIC  X(13)    VALUE SPACES.      03700000
037100*                                                                 03710000
037200 01  SUMMARY-DETAIL-LINE.                                         03720000
037400     05  DL2-SCAN-STORE-NBR      PIC  ZZ99     VALUE ZEROS.       03740003
037500     05  FILLER                  PIC  X(03)    VALUE SPACES.      03750003
037600     05  DL2-STORE-NAME          PIC  X(25)    VALUE SPACES.      03760003
037610* DMH - 08/23/17 BEGIN                                            03761062
037700     05  FILLER                  PIC  X(04)    VALUE SPACES.      03770045
037710     05  DL2-DC-NBR              PIC  Z(04)    VALUE ZEROES.      03771062
037720* DMH - 08/23/17 END                                              03772062
037721     05  FILLER                  PIC  X(03)    VALUE SPACES.      03772170
037722     05  DL2-BTCH-NBR            PIC  X(04)    VALUE SPACES.      03772262
037723     05  FILLER                  PIC  X(04)    VALUE SPACES.      03772370
037730     05  DL2-DATE                PIC  X(10)    VALUE SPACES.      03773003
037740     05  FILLER                  PIC  X(05)    VALUE SPACES.      03774062
037750* DMH - 08/23/17 BEGIN                                            03775062
037751     05  DL2-CARTON-COUNT        PIC  ZZZ,ZZ9  VALUE ZEROES.      03775162
037752     05  FILLER                  PIC  X(05)    VALUE SPACES.      03775262
037760* DMH - 08/23/17 END                                              03776062
037800     05  DL2-SKU-CNT             PIC  ZZZ,ZZ9  VALUE ZEROS.       03780003
037900     05  FILLER                  PIC  X(05)    VALUE SPACES.      03790045
038000     05  DL2-TOTAL-UNITS         PIC  ZZZ,ZZZ,ZZ9                 03800003
038100         VALUE ZEROS.                                             03810000
038200     05  FILLER                  PIC  X(07)    VALUE SPACES.      03820045
038300     05  DL2-TOTAL-RETAIL        PIC  Z,ZZZ,ZZZ.99                03830003
038400         VALUE ZEROS.                                             03840000
038600                                                                  03860000
038700 01  SUMMARY-TOTALS-LINE.                                         03870000
038800     05  FILLER                  PIC  X(35)    VALUE SPACES.      03880044
038900     05  FILLER                  PIC  X(22)    VALUE              03890000
039000         'CORPORATE TOTALS:     '.                                03900000
039010* DMH - 08/23/17 BEGIN                                            03901066
039011     05  FILLER                  PIC  X(07)      VALUE SPACES.    03901167
039020     05  TL2-CARTON-COUNT        PIC  Z,ZZZ,ZZ9  VALUE ZEROES.    03902066
039030     05  FILLER                  PIC  X(03)      VALUE SPACES.    03903066
039040* DMH - 08/23/17 END                                              03904066
039100     05  TL2-SKU-CNT             PIC  Z,ZZZ,ZZ9 VALUE ZEROS.      03910003
039200     05  FILLER                  PIC  X(03)    VALUE SPACES.      03920043
039300     05  TL2-TOTAL-TOTAL-UNITS   PIC  Z,ZZZ,ZZZ,ZZ9               03930009
039400         VALUE ZEROS.                                             03940000
039500     05  FILLER                  PIC  X(05)    VALUE SPACES.      03950044
039600     05  TL2-TOTAL-TOTAL-RETAIL  PIC  ZZZ,ZZZ,ZZZ.99              03960009
039700         VALUE ZEROS.                                             03970000
039900                                                                  03990000
040000 01  BL-BLANK-LINE                   PIC X(132)    VALUE SPACES.  04000000
040100                                                                  04010000
040200 01  MISCELLANEOUS-LINES.                                         04020000
040800     05  NO-DATA-TO-REPORT-LINE.                                  04080000
040900         10  FILLER                  PIC  X(40)    VALUE SPACES.  04090000
041000         10  FILLER                  PIC  X(52)    VALUE          04100000
041100         '*******  N O   D A T A   T O   R E P O R T   *******'.  04110000
041200         10  FILLER                  PIC  X(40)    VALUE SPACES.  04120000
041300*                                                                 04130000
041400*  DB2 AREA FOR XLT_LOC (STORE TABLE - XLT00010)                  04140000
041500                                                                  04150000
041600     EXEC SQL                                                     04160000
041700          INCLUDE XLT00010                                        04170000
041800     END-EXEC.                                                    04180000
041900                                                                  04190000
041901*-----------------------------------------------------------------04190161
041910*  DB2 AREA FOR XLT_DC_LOC_ASGMT (STORE TABLE - XLT00014)         04191061
041911*  DMH 8/23/17                                                    04191161
041912*-----------------------------------------------------------------04191261
041920                                                                  04192061
041930     EXEC SQL                                                     04193061
041940          INCLUDE XLT00014                                        04194061
041950     END-EXEC.                                                    04195061
041960                                                                  04196061
042000*** DB2 MESSAGE AREAS ****                                        04200000
042100     COPY DPWS004.                                                04210000
042200*                                                                 04220000
042300*                                                                 04230000
042400*    DB2 AREA FOR COMMUNICATIONS                                  04240000
042500                                                                  04250000
042600     EXEC SQL                                                     04260000
042700          INCLUDE SQLCA                                           04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000*    DB2 AREA FOR COMMUNICATIONS AREA2                            04300000
043100                                                                  04310000
043200     COPY SQLCA2.                                                 04320000
043300                                                                  04330000
043400     EXEC SQL                                                     04340000
043500         DECLARE SC_CSR CURSOR FOR                                04350006
043600             SELECT T1.LOC_NBR                                    04360061
043700                  , T1.LOC_NM                                     04370061
043800                  , T1.LOC_TYP_CDE                                04380061
044010                  , T2.DC_NBR                                     04401061
044020               FROM                                               04402061
044030               (SELECT  A.LOC_NBR                                 04403061
044040                     ,  A.LOC_NM                                  04404061
044050                     ,  A.LOC_TYP_CDE                             04405061
044080                  FROM  XLT_LOC A                                 04408061
044090                 WHERE  A.LOC_TYP_CDE IN ('DS', 'CS')             04409061
044091                 ORDER BY A.LOC_NBR                               04409161
044092               ) AS T1                                            04409261
044093                 LEFT OUTER JOIN                                  04409361
044094               (SELECT  AA.LOC_NBR                                04409461
044095                     ,  BB.DC_NBR                                 04409561
044097                  FROM  XLT_LOC AA                                04409761
044098                     ,  XLT_DC_LOC_ASGMT BB                       04409861
044099                 WHERE  AA.LOC_TYP_CDE IN ('DS', 'CS')            04409961
044100                   AND  AA.OPN_DTE  <= CURRENT DATE               04410061
044101                   AND  AA.CLO_DTE  >= CURRENT DATE               04410161
044102                   AND  AA.LOC_NBR      =  BB.LOC_NBR             04410261
044103                   AND  BB.EFF_BEG_DTE IN                         04410361
044104                       (SELECT MAX(CC.EFF_BEG_DTE)                04410461
044105                          FROM XLT_DC_LOC_ASGMT CC                04410561
044106                         WHERE BB.LOC_NBR      =  CC.LOC_NBR      04410661
044107                           AND CC.EFF_BEG_DTE <= CURRENT DATE)    04410761
044108                 ORDER BY AA.LOC_NBR                              04410861
044109               ) AS T2                                            04410961
044110                 ON T1.LOC_NBR  =  T2.LOC_NBR                     04411061
044111               ORDER BY 1                                         04411161
044200     END-EXEC.                                                    04420000
044300                                                                  04430000
044400******************************************************************04440000
044500 PROCEDURE DIVISION.                                              04450000
044600******************************************************************04460000
044700*                                                                 04470000
044800******************************************************************04480000
044900**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                    **04490000
045000******************************************************************04500000
045100 0000-MAINLINE-PROCESSING.                                        04510000
045200     PERFORM 1000-INITIALIZE.                                     04520000
045300*                                                                 04530000
045400     IF  PS-END-OF-FILE                                           04540000
045500         NEXT SENTENCE                                            04550000
045600     ELSE                                                         04560000
045700         SET PS-FIRST-TIME-NO TO TRUE                             04570000
045800         PERFORM 2000-MAIN-PROCESS                                04580000
045900           UNTIL  PS-END-OF-FILE                                  04590000
045910         PERFORM 5010-UPDATE-SCAN-LOC-CRTN-CNT                    04591068
046000     END-IF.                                                      04600000
046100*                                                                 04610000
046200*                                                                 04620000
046300     PERFORM 9000-END-PROCESS.                                    04630000
046400*                                                                 04640000
046500     DISPLAY 'NUMBER OF RECORDS READ IS:     '                    04650000
046600         WS-RECORDS-READ-QTY.                                     04660000
046700     DISPLAY 'NUMBER OF RECORDS WRITTEN IS:  '                    04670000
046800         WS-RECORDS-WRITE-QTY.                                    04680000
046900*                                                                 04690000
047000     STOP RUN.                                                    04700000
047100*                                                                 04710000
047200*                                                                 04720000
047300******************************************************************04730000
047400**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM. **            04740000
047500******************************************************************04750000
047600 1000-INITIALIZE.                                                 04760000
047700     OPEN INPUT  SU-FILE                                          04770000
047800          OUTPUT SU-DTL-REPORT-FILE                               04780004
047840                 SU-SUM-REPORT-FILE.                              04784004
047900                                                                  04790000
048000     ACCEPT PV-TODAYS-DATE FROM DATE.                             04800000
048100     ACCEPT PV-TODAYS-TIME FROM TIME.                             04810000
048200*                                                                 04820000
048300     PERFORM 1200-INITIALIZE-HEADINGS.                            04830000
048400                                                                  04840000
048500*READ FIRST INPUT RECORD.                                         04850000
048600     PERFORM 7000-READ-EXTRACT.                                   04860000
048700     SET PS-FIRST-TIME-YES TO TRUE.                               04870000
048800     PERFORM 6999-PRINT-REPORT-HEADINGS.                          04880000
048900     MOVE SU151-SCAN-LOC TO PV-SAVE-LOC.                          04890006
049000*                                                                 04900000
049100     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       04910000
049200     PERFORM 1020-LOAD-SUMMARY-TABLE.                             04920000
049300*                                                                 04930000
049400*                                                                 04940000
049500******************************************************************04950000
049600*   INITIALIZE SUMMARY TABLE.                                    *04960000
049700******************************************************************04970000
049800 1010-INITIALIZE-SUMMARY-TABLE.                                   04980000
049900                                                                  04990000
050000     INITIALIZE CORPORATE-SUMMARY-TABLE.                          05000000
050100*                                                                 05010000
050200******************************************************************05020000
050300*   LOAD SUMMARY TABLE.                                          *05030000
050400******************************************************************05040000
050500 1020-LOAD-SUMMARY-TABLE.                                         05050000
050600     EXEC SQL                                                     05060000
050700         OPEN SC_CSR                                              05070006
050800     END-EXEC.                                                    05080000
050900                                                                  05090000
051000     EVALUATE TRUE                                                05100000
051100         WHEN SQLCODE = ZERO                                      05110000
051200             CONTINUE                                             05120000
051300         WHEN OTHER                                               05130000
051400             MOVE SQLCODE TO PV-SQLCODE                           05140000
051500             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05150000
051600             STRING 'SQL ERROR OPENING CURSOR - '                 05160000
051700                     PV-SQLCODE                                   05170000
051800                     DELIMITED BY SIZE                            05180000
051900                     INTO PV-DB2-OPERATION-MSG-1                  05190000
052000             PERFORM 9998-SQL-ABEND                               05200000
052100     END-EVALUATE.                                                05210000
052200                                                                  05220000
052300     PERFORM 1030-FETCH-CURSOR.                                   05230000
052400                                                                  05240000
052500     PERFORM VARYING SC-IDX FROM 1 BY 1                           05250006
052600         UNTIL SC-IDX > 9999 OR PS-END-OF-CURSOR                  05260053
052700         MOVE XLT00010-LOC-NBR    TO SUMMARY-SCLOC-NBR (SC-IDX)   05270006
052800         MOVE XLT00010-LOC-NM     TO SUMMARY-SCLOC-NAME (SC-IDX)  05280006
052900         MOVE XLT00010-LOC-TYP-CDE TO                             05290000
052910                               SUMMARY-LOC-TYPE-CDE (SC-IDX)      05291006
052911* DMH 08/23/17 BEGIN                                              05291161
052912         MOVE XLT00014-DC-NBR     TO  SUMMARY-DC-NBR (SC-IDX)     05291261
052913         MOVE ZEROES              TO                              05291361
052914                               SUMMARY-CARTON-COUNT (SC-IDX)      05291461
052915* DMH 08/23/17 BEGIN                                              05291561
052920                                                                  05292000
052930         PERFORM 1030-FETCH-CURSOR                                05293000
052940     END-PERFORM.                                                 05294000
052950                                                                  05295000
052960     EXEC SQL                                                     05296000
052970         CLOSE SC_CSR                                             05297006
052980     END-EXEC.                                                    05298000
052990                                                                  05299000
053000     EVALUATE TRUE                                                05300000
053100         WHEN SQLCODE = ZERO                                      05310000
053200             CONTINUE                                             05320000
053300         WHEN OTHER                                               05330000
053400             MOVE SQLCODE TO PV-SQLCODE                           05340000
053500             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05350000
053600             STRING 'SQL ERROR CLOSING CURSOR - '                 05360000
053700                     PV-SQLCODE                                   05370000
053800                     DELIMITED BY SIZE                            05380000
053900                     INTO PV-DB2-OPERATION-MSG-1                  05390000
054000             PERFORM 9998-SQL-ABEND                               05400000
054100     END-EVALUATE.                                                05410000
054200                                                                  05420000
054300*                                                                 05430000
054400 1030-FETCH-CURSOR.                                               05440000
054500     EXEC SQL                                                     05450000
054600         FETCH SC_CSR                                             05460006
054700          INTO :XLT00010-LOC-NBR                                  05470000
054800             , :XLT00010-LOC-NM                                   05480000
054900             , :XLT00010-LOC-TYP-CDE                              05490000
054910             , :XLT00014-DC-NBR  :PV-NULL-IND                     05491061
055000     END-EXEC.                                                    05500000
055100                                                                  05510000
055200     EVALUATE TRUE                                                05520000
055300         WHEN SQLCODE = ZERO                                      05530000
055320              IF  PV-NULL-IND  =  -1                              05532063
055400                  MOVE  ZEROES  TO  XLT00014-DC-NBR               05540061
055410              END-IF                                              05541061
055420                                                                  05542061
055500         WHEN SQLCODE = +100                                      05550000
055600             SET PS-END-OF-CURSOR TO TRUE                         05560000
055700         WHEN OTHER                                               05570000
055800             MOVE SQLCODE TO PV-SQLCODE                           05580000
055900             MOVE '1030-FETCH-CURSOR' TO PV-ABEND-PARA-NAME       05590000
056000             STRING 'SQL ERROR FETCHING DATA - '                  05600000
056100                     PV-SQLCODE                                   05610000
056200                     DELIMITED BY SIZE                            05620000
056300                     INTO PV-DB2-OPERATION-MSG-1                  05630000
056400             PERFORM 9998-SQL-ABEND                               05640000
056500     END-EVALUATE.                                                05650000
056600*                                                                 05660000
056700*                                                                 05670000
056800******************************************************************05680000
056900*   INITIALIZE REPORT HEADINGS.                                  *05690000
057000******************************************************************05700000
057100 1200-INITIALIZE-HEADINGS.                                        05710000
057200     MOVE PV-TODAYS-DATE-YY      TO DP200O-RUN-YEAR.              05720017
057300     MOVE PV-TODAYS-DATE-MM      TO DP200O-RUN-MONTH.             05730017
057400     MOVE PV-TODAYS-DATE-DD      TO DP200O-RUN-DAY.               05740017
057500     MOVE PV-TODAYS-TIME-HH      TO DP200O-RUN-HOUR.              05750017
057600     MOVE PV-TODAYS-TIME-MM      TO DP200O-RUN-MINUTE.            05760017
057700     MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          05770017
057800     SET  PC-DETAIL-RPT-NBR      TO TRUE.                         05780004
057801     MOVE PC-REPORT-NBR          TO DP200O-REPORT-NUMBER.         05780117
057810                                                                  05781004
057820     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              05782017
057830     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             05783017
057840     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               05784017
057850     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              05785017
057860     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            05786017
057870     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          05787017
057880     SET  PC-SUM-RPT-NBR         TO TRUE.                         05788017
057890     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         05789017
057891                                                                  05789117
057900*                                                                 05790000
058000*                                                                 05800000
058100******************************************************************05810000
058200*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *05820000
058300*  MISLOADED CARTONS REPORT.                                     *05830017
058400******************************************************************05840000
058500 2000-MAIN-PROCESS.                                               05850000
058600     IF PV-SAVE-LOC = SU151-SCAN-LOC                              05860006
058700        CONTINUE                                                  05870000
058800     ELSE                                                         05880000
058810        PERFORM 5010-UPDATE-SCAN-LOC-CRTN-CNT                     05881064
058900        MOVE PV-SAVE-LOC TO HL3-SCAN-LOC                          05890006
059000        ADD  1                       TO PV-PAGE-COUNT             05900000
059100        MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER        05910000
059200        PERFORM 6850-PRINT-REPORT-TOTALS                          05920000
059300        MOVE SU151-SCAN-LOC TO PV-SAVE-LOC                        05930006
059400        PERFORM 6999-PRINT-REPORT-HEADINGS                        05940000
059500     END-IF.                                                      05950000
059600                                                                  05960000
059700     PERFORM 3000-PROCESS-DETAIL-RECORD.                          05970000
059800                                                                  05980000
059900*READ NEXT INPUT RECORD.                                          05990000
060000     ADD  +1                    TO WS-RECORDS-WRITE-QTY.          06000000
060100     PERFORM 7000-READ-EXTRACT.                                   06010000
060200     ADD  +1                    TO WS-RECORDS-READ-QTY.           06020000
060300*                                                                 06030000
060400*                                                                 06040000
060500 3000-PROCESS-DETAIL-RECORD.                                      06050000
060700                                                                  06070004
060820     MOVE SU151-SCAN-LOC         TO DL1-SCAN-LOC.                 06082007
060821     MOVE SU151-BTCH-NBR         TO DL1-BTCH-NBR.                 06082109
060822     MOVE SU151-ORIG-STORE       TO DL1-ORIG-STORE.               06082207
060826     MOVE SU151-SML-NUMBER       TO DL1-SML-NUMBER.               06082607
060827     MOVE SU151-SML-TYPE         TO DL1-SML-TYPE.                 06082707
060828     MOVE SU151-ORIG-TRIP-ID     TO DL1-ORIG-TRIP-ID.             06082807
060829     MOVE SU151-SCAN-TRIP-ID     TO DL1-SCAN-TRIP-ID.             06082907
060830     MOVE SU151-DEPT-NBR         TO DL1-DEPT-NBR.                 06083007
060900     MOVE SU151-MAJOR-CL         TO DL1-MAJOR-CLASS.              06090009
061000     MOVE SU151-SUB-CL           TO DL1-SUB-CLASS.                06100007
061100     MOVE SU151-SKU-NBR          TO DL1-SKU-NBR.                  06110007
061300     MOVE SU151-SKU-DESC         TO DL1-SKU-DESC.                 06130007
061400     MOVE SU151-DATE             TO DL1-DATE.                     06140007
062200     MOVE SU151-PO-NBR           TO DL1-PO-NBR.                   06220007
062201     MOVE SU151-RCVR-SEQ-NBR     TO DL1-RCVR-SEQ-NBR.             06220155
062300     MOVE SU151-LINE-NBR         TO DL1-LINE-NBR.                 06230007
062400*                                                                 06240007
062500     MOVE SU151-UNITS            TO DL1-NBR-OF-UNITS.             06250007
062600     MOVE SU151-UNITS            TO PV-RPT-TOTAL-UNITS.           06260009
062700     ADD SU151-UNITS             TO PV-ST-UNITS.                  06270007
062800     ADD PV-RPT-TOTAL-UNITS      TO PV-TOTAL-UNITS.               06280010
062900     MOVE ZEROS                  TO PV-RPT-TOTAL-UNITS.           06290009
063000*                                                                 06300000
063100     MOVE SU151-RETAIL-AMT       TO PV-UNIT-RETAIL.               06310056
063101     MULTIPLY PV-UNIT-RETAIL  BY SU151-UNITS                      06310156
063102          GIVING PV-UNIT-RETAIL-QTY                               06310256
063110     MOVE PV-UNIT-RETAIL-QTY     TO DL1-RETAIL-VALUE.             06311056
063200     MOVE PV-UNIT-RETAIL-QTY     TO PV-RPT-TOTAL-RETAIL.          06320056
063300     ADD PV-UNIT-RETAIL-QTY      TO PV-ST-RETAIL.                 06330056
063400     ADD PV-RPT-TOTAL-RETAIL     TO PV-TOTAL-RETAIL.              06340010
063500     MOVE ZEROS                  TO PV-RPT-TOTAL-RETAIL.          06350009
063600*                                                                 06360000
063610* DMH 08/23/17 - BEGIN                                            06361064
063612     IF  SU151-SML-NUMBER  =  PV-SML                              06361264
063613         CONTINUE                                                 06361364
063614     ELSE                                                         06361464
063615         ADD  1                  TO PV-SCN-LOC-CARTON-COUNT       06361564
063616         MOVE SU151-SML-NUMBER  TO  PV-SML                        06361666
063617     END-IF.                                                      06361764
063618* DMH 08/23/17 - BEGIN                                            06361864
063620*                                                                 06362064
063700     PERFORM 5000-SEARCH-SUMMARY-TABLE.                           06370000
063800     PERFORM 6000-PRINT-REPORT-DETAIL.                            06380000
063900*                                                                 06390000
064000*                                                                 06400000
064100 5000-SEARCH-SUMMARY-TABLE.                                       06410000
064200     SET SC-IDX TO 1.                                             06420006
064300     SEARCH SUMMARY-TABLE                                         06430000
064400         VARYING SC-IDX                                           06440006
064500              AT END SET PS-END-OF-TABLE TO TRUE                  06450000
064600         WHEN SUMMARY-SCLOC-NBR (SC-IDX) = SU151-SCAN-LOC         06460006
064700              ADD SU151-UNITS                                     06470007
064800                                TO SUMMARY-TOTAL-UNITS (SC-IDX)   06480007
064900              ADD PV-UNIT-RETAIL-QTY                              06490057
065000                                TO SUMMARY-TOTAL-RETAIL (SC-IDX)  06500007
065010              MOVE SU151-BTCH-NBR                                 06501023
065020                                TO SUMMARY-BTCH-NBR (SC-IDX)      06502023
065030              MOVE SU151-DATE   TO SUMMARY-DATE (SC-IDX)          06503023
065100              ADD 1             TO SUMMARY-SKU-CNT (SC-IDX)       06510006
065200         END-SEARCH.                                              06520000
065300                                                                  06530064
065310                                                                  06531064
065400*-----------------------------------------------------------------06540064
065401* UPDATE THE SUMMARY TABLE WITH THE UNIQUE CARTON COUNT          -06540164
065402* DMH 08/23/17                                                   -06540264
065403*-----------------------------------------------------------------06540364
065410 5010-UPDATE-SCAN-LOC-CRTN-CNT.                                   06541064
065411                                                                  06541164
065412     SET SC-IDX TO 1.                                             06541264
065413     SEARCH SUMMARY-TABLE                                         06541364
065414         VARYING SC-IDX                                           06541464
065415              AT END SET PS-END-OF-TABLE TO TRUE                  06541564
065416         WHEN SUMMARY-SCLOC-NBR (SC-IDX) = PV-SAVE-LOC            06541664
065417              ADD PV-SCN-LOC-CARTON-COUNT                         06541764
065418                                TO SUMMARY-CARTON-COUNT(SC-IDX)   06541864
065419              ADD PV-SCN-LOC-CARTON-COUNT                         06541968
065420                                TO PV-ST-CARTON-COUNT             06542068
065421              MOVE ZEROES       TO PV-SCN-LOC-CARTON-COUNT        06542168
065425         END-SEARCH.                                              06542564
065428                                                                  06542864
065430                                                                  06543064
065500******************************************************************06550000
065600*     WRITES THE DETAIL LINE INFO FOR THE MAIN REPORT.           *06560000
065700******************************************************************06570000
065800 6000-PRINT-REPORT-DETAIL.                                        06580000
065900         IF  PV-LINE-COUNT > PC-55                                06590000
066000             PERFORM 6999-PRINT-REPORT-HEADINGS                   06600000
066100         END-IF.                                                  06610000
066200                                                                  06620000
066300         WRITE SU-DTL-REPORT-RECORD                               06630000
066400           FROM REPORT-DETAIL-LINE                                06640000
066500             AFTER ADVANCING 1 LINE                               06650000
066600         ADD PC-1            TO PV-LINE-COUNT.                    06660000
066700         INITIALIZE REPORT-DETAIL-LINE.                           06670000
066800*                                                                 06680000
066900*                                                                 06690000
067000******************************************************************06700000
067100*     PRINTS THE TOTALS LINES FOR THE MAIN REPORT.               *06710000
067200******************************************************************06720000
067300 6850-PRINT-REPORT-TOTALS.                                        06730000
067400                                                                  06740000
067500     MOVE PV-TOTAL-UNITS   TO TL1-TOTAL-UNITS.                    06750010
067600     MOVE PV-TOTAL-RETAIL  TO TL1-TOTAL-RETAIL.                   06760010
067700     MOVE TL1-TOTAL-UNITS  TO PV-ST-UNITS.                        06770010
067800     MOVE TL1-TOTAL-RETAIL TO PV-ST-RETAIL.                       06780010
067900     MOVE ZEROS                  TO PV-ST-UNITS.                  06790000
068000     MOVE ZEROS                  TO PV-ST-RETAIL.                 06800000
068100                                                                  06810000
068200     WRITE SU-DTL-REPORT-RECORD                                   06820000
068300       FROM BL-BLANK-LINE                                         06830000
068400         AFTER ADVANCING 2 LINES.                                 06840000
068500*                                                                 06850000
068600     WRITE SU-DTL-REPORT-RECORD                                   06860000
068700       FROM REPORT-TOTALS-LINE                                    06870000
068800         AFTER ADVANCING 2 LINES.                                 06880000
068900*                                                                 06890000
069000     WRITE SU-DTL-REPORT-RECORD                                   06900000
069100       FROM BL-BLANK-LINE                                         06910000
069200         AFTER ADVANCING 2 LINES.                                 06920000
069300*                                                                 06930000
069400     IF PS-END-OF-FILE AND                                        06940000
069500        PS-FIRST-TIME-YES                                         06950000
069600           PERFORM 6900-NO-DETAIL                                 06960000
069700     END-IF.                                                      06970000
069800                                                                  06980000
069900*    WRITE SU-DTL-REPORT-RECORD                                   06990048
070000*      FROM END-OF-REPORT-LINE                                    07000048
070100*        AFTER ADVANCING 3 LINES.                                 07010048
070200*                                                                 07020000
070300     WRITE SU-DTL-REPORT-RECORD                                   07030000
070400       FROM BL-BLANK-LINE                                         07040000
070500         AFTER ADVANCING 2 LINES.                                 07050000
070600*                                                                 07060000
070700*                                                                 07070000
070800     MOVE ZEROS TO PV-TOTAL-UNITS.                                07080010
070900     MOVE ZEROS TO PV-TOTAL-RETAIL.                               07090010
071000*                                                                 07100000
071100*                                                                 07110000
071200******************************************************************07120000
071300*  PRINTS REPORT HEADINGS FOR THE CORPORATE SUMMARY.             *07130000
071400******************************************************************07140000
071500 6875-PRINT-SUMMARY.                                              07150000
071610     SET  PC-SUM-RPT-NBR          TO TRUE.                        07161004
071620     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        07162004
071700     MOVE  1                      TO PV-PAGE-COUNT.               07170018
071800     MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER.          07180000
071900                                                                  07190000
072000     WRITE SU-SUM-REPORT-RECORD                                   07200017
072100       FROM DP132O-STANDRD-HEADER-132-COLS                        07210000
072200         AFTER ADVANCING PAGE.                                    07220000
072300                                                                  07230000
073600     WRITE SU-SUM-REPORT-RECORD                                   07360017
073700       FROM HEADING-LINE7                                         07370000
073800         AFTER ADVANCING 1 LINE.                                  07380000
073900                                                                  07390000
074000     WRITE SU-SUM-REPORT-RECORD                                   07400017
074100       FROM BL-BLANK-LINE                                         07410000
074200         AFTER ADVANCING 1 LINE.                                  07420000
074300                                                                  07430000
074400     WRITE SU-SUM-REPORT-RECORD                                   07440017
074500       FROM HEADING-LINE8                                         07450000
074600         AFTER ADVANCING 1 LINE.                                  07460000
074700                                                                  07470000
074800     WRITE SU-SUM-REPORT-RECORD                                   07480017
074900       FROM HEADING-LINE9.                                        07490000
075000                                                                  07500000
075100     WRITE SU-SUM-REPORT-RECORD                                   07510017
075200       FROM BL-BLANK-LINE                                         07520000
075300         AFTER ADVANCING 1 LINE.                                  07530000
075400                                                                  07540000
075500     MOVE PC-10           TO PV-LINE-COUNT-RPT2.                  07550072
075600*                                                                 07560000
075700** GET INFO FROM TABLE                                            07570000
075800     PERFORM 6880-PRINT-SUMM-DETAIL                               07580000
075900         VARYING SC-IDX FROM 1 BY 1                               07590006
076000         UNTIL SUMMARY-SCLOC-NBR (SC-IDX) = ZEROS.                07600022
076100                                                                  07610020
076110*    MOVE SU151-BTCH-NBR         TO TL2-BTCH-NBR.                 07611023
076200     MOVE PV-ST-SKU-TOT          TO TL2-SKU-CNT.                  07620022
076300     MOVE PV-ST-UNITS            TO TL2-TOTAL-TOTAL-UNITS.        07630022
076400     MOVE PV-ST-RETAIL           TO TL2-TOTAL-TOTAL-RETAIL.       07640022
076410     MOVE PV-ST-CARTON-COUNT     TO TL2-CARTON-COUNT.             07641068
076500                                                                  07650000
076600     WRITE SU-SUM-REPORT-RECORD                                   07660022
076700         FROM BL-BLANK-LINE                                       07670020
076800           AFTER ADVANCING 2 LINES.                               07680022
076900*                                                                 07690000
077000     WRITE SU-SUM-REPORT-RECORD                                   07700022
077100         FROM SUMMARY-TOTALS-LINE                                 07710020
077200           AFTER ADVANCING 2 LINES.                               07720022
077300*                                                                 07730022
077400*                                                                 07740000
077500******************************************************************07750000
077600*  PRINTS THE SUMMARY DETAIL LINES.                              *07760000
077700******************************************************************07770000
077800 6880-PRINT-SUMM-DETAIL.                                          07780000
077900                                                                  07790000
078000     IF  SUMMARY-LOC-TYPE-CDE (SC-IDX) = 'CS' AND                 07800021
078010         SUMMARY-SKU-CNT (SC-IDX)      > 0                        07801021
078100         MOVE SUMMARY-SCLOC-NBR (SC-IDX) TO                       07810006
078200              DL2-SCAN-STORE-NBR                                  07820007
078300         MOVE SUMMARY-SCLOC-NAME (SC-IDX) TO                      07830006
078400              DL2-STORE-NAME                                      07840006
078410         MOVE SUMMARY-BTCH-NBR (SC-IDX) TO                        07841007
078420              DL2-BTCH-NBR                                        07842007
078430         MOVE SUMMARY-DATE (SC-IDX) TO                            07843007
078440              DL2-DATE                                            07844007
078500         MOVE SUMMARY-SKU-CNT (SC-IDX) TO                         07850006
078600              DL2-SKU-CNT                                         07860000
078700         MOVE SUMMARY-TOTAL-UNITS (SC-IDX) TO                     07870007
078800              DL2-TOTAL-UNITS                                     07880007
078900         MOVE SUMMARY-TOTAL-RETAIL (SC-IDX) TO                    07890007
079000              DL2-TOTAL-RETAIL                                    07900007
079010* DMH 08/23/17 - BEGIN                                            07901062
079030         MOVE SUMMARY-DC-NBR       (SC-IDX) TO                    07903062
079040              DL2-DC-NBR                                          07904062
079041         MOVE SUMMARY-CARTON-COUNT (SC-IDX) TO                    07904162
079042              DL2-CARTON-COUNT                                    07904262
079050* DMH 08/23/17 - END                                              07905062
079100         ADD  SUMMARY-SKU-CNT (SC-IDX) TO                         07910007
079200              PV-ST-SKU-TOT                                       07920000
079300         ADD  SUMMARY-TOTAL-UNITS (SC-IDX) TO                     07930007
079400              PV-ST-UNITS                                         07940000
079500         ADD  SUMMARY-TOTAL-RETAIL (SC-IDX) TO                    07950007
079600              PV-ST-RETAIL                                        07960000
079700         WRITE SU-SUM-REPORT-RECORD FROM SUMMARY-DETAIL-LINE      07970018
079800             AFTER ADVANCING 1 LINE                               07980000
079810*                                                                 07981072
079820* DMH 11/20/17 - BEGIN                                            07982072
079830         ADD  1  TO  PV-LINE-COUNT-RPT2                           07983072
079840* DMH 11/20/17 - END                                              07984072
079850*                                                                 07985072
079900     ELSE                                                         07990000
080000         IF  SUMMARY-LOC-TYPE-CDE (SC-IDX) = 'DS'                 08000006
080100         AND SUMMARY-SKU-CNT (SC-IDX)      > 0                    08010006
080200             MOVE SUMMARY-SCLOC-NBR (SC-IDX) TO                   08020006
080300                  DL2-SCAN-STORE-NBR                              08030010
080400             MOVE SUMMARY-SCLOC-NAME (SC-IDX) TO                  08040006
080500                  DL2-STORE-NAME                                  08050006
080510             MOVE SUMMARY-BTCH-NBR (SC-IDX) TO                    08051007
080520                  DL2-BTCH-NBR                                    08052007
080530             MOVE SUMMARY-DATE (SC-IDX) TO                        08053007
080540                  DL2-DATE                                        08054007
080600             MOVE SUMMARY-SKU-CNT (SC-IDX) TO                     08060006
080700                  DL2-SKU-CNT                                     08070000
080800             MOVE SUMMARY-TOTAL-UNITS (SC-IDX) TO                 08080007
080900                  DL2-TOTAL-UNITS                                 08090007
081000             MOVE SUMMARY-TOTAL-RETAIL (SC-IDX) TO                08100007
081100                  DL2-TOTAL-RETAIL                                08110007
081110* DMH 08/23/17 - BEGIN                                            08111062
081120         MOVE SUMMARY-DC-NBR       (SC-IDX) TO                    08112062
081130              DL2-DC-NBR                                          08113062
081140         MOVE SUMMARY-CARTON-COUNT (SC-IDX) TO                    08114062
081150              DL2-CARTON-COUNT                                    08115062
081160* DMH 08/23/17 - END                                              08116062
081200             ADD  SUMMARY-SKU-CNT    (SC-IDX) TO                  08120006
081300                  PV-ST-SKU-TOT                                   08130000
081400             ADD  SUMMARY-TOTAL-UNITS (SC-IDX) TO                 08140007
081500                  PV-ST-UNITS                                     08150000
081600             ADD  SUMMARY-TOTAL-RETAIL (SC-IDX) TO                08160007
081700                  PV-ST-RETAIL                                    08170000
081800             WRITE SU-SUM-REPORT-RECORD FROM SUMMARY-DETAIL-LINE  08180018
081900                 AFTER ADVANCING 1 LINE                           08190000
081910*                                                                 08191072
081920* DMH 11/20/17 - BEGIN                                            08192072
081930             ADD  1  TO  PV-LINE-COUNT-RPT2                       08193072
081940* DMH 11/20/17 - END                                              08194072
081950*                                                                 08195072
082000         END-IF                                                   08200000
082100     END-IF.                                                      08210000
082101                                                                  08210172
082102*                                                                 08210272
082103*** DMH - 11/20/17 BEGIN                                          08210372
082104     IF  PV-LINE-COUNT-RPT2  > 50                                 08210472
082110         ADD  1                       TO PV-PAGE-COUNT            08211072
082120         MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER       08212072
082130                                                                  08213072
082140         WRITE SU-SUM-REPORT-RECORD                               08214072
082150          FROM DP132O-STANDRD-HEADER-132-COLS                     08215072
082160         AFTER ADVANCING PAGE                                     08216072
082170                                                                  08217072
082180         WRITE SU-SUM-REPORT-RECORD                               08218072
082190          FROM HEADING-LINE7                                      08219072
082191         AFTER ADVANCING 1 LINE                                   08219172
082192                                                                  08219272
082193         WRITE SU-SUM-REPORT-RECORD                               08219372
082194          FROM BL-BLANK-LINE                                      08219472
082195         AFTER ADVANCING 1 LINE                                   08219572
082196                                                                  08219672
082197         WRITE SU-SUM-REPORT-RECORD                               08219772
082198          FROM HEADING-LINE8                                      08219872
082199         AFTER ADVANCING 1 LINE                                   08219972
082200                                                                  08220072
082201         WRITE SU-SUM-REPORT-RECORD                               08220172
082202          FROM HEADING-LINE9                                      08220272
082203                                                                  08220372
082204         WRITE SU-SUM-REPORT-RECORD                               08220472
082205          FROM BL-BLANK-LINE                                      08220572
082206         AFTER ADVANCING 1 LINE                                   08220672
082207                                                                  08220772
082208         MOVE PC-10           TO PV-LINE-COUNT-RPT2               08220872
082209     END-IF.                                                      08220972
082210*                                                                 08221072
082211*** DMH - 11/20/17 END                                            08221172
082220                                                                  08222072
082300                                                                  08230072
082400******************************************************************08240000
082500*  PRINTS NO DETAIL LINE AND END OF REPORT LINES.                *08250000
082600******************************************************************08260000
082700 6900-NO-DETAIL.                                                  08270000
082800     WRITE SU-DTL-REPORT-RECORD                                   08280000
082900       FROM NO-DATA-TO-REPORT-LINE                                08290000
083000         AFTER ADVANCING 3 LINES.                                 08300000
083100*                                                                 08310000
083200*                                                                 08320000
083210******************************************************************08321018
083220*  PRINTS NO DETAIL LINE AND END OF REPORT LINES.                *08322018
083230******************************************************************08323018
083240 6910-NO-SUM-DETAIL.                                              08324018
083250     WRITE SU-SUM-REPORT-RECORD                                   08325018
083260       FROM NO-DATA-TO-REPORT-LINE                                08326018
083270         AFTER ADVANCING 3 LINES.                                 08327018
083280*                                                                 08328018
083290*                                                                 08329018
083300******************************************************************08330000
083400*  PRINTS REPORT HEADINGS FOR THE MAIN REPORT.                   *08340000
083500******************************************************************08350000
083600 6999-PRINT-REPORT-HEADINGS.                                      08360000
083700                                                                  08370000
083800     PERFORM 7200-GET-STORE-INFORMATION.                          08380000
083900                                                                  08390000
084000     ADD  1                       TO PV-PAGE-COUNT.               08400000
084100     MOVE PV-PAGE-COUNT           TO DP200O-PAGE-NUMBER.          08410017
084200*                                                                 08420000
084300     WRITE SU-DTL-REPORT-RECORD                                   08430000
084400       FROM DP200O-STANDRD-HEADER-200-COLS                        08440017
084500         AFTER ADVANCING PAGE.                                    08450000
084600*                                                                 08460000
084700     MOVE SU151-DATE              TO HL1-BTCH-PRC-DTE             08470024
085110                                     HL7-BTCH-PRC-DTE.            08511024
085200*                                                                 08520000
085300     MOVE SU151-BTCH-NBR          TO HL2-BTCH-NBR.                08530023
085400     MOVE PV-SAVE-LOC             TO HL3-SCAN-LOC.                08540023
085500     MOVE PV-RPT-STORE-NAME       TO HL3-STORE-NAME.              08550023
085600     MOVE SU151-SKU-NBR           TO PV-PREV-SKU.                 08560023
085700                                                                  08570000
085800     MOVE SU151-SCAN-LOC          TO HL3-SCAN-LOC.                08580006
085900     MOVE PV-RPT-STORE-NAME       TO HL3-STORE-NAME.              08590006
086000*                                                                 08600000
086100     WRITE SU-DTL-REPORT-RECORD                                   08610000
086200       FROM HEADING-LINE1                                         08620000
086300         AFTER ADVANCING 2 LINES.                                 08630000
086400*                                                                 08640000
086500     WRITE SU-DTL-REPORT-RECORD                                   08650000
086600       FROM HEADING-LINE2                                         08660000
086700         AFTER ADVANCING 1 LINE.                                  08670000
086800*                                                                 08680000
086900     WRITE SU-DTL-REPORT-RECORD                                   08690000
087000       FROM BL-BLANK-LINE                                         08700000
087100         AFTER ADVANCING 1 LINE.                                  08710000
087200*                                                                 08720000
087300     WRITE SU-DTL-REPORT-RECORD                                   08730000
087400       FROM HEADING-LINE3                                         08740000
087500         AFTER ADVANCING 1 LINE.                                  08750000
087600*                                                                 08760000
087700     WRITE SU-DTL-REPORT-RECORD                                   08770000
087800       FROM BL-BLANK-LINE                                         08780000
087900         AFTER ADVANCING 1 LINE.                                  08790000
088000*                                                                 08800000
088100     WRITE SU-DTL-REPORT-RECORD                                   08810000
088200       FROM HEADING-LINE4                                         08820000
088300         AFTER ADVANCING 1 LINE.                                  08830000
088400*                                                                 08840000
088500     WRITE SU-DTL-REPORT-RECORD                                   08850000
088600       FROM HEADING-LINE5.                                        08860000
089000*                                                                 08900000
089100     MOVE SPACES TO SU-DTL-REPORT-RECORD.                         08910000
089200     WRITE SU-DTL-REPORT-RECORD                                   08920000
089300         AFTER ADVANCING 1 LINE.                                  08930000
089400*                                                                 08940000
089500     MOVE PC-10           TO PV-LINE-COUNT.                       08950000
089600*                                                                 08960000
089700*                                                                 08970000
089800 7000-READ-EXTRACT.                                               08980000
089900     READ SU-FILE INTO SU151-MISLOADED-CARTONS                    08990012
090000        AT END                                                    09000000
090100           SET PS-END-OF-FILE TO TRUE                             09010000
090200     END-READ.                                                    09020000
090300*                                                                 09030000
090400*                                                                 09040000
090500                                                                  09050000
090600****************************************************************  09060000
090700*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  09070000
090800*                                                              *  09080000
090900****************************************************************  09090000
091000 7200-GET-STORE-INFORMATION.                                      09100000
091100                                                                  09110050
091200     INITIALIZE XL071-COMMAREA-REC.                               09120000
091300     MOVE SU151-SCAN-LOC TO XL071-LOCATION-NUMBER.                09130006
091400                                                                  09140000
091500     CALL XL071-LOCATION-MODULE USING                             09150000
091600                                XL071-COMMAREA-REC.               09160000
091700                                                                  09170000
091800     EVALUATE TRUE                                                09180000
091900         WHEN XL071-NO-ERRORS                                     09190000
092000              MOVE XL071-LOC-NM TO PV-RPT-STORE-NAME              09200006
092100                                                                  09210000
092200         WHEN XL071-LOC-NOT-FOUND                                 09220000
092300              MOVE SPACES TO PV-RPT-STORE-NAME                    09230006
092400                                                                  09240000
092500         WHEN XL071-DC-ASGMT-NOT-FND                              09250000
092600              MOVE SPACES TO PV-RPT-STORE-NAME                    09260006
092700              DISPLAY '7200 - DC ASGMT NOT FOUND '                09270000
092800                       XL071-LOCATION-NUMBER                      09280000
092900                                                                  09290000
093000         WHEN OTHER                                               09300000
093001              MOVE '7200-GET-STORE-INFO' TO PV-ABEND-PARA-NAME    09300100
093002              STRING 'SQL ERROR CALLING XLKUT071 - '              09300200
093003                      XL071-SQLCODE                               09300300
093004                     ' -'                                         09300400
093005                      XL071-RETURN-CODE                           09300500
093006                     ' -'                                         09300600
093007                      XL071-LOCATION-NUMBER                       09300700
093008                      DELIMITED BY SIZE                           09300800
093009                      INTO PV-DB2-OPERATION-MSG-1                 09300900
093010              MOVE XL071-SQLCODE TO PV-SQLCODE                    09301000
093020              PERFORM 9998-SQL-ABEND                              09302000
093021                                                                  09302100
093022     END-EVALUATE.                                                09302200
093023                                                                  09302300
093024******************************************************************09302400
093025*     CLOSE FILES.                                              **09302500
093026******************************************************************09302600
093027 9000-END-PROCESS.                                                09302700
093028     PERFORM 6850-PRINT-REPORT-TOTALS.                            09302800
093029     PERFORM 6875-PRINT-SUMMARY.                                  09302900
093030*                                                                 09303000
093040     WRITE SU-SUM-REPORT-RECORD                                   09304018
093050       FROM BL-BLANK-LINE                                         09305000
093060         AFTER ADVANCING 2 LINES.                                 09306000
093070*                                                                 09307000
093080     IF PS-END-OF-FILE AND                                        09308000
093090        PS-FIRST-TIME-YES                                         09309000
093100           PERFORM 6910-NO-SUM-DETAIL                             09310018
093200     END-IF.                                                      09320000
093300                                                                  09330000
093800     WRITE SU-SUM-REPORT-RECORD                                   09380018
093900       FROM BL-BLANK-LINE                                         09390000
094000         AFTER ADVANCING 2 LINES.                                 09400000
094100                                                                  09410000
094200     CLOSE SU-FILE                                                09420000
094300           SU-DTL-REPORT-FILE                                     09430015
094310           SU-SUM-REPORT-FILE.                                    09431015
094400*                                                                 09440000
094500*                                                                 09450000
094600******************************************************************09460000
094700*     SQL ERROR PROCESSING                                      **09470000
094800******************************************************************09480000
094900 9998-SQL-ABEND.                                                  09490000
095000     MOVE SQLCODE     TO PV-SQLCODE.                              09500000
095100     DISPLAY '** ABEND           ** = SQLABEND'.                  09510000
095200     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          09520000
095300     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        09530000
095400     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        09540000
095500     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   09550000
095600     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   09560000
095700     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               09570000
095800     COPY DPPD004.                                                09580000
095900                                                                  09590000
096000     MOVE +4013                  TO PV-ABEND-CODE.                09600000
096100     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       09610000
096200*                                                                 09620000
096300*                                                                 09630000
