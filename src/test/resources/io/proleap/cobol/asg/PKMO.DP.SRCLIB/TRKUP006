000100******************************************************************00010055
000200 IDENTIFICATION DIVISION.                                         00020005
000300******************************************************************00030005
000400                                                                  00040005
000500 PROGRAM-ID.    TRKUP006.                                         00050005
000600 AUTHOR.        MIKE FRIESS.                                      00060005
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070005
000800 DATE-WRITTEN   FEB, 2001.                                        00080005
000900 DATE-COMPILED.                                                   00090005
001000                                                                  00100005
001100*******  CONTAINER SPLITS FROM ORDERED QTY - RE-TRANSMIT   *******00110005
001200* THIS PROGRAM CREATES THE 'CON' RE-TRANSMISSION FILE FROM THE PO 00120005
001300* TABLES. IT EXTRACTS A FILE TO A WORK TABLE TO BE RE-TRANSMITTED 00130005
001400* AS IMPORT DC SPLIT INFORMATION TO THE DECONSOLIDATOR. TWO ERROR 00140005
001500* REPORTS AND A DETAIL REPORT ARE ALSO WRITTEN TO A WORK TABLE.   00150005
001600* THIS PROGRAM IS BASED ON TRKUP005.                              00160005
001700******************************************************************00170005
001800* MM/DD/YYYY WHO & WHAT                                           00180005
001801* ---------- -----------------------------------------------------00190005
001802* 03/11/2010 FRANK WALA                                           00200005
001803*            REPLACE HARD-CODED EFC NUMBER 870 WITH XLT_LOC TABLE 00210005
001804*            TO CHECK THE E_BUS_IND IN PARA 2410.                 00220005
001805*                                                                 00230005
001806******************************************************************00240005
001807* 04/12/2012 GERMAN BANDA                                         00250005
001808*            THE NEW SYSTEM OF RECORD FOR INNER AND OUTER         00260005
001809*            QUANTITIES WILL BE THE PO THROUGH RMS.               00270005
001810*            ADDED SELECT OF OUTR_PK_QTY FROM TPURITM TO          00280005
001811*            BULK_UPC CURSOR. CHANGED PARA 2420-                  00290005
001812******************************************************************00300005
001813******************************************************************00310005
001814 ENVIRONMENT DIVISION.                                            00320005
001815******************************************************************00330005
001816                                                                  00340005
001817 CONFIGURATION SECTION.                                           00350005
001820                                                                  00360005
001830 SOURCE-COMPUTER.        IBM-3090.                                00370005
001840 OBJECT-COMPUTER.        IBM-3090.                                00380005
001850                                                                  00390005
001860 INPUT-OUTPUT SECTION.                                            00400005
001870                                                                  00410005
001880 FILE-CONTROL.                                                    00420005
001890                                                                  00430005
001900     SELECT INPUT-ENT-FILE                                        00440005
002000         ASSIGN                       TO INP01.                   00450005
002100                                                                  00460005
002200******************************************************************00470005
002300 DATA DIVISION.                                                   00480005
002400******************************************************************00490005
002500                                                                  00500005
002600 FILE SECTION.                                                    00510005
002700                                                                  00520005
002800 FD  INPUT-ENT-FILE                                               00530005
002900     RECORDING MODE IS F                                          00540005
003000     LABEL RECORDS ARE STANDARD                                   00550005
003100     RECORD CONTAINS 80 CHARACTERS                                00560005
003200     BLOCK CONTAINS 0 RECORDS.                                    00570005
003300 01  INPUT-RECORD1                    PIC  X(80).                 00580005
003400                                                                  00590005
003500******************************************************************00600005
003600 WORKING-STORAGE SECTION.                                         00610005
003700******************************************************************00620005
003800*                                                                 00630005
003900*                                                                 00640005
004000******************************************************************00650005
004100*  DB2 FORMATTED MESSAGE AREA                                     00660005
004200******************************************************************00670005
004300     COPY DPWS004.                                                00680005
004400*                                                                 00690005
004500******************************************************************00700005
004600*  COMMUNICATIONS AREA FOR DB2                                    00710005
004700******************************************************************00720005
004800     EXEC SQL                                                     00730005
004900          INCLUDE SQLCA                                           00740005
005000     END-EXEC.                                                    00750005
005100*                                                                 00760005
005200******************************************************************00770005
005300*  DB2 TABLE DECLARATION - IMPORTS CONTAINER UPC                  00780005
005400******************************************************************00790005
005500     EXEC SQL                                                     00800005
005600          INCLUDE TIMCNUP                                         00810005
005700     END-EXEC.                                                    00820005
005800*                                                                 00830005
005900******************************************************************00840005
006000*  DB2 TABLE DECLARATION - IMPORTS CONTAINER                      00850005
006100******************************************************************00860005
006200     EXEC SQL                                                     00870005
006300          INCLUDE TIMCNTK                                         00880005
006400     END-EXEC.                                                    00890005
006500*                                                                 00900005
006600******************************************************************00910005
006700*  DB2 TABLE DECLARATION - UPC SKU TABLE                          00920005
006800******************************************************************00930005
006900     EXEC SQL                                                     00940005
007000          INCLUDE TUPCSKU                                         00950005
007100     END-EXEC.                                                    00960005
007200*                                                                 00970005
007300******************************************************************00980005
007400*  DB2 TABLE DECLARATION - UPC TABLE                              00990005
007500******************************************************************01000005
007600     EXEC SQL                                                     01010005
007700          INCLUDE TUPC                                            01020005
007800     END-EXEC.                                                    01030005
007900*                                                                 01040005
008000******************************************************************01050005
008100*  DB2 TABLE DECLARATION - TRIP TABLE (TVHTRIP)                   01060005
008200******************************************************************01070005
008300     EXEC SQL                                                     01080005
008400          INCLUDE TVHTRIP                                         01090005
008500     END-EXEC.                                                    01100005
008600*                                                                 01110005
008700******************************************************************01120005
008800*  DB2 TABLE DECLARATION - SHIPMENT TO PURCHASE ORDER ASSOCIATION 01130005
008900*      TABLE (TSHPTPO)                                            01140005
009000******************************************************************01150005
009100     EXEC SQL                                                     01160005
009200          INCLUDE TSHPTPO                                         01170005
009300     END-EXEC.                                                    01180005
009400*                                                                 01190005
009500******************************************************************01200005
009600*  DB2 TABLE DECLARATION - SHIPMENT TABLE  (TSHIPMT)              01210005
009700******************************************************************01220005
009800     EXEC SQL                                                     01230005
009900          INCLUDE TSHIPMT                                         01240005
010000     END-EXEC.                                                    01250005
010100*                                                                 01260005
010200******************************************************************01270005
010300*  DB2 TABLE DECLARATION - SHIPMENT STATUS TABLE LAYOUT           01280005
010400*                               (TSHIPST)                         01290005
010500******************************************************************01300005
010600     EXEC SQL                                                     01310005
010700          INCLUDE TSHIPST                                         01320005
010800     END-EXEC.                                                    01330005
010900*                                                                 01340005
011000******************************************************************01350005
011100*  DB2 TABLE DECLARATION - SHIPMENT STATUS TYPE TABLE LAYOUT      01360005
011200*                               (TSHSTYP)                         01370005
011300******************************************************************01380005
011400     EXEC SQL                                                     01390005
011500          INCLUDE TSHSTYP                                         01400005
011600     END-EXEC.                                                    01410005
011700*                                                                 01420005
011800******************************************************************01430005
011900*  DB2 TABLE DECLARATION - PURCHASE ORDER PLANNED SHIPMENT        01440005
012000*      TABLE  (TPLNSHP)                                           01450005
012100******************************************************************01460005
012200     EXEC SQL                                                     01470005
012300          INCLUDE TPLNSHP                                         01480005
012400     END-EXEC.                                                    01490005
012500*                                                                 01500005
012600******************************************************************01510005
012700*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)01520005
012800******************************************************************01530005
012900     EXEC SQL                                                     01540005
013000          INCLUDE TPURCHS                                         01550005
013100     END-EXEC.                                                    01560005
013200*                                                                 01570005
013300******************************************************************01580005
013400*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE ITEM TABLE     01590005
013500*      (TPURITM)                                                  01600005
013600******************************************************************01610005
013700     EXEC SQL                                                     01620005
013800          INCLUDE TPURITM                                         01630005
013900     END-EXEC.                                                    01640005
014000*                                                                 01650005
014100******************************************************************01660005
014200*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01670005
014300******************************************************************01680005
014400     EXEC SQL                                                     01690005
014500          INCLUDE XLT00003                                        01700005
014600     END-EXEC.                                                    01710005
014700*                                                                 01720005
014800******************************************************************01730005
014900*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01740005
015000******************************************************************01750005
015100     EXEC SQL                                                     01760005
015200          INCLUDE XLT00004                                        01770005
015300     END-EXEC.                                                    01780005
015400*                                                                 01790005
015500******************************************************************01800005
015600*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER RELEASE TABLE    01810005
015700*      (TIMPORL)                                                  01820005
015800******************************************************************01830005
015900     EXEC SQL                                                     01840005
016000          INCLUDE TIMPORL                                         01850005
016100     END-EXEC.                                                    01860005
016200*                                                                 01870005
016300******************************************************************01880005
016400*  DB2 TABLE DECLARATION - TRAFFIC TRIP STATUS TABLE (TTRIPST)    01890005
016500******************************************************************01900005
016600     EXEC SQL                                                     01910005
016700          INCLUDE TTRIPST                                         01920005
016800     END-EXEC.                                                    01930005
016900*                                                                 01940005
017000******************************************************************01950005
017100*  DB2 TABLE DECLARATION - TRAFFIC TRIP STATUS TYPE TBL (TTRSTYP) 01960005
017200******************************************************************01970005
017300     EXEC SQL                                                     01980005
017400          INCLUDE TTRSTYP                                         01990005
017500     END-EXEC.                                                    02000005
017600*                                                                 02010005
017700******************************************************************02020005
017800*  DB2 TABLE DECLARATION - PURCHASE ORDER ALLOCATION PLAN TABLE   02030005
017900*      (TALLPLN)                                                  02040005
018000******************************************************************02050005
018100     EXEC SQL                                                     02060005
018200          INCLUDE TALLPLN                                         02070005
018300     END-EXEC.                                                    02080005
018400*                                                                 02090005
018500******************************************************************02100005
018600*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME TABLE         02110005
018700*      (TENTNME)                                                  02120005
018800******************************************************************02130005
018900     EXEC SQL                                                     02140005
019000          INCLUDE TENTNME                                         02150005
019100     END-EXEC.                                                    02160005
019200*                                                                 02170005
019300******************************************************************02180005
019400*  DB2 TABLE DECLARATION - PURCHASE ORDER INSTRUCTION CODES TABLE 02190005
019500*      (TINSTCD)                                                  02200005
019600******************************************************************02210005
019700     EXEC SQL                                                     02220005
019800          INCLUDE TINSTCD                                         02230005
019900     END-EXEC.                                                    02240005
020000*                                                                 02250005
020100******************************************************************02260005
020200*  DB2 TABLE DECLARATION - PURCHASE INSTRUCTION TABLE (TPOINST)   02270005
020300******************************************************************02280005
020400     EXEC SQL                                                     02290005
020500          INCLUDE TPOINST                                         02300005
020600     END-EXEC.                                                    02310005
020700                                                                  02320005
020800******************************************************************02330005
020900*  DB2 TABLE DECLARATION - TRAFFIC VEHICLE TABLE (TVEHICL)        02340005
021000******************************************************************02350005
021100     EXEC SQL                                                     02360005
021200          INCLUDE TVEHICL                                         02370005
021300     END-EXEC.                                                    02380005
021400                                                                  02390005
021500******************************************************************02400005
021600*  DB2 TABLE DECLARATION - SKU TABLE (TSKXREF)                    02410005
021700******************************************************************02420005
021800     EXEC SQL                                                     02430005
021900          INCLUDE TSKXREF                                         02440005
022000     END-EXEC.                                                    02450005
022100******************************************************************02460005
022200*  DB2 TABLE DECLARATION - TRIP AUDIT TABLE       (TAUTRIP)       02470005
022300******************************************************************02480005
022400     EXEC SQL                                                     02490005
022500          INCLUDE TAUTRIP                                         02500005
022600     END-EXEC.                                                    02510005
022700******************************************************************02520005
022800*  DB2 TABLE DECLARATION - PO PREPACK TABLE       (TPOPRPK)       02530005
022900******************************************************************02540005
023000     EXEC SQL                                                     02550005
023100          INCLUDE TPOPRPK                                         02560005
023200     END-EXEC.                                                    02570005
023300******************************************************************02580005
023400*  DB2 TABLE DECLARATION - PO TABLE             (TOUTTR2)         02590005
023500******************************************************************02600005
023600     EXEC SQL                                                     02610005
023700          INCLUDE TOUTTR2                                         02620005
023800     END-EXEC.                                                    02630005
023900******************************************************************02640005
024000*  DB2 TABLE DECLARATION - ERROR RPT TABLE       (TOUTTR3)        02650005
024100******************************************************************02660005
024200     EXEC SQL                                                     02670005
024300          INCLUDE TOUTTR3                                         02680005
024400     END-EXEC.                                                    02690005
024500******************************************************************02700005
024600*  DB2 TABLE DECLARATION - DETAIL RPT TABLE      (TOUTTR4)        02710005
024700******************************************************************02720005
024800     EXEC SQL                                                     02730005
024900          INCLUDE TOUTTR4                                         02740005
025000     END-EXEC.                                                    02750005
025100******************************************************************02760005
025200*  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 02770005
025300*  THIS TABLE IS USED TO STORE WORKING STOREAGE INFORMATION FOR   02780005
025400*  CHECKPOINT RESTARTS.                                           02790005
025500******************************************************************02800005
025600     EXEC SQL                                                     02810005
025700         INCLUDE TCKRSTIN                                         02820005
025800     END-EXEC.                                                    02830005
025900*                                                                 02840005
026000******************************************************************02850005
026100*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02860005
026200*  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    02870005
026300******************************************************************02880005
026400     EXEC SQL                                                     02890005
026500         INCLUDE TCKRSTCN                                         02900005
026600     END-EXEC.                                                    02910005
026700*                                                                 02920005
026800******************************************************************02930005
026900*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02940005
027000*  PO TABLE.                                                      02950005
027100******************************************************************02960005
027200     EXEC SQL                                                     02970005
027300         INCLUDE TIMCNPO                                          02980005
027400     END-EXEC.                                                    02990005
027500*                                                                 03000005
027600******************************************************************03010005
027700*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 03020005
027800*  RELEASE SPLITS TABLE.                                          03030005
027900******************************************************************03040005
028000     EXEC SQL                                                     03050005
028100         INCLUDE TIMCNRL                                          03060005
028200     END-EXEC.                                                    03070005
028300*                                                                 03080005
028400******************************************************************03090005
028500*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - PORT OF   03100005
028600*  ENTRY CODE TABLE.                                              03110005
028700******************************************************************03120005
028800     EXEC SQL                                                     03130005
028900         INCLUDE TIMPOE                                           03140005
029000     END-EXEC.                                                    03150005
029100*                                                                 03160005
029200******************************************************************03170005
029300*  DB2 TABLE DECLARATION - IT-UPC PHYSICAL LOCATION STATUS        03180005
029400******************************************************************03190005
029500     EXEC SQL                                                     03200005
029600         INCLUDE TUPCPLS                                          03210005
029700     END-EXEC.                                                    03220005
029800*                                                                 03230005
029900******************************************************************03240005
030000*  DB2 TABLE DECLARATION - WEB ITEM TABLE FOR E-COMMERCE          03250005
030100******************************************************************03260005
030200     EXEC SQL                                                     03270005
030300         INCLUDE TWEBITM                                          03280005
030400     END-EXEC.                                                    03290005
030500*                                                                 03300005
030600******************************************************************03310005
030700*  DB2 TABLE DECLARATION - TR DECONSOL CONTROL RULE TABLE         03320005
030800******************************************************************03330005
030900     EXEC SQL                                                     03340005
031000         INCLUDE TRT00014                                         03350005
031100     END-EXEC.                                                    03360005
031200*                                                                 03370005
031300******************************************************************03380005
031400*  DB2 TABLE DECLARATION - EXTERNAL PARTNERS ENTITY IDS           03390005
031500******************************************************************03400005
031600     EXEC SQL                                                     03410005
031700         INCLUDE TEXTENT                                          03420005
031800     END-EXEC.                                                    03430005
031900*                                                                 03440005
032000******************************************************************03450005
032100*  DB2 TABLE DECLARATION - TR DECONSOL CONTROL RULE CONSTRAINTS   03460005
032200******************************************************************03470005
032300     EXEC SQL                                                     03480005
032400         INCLUDE TRT00015                                         03490005
032500     END-EXEC.                                                    03500005
032600*FJW 03/11/10 BEGIN                                               03510005
032700******************************************************************03520005
032800*  DB2 TABLE DECLARATION - EFC2 LOC TABLE FOR E-COMMERCE          03530005
032900******************************************************************03540005
033000     EXEC SQL                                                     03550005
033100         INCLUDE XLT00010                                         03560005
033110     END-EXEC.                                                    03570005
033120*FJW 03/11/10 END                                                 03580005
033130*                                                                 03590005
139868******************************************************************03600038
139868*  DB2 TABLE DECLARATION - PARM TABLE                             03610038
139868*      (TKRPRPM)                                                  03620038
139868******************************************************************03630038
139868     EXEC SQL                                                     03640038
139868          INCLUDE TKRPRPM                                         03650038
139868     END-EXEC.                                                    03660038
139868*                                                                 03670038
155029******************************************************************03680074
155029* DB2 TABLE DECLARATION - WST_INTGRTN_TYP TABLE                   03690074
155029******************************************************************03700074
155029     EXEC SQL                                                     03710074
155029          INCLUDE WST00008                                        03720074
155029     END-EXEC.                                                    03730074
155029*                                                                 03740074
155029******************************************************************03750074
155029* DB2 TABLE DECLARATION - WST_ATTR_DEFN TABLE                     03760074
155029******************************************************************03770074
155029     EXEC SQL                                                     03780074
155029          INCLUDE WST00009                                        03790074
155029     END-EXEC.                                                    03800074
155029*                                                                 03810074
155029******************************************************************03820074
155029* DB2 TABLE DECLARATION - WST_ATTR_ELEM TABLE                     03830074
155029******************************************************************03840074
155029     EXEC SQL                                                     03850074
155029          INCLUDE WST00010                                        03860074
155029     END-EXEC.                                                    03870074
155029*                                                                 03880074
139868******************************************************************03890038
139868*  DB2 TABLE DECLARATION - PURCHASE ORDER STORE ALLOCATION TABLE  03900038
139868*      (TMESTDS)                                                  03910038
139868******************************************************************03920038
139868     EXEC SQL                                                     03930038
139868          INCLUDE TMESTDS                                         03940038
139868     END-EXEC.                                                    03950038
139868*                                                                 03960038
033140******************************************************************03970005
033150*    IMPORT TRIP RECORD LAYOUT                                    03980005
033160******************************************************************03990005
033170     COPY TRRD004.                                                04000005
033180 EJECT                                                            04010005
033190                                                                  04020005
033200******************************************************************04030005
033300*    ERROR REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION        04040005
033400*    TRANSMISSION AND RETRANSMISSION.                             04050005
033500******************************************************************04060005
033600     COPY TRRD006.                                                04070005
033700 EJECT                                                            04080005
033800                                                                  04090005
033900******************************************************************04100005
034000*    DETAIL REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION       04110005
034100*    TRANSMISSION AND RETRANSMISSION.                             04120005
034200******************************************************************04130005
034300     COPY TRRD020.                                                04140005
034400 EJECT                                                            04150005
034500                                                                  04160005
034600******************************************************************04170005
034700*    ENTITY ID'S TABLE COPYBOOK LAYOUT                            04180005
034800******************************************************************04190005
034900     COPY TRRD030.                                                04200005
035000                                                                  04210005
035100 EJECT                                                            04220005
035200                                                                  04230005
035300 01  ABEND-CODE                      PIC S9(04)    VALUE +0       04240005
035400                                                   COMP SYNC.     04250005
035500*                                                                 04260005
035600 01  PA-PROGRAM-ACCUMULATORS.                                     04270005
035700     05  PA-TOTALS.                                               04280005
035800         10 PA-TOTAL-CURR-SPLIT-QTY   PIC  S9(13)  VALUE +0       04290005
035900                                                     COMP-3.      04300005
155029         10 PA-TOTAL-STR-SPLIT-QTY    PIC  S9(13)  VALUE +0       04310074
155029                                                     COMP-3.      04320074
036000         10 PA-TOTAL-OUTPUT-REC-COUNT PIC  S9(13)  VALUE +0       04330005
036100                                                     COMP-3.      04340005
036200         10 PA-TOTAL-PACK-UNITS       PIC  S9(13)  VALUE +0       04350005
036300                                                     COMP-3.      04360005
036400         10 PA-TOTAL-PACK-CARTONS     PIC  S9(13)  VALUE +0       04370005
036500                                                     COMP-3.      04380005
036600         10 PA-TOTAL-OTPK-ORD-QTY     PIC  S9(13)  VALUE +0       04390005
036700                                                     COMP-3.      04400005
036800         10 PA-TOTAL-INPK-ORD-QTY     PIC  S9(13)  VALUE +0       04410005
036900                                                     COMP-3.      04420005
037000         10 PA-PDC-SPLIT-QTY          PIC  S9(13)  VALUE +0       04430005
037100                                                     COMP-3.      04440005
037200         10 PA-TOTAL-PACK-SPLIT-QTY        PIC S9(13) VALUE +0    04450005
037300                                                     COMP-3.      04460005
037400     05  PA-ERROR-COUNT               PIC  S9(13)    VALUE +0     04470005
037500                                                     COMP-3.      04480005
037600                                                                  04490005
037700 01  PS-PROGRAM-SWITCHES.                                         04500005
037800     05  PS-EOC-DRIVER-CURSOR-SW       PIC  X(01)    VALUE 'N'.   04510005
037900         88  PS-EOC-DRIVER-CURSOR                    VALUE 'Y'.   04520005
038000         88  PS-NOT-EOC-DRIVER-CURSOR                VALUE 'N'.   04530005
038100     05  PS-EOC-CONT-CURSOR-SW         PIC  X(01)    VALUE 'N'.   04540005
038200         88  PS-EOC-CONT-CURSOR                      VALUE 'Y'.   04550005
038300         88  PS-EOC-CONT-CURSOR-NO                   VALUE 'N'.   04560005
038400     05  PS-EOC-PO-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04570005
038500         88  PS-EOC-PO-CURSOR                        VALUE 'Y'.   04580005
038600         88  PS-EOC-PO-CURSOR-NO                     VALUE 'N'.   04590005
038700     05  PS-EOC-INSTR-CURSOR-SW        PIC  X(01)    VALUE 'N'.   04600005
038800         88  PS-EOC-INSTR-CURSOR                     VALUE 'Y'.   04610005
038900         88  PS-EOC-INSTR-CURSOR-NO                  VALUE 'N'.   04620005
039000     05  PS-EOC-BULK-UPC-CUR-SW        PIC  X(01)    VALUE 'N'.   04630005
039100         88  PS-EOC-BULK-UPC-CUR                     VALUE 'Y'.   04640005
039200         88  PS-EOC-BULK-UPC-CUR-NO                  VALUE 'N'.   04650005
039300     05  PS-EOC-PREPACK-DC-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04660005
039400         88  PS-EOC-PREPACK-DC-CURSOR                VALUE 'Y'.   04670005
039500         88  PS-EOC-PREPACK-DC-CURSOR-NO             VALUE 'N'.   04680005
039600     05  PS-EOC-PREPACK-CM-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04690005
039700         88  PS-EOC-PREPACK-CM-CURSOR                VALUE 'Y'.   04700005
039800         88  PS-EOC-PREPACK-CM-CURSOR-NO             VALUE 'N'.   04710005
039900     05  PS-EOC-DC-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04720005
040000         88  PS-EOC-DC-CURSOR                        VALUE 'Y'.   04730005
040100         88  PS-EOC-DC-CURSOR-NO                     VALUE 'N'.   04740005
040200     05  PS-EOC-POE-CURSOR-SW PIC           X(01)    VALUE 'N'.   04750005
040300         88  PS-EOC-POE-CURSOR                       VALUE 'Y'.   04760005
040400         88  PS-EOC-POE-CURSOR-NO                    VALUE 'N'.   04770005
040500     05  PS-EOC-PACK-CURSOR-SW PIC X(01)             VALUE 'N'.   04780005
040600         88  PS-EOC-PACK-CURSOR                      VALUE 'Y'.   04790005
040700         88  PS-EOC-PACK-CURSOR-NO                   VALUE 'N'.   04800005
040800     05  PS-EOC-POPRPK-FOR-PO-CUR-SW PIC X(01)       VALUE 'N'.   04810005
040900         88  PS-EOC-POPRPK-FOR-PO-CUR                VALUE 'Y'.   04820005
041000         88  PS-EOC-POPRPK-FOR-PO-CUR-NO             VALUE 'N'.   04830005
041100     05  PS-EOC-PURITM-TUPC-CUR-SW    PIC X(01)      VALUE 'N'.   04840005
041200         88  PS-EOC-PURITM-TUPC-CUR                  VALUE 'Y'.   04850005
041300         88  PS-EOC-PURITM-TUPC-CUR-NO               VALUE 'N'.   04860005
041400     05  PS-EOC-PREPACK-CURSOR-SW       PIC X(01)    VALUE 'N'.   04870005
041500         88  PS-EOC-PREPACK-CURSOR                   VALUE 'Y'.   04880005
041600         88  PS-EOC-PREPACK-CURSOR-NO                VALUE 'N'.   04890005
041700     05  PS-EOC-PDC-UNITS-CURSOR-SW     PIC X(01)    VALUE 'N'.   04900005
041800         88  PS-EOC-PDC-UNITS-CURSOR                 VALUE 'Y'.   04910005
041900         88  PS-EOC-PDC-UNITS-CURSOR-NO              VALUE 'N'.   04920005
042000     05  PS-EOC-PACK-UPC-CURSOR-SW      PIC X(01)    VALUE 'N'.   04930005
042100         88  PS-EOC-PACK-UPC-CURSOR                  VALUE 'Y'.   04940005
042200         88  PS-EOC-PACK-UPC-CURSOR-NO               VALUE 'N'.   04950005
042300     05  PS-LINES-ON-TPURITM-SW        PIC  X(01)    VALUE 'N'.   04960005
042400         88  PS-LINES-ON-TPURITM                     VALUE 'Y'.   04970005
042500         88  PS-LINES-ON-TPURITM-NO                  VALUE 'N'.   04980005
042600     05  PS-PREPACKS-ON-TPURITM-SW     PIC  X(01)    VALUE 'N'.   04990005
042700         88  PS-PREPACKS-ON-TPURITM                  VALUE 'Y'.   05000005
042800         88  PS-PREPACKS-ON-TPURITM-NO               VALUE 'N'.   05010005
042900     05  PS-DC-SPLIT-INFO-PRESENT-SW   PIC  X(01)    VALUE 'N'.   05020005
043000         88  PS-DC-SPLIT-INFO-PRESENT                VALUE 'Y'.   05030005
043100         88  PS-DC-SPLIT-INFO-PRESENT-NO             VALUE 'N'.   05040005
043200     05  PS-CONT-INFO-PRESENT-SW       PIC  X(01)    VALUE 'N'.   05050005
043300         88  PS-CONT-INFO-PRESENT                    VALUE 'Y'.   05060005
043400         88  PS-CONT-INFO-PRESENT-NO                 VALUE 'N'.   05070005
043500     05  PS-PO-CUR-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05080005
043600         88  PS-PO-CUR-INFO-PRESENT                  VALUE 'Y'.   05090005
043700         88  PS-PO-CUR-INFO-PRESENT-NO               VALUE 'N'.   05100005
043800     05  PS-CURR-SPLIT-QTY-PRESENT-SW  PIC  X(01)    VALUE 'N'.   05110005
043900         88  PS-CURR-SPLIT-QTY-PRESENT               VALUE 'Y'.   05120005
044000         88  PS-CURR-SPLIT-QTY-PRESENT-NO            VALUE 'N'.   05130005
044100     05  PS-PO-SEL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05140005
044200         88  PS-PO-SEL-INFO-PRESENT                  VALUE 'Y'.   05150005
044300         88  PS-PO-SEL-INFO-PRESENT-NO               VALUE 'N'.   05160005
044400     05  PS-SELECT-PACK-SUM-OK-SW      PIC  X(01)    VALUE 'N'.   05170005
044500         88  PS-SELECT-PACK-SUM-OK                   VALUE 'Y'.   05180005
044600         88  PS-SELECT-PACK-SUM-OK-NO                VALUE 'N'.   05190005
044700     05  PS-GOOD-STATUS-CDE-FOUND-SW   PIC  X(01)    VALUE 'N'.   05200005
044800         88  PS-GOOD-STATUS-CDE-FOUND                VALUE 'Y'.   05210005
044900         88  PS-GOOD-STATUS-CDE-FOUND-NO             VALUE 'N'.   05220005
045000     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   05230005
045100         88  PS-NORMAL-RUN                           VALUE '0'.   05240005
045200         88  PS-RESTART-RUN                          VALUE '9'.   05250005
045300     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   05260005
045400         88  PS-COMMITS-TAKEN                        VALUE 'Y'.   05270005
045500         88  PS-COMMITS-TAKEN-NO                     VALUE 'N'.   05280005
045600     05  PS-PROBLEM-SO-SET-RETRANS-SW  PIC  X(01)    VALUE 'N'.   05290005
045700         88  PS-PROBLEM-SO-SET-RETRANS               VALUE 'Y'.   05300005
045800         88  PS-PROBLEM-SO-SET-RETRANS-NO            VALUE 'N'.   05310005
045900     05  PS-ZERO-OUTR-PACK-QTY-SW      PIC  X(01)    VALUE 'N'.   05320005
046000         88  PS-ZERO-OUTR-PACK-QTY                   VALUE 'Y'.   05330005
046100         88  PS-ZERO-OUTR-PACK-QTY-NO                VALUE 'N'.   05340005
046200     05  PS-TSHPTPO-UPDATED-SW         PIC  X(01)    VALUE 'N'.   05350005
046300         88  PS-TSHPTPO-UPDATED                      VALUE 'Y'.   05360005
046400         88  PS-TSHPTPO-UPDATED-NO                   VALUE 'N'.   05370005
046500     05  PS-AC-AP-LINES-SW             PIC  X(01)    VALUE 'N'.   05380005
046600         88  PS-AC-AP-LINES                          VALUE 'Y'.   05390005
046700         88  PS-AC-AP-LINES-NO                       VALUE 'N'.   05400005
046800     05  PS-FIRST-DC-SW                PIC  X(01)    VALUE 'N'.   05410005
046900         88  PS-FIRST-DC                             VALUE 'Y'.   05420005
047000         88  PS-FIRST-DC-NO                          VALUE 'N'.   05430005
047100     05  PS-COUNT-DCS-OK-SW            PIC  X(01)    VALUE 'N'.   05440005
047200         88  PS-COUNT-DCS-OK                         VALUE 'Y'.   05450005
047300         88  PS-COUNT-DCS-OK-NO                      VALUE 'N'.   05460005
047400     05  PS-UPC-PASSESED-EDITS-SW      PIC  X(01)    VALUE 'N'.   05470005
047500         88  PS-UPC-PASSESED-EDITS                   VALUE 'Y'.   05480005
047600         88  PS-UPC-PASSESED-EDITS-NO                VALUE 'N'.   05490005
047700     05  PS-THERE-ARE-E-COM-DCS-SW     PIC  X(01)    VALUE 'N'.   05500005
047800         88  PS-THERE-ARE-E-COM-DCS                  VALUE 'Y'.   05510005
047900         88  PS-THERE-ARE-E-COM-DCS-NO               VALUE 'N'.   05520005
048000     05  PS-THIS-IS-E-COM-UPC-SW       PIC  X(01)    VALUE 'N'.   05530005
048100         88  PS-THIS-IS-E-COM-UPC                    VALUE 'Y'.   05540005
048200         88  PS-THIS-IS-E-COM-UPC-NO                 VALUE 'N'.   05550005
048300     05  PS-EOC-E-COM-PACK-UPC-CUR-SW  PIC  X(01)    VALUE 'N'.   05560005
048400         88  PS-EOC-E-COM-PACK-UPC-CUR               VALUE 'Y'.   05570005
048500         88  PS-EOC-E-COM-PACK-UPC-CUR-NO            VALUE 'N'.   05580005
048600     05  PS-PASSED-E-COM-CHECK-SW      PIC  X(01)    VALUE 'N'.   05590005
048700         88  PS-PASSED-E-COM-CHECK                   VALUE 'Y'.   05600005
048800         88  PS-PASSED-E-COM-CHECK-NO                VALUE 'N'.   05610005
048900     05  PS-PO-PASSED-EDITS-SW         PIC  X(01)    VALUE 'N'.   05620005
049000         88  PS-PO-PASSED-EDITS                      VALUE 'Y'.   05630005
049100         88  PS-PO-PASSED-EDITS-NO                   VALUE 'N'.   05640005
049200     05  PS-PO-HAS-UNTIED-LINES-SW     PIC  X(01)    VALUE 'N'.   05650005
049300         88  PS-PO-HAS-UNTIED-LINES                  VALUE 'Y'.   05660005
049400         88  PS-PO-HAS-UNTIED-LINES-NO               VALUE 'N'.   05670005
049500     05  PS-UNCONFIRMED-PACK-SW      PIC  X(01)      VALUE 'N'.   05680005
049600         88  PS-UNCONFIRMED-PACK                     VALUE 'Y'.   05690005
049700         88  PS-UNCONFIRMED-PACK-NO                  VALUE 'N'.   05700005
049800                                                                  05710005
049900     05  PS-POE-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05720005
050000         88  PS-POE-WRITTEN                          VALUE 'Y'.   05730005
050100         88  PS-POE-WRITTEN-NO                       VALUE 'N'.   05740005
050200     05  PS-VES-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05750005
050300         88  PS-VES-WRITTEN                          VALUE 'Y'.   05760005
050400         88  PS-VES-WRITTEN-NO                       VALUE 'N'.   05770005
050500     05  PS-ETA-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05780005
050600         88  PS-ETA-WRITTEN                          VALUE 'Y'.   05790005
050700         88  PS-ETA-WRITTEN-NO                       VALUE 'N'.   05800005
050800     05  PS-CON-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05810005
050900         88  PS-CON-WRITTEN                          VALUE 'Y'.   05820005
051000         88  PS-CON-WRITTEN-NO                       VALUE 'N'.   05830005
051100     05  PS-EOT-EXTRACT-SW             PIC  X(01)    VALUE 'N'.   05840005
051200         88  PS-EOT-EXTRACT                          VALUE 'Y'.   05850005
051300         88  PS-EOT-EXTRACT-NO                       VALUE 'N'.   05860005
051400                                                                  05870005
051500     05  PS-END-OF-INPUT-ENT-FILE-SW      PIC X(01) VALUE 'N'.    05880005
051600         88  PS-END-OF-INPUT-ENT-FILE               VALUE 'Y'.    05890005
051700         88  PS-END-OF-INPUT-ENT-FILE-NO            VALUE 'N'.    05900005
051800                                                                  05910005
051900     05  PS-RETRAN-MATCH-TRAN-ENTID-SW    PIC X(01) VALUE 'N'.    05920005
052000         88  PS-RETRAN-MATCH-TRAN-ENTID             VALUE 'Y'.    05930005
052100         88  PS-RETRAN-MATCH-TRAN-ENTID-NO          VALUE 'N'.    05940005
052200                                                                  05950005
052300     05  PS-ENTID-FOUND-SW                PIC X(01) VALUE 'N'.    05960005
052400         88  PS-ENTID-FOUND                         VALUE 'Y'.    05970005
052500         88  PS-ENTID-FOUND-NO                      VALUE 'N'.    05980005
052600                                                                  05990005
052700     05  PS-END-OF-ENTID-TABLE-SW         PIC X(01) VALUE 'N'.    06000005
052800         88  PS-END-OF-ENTID-TABLE                  VALUE 'Y'.    06010005
052900         88  PS-END-OF-ENTID-TABLE-NO               VALUE 'N'.    06020005
139868     05  PS-FIRST-STORE-SW                PIC X(01) VALUE 'N'.    06030038
139868         88  PS-FIRST-STORE                         VALUE 'Y'.    06040038
139868         88  PS-FIRST-STORE-NO                      VALUE 'N'.    06050038
139868     05  PS-EOC-STORE-CURSOR-SW           PIC X(01) VALUE 'N'.    06060038
139868         88  PS-EOC-STORE-CURSOR                    VALUE 'Y'.    06070038
139868         88  PS-EOC-STORE-CURSOR-NO                 VALUE 'N'.    06080038
139868     05  PS-OUTLET-STORE-SW               PIC X(01) VALUE 'N'.    06090038
139868         88  PS-OUTLET-STORE                        VALUE 'Y'.    06100038
139868         88  PS-OUTLET-STORE-NO                     VALUE 'N'.    06110038
155029     05  PS-NEW-UPC-SW                    PIC X(01) VALUE 'N'.    06120074
155029         88  PS-NEW-UPC-YES                         VALUE 'Y'.    06130074
155029         88  PS-NEW-UPC-NO                          VALUE 'N'.    06140074
155029     05  PS-FIRST-UPC-SW                  PIC X(01) VALUE 'N'.    06150074
155029         88  PS-FIRST-UPC-YES                       VALUE 'Y'.    06160074
155029         88  PS-FIRST-UPC-NO                        VALUE 'N'.    06170074
053000                                                                  06180005
053100 01  PC-PROGRAM-CONSTANTS.                                        06190005
053200     05  PC-SYSTEM-CD                PIC  X(02)    VALUE 'RV'.    06200005
053300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          06210005
053400         'TRKUP006'.                                              06220005
053500     05  PC-CURRENT-JOB-NAME         PIC  X(06)    VALUE 'TRK030'.06230005
053600     05  PC-EN                       PIC X(02)     VALUE 'EN'.    06240005
053700     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     06250005
053800     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     06260005
053900     05  PC-A                        PIC X(01)     VALUE 'A'.     06270005
054000     05  PC-B                        PIC X(01)     VALUE 'B'.     06280005
054100     05  PC-C                        PIC X(01)     VALUE 'C'.     06290005
054200     05  PC-I                        PIC X(01)     VALUE 'I'.     06300005
054300     05  PC-M                        PIC X(01)     VALUE 'M'.     06310005
054400     05  PC-N                        PIC X(01)     VALUE 'N'.     06320005
054500     05  PC-O                        PIC X(01)     VALUE 'O'.     06330005
054600     05  PC-S                        PIC X(01)     VALUE 'S'.     06340005
054700     05  PC-U                        PIC X(01)     VALUE 'U'.     06350005
054800     05  PC-Y                        PIC X(01)     VALUE 'Y'.     06360005
054900     05  PC-NA                       PIC X(02)     VALUE 'NA'.    06370005
055000     05  PC-MULTI                    PIC X(05)     VALUE 'MULTI'. 06380005
055100     05  PC-NO-SIZE                  PIC X(07)     VALUE          06390005
055200                                                   'NO SIZE'.     06400005
055300     05  PC-NULL-DTE                PIC X(10) VALUE '9999-09-09'. 06410005
055400     05  PC-LOW-VALUE                PIC X(01)     VALUE          06420005
055500                                                   LOW-VALUE.     06430005
055600     05  PC-EXTRACT-TBL-LIMIT        PIC S9(8)   VALUE +50000.    06440005
055700     05  PC-DECONSOL-TBL-LIMIT      PIC S9(08)  VALUE +00100.     06450005
055800     05  PC-DEFAULT-DTE-9               PIC X(10)     VALUE       06460005
055900                                                    '9999-09-09'. 06470005
056000     05  PC-DEFAULT-TME-9               PIC X(08)     VALUE       06480005
056100                                                      '09.09.09'. 06490005
056200     05  PC-DEFAULT-DTE                 PIC X(10)     VALUE       06500005
056300                                                    '0001-01-01'. 06510005
056400     05  PC-DEFAULT-TME                 PIC X(08)     VALUE       06520005
056500                                                      '00.00.00'. 06530005
056600*                                                                 06540005
056700 01  PV-PROGRAM-VARIABLES.                                        06550005
056800     05  PV-HOLD-PORT-OF-ENTRY-CTY   PIC X(30)     VALUE SPACE.   06560005
056900     05  PV-HOLD-POE-CDE             PIC X(3)      VALUE 'XXX'.   06570005
057000     05  PV-HOLD-VHTRIP-EST-AR-TMST  PIC X(10)     VALUE SPACE.   06580005
057100     05  PV-HOLD-VHTRIP-VEH-NBR      PIC X(10)     VALUE SPACE.   06590005
057200     05  PV-HOLD-VHTRIP-TRIP-ID    PIC S9(9) COMP  VALUE ZERO.    06600005
155029     05  PV-DEPT-NBR                 PIC S9(4)V    VALUE ZEROES   06610074
155029                                                   COMP-3.        06620074
155029     05  PV-FAST-E-BUS-IND           PIC X(01)     VALUE SPACES.  06630074
155029     05  PV-FAST-RDC-IND             PIC X(01)     VALUE SPACES.  06640074
155029     05  PV-FAST-EFC-IND             PIC X(01)     VALUE SPACES.  06650074
155029     05  PV-HOLD-OUT-RECORD.                                      06660074
155029         10  FILLER                  PIC X(03)     VALUE SPACES.  06670074
155029         10  PV-HOLD-DIST-CNTR       PIC X(04)     VALUE SPACES.  06680074
155029         10  FILLER                  PIC X(243)    VALUE SPACES.  06690074
057300     05  PV-QUOTIENT-ORDER-PERCENT   PIC S9(09)V99 COMP-3         06700005
057400                                                   VALUE ZERO.    06710005
057500     05  PV-QUOTIENT-PDC-PERCNT      PIC S9(09)V99 COMP-3         06720005
057600                                                   VALUE ZERO.    06730005
057700     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP-3         06740005
057800                                                   VALUE ZERO.    06750005
057900     05  PV-HOLD-PLAN-NBR            PIC S9(04)    COMP-3         06760005
058000                                                   VALUE ZERO.    06770005
058100     05  PV-HOLD-PO-PREPK-ID         PIC  9(08)    VALUE ZEROES.  06780005
058200     05  PV-DEST-NBR                 PIC  9(04)    VALUE ZEROES.  06790005
058300     05  PV-CURRENT-TIME             PIC  X(26)    VALUE SPACES.  06800005
058400     05  PV-REMAINDER                PIC S9(5)     VALUE +0.      06810005
058500     05  PV-TMST                     PIC X(26)     VALUE SPACES.  06820005
058600     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  06830005
058700     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACE.   06840005
058800     05  PV-HOLD-TR020-PO-NBR        PIC 9(09)     VALUE ZERO.    06850005
058900     05  PV-HOLD-TR020-PROCESS-DATE  PIC X(08)     VALUE SPACE.   06860005
059000     05  PV-HOLD-TR020-CONTNR-ID     PIC X(12)     VALUE SPACE.   06870005
059100     05  PV-ETA-BEGIN-TMST           PIC X(26)     VALUE SPACE.   06880005
059200     05  PV-ETA-END-TMST             PIC X(26)     VALUE SPACE.   06890005
139868     05  PV-HOLD-PCK-UNIT-QTY        PIC 9(12)     VALUE ZERO.    06900038
139868     05  PV-HOLD-PCK-CART-CT         PIC 9(12)     VALUE ZERO.    06910038
139868     05  PV-HOLD-PCK-UNIT-PER-CTN    PIC 9(12)     VALUE ZERO.    06920038
059300     05  PV-WORK-FIELDS-CART-PER-PO.                              06930005
059400         10  PV-CART-PER-PO             PIC S9(13) VALUE +0       06940005
059500                                                     COMP-3.      06950005
059600         10  PV-SUM-PURITM-UNT-QTY      PIC S9(13) VALUE +0       06960005
059700                                                     COMP-3.      06970005
059800         10  PV-CART-PER-PREPACK        PIC S9(13) VALUE +0       06980005
059900                                                     COMP-3.      06990005
060000         10  PV-CART-PER-ITEM           PIC S9(13) VALUE +0       07000005
060100                                                     COMP-3.      07010005
060200     05  PV-EDIT-DEST                PIC ZZZ9.                    07020005
060300     05  PV-EDIT-PREPK-ID            PIC ZZZ9.                    07030005
060400                                                                  07040005
060500     05  PV-E-COM-WORK-FIELDS.                                    07050005
060600         10  PV-NBR-OF-E-COM-DCS       PIC S9(04)  VALUE +0       07060005
060700                                                     COMP SYNC.   07070005
060800         10  PV-NBR-OF-E-COM-ROWS      PIC S9(04)  VALUE +0       07080005
060900                                                     COMP SYNC.   07090005
061000         10  PV-TTL-BAD-PACK-UPCS       PIC S9(04)  VALUE +0      07100005
061100                                                    COMP SYNC.    07110005
061200         10  PV-TTL-E-COM-PACK-UPCS     PIC S9(04)  VALUE +0      07120005
061300                                                    COMP SYNC.    07130005
061400         10  PV-TTL-PACK-UPCS           PIC S9(04)  VALUE +0      07140005
061500                                                    COMP SYNC.    07150005
061600                                                                  07160005
061700     05  PV-ADJUST-ROUNDED-DC-WRK-FLDS.                           07170005
061800         10  PV-TTL-ALL-DCS-PCT         PIC S9(03) VALUE +0.      07180005
061900         10  PV-TTL-ALL-DCS-UNITS       PIC S9(15) VALUE +0.      07190005
062000         10  PV-TTL-ALL-DCS-CARTS       PIC S9(15) VALUE +0.      07200005
062100         10  PV-TOTAL-NBR-OF-DCS        PIC S9(04) VALUE +0       07210005
062200                                                     COMP SYNC.   07220005
062300         10  PV-DCS-TO-SKIP             PIC S9(05) VALUE +0.      07230005
062400         10  PV-TOTAL-CARTONS           PIC  9(09) VALUE  0.      07240005
062500                                                                  07250005
062600     05  PV-UPC-CARTONS                 PIC S9(15) VALUE +0.      07260005
062700     05  PV-DB2-COUNT                   PIC S9(04) VALUE +0       07270005
062800                                                  COMP SYNC.      07280005
062900     05  PV-OUTR-PK-QTY                 PIC S9(04).               07290005
063000     05  PV-TR006-DEPT-NBR              PIC  9(04).               07300005
063100     05  PV-TR006-DEPT-NBR-X REDEFINES                            07310005
063200         PV-TR006-DEPT-NBR.                                       07320005
063300         10  FILLER                     PIC  X(01).               07330005
063400         10  PV-TR006-DEPT-NBR-3        PIC  X(03).               07340005
063500                                                                  07350005
063600     05 PV-HOLD-PRO-NBR              PIC X(22)  VALUE SPACES.     07360005
063700     05 PV-DCNSL-SCAC                PIC X(04)  VALUE SPACES.     07370005
063800     05 PV-ENT-ID                    PIC 9(09)  VALUE ZEROES.     07380005
063900     05 PV-SEARCH-ENT-ID             PIC 9(09)  VALUE ZEROES.     07390005
064000     05 PV-HOLD-ENT-NAME             PIC X(10)  VALUE SPACES.     07400005
064100                                                                  07410005
064200 01  PV-NULLS-TABLE.                                              07420005
064300     05  PV-VHTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     07430005
064400                                                     COMP SYNC.   07440005
064500     05  PV-VHTRIP-EST-AR-NULL        PIC S9(4)      VALUE +0     07450005
064600                                                     COMP SYNC.   07460005
064700                                                                  07470005
064800 01  PV-CKPT-RESTART-INFO.                                        07480005
064900     05  PV-RESTART-TOT-OUT-REC-COUNT    PIC  S9(13)  VALUE +0    07490005
065000                                                     COMP-3.      07500005
065100     05  PV-RESTART-ERROR-COUNT          PIC S9(13)  VALUE +0     07510005
065200                                                     COMP SYNC.   07520005
065300                                                                  07530005
065400 01  PV-EXTRACT-TABLE.                                            07540005
065500     05  PV-TBL-EXT-ROW                                           07550005
065600              OCCURS 50000 TIMES                                  07560005
065700                  INDEXED BY EXT-INDEX.                           07570005
065800         10  PV-TBL-EXT-TYPE       PIC X(03).                     07580005
065900         10  FILLER                PIC X(247).                    07590005
066000                                                                  07600005
066100 01 PV-DECONSOL-NO-TABLE.                                         07610005
066200    05 PV-DECONSOL-NO-TABLE-ENTRIES OCCURS 100 TIMES              07620005
066300                                 INDEXED BY DECNO-IND.            07630005
066400       10 PV-TBL-DECON-ENT-ID     PIC 9(09).                      07640005
066500       10 PV-TBL-DECON-ENT-NAME   PIC X(10).                      07650005
066600                                                                  07660005
066700*                                                                 07670005
066800*                                                                 07680005
066900*                                                                 07690005
067000*  DECLARATION FOR TRIP/VESSEL (DRIVER) CURSOR                    07700005
067100*                                                                 07710005
067200*                                                                 07720005
067300     EXEC SQL                                                     07730005
067400          DECLARE TRIP_CUR CURSOR WITH HOLD FOR                   07740005
067500           SELECT DISTINCT                                        07750005
067600                  T.EST_AR_TMST                                   07760005
067700                , T.VEH_NBR                                       07770005
067800                , T.TRIP_ID                                       07780005
067900                , S.TRIP_STATUS_CDE                               07790005
068000                , V.VEH_TYP_CDE                                   07800005
068100                , O.POE_CDE                                       07810005
068200             FROM                                                 07820005
068300                  TVHTRIP   T                                     07830005
068400                , TVEHICL   V                                     07840005
068500                , TTRSTYP   Y                                     07850005
068600                , TTRIPST   S                                     07860005
068700                , TIMPORL   R                                     07870005
068800                , TSHIPMT   M                                     07880005
068900                , TSHPTPO   N                                     07890005
069000                , TPLNSHP   O                                     07900005
069100            WHERE   V.VEH_TYP_CDE IN ('VS', 'AV')                 07910005
069200               AND  (T.EST_AR_TMST + 90 DAYS)                     07920005
069300                          > CURRENT TIMESTAMP                     07930072
069400               AND  T.VEH_NBR  = V.VEH_NBR                        07940005
069500               AND  Y.TRIP_STATUS_CDE = S.TRIP_STATUS_CDE         07950005
069600               AND  T.TRIP_ID = S.TRIP_ID                         07960005
069700               AND  T.TRIP_ID = M.TRIP_ID                         07970005
069800               AND  M.SHIPT_ID = N.SHIPT_ID                       07980005
069900               AND  N.SPLT_XMIT_IND   = 'S'                       07990059
070000               AND  N.PO_NBR   = R.PO_NBR                         08000005
070100               AND  R.VER_STATUS_CDE  = 'A'                       08010005
070200               AND (R.DCONSLR_RLSE_CDE IN('S','M') OR             08020005
070300                    (R.DCONSLR_RLSE_CDE = 'D' AND                 08030005
070400                     DCONSLR_ACTL_DTE <>  :PC-NULL-DTE))          08040005
070500               AND  N.PO_NBR   = O.PO_NBR                         08050005
070600               AND  O.VER_STATUS_CDE  = 'A'                       08060005
070700               AND  T.OWNER_SCAC_ID = V.OWNER_SCAC_ID             08070005
070800               AND  Y.PRTY_CDE =                                  08080005
070900                    (SELECT MAX(PRTY_CDE)                         08090005
071000                       FROM TTRIPST  ST                           08100005
071100                          , TTRSTYP  TY                           08110005
071200                     WHERE ST.TRIP_ID = T.TRIP_ID                 08120005
071300                       AND ST.TRIP_STATUS_CDE =                   08130005
071400                           TY.TRIP_STATUS_CDE)                    08140005
071500               AND  Y.PRTY_CDE < '95'                             08150005
071600             ORDER BY O.POE_CDE, T.EST_AR_TMST ,V.VEH_TYP_CDE     08160005
071700     END-EXEC.                                                    08170005
071800*                                                                 08180005
071900*                                                                 08190005
072000*  CURSOR DECLARATION FOR POE CITY                                08200005
072100*                                                                 08210005
072200*  NOTE PO_ASGMT_ALWD_IND  MUST = 'Y' BECAUSE ...                 08220005
072300*                                                                 08230005
072400*                                                                 08240005
072500     EXEC SQL                                                     08250005
072600          DECLARE POE_CUR CURSOR FOR                              08260005
072700           SELECT P.POE_CTY_NM                                    08270005
072800                 ,P.POE_STD_EDI_CDE                               08280005
072900             FROM                                                 08290005
073000                TIMPOE    P                                       08300005
073100             WHERE P.POE_CDE  = :IMPOE-POE-CDE                    08310005
073200               AND P.TRIP_TYP_CDE = 'O'                           08320005
073300               AND P.PO_ASGMT_ALWD_IND = 'Y'                      08330005
073400               AND P.STAT_CDE = 'A'                               08340005
073500        ORDER BY  P.POE_STD_EDI_CDE                               08350005
073600     END-EXEC.                                                    08360005
073700*                                                                 08370005
073800*                                                                 08380005
073900*  CURSOR DECLARATION TO OBTAIN CONTAINER INFORMATION.            08390005
074000*                                                                 08400005
074100*                                                                 08410005
074200     EXEC SQL                                                     08420005
074300          DECLARE CONT_CUR CURSOR FOR                             08430005
074400           SELECT DISTINCT                                        08440005
074500                  M.PRO_NBR                                       08450005
074600                , M.SHIPT_ID                                      08460005
074700             FROM                                                 08470005
074800                  TVHTRIP   T                                     08480005
074900                , TSHIPMT   M                                     08490005
075000                , TSHPTPO   N                                     08500005
075100                , TIMPORL   R                                     08510005
075200                , TSHSTYP   Y                                     08520005
075300                , TSHIPST   S                                     08530005
075400             WHERE  T.TRIP_ID  = M.TRIP_ID                        08540005
075500               AND  M.SHIPT_ID = N.SHIPT_ID                       08550005
075600               AND  N.PO_NBR   = R.PO_NBR                         08560005
075700               AND  N.SPLT_XMIT_IND   = 'S'                       08570005
075800               AND  R.VER_STATUS_CDE  = 'A'                       08580005
075900               AND (R.DCONSLR_RLSE_CDE IN('S','M') OR             08590005
076000                    (R.DCONSLR_RLSE_CDE = 'D' AND                 08600005
076100                     DCONSLR_ACTL_DTE <>  :PC-NULL-DTE))          08610005
076200               AND  M.SHIPT_ID = S.SHIPT_ID                       08620005
076300               AND  Y.SHIPT_STATUS_CDE = S.SHIPT_STATUS_CDE       08630005
076400               AND  M.TRIP_ID = :VHTRIP-TRIP-ID                   08640005
076500               AND  Y.PRTY_CDE =                                  08650005
076600                    (SELECT MAX(TY.PRTY_CDE)                      08660005
076700                       FROM TSHIPST  ST                           08670005
076800                          , TSHSTYP  TY                           08680005
076900                     WHERE ST.SHIPT_ID = S.SHIPT_ID               08690005
077000                       AND ST.SHIPT_STATUS_CDE =                  08700005
077100                           TY.SHIPT_STATUS_CDE)                   08710005
077200               AND  Y.PRTY_CDE < '95'                             08720005
077300     END-EXEC.                                                    08730005
077400*                                                                 08740005
077500*                                                                 08750005
077600*  CURSOR DECLARATION TO OBTAIN PURCHASE ORDERS FOR EACH CONTAINER08760005
077700*                                                                 08770005
077800*                                                                 08780005
077900     EXEC SQL                                                     08790005
078000          DECLARE PO_CUR CURSOR FOR                               08800005
078100           SELECT DISTINCT                                        08810005
078200                  SP.PO_NBR                                       08820005
078300                , SP.EXPTED_CART_CNT                              08830005
078400                , SP.SPLT_XMIT_IND                                08840005
078500             FROM                                                 08850005
078600                  TSHPTPO   SP                                    08860005
078700                , TSHIPMT   SH                                    08870005
078800                , TIMPORL   R                                     08880005
078900             WHERE SP.SHIPT_ID   =  :SHIPMT-SHIPT-ID              08890005
079000               AND  SH.SHIPT_ID   =  SP.SHIPT_ID                  08900005
079100               AND  SP.PO_NBR  = R.PO_NBR                         08910005
079200               AND  SP.SPLT_XMIT_IND   = 'S'                      08920005
079300               AND  R.VER_STATUS_CDE   = 'A'                      08930005
079400               AND (R.DCONSLR_RLSE_CDE IN('S','M') OR             08940005
079500                    (R.DCONSLR_RLSE_CDE = 'D' AND                 08950005
079600                     DCONSLR_ACTL_DTE <>  :PC-NULL-DTE))          08960005
079700     END-EXEC.                                                    08970005
079800*                                                                 08980005
079900*                                                                 08990005
080000*                                                                 09000005
080100*  CURSOR DECLARATION TO OBTAIN SPECIAL INSTRUCTIONS FOR PURCHASE 09010005
080200* ORDERS                                                          09020005
080300*                                                                 09030005
080400*                                                                 09040005
080500     EXEC SQL                                                     09050005
080600          DECLARE INSTR_CUR CURSOR FOR                            09060005
080700           SELECT                                                 09070005
080800                  CD.INSTR_DESC                                   09080005
080900                , CD.INSTR_NBR                                    09090005
081000                , PI.RECIP_CDE                                    09100005
081100             FROM                                                 09110005
081200                  TPOINST   PI                                    09120005
081300                , TINSTCD   CD                                    09130005
081400             WHERE PI.PO_NBR   =  :PURCHS-PO-NBR                  09140005
P40877*              AND (PI.RECIP_CDE = 'DC'                           09150006
P40877*               OR  PI.RECIP_CDE = 'DE')                          09160006
P40877               AND PI.RECIP_CDE = 'DE'                            09170006
081700               AND PI.INSTR_NBR  =  CD.INSTR_NBR                  09180005
081800         ORDER BY PI.RECIP_CDE DESC                               09190005
081900                , CD.INSTR_NBR                                    09200005
082000     END-EXEC.                                                    09210005
082100*                                                                 09220005
082200*                                                                 09230005
082300*  CURSOR DECLARATION TO OBTAIN ALL LINES FOR PURCHASE ORDERS     09240005
082400*                                                                 09250005
082500*                                                                 09260005
082600     EXEC SQL                                                     09270005
082700          DECLARE BULK_UPC_CUR CURSOR FOR                         09280005
082800           SELECT                                                 09290005
082900                  LN.APP_PO_LNE_NBR                               09300005
083000                , LN.PO_LNE_NBR                                   09310005
083100                , XVS.VS_NBR                                      09320005
083200                , XS.CSTM_CLOR_DESC                               09330005
083300                , XS.SIZE_DESC                                    09340005
083400                , XS.NRF_CLOR_CDE                                 09350005
083500                , XS.SKU_DESC                                     09360005
083600                , LN.ITM_NBR                                      09370005
083700                , LN.PO_NBR                                       09380005
083800                , LN.STATUS_CDE                                   09390005
083900                , LN.UNT_QTY                                      09400005
084000                , LN.PREPK_RATO_QTY                               09410005
084100                , SKU.UPC_NBR                                     09420005
084200                , SKX.DEPT                                        09430005
084300                , SKX.CLASS                                       09440005
084400                , SKX.SUBCLASS                                    09450005
084500                , SKX.SKU                                         09460005
084510                , LN.OUTR_PK_QTY                                  09470005
084600             FROM                                                 09480005
084700                  TPURITM   LN                                    09490005
084800                 ,TPURCHS   PO                                    09500005
084900                 ,TUPCSKU   SKU                                   09510005
085000                 ,TUPC      UPC                                   09520005
085100                 ,TSKXREF   SKX                                   09530005
085200                 ,XLT_VND_STYL XVS                                09540005
085300                 ,XLT_SKU      XS                                 09550005
085400             WHERE LN.PO_NBR   =  :PURCHS-PO-NBR                  09560005
085500               AND PO.PO_NBR   =  LN.PO_NBR                       09570005
085600               AND LN.ITM_NBR  =  XS.ITM_NBR                      09580005
085700               AND XS.STYL_ID  =  XVS.STYL_ID                     09590005
085800               AND LN.VER_STATUS_CDE = 'A'                        09600005
085900               AND LN.STATUS_CDE    IN ('AC', 'AP')               09610005
086000               AND PO.VER_STATUS_CDE = 'A'                        09620005
086100               AND SKU.ITEM_NBR   = LN.ITM_NBR                    09630005
086200               AND SKU.UPC_NBR    = UPC.UPC_NBR                   09640005
086300               AND UPC.UPC_TYP_CDE = 'I'                          09650005
086400               AND UPC.EFF_END_DTE IS NULL                        09660005
086500               AND LN.ITM_NBR      = SKX.ITM_NBR                  09670005
086600             ORDER BY LN.APP_PO_LNE_NBR                           09680005
086700     END-EXEC.                                                    09690005
086800*                                                                 09700005
086900*                                                                 09710005
087000*  CURSOR DECLARATION TO OBTAIN ALL DISTRIBUTION CENTERS FOR LINES09720005
087100*  ON PURCHASE ORDER.                                             09730005
087200*                                                                 09740005
087300*                                                                 09750005
087400     EXEC SQL                                                     09760005
087500          DECLARE DC_CUR CURSOR FOR                               09770005
087600           SELECT                                                 09780005
087700                  AL.DEST_NBR                                     09790005
087800                , AL.DC_SPLIT_QTY                                 09800005
087900                , AL.CURR_SPLIT_QTY                               09810005
088000                , AL.PLAN_NBR                                     09820005
155029                , XL.E_BUS_IND                                    09830074
088100             FROM                                                 09840005
088200                  TPURITM   LN                                    09850005
088300                , TALLPLN   AL                                    09860005
155029                , XLT_LOC   XL                                    09870074
088400             WHERE AL.PO_NBR         = :PURITM-PO-NBR             09880005
088500               AND AL.PO_NBR         =  LN.PO_NBR                 09890005
088600               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         09900005
088700               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             09910005
155029               AND AL.DEST_NBR       =  XL.LOC_NBR                09920074
088800               AND AL.CURR_SPLIT_QTY >  0                         09930005
088900               AND LN.VER_STATUS_CDE = 'A'                        09940005
089000               AND LN.STATUS_CDE    IN ('AC', 'AP')               09950005
155029             ORDER BY XL.E_BUS_IND                                09960074
089100                     ,AL.CURR_SPLIT_QTY                           09970048
089200     END-EXEC.                                                    09980005
089300*                                                                 09990005
089400*                                                                 10000005
089500*  CURSOR DECLARATION TO OBTAIN CARTONS PER PO FOR PREPACK ORDERS 10010005
089600*  (THIS IS NOT THE MAIN PREPACK CURSOR)                          10020005
089700*                                                                 10030005
089800*                                                                 10040005
089900     EXEC SQL                                                     10050005
090000          DECLARE POPRPK_FOR_PO_CUR CURSOR FOR                    10060005
090100           SELECT                                                 10070005
090200                  A.PO_PREPK_ID                                   10080005
090300                 ,A.OTPK_UNT_QTY                                  10090005
090400                 ,A.INPK_UNT_QTY                                  10100005
090400                 ,A.PREPK_TYP_CDE                                 10110007
090500             FROM                                                 10120005
090600                  TPOPRPK  A                                      10130005
090700             WHERE A.PO_NBR         = :PURCHS-PO-NBR              10140005
090800             ORDER BY A.PO_PREPK_ID                               10150005
090900     END-EXEC.                                                    10160005
091000*                                                                 10170005
091100*                                                                 10180005
091200*  CURSOR DECLARATION TO OBTAIN CARTONS PER PO FOR BULK ORDERS    10190005
091300*                                                                 10200005
091400*                                                                 10210005
091500*    EXEC SQL                                                     10220005
091600*         DECLARE PURITM_TUPC_CUR CURSOR FOR                      10230005
091700*          SELECT                                                 10240005
091800*               UPC.OUTR_PK_QTY                                   10250005
091900*              ,I.UNT_QTY                                         10260005
092000*            FROM                                                 10270005
092100*                 TPURITM  I                                      10280005
092200*                ,TSKXREF  SKX                                    10290005
092300*                ,TUPC     UPC                                    10300005
092400*            WHERE I.PO_NBR         = :PURCHS-PO-NBR              10310005
092500*            AND   I.ITM_NBR        =  SKX.ITM_NBR                10320005
092600*            AND   SKX.INTR_UPC_ID  =  UPC.INTR_UPC_ID            10330005
092700*            AND   UPC.UPC_TYP_CDE  = 'I'                         10340005
092800*            AND   I.VER_STATUS_CDE = 'A'                         10350005
092900*            AND   I.STATUS_CDE     IN ('AC', 'AP')               10360005
093000*            ORDER BY I.ITM_NBR                                   10370005
093001*    END-EXEC.                                                    10380005
093002                                                                  10390005
093003     EXEC SQL                                                     10400005
093004          DECLARE PURITM_TUPC_CUR CURSOR FOR                      10410005
093005           SELECT                                                 10420005
093006                I.OUTR_PK_QTY                                     10430005
093007               ,I.UNT_QTY                                         10440005
093008             FROM                                                 10450005
093009                  TPURITM  I                                      10460005
093012             WHERE I.PO_NBR         = :PURCHS-PO-NBR              10470005
093016             AND   I.VER_STATUS_CDE = 'A'                         10480005
093017             AND   I.STATUS_CDE     IN ('AC', 'AP')               10490005
093018             ORDER BY I.ITM_NBR                                   10500005
093019     END-EXEC.                                                    10510005
093020*                                                                 10520005
093021*                                                                 10530005
093022*  CURSOR DECLARATION - MAIN PREPACK CURSOR                       10540005
093023*                                                                 10550005
093024*                                                                 10560005
093025     EXEC SQL                                                     10570005
093026          DECLARE POPRPK_FOR_PCK_CUR CURSOR FOR                   10580005
093027           SELECT POP.PO_PREPK_ID                                 10590005
093028                , POP.INPK_UNT_QTY                                10600005
093029                , POP.OTPK_UNT_QTY                                10610005
093030                , POP.PREPK_DESC                                  10620005
093040                , POP.PREPK_UPC_NBR                               10630005
093050                , POP.PK_SKU_NBR                                  10640005
090400                , POP.PREPK_TYP_CDE                               10650007
093060             FROM TPOPRPK  POP                                    10660005
093070            WHERE POP.PO_NBR       = :PURCHS-PO-NBR               10670005
093080              AND EXISTS                                          10680005
093090                (SELECT *                                         10690005
093100                   FROM TPURITM      A                            10700005
093200                       ,TUPCSKU      B                            10710005
093300                       ,TUPC         C                            10720005
093400                       ,TSKXREF      D                            10730005
093500                       ,XLT_VND_STYL XVS                          10740005
093600                       ,XLT_SKU      XS                           10750005
093700                   WHERE A.PO_NBR    =  :PURCHS-PO-NBR            10760005
093800                     AND A.ITM_NBR   =  XS.ITM_NBR                10770005
093900                     AND XS.STYL_ID  =  XVS.STYL_ID               10780005
094000                     AND A.VER_STATUS_CDE = 'A'                   10790005
094100                     AND A.STATUS_CDE IN ('AC', 'AP')             10800005
094200                     AND A.PO_PREPK_ID = POP.PO_PREPK_ID          10810005
094300                     AND B.ITEM_NBR     = A.ITM_NBR               10820005
094400                     AND B.UPC_NBR      = C.UPC_NBR               10830005
094500                     AND C.UPC_TYP_CDE = 'I'                      10840005
094600                     AND C.EFF_END_DTE IS NULL                    10850005
094700                     AND A.ITM_NBR     = D.ITM_NBR                10860005
094800                 )                                                10870005
094900            ORDER BY POP.PO_PREPK_ID                              10880005
095000     END-EXEC.                                                    10890005
095100*                                                                 10900005
095200*                                                                 10910005
095300*  CURSOR DECLARATION TO OBTAIN PACK DC INFORMATION FOR           10920005
095400*  PURCHASE ORDER                                                 10930005
095500*                                                                 10940005
095600     EXEC SQL                                                     10950005
095700          DECLARE PREPACK_DC_CUR CURSOR FOR                       10960005
095800           SELECT DISTINCT                                        10970005
095900              SUM (A.CURR_SPLIT_QTY) AS SUMSPLIT                  10980005
096000                 ,A.DEST_NBR                                      10990005
155029                 ,X.E_BUS_IND                                     11000074
096100             FROM                                                 11010005
096200                  TALLPLN  A                                      11020005
096300                 ,TPURITM  B                                      11030005
155029                 ,XLT_LOC  X                                      11040074
096400             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                11050005
096500               AND A.PO_NBR      =  B.PO_NBR                      11060005
096600               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  11070005
155029               AND A.DEST_NBR    =  X.LOC_NBR                     11080074
096700               AND A.CURR_SPLIT_QTY >  0                          11090005
096800               AND B.VER_STATUS_CDE = 'A'                         11100005
096900               AND B.STATUS_CDE    IN ('AC', 'AP')                11110005
097000               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           11120005
097100          GROUP BY A.DEST_NBR                                     11130005
155029                  ,X.E_BUS_IND                                    11140074
155029          ORDER BY X.E_BUS_IND                                    11150074
097200                  ,SUMSPLIT                                       11160048
097300                  ,A.DEST_NBR                                     11170005
097400     END-EXEC.                                                    11180005
097500*                                                                 11190005
097600*                                                                 11200005
097700*  CURSOR DECLARATION TO OBTAIN PREPACK PO LINE LEVEL INFO FOR    11210005
097800*  PURCHASE ORDER.                                                11220005
097900*                                                                 11230005
098000*                                                                 11240005
098100     EXEC SQL                                                     11250005
098200          DECLARE PACK_UPC_CUR CURSOR FOR                         11260005
098300           SELECT                                                 11270005
098400                  A.PO_NBR                                        11280005
098500                , A.APP_PO_LNE_NBR                                11290005
098600                , A.PO_LNE_NBR                                    11300005
098700                , XVS.VS_NBR                                      11310005
098800                , XS.CSTM_CLOR_DESC                               11320005
098900                , XS.SIZE_DESC                                    11330005
099000                , XS.NRF_CLOR_CDE                                 11340005
099100                , XS.SKU_DESC                                     11350005
099200                , A.ITM_NBR                                       11360005
099300                , A.STATUS_CDE                                    11370005
099400                , A.UNT_QTY                                       11380005
099500                , A.PREPK_RATO_QTY                                11390005
099600                , C.UPC_NBR                                       11400005
099700                , D.DEPT                                          11410005
099800                , D.CLASS                                         11420005
099900                , D.SUBCLASS                                      11430005
100000                , D.SKU                                           11440005
100100             FROM                                                 11450005
100200                  TPURITM  A                                      11460005
100300                 ,TUPCSKU  B                                      11470005
100400                 ,TUPC     C                                      11480005
100500                 ,TSKXREF  D                                      11490005
100600                 ,XLT_VND_STYL XVS                                11500005
100700                 ,XLT_SKU      XS                                 11510005
100800             WHERE A.PO_NBR    =  :PURCHS-PO-NBR                  11520005
100900               AND A.ITM_NBR   =  XS.ITM_NBR                      11530005
101000               AND XS.STYL_ID  =  XVS.STYL_ID                     11540005
101100               AND A.VER_STATUS_CDE = 'A'                         11550005
101200               AND A.STATUS_CDE    IN ('AC', 'AP')                11560005
101300               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           11570005
101400               AND B.ITEM_NBR     = A.ITM_NBR                     11580005
101500               AND B.UPC_NBR      = C.UPC_NBR                     11590005
101600               AND C.UPC_TYP_CDE  = 'I'                           11600005
101700               AND C.EFF_END_DTE IS NULL                          11610005
101800               AND A.ITM_NBR      = D.ITM_NBR                     11620005
101900             ORDER BY A.PO_LNE_NBR                                11630005
102000     END-EXEC.                                                    11640005
102100*                                                                 11650005
102200*                                                                 11660005
102300*  CURSOR DECLRATION TO OBTAIN E-COMMERCE PREPACK UPC LEVEL DATA  11670005
102400*                                                                 11680005
102500*                                                                 11690005
102600     EXEC SQL                                                     11700005
102700          DECLARE E_COM_PACK_UPC_CUR CURSOR FOR                   11710005
102800           SELECT                                                 11720005
102900                  C.UPC_NBR                                       11730005
103000                 ,A.PO_LNE_NBR                                    11740005
103100             FROM                                                 11750005
103200                  TPURITM  A                                      11760005
103300                 ,TUPCSKU  B                                      11770005
103400                 ,TUPC     C                                      11780005
103500                 ,TPOPRPK  D                                      11790005
103600             WHERE A.PO_NBR       = :PURCHS-PO-NBR                11800005
103700               AND A.VER_STATUS_CDE = 'A'                         11810005
103800               AND A.STATUS_CDE  IN ('AC', 'AP')                  11820005
103900               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           11830005
104000               AND B.ITEM_NBR     = A.ITM_NBR                     11840005
104100               AND B.UPC_NBR      = C.UPC_NBR                     11850005
104200               AND C.UPC_TYP_CDE  = 'I'                           11860005
104300               AND C.EFF_END_DTE IS NULL                          11870005
104400               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 11880005
104500               AND D.PO_NBR       = A.PO_NBR                      11890005
104600             ORDER BY B.UPC_NBR                                   11900005
104700     END-EXEC.                                                    11910005
139868*                                                                 11920038
139868*                                                                 11930038
139868*  CURSOR DECLARATION TO OBTAIN ALL OUTLET STORES FOR LINES ON    11940038
139868*  THE PURCHASE ORDER.                                            11950038
139868*                                                                 11960038
139868*                                                                 11970038
139868     EXEC SQL                                                     11980038
139868          DECLARE DC_OUT_CUR CURSOR FOR                           11990038
139868           SELECT                                                 12000038
139868                  ES.STR_NBR                                      12010038
139868                , ES.STR_DISTRO_QTY                               12020038
139868             FROM                                                 12030038
139868                  TPURITM   LN                                    12040038
139868                , TMESTDS   ES                                    12050038
155029                , TALLPLN   PL                                    12060074
139868             WHERE ES.PO_NBR         = :PURITM-PO-NBR             12070038
155029               AND ES.PLAN_NBR       = :ALLPLN-PLAN-NBR           12080074
155029               AND PL.PLAN_NBR       =  ES.PLAN_NBR               12090074
139868               AND ES.PO_NBR         =  LN.PO_NBR                 12100038
155029               AND ES.PO_NBR         =  PL.PO_NBR                 12110074
139868               AND ES.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         12120038
139868               AND ES.PO_LNE_NBR     =  LN.PO_LNE_NBR             12130038
155029               AND ES.PO_LNE_NBR     =  PL.PO_LNE_NBR             12140074
139868               AND ES.STR_DISTRO_QTY > 0                          12150038
139868               AND LN.VER_STATUS_CDE = 'A'                        12160038
139868               AND LN.STATUS_CDE    IN ('AC', 'AP')               12170038
139868             ORDER BY ES.STR_DISTRO_QTY                           12180038
139868     END-EXEC.                                                    12190038
139868*                                                                 12200038
139868*                                                                 12210038
139868*  CURSOR DECLARATION TO OBTAIN OUTLET STORE PACK DC INFORMATION  12220038
139868*  FOR THE PURCHASE ORDER                                         12230038
139868*                                                                 12240038
139868     EXEC SQL                                                     12250038
139868          DECLARE PRPACK_DC_OUT_CUR CURSOR FOR                    12260038
139868           SELECT DISTINCT                                        12270038
139868                  ES.STR_NBR                                      12280038
139868                 ,SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             12290038
139868             FROM                                                 12300038
139868                  TMESTDS  ES                                     12310038
139868                 ,TPURITM  PU                                     12320038
139868             WHERE ES.PO_NBR         = :PURCHS-PO-NBR             12330038
155029               AND ES.PLAN_NBR       = :ALLPLN-PLAN-NBR           12340074
139868               AND ES.PO_NBR         = PU.PO_NBR                  12350038
139868               AND ES.PO_LNE_NBR     = PU.PO_LNE_NBR              12360038
139868               AND ES.STR_DISTRO_QTY > 0                          12370038
139868               AND PU.VER_STATUS_CDE = 'A'                        12380038
139868               AND PU.STATUS_CDE  IN   ('AC', 'AP')               12390038
139868               AND PU.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID        12400038
139868          GROUP BY ES.STR_NBR                                     12410038
139868          ORDER BY SUMSPLIT                                       12420038
139868                  ,ES.STR_NBR                                     12430038
139868     END-EXEC.                                                    12440038
139868                                                                  12450038
104800******************************************************************12460005
104900 LINKAGE SECTION.                                                 12470005
105000******************************************************************12480005
105100                                                                  12490005
105200******************************************************************12500005
105300 PROCEDURE DIVISION.                                              12510005
105400******************************************************************12520005
105500                                                                  12530005
105600******************************************************************12540005
105700 0000-PROGRAM-MAINLINE.                                           12550005
105800                                                                  12560005
105900     DISPLAY 'EFC2 TRKUP006 STARTED'.                             12570005
106000                                                                  12580005
106100     PERFORM 1000-INITIALIZE.                                     12590005
106200                                                                  12600005
106300     PERFORM 2000-CREATE-EXTRACT-FILES                            12610005
106400         UNTIL PS-EOC-DRIVER-CURSOR                               12620005
106500                                                                  12630005
106600     PERFORM 9000-EOJ-ROUTINE.                                    12640022
106700     STOP RUN.                                                    12650005
106800                                                                  12660005
106900******************************************************************12670005
107000*  FIRST OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO  12680005
107100*  REPORT FILES.                                                  12690005
107200******************************************************************12700005
107300 1000-INITIALIZE.                                                 12710005
107400                                                                  12720005
107500     INITIALIZE PV-DECONSOL-NO-TABLE.                             12730005
107600     OPEN  INPUT INPUT-ENT-FILE.                                  12740005
107700     PERFORM 1020-READ-INPUT-ENT-FILE.                            12750005
107800     SET DECNO-IND TO 1.                                          12760005
107900     PERFORM 1010-BUILD-ENT-TABLE                                 12770005
108000       UNTIL PS-END-OF-INPUT-ENT-FILE                             12780005
108100          OR DECNO-IND > PC-DECONSOL-TBL-LIMIT.                   12790005
108200     IF DECNO-IND > PC-DECONSOL-TBL-LIMIT                         12800005
108300       DISPLAY  '***********************************************' 12810005
108400       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 12820005
108500       DISPLAY  '** PROGRAM = TRKUP006                        **' 12830005
108600       DISPLAY  '** PARAGRAPGH  - 1000-INITIALIZE             **' 12840005
108700       DISPLAY  '**                                           **' 12850005
108800       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 12860005
108900       DISPLAY  '**                                           **' 12870005
109000       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 12880005
109100       DISPLAY  '**                                           **' 12890005
109200       DISPLAY  '**             PV-DECONSOL-NO-TABLE          **' 12900005
109300       DISPLAY  '**                                           **' 12910005
109400       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 12920005
109500       DISPLAY  '**                                           **' 12930005
109600       DISPLAY  '**             PC-DECONSOL-TBL-LIMIT         **' 12940005
109700       DISPLAY  '**                                           **' 12950005
109800       DISPLAY  '***********************************************' 12960005
109900     END-IF.                                                      12970005
110000                                                                  12980005
110100     PERFORM 1100-RETREVE-CURRENT-TIMESTAMP.                      12990005
110200                                                                  13000005
110300     INITIALIZE PA-TOTAL-OUTPUT-REC-COUNT.                        13010005
110400     INITIALIZE PV-HOLD-TR020-PO-NBR                              13020005
110500                PV-HOLD-TR020-CONTNR-ID                           13030005
110600                PV-HOLD-TR020-PROCESS-DATE.                       13040005
110700                                                                  13050005
110800     PERFORM 6500-GET-CHECKPOINT-CNTL.                            13060005
110900     MOVE PV-CKPT-STAT-CODE       TO                              13070005
111000         PS-RUN-TYPE-SW.                                          13080005
111100                                                                  13090005
111200     IF PS-RESTART-RUN                                            13100005
111300         PERFORM 6550-CHECKPOINT-RESTART                          13110005
111400     END-IF.                                                      13120005
111500                                                                  13130005
111600     MOVE SPACES TO PV-EXTRACT-TABLE.                             13140005
111700     SET EXT-INDEX TO +1.                                         13150005
111800                                                                  13160005
111900     INITIALIZE TR004-REC-TYPE-POE                                13170005
112000                TR004-REC-TYPE-ETA                                13180005
112100                TR004-REC-TYPE-VES                                13190005
112200                TR004-REC-TYPE-CONTAINER                          13200005
112300                TR004-REC-TYPE-PO                                 13210005
112400                TR004-REC-TYPE-INS                                13220005
112500                TR004-REC-TYPE-UPC                                13230005
112600                TR004-REC-TYPE-DC                                 13240005
112700                TR004-REC-TYPE-PCK                                13250005
112800                TR004-REC-TYPE-PDC                                13260005
112900                TR020-REC-TYPE-PO                                 13270023
113000                TR020-REC-TYPE-CONTNR                             13280005
113100                TR020-REC-TYPE-INS                                13290005
113200                TR020-REC-TYPE-UPC                                13300005
113300                TR020-REC-TYPE-PCK                                13310005
113400                TR020-REC-TYPE-PDC                                13320005
113500                DCLTIMPOE.                                        13330005
113600                                                                  13340005
113700     INITIALIZE TR006-RECORD.                                     13350005
113800     MOVE 'T'                     TO TR006-REPORT-TYPE.           13360005
113900     MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM.            13370005
114000     MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD.            13380005
114100     MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY.          13390005
114200     MOVE TR006-PROCESS-DATE      TO PV-HOLD-TR020-PROCESS-DATE.  13400005
114300                                                                  13410005
114400     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    13420005
114500                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   13430005
107910                                                                  13440023
114700     PERFORM 7000-OPEN-DRIVER-CURSOR.                             13450005
114800                                                                  13460005
114900     SET PS-GOOD-STATUS-CDE-FOUND-NO    TO TRUE.                  13470005
115000     PERFORM 7020-FETCH-DRIVER-CURSOR UNTIL                       13480005
115100        PS-GOOD-STATUS-CDE-FOUND  OR                              13490005
115200        PS-EOC-DRIVER-CURSOR                                      13500005
115300                                                                  13510005
115400     IF PS-EOC-DRIVER-CURSOR                                      13520005
115500         CONTINUE                                                 13530005
115600     ELSE                                                         13540005
115700         PERFORM 4600-SET-CHECKPOINT-TIME                         13550005
115800     END-IF.                                                      13560005
115900                                                                  13570005
116000****************************************************************  13580005
116100* 1010-BUILD-ENT-TABLE - BUILD ENTITY TABLE FROM INPUT-ENT-FILE*  13590005
116200****************************************************************  13600005
116300 1010-BUILD-ENT-TABLE.                                            13610005
116400                                                                  13620005
116500     IF TR030-ENT-ID NUMERIC                                      13630005
116600         MOVE TR030-ENT-ID                                        13640005
116700         TO   PV-TBL-DECON-ENT-ID (DECNO-IND)                     13650005
116800     ELSE                                                         13660005
116900         DISPLAY '** INVALID ENTITY ID '                          13670005
117000         TR030-DCONSLR-ENT-TBL-REC                                13680005
117100     END-IF.                                                      13690005
117200                                                                  13700005
117300     MOVE TR030-ENT-DCONSLR-NAME                                  13710005
117400                       TO PV-TBL-DECON-ENT-NAME(DECNO-IND).       13720005
117500                                                                  13730005
117600     PERFORM 1020-READ-INPUT-ENT-FILE                             13740005
117700     SET DECNO-IND UP BY 1.                                       13750005
117800                                                                  13760005
117900                                                                  13770005
118000****************************************************************  13780005
118100* READ IN CONTROL FILE                                         *  13790005
118200****************************************************************  13800005
118300 1020-READ-INPUT-ENT-FILE.                                        13810005
118400                                                                  13820005
118500     READ INPUT-ENT-FILE INTO TR030-DCONSLR-ENT-TBL-REC           13830005
118600       AT END                                                     13840005
118700        SET PS-END-OF-INPUT-ENT-FILE TO TRUE.                     13850005
118800                                                                  13860005
139868******************************************************************13870038
139868** SELECT PARM - CHECK IF THIS IS AN OUTLET STORE               **13880038
139868******************************************************************13890038
139868 1050-CHECK-IF-OUTLET-DC.                                         13900038
139868                                                                  13910038
139868     MOVE 'TRCNSP'             TO KRPRPM-SYS-PRC-FUNC-CDE.        13920038
139868     MOVE 'KHL'                TO KRPRPM-INTFC-SYS-CDE.           13930038
139868     MOVE 'AC'                 TO KRPRPM-FUNC-PRC-STAT-CDE.       13940038
139868     MOVE 'Y'                  TO KRPRPM-FUNC-TXT.                13950038
139868                                                                  13960038
139868        EXEC SQL                                                  13970038
139868            SELECT LOC_ID                                         13980038
139868              INTO :KRPRPM-LOC-ID                                 13990038
139868              FROM  TKRPRPM                                       14000038
139868             WHERE  LOC_ID            = :KRPRPM-LOC-ID            14010038
139868               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  14020038
139868               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     14030038
139868               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 14040038
139868               AND  FUNC_TXT          = :KRPRPM-FUNC-TXT          14050038
139868             WITH UR                                              14060038
139868        END-EXEC.                                                 14070038
139868                                                                  14080038
139868        EVALUATE TRUE                                             14090038
139868            WHEN SQLCODE = +0                                     14100038
139868                SET PS-OUTLET-STORE     TO TRUE                   14110038
139868                                                                  14120038
139868            WHEN SQLCODE = +100                                   14130038
139868                SET PS-OUTLET-STORE-NO  TO TRUE                   14140038
139868                                                                  14150038
139868            WHEN SQLWARN0 NOT = SPACES                            14160038
139868            WHEN SQLCODE < +0                                     14170038
139868            WHEN SQLCODE > +0                                     14180038
139868             DISPLAY '** ABEND **'                                14190038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   14200038
139868             DISPLAY '** PARAGRAPH = 1050-CHECK-IF-OUTLET-DC **'  14210038
139868             DISPLAY '** KRPRPM-LOC-ID            = '             14220038
139868                                          KRPRPM-LOC-ID           14230038
139868             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE  = '             14240038
139868                                          KRPRPM-SYS-PRC-FUNC-CDE 14250038
139868             DISPLAY '** KRPRPM-INTFC-SYS-CDE     = '             14260038
139868                                          KRPRPM-INTFC-SYS-CDE    14270038
139868             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             14280038
139868                                          KRPRPM-FUNC-PRC-STAT-CDE14290038
139868             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           14300038
139868             PERFORM 9100-SQL-ABEND                               14310038
139868        END-EVALUATE.                                             14320038
139868                                                                  14330038
118900******************************************************************14340005
119000 1100-RETREVE-CURRENT-TIMESTAMP.                                  14350005
119100                                                                  14360005
119200     EXEC SQL                                                     14370005
119300         SET  :PV-CURRENT-TIME =                                  14380005
119400                 CURRENT TIMESTAMP                                14390005
119500     END-EXEC.                                                    14400005
119600                                                                  14410005
119700     EVALUATE TRUE                                                14420005
119800         WHEN SQLWARN0 NOT EQUAL SPACE                            14430005
119900         WHEN SQLCODE NOT EQUAL ZERO                              14440005
120000             DISPLAY '** ABEND **'                                14450005
120100             DISPLAY '** PROGRAM = TRKUP006 **'                   14460005
120200             DISPLAY '** PARAGRAPH = 1100-RETREVE-CURRENT-TIME**' 14470005
120300             DISPLAY '** UNSUCCESSFUL SELECT OF TIME**'           14480005
120400             PERFORM 9100-SQL-ABEND                               14490022
120500     END-EVALUATE.                                                14500005
120600                                                                  14510005
120700 EJECT                                                            14520005
120800******************************************************************14530005
120900* PROCESS:  THIS PARAGRAPH WILL SET UP AND WRITE EXTRACT RECORDS  14540005
121000******************************************************************14550005
121100 2000-CREATE-EXTRACT-FILES.                                       14560005
121200                                                                  14570005
121300     IF IMPOE-POE-CDE = SPACES                                    14580005
121400         EVALUATE TRUE                                            14590005
121500             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEE'                   14600005
121600                 MOVE 'NY' TO IMPOE-POE-CDE                       14610005
121700             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEW'                   14620005
121800                 MOVE 'LA' TO IMPOE-POE-CDE                       14630005
121900             WHEN VHTRIP-OWNER-SCAC-ID = 'OCEN'                   14640005
122000                 MOVE 'CH' TO IMPOE-POE-CDE                       14650005
122100             WHEN VHTRIP-OWNER-SCAC-ID = 'OCES'                   14660005
122200                 MOVE 'MI' TO IMPOE-POE-CDE                       14670005
122300             WHEN VHTRIP-OWNER-SCAC-ID = 'OCNW'                   14680005
122400                 MOVE 'SE' TO IMPOE-POE-CDE                       14690005
122500         END-EVALUATE                                             14700005
122600     END-IF.                                                      14710005
122700                                                                  14720005
122800     IF IMPOE-POE-CDE = PV-HOLD-POE-CDE                           14730005
122900         CONTINUE                                                 14740005
123000     ELSE                                                         14750005
123100         MOVE IMPOE-POE-CDE    TO PV-HOLD-POE-CDE                 14760005
123200                                  TR020-POE-CDE-CONTNR            14770005
123300         PERFORM 7100-OPEN-POE-CURSOR                             14780005
123400         PERFORM 7120-FETCH-POE-CURSOR                            14790005
123500         PERFORM 7110-CLOSE-POE-CURSOR                            14800005
123600*        *********************************************************14810005
123700*        * WE DON'T REALLY SEND TR004-PORT-OF-ENTRY-CTY BUT THE  *14820005
123800*        * LOGIC IS HERE SO THAT INIT POE RECS WRITE IN THERE    *14830005
123900*        * NORMAL SPOTS ON RETRAN FILE.                          *14840005
124000*        *********************************************************14850005
124100         IF PS-EOC-POE-CURSOR                                     14860005
124200           MOVE 'POE CODE NOT ON TABLE - '                        14870005
124300                              TO TR004-PORT-OF-ENTRY-CTY (1:24)   14880005
124400                                 IMPOE-POE-CTY-NM                 14890005
124500           IF IMPOE-POE-CDE < SPACES                              14900005
124600             MOVE SPACES TO TR004-PORT-OF-ENTRY-CTY (24:3)        14910005
124700           ELSE                                                   14920005
124800             MOVE IMPOE-POE-CDE TO TR004-PORT-OF-ENTRY-CTY (24:3) 14930005
124900           END-IF                                                 14940005
125000           SET PS-EOC-POE-CURSOR-NO TO TRUE                       14950005
125100         ELSE                                                     14960005
125200           MOVE IMPOE-POE-CTY-NM TO TR004-PORT-OF-ENTRY-CTY       14970005
125300         END-IF                                                   14980005
125400*        ******************************************************** 14990005
125500*        * EVEN THOUGH THE PORT OF ENTRY CODES ARE UNEQUAL, THE * 15000005
125600*        * PROCESS CAN TURN UP THE SAME POE CITY NAME.          * 15010005
125700*        ******************************************************** 15020005
125800         IF IMPOE-POE-CTY-NM        = PV-HOLD-PORT-OF-ENTRY-CTY   15030005
125900           CONTINUE                                               15040005
126000         ELSE                                                     15050005
126100           MOVE IMPOE-POE-CTY-NM  TO PV-HOLD-PORT-OF-ENTRY-CTY    15060005
126200           SET TR004-PROCESS-POE-RETRANS-CON TO TRUE              15070005
126300           SET PS-POE-WRITTEN-NO TO TRUE                          15080005
126400           SET PS-ETA-WRITTEN-NO TO TRUE                          15090005
126500           SET PS-VES-WRITTEN-NO TO TRUE                          15100005
126600           SET PS-CON-WRITTEN-NO TO TRUE                          15110005
126700         END-IF                                                   15120005
126800     END-IF.                                                      15130005
126900                                                                  15140005
127000     IF VHTRIP-EST-AR-TMST (1:10) = PV-HOLD-VHTRIP-EST-AR-TMST    15150005
127100         CONTINUE                                                 15160005
127200     ELSE                                                         15170005
127300         INITIALIZE TR004-REC-TYPE-ETA                            15180005
127400         SET TR004-PROCESS-ETA-RETRANS-CON TO TRUE                15190005
127500         INITIALIZE TR006-RECORD                                  15200005
127600         INITIALIZE TR020-REC-TYPE-PO                             15210005
127700         MOVE 'T'                     TO TR006-REPORT-TYPE        15220005
127800         MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM         15230005
127900         MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD         15240005
128000         MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY       15250005
128100         MOVE TR006-PROCESS-DATE  TO PV-HOLD-TR020-PROCESS-DATE   15260005
128200                                                                  15270005
128300         MOVE VHTRIP-EST-AR-TMST (1:4)  TO                        15280005
128400             TR004-VESSEL-ETA-DATE (1:4)                          15290005
128500             TR006-ETA-DATE (1:4)                                 15300005
128600         MOVE VHTRIP-EST-AR-TMST (6:2)  TO                        15310005
128700             TR004-VESSEL-ETA-DATE (5:2)                          15320005
128800             TR006-ETA-DATE (5:2)                                 15330005
128900         MOVE VHTRIP-EST-AR-TMST (9:2)  TO                        15340005
129000             TR004-VESSEL-ETA-DATE (7:2)                          15350005
129100             TR006-ETA-DATE (7:2)                                 15360005
129200         MOVE TR004-VESSEL-ETA-DATE     TO                        15370005
129300             TR020-VESSEL-ETA-DATE-CONTNR                         15380005
129400         SET PS-ETA-WRITTEN-NO TO TRUE                            15390005
129500         SET PS-VES-WRITTEN-NO TO TRUE                            15400005
129600         SET PS-CON-WRITTEN-NO TO TRUE                            15410005
129700         MOVE VHTRIP-EST-AR-TMST (1:10) TO                        15420005
129800             PV-HOLD-VHTRIP-EST-AR-TMST                           15430005
129900     END-IF.                                                      15440005
130000                                                                  15450005
130100     IF VHTRIP-VEH-NBR = PV-HOLD-VHTRIP-VEH-NBR                   15460005
130200         CONTINUE                                                 15470005
130300     ELSE                                                         15480005
130400         MOVE VHTRIP-VEH-NBR   TO PV-HOLD-VHTRIP-VEH-NBR          15490005
130500         INITIALIZE TR004-REC-TYPE-VES                            15500005
130600         SET TR004-PROCESS-VES-RETRANS-CON TO TRUE                15510005
130700         INITIALIZE TR006-VESSEL-NAME                             15520005
130800                                                                  15530005
130900         MOVE VHTRIP-VEH-NBR             TO                       15540005
131000             TR006-VESSEL-NAME                                    15550005
131100             TR004-VESSEL-NAME                                    15560005
131200                                                                  15570005
131300         EVALUATE VEHICL-VEH-TYP-CDE                              15580005
131400             WHEN 'VS'                                            15590005
131500                 MOVE PC-O               TO                       15600005
131600                     TR004-TRIP-TYP-CDE                           15610005
131700             WHEN 'AV'                                            15620005
131800                 MOVE PC-A               TO                       15630005
131900                     TR004-TRIP-TYP-CDE                           15640005
132000             WHEN 'TR'                                            15650005
132100                 MOVE PC-M               TO                       15660005
132200                     TR004-TRIP-TYP-CDE                           15670005
132300             WHEN OTHER                                           15680005
132400                 MOVE SPACE              TO                       15690005
132500                     TR004-TRIP-TYP-CDE                           15700005
132600         END-EVALUATE                                             15710005
132700         SET PS-VES-WRITTEN-NO TO TRUE                            15720005
132800         SET PS-CON-WRITTEN-NO TO TRUE                            15730005
132900     END-IF.                                                      15740005
133000                                                                  15750005
133100                                                                  15760005
133200     PERFORM 7300-OPEN-CONT-CURSOR.                               15770005
133300                                                                  15780005
133400     PERFORM 2100-PROCESS-CONTAINERS UNTIL                        15790005
133500         PS-EOC-CONT-CURSOR.                                      15800005
133600     SET PS-EOC-CONT-CURSOR-NO    TO TRUE.                        15810005
133700                                                                  15820005
133800     PERFORM 4400-CHECKPOINT-CHECK.                               15830005
133900                                                                  15840005
134000     SET PS-GOOD-STATUS-CDE-FOUND-NO    TO TRUE.                  15850005
134100     PERFORM 7020-FETCH-DRIVER-CURSOR UNTIL                       15860005
134200        PS-GOOD-STATUS-CDE-FOUND  OR                              15870005
134300        PS-EOC-DRIVER-CURSOR.                                     15880005
134400                                                                  15890005
134500******************************************************************15900005
134600*  PROCESS ALL CONTAINERS FOR THIS TRIP.                          15910005
134700******************************************************************15920005
134800                                                                  15930005
134900 2100-PROCESS-CONTAINERS.                                         15940005
135000                                                                  15950005
135100     INITIALIZE TR004-REC-TYPE-CONTAINER.                         15960005
135200                                                                  15970005
135300     PERFORM 7500-FETCH-CONT-CURSOR.                              15980005
135400                                                                  15990005
135500     IF PS-EOC-CONT-CURSOR                                        16000005
135600         PERFORM 7400-CLOSE-CONT-CURSOR                           16010005
135700     ELSE                                                         16020005
135800         INITIALIZE TR006-CONTAINER-NUMBER                        16030005
135900         MOVE SHIPMT-PRO-NBR          TO                          16040005
136000             TR004-CONTNR-ID                                      16050005
136100             TR006-CONTAINER-NUMBER                               16060005
136200             PV-HOLD-TR020-CONTNR-ID                              16070005
136300         SET PS-CON-WRITTEN-NO TO TRUE                            16080005
136400         MOVE IMPOE-POE-CDE    TO PV-HOLD-POE-CDE                 16090005
136500                                  TR020-POE-CDE-CONTNR            16100005
136600         PERFORM 7600-OPEN-PO-CURSOR                              16110005
136700         PERFORM 2200-PROCESS-PO UNTIL                            16120005
136800             PS-EOC-PO-CURSOR                                     16130005
136900         SET PS-EOC-PO-CURSOR-NO      TO TRUE                     16140005
137000     END-IF.                                                      16150005
137100                                                                  16160005
137200******************************************************************16170005
137300* PROCESS ALL PURCHASE ORDERS FOR THIS CONTAINER.                *16180005
137400******************************************************************16190005
137500                                                                  16200005
137600 2200-PROCESS-PO.                                                 16210005
137700                                                                  16220005
137800     PERFORM 7800-FETCH-PO-CURSOR                                 16230005
137900                                                                  16240005
138000     IF PS-EOC-PO-CURSOR                                          16250005
138100         PERFORM 7700-CLOSE-PO-CURSOR                             16260005
138200     ELSE                                                         16270005
138300         INITIALIZE TR004-REC-TYPE-PO                             16280005
138400         INITIALIZE TR006-PO-NBR                                  16290005
138500                    TR006-DONT-SHIP-BEFORE-DATE                   16300005
138600                    PV-HOLD-PO-NBR                                16310005
138700         MOVE SHPTPO-PO-NBR           TO                          16320005
138800             TR006-PO-NBR                                         16330005
138900         SET PS-PO-PASSED-EDITS-NO    TO TRUE                     16340005
139000         PERFORM 2240-PO-EDITS                                    16350005
139100                                                                  16360005
139200         IF PS-PO-PASSED-EDITS                                    16370005
139300                                                                  16380005
139400           PERFORM 2220-GET-CARTONS-PER-PO                        16390005
139500           PERFORM 2260-SELECT-PLNSHP-DATES                       16400005
139600           PERFORM 2210-CREATE-PO                                 16410005
139700                                                                  16420005
139800         END-IF                                                   16430005
139900                                                                  16440005
140000     END-IF.                                                      16450005
140100*                                                                 16460005
140200*                                                                 16470005
140300******************************************************************16480005
140400* CREATE PURCHASE ORDER RECORDS FOR EXTRACT (TOUTTR2).           *16490005
140500******************************************************************16500005
140600                                                                  16510005
140700 2210-CREATE-PO.                                                  16520005
140800                                                                  16530005
140900     SET PS-PROBLEM-SO-SET-RETRANS-NO TO TRUE.                    16540005
141000                                                                  16550005
141100     MOVE SHPTPO-PO-NBR           TO                              16560005
141200         TR004-PO-NBR                                             16570005
141300         PV-HOLD-TR020-PO-NBR.                                    16580005
141400                                                                  16590005
141500     PERFORM 2320-CHECK-IF-SENT-AS-CMN.                           16600005
141600                                                                  16610005
141700     PERFORM 2215-SELECT-ENTITY-NAME-DESCR.                       16620005
141800                                                                  16630005
141900     PERFORM 2217-SELECT-AD-DATE.                                 16640005
142000                                                                  16650005
142100     MOVE PURCHS-OTB-PER-NBR TO                                   16660005
142200         TR004-OPEN-TO-BUY-PERIOD.                                16670005
142300                                                                  16680005
142400     MOVE PURCHS-PKGNG-CDE        TO TR004-PKGNG-CDE.             16690005
142500     MOVE PURCHS-PO-TYP-CDE       TO TR004-PO-TYP-CDE.            16700005
142600                                                                  16710005
142700     PERFORM 5400-WRITE-PO-RECORD.                                16720005
142800                                                                  16730005
142900*    ***************************************************          16740005
143000*    * FROM THIS POINT ON ONLY DO THIS ONCE PER PO     *          16750005
143100*    ***************************************************          16760005
143200     PERFORM 2300-PROCESS-INSTRUCTION-LINES.                      16770005
143300                                                                  16780005
143400     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           16790005
143500         PERFORM 8735-OPEN-POPRPK-FOR-PCK-CUR                     16800005
143600         PERFORM 2350-PROCESS-PACKS-IDS                           16810005
143700                UNTIL PS-EOC-PACK-CURSOR                          16820005
143800         SET PS-EOC-PACK-CURSOR-NO TO TRUE                        16830005
143900     ELSE                                                         16840005
144000         PERFORM 8200-OPEN-BULK-UPC-CUR                           16850005
144100         SET PS-LINES-ON-TPURITM-NO       TO TRUE                 16860005
144200         SET PS-AC-AP-LINES-NO            TO TRUE                 16870005
144300         PERFORM 2400-PROCESS-UPC-FOR-BULK UNTIL                  16880005
144400                 PS-EOC-BULK-UPC-CUR                              16890005
144500         SET PS-EOC-BULK-UPC-CUR-NO       TO TRUE                 16900005
144600     END-IF.                                                      16910005
144700                                                                  16920005
144800     PERFORM 2275-SELECT-TIMPORL.                                 16930005
144900                                                                  16940005
145000     SET PS-RETRAN-MATCH-TRAN-ENTID-NO  TO TRUE                   16950005
145100     PERFORM 8900-CHK-TRAN-SAME-AS-RETAN                          16960005
145200     IF PS-RETRAN-MATCH-TRAN-ENTID                                16970005
145300       CONTINUE                                                   16980005
145400     ELSE                                                         16990005
145500                                                                  17000005
145600       SET TR006-ERROR-TYPE-ERROR       TO TRUE                   17010005
145700       INITIALIZE TR006-ERROR-MSG                                 17020005
145800       STRING 'CON-RETRAN DCNSL NOT= TRAN DCNSL'                  17030005
145900         DELIMITED BY SIZE                                        17040005
146000         INTO TR006-ERROR-MSG                                     17050005
146100       PERFORM 8830-WRITE-ERROR-LINE                              17060005
146200       SET TR006-ERROR-TYPE-ERROR       TO TRUE                   17070005
146300       INITIALIZE TR006-ERROR-MSG                                 17080005
146400       STRING 'CON-NOT SENT BUT SET TO TRANSMIT'                  17090005
146500         DELIMITED BY SIZE                                        17100005
146600         INTO TR006-ERROR-MSG                                     17110005
146700       PERFORM 8830-WRITE-ERROR-LINE                              17120005
146800                                                                  17130005
146900       PERFORM 2280-INACTIVATE-TIMPORL                            17140072
147000       ADD  +1  TO IMPORL-VER-NBR                                 17150005
147100       MOVE 'D' TO IMPORL-DCONSLR-RLSE-CDE                        17160005
147200       MOVE PC-DEFAULT-DTE-9  TO IMPORL-DCONSLR-ACTL-DTE          17170005
147300       MOVE PC-DEFAULT-TME-9  TO IMPORL-DCONSLR-ACTL-TM           17180005
147400       PERFORM 2285-INSERT-TIMPORL                                17190072
147500       PERFORM 4820-UPDATE-TSHPTPO                                17200072
147600       PERFORM 4845-UPDATE-TVHTRIP                                17210072
147700                                                                  17220005
147800     END-IF.                                                      17230005
147900                                                                  17240005
148000     IF PS-RETRAN-MATCH-TRAN-ENTID                                17250005
148100        IF PS-PROBLEM-SO-SET-RETRANS                              17260005
148200            SET PS-PROBLEM-SO-SET-RETRANS-NO TO TRUE              17270005
148300        ELSE                                                      17280005
148400            PERFORM 2280-INACTIVATE-TIMPORL                       17290072
148500            ADD  +1 TO IMPORL-VER-NBR                             17300005
148600            MOVE 'R' TO IMPORL-DCONSLR-RLSE-CDE                   17310005
148700            PERFORM 4800-SET-CURRENT-DATE-TIME                    17320005
148800            PERFORM 2285-INSERT-TIMPORL                           17330072
148900            PERFORM 3000-WRITE-OUT-GOOD-PO-RECS                   17340005
149000        END-IF                                                    17350005
149100     END-IF.                                                      17360005
149200                                                                  17370005
149300     MOVE SPACES TO PV-EXTRACT-TABLE.                             17380005
149400     SET EXT-INDEX TO +1.                                         17390005
149500                                                                  17400005
149600******************************************************************17410005
149700 2215-SELECT-ENTITY-NAME-DESCR.                                   17420005
149800*                                                                 17430005
149900     EXEC SQL                                                     17440005
150000           SELECT DISTINCT                                        17450005
150100                  EN.ENT_NAME_DESC                                17460005
150200             INTO                                                 17470005
150300                  :ENTNME-ENT-NAME-DESC                           17480005
150400             FROM                                                 17490005
150500                  TENTNME   EN                                    17500005
150600                , TPURCHS   PO                                    17510005
150700             WHERE PO.PO_NBR     =  :SHPTPO-PO-NBR                17520005
150800               AND PO.ENT_ID     =  EN.ENT_ID                     17530005
150900               AND PO.VER_STATUS_CDE = 'A'                        17540005
151000               AND EN.TYPE_CDE = '01'                             17550005
151100     END-EXEC                                                     17560005
151200                                                                  17570005
151300     EVALUATE TRUE                                                17580005
151400         WHEN SQLCODE = ZERO                                      17590005
151500             MOVE ENTNME-ENT-NAME-DESC  TO                        17600005
151600                 TR004-VENDOR-NAME                                17610005
151700                                                                  17620005
151800         WHEN SQLCODE = +100                                      17630005
151900             CONTINUE                                             17640005
152000         WHEN SQLWARN0 NOT EQUAL SPACE                            17650005
152100         WHEN SQLCODE NOT EQUAL ZERO                              17660005
152200             DISPLAY '** ABEND **'                                17670005
152300             DISPLAY '** PROGRAM = TRKUP006 **'                   17680005
152400          DISPLAY '** PARAGRAPH = 2215-SELECT-ENTITY-NAME-DESCR'  17690005
152500             PERFORM 9100-SQL-ABEND                               17700022
152600     END-EVALUATE.                                                17710005
152700******************************************************************17720005
152800*  GET THE EARLIEST ADVERTISING DATE                              17730005
152900******************************************************************17740005
153000 2217-SELECT-AD-DATE.                                             17750005
153100*                                                                 17760005
153200     EXEC SQL                                                     17770005
153300         SELECT  MIN(AD_EVNT_DTE)                                 17780005
153400           INTO  :PURITM-AD-EVNT-DTE                              17790005
153500           FROM  TPURITM                                          17800005
153600          WHERE  PO_NBR         = :SHPTPO-PO-NBR                  17810005
153700            AND  AD_EVNT_DTE   <> '0001-01-01'                    17820005
153800            AND  VER_STATUS_CDE = 'A'                             17830005
153900            AND  STATUS_CDE    IN ('AC', 'AP')                    17840005
154000     END-EXEC                                                     17850005
154100                                                                  17860005
154200     EVALUATE TRUE                                                17870005
154300         WHEN SQLCODE = +0                                        17880005
154400              MOVE PURITM-AD-EVNT-DTE (1:4)                       17890005
154500                                   TO TR004-AD-DATE (1:4)         17900005
154600              MOVE PURITM-AD-EVNT-DTE (6:2)                       17910005
154700                                   TO TR004-AD-DATE (5:2)         17920005
154800              MOVE PURITM-AD-EVNT-DTE (9:2)                       17930005
154900                                   TO TR004-AD-DATE (7:2)         17940005
155000                                                                  17950005
155100         WHEN SQLCODE =  100                                      17960005
155200         WHEN SQLCODE = -305                                      17970005
155300              MOVE SPACES     TO TR004-AD-DATE                    17980005
155400                                                                  17990005
155500         WHEN SQLWARN0 NOT = SPACE                                18000005
155600         WHEN SQLCODE  NOT = +0                                   18010005
155700             DISPLAY '** ABEND **'                                18020005
155800             DISPLAY '** PROGRAM = TRKUP006 **'                   18030005
155900             DISPLAY '** PARAGRAPH = 2217-SELECT-AD-DATE'         18040005
156000             PERFORM 9100-SQL-ABEND                               18050022
156100     END-EVALUATE.                                                18060005
156200                                                                  18070005
156300******************************************************************18080005
156400* THIS USED ONLY TO GET TR004-CART-PER-PO                        *18090005
156500******************************************************************18100005
156600 2220-GET-CARTONS-PER-PO.                                         18110005
156700                                                                  18120005
156800     MOVE ZEROS TO  PV-CART-PER-PO                                18130005
156900                    PV-SUM-PURITM-UNT-QTY                         18140005
157000                    PV-CART-PER-PREPACK                           18150005
157100                    PV-CART-PER-ITEM.                             18160005
157200     IF PURCHS-PKGNG-CDE = PC-I OR PC-M                           18170005
157300       PERFORM 8715-OPEN-POPRPK-FOR-PO-CUR                        18180005
157400       PERFORM 2222-SUM-PO-CARTONS-PREPACK                        18190005
157500              UNTIL PS-EOC-POPRPK-FOR-PO-CUR                      18200005
157600       SET PS-EOC-POPRPK-FOR-PO-CUR-NO TO TRUE                    18210005
157700       PERFORM 8717-CLOSE-POPRPK-FOR-PO-CUR                       18220005
157800     ELSE                                                         18230005
157900       PERFORM 8725-OPEN-PURITM-TUPC-CUR                          18240005
158000       PERFORM 2230-SUM-PO-CARTONS-BULK                           18250005
158100              UNTIL PS-EOC-PURITM-TUPC-CUR                        18260005
158200       SET PS-EOC-PURITM-TUPC-CUR-NO TO TRUE                      18270005
158300       PERFORM 8727-CLOSE-PURITM-TUPC-CUR                         18280005
158400     END-IF.                                                      18290005
158500     MOVE PV-CART-PER-PO          TO TR004-CART-PER-PO.           18300005
158600                                                                  18310005
158700******************************************************************18320005
158800 2222-SUM-PO-CARTONS-PREPACK.                                     18330005
158900                                                                  18340005
159000     PERFORM 8720-FETCH-POPRPK-FOR-PO-CUR.                        18350005
159100     IF PS-EOC-POPRPK-FOR-PO-CUR                                  18360005
159200       CONTINUE                                                   18370005
159300     ELSE                                                         18380005
159400       EVALUATE TRUE                                              18390005
159500                                                                  18400005
159600**BUD**  WHEN PURCHS-PKGNG-CDE = PC-M                             18410007
159600         WHEN POPRPK-PREPK-TYP-CDE = PC-M                         18420007
159700           IF POPRPK-INPK-UNT-QTY = ZERO                          18430005
159800             CONTINUE                                             18440005
159900           ELSE                                                   18450005
160000             PERFORM 2225-SELECT-PURITM-UNT-QTY                   18460005
160100             COMPUTE PV-CART-PER-PREPACK =                        18470005
160200               (PV-SUM-PURITM-UNT-QTY / POPRPK-INPK-UNT-QTY)      18480005
160300             ADD PV-CART-PER-PREPACK   TO PV-CART-PER-PO          18490005
160400           END-IF                                                 18500005
160500                                                                  18510005
159600**BUD**  WHEN PURCHS-PKGNG-CDE = PC-I                             18520007
159600         WHEN POPRPK-PREPK-TYP-CDE = PC-I                         18530007
160700           IF POPRPK-OTPK-UNT-QTY = ZERO                          18540005
160800             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 18550005
160900             INITIALIZE TR006-ERROR-MSG                           18560005
161000                        TR006-UPC-NBR                             18570005
161100                        TR006-SKU                                 18580005
161200             STRING 'POPRPK-OTPK-UNT-QTY '                        18590005
161300                    'FLD IS 0-PO'                                 18600005
161400                 DELIMITED BY SIZE                                18610005
161500                 INTO TR006-ERROR-MSG                             18620005
161600             PERFORM 8830-WRITE-ERROR-LINE                        18630005
161700           ELSE                                                   18640005
161800             PERFORM 2225-SELECT-PURITM-UNT-QTY                   18650005
161900             COMPUTE PV-CART-PER-PREPACK =                        18660005
162000               (PV-SUM-PURITM-UNT-QTY / POPRPK-OTPK-UNT-QTY)      18670005
162100             ADD PV-CART-PER-PREPACK   TO PV-CART-PER-PO          18680005
162200           END-IF                                                 18690005
162300                                                                  18700005
162400       END-EVALUATE                                               18710005
162500                                                                  18720005
162600     END-IF.                                                      18730005
162700                                                                  18740005
162800******************************************************************18750005
162900 2225-SELECT-PURITM-UNT-QTY.                                      18760005
163000                                                                  18770005
163100     EXEC SQL                                                     18780005
163200           SELECT                                                 18790005
163300                 SUM (A.UNT_QTY)                                  18800005
163400             INTO                                                 18810005
163500                :PV-SUM-PURITM-UNT-QTY                            18820005
163600             FROM                                                 18830005
163700                  TPURITM  A                                      18840005
163800             WHERE A.PO_NBR         = :PURCHS-PO-NBR              18850005
163900               AND A.VER_STATUS_CDE = :PC-A                       18860005
164000               AND A.STATUS_CDE    IN ('AC', 'AP')                18870005
164100               AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID         18880005
164200     END-EXEC.                                                    18890005
164300                                                                  18900005
164400     EVALUATE TRUE                                                18910005
164500         WHEN SQLCODE = ZERO                                      18920005
164600             CONTINUE                                             18930005
164700                                                                  18940005
164800         WHEN SQLCODE = +100                                      18950005
164900         WHEN SQLCODE = -305                                      18960005
165000               MOVE ZERO     TO PV-SUM-PURITM-UNT-QTY             18970005
165100                                                                  18980005
165200         WHEN SQLWARN0 NOT EQUAL SPACE                            18990005
165300         WHEN SQLCODE NOT EQUAL ZERO                              19000005
165400             DISPLAY '** ABEND **'                                19010005
165500             DISPLAY '** PROGRAM = TRKUP006 **'                   19020005
165600             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          19030005
165700             DISPLAY '** PARA = 2225-SELECT-PURITM-UNT-QTY**'     19040005
165800             PERFORM 9100-SQL-ABEND                               19050022
165900     END-EVALUATE.                                                19060005
166000 EJECT                                                            19070005
166100******************************************************************19080005
166200 2230-SUM-PO-CARTONS-BULK.                                        19090005
166300                                                                  19100005
166400     PERFORM 8730-FETCH-PURITM-TUPC-CUR.                          19110005
166500     IF PS-EOC-PURITM-TUPC-CUR                                    19120005
166600       CONTINUE                                                   19130005
166700     ELSE                                                         19140005
166800       MOVE PURITM-OUTR-PK-QTY TO PV-OUTR-PK-QTY                  19150005
166900       IF PV-OUTR-PK-QTY    NOT NUMERIC                           19160005
167000         OR PURITM-OUTR-PK-QTY = ZERO                             19170005
167100          CONTINUE                                                19180005
167200       ELSE                                                       19190005
167300          COMPUTE PV-CART-PER-ITEM =                              19200005
167400              (PURITM-UNT-QTY / PURITM-OUTR-PK-QTY)               19210005
167500          ADD PV-CART-PER-ITEM TO PV-CART-PER-PO                  19220005
167600     END-IF.                                                      19230005
167700                                                                  19240005
167800*              ***************************************************19250005
167900 2240-PO-EDITS.                                                   19260005
168000*                                                                 19270005
168100         SET PS-PO-SEL-INFO-PRESENT-NO      TO TRUE.              19280005
168200         PERFORM 2250-SELECT-TPURCHS-INFO.                        19290005
155029         PERFORM 6600-FAST-PARM-CHECK.                            19300074
168300                                                                  19310005
168400         IF PS-PO-SEL-INFO-PRESENT                                19320005
168500           IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                    19330005
168600             CONTINUE                                             19340005
168700           ELSE                                                   19350005
168800               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            19360005
168900               SET TR006-ERROR-TYPE-ERROR      TO TRUE            19370005
169000               INITIALIZE TR006-UPC-NBR                           19380005
169100                          TR006-SKU                               19390005
169200                          TR006-ERROR-MSG                         19400005
169300               STRING  'PO-INVALID STATUS-NOT SENT-',             19410005
169400                       PURCHS-STATUS-CDE                          19420005
169500                   DELIMITED BY SIZE                              19430005
169600                   INTO TR006-ERROR-MSG                           19440005
169700               PERFORM 8830-WRITE-ERROR-LINE                      19450005
169800           END-IF                                                 19460005
169900         END-IF.                                                  19470005
170000                                                                  19480005
170100         IF PS-PO-SEL-INFO-PRESENT                                19490005
170200           IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-B             19500005
170300                              OR PC-C OR PC-S OR SPACE            19510005
170400             CONTINUE                                             19520005
170500           ELSE                                                   19530005
170600               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            19540005
170700               SET TR006-ERROR-TYPE-ERROR      TO TRUE            19550005
170800               INITIALIZE TR006-UPC-NBR                           19560005
170900                          TR006-SKU                               19570005
171000                          TR006-ERROR-MSG                         19580005
171100               STRING  'PO-INVALID PKG CODE-NOT SENT-',           19590005
171200                       PURCHS-PKGNG-CDE                           19600005
171300                   DELIMITED BY SIZE                              19610005
171400                   INTO TR006-ERROR-MSG                           19620005
171500               PERFORM 8830-WRITE-ERROR-LINE                      19630005
171600         END-IF.                                                  19640005
171700                                                                  19650005
171800         IF PS-PO-SEL-INFO-PRESENT                                19660005
171900           IF PURCHS-PKGNG-CDE = PC-M OR PC-I                     19670005
172000             SET PS-UNCONFIRMED-PACK-NO  TO TRUE                  19680005
172100             PERFORM 2258-CHECK-UNCONFIRMED-PACKS                 19690005
172200             IF PS-UNCONFIRMED-PACK                               19700005
172300               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            19710005
172400               SET TR006-ERROR-TYPE-ERROR      TO TRUE            19720005
172500               INITIALIZE TR006-UPC-NBR                           19730005
172600                          TR006-SKU                               19740005
172700                          TR006-ERROR-MSG                         19750005
172800               STRING  'UNCONFIRMED PACKS'                        19760005
172900                   DELIMITED BY SIZE                              19770005
173000                   INTO TR006-ERROR-MSG                           19780005
173100               PERFORM 8830-WRITE-ERROR-LINE                      19790005
173200             END-IF                                               19800005
173300           END-IF                                                 19810005
173400         END-IF.                                                  19820005
173500                                                                  19830005
173600         IF PS-PO-SEL-INFO-PRESENT                                19840005
173700                                                                  19850005
173800           SET PS-PO-HAS-UNTIED-LINES-NO   TO TRUE                19860005
173900           PERFORM 2255-SELECT-UNTIED-LINES                       19870005
174000           IF PS-PO-HAS-UNTIED-LINES                              19880005
174100               SET TR006-ERROR-TYPE-ERROR  TO TRUE                19890005
174200               INITIALIZE TR006-ERROR-MSG                         19900005
174300               MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU           19910005
174400               MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR       19920005
174500               STRING 'PCK-DTL UPCS NOT TIED TO PCK-FIX'          19930005
174600                   DELIMITED BY SIZE                              19940005
174700                   INTO TR006-ERROR-MSG                           19950005
174800               PERFORM 8830-WRITE-ERROR-LINE                      19960005
174900           ELSE                                                   19970005
175000               SET PS-PO-PASSED-EDITS       TO TRUE               19980005
175100               PERFORM 2320-CHECK-IF-SENT-AS-CMN                  19990005
175200           END-IF                                                 20000005
175300                                                                  20010005
175400         END-IF.                                                  20020005
175500                                                                  20030005
175600******************************************************************20040005
175700 2250-SELECT-TPURCHS-INFO.                                        20050005
175800*                                                                 20060005
175900     EXEC SQL                                                     20070005
176000           SELECT DISTINCT                                        20080005
176100                  PO.STATUS_CDE                                   20090005
176200                , PO.PO_NBR                                       20100005
176300                , PO.OTB_PER_NBR                                  20110005
176400                , PO.NEW_STR_PO_IND                               20120005
176500                , PO.PKGNG_CDE                                    20130005
176600                , PO.DEPT_NBR                                     20140005
176700                , PO_TYP_CDE                                      20150005
176800                , RL.DCONSLR_RLSE_CDE                             20160005
176900                , RL.DCONSLR_ACTL_DTE                             20170005
177000             INTO                                                 20180005
177100                  :PURCHS-STATUS-CDE                              20190005
177200                , :PURCHS-PO-NBR                                  20200005
177300                , :PURCHS-OTB-PER-NBR                             20210005
177400                , :PURCHS-NEW-STR-PO-IND                          20220005
177500                , :PURCHS-PKGNG-CDE                               20230005
177600                , :PURCHS-DEPT-NBR                                20240005
177700                , :PURCHS-PO-TYP-CDE                              20250005
177800                , :IMPORL-DCONSLR-RLSE-CDE                        20260005
177900                , :IMPORL-DCONSLR-ACTL-DTE                        20270005
178000             FROM                                                 20280005
178100                  TPURCHS   PO                                    20290005
178200                , TSHPTPO   SP                                    20300005
178300                , TIMPORL   RL                                    20310005
178400             WHERE PO.PO_NBR     =  :SHPTPO-PO-NBR                20320005
178500               AND SP.PO_NBR     =  PO.PO_NBR                     20330005
178600               AND PO.PO_NBR     =  RL.PO_NBR                     20340005
178700               AND PO.VER_STATUS_CDE = 'A'                        20350005
178800               AND RL.VER_STATUS_CDE = 'A'                        20360005
178900     END-EXEC                                                     20370005
179000                                                                  20380005
179100     EVALUATE TRUE                                                20390005
179200         WHEN SQLCODE = ZERO                                      20400005
179300           SET PS-PO-SEL-INFO-PRESENT     TO TRUE                 20410005
179400           INITIALIZE TR006-DEPT-NBR                              20420005
179500                      PV-TR006-DEPT-NBR                           20430005
179600           MOVE PURCHS-DEPT-NBR   TO PV-TR006-DEPT-NBR-3          20440005
179700           MOVE PV-TR006-DEPT-NBR TO TR006-DEPT-NBR               20450005
179800           MOVE PURCHS-PKGNG-CDE  TO TR006-PKGNG-CDE              20460005
179900                                                                  20470005
180000         WHEN SQLCODE = +100                                      20480005
180100             INITIALIZE TR006-DEPT-NBR                            20490005
180200                        TR006-UPC-NBR                             20500005
180300                        TR006-SKU                                 20510005
180400                        TR006-PKGNG-CDE                           20520005
180500                        TR006-ERROR-MSG                           20530005
180600             SET TR006-ERROR-TYPE-ERROR      TO TRUE              20540005
180700             STRING 'DCONSLR/PO INFO MISSING-NOT SENT'            20550005
180800                 DELIMITED BY SIZE                                20560005
180900                 INTO TR006-ERROR-MSG                             20570005
181000             PERFORM 8830-WRITE-ERROR-LINE                        20580005
181100                                                                  20590005
181200         WHEN SQLWARN0 NOT EQUAL SPACE                            20600005
181300         WHEN SQLCODE NOT EQUAL ZERO                              20610005
181400             DISPLAY '** ABEND **'                                20620005
181500             DISPLAY '** PROGRAM = TRKUP006 **'                   20630005
181600             DISPLAY '** PARAGRAPH = 2250-SELECT-TPURCHS-INFO***' 20640005
181700             DISPLAY 'SHPTPO-PO-NBR = ' SHPTPO-PO-NBR             20650005
181800             PERFORM 9100-SQL-ABEND                               20660022
181900     END-EVALUATE.                                                20670005
182000                                                                  20680005
182100******************************************************************20690005
182200 2255-SELECT-UNTIED-LINES.                                        20700005
182300                                                                  20710005
182400     EXEC SQL                                                     20720005
182500         SELECT A.PO_NBR                                          20730005
182600           INTO :PURITM-PO-NBR                                    20740005
182700           FROM TPURITM  A                                        20750005
182800               ,TPURCHS  B                                        20760005
182900          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 20770005
183000            AND A.VER_STATUS_CDE = :PC-A                          20780005
183100            AND A.STATUS_CDE    IN ('AC', 'AP')                   20790005
183200            AND A.PO_PREPK_ID    =  0                             20800005
183300            AND B.PO_NBR         =  A.PO_NBR                      20810005
183400            AND B.VER_STATUS_CDE = :PC-A                          20820005
183500            AND B.PKGNG_CDE      IN ('M','I')                     20830005
183600     END-EXEC                                                     20840005
183700                                                                  20850005
183800     EVALUATE TRUE                                                20860005
183900         WHEN SQLCODE = ZERO                                      20870005
184000         WHEN SQLCODE = -811                                      20880005
184100             SET PS-PO-HAS-UNTIED-LINES TO TRUE                   20890005
184200                                                                  20900005
184300         WHEN SQLCODE = +100                                      20910005
184400             CONTINUE                                             20920005
184500                                                                  20930005
184600         WHEN SQLWARN0 NOT EQUAL SPACE                            20940005
184700         WHEN SQLCODE NOT EQUAL ZERO                              20950005
184800             DISPLAY '**************************************'     20960005
184900             DISPLAY '** ABEND                            **'     20970005
185000             DISPLAY '** PROGRAM = TRKUP006               **'     20980005
185100             DISPLAY '** PARAGRAPH = 2255-SELECT-UNTIED-LINES'    20990005
185200             DISPLAY '** SELECT TPURITM                   **'     21000005
185300             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              21010005
185400             DISPLAY '**************************************'     21020005
185500             PERFORM 9100-SQL-ABEND                               21030022
185600     END-EVALUATE.                                                21040005
185700                                                                  21050005
185800******************************************************************21060005
185900 2258-CHECK-UNCONFIRMED-PACKS.                                    21070005
186000                                                                  21080005
186100     INITIALIZE  PV-DB2-COUNT.                                    21090005
186200                                                                  21100005
186300     EXEC SQL                                                     21110005
186400          SELECT COUNT (*)                                        21120005
186500            INTO :PV-DB2-COUNT                                    21130005
186600            FROM TPURITM A                                        21140005
186700           WHERE A.PO_NBR          = :PURCHS-PO-NBR               21150005
186800             AND A.VER_STATUS_CDE  = 'A'                          21160005
186900             AND A.STATUS_CDE   = 'RV'                            21170005
187000     END-EXEC                                                     21180005
187100                                                                  21190005
187200                                                                  21200005
187300     EVALUATE TRUE                                                21210005
187400         WHEN SQLCODE = ZERO                                      21220005
187500         WHEN SQLCODE = -811                                      21230005
187600           IF PV-DB2-COUNT = ZERO                                 21240005
187700             CONTINUE                                             21250005
187800           ELSE                                                   21260005
187900             SET PS-UNCONFIRMED-PACK TO TRUE                      21270005
188000           END-IF                                                 21280005
188100                                                                  21290005
188200         WHEN SQLCODE = +100                                      21300005
188300             CONTINUE                                             21310005
188400                                                                  21320005
188500         WHEN SQLWARN0 NOT EQUAL SPACE                            21330005
188600         WHEN SQLCODE NOT EQUAL ZERO                              21340005
188700             DISPLAY '**************************************'     21350005
188800             DISPLAY '** ABEND                            **'     21360005
188900             DISPLAY '** PROGRAM = TRKUP006               **'     21370005
189000             DISPLAY '** PARAGRAPH = 2258-CHECK-UNCONFIRMED-PACKS'21380005
189100             DISPLAY '** SELECT TPURITM                   **'     21390005
189200             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              21400005
189300             DISPLAY '**************************************'     21410005
189400             PERFORM 9100-SQL-ABEND                               21420022
189500     END-EVALUATE.                                                21430005
189600                                                                  21440005
189700******************************************************************21450005
189800 2260-SELECT-PLNSHP-DATES.                                        21460005
189900*                                                                 21470005
190000     EXEC SQL                                                     21480005
190100           SELECT DISTINCT                                        21490005
190200                  PL.DONT_SHIP_BEF_DTE                            21500005
190300                , PL.CAN_IFNOT_SHIP_DTE                           21510005
190400                , PL.EXT_CAN_DTE                                  21520005
190500             INTO                                                 21530005
190600                  :PLNSHP-DONT-SHIP-BEF-DTE                       21540005
190700                , :PLNSHP-CAN-IFNOT-SHIP-DTE                      21550005
190800                , :PLNSHP-EXT-CAN-DTE                             21560005
190900             FROM                                                 21570005
191000                  TPLNSHP   PL                                    21580005
191100                , TSHPTPO   SP                                    21590005
191200             WHERE PL.PO_NBR     =  :SHPTPO-PO-NBR                21600005
191300               AND SP.PO_NBR     =  PL.PO_NBR                     21610005
191400               AND PL.VER_STATUS_CDE = 'A'                        21620005
191500     END-EXEC                                                     21630005
191600                                                                  21640005
191700     EVALUATE TRUE                                                21650005
191800         WHEN SQLCODE = ZERO                                      21660005
191900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO               21670005
192000                 TR004-DO-NOT-SHIP-BEF-DTE (1:4)                  21680005
192100             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               21690005
192200                 TR004-DO-NOT-SHIP-BEF-DTE (5:2)                  21700005
192300             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               21710005
192400                 TR004-DO-NOT-SHIP-BEF-DTE (7:2)                  21720005
192500                                                                  21730005
192600             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               21740005
192700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2) TO               21750005
192800                 TR006-DONT-SHIP-BEFORE-DATE (5:2)                21760005
192900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               21770005
193000                 TR006-DONT-SHIP-BEFORE-DATE (1:2)                21780005
193100             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               21790005
193200                 TR006-DONT-SHIP-BEFORE-DATE (3:2)                21800005
193300                                                                  21810005
193400             IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                 21820005
193500                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(1:4) TO           21830005
193600                     TR004-CANCEL-DATE (1:4)                      21840005
193700                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(6:2) TO           21850005
193800                     TR004-CANCEL-DATE (5:2)                      21860005
193900                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(9:2) TO           21870005
194000                     TR004-CANCEL-DATE (7:2)                      21880005
194100              ELSE                                                21890005
194200                 MOVE PLNSHP-EXT-CAN-DTE(1:4) TO                  21900005
194300                     TR004-CANCEL-DATE (1:4)                      21910005
194400                 MOVE PLNSHP-EXT-CAN-DTE(6:2) TO                  21920005
194500                     TR004-CANCEL-DATE (5:2)                      21930005
194600                 MOVE PLNSHP-EXT-CAN-DTE(9:2) TO                  21940005
194700                     TR004-CANCEL-DATE (7:2)                      21950005
194800              END-IF                                              21960005
194900                                                                  21970005
195000         WHEN SQLCODE = +100                                      21980005
195100             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               21990005
195200                        TR004-CANCEL-DATE                         22000005
195300                        TR004-DO-NOT-SHIP-BEF-DTE                 22010005
195400                                                                  22020005
195500         WHEN SQLWARN0 NOT EQUAL SPACE                            22030005
195600         WHEN SQLCODE NOT EQUAL ZERO                              22040005
195700             DISPLAY '** ABEND **'                                22050005
195800             DISPLAY '** PROGRAM = TRKUP006 **'                   22060005
195900             DISPLAY '** PARAGRAPH = 2260-SELECT-PLNSHP-DATES**'  22070005
196000             PERFORM 9100-SQL-ABEND                               22080022
196100                                                                  22090005
196200     END-EVALUATE.                                                22100005
196300                                                                  22110005
196400******************************************************************22120005
196500 2275-SELECT-TIMPORL.                                             22130005
196600                                                                  22140005
196700         EXEC SQL                                                 22150005
196800             SELECT PO_NBR                                        22160005
196900                  , VER_NBR                                       22170005
197000                  , VER_STATUS_CDE                                22180005
197100                  , CONSLR_RLSE_CDE                               22190005
197200                  , CONSLR_REQR_DTE                               22200005
197300                  , CONSLR_ACTL_DTE                               22210005
197400                  , CONSLR_ACTL_TM                                22220005
197500                  , CSTM_BKR_RLSE_CDE                             22230005
197600                  , CSTM_BKR_REQR_DTE                             22240005
197700                  , CSTM_BKR_ACTL_DTE                             22250005
197800                  , CSTM_BKR_ACTL_TM                              22260005
197900                  , TKT_PRTR_RLSE_CDE                             22270005
198000                  , TKT_PRTR_REQR_DTE                             22280005
198100                  , TKT_PRTR_ACTL_DTE                             22290005
198200                  , TKT_PRTR_ACTL_TM                              22300005
198300                  , DCONSLR_RLSE_CDE                              22310005
198400                  , DCONSLR_REQR_DTE                              22320005
198500                  , DCONSLR_ACTL_DTE                              22330005
198600                  , DCONSLR_ACTL_TM                               22340005
198700                  , LAST_UPD_TMST                                 22350005
198800                  , LAST_UPD_BY_UID                               22360005
198900                  , DCONSLR_ENT_ID                                22370005
199000             INTO  :IMPORL-PO-NBR                                 22380005
199100                  ,:IMPORL-VER-NBR                                22390005
199200                  ,:IMPORL-VER-STATUS-CDE                         22400005
199300                  ,:IMPORL-CONSLR-RLSE-CDE                        22410005
199400                  ,:IMPORL-CONSLR-REQR-DTE                        22420005
199500                  ,:IMPORL-CONSLR-ACTL-DTE                        22430005
199600                  ,:IMPORL-CONSLR-ACTL-TM                         22440005
199700                  ,:IMPORL-CSTM-BKR-RLSE-CDE                      22450005
199800                  ,:IMPORL-CSTM-BKR-REQR-DTE                      22460005
199900                  ,:IMPORL-CSTM-BKR-ACTL-DTE                      22470005
200000                  ,:IMPORL-CSTM-BKR-ACTL-TM                       22480005
200100                  ,:IMPORL-TKT-PRTR-RLSE-CDE                      22490005
200200                  ,:IMPORL-TKT-PRTR-REQR-DTE                      22500005
200300                  ,:IMPORL-TKT-PRTR-ACTL-DTE                      22510005
200400                  ,:IMPORL-TKT-PRTR-ACTL-TM                       22520005
200500                  ,:IMPORL-DCONSLR-RLSE-CDE                       22530005
200600                  ,:IMPORL-DCONSLR-REQR-DTE                       22540005
200700                  ,:IMPORL-DCONSLR-ACTL-DTE                       22550005
200800                  ,:IMPORL-DCONSLR-ACTL-TM                        22560005
200900                  ,:IMPORL-LAST-UPD-TMST                          22570005
201000                  ,:IMPORL-LAST-UPD-BY-UID                        22580005
201100                  ,:IMPORL-DCONSLR-ENT-ID                         22590005
201200             FROM  TIMPORL                                        22600005
201300             WHERE PO_NBR          = :SHPTPO-PO-NBR               22610005
201400                AND VER_STATUS_CDE  = :PC-A                       22620005
201500         END-EXEC                                                 22630005
201600                                                                  22640005
201700     EVALUATE TRUE                                                22650005
201800         WHEN SQLCODE = ZERO                                      22660005
201900             CONTINUE                                             22670005
202000                                                                  22680005
202100         WHEN SQLCODE = +100                                      22690005
202200             CONTINUE                                             22700005
202300                                                                  22710005
202400         WHEN SQLWARN0 NOT EQUAL SPACE                            22720005
202500         WHEN SQLCODE NOT EQUAL ZERO                              22730005
202600             DISPLAY '** ABEND **'                                22740005
202700             DISPLAY '** PROGRAM = TRKUP006 **'                   22750005
202800             DISPLAY '** PARAGRAPH = 2275-SELECT-TIMPORL**'       22760005
202900             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 22770005
203000             PERFORM 9100-SQL-ABEND                               22780022
203100     END-EVALUATE.                                                22790005
203200                                                                  22800005
203300******************************************************************22810005
203400 2280-INACTIVATE-TIMPORL.                                         22820005
203500                                                                  22830005
203600         EXEC SQL                                                 22840005
203700             UPDATE TIMPORL                                       22850005
203800                SET VER_STATUS_CDE     = :PC-I                    22860005
203900             WHERE PO_NBR          = :SHPTPO-PO-NBR               22870005
204000                AND VER_STATUS_CDE  = :PC-A                       22880005
204100         END-EXEC                                                 22890005
204200                                                                  22900005
204300     EVALUATE TRUE                                                22910005
204400         WHEN SQLCODE = ZERO                                      22920005
204500             CONTINUE                                             22930005
204600                                                                  22940005
204700         WHEN SQLWARN0 NOT EQUAL SPACE                            22950005
204800         WHEN SQLCODE NOT EQUAL ZERO                              22960005
204900             DISPLAY '** ABEND **'                                22970005
205000             DISPLAY '** PROGRAM = TRKUP006 **'                   22980005
205100             DISPLAY '** PARAGRAPH = 2280-INACTIVATE-TIMPORL**'   22990005
205200             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 23000005
205300             PERFORM 9100-SQL-ABEND                               23010022
205400     END-EVALUATE.                                                23020005
205500                                                                  23030005
205600******************************************************************23040005
205700 2285-INSERT-TIMPORL.                                             23050005
205800                                                                  23060005
205900         EXEC SQL                                                 23070005
206000             INSERT INTO TIMPORL                                  23080005
206100                   (PO_NBR                                        23090005
206200                  , VER_NBR                                       23100005
206300                  , VER_STATUS_CDE                                23110005
206400                  , CONSLR_RLSE_CDE                               23120005
206500                  , CONSLR_REQR_DTE                               23130005
206600                  , CONSLR_ACTL_DTE                               23140005
206700                  , CONSLR_ACTL_TM                                23150005
206800                  , CSTM_BKR_RLSE_CDE                             23160005
206900                  , CSTM_BKR_REQR_DTE                             23170005
207000                  , CSTM_BKR_ACTL_DTE                             23180005
207100                  , CSTM_BKR_ACTL_TM                              23190005
207200                  , TKT_PRTR_RLSE_CDE                             23200005
207300                  , TKT_PRTR_REQR_DTE                             23210005
207400                  , TKT_PRTR_ACTL_DTE                             23220005
207500                  , TKT_PRTR_ACTL_TM                              23230005
207600                  , DCONSLR_RLSE_CDE                              23240005
207700                  , DCONSLR_REQR_DTE                              23250005
207800                  , DCONSLR_ACTL_DTE                              23260005
207900                  , DCONSLR_ACTL_TM                               23270005
208000                  , LAST_UPD_TMST                                 23280005
208100                  , LAST_UPD_BY_UID                               23290005
208200                  , DCONSLR_ENT_ID)                               23300005
208300            VALUES (:IMPORL-PO-NBR                                23310005
208400                  , :IMPORL-VER-NBR                               23320005
208500                  , :IMPORL-VER-STATUS-CDE                        23330005
208600                  , :IMPORL-CONSLR-RLSE-CDE                       23340005
208700                  , :IMPORL-CONSLR-REQR-DTE                       23350005
208800                  , :IMPORL-CONSLR-ACTL-DTE                       23360005
208900                  , :IMPORL-CONSLR-ACTL-TM                        23370005
209000                  , :IMPORL-CSTM-BKR-RLSE-CDE                     23380005
209100                  , :IMPORL-CSTM-BKR-REQR-DTE                     23390005
209200                  , :IMPORL-CSTM-BKR-ACTL-DTE                     23400005
209300                  , :IMPORL-CSTM-BKR-ACTL-TM                      23410005
209400                  , :IMPORL-TKT-PRTR-RLSE-CDE                     23420005
209500                  , :IMPORL-TKT-PRTR-REQR-DTE                     23430005
209600                  , :IMPORL-TKT-PRTR-ACTL-DTE                     23440005
209700                  , :IMPORL-TKT-PRTR-ACTL-TM                      23450005
209800                  , :IMPORL-DCONSLR-RLSE-CDE                      23460005
209900                  , :IMPORL-DCONSLR-REQR-DTE                      23470005
210000                  , :IMPORL-DCONSLR-ACTL-DTE                      23480005
210100                  , :IMPORL-DCONSLR-ACTL-TM                       23490005
210200                  ,  CURRENT TIMESTAMP                            23500005
210300                  , :PC-CURRENT-PROGRAM-NAME                      23510005
210400                  , :IMPORL-DCONSLR-ENT-ID)                       23520005
210500         END-EXEC                                                 23530005
210600                                                                  23540005
210700     EVALUATE TRUE                                                23550005
210800         WHEN SQLCODE = ZERO                                      23560005
210900             CONTINUE                                             23570005
211000                                                                  23580005
211100         WHEN SQLWARN0 NOT EQUAL SPACE                            23590005
211200         WHEN SQLCODE NOT EQUAL ZERO                              23600005
211300             DISPLAY '** ABEND **'                                23610005
211400             DISPLAY '** PROGRAM = TRKUP006 **'                   23620005
211500             DISPLAY '** PARAGRAPH = 2285-INSERT-TIMPORL**'       23630005
211600             DISPLAY '** PO-NBR = ' SHPTPO-PO-NBR                 23640005
211700             PERFORM 9100-SQL-ABEND                               23650022
211800     END-EVALUATE.                                                23660005
211900                                                                  23670005
212000******************************************************************23680005
212100 2300-PROCESS-INSTRUCTION-LINES.                                  23690005
212200                                                                  23700005
212300     PERFORM 7900-OPEN-INSTR-CURSOR.                              23710005
212400                                                                  23720005
212500     PERFORM 8100-FETCH-INSTR-CURSOR.                             23730005
212600                                                                  23740005
212700     IF PS-EOC-INSTR-CURSOR                                       23750005
212800         PERFORM 8000-CLOSE-INSTR-CURSOR                          23760005
212900     ELSE                                                         23770005
213000         PERFORM 2310-FINISH-INSTRUCTION-LINES                    23780005
213100         PERFORM 8000-CLOSE-INSTR-CURSOR                          23790005
213200     END-IF.                                                      23800005
213300                                                                  23810005
213400     SET PS-EOC-INSTR-CURSOR-NO TO TRUE.                          23820005
213500                                                                  23830005
213600******************************************************************23840005
213700 2310-FINISH-INSTRUCTION-LINES.                                   23850005
213800                                                                  23860005
213900     INITIALIZE TR004-REC-TYPE-INS.                               23870005
214000     MOVE INSTCD-INSTR-DESC TO TR004-SPEC-INSTR.                  23880005
214100     PERFORM 5500-WRITE-INS-REC.                                  23890005
214200                                                                  23900005
214300******************************************************************23910005
214400* A ROW ON EITHER THE TIMCNRL OR ITS AUDIT TABLE MATCHING THE    *23920005
214500* CRITERIAL IN WHERE CLAUSE INDICATES PO WAS ALREADY SENT AS CMN.*23930005
214600******************************************************************23940005
214700 2320-CHECK-IF-SENT-AS-CMN.                                       23950005
214800                                                                  23960005
214900     EXEC SQL                                                     23970005
215000         SELECT DISTINCT                                          23980005
215100           COALESCE(IMCNRL.PO_NBR,                                23990005
215200                    AUCNRL.PO_NBR)   AS CNRL_PO                   24000005
215300           INTO :IMCNRL-PO-NBR                                    24010005
215400         FROM                                                     24020005
215500                                                                  24030005
215600            (SELECT DISTINCT                                      24040005
215700                 RL.PO_NBR                                        24050005
215800             FROM                                                 24060005
215900                 TIMCNRL   RL                                     24070005
216000             WHERE  RL.PO_NBR   = :PURCHS-PO-NBR                  24080005
216100               AND (DCONSLR_RLSE_CDE  IN ('S', 'R', 'Y') OR       24090005
216200                    (DCONSLR_RLSE_CDE = 'D' AND                   24100005
216300                     DCONSLR_ACTL_DTE <> :PC-NULL-DTE)))          24110005
216400             AS IMCNRL                                            24120005
216500                                                                  24130005
216600         FULL JOIN                                                24140005
216700                                                                  24150005
216800            (SELECT DISTINCT                                      24160005
216900                 RL.PO_NBR                                        24170005
217000             FROM                                                 24180005
217100                 TAUCNRL   RL                                     24190005
217200             WHERE  RL.PO_NBR   = :PURCHS-PO-NBR                  24200005
217300               AND (DCONSLR_RLSE_CDE  IN ('S', 'R', 'Y') OR       24210005
217400                    (DCONSLR_RLSE_CDE = 'D' AND                   24220005
217500                     DCONSLR_ACTL_DTE <> :PC-NULL-DTE)))          24230005
217600             AS AUCNRL                                            24240005
217700                                                                  24250005
217800         ON IMCNRL.PO_NBR  =  AUCNRL.PO_NBR                       24260005
217900                                                                  24270005
218000     END-EXEC.                                                    24280005
218100                                                                  24290005
218200     EVALUATE TRUE                                                24300005
218300         WHEN SQLCODE = ZERO                                      24310005
218400         WHEN SQLCODE = -811                                      24320005
218500             SET TR006-ERROR-TYPE-ERROR     TO TRUE               24330005
218600             INITIALIZE  TR006-ERROR-MSG                          24340005
218700             STRING 'ALREADY SNT CMN-OVERRODE'                    24350005
218800                 DELIMITED BY SIZE                                24360005
218900                 INTO TR006-ERROR-MSG                             24370005
219000             PERFORM 8830-WRITE-ERROR-LINE                        24380005
219100                                                                  24390005
219200                                                                  24400005
219300         WHEN SQLCODE = +100                                      24410005
219400             CONTINUE                                             24420005
219500                                                                  24430005
219600         WHEN SQLWARN0 NOT EQUAL SPACE                            24440005
219700         WHEN SQLCODE NOT EQUAL ZERO                              24450005
219800             DISPLAY '** ABEND **'                                24460005
219900             DISPLAY '** PROGRAM = TRKUP006 **'                   24470005
220000             DISPLAY '** PARAGRAPH = 2320-CHECK-IF-SENT-AS-CMN'   24480005
220100             DISPLAY '** PO NBR = ' PURCHS-PO-NBR                 24490005
220200             PERFORM 9100-SQL-ABEND                               24500022
220300     END-EVALUATE.                                                24510005
220400                                                                  24520005
220500******************************************************************24530005
220600 2350-PROCESS-PACKS-IDS.                                          24540005
220700                                                                  24550005
220800     PERFORM 8745-FETCH-POPRPK-FOR-PCK-CUR.                       24560005
220900                                                                  24570005
221000     IF PS-EOC-PACK-CURSOR                                        24580005
221100       PERFORM 8740-CLOSE-POPRPK-FOR-PCK-CUR                      24590005
221200       INITIALIZE TR006-UPC-NBR                                   24600005
221300                  TR006-PACK-ID                                   24610005
221400                  TR006-SKU                                       24620005
221500     ELSE                                                         24630005
221600       MOVE POPRPK-PO-PREPK-ID   TO TR006-PACK-ID                 24640005
221700       MOVE POPRPK-PK-SKU-NBR    TO TR006-SKU                     24650005
221800       MOVE POPRPK-PREPK-UPC-NBR TO TR006-UPC-NBR                 24660005
221900       PERFORM 8470-OPEN-E-COM-PACK-UPC-CUR                       24670005
222000       SET PS-EOC-E-COM-PACK-UPC-CUR-NO TO TRUE                   24680005
222100       SET PS-PASSED-E-COM-CHECK-NO     TO TRUE                   24690005
222200       PERFORM 2352-CHECK-PACK-FOR-E-COM                          24700005
222300            UNTIL PS-EOC-E-COM-PACK-UPC-CUR                       24710005
222400       PERFORM 8474-CLOSE-E-COM-PACK-UPC-CUR                      24720005
222500                                                                  24730005
222600       IF PS-PASSED-E-COM-CHECK                                   24740005
222700         INITIALIZE TR004-REC-TYPE-PCK                            24750005
222800         MOVE POPRPK-PO-PREPK-ID    TO                            24760005
222900                   TR004-PACK-ID                                  24770005
223000*        **********************************************           24780005
223100*        *             PROCESS PREPACKS               *           24790005
223200*        **********************************************           24800005
223300*        * THE NEXT 3 PERFORMS ARE SELECT DISTINCTS   *           24810005
223400*        * ON THE SAME TABLE WITH SAME WHERE CLAUSES. *           24820005
223500*        * THEY MUST BE KEPT SEPARATE SO THAT WE KNOW *           24830005
223600*        * WHETHER WE HAVE MULTI ROWS (-811) DUE TO   *           24840005
223700*        * STYLE, COLOR OR SIZE.  UNITS MUST BE DONE  *           24850005
223800*        * SEPARATELY BECAUSE -811 ISN'T CHECKED.     *           24860005
223900*        **********************************************           24870005
224000         PERFORM 2360-SELECT-VENDOR-STYLE-PCK                     24880005
224100         PERFORM 2361-SELECT-COLOR-PCK                            24890005
224200         PERFORM 2362-SELECT-SIZE-PCK                             24900005
224300*        *********** END PROCESS PREPACKS *************           24910005
224400         MOVE POPRPK-PREPK-DESC TO TR004-PACK-DESC                24920005
224500                                                                  24930005
224600         PERFORM 2364-CARTON-COUNTS-PCK                           24940005
224700**BUD**  IF PURCHS-PKGNG-CDE = PC-M                               24950007
224700         IF POPRPK-PREPK-TYP-CDE = PC-M                           24960007
224800            MOVE 1    TO TR004-PACKS-PER-CART                     24970005
224900         ELSE                                                     24980005
225000            IF POPRPK-INPK-UNT-QTY = ZERO                         24990005
225100              MOVE ZERO TO TR004-PACKS-PER-CART                   25000005
225200*             *************************************************   25010005
225300*             * A MESSAGE GETS PRINTED FOR ZERO INPK-UNIT-QTY *   25020005
225400*             * IN PARAGRAPGH 2364-CARTON-COUNTS-PCK SO DON'T *   25030005
225500*             * NEED ONE HERE.                                *   25040005
225600*             *************************************************   25050005
225700            ELSE                                                  25060005
225800              COMPUTE TR004-PACKS-PER-CART =                      25070005
225900                   (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY)    25080005
226000            END-IF                                                25090005
226100         END-IF                                                   25100005
226200                                                                  25110005
226300         IF POPRPK-PK-SKU-NBR IS ZERO                             25120005
226400            SET TR006-ERROR-TYPE-ERROR  TO TRUE                   25130005
226500            SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                 25140005
226600            INITIALIZE TR006-ERROR-MSG                            25150005
226700            MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU              25160005
226800            MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR          25170005
226900            STRING 'NO PCK SKU FOR PACK PO-NOT SENT'              25180005
227000                DELIMITED BY SIZE                                 25190005
227100                INTO TR006-ERROR-MSG                              25200005
227200            PERFORM 8830-WRITE-ERROR-LINE                         25210005
227300         END-IF                                                   25220005
227400                                                                  25230005
227500         IF POPRPK-PREPK-UPC-NBR IS ZERO                          25240005
227600            SET TR006-ERROR-TYPE-ERROR    TO TRUE                 25250005
227700            SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                 25260005
227800            INITIALIZE TR006-ERROR-MSG                            25270005
227900            MOVE POPRPK-PK-SKU-NBR        TO TR006-SKU            25280005
228000            MOVE POPRPK-PREPK-UPC-NBR     TO TR006-UPC-NBR        25290005
228100            STRING 'NO PCK UPC FOR PACK PO-NOT SENT'              25300005
228200                DELIMITED BY SIZE                                 25310005
228300                INTO TR006-ERROR-MSG                              25320005
228400            PERFORM 8830-WRITE-ERROR-LINE                         25330005
228500         END-IF                                                   25340005
228600                                                                  25350005
228700         MOVE POPRPK-PREPK-UPC-NBR TO TR004-PACK-UPC-NBR          25360005
228800         MOVE POPRPK-PK-SKU-NBR    TO TR004-PACK-SKU              25370005
228900                                                                  25380005
229000         PERFORM 5755-WRITE-PCK-REC                               25390005
229100                                                                  25400005
229200         SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE                 25410005
229300         PERFORM 2380-SELECT-PACK-SUM                             25420005
229400                                                                  25430005
229500         IF PS-SELECT-PACK-SUM-OK                                 25440005
229600           SET PS-COUNT-DCS-OK-NO         TO TRUE                 25450005
229700           PERFORM 2384-COUNT-DCS-FOR-PACK                        25460005
229800         END-IF                                                   25470005
229900                                                                  25480005
230000         IF PS-SELECT-PACK-SUM-OK                                 25490005
230100          AND PS-COUNT-DCS-OK                                     25500022
230200            PERFORM 8420-OPEN-PACK-DC-CURSOR                      25510005
230300            SET PS-FIRST-DC                 TO TRUE               25520005
230400            SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE               25530005
139868            SET PS-OUTLET-STORE-NO          TO TRUE               25540038
230500            PERFORM 2370-PROCESS-PREPACK-DC UNTIL                 25550005
230600                    PS-EOC-PREPACK-DC-CURSOR                      25560005
230700            SET PS-EOC-PREPACK-DC-CURSOR-NO TO TRUE               25570005
230800         END-IF                                                   25580005
230900                                                                  25590005
231000         PERFORM 8450-OPEN-PACK-UPC-CUR                           25600005
231100         SET PS-LINES-ON-TPURITM-NO       TO TRUE                 25610005
231200         SET PS-AC-AP-LINES-NO            TO TRUE                 25620005
231300         PERFORM 2402-PROCESS-PACK-UPC UNTIL                      25630005
231400                  PS-EOC-PACK-UPC-CURSOR                          25640005
231500         SET PS-EOC-PACK-UPC-CURSOR-NO TO TRUE                    25650005
231600                                                                  25660005
231700       END-IF                                                     25670005
231800                                                                  25680005
231900     END-IF.                                                      25690005
232000                                                                  25700005
232100******************************************************************25710005
232200* GO THRU ALL UPCS ON PACK - IF THERE ARE ANY SPLITS FOR E-COM-  *25720005
232300* MERCE FULFILLMENT CENTER, ALL OF THE UPCS ON THE PACK MUST BE  *25730005
232400* E-COM TYPE OR THE SPLITS WILL NOT BE SENT.                     *25740005
232500******************************************************************25750005
232600 2352-CHECK-PACK-FOR-E-COM.                                       25760005
232700                                                                  25770005
232800     PERFORM 8472-FETCH-E-COM-PACK-UPC-CUR.                       25780005
232900                                                                  25790005
233000     IF PS-EOC-E-COM-PACK-UPC-CUR                                 25800005
233100                                                                  25810005
233200        EVALUATE TRUE                                             25820005
233300                                                                  25830005
233400           WHEN PV-TTL-E-COM-PACK-UPCS = ZERO                     25840005
233500             AND PV-TTL-BAD-PACK-UPCS = ZERO                      25850005
233600           WHEN PV-TTL-E-COM-PACK-UPCS  = PV-TTL-PACK-UPCS        25860005
233700                                                                  25870005
233800             SET PS-PASSED-E-COM-CHECK TO TRUE                    25880005
233900                                                                  25890005
234000           WHEN OTHER                                             25900005
234100                                                                  25910005
234200             INITIALIZE TR006-ERROR-MSG                           25920005
234300             MOVE POPRPK-PK-SKU-NBR        TO TR006-SKU           25930005
234400             MOVE POPRPK-PREPK-UPC-NBR     TO TR006-UPC-NBR       25940005
234500             SET TR006-ERROR-TYPE-ERROR    TO TRUE                25950005
234600             STRING 'PACK-E-COM DC-NOT E-COM SKU-FIX'             25960005
234700                 DELIMITED BY SIZE                                25970005
234800                 INTO TR006-ERROR-MSG                             25980005
234900             PERFORM 8830-WRITE-ERROR-LINE                        25990005
235000             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                26000005
235100                                                                  26010005
235200        END-EVALUATE                                              26020005
235300                                                                  26030005
235400        INITIALIZE  PV-TTL-E-COM-PACK-UPCS                        26040005
235500        INITIALIZE  PV-TTL-PACK-UPCS                              26050005
235600        INITIALIZE  PV-TTL-BAD-PACK-UPCS                          26060005
235700                                                                  26070005
235800     ELSE                                                         26080005
235900                                                                  26090005
236000       ADD +1   TO PV-TTL-PACK-UPCS                               26100005
236100       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     26110005
236200       PERFORM 2410-CHECK-FOR-E-COM-DCS                           26120005
236300                                                                  26130005
236400       IF PS-THERE-ARE-E-COM-DCS                                  26140005
236500          SET PS-THIS-IS-E-COM-UPC-NO  TO TRUE                    26150005
236600          PERFORM 2415-SELECT-UPC-FROM-TWEBITM                    26160005
236700             IF PS-THIS-IS-E-COM-UPC                              26170005
236800               ADD +1   TO PV-TTL-E-COM-PACK-UPCS                 26180005
236900             ELSE                                                 26190005
237000               ADD +1   TO PV-TTL-BAD-PACK-UPCS                   26200005
237100             END-IF                                               26210005
237200       END-IF                                                     26220005
237300                                                                  26230005
237400     END-IF.                                                      26240005
237500                                                                  26250005
237600******************************************************************26260005
237700* SELECT THE VENDOR STYLE NAME FROM TPURITM.                     *26270005
237800******************************************************************26280005
237900 2360-SELECT-VENDOR-STYLE-PCK.                                    26290005
238000                                                                  26300005
238100     EXEC SQL                                                     26310005
238200         SELECT DISTINCT                                          26320005
238300                XVS.VS_NBR                                        26330005
238400           INTO :XLT00004-VS-NBR                                  26340005
238500           FROM TPURITM  A                                        26350005
238600               ,XLT_VND_STYL XVS                                  26360005
238700               ,XLT_SKU      XS                                   26370005
238800          WHERE A.PO_NBR         = :PURCHS-PO-NBR                 26380005
238900            AND A.ITM_NBR        =  XS.ITM_NBR                    26390005
239000            AND XS.STYL_ID       =  XVS.STYL_ID                   26400005
239100            AND A.VER_STATUS_CDE = :PC-A                          26410005
239200            AND A.STATUS_CDE    IN ('AC', 'AP')                   26420005
239300            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            26430005
239400     END-EXEC                                                     26440005
239500                                                                  26450005
239600     EVALUATE TRUE                                                26460005
239700         WHEN SQLCODE = ZERO                                      26470005
239800             MOVE XLT00004-VS-NBR       TO                        26480005
239900                   TR004-PACK-VEND-STYL-NAME                      26490005
240000                                                                  26500005
240100         WHEN SQLCODE = +100                                      26510005
240200             MOVE SPACES TO TR004-PACK-VEND-STYL-NAME             26520005
240300                                                                  26530005
240400         WHEN SQLCODE = -811                                      26540005
240500             MOVE PC-MULTI TO TR004-PACK-VEND-STYL-NAME           26550005
240600             MOVE POPRPK-PO-PREPK-ID TO TR004-PACK-ID             26560005
240700                                                                  26570005
240800         WHEN SQLWARN0 NOT EQUAL SPACE                            26580005
240900         WHEN SQLCODE NOT EQUAL ZERO                              26590005
241000             DISPLAY '**************************************'     26600005
241100             DISPLAY '** ABEND                            **'     26610005
241200             DISPLAY '** PROGRAM = TRKUP006               **'     26620005
241300             DISPLAY '** PARAGRAPH = 2360-SELECT-VENDOR-  **'     26630005
241400             DISPLAY '**                  STYLE-PCK       **'     26640005
241500             DISPLAY '** SELECT TPURITM                   **'     26650005
241600             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              26660005
241700             DISPLAY '**************************************'     26670005
241800             PERFORM 9100-SQL-ABEND                               26680022
241900     END-EVALUATE.                                                26690005
242000                                                                  26700005
242100******************************************************************26710005
242200* SELECT THE COLOR CODE AND DESCRIPTION FROM TPURITM.            *26720005
242300******************************************************************26730005
242400 2361-SELECT-COLOR-PCK.                                           26740005
242500                                                                  26750005
242600     EXEC SQL                                                     26760005
242700         SELECT DISTINCT                                          26770005
242800                XS.NRF_CLOR_CDE                                   26780005
242900              , XS.CSTM_CLOR_DESC                                 26790005
243000           INTO :XLT00003-NRF-CLOR-CDE                            26800005
243100              , :XLT00003-CSTM-CLOR-DESC                          26810005
243200           FROM TPURITM  A                                        26820005
243300               ,XLT_SKU  XS                                       26830005
243400          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                26840005
243500            AND A.ITM_NBR        =  XS.ITM_NBR                    26850005
243600            AND A.VER_STATUS_CDE = :PC-A                          26860005
243700            AND A.STATUS_CDE    IN ('AC', 'AP')                   26870005
243800            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            26880005
243900     END-EXEC                                                     26890005
244000                                                                  26900005
244100     EVALUATE TRUE                                                26910005
244200         WHEN SQLCODE = ZERO                                      26920005
244300             MOVE XLT00003-NRF-CLOR-CDE   TO TR004-PACK-COLOR-CDE 26930005
244400             MOVE XLT00003-CSTM-CLOR-DESC TO TR004-PACK-COLOR-DESC26940005
244500                                                                  26950005
244600         WHEN SQLCODE = +100                                      26960005
244700             MOVE SPACES TO TR004-PACK-COLOR-CDE                  26970005
244800                            TR004-PACK-COLOR-DESC                 26980005
244900                                                                  26990005
245000         WHEN SQLCODE = -811                                      27000005
245100             MOVE PC-MULTI TO TR004-PACK-COLOR-CDE                27010005
245200                              TR004-PACK-COLOR-DESC               27020005
245300                                                                  27030005
245400         WHEN SQLWARN0 NOT EQUAL SPACE                            27040005
245500         WHEN SQLCODE NOT EQUAL ZERO                              27050005
245600             DISPLAY '**************************************'     27060005
245700             DISPLAY '** ABEND                            **'     27070005
245800             DISPLAY '** PROGRAM = TRKUP006               **'     27080005
245900             DISPLAY '** PARAGRAPH = 2361-SELECT-COLOR-PCK**'     27090005
246000             DISPLAY '** SELECT TPURITM                   **'     27100005
246100             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              27110005
246200             DISPLAY '**************************************'     27120005
246300             PERFORM 9100-SQL-ABEND                               27130022
246400     END-EVALUATE.                                                27140005
246500                                                                  27150005
246600******************************************************************27160005
246700* SELECT THE SIZE DESCRIPTION FROM TPURITM.                      *27170005
246800******************************************************************27180005
246900 2362-SELECT-SIZE-PCK.                                            27190005
247000                                                                  27200005
247100     EXEC SQL                                                     27210005
247200         SELECT DISTINCT                                          27220005
247300                XS.SIZE_DESC                                      27230005
247400           INTO :XLT00003-SIZE-DESC                               27240005
247500           FROM TPURITM  A                                        27250005
247600               ,XLT_SKU  XS                                       27260005
247700          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                27270005
247800            AND A.ITM_NBR        =  XS.ITM_NBR                    27280005
247900            AND A.VER_STATUS_CDE = :PC-A                          27290005
248000            AND A.STATUS_CDE    IN ('AC', 'AP')                   27300005
248100            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            27310005
248200     END-EXEC                                                     27320005
248300                                                                  27330005
248400     EVALUATE TRUE                                                27340005
248500         WHEN SQLCODE = ZERO                                      27350005
248600             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         27360005
248700                 MOVE PC-NO-SIZE         TO TR004-PACK-SIZE-DESC  27370005
248800             ELSE                                                 27380005
248900                 MOVE XLT00003-SIZE-DESC TO TR004-PACK-SIZE-DESC  27390005
249000             END-IF                                               27400005
249100                                                                  27410005
249200         WHEN SQLCODE = +100                                      27420005
249300             MOVE SPACES  TO TR004-PACK-SIZE-DESC                 27430005
249400                                                                  27440005
249500         WHEN SQLCODE = -811                                      27450005
249600             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         27460005
249700                 MOVE PC-NO-SIZE TO TR004-PACK-SIZE-DESC          27470005
249800             ELSE                                                 27480005
249900                 MOVE PC-MULTI TO TR004-PACK-SIZE-DESC            27490005
250000             END-IF                                               27500005
250100                                                                  27510005
250200         WHEN SQLWARN0 NOT EQUAL SPACE                            27520005
250300         WHEN SQLCODE NOT EQUAL ZERO                              27530005
250400             DISPLAY '**************************************'     27540005
250500             DISPLAY '** ABEND                            **'     27550005
250600             DISPLAY '** PROGRAM = TRKUP006               **'     27560005
250700             DISPLAY '** PARAGRAPH = 2362-SELECT-SIZE-PCK **'     27570005
250800             DISPLAY '** SELECT TPURITM                   **'     27580005
250900             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              27590005
251000             DISPLAY '**************************************'     27600005
251100             PERFORM 9100-SQL-ABEND                               27610022
251200     END-EVALUATE.                                                27620005
251300                                                                  27630005
251400******************************************************************27640005
251500* CALCULATE ORDER QTY, CARTON COUNTS, AND UNITS PER CARTON.      *27650005
251600******************************************************************27660005
251700 2364-CARTON-COUNTS-PCK.                                          27670005
251800                                                                  27680005
251900*BUD*EVALUATE PURCHS-PKGNG-CDE                                    27690007
251900     EVALUATE POPRPK-PREPK-TYP-CDE                                27700007
252000         WHEN PC-I                                                27710005
252100             MOVE POPRPK-OTPK-UNT-QTY TO                          27720005
252200                  TR004-PACK-UNITS-PER-CTN                        27730005
139868                  PV-HOLD-PCK-UNIT-PER-CTN                        27740038
252300         WHEN PC-M                                                27750005
252400             MOVE POPRPK-INPK-UNT-QTY TO                          27760005
252500                  TR004-PACK-UNITS-PER-CTN                        27770005
139868                  PV-HOLD-PCK-UNIT-PER-CTN                        27780038
252600     END-EVALUATE.                                                27790005
252700                                                                  27800005
252800     PERFORM 2365-PACK-UNITS-PCK.                                 27810005
252900                                                                  27820005
253000     IF TR004-PACK-UNITS-PER-CTN  = ZERO                          27830005
253100       MOVE ZERO TO TR004-PACK-CART-CT                            27840005
139868                    PV-HOLD-PCK-CART-CT                           27850038
253200             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 27860005
253300             INITIALIZE TR006-ERROR-MSG                           27870005
253400             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            27880005
253500             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        27890005
253600**BUD**      IF PURCHS-PKGNG-CDE = PC-I                           27900007
253600             IF POPRPK-PREPK-TYP-CDE = PC-I                       27910007
253700               STRING 'PCK POPRPK-OTPK-UNT-QTY FLD IS 0'          27920005
253800                   DELIMITED BY SIZE                              27930005
253900                   INTO TR006-ERROR-MSG                           27940005
254000             ELSE                                                 27950005
254100               STRING 'PCK POPRPK-INPK-UNT-QTY FLD IS 0'          27960005
254200                   DELIMITED BY SIZE                              27970005
254300                   INTO TR006-ERROR-MSG                           27980005
254400             END-IF                                               27990005
254500             PERFORM 8830-WRITE-ERROR-LINE                        28000005
254600     ELSE                                                         28010005
254700       INITIALIZE PV-REMAINDER                                    28020005
254800       DIVIDE TR004-PACK-UNITS-PER-CTN INTO                       28030005
254900              PA-TOTAL-PACK-UNITS GIVING                          28040005
255000              TR004-PACK-CART-CT ROUNDED                          28050005
255100              REMAINDER PV-REMAINDER                              28060005
139868       MOVE TR004-PACK-CART-CT         TO PV-HOLD-PCK-CART-CT     28070038
255200     END-IF.                                                      28080005
255300                                                                  28090005
255400     IF PV-REMAINDER = ZERO                                       28100005
255500       CONTINUE                                                   28110005
255600     ELSE                                                         28120005
255700       SET TR006-ERROR-TYPE-ERROR      TO TRUE                    28130005
255800       INITIALIZE TR006-ERROR-MSG                                 28140005
255900                  TR006-SKU                                       28150005
256000                  TR006-UPC-NBR                                   28160005
256100       STRING                                                     28170005
256200          'SUM UNTS/PCK QTY NOT EVEN-FIX'                         28180005
256300           DELIMITED BY SIZE                                      28190005
256400           INTO TR006-ERROR-MSG                                   28200005
256500       PERFORM 8830-WRITE-ERROR-LINE                              28210005
256600       SET PS-PROBLEM-SO-SET-RETRANS   TO TRUE                    28220005
256700     END-IF.                                                      28230005
256800                                                                  28240005
256900******************************************************************28250005
257000* CALCULATE PACK UNITS.                                          *28260005
257100******************************************************************28270005
257200 2365-PACK-UNITS-PCK.                                             28280005
257300                                                                  28290005
257400     EXEC SQL                                                     28300005
257500           SELECT                                                 28310005
257600                  SUM (A.UNT_QTY)                                 28320005
257700             INTO                                                 28330005
257800                  :PA-TOTAL-PACK-UNITS                            28340005
257900             FROM                                                 28350005
258000                  TPURITM  A                                      28360005
258100             WHERE A.PO_NBR         = :PURCHS-PO-NBR              28370005
258200               AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID         28380005
258300               AND A.VER_STATUS_CDE = 'A'                         28390005
258400               AND A.STATUS_CDE    IN ('AC', 'AP')                28400005
258500     END-EXEC.                                                    28410005
258600                                                                  28420005
258700     EVALUATE TRUE                                                28430005
258800         WHEN SQLCODE = ZERO                                      28440005
258900             MOVE PA-TOTAL-PACK-UNITS TO                          28450005
259000                   TR004-PACK-UNIT-QTY                            28460005
139868                   PV-HOLD-PCK-UNIT-QTY                           28470038
259100                                                                  28480005
259200         WHEN SQLCODE = +100                                      28490005
259300         WHEN SQLCODE = -305                                      28500005
259400             MOVE ZEROES TO TR004-PACK-UNIT-QTY                   28510005
139868                            PV-HOLD-PCK-UNIT-QTY                  28520038
259500                                                                  28530005
259600         WHEN SQLWARN0 NOT EQUAL SPACE                            28540005
259700         WHEN SQLCODE NOT EQUAL ZERO                              28550005
259800             DISPLAY '** ABEND **'                                28560005
259900             DISPLAY '** PROGRAM = TRKUP006 **'                   28570005
260000             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          28580005
260100             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     28590005
260200             DISPLAY '** PARA = 2365-PACK-UNITS-PCK**'            28600005
260300             PERFORM 9100-SQL-ABEND                               28610022
260400     END-EVALUATE.                                                28620005
260500 EJECT                                                            28630005
260600******************************************************************28640005
260700* PROCESS PREPACK DC INFORMATION.                                *28650005
260800******************************************************************28660005
260900 2370-PROCESS-PREPACK-DC.                                         28670005
261000                                                                  28680005
261100     PERFORM 8430-FETCH-PACK-DC-CURSOR.                           28690005
261200                                                                  28700025
261300     IF PS-EOC-PREPACK-DC-CURSOR                                  28710005
139868        PERFORM 2371-PROCESS-PREPACK-CONT                         28720038
139868     ELSE                                                         28730038
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     28740038
139868        PERFORM 1050-CHECK-IF-OUTLET-DC                           28750038
139868        IF PS-OUTLET-STORE                                        28760038
139868           SET PS-FIRST-STORE  TO TRUE                            28770038
139868           PERFORM 9000-OUTLET-STORE-PREPACK                      28780038
139868        ELSE                                                      28790038
155029           EVALUATE TRUE                                          28800074
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       28810074
155029               AND  PV-FAST-E-BUS-IND = 'N')                      28820074
155029                 IF PS-FIRST-UPC-YES                              28830074
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 28840074
155029                    SET PS-FIRST-STORE    TO TRUE                 28850074
155029                 END-IF                                           28860074
155029                 SET PS-OUTLET-STORE   TO TRUE                    28870074
155029                 PERFORM 9000-OUTLET-STORE-PREPACK                28880074
155029                                                                  28890074
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       28900074
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      28910074
155029                 IF PS-FIRST-UPC-YES                              28920074
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 28930074
155029                    SET PS-FIRST-STORE    TO TRUE                 28940074
155029                 END-IF                                           28950074
155029                 SET PS-OUTLET-STORE   TO TRUE                    28960074
155029                 PERFORM 9000-OUTLET-STORE-PREPACK                28970074
155029                                                                  28980074
155029              WHEN OTHER                                          28990074
139868                 PERFORM 2371-PROCESS-PREPACK-CONT                29000048
155029           END-EVALUATE                                           29010074
139868        END-IF                                                    29020048
139868     END-IF.                                                      29030048
139868                                                                  29040038
139868******************************************************************29050038
139868 2371-PROCESS-PREPACK-CONT.                                       29060038
139868                                                                  29070038
139868     IF PS-EOC-PREPACK-DC-CURSOR                                  29080038
139868         PERFORM 8425-CLOSE-PACK-DC-CURSOR                        29090038
139868         IF PS-DC-SPLIT-INFO-PRESENT                              29100038
139868            IF PS-OUTLET-STORE                                    29110038
139868               CONTINUE                                           29120038
139868            ELSE                                                  29130038
261600               PERFORM 2386-ADJUST-ROUNDED-PDC-DIST               29140017
261700               PERFORM 5756-WRITE-PDC-REC                         29150017
139868            END-IF                                                29160038
261800         END-IF                                                   29170017
261900     ELSE                                                         29180008
262000         IF PS-FIRST-DC                                           29190008
262100           SET PS-FIRST-DC-NO     TO TRUE                         29200008
262200*          ***************************************************    29210008
262300*          * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO       29220008
262400*          * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.        29230008
262500*          ***************************************************    29240008
262600           COMPUTE PV-DCS-TO-SKIP =                               29250008
262700             (TR004-PACK-CART-CT - PV-TOTAL-NBR-OF-DCS)           29260008
262800              * (-1)                                              29270008
262900                                                                  29280008
263000             INITIALIZE PV-TTL-ALL-DCS-PCT                        29290008
263100                      PV-TTL-ALL-DCS-UNITS                        29300008
263200                      PV-TTL-ALL-DCS-CARTS                        29310008
263300         ELSE                                                     29320008
263400*            *******************************************          29330008
263500*            * IF NOT EOC OR FIRST DC, WRITE THE DTL   *          29340008
263600*            * EXTRACT & REPORT RECS FROM THE PRIOR DC *          29350008
263700*            *******************************************          29360008
263800             PERFORM 5756-WRITE-PDC-REC                           29370008
263900         END-IF                                                   29380008
263900                                                                  29390008
264000         INITIALIZE TR004-REC-TYPE-PDC                            29400035
264100         MOVE ALLPLN-DEST-NBR TO TR004-PDC-DIST-CNTR              29410008
264200         PERFORM 2372-ORDER-PERCENT-PDC                           29420008
264300         PERFORM 2374-ORDER-UNIT-CNT-PDC                          29430008
264400         PERFORM 2376-ORDER-CART-CNT-PDC                          29440008
264500         IF PV-DCS-TO-SKIP  > ZERO                                29450008
264600           SUBTRACT 1 FROM PV-DCS-TO-SKIP                         29460008
264700         END-IF                                                   29470008
264800     END-IF.                                                      29480008
264900                                                                  29490008
265000 EJECT                                                            29500005
265100******************************************************************29510005
265200* CALCULATE THE DC ORDER PERCENT.                                *29520005
265300*   NOTE: NO MSG. DIVIDE BY ZERO - MSG IS ALREADY DONE IN SELECT *29530005
265400******************************************************************29540005
265500 2372-ORDER-PERCENT-PDC.                                          29550005
265600                                                                  29560005
265700     IF PA-TOTAL-PACK-SPLIT-QTY = ZERO                            29570005
265800       CONTINUE                                                   29580005
265900     ELSE                                                         29590005
266000       DIVIDE PA-TOTAL-PACK-SPLIT-QTY                             29600005
266100         INTO PA-PDC-SPLIT-QTY                                    29610005
266200       GIVING PV-QUOTIENT-PDC-PERCNT ROUNDED                      29620005
266300     END-IF.                                                      29630005
266400                                                                  29640005
266500     MULTIPLY PV-QUOTIENT-PDC-PERCNT                              29650005
266600           BY +100                                                29660005
266700       GIVING TR004-PDC-PERCNT ROUNDED.                           29670005
266800                                                                  29680005
266900     IF TR004-PDC-PERCNT = ZERO                                   29690005
267000        MOVE +1 TO TR004-PDC-PERCNT                               29700005
267100     END-IF.                                                      29710005
267200                                                                  29720005
267300     ADD  TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT.          29730005
267400                                                                  29740005
267500******************************************************************29750005
267600* CALCULATE THE DC ORDER UNIT COUNT.                             *29760005
267700******************************************************************29770005
267800 2374-ORDER-UNIT-CNT-PDC.                                         29780005
267900                                                                  29790005
268000     MOVE PA-PDC-SPLIT-QTY     TO TR004-PDC-UNIT-QTY.             29800005
268100                                                                  29810005
268200     IF PV-DCS-TO-SKIP  > ZERO                                    29820005
268300       MOVE ZERO    TO TR004-PDC-CART-CT                          29830005
268400     END-IF.                                                      29840005
268500                                                                  29850005
268600     ADD  TR004-PDC-UNIT-QTY   TO PV-TTL-ALL-DCS-UNITS.           29860005
268700                                                                  29870005
268800******************************************************************29880005
268900* CALCULATE THE DC ORDER CART COUNT.                             *29890005
269000******************************************************************29900005
269100 2376-ORDER-CART-CNT-PDC.                                         29910005
269200                                                                  29920005
269300*BUD*EVALUATE PURCHS-PKGNG-CDE                                    29930007
269300     EVALUATE POPRPK-PREPK-TYP-CDE                                29940007
269400                                                                  29950005
269500         WHEN PC-I                                                29960005
269600           IF POPRPK-OTPK-UNT-QTY = ZERO                          29970005
269700             MOVE ZERO TO TR004-PDC-CART-CT                       29980005
269800             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 29990005
269900             INITIALIZE TR006-ERROR-MSG                           30000005
270000             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            30010005
270100             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        30020005
270200             STRING 'POPRPK-OTPK-UNT-QTY FLD IS 0-DC'             30030005
270300                 DELIMITED BY SIZE                                30040005
270400                 INTO TR006-ERROR-MSG                             30050005
270500             PERFORM 8830-WRITE-ERROR-LINE                        30060005
270600           ELSE                                                   30070005
270700             INITIALIZE PV-REMAINDER                              30080005
270800             DIVIDE POPRPK-OTPK-UNT-QTY                           30090005
270900               INTO PA-PDC-SPLIT-QTY                              30100005
271000             GIVING TR004-PDC-CART-CT                             30110005
271100             REMAINDER PV-REMAINDER                               30120005
271200           END-IF                                                 30130005
271300                                                                  30140005
271400         WHEN PC-M                                                30150005
271500           IF POPRPK-INPK-UNT-QTY = ZERO                          30160005
271600             MOVE ZERO TO TR004-PDC-CART-CT                       30170005
271700             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 30180005
271800             INITIALIZE TR006-ERROR-MSG                           30190005
271900             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            30200005
272000             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        30210005
272100             STRING 'POPRPK-INPK-UNT-QTY FLD IS 0-DC'             30220005
272200                 DELIMITED BY SIZE                                30230005
272300                 INTO TR006-ERROR-MSG                             30240005
272400             PERFORM 8830-WRITE-ERROR-LINE                        30250005
272500           ELSE                                                   30260005
272600             INITIALIZE PV-REMAINDER                              30270005
272700             DIVIDE POPRPK-INPK-UNT-QTY                           30280005
272800               INTO PA-PDC-SPLIT-QTY                              30290005
272900             GIVING TR004-PDC-CART-CT                             30300005
273000             REMAINDER PV-REMAINDER                               30310005
273100           END-IF                                                 30320005
273200                                                                  30330005
273300     END-EVALUATE.                                                30340005
273400                                                                  30350005
273500     IF PV-DCS-TO-SKIP  > ZERO                                    30360005
273600       MOVE ZERO    TO TR004-PDC-CART-CT                          30370005
273700     END-IF.                                                      30380005
273800                                                                  30390005
273900     IF TR004-PDC-CART-CT = ZERO                                  30400005
274000       IF PURCHS-NEW-STR-PO-IND = 'Y'                             30410005
274100         INITIALIZE TR006-ERROR-MSG                               30420005
274200         MOVE POPRPK-PK-SKU-NBR      TO TR006-SKU                 30430005
274300         MOVE POPRPK-PREPK-UPC-NBR   TO TR006-UPC-NBR             30440005
274400         MOVE ALLPLN-DEST-NBR        TO PV-DEST-NBR               30450005
274500         SET TR006-ERROR-TYPE-ERROR  TO TRUE                      30460005
274600         STRING                                                   30470005
274700         'DC-'                                                    30480005
274800              PV-DEST-NBR                                         30490005
274900         '-0 CARTONS-PCK NEW STR PO'                              30500005
275000              DELIMITED BY SIZE                                   30510005
275100            INTO TR006-ERROR-MSG                                  30520005
275200         PERFORM 8830-WRITE-ERROR-LINE                            30530005
275300       END-IF                                                     30540005
275400     ELSE                                                         30550005
275500       IF PV-REMAINDER = ZERO                                     30560005
275600          CONTINUE                                                30570005
275700       ELSE                                                       30580005
275800*         ****************************************                30590005
275900*         * THE CARTON QUANTITY IS GREATER THAN  *                30600005
276000*         * ZERO, BUT THE REMAINDER FROM THE     *                30610005
276100*         * DIVIDE BY UNITS IS GREATER THAN ZERO *                30620005
276200*         * SO ISSUE MESSAGE BELOW & DON'T SEND. *                30630005
276300*         ****************************************                30640005
276400          INITIALIZE TR006-ERROR-MSG                              30650005
276500          MOVE POPRPK-PK-SKU-NBR        TO TR006-SKU              30660005
276600          MOVE POPRPK-PREPK-UPC-NBR     TO TR006-UPC-NBR          30670005
276700          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 30680005
276800          STRING                                                  30690005
276900             'DC '                                                30700005
277000              TR004-PDC-DIST-CNTR                                 30710005
277100             'PCK UNTS NT DVBL/OTR-FIX'                           30720005
277200              DELIMITED BY SIZE                                   30730005
277300              INTO TR006-ERROR-MSG                                30740005
277400          PERFORM 8830-WRITE-ERROR-LINE                           30750005
277500          SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                  30760005
277600       END-IF                                                     30770005
277700     END-IF.                                                      30780005
277800                                                                  30790005
277900     ADD  TR004-PDC-CART-CT       TO PV-TTL-ALL-DCS-CARTS.        30800005
278000                                                                  30810005
278100******************************************************************30820005
278200* SELECT PREPACK SUM LINE.                                       *30830005
278300******************************************************************30840005
278400 2380-SELECT-PACK-SUM.                                            30850005
278500                                                                  30860005
278600     EXEC SQL                                                     30870005
278700           SELECT                                                 30880005
278800                  SUM (A.CURR_SPLIT_QTY)                          30890005
278900             INTO                                                 30900005
279000                  :PA-TOTAL-PACK-SPLIT-QTY                        30910005
279100             FROM                                                 30920005
279200                  TALLPLN  A                                      30930005
279300                 ,TPURITM  B                                      30940005
279400                                                                  30950005
279500             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                30960005
279600               AND A.PO_NBR      =  B.PO_NBR                      30970005
279700               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  30980005
279800               AND A.CURR_SPLIT_QTY >  0                          30990005
279900               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           31000005
280000               AND B.VER_STATUS_CDE = 'A'                         31010005
280100               AND B.STATUS_CDE    IN ('AC', 'AP')                31020005
280200     END-EXEC.                                                    31030005
280300                                                                  31040005
280400     EVALUATE TRUE                                                31050005
280500         WHEN SQLCODE = ZERO AND PA-TOTAL-PACK-SPLIT-QTY > 0      31060005
280600           SET PS-SELECT-PACK-SUM-OK     TO TRUE                  31070005
280700                                                                  31080005
280800         WHEN SQLCODE = ZERO AND PA-TOTAL-PACK-SPLIT-QTY = 0      31090005
280900         WHEN SQLCODE = +100                                      31100005
281000         WHEN SQLCODE = -305                                      31110005
281100             MOVE ZEROES TO TR004-PDC-PERCNT                      31120005
281200             INITIALIZE TR006-ERROR-MSG                           31130005
281300             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         31140005
281400             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     31150005
281500             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              31160005
281600             STRING 'PCK PO MISSING SPLIT-FIX'                    31170005
281700                 DELIMITED BY SIZE                                31180005
281800                 INTO TR006-ERROR-MSG                             31190005
281900             PERFORM 8830-WRITE-ERROR-LINE                        31200005
282000             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                31210005
282100                                                                  31220005
282200                                                                  31230005
282300         WHEN SQLWARN0 NOT EQUAL SPACE                            31240005
282400         WHEN SQLCODE NOT EQUAL ZERO                              31250005
282500             DISPLAY '** ABEND **'                                31260005
282600             DISPLAY '** PROGRAM = TRKUP006 **'                   31270005
282700             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          31280005
282800             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      31290005
282900             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     31300005
283000             DISPLAY '** PARA = 2380-SELECT-PACK-SUM'             31310005
283100             PERFORM 9100-SQL-ABEND                               31320022
283200     END-EVALUATE.                                                31330005
283300                                                                  31340005
283400******************************************************************31350005
283500* COUNT THE DCS FOR THIS PACK.                                   *31360005
283600******************************************************************31370005
283700 2384-COUNT-DCS-FOR-PACK.                                         31380005
283800                                                                  31390005
283900     EXEC SQL                                                     31400005
284000           SELECT                                                 31410005
284100                  COUNT(DISTINCT A.DEST_NBR)                      31420005
284200             INTO                                                 31430005
284300                  :PV-TOTAL-NBR-OF-DCS                            31440005
284400             FROM                                                 31450005
284500                  TALLPLN  A                                      31460005
284600                 ,TPURITM  B                                      31470005
284700                                                                  31480005
284800             WHERE A.PO_NBR      =  :PURCHS-PO-NBR                31490005
284900               AND A.PO_NBR      =  B.PO_NBR                      31500005
285000               AND A.PO_LNE_NBR  =  B.PO_LNE_NBR                  31510005
285100               AND A.CURR_SPLIT_QTY >  0                          31520005
285200               AND B.PO_PREPK_ID =  :POPRPK-PO-PREPK-ID           31530005
285300               AND B.VER_STATUS_CDE = 'A'                         31540005
285400               AND B.STATUS_CDE    IN ('AC', 'AP')                31550005
285500     END-EXEC.                                                    31560005
285600                                                                  31570005
285700     EVALUATE TRUE                                                31580005
285800         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS  > 0         31590005
285900*          ***************************************************    31600005
286000*          * IF THERE ARE MORE DCS THAN CARTONS, WE'VE GOT A      31610005
286100*          * PROBLEM AND WE DON'T WANT TO SEND THE SPLIT.         31620005
286200*          ***************************************************    31630005
286300           IF TR004-PACK-CART-CT  < PV-TOTAL-NBR-OF-DCS           31640005
286400             INITIALIZE   TR006-ERROR-MSG                         31650005
286500             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         31660005
286600             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     31670005
286700             SET TR006-ERROR-TYPE-ERROR      TO TRUE              31680005
286800             STRING 'PACK CARTONS < NBR DCS-FIX'                  31690005
286900                 DELIMITED BY SIZE                                31700005
287000                 INTO TR006-ERROR-MSG                             31710005
287100             PERFORM 8830-WRITE-ERROR-LINE                        31720005
287200             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                31730005
287300           ELSE                                                   31740005
287400             SET PS-COUNT-DCS-OK           TO TRUE                31750005
287500           END-IF                                                 31760005
287600                                                                  31770005
287700         WHEN SQLCODE = +100                                      31780005
287800         WHEN SQLCODE = -305                                      31790005
287900             MOVE ZEROES TO TR004-PDC-PERCNT                      31800005
288000             INITIALIZE TR006-ERROR-MSG                           31810005
288100             MOVE POPRPK-PK-SKU-NBR          TO TR006-SKU         31820005
288200             MOVE POPRPK-PREPK-UPC-NBR       TO TR006-UPC-NBR     31830005
288300             SET TR006-ERROR-TYPE-MISS-SPLT  TO TRUE              31840005
288400             STRING 'PCK PO MISSING SPLIT-FIX'                    31850005
288500                 DELIMITED BY SIZE                                31860005
288600                 INTO TR006-ERROR-MSG                             31870005
288700             PERFORM 8830-WRITE-ERROR-LINE                        31880005
288800             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                31890005
288900                                                                  31900005
289000                                                                  31910005
289100         WHEN SQLWARN0 NOT EQUAL SPACE                            31920005
289200         WHEN SQLCODE NOT EQUAL ZERO                              31930005
289300             DISPLAY '** ABEND **'                                31940005
289400             DISPLAY '** PROGRAM = TRKUP006 **'                   31950005
289500             DISPLAY '** PO NUMBER     = ' PURCHS-PO-NBR          31960005
289600             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      31970005
289700             DISPLAY '** PREPACK ID    = ' PURITM-PO-PREPK-ID     31980005
289800             DISPLAY '** PARA = 2384-COUNT-DCS-FOR-PACK'          31990005
289900             PERFORM 9100-SQL-ABEND                               32000022
290000     END-EVALUATE.                                                32010005
290100                                                                  32020005
290200******************************************************************32030005
290300 2386-ADJUST-ROUNDED-PDC-DIST.                                    32040005
290400                                                                  32050005
290500     IF PV-TTL-ALL-DCS-PCT = 100                                  32060005
290600       CONTINUE                                                   32070005
290700     ELSE                                                         32080005
290800       COMPUTE TR004-PDC-PERCNT =                                 32090005
290900            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         32100005
291000     END-IF.                                                      32110005
291100                                                                  32120005
291200***  *******************************************************      32130005
291300***  * DOES IT MAKE SENSE TO TRY TO ADJUST CARTONS WHEN THE       32140005
291400***  * TOTAL YOU WOULD COMPARE TO IS CALCULATED?                  32150005
291500***  *******************************************************      32160005
291600***  IF PV-TTL-ALL-DCS-CARTS = TR004-PACK-CART-CT                 32170005
291700***    CONTINUE                                                   32180005
291800***  ELSE                                                         32190005
291900***    COMPUTE TR004-PDC-CART-CT =                                32200005
292000***       TR004-PDC-CART-CT +                                     32210005
292100***          (TR004-PACK-CART-CT - PV-TTL-ALL-DCS-CARTS)          32220005
292200***  END-IF.                                                      32230005
292300                                                                  32240005
292400     IF PV-TTL-ALL-DCS-UNITS = PA-TOTAL-PACK-SPLIT-QTY            32250005
292500       CONTINUE                                                   32260005
292600     ELSE                                                         32270005
292700       COMPUTE TR004-DC-UNIT-QTY =                                32280005
292800          TR004-DC-UNIT-QTY +                                     32290005
292900             (PA-TOTAL-PACK-SPLIT-QTY - PV-TTL-ALL-DCS-UNITS)     32300005
293000     END-IF.                                                      32310005
293100                                                                  32320005
139868******************************************************************32330038
139868 2387-ADJUST-ROUNDED-OUT-DIST.                                    32340038
139868                                                                  32350038
155029     IF  PS-EOC-STORE-CURSOR                                      32360074
155029     AND PS-OUTLET-STORE-NO                                       32370074
155029        DIVIDE PA-TOTAL-STR-SPLIT-QTY                             32380074
155029          INTO MESTDS-STR-DISTRO-QTY                              32390074
155029            GIVING PV-QUOTIENT-ORDER-PERCENT                      32400074
155029        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     32410074
155029            100 GIVING TR004-DC-PERCNT ROUNDED                    32420074
155029                                                                  32430074
155029        IF TR004-DC-PERCNT = ZERO                                 32440074
155029           MOVE +1 TO TR004-DC-PERCNT                             32450074
155029        END-IF                                                    32460074
155029                                                                  32470074
155029     ELSE                                                         32480074
139868        IF PV-TTL-ALL-DCS-PCT = 100                               32490062
139868          CONTINUE                                                32500062
139868        ELSE                                                      32510062
139868          COMPUTE TR004-PDC-PERCNT =                              32520062
139868              TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)       32530062
155029        END-IF                                                    32540074
139868     END-IF.                                                      32550062
139868                                                                  32560038
293300******************************************************************32570005
293400 2400-PROCESS-UPC-FOR-BULK.                                       32580005
293500                                                                  32590005
293600     PERFORM 8400-FETCH-BULK-UPC-CUR                              32600005
293700                                                                  32610005
293800     IF PS-EOC-BULK-UPC-CUR                                       32620005
293900         PERFORM 8300-CLOSE-BULK-UPC-CUR                          32630005
294000*        ****************************************                 32640005
294100*        * IF PO LINES PRESENT BUT NONE ARE     *                 32650005
294200*        * ACTIVE OR APPROVED SET SWITCH FOR    *                 32660005
294300*        * RETRANSMISSION.                      *                 32670005
294400*        ****************************************                 32680005
294500         IF PS-AC-AP-LINES-NO                                     32690005
294600             SET PS-PROBLEM-SO-SET-RETRANS   TO TRUE              32700005
294700         END-IF                                                   32710005
294800     ELSE                                                         32720005
294900                                                                  32730005
295000       SET PS-UPC-PASSESED-EDITS      TO TRUE                     32740005
295100       PERFORM 2405-BULK-UPC-EDITS                                32750005
295200                                                                  32760005
295300       IF PS-UPC-PASSESED-EDITS                                   32770005
295400                                                                  32780005
295500         SET PS-AC-AP-LINES              TO TRUE                  32790005
295600         INITIALIZE TR004-REC-TYPE-UPC                            32800005
295700         MOVE XLT00004-VS-NBR       TO                            32810005
295800             TR004-VEND-STYL-NAME                                 32820005
295900         MOVE XLT00003-CSTM-CLOR-DESC TO                          32830005
296000             TR004-UPC-COLOR-DESC                                 32840005
296100         MOVE XLT00003-SIZE-DESC      TO                          32850005
296200             TR004-UPC-SIZE-DESC                                  32860005
296300         MOVE SKXREF-SKU              TO                          32870005
296400             TR004-SKU-DESC                                       32880005
296500         MOVE XLT00003-NRF-CLOR-CDE   TO                          32890005
296600             TR004-UPC-COLOR-CDE                                  32900005
296700         MOVE SKXREF-CLASS            TO                          32910005
296800             TR004-CLASS                                          32920005
296900         MOVE SKXREF-SUBCLASS         TO                          32930005
297000             TR004-SUB-CLASS                                      32940005
297100         MOVE SKXREF-SKU              TO                          32950005
297200             TR004-SKU-SEQ-NBR                                    32960005
297300         MOVE SKXREF-DEPT             TO                          32970005
297400             TR004-DEPT-NBR                                       32980005
297500         MOVE PURITM-UNT-QTY   TO TR004-UPC-UNIT-QTY              32990005
139868                                  PV-HOLD-PCK-UNIT-QTY            33000038
297600         SET PS-ZERO-OUTR-PACK-QTY-NO  TO TRUE                    33010005
297700         INITIALIZE PV-UPC-CARTONS                                33020005
297800**GB 4/12/12 PERFORM 2420-SELECT-VEND-OUTR-PACK-QTY               33030005
297810         PERFORM 2420-EDIT-VEND-OUTR-PACK-QTY                     33040005
297900                                                                  33050005
298000         MOVE UPC-UPC-NBR      TO TR004-UPC-NBR                   33060005
298100                                                                  33070005
298200         MOVE ZERO             TO TR004-PACK-RATIO-QTY            33080005
298300                                                                  33090005
298400         PERFORM 5600-WRITE-UPC-REC                               33100005
298500                                                                  33110005
298600         IF PS-ZERO-OUTR-PACK-QTY                                 33120005
298700           CONTINUE                                               33130005
298800         ELSE                                                     33140005
298900           SET PS-CURR-SPLIT-QTY-PRESENT-NO   TO TRUE             33150005
299000           PERFORM 2520-SUM-DC-SPLIT-QTY                          33160005
299100                                                                  33170005
299200           IF PS-CURR-SPLIT-QTY-PRESENT                           33180005
299300             SET PS-COUNT-DCS-OK-NO      TO TRUE                  33190005
299400             PERFORM 2524-COUNT-DCS-FOR-BULK                      33200005
299500           END-IF                                                 33210005
299600                                                                  33220005
299700           IF PS-CURR-SPLIT-QTY-PRESENT                           33230005
299800            AND PS-COUNT-DCS-OK                                   33240022
299900             SET PS-FIRST-DC                 TO TRUE              33250005
300000             SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE              33260005
300100             PERFORM 8500-OPEN-DC-CURSOR                          33270005
300200             PERFORM 2500-PROCESS-DC-CURSOR UNTIL                 33280005
300300                 PS-EOC-DC-CURSOR                                 33290005
300400             SET PS-EOC-DC-CURSOR-NO TO TRUE                      33300005
300500           END-IF                                                 33310005
300600                                                                  33320005
300700       END-IF                                                     33330005
300800                                                                  33340005
300900     END-IF.                                                      33350005
301000                                                                  33360005
301100******************************************************************33370005
301200 2402-PROCESS-PACK-UPC.                                           33380005
301300                                                                  33390005
301400     PERFORM 8460-FETCH-PACK-UPC-CUR.                             33400005
301500                                                                  33410005
301600     IF PS-EOC-PACK-UPC-CURSOR                                    33420005
301700         PERFORM 8455-CLOSE-PACK-UPC-CUR                          33430005
301800*        * ****************************************** *           33440005
301900*        * IF PO LINES PRESENT BUT NONE ARE ACTIVE OR *           33450005
302000*        * OR APPROVED SET SWITCH FOR RETRANSMISSION. *           33460005
302100*        * ****************************************** *           33470005
302200         IF PS-AC-AP-LINES-NO                                     33480005
302300             SET PS-PROBLEM-SO-SET-RETRANS   TO TRUE              33490005
302400         END-IF                                                   33500005
302500     ELSE                                                         33510005
302600         SET PS-AC-AP-LINES              TO TRUE                  33520005
302700         INITIALIZE TR004-REC-TYPE-UPC                            33530005
302800         MOVE XLT00004-VS-NBR       TO                            33540005
302900             TR004-VEND-STYL-NAME                                 33550005
303000         MOVE XLT00003-CSTM-CLOR-DESC TO                          33560005
303100             TR004-UPC-COLOR-DESC                                 33570005
303200         MOVE XLT00003-SIZE-DESC      TO                          33580005
303300             TR004-UPC-SIZE-DESC                                  33590005
303400         MOVE XLT00003-SKU-DESC       TO                          33600005
303500             TR004-SKU-DESC                                       33610005
303600         MOVE XLT00003-NRF-CLOR-CDE   TO                          33620005
303700             TR004-UPC-COLOR-CDE                                  33630005
303800         MOVE SKXREF-CLASS            TO                          33640005
303900             TR004-CLASS                                          33650005
304000         MOVE SKXREF-SUBCLASS         TO                          33660005
304100             TR004-SUB-CLASS                                      33670005
304200         MOVE SKXREF-SKU              TO                          33680005
304300             TR004-SKU-SEQ-NBR                                    33690005
304400         MOVE SKXREF-DEPT             TO                          33700005
304500             TR004-DEPT-NBR                                       33710005
304600         MOVE 1                TO TR004-UPC-UNIT-QTY              33720005
304700         MOVE 1                TO TR004-OUTR-PK-QTY               33730005
304800                                                                  33740005
304900         MOVE UPC-UPC-NBR      TO TR004-UPC-NBR                   33750005
305000                                                                  33760005
305100*BUD*    IF PURCHS-PKGNG-CDE = PC-M                               33770007
305100         IF POPRPK-PREPK-TYP-CDE = PC-M                           33780007
305200            MOVE PURITM-PREPK-RATO-QTY                            33790005
305300                                  TO TR004-PACK-RATIO-QTY         33800005
305400         ELSE                                                     33810005
305500           IF POPRPK-INPK-UNT-QTY = ZERO                          33820005
305600             MOVE ZERO TO TR004-PACK-RATIO-QTY                    33830005
305700             SET TR006-ERROR-TYPE-ERROR   TO TRUE                 33840005
305800             INITIALIZE TR006-ERROR-MSG                           33850005
305900             MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU            33860005
306000             MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR        33870005
306100             STRING 'PCK-INPK-UNT-QTY '                           33880005
306200                    'FLD IS 0-DTL'                                33890005
306300                 DELIMITED BY SIZE                                33900005
306400                 INTO TR006-ERROR-MSG                             33910005
306500             PERFORM 8830-WRITE-ERROR-LINE                        33920005
306600           ELSE                                                   33930005
306700             COMPUTE  TR004-PACK-RATIO-QTY =                      33940005
306800              (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY) *       33950005
306900                 PURITM-PREPK-RATO-QTY                            33960005
307000           END-IF                                                 33970005
307100         END-IF                                                   33980005
307200                                                                  33990005
307300         PERFORM 5600-WRITE-UPC-REC                               34000005
307400                                                                  34010005
307500     END-IF.                                                      34020005
307600******************************************************************34030005
307700* ANY EDITS THAT MIGHT CAUSE A UPC NOT TO BE SENT SHOULD BE DONE *34040005
307800* HERE.  CURRENTLY ONLY CHECKS FOR E-COMMERCE ARE DONE.          *34050005
307900******************************************************************34060005
308000 2405-BULK-UPC-EDITS.                                             34070005
308100                                                                  34080005
308200       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE.                    34090005
308300       PERFORM 2410-CHECK-FOR-E-COM-DCS.                          34100005
308400                                                                  34110069
308500       IF PS-THERE-ARE-E-COM-DCS                                  34120005
308600         SET PS-THIS-IS-E-COM-UPC-NO   TO TRUE                    34130005
308700         PERFORM 2415-SELECT-UPC-FROM-TWEBITM                     34140067
308800                                                                  34150005
308900         IF PS-THIS-IS-E-COM-UPC                                  34160005
309000           CONTINUE                                               34170005
309100         ELSE                                                     34180005
309200             INITIALIZE TR006-ERROR-MSG                           34190005
309300             MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   34200005
309400             MOVE SKXREF-SKU   TO TR006-SKU                       34210005
309500             SET TR006-ERROR-TYPE-ERROR       TO TRUE             34220005
309600             STRING 'E-COM DC-NOT E-COM SKU-FIX'                  34230005
309700                 DELIMITED BY SIZE                                34240005
309800                 INTO TR006-ERROR-MSG                             34250005
309900             PERFORM 8830-WRITE-ERROR-LINE                        34260005
310000             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                34270005
310100             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                34280005
310200         END-IF                                                   34290005
310300                                                                  34300005
310400       END-IF.                                                    34310005
310500                                                                  34320005
310600******************************************************************34330005
310700 2410-CHECK-FOR-E-COM-DCS.                                        34340005
310800*                                                                 34350005
310900     INITIALIZE PV-NBR-OF-E-COM-DCS.                              34360005
311000*                                                                 34370005
311100     EXEC SQL                                                     34380005
311200           SELECT                                                 34390005
311300                   COUNT(*)                                       34400005
311400             INTO                                                 34410005
311500                  :PV-NBR-OF-E-COM-DCS                            34420005
311600             FROM                                                 34430005
311700                  TUPCSKU   SKU                                   34440005
311800                 ,TPURITM   PUR                                   34450005
311900                 ,TALLPLN   AL                                    34460005
312000*FJW 03/11/10 BEGIN                                               34470005
312100                 ,XLT_LOC   LOC                                   34480005
312200*FJW 03/11/10 END                                                 34490005
312300             WHERE SKU.UPC_NBR        = :UPC-UPC-NBR              34500005
312400               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             34510005
312500               AND PUR.PO_NBR         = :PURCHS-PO-NBR            34520005
312600               AND PUR.PO_LNE_NBR     = :PURITM-PO-LNE-NBR        34530005
312700               AND PUR.VER_STATUS_CDE = 'A'                       34540005
312800               AND PUR.STATUS_CDE     IN ('AC', 'AP')             34550005
312900               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           34560005
313000               AND AL.PO_NBR          =  PUR.PO_NBR               34570005
313100               AND AL.CURR_SPLIT_QTY  >  0                        34580005
313200*FJW 03/11/10 BEGIN                                               34590005
313300*              AND AL.DEST_NBR        =  870                      34600005
313400               AND AL.DEST_NBR        =  LOC.LOC_NBR              34610005
313410               AND LOC.LOC_TYP_CDE    = 'DC'                      34620005
313420               AND LOC.E_BUS_IND      = 'Y'                       34630005
313430*FJW 03/11/10 END                                                 34640005
313440     END-EXEC                                                     34650005
313450                                                                  34660005
313460     EVALUATE TRUE                                                34670005
313470         WHEN SQLCODE = ZERO                                      34680005
313480         WHEN SQLCODE = -811                                      34690005
313490            IF PV-NBR-OF-E-COM-DCS > 0                            34700005
313500              SET PS-THERE-ARE-E-COM-DCS  TO TRUE                 34710005
313600            END-IF                                                34720005
313700                                                                  34730005
313800         WHEN SQLCODE = +100                                      34740005
313900              CONTINUE                                            34750005
314000                                                                  34760005
314100         WHEN SQLWARN0 NOT EQUAL SPACE                            34770005
314200         WHEN SQLCODE NOT EQUAL ZERO                              34780005
314300             DISPLAY '** ABEND **'                                34790005
314400             DISPLAY '** PROGRAM = TRKUP006 **'                   34800005
314500             DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          34810005
314600             DISPLAY '** UPC-UPC-NBR = '   UPC-UPC-NBR            34820005
314700             DISPLAY '** PARAGRAPH = 2410-CHECK-FOR-E-COM-DCS'    34830005
314800             PERFORM 9100-SQL-ABEND                               34840022
314900     END-EVALUATE.                                                34850005
315000                                                                  34860005
315100******************************************************************34870005
315200 2415-SELECT-UPC-FROM-TWEBITM.                                    34880005
315300*                                                                 34890005
315400     INITIALIZE PV-NBR-OF-E-COM-ROWS.                             34900005
315500                                                                  34910005
315600     EXEC SQL                                                     34920005
315700           SELECT COUNT (*)                                       34930005
315800           INTO   :PV-NBR-OF-E-COM-ROWS                           34940005
315900           FROM TUPCPLS A                                         34950005
316000              , TWEBITM B                                         34960005
316100              , TUPCSKU   SKU                                     34970005
316200              , TPURITM   PUR                                     34980005
316300           WHERE SKU.UPC_NBR          = :UPC-UPC-NBR              34990005
316400               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             35000005
316500               AND PUR.PO_NBR         = :PURCHS-PO-NBR            35010005
316600               AND PUR.VER_STATUS_CDE = 'A'                       35020005
316700               AND PUR.STATUS_CDE    IN ('AC', 'AP')              35030005
316800               AND A.ITM_NBR          =  PUR.ITM_NBR              35040005
316900               AND A.OPERCO_NBR       = '03'                      35050005
317000               AND A.STR_NBR          = 0                         35060005
317100               AND ((A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      35070005
317200                       A.EFF_END_TMST IS NULL) OR                 35080005
317300                      (A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND    35090005
317400                       A.EFF_END_TMST  > CURRENT TIMESTAMP))      35100005
317500               AND A.UPC_ID        = B.INTR_UPC_ID                35110005
317600               AND (B.EFF_BEG_TMST <= CURRENT TIMESTAMP AND       35120005
317700                         B.EFF_END_TMST IS NULL)                  35130005
317800     END-EXEC                                                     35140005
317900                                                                  35150005
318000     EVALUATE TRUE                                                35160005
318100         WHEN SQLCODE = ZERO                                      35170005
318200         WHEN SQLCODE = -811                                      35180005
318300            IF PV-NBR-OF-E-COM-ROWS > ZERO                        35190005
318400              SET PS-THIS-IS-E-COM-UPC    TO TRUE                 35200005
318500            END-IF                                                35210005
318600                                                                  35220005
318700         WHEN SQLCODE = +100                                      35230005
318800              CONTINUE                                            35240005
318900                                                                  35250005
319000         WHEN SQLWARN0 NOT EQUAL SPACE                            35260005
319100         WHEN SQLCODE NOT EQUAL ZERO                              35270005
319200             DISPLAY '** ABEND **'                                35280005
319300             DISPLAY '** PROGRAM = TRKUP006 **'                   35290005
319400             DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          35300005
319500             DISPLAY '** UPC-UPC-NBR = '   UPC-UPC-NBR            35310005
319600             DISPLAY '** PARAGRAPH = 2415-SELECT-UPC-FROM-TWEBITM'35320005
319700             PERFORM 9100-SQL-ABEND                               35330022
319800     END-EVALUATE.                                                35340005
319900                                                                  35350005
320000                                                                  35360005
320010 2420-EDIT-VEND-OUTR-PACK-QTY.                                    35370005
320020                                                                  35380005
320030      IF PURITM-OUTR-PK-QTY = ZERO                                35390005
320040          INITIALIZE TR006-ERROR-MSG                              35400005
320050          MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                      35410005
320060          MOVE SKXREF-SKU   TO TR006-SKU                          35420005
320070          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 35430005
320080          STRING 'BULK-ZERO OUTR PCK QTY-FIX'                     35440005
320090              DELIMITED BY SIZE                                   35450005
320091              INTO TR006-ERROR-MSG                                35460005
320092          PERFORM 8830-WRITE-ERROR-LINE                           35470005
320093          SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                   35480005
320094          SET PS-ZERO-OUTR-PACK-QTY     TO TRUE                   35490005
320095      ELSE                                                        35500005
320096          MOVE PURITM-OUTR-PK-QTY TO                              35510005
320097              TR004-OUTR-PK-QTY                                   35520005
139868              PV-HOLD-PCK-CART-CT                                 35530038
320098          DIVIDE PURITM-OUTR-PK-QTY                               35540005
320099            INTO TR004-UPC-UNIT-QTY                               35550005
320100          GIVING PV-UPC-CARTONS   ROUNDED                         35560005
320101       END-IF.                                                    35570005
320102                                                                  35580005
320110******************************************************************35590005
320200*2420-SELECT-VEND-OUTR-PACK-QTY.                                  35600005
320300*                                                                 35610005
320400*    EXEC SQL                                                     35620005
320500*          SELECT                                                 35630005
320600*                 UPC.OUTR_PK_QTY                                 35640005
320700*            INTO                                                 35650005
320800*                 :UPC-OUTR-PK-QTY                                35660005
320900*            FROM                                                 35670005
321000*                 TSKXREF  SKX                                    35680005
321100*                ,TUPC     UPC                                    35690005
321200*          WHERE  SKX.ITM_NBR      =  :PURITM-ITM-NBR             35700005
321300*            AND  SKX.INTR_UPC_ID  =  UPC.INTR_UPC_ID             35710005
321400*            AND  UPC.UPC_TYP_CDE  = 'I'                          35720005
321500*    END-EXEC                                                     35730005
321600*                                                                 35740005
321700*    EVALUATE TRUE                                                35750005
321800*        WHEN SQLCODE = ZERO                                      35760005
321900*            IF UPC-OUTR-PK-QTY = ZERO                            35770005
322000*                INITIALIZE TR006-ERROR-MSG                       35780005
322100*                MOVE UPC-UPC-NBR  TO TR006-UPC-NBR               35790005
322200*                MOVE SKXREF-SKU   TO TR006-SKU                   35800005
322300*                SET TR006-ERROR-TYPE-ERROR      TO TRUE          35810005
322400*                STRING 'ZERO OUTR PCK QTY-FIX'                   35820005
322500*                    DELIMITED BY SIZE                            35830005
322600*                    INTO TR006-ERROR-MSG                         35840005
322700*                PERFORM 8830-WRITE-ERROR-LINE                    35850005
322800*                SET PS-PROBLEM-SO-SET-RETRANS TO TRUE            35860005
322900*                SET PS-ZERO-OUTR-PACK-QTY     TO TRUE            35870005
323000*            ELSE                                                 35880005
323100*                MOVE UPC-OUTR-PK-QTY           TO                35890005
323200*                    TR004-OUTR-PK-QTY                            35900005
323300*                DIVIDE UPC-OUTR-PK-QTY                           35910005
323400*                  INTO TR004-UPC-UNIT-QTY                        35920005
323500*                GIVING PV-UPC-CARTONS   ROUNDED                  35930005
323600*            END-IF                                               35940005
323700*                                                                 35950005
323800*        WHEN SQLCODE = +100                                      35960005
323900*            MOVE 0 TO TR004-OUTR-PK-QTY                          35970005
324000*            MOVE 0 TO UPC-OUTR-PK-QTY                            35980005
324100*            INITIALIZE TR006-ERROR-MSG                           35990005
324200*            MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   36000005
324300*            MOVE SKXREF-SKU   TO TR006-SKU                       36010005
324400*            SET TR006-ERROR-TYPE-ERROR      TO TRUE              36020005
324500*            STRING 'BULK SKU NOT FOUND-FIX'                      36030005
324600*                DELIMITED BY SIZE                                36040005
324700*                INTO TR006-ERROR-MSG                             36050005
324800*            PERFORM 8830-WRITE-ERROR-LINE                        36060005
324900*            SET PS-PROBLEM-SO-SET-RETRANS     TO TRUE            36070005
325000*            SET PS-ZERO-OUTR-PACK-QTY         TO TRUE            36080005
325100*                                                                 36090005
325200*        WHEN SQLWARN0 NOT EQUAL SPACE                            36100005
325300*        WHEN SQLCODE NOT EQUAL ZERO                              36110005
325400*            DISPLAY '** ABEND **'                                36120005
325500*            DISPLAY '** PROGRAM = TRKUP006 **'                   36130005
325600*            DISPLAY '** PARAGRAPH = 2420-SEL-VEND-OUTR-PACK-QTY*'36140005
325700*            DISPLAY '** PURITM-ITM-NBR = ' PURITM-ITM-NBR        36150005
325800*            DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          36160005
325900*            DISPLAY '** PURITM-PO-LNE-NBR = '                    36170005
326000*                 PURITM-PO-LNE-NBR                               36180005
326100*            PERFORM 9100-SQL-ABEND                               36190022
326200*    END-EVALUATE.                                                36200005
326300*                                                                 36210005
326400******************************************************************36220005
326500 2500-PROCESS-DC-CURSOR.                                          36230005
326600                                                                  36240005
326700     PERFORM 8700-FETCH-DC-CURSOR                                 36250005
326800                                                                  36260005
326900     IF PS-EOC-DC-CURSOR                                          36270005
139868        PERFORM 2505-PROCESS-DC-CONTINUE                          36280038
139868     ELSE                                                         36290038
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     36300038
139868        PERFORM 1050-CHECK-IF-OUTLET-DC                           36310038
139868        IF PS-OUTLET-STORE                                        36320038
139868           SET PS-FIRST-STORE    TO TRUE                          36330038
155029           PERFORM 2522-SUM-STORE-SPLIT-QTY                       36340074
139868           PERFORM 9102-OUTLET-STORE-DC                           36350038
139868        ELSE                                                      36360038
155029           EVALUATE TRUE                                          36370074
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       36380074
155029               AND  PV-FAST-E-BUS-IND = 'N')                      36390074
155029                 IF PS-FIRST-UPC-YES                              36400074
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 36410074
155029                    SET PS-FIRST-STORE    TO TRUE                 36420074
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              36430074
155029                 END-IF                                           36440074
155029                 SET PS-OUTLET-STORE   TO TRUE                    36450074
155029                 PERFORM 9102-OUTLET-STORE-DC                     36460074
155029                                                                  36470074
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       36480074
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      36490074
155029                 IF PS-FIRST-UPC-YES                              36500074
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 36510074
155029                    SET PS-FIRST-STORE    TO TRUE                 36520074
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              36530074
155029                 END-IF                                           36540074
155029                 SET PS-OUTLET-STORE   TO TRUE                    36550074
155029                 PERFORM 9102-OUTLET-STORE-DC                     36560074
155029                                                                  36570074
155029              WHEN OTHER                                          36580074
139868                 PERFORM 2505-PROCESS-DC-CONTINUE                 36590048
155029           END-EVALUATE                                           36600074
340300        END-IF                                                    36610008
331300     END-IF.                                                      36620008
344300                                                                  36630008
326400******************************************************************36640008
139868 2505-PROCESS-DC-CONTINUE.                                        36650038
326600                                                                  36660008
326900     IF PS-EOC-DC-CURSOR                                          36670008
327000        PERFORM 8600-CLOSE-DC-CURSOR                              36680008
327100        IF PS-DC-SPLIT-INFO-PRESENT                               36690008
139868          IF PS-OUTLET-STORE                                      36700038
139868             CONTINUE                                             36710038
139868          ELSE                                                    36720038
327200            PERFORM 2515-ADJUST-ROUNDED-DC-DIST                   36730016
327300            PERFORM 5700-WRITE-DC-RECORD                          36740016
139868          END-IF                                                  36750038
327400        END-IF                                                    36760008
327500     ELSE                                                         36770008
327600        IF PS-FIRST-DC                                            36780008
327700          SET PS-FIRST-DC-NO     TO TRUE                          36790008
327800          INITIALIZE PV-TTL-ALL-DCS-PCT                           36800008
327900                     PV-TTL-ALL-DCS-UNITS                         36810008
328000                     PV-TTL-ALL-DCS-CARTS                         36820008
328100*         ***************************************************     36830008
328200*         * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO        36840008
328300*         * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.         36850008
328400*         ***************************************************     36860008
328500          IF PURITM-OUTR-PK-QTY = ZERO                            36870008
328600            MOVE ZERO TO PV-DCS-TO-SKIP                           36880008
328700          ELSE                                                    36890008
328800              DIVIDE PURITM-OUTR-PK-QTY                           36900008
328900                INTO PA-TOTAL-CURR-SPLIT-QTY                      36910008
329000              GIVING PV-TOTAL-CARTONS   ROUNDED                   36920008
329100              COMPUTE PV-DCS-TO-SKIP =                            36930008
329200               (PV-TOTAL-CARTONS - PV-TOTAL-NBR-OF-DCS) * (-1)    36940008
329300          END-IF                                                  36950008
329400                                                                  36960008
329500        ELSE                                                      36970008
329600*           *******************************************           36980008
329700*           * IF NOT EOC OR FIRST DC, WRITE THE DTL   *           36990008
329800*           * EXTRACT & REPORT RECS FROM THE PRIOR DC *           37000008
329900*           * (AND NOT ZERO-OUTR-PACK-QTY)            *           37010008
330000*           *******************************************           37020008
330100            PERFORM 5700-WRITE-DC-RECORD                          37030008
330200        END-IF                                                    37040008
330300                                                                  37050031
330400        INITIALIZE TR004-REC-TYPE-DC                              37060031
330500        MOVE ALLPLN-DEST-NBR TO                                   37070031
330600            TR004-DIST-CNTR                                       37080031
330700        MOVE ALLPLN-CURR-SPLIT-QTY             TO                 37090031
330800            TR004-DC-UNIT-QTY                                     37100031
330900        PERFORM 2510-DC-CALCULATIONS                              37110031
331000***     IF ALLPLN-DC-SPLIT-QTY = 0                                37120031
331100***         PERFORM 2540-UPDATE-TALLPLN                           37130031
331200***     END-IF                                                    37140031
331300     END-IF.                                                      37150031
331400                                                                  37160031
331500******************************************************************37170005
331600* NOTE: NO NEED FOR MSG FOR DIVIDE BY ZERO BECAUSE DIVISORS      *37180005
331700*       CHECKED IN PREVIOUS ROUTINES.                            *37190005
331800******************************************************************37200005
331900 2510-DC-CALCULATIONS.                                            37210005
332000                                                                  37220005
332100     IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                            37230005
332200       CONTINUE                                                   37240005
332300     ELSE                                                         37250005
332400       DIVIDE PA-TOTAL-CURR-SPLIT-QTY    INTO                     37260005
332500         ALLPLN-CURR-SPLIT-QTY         GIVING                     37270005
332600         PV-QUOTIENT-ORDER-PERCENT ROUNDED                        37280005
332700         MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                    37290005
332800             100 GIVING TR004-DC-PERCNT ROUNDED                   37300005
332900     END-IF.                                                      37310005
333000     IF TR004-DC-PERCNT = ZERO                                    37320005
333100        MOVE +1 TO TR004-DC-PERCNT                                37330005
333200     END-IF.                                                      37340005
333300     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             37350005
333400                                                                  37360005
333500     INITIALIZE PV-REMAINDER.                                     37370005
333600     IF PURITM-OUTR-PK-QTY = ZERO                                 37380005
333700       CONTINUE                                                   37390005
333800     ELSE                                                         37400005
333900       DIVIDE PURITM-OUTR-PK-QTY INTO                             37410005
334000         ALLPLN-CURR-SPLIT-QTY     GIVING                         37420005
334100         TR004-DC-CART-CT                                         37430005
334200         REMAINDER PV-REMAINDER                                   37440005
334300     END-IF.                                                      37450005
334400     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           37460005
334500                                                                  37470005
334600     IF PV-REMAINDER = ZERO                                       37480005
334700        CONTINUE                                                  37490005
334800     ELSE                                                         37500005
334900        INITIALIZE TR006-ERROR-MSG                                37510005
335000        MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                        37520005
335100        MOVE SKXREF-SKU   TO TR006-SKU                            37530005
335200        SET TR006-ERROR-TYPE-ERROR      TO TRUE                   37540005
335300        STRING                                                    37550005
335400             'DC '                                                37560005
335500              TR004-DIST-CNTR                                     37570005
335600             ' UNITS NOT DIVBL/OUTR-FIX'                          37580005
335700            DELIMITED BY SIZE                                     37590005
335800            INTO TR006-ERROR-MSG                                  37600005
335900        PERFORM 8830-WRITE-ERROR-LINE                             37610005
336000        SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                    37620005
336100     END-IF.                                                      37630005
336200                                                                  37640005
336300     IF TR004-DC-CART-CT = ZERO                                   37650005
336400       IF PURCHS-NEW-STR-PO-IND = 'Y'                             37660005
336500             AND TR004-DC-CART-CT = ZERO                          37670005
336600           INITIALIZE TR006-ERROR-MSG                             37680005
336700           MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                     37690005
336800           MOVE SKXREF-SKU   TO TR006-SKU                         37700005
336900           MOVE ALLPLN-DEST-NBR TO                                37710005
337000                      PV-DEST-NBR                                 37720005
337100           SET TR006-ERROR-TYPE-ERROR                             37730005
337200                                    TO TRUE                       37740005
337300           STRING                                                 37750005
337400           'DC-'                                                  37760005
337500                PV-DEST-NBR                                       37770005
337600           '-PCK-0 CARTONS-NEW STR PO'                            37780005
337700                DELIMITED BY SIZE                                 37790005
337800              INTO TR006-ERROR-MSG                                37800005
337900           PERFORM 8830-WRITE-ERROR-LINE                          37810005
338000       END-IF                                                     37820005
338100     END-IF.                                                      37830005
338200                                                                  37840005
338300******************************************************************37850005
139868 2512-DC-OUT-CALCULATIONS.                                        37860038
139868                                                                  37870038
139868     IF TR004-DC-PERCNT = ZERO                                    37880038
139868        MOVE +1 TO TR004-DC-PERCNT                                37890038
139868     END-IF.                                                      37900038
139868     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             37910038
139868                                                                  37920038
139868     INITIALIZE PV-REMAINDER.                                     37930038
139868     IF PURITM-OUTR-PK-QTY = ZERO                                 37940038
139868       CONTINUE                                                   37950038
139868     ELSE                                                         37960038
139868       DIVIDE PURITM-OUTR-PK-QTY   INTO                           37970038
139868         MESTDS-STR-DISTRO-QTY     GIVING                         37980038
139868         TR004-DC-CART-CT                                         37990038
139868         REMAINDER PV-REMAINDER                                   38000038
139868     END-IF.                                                      38010038
139868     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           38020038
139868                                                                  38030038
139868     IF PV-REMAINDER = ZERO                                       38040038
139868        CONTINUE                                                  38050038
139868     ELSE                                                         38060038
139868        INITIALIZE TR006-ERROR-MSG                                38070038
139868        MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                        38080038
139868        MOVE SKXREF-SKU   TO TR006-SKU                            38090038
139868        SET TR006-ERROR-TYPE-ERROR      TO TRUE                   38100038
139868        STRING                                                    38110038
139868           'DC '                                                  38120038
139868           TR004-DIST-CNTR                                        38130038
139868           ' UNITS NOT DIVBL/OUTR-FIX'                            38140038
139868            DELIMITED BY SIZE                                     38150038
139868            INTO TR006-ERROR-MSG                                  38160038
139868        PERFORM 8830-WRITE-ERROR-LINE                             38170038
139868        SET PS-PROBLEM-SO-SET-RETRANS  TO TRUE                    38180038
139868     END-IF.                                                      38190038
139868                                                                  38200038
139868     IF TR004-DC-CART-CT = ZERO                                   38210038
139868       IF PURCHS-NEW-STR-PO-IND = 'Y'                             38220038
139868             AND TR004-DC-CART-CT = ZERO                          38230038
139868           INITIALIZE TR006-ERROR-MSG                             38240038
139868           MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                     38250038
139868           MOVE SKXREF-SKU   TO TR006-SKU                         38260038
139868           MOVE MESTDS-STR-NBR TO                                 38270038
139868                      PV-DEST-NBR                                 38280038
139868           SET TR006-ERROR-TYPE-ERROR                             38290038
139868                                    TO TRUE                       38300038
139868           STRING                                                 38310038
139868           'DC-'                                                  38320038
139868                PV-DEST-NBR                                       38330038
139868           '-BULK-0 CARTONS-NEW STR PO'                           38340038
139868                DELIMITED BY SIZE                                 38350038
139868              INTO TR006-ERROR-MSG                                38360038
139868           PERFORM 8830-WRITE-ERROR-LINE                          38370038
139868       END-IF                                                     38380038
139868     END-IF.                                                      38390038
139868                                                                  38400038
338400 2515-ADJUST-ROUNDED-DC-DIST.                                     38410005
338500                                                                  38420005
338600     IF PV-TTL-ALL-DCS-PCT = 100                                  38430005
338700       CONTINUE                                                   38440005
338800     ELSE                                                         38450005
338900       COMPUTE TR004-DC-PERCNT =                                  38460005
339000            TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)          38470005
339100     END-IF.                                                      38480005
339200                                                                  38490005
339300***  IF PV-TTL-ALL-DCS-CARTS = PV-UPC-CARTONS                     38500005
339400***    CONTINUE                                                   38510005
339500***  ELSE                                                         38520005
339600***    COMPUTE TR004-PDC-CART-CT =                                38530005
339700***       TR004-PDC-CART-CT +                                     38540005
339800***          (PV-UPC-CARTONS  - PV-TTL-ALL-DCS-CARTS)             38550005
339900***  END-IF.                                                      38560005
340000                                                                  38570005
340100******************************************************************38580005
340200 2520-SUM-DC-SPLIT-QTY.                                           38590005
340300*                                                                 38600005
340400     EXEC SQL                                                     38610005
340500           SELECT                                                 38620005
340600                  SUM (AL.CURR_SPLIT_QTY)                         38630005
340700             INTO                                                 38640005
340800                  :PA-TOTAL-CURR-SPLIT-QTY                        38650005
340900             FROM                                                 38660005
341000                  TALLPLN   AL                                    38670005
341100                , TPURITM   LN                                    38680005
341200             WHERE AL.PO_NBR         = :PURITM-PO-NBR             38690005
341300               AND AL.PO_NBR         =  LN.PO_NBR                 38700005
341400               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         38710005
341500               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             38720005
341600               AND AL.CURR_SPLIT_QTY >  0                         38730005
341700               AND LN.VER_STATUS_CDE = 'A'                        38740005
341800               AND LN.STATUS_CDE    IN ('AC', 'AP')               38750005
341900     END-EXEC                                                     38760005
342000                                                                  38770005
342100     EVALUATE TRUE                                                38780005
342200         WHEN SQLCODE = ZERO AND PA-TOTAL-CURR-SPLIT-QTY = ZERO   38790005
342300         WHEN SQLCODE = +100                                      38800005
342400         WHEN SQLCODE = -305                                      38810005
342500                                                                  38820005
342600             INITIALIZE        TR006-ERROR-MSG                    38830005
342700                               TR006-UPC-NBR                      38840005
342800                               TR006-SKU                          38850005
342900             STRING 'BULK PO MISSING SPLITS-FIX'                  38860005
343000                 DELIMITED BY SIZE                                38870005
343100             INTO TR006-ERROR-MSG                                 38880005
343200             PERFORM 8710-MISSING-SPLIT-ERROR                     38890005
343300                                                                  38900005
343400         WHEN SQLCODE = ZERO                                      38910005
343500             SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE                38920005
343600                                                                  38930005
343700         WHEN SQLWARN0 NOT EQUAL SPACE                            38940005
343800         WHEN SQLCODE NOT EQUAL ZERO                              38950005
343900             DISPLAY '** ABEND **'                                38960005
344000             DISPLAY '** PROGRAM = TRKUP006 **'                   38970005
344100             DISPLAY '** PURITM-PO-NBR = ' PURITM-PO-NBR          38980005
344200             DISPLAY '** PURITM-PO-LNE-NBR = '                    38990005
344300                 PURITM-PO-LNE-NBR                                39000005
344400             DISPLAY '** PARAGRAPH = 2520-SUM-DC-SPLIT-QTY**'     39010005
344500             PERFORM 9100-SQL-ABEND                               39020022
344600     END-EVALUATE.                                                39030005
344700                                                                  39040005
155029******************************************************************39050074
155029 2521-SUM-SPLIT-QTY.                                              39060074
155029                                                                  39070074
155029     EXEC SQL                                                     39080074
155029           SELECT SUM (EST.STR_DISTRO_QTY)                        39090074
155029             INTO :PA-TOTAL-STR-SPLIT-QTY                         39100074
155029             FROM TMESTDS   EST                                   39110074
155029                , TALLPLN   TAL                                   39120074
155029                , TPURITM   PUR                                   39130074
155029             WHERE PUR.PO_NBR         = :PURCHS-PO-NBR            39140074
155029               AND PUR.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID       39150074
155029               AND PUR.VER_STATUS_CDE = 'A'                       39160074
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             39170074
155029               AND EST.PO_LNE_NBR     =  PUR.PO_LNE_NBR           39180074
155029               AND EST.PO_NBR         =  PUR.PO_NBR               39190074
155029               AND EST.PO_NBR         =  TAL.PO_NBR               39200074
155029               AND EST.PO_LNE_NBR     =  TAL.PO_LNE_NBR           39210074
155029               AND EST.PLAN_NBR       =  TAL.PLAN_NBR             39220074
155029               AND TAL.DEST_NBR       = :ALLPLN-DEST-NBR          39230074
155029               AND EST.STR_DISTRO_QTY >  0                        39240074
155029     END-EXEC                                                     39250074
155029                                                                  39260074
155029     EVALUATE TRUE                                                39270074
155029         WHEN SQLCODE = ZERO AND PA-TOTAL-STR-SPLIT-QTY = ZERO    39280074
155029         WHEN SQLCODE = -305                                      39290074
155029         WHEN SQLCODE = +100                                      39300074
155029             INITIALIZE        TR006-ERROR-MSG                    39310074
155029                               TR006-UPC-NBR                      39320074
155029                               TR006-SKU                          39330074
155029             STRING 'BULK PO MISSING SPLITS-FIX'                  39340074
155029                 DELIMITED BY SIZE                                39350074
155029             INTO TR006-ERROR-MSG                                 39360074
155029             PERFORM 8710-MISSING-SPLIT-ERROR                     39370074
155029                                                                  39380074
155029         WHEN SQLCODE = ZERO                                      39390074
155029             SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE                39400074
155029                                                                  39410074
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            39420074
155029         WHEN SQLCODE NOT EQUAL ZERO                              39430074
155029             DISPLAY '** ABEND **'                                39440074
155029             DISPLAY '** PROGRAM = TRKUP006 **'                   39450074
155029             DISPLAY '** PURCHS-PO-NBR     = ' PURCHS-PO-NBR      39460074
155029             DISPLAY '** POPRPK-PO-PREPK-ID= ' POPRPK-PO-PREPK-ID 39470074
155029             DISPLAY '** ALLPLN-DEST-NBR   = ' ALLPLN-DEST-NBR    39480074
155029             DISPLAY '** PARAGRAPH = 2521-SUM-SPLIT-QTY**'        39490074
155029             PERFORM 9100-SQL-ABEND                               39500074
155029     END-EVALUATE.                                                39510074
155029                                                                  39520074
139868******************************************************************39530038
139868*  RETRIEVE THE TOTAL QUANTITY FOR THE OUTLET STORE               39540038
139868******************************************************************39550038
139868 2522-SUM-STORE-SPLIT-QTY.                                        39560038
139868                                                                  39570038
139868     EXEC SQL                                                     39580038
139868           SELECT SUM (ES.STR_DISTRO_QTY)                         39590038
139868             INTO :PA-TOTAL-CURR-SPLIT-QTY                        39600038
139868             FROM TMESTDS   ES                                    39610038
139868                , TPURITM   LN                                    39620038
139868             WHERE ES.PO_NBR         = :PURITM-PO-NBR             39630038
139868               AND ES.PO_NBR         =  LN.PO_NBR                 39640038
139868               AND ES.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         39650038
139868               AND ES.PO_LNE_NBR     =  LN.PO_LNE_NBR             39660038
139868               AND ES.STR_DISTRO_QTY >  0                         39670038
139868               AND LN.VER_STATUS_CDE = 'A'                        39680038
139868               AND LN.STATUS_CDE    IN ('AC', 'AP')               39690038
139868              WITH UR                                             39700038
139868     END-EXEC                                                     39710038
139868                                                                  39720038
139868     EVALUATE TRUE                                                39730038
139868         WHEN SQLCODE = ZERO                                      39740038
139868         WHEN SQLCODE = -305                                      39750038
139868                                                                  39760038
139868             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    39770038
139868             OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC               39780038
139868                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        39790038
139868                 PERFORM 8710-MISSING-SPLIT-ERROR                 39800038
139868             ELSE                                                 39810038
139868                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            39820038
139868             END-IF                                               39830038
139868                                                                  39840038
139868         WHEN SQLCODE = +100                                      39850038
139868             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            39860038
139868             PERFORM 8710-MISSING-SPLIT-ERROR                     39870038
139868                                                                  39880038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            39890038
139868         WHEN SQLCODE NOT EQUAL ZERO                              39900038
139868             DISPLAY '** ABEND **'                                39910038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   39920038
139868             DISPLAY '** PURITM-PO-NBR    = '  PURITM-PO-NBR      39930038
139868             DISPLAY '** PURITM-PO-LNE-NBR= '  PURITM-PO-LNE-NBR  39940038
139868             DISPLAY '** PARAGRAPH = 2522-SUM-STORE-SPLIT-QTY**'  39950038
139868             PERFORM 9100-SQL-ABEND                               39960038
139868     END-EVALUATE.                                                39970038
139868                                                                  39980038
344800******************************************************************39990009
344900 2524-COUNT-DCS-FOR-BULK.                                         40000005
345000*                                                                 40010005
345100     EXEC SQL                                                     40020005
345200           SELECT                                                 40030005
345300                  COUNT(DISTINCT AL.DEST_NBR)                     40040005
345400             INTO                                                 40050005
345500                  :PV-TOTAL-NBR-OF-DCS                            40060005
345600             FROM                                                 40070005
345700                  TALLPLN   AL                                    40080005
345800                , TPURITM   LN                                    40090005
345900             WHERE AL.PO_NBR         = :PURITM-PO-NBR             40100005
346000               AND AL.PO_NBR         =  LN.PO_NBR                 40110005
346100               AND AL.PO_LNE_NBR     = :PURITM-PO-LNE-NBR         40120005
346200               AND AL.PO_LNE_NBR     =  LN.PO_LNE_NBR             40130005
346300               AND AL.CURR_SPLIT_QTY >  0                         40140005
346400               AND LN.VER_STATUS_CDE = 'A'                        40150005
346500               AND LN.STATUS_CDE    IN ('AC', 'AP')               40160005
346600     END-EXEC                                                     40170005
346700                                                                  40180005
346800     EVALUATE TRUE                                                40190005
346900         WHEN SQLCODE = ZERO                                      40200005
347000*          ***************************************************    40210005
347100*          * IF THERE ARE MORE DCS THAN CARTONS, WE'VE GOT A      40220005
347200*          * PROBLEM AND WE DON'T WANT TO SEND THE SPLIT.         40230005
347300*          ***************************************************    40240005
347400           IF PV-UPC-CARTONS  <  PV-TOTAL-NBR-OF-DCS              40250005
347500             INITIALIZE                                           40260005
347600                 TR006-ERROR-MSG                                  40270005
347700             MOVE UPC-UPC-NBR  TO TR006-UPC-NBR                   40280005
347800             MOVE SKXREF-SKU   TO TR006-SKU                       40290005
347900             SET TR006-ERROR-TYPE-ERROR       TO TRUE             40300005
348000             STRING 'CARTS < NBR DCS-FIX'                         40310005
348100                 DELIMITED BY SIZE                                40320005
348200                 INTO TR006-ERROR-MSG                             40330005
348300             PERFORM 8830-WRITE-ERROR-LINE                        40340005
348400             SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                40350005
348500           ELSE                                                   40360005
348600             SET PS-COUNT-DCS-OK         TO TRUE                  40370005
348700           END-IF                                                 40380005
348800                                                                  40390005
348900         WHEN SQLCODE = +100                                      40400005
349000         WHEN SQLCODE = -305                                      40410005
349100             INITIALIZE        TR006-ERROR-MSG                    40420005
349200                               TR006-UPC-NBR                      40430005
349300                               TR006-SKU                          40440005
349400             STRING 'BULK PO MISSING SPLITS-FIX'                  40450005
349500                 DELIMITED BY SIZE                                40460005
349600             INTO TR006-ERROR-MSG                                 40470005
349700             PERFORM 8710-MISSING-SPLIT-ERROR                     40480005
349800                                                                  40490005
349900                                                                  40500005
350000         WHEN SQLWARN0 NOT EQUAL SPACE                            40510005
350100         WHEN SQLCODE NOT EQUAL ZERO                              40520005
350200             DISPLAY '** ABEND **'                                40530005
350300             DISPLAY '** PROGRAM = TRKUP006 **'                   40540005
350400             DISPLAY '** PURITM-PO-NBR = ' PURITM-PO-NBR          40550005
350500             DISPLAY '** PURITM-PO-LNE-NBR = '                    40560005
350600                 PURITM-PO-LNE-NBR                                40570005
350700             DISPLAY '** PARAGRAPH = 2524-COUNT-DCS-FOR-BULK'     40580005
350800             PERFORM 9100-SQL-ABEND                               40590022
350900     END-EVALUATE.                                                40600005
351000                                                                  40610005
351100******************************************************************40620005
351200*2540-UPDATE-TALLPLN.                                             40630005
351300*                                                                 40640005
351400*        EXEC SQL                                                 40650005
351500*            UPDATE TALLPLN                                       40660005
351600*               SET DC_SPLIT_QTY    = :ALLPLN-CURR-SPLIT-QTY      40670005
351700*             WHERE PO_NBR          = :PURITM-PO-NBR              40680005
351800*               AND PO_LNE_NBR      = :PURITM-PO-LNE-NBR          40690005
351900*               AND PLAN_NBR        = :ALLPLN-PLAN-NBR            40700005
352000*        END-EXEC.                                                40710005
352100*                                                                 40720005
352200*    EVALUATE TRUE                                                40730005
352300*        WHEN SQLCODE = ZERO                                      40740005
352400*            CONTINUE                                             40750005
352500*                                                                 40760005
352600*        WHEN SQLCODE = +100                                      40770005
352700*            CONTINUE                                             40780005
352800*                                                                 40790005
352900*        WHEN SQLWARN0 NOT EQUAL SPACE                            40800005
353000*        WHEN SQLCODE NOT EQUAL ZERO                              40810005
353100*            DISPLAY '** ABEND **'                                40820005
353200*            DISPLAY '** PROGRAM = TRKUP006 **'                   40830005
353300*            DISPLAY '** PARAGRAPH = 2540-UPDATE-TALPLAN**'       40840005
353400*            PERFORM 9100-SQL-ABEND                               40850022
353500*    END-EVALUATE.                                                40860005
353600*                                                                 40870005
353700******************************************************************40880005
353800* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  40890005
353900* RECORDS THAT RESIDE IN COPYBOOK TRRD020 AREA AND THEN WRITE THE 40900005
354000* LOWER LEVEL PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL 40910005
354100* PROGRAM TABLE.                                                  40920005
354200******************************************************************40930005
354300                                                                  40940005
354400 3000-WRITE-OUT-GOOD-PO-RECS.                                     40950005
354500                                                                  40960005
354600     IF PS-POE-WRITTEN-NO                                         40970005
354700       PERFORM 5100-WRITE-POE-RECORD                              40980005
354800       SET PS-POE-WRITTEN TO TRUE                                 40990005
354900     END-IF.                                                      41000005
355000                                                                  41010005
355100     IF PS-ETA-WRITTEN-NO                                         41020005
355200       PERFORM 5000-WRITE-ETA-RECORD                              41030005
355300       SET PS-ETA-WRITTEN TO TRUE                                 41040005
355400     END-IF.                                                      41050005
355500                                                                  41060005
355600     IF PS-VES-WRITTEN-NO                                         41070005
355700       PERFORM 5200-WRITE-VES-RECORD                              41080005
355800       SET PS-VES-WRITTEN TO TRUE                                 41090005
355900     END-IF.                                                      41100005
356000                                                                  41110005
356100     IF PS-CON-WRITTEN-NO                                         41120005
356200       PERFORM 5300-WRITE-CON-RECORD                              41130005
356300       SET PS-CON-WRITTEN TO TRUE                                 41140005
356400     END-IF.                                                      41150005
356500                                                                  41160005
356600     SET EXT-INDEX TO +1.                                         41170005
356700     SET PS-EOT-EXTRACT-NO  TO TRUE.                              41180005
356800     PERFORM 3100-UNLOAD-EXT-TABLE                                41190005
356900         UNTIL  PS-EOT-EXTRACT                                    41200005
357000            OR EXT-INDEX > PC-EXTRACT-TBL-LIMIT.                  41210005
357100                                                                  41220005
357200******************************************************************41230005
357300* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  41240005
357400* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL41250005
357500* PROGRAM TABLE.                                                  41260005
357600******************************************************************41270005
357700                                                                  41280005
357800 3100-UNLOAD-EXT-TABLE.                                           41290005
357900                                                                  41300005
358000     EVALUATE TRUE                                                41310005
358100                                                                  41320005
358200         WHEN PV-TBL-EXT-ROW (EXT-INDEX) = SPACES                 41330005
358300                                                                  41340005
358400            SET PS-EOT-EXTRACT TO TRUE                            41350005
358500                                                                  41360005
358600         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PO '                 41370005
358700                                                                  41380005
358800            PERFORM 3110-PO-EXTRACT-AND-DETAIL                    41390005
358900            SET EXT-INDEX UP BY +1                                41400005
359000                                                                  41410005
359100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'INS'                 41420005
359200                                                                  41430005
359300            PERFORM 3120-INS-EXTRACT-AND-DETAIL                   41440005
359400            SET EXT-INDEX UP BY +1                                41450005
359500                                                                  41460005
359600         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCK'                 41470005
359700                                                                  41480005
359800            PERFORM 3130-PCK-EXTRACT-AND-DETAIL                   41490005
359900            SET EXT-INDEX UP BY +1                                41500005
360000                                                                  41510005
360100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'UPC'                 41520005
360200                                                                  41530005
360300            PERFORM 3140-UPC-EXTRACT-AND-DETAIL                   41540005
360400            SET EXT-INDEX UP BY +1                                41550005
360500                                                                  41560005
360600         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PDC'                 41570005
360700                                                                  41580005
360800            PERFORM 3150-PDC-EXTRACT-AND-DETAIL                   41590005
360900            SET EXT-INDEX UP BY +1                                41600005
361000                                                                  41610005
361100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DC '                 41620005
361200                                                                  41630005
361300            PERFORM 3160-DC-EXTRACT-AND-DETAIL                    41640005
361400            SET EXT-INDEX UP BY +1                                41650005
361500                                                                  41660005
361600         WHEN OTHER                                               41670005
361700                                                                  41680005
361800            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    41690005
361900            DISPLAY  '&& TABLE ERROR                       &&'    41700005
362000            DISPLAY  '&& FOUND REC TYPE  - '                      41710005
362100                               PV-TBL-EXT-TYPE (EXT-INDEX)        41720005
362200            DISPLAY                          '             &&'    41730005
362300            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    41740005
362400                                                                  41750005
362500            SET EXT-INDEX UP BY +1                                41760005
362600                                                                  41770005
362700     END-EVALUATE.                                                41780005
362800                                                                  41790005
362900******************************************************************41800005
363000* PO  DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *41810005
363100******************************************************************41820005
363200                                                                  41830005
363300 3110-PO-EXTRACT-AND-DETAIL.                                      41840005
363400                                                                  41850005
363500     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PO         41860005
363600                                        OUTTR2-TRGL-EDI-PO-ODR.   41870005
363700     PERFORM 6000-INSERT-EXTRACT-REC.                             41880005
363800*    *************************************************            41890005
363900*    * A CON RECORD IS WRITTEN TO THE REPORT DETAIL  *            41900005
364000*    * FILE FOR EACH PO BECAUSE REPORTING IS BY PO,  *            41910005
364100*    * NOT CONTAINER.                                *            41920005
364200*    *************************************************            41930005
364300     PERFORM 8856-WRITE-DTL-RPT-CON-RECORD.                       41940005
364400     PERFORM 8850-WRITE-DTL-RPT-PO-RECORD.                        41950005
364500                                                                  41960005
364600******************************************************************41970005
364700* INS DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *41980005
364800******************************************************************41990005
364900                                                                  42000005
365000 3120-INS-EXTRACT-AND-DETAIL.                                     42010005
365100                                                                  42020005
365200     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-INS        42030005
365300                                        OUTTR2-TRGL-EDI-PO-ODR.   42040005
365400     PERFORM 6000-INSERT-EXTRACT-REC.                             42050005
365500     PERFORM 8852-WRITE-DTL-RPT-INS-RECORD.                       42060005
365600                                                                  42070005
365700******************************************************************42080005
365800* PCK DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *42090005
365900******************************************************************42100005
366000                                                                  42110005
366100 3130-PCK-EXTRACT-AND-DETAIL.                                     42120005
366200                                                                  42130005
366300     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PCK        42140005
366400                                        OUTTR2-TRGL-EDI-PO-ODR.   42150005
366500     PERFORM 6000-INSERT-EXTRACT-REC.                             42160005
366600     PERFORM 8847-WRITE-DTL-RPT-PCK-RECORD.                       42170005
366700                                                                  42180005
366800******************************************************************42190005
366900* UPC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *42200005
367000******************************************************************42210005
367100                                                                  42220005
367200 3140-UPC-EXTRACT-AND-DETAIL.                                     42230005
367300                                                                  42240005
367400     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-UPC        42250005
367500                                        OUTTR2-TRGL-EDI-PO-ODR.   42260005
367600     PERFORM 6000-INSERT-EXTRACT-REC.                             42270005
367700     PERFORM 8854-WRITE-DTL-RPT-UPC-RECORD.                       42280005
367800                                                                  42290005
367900******************************************************************42300005
368000* PDC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *42310005
368100******************************************************************42320005
368200                                                                  42330005
368300 3150-PDC-EXTRACT-AND-DETAIL.                                     42340005
368400                                                                  42350005
368500     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PDC        42360005
368600                                        OUTTR2-TRGL-EDI-PO-ODR.   42370005
368700     PERFORM 6000-INSERT-EXTRACT-REC.                             42380005
368800     PERFORM 8848-WRITE-DTL-RPT-PDC-RECORD.                       42390005
368900                                                                  42400005
369000******************************************************************42410005
369100* DC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT   *42420005
369200******************************************************************42430005
369300                                                                  42440005
369400 3160-DC-EXTRACT-AND-DETAIL.                                      42450005
369500                                                                  42460005
369600     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC         42470005
369700                                        OUTTR2-TRGL-EDI-PO-ODR.   42480005
369800     PERFORM 6000-INSERT-EXTRACT-REC.                             42490005
369900     PERFORM 8870-WRITE-DTL-RPT-DC-RECORD.                        42500005
370000                                                                  42510005
370100*----------------------------------------------------------------*42520005
370200*    CHECK TO SEE IF A CHECKPOINT SHOULD BE TAKEN.               *42530005
370300*----------------------------------------------------------------*42540005
370400 4400-CHECKPOINT-CHECK.                                           42550005
370500                                                                  42560005
370600     EXEC SQL                                                     42570005
370700       SET :PV-TMST = CURRENT TIMESTAMP                           42580005
370800     END-EXEC.                                                    42590005
370900                                                                  42600005
371000     EVALUATE TRUE                                                42610005
371100         WHEN SQLWARN0 NOT EQUAL SPACE                            42620005
371200         WHEN SQLCODE NOT EQUAL ZERO                              42630005
371300             DISPLAY '** ABEND **'                                42640005
371400             DISPLAY '** PROGRAM = TRKUP006 **'                   42650005
371500             DISPLAY '** PARAGRAPH = 4400-CHEKPOINT-CHECK**'      42660005
371600             DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'          42670005
371700             PERFORM 9100-SQL-ABEND                               42680022
371800     END-EVALUATE.                                                42690005
371900                                                                  42700005
372000     IF PV-TMST > PV-HOLD-TMST                                    42710005
372100        IF PS-COMMITS-TAKEN                                       42720005
372200            CONTINUE                                              42730005
372300        ELSE                                                      42740005
372400            MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE          42750005
372500            PERFORM 6570-UPDATE-TCKRSTCNTL                        42760005
372600            SET PS-COMMITS-TAKEN   TO TRUE                        42770005
372700        END-IF                                                    42780005
372800        PERFORM 6580-UPDATE-TCKRSTINF                             42790005
372900        PERFORM 4500-COMMIT                                       42800005
373000        DISPLAY 'COMMIT TAKEN AT '                                42810005
373100        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)42820005
373200         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)42830005
373300        PERFORM 4600-SET-CHECKPOINT-TIME                          42840005
373400     END-IF.                                                      42850005
373500                                                                  42860005
373600 EJECT                                                            42870005
373700******************************************************************42880005
373800* EXECUTES AN SQL COMMIT AFTER ALL TABLES FOR TRIP ARE UPDATED.   42890005
373900******************************************************************42900005
374000 4500-COMMIT.                                                     42910005
374100                                                                  42920005
374200     EXEC SQL                                                     42930005
374300         COMMIT                                                   42940005
374400     END-EXEC.                                                    42950005
374500                                                                  42960005
374600     EVALUATE TRUE                                                42970005
374700         WHEN SQLWARN0 NOT EQUAL SPACE                            42980005
374800         WHEN SQLCODE NOT EQUAL ZERO                              42990005
374900       DISPLAY '***********CHECKPOINT*************'               43000005
375000          DISPLAY 'SHPTPO-PO-NBR = ' SHPTPO-PO-NBR                43010005
375100          DISPLAY 'SHIPMT-SHIPT-ID = ' SHIPMT-SHIPT-ID            43020005
375200          DISPLAY 'VHTRIP-TRIP-ID = ' VHTRIP-TRIP-ID              43030005
375300          DISPLAY 'TVTRIP-VEH-NBR = '    VHTRIP-VEH-NBR           43040005
375400          DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                  43050005
375500              PA-TOTAL-OUTPUT-REC-COUNT                           43060005
375600          DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT              43070005
375700          DISPLAY '**********************************'            43080005
375800                                                                  43090005
375900             DISPLAY '** ABEND **'                                43100005
376000             DISPLAY '** PROGRAM = TRKUP006 **'                   43110005
376100             DISPLAY '** PARAGRAPH = 4500-COMMIT**'               43120005
376200             DISPLAY '**UNSUCCESSFUL COMMIT**'                    43130005
376300             PERFORM 9100-SQL-ABEND                               43140022
376400     END-EVALUATE.                                                43150005
376500 EJECT                                                            43160005
376600******************************************************************43170005
376700* SET THE TIME FOR THE NEXT CHECKPOINT.                           43180005
376800******************************************************************43190005
376900 4600-SET-CHECKPOINT-TIME.                                        43200005
377000                                                                  43210005
377100      EXEC SQL                                                    43220005
377200          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    43230005
377300          INTO :PV-HOLD-TMST                                      43240005
377400          FROM TCKRSTCNTL                                         43250005
377500          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              43260005
377600      END-EXEC.                                                   43270005
377700                                                                  43280005
377800     EVALUATE TRUE                                                43290005
377900         WHEN SQLWARN0 NOT EQUAL SPACE                            43300005
378000         WHEN SQLCODE NOT EQUAL ZERO                              43310005
378100             DISPLAY '** ABEND **'                                43320005
378200             DISPLAY '** PROGRAM = TRKUP006 **'                   43330005
378300             DISPLAY '** PARAGRAPH = 4600-SET-CHECKPOINT-TIME**'  43340005
378400             DISPLAY '**UNSUCESSFUL SET OF CHECKPOINT INTERVAL**' 43350005
378500             PERFORM 9100-SQL-ABEND                               43360022
378600     END-EVALUATE.                                                43370005
378700                                                                  43380005
378800 EJECT                                                            43390005
378900******************************************************************43400005
379000 4800-SET-CURRENT-DATE-TIME.                                      43410005
379100                                                                  43420005
379200     EXEC SQL                                                     43430005
379300       SET :IMPORL-DCONSLR-ACTL-DTE  = CURRENT DATE               43440005
379400          ,:IMPORL-DCONSLR-ACTL-TM   = CURRENT TIME               43450005
379500     END-EXEC.                                                    43460005
379600                                                                  43470005
379700     EVALUATE TRUE                                                43480005
379800         WHEN SQLWARN0 NOT EQUAL SPACE                            43490005
379900         WHEN SQLCODE NOT EQUAL ZERO                              43500005
380000             DISPLAY '** ABEND **'                                43510005
380100             DISPLAY '** PROGRAM = TRKUP006 **'                   43520005
380200             DISPLAY '** PARAGRAPH = 4800-SET-CURRENT-DATE-TIME'  43530005
380300             DISPLAY '**UNSUCCESSFUL SET DATE/TIME**'             43540005
380400             PERFORM 9100-SQL-ABEND                               43550022
380500     END-EVALUATE.                                                43560005
380600                                                                  43570005
380700 EJECT                                                            43580005
380800                                                                  43590005
380900*----------------------------------------------------------------*43600005
381000 4820-UPDATE-TSHPTPO.                                             43610005
381100                                                                  43620005
381200         EXEC SQL                                                 43630005
381300            UPDATE TSHPTPO                                        43640005
381400               SET SPLT_XMIT_IND    = ' '                         43650005
381500                ,  SPLT_XMIT_DTE    = :PC-DEFAULT-DTE             43660005
381600                ,  SPLT_XMIT_TM     = :PC-DEFAULT-TME             43670005
381700                ,  LAST_UPD_DTE     = (CURRENT DATE)              43680005
381800                ,  LAST_UPD_TIME    = (CURRENT TIME)              43690005
381900                ,  LAST_UPD_USER_ID = :PC-CURRENT-PROGRAM-NAME    43700005
382000                ,  LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME    43710005
382100             WHERE SHIPT_ID         = :SHIPMT-SHIPT-ID            43720005
382200               AND PO_NBR           = :SHPTPO-PO-NBR              43730005
382300         END-EXEC                                                 43740005
382400                                                                  43750005
382500     EVALUATE TRUE                                                43760005
382600         WHEN SQLCODE = ZERO                                      43770005
382700             CONTINUE                                             43780005
382800                                                                  43790005
382900         WHEN SQLCODE NOT = ZERO                                  43800005
383000         WHEN SQLWARN0 NOT = SPACE                                43810005
383100         WHEN SQLCODE NOT = ZERO                                  43820005
383200             DISPLAY '** ABEND **'                                43830005
383300             DISPLAY '** PROGRAM = TRKUP006 **'                   43840005
383400             DISPLAY '** PARAGRAPH = 4820-UPDATE-TSHPTPO **'      43850005
383500             DISPLAY '** UNSUCCESSFUL UPDATE **'                  43860005
383600             DISPLAY '** SHIP ID '  SHIPMT-SHIPT-ID               43870005
383700             DISPLAY '** PO      '  SHPTPO-PO-NBR                 43880005
383800     END-EVALUATE.                                                43890005
383900                                                                  43900005
384000                                                                  43910005
384100*----------------------------------------------------------------*43920005
384200 4845-UPDATE-TVHTRIP.                                             43930005
384300                                                                  43940005
384400         EXEC SQL                                                 43950005
384500            UPDATE TVHTRIP                                        43960005
384600               SET SPLT_XMIT_IND    = ' '                         43970005
384700                ,  SPLT_XMIT_DTE    = :PC-DEFAULT-DTE             43980005
384800                ,  SPLT_XMIT_TM     = :PC-DEFAULT-TME             43990005
384900                ,  LAST_UPD_DTE     = (CURRENT DATE)              44000005
385000                ,  LAST_UPD_TME     = (CURRENT TIME)              44010005
385100                ,  LAST_UPD_UID     = :PC-CURRENT-PROGRAM-NAME    44020005
385200             WHERE EST_AR_TMST      = :VHTRIP-EST-AR-TMST         44030005
385300               AND VEH_NBR          = :VHTRIP-VEH-NBR             44040005
385400               AND TRIP_ID          = :VHTRIP-TRIP-ID             44050005
385500         END-EXEC                                                 44060005
385600                                                                  44070005
385700     EVALUATE TRUE                                                44080005
385800         WHEN SQLCODE = ZERO                                      44090005
385900             CONTINUE                                             44100005
386000                                                                  44110005
386100         WHEN SQLWARN0 NOT = SPACE                                44120005
386200         WHEN SQLCODE NOT = ZERO                                  44130005
386300             DISPLAY '** ABEND **'                                44140005
386400             DISPLAY '** PROGRAM = TRKUP006 **'                   44150005
386500             DISPLAY '** PARAGRAPH = 4845-UPDATE-TVHTRIP **'      44160005
386600             DISPLAY '** UNSUCCESSFUL UPDATE **'                  44170005
386700             DISPLAY '** TRIP ID '  VHTRIP-TRIP-ID                44180005
386800             DISPLAY '** ETA     '  VHTRIP-EST-AR-TMST            44190005
386900             DISPLAY '** VEHICLE '  VHTRIP-VEH-NBR                44200005
387000             PERFORM 9100-SQL-ABEND                               44210022
387100     END-EVALUATE.                                                44220005
387200                                                                  44230005
387300******************************************************************44240005
387400* WRITE ESTIMATE TIME OF ARRIVAL RECORD TYPE FOR VESSEL EXTRACT  *44250005
387500* FILE                                                           *44260005
387600******************************************************************44270005
387700 5000-WRITE-ETA-RECORD.                                           44280005
387800                                                                  44290005
387900     MOVE 'ETA'   TO TR004-REC-TYPE-CDE-ETA.                      44300005
388000     MOVE SPACES  TO TR004-VESSEL-ETA-DATE                        44310005
388100     MOVE TR004-REC-TYPE-ETA                                      44320005
388200                       TO OUTTR2-TRGL-EDI-PO-ODR.                 44330005
388300                                                                  44340005
388400     PERFORM 6000-INSERT-EXTRACT-REC.                             44350005
388500                                                                  44360005
388600******************************************************************44370005
388700* WRITE PORT OF ENTRY RECORD TYPE FOR EXTRACT FILE.              *44380005
388800******************************************************************44390005
388900 5100-WRITE-POE-RECORD.                                           44400005
389000                                                                  44410005
389100     MOVE 'POE'   TO TR004-REC-TYPE-CDE-POE.                      44420005
389200     MOVE SPACES  TO TR004-PORT-OF-ENTRY-CTY.                     44430005
389300     MOVE TR004-REC-TYPE-POE                                      44440005
389400                          TO OUTTR2-TRGL-EDI-PO-ODR.              44450005
389500                                                                  44460005
389600     PERFORM 6000-INSERT-EXTRACT-REC.                             44470005
389700                                                                  44480005
389800******************************************************************44490005
389900* WRITE VESSEL RECORD TYPE FOR EXTRACT FILE.                     *44500005
390000******************************************************************44510005
390100 5200-WRITE-VES-RECORD.                                           44520005
390200                                                                  44530005
390300     MOVE 'VES'     TO TR004-REC-TYPE-CDE-VES.                    44540005
390400     MOVE SPACES    TO TR004-VESSEL-NAME                          44550005
390500                       TR004-TRIP-TYP-CDE.                        44560005
390600     MOVE TR004-REC-TYPE-VES  TO                                  44570005
390700         OUTTR2-TRGL-EDI-PO-ODR.                                  44580005
390800                                                                  44590005
390900     PERFORM 6000-INSERT-EXTRACT-REC.                             44600005
391000                                                                  44610005
391100******************************************************************44620005
391200* WRITE CONTAINER RECORD TYPE FOR EXTRACT FILE.                  *44630005
391300******************************************************************44640005
391400 5300-WRITE-CON-RECORD.                                           44650005
391500                                                                  44660005
391600     SET TR004-REC-TYPE-CDE-CON        TO TRUE.                   44670005
391700     MOVE SPACES      TO TR004-CONTNR-ID.                         44680005
391800     MOVE TR004-REC-TYPE-CONTAINER                                44690005
391900                      TO OUTTR2-TRGL-EDI-PO-ODR.                  44700005
392000                                                                  44710005
392100     PERFORM 6000-INSERT-EXTRACT-REC.                             44720005
392200                                                                  44730005
392300******************************************************************44740005
392400* WRITE PO RECORD TYPE FOR EXTRACT FILE.                         *44750005
392500******************************************************************44760005
392600 5400-WRITE-PO-RECORD.                                            44770005
392700                                                                  44780005
392800     MOVE 'PO '     TO TR004-REC-TYPE-CDE-PO.                     44790005
392900     MOVE TR004-REC-TYPE-PO     TO PV-TBL-EXT-ROW (EXT-INDEX).    44800005
393000     PERFORM 5900-CHECK-OVERFLOW.                                 44810005
393100                                                                  44820005
393200******************************************************************44830005
393300* WRITE INSTRUCTION RECORD TYPE FOR EXTRACT FILE.                *44840005
393400******************************************************************44850005
393500 5500-WRITE-INS-REC.                                              44860005
393600                                                                  44870005
393700     MOVE 'INS'     TO TR004-REC-TYPE-CDE-INS.                    44880005
393800     MOVE TR004-REC-TYPE-INS    TO PV-TBL-EXT-ROW (EXT-INDEX).    44890005
393900     PERFORM 5900-CHECK-OVERFLOW.                                 44900005
394000                                                                  44910005
394100******************************************************************44920005
394200* WRITE PURCHASE ORDER UPC RECORD TYPE FOR EXTRACT FILE.         *44930005
394300******************************************************************44940005
394400                                                                  44950005
394500 5600-WRITE-UPC-REC.                                              44960005
394600                                                                  44970005
394700     MOVE 'UPC'    TO TR004-REC-TYPE-CDE-UPC.                     44980005
394800     MOVE TR004-REC-TYPE-UPC    TO PV-TBL-EXT-ROW (EXT-INDEX).    44990005
394900     PERFORM 5900-CHECK-OVERFLOW.                                 45000005
395000                                                                  45010005
395100******************************************************************45020005
395200* WRITE DISTRIBUTION CENTER RECORD TYPE FOR EXTRACT FILE.        *45030005
395300******************************************************************45040005
395400                                                                  45050005
395500 5700-WRITE-DC-RECORD.                                            45060005
395600                                                                  45070005
395700     MOVE 'DC '    TO TR004-REC-TYPE-CDE-DC.                      45080005
395800     MOVE TR004-REC-TYPE-DC     TO PV-TBL-EXT-ROW (EXT-INDEX).    45090005
395900     PERFORM 5900-CHECK-OVERFLOW.                                 45100005
396000                                                                  45110005
396100******************************************************************45120005
396200* WRITE PACK RECORD TYPE (PCK) FOR EXTRACT FILE.                 *45130005
396300******************************************************************45140005
396400                                                                  45150005
396500 5755-WRITE-PCK-REC.                                              45160005
396600                                                                  45170005
396700     MOVE 'PCK'    TO TR004-REC-TYPE-CDE-PCK.                     45180005
396800     MOVE TR004-REC-TYPE-PCK    TO PV-TBL-EXT-ROW (EXT-INDEX).    45190005
396900     PERFORM 5900-CHECK-OVERFLOW.                                 45200005
397000                                                                  45210005
397100******************************************************************45220005
397200* WRITE PACK DC (PDC) RECORD TYPE FOR EXTRACT FILE.              *45230005
397300******************************************************************45240005
397400                                                                  45250005
397500 5756-WRITE-PDC-REC.                                              45260005
397600                                                                  45270005
155029     IF TR004-PDC-DIST-CNTR = PV-HOLD-DIST-CNTR                   45280074
155029        CONTINUE                                                  45290074
155029     ELSE                                                         45300074
397700        MOVE 'PDC'    TO TR004-REC-TYPE-CDE-PDC                   45310061
155029        MOVE TR004-REC-TYPE-PDC    TO PV-HOLD-OUT-RECORD          45320074
397800        MOVE TR004-REC-TYPE-PDC    TO PV-TBL-EXT-ROW (EXT-INDEX)  45330061
397900        PERFORM 5900-CHECK-OVERFLOW                               45340061
155029     END-IF.                                                      45350074
398000                                                                  45360005
398100******************************************************************45370005
398200* WRITE TRAILER RECORD FOR EXTRACT FILE.                         *45380005
398300******************************************************************45390005
398400 5800-WRITE-CTT-REC.                                              45400005
398500                                                                  45410005
398600     MOVE 'CTT'    TO TR004-REC-TYPE-CDE-CTT.                     45420005
398700     MOVE TR004-REC-TYPE-CTT      TO                              45430005
398800         OUTTR2-TRGL-EDI-PO-ODR.                                  45440005
398900                                                                  45450005
399000     PERFORM 6000-INSERT-EXTRACT-REC.                             45460005
399100                                                                  45470005
399200******************************************************************45480005
399300* CHECK IF INTERNAL TABLE FILLED UP.                             *45490005
399400******************************************************************45500005
399500                                                                  45510005
399600 5900-CHECK-OVERFLOW.                                             45520005
399700                                                                  45530005
399800     SET EXT-INDEX UP BY +1.                                      45540005
399900                                                                  45550005
400000     IF EXT-INDEX > PC-EXTRACT-TBL-LIMIT                          45560005
400100       DISPLAY  '***********************************************' 45570005
400200       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 45580005
400300       DISPLAY  '** PROGRAM = TRKUP006                        **' 45590005
400400       DISPLAY  '** PARAGRAPGH  - 5900-CHECK-OVERFLOW         **' 45600005
400500       DISPLAY  '**                                           **' 45610005
400600       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 45620005
400700       DISPLAY  '**                                           **' 45630005
400800       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 45640005
400900       DISPLAY  '**                                           **' 45650005
401000       DISPLAY  '**              PV-EXTRACT-TABLE             **' 45660005
401100       DISPLAY  '**                                           **' 45670005
401200       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 45680005
401300       DISPLAY  '**                                           **' 45690005
401400       DISPLAY  '**              PC-EXTRACT-TBL-LIMIT         **' 45700005
401500       DISPLAY  '**                                           **' 45710005
401600       DISPLAY  '** SHIPMENT ID  = ' SHIPMT-SHIPT-ID              45720005
401700       DISPLAY  '** CONTAINER ID = ' SHIPMT-PRO-NBR               45730005
401800       DISPLAY  '** PO NUMBER    = ' SHPTPO-PO-NBR                45740005
401900       DISPLAY  '**                                           **' 45750005
402000       DISPLAY  '***********************************************' 45760005
402100       PERFORM 9100-SQL-ABEND                                     45770022
402200     END-IF.                                                      45780005
402300                                                                  45790005
402400******************************************************************45800005
402500 6000-INSERT-EXTRACT-REC.                                         45810005
402600                                                                  45820005
402700     EXEC SQL                                                     45830005
402800         INSERT INTO TOUTTR2                                      45840005
402900             (TRGL_EDI_PO_ODR)                                    45850005
403000            VALUES  (:OUTTR2-TRGL-EDI-PO-ODR)                     45860005
403100     END-EXEC                                                     45870005
403200                                                                  45880005
403300     EVALUATE TRUE                                                45890005
403400                                                                  45900005
403500         WHEN SQLCODE = ZERO                                      45910005
403600             MOVE SPACES       TO  OUTTR2-TRGL-EDI-PO-ODR         45920005
403700                                                                  45930005
403800         WHEN SQLWARN0 NOT EQUAL SPACE                            45940005
403900         WHEN SQLCODE NOT EQUAL ZERO                              45950005
404000             DISPLAY '** ABEND **'                                45960005
404100             DISPLAY '** PROGRAM = TRKUP006 **'                   45970005
404200             DISPLAY '** PARAGRAPH = 6000-INSERT-EXTRACT-REC**'   45980005
404300             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR2**'         45990005
404400             PERFORM 9100-SQL-ABEND                               46000022
404500     END-EVALUATE.                                                46010005
404600                                                                  46020005
404700     ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT.                         46030005
404800                                                                  46040005
404900 EJECT                                                            46050005
405000******************************************************************46060005
405100*    SELECT CHECKPOINT RESTART CONTROL INFO.                     *46070005
405200******************************************************************46080005
405300 6500-GET-CHECKPOINT-CNTL.                                        46090005
405400                                                                  46100005
405500     EXEC SQL                                                     46110005
405600      SELECT CKPT_STAT_CODE                                       46120005
405700       INTO :PV-CKPT-STAT-CODE                                    46130005
405800       FROM TCKRSTCNTL                                            46140005
405900       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 46150005
406000     END-EXEC.                                                    46160005
406100                                                                  46170005
406200                                                                  46180005
406300     EVALUATE TRUE                                                46190005
406400         WHEN SQLWARN0 NOT EQUAL SPACE                            46200005
406500         WHEN SQLCODE NOT EQUAL ZERO                              46210005
406600             DISPLAY '** ABEND **'                                46220005
406700             DISPLAY '** PROGRAM = TRKUP006 **'                   46230005
406800             DISPLAY '** PARAGRAPH = 6500-GET-CHECKPOINT-CNTL**'  46240005
406900             DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART*'   46250005
407000             PERFORM 9100-SQL-ABEND                               46260022
407100     END-EVALUATE.                                                46270005
407200                                                                  46280005
407300 EJECT                                                            46290005
407400******************************************************************46300005
407500 6550-CHECKPOINT-RESTART.                                         46310005
407600                                                                  46320005
407700     PERFORM 6560-GET-CHECKPOINT-INFO.                            46330005
407800     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO PV-CKPT-RESTART-INFO.  46340005
407900                                                                  46350005
408000     DISPLAY '** TRKUP006 CHECKPOINT RESTART **'.                 46360005
408100     DISPLAY '** TOTAL OUTPUT RECORD COUNT AT RESTART = '         46370005
408200              PV-RESTART-TOT-OUT-REC-COUNT.                       46380005
408300     DISPLAY '***********************************************'    46390005
408400                                                                  46400005
408500     MOVE PV-RESTART-TOT-OUT-REC-COUNT    TO                      46410005
408600         PA-TOTAL-OUTPUT-REC-COUNT.                               46420005
408700                                                                  46430005
408800     MOVE PV-RESTART-ERROR-COUNT          TO                      46440005
408900         PA-ERROR-COUNT.                                          46450005
409000                                                                  46460005
409100                                                                  46470005
409200******************************************************************46480005
409300*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.      *46490005
409400******************************************************************46500005
409500 6560-GET-CHECKPOINT-INFO.                                        46510005
409600                                                                  46520005
409700     EXEC SQL                                                     46530005
409800      SELECT WORK_STRG_DESC                                       46540005
409900       INTO :TCKRSTINF-WORK-STRG-DESC                             46550005
410000       FROM TCKRSTINF                                             46560005
410100      WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                  46570005
410200     END-EXEC.                                                    46580005
410300                                                                  46590005
410400     EVALUATE TRUE                                                46600005
410500         WHEN SQLWARN0 NOT EQUAL SPACE                            46610005
410600         WHEN SQLCODE NOT EQUAL ZERO                              46620005
410700             DISPLAY '** ABEND **'                                46630005
410800             DISPLAY '** PROGRAM = TRKUP006 **'                   46640005
410900             DISPLAY '** PARAGRAPH = 6560-GET-CHECKPOINT-INFO**'  46650005
411000             DISPLAY '** GETTING RESTART WORKING STORAGE INFO**'  46660005
411100             PERFORM 9100-SQL-ABEND                               46670022
411200     END-EVALUATE.                                                46680005
411300                                                                  46690005
411400 EJECT                                                            46700005
411500******************************************************************46710005
411600*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *46720005
411700*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *46730005
411800******************************************************************46740005
411900 6570-UPDATE-TCKRSTCNTL.                                          46750005
412000                                                                  46760005
412100     EXEC SQL                                                     46770005
412200       UPDATE TCKRSTCNTL                                          46780005
412300       SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                  46790005
412400       WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME            46800005
412500     END-EXEC.                                                    46810005
412600                                                                  46820005
412700     EVALUATE TRUE                                                46830005
412800         WHEN SQLWARN0 NOT EQUAL SPACE                            46840005
412900         WHEN SQLCODE NOT EQUAL ZERO                              46850005
413000             DISPLAY '** ABEND **'                                46860005
413100             DISPLAY '** PROGRAM = TRKUP006 **'                   46870005
413200             DISPLAY '** PARAGRAPH = 6570-UPDATE-TCKRSTCNTL**'    46880005
413300             DISPLAY '** GETTING RESTART INFORMATION AFTER ABEND*'46890005
413400             PERFORM 9100-SQL-ABEND                               46900022
413500     END-EVALUATE.                                                46910005
413600                                                                  46920005
413700 EJECT                                                            46930005
413800******************************************************************46940005
413900*    UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS     *46950005
414000*    INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND*46960005
414100******************************************************************46970005
414200 6580-UPDATE-TCKRSTINF.                                           46980005
414300                                                                  46990005
414400     MOVE PA-TOTAL-OUTPUT-REC-COUNT       TO                      47000005
414500         PV-RESTART-TOT-OUT-REC-COUNT.                            47010005
414600     MOVE PA-ERROR-COUNT                  TO                      47020005
414700         PV-RESTART-ERROR-COUNT.                                  47030005
414800     MOVE PV-CKPT-RESTART-INFO            TO                      47040005
414900         TCKRSTINF-WORK-STRG-DESC-TEXT.                           47050005
415000     MOVE 4022                            TO                      47060005
415100         TCKRSTINF-WORK-STRG-DESC-LEN.                            47070005
415200                                                                  47080005
415300     EXEC SQL                                                     47090005
415400        UPDATE TCKRSTINF                                          47100005
415500         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         47110005
415600         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          47120005
415700     END-EXEC.                                                    47130005
415800                                                                  47140005
415900     EVALUATE TRUE                                                47150005
416000         WHEN SQLWARN0 NOT EQUAL SPACE                            47160005
416100         WHEN SQLCODE NOT EQUAL ZERO                              47170005
416200             DISPLAY '** ABEND **'                                47180005
416300             DISPLAY '** PROGRAM = TRKUP006 **'                   47190005
416400             DISPLAY '** PARAGRAPH = 6580-UPDATE-TCKRSTINF**'     47200005
416500             DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF**'         47210005
416600             PERFORM 9100-SQL-ABEND                               47220022
416700     END-EVALUATE.                                                47230005
416800                                                                  47240005
416900 EJECT                                                            47250005
155029******************************************************************47260074
155029*  FOR FAST FASHION CHECK TO SEE IF THIS DEPARTMENT NUMBER IS    *47270074
155029*  ONE OF THE FAST FASHION DEPARTMENT NUMBERS                    *47280074
155029******************************************************************47290074
155029 6600-FAST-PARM-CHECK.                                            47300074
155029                                                                  47310074
155029     MOVE PURCHS-DEPT-NBR  TO PV-DEPT-NBR.                        47320074
155029     MOVE SPACES           TO PV-FAST-RDC-IND                     47330074
155029                              PV-FAST-EFC-IND.                    47340074
155029                                                                  47350074
155029     EXEC SQL                                                     47360074
155029         SELECT  D.ATTR_ELEM_TXT AS RDC_IND                       47370074
155029                ,E.ATTR_ELEM_TXT AS EFC_IND                       47380074
155029           INTO :PV-FAST-RDC-IND                                  47390074
155029               ,:PV-FAST-EFC-IND                                  47400074
155029           FROM WST_INTGRTN_TYP A                                 47410074
155029               ,WST_ATTR_DEFN   B                                 47420074
155029               ,WST_ATTR_ELEM   C                                 47430074
155029               ,WST_ATTR_ELEM   D                                 47440074
155029               ,WST_ATTR_ELEM   E                                 47450074
155029               ,WST_ATTR_ELEM   F                                 47460074
155029               ,WST_ATTR_ELEM   G                                 47470074
155029          WHERE A.INTGRTN_TYP_CDE   = 'FASTFSHDPT'                47480074
155029            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           47490074
155029            AND B.ATTR_DEFN_SEQ_NBR = 1                           47500074
155029            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           47510074
155029            AND C.ATTR_DEFN_SEQ_NBR = 1                           47520074
155029            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           47530074
155029            AND D.ATTR_DEFN_SEQ_NBR = 2                           47540074
155029            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           47550074
155029            AND E.ATTR_DEFN_SEQ_NBR = 3                           47560074
155029            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           47570074
155029            AND F.ATTR_DEFN_SEQ_NBR = 4                           47580074
155029            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           47590074
155029            AND G.ATTR_DEFN_SEQ_NBR = 5                           47600074
155029            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         47610074
155029            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         47620074
155029            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         47630074
155029            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         47640074
155029            AND C.ATTR_ELEM_NBR     = :PV-DEPT-NBR                47650074
155029            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           47660074
155029            AND G.ATTR_ELEM_TMST = '9999-12-31-23.59.59.999999'   47670074
155029          WITH UR                                                 47680074
155029     END-EXEC.                                                    47690074
155029                                                                  47700074
155029     EVALUATE TRUE                                                47710074
155029          WHEN SQLCODE = +0                                       47720074
155029               CONTINUE                                           47730074
155029                                                                  47740074
155029          WHEN SQLCODE = +100                                     47750074
155029               MOVE 'N'          TO PV-FAST-RDC-IND               47760074
155029                                    PV-FAST-EFC-IND               47770074
155029                                                                  47780074
155029          WHEN OTHER                                              47790074
155029            DISPLAY '** ABEND **'                                 47800074
155029            DISPLAY '** PROGRAM = TRKUP006 **'                    47810074
155029            DISPLAY '** PARAGRAPH = 6600-FAST-PARM-CHECK **'      47820074
155029            DISPLAY '** PURCHS-PO-NBR   = ' PURCHS-PO-NBR         47830074
155029            DISPLAY '** PURCHS-DEPT-NBR = ' PURCHS-DEPT-NBR       47840074
155029            DISPLAY '** UNSUCCESSFUL SELECT OF FAST PARM**'       47850074
155029            PERFORM 9100-SQL-ABEND                                47860074
155029     END-EVALUATE.                                                47870074
155029                                                                  47880074
155029 EJECT                                                            47890074
417000******************************************************************47900005
417100* OPEN DRIVER (TRIP) CURSOR FOR CON TRANSMISSIONS.                47910005
417200******************************************************************47920005
417300 7000-OPEN-DRIVER-CURSOR.                                         47930005
417400                                                                  47940005
417500     EXEC SQL                                                     47950005
417600          OPEN TRIP_CUR                                           47960005
417700     END-EXEC.                                                    47970005
417800                                                                  47980005
417900     EVALUATE TRUE                                                47990005
418000         WHEN SQLWARN0 NOT EQUAL SPACE                            48000005
418100         WHEN SQLCODE NOT EQUAL ZERO                              48010005
418200             DISPLAY '** ABEND **'                                48020005
418300             DISPLAY '** PROGRAM = TRKUP006 **'                   48030005
418400             DISPLAY                                              48040005
418500                '** PARAGRAPH = 7000-OPEN-DRIVER-CURSOR **'       48050005
418600             PERFORM 9100-SQL-ABEND                               48060022
418700     END-EVALUATE.                                                48070005
418800                                                                  48080005
418900*                                                                 48090005
419000******************************************************************48100005
419100* CLOSE CURSOR FOR COM TRANSMISSIONS.                            *48110005
419200******************************************************************48120005
419300 7010-CLOSE-DRIVER-CURSOR.                                        48130005
419400                                                                  48140005
419500                                                                  48150005
419600     EXEC SQL                                                     48160005
419700         CLOSE TRIP_CUR                                           48170005
419800     END-EXEC.                                                    48180005
419900                                                                  48190005
420000     EVALUATE TRUE                                                48200005
420100         WHEN SQLWARN0 NOT EQUAL SPACE                            48210005
420200         WHEN SQLCODE NOT EQUAL ZERO                              48220005
420300             DISPLAY '** ABEND **'                                48230005
420400             DISPLAY '** PROGRAM = TRKUP006 **'                   48240005
420500             DISPLAY                                              48250005
420600               '** PARAGRAPH = 7010-CLOSE-DRIVER-CURSOR**'        48260005
420700             PERFORM 9100-SQL-ABEND                               48270022
420800     END-EVALUATE.                                                48280005
420900                                                                  48290005
421000*                                                                 48300005
421100******************************************************************48310005
421200* FETCH CURSOR FOR COM TRANSMISSIONS                             *48320005
421300******************************************************************48330005
421400 7020-FETCH-DRIVER-CURSOR.                                        48340005
421500                                                                  48350005
421600     EXEC SQL                                                     48360005
421700          FETCH TRIP_CUR                                          48370005
421800          INTO                                                    48380005
421900                  :VHTRIP-EST-AR-TMST                             48390005
422000                , :VHTRIP-VEH-NBR                                 48400005
422100                , :VHTRIP-TRIP-ID                                 48410005
422200                , :TRIPST-TRIP-STATUS-CDE                         48420005
422300                , :VEHICL-VEH-TYP-CDE                             48430005
422400                , :IMPOE-POE-CDE                                  48440005
422500     END-EXEC.                                                    48450005
422600                                                                  48460005
422700     EVALUATE TRUE                                                48470005
422800         WHEN SQLCODE = ZERO                                      48480005
422900             IF TRIPST-TRIP-STATUS-CDE = 'DE' OR 'ET'             48490005
423000                 CONTINUE                                         48500005
423100             ELSE                                                 48510005
423200                 SET PS-GOOD-STATUS-CDE-FOUND TO TRUE             48520005
423300             END-IF                                               48530005
423400                                                                  48540005
423500         WHEN SQLCODE = +100                                      48550005
423600              SET PS-EOC-DRIVER-CURSOR                            48560005
423700               TO TRUE                                            48570005
423800                                                                  48580005
423900         WHEN SQLWARN0 NOT EQUAL SPACE                            48590005
424000         WHEN SQLCODE NOT EQUAL ZERO                              48600005
424100             DISPLAY '** ABEND **'                                48610005
424200             DISPLAY '** PROGRAM = TRKUP006 **'                   48620005
424300             DISPLAY                                              48630005
424400                 '** PARAGRAPH = 7020-FETCH-DRIVER-CURSOR**'      48640005
424500             PERFORM 9100-SQL-ABEND                               48650022
424600     END-EVALUATE.                                                48660005
424700                                                                  48670005
424800 EJECT                                                            48680005
424900******************************************************************48690005
425000* OPEN CURSOR TO OBTAIN POE CITY FROM TIMPOE.                    *48700005
425100******************************************************************48710005
425200 7100-OPEN-POE-CURSOR.                                            48720005
425300                                                                  48730005
425400     EXEC SQL                                                     48740005
425500          OPEN POE_CUR                                            48750005
425600     END-EXEC.                                                    48760005
425700                                                                  48770005
425800     EVALUATE TRUE                                                48780005
425900         WHEN SQLWARN0 NOT EQUAL SPACE                            48790005
426000         WHEN SQLCODE NOT EQUAL ZERO                              48800005
426100             DISPLAY '** ABEND **'                                48810005
426200             DISPLAY '** PROGRAM = TRKUP006 **'                   48820005
426300             DISPLAY                                              48830005
426400                '** PARAGRAPH = 7100-OPEN-POE-CURSOR **'          48840005
426500             PERFORM 9100-SQL-ABEND                               48850022
426600     END-EVALUATE.                                                48860005
426700*                                                                 48870005
426800 EJECT                                                            48880005
426900******************************************************************48890005
427000* CLOSE CURSOR FOR TIMPOE.                                       *48900005
427100******************************************************************48910005
427200 7110-CLOSE-POE-CURSOR.                                           48920005
427300                                                                  48930005
427400                                                                  48940005
427500     EXEC SQL                                                     48950005
427600         CLOSE POE_CUR                                            48960005
427700     END-EXEC.                                                    48970005
427800                                                                  48980005
427900     EVALUATE TRUE                                                48990005
428000         WHEN SQLWARN0 NOT EQUAL SPACE                            49000005
428100         WHEN SQLCODE NOT EQUAL ZERO                              49010005
428200             DISPLAY '** ABEND **'                                49020005
428300             DISPLAY '** PROGRAM = TRKUP006 **'                   49030005
428400             DISPLAY                                              49040005
428500               '** PARAGRAPH = 7110-CLOSE-POE-CURSOR**'           49050005
428600             PERFORM 9100-SQL-ABEND                               49060022
428700     END-EVALUATE.                                                49070005
428800                                                                  49080005
428900*                                                                 49090005
429000******************************************************************49100005
429100* FETCH CURSOR FOR POE CITY FROM TIMPOE.                         *49110005
429200******************************************************************49120005
429300 7120-FETCH-POE-CURSOR.                                           49130005
429400                                                                  49140005
429500     EXEC SQL                                                     49150005
429600          FETCH POE_CUR                                           49160005
429700          INTO                                                    49170005
429800                 :IMPOE-POE-CTY-NM                                49180005
429900                ,:IMPOE-POE-STD-EDI-CDE                           49190005
430000     END-EXEC.                                                    49200005
430100                                                                  49210005
430200     EVALUATE TRUE                                                49220005
430300         WHEN SQLCODE = ZERO                                      49230005
430400                 CONTINUE                                         49240005
430500                                                                  49250005
430600         WHEN SQLCODE = +100                                      49260005
430700              SET PS-EOC-POE-CURSOR                               49270005
430800                               TO  TRUE                           49280005
430900                                                                  49290005
431000         WHEN SQLWARN0 NOT EQUAL SPACE                            49300005
431100         WHEN SQLCODE NOT EQUAL ZERO                              49310005
431200             DISPLAY '** ABEND **'                                49320005
431300             DISPLAY '** PROGRAM = TRKUP006 **'                   49330005
431400             DISPLAY                                              49340005
431500                 '** PARAGRAPH = 7120-FETCH-POE-CURSOR**'         49350005
431600             PERFORM 9100-SQL-ABEND                               49360022
431700     END-EVALUATE.                                                49370005
431800                                                                  49380005
431900 EJECT                                                            49390005
432000******************************************************************49400005
432100 7300-OPEN-CONT-CURSOR.                                           49410005
432200                                                                  49420005
432300     EXEC SQL                                                     49430005
432400          OPEN CONT_CUR                                           49440005
432500     END-EXEC.                                                    49450005
432600                                                                  49460005
432700     EVALUATE TRUE                                                49470005
432800         WHEN SQLWARN0 NOT EQUAL SPACE                            49480005
432900         WHEN SQLCODE NOT EQUAL ZERO                              49490005
433000             DISPLAY '** ABEND **'                                49500005
433100             DISPLAY '** PROGRAM = TRKUP006 **'                   49510005
433200             DISPLAY '** PARAGRAPH = 7300-OPEN-CONT-CURSOR **'    49520005
433300             PERFORM 9100-SQL-ABEND                               49530022
433400     END-EVALUATE.                                                49540005
433500                                                                  49550005
433600*                                                                 49560005
433700******************************************************************49570005
433800 7400-CLOSE-CONT-CURSOR.                                          49580005
433900                                                                  49590005
434000                                                                  49600005
434100     EXEC SQL                                                     49610005
434200         CLOSE CONT_CUR                                           49620005
434300     END-EXEC.                                                    49630005
434400                                                                  49640005
434500     EVALUATE TRUE                                                49650005
434600         WHEN SQLWARN0 NOT EQUAL SPACE                            49660005
434700         WHEN SQLCODE NOT EQUAL ZERO                              49670005
434800             DISPLAY '** ABEND **'                                49680005
434900             DISPLAY '** PROGRAM = TRKUP006 **'                   49690005
435000             DISPLAY '** PARAGRAPH = 7400-CLOSE-CONT-CURSOR**'    49700005
435100             PERFORM 9100-SQL-ABEND                               49710022
435200     END-EVALUATE.                                                49720005
435300                                                                  49730005
435400*                                                                 49740005
435500******************************************************************49750005
435600 7500-FETCH-CONT-CURSOR.                                          49760005
435700                                                                  49770005
435800     EXEC SQL                                                     49780005
435900          FETCH CONT_CUR                                          49790005
436000          INTO                                                    49800005
436100                  :SHIPMT-PRO-NBR                                 49810005
436200                , :SHIPMT-SHIPT-ID                                49820005
436300     END-EXEC.                                                    49830005
436400                                                                  49840005
436500     EVALUATE TRUE                                                49850005
436600         WHEN SQLCODE = ZERO                                      49860005
436700              SET PS-CONT-INFO-PRESENT TO TRUE                    49870005
436800                                                                  49880005
436900         WHEN SQLCODE = +100                                      49890005
437000              IF PS-CONT-INFO-PRESENT                             49900005
437100                  SET PS-CONT-INFO-PRESENT-NO TO TRUE             49910005
437200              ELSE                                                49920005
437300                  INITIALIZE TR006-UPC-NBR                        49930005
437400                             TR006-SKU                            49940005
437500                             TR006-ERROR-MSG                      49950005
437600                             TR006-CONTAINER-NUMBER               49960005
437700                             TR006-PO-NBR                         49970005
437800                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         49980005
437900                  STRING 'NO CONTAINERS FOR VESSL-NOT SENT'       49990005
438000                      DELIMITED BY SIZE                           50000005
438100                      INTO TR006-ERROR-MSG                        50010005
438200                  PERFORM 8830-WRITE-ERROR-LINE                   50020005
438300              END-IF                                              50030005
438400                                                                  50040005
438500              SET PS-EOC-CONT-CURSOR          TO TRUE             50050005
438600                                                                  50060005
438700         WHEN SQLWARN0 NOT EQUAL SPACE                            50070005
438800         WHEN SQLCODE NOT EQUAL ZERO                              50080005
438900             DISPLAY '** ABEND **'                                50090005
439000             DISPLAY '** PROGRAM = TRKUP006 **'                   50100005
439100             DISPLAY '** PARAGRAPH = 7500-FETCH-CONT-CURSOR**'    50110005
439200             PERFORM 9100-SQL-ABEND                               50120022
439300     END-EVALUATE.                                                50130005
439400                                                                  50140005
439500 EJECT                                                            50150005
439600******************************************************************50160005
439700 7600-OPEN-PO-CURSOR.                                             50170005
439800                                                                  50180005
439900     EXEC SQL                                                     50190005
440000          OPEN PO_CUR                                             50200005
440100     END-EXEC.                                                    50210005
440200                                                                  50220005
440300     EVALUATE TRUE                                                50230005
440400         WHEN SQLWARN0 NOT EQUAL SPACE                            50240005
440500         WHEN SQLCODE NOT EQUAL ZERO                              50250005
440600             DISPLAY '** ABEND **'                                50260005
440700             DISPLAY '** PROGRAM = TRKUP006 **'                   50270005
440800             DISPLAY '** PARAGRAPH = 7600-OPEN-PO-CURSOR **'      50280005
440900             PERFORM 9100-SQL-ABEND                               50290022
441000     END-EVALUATE.                                                50300005
441100                                                                  50310005
441200*                                                                 50320005
441300******************************************************************50330005
441400 7700-CLOSE-PO-CURSOR.                                            50340005
441500                                                                  50350005
441600                                                                  50360005
441700     EXEC SQL                                                     50370005
441800         CLOSE PO_CUR                                             50380005
441900     END-EXEC.                                                    50390005
442000                                                                  50400005
442100     EVALUATE TRUE                                                50410005
442200         WHEN SQLWARN0 NOT EQUAL SPACE                            50420005
442300         WHEN SQLCODE NOT EQUAL ZERO                              50430005
442400             DISPLAY '** ABEND **'                                50440005
442500             DISPLAY '** PROGRAM = TRKUP006 **'                   50450005
442600             DISPLAY '** PARAGRAPH = 7700-CLOSE-PO-CURSOR**'      50460005
442700             PERFORM 9100-SQL-ABEND                               50470022
442800     END-EVALUATE.                                                50480005
442900                                                                  50490005
443000*                                                                 50500005
443100******************************************************************50510005
443200 7800-FETCH-PO-CURSOR.                                            50520005
443300                                                                  50530005
443400     EXEC SQL                                                     50540005
443500          FETCH PO_CUR                                            50550005
443600          INTO                                                    50560005
443700                  :SHPTPO-PO-NBR                                  50570005
443800                , :SHPTPO-EXPTED-CART-CNT                         50580005
443900                , :SHPTPO-SPLT-XMIT-IND                           50590005
444000     END-EXEC.                                                    50600005
444100                                                                  50610005
444200     EVALUATE TRUE                                                50620005
444300         WHEN SQLCODE = ZERO                                      50630005
444400              SET PS-PO-CUR-INFO-PRESENT    TO TRUE               50640005
444500                                                                  50650005
444600         WHEN SQLCODE = +100                                      50660005
444700              IF PS-PO-CUR-INFO-PRESENT                           50670005
444800                  SET PS-PO-CUR-INFO-PRESENT-NO TO TRUE           50680005
444900              ELSE                                                50690005
445000                  INITIALIZE TR006-UPC-NBR                        50700005
445100                             TR006-SKU                            50710005
445200                             TR006-ERROR-MSG                      50720005
445300                             TR006-DONT-SHIP-BEFORE-DATE          50730005
445400                             TR006-DEPT-NBR                       50740005
445500                             TR006-PO-NBR                         50750005
445600                  SET TR006-ERROR-TYPE-ERROR     TO TRUE          50760005
445700                  STRING 'NO PO FOR CONTAINER-NOT SENT'           50770005
445800                      DELIMITED BY SIZE                           50780005
445900                      INTO TR006-ERROR-MSG                        50790005
446000                  PERFORM 8830-WRITE-ERROR-LINE                   50800005
446100              END-IF                                              50810005
446200                                                                  50820005
446300              SET PS-EOC-PO-CURSOR          TO TRUE               50830005
446400                                                                  50840005
446500         WHEN SQLWARN0 NOT EQUAL SPACE                            50850005
446600         WHEN SQLCODE NOT EQUAL ZERO                              50860005
446700             DISPLAY '** ABEND **'                                50870005
446800             DISPLAY '** PROGRAM = TRKUP006 **'                   50880005
446900             DISPLAY '** PARAGRAPH = 7800-FETCH-PO-CURSOR**'      50890005
447000             PERFORM 9100-SQL-ABEND                               50900022
447100     END-EVALUATE.                                                50910005
447200                                                                  50920005
447300 EJECT                                                            50930005
155029******************************************************************50940074
155029 7830-RETRIEVE-PLAN-NBR.                                          50950074
155029                                                                  50960074
155029     EXEC SQL                                                     50970074
155029           SELECT DISTINCT AL.PLAN_NBR                            50980074
155029             INTO :ALLPLN-PLAN-NBR                                50990074
155029             FROM TIMCNUP   CNUP                                  51000074
155029                 ,TUPCSKU   SKU                                   51010074
155029                 ,TPURITM   PUR                                   51020074
155029                 ,TALLPLN   AL                                    51030074
155029                 ,TMESTDS   ES                                    51040074
155029             WHERE CNUP.CONTNR_ID      = :PV-HOLD-TR020-CONTNR-ID 51050074
155029               AND SKU.UPC_NBR         = :UPC-UPC-NBR             51060074
155029               AND AL.DEST_NBR         = :ALLPLN-DEST-NBR         51070074
155029               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            51080074
155029               AND PUR.PO_NBR          = :PURCHS-PO-NBR           51090074
155029               AND PUR.VER_STATUS_CDE  = 'A'                      51100074
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             51110074
155029               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          51120074
155029               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           51130074
155029               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         51140074
155029               AND AL.PO_NBR           =  PUR.PO_NBR              51150074
155029               AND AL.PO_NBR           =  CNUP.PO_NBR             51160074
155029               AND AL.PLAN_NBR         =  ES.PLAN_NBR             51170074
155029               AND PUR.PO_NBR          =  ES.PO_NBR               51180074
155029               AND ES.STR_DISTRO_QTY  >  0                        51190074
155029     END-EXEC.                                                    51200074
155029                                                                  51210074
155029     EVALUATE TRUE                                                51220074
155029         WHEN SQLCODE = ZERO                                      51230074
155029             CONTINUE                                             51240074
155029                                                                  51250074
155029         WHEN SQLCODE = +100                                      51260074
155029             SET PS-EOC-STORE-CURSOR                              51270074
155029                 PS-EOC-PREPACK-DC-CURSOR                         51280074
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             51290074
155029             INITIALIZE TR006-UPC-NBR                             51300074
155029                        TR006-ERROR-MSG                           51310074
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             51320074
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              51330074
155029                     DELIMITED BY SIZE                            51340074
155029                     INTO TR006-ERROR-MSG                         51350074
155029             MOVE POPRPK-PK-SKU-NBR   TO  TR006-SKU               51360074
155029             PERFORM 8830-WRITE-ERROR-LINE                        51370074
155029                                                                  51380074
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            51390074
155029         WHEN SQLCODE NOT EQUAL ZERO                              51400074
155029             DISPLAY '**************************************'     51410074
155029             DISPLAY '** ABEND                            **'     51420074
155029             DISPLAY '** PROGRAM = TRKUP006               **'     51430074
155029             DISPLAY '** PARAGRAPH = 7830-RETRIEVE-PLAN-NBR'      51440074
155029             DISPLAY '** CONTAINER = ' PV-HOLD-TR020-CONTNR-ID    51450074
155029             DISPLAY '** UPC NBR   = ' UPC-UPC-NBR                51460074
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            51470074
155029             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              51480074
155029             DISPLAY '**************************************'     51490074
155029             PERFORM 9100-SQL-ABEND                               51500074
155029     END-EVALUATE.                                                51510074
155029                                                                  51520074
155029 EJECT                                                            51530074
155029******************************************************************51540074
155029 7835-RETRIEVE-PLAN-NBR.                                          51550074
155029                                                                  51560074
155029     EXEC SQL                                                     51570074
155029         SELECT DISTINCT(PLAN_NBR)                                51580074
155029           INTO :ALLPLN-PLAN-NBR                                  51590074
155029           FROM TALLPLN                                           51600074
155029          WHERE PO_NBR         = :PURCHS-PO-NBR                   51610074
155029            AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR               51620074
155029            AND DEST_NBR       = :ALLPLN-DEST-NBR                 51630074
155029            AND CURR_SPLIT_QTY >  0                               51640074
155029     END-EXEC.                                                    51650074
155029                                                                  51660074
155029     EVALUATE TRUE                                                51670074
155029         WHEN SQLCODE = ZERO                                      51680074
155029             CONTINUE                                             51690074
155029                                                                  51700074
155029         WHEN SQLCODE = +100                                      51710074
155029             SET PS-EOC-STORE-CURSOR                              51720074
155029                 PS-EOC-PREPACK-DC-CURSOR                         51730074
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             51740074
155029             INITIALIZE TR006-UPC-NBR                             51750074
155029                        TR006-ERROR-MSG                           51760074
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             51770074
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              51780074
155029                     DELIMITED BY SIZE                            51790074
155029                     INTO TR006-ERROR-MSG                         51800074
155029             MOVE POPRPK-PK-SKU-NBR   TO  TR006-SKU               51810074
155029             PERFORM 8830-WRITE-ERROR-LINE                        51820074
155029                                                                  51830074
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            51840074
155029         WHEN SQLCODE NOT EQUAL ZERO                              51850074
155029             DISPLAY '**************************************'     51860074
155029             DISPLAY '** ABEND                            **'     51870074
155029             DISPLAY '** PROGRAM = TRKUP006               **'     51880074
155029             DISPLAY '** PARAGRAPH = 7835-RETRIEVE-PLAN-NBR'      51890074
155029             DISPLAY '** CONTAINER = ' PV-HOLD-TR020-CONTNR-ID    51900074
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            51910074
155029             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              51920074
155029             DISPLAY '** LINE NBR  = ' PURITM-PO-LNE-NBR          51930074
155029             DISPLAY '**************************************'     51940074
155029             PERFORM 9100-SQL-ABEND                               51950074
155029     END-EVALUATE.                                                51960074
155029                                                                  51970074
155029 EJECT                                                            51980074
447400******************************************************************51990005
447500 7900-OPEN-INSTR-CURSOR.                                          52000005
447600                                                                  52010005
447700     EXEC SQL                                                     52020005
447800          OPEN INSTR_CUR                                          52030005
447900     END-EXEC.                                                    52040005
448000                                                                  52050005
448100     EVALUATE TRUE                                                52060005
448200         WHEN SQLWARN0 NOT EQUAL SPACE                            52070005
448300         WHEN SQLCODE NOT EQUAL ZERO                              52080005
448400             DISPLAY '** ABEND **'                                52090005
448500             DISPLAY '** PROGRAM = TRKUP006 **'                   52100005
448600             DISPLAY '** PARAGRAPH = 7900-OPEN-INSTR-CURSOR **'   52110005
448700             PERFORM 9100-SQL-ABEND                               52120022
448800     END-EVALUATE.                                                52130005
448900                                                                  52140005
449000*                                                                 52150005
449100******************************************************************52160005
449200 8000-CLOSE-INSTR-CURSOR.                                         52170005
449300                                                                  52180005
449400                                                                  52190005
449500     EXEC SQL                                                     52200005
449600         CLOSE INSTR_CUR                                          52210005
449700     END-EXEC.                                                    52220005
449800                                                                  52230005
449900     EVALUATE TRUE                                                52240005
450000         WHEN SQLWARN0 NOT EQUAL SPACE                            52250005
450100         WHEN SQLCODE NOT EQUAL ZERO                              52260005
450200             DISPLAY '** ABEND **'                                52270005
450300             DISPLAY '** PROGRAM = TRKUP006 **'                   52280005
450400             DISPLAY '** PARAGRAPH = 8000-CLOSE-INSTR-CURSOR**'   52290005
450500             PERFORM 9100-SQL-ABEND                               52300022
450600     END-EVALUATE.                                                52310005
450700                                                                  52320005
450800*                                                                 52330005
450900******************************************************************52340005
451000 8100-FETCH-INSTR-CURSOR.                                         52350005
451100                                                                  52360005
451200     EXEC SQL                                                     52370005
451300          FETCH INSTR_CUR                                         52380005
451400          INTO                                                    52390005
451500                  :INSTCD-INSTR-DESC                              52400005
451600                , :INSTCD-INSTR-NBR                               52410005
451700                , :POINST-RECIP-CDE                               52420005
451800     END-EXEC.                                                    52430005
451900                                                                  52440005
452000     EVALUATE TRUE                                                52450005
452100         WHEN SQLCODE = ZERO                                      52460005
452200             CONTINUE                                             52470005
452300                                                                  52480005
452400         WHEN SQLCODE = +100                                      52490005
452500              SET PS-EOC-INSTR-CURSOR                             52500005
452600                                   TO  TRUE                       52510005
452700                                                                  52520005
452800         WHEN SQLWARN0 NOT EQUAL SPACE                            52530005
452900         WHEN SQLCODE NOT EQUAL ZERO                              52540005
453000             DISPLAY '** ABEND **'                                52550005
453100             DISPLAY '** PROGRAM = TRKUP006 **'                   52560005
453200             DISPLAY '** PARAGRAPH = 8100-FETCH-INSTR-CURSOR**'   52570005
453300             PERFORM 9100-SQL-ABEND                               52580022
453400     END-EVALUATE.                                                52590005
453500                                                                  52600005
453600 EJECT                                                            52610005
453700******************************************************************52620005
453800 8200-OPEN-BULK-UPC-CUR.                                          52630005
453900                                                                  52640005
454000     EXEC SQL                                                     52650005
454100          OPEN BULK_UPC_CUR                                       52660005
454200     END-EXEC.                                                    52670005
454300                                                                  52680005
454400     EVALUATE TRUE                                                52690005
454500         WHEN SQLWARN0 NOT EQUAL SPACE                            52700005
454600         WHEN SQLCODE NOT EQUAL ZERO                              52710005
454700             DISPLAY '** ABEND **'                                52720005
454800             DISPLAY '** PROGRAM = TRKUP006 **'                   52730005
454900             DISPLAY '** PARAGRAPH = 8200-OPEN-BULK-UPC-CUR **'   52740005
455000             PERFORM 9100-SQL-ABEND                               52750022
455100     END-EVALUATE.                                                52760005
455200                                                                  52770005
455300*                                                                 52780005
455400******************************************************************52790005
455500 8300-CLOSE-BULK-UPC-CUR.                                         52800005
455600                                                                  52810005
455700                                                                  52820005
455800     EXEC SQL                                                     52830005
455900         CLOSE BULK_UPC_CUR                                       52840005
456000     END-EXEC.                                                    52850005
456100                                                                  52860005
456200     EVALUATE TRUE                                                52870005
456300         WHEN SQLWARN0 NOT EQUAL SPACE                            52880005
456400         WHEN SQLCODE NOT EQUAL ZERO                              52890005
456500             DISPLAY '** ABEND **'                                52900005
456600             DISPLAY '** PROGRAM = TRKUP006 **'                   52910005
456700             DISPLAY '** PARAGRAPH = 8300-CLOSE-BULK-UPC-CUR**'   52920005
456800             PERFORM 9100-SQL-ABEND                               52930022
456900     END-EVALUATE.                                                52940005
457000                                                                  52950005
457100*                                                                 52960005
457200******************************************************************52970005
457300 8400-FETCH-BULK-UPC-CUR.                                         52980005
457400                                                                  52990005
457500     EXEC SQL                                                     53000005
457600          FETCH BULK_UPC_CUR                                      53010005
457700          INTO                                                    53020005
457800                  :PURITM-APP-PO-LNE-NBR                          53030005
457900                , :PURITM-PO-LNE-NBR                              53040005
458000                , :XLT00004-VS-NBR                                53050005
458100                , :XLT00003-CSTM-CLOR-DESC                        53060005
458200                , :XLT00003-SIZE-DESC                             53070005
458300                , :XLT00003-NRF-CLOR-CDE                          53080005
458400                , :XLT00003-SKU-DESC                              53090005
458500                , :PURITM-ITM-NBR                                 53100005
458600                , :PURITM-PO-NBR                                  53110005
458700                , :PURITM-STATUS-CDE                              53120005
458800                , :PURITM-UNT-QTY                                 53130005
458900                , :PURITM-PREPK-RATO-QTY                          53140005
459000                , :UPC-UPC-NBR                                    53150005
459100                , :SKXREF-DEPT                                    53160005
459200                , :SKXREF-CLASS                                   53170005
459300                , :SKXREF-SUBCLASS                                53180005
459400                , :SKXREF-SKU                                     53190005
459410                , :PURITM-OUTR-PK-QTY                             53200005
459500     END-EXEC.                                                    53210005
459600                                                                  53220005
459700     EVALUATE TRUE                                                53230005
459800         WHEN SQLCODE = ZERO                                      53240005
155029             SET PS-NEW-UPC-YES      TO TRUE                      53250074
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        53260074
459900             SET PS-LINES-ON-TPURITM TO TRUE                      53270005
460000             IF SKXREF-DEPT NUMERIC                               53280005
460100              IF SKXREF-DEPT > ZEROES                             53290005
460200                  MOVE SKXREF-DEPT TO TR006-DEPT-NBR              53300005
460300              END-IF                                              53310005
460400             END-IF                                               53320005
460500                                                                  53330005
460600         WHEN SQLCODE = +100                                      53340005
460700              IF PS-LINES-ON-TPURITM AND                          53350005
460800                 PS-AC-AP-LINES                                   53360005
460900                  CONTINUE                                        53370005
461000              ELSE                                                53380005
461100                  INITIALIZE TR006-UPC-NBR                        53390005
461200                             TR006-SKU                            53400005
461300                             TR006-ERROR-MSG                      53410005
461400                  SET TR006-ERROR-TYPE-ERROR   TO TRUE            53420005
461500                  STRING 'NO UPCS FOR BULK PO-NOT SENT'           53430005
461600                      DELIMITED BY SIZE                           53440005
461700                      INTO TR006-ERROR-MSG                        53450005
461800                  PERFORM 8830-WRITE-ERROR-LINE                   53460005
461900              END-IF                                              53470005
462000                                                                  53480005
462100              SET PS-EOC-BULK-UPC-CUR TO TRUE                     53490005
462200                                                                  53500005
462300         WHEN SQLWARN0 NOT EQUAL SPACE                            53510005
462400         WHEN SQLCODE NOT EQUAL ZERO                              53520005
462500             DISPLAY '** ABEND **'                                53530005
462600             DISPLAY '** PROGRAM = TRKUP006 **'                   53540005
462700             DISPLAY '** PARAGRAPH = 8400-FETCH-BULK-UPC-CUR**'   53550005
462800             PERFORM 9100-SQL-ABEND                               53560022
462900     END-EVALUATE.                                                53570005
463000                                                                  53580005
463100 EJECT                                                            53590005
463200******************************************************************53600005
463300 8420-OPEN-PACK-DC-CURSOR.                                        53610005
463400                                                                  53620005
463500     EXEC SQL                                                     53630005
463600          OPEN PREPACK_DC_CUR                                     53640005
463700     END-EXEC.                                                    53650005
463800                                                                  53660005
463900     EVALUATE TRUE                                                53670005
464000         WHEN SQLWARN0 NOT EQUAL SPACE                            53680005
464100         WHEN SQLCODE NOT EQUAL ZERO                              53690005
464200             DISPLAY '** ABEND **'                                53700005
464300             DISPLAY '** PROGRAM = TRKUP006 **'                   53710005
464400             DISPLAY '** PARAGRAPH = 8420-OPEN-PACK-DC-CURSOR***' 53720005
464500             PERFORM 9100-SQL-ABEND                               53730022
464600     END-EVALUATE.                                                53740005
464700                                                                  53750005
464800******************************************************************53760005
464900 8425-CLOSE-PACK-DC-CURSOR.                                       53770005
465000                                                                  53780005
465100     EXEC SQL                                                     53790005
465200         CLOSE PREPACK_DC_CUR                                     53800005
465300     END-EXEC.                                                    53810005
465400                                                                  53820005
465500     EVALUATE TRUE                                                53830005
465600         WHEN SQLWARN0 NOT EQUAL SPACE                            53840005
465700         WHEN SQLCODE NOT EQUAL ZERO                              53850005
465800             DISPLAY '** ABEND **'                                53860005
465900             DISPLAY '** PROGRAM = TRKUP006 **'                   53870005
466000             DISPLAY '** PARAGRAPH = 8425-CLOSE-PACK-DC-CURSOR***'53880005
466100             PERFORM 9100-SQL-ABEND                               53890022
466200     END-EVALUATE.                                                53900005
466300                                                                  53910005
466400******************************************************************53920005
466500 8430-FETCH-PACK-DC-CURSOR.                                       53930005
466600                                                                  53940005
466700     EXEC SQL                                                     53950005
466800          FETCH PREPACK_DC_CUR                                    53960005
466900          INTO                                                    53970005
467000               :PA-PDC-SPLIT-QTY                                  53980005
467100             , :ALLPLN-DEST-NBR                                   53990005
155029             , :PV-FAST-E-BUS-IND                                 54000074
467200     END-EXEC.                                                    54010005
467300                                                                  54020005
467400     EVALUATE TRUE                                                54030005
467500         WHEN SQLCODE = ZERO                                      54040005
467600             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 54050005
155029             IF PS-NEW-UPC-YES                                    54060074
155029                SET PS-NEW-UPC-NO      TO TRUE                    54070074
155029                SET PS-FIRST-UPC-YES   TO TRUE                    54080074
155029             END-IF                                               54090074
467700                                                                  54100005
467800         WHEN SQLCODE = +100                                      54110005
467900              SET PS-EOC-PREPACK-DC-CURSOR TO TRUE                54120005
468000              IF PS-DC-SPLIT-INFO-PRESENT                         54130005
468100                  CONTINUE                                        54140005
468200              ELSE                                                54150005
468300                  INITIALIZE TR006-ERROR-MSG                      54160005
468400                  MOVE POPRPK-PK-SKU-NBR         TO TR006-SKU     54170005
468500                  MOVE POPRPK-PREPK-UPC-NBR      TO TR006-UPC-NBR 54180005
468600                  SET TR006-ERROR-TYPE-MISS-SPLT TO TRUE          54190005
468700                  STRING 'PCK PO MISSING SPLIT-FIX'               54200005
468800                      DELIMITED BY SIZE                           54210005
468900                      INTO TR006-ERROR-MSG                        54220005
469000                  PERFORM 8830-WRITE-ERROR-LINE                   54230005
469100                  SET PS-PROBLEM-SO-SET-RETRANS TO TRUE           54240005
469200              END-IF                                              54250005
469300                                                                  54260005
469400         WHEN SQLWARN0 NOT EQUAL SPACE                            54270005
469500         WHEN SQLCODE NOT EQUAL ZERO                              54280005
469600             DISPLAY '** ABEND **'                                54290005
469700             DISPLAY '** PROGRAM = TRKUP006 **'                   54300005
469800             DISPLAY '** PARAGRAPH = 8430-FETCH-PACK-DC-CURSOR**' 54310005
469900             PERFORM 9100-SQL-ABEND                               54320022
470000     END-EVALUATE.                                                54330005
470100                                                                  54340005
470200 EJECT                                                            54350005
470300******************************************************************54360005
470400 8450-OPEN-PACK-UPC-CUR.                                          54370005
470500                                                                  54380005
470600     EXEC SQL                                                     54390005
470700          OPEN PACK_UPC_CUR                                       54400005
470800     END-EXEC.                                                    54410005
470900                                                                  54420005
471000     EVALUATE TRUE                                                54430005
471100         WHEN SQLWARN0 NOT EQUAL SPACE                            54440005
471200         WHEN SQLCODE NOT EQUAL ZERO                              54450005
471300             DISPLAY '** ABEND **'                                54460005
471400             DISPLAY '** PROGRAM = TRKUP006 **'                   54470005
471500             DISPLAY '** PARAGRAPH = 8450-OPEN-PACK-UPC-CUR*'     54480005
471600             PERFORM 9100-SQL-ABEND                               54490022
471700     END-EVALUATE.                                                54500005
471800                                                                  54510005
471900******************************************************************54520005
472000 8455-CLOSE-PACK-UPC-CUR.                                         54530005
472100                                                                  54540005
472200     EXEC SQL                                                     54550005
472300         CLOSE PACK_UPC_CUR                                       54560005
472400     END-EXEC.                                                    54570005
472500                                                                  54580005
472600     EVALUATE TRUE                                                54590005
472700         WHEN SQLWARN0 NOT EQUAL SPACE                            54600005
472800         WHEN SQLCODE NOT EQUAL ZERO                              54610005
472900             DISPLAY '** ABEND **'                                54620005
473000             DISPLAY '** PROGRAM = TRKUP006 **'                   54630005
473100             DISPLAY '** PARAGRAPH = 8455-CLOSE-PACK-UPC-CUR*'    54640005
473200             PERFORM 9100-SQL-ABEND                               54650022
473300     END-EVALUATE.                                                54660005
473400                                                                  54670005
473500******************************************************************54680005
473600 8460-FETCH-PACK-UPC-CUR.                                         54690005
473700                                                                  54700005
473800     EXEC SQL                                                     54710005
473900          FETCH PACK_UPC_CUR                                      54720005
474000          INTO                                                    54730005
474100               :PURITM-PO-NBR                                     54740005
474200             , :PURITM-APP-PO-LNE-NBR                             54750005
474300             , :PURITM-PO-LNE-NBR                                 54760005
474400             , :XLT00004-VS-NBR                                   54770005
474500             , :XLT00003-CSTM-CLOR-DESC                           54780005
474600             , :XLT00003-SIZE-DESC                                54790005
474700             , :XLT00003-NRF-CLOR-CDE                             54800005
474800             , :XLT00003-SKU-DESC                                 54810005
474900             , :PURITM-ITM-NBR                                    54820005
475000             , :PURITM-STATUS-CDE                                 54830005
475100             , :PURITM-UNT-QTY                                    54840005
475200             , :PURITM-PREPK-RATO-QTY                             54850005
475300             , :UPC-UPC-NBR                                       54860005
475400             , :SKXREF-DEPT                                       54870005
475500             , :SKXREF-CLASS                                      54880005
475600             , :SKXREF-SUBCLASS                                   54890005
475700             , :SKXREF-SKU                                        54900005
475800     END-EXEC.                                                    54910005
475900                                                                  54920005
476000     EVALUATE TRUE                                                54930005
476100         WHEN SQLCODE = ZERO                                      54940005
476200             SET PS-LINES-ON-TPURITM TO TRUE                      54950005
476300             IF SKXREF-DEPT NUMERIC                               54960005
476400              IF SKXREF-DEPT > ZEROES                             54970005
476500                 MOVE SKXREF-DEPT TO TR006-DEPT-NBR               54980005
476600              END-IF                                              54990005
476700             END-IF                                               55000005
476800                                                                  55010005
476900         WHEN SQLCODE = +100                                      55020005
477000              IF PS-LINES-ON-TPURITM AND                          55030005
477100                 PS-AC-AP-LINES                                   55040005
477200                  CONTINUE                                        55050005
477300              ELSE                                                55060005
477400                  INITIALIZE TR006-ERROR-MSG                      55070005
477500                  MOVE POPRPK-PK-SKU-NBR       TO TR006-SKU       55080005
477600                  MOVE POPRPK-PREPK-UPC-NBR    TO TR006-UPC-NBR   55090005
477700                  SET TR006-ERROR-TYPE-ERROR   TO TRUE            55100005
477800                  STRING 'NO DL UPCS/SKUS FR PCK PO-NT SNT'       55110005
477900                      DELIMITED BY SIZE                           55120005
478000                      INTO TR006-ERROR-MSG                        55130005
478100                  PERFORM 8830-WRITE-ERROR-LINE                   55140005
478200              END-IF                                              55150005
478300                                                                  55160005
478400              SET PS-EOC-PACK-UPC-CURSOR TO TRUE                  55170005
478500                                                                  55180005
478600         WHEN SQLWARN0 NOT EQUAL SPACE                            55190005
478700         WHEN SQLCODE NOT EQUAL ZERO                              55200005
478800             DISPLAY '** ABEND **'                                55210005
478900             DISPLAY '** PROGRAM = TRKUP006 **'                   55220005
479000             DISPLAY '** PARAGRAPH = 8460-FETCH-PACK-UPC-CUR'     55230005
479100             PERFORM 9100-SQL-ABEND                               55240022
479200     END-EVALUATE.                                                55250005
479300                                                                  55260005
479400 EJECT                                                            55270005
479500******************************************************************55280005
479600 8470-OPEN-E-COM-PACK-UPC-CUR.                                    55290005
479700                                                                  55300005
479800     EXEC SQL                                                     55310005
479900         OPEN E_COM_PACK_UPC_CUR                                  55320005
480000     END-EXEC.                                                    55330005
480100                                                                  55340005
480200     EVALUATE TRUE                                                55350005
480300         WHEN SQLWARN0 NOT EQUAL SPACE                            55360005
480400         WHEN SQLCODE NOT EQUAL ZERO                              55370005
480500            DISPLAY '** ABEND **'                                 55380005
480600            DISPLAY '** PROGRAM = TRKUP006 **'                    55390005
480700            DISPLAY '** PARAGRAPH = 8470-OPEN-E-COM-PACK-UPC-CUR' 55400005
480800            PERFORM 9100-SQL-ABEND                                55410022
480900     END-EVALUATE.                                                55420005
481000                                                                  55430005
481100******************************************************************55440005
481200 8472-FETCH-E-COM-PACK-UPC-CUR.                                   55450005
481300                                                                  55460005
481400     EXEC SQL                                                     55470005
481500          FETCH E_COM_PACK_UPC_CUR                                55480005
481600          INTO                                                    55490005
481700               :UPC-UPC-NBR                                       55500005
481800              ,:PURITM-PO-LNE-NBR                                 55510005
481900     END-EXEC.                                                    55520005
482000                                                                  55530005
482100     EVALUATE TRUE                                                55540005
482200         WHEN SQLCODE = ZERO                                      55550005
482300             CONTINUE                                             55560005
482400                                                                  55570005
482500         WHEN SQLCODE = +100                                      55580005
482600              SET PS-EOC-E-COM-PACK-UPC-CUR  TO TRUE              55590005
482700                                                                  55600005
482800         WHEN SQLWARN0 NOT EQUAL SPACE                            55610005
482900         WHEN SQLCODE NOT EQUAL ZERO                              55620005
483000            DISPLAY '** ABEND **'                                 55630005
483100            DISPLAY '** PROGRAM = TRKUP006 **'                    55640005
483200            DISPLAY '** PARAGRAPH = 8472-FETCH-E-COM-PACK-UPC-CUR'55650005
483300            PERFORM 9100-SQL-ABEND                                55660022
483400     END-EVALUATE.                                                55670005
483500                                                                  55680005
483600******************************************************************55690005
483700 8474-CLOSE-E-COM-PACK-UPC-CUR.                                   55700005
483800                                                                  55710005
483900     EXEC SQL                                                     55720005
484000         CLOSE E_COM_PACK_UPC_CUR                                 55730005
484100     END-EXEC.                                                    55740005
484200                                                                  55750005
484300     EVALUATE TRUE                                                55760005
484400         WHEN SQLWARN0 NOT EQUAL SPACE                            55770005
484500         WHEN SQLCODE NOT EQUAL ZERO                              55780005
484600          DISPLAY '** ABEND **'                                   55790005
484700          DISPLAY '** PROGRAM = TRKUP006 **'                      55800005
484800          DISPLAY '** PARAGRAPH = 8474-CLOSE-E-COM-PACK-UPC-CUR'  55810005
484900            PERFORM 9100-SQL-ABEND                                55820022
485000     END-EVALUATE.                                                55830005
485100                                                                  55840005
485200 EJECT                                                            55850005
485300******************************************************************55860005
485400 8500-OPEN-DC-CURSOR.                                             55870005
485500                                                                  55880005
485600     EXEC SQL                                                     55890005
485700          OPEN DC_CUR                                             55900005
485800     END-EXEC.                                                    55910005
485900                                                                  55920005
486000     EVALUATE TRUE                                                55930005
486100         WHEN SQLWARN0 NOT EQUAL SPACE                            55940005
486200         WHEN SQLCODE NOT EQUAL ZERO                              55950005
486300             DISPLAY '** ABEND **'                                55960005
486400             DISPLAY '** PROGRAM = TRKUP006 **'                   55970005
486500             DISPLAY '** PARAGRAPH = 8500-OPEN-DC-CURSOR **'      55980005
486600             PERFORM 9100-SQL-ABEND                               55990022
486700     END-EVALUATE.                                                56000005
486800                                                                  56010005
486900*                                                                 56020005
487000******************************************************************56030005
487100 8600-CLOSE-DC-CURSOR.                                            56040005
487200                                                                  56050005
487300                                                                  56060005
487400     EXEC SQL                                                     56070005
487500         CLOSE DC_CUR                                             56080005
487600     END-EXEC.                                                    56090005
487700                                                                  56100005
487800     EVALUATE TRUE                                                56110005
487900         WHEN SQLWARN0 NOT EQUAL SPACE                            56120005
488000         WHEN SQLCODE NOT EQUAL ZERO                              56130005
488100             DISPLAY '** ABEND **'                                56140005
488200             DISPLAY '** PROGRAM = TRKUP006 **'                   56150005
488300             DISPLAY '** PARAGRAPH = 8600-CLOSE-DC-CURSOR**'      56160005
488400             PERFORM 9100-SQL-ABEND                               56170022
488500     END-EVALUATE.                                                56180005
488600                                                                  56190005
488700*                                                                 56200005
488800******************************************************************56210005
488900 8700-FETCH-DC-CURSOR.                                            56220005
489000                                                                  56230005
489100     EXEC SQL                                                     56240005
489200          FETCH DC_CUR                                            56250005
489300          INTO                                                    56260005
489400                  :ALLPLN-DEST-NBR                                56270005
489500                , :ALLPLN-DC-SPLIT-QTY                            56280005
489600                , :ALLPLN-CURR-SPLIT-QTY                          56290005
489700                , :ALLPLN-PLAN-NBR                                56300005
155029                , :PV-FAST-E-BUS-IND                              56310074
489800     END-EXEC.                                                    56320005
489900                                                                  56330005
490000     EVALUATE TRUE                                                56340005
490100         WHEN SQLCODE = ZERO                                      56350005
490200             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 56360005
155029             IF PS-NEW-UPC-YES                                    56370074
155029                SET PS-NEW-UPC-NO      TO TRUE                    56380074
155029                SET PS-FIRST-UPC-YES   TO TRUE                    56390074
155029             END-IF                                               56400074
490300                                                                  56410005
490400         WHEN SQLCODE = +100                                      56420005
490500              IF PS-DC-SPLIT-INFO-PRESENT                         56430005
490600                  CONTINUE                                        56440005
490700              ELSE                                                56450005
490800                  INITIALIZE TR006-ERROR-MSG                      56460005
490900                  MOVE UPC-UPC-NBR  TO TR006-UPC-NBR              56470005
491000                  MOVE SKXREF-SKU   TO TR006-SKU                  56480005
491100                  STRING 'BLK UPC MISSING SPLT-SPLT NT SNT'       56490005
491200                      DELIMITED BY SIZE                           56500005
491300                      INTO TR006-ERROR-MSG                        56510005
491400                  PERFORM 8710-MISSING-SPLIT-ERROR                56520005
491500              END-IF                                              56530005
491600                                                                  56540005
491700              SET PS-EOC-DC-CURSOR TO TRUE                        56550005
491800                                                                  56560005
491900         WHEN SQLWARN0 NOT EQUAL SPACE                            56570005
492000         WHEN SQLCODE NOT EQUAL ZERO                              56580005
492100             DISPLAY '** ABEND **'                                56590005
492200             DISPLAY '** PROGRAM = TRKUP006 **'                   56600005
492300             DISPLAY '** PARAGRAPH = 8700-FETCH-DC-CURSOR**'      56610005
492400             PERFORM 9100-SQL-ABEND                               56620022
492500     END-EVALUATE.                                                56630005
492600                                                                  56640005
492700******************************************************************56650005
492800 8710-MISSING-SPLIT-ERROR.                                        56660005
492900                                                                  56670005
493000     SET PS-PROBLEM-SO-SET-RETRANS TO TRUE                        56680005
493100     IF SHPTPO-PO-NBR = PV-HOLD-PO-NBR                            56690005
493200         CONTINUE                                                 56700005
493300     ELSE                                                         56710005
493400         MOVE SHPTPO-PO-NBR TO PV-HOLD-PO-NBR                     56720005
493500         SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE                 56730005
493600         PERFORM 8830-WRITE-ERROR-LINE                            56740005
493700     END-IF.                                                      56750005
493800                                                                  56760005
493900 EJECT                                                            56770005
494000******************************************************************56780005
494100 8715-OPEN-POPRPK-FOR-PO-CUR.                                     56790005
494200                                                                  56800005
494300     EXEC SQL                                                     56810005
494400          OPEN POPRPK_FOR_PO_CUR                                  56820005
494500     END-EXEC.                                                    56830005
494600                                                                  56840005
494700     EVALUATE TRUE                                                56850005
494800         WHEN SQLWARN0 NOT EQUAL SPACE                            56860005
494900         WHEN SQLCODE NOT EQUAL ZERO                              56870005
495000             DISPLAY '** ABEND **'                                56880005
495100             DISPLAY '** PROGRAM = TRKUP006 **'                   56890005
495200             DISPLAY '** PARAGRAPH = 8715-OPEN-POPRPK-FOR-PO-CUR' 56900005
495300             PERFORM 9100-SQL-ABEND                               56910022
495400     END-EVALUATE.                                                56920005
495500                                                                  56930005
495600******************************************************************56940005
495700 8717-CLOSE-POPRPK-FOR-PO-CUR.                                    56950005
495800                                                                  56960005
495900     EXEC SQL                                                     56970005
496000         CLOSE POPRPK_FOR_PO_CUR                                  56980005
496100     END-EXEC.                                                    56990005
496200                                                                  57000005
496300     EVALUATE TRUE                                                57010005
496400         WHEN SQLWARN0 NOT EQUAL SPACE                            57020005
496500         WHEN SQLCODE NOT EQUAL ZERO                              57030005
496600             DISPLAY '** ABEND **'                                57040005
496700             DISPLAY '** PROGRAM = TRKUP006 **'                   57050005
496800             DISPLAY '** PARAGRAPH =8717-CLOSE-POPRPK-FOR-PO-CUR' 57060005
496900             PERFORM 9100-SQL-ABEND                               57070022
497000     END-EVALUATE.                                                57080005
497100                                                                  57090005
497200******************************************************************57100005
497300 8720-FETCH-POPRPK-FOR-PO-CUR.                                    57110005
497400                                                                  57120005
497500     EXEC SQL                                                     57130005
497600          FETCH POPRPK_FOR_PO_CUR                                 57140005
497700          INTO                                                    57150005
497800               :POPRPK-PO-PREPK-ID                                57160005
497900              ,:POPRPK-OTPK-UNT-QTY                               57170005
498000              ,:POPRPK-INPK-UNT-QTY                               57180005
498000              ,:POPRPK-PREPK-TYP-CDE                              57190007
498100     END-EXEC.                                                    57200005
498200                                                                  57210005
498300     EVALUATE TRUE                                                57220005
498400         WHEN SQLCODE = ZERO                                      57230005
498500             CONTINUE                                             57240005
498600                                                                  57250005
498700         WHEN SQLCODE = +100                                      57260005
498800              SET PS-EOC-POPRPK-FOR-PO-CUR TO TRUE                57270005
498900                                                                  57280005
499000         WHEN SQLWARN0 NOT EQUAL SPACE                            57290005
499100         WHEN SQLCODE NOT EQUAL ZERO                              57300005
499200            DISPLAY '** ABEND **'                                 57310005
499300            DISPLAY '** PROGRAM = TRKUP006 **'                    57320005
499400            DISPLAY '** PARAGRAPH = 8720-FETCH-POPRPK-FOR-PO-CUR' 57330005
499500            PERFORM 9100-SQL-ABEND                                57340022
499600     END-EVALUATE.                                                57350005
499700                                                                  57360005
499800 EJECT                                                            57370005
499900******************************************************************57380005
500000 8725-OPEN-PURITM-TUPC-CUR.                                       57390005
500100                                                                  57400005
500200     EXEC SQL                                                     57410005
500300          OPEN PURITM_TUPC_CUR                                    57420005
500400     END-EXEC.                                                    57430005
500500                                                                  57440005
500600     EVALUATE TRUE                                                57450005
500700         WHEN SQLWARN0 NOT EQUAL SPACE                            57460005
500800         WHEN SQLCODE NOT EQUAL ZERO                              57470005
500900             DISPLAY '** ABEND **'                                57480005
501000             DISPLAY '** PROGRAM = TRKUP006 **'                   57490005
501100             DISPLAY '** PARAGRAPH = 8725-OPEN-PURITM-TUPC-CUR'   57500005
501200             PERFORM 9100-SQL-ABEND                               57510022
501300     END-EVALUATE.                                                57520005
501400                                                                  57530005
501500                                                                  57540005
501600******************************************************************57550005
501700 8727-CLOSE-PURITM-TUPC-CUR.                                      57560005
501800                                                                  57570005
501900     EXEC SQL                                                     57580005
502000         CLOSE PURITM_TUPC_CUR                                    57590005
502100     END-EXEC.                                                    57600005
502200                                                                  57610005
502300     EVALUATE TRUE                                                57620005
502400         WHEN SQLWARN0 NOT EQUAL SPACE                            57630005
502500         WHEN SQLCODE NOT EQUAL ZERO                              57640005
502600             DISPLAY '** ABEND **'                                57650005
502700             DISPLAY '** PROGRAM = TRKUP006 **'                   57660005
502800             DISPLAY '** PARAGRAPH = 8727-CLOSE-PURITM-TUPC-CUR'  57670005
502900             PERFORM 9100-SQL-ABEND                               57680022
503000     END-EVALUATE.                                                57690005
503100                                                                  57700005
503200******************************************************************57710005
503300 8730-FETCH-PURITM-TUPC-CUR.                                      57720005
503400                                                                  57730005
503500     EXEC SQL                                                     57740005
503600          FETCH PURITM_TUPC_CUR                                   57750005
503700          INTO                                                    57760005
503800              :PURITM-OUTR-PK-QTY                                 57770005
503900             ,:PURITM-UNT-QTY                                     57780005
504000     END-EXEC.                                                    57790005
504100                                                                  57800005
504200     EVALUATE TRUE                                                57810005
504300         WHEN SQLCODE = ZERO                                      57820005
504400             CONTINUE                                             57830005
504500                                                                  57840005
504600         WHEN SQLCODE = +100                                      57850005
504700              SET PS-EOC-PURITM-TUPC-CUR TO TRUE                  57860005
504800                                                                  57870005
504900         WHEN SQLWARN0 NOT EQUAL SPACE                            57880005
505000         WHEN SQLCODE NOT EQUAL ZERO                              57890005
505100            DISPLAY '** ABEND **'                                 57900005
505200            DISPLAY '** PROGRAM = TRKUP006 **'                    57910005
505300            DISPLAY '** PARAGRAPH = 8730-FETCH-PURITM-TUPC-CUR'   57920005
505400            PERFORM 9100-SQL-ABEND                                57930022
505500     END-EVALUATE.                                                57940005
505600                                                                  57950005
505700 EJECT                                                            57960005
505800******************************************************************57970005
505900 8735-OPEN-POPRPK-FOR-PCK-CUR.                                    57980005
506000                                                                  57990005
506100     EXEC SQL                                                     58000005
506200          OPEN POPRPK_FOR_PCK_CUR                                 58010005
506300     END-EXEC.                                                    58020005
506400                                                                  58030005
506500     EVALUATE TRUE                                                58040005
506600         WHEN SQLWARN0 NOT EQUAL SPACE                            58050005
506700         WHEN SQLCODE NOT EQUAL ZERO                              58060005
506800            DISPLAY '** ABEND **'                                 58070005
506900            DISPLAY '** PROGRAM = TRKUP006 **'                    58080005
507000            DISPLAY '** PARAGRAPH = 8735-OPEN-POPRPK-FOR-PCK-CUR' 58090005
507100            PERFORM 9100-SQL-ABEND                                58100022
507200     END-EVALUATE.                                                58110005
507300                                                                  58120005
507400******************************************************************58130005
507500 8740-CLOSE-POPRPK-FOR-PCK-CUR.                                   58140005
507600                                                                  58150005
507700     EXEC SQL                                                     58160005
507800         CLOSE POPRPK_FOR_PCK_CUR                                 58170005
507900     END-EXEC.                                                    58180005
508000                                                                  58190005
508100     EVALUATE TRUE                                                58200005
508200         WHEN SQLWARN0 NOT EQUAL SPACE                            58210005
508300         WHEN SQLCODE NOT EQUAL ZERO                              58220005
508400           DISPLAY '** ABEND **'                                  58230005
508500           DISPLAY '** PROGRAM = TRKUP006 **'                     58240005
508600           DISPLAY '** PARAGRAPH =8740-CLOSE-POPRPK-FOR-PCK-CUR'  58250005
508700           PERFORM 9100-SQL-ABEND                                 58260022
508800     END-EVALUATE.                                                58270005
508900                                                                  58280005
509000******************************************************************58290005
509100 8745-FETCH-POPRPK-FOR-PCK-CUR.                                   58300005
509200                                                                  58310005
509300     EXEC SQL                                                     58320005
509400          FETCH POPRPK_FOR_PCK_CUR                                58330005
509500          INTO                                                    58340005
509600               :POPRPK-PO-PREPK-ID                                58350005
509700             , :POPRPK-INPK-UNT-QTY                               58360005
509800             , :POPRPK-OTPK-UNT-QTY                               58370005
509900             , :POPRPK-PREPK-DESC                                 58380005
510000             , :POPRPK-PREPK-UPC-NBR                              58390005
510100             , :POPRPK-PK-SKU-NBR                                 58400005
498000             , :POPRPK-PREPK-TYP-CDE                              58410007
510200     END-EXEC.                                                    58420005
510300                                                                  58430005
510400     EVALUATE TRUE                                                58440005
510500         WHEN SQLCODE = ZERO                                      58450005
155029              MOVE SPACES             TO PV-HOLD-OUT-RECORD       58460074
155029              SET PS-NEW-UPC-YES      TO TRUE                     58470074
510700                                                                  58480005
510800         WHEN SQLCODE = +100                                      58490005
510900              SET PS-EOC-PACK-CURSOR TO TRUE                      58500005
511000                                                                  58510005
511100         WHEN SQLWARN0 NOT EQUAL SPACE                            58520005
511200         WHEN SQLCODE NOT EQUAL ZERO                              58530005
511300          DISPLAY '** ABEND **'                                   58540005
511400          DISPLAY '** PROGRAM = TRKUP006 **'                      58550005
511500          DISPLAY '** PARAGRAPH = 8745-FETCH-POPRPK-FOR-PCK-CUR'  58560005
511600          PERFORM 9100-SQL-ABEND                                  58570022
511700     END-EVALUATE.                                                58580005
511800                                                                  58590005
511900******************************************************************58600005
512000 8830-WRITE-ERROR-LINE.                                           58610005
512100                                                                  58620005
512200     SET TR006-REXMIT-RPT             TO TRUE.                    58630005
512300     MOVE 'VS'                        TO TR006-TRIP-TYPE.         58640005
512400     MOVE PC-CURRENT-PROGRAM-NAME     TO TR006-PGM-NAME.          58650005
512500                                                                  58660005
512600     MOVE TR006-RECORD                TO OUTTR3-TRGL-ERR-RPT-ODR. 58670005
512700     ADD +1                           TO PA-ERROR-COUNT.          58680005
512800                                                                  58690005
512900     PERFORM 8840-INSERT-ERROR.                                   58700005
513000                                                                  58710005
513100******************************************************************58720005
513200 8840-INSERT-ERROR.                                               58730005
513300                                                                  58740005
513400     EXEC SQL                                                     58750005
513500         INSERT INTO TOUTTR3                                      58760005
513600             (TRGL_ERR_RPT_ODR)                                   58770005
513700            VALUES  (:OUTTR3-TRGL-ERR-RPT-ODR)                    58780005
513800     END-EXEC                                                     58790005
513900                                                                  58800005
514000     EVALUATE TRUE                                                58810005
514100         WHEN SQLWARN0 NOT EQUAL SPACE                            58820005
514200         WHEN SQLCODE NOT EQUAL ZERO                              58830005
514300             DISPLAY '** ABEND **'                                58840005
514400             DISPLAY '** PROGRAM = TRKUP006 **'                   58850005
514500             DISPLAY '** PARAGRAPH = 8840-INSERT-ERROR**'         58860005
514600             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR3**'         58870005
514700             PERFORM 9100-SQL-ABEND                               58880022
514800     END-EVALUATE.                                                58890005
514900                                                                  58900005
515000 EJECT                                                            58910005
515100******************************************************************58920005
515200* WRITE PACK (PCK) RECORD TYPE FOR DETAIL REPORT RECORD.         *58930005
515300******************************************************************58940005
515400 8847-WRITE-DTL-RPT-PCK-RECORD.                                   58950005
515500                                                                  58960005
515600     MOVE '40PCK'                     TO TR020-REC-TYPE-CDE-PCK.  58970005
515700     SET TR020-REXMIT-RPT-PCK         TO TRUE.                    58980005
515800     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCK.        58990005
515900     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCK.  59000005
516000     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PCK.     59010005
516100     MOVE TR004-PACK-ID               TO TR020-PACK-ID-PCK.       59020005
516200     MOVE TR004-PACK-UNITS-PER-CTN    TO TR020-UNITS-PER-CTN-PCK. 59030005
516300     MOVE TR004-PACK-CART-CT          TO TR020-CART-CT-PCK.       59040005
516400     MOVE TR004-PACK-UNIT-QTY         TO TR020-UNIT-QTY-PCK.      59050005
516500     MOVE TR004-PACK-DESC             TO TR020-DESC-PCK.          59060005
516600     MOVE TR004-PACKS-PER-CART        TO TR020-PACKS-PER-CART-PCK.59070005
516700     MOVE TR004-PACK-UPC-NBR          TO TR020-UPC-NBR-PCK.       59080005
516800     MOVE TR004-PACK-SKU              TO TR020-SKU-PCK.           59090005
516900     MOVE PC-NA                       TO TR020-ASN-PKGNG-CDE-PCK. 59100005
517000***  MOVE TR004-PACK-VEND-STYL-NAME   TO TR020-VEND-STYL-NAME-PCK.59110005
517100***  MOVE TR004-PACK-COLOR-CDE        TO TR020-COLOR-CDE-PCK.     59120005
517200***  MOVE TR004-PACK-COLOR-DESC       TO TR020-COLOR-DESC-PCK.    59130005
517300***  MOVE TR004-PACK-SIZE-DESC        TO TR020-SIZE-DESC-PCK.     59140005
517400                                                                  59150005
517500     MOVE TR020-REC-TYPE-PCK    TO OUTTR4-TRGL-DTL-RPT-1-ODR.     59160005
517600                                                                  59170005
517700     PERFORM 8880-INSERT-DETAIL.                                  59180005
517800                                                                  59190005
517900******************************************************************59200005
518000* WRITE PACK DC (PDC) RECORD TYPE FOR DETAIL REPORT RECORD.      *59210005
518100******************************************************************59220005
518200 8848-WRITE-DTL-RPT-PDC-RECORD.                                   59230005
518300                                                                  59240005
518400     MOVE '50PDC'                     TO TR020-REC-TYPE-CDE-PDC.  59250005
518500     SET TR020-REXMIT-RPT-PDC         TO TRUE.                    59260005
518600     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PDC.        59270005
518700     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PDC.  59280005
518800     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PDC.     59290005
518900     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-PDC.       59300005
519000     MOVE TR004-PDC-DIST-CNTR         TO TR020-DIST-CNTR-PDC.     59310005
519100     MOVE TR004-PDC-UNIT-QTY          TO TR020-UNIT-QTY-PDC.      59320005
519200     MOVE TR004-PDC-PERCNT            TO TR020-PERCNT-PDC.        59330005
519300     MOVE TR004-PDC-CART-CT           TO TR020-CART-CT-PDC.       59340005
519400                                                                  59350005
519500     MOVE TR020-REC-TYPE-PDC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.    59360005
519600                                                                  59370005
519700     PERFORM 8880-INSERT-DETAIL.                                  59380005
519800                                                                  59390005
519900******************************************************************59400005
520000* WRITE PURCHASE ORDER RECORD TYPE FOR DETAIL REPORT RECORD.     *59410005
520100******************************************************************59420005
520200 8850-WRITE-DTL-RPT-PO-RECORD.                                    59430005
520300                                                                  59440005
520400     MOVE '10PO '                     TO TR020-REC-TYPE-CDE-PO.   59450005
520500     SET TR020-REXMIT-RPT-PO          TO TRUE.                    59460005
520600     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PO.         59470005
520700     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PO.   59480005
520800     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PO.      59490005
520900     MOVE TR004-VENDOR-NAME           TO TR020-VENDOR-NAME-PO.    59500005
521000     MOVE TR006-DONT-SHIP-BEFORE-DATE                             59510005
521100                               TO TR020-DO-NOT-SHIP-BEF-DTE-PO.   59520005
521200     MOVE TR004-CANCEL-DATE           TO TR020-CANCEL-DATE-PO.    59530005
521300     MOVE TR004-OPEN-TO-BUY-PERIOD                                59540005
521400                               TO TR020-OPEN-TO-BUY-PERIOD-PO.    59550005
521500     MOVE TR004-PKGNG-CDE             TO TR020-PKGNG-CDE-PO.      59560005
521600     MOVE TR004-PO-TYP-CDE            TO TR020-PO-TYP-CDE-PO.     59570005
521700     MOVE TR004-AD-DATE               TO TR020-AD-DATE-PO.        59580005
521800     MOVE PC-CURRENT-PROGRAM-NAME     TO TR020-PGM-NAME.          59590005
521900                                                                  59600005
522000     MOVE TR020-REC-TYPE-PO        TO OUTTR4-TRGL-DTL-RPT-1-ODR.  59610005
522100                                                                  59620005
522200     PERFORM 8880-INSERT-DETAIL.                                  59630005
522300                                                                  59640005
522400******************************************************************59650005
522500* WRITE INSTURCTIONS RECORD TYPE FOR DETAIL REPORT RECORD.       *59660005
522600******************************************************************59670005
522700 8852-WRITE-DTL-RPT-INS-RECORD.                                   59680005
522800                                                                  59690005
522900     MOVE '20INS'                     TO TR020-REC-TYPE-CDE-INS.  59700005
523000     SET TR020-REXMIT-RPT-INS         TO TRUE.                    59710005
523100     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-INS.        59720005
523200     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-INS.  59730005
523300     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-INS.     59740005
523400     MOVE TR004-SPEC-INSTR            TO TR020-SPEC-INSTR-INS.    59750005
523500                                                                  59760005
523600     MOVE TR020-REC-TYPE-INS-1  TO OUTTR4-TRGL-DTL-RPT-1-ODR.     59770005
523700     MOVE TR020-REC-TYPE-INS-2  TO OUTTR4-TRGL-DTL-RPT-2-ODR.     59780005
523800                                                                  59790005
523900     PERFORM 8880-INSERT-DETAIL.                                  59800005
524000                                                                  59810005
524100******************************************************************59820005
524200* WRITE PURCHASE ORDER UPC RECORD TYPE FOR DETAIL REPORT RECORD. *59830005
524300******************************************************************59840005
524400 8854-WRITE-DTL-RPT-UPC-RECORD.                                   59850005
524500                                                                  59860005
524600     MOVE '60UPC'                     TO TR020-REC-TYPE-CDE-UPC.  59870005
524700     SET TR020-REXMIT-RPT-UPC         TO TRUE.                    59880005
524800     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-UPC.        59890005
524900     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-UPC.  59900005
525000     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-UPC.     59910005
525100                                                                  59920005
525200     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           59930005
525300         MOVE TR020-PACK-ID-PCK       TO TR020-PACK-ID-UPC        59940005
525400     ELSE                                                         59950005
525500         MOVE ZEROS                   TO TR020-PACK-ID-UPC        59960005
525600     END-IF.                                                      59970005
525700     MOVE TR004-VEND-STYL-NAME        TO TR020-VEND-STYL-NAME-UPC.59980005
525800     MOVE TR004-UPC-COLOR-CDE         TO TR020-COLOR-CDE-UPC.     59990005
525900     MOVE TR004-UPC-SIZE-DESC         TO TR020-SIZE-DESC-UPC.     60000005
526000     MOVE TR004-UPC-NBR               TO TR020-UPC-NBR-UPC.       60010005
526100     MOVE TR004-UPC-COLOR-DESC        TO TR020-COLOR-DESC-UPC.    60020005
526200     MOVE TR004-SKU-DESC              TO TR020-SKU-DESC-UPC.      60030005
526300     MOVE TR004-DEPT-NBR              TO TR020-DEPT-NBR-UPC.      60040005
526400     MOVE TR004-CLASS                 TO TR020-CLASS-UPC.         60050005
526500     MOVE TR004-SUB-CLASS             TO TR020-SUB-CLASS-UPC.     60060005
526600     MOVE TR004-SKU-SEQ-NBR           TO TR020-SKU-UPC.           60070005
526700     MOVE TR004-OUTR-PK-QTY           TO TR020-OUTR-PK-QTY-UPC.   60080005
526800     MOVE TR004-PACK-RATIO-QTY        TO TR020-PACK-RATIO-QTY-UPC.60090005
526900     MOVE TR004-UPC-UNIT-QTY          TO TR020-UNIT-QTY-UPC.      60100005
527000     MOVE PC-NA                       TO TR020-ASN-PKGNG-CDE-UPC. 60110005
527100                                                                  60120005
527200     MOVE TR020-REC-TYPE-UPC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.    60130005
527300                                                                  60140005
527400     PERFORM 8880-INSERT-DETAIL.                                  60150005
527500                                                                  60160005
527600                                                                  60170005
527700******************************************************************60180005
527800* WRITE CONTAINER/VESSEL RECORD TYPE FOR DETAIL REPORT RECORD.   *60190005
527900******************************************************************60200005
528000 8856-WRITE-DTL-RPT-CON-RECORD.                                   60210005
528100                                                                  60220005
528200     SET TR020-REC-TYPE-CDE-CON-CONTNR   TO TRUE.                 60230005
528300     SET TR020-REXMIT-RPT-CONTNR         TO TRUE.                 60240005
528400     MOVE PV-HOLD-TR020-PROCESS-DATE                              60250005
528500                                   TO TR020-PROCESS-DATE-CONTNR.  60260005
528600     MOVE TR004-CART-PER-PO        TO TR020-EXP-CART-CT-CONTNR.   60270005
528700     MOVE PV-HOLD-TR020-CONTNR-ID  TO TR020-CONTNR-ID-CONTNR.     60280005
528800     MOVE PV-HOLD-TR020-PO-NBR     TO TR020-PO-NBR-CONTNR.        60290005
528900                                                                  60300005
529000     MOVE TR020-REC-TYPE-CONTNR    TO OUTTR4-TRGL-DTL-RPT-1-ODR.  60310005
529100                                                                  60320005
529200     PERFORM 8880-INSERT-DETAIL.                                  60330005
529300                                                                  60340005
529400******************************************************************60350005
529500 8870-WRITE-DTL-RPT-DC-RECORD.                                    60360005
529600                                                                  60370005
529700     MOVE '70DC '                  TO TR020-REC-TYPE-CDE-DC.      60380005
529800     SET  TR020-REXMIT-RPT-DC      TO TRUE.                       60390005
529900     MOVE PV-HOLD-TR020-PROCESS-DATE                              60400005
530000                                   TO TR020-PROCESS-DATE-DC.      60410005
530100     MOVE TR020-PO-NBR-UPC         TO TR020-PO-NBR-DC.            60420005
530200     MOVE TR020-CONTNR-ID-UPC      TO TR020-CONTNR-ID-DC.         60430005
530300     MOVE TR020-PACK-ID-UPC        TO TR020-PACK-ID-DC.           60440005
530400     MOVE TR020-VEND-STYL-NAME-UPC TO TR020-VEND-STYL-NAME-DC.    60450005
530500     MOVE TR020-COLOR-CDE-UPC      TO TR020-COLOR-CDE-DC.         60460005
530600     MOVE TR020-SIZE-DESC-UPC      TO TR020-SIZE-DESC-DC.         60470005
530700     MOVE TR004-DIST-CNTR          TO TR020-DIST-CNTR-DC.         60480005
530800**** **********  UPC NUMBER FOR FUTURE USE  ************          60490005
530900**** MOVE TR020-UPC-NBR-UPC        TO TR020-UPC-NBR-DC.           60500005
531000     MOVE TR004-DC-UNIT-QTY        TO TR020-UNIT-QTY-DC.          60510005
531100     MOVE TR004-DC-PERCNT          TO TR020-PERCNT-DC.            60520005
531200     MOVE TR004-DC-CART-CT         TO TR020-CART-CT-DC.           60530005
531300                                                                  60540005
531400     MOVE TR020-REC-TYPE-DC     TO OUTTR4-TRGL-DTL-RPT-1-ODR.     60550005
531500                                                                  60560005
531600     PERFORM 8880-INSERT-DETAIL.                                  60570005
531700                                                                  60580005
531800******************************************************************60590005
531900 8880-INSERT-DETAIL.                                              60600005
532000                                                                  60610005
532100     EXEC SQL                                                     60620005
532200         INSERT INTO TOUTTR4                                      60630005
532300             (TRGL_DTL_RPT_1_ODR                                  60640005
532400             ,TRGL_DTL_RPT_2_ODR)                                 60650005
532500            VALUES  (:OUTTR4-TRGL-DTL-RPT-1-ODR                   60660005
532600                    ,:OUTTR4-TRGL-DTL-RPT-2-ODR)                  60670005
532700     END-EXEC                                                     60680005
532800                                                                  60690005
532900     EVALUATE TRUE                                                60700005
533000         WHEN SQLWARN0 NOT EQUAL SPACE                            60710005
533100         WHEN SQLCODE NOT EQUAL ZERO                              60720005
533200             DISPLAY '** ABEND **'                                60730005
533300             DISPLAY '** PROGRAM = TRKUP006 **'                   60740005
533400             DISPLAY '** PARAGRAPH = 8880-INSERT-DETAIL*'         60750005
533500             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR4**'         60760005
533600             PERFORM 9100-SQL-ABEND                               60770022
533700     END-EVALUATE.                                                60780005
533800                                                                  60790005
533900     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    60800005
534000                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   60810005
534100 EJECT                                                            60820005
534200                                                                  60830005
534300******************************************************************60840005
534400 8900-CHK-TRAN-SAME-AS-RETAN.                                     60850005
534500                                                                  60860005
534600*    ***** ONLY NEED TO SELECT RULE ONCE PER CONTAINER  *****     60870005
534700     IF SHIPMT-PRO-NBR = PV-HOLD-PRO-NBR                          60880005
534800        IF PV-DCNSL-SCAC = SPACES                                 60890005
534900          SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                  60900005
535000        END-IF                                                    60910005
535100     ELSE                                                         60920005
535200        MOVE SHIPMT-PRO-NBR  TO PV-HOLD-PRO-NBR                   60930005
535300                                                                  60940005
535400*       *** 1ST LOOK FOR A CONTAINER ADJUSTMENT ***               60950005
535500        MOVE 'ADJ'    TO TRT00014-RUL-TYP-CDE                     60960005
535600        PERFORM 8910-SELECT-DCP-RULE-CONT                         60970005
535700                                                                  60980005
535800*       *** IF NO CONTAINER - LOOK FOR A VESSEL ADJUSTMENT ***    60990005
535900        IF PV-DCNSL-SCAC = SPACES                                 61000005
536000           PERFORM 8920-SELECT-DCP-RULE-VSL                       61010005
536100        END-IF                                                    61020005
536200                                                                  61030005
536300*       *** IF NEITHER - GET THE CONTAINER DEFAULT ***            61040005
536400        IF PV-DCNSL-SCAC = SPACES                                 61050005
536500           MOVE 'DEF'    TO TRT00014-RUL-TYP-CDE                  61060005
536600           PERFORM 8910-SELECT-DCP-RULE-CONT                      61070005
536700        END-IF                                                    61080005
536800                                                                  61090005
536900        IF PV-DCNSL-SCAC = SPACES                                 61100005
537000           DISPLAY '#### NO RULE FOUND FOR THIS CONTAINER'        61110005
537100           DISPLAY '#### CONT ID  = ' SHIPMT-PRO-NBR              61120005
537200           DISPLAY '#### ETA      = ' VHTRIP-EST-AR-TMST          61130005
537300           DISPLAY '#### PO NBR   = ' SHPTPO-PO-NBR               61140005
537400*          *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN     61150005
537500           SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                 61160005
537600        END-IF                                                    61170005
537700                                                                  61180005
537800     END-IF.                                                      61190005
537900                                                                  61200005
538000     IF PS-RETRAN-MATCH-TRAN-ENTID                                61210005
538100       CONTINUE                                                   61220005
538200     ELSE                                                         61230005
538300       PERFORM 8930-ENTID-COMPARE-PROCESS                         61240005
538400     END-IF.                                                      61250005
538500                                                                  61260005
538600******************************************************************61270005
538700 8910-SELECT-DCP-RULE-CONT.                                       61280005
538800                                                                  61290005
538900     MOVE SPACES TO       PV-DCNSL-SCAC                           61300005
539000                          TRT00015-RUL-CNSTR-VAL-TXT.             61310005
539100                                                                  61320005
539200     EXEC SQL                                                     61330005
539300         SELECT DISTINCT                                          61340005
539400                A.RUL_CNSTR_VAL_TXT                               61350005
539500         INTO   :TRT00015-RUL-CNSTR-VAL-TXT                       61360005
539600         FROM   TRT_RUL_CNSTR A                                   61370005
539700               ,TRT_RUL_CNSTR B                                   61380005
539800               ,TRT_RUL_CNSTR C                                   61390005
539900               ,TRT_RUL       D                                   61400005
540000         WHERE  A.RUL_ID            = B.RUL_ID                    61410005
540100           AND  A.RUL_ID            = C.RUL_ID                    61420005
540200           AND  A.RUL_ID            = D.RUL_ID                    61430005
540300           AND  A.RUL_CNSTR_TYP_CDE = 'DECN'                      61440005
540400           AND  B.RUL_CNSTR_TYP_CDE = 'CONT'                      61450005
540500           AND  B.RUL_CNSTR_VAL_TXT = :SHIPMT-PRO-NBR             61460005
540600           AND  C.RUL_CNSTR_TYP_CDE = 'ETA'                       61470005
540700           AND  SUBSTR(C.RUL_CNSTR_VAL_TXT,1,10)                  61480005
540800                     = SUBSTR(:VHTRIP-EST-AR-TMST,1,10)           61490005
540900           AND  D.RUL_TYP_CDE       = :TRT00014-RUL-TYP-CDE       61500005
541000           AND  D.RUL_CDE           = 'CONT'                      61510005
541100     END-EXEC                                                     61520005
541200                                                                  61530005
541300     EVALUATE TRUE                                                61540005
541400                                                                  61550005
541500         WHEN SQLCODE = ZERO                                      61560005
541600             MOVE TRT00015-RUL-CNSTR-VAL-TXT  TO PV-DCNSL-SCAC    61570005
541700                                                                  61580005
541800         WHEN SQLCODE = +100                                      61590005
541900         WHEN SQLCODE = -811                                      61600005
542000             CONTINUE                                             61610005
542100                                                                  61620005
542200         WHEN SQLWARN0 NOT = SPACES                               61630005
542300         WHEN SQLCODE < ZERO                                      61640005
542400         WHEN SQLCODE > ZERO                                      61650005
542500             DISPLAY '** ABEND **'                                61660005
542600             DISPLAY '** SQLCODE = ' SQLCODE                      61670005
542700             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      61680005
542800             DISPLAY '** PARAGRAPH = 8910-SELECT-DCP-RULE-CONT'   61690005
542900             DISPLAY '** CONT ID  = ' SHIPMT-PRO-NBR              61700005
543000             DISPLAY '** PO NBR   = ' SHPTPO-PO-NBR               61710005
543100             PERFORM 9100-SQL-ABEND                               61720022
543200     END-EVALUATE.                                                61730005
543300*                                                                 61740005
543400******************************************************************61750005
543500 8920-SELECT-DCP-RULE-VSL.                                        61760005
543600                                                                  61770005
543700     MOVE SPACES TO       PV-DCNSL-SCAC                           61780005
543800                          TRT00015-RUL-CNSTR-VAL-TXT.             61790005
543900                                                                  61800005
544000     EXEC SQL                                                     61810005
544100         SELECT DISTINCT                                          61820005
544200                VSLA.RUL_CNSTR_VAL_TXT                            61830005
544300         INTO   :TRT00015-RUL-CNSTR-VAL-TXT                       61840005
544400         FROM   TRT_RUL_CNSTR VSLA                                61850005
544500               ,TRT_RUL_CNSTR VSLB                                61860005
544600               ,TRT_RUL_CNSTR VSLC                                61870005
544700               ,TRT_RUL       VSLD                                61880005
544800         WHERE  VSLA.RUL_ID            = VSLB.RUL_ID              61890005
544900           AND  VSLA.RUL_ID            = VSLC.RUL_ID              61900005
545000           AND  VSLA.RUL_ID            = VSLD.RUL_ID              61910005
545100           AND  VSLA.RUL_CNSTR_TYP_CDE = 'DECN'                   61920005
545200           AND  VSLB.RUL_CNSTR_TYP_CDE = 'VSL'                    61930005
545300           AND  VSLD.RUL_TYP_CDE       = 'ADJ'                    61940005
545400           AND  VSLD.RUL_CDE           = 'VSL'                    61950005
545500           AND  VSLB.RUL_CNSTR_VAL_TXT =                          61960005
545600               (SELECT   A.RUL_CNSTR_VAL_TXT                      61970005
545700                  FROM   TRT_RUL_CNSTR A                          61980005
545800                        ,TRT_RUL_CNSTR B                          61990005
545900                        ,TRT_RUL_CNSTR C                          62000005
546000                        ,TRT_RUL       D                          62010005
546100                  WHERE  A.RUL_ID            = B.RUL_ID           62020005
546200                    AND  A.RUL_ID            = C.RUL_ID           62030005
546300                    AND  A.RUL_ID            = D.RUL_ID           62040005
546400                    AND  A.RUL_CNSTR_TYP_CDE = 'VSL'              62050005
546500                    AND  A.RUL_CNSTR_VAL_TXT =                    62060005
546600                                           VSLB.RUL_CNSTR_VAL_TXT 62070005
546700                    AND  B.RUL_CNSTR_TYP_CDE = 'CONT'             62080005
546800                    AND  B.RUL_CNSTR_VAL_TXT = :SHIPMT-PRO-NBR    62090005
546900                    AND  C.RUL_CNSTR_TYP_CDE = 'ETA'              62100005
547000                    AND  SUBSTR(C.RUL_CNSTR_VAL_TXT,1,10)         62110005
547100                                = SUBSTR(:VHTRIP-EST-AR-TMST,1,10)62120005
547200                    AND  D.RUL_TYP_CDE       = 'DEF'              62130005
547300                    AND  D.RUL_CDE           = 'CONT'             62140005
547400                    AND  D.RUL_BEG_DTE  = VSLD.RUL_BEG_DTE        62150005
547500                    AND  D.RUL_END_DTE  = VSLD.RUL_END_DTE        62160005
547600                )                                                 62170005
547700     END-EXEC                                                     62180005
547800                                                                  62190005
547900     EVALUATE TRUE                                                62200005
548000                                                                  62210005
548100         WHEN SQLCODE = ZERO                                      62220005
548200             MOVE TRT00015-RUL-CNSTR-VAL-TXT  TO PV-DCNSL-SCAC    62230005
548300                                                                  62240005
548400         WHEN SQLCODE = +100                                      62250005
548500         WHEN SQLCODE = -811                                      62260005
548600             CONTINUE                                             62270005
548700                                                                  62280005
548800         WHEN SQLWARN0 NOT = SPACES                               62290005
548900         WHEN SQLCODE < ZERO                                      62300005
549000         WHEN SQLCODE > ZERO                                      62310005
549100             DISPLAY '** ABEND **'                                62320005
549200             DISPLAY '** SQLCODE = ' SQLCODE                      62330005
549300             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      62340005
549400             DISPLAY '** PARAGRAPH = 8920-SELECT-DCP-RULE-VSL'    62350005
549500             DISPLAY '** CONT ID  = ' SHIPMT-PRO-NBR              62360005
549600             DISPLAY '** PO NBR   = ' SHPTPO-PO-NBR               62370005
549700             PERFORM 9100-SQL-ABEND                               62380022
549800     END-EVALUATE.                                                62390005
549900*                                                                 62400005
550000                                                                  62410005
550100******************************************************************62420005
550200 8930-ENTID-COMPARE-PROCESS.                                      62430005
550300                                                                  62440005
550400     PERFORM 8940-SELECT-ENTITY-ID.                               62450005
550500     IF PV-ENT-ID = ZERO                                          62460005
550501       DISPLAY '#### RULE SCAC NOT ON TEXTENT TABLE'              62470005
550502       DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC                   62480005
550503       DISPLAY '#### CONT ID  = ' SHIPMT-PRO-NBR                  62490005
550504       DISPLAY '#### PO NBR   = ' SHPTPO-PO-NBR                   62500005
550505*      *** NO ENTID TO MATCH UP TO SO LET IT GO AS RETRAN         62510005
550506       SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                     62520005
550507     ELSE                                                         62530005
550508       IF IMPORL-DCONSLR-ENT-ID = PV-ENT-ID                       62540005
550509         SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                   62550005
550510       END-IF                                                     62560005
550520     END-IF.                                                      62570005
550530                                                                  62580005
550540*    **************************************************           62590005
550550*    * THE ENTIDS MAY NOT MATCH BUT IT MAY STILL BE   *           62600005
550560*    * THE SAME DECONSOLIDATOR I.E. GALE TRIANGLE AND *           62610005
550570*    * EAST HAVE DIF ENTIDS.  LOOK ON A TABLE TO SEE  *           62620005
550580*    * IF THIS IS THE CASE.                           *           62630005
550590*    **************************************************           62640005
550600     IF PS-RETRAN-MATCH-TRAN-ENTID                                62650005
550700       CONTINUE                                                   62660005
550800     ELSE                                                         62670005
550900*        *****************************                            62680005
551000*        * LOOK UP RE-TRANSMIT ENTID *                            62690005
551100*        *****************************                            62700005
551200         SET PS-ENTID-FOUND-NO         TO TRUE                    62710005
551300         SET PS-END-OF-ENTID-TABLE-NO  TO TRUE                    62720005
551400         MOVE PV-ENT-ID   TO PV-SEARCH-ENT-ID                     62730005
551500         SET DECNO-IND                 TO 1                       62740005
551600         PERFORM 8950-SEARCH-ENTITY-TABLE                         62750005
551700           UNTIL PS-END-OF-ENTID-TABLE                            62760005
551800            OR  PS-ENTID-FOUND                                    62770005
551900         IF PS-ENTID-FOUND                                        62780005
552000           MOVE PV-TBL-DECON-ENT-NAME (DECNO-IND)                 62790005
552100                                    TO PV-HOLD-ENT-NAME           62800005
552200         ELSE                                                     62810005
552300           DISPLAY '#### RULE ENTID NOT ON DCONSLR.CONTROL'       62820005
552400           DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC               62830005
552500           DISPLAY '#### CONT ID  = ' SHIPMT-PRO-NBR              62840005
552600           DISPLAY '#### PO NBR   = ' SHPTPO-PO-NBR               62850005
552700*          *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN     62860005
552800           SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                 62870005
552900         END-IF                                                   62880005
553000     END-IF.                                                      62890005
553100                                                                  62900005
553200*    ***********************************                          62910005
553300*    * LOOK UP ORIGINAL TRANSMIT ENTID *                          62920005
553400*    ***********************************                          62930005
553500     IF PS-RETRAN-MATCH-TRAN-ENTID                                62940005
553600       CONTINUE                                                   62950005
553700     ELSE                                                         62960005
553800       SET PS-ENTID-FOUND-NO         TO TRUE                      62970005
553900       SET PS-END-OF-ENTID-TABLE-NO  TO TRUE                      62980005
554000       SET DECNO-IND                 TO 1                         62990005
554100       MOVE IMPORL-DCONSLR-ENT-ID  TO PV-SEARCH-ENT-ID            63000005
554200       PERFORM 8950-SEARCH-ENTITY-TABLE                           63010005
554300         UNTIL PS-END-OF-ENTID-TABLE                              63020005
554400          OR  PS-ENTID-FOUND                                      63030005
554500       IF PS-ENTID-FOUND                                          63040005
554600         CONTINUE                                                 63050005
554700       ELSE                                                       63060005
554800           DISPLAY '#### TIMPORL ENTID NOT ON DCONSLR.CONTROL'    63070005
554900           DISPLAY '#### SCAC     = ' PV-DCNSL-SCAC               63080005
555000           DISPLAY '#### CONT ID  = ' SHIPMT-PRO-NBR              63090005
555100           DISPLAY '#### PO NBR   = ' SHPTPO-PO-NBR               63100005
555200*          *** NO DECON TO MATCH UP TO SO LET IT GO AS RETRAN     63110005
555300           SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                 63120005
555400       END-IF                                                     63130005
555500     END-IF.                                                      63140005
555600                                                                  63150005
555700     IF PS-RETRAN-MATCH-TRAN-ENTID                                63160005
555800       CONTINUE                                                   63170005
555900     ELSE                                                         63180005
556000       IF PV-TBL-DECON-ENT-NAME (DECNO-IND) = PV-HOLD-ENT-NAME    63190005
556100         SET PS-RETRAN-MATCH-TRAN-ENTID TO TRUE                   63200005
556200       END-IF                                                     63210005
556300     END-IF.                                                      63220005
556400                                                                  63230005
556500******************************************************************63240005
556600* SELECT DECON ENTID FOR THE CONTAINER OR VESSEL DECON SCAC      *63250005
556700******************************************************************63260005
556800 8940-SELECT-ENTITY-ID.                                           63270005
556900                                                                  63280005
557000     EXEC SQL                                                     63290005
557100        SELECT ENT_ID                                             63300005
557200        INTO  :EXTENT-ENT-ID                                      63310005
557300        FROM   TEXTENT                                            63320005
557400        WHERE  SCAC_CDE = :PV-DCNSL-SCAC                          63330005
557500     END-EXEC                                                     63340005
557600                                                                  63350005
557700     EVALUATE TRUE                                                63360005
557800         WHEN SQLCODE = ZERO                                      63370005
557900             MOVE EXTENT-ENT-ID TO PV-ENT-ID                      63380005
558000         WHEN SQLCODE = +100                                      63390005
558100         WHEN SQLCODE = -811                                      63400005
558200             MOVE ZEROES        TO PV-ENT-ID                      63410005
558300         WHEN SQLWARN0 NOT EQUAL SPACE                            63420005
558400         WHEN SQLCODE NOT EQUAL ZERO                              63430005
558500             DISPLAY '** ABEND **'                                63440005
558600             DISPLAY '** SQLCODE = ' SQLCODE                      63450005
558700             DISPLAY '** PROGRAM = ' PC-CURRENT-PROGRAM-NAME      63460005
558800             DISPLAY '** PARAGRAPH = 8940-SELECT-ENTITY-ID'       63470005
558900             DISPLAY '** CONT ID  = ' SHIPMT-PRO-NBR              63480005
559000             DISPLAY '** PO NBR   = ' SHPTPO-PO-NBR               63490005
559100             DISPLAY '** DCNSL SCAC ' PV-DCNSL-SCAC               63500005
559200             PERFORM 9100-SQL-ABEND                               63510022
559300     END-EVALUATE.                                                63520005
559400                                                                  63530005
559500******************************************************************63540005
559600* LOOK UP A DESCRIPTION USING THE DECON ENTID.                    63550005
559700******************************************************************63560005
559800 8950-SEARCH-ENTITY-TABLE.                                        63570005
559900                                                                  63580005
560000     SEARCH PV-DECONSOL-NO-TABLE-ENTRIES                          63590005
560100                                                                  63600005
560200         WHEN PV-TBL-DECON-ENT-ID(DECNO-IND) = PV-SEARCH-ENT-ID   63610005
560300            SET PS-ENTID-FOUND TO TRUE                            63620005
560400                                                                  63630005
560500         WHEN PV-TBL-DECON-ENT-ID(DECNO-IND)                      63640005
560600                                   = ZEROS OR LOW-VALUES          63650005
560700            SET PS-END-OF-ENTID-TABLE TO TRUE                     63660005
560800                                                                  63670005
560900         WHEN DECNO-IND = PC-DECONSOL-TBL-LIMIT                   63680005
561000            SET PS-END-OF-ENTID-TABLE TO TRUE                     63690005
561100                                                                  63700005
561200     END-SEARCH.                                                  63710005
561300                                                                  63720005
139868******************************************************************63730038
139868 9000-OUTLET-STORE-PREPACK.                                       63740038
139868                                                                  63750038
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     63760038
155029     PERFORM 7835-RETRIEVE-PLAN-NBR.                              63770074
155029                                                                  63780074
155029     PERFORM 2521-SUM-SPLIT-QTY.                                  63790074
155029                                                                  63800074
139868     PERFORM 9110-OPEN-PRPACK-DC-STR-CSR.                         63810038
139868                                                                  63820038
139868     PERFORM 9200-PROCESS-STORE-PRPK-CSR                          63830038
139868       UNTIL PS-EOC-STORE-CURSOR.                                 63840038
139868                                                                  63850038
139868     PERFORM 9120-CLOSE-PRPACK-DC-STR-CSR.                        63860038
139868                                                                  63870038
139868******************************************************************63880038
139868 9102-OUTLET-STORE-DC.                                            63890038
139868                                                                  63900038
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     63910038
155029     PERFORM 7830-RETRIEVE-PLAN-NBR.                              63920074
139868     PERFORM 9105-OPEN-DC-STORE-CSR.                              63930038
139868                                                                  63940038
139868     PERFORM 9300-PROCESS-STORE-DC-CURSOR                         63950038
139868       UNTIL PS-EOC-STORE-CURSOR.                                 63960038
139868                                                                  63970038
139868     PERFORM 9115-CLOSE-DC-STORE-CSR.                             63980038
139868                                                                  63990038
139868******************************************************************64000038
139868 9105-OPEN-DC-STORE-CSR.                                          64010038
139868                                                                  64020038
139868     EXEC SQL                                                     64030038
139868          OPEN DC_OUT_CUR                                         64040038
139868     END-EXEC.                                                    64050038
139868                                                                  64060038
139868     EVALUATE TRUE                                                64070038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64080038
139868         WHEN SQLCODE NOT EQUAL ZERO                              64090038
139868             DISPLAY '** ABEND **'                                64100038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   64110038
139868             DISPLAY '** PARAGRAPH = 9105-OPEN-DC-STORE-CSR **'   64120038
139868             DISPLAY '**PO_NBR     = '  PURITM-PO-NBR             64130038
155029             DISPLAY '**PLAN_NBR   = '  ALLPLN-PLAN-NBR           64140074
139868             DISPLAY '**PO_LNE_NBR = '  PURITM-PO-LNE-NBR         64150038
139868             PERFORM 9100-SQL-ABEND                               64160038
139868     END-EVALUATE.                                                64170038
139868                                                                  64180038
139868******************************************************************64190038
139868 9110-OPEN-PRPACK-DC-STR-CSR.                                     64200038
139868                                                                  64210038
139868     EXEC SQL                                                     64220038
139868          OPEN PRPACK_DC_OUT_CUR                                  64230038
139868     END-EXEC.                                                    64240038
139868                                                                  64250038
139868     EVALUATE TRUE                                                64260038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64270038
139868         WHEN SQLCODE NOT EQUAL ZERO                              64280038
139868             DISPLAY '** ABEND **'                                64290038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   64300038
139868             DISPLAY '** PARAGRAPH = 9110-OPEN-PRPACK-DC-STR-CSR' 64310038
139868             DISPLAY 'PO-NBR       = ' PURCHS-PO-NBR              64320038
139868             DISPLAY 'PO-PREPK-ID  = ' POPRPK-PO-PREPK-ID         64330038
155029             DISPLAY 'PLAN-NBR     = ' ALLPLN-PLAN-NBR            64340074
139868             PERFORM 9100-SQL-ABEND                               64350038
139868     END-EVALUATE.                                                64360038
139868                                                                  64370038
139868******************************************************************64380038
139868 9115-CLOSE-DC-STORE-CSR.                                         64390038
139868                                                                  64400038
139868     EXEC SQL                                                     64410038
139868         CLOSE DC_OUT_CUR                                         64420038
139868     END-EXEC.                                                    64430038
139868                                                                  64440038
139868     EVALUATE TRUE                                                64450038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64460038
139868         WHEN SQLCODE NOT EQUAL ZERO                              64470038
139868             DISPLAY '** ABEND **'                                64480038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   64490038
139868             DISPLAY '** PARAGRAPH = 9115-CLOSE-DC-STORE-CSR**'   64500038
139868             PERFORM 9100-SQL-ABEND                               64510038
139868     END-EVALUATE.                                                64520038
139868                                                                  64530038
139868******************************************************************64540038
139868 9120-CLOSE-PRPACK-DC-STR-CSR.                                    64550038
139868                                                                  64560038
139868     EXEC SQL                                                     64570038
139868         CLOSE PRPACK_DC_OUT_CUR                                  64580038
139868     END-EXEC.                                                    64590038
139868                                                                  64600038
139868     EVALUATE TRUE                                                64610038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64620038
139868         WHEN SQLCODE NOT EQUAL ZERO                              64630038
139868             DISPLAY '** ABEND **'                                64640038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   64650038
139868             DISPLAY '** PARAGRAPH = 9120-CLOSE-PRPACK-DC-STR-CSR'64660038
139868             PERFORM 9100-SQL-ABEND                               64670038
139868     END-EVALUATE.                                                64680038
139868                                                                  64690038
139868******************************************************************64700038
139868 9130-FETCH-DC-STORE-CSR.                                         64710038
139868                                                                  64720038
139868     EXEC SQL                                                     64730038
139868          FETCH DC_OUT_CUR                                        64740038
139868           INTO :MESTDS-STR-NBR                                   64750038
139868               ,:MESTDS-STR-DISTRO-QTY                            64760038
139868     END-EXEC.                                                    64770038
139868                                                                  64780038
139868     EVALUATE TRUE                                                64790038
139868         WHEN SQLCODE = ZERO                                      64800038
139868             CONTINUE                                             64810038
139868                                                                  64820038
139868         WHEN SQLCODE = +100                                      64830038
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    64840038
139868             IF PS-FIRST-STORE                                    64850038
139868                SET PS-EOC-DC-CURSOR                              64860038
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          64870038
139868                PERFORM 8600-CLOSE-DC-CURSOR                      64880038
139868                INITIALIZE TR006-UPC-NBR                          64890038
139868                           TR006-ERROR-MSG                        64900038
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          64910038
139868                STRING 'CON-BULK MISSING SPLT-FIX/OUTLET'         64920047
139868                    DELIMITED BY SIZE                             64930038
139868                     INTO TR006-ERROR-MSG                         64940038
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               64950038
139868                PERFORM 8830-WRITE-ERROR-LINE                     64960038
139868                SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE           64970038
139868             END-IF                                               64980038
139868                                                                  64990038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65000038
139868         WHEN SQLCODE NOT EQUAL ZERO                              65010038
139868             DISPLAY '** ABEND **'                                65020038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   65030038
139868             DISPLAY '** PARAGRAPH = 9130-FETCH-DC-STORE-CSR**'   65040038
139868             DISPLAY '**PO_NBR     = '  PURITM-PO-NBR             65050038
139868             DISPLAY '**PO_LNE_NBR = '  PURITM-PO-LNE-NBR         65060038
155029             DISPLAY '**PLAN_NBR   = '  ALLPLN-PLAN-NBR           65070074
139868             PERFORM 9100-SQL-ABEND                               65080038
139868     END-EVALUATE.                                                65090038
139868                                                                  65100038
139868******************************************************************65110038
139868 9140-FETCH-PRPACK-DC-STR-CSR.                                    65120038
139868                                                                  65130038
139868     EXEC SQL                                                     65140038
139868          FETCH PRPACK_DC_OUT_CUR                                 65150038
139868           INTO :MESTDS-STR-NBR                                   65160038
139868               ,:MESTDS-STR-DISTRO-QTY                            65170038
139868     END-EXEC.                                                    65180038
139868                                                                  65190038
139868     EVALUATE TRUE                                                65200038
139868         WHEN SQLCODE = ZERO                                      65210038
139868             CONTINUE                                             65220038
139868                                                                  65230038
139868         WHEN SQLCODE = +100                                      65240038
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    65250038
139868             IF PS-FIRST-STORE                                    65260038
141519**              SET PS-EOC-DC-CURSOR                              65270044
141519                SET PS-EOC-PREPACK-DC-CURSOR                      65280044
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          65290038
139868                PERFORM 8425-CLOSE-PACK-DC-CURSOR                 65300038
139868                INITIALIZE TR006-UPC-NBR                          65310038
139868                           TR006-ERROR-MSG                        65320038
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          65330038
139868                STRING 'CON-PACK MISSING SPLT-FIX/OUTLET'         65340047
139868                    DELIMITED BY SIZE                             65350038
139868                     INTO TR006-ERROR-MSG                         65360038
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               65370038
139868                PERFORM 8830-WRITE-ERROR-LINE                     65380038
139868                SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE           65390038
139868             END-IF                                               65400038
139868                                                                  65410038
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65420038
139868         WHEN SQLCODE NOT EQUAL ZERO                              65430038
139868             DISPLAY '** ABEND **'                                65440038
139868             DISPLAY '** PROGRAM = TRKUP006 **'                   65450038
139868             DISPLAY '** PARAGRAPH = 9140-FETCH-PRPACK-DC-STR-CSR'65460038
139868             DISPLAY 'PO-NBR       = ' PURCHS-PO-NBR              65470038
139868             DISPLAY 'PO-PREPK-ID  = ' POPRPK-PO-PREPK-ID         65480038
155029             DISPLAY 'PLAN-NBR     = ' ALLPLN-PLAN-NBR            65490074
139868             PERFORM 9100-SQL-ABEND                               65500038
139868     END-EVALUATE.                                                65510038
139868                                                                  65520038
139868******************************************************************65530038
139868 9200-PROCESS-STORE-PRPK-CSR.                                     65540038
139868                                                                  65550038
139868     PERFORM 9140-FETCH-PRPACK-DC-STR-CSR.                        65560038
139868                                                                  65570038
139868     IF PS-EOC-STORE-CURSOR                                       65580038
139868         IF PS-DC-SPLIT-INFO-PRESENT                              65590038
155029            SET PS-OUTLET-STORE-NO TO TRUE                        65600074
139868            PERFORM 2387-ADJUST-ROUNDED-OUT-DIST                  65610038
139868            PERFORM 5756-WRITE-PDC-REC                            65620038
139868         END-IF                                                   65630038
139868     ELSE                                                         65640038
139868         IF PS-FIRST-STORE                                        65650038
139868           SET PS-FIRST-STORE-NO   TO TRUE                        65660038
155029           SET PS-FIRST-DC-NO        TO TRUE                      65670074
139868                                                                  65680038
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          65690038
139868                      PV-TTL-ALL-DCS-UNITS                        65700038
139868                      PV-TTL-ALL-DCS-CARTS                        65710038
139868         ELSE                                                     65720038
139868*            **********************************************       65730038
139868*            * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *       65740038
139868*            * FROM THE PRIOR STORE                       *       65750038
139868*            **********************************************       65760038
139868             PERFORM 5756-WRITE-PDC-REC                           65770038
139868         END-IF                                                   65780038
139868                                                                  65790038
139868         INITIALIZE TR004-REC-TYPE-PDC                            65800038
139868         MOVE MESTDS-STR-NBR TO TR004-PDC-DIST-CNTR               65810038
139868                                                                  65820038
139868         MOVE MESTDS-STR-DISTRO-QTY  TO TR004-PDC-UNIT-QTY        65830038
139868                                                                  65840041
155029         IF PV-FAST-E-BUS-IND = 'Y'                               65850074
155029            DIVIDE PA-TOTAL-CURR-SPLIT-QTY                        65860074
155029              INTO MESTDS-STR-DISTRO-QTY                          65870074
155029                GIVING PV-QUOTIENT-ORDER-PERCENT                  65880074
155029         ELSE                                                     65890074
140332            DIVIDE PV-HOLD-PCK-UNIT-QTY                           65900048
140332              INTO MESTDS-STR-DISTRO-QTY                          65910048
140332                GIVING PV-QUOTIENT-ORDER-PERCENT                  65920048
155029         END-IF                                                   65930074
140332         MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                    65940042
140332              100 GIVING TR004-PDC-PERCNT ROUNDED                 65950042
139868                                                                  65960038
139868         IF TR004-PDC-PERCNT = ZERO                               65970038
139868            MOVE +1 TO TR004-PDC-PERCNT                           65980038
139868         END-IF                                                   65990038
139868                                                                  66000038
139868         ADD TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT        66010038
139868                                                                  66020038
139868         DIVIDE PV-HOLD-PCK-UNIT-PER-CTN                          66030038
139868           INTO MESTDS-STR-DISTRO-QTY                             66040038
139868              GIVING TR004-PDC-CART-CT ROUNDED                    66050038
139868                                                                  66060038
139868     END-IF.                                                      66070038
139868                                                                  66080038
139868******************************************************************66090038
139868 9300-PROCESS-STORE-DC-CURSOR.                                    66100038
139868                                                                  66110038
139868     PERFORM 9130-FETCH-DC-STORE-CSR.                             66120038
139868                                                                  66130038
139868     IF PS-EOC-STORE-CURSOR                                       66140038
139868        IF PS-DC-SPLIT-INFO-PRESENT                               66150038
155029          SET PS-OUTLET-STORE-NO TO TRUE                          66160074
139868          PERFORM 2515-ADJUST-ROUNDED-DC-DIST                     66170038
139868          PERFORM 5700-WRITE-DC-RECORD                            66180038
139868        END-IF                                                    66190038
139868     ELSE                                                         66200038
139868        IF PS-FIRST-STORE                                         66210038
139868          SET PS-FIRST-STORE-NO   TO TRUE                         66220038
155029          SET PS-FIRST-DC-NO      TO TRUE                         66230074
139868          INITIALIZE PV-TTL-ALL-DCS-PCT                           66240038
139868                     PV-TTL-ALL-DCS-UNITS                         66250038
139868                     PV-TTL-ALL-DCS-CARTS                         66260038
139868                                                                  66270038
139868        ELSE                                                      66280038
139868*           **********************************************        66290038
139868*           * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *        66300038
139868*           * FROM THE PRIOR STORE                       *        66310038
139868*           **********************************************        66320038
139868            PERFORM 5700-WRITE-DC-RECORD                          66330038
139868        END-IF                                                    66340038
139868                                                                  66350038
139868        INITIALIZE TR004-REC-TYPE-DC                              66360038
139868        MOVE MESTDS-STR-NBR        TO TR004-DIST-CNTR             66370038
139868        MOVE MESTDS-STR-DISTRO-QTY TO TR004-DC-UNIT-QTY           66380038
139868                                                                  66390038
155029        IF PV-FAST-E-BUS-IND = 'Y'                                66400074
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         66410074
155029             INTO MESTDS-STR-DISTRO-QTY                           66420074
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   66430074
155029        ELSE                                                      66440074
139868           DIVIDE PV-HOLD-PCK-UNIT-QTY                            66450048
139868             INTO MESTDS-STR-DISTRO-QTY                           66460048
139868               GIVING PV-QUOTIENT-ORDER-PERCENT                   66470048
155029        END-IF                                                    66480074
139868        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     66490038
139868            100 GIVING TR004-DC-PERCNT ROUNDED                    66500038
139868                                                                  66510038
139868        PERFORM 2512-DC-OUT-CALCULATIONS                          66520038
139868                                                                  66530038
139868     END-IF.                                                      66540038
139868                                                                  66550038
561400******************************************************************66560005
561500* END OF JOB ROUTINE.                                             66570005
561600******************************************************************66580005
561700 9000-EOJ-ROUTINE.                                                66590022
561800                                                                  66600005
561900     IF PA-TOTAL-OUTPUT-REC-COUNT = ZERO                          66610005
562000         CONTINUE                                                 66620005
562100     ELSE                                                         66630005
562200         INITIALIZE TR004-REC-TYPE-CTT                            66640005
562300         MOVE PA-TOTAL-OUTPUT-REC-COUNT TO                        66650005
562400             TR004-HASH-TOTALS                                    66660005
562500         PERFORM 5800-WRITE-CTT-REC                               66670005
562600         ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT                      66680005
562700     END-IF                                                       66690005
562800                                                                  66700005
562900     DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                       66710005
563000         PA-TOTAL-OUTPUT-REC-COUNT.                               66720005
563100     DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT.                  66730005
563200                                                                  66740005
563300     PERFORM 7010-CLOSE-DRIVER-CURSOR.                            66750005
563400                                                                  66760005
563500     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              66770005
563600     PERFORM 6570-UPDATE-TCKRSTCNTL.                              66780005
563700                                                                  66790005
563800******************************************************************66800005
563900* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      66810022
564000* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 66820005
564100******************************************************************66830005
564200 9100-SQL-ABEND.                                                  66840022
564300******************************************************************66850005
564400* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    66860005
564500* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         66870005
564600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     66880005
564700* FORMAT.                                                         66890005
564800******************************************************************66900005
564900*    COPY DPPD004.                                                66910005
565000     COPY DPPD004.                                                66920005
565100                                                                  66930005
565200     MOVE +4013 TO ABEND-CODE.                                    66940005
565300     CALL 'ILBOABN0' USING ABEND-CODE.                            66950005
