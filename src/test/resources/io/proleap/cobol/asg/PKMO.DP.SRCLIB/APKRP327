000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP327.                                         00020000
000300 AUTHOR.        NANCY EILBES.                                     00030000
000400 DATE-WRITTEN.  MAY 2016.                                         00040000
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060000
000700*     REPORT OF RECYCLE 210 INVOICES                             *00070000
000800*----------------------------------------------------------------*00080000
000900*    COBOL 390                                                   *00090000
001000*----------------------------------------------------------------*00100000
001100*  PURPOSE:  TO CREATE A REPORT OF EDI 210 INVOICES BEING        *00110000
001200*  RECYCLED BECAUSE THE BROKER REFERENCE NUMBER AND /OR THE      *00120000
001210*  CUSTOMS ENTRY NUMBER COULD NOT BE VERIFIED FOR THE PO.        *00121000
001300*                                                                *00130000
001400*  INPUT:  RECYCLE REPORT RECORDS (APRD015)                      *00140000
001500*  OUTPUT: INVOICES IN RECYCLE STATUS REPORT                     *00150000
001600*----------------------------------------------------------------*00160000
001601* CHANGES:                                                       *00160100
001602*   06/07/2016                                                   *00160200
001603*      INITIAL VERSION.                                          *00160300
001605*        MADE BY: NANCY EILBES            WR/IR #: CHG0143455    *00160500
001606*                                                               * 00160609
001607* DATE  11/02/2020                                              * 00160709
001608*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK     * 00160809
001609*    APWS010.                                                   * 00160909
001610*    MADE BY: NANCY EILBES            WR/IR #: CHG0250510       * 00161009
001611*                                                                *00161100
007010*                                                               * 00161210
007020* DATE  05/10/2023                                              * 00161311
007030*    CHANGE MADE: RECOMPILED FOR CHANGES TO COPYBOOK APWS010    * 00161410
007050*    MADE BY: JEAN KURK               WR/IR #: CHG0288104       * 00161511
001617*----------------------------------------------------------------*00161700
001618 ENVIRONMENT DIVISION.                                            00161800
001619 CONFIGURATION SECTION.                                           00161900
001620 SOURCE-COMPUTER.        IBM-370.                                 00162000
001630 OBJECT-COMPUTER.        IBM-370.                                 00163000
001640                                                                  00164000
001650 INPUT-OUTPUT SECTION.                                            00165000
001660 FILE-CONTROL.                                                    00166000
001670     SELECT RECYCLE-RPT-FILE     ASSIGN TO INP01.                 00167000
001680     SELECT RECYCLE-REPORT       ASSIGN TO RPT01.                 00168000
001690                                                                  00169000
001700 DATA DIVISION.                                                   00170000
001800 FILE SECTION.                                                    00180000
001900                                                                  00190000
002000 FD  RECYCLE-RPT-FILE                                             00200000
002100     RECORDING MODE IS F                                          00210000
002200     LABEL RECORDS ARE STANDARD                                   00220000
002300     BLOCK CONTAINS 0 RECORDS                                     00230000
002400     RECORD CONTAINS 200 CHARACTERS                               00240000
002500     DATA RECORD IS RECYCLE-RPT-REC.                              00250000
002600                                                                  00260000
002700 01  RECYCLE-RPT-REC                    PIC X(200).               00270000
002800                                                                  00280000
002900 FD  RECYCLE-REPORT                                               00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     BLOCK CONTAINS 0 RECORDS                                     00320000
003300     RECORD CONTAINS 132 CHARACTERS                               00330000
003400     DATA RECORD IS RECYCLE-REPORT-REC.                           00340000
003500                                                                  00350000
003600 01  RECYCLE-REPORT-REC                 PIC X(132).               00360000
003700                                                                  00370000
003800                                                                  00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000                                                                  00400000
004100 01  PROGRAM-SWITCHES.                                            00410000
004200     05  PS-RECYCLE-RPT-EOF-SW          PIC X       VALUE 'N'.    00420000
004300         88 PS-RECYCLE-RPT-NOT-EOF                  VALUE 'N'.    00430000
004400         88 PS-RECYCLE-RPT-EOF                      VALUE 'Y'.    00440000
004500     05  PS-END-OF-TABLE-CHRG-SW        PIC X       VALUE 'N'.    00450000
004600         88 PS-NOT-END-OF-TABLE-CHRG                VALUE 'N'.    00460000
004700         88 PS-END-OF-TABLE-CHRG                    VALUE 'Y'.    00470000
004800     05  PS-RECYCLES-TO-RPT-SW          PIC X       VALUE 'Y'.    00480000
004900         88 NO-RECYCLES-TO-REPORT                   VALUE 'N'.    00490000
005000         88 RECYCLES-TO-REPORT                      VALUE 'Y'.    00500000
005100                                                                  00510000
005200 01  PROGRAM-VARIABLES.                                           00520000
005300     05  PV-RECYCLE-RPT-OUT             PIC 9(12)   VALUE 0.      00530000
005400     05  PV-COUNT-INPUT                 PIC 9(12)   VALUE 0.      00540000
005500     05  MAX-LINES                      PIC  S9(3)  COMP-3        00550000
005600                                                    VALUE +65.    00560000
005700     05  PAGE-COUNT                     PIC S9(9) COMP-3 VALUE +0.00570000
005800     05  LINE-COUNT                     PIC S9(3) COMP-3 VALUE +0.00580000
005900     05  PV-SYSTEM-DATE                 PIC X(08)  VALUE ZERO.    00590000
006000     05  FILLER REDEFINES PV-SYSTEM-DATE.                         00600000
006100         10  PV-SYSTEM-CCYY.                                      00610000
006200             15  PV-SYSTEM-CENTURY      PIC X(02).                00620000
006300             15  PV-SYSTEM-YEAR         PIC X(02).                00630000
006400         10  PV-SYSTEM-MONTH            PIC X(02).                00640000
006500         10  PV-SYSTEM-DAY              PIC X(02).                00650000
006600     05  PV-SYSTEM-TIME.                                          00660000
006700         10  PV-SYSTEM-HOUR             PIC 9(02) VALUE ZERO.     00670000
006800         10  PV-SYSTEM-MINUTE           PIC 9(02) VALUE ZERO.     00680000
006900         10  PV-SYSTEM-SECOND           PIC 9(02) VALUE ZERO.     00690000
007000         10  FILLER                     PIC 9(02) VALUE ZERO.     00700000
007100     05  PV-PROGRAM-NAME                PIC X(8) VALUE 'APKRP327'.00710000
007200     05  PV-HLD-VNDR-NBR                PIC 9(09) VALUE ZEROES.   00720000
007300     05  PV-HLD-INVC-NBR                PIC X(22) VALUE SPACES.   00730000
007400     05  SAVE-CHRG-CODE                 PIC X(03) VALUE SPACES.   00740000
007500     05  SAVE-CHRG-AMT                  PIC -------.99            00750000
007600                                                  VALUE ZEROES.   00760000
009500 01  WS-WORK-AREA.                                                00950000
009600     05  WS-VNDR-INVC-KEY.                                        00960000
009700         10  WS-VENDOR-NBR           PIC X(09)     VALUE SPACES.  00970000
009800         10  WS-INVOICE-NBR          PIC X(22)     VALUE SPACES.  00980000
010920                                                                  01092000
010930                                                                  01093000
010940*----------------------------------------------------------------*01094000
010950*           KOHLS STANDARD 132 CHARACTER REPORT HEADER           *01095000
010960*----------------------------------------------------------------*01096000
010970     COPY DPWS132O.                                               01097000
010980                                                                  01098000
010990 01  BLANK-LINE                PIC X(132) VALUE SPACES.           01099000
011000                                                                  01100000
011100 01  SAVE-DETAIL-LINE          PIC X(132) VALUE SPACES.           01110000
011200                                                                  01120000
011300 01  HDR-TITLE-1.                                                 01130000
011400     05  FILLER                  PIC  X(50)     VALUE SPACE.      01140000
011500     05  FILLER                  PIC  X(33)     VALUE             01150000
011600             'EDI210 INVOICES IN RECYCLE STATUS'.                 01160000
011700     05  FILLER                  PIC  X(49)     VALUE SPACE.      01170000
011800                                                                  01180000
011900 01  HEADER-1.                                                    01190000
012100     05  FILLER                PIC X(06) VALUE 'VENDOR'.          01210000
012200     05  FILLER                PIC X(10) VALUE SPACES.            01220000
012300     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01230000
012400     05  FILLER                PIC X(16) VALUE SPACES.            01240000
012410     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01241000
012420     05  FILLER                PIC X(10) VALUE SPACES.            01242000
012500     05  FILLER                PIC X(09) VALUE '  PO    '.        01250000
012600     05  FILLER                PIC X(06) VALUE SPACES.            01260000
012700     05  FILLER                PIC X(05) VALUE 'ENTRY'.           01270000
012800     05  FILLER                PIC X(15) VALUE SPACES.            01280000
012810     05  FILLER                PIC X(08) VALUE 'CUSTOMER'.        01281000
012820     05  FILLER                PIC X(06) VALUE SPACES.            01282000
012850     05  FILLER                PIC X(09) VALUE 'RECYCLE'.         01285000
012860     05  FILLER                PIC X(08) VALUE SPACES.            01286000
012870     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01287000
012880     05  FILLER                PIC X(08) VALUE SPACES.            01288000
013000                                                                  01300000
013100 01  HEADER-2.                                                    01310000
013300     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01330000
013400     05  FILLER                PIC X(10) VALUE SPACES.            01340000
013700     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01370000
013800     05  FILLER                PIC X(17) VALUE SPACES.            01380000
013810     05  FILLER                PIC X(04) VALUE 'DATE'.            01381000
013820     05  FILLER                PIC X(15) VALUE SPACES.            01382000
013900     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01390000
014000     05  FILLER                PIC X(07) VALUE SPACES.            01400000
014100     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01410000
014200     05  FILLER                PIC X(14) VALUE SPACES.            01420000
014300     05  FILLER                PIC X(09) VALUE 'REFERENCE'.       01430000
014400     05  FILLER                PIC X(08) VALUE SPACES.            01440000
014700     05  FILLER                PIC X(04) VALUE 'DAYS'.            01470000
014800     05  FILLER                PIC X(11) VALUE SPACES.            01480000
014900     05  FILLER                PIC X(06) VALUE 'AMOUNT'.          01490000
015000     05  FILLER                PIC X(12) VALUE SPACES.            01500000
015300                                                                  01530000
015400 01  DETAIL-1.                                                    01540000
015500     05  DTL-VENDOR-ID         PIC X(10) VALUE SPACES.            01550000
015600     05  FILLER                PIC X(06) VALUE SPACES.            01560000
015900     05  DTL-INVOIC-NBR        PIC X(22) VALUE SPACES.            01590000
016000     05  FILLER                PIC X(01) VALUE SPACES.            01600000
016010     05  DTL-INVOICE-DTE       PIC X(10) VALUE SPACES.            01601000
016020     05  FILLER                PIC X(09) VALUE SPACES.            01602000
016100     05  DTL-PO-NBR            PIC X(09) VALUE SPACES.            01610000
016200     05  FILLER                PIC X(04) VALUE SPACES.            01620000
016300     05  DTL-ENTRY-NBR         PIC X(15) VALUE ZEROES.            01630000
016400     05  FILLER                PIC X(05) VALUE SPACES.            01640000
016500     05  DTL-CUST-REFERENCE    PIC X(15) VALUE ZEROES.            01650000
016600     05  FILLER                PIC X(04) VALUE SPACES.            01660000
016900     05  DTL-RECYCLE-DAYS      PIC 9(02) VALUE ZEROES.            01690000
017000     05  FILLER                PIC X(05) VALUE SPACES.            01700000
017100     05  DTL-INVOICE-AMT       PIC Z(8)9.99  VALUE ZEROES.        01710000
017200     05  FILLER                PIC X(08) VALUE SPACES.            01720000
017500                                                                  01750000
017600 01  END-OF-REPORT.                                               01760000
017700     05  FILLER                PIC X(51) VALUE SPACES.            01770000
017800     05  FILLER                PIC X(29) VALUE                    01780000
017900        '- - - - END OF REPORT - - - -'.                          01790000
018000     05  FILLER                PIC X(42) VALUE SPACES.            01800000
018100                                                                  01810000
018200 01  NO-DATA-TO-REPORT.                                           01820000
018300     05  FILLER                PIC X(63) VALUE SPACES.            01830000
018400     05  FILLER                PIC X(23) VALUE                    01840000
018500        '-  NO DATA TO REPORT  -'.                                01850000
018600     05  FILLER                PIC X(42) VALUE SPACES.            01860000
018700 EJECT                                                            01870000
018800                                                                  01880000
018900*--------------------------------------------------------------*  01890000
019000*  APWS010 RECORD LAYOUT FOR ERROR MESSAGE REPORTING           *  01900000
019100*--------------------------------------------------------------*  01910000
019200 01  WS-EDIT-CODES.                                               01920000
019300     COPY APWS010.                                                01930000
019400                                                                  01940000
019500*--------------------------------------------------------------*  01950000
019600*  APRD015 RECORD LAYOUT FOR RECYCLE REVIEW TRANSACTIONS       *  01960000
019700*--------------------------------------------------------------*  01970000
019800     COPY APRD015.                                                01980000
019900                                                                  01990000
020000                                                                  02000000
020100 LINKAGE SECTION.                                                 02010000
020200 PROCEDURE DIVISION.                                              02020000
020300                                                                  02030000
020400 A100-MAINLINE-ROUTINE.                                           02040000
020500                                                                  02050000
020600     PERFORM B100-INITIALIZATION.                                 02060000
020700                                                                  02070000
020800     PERFORM B200-CREATE-RECYCLE-RPT                              02080000
020900       UNTIL PS-RECYCLE-RPT-EOF.                                  02090000
021000                                                                  02100000
021300     PERFORM B300-END-OF-JOB.                                     02130000
021400     GOBACK.                                                      02140000
021500                                                                  02150000
021600*--------------------------------------------------------------*  02160000
021700* B100-INITIALIZATION                                          *  02170000
021800*  OPEN FILES, PREPARE REPORT HEADERS AND PERFORM INITIAL READ *  02180000
021900*--------------------------------------------------------------*  02190000
022000 B100-INITIALIZATION.                                             02200000
022100                                                                  02210000
022200     DISPLAY '**--------------- APKRP327 --------------------**'. 02220000
022300     OPEN INPUT  RECYCLE-RPT-FILE                                 02230000
022400          OUTPUT RECYCLE-REPORT.                                  02240000
022500                                                                  02250000
022600     MOVE FUNCTION CURRENT-DATE TO PV-SYSTEM-DATE.                02260000
022700     MOVE PV-SYSTEM-MONTH        TO DP132O-RUN-MONTH.             02270000
022800     MOVE PV-SYSTEM-DAY          TO DP132O-RUN-DAY.               02280000
022900     MOVE PV-SYSTEM-YEAR         TO DP132O-RUN-YEAR.              02290000
023000     ACCEPT PV-SYSTEM-TIME FROM TIME.                             02300000
023100     MOVE PV-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02310000
023200     MOVE PV-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02320000
023300     MOVE PV-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          02330000
023400     MOVE '1'                    TO DP132O-REPORT-NUMBER.         02340000
023600     PERFORM W100-WRITE-HEADINGS.                                 02360000
023700                                                                  02370000
023800*  THIS READS THE FIRST RECORD OF THE INPUT FILE AND CHECKS TO SEE02380000
023900*  IF THERE ARE RECORDS TO PROCESS.                               02390000
024000     PERFORM R100-READ-INPUT.                                     02400000
024100                                                                  02410000
024200     IF PS-RECYCLE-RPT-EOF                                        02420000
024300        SET NO-RECYCLES-TO-REPORT TO TRUE                         02430000
024600     END-IF.                                                      02460000
024700                                                                  02470000
024800     MOVE AP015-VENDOR-NBR TO WS-VENDOR-NBR.                      02480000
024900     MOVE AP015-INVOICE-NBR TO WS-INVOICE-NBR.                    02490000
025000                                                                  02500000
025100*--------------------------------------------------------------*  02510000
025200* B200-CREATE-RECYCLE-RPT                                      *  02520000
025300*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR RECYCLE REVIEW        *  02530000
025400*  REPORTING.                                                  *  02540000
025500*--------------------------------------------------------------*  02550000
025600 B200-CREATE-RECYCLE-RPT.                                         02560000
025700                                                                  02570000
025800     IF AP015-VNDR-INVC-KEY NOT = WS-VNDR-INVC-KEY                02580000
026100        MOVE DETAIL-1 TO SAVE-DETAIL-LINE                         02610000
026200        PERFORM W200-WRITE-DETAIL                                 02620000
026300        MOVE SPACES TO DETAIL-1                                   02630000
026400        PERFORM W300-WRITE-BLANK-LINE                             02640000
026410        MOVE AP015-VENDOR-NBR TO WS-VENDOR-NBR                    02641000
026420        MOVE AP015-INVOICE-NBR TO WS-INVOICE-NBR                  02642000
026500*       MOVE AP015-VENDOR-NBR  TO DTL-VENDOR-ID                   02650000
026700*       MOVE AP015-INVOICE-NBR TO DTL-INVOIC-NBR                  02670000
026710*       MOVE AP015-PO-NBR       TO DTL-PO-NBR                     02671000
026720*       MOVE AP015-RECYCLE-DAYS TO DTL-RECYCLE-DAYS               02672000
026800*       PERFORM R100-READ-INPUT                                   02680000
026900     END-IF.                                                      02690000
026910                                                                  02691000
027000     IF AP015-210-INTRCHG-HDR                                     02700000
027100        MOVE AP015-VENDOR-NBR    TO DTL-VENDOR-ID                 02710000
027300        MOVE AP015-INVOICE-NBR   TO DTL-INVOIC-NBR                02730000
027310        MOVE AP015-PO-NBR        TO DTL-PO-NBR                    02731000
027320        MOVE AP015-RECYCLE-COUNT TO DTL-RECYCLE-DAYS              02732000
027400     END-IF.                                                      02740000
027900                                                                  02790000
028000     IF AP015-210-INVOICE-HDR                                     02800000
028100        MOVE AP015-INVC-DTE     TO DTL-INVOICE-DTE                02810000
028200        MOVE AP015-NET-INVC-AMT TO DTL-INVOICE-AMT                02820000
028400     END-IF.                                                      02840000
028500                                                                  02850000
028600     IF AP015-210-REF-ID                                          02860000
028610        EVALUATE TRUE                                             02861000
028620**      EVALUATE AP015-REF-ID-QUAL                                02862000
028700           WHEN AP015-ENTRY-NBR                                   02870000
028800                MOVE AP015-REFERENCE-ID-NBR TO DTL-CUST-REFERENCE 02880000
028900           WHEN AP015-CUSTOMER-REF                                02890000
028910                MOVE AP015-REFERENCE-ID-NBR TO DTL-ENTRY-NBR      02891000
029000        END-EVALUATE                                              02900000
029641     END-IF.                                                      02964100
029642                                                                  02964200
029643     PERFORM R100-READ-INPUT.                                     02964300
029644                                                                  02964400
029900*--------------------------------------------------------------*  02990000
030000* B300-END-OF-JOB                                              *  03000000
030100*  PRINT LAST DETAIL LINE, DISPLAY COUNTS, CLOSE FILES.        *  03010000
030200*--------------------------------------------------------------*  03020000
030300 B300-END-OF-JOB.                                                 03030000
030400                                                                  03040000
030410     IF  NO-RECYCLES-TO-REPORT                                    03041000
030411         DISPLAY ' NO REPORT RECORDS TO PROCESS '                 03041100
030412         WRITE RECYCLE-REPORT-REC FROM NO-DATA-TO-REPORT          03041200
030413             AFTER ADVANCING 1 LINE                               03041300
030414     ELSE                                                         03041400
030420         MOVE DETAIL-1 TO SAVE-DETAIL-LINE                        03042000
030430         PERFORM W200-WRITE-DETAIL                                03043000
030440         MOVE SPACES TO DETAIL-1                                  03044000
030450         PERFORM W300-WRITE-BLANK-LINE                            03045000
030451     END-IF.                                                      03045100
030460                                                                  03046000
030470     WRITE RECYCLE-REPORT-REC FROM END-OF-REPORT                  03047000
030480        AFTER ADVANCING 2 LINES.                                  03048000
030490                                                                  03049000
030500     DISPLAY '*************************************'.             03050000
030700     DISPLAY 'EDI IMPORT INVOICE COUNT  ' PV-COUNT-INPUT.         03070000
030800     DISPLAY 'RECYCLE RECORDS WRITTEN  '  PV-RECYCLE-RPT-OUT.     03080000
031000     DISPLAY '*************************************'.             03100000
031100                                                                  03110000
031200     CLOSE RECYCLE-RPT-FILE                                       03120000
031300           RECYCLE-REPORT.                                        03130000
031400                                                                  03140000
031500*--------------------------------------------------------------*  03150000
031600* R100-READ-INPUT                                              *  03160000
031700*  READS A RECORD IN A FILE.                                   *  03170000
031800*--------------------------------------------------------------*  03180000
031900 R100-READ-INPUT.                                                 03190000
032000                                                                  03200000
032100      INITIALIZE AP015-EDI-IMPORT-INVOICE.                        03210000
032200      READ RECYCLE-RPT-FILE INTO AP015-EDI-IMPORT-INVOICE         03220000
032300          AT END                                                  03230000
032400              SET PS-RECYCLE-RPT-EOF TO TRUE                      03240000
032500      END-READ.                                                   03250000
032600                                                                  03260000
032700      IF PS-RECYCLE-RPT-NOT-EOF                                   03270000
032800         ADD 1 TO PV-COUNT-INPUT                                  03280000
032900      END-IF.                                                     03290000
033000                                                                  03300000
033100                                                                  03310000
033200                                                                  03320000
033300*--------------------------------------------------------------*  03330000
033400* W100-WRITE-HEADINGS                                          *  03340000
033500*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                   *  03350000
033600*--------------------------------------------------------------*  03360000
033700 W100-WRITE-HEADINGS.                                             03370000
033800                                                                  03380000
033900     ADD 1 TO PAGE-COUNT.                                         03390000
034000     MOVE PAGE-COUNT TO DP132O-PAGE-NUMBER.                       03400000
034100     WRITE RECYCLE-REPORT-REC                                     03410000
034200       FROM DP132O-STANDRD-HEADER-132-COLS AFTER ADVANCING PAGE.  03420000
034300     WRITE RECYCLE-REPORT-REC FROM HDR-TITLE-1                    03430000
034400         AFTER ADVANCING 1 LINE.                                  03440000
034500     WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                     03450000
034600         AFTER ADVANCING 1 LINE.                                  03460000
034700     WRITE RECYCLE-REPORT-REC FROM HEADER-1                       03470000
034800         AFTER ADVANCING 2 LINES.                                 03480000
034900     WRITE RECYCLE-REPORT-REC FROM HEADER-2                       03490000
035000         AFTER ADVANCING 1 LINE.                                  03500000
035100     WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                     03510000
035200         AFTER ADVANCING 1 LINE.                                  03520000
035300     MOVE +7            TO LINE-COUNT.                            03530000
035400                                                                  03540000
035500*--------------------------------------------------------------*  03550000
035600* W200-WRITE-DETAIL                                            *  03560000
035700*  THIS ROUTINE WRITES THE DETAIL LINES.                       *  03570000
035800*--------------------------------------------------------------*  03580000
035900 W200-WRITE-DETAIL.                                               03590000
036000                                                                  03600000
036100     IF LINE-COUNT >= MAX-LINES                                   03610000
036200        PERFORM W100-WRITE-HEADINGS                               03620000
036300        MOVE SAVE-DETAIL-LINE TO DETAIL-1                         03630000
036400     END-IF.                                                      03640000
036500                                                                  03650000
036600     WRITE RECYCLE-REPORT-REC FROM DETAIL-1                       03660000
036700         AFTER ADVANCING 1 LINE.                                  03670000
036800                                                                  03680000
036900     ADD 1 TO LINE-COUNT                                          03690000
037000              PV-RECYCLE-RPT-OUT.                                 03700000
037100                                                                  03710000
037200*--------------------------------------------------------------*  03720000
037300* W300-WRITE-BLANK-LINE                                        *  03730000
037400*--------------------------------------------------------------*  03740000
037500 W300-WRITE-BLANK-LINE.                                           03750000
037600                                                                  03760000
037700     IF LINE-COUNT >= MAX-LINES                                   03770000
037800        CONTINUE                                                  03780000
037900     ELSE                                                         03790000
038000        WRITE RECYCLE-REPORT-REC FROM BLANK-LINE                  03800000
038100        ADD 1 TO LINE-COUNT                                       03810000
038200     END-IF.                                                      03820000
038300                                                                  03830000
038400                                                                  03840000
