      ******************************************************************02/21/96
       IDENTIFICATION DIVISION.                                                 
      ******************************************************************   LV034
       PROGRAM-ID.    TFKCS420.                                                 
       AUTHOR.        PAUL KEBER - STRATAGEM.                                   
       INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
       DATE-WRITTEN.  09/11/96.                                            CL**3
       DATE-COMPILED.                                                           
      ******************************************************************        
      * PROGRAM NUMBER: TFKCS420       SYSTEM: TF     LANGUAGE: COBOL II        
      *                                                                         
      * TRANID:  P420       MNEMONIC:  TFSINQ        MAP: TFKM420               
      *                                                                         
      * PROGRAM NAME : TRANSFER INQUIRY CRITERIA SPECIFICATION                  
      *                                                                         
      * ORIGINAL WORK REQUEST #: 3780                                           
      *                                                                         
      * PROGRAM OBJECTIVE:                                                      
      *                                                                         
      *   TO DISPLAY THE TRANSFER INQUIRY CRITERIA SPECIFICATION SCREEN         
      *   AND PASS INFORMATION TO THE NEXT PROGRAM, ACCORDING TO THE            
      *   FUNCTION KEY SELECTED.                                                
      *                                                                         
      * DATASETS USED:                                                          
      *  DATASET                             COPY USED  I/O  VSAM?  DB?         
      * --------------------------------    ----------- ---- -----  ---         
      *  TRANSFER TABLE                      TTFMSTR     I     N    DB2    CL*11
      *  TRANSFER TYPE TABLE                 TTFTYCD     I     N    DB2    CL*11
      *  TRANSFER STATUS TABLE               TTFSTAT    I/O    N    DB2    CL*11
      *  TRANSFER STATUS CODE TABLE          TTFSTCD     I     N    DB2    CL*11
100404*  STORE TABLE                         XST_LOC     I     N    DB2    CL*11
      *  SKU CROSS REFERENCE TABLE           TSKXREF     I     N    DB2    CL*11
      *                                                                         
      * PROGRAM NARRATIVE:                                                      
      *                                                                         
      *   THIS PROGRAM WILL ALLOW THE USER TO SPECIFY A SPECIFIC                
      *   TRANSFER NUMBER FOR A TRANSFER HEADER INQUIRY, FOR A TRANSFER         
      *   ITEM INQUIRY, TO VOID A TRANSFER, OR TO START A PROGRAM TO            
      *   RE-PRINT THE TRANSFER DOCUMENT.  THE PROGRAM CAN ALSO BE USED         
      *   TO SPECIFY VARIOUS TRANSFER INQUIRY CRITERIA COMBINATIONS FOR         
      *   THE TRANSFER INQUIRY LIST PROGRAM.                                    
      *                                                                         
      *****************************************************************         
      * CHANGES:                                                                
      *   DATE 03/27/97                                                         
      *   ADDED THE ABILITY TO DISPLAY VOIDED TRANSFERS. ALSO ADDED             
      *   OFFSITE STORAGE TRANSFERS. ALLOW DISPLAY TOTALS FOR ALL BUT           
      *   NON-RETAIL TRANSFERS.                                                 
      *   MADE BY: JACK KRAMER _________   WR/IR #: __________________          
      *****************************************************************         
      *   DATE 10/21/97                                                         
      *   REMOVE SELECTIVE LOGIC FOR OFFSITE STORAGE; ALLOW OFFSITE             
      *   STORAGE FOR ALL STORES.                                               
      *   MADE BY: JACK KRAMER _________   WR/IR #: __________________          
      *****************************************************************         
      *   DATE 08/30/01                                                         
      *   CHANGE FROM/TO STORE TO FROM/TO LOCATION ON SCREEN                    
      *   FORCE ENTRY OF FROM/TO LOCATION WHEN CRITLIST IS REQUESTED            
      *   FORCE ENTRY OF COMPLETE/RECEIVE DATE RANGE WHEN CRITLIST              
      *   IS REQUESTED                                                          
      *   RESTRICT BOTH DATE RANGES TO LESS THAN OR EQUAL TO 90 DAYS            
      *   INTO THE FUTURE, NOT INCLUDING CURRENT DATE                           
      *   MADE BY: RAY GRAF   22610_____   WR/IR #: __________________          
      *****************************************************************         
      *  1/20/2003 - RAY GRAF                                                   
      *   PROCESS NONINTELLIGENT SKU.                                           
      ******************************************************************        
111703* 11/17/2003 - RAY GRAF                                                   
111703*   MOS/RTV TRANSFER TYPES.                                               
111703*     REJECT MOS ITEMS FOR RTV DEF/DAM SORT 2 TRANSFER TYPE               
111703*     REJECT RTV ITEMS FOR MOS DEF/DAM SORT 1 TRANSFER TYPE               
111703*     REJECT DEPT 127 AND 427 FOR EITHER DEF/DAM TRANSFER TYPE            
111703*         WHEN THE 'TO' STORE IS 811 (FINDLAY)                            
      ******************************************************************        
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                                    
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT               
      *****************************************************************         
100404** 10/04/2004 CHANGED BY: RAY GRAF                                        
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                        
      *****************************************************************         
033111* WR39649 -  DAVID WELLER - 03/31/2011                                    
033111*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809             
033111*****************************************************************         
      * DATE:        09/24/2021                                                 
      * WR/IR#:      CHG0261678                                                 
      * PROGRAMMER:  GERMAN BANDA                                               
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                                 
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                           
      *              MAKING THE CALL DYNAMIC VS STATIC                          
      *----------------------------------------------------------------*        
CICS  * CHANGED 11/15/2022    BY JIM HUNTER      WR: CHG0278345                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
      * CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369                 
      * CHANGE CALL OF UPC CHECK DIGIT ROUTINE TO DYNAMIC                       
      *-----------------------------------------------------------------        
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       DATA DIVISION.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  DK-DB2-KEYS.                                                         
           05  DK-DEPT-NBR               PIC S9(04)  VALUE ZEROS                
                                                      COMP-3.                   
           05  DK-CLASS-NBR              PIC S9(04)  VALUE ZEROS                
                                                      COMP-3.                   
           05  DK-SUBCLASS-NBR           PIC S9(04)  VALUE ZEROS                
                                                      COMP-3.                   
                                                                                
      *                                                                         
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TF420A  '.    CL**2
           05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TFKM420 '.         
           05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TFKCS420'.         
           05  PC-CALLBACK-XFER          PIC  X(01)  VALUE  '2'.           CL*23
           05  PC-COMPLETE-STATUS        PIC  X(02)  VALUE  'CM'.          CL*23
           05  PC-VOID-STATUS            PIC  X(02)  VALUE  'VD'.          CL*23
           05  PC-ASSUMPTIVE-STATUS      PIC  X(02)  VALUE  'AR'.          CL*23
           05  PC-INTERMEDIATE-STATUS    PIC  X(02)  VALUE  'IR'.          CL*23
           05  PC-RECEIVED-STATUS        PIC  X(02)  VALUE  'PR'.          CL*23
           05  PC-RECEIVED-CHK-STATUS    PIC  X(02)  VALUE  'RC'.          CL*23
           05  PC-RECEIVED-NO-CHK-STATUS PIC  X(02)  VALUE  'RN'.          CL*23
           05  PC-COMPLETE-STATUS-DESC   PIC  X(08)  VALUE  'COMPLETE'.    CL*23
           05  PC-RECEIVED-STATUS-DESC   PIC  X(08)  VALUE  'RECEIVED'.    CL*23
           05  PC-DTL-CHCK-STATUS-DESC   PIC  X(20)  VALUE                 CL*23
                                         'RCVD - DETAIL CHECK'.            CL*23
           05  PC-NO-DTL-STATUS-DESC     PIC  X(20)  VALUE                 CL*23
                                         'RCVD - NO DETAIL CHK'.           CL*23
           05  PC-VOIDED-STATUS-DESC     PIC  X(06)  VALUE  'VOIDED'.      CL*23
           05  PC-OFFSITE-STORAGE        PIC  X(02)  VALUE  '07'.          CL*23
           05  PC-DEFECTS-XFER           PIC  X(01)  VALUE  '1'.           CL*23
           05  PC-LEAVE-SYSTEM-LENGTH    PIC S9(04)  VALUE  +160        00560012
                                                             COMP SYNC. 00570012
           05  PC-MAX-RETRIES            PIC S9(03)  VALUE  +3  COMP-3. APKCS323
           05  PC-MAX-TYPE-SCR-LINES     PIC S9(03)  VALUE  +18 COMP-3. APKCS323
           05  PC-MAX-TYPES              PIC S9(03)  VALUE  +9  COMP-3. APKCS323
           05  PC-STK-BAL-CORP-XFER      PIC  X(01)  VALUE  '3'.           CL*23
      *    05  PC-3-ZEROS                PIC  X(03)  VALUE  '000'.         CL*23
100404     05  PC-4-ZEROS                PIC  X(04)  VALUE  '0000'.        CL*23
           05  PC-6-ZEROS                PIC  X(06)  VALUE  '000000'.      CL*23
           05  PC-91-DAYS                PIC S9(02)  VALUE +91.                 
           05  PC-TSYMSG-NUMBERS.                                               
               10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.              
               10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.              
               10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.              
               10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.              
               10  PC-TSYMSG-00010       PIC  9(05)  VALUE  00010.              
               10  PC-TSYMSG-00017       PIC  9(05)  VALUE  00017.              
               10  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.              
               10  PC-TSYMSG-00051       PIC  9(05)  VALUE  00051.              
               10  PC-TSYMSG-00052       PIC  9(05)  VALUE  00052.              
               10  PC-TSYMSG-00053       PIC  9(05)  VALUE  00053.              
               10  PC-TSYMSG-00100       PIC  9(05)  VALUE  00100.              
               10  PC-TSYMSG-00110       PIC  9(05)  VALUE  00110.              
               10  PC-TSYMSG-00507       PIC  9(05)  VALUE  00507.              
               10  PC-TSYMSG-00691       PIC  9(05)  VALUE  00691.              
               10  PC-TSYMSG-01399       PIC  9(05)  VALUE  01399.              
               10  PC-TSYMSG-01400       PIC  9(05)  VALUE  01400.              
               10  PC-TSYMSG-01401       PIC  9(05)  VALUE  01401.              
               10  PC-TSYMSG-01402       PIC  9(05)  VALUE  01402.              
               10  PC-TSYMSG-01403       PIC  9(05)  VALUE  01403.              
               10  PC-TSYMSG-01404       PIC  9(05)  VALUE  01404.              
               10  PC-TSYMSG-01405       PIC  9(05)  VALUE  01405.              
               10  PC-TSYMSG-01406       PIC  9(05)  VALUE  01406.              
               10  PC-TSYMSG-01407       PIC  9(05)  VALUE  01407.              
               10  PC-TSYMSG-01408       PIC  9(05)  VALUE  01408.              
               10  PC-TSYMSG-01409       PIC  9(05)  VALUE  01409.              
               10  PC-TSYMSG-01410       PIC  9(05)  VALUE  01410.              
               10  PC-TSYMSG-01411       PIC  9(05)  VALUE  01411.              
               10  PC-TSYMSG-01412       PIC  9(05)  VALUE  01412.              
               10  PC-TSYMSG-01413       PIC  9(05)  VALUE  01413.              
TEMP           10  PC-TSYMSG-01479       PIC  9(05)  VALUE  01479.              
TEMP           10  PC-TSYMSG-01539       PIC  9(05)  VALUE  01539.              
               10  PC-TSYMSG-01554       PIC  9(05)  VALUE  01554.              
               10  PC-TSYMSG-01581       PIC  9(05)  VALUE  01581.              
               10  PC-TSYMSG-01583       PIC  9(05)  VALUE  01583.              
               10  PC-TSYMSG-01584       PIC  9(05)  VALUE  01584.              
               10  PC-TSYMSG-02787       PIC  9(05)  VALUE  02787.              
               10  PC-TSYMSG-02788       PIC  9(05)  VALUE  02788.              
               10  PC-TSYMSG-02789       PIC  9(05)  VALUE  02789.              
TEMP           10  PC-TSYMSG-03603       PIC  9(05)  VALUE  03603.              
                                                                                
      *                                                                         
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-ABEND-IND              PIC X(01)   VALUE 'N'.         00930012
               88  PS-NO-ABEND-IN-PROGRESS           VALUE 'N'.         00940012
               88  PS-ABEND-IN-PROGRESS              VALUE 'Y'.         00950012
           05  PS-BCOMP-DATE-ERROR-SW    PIC  X      VALUE  'N'.                
               88  PS-BCOMP-DATE-ERROR               VALUE  'Y'.                
               88  PS-NO-BCOMP-DATE-ERROR            VALUE  'N'.                
           05  PS-BRECV-DATE-ERROR-SW    PIC  X      VALUE  'N'.                
               88  PS-BRECV-DATE-ERROR               VALUE  'Y'.                
               88  PS-NO-BRECV-DATE-ERROR            VALUE  'N'.                
           05  PS-CRITLIST-INFO-CHG-IND  PIC X(01)   VALUE 'N'.         00930012
               88  PS-CRITLIST-INFO-NO-CHG           VALUE 'N'.         00940012
               88  PS-CRITLIST-INFO-CHG              VALUE 'Y'.         00950012
           05  PS-ECOMP-DATE-ERROR-SW    PIC  X      VALUE  'N'.                
               88  PS-ECOMP-DATE-ERROR               VALUE  'Y'.                
               88  PS-NO-ECOMP-DATE-ERROR            VALUE  'N'.                
           05  PS-ERECV-DATE-ERROR-SW    PIC  X      VALUE  'N'.                
               88  PS-ERECV-DATE-ERROR               VALUE  'Y'.                
               88  PS-NO-ERECV-DATE-ERROR            VALUE  'N'.                
           05  PS-ERROR-SW               PIC  X      VALUE  'N'.                
               88  PS-ERROR                          VALUE  'Y'.                
               88  PS-NO-ERROR                       VALUE  'N'.                
           05  PS-ITEMS-LEFT-ON-DB-SW    PIC  X      VALUE  'Y'.                
               88  PS-ITEMS-LEFT-ON-DB               VALUE  'Y'.                
               88  PS-NO-ITEMS-LEFT-ON-DB            VALUE  'N'.                
           05  PS-SORT-FIELD-ERROR-SW    PIC  X      VALUE 'N'.                 
               88  PS-SORT-FIELD-ERROR               VALUE 'Y'.                 
               88  PS-NO-SORT-FIELD-ERROR            VALUE 'N'.                 
               88  PS-DUPLICATE-SORT-NR              VALUE 'D'.                 
               88  PS-SORT-SEQ-ERROR                 VALUE 'S'.                 
           05  PS-TXFER-FOUND-IND        PIC X(01)   VALUE 'N'.         00930012
               88  PS-TXFER-NOT-FOUND                VALUE 'N'.         00940012
               88  PS-TXFER-FOUND                    VALUE 'Y'.         00950012
           05  PS-XFER-NBR-CHG-IND       PIC X(01)   VALUE 'N'.         00930012
               88  PS-XFER-NBR-NO-CHG                VALUE 'N'.         00940012
               88  PS-XFER-NBR-CHG                   VALUE 'Y'.         00950012
           05  PS-VALID-DEPT-CL-SW       PIC  X(01)  VALUE 'N'.                 
               88  PS-VALID-DEPT-CL                  VALUE 'Y'.                 
               88  PS-INVALID-DEPT-CL                VALUE 'N'.                 
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-DEPT-CL-COUNT        PIC S9(09)   VALUE +0  COMP.     APKCS323
           05  PV-DEPT-NMBR-COUNT      PIC S9(09)   VALUE +0  COMP.     APKCS323
           05  PV-CICS-RESP            PIC S9(04)   VALUE +0  COMP.             
           05  PV-READ-COUNT           PIC S9(04)   VALUE +0  COMP.     APKCS323
           05  PV-RETRY-COUNTER        PIC S9(04)   VALUE +0  COMP.     APKCS323
           05  PV-SORT-TBL-SUB         PIC S9(04)   VALUE +0  COMP.     01210012
           05  PV-BEG-DTE-DB2          PIC  X(10)   VALUE SPACES.               
           05  PV-END-DTE-DB2          PIC  X(10)   VALUE SPACES.               
           05  PV-MAX-SORT-SUB         PIC  9(01)   VALUE ZERO.         01210012
           05  PV-SORT-SUB             PIC  9(01)   VALUE ZERO.         01210012
           05  PV-USER-ID-8.                                            01390012
               10  PV-USER-ID          PIC  X(07)   VALUE SPACES.       01400012
               10  FILLER              PIC  X(01)   VALUE 'Q'.          01410012
           05  PV-XFER-STATUS-COUNT    PIC  9(01)   VALUE ZERO.         APKCS323
           05  PV-NULL-IND                     PIC S9(04)  VALUE ZEROS          
                                                           COMP SYNC.           
           05  PV-DISPLAY-XFER-DKEY-ID         PIC  9(09)  VALUE ZEROS.         
           05  PV-HOLD-DATE-PLUS-90DAYS    PIC  X(10).                          
           05  PV-HOLD-BEG-DTE.                                                 
               10  PV-HOLD-BEG-YR          PIC  X(04).                          
               10  FILLER                  PIC  X(01) VALUE '-'.                
               10  PV-HOLD-BEG-MM          PIC  X(02).                          
               10  FILLER                  PIC  X(01) VALUE '-'.                
               10  PV-HOLD-BEG-DD          PIC  X(02).                          
           05  PV-HOLD-END-DTE.                                                 
               10  PV-HOLD-END-YR          PIC  X(04).                          
               10  FILLER                  PIC  X(01) VALUE '-'.                
               10  PV-HOLD-END-MM          PIC  X(02).                          
               10  FILLER                  PIC  X(01) VALUE '-'.                
               10  PV-HOLD-END-DD          PIC  X(02).                          
           05  PV-HOLD-UPC-NBR.                                                 
               10  PV-KOHLS-UPC-DIGITS         PIC X(04).                       
               10  PV-KOHLS-DEPT               PIC X(03).                       
               10  PV-KOHLS-CL.                                                 
                   15  PV-KOHLS-CL-1           PIC X(01).                       
                   15  PV-KOHLS-CL-2           PIC X(01).                       
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                          
                                               PIC 9(02).                       
               10  PV-KOHLS-DUMMY-SKU          PIC X(03).                       
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).                       
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR                      
                                               PIC 9(13).                       
                                                                                
       01  SORT-ORDER-FIELDS-TBL        PIC 9(8)    VALUE ZEROES.       04      
       01  SORT-ORDER-FIELDS-TBL-REDEF REDEFINES SORT-ORDER-FIELDS-TBL. 04      
           05  SORT-ORDER-FIELD OCCURS 8 TIMES                                  
                                        PIC 9(01).                              
                                                                        04      
       01  TYPE-STATUS-FIELD.                                           04      
           05  TYPE-ST-FIELD-CODE      PIC X(1)     VALUE SPACE.        04      
           05  FILLER                  PIC X(1)     VALUE '-'.          04      
           05  TYPE-ST-FIELD-DESC      PIC X(20)    VALUE SPACES.       04      
                                                                                
      ******************************************************************        
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                              
      ******************************************************************        
080204     COPY RFWS009.                                                        
                                                                                
      ******************************************************************        
      *    MAP LAYOUT                                                  *        
      ******************************************************************        
           COPY TFKM420.                                                        
           EJECT                                                                
                                                                                
TEMP  ******************************************************************        
TEMP  *  LIST OF LOCATION EXCLUSIONS                                            
TEMP  ******************************************************************        
TEMP       COPY TFWS010.                                                        
                                                                                
      ******************************************************************        
      *  EXTENDED ATTRIBUTES COPYBOOK                                  *        
      ******************************************************************        
                                                                                
           COPY DPWS015.                                                        
                                                                                
      ******************************************************************        
      *  FUNCTION KEYS  COPYBOOK                                       *        
      ******************************************************************        
                                                                                
           COPY DPWS016.                                                        
                                                                                
      ******************************************************************        
      *    COPY BOOK FOR NUMERIC EDIT SUBROUTINE (DPKUT100) PARAMETER  *        
      *    LIST.                                                       *        
      ******************************************************************        
                                                                                
           COPY DPWS010I.                                                       
                                                                                
      ******************************************************************        
      *    COPY BOOK FOR CURRENT SYSTEM DATE/TIME PROCEDURE DIVISION   *        
      *    ROUTINE                                                              
      ******************************************************************        
                                                                                
           COPY DPWS017.                                                        
                                                                                
      ******************************************************************        
      *  DATE VALIDATION CALLING PARAMETER LIST                        *        
      ******************************************************************        
                                                                                
           COPY DPWS500.                                                        
                                                                                
111703******************************************************************        
111703*  UPC PARAMETER LIST FOR CALLING THE DUMMY UPC CHECK ROUTINE             
111703******************************************************************        
111703     COPY DPWS040I.                                                       
                                                                                
      ******************************************************************        
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **        
      ** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **        
      ******************************************************************        
           COPY DPWS030.                                                        
CICS       COPY DPWS930.                                                        
                                                                                
      *****************************************************************         
      *    STANDARD COMMAREA.                                                   
      *****************************************************************         
                                                                                
           COPY DPWS020.                                                        
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                        
                                                                                
      *****************************************************************         
      *    INTER-APPLICATION COMMAREA.                                          
      *****************************************************************         
                                                                                
               10  INTER-APPL-COMM-AREA PIC X(200).                             
                                                                                
           COPY TFWS001.                                                        
      *****************************************************************         
      *    SPECIFIC COMMMAREA FOR TFKCS420.                                     
      *****************************************************************         
               10  ASC-SPECIFIC-COMMAREA.                                       
                   15  ASC-XFER-NBR.                                            
      *                20 ASC-XFER-NBR-1-3         PIC  X(03).                  
      *                20 ASC-XFER-NBR-1-3-N REDEFINES                          
      *                        ASC-XFER-NBR-1-3    PIC  9(03).                  
100404                 20 ASC-XFER-NBR-1-4         PIC  X(04).                  
100404                 20 ASC-XFER-NBR-1-4-N REDEFINES                          
100404                         ASC-XFER-NBR-1-4    PIC  9(04).                  
      *                20 ASC-XFER-NBR-4-9         PIC  X(06).                  
      *                20 ASC-XFER-NBR-4-9-N REDEFINES                          
      *                        ASC-XFER-NBR-4-9    PIC  9(06).                  
100404                 20 ASC-XFER-NBR-5-10        PIC  X(06).                  
100404                 20 ASC-XFER-NBR-5-10-N REDEFINES                         
100404                         ASC-XFER-NBR-5-10   PIC  9(06).                  
                   15  ASC-XFER-TYPE               PIC  X(01).                  
                       88  ASC-VALID-DISP-TOTALS VALUES                         
111703                               '0' THRU '5', '7'.                         
                   15  ASC-XFER-TYPE-DESC          PIC  X(20).                  
                   15  ASC-XFER-STATUS             PIC  X(01).                  
                   15  ASC-XFER-STATUS-DESC        PIC  X(20).                  
      *            15  ASC-FROM-STORE              PIC  X(03).                  
      *            15  ASC-FROM-STORE-N REDEFINES                               
      *                    ASC-FROM-STORE          PIC  9(03).                  
100404             15  ASC-FROM-STORE              PIC  X(04).                  
100404             15  ASC-FROM-STORE-N REDEFINES                               
100404                     ASC-FROM-STORE          PIC  9(04).                  
      *            15  ASC-TO-STORE                PIC  X(03).                  
      *            15  ASC-TO-STORE-N REDEFINES                                 
      *                    ASC-TO-STORE            PIC  9(03).                  
100404             15  ASC-TO-STORE                PIC  X(04).                  
                   15  ASC-TO-STORE-N REDEFINES                                 
100404                     ASC-TO-STORE            PIC  9(04).                  
                   15  ASC-COMP-BEG-DTE            PIC  X(08).             CL**9
                   15  ASC-COMP-BEG-DTE-RDF REDEFINES                      CL*26
                           ASC-COMP-BEG-DTE.                               CL*26
                       20  ASC-COMP-BEG-MM         PIC  X(02).             CL*26
                       20  ASC-COMP-BEG-MM-N REDEFINES                     CL*26
                               ASC-COMP-BEG-MM     PIC  9(02).             CL*26
                       20  ASC-COMP-BEG-DD         PIC  X(02).             CL*26
                       20  ASC-COMP-BEG-DD-N REDEFINES                     CL*26
                               ASC-COMP-BEG-DD     PIC  9(02).             CL*26
                       20  ASC-COMP-BEG-YR         PIC  X(04).             CL*26
                       20  ASC-COMP-BEG-YR-N REDEFINES                     CL*26
                               ASC-COMP-BEG-YR     PIC  9(04).             CL*26
                   15  ASC-COMP-END-DTE            PIC  X(08).             CL**9
                   15  ASC-COMP-END-DTE-RDF REDEFINES                      CL*26
                           ASC-COMP-END-DTE.                               CL*26
                       20  ASC-COMP-END-MM         PIC  X(02).             CL*26
                       20  ASC-COMP-END-MM-N REDEFINES                     CL*26
                               ASC-COMP-END-MM     PIC  9(02).             CL*26
                       20  ASC-COMP-END-DD         PIC  X(02).             CL*26
                       20  ASC-COMP-END-DD-N REDEFINES                     CL*26
                               ASC-COMP-END-DD     PIC  9(02).             CL*26
                       20  ASC-COMP-END-YR         PIC  X(04).             CL*26
                       20  ASC-COMP-END-YR-N REDEFINES                     CL*26
                               ASC-COMP-END-YR     PIC  9(04).             CL*26
                   15  ASC-RECV-BEG-DTE            PIC  X(08).             CL**9
                   15  ASC-RECV-BEG-DTE-RDF REDEFINES                      CL*26
                           ASC-RECV-BEG-DTE.                               CL*26
                       20  ASC-RECV-BEG-MM         PIC  X(02).             CL*26
                       20  ASC-RECV-BEG-MM-N REDEFINES                     CL*26
                               ASC-RECV-BEG-MM     PIC  9(02).             CL*26
                       20  ASC-RECV-BEG-DD         PIC  X(02).             CL*26
                       20  ASC-RECV-BEG-DD-N REDEFINES                     CL*26
                               ASC-RECV-BEG-DD     PIC  9(02).             CL*26
                       20  ASC-RECV-BEG-YR         PIC  X(04).             CL*26
                       20  ASC-RECV-BEG-YR-N REDEFINES                     CL*26
                               ASC-RECV-BEG-YR     PIC  9(04).             CL*26
                   15  ASC-RECV-END-DTE            PIC  X(08).             CL**9
                   15  ASC-RECV-END-DTE-RDF REDEFINES                      CL*26
                           ASC-RECV-END-DTE.                               CL*26
                       20  ASC-RECV-END-MM         PIC  X(02).             CL*26
                       20  ASC-RECV-END-MM-N REDEFINES                     CL*26
                               ASC-RECV-END-MM     PIC  9(02).             CL*26
                       20  ASC-RECV-END-DD         PIC  X(02).             CL*26
                       20  ASC-RECV-END-DD-N REDEFINES                     CL*26
                               ASC-RECV-END-DD     PIC  9(02).             CL*26
                       20  ASC-RECV-END-YR         PIC  X(04).             CL*26
                       20  ASC-RECV-END-YR-N REDEFINES                     CL*26
                               ASC-RECV-END-YR     PIC  9(04).             CL*26
                   15  ASC-DEPT-NBR                PIC  X(03).                  
                   15  ASC-DEPT-NBR-N REDEFINES                                 
                           ASC-DEPT-NBR            PIC  9(03).                  
                   15  ASC-CLASS-NBR               PIC  X(03).                  
                   15  ASC-CLASS-NBR-N REDEFINES                                
                           ASC-CLASS-NBR           PIC  9(03).                  
                   15  ASC-SUBCL-NBR               PIC  X(03).                  
                   15  ASC-SUBCL-NBR-N REDEFINES                                
                           ASC-SUBCL-NBR           PIC  9(03).                  
                   15  ASC-UPC-NBR                 PIC  X(13).                  
                   15  ASC-UPC-NBR-N REDEFINES                                  
                           ASC-UPC-NBR             PIC  9(13).                  
                   15  ASC-CALLBACK-NBR            PIC  X(04).                  
                   15  ASC-CALLBACK-NBR-N REDEFINES                             
                           ASC-CALLBACK-NBR        PIC  9(04).                  
                   15  ASC-APPROVAL-NBR            PIC  X(09).                  
                   15  ASC-APPROVAL-NBR-N REDEFINES                             
                           ASC-APPROVAL-NBR        PIC  9(09).                  
                   15  ASC-COMP-BY-FIRST-INIT      PIC  X(01).                  
                   15  ASC-COMP-BY-LAST-NAME       PIC  X(20).                  
                   15  ASC-RECV-BY-FIRST-INIT      PIC  X(01).                  
                   15  ASC-RECV-BY-LAST-NAME       PIC  X(20).                  
                   15  ASC-DISPLAY-TOTALS          PIC  X(01).                  
                   15  ASC-XFER-DKEY-ID            PIC  S9(09) COMP.            
                   15  ASC-SORT-ORDER-FIELDS.                                   
                       20  ASC-XFER-TYPE-SORT-NR   PIC  X(01).                  
                       20  ASC-XFER-STATUS-SORT-NR PIC  X(01).                  
                       20  ASC-FROM-STORE-SORT-NR  PIC  X(01).                  
                       20  ASC-TO-STORE-SORT-NR    PIC  X(01).                  
                       20  ASC-COMP-DTE-SORT-NR    PIC  X(01).                  
                       20  ASC-RECV-DTE-SORT-NR    PIC  X(01).                  
                       20  ASC-CALLBCK-NR-SORT-NR  PIC  X(01).                  
                       20  ASC-APPRV-NR-SORT-NR    PIC  X(01).                  
                   15  ASC-XFER-TYPE-STATUS-TBL.                                
                       20  ASC-XFER-TY-ST-FIELD OCCURS 18 TIMES                 
                                                   PIC  X(22).                  
                   15  ASC-STATUS-TBL-SUB          PIC S9(04) COMP.     01210012
                   15  ASC-ACTION-SW               PIC  X(01).             CL**1
                       88  ASC-CRITLIST-REQUESTED  VALUE 'C'.              CL**1
                       88  ASC-PRT-DOC-REQUESTED   VALUE 'P'.              CL**1
                       88  ASC-VOID-REQUESTED      VALUE 'V'.              CL**1
                   15  ASC-HOLD-FIELDS.                                    CL**1
      *                20  ASC-HOLD-XFER-NBR       PIC  X(09).                  
100404                 20  ASC-HOLD-XFER-NBR       PIC  X(10).                  
                       20  ASC-HOLD-XFER-TYPE      PIC  X(01).                  
                       20  ASC-HOLD-XFER-STATUS    PIC  X(01).                  
      *                20  ASC-HOLD-FROM-STORE     PIC  X(03).                  
100404                 20  ASC-HOLD-FROM-STORE     PIC  X(04).                  
      *                20  ASC-HOLD-TO-STORE       PIC  X(03).                  
100404                 20  ASC-HOLD-TO-STORE       PIC  X(04).                  
                       20  ASC-HOLD-COMP-BEG-DTE   PIC  X(08).                  
                       20  ASC-HOLD-COMP-END-DTE   PIC  X(08).                  
                       20  ASC-HOLD-RECV-BEG-DTE   PIC  X(08).                  
                       20  ASC-HOLD-RECV-END-DTE   PIC  X(08).                  
                       20  ASC-HOLD-DEPT-NBR       PIC  X(03).                  
                       20  ASC-HOLD-CLASS-NBR      PIC  X(03).                  
                       20  ASC-HOLD-SUBCL-NBR      PIC  X(03).                  
                       20  ASC-HOLD-UPC-NBR        PIC  X(13).                  
                       20  ASC-HOLD-CALLBACK-NBR   PIC  X(04).                  
                       20  ASC-HOLD-APPROVAL-NBR   PIC  X(09).                  
                       20  ASC-HOLD-COMP-BY-FIRST-INIT                          
                                                   PIC  X(01).                  
                       20  ASC-HOLD-COMP-BY-LAST-NAME                           
                                                   PIC  X(20).                  
                       20  ASC-HOLD-RECV-BY-FIRST-INIT                          
                                                   PIC  X(01).                  
                       20  ASC-HOLD-RECV-BY-LAST-NAME                           
                                                   PIC  X(20).                  
                       20  ASC-HOLD-DISPLAY-TOT    PIC  X(01).                  
           EJECT                                                                
                                                                                
      *****************************************************************         
      *   ABEND COPYBOOK.                                                       
      *****************************************************************         
           COPY DPWS013.                                                        
                                                                                
           EJECT                                                        03480012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR TRANSFER TABLE                                * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TTFMSTR                                         04190012
           END-EXEC.                                                    04200012
                                                                        04210012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TTFTYCD                                         04190012
           END-EXEC.                                                    04200012
                                                                        04210012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TTFSTAT                                         04190012
           END-EXEC.                                                    04200012
                                                                        04210012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR TRANSFER RECEIPT TABLE                        * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TTFRCPT                                         04190012
           END-EXEC.                                                    04200012
                                                                        04210012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR TRANSFER STATUS CODE TABLE                    * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TTFSTCD                                         04190012
           END-EXEC.                                                    04200012
                                                                        04210012
100404*---------------------------------------------------------------* 04150012
100404*    DB2 AREA FOR XST_LOC TABLE                                 * 04160012
100404*---------------------------------------------------------------* 04170012
100404     EXEC SQL                                                     04180012
100404          INCLUDE XST00001                                        04190012
100404     END-EXEC.                                                    04200012
                                                                        04210012
100404*---------------------------------------------------------------* 04150012
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 04160012
100404*---------------------------------------------------------------* 04170012
100404     EXEC SQL                                                     04180012
100404          INCLUDE XST00012                                        04190012
100404     END-EXEC.                                                    04200012
                                                                        04210012
      *---------------------------------------------------------------* 04150012
      *    DB2 AREA FOR SKU CROSS REFERENCE TABLE                     * 04160012
      *---------------------------------------------------------------* 04170012
           EXEC SQL                                                     04180012
                INCLUDE TSKXREF                                         04190012
           END-EXEC.                                                    04200012
                                                                                
      *---------------------------------------------------------------* 04629012
      *    DB2 AREA FOR COMMUNICATIONS                                * 04630012
      *---------------------------------------------------------------* 04640012
           EXEC SQL                                                     04650012
                INCLUDE SQLCA                                           04660012
           END-EXEC.                                                    04670012
                                                                        04680012
      *---------------------------------------------------------------* 04910012
      *    CURSOR TO OBTAIN THE TRANSFER TYPE CODES AND DESCRIPTIONS  * 04920012
      *---------------------------------------------------------------* 04930012
                                                                        04940012
           EXEC SQL                                                     04950012
                DECLARE XFER-TYPE-CSR CURSOR                            04960012
                FOR                                                     04970012
                  SELECT                                                04970012
                      XFER_TYP_CDE                                      04980012
                     ,TYP_1ST_LNE_DESC                                        12
                     ,TYP_2ND_LNE_DESC                                  04990012
                  FROM                                                  05000012
                      TTFTYCD                                           05010012
                  ORDER BY XFER_TYP_CDE                                 05120012
100404            WITH UR                                                       
           END-EXEC.                                                    05140012
                                                                                
      *---------------------------------------------------------------* 04910012
      *    CURSOR TO OBTAIN THE TRANSFER STATUS CODES AND DESCRIPTIONS  04920012
      *---------------------------------------------------------------* 04930012
                                                                        04940012
           EXEC SQL                                                     04950012
                DECLARE XFER-STATUS-CSR CURSOR                          04960012
                FOR                                                     04970012
                  SELECT                                                04970012
                      XFER_STAT_CDE                                     04980012
                     ,XFER_STAT_DESC                                          12
                  FROM                                                  05000012
                      TTFSTCD                                           05010012
                  WHERE                                                 05000012
                      XFER_STAT_CDE IN ('CM', 'PR', 'VD', 'RC', 'RN')   05010012
                  ORDER BY XFER_STAT_CDE                                05120012
100404            WITH UR                                                       
           END-EXEC.                                                    05140012
                                                                                
           EJECT                                                        04280012
       LINKAGE SECTION.                                                         
                                                                                
       01  DFHCOMMAREA.                                                         
           05  FILLER                         OCCURS  1 TO 4072 TIMES           
                                              DEPENDING ON EIBCALEN.            
               10  FILLER                     PIC X.                            
                                                                                
                                                                                
       PROCEDURE DIVISION.                                                      
      *****************************************************************         
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. **         
      ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  **         
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            **         
      **                                                             **         
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  **         
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       **         
      *****************************************************************         
       0000-MAIN-MODULE.                                                        
           INITIALIZE DP030-CICS-API-FIELDS.                                    
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.               
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.                  
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).                 
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                               
           MOVE LENGTH OF TF420AI        TO DP030-MAP-LENGTH (1).          CL**2
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).             
           PERFORM 0001-CALL-CICS-ARCH-API.                                     
      *                                                                         
           PERFORM 1000-CONTROL-PROCESSING.                                     
      *                                                                         
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).             
           PERFORM 0001-CALL-CICS-ARCH-API.                                     
                                                                                
       0001-CALL-CICS-ARCH-API.                                                 
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
                                          DFHCOMMAREA                           
                                          DP030-CICS-API-FIELDS                 
                                          DP020-STANDARD-COMMAREA               
                                          TF420AI.                              
      *                                                                         
           IF  DP030-RC-CALL-SUCCESSFUL                                         
               CONTINUE                                                         
           ELSE                                                                 
               SET DP013-NO-ROLLBACK                                            
                   DP013-XCTL-DISPLAY-RESTART                                   
                   DP013-CICS-ABEND      TO TRUE                                
               MOVE 'BEFORE 0000-MAIN-MODULE'                                   
                                         TO DP013-PARAGRAPH                     
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
               MOVE DP030-RETURN-CODE                                           
                                         TO DP013-MESSAGE-TEXT (3)              
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
       EJECT                                                                    
      ******************************************************************        
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *        
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *        
      ******************************************************************        
                                                                                
       1000-CONTROL-PROCESSING.                                                 
                                                                                
           EVALUATE TRUE                                                        
               WHEN DP020-NEXT-ACT-INITIAL                                      
                   INITIALIZE ASC-SPECIFIC-COMMAREA                             
                   INITIALIZE TF001-INTER-APPL-COMMAREA                         
                   PERFORM 4000-BUILD-INITIAL-PANEL                             
                                                                                
               WHEN DP020-NEXT-ACT-READ-MAP                                     
                   PERFORM 2000-FKEY-PROCESSING                                 
                                                                                
               WHEN DP020-NEXT-ACT-RETURN                                       
                   IF ASC-PRT-DOC-REQUESTED   AND                               
                         TF001-PRINT-DOC                                        
                       MOVE PC-TSYMSG-01400        TO DP020-MSG-NUMBER          
                       SET DP020-MSG-INFORMATIONAL TO TRUE                      
                   END-IF                                                       
                   MOVE SPACE                      TO ASC-ACTION-SW        CL**1
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                           
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                         
                                                                                
               WHEN OTHER                                                       
                   SET DP013-LOGIC-ABEND                                        
                       DP013-NO-ROLLBACK TO TRUE                                
                   MOVE '1000-CONTROL-PROCESSING'                               
                                         TO  DP013-PARAGRAPH                    
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'           
                                         TO  DP013-MESSAGE-TEXT(1)              
                   MOVE DP020-NEXT-APPL-ACTIVITY                                
                                         TO DP013-MESSAGE-TEXT(2)               
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*        
      * SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*        
      * EDITS.                                                         *        
      ******************************************************************        
                                                                                
       2000-FKEY-PROCESSING.                                                    
           EVALUATE TRUE                                                        
                                                                                
               WHEN DP020-SRC-AID = DP016-CLEAR                                 
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                           
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                         
                                                                                
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                             
                   INITIALIZE ASC-SPECIFIC-COMMAREA                             
                   INITIALIZE TF001-INTER-APPL-COMMAREA                         
                   PERFORM 4000-BUILD-INITIAL-PANEL                             
                   PERFORM 3200-RESET-ATTRIBUTES                                
                                                                                
               WHEN OTHER                                                       
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                         
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                           
                   IF  PS-NO-ERROR                                              
                       SET DP030-CONTINUE-GO TO TRUE                            
                       PERFORM 2100-CHECK-FUNCTION-KEY                          
                       IF PS-ERROR                                              
                           SET DP030-OVERRIDE-GO TO TRUE                        
                       END-IF                                                   
                   ELSE                                                         
                       SET DP030-OVERRIDE-GO TO TRUE                            
                   END-IF                                                       
           END-EVALUATE.                                                        
                                                                                
                                                                                
      ******************************************************************        
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *        
      * FIRST. NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED    *        
      * FROM THE CICS ARCHITECTURE API.                                *        
      ******************************************************************        
                                                                                
       2100-CHECK-FUNCTION-KEY.                                                 
                                                                                
           EVALUATE TRUE                                                        
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                      
      *----- HDR INQ ---------------------------------------------------        
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                      
      *----- ITM INQ ---------------------------------------------------        
                   MOVE SPACE                   TO ASC-ACTION-SW           CL**1
                   IF ASC-XFER-NBR NOT = SPACES                                 
                       PERFORM 5000-VERIFY-TRANSFER-EXISTS                      
                       IF PS-TXFER-FOUND                                        
      **                 ** MOVE DATA NECESSARY FOR A TRANSFER HEADER           
      **                 ** INQUIRY OR TRANSFER ITEM INQUIRY                    
                           INITIALIZE TF001-INTER-APPL-COMMAREA                 
                           MOVE ASC-XFER-NBR TO TF001-XFER-NBR                  
                           SET TF001-INITIALLY-FROM-CRIT-SPEC TO TRUE           
                       ELSE                                                     
                           SET PS-ERROR                                         
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL TO TRUE                          
      *                    -- INVALID TRANSFER NUMBER --                        
                           MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER             
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                           MOVE DP015-RED       TO ATRNBR1C                     
                                                   ATRNBR2C                     
                           MOVE DP015-REVERSE   TO ATRNBR1H                     
                                                   ATRNBR2H                     
                           MOVE -1              TO ATRNBR1L                     
                           SET DP030-SET-CURSOR-APPL-1 TO TRUE                  
                       END-IF                                                   
                   ELSE                                                         
                       SET PS-ERROR                                             
                           DP030-OVERRIDE-GO                            20010002
                           DP020-MSG-FATAL  TO TRUE                             
      *                -- REQUIRED ENTRY --                                     
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                            TO ATRNBR1A                         
                                               ATRNBR2A                         
                       MOVE DP015-RED       TO ATRNBR1C                         
                                               ATRNBR2C                         
                       MOVE DP015-REVERSE   TO ATRNBR1H                         
                                               ATRNBR2H                         
                       MOVE -1              TO ATRNBR1L                         
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE                      
                   END-IF                                                       
                                                                                
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                      
      *----- VOID ------------------------------------------------------        
                   MOVE SPACE               TO ASC-ACTION-SW               CL**1
                   IF ASC-XFER-NBR NOT = SPACES                                 
                       PERFORM 5000-VERIFY-TRANSFER-EXISTS                      
                       IF PS-TXFER-NOT-FOUND                                    
                           SET PS-ERROR                                         
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL TO TRUE                          
      *                        -- INVALID TRANSFER NUMBER --                    
                           MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER             
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                           MOVE DP015-RED       TO ATRNBR1C                     
                                                   ATRNBR2C                     
                           MOVE DP015-REVERSE   TO ATRNBR1H                     
                                                   ATRNBR2H                     
                           MOVE -1              TO ATRNBR1L                     
                           SET DP030-SET-CURSOR-APPL-1 TO TRUE                  
                       ELSE                                                     
                           PERFORM 5100-SELECT-CURR-XFER-STATUS                 
                           IF TFSTAT-XFER-STAT-CDE NOT =                        
                                             PC-COMPLETE-STATUS    AND          
                              TFSTAT-XFER-STAT-CDE NOT =                        
                                             PC-ASSUMPTIVE-STATUS               
                               SET PS-ERROR                                     
                                   DP030-OVERRIDE-GO                    20010002
                                   DP020-MSG-FATAL TO TRUE                      
      *           -- CANNOT VOID TRANSFER WITH THIS STATUS --                   
                               MOVE TFSTCD-XFER-STAT-DESC                       
                                                    TO  DP020-MSG-TEXT          
                               MOVE PC-TSYMSG-01402                             
                                                    TO DP020-MSG-NUMBER         
                               MOVE DP015-UNP-ALP-BRT-OFF                       
                                                    TO ATRNBR1A                 
                                                       ATRNBR2A                 
                               MOVE DP015-RED       TO ATRNBR1C                 
                                                       ATRNBR2C                 
                               MOVE DP015-REVERSE                               
                                                    TO ATRNBR1H                 
                                                       ATRNBR2H                 
                               MOVE -1          TO ATRNBR1L                     
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE              
                           ELSE                                                 
                               INITIALIZE TF001-INTER-APPL-COMMAREA             
                               MOVE ASC-XFER-NBR TO TF001-XFER-NBR              
                               MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER         
                               MOVE 'F16-FKEY'      TO DP020-MSG-TEXT   29420002
                               SET DP020-MSG-INFORMATIONAL  TO TRUE             
                           END-IF                                               
                       END-IF                                                   
                   ELSE                                                         
                       SET PS-ERROR                                             
                           DP030-OVERRIDE-GO                            20010002
                           DP020-MSG-FATAL TO TRUE                              
      *                    -- REQUIRED ENTRY --                                 
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                       MOVE DP015-RED           TO ATRNBR1C                     
                                                   ATRNBR2C                     
                       MOVE DP015-REVERSE       TO ATRNBR1H                     
                                                   ATRNBR2H                     
                       MOVE -1                  TO ATRNBR1L                     
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE                      
                   END-IF                                                       
                                                                                
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                      
      *----- PRT DOC ---------------------------------------------------        
                   IF PS-XFER-NBR-CHG                                      CL**1
                       MOVE SPACE               TO ASC-ACTION-SW           CL**1
                   END-IF                                                  CL**1
                   IF ASC-XFER-NBR NOT = SPACES                                 
                       PERFORM 5000-VERIFY-TRANSFER-EXISTS                      
                       IF PS-TXFER-NOT-FOUND                                    
                           SET PS-ERROR                                         
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL TO TRUE                          
      *       -- INVALID TRANSFER NUMBER --                                     
                           MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER             
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                           MOVE DP015-RED       TO ATRNBR1C                     
                                                   ATRNBR2C                     
                           MOVE DP015-REVERSE   TO ATRNBR1H                     
                                                   ATRNBR2H                     
                           MOVE -1              TO ATRNBR1L                     
                           SET DP030-SET-CURSOR-APPL-1 TO TRUE                  
                       ELSE                                                     
                           PERFORM 5100-SELECT-CURR-XFER-STATUS                 
                           IF TFSTAT-XFER-STAT-CDE = PC-VOID-STATUS             
                               SET PS-ERROR                                     
                                   DP030-OVERRIDE-GO                    20010002
                                   DP020-MSG-FATAL TO TRUE                      
      *            -- CANNOT PRINT THE DOCUMENT;                        R       
      *                TRANSFER WAS VOIDED --                                   
                               MOVE PC-TSYMSG-01399                             
                                                TO DP020-MSG-NUMBER           07
                               MOVE DP015-UNP-ALP-BRT-OFF                       
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                               MOVE DP015-RED   TO ATRNBR1C                     
                                                   ATRNBR2C                     
                               MOVE DP015-REVERSE                               
                                                TO ATRNBR1H                     
                                                   ATRNBR2H                     
                               MOVE -1          TO ATRNBR1L                     
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE              
                           ELSE                                                 
                               INITIALIZE TF001-INTER-APPL-COMMAREA             
080204                         MOVE DP020-LOCATION-NBR                          
080204                                        TO RFWS009-STORE-NBR              
080204                         MOVE RFWS009-STORE-PRINTER-DEST                  
080204                                        TO TF001-PRINTER-DEST             
                               MOVE ASC-XFER-NBR                                
                                              TO TF001-XFER-NBR                 
                               SET ASC-PRT-DOC-REQUESTED TO TRUE                
                           END-IF                                               
                       END-IF                                                   
                   ELSE                                                         
                       SET PS-ERROR                                             
                           DP030-OVERRIDE-GO                            20010002
                           DP020-MSG-FATAL TO TRUE                              
      *      -- REQUIRED ENTRY --                                               
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                            TO ATRNBR1A                         
                                               ATRNBR2A                         
                       MOVE DP015-RED       TO ATRNBR1C                         
                                               ATRNBR2C                         
                       MOVE DP015-REVERSE   TO ATRNBR1H                         
                                               ATRNBR2H                         
                       MOVE -1              TO ATRNBR1L                         
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE                      
                   END-IF                                                       
                                                                                
               WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                      
      *----- CRITLIST --------------------------------------------------        
                   IF PS-CRITLIST-INFO-CHG                                      
                       MOVE SPACE               TO ASC-ACTION-SW           CL**1
                   END-IF                                                  CL**1
                   IF ASC-CRITLIST-REQUESTED                                    
                       MOVE SPACE               TO ASC-ACTION-SW           CL**1
                       PERFORM 2120-PREP-CRITLIST-COMMAREA                      
                   ELSE                                                    CL**1
                       PERFORM 2110-VERIFY-CRITLIST-FIELDS                      
                       IF PS-NO-ERROR                                           
                           SET ASC-CRITLIST-REQUESTED                           
                               PS-ERROR                                         
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL  TO TRUE                         
      *                    -- PRESS &VAR AGAIN TO CONFIRM --                    
                           MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER             
                           MOVE 'F17-FKEY'      TO DP020-MSG-TEXT       29420002
                       END-IF                                                   
                   END-IF                                                  CL**1
                                                                                
               WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                      
      *----- RESET -----------------------------------------------------        
                   IF PS-XFER-NBR-CHG                                      CL**1
                       MOVE SPACE               TO ASC-ACTION-SW           CL**1
                   END-IF                                                  CL**1
                   IF ASC-XFER-NBR NOT = SPACES                                 
                       PERFORM 5000-VERIFY-TRANSFER-EXISTS                      
                       IF PS-TXFER-NOT-FOUND                                    
                           SET PS-ERROR                                         
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL TO TRUE                          
      *   -- INVALID TRANSFER NUMBER --                                         
                           MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER             
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                                TO ATRNBR1A                     
                                                   ATRNBR2A                     
                           MOVE DP015-RED       TO ATRNBR1C                     
                                                   ATRNBR2C                     
                           MOVE DP015-REVERSE   TO ATRNBR1H                     
                                                   ATRNBR2H                     
                           MOVE -1              TO ATRNBR1L                     
                           SET DP030-SET-CURSOR-APPL-1 TO TRUE                  
                       ELSE                                                     
                           PERFORM 5100-SELECT-CURR-XFER-STATUS                 
                           EVALUATE TFSTAT-XFER-STAT-CDE                        
                               WHEN PC-COMPLETE-STATUS                          
                               WHEN PC-INTERMEDIATE-STATUS                      
                               WHEN PC-ASSUMPTIVE-STATUS                        
                                   CONTINUE                                     
                               WHEN OTHER                                       
                                   MOVE TFSTCD-XFER-STAT-DESC                   
                                                   TO  DP020-MSG-TEXT           
                                   MOVE DP015-UNP-ALP-BRT-OFF                   
                                                        TO ATRNBR1A             
                                                           ATRNBR2A             
                                   MOVE DP015-RED       TO ATRNBR1C             
                                                           ATRNBR2C             
                                   MOVE DP015-REVERSE   TO ATRNBR1H             
                                                           ATRNBR2H             
                                   MOVE -1              TO ATRNBR1L             
                                   SET DP030-SET-CURSOR-APPL-1                  
                                       DP020-MSG-FATAL                          
                                       DP030-OVERRIDE-GO                20010002
                                       PS-ERROR        TO  TRUE                 
                                   MOVE PC-TSYMSG-01581                         
                                                   TO  DP020-MSG-NUMBER         
                           END-EVALUATE                                         
                           IF PS-NO-ERROR                                       
                               PERFORM 3050-CHK-IN-PROCESS                      
                           END-IF                                               
                           IF PS-NO-ERROR                                       
                               INITIALIZE TF001-INTER-APPL-COMMAREA             
                               MOVE ASC-XFER-NBR TO TF001-XFER-NBR              
                               MOVE ASC-XFER-DKEY-ID                            
                                                     TO TF001-DKEY-ID           
                               MOVE PC-TSYMSG-01403                             
                                                    TO DP020-MSG-NUMBER         
                                   MOVE 'F23-FKEY'    TO DP020-MSG-TEXT 29420002
                                   SET DP020-MSG-INFORMATIONAL  TO TRUE         
                           END-IF                                               
                       END-IF                                                   
                   ELSE                                                         
                       SET PS-ERROR                                             
                           DP030-OVERRIDE-GO                            20010002
                           DP020-MSG-FATAL TO TRUE                              
      *    -- REQUIRED ENTRY --                                                 
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                 
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                            TO ATRNBR1A                         
                                               ATRNBR2A                         
                       MOVE DP015-RED       TO ATRNBR1C                         
                                               ATRNBR2C                         
                       MOVE DP015-REVERSE   TO ATRNBR1H                         
                                               ATRNBR2H                         
                       MOVE -1              TO ATRNBR1L                         
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE                      
                   END-IF                                                       
                                                                           CL**1
               WHEN DP020-SRC-AID = DP016-ENTER                                 
                   MOVE SPACE            TO ASC-ACTION-SW                  CL**1
                                                                           CL**1
               WHEN DP030-OVERRIDE-GO                                           
                   CONTINUE                                                     
                                                                                
               WHEN OTHER                                                       
                   SET DP013-NO-ROLLBACK                                        
                       DP013-XCTL-DISPLAY-RESTART                               
                       DP013-CICS-ABEND  TO TRUE                                
                   MOVE '2100-CHECK-FUNCTION-KEY'                               
                                         TO DP013-PARAGRAPH                     
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'              
                                         TO DP013-MESSAGE-TEXT (1)              
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      ** CHECK SELECTED CRITERIA FIELDS FOR VALID DATA THAT EXISTS.   **        
      ******************************************************************        
                                                                                
       2110-VERIFY-CRITLIST-FIELDS.                                             
                                                                                
           IF ASC-FROM-STORE NOT = SPACE                                   CL*34
100404         MOVE ASC-FROM-STORE       TO XST00001-LOC-NBR               CL*33
               PERFORM 5400-SELECT-STORE                                   CL*33
               IF SQLCODE NOT = +0                                              
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- STORE DOES NOT EXIST --                              CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO AFRSTORA                            
                   MOVE DP015-RED        TO AFRSTORC                            
                   MOVE DP015-REVERSE    TO AFRSTORH                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00017 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO AFRSTORL                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                                
TEMP       IF ASC-FROM-STORE NOT = SPACE                                        
TEMP          MOVE ASC-FROM-STORE TO PV-LOC-EXCLUDE                        CL*34
TEMP          IF PV-EXCLUDE                                                CL*34
TEMP              SET DP020-MSG-FATAL   TO TRUE                         23080002
TEMP  *              -- INVALID FROM STORE --                              CL*30
TEMP              MOVE DP015-UNP-ALP-BRT-OFF                                    
TEMP                                    TO AFRSTORA                             
TEMP              MOVE DP015-RED        TO AFRSTORC                             
TEMP              MOVE DP015-REVERSE    TO AFRSTORH                             
TEMP              IF PS-NO-ERROR                                        APKCS323
TEMP                  MOVE PC-TSYMSG-01539 TO DP020-MSG-NUMBER          APKCS323
TEMP                  MOVE -1           TO AFRSTORL                             
TEMP                  SET DP030-SET-CURSOR-APPL-1                       23170002
TEMP                                    TO TRUE                         23180002
TEMP                  SET PS-ERROR      TO TRUE                         231CL*30
TEMP              END-IF                                                APKCS323
TEMP           END-IF                                                   APKCS323
TEMP       END-IF.                                                         CL*33
                                                                                
           IF ASC-TO-STORE NOT = SPACE                                     CL*34
100404         MOVE ASC-TO-STORE         TO XST00001-LOC-NBR               CL*33
               PERFORM 5400-SELECT-STORE                                   CL*33
               IF SQLCODE NOT = +0                                              
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- STORE DOES NOT EXIST --                              CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ATOSTORA                            
                   MOVE DP015-RED        TO ATOSTORC                            
                   MOVE DP015-REVERSE    TO ATOSTORH                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00017 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATOSTORL                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                                
TEMP       IF ASC-TO-STORE NOT = SPACE                                     CL*34
TEMP          MOVE ASC-TO-STORE TO PV-LOC-EXCLUDE                          CL*34
TEMP          IF PV-EXCLUDE                                                CL*34
TEMP              SET DP020-MSG-FATAL   TO TRUE                         23080002
TEMP  *              -- INVALID TO STORE --                                CL*30
TEMP              MOVE DP015-UNP-ALP-BRT-OFF                                    
TEMP                                    TO ATOSTORA                             
TEMP              MOVE DP015-RED        TO ATOSTORC                             
TEMP              MOVE DP015-REVERSE    TO ATOSTORH                             
TEMP              IF PS-NO-ERROR                                        APKCS323
TEMP                  MOVE PC-TSYMSG-01479 TO DP020-MSG-NUMBER          APKCS323
TEMP                  MOVE -1           TO ATOSTORL                             
TEMP                  SET DP030-SET-CURSOR-APPL-1                       23170002
TEMP                                    TO TRUE                         23180002
TEMP                  SET PS-ERROR      TO TRUE                         231CL*30
TEMP              END-IF                                                APKCS323
TEMP           END-IF                                                   APKCS323
TEMP       END-IF.                                                         CL*33
           IF ASC-DEPT-NBR NOT = SPACES                                    CL*34
             AND ASC-CLASS-NBR = SPACES                                    CL*34
               MOVE ASC-DEPT-NBR-N       TO SKXREF-DEPT                    CL*33
               PERFORM 5500-VERIFY-DEPARTMENT                              CL*33
               IF PV-DEPT-NMBR-COUNT = ZERO                                     
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- DEPARTMENT DOES NOT EXIST --                         CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ADEPTA                              
                   MOVE DP015-RED        TO ADEPTC                              
                   MOVE DP015-REVERSE    TO ADEPTH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00032 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ADEPTL                              
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                                
           IF ASC-CLASS-NBR NOT = SPACE                                    CL*34
               MOVE ASC-DEPT-NBR-N       TO SKXREF-DEPT                    CL*33
               MOVE ASC-CLASS-NBR-N      TO SKXREF-CLASS                   CL*33
               PERFORM 5600-VERIFY-DEPARTMENT-CLASS                        CL*33
               IF PV-DEPT-CL-COUNT = ZERO                                       
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- DEPARTMENT/CLASS DOES NOT EXIST --                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ADEPTA                              
                                            ACLASSA                             
                   MOVE DP015-RED        TO ADEPTC                              
                                            ACLASSC                             
                   MOVE DP015-REVERSE    TO ADEPTH                              
                                            ACLASSH                             
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ADEPTL                              
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                                
           IF ASC-UPC-NBR NOT = SPACE                                      CL*34
               MOVE ASC-UPC-NBR-N        TO PV-HOLD-UPC-NBR                CL*33
100404                                      XST00012-UPC-NBR                    
111703*        IF (PV-KOHLS-UPC-DIGITS = '0400')        AND                     
111703*           (PV-KOHLS-DUMMY-SKU = '000')                                  
111703         MOVE ASC-UPC-NBR-N              TO DP040I-UPC-CODE               
111703         SET DP040I-EXTRACT-SKU-FROM-UPC TO TRUE                          
111703         CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                              
111703                         USING DP040I-UPC-CHECK-DIGIT-PARMS               
111703         IF NOT DP040I-UPC-NOT-DUMMY-UPC                                  
                   PERFORM 3905-VALIDATE-UPC-DEPT-CLASS                         
                   IF PS-INVALID-DEPT-CL                                        
                       SET DP020-MSG-FATAL TO TRUE                      23080002
      *                -- DEPARTMENT/CLASS DOES NOT EXIST --               CL*30
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                             TO ATRUPCA                         
                       MOVE DP015-RED    TO ATRUPCC                             
                       MOVE DP015-REVERSE TO ATRUPCH                            
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1       TO ATRUPCL                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                             TO TRUE                    23180002
                           SET PS-ERROR  TO TRUE                        231CL*30
                       END-IF                                           APKCS323
                   END-IF                                                       
               ELSE                                                             
                   PERFORM 5700-SELECT-UPC                                 CL*33
                   IF SQLCODE NOT = +0                                          
                       SET DP020-MSG-FATAL TO TRUE                      23080002
      *                -- UPC DOES NOT EXIST --                            CL*30
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                             TO ATRUPCA                         
                       MOVE DP015-RED    TO ATRUPCC                             
                       MOVE DP015-REVERSE TO ATRUPCH                            
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00100 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1       TO ATRUPCL                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                             TO TRUE                    23180002
                           SET PS-ERROR  TO TRUE                        231CL*30
                       END-IF                                           APKCS323
                   END-IF                                               APKCS323
               END-IF                                                      CL*33
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      ** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **        
      ** INTER-APPLICATION COMMAREA FOR A CRITERIA LIST SELECTION.    **        
      ******************************************************************        
                                                                                
       2120-PREP-CRITLIST-COMMAREA.                                             
                                                                                
           INITIALIZE TF001-INTER-APPL-COMMAREA.                                
           SET TF001-INITIALLY-FROM-CRIT-SPEC TO TRUE.                          
                                                                                
           IF ASC-XFER-TYPE  NOT = SPACE                                        
               MOVE ZERO           TO TF001-XFER-TYPE(1:1)                      
               MOVE ASC-XFER-TYPE  TO TF001-XFER-TYPE(2:1)                      
           END-IF.                                                              
                                                                                
           IF ASC-XFER-STATUS NOT = SPACE                                       
               IF ASC-XFER-STATUS = '1'                                         
                   MOVE PC-COMPLETE-STATUS                                      
                                   TO TF001-XFER-STATUS                         
               ELSE                                                             
                   IF ASC-XFER-STATUS = '2'                                     
                       MOVE PC-RECEIVED-STATUS                                  
                                       TO TF001-XFER-STATUS                     
                   ELSE                                                         
                       IF ASC-XFER-STATUS = '3'                                 
                           MOVE PC-RECEIVED-CHK-STATUS                          
                                       TO TF001-XFER-STATUS                     
                       ELSE                                                     
                           IF ASC-XFER-STATUS = '4'                             
                               MOVE PC-RECEIVED-NO-CHK-STATUS                   
                                       TO TF001-XFER-STATUS                     
                           ELSE                                                 
                               IF ASC-XFER-STATUS = '5'                         
                                   MOVE PC-VOID-STATUS                          
                                       TO TF001-XFER-STATUS                     
                               END-IF                                           
                           END-IF                                               
                       END-IF                                                   
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASC-FROM-STORE = SPACES                                          
               MOVE ZERO           TO TF001-XFER-FROM-STR                       
           ELSE                                                                 
               MOVE ASC-FROM-STORE-N                                            
                                   TO TF001-XFER-FROM-STR                       
           END-IF.                                                              
                                                                                
           IF  ASC-TO-STORE = SPACES                                            
               MOVE ZERO           TO TF001-XFER-TO-STR                         
           ELSE                                                                 
               MOVE ASC-TO-STORE-N TO TF001-XFER-TO-STR                         
           END-IF.                                                              
                                                                                
           IF  ASC-COMP-BEG-DTE = SPACES                                        
               MOVE ZERO           TO TF001-XFER-COMP-BEG-DTE                   
           ELSE                                                                 
               MOVE ASC-COMP-BEG-DTE                                            
                                   TO TF001-XFER-COMP-BEG-DTE                   
           END-IF.                                                              
                                                                                
           IF  ASC-COMP-END-DTE = SPACES                                        
               MOVE ZERO           TO TF001-XFER-COMP-END-DTE                   
           ELSE                                                                 
               MOVE ASC-COMP-END-DTE                                            
                                   TO TF001-XFER-COMP-END-DTE                   
           END-IF.                                                              
                                                                                
           IF  ASC-RECV-BEG-DTE = SPACES                                        
               MOVE ZERO           TO TF001-XFER-RECV-BEG-DTE                   
           ELSE                                                                 
               MOVE ASC-RECV-BEG-DTE                                            
                                   TO TF001-XFER-RECV-BEG-DTE                   
           END-IF.                                                              
                                                                                
           IF  ASC-RECV-END-DTE = SPACES                                        
               MOVE ZERO           TO TF001-XFER-RECV-END-DTE                   
           ELSE                                                                 
               MOVE ASC-RECV-END-DTE                                            
                                   TO TF001-XFER-RECV-END-DTE                   
           END-IF.                                                              
                                                                                
           IF  ASC-DEPT-NBR = SPACES                                            
               MOVE ZERO           TO TF001-XFER-DPT                            
           ELSE                                                                 
               MOVE ASC-DEPT-NBR-N TO TF001-XFER-DPT                            
           END-IF.                                                              
                                                                                
           IF  ASC-CLASS-NBR = SPACES                                           
               MOVE ZERO           TO TF001-XFER-CLASS                          
           ELSE                                                                 
               MOVE ASC-CLASS-NBR-N                                             
                                   TO TF001-XFER-CLASS                          
           END-IF.                                                              
                                                                                
           MOVE ASC-SUBCL-NBR   TO TF001-XFER-SUBCLASS.                         
                                                                                
           IF  ASC-UPC-NBR = SPACES                                             
               MOVE ZERO           TO TF001-XFER-UPC                            
           ELSE                                                                 
               MOVE ASC-UPC-NBR-N  TO TF001-XFER-UPC                            
           END-IF.                                                              
                                                                                
           IF  ASC-CALLBACK-NBR = SPACES                                        
               MOVE ZERO           TO TF001-XFER-CALLBACK-NBR                   
           ELSE                                                                 
               MOVE ASC-CALLBACK-NBR-N                                          
                                   TO TF001-XFER-CALLBACK-NBR                   
           END-IF.                                                              
                                                                                
           IF  ASC-APPROVAL-NBR = SPACES                                        
               MOVE ZERO           TO TF001-XFER-APPROVAL-NBR                   
           ELSE                                                                 
               MOVE ASC-APPROVAL-NBR-N                                          
                                   TO TF001-XFER-APPROVAL-NBR                   
           END-IF.                                                              
                                                                                
           MOVE ASC-COMP-BY-FIRST-INIT                                          
                                   TO TF001-XFER-COMP-BY-FIRST-INIT.            
           MOVE ASC-COMP-BY-LAST-NAME                                           
                                   TO TF001-XFER-COMP-BY-LAST-NAME.             
           MOVE ASC-RECV-BY-FIRST-INIT                                          
                                   TO TF001-XFER-RECV-BY-FIRST-INIT.            
           MOVE ASC-RECV-BY-LAST-NAME                                           
                                   TO TF001-XFER-RECV-BY-LAST-NAME.             
           MOVE ASC-DISPLAY-TOTALS TO TF001-XFER-DISPLAY-TOT.                   
                                                                                
           IF  ASC-XFER-TYPE-SORT-NR = SPACE                                    
               MOVE ZERO           TO TF001-XFER-TYPE-SORT-NR                   
           ELSE                                                                 
               MOVE ASC-XFER-TYPE-SORT-NR                                       
                                   TO TF001-XFER-TYPE-SORT-NR                   
           END-IF.                                                              
                                                                                
           IF  ASC-XFER-STATUS-SORT-NR = SPACE                                  
               MOVE ZERO           TO TF001-XFER-STATUS-SORT-NR                 
           ELSE                                                                 
               MOVE ASC-XFER-STATUS-SORT-NR                                     
                                   TO TF001-XFER-STATUS-SORT-NR                 
           END-IF.                                                              
                                                                                
           IF  ASC-FROM-STORE-SORT-NR = SPACE                                   
               MOVE ZERO           TO TF001-XFER-FROM-STR-SORT-NR               
           ELSE                                                                 
               MOVE ASC-FROM-STORE-SORT-NR                                      
                                   TO TF001-XFER-FROM-STR-SORT-NR               
           END-IF.                                                              
                                                                                
           IF  ASC-TO-STORE-SORT-NR = SPACE                                     
               MOVE ZERO           TO TF001-XFER-TO-STR-SORT-NR                 
           ELSE                                                                 
               MOVE ASC-TO-STORE-SORT-NR                                        
                                   TO TF001-XFER-TO-STR-SORT-NR                 
           END-IF.                                                              
                                                                                
           IF  ASC-COMP-DTE-SORT-NR = SPACE                                     
               MOVE ZERO           TO TF001-XFER-COMP-DTE-SORT-NR               
           ELSE                                                                 
               MOVE ASC-COMP-DTE-SORT-NR                                        
                                   TO TF001-XFER-COMP-DTE-SORT-NR               
           END-IF.                                                              
                                                                                
           IF  ASC-RECV-DTE-SORT-NR = SPACE                                     
               MOVE ZERO           TO TF001-XFER-RECV-DTE-SORT-NR               
           ELSE                                                                 
               MOVE ASC-RECV-DTE-SORT-NR                                        
                                   TO TF001-XFER-RECV-DTE-SORT-NR               
           END-IF.                                                              
                                                                                
           IF  ASC-CALLBCK-NR-SORT-NR = SPACE                                   
               MOVE ZERO           TO TF001-XFER-CALLBCK-NR-SORT-NR             
           ELSE                                                                 
               MOVE ASC-CALLBCK-NR-SORT-NR                                      
                                   TO TF001-XFER-CALLBCK-NR-SORT-NR             
           END-IF.                                                              
                                                                                
           IF  ASC-APPRV-NR-SORT-NR = SPACE                                     
               MOVE ZERO           TO TF001-XFER-APPRV-NR-SORT-NR               
           ELSE                                                                 
               MOVE ASC-APPRV-NR-SORT-NR                                        
                                   TO TF001-XFER-APPRV-NR-SORT-NR               
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * MOVE FIELDS FROM THE MAP TO THE ASC COMMAREA                            
      ******************************************************************        
       2200-MOVE-SCREEN-TO-COMMAREA.                                            
                                                                                
           IF  ATRNBR1L > ZERO                                                  
100404         MOVE ATRNBR1I       TO ASC-XFER-NBR-1-4                     CL**4
           ELSE                                                                 
               IF  ATRNBR1F = DP015-ERASE-EOF                                   
100404             MOVE SPACES     TO ASC-XFER-NBR-1-4                     CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ATRNBR2L > ZERO                                                  
100404         MOVE ATRNBR2I       TO ASC-XFER-NBR-5-10                    CL**4
           ELSE                                                                 
               IF  ATRNBR2F = DP015-ERASE-EOF                                   
100404             MOVE SPACES     TO ASC-XFER-NBR-5-10                    CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASXFRTYPL > ZERO                                                 
               MOVE ASXFRTYPI      TO ASC-XFER-TYPE-SORT-NR                CL**4
           ELSE                                                                 
               IF  ASXFRTYPF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-XFER-TYPE-SORT-NR                CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AXFRTYPL > ZERO                                                  
               MOVE AXFRTYPI       TO ASC-XFER-TYPE                        CL**4
           ELSE                                                                 
               IF  AXFRTYPF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-XFER-TYPE                        CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AXFRTYPDL > ZERO                                                 
               MOVE AXFRTYPDI      TO ASC-XFER-TYPE-DESC                   CL**4
           ELSE                                                                 
               IF  AXFRTYPDF = DP015-ERASE-EOF                                  
                   MOVE SPACES     TO ASC-XFER-TYPE-DESC                   CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASXFRSTAL > ZERO                                                 
               MOVE ASXFRSTAI      TO ASC-XFER-STATUS-SORT-NR              CL**4
           ELSE                                                                 
               IF  ASXFRSTAF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-XFER-STATUS-SORT-NR              CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AXFRSTAL > ZERO                                                  
               MOVE AXFRSTAI       TO ASC-XFER-STATUS                      CL**4
           ELSE                                                                 
               IF  AXFRSTAF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-XFER-STATUS                      CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AXFRSTADL > ZERO                                                 
               MOVE AXFRSTADI      TO ASC-XFER-STATUS-DESC                 CL**4
           ELSE                                                                 
               IF  AXFRSTADF = DP015-ERASE-EOF                                  
                   MOVE SPACES     TO ASC-XFER-STATUS-DESC                 CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASFRSTORL > ZERO                                                 
               MOVE ASFRSTORI      TO ASC-FROM-STORE-SORT-NR               CL**4
           ELSE                                                                 
               IF  ASFRSTORF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-FROM-STORE-SORT-NR               CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AFRSTORL > ZERO                                                  
               MOVE AFRSTORI       TO ASC-FROM-STORE                       CL**4
           ELSE                                                                 
               IF  AFRSTORF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-FROM-STORE                       CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASTOSTORL > ZERO                                                 
               MOVE ASTOSTORI      TO ASC-TO-STORE-SORT-NR                 CL**4
           ELSE                                                                 
               IF  ASTOSTORF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-TO-STORE-SORT-NR                 CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ATOSTORL > ZERO                                                  
               MOVE ATOSTORI       TO ASC-TO-STORE                         CL**4
           ELSE                                                                 
               IF  ATOSTORF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-TO-STORE                         CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASCMDTERL > ZERO                                                 
               MOVE ASCMDTERI      TO ASC-COMP-DTE-SORT-NR                 CL**4
           ELSE                                                                 
               IF  ASCMDTERF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-COMP-DTE-SORT-NR                 CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACMPDBMML > ZERO                                            CL*26
               MOVE ACMPDBMMI      TO ASC-COMP-BEG-MM                      CL*26
           ELSE                                                                 
               IF  ACMPDBMMF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-BEG-MM                      CL*26
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACMPDBDDL > ZERO                                            CL*26
               MOVE ACMPDBDDI      TO ASC-COMP-BEG-DD                      CL*26
           ELSE                                                            CL*26
               IF  ACMPDBDDF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-BEG-DD                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ACMPDBYRL > ZERO                                            CL*26
               MOVE ACMPDBYRI      TO ASC-COMP-BEG-YR                      CL*26
           ELSE                                                            CL*26
               IF  ACMPDBYRF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-BEG-YR                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ACMPDEMML > ZERO                                            CL*26
               MOVE ACMPDEMMI      TO ASC-COMP-END-MM                      CL*26
           ELSE                                                                 
               IF  ACMPDEMMF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-END-MM                      CL*26
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACMPDEDDL > ZERO                                            CL*26
               MOVE ACMPDEDDI      TO ASC-COMP-END-DD                      CL*26
           ELSE                                                            CL*26
               IF  ACMPDEDDF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-END-DD                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ACMPDEYRL > ZERO                                            CL*26
               MOVE ACMPDEYRI      TO ASC-COMP-END-YR                      CL*26
           ELSE                                                            CL*26
               IF  ACMPDEYRF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-COMP-END-YR                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ASRCDTERL > ZERO                                                 
               MOVE ASRCDTERI      TO ASC-RECV-DTE-SORT-NR                 CL**4
           ELSE                                                                 
               IF  ASRCDTERF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-RECV-DTE-SORT-NR                 CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ARCVDBMML > ZERO                                            CL*26
               MOVE ARCVDBMMI      TO ASC-RECV-BEG-MM                      CL*26
           ELSE                                                                 
               IF  ARCVDBMMF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-BEG-MM                      CL*26
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ARCVDBDDL > ZERO                                            CL*26
               MOVE ARCVDBDDI      TO ASC-RECV-BEG-DD                      CL*26
           ELSE                                                            CL*26
               IF  ARCVDBDDF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-BEG-DD                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ARCVDBYRL > ZERO                                            CL*26
               MOVE ARCVDBYRI      TO ASC-RECV-BEG-YR                      CL*26
           ELSE                                                            CL*26
               IF  ARCVDBYRF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-BEG-YR                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ARCVDEMML > ZERO                                            CL*26
               MOVE ARCVDEMMI      TO ASC-RECV-END-MM                      CL*26
           ELSE                                                                 
               IF  ARCVDEMMF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-END-MM                      CL*26
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ARCVDEDDL > ZERO                                            CL*26
               MOVE ARCVDEDDI      TO ASC-RECV-END-DD                      CL*26
           ELSE                                                            CL*26
               IF  ARCVDEDDF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-END-DD                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                           CL*26
           IF  ARCVDEYRL > ZERO                                            CL*26
               MOVE ARCVDEYRI      TO ASC-RECV-END-YR                      CL*26
           ELSE                                                            CL*26
               IF  ARCVDEYRF = DP015-ERASE-EOF                             CL*26
                   MOVE SPACES     TO ASC-RECV-END-YR                      CL*26
               END-IF                                                      CL*26
           END-IF.                                                         CL*26
                                                                                
           IF  ADEPTL > ZERO                                                    
               MOVE ADEPTI         TO ASC-DEPT-NBR                         CL**4
           ELSE                                                                 
               IF  ADEPTF = DP015-ERASE-EOF                                     
                   MOVE SPACES     TO ASC-DEPT-NBR                         CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACLASSL > ZERO                                                   
               MOVE ACLASSI        TO ASC-CLASS-NBR                        CL**4
           ELSE                                                                 
               IF  ACLASSF = DP015-ERASE-EOF                                    
                   MOVE SPACES     TO ASC-CLASS-NBR                        CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASUBCLL > ZERO                                                   
               MOVE ASUBCLI          TO ASC-SUBCL-NBR                      CL**4
           ELSE                                                                 
               IF  ASUBCLF = DP015-ERASE-EOF                                    
                   MOVE SPACES     TO ASC-SUBCL-NBR                        CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ATRUPCL > ZERO                                                   
               MOVE ATRUPCI        TO ASC-UPC-NBR                          CL**4
           ELSE                                                                 
               IF  ATRUPCF = DP015-ERASE-EOF                                    
                   MOVE SPACES     TO ASC-UPC-NBR                          CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASCALLNOL > ZERO                                                 
               MOVE ASCALLNOI      TO ASC-CALLBCK-NR-SORT-NR               CL**4
           ELSE                                                                 
               IF  ASCALLNOF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-CALLBCK-NR-SORT-NR               CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACALLNOL > ZERO                                                  
               MOVE ACALLNOI       TO ASC-CALLBACK-NBR                     CL**4
           ELSE                                                                 
               IF  ACALLNOF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-CALLBACK-NBR                     CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ASAPPRNOL > ZERO                                                 
               MOVE ASAPPRNOI      TO ASC-APPRV-NR-SORT-NR                 CL**4
           ELSE                                                                 
               IF  ASAPPRNOF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-APPRV-NR-SORT-NR                 CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  AAPPRNOL > ZERO                                                  
               MOVE AAPPRNOI       TO ASC-APPROVAL-NBR                     CL**4
           ELSE                                                                 
               IF  AAPPRNOF = DP015-ERASE-EOF                                   
                   MOVE SPACES     TO ASC-APPROVAL-NBR                     CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACMPBYINL > ZERO                                                 
               MOVE ACMPBYINI      TO ASC-COMP-BY-FIRST-INIT               CL**4
           ELSE                                                                 
               IF  ACMPBYINF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-COMP-BY-FIRST-INIT               CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ACMPBYNML > ZERO                                                 
               MOVE ACMPBYNMI      TO ASC-COMP-BY-LAST-NAME                CL**4
           ELSE                                                                 
               IF  ACMPBYNMF = DP015-ERASE-EOF                                  
                   MOVE SPACES     TO ASC-COMP-BY-LAST-NAME                CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ARCVBYINL > ZERO                                                 
               MOVE ARCVBYINI      TO ASC-RECV-BY-FIRST-INIT               CL**4
           ELSE                                                                 
               IF  ARCVBYINF = DP015-ERASE-EOF                                  
                   MOVE SPACE      TO ASC-RECV-BY-FIRST-INIT               CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ARCVBYNML > ZERO                                                 
               MOVE ARCVBYNMI      TO ASC-RECV-BY-LAST-NAME                CL**4
           ELSE                                                                 
               IF  ARCVBYNMF = DP015-ERASE-EOF                                  
                   MOVE SPACES     TO ASC-RECV-BY-LAST-NAME                CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
           IF  ADISPTOTL > ZERO                                                 
               MOVE ADISPTOTI      TO ASC-DISPLAY-TOTALS                   CL**4
           ELSE                                                                 
               IF  ADISPTOTF = DP015-ERASE-EOF                                  
                   MOVE SPACES     TO ASC-DISPLAY-TOTALS                   CL**4
               END-IF                                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *APKCS323
      * IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *APKCS323
      * APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *APKCS323
      ******************************************************************        
       3000-EDIT-DATA-IN-COMMAREA.                                              
                                                                                
           PERFORM 3200-RESET-ATTRIBUTES.                                       
                                                                           CL**2
      *    -- EDIT THE FIRST HALF OF THE TRANSFER NUMBER --                CL*30
100404     IF (ASC-XFER-NBR-1-4 > SPACES) AND                                 30
100404        (ASC-XFER-NBR-1-4 NOT = PC-4-ZEROS)                             30
100404         MOVE ASC-XFER-NBR-1-4     TO DP010I-UNEDITED-FIELD          CL*30
      *        MOVE 3                    TO DP010I-MAXIMUM-DIGITS          CL*30
100404         MOVE LENGTH OF ASC-XFER-NBR-1-4                             CL*30
                                         TO DP010I-MAXIMUM-DIGITS          CL*30
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS        CL*30
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                     CL*30
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                   CL*30
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ATRNBR1A                            
                   MOVE DP015-RED        TO ATRNBR1C                            
                   MOVE DP015-REVERSE    TO ATRNBR1H                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATRNBR1L                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
100404                                   TO ASC-XFER-NBR-1-4-N             CL*30
               END-IF                                                      CL*30
           ELSE                                                            CL*30
100404         IF ASC-XFER-NBR-1-4      = PC-4-ZEROS                          30
                   SET DP020-MSG-FATAL   TO TRUE                                
      *            -- CANNOT BE ZERO --                                    CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ATRNBR1A                            
                   MOVE DP015-RED        TO ATRNBR1C                            
                   MOVE DP015-REVERSE    TO ATRNBR1H                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATRNBR1L                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                           
           END-IF.                                                         CL*30
                                                                           CL*30
      *    -- EDIT THE SECOND HALF OF THE TRANSFER NUMBER --               CL*30
100404     IF (ASC-XFER-NBR-5-10 > SPACES) AND                                30
100404        (ASC-XFER-NBR-5-10 NOT = PC-6-ZEROS)                            30
100404         MOVE ASC-XFER-NBR-5-10    TO DP010I-UNEDITED-FIELD          CL*30
               MOVE 6                    TO DP010I-MAXIMUM-DIGITS          CL*30
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS        CL*30
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                     CL*30
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                   CL*30
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ATRNBR2A                            
                   MOVE DP015-RED        TO ATRNBR2C                            
                   MOVE DP015-REVERSE    TO ATRNBR2H                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATRNBR2L                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
100404                                   TO ASC-XFER-NBR-5-10-N            CL*30
               END-IF                                                      CL*30
           ELSE                                                            CL*30
100404         IF ASC-XFER-NBR-5-10     = PC-6-ZEROS                          30
                   SET DP020-MSG-FATAL   TO TRUE                                
      *            -- CANNOT BE ZERO --                                    CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ATRNBR2A                            
                   MOVE DP015-RED        TO ATRNBR2C                            
                   MOVE DP015-REVERSE    TO ATRNBR2H                            
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATRNBR2L                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                           
           END-IF.                                                         CL*30
                                                                           CL*30
           IF ASC-XFER-TYPE-SORT-NR  = ZERO                                CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASXFRTYPA                               
               MOVE DP015-RED        TO ASXFRTYPC                               
               MOVE DP015-REVERSE    TO ASXFRTYPH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASXFRTYPL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-XFER-TYPE-SORT-NR NUMERIC OR                         CL*34
                  ASC-XFER-TYPE-SORT-NR = SPACE                            CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASXFRTYPA                               
                   MOVE DP015-RED    TO ASXFRTYPC                               
                   MOVE DP015-REVERSE TO ASXFRTYPH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASXFRTYPL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-XFER-TYPE  NUMERIC OR                                    CL*34
              ASC-XFER-TYPE  = SPACE                                       CL*34
              CONTINUE                                                     CL*33
           ELSE                                                            CL*33
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- MUST BE NUMERIC --                                       CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO AXFRTYPA                                
               MOVE DP015-RED        TO AXFRTYPC                                
               MOVE DP015-REVERSE    TO AXFRTYPH                                
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO AXFRTYPL                                
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-XFER-TYPE  NUMERIC                                       CL*34
               MOVE ZERO                 TO  TFTYCD-XFER-TYP-CDE(1:1)           
               MOVE ASC-XFER-TYPE        TO  TFTYCD-XFER-TYP-CDE(2:1)           
               PERFORM 5200-SELECT-XFER-TYPE-CD-INFO                       CL*33
               IF SQLCODE = +0                                                  
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                          
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                             
                                         TO ASC-XFER-TYPE-DESC                  
                   ELSE                                                         
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '         
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  '         
                           INTO ASC-XFER-TYPE-DESC                              
                   END-IF                                                       
                   MOVE ASC-XFER-TYPE-DESC TO AXFRTYPDO                    CL*28
               ELSE                                                             
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *            -- TRANSFER TYPE DOES NOT EXIST --                      CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO AXFRTYPA                            
                   MOVE DP015-RED        TO AXFRTYPC                            
                   MOVE DP015-REVERSE    TO AXFRTYPH                            
                   MOVE SPACES           TO ASC-XFER-TYPE-DESC             CL*28
                   MOVE SPACES           TO AXFRTYPDO                      CL*28
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01412 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO AXFRTYPL                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           ELSE                                                                 
               MOVE SPACES               TO ASC-XFER-TYPE-DESC             CL*28
               MOVE SPACES               TO AXFRTYPDO                      CL*28
           END-IF.                                                         CL*33
                                                                                
           IF ASC-XFER-STATUS-SORT-NR = ZERO                               CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASXFRSTAA                               
               MOVE DP015-RED        TO ASXFRSTAC                               
               MOVE DP015-REVERSE    TO ASXFRSTAH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASXFRSTAL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-XFER-STATUS-SORT-NR NUMERIC OR                       CL*34
                  ASC-XFER-STATUS-SORT-NR = SPACE                          CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASXFRSTAA                               
                   MOVE DP015-RED    TO ASXFRSTAC                               
                   MOVE DP015-REVERSE TO ASXFRSTAH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASXFRSTAL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-XFER-STATUS NUMERIC OR                                   CL*34
              ASC-XFER-STATUS = SPACE                                      CL*34
              CONTINUE                                                     CL*33
           ELSE                                                            CL*33
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- MUST BE NUMERIC --                                       CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO AXFRSTAA                                
               MOVE DP015-RED        TO AXFRSTAC                                
               MOVE DP015-REVERSE    TO AXFRSTAH                                
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO AXFRSTAL                                
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-XFER-STATUS NUMERIC                                      CL*34
              IF ASC-XFER-STATUS = '1'                                     CL*33
                  MOVE PC-COMPLETE-STATUS-DESC                                  
                                         TO ASC-XFER-STATUS-DESC                
                                            AXFRSTADO                           
              ELSE                                                              
                 IF ASC-XFER-STATUS = '2'                                  CL*33
                     MOVE PC-RECEIVED-STATUS-DESC                               
                                         TO ASC-XFER-STATUS-DESC                
                                            AXFRSTADO                           
                 ELSE                                                           
                    IF ASC-XFER-STATUS = '3'                               CL*33
                       MOVE PC-DTL-CHCK-STATUS-DESC                             
                                         TO ASC-XFER-STATUS-DESC                
                                            AXFRSTADO                           
                    ELSE                                                        
                       IF ASC-XFER-STATUS = '4'                            CL*33
                          MOVE PC-NO-DTL-STATUS-DESC                            
                                         TO ASC-XFER-STATUS-DESC                
                                            AXFRSTADO                           
                          ELSE                                                  
                          IF ASC-XFER-STATUS = '5'                         CL*33
                             MOVE PC-VOIDED-STATUS-DESC                         
                                         TO ASC-XFER-STATUS-DESC                
                                            AXFRSTADO                           
                          ELSE                                                  
                             SET DP020-MSG-FATAL TO TRUE                23080002
      *                -- TRANSFER STATUS DOES NOT EXIST --                CL*30
                             MOVE DP015-UNP-ALP-BRT-OFF                         
                                         TO AXFRSTAA                            
                             MOVE DP015-RED    TO AXFRSTAC                      
                             MOVE DP015-REVERSE TO AXFRSTAH                     
                             MOVE SPACES TO ASC-XFER-STATUS-DESC           CL*28
                             MOVE SPACES TO AXFRSTADO                      CL*28
                             IF PS-NO-ERROR                             APKCS323
                                 MOVE PC-TSYMSG-01413                   APKCS323
                                                    TO DP020-MSG-NUMBER APKCS323
                                 MOVE -1       TO AXFRSTAL                      
                                 SET DP030-SET-CURSOR-APPL-1            23170002
                                               TO TRUE                  23180002
                                 SET PS-ERROR  TO TRUE                  231CL*30
                             END-IF                                     APKCS323
                          END-IF                                        APKCS323
                       END-IF                                           APKCS323
                    END-IF                                              APKCS323
                 END-IF                                                 APKCS323
              END-IF                                                    APKCS323
           ELSE                                                                 
               MOVE SPACES               TO ASC-XFER-STATUS-DESC           CL*28
               MOVE SPACES               TO AXFRSTADO                      CL*28
           END-IF.                                                         CL*33
                                                                                
           IF ASC-FROM-STORE-SORT-NR = ZERO                                CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASFRSTORA                               
               MOVE DP015-RED        TO ASFRSTORC                               
               MOVE DP015-REVERSE    TO ASFRSTORH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASFRSTORL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-FROM-STORE-SORT-NR NUMERIC OR                        CL*34
                  ASC-FROM-STORE-SORT-NR = SPACE                           CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASFRSTORA                               
                   MOVE DP015-RED    TO ASFRSTORC                               
                   MOVE DP015-REVERSE TO ASFRSTORH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASFRSTORL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-FROM-STORE > SPACES                                      CL*34
               MOVE ASC-FROM-STORE       TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-FROM-STORE                            POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO AFRSTORA                    POKCS016
                   MOVE DP015-RED        TO AFRSTORC                    POKCS016
                   MOVE DP015-REVERSE    TO AFRSTORH                    POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         POKCS016
                       MOVE -1           TO AFRSTORL                    POKCS016
                       SET DP030-SET-CURSOR-APPL-1                      POKCS016
                                         TO TRUE                        POKCS016
                       SET PS-ERROR      TO TRUE                        POKCS016
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-FROM-STORE-N               CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF ASC-TO-STORE-SORT-NR = ZERO                                  CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASTOSTORA                               
               MOVE DP015-RED        TO ASTOSTORC                               
               MOVE DP015-REVERSE    TO ASTOSTORH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASTOSTORL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-TO-STORE-SORT-NR NUMERIC OR                          CL*34
                  ASC-TO-STORE-SORT-NR = SPACE                             CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASTOSTORA                               
                   MOVE DP015-RED    TO ASTOSTORC                               
                   MOVE DP015-REVERSE TO ASTOSTORH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASTOSTORL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-TO-STORE > SPACES                                        CL*34
               MOVE ASC-TO-STORE         TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-TO-STORE                              POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ATOSTORA                    POKCS016
                   MOVE DP015-RED        TO ATOSTORC                    POKCS016
                   MOVE DP015-REVERSE    TO ATOSTORH                    POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         POKCS016
                       MOVE -1           TO ATOSTORL                    POKCS016
                       SET DP030-SET-CURSOR-APPL-1                      POKCS016
                                         TO TRUE                        POKCS016
                       SET PS-ERROR      TO TRUE                        POKCS016
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-TO-STORE-N                 CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
      **********************************************************                
      * ENTRY OF EITHER A FROM STORE OR TO STORE IS REQUIRED                    
      **********************************************************                
           EVALUATE TRUE                                                        
            WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                         
             IF (ASC-FROM-STORE = SPACES AND ASC-TO-STORE = SPACES)        CL*34
                 SET DP020-MSG-FATAL     TO TRUE                        POKCS016
      *          -- MUST ENTER A FROM STORE OR TO STORE --                 CL*30
                 MOVE DP015-UNP-ALP-BRT-OFF                             POKCS016
                                       TO AFRSTORA                      POKCS016
                 MOVE DP015-RED          TO AFRSTORC                    POKCS016
                 MOVE DP015-REVERSE      TO AFRSTORH                    POKCS016
      *          MOVE DP015-UNP-ALP-BRT-OFF                             POKCS016
      *                                TO ATOSTORA                      POKCS016
      *          MOVE DP015-RED          TO ATOSTORC                    POKCS016
      *          MOVE DP015-REVERSE      TO ATOSTORH                    POKCS016
                 IF PS-NO-ERROR                                         APKCS323
                     MOVE PC-TSYMSG-02787 TO DP020-MSG-NUMBER           POKCS016
                     MOVE -1             TO AFRSTORL                    POKCS016
                     SET DP030-SET-CURSOR-APPL-1                        POKCS016
                                       TO TRUE                          POKCS016
                     SET PS-ERROR        TO TRUE                        POKCS016
                 END-IF                                                 APKCS323
             END-IF                                                     POKCS016
           END-EVALUATE.                                                        
                                                                        POKCS016
      ********************************************************                  
           IF ASC-COMP-DTE-SORT-NR = ZERO                                  CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASCMDTERA                               
               MOVE DP015-RED        TO ASCMDTERC                               
               MOVE DP015-REVERSE    TO ASCMDTERH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASCMDTERL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-COMP-DTE-SORT-NR NUMERIC OR                          CL*34
                  ASC-COMP-DTE-SORT-NR = SPACE                             CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASCMDTERA                               
                   MOVE DP015-RED    TO ASCMDTERC                               
                   MOVE DP015-REVERSE TO ASCMDTERH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASCMDTERL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-COMP-BEG-MM        NUMERIC OR                            CL*34
              ASC-COMP-BEG-MM        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-BCOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDBMMA                          CL*33
               MOVE DP015-RED        TO ACMPDBMMC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDBMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDBMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-COMP-BEG-DD        NUMERIC OR                            CL*34
              ASC-COMP-BEG-DD        = SPACES                              CL*34
               CONTINUE                                                    CL**9
           ELSE                                                            CL**9
               SET PS-BCOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDBDDA                          CL*33
               MOVE DP015-RED        TO ACMPDBDDC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDBDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDBDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL**9
                                                                           CL**9
           IF ASC-COMP-BEG-YR        NUMERIC OR                            CL*34
              ASC-COMP-BEG-YR        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-BCOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDBYRA                          CL*33
               MOVE DP015-RED        TO ACMPDBYRC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDBYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDBYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-COMP-BEG-DTE > SPACE AND                                     
               PS-NO-BCOMP-DATE-ERROR                                           
               MOVE SPACES             TO DPG52-LK-DATE-INPUT                   
               MOVE ASC-COMP-BEG-DTE   TO DPG52-LK-DATE-INPUT                   
               SET DPG52-LK-DTE-GREG-CC        TO TRUE                     CL**9
               SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                     CL**9
               SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                     CL**9
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-SEVERE-ERROR                                      
                   WHEN DPG54-DATE-INVALID                                      
                       SET PS-BCOMP-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ACMPDBMMA                        CL*26
                                          ACMPDBDDA                        CL*27
                                          ACMPDBYRA                        CL*27
                       MOVE DP015-RED  TO ACMPDBMMC                        CL*26
                                          ACMPDBDDC                        CL*27
                                          ACMPDBYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ACMPDBMMH                        CL*26
                                          ACMPDBDDH                        CL*27
                                          ACMPDBYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ACMPDBMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
                   WHEN OTHER                                           RCK00071
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                       TO PV-BEG-DTE-DB2                RCK00071
               END-EVALUATE                                                     
           END-IF.                                                              
                                                                                
           IF ASC-COMP-END-MM        NUMERIC OR                            CL*34
              ASC-COMP-END-MM        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-ECOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDEMMA                          CL*33
               MOVE DP015-RED        TO ACMPDEMMC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDEMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDEMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-COMP-END-DD        NUMERIC OR                            CL*34
              ASC-COMP-END-DD        = SPACES                              CL*34
               CONTINUE                                                    CL**9
           ELSE                                                            CL**9
               SET PS-ECOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDEDDA                          CL*33
               MOVE DP015-RED        TO ACMPDEDDC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDEDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDEDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL**9
                                                                           CL**9
           IF ASC-COMP-END-YR        NUMERIC OR                            CL*34
              ASC-COMP-END-YR        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-ECOMP-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ACMPDEYRA                          CL*33
               MOVE DP015-RED        TO ACMPDEYRC                          CL*33
               MOVE DP015-REVERSE    TO ACMPDEYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPDEYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-COMP-END-DTE > SPACE AND                                     
               PS-NO-ECOMP-DATE-ERROR                                           
               MOVE SPACES             TO DPG52-LK-DATE-INPUT                   
               MOVE ASC-COMP-END-DTE   TO DPG52-LK-DATE-INPUT                   
               SET DPG52-LK-DTE-GREG-CC        TO TRUE                     CL**9
               SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                     CL**9
               SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                     CL**9
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-SEVERE-ERROR                                      
                   WHEN DPG54-DATE-INVALID                                      
                       SET PS-ECOMP-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ACMPDEMMA                        CL*26
                                          ACMPDEDDA                        CL*27
                                          ACMPDEYRA                        CL*27
                       MOVE DP015-RED  TO ACMPDEMMC                        CL*26
                                          ACMPDEDDC                        CL*27
                                          ACMPDEYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ACMPDEMMH                        CL*26
                                          ACMPDEDDH                        CL*27
                                          ACMPDEYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ACMPDEMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
                   WHEN OTHER                                           RCK00071
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                       TO PV-END-DTE-DB2                RCK00071
               END-EVALUATE                                                     
           END-IF.                                                              
                                                                           CL*33
           IF ASC-COMP-BEG-DTE > SPACE                                          
             AND ASC-COMP-END-DTE > SPACE                                       
             AND PS-NO-BCOMP-DATE-ERROR                                         
             AND PS-NO-ECOMP-DATE-ERROR                                         
              IF PV-END-DTE-DB2 < PV-BEG-DTE-DB2                                
      *            -- END OF RANGE PRECEDES START OF RANGE --                   
                 MOVE DP015-UNP-ALP-BRT-OFF                                     
                                      TO ACMPDBMMA                         CL*26
                                         ACMPDBDDA                         CL*27
                                         ACMPDBYRA                         CL*27
                                         ACMPDEMMA                         CL*27
                                         ACMPDEDDA                         CL*27
                                         ACMPDEYRA                         CL*27
                 MOVE DP015-RED       TO ACMPDBMMC                         CL*26
                                         ACMPDBDDC                         CL*27
                                         ACMPDBYRC                         CL*27
                                         ACMPDEMMC                         CL*27
                                         ACMPDEDDC                         CL*27
                                         ACMPDEYRC                         CL*27
                 MOVE DP015-REVERSE   TO ACMPDBMMH                         CL*26
                                         ACMPDBDDH                         CL*27
                                         ACMPDBYRH                         CL*27
                                         ACMPDEMMH                         CL*27
                                         ACMPDEDDH                         CL*27
                                         ACMPDEYRH                         CL*27
                 IF PS-NO-ERROR                                         APKCS323
                     MOVE PC-TSYMSG-00052                                       
                                      TO DP020-MSG-NUMBER               APKCS323
                     MOVE -1          TO ACMPDBMML                              
                     SET DP030-SET-CURSOR-APPL-1                        23170002
                                      TO TRUE                           23180002
                     SET PS-ERROR TO TRUE                               231CL*30
                 END-IF                                                 APKCS323
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF ASC-COMP-BEG-DTE = SPACE                                          
             AND ASC-COMP-END-DTE > SPACE                                       
              SET DP020-MSG-FATAL  TO TRUE                                 CL**9
      *        -- NO START OF RANGE HAS BEEN SPECIFIED --                       
              MOVE DP015-UNP-ALP-BRT-OFF                                   CL**9
                                   TO ACMPDBMMA                            CL*27
                                      ACMPDBDDA                            CL*27
                                      ACMPDBYRA                            CL*27
              MOVE DP015-RED       TO ACMPDBMMC                            CL*27
                                      ACMPDBDDC                            CL*27
                                      ACMPDBYRC                            CL*27
              MOVE DP015-REVERSE   TO ACMPDBMMH                            CL*27
                                      ACMPDBDDH                            CL*27
                                      ACMPDBYRH                            CL*27
              IF PS-NO-ERROR                                            APKCS323
                  MOVE PC-TSYMSG-00053 TO DP020-MSG-NUMBER              APKCS323
                  MOVE -1          TO ACMPDBMML                                 
                  SET DP030-SET-CURSOR-APPL-1                           23170002
                                   TO TRUE                              23180002
                  SET PS-ERROR     TO TRUE                              231CL*30
              END-IF                                                    APKCS323
           END-IF.                                                         CL**9
                                                                                
           IF ASC-COMP-BEG-DTE > SPACE                                          
             AND ASC-COMP-END-DTE = SPACE                                       
              SET DP020-MSG-FATAL  TO TRUE                                 CL**9
      *        -- NO END OF RANGE HAS BEEN SPECIFIED --                         
              MOVE DP015-UNP-ALP-BRT-OFF                                   CL**9
                                   TO ACMPDEMMA                            CL*27
                                      ACMPDEDDA                            CL*27
                                      ACMPDEYRA                            CL*27
              MOVE DP015-RED       TO ACMPDEMMC                            CL*27
                                      ACMPDEDDC                            CL*27
                                      ACMPDEYRC                            CL*27
              MOVE DP015-REVERSE   TO ACMPDEMMH                            CL*27
                                      ACMPDEDDH                            CL*27
                                      ACMPDEYRH                            CL*27
              IF PS-NO-ERROR                                            APKCS323
                  MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              APKCS323
                  MOVE -1          TO ACMPDEMML                                 
                  SET DP030-SET-CURSOR-APPL-1                           23170002
                                   TO TRUE                              23180002
                  SET PS-ERROR     TO TRUE                              231CL*30
              END-IF                                                    APKCS323
           END-IF.                                                         CL**9
                                                                           CL*33
           IF  ASC-RECV-DTE-SORT-NR NOT = SPACE                            CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASRCDTERA                               
               MOVE DP015-RED        TO ASRCDTERC                               
               MOVE DP015-REVERSE    TO ASRCDTERH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASRCDTERL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-RECV-DTE-SORT-NR = ZERO                                  CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASRCDTERA                               
               MOVE DP015-RED        TO ASRCDTERC                               
               MOVE DP015-REVERSE    TO ASRCDTERH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASRCDTERL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-RECV-DTE-SORT-NR NUMERIC OR                          CL*34
                  ASC-RECV-DTE-SORT-NR = SPACE                             CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASRCDTERA                               
                   MOVE DP015-RED    TO ASRCDTERC                               
                   MOVE DP015-REVERSE TO ASRCDTERH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASRCDTERL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-RECV-BEG-MM > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBMMA                          CL*33
               MOVE DP015-RED        TO ARCVDBMMC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF ASC-RECV-BEG-MM        NUMERIC OR                            CL*34
              ASC-RECV-BEG-MM        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-BRECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBMMA                          CL*33
               MOVE DP015-RED        TO ARCVDBMMC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-RECV-BEG-DD > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBDDA                          CL*33
               MOVE DP015-RED        TO ARCVDBDDC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF ASC-RECV-BEG-DD        NUMERIC OR                            CL*34
              ASC-RECV-BEG-DD        = SPACES                              CL*34
               CONTINUE                                                    CL**9
           ELSE                                                            CL**9
               SET PS-BRECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBDDA                          CL*33
               MOVE DP015-RED        TO ARCVDBDDC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL**9
                                                                           CL*33
           IF ASC-RECV-BEG-YR > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBYRA                          CL*33
               MOVE DP015-RED        TO ARCVDBYRC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL**9
           IF ASC-RECV-BEG-YR        NUMERIC OR                            CL*34
              ASC-RECV-BEG-YR        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-BRECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDBYRA                          CL*33
               MOVE DP015-RED        TO ARCVDBYRC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDBYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDBYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-RECV-BEG-DTE > SPACE AND                                     
               PS-NO-BRECV-DATE-ERROR                                           
               MOVE SPACES             TO DPG52-LK-DATE-INPUT                   
               MOVE ASC-RECV-BEG-DTE   TO DPG52-LK-DATE-INPUT                   
               SET DPG52-LK-DTE-GREG-CC        TO TRUE                     CL**9
               SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                     CL**9
               SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                     CL**9
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-SEVERE-ERROR                                      
                   WHEN DPG54-DATE-INVALID                                      
                       SET PS-BRECV-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ARCVDBMMA                        CL*26
                                          ARCVDBDDA                        CL*27
                                          ARCVDBYRA                        CL*27
                       MOVE DP015-RED  TO ARCVDBMMC                        CL*26
                                          ARCVDBDDC                        CL*27
                                          ARCVDBYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ARCVDBMMH                        CL*26
                                          ARCVDBDDH                        CL*27
                                          ARCVDBYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ARCVDBMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
                   WHEN OTHER                                           RCK00071
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                       TO PV-BEG-DTE-DB2                RCK00071
               END-EVALUATE                                                     
           END-IF.                                                              
                                                                           CL*33
           IF ASC-RECV-END-MM > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEMMA                          CL*33
               MOVE DP015-RED        TO ARCVDEMMC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-RECV-END-MM        NUMERIC OR                            CL*34
              ASC-RECV-END-MM        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-ERECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEMMA                          CL*33
               MOVE DP015-RED        TO ARCVDEMMC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEMMH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEMML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF ASC-RECV-END-DD > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEDDA                          CL*33
               MOVE DP015-RED        TO ARCVDEDDC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF ASC-RECV-END-DD        NUMERIC OR                            CL*34
              ASC-RECV-END-DD        = SPACES                              CL*34
               CONTINUE                                                    CL**9
           ELSE                                                            CL**9
               SET PS-ERECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEDDA                          CL*33
               MOVE DP015-RED        TO ARCVDEDDC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEDDH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEDDL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL**9
                                                                           CL*33
           IF ASC-RECV-END-YR > SPACES                                     CL*34
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEYRA                          CL*33
               MOVE DP015-RED        TO ARCVDEYRC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL**9
           IF ASC-RECV-END-YR        NUMERIC OR                            CL*34
              ASC-RECV-END-YR        = SPACES                              CL*34
               CONTINUE                                                    CL*33
           ELSE                                                            CL*33
               SET PS-ERECV-DATE-ERROR                                     CL*33
                                     TO TRUE                               CL*33
               SET DP020-MSG-FATAL   TO TRUE                               CL*33
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                  CL*33
                                     TO ARCVDEYRA                          CL*33
               MOVE DP015-RED        TO ARCVDEYRC                          CL*33
               MOVE DP015-REVERSE    TO ARCVDEYRH                          CL*33
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVDEYRL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-RECV-END-DTE > SPACE AND                                     
               PS-NO-ERECV-DATE-ERROR                                           
               MOVE SPACES             TO DPG52-LK-DATE-INPUT                   
               MOVE ASC-RECV-END-DTE   TO DPG52-LK-DATE-INPUT                   
               SET DPG52-LK-DTE-GREG-CC        TO TRUE                     CL**9
               SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                     CL**9
               SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                     CL**9
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-SEVERE-ERROR                                      
                   WHEN DPG54-DATE-INVALID                                      
                       SET PS-ERECV-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ARCVDEMMA                        CL*26
                                          ARCVDEDDA                        CL*27
                                          ARCVDEYRA                        CL*27
                       MOVE DP015-RED  TO ARCVDEMMC                        CL*26
                                          ARCVDEDDC                        CL*27
                                          ARCVDEYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ARCVDEMMH                        CL*26
                                          ARCVDEDDH                        CL*27
                                          ARCVDEYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ARCVDEMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
                   WHEN OTHER                                           RCK00071
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                       TO PV-END-DTE-DB2                RCK00071
               END-EVALUATE                                                     
           END-IF.                                                              
                                                                           CL*33
           IF ASC-RECV-BEG-DTE > SPACE                                          
             AND ASC-RECV-END-DTE > SPACE                                       
             AND PS-NO-BRECV-DATE-ERROR                                         
             AND PS-NO-ERECV-DATE-ERROR                                         
              IF PV-END-DTE-DB2 < PV-BEG-DTE-DB2                                
      *            -- END OF RANGE PRECEDES START OF RANGE --                   
                 MOVE DP015-UNP-ALP-BRT-OFF                                     
                                      TO ARCVDBMMA                         CL*26
                                         ARCVDBDDA                         CL*27
                                         ARCVDBYRA                         CL*27
                                         ARCVDEMMA                         CL*27
                                         ARCVDEDDA                         CL*27
                                         ARCVDEYRA                         CL*27
                 MOVE DP015-RED       TO ARCVDBMMC                         CL*26
                                         ARCVDBDDC                         CL*27
                                         ARCVDBYRC                         CL*27
                                         ARCVDEMMC                         CL*27
                                         ARCVDEDDC                         CL*27
                                         ARCVDEYRC                         CL*27
                 MOVE DP015-REVERSE   TO ARCVDBMMH                         CL*26
                                         ARCVDBDDH                         CL*27
                                         ARCVDBYRH                         CL*27
                                         ARCVDEMMH                         CL*27
                                         ARCVDEDDH                         CL*27
                                         ARCVDEYRH                         CL*27
                 IF PS-NO-ERROR                                         APKCS323
                     MOVE PC-TSYMSG-00052                                       
                                      TO DP020-MSG-NUMBER               APKCS323
                     MOVE -1          TO ARCVDBMML                              
                     SET DP030-SET-CURSOR-APPL-1                        23170002
                                      TO TRUE                           23180002
                     SET PS-ERROR TO TRUE                               231CL*30
                 END-IF                                                 APKCS323
              END-IF                                                            
           END-IF.                                                              
                                                                                
           IF ASC-RECV-BEG-DTE = SPACE                                          
             AND ASC-RECV-END-DTE > SPACE                                       
              SET DP020-MSG-FATAL  TO TRUE                                 CL**9
      *        -- NO START OF RANGE HAS BEEN SPECIFIED --                       
              MOVE DP015-UNP-ALP-BRT-OFF                                   CL**9
                                   TO ARCVDBMMA                            CL*27
                                      ARCVDBDDA                            CL*27
                                      ARCVDBYRA                            CL*27
              MOVE DP015-RED       TO ARCVDBMMC                            CL*27
                                      ARCVDBDDC                            CL*27
                                      ARCVDBYRC                            CL*27
              MOVE DP015-REVERSE   TO ARCVDBMMH                            CL*27
                                      ARCVDBDDH                            CL*27
                                      ARCVDBYRH                            CL*27
              IF PS-NO-ERROR                                            APKCS323
                  MOVE PC-TSYMSG-00053 TO DP020-MSG-NUMBER              APKCS323
                  MOVE -1          TO ARCVDBMML                                 
                  SET DP030-SET-CURSOR-APPL-1                           23170002
                                   TO TRUE                              23180002
                  SET PS-ERROR     TO TRUE                              231CL*30
              END-IF                                                    APKCS323
           END-IF.                                                         CL**9
                                                                                
           IF ASC-RECV-BEG-DTE > SPACE                                          
             AND ASC-RECV-END-DTE = SPACE                                       
              SET DP020-MSG-FATAL  TO TRUE                                 CL**9
      *        -- NO END OF RANGE HAS BEEN SPECIFIED --                         
              MOVE DP015-UNP-ALP-BRT-OFF                                   CL**9
                                   TO ARCVDEMMA                            CL*27
                                      ARCVDEDDA                            CL*27
                                      ARCVDEYRA                            CL*27
              MOVE DP015-RED       TO ARCVDEMMC                            CL*27
                                      ARCVDEDDC                            CL*27
                                      ARCVDEYRC                            CL*27
              MOVE DP015-REVERSE   TO ARCVDEMMH                            CL*27
                                      ARCVDEDDH                            CL*27
                                      ARCVDEYRH                            CL*27
              IF PS-NO-ERROR                                            APKCS323
                  MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              APKCS323
                  MOVE -1          TO ARCVDEMML                                 
                  SET DP030-SET-CURSOR-APPL-1                           23170002
                                   TO TRUE                              23180002
                  SET PS-ERROR     TO TRUE                              231CL*30
              END-IF                                                    APKCS323
           END-IF.                                                         CL**9
                                                                           CL*33
      ***********************************************************               
      * MUST ENTER COMPLETE OR RECEIVE DATE RANGE                               
      ***********************************************************               
           EVALUATE TRUE                                                        
            WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                         
             IF ASC-COMP-BEG-DTE = SPACE                                        
               AND ASC-COMP-END-DTE = SPACE                                     
               AND ASC-RECV-BEG-DTE = SPACE                                     
               AND ASC-RECV-END-DTE = SPACE                                     
               AND ASC-XFER-STATUS NOT = 5                                      
      *              -- MUST ENTER COMPLETE OR RECEIVE DATE RANGE --            
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                        TO ACMPDBMMA                       CL*26
                                           ACMPDBDDA                       CL*27
                                           ACMPDBYRA                       CL*27
                                           ACMPDEMMA                       CL*27
                                           ACMPDEDDA                       CL*27
                                           ACMPDEYRA                       CL*27
                   MOVE DP015-RED     TO ACMPDBMMC                         CL*26
                                           ACMPDBDDC                       CL*27
                                           ACMPDBYRC                       CL*27
                                           ACMPDEMMC                       CL*27
                                           ACMPDEDDC                       CL*27
                                           ACMPDEYRC                       CL*27
                   MOVE DP015-REVERSE TO ACMPDBMMH                         CL*26
                                           ACMPDBDDH                       CL*27
                                           ACMPDBYRH                       CL*27
                                           ACMPDEMMH                       CL*27
                                           ACMPDEDDH                       CL*27
                                           ACMPDEYRH                       CL*27
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-02788                                     
                                        TO DP020-MSG-NUMBER             APKCS323
                       MOVE -1        TO ACMPDBMML                              
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                        TO TRUE                         23180002
                       SET PS-ERROR TO TRUE                             231CL*30
                   END-IF                                               APKCS323
             END-IF                                                             
           END-EVALUATE.                                                        
                                                                           CL*33
      ***********************************************************               
      * END DATE MUST BE < = 90 DAYS FROM COMPLETE BEGIN DATE                   
      ***********************************************************               
           EVALUATE TRUE                                                        
            WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                         
           IF ASC-COMP-END-DTE > SPACE                                          
               MOVE ASC-COMP-BEG-YR TO PV-HOLD-BEG-YR                           
               MOVE ASC-COMP-BEG-MM TO PV-HOLD-BEG-MM                           
               MOVE ASC-COMP-BEG-DD TO PV-HOLD-BEG-DD                           
               MOVE ASC-COMP-END-YR TO PV-HOLD-END-YR                           
               MOVE ASC-COMP-END-MM TO PV-HOLD-END-MM                           
               MOVE ASC-COMP-END-DD TO PV-HOLD-END-DD                           
               INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                   
               MOVE PV-HOLD-BEG-DTE    TO DPG52-LK-DATE-INPUT                   
               SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE                      CL**9
               SET DPG51-INCREMENT-DATE        TO TRUE                     CL**9
               SET DPG52-LK-DTE-ISO-FMT        TO TRUE                          
               MOVE PC-91-DAYS TO DPG51-INCR-DECR-DAYS-9                        
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-DATE-VALID                                        
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                 TO PV-HOLD-DATE-PLUS-90DAYS            RCK00071
                       IF PV-HOLD-END-DTE >= PV-HOLD-DATE-PLUS-90DAYS           
                           SET PS-ECOMP-DATE-ERROR                         CL*33
                                           TO TRUE                         CL*33
                           SET DP020-MSG-FATAL                                  
                                           TO TRUE                              
      *                    -- DATE PAST 90 DAYS --                              
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                           TO ACMPDEMMA                    CL*26
                                              ACMPDEDDA                    CL*27
                                              ACMPDEYRA                    CL*27
                           MOVE DP015-RED TO ACMPDEMMC                     CL*26
                                              ACMPDEDDC                    CL*27
                                              ACMPDEYRC                    CL*27
                           MOVE DP015-REVERSE                                   
                                           TO ACMPDEMMH                    CL*26
                                              ACMPDEDDH                    CL*27
                                              ACMPDEYRH                    CL*27
                           IF PS-NO-ERROR                               APKCS323
                             MOVE PC-TSYMSG-02789 TO DP020-MSG-NUMBER   APKCS323
                               MOVE -1 TO ACMPDEMML                             
                               SET DP030-SET-CURSOR-APPL-1              23170002
                                           TO TRUE                      23180002
                               SET PS-ERROR TO TRUE                     231CL*30
                           END-IF                                       APKCS323
                       END-IF                                                   
                                                                                
                   WHEN OTHER                                                   
                       SET PS-ECOMP-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ACMPDEMMA                        CL*26
                                          ACMPDEDDA                        CL*27
                                          ACMPDEYRA                        CL*27
                       MOVE DP015-RED TO ACMPDEMMC                         CL*26
                                          ACMPDEDDC                        CL*27
                                          ACMPDEYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ACMPDEMMH                        CL*26
                                          ACMPDEDDH                        CL*27
                                          ACMPDEYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-02789 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ACMPDEMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
               END-EVALUATE                                                     
           END-IF                                                               
           END-EVALUATE.                                                   CL*33
                                                                           CL*33
      ***********************************************************               
      * END DATE MUST BE < =  90 DAYS FROM RECEIVE BEGIN DATE                   
      ***********************************************************               
           EVALUATE TRUE                                                        
            WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                         
           IF  ASC-RECV-END-DTE > SPACE                                         
               MOVE ASC-RECV-BEG-YR TO PV-HOLD-BEG-YR                           
               MOVE ASC-RECV-BEG-MM TO PV-HOLD-BEG-MM                           
               MOVE ASC-RECV-BEG-DD TO PV-HOLD-BEG-DD                           
               MOVE ASC-RECV-END-YR TO PV-HOLD-END-YR                           
               MOVE ASC-RECV-END-MM TO PV-HOLD-END-MM                           
               MOVE ASC-RECV-END-DD TO PV-HOLD-END-DD                           
               INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                   
               MOVE PV-HOLD-BEG-DTE    TO DPG52-LK-DATE-INPUT                   
               SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                     CL**9
               SET DPG51-INCREMENT-DATE        TO TRUE                     CL**9
               SET DPG52-LK-DTE-ISO-FMT        TO TRUE                          
               MOVE PC-91-DAYS TO DPG51-INCR-DECR-DAYS-9                        
               CALL DP500-KOHLS-CALENDAR-ROUTINE USING                          
                                          DPG51 DPG52                           
                                          DPG53 DPG54                           
                                          DPG55 DPG56                           
               EVALUATE TRUE                                                    
                   WHEN DPG54-DATE-VALID                                        
                       MOVE DPG55-DB2-ISO-DATE-FMT                      RCK00071
                                 TO PV-HOLD-DATE-PLUS-90DAYS            RCK00071
                       IF PV-HOLD-END-DTE >= PV-HOLD-DATE-PLUS-90DAYS           
                           SET PS-ERECV-DATE-ERROR                         CL*33
                                           TO TRUE                         CL*33
                           SET DP020-MSG-FATAL                                  
                                           TO TRUE                              
      *                    -- DATE PAST 90 DAYS --                              
                           MOVE DP015-UNP-ALP-BRT-OFF                           
                                           TO ARCVDEMMA                    CL*26
                                              ARCVDEDDA                    CL*27
                                              ARCVDEYRA                    CL*27
                           MOVE DP015-RED TO ARCVDEMMC                     CL*26
                                              ARCVDEDDC                    CL*27
                                              ARCVDEYRC                    CL*27
                           MOVE DP015-REVERSE                                   
                                           TO ARCVDEMMH                    CL*26
                                              ARCVDEDDH                    CL*27
                                              ARCVDEYRH                    CL*27
                           IF PS-NO-ERROR                               APKCS323
                               MOVE PC-TSYMSG-02789 TO DP020-MSG-NUMBER APKCS323
                               MOVE -1 TO ARCVDEMML                             
                               SET DP030-SET-CURSOR-APPL-1              23170002
                                           TO TRUE                      23180002
                               SET PS-ERROR TO TRUE                     231CL*30
                           END-IF                                       APKCS323
                       END-IF                                                   
                                                                                
                   WHEN OTHER                                                   
                       SET PS-ERECV-DATE-ERROR                             CL*33
                                       TO TRUE                             CL*33
                       SET DP020-MSG-FATAL                                      
                                       TO TRUE                                  
      *                -- INVALID DATE --                                       
                       MOVE DP015-UNP-ALP-BRT-OFF                               
                                       TO ARCVDEMMA                        CL*26
                                          ARCVDEDDA                        CL*27
                                          ARCVDEYRA                        CL*27
                       MOVE DP015-RED  TO ARCVDEMMC                        CL*26
                                          ARCVDEDDC                        CL*27
                                          ARCVDEYRC                        CL*27
                       MOVE DP015-REVERSE                                       
                                       TO ARCVDEMMH                        CL*26
                                          ARCVDEDDH                        CL*27
                                          ARCVDEYRH                        CL*27
                       IF PS-NO-ERROR                                   APKCS323
                           MOVE PC-TSYMSG-02789 TO DP020-MSG-NUMBER     APKCS323
                           MOVE -1     TO ARCVDEMML                             
                           SET DP030-SET-CURSOR-APPL-1                  23170002
                                       TO TRUE                          23180002
                           SET PS-ERROR TO TRUE                         231CL*30
                       END-IF                                           APKCS323
               END-EVALUATE                                                     
           END-IF                                                               
           END-EVALUATE.                                                   CL*33
                                                                                
      ************************************************************              
                                                                                
           IF  ASC-DEPT-NBR > SPACES                                    POKCS016
               MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-DEPT-NBR                              POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ADEPTA                      POKCS016
                   MOVE DP015-RED        TO ADEPTC                      POKCS016
                   MOVE DP015-REVERSE    TO ADEPTH                      POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ADEPTL                              
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-DEPT-NBR-N                 CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF  ASC-CLASS-NBR > SPACES                                   POKCS016
               MOVE ASC-CLASS-NBR        TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-CLASS-NBR                             POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ACLASSA                     POKCS016
                   MOVE DP015-RED        TO ACLASSC                     POKCS016
                   MOVE DP015-REVERSE    TO ACLASSH                     POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ACLASSL                             
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-CLASS-NBR-N                CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                                
           IF  ASC-SUBCL-NBR > SPACES                                   POKCS016
               MOVE ASC-SUBCL-NBR        TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-SUBCL-NBR                             POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ASUBCLA                     POKCS016
                   MOVE DP015-RED        TO ASUBCLC                     POKCS016
                   MOVE DP015-REVERSE    TO ASUBCLH                     POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ASUBCLL                             
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-SUBCL-NBR-N                CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF  ASC-DEPT-NBR = SPACES                                    POKCS016
             AND ASC-CLASS-NBR NOT = SPACES                             POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- DEPARTMENT IS REQUIRED WHEN CLASS IS ENTERED --          CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ADEPTA                                  
               MOVE DP015-RED        TO ADEPTC                                  
               MOVE DP015-REVERSE    TO ADEPTH                                  
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01409 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ADEPTL                                  
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                        POKCS016
           IF  ASC-SUBCL-NBR NOT = SPACES                               POKCS016
               IF ASC-DEPT-NBR = SPACES                                 POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *        -- DEPARTMENT AND CLASS ARE REQUIRED  --                    CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ADEPTA                              
                   MOVE DP015-RED        TO ADEPTC                              
                   MOVE DP015-REVERSE    TO ADEPTH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00691 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ADEPTL                              
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
               IF ASC-CLASS-NBR = SPACES                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        23080002
      *        -- DEPARTMENT AND CLASS ARE REQUIRED  --                    CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                         TO ACLASSA                             
                   MOVE DP015-RED        TO ACLASSC                             
                   MOVE DP015-REVERSE    TO ACLASSH                             
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00691 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ACLASSL                             
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF  ASC-UPC-NBR > SPACES                                     POKCS016
               MOVE ASC-UPC-NBR         TO DP010I-UNEDITED-FIELD        POKCS016
               MOVE +13                  TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ATRUPCA                     POKCS016
                   MOVE DP015-RED        TO ATRUPCC                     POKCS016
                   MOVE DP015-REVERSE    TO ATRUPCH                     POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ATRUPCL                             
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUM-FIELD-13-DIG-4-DEC                           
                                         TO ASC-UPC-NBR-N                  CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF ASC-CALLBCK-NR-SORT-NR = ZERO                                CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASCALLNOA                               
               MOVE DP015-RED        TO ASCALLNOC                               
               MOVE DP015-REVERSE    TO ASCALLNOH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASCALLNOL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-CALLBCK-NR-SORT-NR NUMERIC OR                        CL*34
                  ASC-CALLBCK-NR-SORT-NR = SPACE                           CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASCALLNOA                               
                   MOVE DP015-RED    TO ASCALLNOC                               
                   MOVE DP015-REVERSE TO ASCALLNOH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASCALLNOL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-CALLBCK-NR-SORT-NR NOT = SPACE                          CL*34
             AND ASC-XFER-TYPE NOT = PC-CALLBACK-XFER                   POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- ONLY ALLOWED FOR A TRANSFER TYPE OF CALLBACKS --         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASCALLNOA                               
               MOVE DP015-RED        TO ASCALLNOC                               
               MOVE DP015-REVERSE    TO ASCALLNOH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01407 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASCALLNOL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                        POKCS016
           IF  ASC-CALLBACK-NBR > SPACES                                POKCS016
               MOVE ASC-CALLBACK-NBR     TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-CALLBACK-NBR                          POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO ACALLNOA                    POKCS016
                   MOVE DP015-RED        TO ACALLNOC                    POKCS016
                   MOVE DP015-REVERSE    TO ACALLNOH                    POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO ACALLNOL                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-CALLBACK-NBR-N             CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF  ASC-CALLBACK-NBR NOT = SPACES                            POKCS016
             AND ASC-XFER-TYPE NOT = PC-CALLBACK-XFER                   POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- ONLY ALLOWED FOR TRANSFER TYPE 2 --                      CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ACALLNOA                                
               MOVE DP015-RED        TO ACALLNOC                                
               MOVE DP015-REVERSE    TO ACALLNOH                                
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01407 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACALLNOL                                
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                        POKCS016
           IF ASC-APPRV-NR-SORT-NR = ZERO                                  CL*34
               SET DP020-MSG-FATAL   TO TRUE                            23080002
               SET PS-SORT-FIELD-ERROR TO TRUE                          23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASAPPRNOA                               
               MOVE DP015-RED        TO ASAPPRNOC                               
               MOVE DP015-REVERSE    TO ASAPPRNOH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASAPPRNOL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           ELSE                                                         APKCS323
               IF ASC-APPRV-NR-SORT-NR NUMERIC OR                          CL*34
                  ASC-APPRV-NR-SORT-NR = SPACE                             CL*34
                  CONTINUE                                                 CL*33
               ELSE                                                        CL*33
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASAPPRNOA                               
                   MOVE DP015-RED    TO ASAPPRNOC                               
                   MOVE DP015-REVERSE TO ASAPPRNOH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASAPPRNOL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                         CL*33
                                                                           CL*33
           IF  ASC-APPRV-NR-SORT-NR NOT = SPACE                            CL*34
             AND ASC-XFER-TYPE NOT = PC-STK-BAL-CORP-XFER               POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- ONLY ALLOWED FOR TRANSFER TYPE 3 --                      CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ASAPPRNOA                               
               MOVE DP015-RED        TO ASAPPRNOC                               
               MOVE DP015-REVERSE    TO ASAPPRNOH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01408 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ASAPPRNOL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                        POKCS016
           IF  ASC-APPROVAL-NBR > SPACES                                POKCS016
               MOVE ASC-APPROVAL-NBR     TO DP010I-UNEDITED-FIELD       POKCS016
               MOVE LENGTH OF ASC-APPROVAL-NBR                          POKCS016
                                         TO DP010I-MAXIMUM-DIGITS       POKCS016
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     POKCS016
               SET DP010I-NEGATIVE-NOT-ALLOWED                          POKCS016
                                         TO TRUE                        POKCS016
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
               IF  DP010I-ERROR-DETECTED                                POKCS016
                   SET DP020-MSG-FATAL   TO TRUE                        POKCS016
      *            -- MUST BE NUMERIC --                                   CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                           POKCS016
                                         TO AAPPRNOA                    POKCS016
                   MOVE DP015-RED        TO AAPPRNOC                    POKCS016
                   MOVE DP015-REVERSE    TO AAPPRNOH                    POKCS016
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1           TO AAPPRNOL                            
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                         TO TRUE                        23180002
                       SET PS-ERROR      TO TRUE                        231CL*30
                   END-IF                                               APKCS323
               ELSE                                                             
                   MOVE DP010I-NUMERIC-FIELD                               CL*30
                                         TO ASC-APPROVAL-NBR-N             CL*30
               END-IF                                                   POKCS016
           END-IF.                                                      POKCS016
                                                                        POKCS016
           IF  ASC-APPROVAL-NBR NOT = SPACES                               CL*34
             AND ASC-XFER-TYPE NOT = PC-STK-BAL-CORP-XFER               POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- ONLY ALLOWED FOR A TRANSFER TYPE OF STOCK BALANCE-CORP   CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO AAPPRNOA                                
               MOVE DP015-RED        TO AAPPRNOC                                
               MOVE DP015-REVERSE    TO AAPPRNOH                                
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01408 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO AAPPRNOL                                
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                        POKCS016
           IF  ASC-COMP-BY-FIRST-INIT NOT ALPHABETIC                    POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ACMPBYINA                               
               MOVE DP015-RED        TO ACMPBYINC                               
               MOVE DP015-REVERSE    TO ACMPBYINH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPBYINL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-COMP-BY-LAST-NAME NOT ALPHABETIC                     POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ACMPBYNMA                               
               MOVE DP015-RED        TO ACMPBYNMC                               
               MOVE DP015-REVERSE    TO ACMPBYNMH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPBYNML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*30
           IF (ASC-COMP-BY-FIRST-INIT NOT = SPACES                      POKCS016
               AND ASC-COMP-BY-LAST-NAME = SPACES)                      POKCS016
             OR (ASC-COMP-BY-FIRST-INIT = SPACES                        POKCS016
                 AND ASC-COMP-BY-LAST-NAME NOT = SPACES)                POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- FIRST AND LAST NAME REQUIRED --                          CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ACMPBYINA                               
                                        ACMPBYNMA                               
               MOVE DP015-RED        TO ACMPBYINC                               
                                        ACMPBYNMC                               
               MOVE DP015-REVERSE    TO ACMPBYINH                               
                                        ACMPBYNMH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01405 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ACMPBYINL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-RECV-BY-FIRST-INIT > SPACE                           POKCS016
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ARCVBYINA                               
               MOVE DP015-RED        TO ARCVBYINC                               
               MOVE DP015-REVERSE    TO ARCVBYINH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVBYINL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-RECV-BY-FIRST-INIT NOT ALPHABETIC                    POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ARCVBYINA                               
               MOVE DP015-RED        TO ARCVBYINC                               
               MOVE DP015-REVERSE    TO ARCVBYINH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVBYINL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-RECV-BY-LAST-NAME NOT ALPHABETIC                     POKCS016
             AND ASC-XFER-STATUS = '5'                                  POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *    -- NOT ALLOWED WHEN VOID STATUS IS SELECTED --                  CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ARCVBYNMA                               
               MOVE DP015-RED        TO ARCVBYNMC                               
               MOVE DP015-REVERSE    TO ARCVBYNMH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01554 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVBYNML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-RECV-BY-LAST-NAME NOT ALPHABETIC                     POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ARCVBYNMA                               
               MOVE DP015-RED        TO ARCVBYNMC                               
               MOVE DP015-REVERSE    TO ARCVBYNMH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVBYNML                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*30
           IF (ASC-RECV-BY-FIRST-INIT NOT = SPACES                      POKCS016
               AND ASC-RECV-BY-LAST-NAME = SPACES)                      POKCS016
             OR (ASC-RECV-BY-FIRST-INIT = SPACES                        POKCS016
                 AND ASC-RECV-BY-LAST-NAME NOT = SPACES)                POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- FIRST AND LAST NAME REQUIRED --                          CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ARCVBYINA                               
                                        ARCVBYNMA                               
               MOVE DP015-RED        TO ARCVBYINC                               
                                        ARCVBYNMC                               
               MOVE DP015-REVERSE    TO ARCVBYINH                               
                                        ARCVBYNMH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01405 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ARCVBYINL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  NOT (ASC-DISPLAY-TOTALS = SPACE OR 'Y' OR 'N')           POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- INVALID VALUE --                                         CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ADISPTOTA                               
               MOVE DP015-RED        TO ADISPTOTC                               
               MOVE DP015-REVERSE    TO ADISPTOTH                               
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ADISPTOTL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*33
           IF  ASC-DISPLAY-TOTALS = 'Y'                                 POKCS016
             AND NOT (ASC-VALID-DISP-TOTALS)                            POKCS016
      *      AND NOT (ASC-XFER-TYPE = PC-DEFECTS-XFER                   POKCS016
      *                            OR PC-CALLBACK-XFER                  POKCS016
      *                            OR PC-STK-BAL-CORP-XFER)             POKCS016
               SET DP020-MSG-FATAL   TO TRUE                            23080002
      *        -- ONLY ALLOWED FOR TRANSFER TYPE 1, 2, OR 3 --             CL*30
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                     TO ADISPTOTA                               
               MOVE DP015-RED        TO ADISPTOTC                               
               MOVE DP015-REVERSE    TO ADISPTOTH                               
               MOVE 'N'              TO ADISPTOTO                               
                                        ASC-DISPLAY-TOTALS                 CL**4
               IF PS-NO-ERROR                                           APKCS323
                   MOVE 'NON-RETAIL'    TO DP020-MSG-TEXT               APKCS323
                   MOVE PC-TSYMSG-01406 TO DP020-MSG-NUMBER             APKCS323
                   MOVE -1           TO ADISPTOTL                               
                   SET DP030-SET-CURSOR-APPL-1                          23170002
                                     TO TRUE                            23180002
                   SET PS-ERROR      TO TRUE                            231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                           CL*30
           IF (ASC-DISPLAY-TOTALS = SPACE OR 'N')                       POKCS016
             AND (ASC-XFER-TYPE NOT = ASC-HOLD-XFER-TYPE)                       
             AND (ASC-VALID-DISP-TOTALS)                                POKCS016
      *      AND (ASC-XFER-TYPE = PC-DEFECTS-XFER                       POKCS016
      *                       OR PC-CALLBACK-XFER                       POKCS016
      *                       OR PC-STK-BAL-CORP-XFER)                  POKCS016
               MOVE 'Y'              TO ADISPTOTO                               
                                        ASC-DISPLAY-TOTALS                 CL**4
           END-IF.                                                      APKCS323
                                                                           CL*30
           IF  PS-NO-SORT-FIELD-ERROR                                           
             AND ASC-SORT-ORDER-FIELDS NOT = SPACES                             
               PERFORM 3010-SORT-FIELDS-CHECK                           231CL*30
           END-IF.                                                              
                                                                           CL*30
           IF  PS-NO-ERROR                                                      
100404       AND ASC-XFER-NBR NOT = ASC-HOLD-XFER-NBR                           
               SET PS-XFER-NBR-CHG   TO TRUE                            231CL*30
           END-IF.                                                              
                                                                           CL*30
           IF  PS-NO-ERROR                                                      
             AND (   ASC-XFER-TYPE       NOT = ASC-HOLD-XFER-TYPE               
                  OR ASC-XFER-STATUS     NOT = ASC-HOLD-XFER-STATUS             
                  OR ASC-FROM-STORE      NOT = ASC-HOLD-FROM-STORE              
                  OR ASC-TO-STORE        NOT = ASC-HOLD-TO-STORE                
                  OR ASC-COMP-BEG-DTE    NOT = ASC-HOLD-COMP-BEG-DTE            
                  OR ASC-COMP-END-DTE    NOT = ASC-HOLD-COMP-END-DTE            
                  OR ASC-RECV-BEG-DTE    NOT = ASC-HOLD-RECV-BEG-DTE            
                  OR ASC-RECV-END-DTE    NOT = ASC-HOLD-RECV-END-DTE            
                  OR ASC-DEPT-NBR        NOT = ASC-HOLD-DEPT-NBR                
                  OR ASC-CLASS-NBR       NOT = ASC-HOLD-CLASS-NBR               
                  OR ASC-SUBCL-NBR       NOT = ASC-HOLD-SUBCL-NBR               
                  OR ASC-UPC-NBR         NOT = ASC-HOLD-UPC-NBR                 
                  OR ASC-CALLBACK-NBR    NOT = ASC-HOLD-CALLBACK-NBR            
                  OR ASC-APPROVAL-NBR    NOT = ASC-HOLD-APPROVAL-NBR            
                  OR ASC-COMP-BY-FIRST-INIT                                     
                                      NOT = ASC-HOLD-COMP-BY-FIRST-INIT         
                  OR ASC-COMP-BY-LAST-NAME                                      
                                      NOT = ASC-HOLD-COMP-BY-LAST-NAME          
                  OR ASC-RECV-BY-FIRST-INIT                                     
                                      NOT = ASC-HOLD-RECV-BY-FIRST-INIT         
                  OR ASC-RECV-BY-LAST-NAME                                      
                                      NOT = ASC-HOLD-RECV-BY-LAST-NAME)         
      **>         OR ASC-DISPLAY-TOTALS  NOT = ASC-HOLD-DISPLAY-TOT)            
               SET PS-CRITLIST-INFO-CHG TO TRUE                         231CL*30
           END-IF.                                                              
                                                                           CL*30
           IF  PS-NO-ERROR                                                      
               MOVE ASC-XFER-NBR     TO ASC-HOLD-XFER-NBR                  CL**1
               MOVE ASC-XFER-TYPE    TO ASC-HOLD-XFER-TYPE                      
               MOVE ASC-XFER-STATUS  TO ASC-HOLD-XFER-STATUS                    
               MOVE ASC-FROM-STORE   TO ASC-HOLD-FROM-STORE                     
               MOVE ASC-TO-STORE     TO ASC-HOLD-TO-STORE                       
               MOVE ASC-COMP-BEG-DTE TO ASC-HOLD-COMP-BEG-DTE                   
               MOVE ASC-COMP-END-DTE TO ASC-HOLD-COMP-END-DTE                   
               MOVE ASC-RECV-BEG-DTE TO ASC-HOLD-RECV-BEG-DTE                   
               MOVE ASC-RECV-END-DTE TO ASC-HOLD-RECV-END-DTE                   
               MOVE ASC-DEPT-NBR     TO ASC-HOLD-DEPT-NBR                       
               MOVE ASC-CLASS-NBR    TO ASC-HOLD-CLASS-NBR                      
               MOVE ASC-SUBCL-NBR    TO ASC-HOLD-SUBCL-NBR                      
               MOVE ASC-UPC-NBR      TO ASC-HOLD-UPC-NBR                        
               MOVE ASC-CALLBACK-NBR TO ASC-HOLD-CALLBACK-NBR                   
               MOVE ASC-APPROVAL-NBR TO ASC-HOLD-APPROVAL-NBR                   
               MOVE ASC-COMP-BY-FIRST-INIT                                      
                                     TO ASC-HOLD-COMP-BY-FIRST-INIT             
               MOVE ASC-COMP-BY-LAST-NAME                                       
                                     TO ASC-HOLD-COMP-BY-LAST-NAME              
               MOVE ASC-RECV-BY-FIRST-INIT                                      
                                     TO ASC-HOLD-RECV-BY-FIRST-INIT             
               MOVE ASC-RECV-BY-LAST-NAME                                       
                                     TO ASC-HOLD-RECV-BY-LAST-NAME              
               MOVE ASC-DISPLAY-TOTALS                                          
                                     TO ASC-HOLD-DISPLAY-TOT                    
               MOVE -1               TO ATRNBR1L                                
               SET DP030-SET-CURSOR-APPL-1                                      
                                     TO TRUE                                    
           END-IF.                                                              
                                                                                
      ******************************************************************        
      **  VERIFY THAT THE SORT NUMBERS ARE IN SEQUENCE WITH NO GAPS.            
      ******************************************************************        
       3010-SORT-FIELDS-CHECK.                                                  
                                                                                
           IF ASC-XFER-TYPE-SORT-NR NOT = SPACE                                 
               MOVE ASC-XFER-TYPE-SORT-NR TO PV-SORT-SUB                        
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASXFRTYPA                               
                   MOVE DP015-RED    TO ASXFRTYPC                               
                   MOVE DP015-REVERSE TO ASXFRTYPH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASXFRTYPL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-XFER-STATUS-SORT-NR NOT = SPACE                               
               MOVE ASC-XFER-STATUS-SORT-NR TO PV-SORT-SUB                      
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASXFRSTAA                               
                   MOVE DP015-RED    TO ASXFRSTAC                               
                   MOVE DP015-REVERSE TO ASXFRSTAH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASXFRSTAL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-FROM-STORE-SORT-NR NOT = SPACE                                
               MOVE ASC-FROM-STORE-SORT-NR TO PV-SORT-SUB                       
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASFRSTORA                               
                   MOVE DP015-RED    TO ASFRSTORC                               
                   MOVE DP015-REVERSE TO ASFRSTORH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASFRSTORL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-TO-STORE-SORT-NR NOT = SPACE                                  
               MOVE ASC-TO-STORE-SORT-NR TO PV-SORT-SUB                         
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASTOSTORA                               
                   MOVE DP015-RED    TO ASTOSTORC                               
                   MOVE DP015-REVERSE TO ASTOSTORH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASTOSTORL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-COMP-DTE-SORT-NR NOT = SPACE                                  
               MOVE ASC-COMP-DTE-SORT-NR TO PV-SORT-SUB                         
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASCMDTERA                               
                   MOVE DP015-RED    TO ASCMDTERC                               
                   MOVE DP015-REVERSE TO ASCMDTERH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASCMDTERL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-RECV-DTE-SORT-NR NOT = SPACE                                  
               MOVE ASC-RECV-DTE-SORT-NR TO PV-SORT-SUB                         
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASRCDTERA                               
                   MOVE DP015-RED    TO ASRCDTERC                               
                   MOVE DP015-REVERSE TO ASRCDTERH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASRCDTERL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-CALLBCK-NR-SORT-NR NOT = SPACE                                
               MOVE ASC-CALLBCK-NR-SORT-NR TO PV-SORT-SUB                       
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASCALLNOA                               
                   MOVE DP015-RED    TO ASCALLNOC                               
                   MOVE DP015-REVERSE TO ASCALLNOH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASCALLNOL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           IF ASC-APPRV-NR-SORT-NR NOT = SPACE                                  
               MOVE ASC-APPRV-NR-SORT-NR TO PV-SORT-SUB                         
               PERFORM 3011-FILL-SORT-ORDER-FIELD                               
               IF PS-DUPLICATE-SORT-NR                                          
                   SET DP020-MSG-FATAL TO TRUE                          23080002
                   SET PS-SORT-FIELD-ERROR TO TRUE                      23080002
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --                 CL*30
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                     TO ASAPPRNOA                               
                   MOVE DP015-RED    TO ASAPPRNOC                               
                   MOVE DP015-REVERSE TO ASAPPRNOH                              
                   IF PS-NO-ERROR                                       APKCS323
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         APKCS323
                       MOVE -1       TO ASAPPRNOL                               
                       SET DP030-SET-CURSOR-APPL-1                      23170002
                                     TO TRUE                            23180002
                       SET PS-ERROR  TO TRUE                            231CL*30
                   END-IF                                               APKCS323
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
           PERFORM 3012-CHECK-SORT-SEQ-ORDER                                    
               VARYING PV-SORT-TBL-SUB                                          
               FROM 1 BY 1                                                      
               UNTIL PV-SORT-TBL-SUB > PV-MAX-SORT-SUB.                         
                                                                                
           IF PS-SORT-SEQ-ERROR                                                 
               SET DP020-MSG-FATAL TO TRUE                              23080002
      *        -- SORT NUMBERS MUST BE IN SEQUENCE --                      CL*30
               IF PS-NO-ERROR                                           APKCS323
                   MOVE PC-TSYMSG-01411 TO DP020-MSG-NUMBER             APKCS323
                   SET PS-ERROR         TO TRUE                         231CL*30
               END-IF                                                   APKCS323
           END-IF.                                                      APKCS323
                                                                                
      ******************************************************************        
      **  FILL THE SORT ORDER TABLE FIELD.                                      
      ******************************************************************        
       3011-FILL-SORT-ORDER-FIELD.                                              
                                                                                
           IF SORT-ORDER-FIELD (PV-SORT-SUB) = ZERO                             
               MOVE PV-SORT-SUB      TO SORT-ORDER-FIELD (PV-SORT-SUB)          
           ELSE                                                                 
               SET PS-DUPLICATE-SORT-NR TO TRUE                                 
           END-IF.                                                              
                                                                                
           IF PV-SORT-SUB > PV-MAX-SORT-SUB                                     
               MOVE PV-SORT-SUB      TO PV-MAX-SORT-SUB                         
           END-IF.                                                              
                                                                                
      ******************************************************************        
      **  VERIFY THAT THERE ARE NO SEQUENCE NUMBER GAPS IN THE SORT             
      **  ORDER TABLE.                                                          
      ******************************************************************        
       3012-CHECK-SORT-SEQ-ORDER.                                               
                                                                                
           IF SORT-ORDER-FIELD (PV-SORT-TBL-SUB) = ZERO                         
               SET PS-SORT-SEQ-ERROR TO TRUE                                    
           END-IF.                                                              
                                                                                
      *----------------------------------------------------------------*        
      *  CHECK TO SEE IF THE TRANSFER IS IN PROCESS.                            
      *----------------------------------------------------------------*        
       3050-CHK-IN-PROCESS.                                                     
           PERFORM 7150-SELECT-MAX-RCPT-TMST.                                   
                                                                                
           IF PV-NULL-IND IS NOT NEGATIVE                                       
               PERFORM 7200-SELECT-CURRENT-RCPT                                 
               IF TFRCPT-RCV-XFER-BEG-TMST IS NOT =                             
                                               TFRCPT-RCV-XFER-END-TMST         
                   MOVE DP015-UNP-ALP-BRT-OFF                                   
                                             TO ATRNBR1A                        
                                                ATRNBR2A                        
                   MOVE DP015-RED            TO ATRNBR1C                        
                                                ATRNBR2C                        
                   MOVE DP015-REVERSE        TO ATRNBR1H                        
                                                ATRNBR2H                        
                   MOVE -1                   TO ATRNBR1L                        
                   SET DP030-SET-CURSOR-APPL-1                                  
                       DP030-OVERRIDE-GO                                20010002
                       DP020-MSG-FATAL                                          
                       PS-ERROR               TO  TRUE                          
                   MOVE PC-TSYMSG-01583       TO  DP020-MSG-NUMBER              
               END-IF                                                           
           ELSE                                                                 
               MOVE DP015-UNP-ALP-BRT-OFF                                       
                                         TO ATRNBR1A                            
                                            ATRNBR2A                            
               MOVE DP015-RED            TO ATRNBR1C                            
                                            ATRNBR2C                            
               MOVE DP015-REVERSE        TO ATRNBR1H                            
                                            ATRNBR2H                            
               MOVE -1                   TO ATRNBR1L                            
               SET DP030-SET-CURSOR-APPL-1                                      
                   DP030-OVERRIDE-GO                                    20010002
                   DP020-MSG-FATAL                                              
                   PS-ERROR               TO  TRUE                              
               MOVE PC-TSYMSG-01583  TO  DP020-MSG-NUMBER                       
           END-IF.                                                              
      ******************************************************************        
      **  MAKE ALL FIELDS UNPROTECTED, UNDERLINED, AND GREEN.                   
      ******************************************************************        
       3200-RESET-ATTRIBUTES.                                                   
                                                                                
           MOVE DP015-UNP-ALP-NOR-OFF  TO ATRNBR1A                         CL*28
                                          ATRNBR2A                         CL*28
                                          ASXFRTYPA                        CL*28
                                          AXFRTYPA                         CL*28
                                          ASXFRSTAA                        CL*28
                                          AXFRSTAA                         CL*28
                                          ASFRSTORA                        CL*28
                                          AFRSTORA                         CL*28
                                          ASTOSTORA                        CL*28
                                          ATOSTORA                         CL*28
                                          ASCMDTERA                        CL*28
                                          ACMPDBMMA                        CL*28
                                          ACMPDBDDA                        CL*28
                                          ACMPDBYRA                        CL*28
                                          ACMPDEMMA                        CL*28
                                          ACMPDEDDA                        CL*28
                                          ACMPDEYRA                        CL*28
                                          ASRCDTERA                        CL*28
                                          ARCVDBMMA                        CL*28
                                          ARCVDBDDA                        CL*28
                                          ARCVDBYRA                        CL*28
                                          ARCVDEMMA                        CL*28
                                          ARCVDEDDA                        CL*28
                                          ARCVDEYRA                        CL*28
                                          ADEPTA                           CL*28
                                          ACLASSA                          CL*28
                                          ASCALLNOA                        CL*28
                                          ACALLNOA                         CL*28
                                          ASAPPRNOA                        CL*28
                                          AAPPRNOA                         CL*28
                                          ACMPBYINA                        CL*28
                                          ACMPBYNMA                        CL*28
                                          ARCVBYINA                        CL*28
                                          ARCVBYNMA                        CL*28
                                          ADISPTOTA.                       CL*28
           MOVE DP015-GREEN            TO ATRNBR1C                         CL*28
                                          ATRNBR2C                         CL*28
                                          ASXFRTYPC                        CL*28
                                          AXFRTYPC                         CL*28
                                          ASXFRSTAC                        CL*28
                                          AXFRSTAC                         CL*28
                                          ASFRSTORC                        CL*28
                                          AFRSTORC                         CL*28
                                          ASTOSTORC                        CL*28
                                          ATOSTORC                         CL*28
                                          ASCMDTERC                        CL*28
                                          ACMPDBMMC                        CL*28
                                          ACMPDBDDC                        CL*28
                                          ACMPDBYRC                        CL*28
                                          ACMPDEMMC                        CL*28
                                          ACMPDEDDC                        CL*28
                                          ACMPDEYRC                        CL*28
                                          ASRCDTERC                        CL*28
                                          ARCVDBMMC                        CL*28
                                          ARCVDBDDC                        CL*28
                                          ARCVDBYRC                        CL*28
                                          ARCVDEMMC                        CL*28
                                          ARCVDEDDC                        CL*28
                                          ARCVDEYRC                        CL*28
                                          ADEPTC                           CL*28
                                          ACLASSC                          CL*28
                                          ASCALLNOC                        CL*28
                                          ACALLNOC                         CL*28
                                          ASAPPRNOC                        CL*28
                                          AAPPRNOC                         CL*28
                                          ACMPBYINC                        CL*28
                                          ACMPBYNMC                        CL*28
                                          ARCVBYINC                        CL*28
                                          ARCVBYNMC                        CL*28
                                          ADISPTOTC.                       CL*28
           MOVE DP015-UNDERLINE        TO ATRNBR1H                         CL*28
                                          ATRNBR2H                         CL*28
                                          ASXFRTYPH                        CL*28
                                          AXFRTYPH                         CL*28
                                          ASXFRSTAH                        CL*28
                                          AXFRSTAH                         CL*28
                                          ASFRSTORH                        CL*28
                                          AFRSTORH                         CL*28
                                          ASTOSTORH                        CL*28
                                          ATOSTORH                         CL*28
                                          ASCMDTERH                        CL*28
                                          ACMPDBMMH                        CL*28
                                          ACMPDBDDH                        CL*28
                                          ACMPDBYRH                        CL*28
                                          ACMPDEMMH                        CL*28
                                          ACMPDEDDH                        CL*28
                                          ACMPDEYRH                        CL*28
                                          ASRCDTERH                        CL*28
                                          ARCVDBMMH                        CL*28
                                          ARCVDBDDH                        CL*28
                                          ARCVDBYRH                        CL*28
                                          ARCVDEMMH                        CL*28
                                          ARCVDEDDH                        CL*28
                                          ARCVDEYRH                        CL*28
                                          ADEPTH                           CL*28
                                          ACLASSH                          CL*28
                                          ASCALLNOH                        CL*28
                                          ACALLNOH                         CL*28
                                          ASAPPRNOH                        CL*28
                                          AAPPRNOH                         CL*28
                                          ACMPBYINH                        CL*28
                                          ACMPBYNMH                        CL*28
                                          ARCVBYINH                        CL*28
                                          ARCVBYNMH                        CL*28
                                          ADISPTOTH.                       CL*28
                                                                                
                                                                                
      ******************************************************************        
      ** VALIDATE EMBEDDED DEPT AND CLASS IN UPC                      **        
      ******************************************************************        
       3905-VALIDATE-UPC-DEPT-CLASS.                                            
           MOVE PV-KOHLS-DEPT     TO DK-DEPT-NBR.                               
           MOVE PV-KOHLS-CL-9     TO DK-SUBCLASS-NBR.                           
           MOVE ZERO              TO PV-KOHLS-CL-2.                             
           MOVE PV-KOHLS-CL-9     TO DK-CLASS-NBR.                              
                                                                                
           PERFORM                                                              
             WITH TEST AFTER                                                    
               VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
                 UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                        
                    OR SQLCODE = ZERO                                           
                    OR SQLCODE = +100                                           
               EXEC SQL                                                         
                   SELECT  COUNT(*)                                             
                     INTO  :PV-READ-COUNT                                       
                     FROM  TSKXREF                                              
                    WHERE  (DEPT        =  :DK-DEPT-NBR                         
                      AND   CLASS       =  :DK-CLASS-NBR                        
                      AND   SUBCLASS    =  :DK-SUBCLASS-NBR)                    
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = ZERO                                          
                       IF PV-READ-COUNT > +0                                    
                           SET PS-VALID-DEPT-CL    TO TRUE                      
                       ELSE                                                     
                           SET PS-INVALID-DEPT-CL  TO TRUE                      
                       END-IF                                                   
                   WHEN SQLCODE = +100                                          
                       SET PS-INVALID-DEPT-CL      TO TRUE                      
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                       CONTINUE                                                 
100404             WHEN OTHER                                                   
                       MOVE '3905-VALIDATE-UPC-DEPT-CLASS'                      
                                           TO DP013-PARAGRAPH                   
                       MOVE 'READ A ROW FROM TSKXREF'                           
                                           TO DP013-MESSAGE-TEXT (1)            
                       MOVE SQLCA          TO DP013-SQLCA                       
                       MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (1)          
                       SET DP013-DB2-ABEND TO TRUE                              
                       PERFORM DP013-0000-PROCESS-ABEND                         
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '3905-VALIDATE-UPC-DEPT-CLASS' TO DP013-PARAGRAPH           
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '            
                                           TO DP013-MESSAGE-TEXT (1)            
               MOVE 'DATA FROM TSKXREF'    TO DP013-MESSAGE-TEXT (2)            
               MOVE SQLCA                  TO DP013-SQLCA                       
               MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (1)          
               SET DP013-DB2-ABEND         TO TRUE                              
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *        
      *  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *        
      *  IT HERE.                                                      *        
      ******************************************************************        
                                                                                
       4000-BUILD-INITIAL-PANEL.                                                
                                                                                
           MOVE ZERO                   TO ASC-STATUS-TBL-SUB.           AP      
                                                                                
           PERFORM 4010-OPEN-XFER-TYPE-CURSOR.                          APKCS327
                                                                        APKCS327
           PERFORM 4020-READ-TRANSFER-TYPES.                            APKCS327
                                                                        APKCS327
           PERFORM 4030-CLOSE-XFER-TYPE-CURSOR.                         APKCS327
                                                                        APKCS327
           ADD +1                      TO ASC-STATUS-TBL-SUB            AP      
           MOVE SPACES                 TO ASC-XFER-TY-ST-FIELD          AP      
                                                (ASC-STATUS-TBL-SUB)    AP      
           ADD +1                      TO ASC-STATUS-TBL-SUB            AP      
           MOVE '  TRANSFER STATUS'    TO ASC-XFER-TY-ST-FIELD          AP      
                                                (ASC-STATUS-TBL-SUB)    AP      
                                                                        APKCS327
           PERFORM 4110-OPEN-XFER-STATUS-CURSOR.                        APKCS327
                                                                        APKCS327
           PERFORM 4120-READ-TRANSFER-STATUS.                           APKCS327
                                                                        APKCS327
           PERFORM 4130-CLOSE-XFER-STATUS-CURSOR.                       APKCS327
                                                                        APKCS327
           MOVE -1                     TO ATRNBR1L.                        CL**2
           SET DP030-SET-CURSOR-APPL-1 TO TRUE.                                 
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                                
                                                                                
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*APKCS327
      * OPENS THE TRANSFER TYPE CURSOR                                 *APKCS327
      *----------------------------------------------------------------*APKCS327
                                                                        APKCS327
       4010-OPEN-XFER-TYPE-CURSOR.                                      APKCS327
                                                                        APKCS327
           EXEC SQL                                                     APKCS327
               OPEN XFER-TYPE-CSR                                       APKCS327
           END-EXEC.                                                    APKCS327
                                                                        APKCS327
           EVALUATE TRUE                                                APKCS327
               WHEN SQLCODE = +0                                        APKCS327
                   CONTINUE                                             APKCS327
               WHEN OTHER                                               APKCS327
                    MOVE '4010-OPEN-XFER-TYPE-CURSOR'                   APKCS327
                                     TO DP013-PARAGRAPH                 APKCS327
                    MOVE 'OPEN XFER-TYPE-CSR CURSOR'                    APKCS327
                                     TO DP013-MESSAGE-TEXT (1)          APKCS327
                    MOVE SQLCA           TO DP013-SQLCA                 APKCS327
                    SET DP013-DB2-ABEND                                 APKCS327
                                     TO TRUE                            APKCS327
                    PERFORM DP013-0000-PROCESS-ABEND                    APKCS327
           END-EVALUATE.                                                APKCS327
                                                                        APKCS327
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*AP      
      *    READ THE TRANSFER TYPES AND DESCRIPTIONS AND PROCESS THEM   *AP      
      *----------------------------------------------------------------*AP      
                                                                        AP      
       4020-READ-TRANSFER-TYPES.                                        AP      
                                                                        AP      
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       AP      
           PERFORM                                                      AP      
               VARYING PV-READ-COUNT                                    AP      
               FROM 1 BY 1                                              AP      
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    AP      
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          AP      
                                                                        AP      
               PERFORM 4025-FETCH-TRANSFER-TYPE                         AP      
                                                                        AP      
               IF  PS-ITEMS-LEFT-ON-DB                                  AP      
                   MOVE TFTYCD-XFER-TYP-CDE(2:1)                        AP      
                                         TO TYPE-ST-FIELD-CODE          AP      
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                          
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                             
                                         TO TYPE-ST-FIELD-DESC                  
                   ELSE                                                         
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '         
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  '         
                           INTO TYPE-ST-FIELD-DESC                              
                   END-IF                                                       
                   ADD +1                TO ASC-STATUS-TBL-SUB          AP      
                   MOVE TYPE-STATUS-FIELD                               AP      
                                         TO ASC-XFER-TY-ST-FIELD        AP      
                                                  (ASC-STATUS-TBL-SUB)  AP      
               END-IF                                                   AP      
           END-PERFORM.                                                 AP      
                                                                        AP      
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*AP      
      *    FETCH THE TRANSFER TYPES AND DESCRIPTIONS                   *AP      
      *----------------------------------------------------------------*AP      
                                                                        AP      
       4025-FETCH-TRANSFER-TYPE.                                        AP      
                                                                        AP      
           EXEC SQL                                                     AP      
               FETCH XFER-TYPE-CSR                                      AP      
                   INTO                                                 AP      
                       :TFTYCD-XFER-TYP-CDE                             AP      
                     , :TFTYCD-TYP-1ST-LNE-DESC                         AP      
                     , :TFTYCD-TYP-2ND-LNE-DESC                         AP      
           END-EXEC.                                                    AP      
                                                                        AP      
           EVALUATE TRUE                                                AP      
               WHEN SQLCODE = ZERO                                      AP      
                    CONTINUE                                            AP      
               WHEN SQLCODE = +100                                      AP      
                    SET PS-NO-ITEMS-LEFT-ON-DB                          AP      
                                       TO TRUE                          AP      
100404         WHEN OTHER                                               AP      
                    MOVE '4025-FETCH-TRANSFER-TYPE'                     AP      
                                     TO DP013-PARAGRAPH                 AP      
                    MOVE 'FETCH XFER-TYPE-CSR CURSOR'                   AP      
                                     TO DP013-MESSAGE-TEXT (1)          AP      
                    MOVE SQLCA           TO DP013-SQLCA                 AP      
                    SET DP013-DB2-ABEND                                 AP      
                                     TO TRUE                            AP      
                    PERFORM DP013-0000-PROCESS-ABEND                    AP      
           END-EVALUATE.                                                AP      
                                                                        AP      
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*APKCS327
      * CLOSE THE TRANSFER TYPE CURSOR                                 *APKCS327
      *----------------------------------------------------------------*APKCS327
                                                                        APKCS327
       4030-CLOSE-XFER-TYPE-CURSOR.                                     APKCS327
                                                                        APKCS327
           EXEC SQL                                                     APKCS327
               CLOSE XFER-TYPE-CSR                                      APKCS327
           END-EXEC.                                                    APKCS327
                                                                        APKCS327
           EVALUATE TRUE                                                10490009
               WHEN SQLCODE = ZERO                                      10500009
                    CONTINUE                                            10510009
               WHEN OTHER                                               APKCS327
                    MOVE '4030-CLOSE-XFER-TYPE-CURSOR'                  10540009
                                 TO  DP013-PARAGRAPH                    10550009
                    MOVE 'CLOSE XFER-TYPE-CSR CURSOR'                   10560009
                                 TO  DP013-MESSAGE-TEXT (1)             10570009
                    MOVE SQLCA   TO  DP013-SQLCA                        10580009
                    SET DP013-DB2-ABEND                                 10590009
                                 TO  TRUE                               10600009
                    PERFORM DP013-0000-PROCESS-ABEND                    10610009
           END-EVALUATE.                                                10620009
                                                                                
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*APKCS327
      * OPENS THE TRANSFER STATUS CURSOR                               *APKCS327
      *----------------------------------------------------------------*APKCS327
                                                                        APKCS327
       4110-OPEN-XFER-STATUS-CURSOR.                                    APKCS327
                                                                        APKCS327
           EXEC SQL                                                     APKCS327
               OPEN XFER-STATUS-CSR                                     APKCS327
           END-EXEC.                                                    APKCS327
                                                                        APKCS327
           EVALUATE TRUE                                                APKCS327
               WHEN SQLCODE = +0                                        APKCS327
                   CONTINUE                                             APKCS327
               WHEN OTHER                                               APKCS327
                    MOVE '4110-OPEN-XFER-STATUS-CURSOR'                 APKCS327
                                     TO DP013-PARAGRAPH                 APKCS327
                    MOVE 'OPEN XFER-STATUS-CSR CURSOR'                  APKCS327
                                     TO DP013-MESSAGE-TEXT (1)          APKCS327
                    MOVE SQLCA           TO DP013-SQLCA                 APKCS327
                    SET DP013-DB2-ABEND                                 APKCS327
                                     TO TRUE                            APKCS327
                    PERFORM DP013-0000-PROCESS-ABEND                    APKCS327
           END-EVALUATE.                                                APKCS327
                                                                        APKCS327
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*AP      
      *    READ THE TRANSFER STATUSES AND DESCRIPTIONS AND PROCESS THEM AP      
      *----------------------------------------------------------------*AP      
                                                                        AP      
       4120-READ-TRANSFER-STATUS.                                       AP      
                                                                        AP      
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       AP      
           PERFORM                                                      AP      
               VARYING PV-READ-COUNT                                    AP      
               FROM 1 BY 1                                              AP      
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    AP      
                  OR (ASC-STATUS-TBL-SUB = PC-MAX-TYPE-SCR-LINES)       AP      
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          AP      
                                                                        AP      
               PERFORM 4125-FETCH-TRANSFER-STATUS                       AP      
                                                                        AP      
               IF  PS-ITEMS-LEFT-ON-DB                                  AP      
                   ADD 1                 TO PV-XFER-STATUS-COUNT        AP      
                   MOVE PV-XFER-STATUS-COUNT                            AP      
                                         TO TYPE-ST-FIELD-CODE          AP      
                   IF TFSTCD-XFER-STAT-CDE = PC-RECEIVED-STATUS         AP      
                       MOVE PC-RECEIVED-STATUS-DESC                     AP      
                                         TO TYPE-ST-FIELD-DESC                  
                   ELSE                                                 AP      
                       MOVE TFSTCD-XFER-STAT-DESC                       AP      
                                         TO TYPE-ST-FIELD-DESC                  
                   END-IF                                               AP      
                   ADD +1                TO ASC-STATUS-TBL-SUB          AP      
                   MOVE TYPE-STATUS-FIELD                               AP      
                                         TO ASC-XFER-TY-ST-FIELD        AP      
                                                  (ASC-STATUS-TBL-SUB)  AP      
               END-IF                                                   AP      
           END-PERFORM.                                                 AP      
                                                                        AP      
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*AP      
      *    FETCH THE TRANSFER STATUS AND DESCRIPTION                   *AP      
      *----------------------------------------------------------------*AP      
                                                                        AP      
       4125-FETCH-TRANSFER-STATUS.                                      AP      
                                                                        AP      
           EXEC SQL                                                     AP      
               FETCH XFER-STATUS-CSR                                    AP      
                   INTO                                                 AP      
                       :TFSTCD-XFER-STAT-CDE                            AP      
                     , :TFSTCD-XFER-STAT-DESC                           AP      
           END-EXEC.                                                    AP      
                                                                        AP      
           EVALUATE TRUE                                                AP      
               WHEN SQLCODE = ZERO                                      AP      
                    CONTINUE                                            AP      
               WHEN SQLCODE = +100                                      AP      
                    SET PS-NO-ITEMS-LEFT-ON-DB                          AP      
                                       TO TRUE                          AP      
               WHEN OTHER                                               AP      
                    MOVE '4125-FETCH-TRANSFER-STATUS'                   AP      
                                     TO DP013-PARAGRAPH                 AP      
                    MOVE 'FETCH XFER-STATUS-CSR CURSOR'                 AP      
                                     TO DP013-MESSAGE-TEXT (1)          AP      
                    MOVE SQLCA           TO DP013-SQLCA                 AP      
                    SET DP013-DB2-ABEND                                 AP      
                                     TO TRUE                            AP      
                    PERFORM DP013-0000-PROCESS-ABEND                    AP      
           END-EVALUATE.                                                AP      
                                                                        AP      
       EJECT                                                            APKCS327
      *----------------------------------------------------------------*APKCS327
      * CLOSE THE TRANSFER STATUS CURSOR                               *APKCS327
      *----------------------------------------------------------------*APKCS327
                                                                        APKCS327
       4130-CLOSE-XFER-STATUS-CURSOR.                                   APKCS327
                                                                        APKCS327
           EXEC SQL                                                     APKCS327
               CLOSE XFER-STATUS-CSR                                    APKCS327
           END-EXEC.                                                    APKCS327
                                                                        APKCS327
           EVALUATE TRUE                                                10490009
               WHEN SQLCODE = ZERO                                      10500009
                    CONTINUE                                            10510009
               WHEN OTHER                                               APKCS327
                    MOVE '4130-CLOSE-XFER-STATUS-CURSOR'                10540009
                                 TO  DP013-PARAGRAPH                    10550009
                    MOVE 'CLOSE XFER-STATUS-CSR CURSOR'                 10560009
                                 TO  DP013-MESSAGE-TEXT (1)             10570009
                    MOVE SQLCA   TO  DP013-SQLCA                        10580009
                    SET DP013-DB2-ABEND                                 10590009
                                 TO  TRUE                               10600009
                    PERFORM DP013-0000-PROCESS-ABEND                    10610009
           END-EVALUATE.                                                10620009
                                                                                
      ******************************************************************        
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *        
      ******************************************************************        
       4400-MOVE-COMMAREA-TO-SCREEN.                                            
                                                                                
100404     MOVE ASC-XFER-NBR-1-4         TO ATRNBR1O.                      CL*28
100404     MOVE ASC-XFER-NBR-5-10        TO ATRNBR2O.                      CL*28
           MOVE ASC-XFER-TYPE-SORT-NR    TO ASXFRTYPO.                     CL*28
           MOVE ASC-XFER-TYPE            TO AXFRTYPO.                      CL*28
           MOVE ASC-XFER-TYPE-DESC       TO AXFRTYPDO.                     CL*28
           MOVE ASC-XFER-STATUS-SORT-NR  TO ASXFRSTAO.                     CL*28
           MOVE ASC-XFER-STATUS          TO AXFRSTAO.                      CL*28
           MOVE ASC-XFER-STATUS-DESC     TO AXFRSTADO.                     CL*28
           MOVE ASC-FROM-STORE-SORT-NR   TO ASFRSTORO.                     CL*28
100404     MOVE ASC-FROM-STORE           TO AFRSTORO.                      CL*28
           MOVE ASC-TO-STORE-SORT-NR     TO ASTOSTORO.                     CL*28
100404     MOVE ASC-TO-STORE             TO ATOSTORO.                      CL*28
           MOVE ASC-COMP-DTE-SORT-NR     TO ASCMDTERO.                     CL*28
           MOVE ASC-COMP-BEG-MM          TO ACMPDBMMO.                     CL*28
           MOVE ASC-COMP-BEG-DD          TO ACMPDBDDO.                     CL*28
           MOVE ASC-COMP-BEG-YR          TO ACMPDBYRO.                     CL*28
           MOVE ASC-COMP-END-MM          TO ACMPDEMMO.                     CL*28
           MOVE ASC-COMP-END-DD          TO ACMPDEDDO.                     CL*28
           MOVE ASC-COMP-END-YR          TO ACMPDEYRO.                     CL*28
           MOVE ASC-RECV-DTE-SORT-NR     TO ASRCDTERO.                     CL*28
           MOVE ASC-RECV-BEG-MM          TO ARCVDBMMO.                     CL*28
           MOVE ASC-RECV-BEG-DD          TO ARCVDBDDO.                     CL*28
           MOVE ASC-RECV-BEG-YR          TO ARCVDBYRO.                     CL*28
           MOVE ASC-RECV-END-MM          TO ARCVDEMMO.                     CL*28
           MOVE ASC-RECV-END-DD          TO ARCVDEDDO.                     CL*28
           MOVE ASC-RECV-END-YR          TO ARCVDEYRO.                     CL*28
           MOVE ASC-DEPT-NBR             TO ADEPTO.                        CL*28
           MOVE ASC-CLASS-NBR            TO ACLASSO.                       CL*28
           MOVE ASC-SUBCL-NBR            TO ASUBCLO.                       CL*28
           MOVE ASC-UPC-NBR              TO ATRUPCO.                       CL*28
           MOVE ASC-CALLBCK-NR-SORT-NR   TO ASCALLNOO.                     CL*28
           MOVE ASC-CALLBACK-NBR         TO ACALLNOO.                      CL*28
           MOVE ASC-APPRV-NR-SORT-NR     TO ASAPPRNOO.                     CL*28
           MOVE ASC-APPROVAL-NBR         TO AAPPRNOO.                      CL*28
           MOVE ASC-COMP-BY-FIRST-INIT   TO ACMPBYINO.                     CL*28
           MOVE ASC-COMP-BY-LAST-NAME    TO ACMPBYNMO.                     CL*28
           MOVE ASC-RECV-BY-FIRST-INIT   TO ARCVBYINO.                     CL*28
           MOVE ASC-RECV-BY-LAST-NAME    TO ARCVBYNMO.                     CL*28
           MOVE ASC-DISPLAY-TOTALS       TO ADISPTOTO.                     CL*28
                                                                                
           MOVE ASC-XFER-TY-ST-FIELD (1)  TO ATRTYST01O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (2)  TO ATRTYST02O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (3)  TO ATRTYST03O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (4)  TO ATRTYST04O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (5)  TO ATRTYST05O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (6)  TO ATRTYST06O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (7)  TO ATRTYST07O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (8)  TO ATRTYST08O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (9)  TO ATRTYST09O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (10) TO ATRTYST10O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (11) TO ATRTYST11O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (12) TO ATRTYST12O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (13) TO ATRTYST13O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (14) TO ATRTYST14O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (15) TO ATRTYST15O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (16) TO ATRTYST16O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (17) TO ATRTYST17O.                AP      
           MOVE ASC-XFER-TY-ST-FIELD (18) TO ATRTYST18O.                AP      
                                                                        AP      
           EJECT                                                        17680010
      ******************************************************************        
      *    SELECT THE TTFMSTR TABLE ROW FOR A TRANSFER NUMBER.                  
      ******************************************************************        
       5000-VERIFY-TRANSFER-EXISTS.                                     17690009
                                                                        17700009
100404     MOVE ASC-XFER-NBR-1-4         TO  TFMSTR-FR-STR-NBR.                 
100404     MOVE ASC-XFER-NBR-5-10        TO  TFMSTR-XFER-SEQ-NBR.               
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT                                                       
                          XFER_DKEY_ID                                          
                    INTO :TFMSTR-XFER-DKEY-ID                                   
                    FROM TTFMSTR                                                
                   WHERE FR_STR_NBR   = :TFMSTR-FR-STR-NBR                      
                     AND XFER_SEQ_NBR = :TFMSTR-XFER-SEQ-NBR                    
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        SET PS-TXFER-FOUND     TO TRUE                          
                        MOVE TFMSTR-XFER-DKEY-ID TO ASC-XFER-DKEY-ID            
                   WHEN SQLCODE = +100                                          
                        SET PS-TXFER-NOT-FOUND TO TRUE                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
                   WHEN OTHER                                                   
                        MOVE '5000-VERIFY-TRANSFER-EXISTS'                      
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
                        MOVE 'TTFMSTR'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '5000-VERIFY-TRANSFER-EXISTS'                               
                                        TO DP013-PARAGRAPH                      
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                           
                                        TO DP013-MESSAGE-TEXT (1)               
               MOVE SQLCA               TO DP013-SQLCA                          
               MOVE 'TTFMSTR   '        TO DP013-DB2-TABLE-NAME (1)             
               SET DP013-DB2-ABEND                                              
                   DP013-XCTL-DISPLAY-RESTART                                   
                                        TO TRUE                                 
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
           EJECT                                                        17680010
      ******************************************************************        
      *    SELECT THE CURRENT TTFSTAT TABLE ROW FOR A TRANSFER NUMBER.          
      ******************************************************************        
       5100-SELECT-CURR-XFER-STATUS.                                    17690009
                                                                        17700009
           MOVE ASC-XFER-DKEY-ID         TO  TFSTAT-XFER-DKEY-ID.               
                                                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT  A.XFER_STAT_CDE,                                     
                           B.XFER_STAT_DESC                                     
                     INTO  :TFSTAT-XFER-STAT-CDE,                               
                           :TFSTCD-XFER-STAT-DESC                               
                     FROM  TTFSTAT  A,                                          
                           TTFSTCD  B                                           
                     WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID                  
                       AND   A.XFER_STAT_CDE  =  B.XFER_STAT_CDE                
                       AND XFER_STAT_TMST =                                     
                           (SELECT MAX (XFER_STAT_TMST)                         
                             FROM TTFSTAT                                       
                            WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID)          
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                        CONTINUE                                                
                   WHEN SQLCODE = +100                                          
                        MOVE SPACES     TO TFSTAT-XFER-STAT-CDE                 
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
                   WHEN OTHER                                                   
                        MOVE '5100-SELECT-CURR-XFER-STATUS'                     
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
                        MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)             
                        MOVE 'TTFSTCD'  TO DP013-DB2-TABLE-NAME (2)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '5100-SELECT-CURR-XFER-STATUS'                              
                                        TO DP013-PARAGRAPH                      
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                           
                                        TO DP013-MESSAGE-TEXT (1)               
               MOVE SQLCA               TO DP013-SQLCA                          
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)             
               MOVE 'TTFSTCD'           TO DP013-DB2-TABLE-NAME (2)             
               SET DP013-DB2-ABEND                                              
                   DP013-XCTL-DISPLAY-RESTART                                   
                                        TO TRUE                                 
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
           EJECT                                                        17680010
      ******************************************************************        
      *    SELECT THE TTFTYCD TABLE ROW FOR A TRANSFER TYPE CODE.               
      ******************************************************************        
       5200-SELECT-XFER-TYPE-CD-INFO.                                   17690009
                                                                        17700009
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT                                                       
                          TYP_1ST_LNE_DESC                                      
                        , TYP_2ND_LNE_DESC                                      
                   INTO  :TFTYCD-TYP-1ST-LNE-DESC                               
                        ,:TFTYCD-TYP-2ND-LNE-DESC                               
                   FROM TTFTYCD                                                 
                   WHERE XFER_TYP_CDE = :TFTYCD-XFER-TYP-CDE                    
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                   WHEN OTHER                                                   
                        MOVE '5200-SELECT-XFER-TYPE-CD-INFO'                    
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
                        MOVE 'TTFTYCD'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '5200-SELECT-XFER-TYPE-CD-INFO'                             
                                        TO DP013-PARAGRAPH                      
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                           
                                        TO DP013-MESSAGE-TEXT (1)               
               MOVE SQLCA               TO DP013-SQLCA                          
               MOVE 'TTFTYCD '          TO DP013-DB2-TABLE-NAME (1)             
               SET DP013-DB2-ABEND                                              
                   DP013-XCTL-DISPLAY-RESTART                                   
                                        TO TRUE                                 
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
           EJECT                                                        17680010
      ******************************************************************        
100404*    SELECT THE XST_LOC TABLE ROW FOR A STORE NUMBER.                     
      ******************************************************************        
       5400-SELECT-STORE.                                               17690009
                                                                        17700009
               EXEC SQL                                                         
100404             SELECT LOC_NBR                                               
100404              INTO :XST00001-LOC-NBR                                      
100404              FROM XST_LOC                                                
100404             WHERE LOC_NBR     = :XST00001-LOC-NBR                   CL*33
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
100404             WHEN OTHER                                                   
                        MOVE '5400-SELECT-STORE'                                
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
100404                  MOVE 'XST_LOC'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE.                                                    
                                                                                
           EJECT                                                        17680010
      ******************************************************************        
      *    DETERMINE IF A TSKXREF TABLE ROW EXISTS FOR A DPT NUMBER.            
      ******************************************************************        
       5500-VERIFY-DEPARTMENT.                                          17690009
                                                                        17700009
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0))                                           
                                                                                
               EXEC SQL                                                         
                   SELECT                                                       
                          COUNT (DISTINCT DEPT)                                 
                    INTO :PV-DEPT-NMBR-COUNT                                    
                    FROM TSKXREF                                                
                   WHERE DEPT = :SKXREF-DEPT                            17700009
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
                   WHEN OTHER                                                   
                        MOVE '5500-VERIFY-DEPARTMENT'                           
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
                        MOVE 'TSKXREF'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '5500-VERIFY-DEPARTMENT'                                    
                                        TO DP013-PARAGRAPH                      
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                           
                                        TO DP013-MESSAGE-TEXT (1)               
               MOVE SQLCA               TO DP013-SQLCA                          
               MOVE 'TSKXREF'           TO DP013-DB2-TABLE-NAME (1)             
               SET DP013-DB2-ABEND                                              
                   DP013-XCTL-DISPLAY-RESTART                                   
                                        TO TRUE                                 
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
           EJECT                                                        17680010
      ******************************************************************        
      *    DETERMINE IF A TSKXREF TABLE ROW EXISTS FOR A DEPT/CLASS NO.         
      ******************************************************************        
       5600-VERIFY-DEPARTMENT-CLASS.                                    17690009
                                                                        17700009
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0))                                           
                                                                                
               EXEC SQL                                                         
                   SELECT                                                       
                          COUNT (DISTINCT DEPT)                                 
                    INTO :PV-DEPT-CL-COUNT                                      
                    FROM TSKXREF                                                
                   WHERE DEPT  = :SKXREF-DEPT                           17700009
                     AND CLASS = :SKXREF-CLASS                          17700009
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
                   WHEN OTHER                                                   
                        MOVE '5600-VERIFY-DEPARTMENT-CLASS'                     
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
                        MOVE 'TSKXREF'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
               MOVE '5600-VERIFY-DEPARTMENT-CLASS'                              
                                        TO DP013-PARAGRAPH                      
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                           
                                        TO DP013-MESSAGE-TEXT (1)               
               MOVE SQLCA               TO DP013-SQLCA                          
               MOVE 'TSKXREF'           TO DP013-DB2-TABLE-NAME (1)             
               SET DP013-DB2-ABEND                                              
                   DP013-XCTL-DISPLAY-RESTART                                   
                                        TO TRUE                                 
               PERFORM DP013-0000-PROCESS-ABEND                                 
           END-IF.                                                              
                                                                                
           EJECT                                                        17680010
                                                                                
                                                                                
       5700-SELECT-UPC.                                                 17690009
                                                                        17700009
               EXEC SQL                                                         
100404             SELECT UPC_NBR                                               
100404              INTO :XST00012-UPC-NBR                                      
100404              FROM XST_UPC                                                
100404             WHERE UPC_NBR        = :XST00012-UPC-NBR                     
100404               AND LAST_ACTN_CDE IN ('A', 'U')                            
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = +0                                            
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                        CONTINUE                                                
                                                                                
100404             WHEN OTHER                                                   
                        MOVE '5700-SELECT-UPC'                                  
                                        TO DP013-PARAGRAPH                      
                        MOVE 'UNSUCCESSFUL SELECT'                              
                                        TO DP013-MESSAGE-TEXT (1)               
                        MOVE SQLCA      TO DP013-SQLCA                          
100404                  MOVE 'XST_UPC'  TO DP013-DB2-TABLE-NAME (1)             
                        SET DP013-DB2-ABEND                                     
                            DP013-XCTL-DISPLAY-RESTART                          
                                        TO TRUE                                 
                        PERFORM DP013-0000-PROCESS-ABEND                        
               END-EVALUATE.                                                    
                                                                                
           EJECT                                                        17680010
      *----------------------------------------------------------------*        
      *  GET THE MAX RECEIPT TIMESTAMP.                                         
      *----------------------------------------------------------------*        
       7150-SELECT-MAX-RCPT-TMST.                                               
           MOVE ASC-XFER-DKEY-ID          TO  TFMSTR-XFER-DKEY-ID.              
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT  MAX(RCV_XFER_BEG_TMST)                               
                     INTO  :TFRCPT-RCV-XFER-BEG-TMST                            
                               :PV-NULL-IND                                     
                     FROM  TTFRCPT                                              
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)              
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = ZERO                                          
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                       CONTINUE                                                 
                   WHEN OTHER                                                   
                       MOVE '7150-SELECT-MAX-RCPT-TMST'                         
                                             TO DP013-PARAGRAPH                 
                       MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '           
                                             TO DP013-MESSAGE-TEXT (1)          
                       MOVE TFMSTR-XFER-DKEY-ID                                 
                                             TO PV-DISPLAY-XFER-DKEY-ID         
                       MOVE PV-DISPLAY-XFER-DKEY-ID                             
                                             TO DP013-MESSAGE-TEXT (2)          
                       MOVE SQLCA            TO DP013-SQLCA                     
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)        
                       SET DP013-DB2-ABEND                                      
                           DP013-XCTL-DISPLAY-RESTART                           
                                             TO TRUE                            
                       PERFORM DP013-0000-PROCESS-ABEND                         
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
                   MOVE '7150-SELECT-MAX-RCPT-TMST'                             
                                             TO DP013-PARAGRAPH                 
                   MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '               
                                             TO DP013-MESSAGE-TEXT (1)          
                   MOVE TFMSTR-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID         
                   MOVE PV-DISPLAY-XFER-DKEY-ID                                 
                                             TO DP013-MESSAGE-TEXT (2)          
                   MOVE SQLCA                TO DP013-SQLCA                     
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)        
                   SET DP013-DB2-ABEND                                          
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-IF.                                                              
      *                                                                         
      *----------------------------------------------------------------*        
      *  GET THE CURRENT RECEIPT END TIMESTAMP.                                 
      *----------------------------------------------------------------*        
       7200-SELECT-CURRENT-RCPT.                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT  RCV_XFER_END_TMST                                    
                     INTO  :TFRCPT-RCV-XFER-END-TMST                            
                     FROM  TTFRCPT                                              
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID  AND          
                       RCV_XFER_BEG_TMST  =  :TFRCPT-RCV-XFER-BEG-TMST)         
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = ZERO                                          
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                       CONTINUE                                                 
                   WHEN OTHER                                                   
                       MOVE '7200-SELECT-CURRENT-RCPT'                          
                                             TO DP013-PARAGRAPH                 
                       MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIM        
      -                 'MP: '           TO DP013-MESSAGE-TEXT (1)              
                       MOVE TFMSTR-XFER-DKEY-ID                                 
                                             TO PV-DISPLAY-XFER-DKEY-ID         
                       MOVE PV-DISPLAY-XFER-DKEY-ID                             
                                             TO DP013-MESSAGE-TEXT (2)          
                       MOVE TFRCPT-RCV-XFER-BEG-TMST                            
                                             TO DP013-MESSAGE-TEXT (3)          
                       MOVE SQLCA            TO DP013-SQLCA                     
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)        
                       SET DP013-DB2-ABEND                                      
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                       PERFORM DP013-0000-PROCESS-ABEND                         
               END-EVALUATE                                                     
           END-PERFORM.                                                         
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
                   MOVE '7200-SELECT-CURRENT-RCPT'                              
                                             TO DP013-PARAGRAPH                 
                   MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIMESTA        
      -                 'MP: '               TO DP013-MESSAGE-TEXT (1)          
                   MOVE TFMSTR-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID         
                   MOVE PV-DISPLAY-XFER-DKEY-ID                                 
                                             TO DP013-MESSAGE-TEXT (2)          
                   MOVE TFRCPT-RCV-XFER-BEG-TMST                                
                                             TO DP013-MESSAGE-TEXT (3)          
                   MOVE SQLCA                TO DP013-SQLCA                     
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)        
                   SET DP013-DB2-ABEND                                          
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-IF.                                                              
      ******************************************************************        
      *    ABEND PROCESSOR MODULE                                      *        
      ******************************************************************        
                                                                                
           COPY DPPD013.                                                        
