000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300***************************************************************** 00030002
000400                                                                  00040002
000500 PROGRAM-ID.             PCKRP012.                                00050002
000600 AUTHOR.                 PATRICK BURKE.                           00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN.           JANUARY 2002.                            00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100***************************************************************** 00110002
001200*  THIS PROGRAM TAKE THE EXTRACT FILE CREATED IN PCKUT019 AND     00120002
001300*  CREATES A SUMMARY REPORT TO LIST UNITS WORKED BY OPERATIONAL   00130002
001400*  UNIT.                                                          00140002
001500***************************************************************** 00150002
001600* THIS PROGRAM WILL REPORT ON ANY DISCREPANCIES BETWEEN WHAT      00160002
001700* THE ADVANCED ORACLE QUEUE FOUND FOR PROCESSING AND WHAT WAS     00170002
001800* ACTUALLY PROCESSED.                                             00180002
001900***************************************************************** 00190002
002000 ENVIRONMENT DIVISION.                                            00200002
002100***************************************************************** 00210002
002200 CONFIGURATION SECTION.                                           00220002
002300 SOURCE-COMPUTER.                        IBM-3090.                00230002
002400 OBJECT-COMPUTER.                        IBM-3090.                00240002
002500 INPUT-OUTPUT SECTION.                                            00250002
002600 FILE-CONTROL.                                                    00260002
002700                                                                  00270002
002800     SELECT EXTRACT-FILE                                          00280002
002900         ASSIGN TO INP01.                                         00290002
003000                                                                  00300002
003100     SELECT REPORT-FILE-1                                         00310002
003200         ASSIGN TO RPT01.                                         00320002
003300                                                                  00330002
003400     SELECT REPORT-FILE-2                                         00340002
003500         ASSIGN TO RPT02.                                         00350002
003600                                                                  00360002
003700***************************************************************** 00370002
003800 DATA DIVISION.                                                   00380002
003900***************************************************************** 00390002
004000 FILE SECTION.                                                    00400002
004100                                                                  00410002
004200 FD  EXTRACT-FILE                                                 00420002
004300     RECORDING MODE IS F                                          00430002
004400     LABEL RECORDS ARE STANDARD                                   00440002
004500     BLOCK CONTAINS 0 RECORDS.                                    00450002
004600 01  EXTRACT-RECORD                   PIC X(170).                 00460002
004700                                                                  00470002
004800 FD  REPORT-FILE-1                                                00480002
004900     RECORDING MODE IS F                                          00490002
005000     BLOCK CONTAINS 0 RECORDS.                                    00500002
005100 01  REPORT-RECORD-1                  PIC X(132).                 00510002
005200                                                                  00520002
005300 FD  REPORT-FILE-2                                                00530002
005400     RECORDING MODE IS F                                          00540002
005500     BLOCK CONTAINS 0 RECORDS.                                    00550002
005600 01  REPORT-RECORD-2                  PIC X(132).                 00560002
005700/                                                                 00570002
005800***************************************************************** 00580002
005900 WORKING-STORAGE SECTION.                                         00590002
006000***************************************************************** 00600002
006100*  CONTROL CARD LAYOUT.                                           00610008
006200**************************************************************    00620008
006300     COPY PCWS239.                                                00630008
006400/                                                                 00640008
006500**************************************************************    00650002
006600                                                                  00660002
006700 01  PS-SWITCHES.                                                 00670002
006800     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00680002
006900         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00690002
007000         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00700002
007100     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00710002
007200         88  PS-END-OF-INPUT                    VALUE 'Y'.        00720002
007300         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00730002
007400     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00740002
007500         88  PS-NEW-PAGE                       VALUE 'Y'.         00750002
007600         88  PS-SAME-PAGE                      VALUE 'N'.         00760002
007700     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00770002
007800         88  PS-PRINT-LINE                      VALUE 'Y'.        00780002
007900                                                                  00790002
008000 01  DK-DB2-KEYS.                                                 00800002
008100     05  DK-RUN-DATE                  PIC X(10).                  00810002
008200     05  DK-WEEK-END-DATE             PIC X(10).                  00820002
008300                                                                  00830002
008400                                                                  00840002
008500 01  PV-DATE-RECORD.                                              00850002
008600     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00860002
008700     05  FILLER                       PIC X(01) VALUE SPACES.     00870002
008800     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00880002
008900                                                                  00890002
009000 01  SD-SYSTEM-DATE.                                              00900002
009100     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00910002
009200     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00920002
009300     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00930002
009400                                                                  00940002
009500 01  ST-SYSTEM-TIME.                                              00950002
009600     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00960002
009700     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00970002
009800     05  FILLER                     PIC  9(04)   VALUE ZERO.      00980002
009900                                                                  00990002
010000 01  PV-VARIABLES.                                                01000002
010100     05  PV-READ-COUNT                PIC S9(7) COMP-3            01010002
010200                                                VALUE ZERO.       01020002
010300     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01030002
010400                                                VALUE ZERO.       01040002
010500     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01050002
010600                                                VALUE ZERO.       01060002
010700     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01070002
010800                                                VALUE ZERO.       01080002
010900     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01090002
011000                                                 COMP SYNC.       01100002
011100     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       01110002
011200                                                 COMP-3.          01120002
011300     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       01130002
011400                                                 COMP-3.          01140002
011500     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       01150002
011600                                                 COMP-3.          01160002
011700     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    01170002
011800                                                 COMP-3.          01180002
011900     05  PV-DEPT                      PIC 9(03) VALUE ZEROS.      01190002
012000     05  PV-STORE-NBR                 PIC S9(4) COMP.             01200002
012100     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01210002
012200     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01220002
012300     05  PV-OPER-ID                   PIC S9(4) COMP.             01230002
012400     05  PV-PREV-OPER-ID              PIC 9(04) VALUE ZEROS.      01240002
012500     05  PV-SHIFT-NBR                 PIC 9(01) VALUE ZEROS.      01250002
012600     05  PV-UNIT-RETAIL               PIC X(14) VALUE SPACES.     01260002
012700     05  PV-OPER-DESC                 PIC X(05) VALUE SPACES.     01270002
012800     05  PV-EXTENDED-RETAIL           PIC S9(12)V99.              01280002
012900     05  PV-EXTENDED-RETAIL-Z         PIC ZZZ,ZZZ,ZZZ.ZZ-         01290002
013000                                                 VALUE ZEROS.     01300002
013100                                                                  01310002
013200     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01320002
013300     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01330002
013400     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01340002
013500                                                                  01350002
013600     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01360002
013700     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01370002
013800     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01380002
013900     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01390002
014000     05  PV-DB2-YEAR                  PIC S9(08) COMP             01400002
014100                                          VALUE ZERO.             01410002
014200     05  PV-DB2-MONTH                 PIC S9(08) COMP             01420002
014300                                          VALUE ZERO.             01430002
014400     05  PV-DB2-DAY                   PIC S9(08) COMP             01440002
014500                                          VALUE ZERO.             01450002
014600     05  PV-DB2-HOUR                  PIC S9(08) COMP             01460002
014700                                          VALUE ZERO.             01470002
014800     05  PV-DB2-MINUTE                PIC S9(08) COMP             01480002
014900                                          VALUE ZERO.             01490002
015000     05  PV-DB2-SECOND                PIC S9(08) COMP             01500002
015100                                          VALUE ZERO.             01510002
015200                                                                  01520002
015300     05  PV-DIVIDEND                  PIC 9(03)V9999.             01530002
015400     05  PV-TIMESTAMP                 PIC X(26).                  01531013
015500                                                                  01540002
015600******************************************************************01550002
015700 01  PV-DETAIL-LINE.                                              01560002
015800     05  PV-OPER-TOT-UNITS            PIC S9(09) VALUE +0 COMP.   01570002
015900     05  PV-DC-COMP-PERCENT           PIC S9(03)V9 VALUE +0       01580003
016000                                                 COMP.            01590002
016100     05  PV-OPER-TOT-RETAIL           PIC S9(09) VALUE +0 COMP.   01600003
016200     05  PV-OPER-VRFD-PO              PIC S9(09) VALUE +0 COMP.   01610002
016300     05  PV-OPER-VRFD-UNITS           PIC S9(09) VALUE +0 COMP.   01620002
016400     05  PV-OPER-VRFD-RETAIL          PIC S9(09) VALUE +0 COMP.   01630002
016500                                                                  01640002
016600 01  PV-TOTAL-LINE.                                               01650002
016700     05  PV-COMP-TOT-UNITS            PIC S9(09) VALUE +0 COMP.   01660002
016800     05  PV-COMP-PERCENT              PIC S9(03)V9 VALUE +0       01670003
016900                                                 COMP.            01680002
017000     05  PV-COMP-TOT-RETAIL           PIC S9(09) VALUE +0 COMP.   01690003
017100     05  PV-COMP-VRFD-PO              PIC S9(09) VALUE +0 COMP.   01700002
017200     05  PV-COMP-VRFD-UNITS           PIC S9(09) VALUE +0 COMP.   01710002
017300     05  PV-COMP-VRFD-RETAIL          PIC S9(09) VALUE +0 COMP.   01720002
017400*                                                                 01730002
017500******************************************************************01740002
017600 01  PV-VERIFIED-DATE.                                            01750002
017700     05  PV-VERIFIED-MM             PIC  X(02)   VALUE SPACES.    01760002
017800     05  FILLER                     PIC  X(01)   VALUE '/'.       01770002
017900     05  PV-VERIFIED-DD             PIC  X(02)   VALUE SPACES.    01780002
018000     05  FILLER                     PIC  X(01)   VALUE '/'.       01790002
018100     05  PV-VERIFIED-CC             PIC  X(02)   VALUE '20'.      01800002
018200     05  PV-VERIFIED-YY             PIC  X(02)   VALUE SPACES.    01810002
018300                                                                  01820002
018400 01  PV-FORMAT-DATE.                                              01830002
018500     05  PV-FORMAT-CCYY           PIC  X(04)   VALUE SPACES.      01840002
018600     05  FILLER                   PIC  X(01)   VALUE '/'.         01850002
018700     05  PV-FORMAT-MM             PIC  X(02)   VALUE SPACES.      01860002
018800     05  FILLER                   PIC  X(01)   VALUE '/'.         01870002
018900     05  PV-FORMAT-DD             PIC  X(02)   VALUE SPACES.      01880002
019000                                                                  01890002
019100 01  PV-BUCKETS COMP-3.                                           01900002
019200     05  PV-CLASS-TOTAL-UNITS      PIC S9(7) VALUE ZERO.          01910002
019300     05  PV-CLASS-TOTAL-RETAIL     PIC S9(10)V99 VALUE ZERO.      01920002
019400                                                                  01930002
019500     05  PV-DEPT-TOTAL-UNITS       PIC S9(7) VALUE ZERO.          01940002
019600     05  PV-DEPT-TOTAL-RETAIL      PIC S9(10)V99 VALUE ZERO.      01950002
019700                                                                  01960002
019800     05  PV-LOC-TOTAL-UNITS        PIC S9(7) VALUE ZERO.          01970002
019900     05  PV-LOC-TOTAL-RETAIL       PIC S9(10)V99 VALUE ZERO.      01980002
020000                                                                  01990002
020100 01  PV-ABEND-FIELDS.                                             02000002
020200     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02010002
020300                                                 COMP SYNC.       02020002
020400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'PCKRP012'.02030002
020500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02040002
020600     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02050002
020700     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02060002
020800     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02070002
020900     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02080002
021000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02090002
021100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02100002
021200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02110002
021300/                                                                 02120002
021400 01  PC-CONSTANTS.                                                02130002
021500     05  PC-PCKRP012                  PIC X(08) VALUE 'PCKRP012'. 02140003
021600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP012'. 02150003
021700     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02160002
021800     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02170002
021900                                                COMP-3.           02180002
022000/                                                                 02190002
022100******************************************************************02200002
022200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02210002
022300******************************************************************02220002
022400     COPY DPWS132O.                                               02230002
022500*                                                                 02240002
022600 01  HL-HEADING-LINE-1.                                           02250002
022700     05  HL1-SPECIAL-RUN             PIC  X(39).                  02260002
022800     05  FILLER                      PIC  X(47)  VALUE            02270003
022900      'SUMMARY LISTING OF UNITS WORKED BY OPERATIONAL '.          02280003
023000     05  FILLER                      PIC  X(39)  VALUE            02290002
023100      'UNIT                                   '.                  02300003
023200                                                                  02310002
023300 01  HL-HEADING-LINE-1B.                                          02320002
023400     05  HL1B-REQUEST1               PIC  X(17).                  02330002
023500     05  HL1B-USER-ID                PIC  X(08).                  02340002
023600     05  HL1B-REQUEST2               PIC  X(04).                  02350002
023700     05  FILLER                      PIC  X(10)  VALUE SPACES.    02360005
023800     05  FILLER                      PIC  X(26)  VALUE            02370002
023900      'BUSINESS DATE RANGE FROM: '.                               02380002
024000     05  HL1B-FROM-DATE.                                          02390002
024100         10  HL1B-FROM-MM            PIC 99.                      02400002
024200         10  FILLER                  PIC X VALUE '/'.             02410002
024300         10  HL1B-FROM-DD            PIC 99.                      02420002
024400         10  FILLER                  PIC X VALUE '/'.             02430002
024500         10  HL1B-FROM-CCYY          PIC 9(04).                   02440002
024600     05  FILLER                      PIC X(4)  VALUE              02450002
024700            ' TO '.                                               02460002
024800     05  HL1B-TO-DATE.                                            02470002
024900         10  HL1B-TO-MM              PIC 99.                      02480002
025000         10  FILLER                  PIC X VALUE '/'.             02490002
025100         10  HL1B-TO-DD              PIC 99.                      02500002
025200         10  FILLER                  PIC X VALUE '/'.             02510002
025300         10  HL1B-TO-CCYY            PIC 9(04).                   02520002
025400     05  FILLER                      PIC  X(47)  VALUE SPACES.    02530002
025500                                                                  02540002
025600 01  HL-HEADING-LINE-2.                                           02550002
025700     05  FILLER                      PIC  X(31)  VALUE            02560003
025800            'OPER UNIT  - CORPORATE SUMMARY'.                     02570003
025900     05  FILLER                      PIC  X(101)  VALUE SPACES.   02580003
026000                                                                  02590002
026100 01  HL-HEADING-LINE-3.                                           02600002
026200     05  FILLER                      PIC  X(50)  VALUE            02610006
026300           '                                               UNI'.  02620006
026400     05  FILLER                      PIC  X(44)  VALUE            02630002
026500           'T                                           '.        02640005
026600     05  FILLER                      PIC  X(38)  VALUE            02650005
026700           '   RETAIL                             '.              02660005
026800                                                                  02670002
026900 01  HL-HEADING-LINE-4.                                           02680002
027000     05  FILLER                      PIC  X(50)  VALUE            02690006
027100           '                                      TOTAL    % T'.  02700006
027200     05  FILLER                      PIC  X(44)  VALUE            02710002
027300           'O       RETAIL     PO/RCVRS     QUANTITY    '.        02720005
027400     05  FILLER                      PIC  X(38)  VALUE            02730005
027500           '   DOLLAR                             '.              02740005
027600                                                                  02750002
027700 01  HL-HEADING-LINE-5.                                           02760002
027800     05  FILLER                      PIC  X(50)  VALUE            02770006
027900           'OPER UNIT LOCATION                    UNITS  COMPA'.  02780006
028000     05  FILLER                      PIC  X(44)  VALUE            02790002
028100           'NY      DOLLAR     VERIFIED     VERIFIED    '.        02800005
028200     05  FILLER                      PIC  X(38)  VALUE            02810005
028300           ' VERIFIED                            '.               02820005
028400                                                                  02830002
028500                                                                  02840002
028600 01  DL-DETAIL-LINE-1.                                            02850002
028700     05  DL1-OPER-NBR                 PIC X(04).                  02860003
028800     05  FILLER                       PIC X(01) VALUE SPACES.     02870005
028900     05  DL1-OPER-DESC                PIC X(25).                  02880003
029000     05  FILLER                       PIC X(02) VALUE SPACES.     02890005
029100     05  DL1-OPER-TOT-UNITS           PIC ZZZ,ZZZ,ZZ9.            02900003
029200     05  FILLER                       PIC X(03) VALUE SPACES.     02910006
029300     05  DL1-OPER-DC-PERCENT          PIC ZZZ.9.                  02920003
029400     05  FILLER                       PIC X(02) VALUE SPACES.     02930002
029500     05  DL1-OPER-RETAIL              PIC ZZZ,ZZZ,ZZ9.            02940011
029600     05  FILLER                       PIC X(02) VALUE SPACES.     02950002
029700     05  DL1-OPER-VRFD-PO             PIC ZZZ,ZZZ,ZZ9.            02960003
029800     05  FILLER                       PIC X(02) VALUE SPACES.     02970003
029900     05  DL1-OPER-VRFD-UNITS          PIC ZZZ,ZZZ,ZZ9.            02980003
030000     05  FILLER                       PIC X(02) VALUE SPACES.     02990002
030100     05  DL1-OPER-VRFD-RETAIL         PIC ZZZ,ZZZ,ZZ9.            03000011
030200                                                                  03010002
030300 01  TL1-COMP-LINE.                                               03020002
030400     05  FILLER                       PIC X(14) VALUE             03030003
030500         'TOTAL COMPANY:'.                                        03040003
030600     05  FILLER                       PIC X(18) VALUE SPACES.     03050005
030700     05  TL1-COMP-TOT-UNITS           PIC ZZZ,ZZZ,ZZ9.            03060005
030800     05  FILLER                       PIC X(03) VALUE SPACES.     03070006
030900     05  TL1-COMP-DC-PERCENT          PIC ZZZ.9.                  03080003
031000     05  FILLER                       PIC X(02) VALUE SPACES.     03090003
031100     05  TL1-COMP-RETAIL              PIC ZZZ,ZZZ,ZZ9.            03100011
031200     05  FILLER                       PIC X(02) VALUE SPACES.     03110003
031300     05  TL1-COMP-VRFD-PO             PIC ZZZ,ZZZ,ZZ9.            03120003
031400     05  FILLER                       PIC X(02) VALUE SPACES.     03130003
031500     05  TL1-COMP-VRFD-UNITS          PIC ZZZ,ZZZ,ZZ9.            03140003
031600     05  FILLER                       PIC X(02) VALUE SPACES.     03150003
031700     05  TL1-COMP-VRFD-RETAIL         PIC ZZZ,ZZZ,ZZ9.            03160011
031800                                                                  03170002
031900 01  ER-END-OF-REPORT-LINE.                                       03180002
032000     05  FILLER                       PIC X(19)  VALUE            03190002
032100         '** END OF REPORT **'.                                   03200002
032200     05  FILLER                       PIC X(113)  VALUE SPACES.   03210002
032300                                                                  03220002
032400 01  EP-EMPTY-REPORT-LINE.                                        03230002
032500     05  FILLER                       PIC X(34)  VALUE SPACES.    03240002
032600     05  FILLER                       PIC X(52)  VALUE            03250002
032700      '*************** EMPTY INPUT FILE *******************'.     03260002
032800     05  FILLER                       PIC X(49)  VALUE SPACES.    03270002
032900                                                                  03280002
033000 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03290002
033100                                                                  03300002
033200 01  EL1-ERROR-LINE-1P.                                           03310009
033300     05  FILLER                      PIC  X(02)     VALUE SPACES. 03320009
033400     05  FILLER                      PIC  X(48)     VALUE         03330009
033500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03340009
033600     05  FILLER                      PIC  X(49)     VALUE         03350009
033700         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     03360009
033800     05  FILLER                      PIC  X(33)     VALUE         03370009
033900         'COMPLETED.                       '.                     03380009
034000                                                                  03390009
034100 01  EL2-ERROR-LINE-2F.                                           03400009
034200     05  FILLER                      PIC  X(02)     VALUE SPACES. 03410009
034300     05  FILLER                      PIC  X(36)     VALUE         03420009
034400         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03430009
034500     05  FILLER                      PIC  X(36)     VALUE         03440009
034600         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03450009
034700     05  FILLER                      PIC  X(58)     VALUE SPACES. 03460009
034800                                                                  03470009
034900 01  EL3-ERROR-LINE-3.                                            03480009
035000     05  FILLER                      PIC  X(02)     VALUE SPACES. 03490009
035100     05  FILLER                      PIC  X(50)     VALUE         03500009
035200         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03510009
035300     05  FILLER                      PIC  X(81)     VALUE SPACES. 03520009
035400                                                                  03530009
035500 01  EL4-ERROR-LINE-4.                                            03540009
035600     05  FILLER                      PIC  X(02)     VALUE SPACES. 03550009
035700     05  FILLER                      PIC  X(18)     VALUE         03560009
035800         'REQUESTOR       : '.                                    03570009
035900     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 03580009
036000     05  FILLER                      PIC  X(07)     VALUE SPACES. 03590009
036100     05  FILLER                      PIC  X(21)     VALUE         03600009
036200         'PRINTER DESTINATION: '.                                 03610009
036300     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 03620009
036400     05  FILLER                      PIC  X(65)     VALUE SPACES. 03630009
036500                                                                  03640009
036600 01  EL5-ERROR-LINE-5B.                                           03650009
036700     05  FILLER                      PIC  X(02)     VALUE SPACES. 03660009
036800     05  FILLER                      PIC  X(18)     VALUE         03670009
036900         'START DATE RANGE: '.                                    03680009
037000     05  EL5-START-DATE-RANGE        PIC  X(10).                  03690009
037100     05  FILLER                      PIC  X(07)     VALUE SPACES. 03700009
037200     05  FILLER                      PIC  X(21)     VALUE         03710009
037300         'END DATE RANGE     : '.                                 03720009
037400     05  EL5-END-DATE-RANGE          PIC  X(10).                  03730009
037500     05  FILLER                      PIC  X(20)     VALUE SPACES. 03740009
037600/                                                                 03750002
037700******************************************************************03760002
037800*  COPYBOOK USED BY MBS SYSTEM                                    03770002
037900******************************************************************03780002
038000     COPY DPWS003.                                                03790002
038100*                                                                 03800002
038200******************************************************************03810002
038300*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03820002
038400******************************************************************03830002
038500     COPY DPWS024.                                                03840002
038600/                                                                 03850002
038700******************************************************************03860002
038800*  DB2 FORMATTED MESSAGE AREA                                     03870002
038900******************************************************************03880002
039000     COPY DPWS004.                                                03890002
039100/                                                                 03900002
039200******************************************************************03910002
039300* CORPORATE DATE ROUTINES                                         03920002
039400******************************************************************03930002
039500     COPY DPWS500.                                                03940002
039600/                                                                 03950002
039700******************************************************************03960002
039800*  RECORD LAYOUT FOR INPUT FILE                                   03970002
039900******************************************************************03980002
040000     COPY PCRD012.                                                03990002
040100/                                                                 04000002
040200*    LOCATION MODULE                                              04001013
040300     COPY XLWS071.                                                04002013
040400/                                                                 04003013
040500******************************************************************04010002
040600*   DB2 SQL COMMUNICATION AREA                                    04020002
040700******************************************************************04030002
040800     EXEC SQL                                                     04040002
040900         INCLUDE SQLCA                                            04050002
041000     END-EXEC.                                                    04060002
041100*                                                                 04070002
041200     COPY SQLCA2.                                                 04080002
041300*                                                                 04090002
041400******************************************************************04180002
041500 PROCEDURE DIVISION.                                              04190002
041600******************************************************************04200002
041700 0000-MAINLINE.                                                   04210002
041800                                                                  04220002
041900     ACCEPT PC239-CONTROL-CARD FROM SYSIN.                        04230002
042000     DISPLAY 'CONTROL CARD = ' PC239-CONTROL-CARD.                04240002
042100                                                                  04250002
042200     IF CC-RPT-PCKRP012                                           04260004
042300         OPEN INPUT  EXTRACT-FILE                                 04270002
042400         IF CC-ROUTE-TO-RDS                                       04280002
042500            OPEN OUTPUT REPORT-FILE-1                             04290002
042600         ELSE                                                     04300002
042700            OPEN OUTPUT REPORT-FILE-2                             04310002
042800         END-IF                                                   04320002
042900                                                                  04330002
043000         PERFORM 2100-READ-EXTRACT                                04340002
043100         PERFORM 1000-INITIALIZE                                  04350009
043200                                                                  04360002
043300         IF PC012-RCD-TYPE-ERROR                                  04370002
043400             PERFORM 7000-WRITE-ERROR-REPORT                      04380009
043500         ELSE                                                     04390002
043600             PERFORM 8100-WRITE-SUB-HEADINGS                      04400009
043700             PERFORM 2000-PROCESS-EXTRACT                         04410009
043800                 UNTIL PS-END-OF-INPUT                            04420009
043900             PERFORM 3100-COMPANY-TOTALS                          04430009
044000             PERFORM 9000-EOJ                                     04440009
044100         END-IF                                                   04450009
044200      END-IF                                                      04460002
044300                                                                  04470002
044400     GOBACK.                                                      04480002
044500                                                                  04490002
044600******************************************************************04500002
044700 1000-INITIALIZE.                                                 04510002
044800******************************************************************04520002
044900*                                                                 04530002
045000     EXEC SQL                                                     04531013
045100         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    04532013
045200     END-EXEC                                                     04533013
045300                                                                  04534013
045400* LOAD SYSTEM DATE INTO HEADINGS                                  04540002
045500     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04550002
045600     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04560002
045700                                                                  04570002
045800     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04580002
045900     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04590002
046000     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04600002
046100     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04610002
046200     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04620002
046300                                                                  04630002
046400     MOVE PC-CURRENT-PROGRAM-NAME                                 04640002
046500                                 TO DP132O-PROGRAM-NAME.          04650002
046600     MOVE 1                      TO DP132O-REPORT-NUMBER          04660002
046700                                    DP132O-PAGE-NUMBER.           04670002
046800     IF CC-BATCH-REQUEST                                          04680002
046900        CONTINUE                                                  04690002
047000     ELSE                                                         04700002
047100        MOVE '** SPECIAL REQUESTED RUN **' TO HL1-SPECIAL-RUN     04710002
047200        MOVE '** REQUESTED BY: '         TO HL1B-REQUEST1         04720002
047300        MOVE CC-USER-ID                  TO HL1B-USER-ID          04730002
047400        MOVE '**  '                      TO HL1B-REQUEST2         04740002
047500     END-IF.                                                      04750002
047600                                                                  04760002
047700     PERFORM 8000-WRITE-MAIN-HEADINGS.                            04770002
047800*                                                                 04780002
047900***************************************************************** 04790002
048000 1200-SELECT-OPER-DESC.                                           04800002
048100***************************************************************** 04810002
048200*                                                                 04820002
048300*                                                                 05780002
048400     INITIALIZE XL071-COMMAREA-REC.                               05790023
048500     MOVE PV-STORE-NBR         TO XL071-LOCATION-NUMBER           05800023
048600                                                                  05810023
048700     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
048800                                                                  05830023
048900     EVALUATE TRUE                                                05840023
049000     WHEN XL071-NO-ERRORS                                         05850023
049100         MOVE XL071-LOC-NM    TO PV-STORE-NAME                    05860023
049200     WHEN XL071-LOC-NOT-FOUND                                     05870023
049300     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
049400         MOVE SPACES           TO  PV-STORE-NAME                  05890023
049500     WHEN XL071-BAD-DB2-RETURN                                    05900023
049600         MOVE XL071-SQLCA             TO SQLCA                    05910023
049700         MOVE '1200-SELECT-OPER-DESC'                             05920023
049800                                TO PV-PARAGRAPH                   05930023
049900         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
050000         MOVE ' CALL TO XLKUT071'                                 05950023
050100                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
050200         MOVE ' TABLE = XLT_LOC '                                 05970023
050300                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
050400         PERFORM 9200-SQL-ABEND                                   05990023
050500     END-EVALUATE.                                                06000023
050600/                                                                 06010023
050700******************************************************************05080002
050800*  PRINT A 'NO INPUT' REPORT LINE.                                05090002
050900******************************************************************05100002
051000 1300-NO-DETAIL-LINE.                                             05110002
051100                                                                  05120002
051200         IF CC-ROUTE-TO-RDS                                       05130002
051300             WRITE REPORT-RECORD-1                                05140002
051400               FROM EP-EMPTY-REPORT-LINE                          05150002
051500                 AFTER ADVANCING 3 LINES                          05160002
051600         ELSE                                                     05170002
051700             WRITE REPORT-RECORD-2                                05180002
051800               FROM EP-EMPTY-REPORT-LINE                          05190002
051900                 AFTER ADVANCING 3 LINES.                         05200002
052000*                                                                 05210002
052100***************************************************************** 05220002
052200* MOVE COMPANY TOTALS.                                            05230003
052300***************************************************************** 05240002
052400 1500-PROCESS-B-RECORD.                                           05250003
052500*                                                                 05260002
052600     MOVE PC012-UNT-WRKD-QTY      TO PV-COMP-TOT-UNITS.           05270003
052700     MOVE PC012-EXTD-RTL-WRKD-AMT TO PV-COMP-TOT-RETAIL.          05280003
052800     MOVE PC012-PO-RCVR-VRFD-QTY  TO PV-COMP-VRFD-PO.             05290003
052900     MOVE PC012-UNT-VRFD-QTY      TO PV-COMP-VRFD-UNITS.          05300003
053000     MOVE PC012-EXTD-RTL-VRFD-AMT TO PV-COMP-VRFD-RETAIL.         05310003
053100/                                                                 05320003
053200***************************************************************** 05330003
053300* OPER TO COMPANY PERCENT.                                        05340003
053400***************************************************************** 05350003
053500 1600-OPER-COMP-PERCENT.                                          05360003
053600*                                                                 05370003
053700     IF PV-COMP-TOT-UNITS  > ZERO                                 05380007
053800       DIVIDE PV-OPER-TOT-UNITS  BY  PV-COMP-TOT-UNITS            05390007
053900         GIVING PV-DIVIDEND ROUNDED                               05400002
054000       MULTIPLY PV-DIVIDEND BY 100                                05410003
054100         GIVING PV-DC-COMP-PERCENT                                05420003
054200       IF PV-DC-COMP-PERCENT = ZERO AND                           05430010
054300          PV-OPER-TOT-UNITS  > ZERO                               05440010
054400          MOVE .1      TO PV-DC-COMP-PERCENT                      05450003
054500       END-IF                                                     05460003
054600     ELSE                                                         05470002
054700           MOVE ZEROES  TO  PV-DIVIDEND                           05480002
054800                            PV-DC-COMP-PERCENT                    05490003
054900     END-IF.                                                      05500002
055000/                                                                 05510002
055100******************************************************************05520002
055200 2000-PROCESS-EXTRACT.                                            05530002
055300******************************************************************05540002
055400*                                                                 05550002
055500     EVALUATE TRUE                                                05560002
055600       WHEN PC012-RECORD-TYPE-CDE = 'B'                           05570003
055700           PERFORM 1500-PROCESS-B-RECORD                          05580003
055800                                                                  05590002
055900       WHEN PC012-RECORD-TYPE-CDE = 'D'                           05600003
056000           PERFORM 1200-SELECT-OPER-DESC                          05610003
056100           PERFORM 1600-OPER-COMP-PERCENT                         05620003
056200           PERFORM 3000-PRINT-DETAILS                             05630003
056300                                                                  05640003
056400     END-EVALUATE.                                                05650002
056500                                                                  05660002
056600     PERFORM 2100-READ-EXTRACT.                                   05670002
056700*                                                                 05680002
056800******************************************************************05690002
056900*  READ NEXT INPUT FILE RECORD.                                   05700002
057000******************************************************************05710002
057100 2100-READ-EXTRACT.                                               05720002
057200                                                                  05730002
057300     READ EXTRACT-FILE INTO PC012-RECORD-LAYOUT                   05740002
057400        AT END                                                    05750002
057500           SET PS-END-OF-INPUT TO TRUE                            05760002
057600        NOT AT END                                                05770002
057700           ADD +1                  TO PV-READ-COUNT               05780002
057800           MOVE PC012-OPER-UNT-ID  TO PV-STORE-NBR                05790004
057900           MOVE PC012-UNT-WRKD-QTY TO PV-OPER-TOT-UNITS           05800007
058000     END-READ.                                                    05810002
058100*                                                                 05820002
058200******************************************************************05830002
058300*  FILL AND PRINT DETAIL REPORT LINE.                             05840002
058400******************************************************************05850002
058500 3000-PRINT-DETAILS.                                              05860002
058600*                                                                 05870002
058700     MOVE PV-STORE-NBR             TO DL1-OPER-NBR.               05880005
058800     MOVE PV-STORE-NAME            TO DL1-OPER-DESC.              05890003
058900                                                                  05900003
059000     MOVE PC012-UNT-WRKD-QTY       TO DL1-OPER-TOT-UNITS.         05910003
059100     MOVE PV-DC-COMP-PERCENT       TO DL1-OPER-DC-PERCENT.        05920003
059200     MOVE PC012-EXTD-RTL-WRKD-AMT  TO DL1-OPER-RETAIL.            05930003
059300                                                                  05940002
059400     MOVE PC012-PO-RCVR-VRFD-QTY   TO DL1-OPER-VRFD-PO.           05950003
059500     MOVE PC012-UNT-VRFD-QTY       TO DL1-OPER-VRFD-UNITS.        05960003
059600     MOVE PC012-EXTD-RTL-VRFD-AMT  TO DL1-OPER-VRFD-RETAIL.       05970003
059700                                                                  05980002
059800*CHECK FOR OVERFLOW.                                              05990002
059900     ADD 1 TO PV-LINE-COUNT.                                      06000002
060000     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06010002
060100         SET PS-NEW-PAGE TO TRUE                                  06020002
060200         PERFORM 8000-WRITE-MAIN-HEADINGS                         06030002
060300         PERFORM 8100-WRITE-SUB-HEADINGS                          06040002
060400     END-IF.                                                      06050002
060500                                                                  06060002
060600*IF NEW PAGE, DISPLAY WEEK-END DATE.                              06070002
060700     IF PS-NEW-PAGE                                               06080002
060800         SET PS-SAME-PAGE             TO TRUE                     06090002
060900     END-IF.                                                      06100002
061000                                                                  06110002
061100*WRITE DETAIL LINE.                                               06120002
061200         IF CC-ROUTE-TO-RDS                                       06130002
061300             WRITE REPORT-RECORD-1                                06140002
061400               FROM DL-DETAIL-LINE-1                              06150002
061500                 AFTER ADVANCING 1 LINES                          06160002
061600                                                                  06170002
061700             WRITE REPORT-RECORD-1                                06180002
061800               FROM DL-BLANK-LINE                                 06190002
061900                 AFTER ADVANCING 1 LINE                           06200002
062000             ADD 2                   TO PV-LINE-COUNT             06210002
062100         ELSE                                                     06220002
062200             WRITE REPORT-RECORD-2                                06230002
062300               FROM DL-DETAIL-LINE-1                              06240002
062400                 AFTER ADVANCING 1 LINES                          06250002
062500                                                                  06260002
062600             WRITE REPORT-RECORD-2                                06270002
062700               FROM DL-BLANK-LINE                                 06280002
062800                 AFTER ADVANCING 1 LINE                           06290002
062900             ADD 2                   TO PV-LINE-COUNT.            06300002
063000*                                                                 06310002
063100******************************************************************06320002
063200 3100-COMPANY-TOTALS.                                             06330002
063300******************************************************************06340002
063400*                                                                 06350002
063500     MOVE PV-COMP-TOT-UNITS       TO TL1-COMP-TOT-UNITS           06360003
063600*    MOVE PV-COMP-PERCENT         TO TL1-COMP-TOT-RETAIL          06370003
063700     MOVE PV-COMP-TOT-RETAIL      TO TL1-COMP-RETAIL              06380006
063800     MOVE PV-COMP-VRFD-PO         TO TL1-COMP-VRFD-PO             06390003
063900     MOVE PV-COMP-VRFD-UNITS      TO TL1-COMP-VRFD-UNITS          06400003
064000     MOVE PV-COMP-VRFD-RETAIL     TO TL1-COMP-VRFD-RETAIL         06410003
064100                                                                  06420002
064200                                                                  06430002
064300     IF CC-ROUTE-TO-RDS                                           06440002
064400         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 06450002
064500             AFTER ADVANCING 1 LINE                               06460002
064600         ADD 1                   TO PV-LINE-COUNT                 06470002
064700                                                                  06480002
064800         WRITE REPORT-RECORD-1 FROM TL1-COMP-LINE                 06490002
064900             AFTER ADVANCING 1 LINE                               06500002
065000                                                                  06510002
065100         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 06520002
065200         AFTER ADVANCING 1 LINE                                   06530002
065300         ADD 1                     TO PV-LINE-COUNT               06540002
065400     ELSE                                                         06550002
065500         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 06560002
065600             AFTER ADVANCING 1 LINE                               06570002
065700         ADD 1                   TO PV-LINE-COUNT                 06580002
065800                                                                  06590002
065900         WRITE REPORT-RECORD-2 FROM TL1-COMP-LINE                 06600002
066000             AFTER ADVANCING 1 LINE                               06610002
066100         ADD 1                    TO PV-LINE-COUNT                06620002
066200                                                                  06630002
066300         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 06640002
066400         AFTER ADVANCING 1 LINE                                   06650002
066500         ADD 1                     TO PV-LINE-COUNT.              06660002
066600*                                                                 06670002
066700******************************************************************06680002
066800*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *06690002
066900******************************************************************06700002
067000 7000-WRITE-ERROR-REPORT.                                         06710002
067100*                                                                 06720009
067200     IF CC-ROUTE-TO-RDS                                           06730009
067300         WRITE REPORT-RECORD-1                                    06740009
067400           FROM EL1-ERROR-LINE-1P                                 06750009
067500             AFTER ADVANCING 3 LINES                              06760009
067600*                                                                 06770009
067700         WRITE REPORT-RECORD-1                                    06780009
067800           FROM EL2-ERROR-LINE-2F                                 06790009
067900             AFTER ADVANCING 2 LINES                              06800009
068000*                                                                 06810009
068100         WRITE REPORT-RECORD-1                                    06820009
068200           FROM EL3-ERROR-LINE-3                                  06830009
068300             AFTER ADVANCING 2 LINES                              06840009
068400*                                                                 06850009
068500         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              06860009
068600         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                06870009
068700                                                                  06880009
068800         WRITE REPORT-RECORD-1                                    06890009
068900           FROM EL4-ERROR-LINE-4                                  06900009
069000             AFTER ADVANCING 3 LINES                              06910009
069100                                                                  06920009
069200         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    06930009
069300         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      06940009
069400                                                                  06950009
069500         WRITE REPORT-RECORD-1                                    06960009
069600           FROM EL5-ERROR-LINE-5B                                 06970009
069700             AFTER ADVANCING 2 LINES                              06980009
069800*                                                                 06990009
069900         WRITE REPORT-RECORD-1                                    07000009
070000           FROM ER-END-OF-REPORT-LINE                             07010009
070100             AFTER ADVANCING 6 LINES                              07020009
070200     ELSE                                                         07030009
070300         WRITE REPORT-RECORD-2                                    07040009
070400           FROM EL1-ERROR-LINE-1P                                 07050009
070500             AFTER ADVANCING 3 LINES                              07060009
070600*                                                                 07070009
070700         WRITE REPORT-RECORD-2                                    07080009
070800           FROM EL2-ERROR-LINE-2F                                 07090009
070900             AFTER ADVANCING 2 LINES                              07100009
071000*                                                                 07110009
071100         WRITE REPORT-RECORD-2                                    07120009
071200           FROM EL3-ERROR-LINE-3                                  07130009
071300             AFTER ADVANCING 2 LINES                              07140009
071400*                                                                 07150009
071500         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              07160009
071600         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                07170009
071700                                                                  07180009
071800         WRITE REPORT-RECORD-2                                    07190009
071900           FROM EL4-ERROR-LINE-4                                  07200009
072000             AFTER ADVANCING 3 LINES                              07210009
072100*                                                                 07220009
072200         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    07230009
072300         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      07240009
072400                                                                  07250009
072500         WRITE REPORT-RECORD-2                                    07260009
072600           FROM EL5-ERROR-LINE-5B                                 07270009
072700             AFTER ADVANCING 2 LINE                               07280009
072800*                                                                 07290009
072900         WRITE REPORT-RECORD-2                                    07300009
073000           FROM ER-END-OF-REPORT-LINE                             07310009
073100             AFTER ADVANCING 6 LINES.                             07320009
073200*                                                                 07330009
073300******************************************************************07340002
073400 8000-WRITE-MAIN-HEADINGS.                                        07350002
073500******************************************************************07360002
073600*                                                                 07370002
073700     MOVE CC-START-RPT-DATE-RANGE     TO HL1B-FROM-DATE.          07380002
073800     MOVE CC-END-RPT-DATE-RANGE       TO HL1B-TO-DATE.            07390002
073900                                                                  07400002
074000     ADD 1                            TO PV-PAGE-COUNT.           07410002
074100     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      07420002
074200     MOVE ZERO                        TO PV-LINE-COUNT.           07430002
074300                                                                  07440002
074400     IF CC-ROUTE-TO-RDS                                           07450002
074500         WRITE REPORT-RECORD-1 FROM                               07460002
074600             DP132O-STANDRD-HEADER-132-COLS                       07470002
074700             AFTER ADVANCING PAGE                                 07480002
074800                                                                  07490002
074900         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1             07500003
075000            AFTER ADVANCING 2 LINES                               07510003
075100                                                                  07520002
075200         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1B            07530002
075300            AFTER ADVANCING 2 LINES                               07540002
075400                                                                  07550002
075500         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2             07560002
075600            AFTER ADVANCING 2 LINES                               07570002
075700         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07580002
075800             AFTER ADVANCING 3 LINES                              07590002
075900         ADD 7                            TO PV-LINE-COUNT        07600002
076000     ELSE                                                         07610002
076100         WRITE REPORT-RECORD-2 FROM                               07620002
076200             DP132O-STANDRD-HEADER-132-COLS                       07630002
076300             AFTER ADVANCING PAGE                                 07640002
076400                                                                  07650002
076500         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1             07660003
076600            AFTER ADVANCING 2 LINES                               07670003
076700                                                                  07680002
076800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1B            07690002
076900            AFTER ADVANCING 2 LINES                               07700002
077000                                                                  07710002
077100         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2             07720002
077200            AFTER ADVANCING 2 LINES                               07730002
077300         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 07740002
077400             AFTER ADVANCING 3 LINES                              07750002
077500         ADD 7                            TO PV-LINE-COUNT        07760002
077600     END-IF.                                                      07770002
077700*                                                                 07780002
077800******************************************************************07790002
077900 8100-WRITE-SUB-HEADINGS.                                         07800002
078000******************************************************************07810002
078100*                                                                 07820002
078200                                                                  07830002
078300     IF CC-ROUTE-TO-RDS                                           07840002
078400         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3             07850002
078500            AFTER ADVANCING 1 LINES                               07860002
078600                                                                  07870002
078700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4             07880002
078800            AFTER ADVANCING 1 LINES                               07890002
078900                                                                  07900002
079000         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-5             07910002
079100            AFTER ADVANCING 1 LINES                               07920002
079200                                                                  07930002
079300         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07940002
079400             AFTER ADVANCING 1 LINE                               07950002
079500         ADD 3                            TO PV-LINE-COUNT        07960002
079600                                                                  07970002
079700     ELSE                                                         07980002
079800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-3             07990002
079900            AFTER ADVANCING 1 LINES                               08000002
080000                                                                  08010002
080100         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4             08020002
080200            AFTER ADVANCING 1 LINES                               08030002
080300                                                                  08040002
080400         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-5             08050002
080500            AFTER ADVANCING 1 LINES                               08060002
080600                                                                  08070002
080700         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 08080002
080800             AFTER ADVANCING 1 LINE                               08090002
080900         ADD 3                            TO PV-LINE-COUNT.       08100002
081000*                                                                 08110002
081100******************************************************************08120002
081200 9000-EOJ.                                                        08130002
081300******************************************************************08140002
081400*                                                                 08150002
081500     DISPLAY ' RECORDS READ               = ' PV-READ-COUNT       08160012
081600                                                                  08170012
081700     IF CC-ROUTE-TO-RDS                                           08180002
081800         WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE         08190002
081900            AFTER ADVANCING 2 LINES                               08200002
082000     ELSE                                                         08210002
082100         WRITE REPORT-RECORD-2 FROM ER-END-OF-REPORT-LINE         08220002
082200            AFTER ADVANCING 2 LINES.                              08230002
082300                                                                  08240002
082400*CLOSE FILES.                                                     08250002
082500     CLOSE EXTRACT-FILE                                           08260002
082600                                                                  08270002
082700     IF CC-ROUTE-TO-RDS                                           08280002
082800        CLOSE REPORT-FILE-1                                       08290002
082900     ELSE                                                         08300002
083000        CLOSE REPORT-FILE-2                                       08310002
083100     END-IF.                                                      08320002
083200/                                                                 08330002
083300******************************************************************08340002
083400 9200-SQL-ABEND.                                                  08350002
083500******************************************************************08360002
083600                                                                  08370002
083700     MOVE SQLCODE                     TO SQLCODE2.                08380002
083800     MOVE SQLERRD(3)                  TO SQLERRD3.                08390002
083900                                                                  08400002
084000     DISPLAY '** ABEND **         ** = SQLERROR'.                 08410002
084100     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08420002
084200     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08430002
084300     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08440002
084400     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     08450002
084500     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     08460002
084600     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     08470002
084700                                                                  08480002
084800     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                08490002
084900     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                08500002
085000     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 08510002
085100     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                08520002
085200                                                                  08530002
085300                                                                  08540002
085400     MOVE +4013                       TO PV-ABEND-CODE.           08550002
085500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08560002
085600                                                                  08570002
085700******************************************************************08580002
085800 9300-SQL-WARNING.                                                08590002
085900******************************************************************08600002
086000                                                                  08610002
086100     DISPLAY '9300-SQL-WARNING'.                                  08620002
086200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08630002
086300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08640002
086400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08650002
086500                                                                  08660002
086600     MOVE SQLCODE                     TO SQLCODE2.                08670002
086700     MOVE SQLERRD(3)                  TO SQLERRD3.                08680002
086800     DISPLAY '** ABEND **       ** = SQLWARNING'.                 08690002
086900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08700002
087000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  08710002
087100     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  08720002
087200     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  08730002
087300     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  08740002
087400     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  08750002
087500     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  08760002
087600     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  08770002
087700     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  08780002
087800     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  08790002
087900                                                                  08800002
088000     MOVE +4013                       TO PV-ABEND-CODE.           08810002
088100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08820002
088200*                                                                 08830002
088300******************************************************************08840002
088400*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       08850002
088500******************************************************************08860002
088600 9400-ABEND.                                                      08870002
088700*                                                                 08880002
088800     DISPLAY '***************************'.                       08890002
088900     DISPLAY '**       ABEND           **'.                       08900002
089000     DISPLAY '**  IN PROGRAM RCKRP035  **'.                       08910002
089100     DISPLAY '***************************'.                       08920002
089200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             08930002
089300     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         08940002
089400     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       08950002
089500     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       08960002
089600                                                                  08970002
089700     MOVE +4014                  TO PV-ABEND-CODE.                08980002
089800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08990002
089900*                                                                 09000002
090000******************************************************************09010002
