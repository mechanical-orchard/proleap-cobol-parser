000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT005.                                        00020001
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400 DATE-WRITTEN.   AUGUST 2023.                                     00040001
000500 DATE-COMPILED.                                                   00050001
000600******************************************************************00060001
000700* COBOL 2                                                        *00070001
000800*  REFORMATS PRIVATE LABEL LOAD BY PO FILE TO CSV FORMAT         *00080001
000900*                                                                *00090001
001000* INPUT:                                                         *00100001
001100*  1. PRIVATE LABEL GL FILE          COPYBOOK APRD006            *00110001
001200*                                                                *00120001
001300* OUTPUT:                                                        *00130001
001400*  1. CSV FILE TO BE SENT TO AP IMPORTS TEAM                     *00140001
001500*                                                                *00150001
001600*----------------------------------------------------------------*00160001
001700* CHANGE LOG                                                     *00170001
001900*    DATE  08/28/2023                                            *00190001
001910*        CHANGE MADE: INITIAL IMPLEMENTATION                     *00191001
001920*        MADE BY: NANCY EILBES            WR/IR #: CHG0292273    *00192002
001930*                                                                *00193001
001997******************************************************************00199701
001998   EJECT                                                          00199801
001999 ENVIRONMENT DIVISION.                                            00199901
002000 CONFIGURATION SECTION.                                           00200001
002100 SOURCE-COMPUTER.    IBM-3090.                                    00210001
002200 OBJECT-COMPUTER.    IBM-3090.                                    00220001
002300                                                                  00230001
002400 INPUT-OUTPUT SECTION.                                            00240001
002500 FILE-CONTROL.                                                    00250001
002600     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00260001
002700     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00270001
002800                                                                  00280001
002900 DATA DIVISION.                                                   00290001
003000 FILE SECTION.                                                    00300001
003100                                                                  00310001
003200 FD  IN-FILE                                                      00320001
003300     RECORDING MODE IS F                                          00330001
003400     LABEL RECORDS ARE STANDARD                                   00340001
003500     BLOCK CONTAINS 0 RECORDS                                     00350001
003600     DATA RECORD IS APTRAN-IN-REC.                                00360001
003700 01  IN-REC.                                                      00370001
003800     05  FILLER                       PIC  X(50).                 00380001
003900                                                                  00390001
004000 FD  OUT-FILE                                                     00400001
004100     RECORDING MODE IS F                                          00410001
004200     LABEL RECORDS ARE STANDARD                                   00420001
004300     BLOCK CONTAINS 0 RECORDS                                     00430001
004400     DATA RECORD IS APTRAN-OUT-REC.                               00440001
004500 01  OUT-REC.                                                     00450001
004600     05  FILLER                       PIC  X(65).                 00460001
004700                                                                  00470001
004800 EJECT                                                            00480001
004900 WORKING-STORAGE SECTION.                                         00490001
005000                                                                  00500001
005100 01  PV-PROGRAM-VARIABLES.                                        00510001
005200     05  PV-COUNT-OUT          PIC  9(9)   VALUE ZEROS.           00520001
005300     05  PV-COUNT-IN           PIC  9(9)   VALUE ZEROS.           00530001
005400                                                                  00540001
005500 01  EOF-SW                           PIC X     VALUE 'N'.        00550001
005600     88  IN-EOF                                 VALUE 'Y'.        00560001
005700     88  MORE-IN-RECS                           VALUE 'N'.        00570001
005800*----------------------------------------------------------------*00580001
005900*  VERIFIED RECEIPT GL POSTING FILE RECORD LAYOUT.               *00590001
006000*----------------------------------------------------------------*00600001
006100     COPY APRD006.                                                00610001
006200                                                                  00620001
006300*----------------------------------------------------------------*00630001
006400*  PRIVATE LABEL CSV FILE RECORD LAYOUT.                         *00640001
006500*----------------------------------------------------------------*00650001
006680 01  LDCSV-TEXT-RECORD.                                           00668001
006691     05  LDCSV-AMT-TYP-CDE-TXT        PIC X(02).                  00669101
006692     05  COMMA1                       PIC X(1) VALUE ','.         00669201
006693     05  LDCSV-PO-NBR-TXT             PIC 9(9).                   00669301
006694     05  COMMA2                       PIC X(1) VALUE ','.         00669401
006695     05  LDCSV-SIGN-TXT               PIC X(1) VALUE SPACES.      00669501
006697     05  LDCSV-COST-AMT-TXT           PIC 99999999999.99.         00669701
006698     05  FILLER                       PIC X(15) VALUE SPACES.     00669801
006699                                                                  00669901
006700 01  LDCSV-HEADING-RECORD.                                        00670001
006701     05  FILLER                       PIC X(9) VALUE 'POST_TYPE'. 00670101
006710     05  FILLER                       PIC X(1) VALUE ','.         00671001
006720     05  FILLER                       PIC X(9) VALUE 'PO_NUMBER'. 00672001
006730     05  FILLER                       PIC X(1) VALUE ','.         00673001
006750     05  FILLER                       PIC X(9) VALUE 'LOAD_AMT'.  00675001
006760     05  FILLER                       PIC X(14) VALUE SPACES.     00676001
006800                                                                  00680001
011400 EJECT                                                            01140001
011500 PROCEDURE DIVISION.                                              01150001
011600 A100-MAIN.                                                       01160001
011700                                                                  01170001
011800     PERFORM B100-INITIALIZE.                                     01180001
011900                                                                  01190001
012000     PERFORM B200-PROCESS                                         01200001
012100         UNTIL IN-EOF.                                            01210001
012200                                                                  01220001
012300     PERFORM B300-END-OF-JOB.                                     01230001
012400                                                                  01240001
012500     GOBACK.                                                      01250001
012600 EJECT                                                            01260001
012700*----------------------------------------------------------------*01270001
012800*    INITIALIZATION PROCESSING                                   *01280001
012900*----------------------------------------------------------------*01290001
013000 B100-INITIALIZE.                                                 01300001
013100                                                                  01310001
013200     OPEN INPUT  IN-FILE                                          01320001
013300          OUTPUT OUT-FILE.                                        01330001
014800                                                                  01480001
014900     PERFORM R100-READ-INPUT.                                     01490001
015000                                                                  01500001
015001     IF IN-EOF                                                    01500101
015002        CONTINUE                                                  01500201
015003     ELSE                                                         01500301
015010        PERFORM W200-WRITE-HEADER                                 01501001
015020     END-IF.                                                      01502001
015030                                                                  01503001
015100*----------------------------------------------------------------*01510001
015110*  CONVERT EACH RECORD TO TEXT BY MOVING EACH FIELD TO OUTPUT.   *01511001
015120*----------------------------------------------------------------*01512001
015130 B200-PROCESS.                                                    01513001
015140                                                                  01514001
015160     MOVE AP006-AMT-TYP-CDE   TO  LDCSV-AMT-TYP-CDE-TXT.          01516001
015170     IF  AP006-COST-AMT < ZERO                                    01517001
015180         MOVE '-'             TO  LDCSV-SIGN-TXT                  01518001
015190     ELSE                                                         01519001
015200         MOVE ' '             TO  LDCSV-SIGN-TXT                  01520001
015300     END-IF.                                                      01530001
015400     MOVE AP006-COST-AMT      TO  LDCSV-COST-AMT-TXT.             01540001
015500     MOVE AP006-PO-NBR        TO  LDCSV-PO-NBR-TXT.               01550001
015700                                                                  01570001
015800     PERFORM W100-WRITE-OUTPUT.                                   01580001
015900                                                                  01590001
016000     PERFORM R100-READ-INPUT.                                     01600001
016100     EJECT                                                        01610001
016200*----------------------------------------------------------------*01620001
016300*    ENDING PROCESSING: DISPLAYS RECORD COUNTS AND CLOSE FILES.  *01630001
016400*----------------------------------------------------------------*01640001
016500 B300-END-OF-JOB.                                                 01650001
016600                                                                  01660001
016700     DISPLAY '*----------------------------------*'.              01670001
016800     DISPLAY '* PROGRAM APKUT005 RECORD COUNTS   *'.              01680001
016810     DISPLAY '*----------------------------------*'.              01681001
016820     DISPLAY '* INPUT RECORDS = ' PV-COUNT-IN.                    01682001
016830     DISPLAY '* OUTPUT RECORDS = ' PV-COUNT-OUT.                  01683001
016840     DISPLAY '*----------------------------------*'.              01684001
016850                                                                  01685001
016860     CLOSE IN-FILE                                                01686001
016870           OUT-FILE.                                              01687001
016880                                                                  01688001
016890 R100-READ-INPUT.                                                 01689001
016900                                                                  01690001
017000     READ IN-FILE INTO AP006-VERIFIED-RECEIPT-FILE                01700001
017100         AT END SET IN-EOF TO TRUE.                               01710001
017200                                                                  01720001
017300     IF MORE-IN-RECS                                              01730001
017400        ADD +1 TO PV-COUNT-IN                                     01740001
017410     END-IF.                                                      01741001
017420                                                                  01742001
017430 W100-WRITE-OUTPUT.                                               01743001
017440                                                                  01744001
017450     WRITE OUT-REC FROM LDCSV-TEXT-RECORD.                        01745001
017460     ADD +1 TO PV-COUNT-OUT.                                      01746001
017470                                                                  01747001
017471 W200-WRITE-HEADER.                                               01747101
017472                                                                  01747201
017473     WRITE OUT-REC FROM LDCSV-HEADING-RECORD.                     01747301
017475                                                                  01747501
