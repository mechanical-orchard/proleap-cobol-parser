       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.      XSKUT035.                                       00020000
       AUTHOR.          STEVE KRIEG.                                    00030000
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
       DATE-WRITTEN.    02/07/2003.                                     00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00061000
      *  XS DOMAIN - PRICE DETERMINATION ENGINE - REAL TIME BATCH       00062000
      ******************************************************************00063000
      ******************************************************************00064000
      *  NOTE: THERE ARE MANY VERSIONS OF THIS PROGRAM THAT MUST BE     00065000
      *        KEPT SYNCHRONIZED.                                       00066000
      ******************************************************************00067000
      ******************************************************************00068000
      * XSKUT035 - REAL-TIME, ONE-AT-A-TIME PDE                         00069000
      *       = INITIAL PROGRAM USED BY MANY AREAS                      00070000
      * XSKUT049 - LARGE FILE BATCH PDE (BY JCL)                        00080000
      *       = COPIED FROM 035, WITH SEVERAL CHANGES. AN INPUT AND     00090000
      *         OUTPUT FILE REPLACE LINKAGE. BASIC LOGIC REMAINS THE    00100000
      *         SAME EXCEPT ALL SKUS ARE PROCESSED INTO TEMP TABLE AND  00100100
      *         THEN PROMO SQL CALLS ARE MADE.                          00100200
      * XSKUT060 - REAL-TIME PERM PDE (BY STORED PROCEDURE)             00100300
      *       = COPIED FROM 035, WITH HEAVY DELETIONS. ALL PROMO CODING 00100400
      *         HAS BEEN REMOVED. PROGRAM BASICLY RETURNS PERM INFO.    00100500
      * XSKUT061 - REAL-TIME MQSERIES/CICS PDE                          00100600
      *       = EXACT COPY OF 035, EXCEPT DFHEIBLK & XS045-COMMAREA     00100700
      *         HAVE BEEN ADDED TO THE CALL OF THE BUSINESS RULE PGM    00100800
      *         TO MAKE IT COMPATIBLE RUNNING AS A CICS PROGRAM.        00100900
      * XSKUT062 - REAL-TIME PDE (BY STORED PROCEDURE)                  00101000
      *       = COPIED FROM 035, MAIN CHANGE IS HOW IT'S COMPILED.      00102000
      ******************************************************************00102100
      * NOTE: SOME SECOND PHASE CODE IS IN THIS PROGRAM BUT COMMENTED   00102200
      *       OUT. THOSE LINES ARE IDENTIFIED W/ (P2).                  00102300
      ******************************************************************00102400
      * 06/04/03  - KARI HAAK   -  WR21770                             *00102500
      *   ADDED CODE TO HANDLE GOLDSTARS BY TICKET COLOR.              *00102600
      ******************************************************************00102700
      * 06/18/03  - KARI HAAK   -  WR21770                             *00102800
      * - MODIFIED STRUCTURE OF PROGRAM AND CORRECTED FUNCTIONALITY.   *00102900
      * - IN 9000-DISPLAY-ERROR REPLACED GOBACK WITH SETTING PS-ERROR- *00103000
      *   FOUND TO TRUE.  AFTER AN ERROR ON A FETCH, THE NEXT RECORD   *00104000
      *   SENT INTO THIS MODULE WAS ABENDING WHEN TRYING TO OPEN THE   *00105000
      *   SAME CURSOR.  CHECKING ERROR SWITCH ALLOWS CURSORS TO BE     *00106000
      *   CLOSED.                                                      *00107000
      ******************************************************************00108000
      * 06/20/03  - KARI HAAK   -  WR21770                             *00109000
      * - INITIALIZE  XS045-ELIG-PROMO-TBL BEFORE RETURNING TO CALLING *00110000
      *   PROGRAM.                                                     *00120000
      ******************************************************************00130000
      * 07/14/03  - KARI HAAK   -  WR21770                             *00131000
      * - SEPARATED THE CALL TO THE PDE RULES ENGINE INTO ANOTHER      *00132000
      *   PROCEDURE DIVISION, XSPD003.                                 *00133000
      * - MODIFIED LOGIC TO HANDLE THE NEW START AND END TIMESTAMPS    *00134000
      *   THAT ARE BEING KEPT.                                         *00135000
      * - BOTH CHANGES WERE REQUESTED BY RF.                           *00136000
      ******************************************************************00137000
      * 10/07/03  - KARI HAAK   -  P000603068                          *00138000
      * - CHANGED CALL TO THE BUSINESS RULES ENGINE TO BE PROGRAM      *00139000
      *   XSKUT037 INSTEAD OF XSKUT036.                                *00139100
      ******************************************************************00139200
       ENVIRONMENT DIVISION.                                            00139300
       CONFIGURATION SECTION.                                           00139400
       SOURCE-COMPUTER.        IBM-3090.                                00139500
       OBJECT-COMPUTER.        IBM-3090.                                00139600
                                                                        00139700
       INPUT-OUTPUT SECTION.                                            00139800
       FILE-CONTROL.                                                    00139900
                                                                        00140000
       DATA DIVISION.                                                   00150000
       FILE SECTION.                                                    00160000
                                                                        00170000
       WORKING-STORAGE SECTION.                                         00180000
                                                                        00190000
      ******************************************************************00200000
      *  THE WORKING STORAGE SECTION IS SHARED BETWEEN XSKUT035 &      *00210000
      *  XSKUT061                                                      *00220000
      ******************************************************************00230000
           COPY XSWS002.                                                00240000
                                                                        00250000
                                                                        00260000
       LINKAGE SECTION.                                                 00270000
      ******************************************************************00280000
      * PRICE DETERMINATION LAYOUT COPYBOOK                             00290000
      ******************************************************************00300000
           COPY XSRD047.                                                00310000
                                                                        00320000
      ******************************************************************00330000
       PROCEDURE DIVISION USING XS047-PRICE-DETERMINATION.              00340000
                                                                        00350000
       0000-MAINLINE.                                                   00360000
                                                                        00370000
           PERFORM 1000-INITIALIZATION.                                 00380000
           IF PS-NO-ERROR-FOUND                                         00390000
               PERFORM 2000-PROCESS-MERCH                               00400000
           END-IF.                                                      00410000
                                                                        00420000
           IF PS-NO-ERROR-FOUND                                         00430000
               PERFORM 3000-PROCESS-RULES                               00440000
           END-IF.                                                      00450000
                                                                        00460000
           GOBACK.                                                      00470000
                                                                        00480000
      ******************************************************************00490000
      ** THE CODE FOR THIS PROGRAM IS SHARED WITH PROGRAM XSKUT061.     00500000
      ** THE ONLY DIFFERENCE IS THE CALL TO THE RULES ENGINE.  THIS     00510000
      ** PROGRAM IS BATCH AND XSKUT061 IS CICS                          00520000
      ******************************************************************00530000
           COPY XSPD002.                                                00540000
           COPY XSPD003.                                                00550000
                                                                        00560000
      ******************************************************************00570000
      * CALL BEST PRICE MODULE                                          00580000
      ******************************************************************00590000
       8100-CALL-BUS-RULES-MOD.                                         00600000
                                                                        00610000
           CALL PC-BUS-RULE-ENGINE-BATCH                                00620000
                                    USING XS045-BUS-RULE-LINKAGE.       00630000
                                                                        00640000
      ******************************************************************00650000
      * DISPLAY ERROR VALUES                                            00660000
      ******************************************************************00670000
       9000-DISPLAY-ERRORS.                                             00680000
                                                                        00690000
           DISPLAY '**  ABEND     **'.                                  00700000
           DISPLAY '**  PROGRAM   **  =   XSKUT035'.                    00710000
           DISPLAY '**  PARAGRAPH **  = ' XS047-ERROR-SECTION-NAME.     00720000
                                                                        00730000
      ***************************************************************** 00740000
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    00750000
      * MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         00760000
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     00770000
      * FORMAT.                                                         00780000
      ***************************************************************** 00790000
           COPY DPPD004.                                                00800000
                                                                        00810000
           SET PS-ERROR-FOUND           TO TRUE.                        00820000
