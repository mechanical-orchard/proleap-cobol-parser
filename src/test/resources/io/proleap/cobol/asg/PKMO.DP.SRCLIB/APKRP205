000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.    APKRP205.                                         00030000
000400                                                                  00040000
000500 AUTHOR.        JOHN OBERHAUSER - CPU.                            00050000
000600                                                                  00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800                                                                  00080000
000900 DATE-WRITTEN.  02-23-95.                                         00090000
001000                                                                  00100000
001100 DATE-COMPILED.                                                   00110000
001200******************************************************************00120000
001300*                                                                 00130000
001400*                      - APKRP205 -                               00140000
001500*                                                                 00150000
001600* THIS PROGRAM PRODUCES THREE OUTPUT FILES.  THE DETAIL FILE      00160009
001700* CONTAINS ALL THE EXTRACTED TRANSACTIONS FOR THE LOCATIONS/      00170009
001800* ACCOUNTS REQUESTED.  THE SECOND IS A SUMMARY OF THE DETAIL BY   00180009
001900* PERIOD/ASSET/ACTIVITY.  THE THIRD IS A SALESTAX DETAIL FILE     00190009
002000* THAT SHOWS MORE INFORMATION ABOUT THE INVOICE AMOUNTS THAN      00200009
002010* THE GENERAL DETAIL FILE.                                        00201009
002100*                                                                 00210000
002200* MODIFICATION NOTES:                                             00220000
002300*                                                                 00230000
002400* 04/13/95 - NANCY EILBES - CHANGED THE WORK FIELDS AND REPORT    00240000
002500*            FIELDS FOR DOLLAR AMOUNTS TO BE SIGNED.              00250000
002600*                                                                 00260000
002700* 04/14/95 - LEN LEWANDOWSKI (CPU) - CHANGED DETAIL LINE TO ALIGN 00270000
002800*            VENDOR NAME                                          00280000
002900*                                                                 00290000
003000* 02/09/2000 JILL JUEL                     WR# 20564              00300000
003100*            CHANGED THE INPUT FILE TO BRING IN A PEOPLESOFT      00310000
003200*            EXTRACT FILE, THE FILE SIZE TO 175, AND THE REPORT   00320000
003300*            LAYOUT TO ACCOMIDATE THE PEOPLESOFT FIELDS.          00330000
003400*            CHANGED THE SUMMARY TAX REPORT TO HAVE THE TOTAL     00340000
003500*            FOR EACH PERIOD AND ACCOUNT.  CREATED 3 FILES TO     00350000
003600*            BE FTP'D TO THE COORPORATE SERVICE FOR ACCOUNTING    00360000
003700*            TO USE IN EXCEL.                                     00370000
003800*                                                                 00380000
003900* 06/28/2001 ALEXIS KEIKER                 WR# 21913              00390000
004000*            ADDED LAST ACCOUNT TOTALS FOR THE LAST PAGE OF THE   00400000
004100*            REPORT.                                              00410000
004200*                                                                 00420000
004300* 07/24/2006 MICHELE RINDFLEISCH           WR# 30771              00430000
004400*            MODIFIED DETAIL TAX REPORT, FTP-DETAIL-TAX-FILE,     00440000
004500*            AND FTP-SALES-TAX-FILE TO INCREASE THE SIZE          00450000
004600*            OF THE DOCUMENT NUMBER COLUMN FROM 10 TO 16          00460000
004700*            CHARACTERS.                                          00470000
004800*                                                                 00480000
004900* DATE  01/05/2010                                                00490000
005000*     CHANGE MADE: MODIFIED THE CODE TO DISPLAY THE ADDED         00500000
005100*     AP216-DESCR FIELD TO THE DETAIL AND SALES TAX FTP FILES.    00510000
005200*     INCREASED THE LENGTH OF THE DETAIL AND SALES TAX FTP FILES. 00520000
005300*     ADDED PIPE DELIMITERS TO ALL 3 FTP FILES REPLACING THE      00530000
005400*     SPACE DELIMITERS.  ADDED CODE TO INSPECT THE AP216-DESCR    00540000
005500*     FIELD FOR HEX CHARS THAT CAUSE PROBLEMS WITH THE FTP FILES. 00550000
005600*     THE HEX CHARACTERS ARE REPLACED WITH SPACE.                 00560000
005700*     MADE BY: MIKE BESKE              WR/IR #: WR37785           00570000
005800*                                                                 00580000
005810* DATE  06/14/2013                                                00581022
005820*     CHANGE MADE: REMOVED THE 2 REPORT FILES AS THE REPORTS ARE  00582009
005830*     NO LONGER BEING USED.  ADDED ORIGIN, ACCOUNT DESCRIPTION,   00583009
005840*     ASSET PROFILE, ACTIVITY TYPE, ACTIVITY ID, ACTIVITY DESCR,  00584009
005850*     PROJECT NUMBER, AND SHIP TO INFO TO THE DETAIL AND SALESTAX 00585009
005860*     DEAIL FILES.  ADDED MERCHANDISE AMT, DISC & FREIGHT TO THE  00586022
005870*     SALESTAX FILE.  ADDED ASSET AND ACTIVITY INFO TO THE SUMMARY00587009
005880*     FILE.  REMOVED ALL REFERENCES TO CART AND FRAME.            00588009
005890*     MADE BY: NANCY EILBES            WR/IR #: CH0055677         00589022
005891*                                                                 00589109
005900******************************************************************00590000
006100     EJECT                                                        00610000
006200                                                                  00620000
006300 ENVIRONMENT DIVISION.                                            00630000
006400                                                                  00640000
006500 CONFIGURATION SECTION.                                           00650000
006600                                                                  00660000
006700 SOURCE-COMPUTER.        IBM-3090.                                00670000
006800 OBJECT-COMPUTER.        IBM-3090.                                00680000
006900                                                                  00690000
007000 INPUT-OUTPUT SECTION.                                            00700000
007100                                                                  00710000
007200 FILE-CONTROL.                                                    00720000
007300                                                                  00730000
007400     SELECT INPUT-TAX-FILE       ASSIGN TO INP01.                 00740000
007700     SELECT FTP-DETAIL-TAX-FILE  ASSIGN TO OUT01.                 00770000
007800     SELECT FTP-SUMMARY-TAX-FILE ASSIGN TO OUT02.                 00780000
007900     SELECT FTP-SALES-TAX-FILE   ASSIGN TO OUT03.                 00790000
008000                                                                  00800000
008100     EJECT                                                        00810000
008200                                                                  00820000
008300 DATA DIVISION.                                                   00830000
008400                                                                  00840000
008500 FILE SECTION.                                                    00850000
008600                                                                  00860000
008700 FD  INPUT-TAX-FILE                                               00870000
008800     RECORDING MODE IS F                                          00880000
008900     LABEL RECORDS ARE STANDARD                                   00890000
009000     RECORD CONTAINS 325 CHARACTERS                               00900009
009100     BLOCK CONTAINS 0 RECORDS                                     00910000
009200     DATA RECORD IS INPUT-TAX-RECORD.                             00920000
009300                                                                  00930000
009400 01  INPUT-TAX-RECORD               PIC X(325).                   00940009
011500                                                                  01150000
011600                                                                  01160000
011700 FD  FTP-DETAIL-TAX-FILE                                          01170000
011800     RECORDING MODE IS F                                          01180000
011900     LABEL RECORDS ARE STANDARD                                   01190000
012000     RECORD CONTAINS 280 CHARACTERS                               01200013
012100     BLOCK CONTAINS 0 RECORDS                                     01210000
012200     DATA RECORD IS FTP-DETAIL-TAX-RECORD.                        01220000
012300                                                                  01230000
012400 01  FTP-DETAIL-TAX-RECORD          PIC X(280).                   01240013
012500                                                                  01250000
012600                                                                  01260000
012700 FD  FTP-SUMMARY-TAX-FILE                                         01270000
012800     RECORDING MODE IS F                                          01280000
012900     LABEL RECORDS ARE STANDARD                                   01290000
013000     RECORD CONTAINS 145 CHARACTERS                               01300013
013100     BLOCK CONTAINS 0 RECORDS                                     01310000
013200     DATA RECORD IS FTP-SUMMARY-TAX-RECORD.                       01320000
013300                                                                  01330000
013400 01  FTP-SUMMARY-TAX-RECORD         PIC X(145).                   01340013
013500                                                                  01350000
013600                                                                  01360000
013700 FD  FTP-SALES-TAX-FILE                                           01370000
013800     RECORDING MODE IS F                                          01380000
013900     LABEL RECORDS ARE STANDARD                                   01390000
014000     RECORD CONTAINS 347 CHARACTERS                               01400021
014100     BLOCK CONTAINS 0 RECORDS                                     01410000
014200     DATA RECORD IS FTP-SALES-TAX-RECORD.                         01420000
014300                                                                  01430000
014400 01  FTP-SALES-TAX-RECORD           PIC X(347).                   01440021
014500                                                                  01450000
014600     EJECT                                                        01460000
014700                                                                  01470000
014900 WORKING-STORAGE SECTION.                                         01490000
015100                                                                  01510000
015200******************************************************************01520000
015300*  COPYBOOK FOR THE STATE TAX AUDIT FILE                          01530000
015400******************************************************************01540000
015600     COPY APRD216.                                                01560000
015700                                                                  01570000
015800     EJECT                                                        01580000
017800 01  ACCUM-FIELDS.                                                01780000
017900     05  ACCUM-AMOUNT-PAID            PIC S9(13)V99 VALUE ZERO.   01790000
018000     05  ACCUM-BY-MONTH               PIC S9(15)V99 VALUE ZERO.   01800000
018100                                                                  01810000
018200 01  HOLD-FIELDS.                                                 01820000
018300     05  HOLD-YEAR                    PIC X(04)     VALUE ZERO.   01830000
018400     05  HOLD-MONTH                   PIC X(02)     VALUE SPACES. 01840000
018500     05  FILLER REDEFINES HOLD-MONTH.                             01850000
018600         10  HOLD-MONTH-N             PIC 9(02).                  01860000
018700     05  HOLD-ACCOUNT                 PIC X(07)     VALUE ZERO.   01870000
018710     05  HOLD-ACCT-DESCR              PIC X(30)     VALUE ZERO.   01871012
018800     05  HOLD-ASSET-PROFILE           PIC X(10)     VALUE ZERO.   01880012
018810     05  HOLD-ACTIVITY-TYPE           PIC X(05)     VALUE ZERO.   01881012
018820     05  HOLD-ACTIVITY-ID             PIC X(15)     VALUE ZERO.   01882012
018830     05  HOLD-ACTIVITY-DESCR          PIC X(30)     VALUE ZERO.   01883012
018900                                                                  01890000
019000 01  PC-PROGRAM-COUNTERS                             COMP-3.      01900000
019300     05  PC-RECORDS-IN               PIC 9(10)       VALUE ZERO.  01930000
019600     05  PC-FTP-DETAIL-OUT           PIC 9(10)       VALUE ZERO.  01960000
019700     05  PC-FTP-SUMMARY-OUT          PIC 9(10)       VALUE ZERO.  01970000
019800     05  PC-FTP-SALETX-OUT           PIC 9(10)       VALUE ZERO.  01980000
019900                                                                  01990000
020700 01  PS-PROGRAM-SWITCHES.                                         02070000
020800     05  PS-TAX-FILE-SW              PIC  X(01)      VALUE 'N'.   02080000
020900         88  TAX-FILE-EOF                            VALUE 'Y'.   02090000
021200                                                                  02120000
021300 01  WS-CONSTANTS.                                                02130000
021400     05  WSC-EXP-JOB-NAME            PIC X(30)       VALUE        02140000
021500                               '  EXPENSE ACCOUNT JOB APK970  '.  02150000
021600     05  WSC-FIX-JOB-NAME            PIC X(30)       VALUE        02160000
021700                               'FIXED ASSET ACCOUNT JOB APK975'.  02170000
021800     05  WSC-EXP-JOB-CONSTANT        PIC X(30)                    02180000
021900                                                 VALUE SPACES.    02190000
024300     EJECT                                                        02430000
041800                                                                  04180000
041900** FTP FILE HEADINGS/DETAIL INFO                                  04190000
042000                                                                  04200000
042100 01  DL1-FTP-DETAIL-HEADING.                                      04210000
042200     05  FILLER                      PIC  X(12)      VALUE        04220009
042300         'ORIGIN CODE|'.                                          04230009
042301     05  FILLER                      PIC  X(10)      VALUE        04230109
042302         'ACCOUNT #|'.                                            04230209
042303     05  FILLER                      PIC  X(14)      VALUE        04230309
042304         'ACCOUNT DESCR|'.                                        04230409
042305     05  FILLER                      PIC  X(09)      VALUE        04230509
042306         'PROFILE |'.                                             04230609
042307     05  FILLER                      PIC  X(09)      VALUE        04230709
042308         'ACTV TYP|'.                                             04230809
042309     05  FILLER                      PIC  X(12)      VALUE        04230910
042310         'ACTIVITY ID|'.                                          04231010
042311     05  FILLER                      PIC  X(15)      VALUE        04231109
042312         'ACTIVITY DESCR|'.                                       04231209
042313     05  FILLER                      PIC  X(11)      VALUE        04231314
042314         'PROJECT # |'.                                           04231409
042315     05  FILLER                      PIC  X(09)      VALUE        04231509
042316         'LOCATION|'.                                             04231609
042317     05  FILLER                      PIC  X(08)      VALUE        04231709
042318         'SHIP TO|'.                                              04231809
042319     05  FILLER                      PIC  X(14)      VALUE        04231909
042320         'SHIP TO DESCR|'.                                        04232009
042321     05  FILLER                      PIC  X(11)      VALUE        04232109
042322         'VENDOR # |'.                                            04232209
042323     05  FILLER                      PIC  X(12)      VALUE        04232309
042330         'VENDOR NAME|'.                                          04233009
042400     05  FILLER                      PIC  X(14)      VALUE SPACE. 04240000
043400     05  FILLER                      PIC  X(10)      VALUE        04340000
043500         'DOCUMENT #'.                                            04350000
043700     05  FILLER                      PIC  X(10)      VALUE        04370000
043800         '| DOC DATE'.                                            04380000
043900     05  FILLER                      PIC  X(01)      VALUE SPACE. 04390005
043910     05  FILLER                      PIC  X(11)      VALUE        04391009
043920         '|ACCTG DATE'.                                           04392009
044000     05  FILLER                      PIC  X(10)      VALUE        04400000
044100         '|PAID DATE'.                                            04410000
044200     05  FILLER                      PIC  X(01)      VALUE SPACE. 04420000
044300     05  FILLER                      PIC  X(08)      VALUE        04430000
044400         '|CHECK #'.                                              04440000
044500     05  FILLER                      PIC  X(03)      VALUE SPACE. 04450000
045300     05  FILLER                      PIC  X(07)      VALUE        04530000
045400         '|AMOUNT'.                                               04540000
045500     05  FILLER                      PIC  X(12)      VALUE SPACE. 04550007
045900     05  FILLER                      PIC  X(06)      VALUE SPACE. 04590000
046000                                                                  04600000
046100 01  DLFTP-DETAIL-LINE.                                           04610000
046110     05  DLFTP-ORIGIN                PIC  X(03)   VALUE SPACE.    04611010
046120     05  FILLER                      PIC  X(02)   VALUE '|'.      04612010
046130     05  DLFTP-ACCT-NBR              PIC  X(07)   VALUE SPACE.    04613010
046140     05  FILLER                      PIC  X(02)   VALUE '|'.      04614010
046150     05  DLFTP-ACCT-DESCR            PIC  X(30)   VALUE SPACE.    04615010
046160     05  FILLER                      PIC  X(02)   VALUE '|'.      04616010
046170     05  DLFTP-ASSET-PROFILE         PIC  X(10)   VALUE SPACE.    04617010
046180     05  FILLER                      PIC  X(01)   VALUE '|'.      04618010
046190     05  DLFTP-ACTIVITY-TYPE         PIC  X(05)   VALUE SPACE.    04619010
046191     05  FILLER                      PIC  X(01)   VALUE SPACE.    04619110
046192     05  FILLER                      PIC  X(01)   VALUE '|'.      04619210
046193     05  DLFTP-ACTIVITY-ID           PIC  X(15)   VALUE SPACE.    04619310
046194     05  FILLER                      PIC  X(01)   VALUE '|'.      04619410
046195     05  DLFTP-ACTIVITY-DESCR        PIC  X(30)   VALUE SPACE.    04619510
046196     05  FILLER                      PIC  X(01)   VALUE '|'.      04619610
046197     05  DLFTP-PROJECT-ID            PIC  X(10)   VALUE SPACE.    04619710
046198     05  FILLER                      PIC  X(01)   VALUE '|'.      04619810
046199     05  DLFTP-DEPTID                PIC  X(05)   VALUE SPACE.    04619910
046200     05  FILLER                      PIC  X(01)   VALUE '|'.      04620010
046210     05  DLFTP-SHIPTO                PIC  X(05)   VALUE SPACE.    04621010
046300     05  FILLER                      PIC  X(01)   VALUE '|'.      04630000
046301     05  DLFTP-SHIPTO-DESCR          PIC  X(30)   VALUE SPACE.    04630110
046302     05  FILLER                      PIC  X(01)   VALUE '|'.      04630210
046303     05  DLFTP-VEND-NBR              PIC  X(09)   VALUE SPACE.    04630310
046304     05  FILLER                      PIC  X(01)   VALUE '|'.      04630410
046310     05  DLFTP-VEND-NAME             PIC  X(25)   VALUE SPACE.    04631010
046320     05  FILLER                      PIC  X(01)   VALUE '|'.      04632010
047000     05  DLFTP-DOC-NBR               PIC  X(16)   VALUE SPACE.    04700000
047100     05  FILLER                      PIC  X(01)   VALUE '|'.      04710002
047200     05  DLFTP-DOC-DATE.                                          04720000
047300         10  DLFTP-DOCDTE-MM         PIC  X(02)   VALUE SPACE.    04730000
047400         10  FILLER                  PIC  X(01)   VALUE '/'.      04740000
047500         10  DLFTP-DOCDTE-DD         PIC  X(02)   VALUE SPACE.    04750000
047600         10  FILLER                  PIC  X(01)   VALUE '/'.      04760000
047700         10  DLFTP-DOCDTE-YR         PIC  X(04)   VALUE SPACE.    04770000
047800     05  FILLER                      PIC  X(01)   VALUE '|'.      04780000
047810     05  DLFTP-ACCOUNTING-DATE.                                   04781010
047820         10  DLFTP-ACTGDTE-MM        PIC  X(02)   VALUE SPACE.    04782010
047830         10  FILLER                  PIC  X(01)   VALUE '/'.      04783010
047840         10  DLFTP-ACTGDTE-DD        PIC  X(02)   VALUE SPACE.    04784010
047850         10  FILLER                  PIC  X(01)   VALUE '/'.      04785010
047860         10  DLFTP-ACTGDTE-YR        PIC  X(04)   VALUE SPACE.    04786010
047870     05  FILLER                      PIC  X(01)   VALUE '|'.      04787010
047900     05  DLFTP-CHECK-DATE.                                        04790000
048000         10  DLFTP-CHKDTE-MM         PIC  X(02)   VALUE SPACE.    04800000
048100         10  FILLER                  PIC  X(01)   VALUE '/'.      04810000
048200         10  DLFTP-CHKDTE-DD         PIC  X(02)   VALUE SPACE.    04820000
048300         10  FILLER                  PIC  X(01)   VALUE '/'.      04830000
048400         10  DLFTP-CHKDTE-YR         PIC  X(04)   VALUE SPACE.    04840000
048500     05  FILLER                      PIC  X(01)   VALUE '|'.      04850000
048600     05  DLFTP-CHECK-NBR             PIC  X(10)   VALUE SPACE.    04860000
048700     05  FILLER                      PIC  X(01)   VALUE '|'.      04870002
050100                                                                  05010000
050300 01  DLFTP2-DETAIL-LINE.                                          05030012
050400     05  DLFTP2-DETAILS              PIC  X(262)     VALUE SPACE. 05040013
050510     05  DLFTP2-AMOUNT               PIC  ---,---,--9.99.         05051018
050511     05  DLFTP2-AMOUNT-P             PIC  X(01)   VALUE SPACES.   05051118
050520     05  FILLER                      PIC  X(02)   VALUE SPACE.    05052012
050710                                                                  05071012
051900 01  SL1-FTP-SUMMARY-HEADING.                                     05190000
052000     05  FILLER                      PIC  X(10)  VALUE            05200013
052010         'PERIOD   |'.                                            05201013
052200     05  FILLER                      PIC  X(10)  VALUE            05220013
052210         'ACCOUNT  |'.                                            05221013
052310     05  FILLER                      PIC  X(14)  VALUE            05231013
052320         'ACCOUNT DESCR|'.                                        05232012
052330     05  FILLER                      PIC  X(09)  VALUE            05233013
052340         'PROFILE |'.                                             05234012
052350     05  FILLER                      PIC  X(09)  VALUE            05235013
052360         'ACTV TYP|'.                                             05236012
052370     05  FILLER                      PIC  X(12)  VALUE            05237013
052380         'ACTIVITY ID|'.                                          05238012
052390     05  FILLER                      PIC  X(15)  VALUE            05239013
052391         'ACTIVITY DESCR|'.                                       05239112
052400     05  FILLER                      PIC  X(12)  VALUE            05240013
052410         'TOTAL AMOUNT'.                                          05241013
052800     05  FILLER                      PIC  X(53)  VALUE SPACE.     05280000
052900                                                                  05290000
053000 01  SL2-FTP-SUMMARY-LINE.                                        05300000
053100     05  SL2-FTP-PERIOD              PIC  X(08) VALUE SPACE.      05310013
053200     05  FILLER                      PIC  X(02) VALUE ' |'.       05320013
053300     05  SL2-FTP-ACCOUNT             PIC  X(07) VALUE SPACE.      05330013
053400     05  FILLER                      PIC  X(03) VALUE '  |'.      05340013
053410     05  SL2-FTP-ACCT-DESCR          PIC  X(30) VALUE SPACE.      05341013
053420     05  FILLER                      PIC  X(02) VALUE '|'.        05342013
053430     05  SL2-FTP-ASSET-PROFILE       PIC  X(10) VALUE SPACE.      05343013
053440     05  FILLER                      PIC  X(01) VALUE '|'.        05344013
053450     05  SL2-FTP-ACTIVITY-TYPE       PIC  X(05) VALUE SPACE.      05345013
053460     05  FILLER                      PIC  X(01) VALUE SPACE.      05346013
053470     05  FILLER                      PIC  X(01) VALUE '|'.        05347013
053480     05  SL2-FTP-ACTIVITY-ID         PIC  X(15) VALUE SPACE.      05348013
053490     05  FILLER                      PIC  X(01) VALUE '|'.        05349013
053491     05  SL2-FTP-ACTIVITY-DESCR      PIC  X(30) VALUE SPACE.      05349113
053492     05  FILLER                      PIC  X(01) VALUE '|'.        05349213
053500     05  SL2-FTP-AMOUNT              PIC  ---,---,---,--9.99.     05350018
053510     05  SL2-FTP-AMOUNT-P            PIC  X(01) VALUE SPACES.     05351018
053600     05  FILLER                      PIC  X(08) VALUE SPACE.      05360013
054600     EJECT                                                        05460000
054700                                                                  05470000
054800 01  ST1-FTP-SALES-TAX-HEADING.                                   05480000
054801     05  FILLER                      PIC  X(12)      VALUE        05480112
054802         'ORIGIN CODE|'.                                          05480212
054803     05  FILLER                      PIC  X(10)      VALUE        05480312
054804         'ACCOUNT #|'.                                            05480412
054805     05  FILLER                      PIC  X(14)      VALUE        05480512
054806         'ACCOUNT DESCR|'.                                        05480612
054807     05  FILLER                      PIC  X(09)      VALUE        05480712
054808         'PROFILE |'.                                             05480812
054809     05  FILLER                      PIC  X(09)      VALUE        05480912
054810         'ACTV TYP|'.                                             05481012
054811     05  FILLER                      PIC  X(12)      VALUE        05481112
054812         'ACTIVITY ID|'.                                          05481212
054813     05  FILLER                      PIC  X(15)      VALUE        05481312
054814         'ACTIVITY DESCR|'.                                       05481412
054815     05  FILLER                      PIC  X(11)      VALUE        05481514
054816         'PROJECT # |'.                                           05481612
054817     05  FILLER                      PIC  X(09)      VALUE        05481712
054818         'LOCATION|'.                                             05481812
054819     05  FILLER                      PIC  X(08)      VALUE        05481912
054820         'SHIP TO|'.                                              05482012
054821     05  FILLER                      PIC  X(14)      VALUE        05482112
054822         'SHIP TO DESCR|'.                                        05482212
054823     05  FILLER                      PIC  X(11)      VALUE        05482312
054824         'VENDOR # |'.                                            05482412
054825     05  FILLER                      PIC  X(12)      VALUE        05482512
054826         'VENDOR NAME|'.                                          05482612
054828     05  FILLER                      PIC  X(10)      VALUE        05482812
054829         'DOCUMENT #'.                                            05482912
054830     05  FILLER                      PIC  X(10)      VALUE        05483012
054831         '| DOC DATE'.                                            05483112
054832     05  FILLER                      PIC  X(01)      VALUE SPACE. 05483212
054833     05  FILLER                      PIC  X(11)      VALUE        05483312
054834         '|ACCTG DATE'.                                           05483412
054835     05  FILLER                      PIC  X(10)      VALUE        05483512
054836         '|PAID DATE'.                                            05483612
054837     05  FILLER                      PIC  X(01)      VALUE SPACE. 05483712
054838     05  FILLER                      PIC  X(08)      VALUE        05483812
054839         '|CHECK #'.                                              05483912
058300     05  FILLER                      PIC  X(16)      VALUE        05830014
058400         '|MERCHANDISE AMT'.                                      05840012
058410     05  FILLER                      PIC  X(10)      VALUE        05841012
058420         '|SALES TAX'.                                            05842012
058421     05  FILLER                      PIC  X(08)      VALUE        05842121
058422         '|FREIGHT'.                                              05842221
058430     05  FILLER                      PIC  X(13)      VALUE        05843014
058440         '|DISCOUNT AMT'.                                         05844012
058510     05  FILLER                      PIC  X(15)      VALUE        05851014
058520         '|INVOICE AMOUNT'.                                       05852012
058900     05  FILLER                      PIC  X(06)      VALUE SPACE. 05890000
059000                                                                  05900000
059100 01  ST2-FTP-SALES-TAX-LINE.                                      05910000
059200     05  ST2-FTP-DETAILS             PIC X(262) VALUE SPACE.      05920018
059410     05  ST2-FTP-MERCHANDISE-AMT     PIC ---,---,--9.99.          05941018
059411     05  ST2-FTP-MERCHANDISE-AMT-P   PIC X(01) VALUE SPACES.      05941118
059412     05  FILLER                      PIC X(02) VALUE ' |'.        05941218
059420     05  ST2-FTP-SALETX-AMT          PIC ---,---,--9.99.          05942018
059421     05  ST2-FTP-SALETX-AMT-P        PIC X(01) VALUE SPACE.       05942118
059422     05  FILLER                      PIC X(02) VALUE ' |'.        05942218
059423     05  ST2-FTP-FREIGHT-AMT         PIC ---,---,--9.99.          05942321
059424     05  ST2-FTP-FREIGHT-AMT-P       PIC X(01) VALUE SPACE.       05942421
059425     05  FILLER                      PIC X(02) VALUE ' |'.        05942521
059430     05  ST2-FTP-DISCOUNT-AMT        PIC ---,---,--9.99.          05943018
059440     05  ST2-FTP-DISCOUNT-AMT-P      PIC X(01) VALUE SPACE.       05944018
059500     05  FILLER                      PIC X(02) VALUE ' |'.        05950018
059510     05  ST2-FTP-AMOUNT              PIC ---,---,--9.99.          05951018
059511     05  ST2-FTP-AMOUNT-P            PIC X(01) VALUE SPACE.       05951118
059520     05  FILLER                      PIC X(02) VALUE SPACE.       05952018
059800                                                                  05980000
059900     EJECT                                                        05990000
060000                                                                  06000000
061500** CONTROL CARD                                                   06150000
061600                                                                  06160000
061700 01  CC-CONTROL-CARD.                                             06170000
061800     05  FILLER                      PIC X(07).                   06180000
061900     05  CC-STATE-CD                 PIC X(02).                   06190000
062000     05  FILLER                      PIC X(08).                   06200000
062100     05  CC-START-DATE               PIC X(10).                   06210000
062200     05  FILLER REDEFINES CC-START-DATE.                          06220000
062300         10  CC-START-CCYY           PIC X(04).                   06230000
062400         10  FILLER                  PIC X(01).                   06240000
062500         10  CC-START-MM             PIC X(02).                   06250000
062600         10  FILLER                  PIC X(01).                   06260000
062700         10  CC-START-DD             PIC X(02).                   06270000
062800     05  FILLER                      PIC X(06).                   06280000
062900     05  CC-END-DATE                 PIC X(10).                   06290000
063000     05  FILLER REDEFINES CC-END-DATE.                            06300000
063100         10  CC-END-CCYY             PIC X(04).                   06310000
063200         10  FILLER                  PIC X(01).                   06320000
063300         10  CC-END-MM               PIC X(02).                   06330000
063400         10  FILLER                  PIC X(01).                   06340000
063500         10  CC-END-DD               PIC X(02).                   06350000
063600     05  FILLER                      PIC X(16).                   06360000
063700     05  CC-DETAIL-FLAG              PIC X(01).                   06370000
063800     05  FILLER                      PIC X(10).                   06380000
063900     05  CC-TYPERUN-FLAG             PIC X(01).                   06390000
064000         88  CC-EXPENSE-RUN          VALUE 'E'.                   06400000
064100         88  CC-FIXED-RUN            VALUE 'F'.                   06410000
064200     05  FILLER                      PIC X(09).                   06420000
064300                                                                  06430000
064400     EJECT                                                        06440000
064500                                                                  06450000
064600 01  MT-MONTH-SUB         PIC 9(02)  VALUE ZEROES.                06460000
064700                                                                  06470000
064800 01  MT-MONTH-TABLE.                                              06480000
064900     05  MT-MONTH-X.                                              06490000
065000         10  FILLER       PIC X(04)  VALUE 'JAN '.                06500000
065100         10  FILLER       PIC X(04)  VALUE 'FEB '.                06510000
065200         10  FILLER       PIC X(04)  VALUE 'MAR '.                06520000
065300         10  FILLER       PIC X(04)  VALUE 'APR '.                06530000
065400         10  FILLER       PIC X(04)  VALUE 'MAY '.                06540000
065500         10  FILLER       PIC X(04)  VALUE 'JUN '.                06550000
065600         10  FILLER       PIC X(04)  VALUE 'JLY '.                06560000
065700         10  FILLER       PIC X(04)  VALUE 'AUG '.                06570000
065800         10  FILLER       PIC X(04)  VALUE 'SEP '.                06580000
065900         10  FILLER       PIC X(04)  VALUE 'OCT '.                06590000
066000         10  FILLER       PIC X(04)  VALUE 'NOV '.                06600000
066100         10  FILLER       PIC X(04)  VALUE 'DEC '.                06610000
066200     05  MT-MONTH REDEFINES MT-MONTH-X    PIC X(04)               06620000
066300                             OCCURS 12  TIMES.                    06630000
066400                                                                  06640000
066500     EJECT                                                        06650000
066600                                                                  06660000
066700** ABEND AREA WORKING STORAGE                                     06670000
066800                                                                  06680000
066900 01  ABEND-CODE                            PIC S9(04) VALUE ZERO  06690000
067000                                                      COMP SYNC.  06700000
067100                                                                  06710000
067200     88  AC-INVALID-DATA                   VALUE  +4008.          06720000
067300     88  AC-DATE-ERROR                     VALUE  +4019.          06730000
067400                                                                  06740000
067500 01  ABEND-AREAS.                                                 06750000
067600     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  06760000
067700             '*****       ABEND'.                                 06770000
067800     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  06780000
067900             '*****   PROGRAM: VNKUT025'.                         06790000
068000     05  AA-PARAGRAPH-LIT.                                        06800000
068100         10  FILLER            PIC  X(17)  VALUE                  06810000
068200             '***** PARAGRAPH: '.                                 06820000
068300         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          06830000
068400     05  AA-MESSAGE-LINE.                                         06840000
068500         10  FILLER            PIC  X(06)  VALUE '*****'.         06850000
068600         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          06860000
068700         10  FILLER REDEFINES AA-MESSAGE.                         06870000
068800             15 AA-MESSAGE-1   PIC  X(45).                        06880000
068900             15 AA-MESSAGE-2   PIC  X(45).                        06890000
069000             15 AA-MESSAGE-3   PIC  X(37).                        06900000
069100                                                                  06910000
069200     EJECT                                                        06920000
069300                                                                  06930000
069400*--------------------------------------------------------------*  06940000
069500*  THIS CONTAINS THE SIX PARAMETER LISTS NEEDED TO             *  06950000
069600*  CALL THE CALENDAR MODULE 'DPKUT500'.                        *  06960000
069700*--------------------------------------------------------------*  06970000
069800                                                                  06980000
069900     COPY DPWS500.                                                06990000
070000                                                                  07000000
070100 EJECT                                                            07010000
070200                                                                  07020000
070400 PROCEDURE DIVISION.                                              07040000
070600                                                                  07060000
070700 A100-MAINLINE-ROUTINE.                                           07070000
070800                                                                  07080000
070900     PERFORM B100-INITIALIZATION.                                 07090000
071000                                                                  07100000
071100     PERFORM B200-PROCESS-TAX-RECORDS                             07110000
071200       UNTIL TAX-FILE-EOF.                                        07120000
071300                                                                  07130000
071400     PERFORM B300-TERMINATION-ROUTINE.                            07140000
071500                                                                  07150000
071600     STOP RUN.                                                    07160000
071700                                                                  07170000
071800     EJECT                                                        07180000
071900                                                                  07190000
072000*--------------------------------------------------------------*  07200000
072100*  INITIALIZATION                                              *  07210000
072200*--------------------------------------------------------------*  07220000
072300                                                                  07230000
072400 B100-INITIALIZATION.                                             07240000
072500                                                                  07250000
072600     DISPLAY 'DATE ' FUNCTION CURRENT-DATE(1:8)                   07260000
072700     DISPLAY 'TIME ' FUNCTION CURRENT-DATE(9:6)                   07270000
072800                                                                  07280000
072900     ACCEPT CC-CONTROL-CARD.                                      07290000
073000                                                                  07300000
073100     DISPLAY ' '                                                  07310000
073200     DISPLAY 'STATE CODE ' CC-STATE-CD.                           07320000
073300     DISPLAY 'START DATE ' CC-START-DATE.                         07330000
073400     DISPLAY 'END   DATE ' CC-END-DATE.                           07340000
073500     DISPLAY 'DETAIL RPT ' CC-DETAIL-FLAG.                        07350000
073600     DISPLAY 'TYPERUN    ' CC-TYPERUN-FLAG.                       07360000
073700     DISPLAY ' '                                                  07370000
073800                                                                  07380000
073900** THIS VERIFIES THE CONTROL CARD DATE, CC-START-DATE             07390000
074000                                                                  07400000
074100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07410000
074200                                                                  07420000
074300     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      07430000
074400                                                                  07440000
074500     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            07450000
074600                                                                  07460000
074700     MOVE CC-START-DATE TO DPG52-DB2-ISO-DATE-FMT                 07470000
074800                                                                  07480000
074900     PERFORM Z900-CALENDAR-ROUTINE.                               07490000
075000                                                                  07500000
075100     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 07510000
075200         DISPLAY 'INVALID START DATE ' CC-START-DATE              07520000
075300         SET AC-DATE-ERROR TO TRUE                                07530000
075400         MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME          07540000
075500         MOVE DPG54-ERROR-MESSAGE   TO AA-MESSAGE                 07550000
075600         PERFORM Z999-ABEND                                       07560000
075700     END-IF.                                                      07570000
075800                                                                  07580000
075900** THIS VERIFIES THE CONTROL CARD DATE, CC-END-DATE               07590000
076000                                                                  07600000
076100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07610000
076200                                                                  07620000
076300     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      07630000
076400                                                                  07640000
076500     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            07650000
076600                                                                  07660000
076700     MOVE CC-END-DATE TO DPG52-DB2-ISO-DATE-FMT                   07670000
076800                                                                  07680000
076900     PERFORM Z900-CALENDAR-ROUTINE.                               07690000
077000                                                                  07700000
077100     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 07710000
077200         DISPLAY 'INVALID END DATE ' CC-END-DATE                  07720000
077300         SET AC-DATE-ERROR TO TRUE                                07730000
077400         MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME          07740000
077500         MOVE DPG54-ERROR-MESSAGE   TO AA-MESSAGE                 07750000
077600         PERFORM Z999-ABEND                                       07760000
077700     END-IF.                                                      07770000
077800                                                                  07780000
078200                                                                  07820000
078300** TYPE RUN FLAG                                                  07830000
078400                                                                  07840000
078500     IF CC-TYPERUN-FLAG NOT = 'E' AND                             07850000
078600        CC-TYPERUN-FLAG NOT = 'F'                                 07860000
078700         DISPLAY 'INVALID TYPE RUN FLAG ' CC-TYPERUN-FLAG         07870000
078800         SET AC-INVALID-DATA TO TRUE                              07880000
078900         MOVE 'B100-INITIALIZATION' TO AA-PARAGRAPH-NAME          07890000
079000         MOVE 'TYPERUN FLAG ERROR'  TO AA-MESSAGE                 07900000
079100         PERFORM Z999-ABEND                                       07910000
079200     END-IF.                                                      07920000
079300                                                                  07930000
079400                                                                  07940000
079500** OPEN FILES                                                     07950000
079600                                                                  07960000
079700     OPEN INPUT  INPUT-TAX-FILE                                   07970000
079800          OUTPUT FTP-DETAIL-TAX-FILE                              07980009
080100                 FTP-SUMMARY-TAX-FILE                             08010000
080200                 FTP-SALES-TAX-FILE.                              08020000
080300                                                                  08030000
082700     IF CC-EXPENSE-RUN                                            08270000
082800         MOVE WSC-EXP-JOB-NAME TO WSC-EXP-JOB-CONSTANT            08280000
083200     ELSE                                                         08320000
083300         MOVE WSC-FIX-JOB-NAME TO WSC-EXP-JOB-CONSTANT            08330000
083700     END-IF.                                                      08370000
083800                                                                  08380000
083900     DISPLAY '****************************************'.          08390000
084000     DISPLAY '*****'.                                             08400000
084100     DISPLAY '**'  WSC-EXP-JOB-CONSTANT.                          08410000
084200     DISPLAY '*****'.                                             08420000
084300     DISPLAY '****************************************'.          08430000
084400     DISPLAY '**  START OF REPORT PROGRAM APKRP205  **'.          08440000
084500     DISPLAY '****************************************'.          08450000
084600** INITIAL HEADINGS FOR FTP FILES                                 08460009
084700                                                                  08470000
085000     WRITE FTP-DETAIL-TAX-RECORD FROM DL1-FTP-DETAIL-HEADING.     08500009
085500     WRITE FTP-SUMMARY-TAX-RECORD FROM SL1-FTP-SUMMARY-HEADING.   08550000
085600     WRITE FTP-SALES-TAX-RECORD   FROM ST1-FTP-SALES-TAX-HEADING. 08560000
085700                                                                  08570000
085800** INITIAL READ                                                   08580000
085900                                                                  08590000
086000     PERFORM R100-READ-TAX-FILE.                                  08600000
086100                                                                  08610000
086200     MOVE AP216-ACCOUNTING-YR  TO HOLD-YEAR.                      08620012
086300     MOVE AP216-ACCOUNTING-MM  TO HOLD-MONTH.                     08630012
086400     MOVE AP216-ACCOUNT        TO HOLD-ACCOUNT.                   08640012
086410     MOVE AP216-ACCT-DESCR     TO HOLD-ACCT-DESCR.                08641012
086420     MOVE AP216-ASSET-PROFILE  TO HOLD-ASSET-PROFILE.             08642012
086430     MOVE AP216-ACTIVITY-TYPE  TO HOLD-ACTIVITY-TYPE.             08643012
086440     MOVE AP216-ACTIVITY-ID    TO HOLD-ACTIVITY-ID.               08644012
086450     MOVE AP216-ACTIVITY-DESCR TO HOLD-ACTIVITY-DESCR.            08645012
086500                                                                  08650000
086600     EJECT                                                        08660000
086700                                                                  08670000
086800*--------------------------------------------------------------*  08680000
086900*     PROCESS LOOP FOR WRITING THE REPORT.                     *  08690000
087000*--------------------------------------------------------------*  08700000
087100                                                                  08710000
087200 B200-PROCESS-TAX-RECORDS.                                        08720000
087300                                                                  08730000
087400     IF  AP216-ACCOUNTING-YR  = HOLD-YEAR                         08740012
087500     AND AP216-ACCOUNTING-MM  = HOLD-MONTH                        08750012
087600     AND AP216-ACCOUNT        = HOLD-ACCOUNT                      08760012
087610     AND AP216-ASSET-PROFILE  = HOLD-ASSET-PROFILE                08761012
087620     AND AP216-ACTIVITY-TYPE  = HOLD-ACTIVITY-TYPE                08762012
087630     AND AP216-ACTIVITY-ID    = HOLD-ACTIVITY-ID                  08763012
087640     AND AP216-ACTIVITY-DESCR = HOLD-ACTIVITY-DESCR               08764012
087700         ADD AP216-AMOUNT-PAID TO ACCUM-AMOUNT-PAID               08770000
087800                                  ACCUM-BY-MONTH                  08780000
087900     ELSE                                                         08790000
088000         IF HOLD-MONTH-N NUMERIC                                  08800000
088100            MOVE HOLD-MONTH-N TO MT-MONTH-SUB                     08810000
088200            STRING MT-MONTH (MT-MONTH-SUB) DELIMITED BY SIZE      08820000
088300                 , HOLD-YEAR               DELIMITED BY SIZE      08830000
088400              INTO SL2-FTP-PERIOD                                 08840009
088500         END-IF                                                   08850000
088600         MOVE HOLD-ACCOUNT         TO SL2-FTP-ACCOUNT             08860012
088601         MOVE HOLD-ACCT-DESCR      TO SL2-FTP-ACCT-DESCR          08860112
088602         MOVE HOLD-ASSET-PROFILE   TO SL2-FTP-ASSET-PROFILE       08860212
088603         MOVE HOLD-ACTIVITY-TYPE   TO SL2-FTP-ACTIVITY-TYPE       08860312
088604         MOVE HOLD-ACTIVITY-ID     TO SL2-FTP-ACTIVITY-ID         08860412
088610         MOVE HOLD-ACTIVITY-DESCR  TO SL2-FTP-ACTIVITY-DESCR      08861012
088700         MOVE ACCUM-AMOUNT-PAID    TO SL2-FTP-AMOUNT              08870012
088701         IF ACCUM-AMOUNT-PAID < 0                                 08870120
088710            INSPECT SL2-FTP-AMOUNT REPLACING ALL '-' BY '('       08871020
088720            MOVE ')' TO SL2-FTP-AMOUNT-P                          08872020
088721         ELSE                                                     08872120
088730            MOVE ' ' TO SL2-FTP-AMOUNT-P                          08873020
088740         END-IF                                                   08874020
088800         PERFORM W400-WRITE-SUMMARY-LINE                          08880000
088900         MOVE AP216-AMOUNT-PAID TO ACCUM-AMOUNT-PAID              08890000
088910         IF  AP216-ACCOUNTING-YR  = HOLD-YEAR                     08891012
088920         AND AP216-ACCOUNTING-MM  = HOLD-MONTH                    08892012
089200             ADD AP216-AMOUNT-PAID TO ACCUM-BY-MONTH              08920012
089300         ELSE                                                     08930000
089900             MOVE AP216-AMOUNT-PAID TO ACCUM-BY-MONTH             08990012
090000         END-IF                                                   09000000
090100     END-IF.                                                      09010000
090200                                                                  09020000
090900     PERFORM C100-BUILD-DETAIL-REPORT.                            09090009
091000                                                                  09100009
091100**   IF AP216-SALETX-AMT NOT = 0                                  09110017
091200        PERFORM C200-BUILD-SALES-TAX-FILE                         09120009
091300**   END-IF.                                                      09130017
091500                                                                  09150000
091510     MOVE AP216-ACCOUNTING-YR  TO HOLD-YEAR.                      09151012
091520     MOVE AP216-ACCOUNTING-MM  TO HOLD-MONTH.                     09152012
091530     MOVE AP216-ACCOUNT        TO HOLD-ACCOUNT.                   09153012
091540     MOVE AP216-ACCT-DESCR     TO HOLD-ACCT-DESCR.                09154012
091550     MOVE AP216-ASSET-PROFILE  TO HOLD-ASSET-PROFILE.             09155012
091560     MOVE AP216-ACTIVITY-TYPE  TO HOLD-ACTIVITY-TYPE.             09156012
091570     MOVE AP216-ACTIVITY-ID    TO HOLD-ACTIVITY-ID.               09157012
091580     MOVE AP216-ACTIVITY-DESCR TO HOLD-ACTIVITY-DESCR.            09158012
091590                                                                  09159012
092000     PERFORM R100-READ-TAX-FILE.                                  09200000
092100                                                                  09210000
092200     EJECT                                                        09220000
092300                                                                  09230000
092400*--------------------------------------------------------------*  09240000
092500* B300-TERMINATION-ROUTINE                                     *  09250000
092600*--------------------------------------------------------------*  09260000
092700                                                                  09270000
092800 B300-TERMINATION-ROUTINE.                                        09280000
092900                                                                  09290000
093600     MOVE HOLD-ACCOUNT TO SL2-FTP-ACCOUNT.                        09360009
093700                                                                  09370000
093800     MOVE ACCUM-AMOUNT-PAID TO SL2-FTP-AMOUNT.                    09380009
093801     IF  ACCUM-AMOUNT-PAID < 0                                    09380120
093810         INSPECT SL2-FTP-AMOUNT REPLACING ALL '-' BY '('          09381020
093820         MOVE ')' TO SL2-FTP-AMOUNT-P                             09382020
093821     ELSE                                                         09382120
093830         MOVE ' ' TO SL2-FTP-AMOUNT-P                             09383020
093840     END-IF.                                                      09384020
093900                                                                  09390000
094000     PERFORM W400-WRITE-SUMMARY-LINE.                             09400000
094100                                                                  09410000
094200***  PERFORM W500-WRITE-TOTALS-BY-MONTH.                          09420017
094300                                                                  09430000
095200     DISPLAY '****************************************'.          09520000
095300     DISPLAY '**            RECORD COUNTS           **'.          09530000
095400     DISPLAY '****************************************'.          09540000
095500     DISPLAY 'RECORDS IN          ' PC-RECORDS-IN.                09550000
095800     DISPLAY 'FTP DETAIL REC  OUT ' PC-FTP-DETAIL-OUT.            09580000
095900     DISPLAY 'FTP SUMMARY REC OUT ' PC-FTP-SUMMARY-OUT.           09590000
096000     DISPLAY 'FTP SALETX  REC OUT ' PC-FTP-SALETX-OUT.            09600000
096100     DISPLAY '****************************************'.          09610000
096200     DISPLAY '*****'.                                             09620000
096300     DISPLAY '**'  WSC-EXP-JOB-CONSTANT.                          09630000
096400     DISPLAY '*****'.                                             09640000
096500     DISPLAY '**   END OF REPORT PROGRAM APKRP205   **'.          09650000
096600     DISPLAY '****************************************'.          09660000
096700                                                                  09670000
096800     CLOSE  INPUT-TAX-FILE                                        09680000
097100            FTP-DETAIL-TAX-FILE                                   09710000
097200            FTP-SUMMARY-TAX-FILE                                  09720000
097300            FTP-SALES-TAX-FILE.                                   09730000
097400                                                                  09740000
097500     EJECT                                                        09750000
097600                                                                  09760000
097700*--------------------------------------------------------------*  09770000
097800* BUILDS THE DETAIL RECORD FOR THE DETAIL REPORT               *  09780000
097900*--------------------------------------------------------------*  09790000
098000                                                                  09800000
098100 C100-BUILD-DETAIL-REPORT.                                        09810000
098200                                                                  09820000
098300     MOVE AP216-ORIGIN         TO DLFTP-ORIGIN.                   09830012
098400     MOVE AP216-VENDOR-NAME    TO DLFTP-VEND-NAME.                09840012
098500     MOVE AP216-VENDOR-NBR     TO DLFTP-VEND-NBR.                 09850009
098700     MOVE AP216-ACCOUNT        TO DLFTP-ACCT-NBR.                 09870009
098800     MOVE AP216-ACCT-DESCR     TO DLFTP-ACCT-DESCR.               09880012
098810     MOVE AP216-ACTIVITY-ID    TO DLFTP-ACTIVITY-ID.              09881002
098820     MOVE AP216-ACTIVITY-DESCR TO DLFTP-ACTIVITY-DESCR.           09882002
098830     MOVE AP216-ACTIVITY-TYPE  TO DLFTP-ACTIVITY-TYPE.            09883002
098840     MOVE AP216-ASSET-PROFILE  TO DLFTP-ASSET-PROFILE.            09884002
098850     MOVE AP216-PROJECT-ID     TO DLFTP-PROJECT-ID.               09885012
098900     MOVE AP216-DEPTID         TO DLFTP-DEPTID.                   09890009
099100     MOVE AP216-INVOICE-ID     TO DLFTP-DOC-NBR.                  09910009
099300     MOVE AP216-CHECK-NBR      TO DLFTP-CHECK-NBR.                09930009
100100                                                                  10010000
100200     MOVE AP216-ACCOUNTING-YR  TO DLFTP-ACTGDTE-YR.               10020009
100400     MOVE AP216-ACCOUNTING-MM  TO DLFTP-ACTGDTE-MM.               10040009
100600     MOVE AP216-ACCOUNTING-DD  TO DLFTP-ACTGDTE-DD.               10060009
100800                                                                  10080000
100900     MOVE AP216-INVOICE-YR     TO DLFTP-DOCDTE-YR.                10090009
101100     MOVE AP216-INVOICE-MM     TO DLFTP-DOCDTE-MM.                10110009
101300     MOVE AP216-INVOICE-DD     TO DLFTP-DOCDTE-DD.                10130009
101500                                                                  10150000
101600     MOVE AP216-PAID-DT-YR     TO DLFTP-CHKDTE-YR.                10160009
101800     MOVE AP216-PAID-DT-MM     TO DLFTP-CHKDTE-MM.                10180009
102000     MOVE AP216-PAID-DT-DD     TO DLFTP-CHKDTE-DD.                10200009
102010                                                                  10201012
102100     MOVE AP216-SHIPTO         TO DLFTP-SHIPTO.                   10210012
102110     MOVE AP216-SHIPTO-DESCR   TO DLFTP-SHIPTO-DESCR.             10211012
102200                                                                  10220000
102300     MOVE DLFTP-DETAIL-LINE    TO DLFTP2-DETAILS.                 10230012
102310     MOVE AP216-AMOUNT-PAID    TO DLFTP2-AMOUNT.                  10231012
102311     IF  AP216-AMOUNT-PAID < 0                                    10231120
102320         INSPECT DLFTP2-AMOUNT REPLACING ALL '-' BY '('           10232020
102330         MOVE ')' TO DLFTP2-AMOUNT-P                              10233020
102331     ELSE                                                         10233120
102340         MOVE ' ' TO DLFTP2-AMOUNT-P                              10234020
102350     END-IF.                                                      10235020
102400                                                                  10240012
102600     PERFORM W200-WRITE-DETAIL-LINE.                              10260000
102700                                                                  10270000
102800     EJECT                                                        10280000
102900                                                                  10290000
103000*--------------------------------------------------------------*  10300000
103100* BUILDS THE DETAIL RECORD FOR THE SALES TAX FILE, WHICH ADDS  *  10310017
103110* BREAK OUT OF THE COSTS.                                      *  10311017
103200*--------------------------------------------------------------*  10320000
103400 C200-BUILD-SALES-TAX-FILE.                                       10340000
107800                                                                  10780000
107900     MOVE DLFTP-DETAIL-LINE     TO ST2-FTP-DETAILS.               10790012
108100     MOVE AP216-MERCHANDISE-AMT TO ST2-FTP-MERCHANDISE-AMT.       10810012
108101     MOVE AP216-SALETX-AMT      TO ST2-FTP-SALETX-AMT.            10810112
108102     MOVE AP216-FREIGHT-AMT     TO ST2-FTP-FREIGHT-AMT.           10810221
108110     MOVE AP216-DISCOUNT-AMT    TO ST2-FTP-DISCOUNT-AMT.          10811012
108120     MOVE AP216-AMOUNT-PAID     TO ST2-FTP-AMOUNT.                10812013
108121                                                                  10812120
108122     IF  AP216-MERCHANDISE-AMT < 0                                10812220
108130         INSPECT ST2-FTP-MERCHANDISE-AMT REPLACING ALL '-' BY '(' 10813020
108140         MOVE ')' TO ST2-FTP-MERCHANDISE-AMT-P                    10814020
108141     ELSE                                                         10814120
108142         MOVE ' ' TO ST2-FTP-MERCHANDISE-AMT-P                    10814220
108143     END-IF.                                                      10814320
108144                                                                  10814420
108145     IF  AP216-SALETX-AMT < 0                                     10814520
108146         INSPECT ST2-FTP-SALETX-AMT REPLACING ALL '-' BY '('      10814620
108147         MOVE ')' TO ST2-FTP-SALETX-AMT-P                         10814720
108148     ELSE                                                         10814820
108149         MOVE ' ' TO ST2-FTP-SALETX-AMT-P                         10814920
108150     END-IF.                                                      10815020
108151                                                                  10815120
108152     IF  AP216-FREIGHT-AMT < 0                                    10815221
108153         INSPECT ST2-FTP-FREIGHT-AMT REPLACING ALL '-' BY '('     10815321
108154         MOVE ')' TO ST2-FTP-FREIGHT-AMT-P                        10815421
108155     ELSE                                                         10815521
108156         MOVE ' ' TO ST2-FTP-FREIGHT-AMT-P                        10815621
108157     END-IF.                                                      10815721
108158                                                                  10815821
108159     IF  AP216-DISCOUNT-AMT < 0                                   10815921
108160         INSPECT ST2-FTP-DISCOUNT-AMT REPLACING ALL '-' BY '('    10816021
108161         MOVE ')' TO ST2-FTP-DISCOUNT-AMT-P                       10816121
108162     ELSE                                                         10816221
108163         MOVE ' ' TO ST2-FTP-DISCOUNT-AMT-P                       10816321
108164     END-IF.                                                      10816421
108165                                                                  10816521
108166     IF  AP216-AMOUNT-PAID < 0                                    10816621
108167         INSPECT ST2-FTP-AMOUNT REPLACING ALL '-' BY '('          10816721
108168         MOVE ')' TO ST2-FTP-AMOUNT-P                             10816821
108170     ELSE                                                         10817020
108180         MOVE ' ' TO ST2-FTP-AMOUNT-P                             10818020
108190     END-IF.                                                      10819020
108200                                                                  10820000
108300     PERFORM W300-WRITE-SALESTAX-LINE.                            10830013
108700     EJECT                                                        10870000
108800                                                                  10880000
108900*--------------------------------------------------------------*  10890000
109000* R100-READ-TAX-FILE                                           *  10900000
109100*--------------------------------------------------------------*  10910000
109200                                                                  10920000
109300 R100-READ-TAX-FILE.                                              10930000
109400                                                                  10940000
109500     READ INPUT-TAX-FILE INTO AP216-STATE-TAX-AUDIT-RECORD        10950000
109600        AT END                                                    10960000
109700           SET TAX-FILE-EOF TO TRUE                               10970000
109800        NOT AT END                                                10980000
109900           INSPECT AP216-ACCT-DESCR                               10990009
110000                   REPLACING ALL X'00' BY ' '                     11000000
110100           INSPECT AP216-ACCT-DESCR                               11010009
110200                   REPLACING ALL X'0D25' BY '  '                  11020000
110300           INSPECT AP216-ACCT-DESCR                               11030009
110400                   REPLACING ALL X'0D15' BY '  '                  11040000
110500           INSPECT AP216-ACCT-DESCR                               11050009
110600                   REPLACING ALL X'0D' BY ' '                     11060000
110700           ADD 1 TO PC-RECORDS-IN                                 11070000
110800     END-READ.                                                    11080000
110900                                                                  11090000
111000     EJECT                                                        11100000
111100                                                                  11110000
115700                                                                  11570000
115800*--------------------------------------------------------------*  11580000
115900*  WRITE DETAIL REPORT DETAIL LINES.                           *  11590000
116000*--------------------------------------------------------------*  11600000
116100                                                                  11610000
116200 W200-WRITE-DETAIL-LINE.                                          11620000
116300                                                                  11630000
117900     WRITE FTP-DETAIL-TAX-RECORD FROM DLFTP2-DETAIL-LINE.         11790015
118000                                                                  11800000
118100     ADD 1 TO PC-FTP-DETAIL-OUT.                                  11810000
118200                                                                  11820000
119400     EJECT                                                        11940000
119410*--------------------------------------------------------------*  11941013
119420*  WRITE SALES TAX LINE.                                       *  11942013
119430*--------------------------------------------------------------*  11943013
119440                                                                  11944013
119450 W300-WRITE-SALESTAX-LINE.                                        11945013
119460                                                                  11946013
119481     WRITE FTP-SALES-TAX-RECORD FROM ST2-FTP-SALES-TAX-LINE.      11948113
119482                                                                  11948213
119483     ADD 1 TO PC-FTP-SALETX-OUT.                                  11948313
119484                                                                  11948413
119494     EJECT                                                        11949413
123600*--------------------------------------------------------------*  12360000
123700*  WRITE SUMMARY REPORT DETAIL LINES.                          *  12370000
123800*--------------------------------------------------------------*  12380000
123900                                                                  12390000
124000 W400-WRITE-SUMMARY-LINE.                                         12400000
124100                                                                  12410000
126500     WRITE FTP-SUMMARY-TAX-RECORD FROM SL2-FTP-SUMMARY-LINE.      12650000
126600                                                                  12660000
126700     ADD 1 TO PC-FTP-SUMMARY-OUT.                                 12670000
126800                                                                  12680000
126900     EJECT                                                        12690000
132900*--------------------------------------------------------------*  13290000
133000*  THIS ROUTINE CALLS THE NEW FISCAL CALENDAR SUBROUTINE       *  13300000
133100*  TO OBTAIN DATE, PROGRAM NAME DPKUT500                       *  13310000
133200*--------------------------------------------------------------*  13320000
133300                                                                  13330000
133400 Z900-CALENDAR-ROUTINE.                                           13340000
133500                                                                  13350000
133600     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                13360000
133700                                             DPG52                13370000
133800                                             DPG53                13380000
133900                                             DPG54                13390000
134000                                             DPG55                13400000
134100                                             DPG56.               13410000
134200                                                                  13420000
134300     EJECT                                                        13430000
134400                                                                  13440000
134500*--------------------------------------------------------------*  13450000
134600*  ABEND ROUTINE                                               *  13460000
134700*--------------------------------------------------------------*  13470000
134800                                                                  13480000
134900 Z999-ABEND.                                                      13490000
135000                                                                  13500000
135100     DISPLAY AA-ABEND-LIT.                                        13510000
135200     DISPLAY AA-PROGRAM-LIT.                                      13520000
135300     DISPLAY AA-PARAGRAPH-LIT.                                    13530000
135400     DISPLAY AA-MESSAGE-LINE.                                     13540000
135500                                                                  13550000
135600     CALL 'ILBOABN0' USING ABEND-CODE.                            13560000
