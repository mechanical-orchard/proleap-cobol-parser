000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 TITLE 'UTILITY FILE PREP FOR INVENTORY SUMMARY REPORT'.          00040087
000500 PROGRAM-ID.             RVKUT030.                                00050065
000600 AUTHOR.                 THERESE RAMSEYER.                        00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE 2007.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*                                                                 00120087
001300*  THIS PROGRAM READS AN INPUT FILE OF PHYSICAL INVENTORY DETAILS 00130087
001400*  AND PRODUCES AN OUTPUT FILE OF SUMMED VALUES ON BUYER BY       00140087
001500*  DEPT AND BL.                                                   00150087
001600*                                                                 00160087
001700*  EACH INPUT RECORD HAS A QUANTITY OF 1. THE PROGRAM WILL SUM AND00170087
001800*  BREAK ON THE FOLLOWING LEVELS IN SORT ORDER:                   00180087
001900*                                                                 00190087
002000*  SORT FIELDS=(166,3,CH,A,                * BUYER NUMBER         00200087
002100*                48,3,ZD,A,                * DEPT                 00210087
002200*                1,38,CH,A,                * BL NUMBER            00220087
002300*                40,8,ZD,A,                * SKU                  00230087
002400*                54,11,ZD,A,               * UNIT COST            00240087
002500*                65,11,ZD,A,               * RETL COST            00250087
002600*                85,8,CH,A)                * SCAN DATE            00260087
002700*                                                                 00270087
002800* !NOTE! :  THE MAIN LOGIC IN 2000- IS WRITTEN SPECIFICALLY       00280087
002900*           TO ADDRESS THIS SORT ORDER, SO ALTERING THIS IN       00290087
003000*           ANY WAY W/O MAKING APPROPRIATE AND CORESPONDING       00300087
003100*           CHANGES IN THE PROGRAM MAY PRODUCE UNRELIABLE         00310087
003200*           AND UNEXPECTED RESULTS IN THE REPORT THAT             00320087
003300*           EVENTUALLY GETS PRODUCED FROM THIS PREP FILE.         00330087
003400*                                                                 00340087
003500*  THE FIELDS THAT GET SUMMED ARE:                                00350087
003600*  QTY, COST, EXTENDED COST, RETAIL AND EXTENDED RETAIL.          00360087
003700*                                                                 00370087
003800*  AN EXAMPLE OF THESE ON A REPORT:                               00380087
003900*                                                                 00390087
004000*  QTY     COST     EXTENDED COST     RETAIL     EXTENDED RETAIL  00400087
004100*  ____   ______   ______________   _________   ________________  00410087
004200*                                                                 00420087
004300*  1       15.00        15.00         22.99           22.99       00430087
004400*                                                                 00440087
004500*  2       12.00        24.00         19.99           39.98       00450087
004600*  ---------------------------------------------------------      00460087
004700*  3       27.00        39.00         42.98           62.97       00470087
004800*                                                                 00480087
004900*  (ONLY EXTENDED VALUES ARE MULTIPLIED BY THE SUMMED QTY)        00490087
005000*                                                                 00500087
005100*  THE RECORDS ARE WRITTEN TO THE OUTPUT FILE WHOSE FIRST         00510087
005200*  BYTE DESIGNATES A RECORD TYPE OF : 1=DTL, 3=DEPT,              00520087
005300*  4=BUYER & 5=GRAND. (2=BL IS NOT USED FOR THE SUMMARY)          00530087
005400*                                                                 00540087
005500*  THIS PREP FILE IS USED BY A SUBSEQUENT REPORT PROGRAM. THE     00550087
005600*  INTENTION WAS TO REDUCE COMPLEXITY OF THIS PROCESS BY SPLITTING00560087
005700*  THE SUMMING/BREAKING AND REPORT CREATION INTO 2 PROCESSES.     00570087
005800*                                                                 00580087
005900*  AS INPUT RECORDS ARE READ AND ADDED TO THE APPROPRIATE BUCKETS,00590087
006000*  AN INTERNAL TABLE IS BUILT TO HOUSE THE SAME TOTALS BY         00600087
006100*  DEPARTMENT - SO THAT DEPARTMENT TOTALS CAN BE DISPLAYED IN     00610087
006200*  NUMERIC  ORDER AT THE TIME OF A BUYER BREAK.                   00620087
006300*                                                                 00630087
006400*  EACH OUTPUT RECORD HAS THE ORIGINAL INPUT FIELDS PLUS A        00640087
006500*  CORRESPONDING SET OF FIELDS TO HOLD THE SUMMED VALUES          00650087
006600*  FOR THE 5 FIELDS (QTY, COST, EXT COST, RETL, EXT RETL)         00660087
006700*  DEPENDING UPON WHICH REC TYPE (DTL, DEPT, BUYER OR GRAND).     00670087
006800*  IF THE REC TYPE IS '3' MEANING DEPT LEVEL SUM OUTPUT REC,      00680087
006900*  THEN THE PERTINENT INFORMATION WILL BE IN THE RV028-DEPT-TOTALS00690087
007000*  WHICH INCLUDE RV028-DEPT-UNT-QTY                               00700087
007100*                RV028-DEPT-UNT-COST-AMT                          00710087
007200*                RV028-DEPT-EXT-UNT-COST-AMT                      00720087
007300*                RV028-DEPT-RTL-COST-AMT                          00730087
007400*                RV028-DEPT-EXT-RTL-COST-AMT                      00740087
007500*                                                                 00750088
007600*  IMPORTANT NOTE:                                                00760088
007700*  THE DATA IN THE FIRST PORTION OF EACH OUTREC (SIMILAR TO THE   00770088
007800*  INPUT) IS FROM THE LAST RECORD READ BEFORE THE BREAK, AND IS   00780088
007900*  MEANT TO JUST PASS ALONG THE INPUT FIELDS THAT ARE NEEDED FOR  00790088
008000*  REPORTING.  THE INTENTION WAS TO CLEAN UP THIS SITUATION BY    00800088
008100*  MOVING SPACES TO SOME SPECIFIC FIELDS IN THE UPPER PORTION     00810088
008200*  OF THE COPYBOOK (NON-TOTAL FIELDS), WHILE PASSING THE          00820088
008300*  APPROPRIATE TOTAL FIELDS FOR WHAT EVER LEVEL MAY BE GETTING    00830088
008400*  WRITTEN AT THE TIME, BL, DEPT, BUYER, GRAND. TIME FOR THIS     00840088
008500*  RAN OUT AS THE EMPHASIS WAS ON PRODUCING THE REPORTS FOR       00850088
008600*  THE USER AND THEN THE AUTHOR WAS RE-DIRECTED TO MORE PRESSING  00860088
008700*  ISSUES ON ANOTHER PROJECT.                                     00870088
009300*                                                                 00880000
009400******************************************************************00890000
009500                                                                  00900000
009600******************************************************************00910000
009700 ENVIRONMENT DIVISION.                                            00920000
009800******************************************************************00930000
009900                                                                  00940000
010000 CONFIGURATION SECTION.                                           00950000
010100                                                                  00960000
010200 SOURCE-COMPUTER.        IBM-3090.                                00970000
010300 OBJECT-COMPUTER.        IBM-3090.                                00980000
010400                                                                  00990000
010500 INPUT-OUTPUT SECTION.                                            01000000
010600                                                                  01010000
010700 FILE-CONTROL.                                                    01020000
010800                                                                  01030000
010900     SELECT INPUT-FILE                  ASSIGN TO INP01.          01040000
011000                                                                  01050000
011100     SELECT OUTPUT-FILE                 ASSIGN TO OUT01.          01060000
011200                                                                  01070000
011300******************************************************************01080000
011400 DATA DIVISION.                                                   01090000
011500******************************************************************01100000
011600                                                                  01110000
011700 FILE SECTION.                                                    01120000
011800                                                                  01130000
011900 FD  INPUT-FILE                                                   01140000
012000     RECORDING MODE IS F                                          01150000
012100     LABEL RECORDS ARE STANDARD                                   01160000
012200     BLOCK CONTAINS 0 RECORDS.                                    01170000
012300                                                                  01180000
012400 01  INPUT-RECORD                        PIC  X(200).             01190000
012500                                                                  01200000
012600 FD  OUTPUT-FILE                                                  01210000
012700     RECORDING MODE IS F                                          01220000
012800     LABEL RECORDS ARE STANDARD                                   01230000
012900     BLOCK CONTAINS 0 RECORDS.                                    01240000
013000                                                                  01250000
013100 01  OUTPUT-RECORD                       PIC  X(610).             01260069
013200                                                                  01270000
013300******************************************************************01280000
013400 WORKING-STORAGE SECTION.                                         01290000
013500******************************************************************01300000
013600                                                                  01310000
013700 01  ABEND-CODE                          PIC S9(04) VALUE +0      01320000
013800                                                     COMP SYNC.   01330000
013900*                                                                 01340000
014000*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01350000
014100*                                                                 01360000
014200     COPY DPWS004.                                                01370000
014300                                                                  01380000
014400*                                                                 01390000
014500*  COPYBOOK FOR INPUT INVENTORY FILE.                             01400000
014600*                                                                 01410000
014700     COPY RVRD023.                                                01420000
014800*                                                                 01430000
014900*  COPYBOOK FOR OUTPUT REPORT PREP FILE                           01440000
015000*                                                                 01450000
015100     COPY RVRD028.                                                01460065
015200                                                                  01470000
015300 01  PROGRAM-ACCUMULATORS.                                        01480000
015400     05  PA-TOTAL-STATS.                                          01490000
015500         10  PA-TOT-RECS-READ              PIC S9(07)  VALUE +0   01500000
015600                                                       COMP-3.    01510000
015700         10  PA-TOT-RECS-WRIT              PIC S9(07)  VALUE +0   01520000
015800                                                       COMP-3.    01530000
015900         10  PA-TOT-DTL-RECS-WRIT          PIC S9(07)  VALUE +0   01540000
016000                                                       COMP-3.    01550000
016100         10  PA-TOT-DEPT-TOTAL-RECS-WRIT   PIC S9(07)  VALUE +0   01560000
016200                                                       COMP-3.    01570000
016300         10  PA-TOT-BUYER-TOTAL-RECS-WRIT  PIC S9(07)  VALUE +0   01580000
016400                                                       COMP-3.    01590000
016500         10  PA-TOT-GRAND-TOTAL-RECS-WRIT  PIC S9(07)  VALUE +0   01600000
016600                                                       COMP-3.    01610000
016700     05  PA-DTL-DOLLARS.                                          01620000
016800         10  PA-DTL-COST                   PIC S9(09)V99          01630000
016900                                               VALUE +0 COMP-3.   01640000
017000         10  PA-DTL-EXT-COST               PIC S9(09)V99          01650000
017100                                               VALUE +0 COMP-3.   01660000
017200         10  PA-DTL-RETL                   PIC S9(09)V99          01670000
017300                                               VALUE +0 COMP-3.   01680000
017400         10  PA-DTL-EXT-RETL               PIC S9(09)V99          01690000
017500                                               VALUE +0 COMP-3.   01700000
017600     05  PA-DTL-QTY                        PIC S9(07)  VALUE +0   01710000
017700                                                        COMP-3.   01720000
017800     05  PA-BL-DOLLARS.                                           01730000
017900         10  PA-BL-COST                    PIC S9(09)V99          01740000
018000                                               VALUE +0 COMP-3.   01750000
018100         10  PA-BL-EXT-COST                PIC S9(09)V99          01760000
018200                                               VALUE +0 COMP-3.   01770000
018300         10  PA-BL-RETL                    PIC S9(09)V99          01780000
018400                                               VALUE +0 COMP-3.   01790000
018500         10  PA-BL-EXT-RETL                PIC S9(09)V99          01800000
018600                                               VALUE +0 COMP-3.   01810000
018700     05  PA-BL-QTY                         PIC S9(07)  VALUE +0   01820000
018800                                                        COMP-3.   01830000
018900     05  PA-DEPT-DOLLARS.                                         01840000
019000         10  PA-DEPT-COST                  PIC S9(09)V99          01850000
019100                                               VALUE +0 COMP-3.   01860000
019200         10  PA-DEPT-EXT-COST              PIC S9(09)V99          01870000
019300                                               VALUE +0 COMP-3.   01880000
019400         10  PA-DEPT-RETL                  PIC S9(09)V99          01890000
019500                                               VALUE +0 COMP-3.   01900000
019600         10  PA-DEPT-EXT-RETL              PIC S9(09)V99          01910000
019700                                               VALUE +0 COMP-3.   01920000
019800     05  PA-DEPT-QTY                       PIC S9(07)  VALUE +0   01930000
019900                                                        COMP-3.   01940000
020000     05  PA-BUYER-DOLLARS.                                        01950000
020100         10  PA-BUYER-COST                 PIC S9(09)V99          01960000
020200                                               VALUE +0 COMP-3.   01970000
020300         10  PA-BUYER-EXT-COST             PIC S9(09)V99          01980000
020400                                               VALUE +0 COMP-3.   01990000
020500         10  PA-BUYER-RETL                 PIC S9(09)V99          02000000
020600                                               VALUE +0 COMP-3.   02010000
020700         10  PA-BUYER-EXT-RETL             PIC S9(09)V99          02020000
020800                                               VALUE +0 COMP-3.   02030000
020900     05  PA-BUYER-QTY                      PIC S9(07)  VALUE +0   02040000
021000                                                        COMP-3.   02050000
021100                                                                  02060000
021200     05  PA-GRAND-DOLLARS.                                        02070000
021300         10  PA-GRAND-COST                 PIC S9(09)V99          02080000
021400                                               VALUE +0 COMP-3.   02090000
021500         10  PA-GRAND-EXT-COST             PIC S9(09)V99          02100000
021600                                               VALUE +0 COMP-3.   02110000
021700         10  PA-GRAND-RETL                 PIC S9(09)V99          02120000
021800                                               VALUE +0 COMP-3.   02130000
021900         10  PA-GRAND-EXT-RETL             PIC S9(09)V99          02140000
022000                                               VALUE +0 COMP-3.   02150000
022100     05  PA-GRAND-QTY                      PIC S9(07)  VALUE +0   02160000
022200                                                        COMP-3.   02170000
022300                                                                  02180000
022400 01  PC-CONSTANTS.                                                02190000
022500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        02200000
022600         'RVKUT030'.                                              02210065
022700     05  PC-DTL-IND                      PIC  9(01)  VALUE 1.     02220000
022800     05  PC-DEPT-TOT-IND                 PIC  9(01)  VALUE 3.     02230000
022900     05  PC-BUYER-TOT-IND                PIC  9(01)  VALUE 4.     02240000
023000     05  PC-GRAND-TOT-IND                PIC  9(01)  VALUE 5.     02250000
023100                                                                  02260000
023200 01  PS-PROGRAM-SWITCHES.                                         02270000
023300     05  PS-END-OF-FILE-SWITCH        PIC  X(01) VALUE 'N'.       02280000
023400         88  PS-EOF                              VALUE 'Y'.       02290000
023500         88  PS-NOT-EOF                          VALUE 'N'.       02300000
023600     05  PS-FIRST-PASS-SWITCH         PIC  X(01) VALUE 'N'.       02310000
023700         88  PS-FIRST-PASS-YES                   VALUE 'Y'.       02320000
023800         88  PS-FIRST-PASS-NO                    VALUE 'N'.       02330000
023900     05  PS-MULTIPLE-SWITCH           PIC  X(01) VALUE 'N'.       02340074
024000         88  PS-MULTIPLE-YES                     VALUE 'Y'.       02350074
024100         88  PS-MULTIPLE-NO                      VALUE 'N'.       02360074
024200     05  PS-DEPT-PRINT-CONTROL        PIC  X(01) VALUE 'S'.       02370000
024300         88  PS-DEPT-PRINT-START                 VALUE 'S'.       02380000
024400         88  PS-DEPT-PRINT-END                   VALUE 'E'.       02390000
024500     05  PS-DEPT-PRINT-IND            PIC  X(01) VALUE 'N'.       02400000
024600         88  PS-NO-DEPT-PRINTED                  VALUE 'N'.       02410000
024700         88  PS-DEPT-PRINTED                     VALUE 'Y'.       02420000
024800                                                                  02430000
024900 01  PROGRAM-VARIABLES.                                           02440000
025000     05  PV-CURRENT-TMST                 PIC  X(26)  VALUE SPACES.02450000
025100     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.02460000
025200     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 02470000
025300     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 02480000
025400     05  PV-DB2-OPER-UNT-ID              PIC S9(04) COMP VALUE +0.02490000
025500     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.02500000
025600     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.02510000
025700     05  PV-ACCUM-DEPT-NBR               PIC  X(03) VALUE SPACE.  02520000
025800                                                                  02530000
025900 01  PROGRAM-HOLD-VARIABLES.                                      02540000
026000     05  PV-HOLD-BL-NBR                  PIC  X(38) VALUE SPACE.  02550000
026100     05  PV-HOLD-BL-STATUS               PIC  X(01) VALUE SPACE.  02560000
026200     05  PV-HOLD-SKU                     PIC  X(08) VALUE SPACE.  02570000
026300     05  PV-HOLD-DEPT-NBR                PIC  X(03) VALUE SPACE.  02580000
026400     05  PV-HOLD-SUB-CL-NBR              PIC  9(02) VALUE 0.      02590000
026500     05  PV-HOLD-RETURN-TYPE             PIC  X(01) VALUE SPACE.  02600000
026600     05  PV-HOLD-COST                    PIC  9(07)V99 VALUE 0.   02610000
026700     05  PV-HOLD-RETL                    PIC  9(07)V99 VALUE 0.   02620000
026800     05  PV-HOLD-UNT-QTY                 PIC S9(09) VALUE +0.     02630000
026900     05  PV-HOLD-SCAN-DTE                PIC  X(08) VALUE SPACE.  02640000
027000     05  PV-HOLD-LOC-ID                  PIC  X(50) VALUE SPACE.  02650000
027100     05  PV-HOLD-DISP                    PIC  X(01) VALUE SPACE.  02660000
027200     05  PV-HOLD-PUT-AWAY-DATE           PIC  X(08) VALUE SPACE.  02670000
027300     05  PV-HOLD-TRNS-NBR-STR            PIC  9(04) VALUE 0.      02680000
027400     05  PV-HOLD-TRNS-NBR                PIC  9(06) VALUE 0.      02690000
027500     05  PV-HOLD-RTV-LOC                 PIC  X(04) VALUE SPACE.  02700000
027600     05  PV-HOLD-BUYER-NBR               PIC  X(03) VALUE SPACE.  02710000
027700     05  PV-HOLD-BUYER-NAME              PIC  X(32) VALUE SPACE.  02720000
027800                                                                  02730000
027900                                                                  02740000
028000 01  DT-DEPARTMENT-TOTALS.                                        02750000
028100     05  DT-MAX-DEPTS                    PIC S9(3) VALUE +25      02760000
028200                                                     COMP-3.      02770000
028300     05  DT-HOLD-DEPT-NBR                PIC X(03) VALUE SPACE.   02780000
028400                                                                  02790000
028500 01  DT-DEPT-TOTAL-TABLE.                                         02800000
028600     05  DT-DEPT-TOTAL-ENTRIES           OCCURS 25 TIMES          02810000
028700                                         INDEXED BY DT-IDX.       02820000
028800         10  DT-DEPT-NBR                 PIC  X(03)  VALUE SPACES.02830000
028900         10  DT-QTY-DEPT-TOTAL           PIC S9(05)  VALUE +0     02840000
029000                                                     COMP-3.      02850000
029100         10  DT-UNIT-COST-DEPT-TOTAL     PIC S9(07)V99            02860000
029200                                                     VALUE +0     02870000
029300                                                     COMP-3.      02880000
029400         10  DT-UNIT-EXT-COST-DEPT-TOTAL PIC S9(07)V99            02890000
029500                                                     VALUE +0     02900000
029600                                                     COMP-3.      02910000
029700         10  DT-RETL-COST-DEPT-TOTAL     PIC S9(07)V99            02920000
029800                                                     VALUE +0     02930000
029900                                                     COMP-3.      02940000
030000         10  DT-RETL-EXT-COST-DEPT-TOTAL PIC S9(07)V99            02950000
030100                                                     VALUE +0     02960000
030200                                                     COMP-3.      02970000
030300******************************************************************02980000
030400*  DB2 COMMUNICATION AREA.                                        02990000
030500******************************************************************03000000
030600     EXEC SQL                                                     03010000
030700          INCLUDE SQLCA                                           03020000
030800     END-EXEC.                                                    03030000
030900                                                                  03040000
031000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03050000
031100 PROCEDURE DIVISION.                                              03060000
031200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03070000
031300                                                                  03080000
031400******************************************************************03090000
031500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    03100000
031600******************************************************************03110000
031700 0000-PROGRAM-MAINLINE.                                           03120000
031800     DISPLAY '************ START OF RVKUT030 ***************'     03130089
031900     PERFORM 1000-INITIALIZE.                                     03140000
032000                                                                  03150000
032100     IF PS-NOT-EOF                                                03160000
032200        PERFORM 1100-CONTINUE-PROCESSING                          03170000
032300     ELSE                                                         03180000
032400        DISPLAY ' '                                               03190000
032500        DISPLAY '******  EMPTY INPUT FILE  ********'              03200000
032600        DISPLAY ' '                                               03210000
032700        CLOSE INPUT-FILE                                          03220000
032800              OUTPUT-FILE                                         03230000
032900     END-IF.                                                      03240000
033000                                                                  03250000
033100     DISPLAY '************  END OF RVKUT030  ***************'     03260089
033200     STOP RUN.                                                    03270000
033300                                                                  03280000
033400******************************************************************03290000
033500*  INIT VARIABLES                                                 03300000
033600*  OPEN FILES                                                     03310000
033700*  DO A PRIME READ                                                03320000
033800******************************************************************03330000
033900 1000-INITIALIZE.                                                 03340000
034000                                                                  03350000
034100     EXEC SQL                                                     03360000
034200          SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                03370000
034300     END-EXEC.                                                    03380000
034400                                                                  03390000
034500     OPEN INPUT  INPUT-FILE                                       03400000
034600          OUTPUT OUTPUT-FILE.                                     03410000
034700                                                                  03420000
034800     INITIALIZE PROGRAM-VARIABLES                                 03430000
034900                PROGRAM-HOLD-VARIABLES                            03440000
035000                PROGRAM-ACCUMULATORS                              03450000
035100                RV023-INVENTORY-RECORD                            03460000
035200                RV028-INV-SUM-RPT-PREP-REC.                       03470067
035300                                                                  03480000
035400     MOVE +0    TO RV028-DTL-TOTALS                               03490067
035500                   RV028-DEPT-TOTALS                              03500067
035600                   RV028-BUYER-TOTALS                             03510067
035700                   RV028-GRAND-TOTALS.                            03520067
035800                                                                  03530000
035900     SET PS-FIRST-PASS-YES TO TRUE.                               03540000
036000                                                                  03550000
036100*ZERO OUT ALL BUCKETS                                             03560000
036200     PERFORM 6800-ZERO-OUT-ALL-BUCKETS.                           03570000
036300                                                                  03580000
036400*PRIME READ OF INPUT                                              03590000
036500     PERFORM 7000-READ-INPUT.                                     03600000
036600                                                                  03610000
036700*MOVE THE CURR REC DEPT NBR TO THE HOLD FIELD FOR THE INTERNAL    03620000
036800*DEPT TABLE USED TO ACCUMULATE DEPT TOTALS BY BUYER               03630000
036900     MOVE RV023-DEPT-NBR    TO PV-ACCUM-DEPT-NBR.                 03640000
037000                                                                  03650000
037100******************************************************************03660000
037200*                                                                 03670000
037300*                                                                 03680000
037400*                                                                 03690000
037500******************************************************************03700000
037600 1100-CONTINUE-PROCESSING.                                        03710000
037700                                                                  03720000
037800     PERFORM 2000-PROCESS UNTIL PS-EOF.                           03730000
037900                                                                  03740000
038000     PERFORM 8000-EOJ-ROUTINE.                                    03750000
038100                                                                  03760000
038200******************************************************************03770000
038300*                                                                 03780000
038400******************************************************************03790000
038500 2000-PROCESS.                                                    03800000
038600                                                                  03810000
038700     EVALUATE TRUE                                                03820000
038800***MULT DTLS                                                      03830079
038900        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         03840079
039000         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            03850079
039100         AND RV023-DEPT-NBR       EQUAL PV-HOLD-DEPT-NBR          03860079
039200         AND RV023-SKU            EQUAL PV-HOLD-SKU               03870079
039300         AND RV023-UNT-COST-AMT   EQUAL PV-HOLD-COST              03880079
039400         AND RV023-RTL-AMT        EQUAL PV-HOLD-RETL              03890079
039500         AND RV023-SCN-DATE       EQUAL PV-HOLD-SCAN-DTE          03900079
039600               PERFORM 5000-MULT-DTL                              03910079
039700                                                                  03920000
039800***NEW SCAN DATE                                                  03930080
039900        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         03940080
040000         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            03950080
040100         AND RV023-DEPT-NBR       EQUAL PV-HOLD-DEPT-NBR          03960080
040200         AND RV023-SKU            EQUAL PV-HOLD-SKU               03970080
040300         AND RV023-UNT-COST-AMT   EQUAL PV-HOLD-COST              03980080
040400         AND RV023-RTL-AMT        EQUAL PV-HOLD-RETL              03990080
040500         AND RV023-SCN-DATE       NOT EQUAL PV-HOLD-SCAN-DTE      04000080
040600               PERFORM 5100-SCAN-BREAK                            04010080
040700                                                                  04020080
040800***NEW RETAIL AMOUNT                                              04030000
040900        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         04040071
041000         AND RV023-DEPT-NBR       EQUAL PV-HOLD-DEPT-NBR          04050071
041100         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            04060071
041200         AND RV023-SKU            EQUAL PV-HOLD-SKU               04070081
041300         AND RV023-UNT-COST-AMT   EQUAL PV-HOLD-COST              04080071
041400         AND RV023-RTL-AMT        NOT EQUAL PV-HOLD-RETL          04090071
041500               PERFORM 5200-RETL-BREAK                            04100071
041600                                                                  04110000
041700***NEW COST AMOUNT                                                04120000
041800        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         04130071
041900         AND RV023-DEPT-NBR       EQUAL PV-HOLD-DEPT-NBR          04140071
042000         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            04150071
042100         AND RV023-SKU            EQUAL PV-HOLD-SKU               04160081
042200         AND RV023-UNT-COST-AMT   NOT EQUAL PV-HOLD-COST          04170071
042300               PERFORM 5300-COST-BREAK                            04180071
042400                                                                  04190000
042500***NEW SKU                                                        04200081
042600        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         04210081
042700         AND RV023-DEPT-NBR       EQUAL PV-HOLD-DEPT-NBR          04220081
042800         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            04230081
042900         AND RV023-SKU            NOT EQUAL PV-HOLD-SKU           04240081
043000               PERFORM 5400-SKU-BREAK                             04250081
043100                                                                  04260081
043200***NEW BL                                                         04270067
043300        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         04280067
043400         AND RV023-BL-NBR         NOT EQUAL PV-HOLD-BL-NBR        04290067
043500               PERFORM 5600-BL-BREAK                              04300067
043600                                                                  04310067
043700***NEW DEPT                                                       04320000
043800        WHEN RV023-BUYER-NBR      EQUAL PV-HOLD-BUYER-NBR         04330000
043900         AND RV023-BL-NBR         EQUAL PV-HOLD-BL-NBR            04340081
044000         AND RV023-DEPT-NBR       NOT EQUAL PV-HOLD-DEPT-NBR      04350067
044100               PERFORM 5500-DEPT-BREAK                            04360000
044200                                                                  04370000
044300***NEW BUYER NBR                                                  04380000
044400        WHEN RV023-BUYER-NBR      NOT EQUAL PV-HOLD-BUYER-NBR     04390000
044500         AND PS-FIRST-PASS-NO                                     04400000
044600               PERFORM 5700-BUYER-BREAK                           04410000
044700                                                                  04420000
044800***FIRST TIME THROUGH (FIRST REC)                                 04430000
044900        WHEN RV023-BUYER-NBR      NOT EQUAL PV-HOLD-BUYER-NBR     04440000
045000         AND RV023-DEPT-NBR       NOT EQUAL PV-HOLD-DEPT-NBR      04450067
045100         AND RV023-BL-NBR         NOT EQUAL PV-HOLD-BL-NBR        04460000
045200         AND RV023-SKU            NOT EQUAL PV-HOLD-SKU           04470000
045300         AND RV023-UNT-COST-AMT   NOT EQUAL PV-HOLD-COST          04480000
045400         AND RV023-RTL-AMT        NOT EQUAL PV-HOLD-RETL          04490000
045500         AND RV023-SCN-DATE       NOT EQUAL PV-HOLD-SCAN-DTE      04500000
045600         AND PS-FIRST-PASS-YES                                    04510000
045700               PERFORM 4900-ACCUM-DTL                             04520000
045800     END-EVALUATE.                                                04530000
045900                                                                  04540000
046000     PERFORM 6300-ACCUM-DEPT-TOTALS.                              04550000
046100                                                                  04560000
046200     PERFORM 7100-MOVE-TO-HOLD.                                   04570000
046300                                                                  04580000
046400     PERFORM 7000-READ-INPUT.                                     04590000
046500                                                                  04600000
046600     MOVE RV023-DEPT-NBR  TO PV-ACCUM-DEPT-NBR.                   04610000
046700                                                                  04620000
046800******************************************************************04630000
046900* THIS IS A FIRST TIME THROUGH, SO DOLLAR FIELDS SHOULD BE INIT 0 04640000
047000******************************************************************04650000
047100 4900-ACCUM-DTL.                                                  04660000
047200                                                                  04670000
047300     SET PS-FIRST-PASS-NO TO TRUE.                                04680000
047400                                                                  04690000
047500*LOAD "DTL" REC TYP FOR OUTREC                                    04700000
047600     MOVE PC-DTL-IND  TO RV028-REC-TYP.                           04710067
047700                                                                  04720000
047800*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         04730000
047900     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    04740000
048000     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    04750000
048100                                   PA-DTL-EXT-COST.               04760000
048200     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    04770000
048300                                   PA-DTL-EXT-RETL.               04780000
048400                                                                  04790000
048500*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          04800000
048600     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     04810000
048700     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     04820000
048800                                   PA-BL-EXT-COST.                04830000
048900     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     04840000
049000                                   PA-BL-EXT-RETL.                04850000
049100                                                                  04860000
049200*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        04870000
049300     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   04880000
049400     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   04890000
049500                                   PA-DEPT-EXT-COST.              04900000
049600     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   04910000
049700                                   PA-DEPT-EXT-RETL.              04920000
049800                                                                  04930000
049900*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       04940000
050000     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  04950000
050100     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  04960000
050200                                   PA-BUYER-EXT-COST.             04970000
050300     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  04980000
050400                                   PA-BUYER-EXT-RETL.             04990000
050500                                                                  05000000
050600*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       05010000
050700     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  05020000
050800     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  05030000
050900                                   PA-GRAND-EXT-COST.             05040000
051000     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  05050000
051100                                   PA-GRAND-EXT-RETL.             05060000
051200                                                                  05070000
051300*LOAD FIELDS (USE THE CURRENT REC - NOT HOLD FOR 1ST TIME THROUGH)05080000
051400     PERFORM 6500-PREP-OUTREC.                                    05090000
051500                                                                  05100000
051600******************************************************************05110000
051700*                                                                 05120000
051800******************************************************************05130000
051900 5000-MULT-DTL.                                                   05140000
052000                                                                  05150000
052100*THIS IS INTERROGATED IN 6300- SO THAT THE DUPLICATE INPUT VALUE  05160075
052200*IS ONLY DUMPED ONCE INTO DEPT ACCUM NON-EXTEND BUCKETS           05170075
052300     SET PS-MULTIPLE-YES TO TRUE                                  05180074
052400                                                                  05190075
052500*NOTE !!!!                                                        05200000
052600*ONLY ADD TO THE EXTENDED BUCKETS - BECAUSE THE NON-EXTENDED      05210000
052700*COST & RETAIL DOLLAR VALUES WILL BE THE SAME FOR THE DETAIL LINE 05220000
052800                                                                  05230000
052900*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         05240000
053000     ADD   RV023-UNT-QTY         TO PA-DTL-QTY.                   05250000
053100                                                                  05260000
053200     ADD RV023-UNT-COST-AMT      TO PA-DTL-EXT-COST.              05270000
053300     ADD RV023-RTL-AMT           TO PA-DTL-EXT-RETL.              05280000
053400                                                                  05290000
053500*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          05300000
053600     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     05310000
053700                                                                  05320000
053800     ADD   RV023-UNT-COST-AMT   TO PA-BL-EXT-COST.                05330000
053900     ADD   RV023-RTL-AMT        TO PA-BL-EXT-RETL.                05340000
054000                                                                  05350000
054100                                                                  05360000
054200*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        05370000
054300     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   05380000
054400                                                                  05390000
054500     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-EXT-COST.              05400000
054600     ADD   RV023-RTL-AMT        TO PA-DEPT-EXT-RETL.              05410000
054700                                                                  05420000
054800*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       05430000
054900     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  05440000
055000                                                                  05450000
055100     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-EXT-COST.             05460000
055200     ADD   RV023-RTL-AMT        TO PA-BUYER-EXT-RETL.             05470000
055300                                                                  05480000
055400*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       05490000
055500     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  05500000
055600                                                                  05510000
055700     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-EXT-COST.             05520000
055800     ADD   RV023-RTL-AMT        TO PA-GRAND-EXT-RETL.             05530000
055900                                                                  05540000
056000******************************************************************05550080
056100*                                                                 05560080
056200******************************************************************05570080
056300 5100-SCAN-BREAK.                                                 05580080
056400                                                                  05590080
056500*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         05600080
056600     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    05610080
056700     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    05620080
056800                                   PA-DTL-EXT-COST.               05630080
056900     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    05640080
057000                                   PA-DTL-EXT-RETL.               05650080
057100                                                                  05660080
057200*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          05670080
057300     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     05680080
057400     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     05690080
057500                                   PA-BL-EXT-COST.                05700080
057600     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     05710080
057700                                   PA-BL-EXT-RETL.                05720080
057800                                                                  05730080
057900*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        05740080
058000     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   05750080
058100     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   05760080
058200                                   PA-DEPT-EXT-COST.              05770080
058300     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   05780080
058400                                   PA-DEPT-EXT-RETL.              05790080
058500                                                                  05800080
058600*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       05810080
058700     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  05820080
058800     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  05830080
058900                                   PA-BUYER-EXT-COST.             05840080
059000     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  05850080
059100                                   PA-BUYER-EXT-RETL.             05860080
059200                                                                  05870080
059300*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       05880080
059400     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  05890080
059500     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  05900080
059600                                   PA-GRAND-EXT-COST.             05910080
059700     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  05920080
059800                                   PA-GRAND-EXT-RETL.             05930080
059900                                                                  05940080
060000******************************************************************05950000
060100*                                                                 05960000
060200******************************************************************05970000
060300 5200-RETL-BREAK.                                                 05980000
060400                                                                  05990000
060500*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         06000000
060600     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    06010000
060700     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    06020000
060800                                   PA-DTL-EXT-COST.               06030000
060900     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    06040000
061000                                   PA-DTL-EXT-RETL.               06050000
061100                                                                  06060000
061200*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          06070000
061300     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     06080000
061400     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     06090000
061500                                   PA-BL-EXT-COST.                06100000
061600     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     06110000
061700                                   PA-BL-EXT-RETL.                06120000
061800                                                                  06130000
061900*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        06140000
062000     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   06150000
062100     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   06160000
062200                                   PA-DEPT-EXT-COST.              06170000
062300     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   06180000
062400                                   PA-DEPT-EXT-RETL.              06190000
062500                                                                  06200000
062600*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       06210000
062700     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  06220000
062800     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  06230000
062900                                   PA-BUYER-EXT-COST.             06240000
063000     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  06250000
063100                                   PA-BUYER-EXT-RETL.             06260000
063200                                                                  06270000
063300*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       06280000
063400     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  06290000
063500     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  06300000
063600                                   PA-GRAND-EXT-COST.             06310000
063700     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  06320000
063800                                   PA-GRAND-EXT-RETL.             06330000
063900                                                                  06340000
064000******************************************************************06350000
064100*                                                                 06360000
064200******************************************************************06370000
064300 5300-COST-BREAK.                                                 06380000
064400                                                                  06390078
064500*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         06400000
064600     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    06410000
064700     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    06420000
064800                                   PA-DTL-EXT-COST.               06430000
064900     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    06440000
065000                                   PA-DTL-EXT-RETL.               06450000
065100                                                                  06460000
065200*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          06470000
065300     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     06480000
065400     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     06490000
065500                                   PA-BL-EXT-COST.                06500000
065600     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     06510000
065700                                   PA-BL-EXT-RETL.                06520000
065800                                                                  06530000
065900*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        06540000
066000     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   06550000
066100     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   06560000
066200                                   PA-DEPT-EXT-COST.              06570000
066300     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   06580000
066400                                   PA-DEPT-EXT-RETL.              06590000
066500                                                                  06600000
066600*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       06610000
066700     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  06620000
066800     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  06630000
066900                                   PA-BUYER-EXT-COST.             06640000
067000     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  06650000
067100                                   PA-BUYER-EXT-RETL.             06660000
067200                                                                  06670000
067300*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       06680000
067400     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  06690000
067500     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  06700000
067600                                   PA-GRAND-EXT-COST.             06710000
067700     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  06720000
067800                                   PA-GRAND-EXT-RETL.             06730000
067900                                                                  06740000
068000******************************************************************06750081
068100*                                                                 06760081
068200******************************************************************06770081
068300 5400-SKU-BREAK.                                                  06780081
068400                                                                  06790081
068500*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         06800081
068600     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    06810081
068700     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    06820081
068800                                   PA-DTL-EXT-COST.               06830081
068900     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    06840081
069000                                   PA-DTL-EXT-RETL.               06850081
069100                                                                  06860081
069200*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          06870081
069300     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     06880081
069400     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     06890081
069500                                   PA-BL-EXT-COST.                06900081
069600     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     06910081
069700                                   PA-BL-EXT-RETL.                06920081
069800                                                                  06930081
069900*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        06940081
070000     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   06950081
070100     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   06960081
070200                                   PA-DEPT-EXT-COST.              06970081
070300     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   06980081
070400                                   PA-DEPT-EXT-RETL.              06990081
070500                                                                  07000081
070600*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       07010081
070700     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  07020081
070800     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  07030081
070900                                   PA-BUYER-EXT-COST.             07040081
071000     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  07050081
071100                                   PA-BUYER-EXT-RETL.             07060081
071200                                                                  07070081
071300*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       07080081
071400     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  07090081
071500     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  07100081
071600                                   PA-GRAND-EXT-COST.             07110081
071700     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  07120081
071800                                   PA-GRAND-EXT-RETL.             07130081
071900                                                                  07140081
072000******************************************************************07150000
072100*                                                                 07160000
072200******************************************************************07170000
072300 5500-DEPT-BREAK.                                                 07180000
072400                                                                  07190000
072500*ZERO OUT THE OUTPUT DOLLAR FIELDS                                07200000
072600     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        07210000
072700                                                                  07220000
072800*LOAD THE SUMMED DTL VALUES TO THE REPORT DOLLAR FIELDS           07230000
072900     PERFORM 6510-PREP-OUTREC-DTL-DLRS.                           07240000
073000                                                                  07250000
073100*WRITE DETAIL                                                     07260000
073200     PERFORM 6600-WRITE-OUTREC.                                   07270000
073300                                                                  07280076
073400*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                07290000
073500     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        07300000
073600                                                                  07310000
073700*LOAD THE SUMMED DEPT VALUES TO THE REPORT DOLLAR FIELDS          07320000
073800     PERFORM 6530-PREP-OUTREC-DEPT-DLRS.                          07330000
073900                                                                  07340000
074000*LOAD THE "DEPT" REC TYP                                          07350000
074100     MOVE PC-DEPT-TOT-IND  TO RV028-REC-TYP.                      07360067
074200                                                                  07370000
074300*WRITE DEPT TOTAL LINE                                            07380000
074400     PERFORM 7500-PRINT-DEPT-TOTALS.                              07390000
074500                                                                  07400000
074600*INIT THE OUTREC                                                  07410000
074700     INITIALIZE RV028-INV-SUM-RPT-PREP-REC.                       07420068
074800                                                                  07430000
074900*AFTER A DEPT WRITE, SET UP FOR ANOTHER 'DTL' REC TYP             07440000
075000     MOVE PC-DTL-IND  TO RV028-REC-TYP.                           07450067
075100                                                                  07460000
075200*ZERO OUT THE DTL BUCKETS THAT WERE JUST WRITTEN                  07470000
075300     MOVE +0 TO PA-DTL-QTY                                        07480000
075400                PA-DTL-COST                                       07490000
075500                PA-DTL-EXT-COST                                   07500000
075600                PA-DTL-RETL                                       07510000
075700                PA-DTL-EXT-RETL.                                  07520000
075800                                                                  07530000
075900     MOVE +0 TO PA-DEPT-QTY                                       07540000
076000                PA-DEPT-COST                                      07550000
076100                PA-DEPT-EXT-COST                                  07560000
076200                PA-DEPT-RETL                                      07570000
076300                PA-DEPT-EXT-RETL.                                 07580000
076400                                                                  07590000
076500*LOAD THE PREV REC (HOLD) INTO THE OUTREC (NON BUCKET FIELDS)     07600000
076600*J/29PERFORM 6501-PREP-OUTREC-FROM-HOLD.                          07610083
076700*LOAD THE CURR REC RV023 INTO THE OUTREC (NON BUCKET FIELDS)      07620083
076800     PERFORM 6500-PREP-OUTREC.                                    07630083
076900                                                                  07640000
077000*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         07650000
077100     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    07660000
077200     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    07670000
077300                                   PA-DTL-EXT-COST.               07680000
077400     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    07690000
077500                                   PA-DTL-EXT-RETL.               07700000
077600                                                                  07710000
077700*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          07720000
077800     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     07730000
077900     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     07740000
078000                                   PA-BL-EXT-COST.                07750000
078100     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     07760000
078200                                   PA-BL-EXT-RETL.                07770000
078300                                                                  07780000
078400*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        07790000
078500     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   07800000
078600     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   07810000
078700                                   PA-DEPT-EXT-COST.              07820000
078800     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   07830000
078900                                   PA-DEPT-EXT-RETL.              07840000
079000                                                                  07850000
079100*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       07860000
079200     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  07870000
079300     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  07880000
079400                                   PA-BUYER-EXT-COST.             07890000
079500     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  07900000
079600                                   PA-BUYER-EXT-RETL.             07910000
079700                                                                  07920000
079800*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       07930000
079900     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  07940000
080000     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  07950000
080100                                   PA-GRAND-EXT-COST.             07960000
080200     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  07970000
080300                                   PA-GRAND-EXT-RETL.             07980000
080400                                                                  07990000
080500******************************************************************08000000
080600*                                                                 08010000
080700******************************************************************08020000
080800 5600-BL-BREAK.                                                   08030000
080900                                                                  08040000
081000*ZERO OUT THE OUTPUT DOLLAR FIELDS                                08050000
081100     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        08060000
081200                                                                  08070000
081300*LOAD THE SUMMED DTL VALUES TO THE REPORT DOLLAR FIELDS           08080000
081400     PERFORM 6510-PREP-OUTREC-DTL-DLRS.                           08090000
081500                                                                  08100000
081600*WRITE DETAIL                                                     08110000
081700     PERFORM 6600-WRITE-OUTREC.                                   08120000
081800                                                                  08130000
081900*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                08140000
082000     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        08150000
082100                                                                  08160000
082200*INIT THE OUTREC                                                  08170000
082300     INITIALIZE RV028-INV-SUM-RPT-PREP-REC.                       08180068
082400                                                                  08190000
082500*AFTER A BL WRITE, SET UP FOR ANOTHER 'DTL' REC TYP               08200000
082600     MOVE PC-DTL-IND  TO RV028-REC-TYP.                           08210067
082700                                                                  08220000
082800*ZERO OUT THE BUCKETS THAT WERE JUST WRITTEN                      08230000
082900     MOVE +0 TO PA-DTL-QTY                                        08240000
083000                PA-DTL-COST                                       08250000
083100                PA-DTL-EXT-COST                                   08260000
083200                PA-DTL-RETL                                       08270000
083300                PA-DTL-EXT-RETL.                                  08280000
083400                                                                  08290000
083500     MOVE +0 TO PA-DEPT-QTY                                       08300000
083600                PA-DEPT-COST                                      08310000
083700                PA-DEPT-EXT-COST                                  08320000
083800                PA-DEPT-RETL                                      08330000
083900                PA-DEPT-EXT-RETL.                                 08340000
084000                                                                  08350000
084100     MOVE +0 TO PA-BL-QTY                                         08360000
084200                PA-BL-COST                                        08370000
084300                PA-BL-EXT-COST                                    08380000
084400                PA-BL-RETL                                        08390000
084500                PA-BL-EXT-RETL.                                   08400000
084600                                                                  08410000
084700*LOAD THE CURR REC RV023 INTO THE OUTREC (NON BUCKET FIELDS)      08420000
084800     PERFORM 6500-PREP-OUTREC.                                    08430000
084900                                                                  08440000
085000*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         08450000
085100     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    08460000
085200     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    08470000
085300                                   PA-DTL-EXT-COST.               08480000
085400     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    08490000
085500                                   PA-DTL-EXT-RETL.               08500000
085600                                                                  08510000
085700*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          08520000
085800     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     08530000
085900     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     08540000
086000                                   PA-BL-EXT-COST.                08550000
086100     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     08560000
086200                                   PA-BL-EXT-RETL.                08570000
086300                                                                  08580000
086400*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        08590000
086500     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   08600000
086600     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   08610000
086700                                   PA-DEPT-EXT-COST.              08620000
086800     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   08630000
086900                                   PA-DEPT-EXT-RETL.              08640000
087000                                                                  08650000
087100*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       08660000
087200     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  08670000
087300     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  08680000
087400                                   PA-BUYER-EXT-COST.             08690000
087500     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  08700000
087600                                   PA-BUYER-EXT-RETL.             08710000
087700                                                                  08720000
087800*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       08730000
087900     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  08740000
088000     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  08750000
088100                                   PA-GRAND-EXT-COST.             08760000
088200     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  08770000
088300                                   PA-GRAND-EXT-RETL.             08780000
088400                                                                  08790000
088500******************************************************************08800000
088600*                                                                 08810000
088700******************************************************************08820000
088800 5700-BUYER-BREAK.                                                08830000
088900                                                                  08840000
089000*ZERO OUT THE OUTPUT DOLLAR FIELDS                                08850000
089100     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        08860000
089200                                                                  08870000
089300*LOAD THE SUMMED DTL VALUES TO THE REPORT DOLLAR FIELDS           08880000
089400     PERFORM 6510-PREP-OUTREC-DTL-DLRS.                           08890000
089500                                                                  08900000
089600*WRITE DETAIL                                                     08910000
089700     PERFORM 6600-WRITE-OUTREC.                                   08920000
089800                                                                  08930000
089900*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                08940000
090000     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        08950000
090100                                                                  08960000
090200*LOAD THE SUMMED DEPT VALUES TO THE REPORT DOLLAR FIELDS          08970000
090300     PERFORM 6530-PREP-OUTREC-DEPT-DLRS.                          08980000
090400                                                                  08990000
090500*LOAD THE "DEPT" REC TYP                                          09000000
090600     MOVE PC-DEPT-TOT-IND  TO RV028-REC-TYP.                      09010067
090700                                                                  09020000
090800*WRITE DEPT TOTAL LINE                                            09030000
090900     PERFORM 7500-PRINT-DEPT-TOTALS.                              09040000
091000                                                                  09050000
091100*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                09060000
091200     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        09070000
091300                                                                  09080000
091400*LOAD THE SUMMED BUYER VALUES TO THE REPORT DOLLAR FIELDS         09090000
091500     PERFORM 6540-PREP-OUTREC-BUYER-DLRS.                         09100000
091600                                                                  09110000
091700*LOAD THE "BUYER" REC TYP                                         09120000
091800     MOVE PC-BUYER-TOT-IND    TO RV028-REC-TYP.                   09130067
091900                                                                  09140000
092000*WRITE BUYER OUTREC                                               09150000
092100     PERFORM 6600-WRITE-OUTREC.                                   09160000
092200                                                                  09170000
092300*INIT THE OUTREC                                                  09180000
092400     INITIALIZE RV028-INV-SUM-RPT-PREP-REC.                       09190068
092500                                                                  09200000
092600*AFTER A BUYER WRITE, SET UP FOR ANOTHER 'DTL' REC TYP            09210000
092700     MOVE PC-DTL-IND  TO RV028-REC-TYP.                           09220067
092800                                                                  09230000
092900*ZERO OUT THE BUCKETS THAT WERE JUST WRITTEN                      09240000
093000     MOVE +0 TO PA-DTL-QTY                                        09250000
093100                PA-DTL-COST                                       09260000
093200                PA-DTL-EXT-COST                                   09270000
093300                PA-DTL-RETL                                       09280000
093400                PA-DTL-EXT-RETL.                                  09290000
093500                                                                  09300000
093600     MOVE +0 TO PA-DEPT-QTY                                       09310000
093700                PA-DEPT-COST                                      09320000
093800                PA-DEPT-EXT-COST                                  09330000
093900                PA-DEPT-RETL                                      09340000
094000                PA-DEPT-EXT-RETL.                                 09350000
094100                                                                  09360000
094200     MOVE +0 TO PA-BL-QTY                                         09370000
094300                PA-BL-COST                                        09380000
094400                PA-BL-EXT-COST                                    09390000
094500                PA-BL-RETL                                        09400000
094600                PA-BL-EXT-RETL.                                   09410000
094700                                                                  09420000
094800     MOVE +0 TO PA-BUYER-QTY                                      09430000
094900                PA-BUYER-COST                                     09440000
095000                PA-BUYER-EXT-COST                                 09450000
095100                PA-BUYER-RETL                                     09460000
095200                PA-BUYER-EXT-RETL.                                09470000
095300                                                                  09480000
095400*LOAD THE CURR REC RV023 INTO THE OUTREC (NON BUCKET FIELDS)      09490000
095500     PERFORM 6500-PREP-OUTREC.                                    09500000
095600                                                                  09510000
095700*LOAD QTY & DOLLAR FIELDS FOR DTL BUCKETS                         09520000
095800     ADD   RV023-UNT-QTY        TO PA-DTL-QTY.                    09530000
095900     ADD   RV023-UNT-COST-AMT   TO PA-DTL-COST                    09540000
096000                                   PA-DTL-EXT-COST.               09550000
096100     ADD   RV023-RTL-AMT        TO PA-DTL-RETL                    09560000
096200                                   PA-DTL-EXT-RETL.               09570000
096300                                                                  09580000
096400*LOAD QTY & DOLLAR FIELDS FOR BL BUCKETS                          09590000
096500     ADD   RV023-UNT-QTY        TO PA-BL-QTY.                     09600000
096600     ADD   RV023-UNT-COST-AMT   TO PA-BL-COST                     09610000
096700                                   PA-BL-EXT-COST.                09620000
096800     ADD   RV023-RTL-AMT        TO PA-BL-RETL                     09630000
096900                                   PA-BL-EXT-RETL.                09640000
097000                                                                  09650000
097100*LOAD QTY & DOLLAR FIELDS FOR DEPT BUCKETS                        09660000
097200     ADD   RV023-UNT-QTY        TO PA-DEPT-QTY.                   09670000
097300     ADD   RV023-UNT-COST-AMT   TO PA-DEPT-COST                   09680000
097400                                   PA-DEPT-EXT-COST.              09690000
097500     ADD   RV023-RTL-AMT        TO PA-DEPT-RETL                   09700000
097600                                   PA-DEPT-EXT-RETL.              09710000
097700                                                                  09720000
097800*LOAD QTY & DOLLAR FIELDS FOR BUYER BUCKETS                       09730000
097900     ADD   RV023-UNT-QTY        TO PA-BUYER-QTY.                  09740000
098000     ADD   RV023-UNT-COST-AMT   TO PA-BUYER-COST                  09750000
098100                                   PA-BUYER-EXT-COST.             09760000
098200     ADD   RV023-RTL-AMT        TO PA-BUYER-RETL                  09770000
098300                                   PA-BUYER-EXT-RETL.             09780000
098400                                                                  09790000
098500*LOAD QTY & DOLLAR FIELDS FOR GRAND BUCKETS                       09800000
098600     ADD   RV023-UNT-QTY        TO PA-GRAND-QTY.                  09810000
098700     ADD   RV023-UNT-COST-AMT   TO PA-GRAND-COST                  09820000
098800                                   PA-GRAND-EXT-COST.             09830000
098900     ADD   RV023-RTL-AMT        TO PA-GRAND-RETL                  09840000
099000                                   PA-GRAND-EXT-RETL.             09850000
099100                                                                  09860000
099200******************************************************************09870000
099300*                                                                 09880000
099400******************************************************************09890000
099500 6300-ACCUM-DEPT-TOTALS.                                          09900000
099600                                                                  09910000
099700      IF PV-ACCUM-DEPT-NBR = DT-DEPT-NBR(DT-IDX)                  09920000
099800         IF PS-MULTIPLE-YES                                       09930085
099900            SET PS-MULTIPLE-NO TO TRUE                            09940085
100000         ELSE                                                     09950085
100100            ADD RV023-UNT-COST-AMT  TO DT-UNIT-COST-DEPT-TOTAL    09960085
100200                                          (DT-IDX)                09970085
100300            ADD RV023-RTL-AMT       TO DT-RETL-COST-DEPT-TOTAL    09980085
100400                                          (DT-IDX)                09990085
100500         END-IF                                                   10000085
100600          ADD RV023-UNT-COST-AMT   TO DT-UNIT-EXT-COST-DEPT-TOTAL 10010000
100700                                          (DT-IDX)                10020000
100800          ADD RV023-RTL-AMT        TO DT-RETL-EXT-COST-DEPT-TOTAL 10030000
100900                                          (DT-IDX)                10040000
101000          ADD +1                       TO DT-QTY-DEPT-TOTAL       10050000
101100                                          (DT-IDX)                10060000
101200      ELSE                                                        10070000
101300*** IF IDX IS NOT ALREADY ON THE DEPT...                          10080000
101400          SET DT-IDX                   TO +1                      10090000
101500          PERFORM UNTIL                                           10100000
101600              ( DT-DEPT-NBR(DT-IDX) = PV-ACCUM-DEPT-NBR )         10110000
101700           OR ( DT-DEPT-NBR(DT-IDX) = '   '            )          10120000
101800           OR ( DT-IDX > DT-MAX-DEPTS                  )          10130000
101900              SET DT-IDX               UP BY +1                   10140000
102000          END-PERFORM                                             10150000
102100                                                                  10160000
102200          IF PV-ACCUM-DEPT-NBR = DT-DEPT-NBR(DT-IDX)              10170000
102300             IF PA-DTL-QTY > 1                                    10180000
102400                CONTINUE                                          10190000
102500             ELSE                                                 10200000
102600                ADD RV023-UNT-COST-AMT  TO DT-UNIT-COST-DEPT-TOTAL10210000
102700                                              (DT-IDX)            10220000
102800                ADD RV023-RTL-AMT       TO DT-RETL-COST-DEPT-TOTAL10230000
102900                                              (DT-IDX)            10240000
103000             END-IF                                               10250000
103100             ADD RV023-UNT-COST-AMT TO DT-UNIT-EXT-COST-DEPT-TOTAL10260000
103200                                           (DT-IDX)               10270000
103300             ADD RV023-RTL-AMT      TO DT-RETL-EXT-COST-DEPT-TOTAL10280000
103400                                          (DT-IDX)                10290000
103500             ADD +1                    TO DT-QTY-DEPT-TOTAL       10300000
103600                                          (DT-IDX)                10310000
103700          ELSE                                                    10320000
103800             IF DT-DEPT-NBR(DT-IDX) = '   '                       10330000
103900                                                                  10340000
104000                 MOVE PV-ACCUM-DEPT-NBR TO DT-DEPT-NBR(DT-IDX)    10350000
104100                 MOVE RV023-UNT-COST-AMT                          10360000
104200                                       TO DT-UNIT-COST-DEPT-TOTAL 10370000
104300                                          (DT-IDX)                10380000
104400                                   DT-UNIT-EXT-COST-DEPT-TOTAL    10390000
104500                                       (DT-IDX)                   10400000
104600                 MOVE RV023-RTL-AMT TO DT-RETL-COST-DEPT-TOTAL    10410000
104700                                          (DT-IDX)                10420000
104800                                    DT-RETL-EXT-COST-DEPT-TOTAL   10430000
104900                                        (DT-IDX)                  10440000
105000                 MOVE +1               TO DT-QTY-DEPT-TOTAL       10450000
105100                                          (DT-IDX)                10460000
105200             ELSE                                                 10470000
105300                IF DT-IDX > DT-MAX-DEPTS                          10480000
105400                   DISPLAY '** ABEND **'                          10490000
105500                   DISPLAY '** PROGRAM = RVKUT030 **'             10500065
105600                   DISPLAY                                        10510000
105700                   '** PARAGRAPH = 6300-ACCUM-DEPT-TOTALS     **' 10520000
105800                   DISPLAY                                        10530000
105900                   '** TABLE OVERFLOW ERROR SEARCHING DEPT TOTALS'10540000
106000                   DISPLAY '** DEPARTMENT NUMBER = '              10550000
106100                           PV-ACCUM-DEPT-NBR ' **'                10560000
106200                   MOVE +4004 TO ABEND-CODE                       10570000
106300                   CALL 'ILBOABN0' USING ABEND-CODE               10580000
106400                END-IF                                            10590000
106500             END-IF                                               10600000
106600          END-IF                                                  10610000
106700      END-IF.                                                     10620000
106800                                                                  10630000
106900******************************************************************10640000
107000*                                                                 10650000
107100******************************************************************10660000
107200 6500-PREP-OUTREC.                                                10670000
107300                                                                  10680000
107400     MOVE RV023-BL-NBR           TO RV028-BL-NBR.                 10690067
107500     MOVE RV023-BL-STATUS        TO RV028-BL-STATUS.              10700067
107600     MOVE RV023-SKU              TO RV028-SKU.                    10710067
107700     MOVE RV023-DEPT-NBR         TO RV028-DEPT-NBR.               10720067
107800     MOVE RV023-SUB-CL-NBR       TO RV028-SUB-CL-NBR.             10730067
107900     MOVE RV023-RETURN-TYPE      TO RV028-RETURN-TYPE.            10740067
108000     MOVE RV023-UNT-COST-AMT     TO RV028-UNT-COST-AMT.           10750067
108100     MOVE RV023-RTL-AMT          TO RV028-RTL-AMT.                10760067
108200     MOVE RV023-UNT-QTY          TO RV028-UNT-QTY.                10770067
108300     MOVE RV023-SCN-DATE         TO RV028-SCN-DATE.               10780067
108400     MOVE RV023-LOC-ID           TO RV028-LOC-ID.                 10790067
108500     MOVE RV023-DISP             TO RV028-DISP.                   10800067
108600     MOVE RV023-PUT-AWAY-DATE    TO RV028-PUT-AWAY-DATE.          10810067
108700     MOVE RV023-TRNS-NBR-STR     TO RV028-TRNS-NBR-STR.           10820067
108800     MOVE RV023-TRNS-NBR         TO RV028-TRNS-NBR.               10830067
108900     MOVE RV023-RTV-LOC          TO RV028-RTV-LOC.                10840067
109000     MOVE RV023-BUYER-NBR        TO RV028-BUYER-NBR.              10850067
109100     MOVE RV023-BUYER-NAME       TO RV028-BUYER-NAME.             10860067
109200                                                                  10870000
109300******************************************************************10880000
109400*                                                                 10890000
109500******************************************************************10900000
109600 6501-PREP-OUTREC-FROM-HOLD.                                      10910000
109700                                                                  10920000
109800     MOVE PV-HOLD-BL-NBR         TO RV028-BL-NBR.                 10930067
109900     MOVE PV-HOLD-BL-STATUS      TO RV028-BL-STATUS.              10940067
110000     MOVE PV-HOLD-SKU            TO RV028-SKU.                    10950067
110100     MOVE PV-HOLD-DEPT-NBR       TO RV028-DEPT-NBR.               10960067
110200     MOVE PV-HOLD-SUB-CL-NBR     TO RV028-SUB-CL-NBR.             10970067
110300     MOVE PV-HOLD-RETURN-TYPE    TO RV028-RETURN-TYPE.            10980067
110400     MOVE PV-HOLD-COST           TO RV028-UNT-COST-AMT.           10990067
110500     MOVE PV-HOLD-RETL           TO RV028-RTL-AMT.                11000067
110600     MOVE PV-HOLD-UNT-QTY        TO RV028-UNT-QTY.                11010067
110700     MOVE PV-HOLD-SCAN-DTE       TO RV028-SCN-DATE.               11020067
110800     MOVE PV-HOLD-LOC-ID         TO RV028-LOC-ID.                 11030067
110900     MOVE PV-HOLD-DISP           TO RV028-DISP.                   11040067
111000     MOVE PV-HOLD-PUT-AWAY-DATE  TO RV028-PUT-AWAY-DATE.          11050067
111100     MOVE PV-HOLD-TRNS-NBR-STR   TO RV028-TRNS-NBR-STR.           11060067
111200     MOVE PV-HOLD-TRNS-NBR       TO RV028-TRNS-NBR.               11070067
111300     MOVE PV-HOLD-RTV-LOC        TO RV028-RTV-LOC.                11080067
111400     MOVE PV-HOLD-BUYER-NBR      TO RV028-BUYER-NBR.              11090067
111500     MOVE PV-HOLD-BUYER-NAME     TO RV028-BUYER-NAME.             11100067
111600                                                                  11110000
111700******************************************************************11120000
111800*                                                                 11130000
111900******************************************************************11140000
112000 6510-PREP-OUTREC-DTL-DLRS.                                       11150000
112100                                                                  11160000
112200     MOVE PA-DTL-QTY             TO RV028-DTL-UNT-QTY.            11170067
112300     MOVE PA-DTL-COST            TO RV028-DTL-UNT-COST-AMT.       11180067
112400     MOVE PA-DTL-EXT-COST        TO RV028-DTL-EXT-UNT-COST-AMT.   11190067
112500     MOVE PA-DTL-RETL            TO RV028-DTL-RTL-COST-AMT.       11200067
112600     MOVE PA-DTL-EXT-RETL        TO RV028-DTL-EXT-RTL-COST-AMT.   11210067
112700                                                                  11220000
112800******************************************************************11230000
112900*                                                                 11240000
113000******************************************************************11250000
113100 6530-PREP-OUTREC-DEPT-DLRS.                                      11260000
113200                                                                  11270000
113300     MOVE PA-DEPT-QTY            TO RV028-DEPT-UNT-QTY.           11280067
113400     MOVE PA-DEPT-COST           TO RV028-DEPT-UNT-COST-AMT.      11290067
113500     MOVE PA-DEPT-EXT-COST       TO RV028-DEPT-EXT-UNT-COST-AMT.  11300067
113600     MOVE PA-DEPT-RETL           TO RV028-DEPT-RTL-COST-AMT.      11310067
113700     MOVE PA-DEPT-EXT-RETL       TO RV028-DEPT-EXT-RTL-COST-AMT.  11320067
113800                                                                  11330000
113900******************************************************************11340000
114000*                                                                 11350000
114100******************************************************************11360000
114200 6540-PREP-OUTREC-BUYER-DLRS.                                     11370000
114300                                                                  11380000
114400     MOVE PA-BUYER-QTY           TO RV028-BUYER-UNT-QTY.          11390067
114500     MOVE PA-BUYER-COST          TO RV028-BUYER-UNT-COST-AMT.     11400067
114600     MOVE PA-BUYER-EXT-COST      TO RV028-BUYER-EXT-UNT-COST-AMT. 11410067
114700     MOVE PA-BUYER-RETL          TO RV028-BUYER-RTL-COST-AMT.     11420067
114800     MOVE PA-BUYER-EXT-RETL      TO RV028-BUYER-EXT-RTL-COST-AMT. 11430067
114900                                                                  11440000
115000******************************************************************11450000
115100*                                                                 11460000
115200******************************************************************11470000
115300 6550-PREP-OUTREC-GRAND-DLRS.                                     11480000
115400                                                                  11490000
115500     MOVE PA-GRAND-QTY           TO RV028-GRAND-UNT-QTY.          11500067
115600     MOVE PA-GRAND-COST          TO RV028-GRAND-UNT-COST-AMT.     11510067
115700     MOVE PA-GRAND-EXT-COST      TO RV028-GRAND-EXT-UNT-COST-AMT. 11520067
115800     MOVE PA-GRAND-RETL          TO RV028-GRAND-RTL-COST-AMT.     11530067
115900     MOVE PA-GRAND-EXT-RETL      TO RV028-GRAND-EXT-RTL-COST-AMT. 11540067
116000                                                                  11550000
116100******************************************************************11560000
116200*                                                                 11570000
116300******************************************************************11580000
116400 6600-WRITE-OUTREC.                                               11590000
116500                                                                  11600000
116600     WRITE OUTPUT-RECORD                                          11610000
116700      FROM RV028-INV-SUM-RPT-PREP-REC.                            11620068
116800                                                                  11630000
116900     ADD 1 TO PA-TOT-RECS-WRIT.                                   11640000
117000                                                                  11650000
117100     EVALUATE RV028-REC-TYP                                       11660067
117200        WHEN PC-DTL-IND                                           11670000
117300             ADD 1 TO PA-TOT-DTL-RECS-WRIT                        11680000
117400        WHEN PC-DEPT-TOT-IND                                      11690000
117500             ADD 1 TO PA-TOT-DEPT-TOTAL-RECS-WRIT                 11700000
117600        WHEN PC-BUYER-TOT-IND                                     11710000
117700             ADD 1 TO PA-TOT-BUYER-TOTAL-RECS-WRIT                11720000
117800        WHEN PC-GRAND-TOT-IND                                     11730000
117900             ADD 1 TO PA-TOT-GRAND-TOTAL-RECS-WRIT                11740000
118000     END-EVALUATE.                                                11750000
118100                                                                  11760000
118200                                                                  11770000
118300******************************************************************11780000
118400*ZERO ALL THE BUCKETS - EXCEPT GRAND TOTAL BUCKETS                11790000
118500******************************************************************11800000
118600 6800-ZERO-OUT-ALL-BUCKETS.                                       11810000
118700                                                                  11820000
118800     MOVE +0 TO PA-DTL-QTY                                        11830000
118900                PA-DTL-COST                                       11840000
119000                PA-DTL-EXT-COST                                   11850000
119100                PA-DTL-RETL                                       11860000
119200                PA-DTL-EXT-RETL.                                  11870000
119300                                                                  11880000
119400     MOVE +0 TO PA-DEPT-QTY                                       11890000
119500                PA-DEPT-COST                                      11900000
119600                PA-DEPT-EXT-COST                                  11910000
119700                PA-DEPT-RETL                                      11920000
119800                PA-DEPT-EXT-RETL.                                 11930000
119900                                                                  11940000
120000     MOVE +0 TO PA-BL-QTY                                         11950000
120100                PA-BL-COST                                        11960000
120200                PA-BL-EXT-COST                                    11970000
120300                PA-BL-RETL                                        11980000
120400                PA-BL-EXT-RETL.                                   11990000
120500                                                                  12000000
120600     MOVE +0 TO PA-BUYER-QTY                                      12010000
120700                PA-BUYER-COST                                     12020000
120800                PA-BUYER-EXT-COST                                 12030000
120900                PA-BUYER-RETL                                     12040000
121000                PA-BUYER-EXT-RETL.                                12050000
121100                                                                  12060000
121200******************************************************************12070000
121300*ZERO ALL THE OUTPUT DOLLAR FIELDS                                12080000
121400******************************************************************12090000
121500 6900-ZERO-OUT-ALL-DLR-FIELDS.                                    12100000
121600                                                                  12110000
121700                                                                  12120000
121800     MOVE +0 TO RV028-DTL-UNT-QTY                                 12130067
121900                RV028-DTL-UNT-COST-AMT                            12140067
122000                RV028-DTL-EXT-UNT-COST-AMT                        12150067
122100                RV028-DTL-RTL-COST-AMT                            12160067
122200                RV028-DTL-EXT-RTL-COST-AMT                        12170067
122300                RV028-DEPT-UNT-QTY                                12180067
122400                RV028-DEPT-UNT-COST-AMT                           12190067
122500                RV028-DEPT-EXT-UNT-COST-AMT                       12200067
122600                RV028-DEPT-RTL-COST-AMT                           12210067
122700                RV028-DEPT-EXT-RTL-COST-AMT                       12220067
122800                RV028-BUYER-UNT-QTY                               12230067
122900                RV028-BUYER-UNT-COST-AMT                          12240067
123000                RV028-BUYER-EXT-UNT-COST-AMT                      12250067
123100                RV028-BUYER-RTL-COST-AMT                          12260067
123200                RV028-BUYER-EXT-RTL-COST-AMT.                     12270067
123300                                                                  12280000
123400                                                                  12290000
123500******************************************************************12300000
123600*                                                                 12310000
123700******************************************************************12320000
123800 7000-READ-INPUT.                                                 12330000
123900                                                                  12340000
124000     READ INPUT-FILE INTO RV023-INVENTORY-RECORD                  12350000
124100          AT END SET PS-EOF TO TRUE                               12360000
124200          NOT AT END ADD 1 TO PA-TOT-RECS-READ                    12370000
124300     END-READ.                                                    12380000
124400                                                                  12390000
124500*THE HDR INFO FOR RV027 IS LOADED FROM THE PREV (HOLD), FOR       12400000
124600*ALL RECS WRITTEN OUT EXCEPT THE LAST WHICH WOULD USE THE CURRENT 12410000
124700*REC SO THIS IS TO BE SURE THE LAST RECORD GETS THE RIGHT INFO    12420000
124800     IF PS-EOF                                                    12430000
124900        PERFORM 7100-MOVE-TO-HOLD                                 12440000
125000     END-IF.                                                      12450000
125100                                                                  12460000
125200******************************************************************12470000
125300*                                                                 12480000
125400******************************************************************12490000
125500 7100-MOVE-TO-HOLD.                                               12500000
125600                                                                  12510000
125700     MOVE RV023-BL-NBR            TO PV-HOLD-BL-NBR.              12520000
125800     MOVE RV023-BL-STATUS         TO PV-HOLD-BL-STATUS.           12530000
125900     MOVE RV023-SKU               TO PV-HOLD-SKU.                 12540000
126000     MOVE RV023-DEPT-NBR          TO PV-HOLD-DEPT-NBR.            12550000
126100     MOVE RV023-SUB-CL-NBR        TO PV-HOLD-SUB-CL-NBR.          12560000
126200     MOVE RV023-RETURN-TYPE       TO PV-HOLD-RETURN-TYPE.         12570000
126300     MOVE RV023-UNT-COST-AMT      TO PV-HOLD-COST.                12580000
126400     MOVE RV023-RTL-AMT           TO PV-HOLD-RETL.                12590000
126500     MOVE RV023-UNT-QTY           TO PV-HOLD-UNT-QTY.             12600000
126600     MOVE RV023-SCN-DATE          TO PV-HOLD-SCAN-DTE.            12610000
126700     MOVE RV023-LOC-ID            TO PV-HOLD-LOC-ID.              12620000
126800     MOVE RV023-DISP              TO PV-HOLD-DISP.                12630000
126900     MOVE RV023-PUT-AWAY-DATE     TO PV-HOLD-PUT-AWAY-DATE.       12640000
127000     MOVE RV023-TRNS-NBR-STR      TO PV-HOLD-TRNS-NBR-STR.        12650000
127100     MOVE RV023-TRNS-NBR          TO PV-HOLD-TRNS-NBR.            12660000
127200     MOVE RV023-RTV-LOC           TO PV-HOLD-RTV-LOC.             12670000
127300     MOVE RV023-BUYER-NBR         TO PV-HOLD-BUYER-NBR.           12680000
127400     MOVE RV023-BUYER-NAME        TO PV-HOLD-BUYER-NAME.          12690000
127500                                                                  12700000
127600******************************************************************12710000
127700* 7500-PRINT-DEPT-TOTALS.                                         12720000
127800* PROCESS:  THIS PARAGRAPH WILL PRINT THE DEPARTMENT TOTALS FROM  12730000
127900*  THE DEPARTMENT TOTALS WORKING STORAGE TABLE.  IT GOES THROUGH  12740000
128000*  TWO "PERFORMS" SO THAT THE TOTALS WILL BE PRINTED IN DEPARTMENT12750000
128100*  ORDER.  THE IF STATMENT WILL CHECK IF THE DEPT IS LESS THAN    12760000
128200* PV-CURR-DEPT (THE CURRENT "HIGH" DEPT) AND GREATER THAN         12770000
128300* PV-PREV-DEPT (THE PREVIOUS DEPT PRINTED).  THAT WILL SELECT     12780000
128400* THE NEXT DEPT TO PRINT.                                         12790000
128500******************************************************************12800000
128600 7500-PRINT-DEPT-TOTALS.                                          12810000
128700     SET PS-DEPT-PRINT-START          TO TRUE.                    12820000
128800                                                                  12830000
128900     MOVE '999'                       TO PV-CURR-DEPT.            12840000
129000     MOVE '   '                       TO PV-PREV-DEPT.            12850000
129100                                                                  12860000
129200     PERFORM UNTIL PS-DEPT-PRINT-END                              12870000
129300         SET PS-NO-DEPT-PRINTED       TO TRUE                     12880000
129400         PERFORM                                                  12890000
129500         VARYING DT-IDX FROM 1 BY 1                               12900000
129600         UNTIL DT-IDX > DT-MAX-DEPTS                              12910000
129700         OR    DT-DEPT-NBR(DT-IDX) = '   '                        12920000
129800                                                                  12930000
129900             IF  DT-DEPT-NBR(DT-IDX) < PV-CURR-DEPT               12940000
130000             AND DT-DEPT-NBR(DT-IDX) > PV-PREV-DEPT               12950000
130100                 MOVE DT-DEPT-NBR (DT-IDX)                        12960000
130200                                      TO PV-CURR-DEPT             12970000
130300                                         RV028-DEPT-NBR           12980067
130400                 MOVE DT-UNIT-COST-DEPT-TOTAL(DT-IDX)             12990000
130500                                  TO RV028-DEPT-UNT-COST-AMT      13000067
130600                                                                  13010000
130700                 MOVE DT-UNIT-EXT-COST-DEPT-TOTAL(DT-IDX)         13020000
130800                                  TO RV028-DEPT-EXT-UNT-COST-AMT  13030067
130900                                                                  13040000
131000                 MOVE DT-RETL-COST-DEPT-TOTAL(DT-IDX)             13050000
131100                                  TO RV028-DEPT-RTL-COST-AMT      13060067
131200                                                                  13070000
131300                 MOVE DT-RETL-EXT-COST-DEPT-TOTAL(DT-IDX)         13080000
131400                                  TO RV028-DEPT-EXT-RTL-COST-AMT  13090067
131500                                                                  13100000
131600                 MOVE DT-QTY-DEPT-TOTAL(DT-IDX)                   13110000
131700                                      TO RV028-DEPT-UNT-QTY       13120067
131800                                                                  13130000
131900                 SET PS-DEPT-PRINTED  TO TRUE                     13140000
132000             END-IF                                               13150000
132100         END-PERFORM                                              13160000
132200                                                                  13170000
132300         IF PS-DEPT-PRINTED                                       13180000
132400**           MOVE SPACE TO RV028-BL-NBR                           13190067
132500**                         RV028-BL-STATUS                        13200067
132600**                         RV028-RETURN-TYPE                      13210067
132700**                         RV028-SCN-DATE                         13220067
132800**                         RV028-LOC-ID                           13230067
132900**                         RV028-DISP                             13240067
133000**                         RV028-PUT-AWAY-DATE                    13250067
133100**                         RV028-RTV-LOC                          13260067
133200**                         RV028-BUYER-NBR                        13270067
133300**                         RV028-BUYER-NAME                       13280067
133400**                                                                13290000
133500**           MOVE 0     TO RV028-SKU                              13300067
133600**                         RV028-SUB-CL-NBR                       13310067
133700**                         RV028-UNT-COST-AMT                     13320067
133800**                         RV028-RTL-AMT                          13330067
133900**                         RV028-UNT-QTY                          13340067
134000**                         RV028-TRNS-NBR-STR                     13350067
134100**                         RV028-TRNS-NBR                         13360067
134200                                                                  13370000
134300                                                                  13380000
134400             PERFORM 6600-WRITE-OUTREC                            13390000
134500                                                                  13400000
134600             MOVE PV-CURR-DEPT        TO PV-PREV-DEPT             13410000
134700             MOVE '999'               TO PV-CURR-DEPT             13420000
134800         ELSE                                                     13430000
134900             SET PS-DEPT-PRINT-END    TO TRUE                     13440000
135000         END-IF                                                   13450000
135100                                                                  13460000
135200     END-PERFORM.                                                 13470000
135300                                                                  13480000
135400     INITIALIZE DT-DEPT-TOTAL-TABLE.                              13490000
135500                                                                  13500000
135600******************************************************************13510000
135700*                                                                 13520000
135800*                                                                 13530000
135900******************************************************************13540000
136000 8000-EOJ-ROUTINE.                                                13550000
136100                                                                  13560000
136200*EOF, SO WRITE LAST BL, DEPT, BUYER & GRAND TOTAL LINES           13570000
136300     PERFORM 8500-WRITE-LAST-RECS.                                13580000
136400                                                                  13590000
136500     DISPLAY '*******************************************'.       13600000
136600     DISPLAY '**       RVKUT030 SUMMARY STATISTICS      *'.       13610089
136700     DISPLAY '*******************************************'.       13620000
136800     DISPLAY 'TOT RECS READ...........:' PA-TOT-RECS-READ.        13630000
136900     DISPLAY 'TOT DTL RECS WRITTEN....:' PA-TOT-DTL-RECS-WRIT.    13640086
137000     DISPLAY 'TOT DEPT RECS WRITTEN...:'                          13650086
137100                                     PA-TOT-DEPT-TOTAL-RECS-WRIT. 13660000
137200     DISPLAY 'TOT BUYER RECS WRITTEN..:'                          13670086
137300                                     PA-TOT-BUYER-TOTAL-RECS-WRIT.13680000
137400     DISPLAY 'TOT GRAND RECS WRITTEN..:'                          13690086
137500                                     PA-TOT-GRAND-TOTAL-RECS-WRIT.13700000
137600     DISPLAY 'TOT RECS WRITTEN........:' PA-TOT-RECS-WRIT.        13710086
137700     DISPLAY '*******************************************'.       13720000
137800                                                                  13730000
137900     CLOSE INPUT-FILE                                             13740000
138000           OUTPUT-FILE.                                           13750000
138100                                                                  13760000
138200******************************************************************13770000
138300*                                                                 13780000
138400******************************************************************13790000
138500 8500-WRITE-LAST-RECS.                                            13800000
138600                                                                  13810000
138700*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                13820000
138800     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        13830000
138900                                                                  13840000
139000*LOAD THE SUMMED DTL VALUES TO THE REPORT DOLLAR FIELDS           13850000
139100     PERFORM 6510-PREP-OUTREC-DTL-DLRS.                           13860000
139200                                                                  13870000
139300*WRITE DETAIL                                                     13880000
139400     PERFORM 6600-WRITE-OUTREC.                                   13890000
139500                                                                  13900000
139600*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                13910000
139700     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        13920000
139800                                                                  13930000
139900*LOAD THE SUMMED DEPT VALUES TO THE REPORT DOLLAR FIELDS          13940000
140000     PERFORM 6530-PREP-OUTREC-DEPT-DLRS.                          13950000
140100                                                                  13960000
140200*LOAD THE "DEPT" REC TYP                                          13970000
140300     MOVE PC-DEPT-TOT-IND  TO RV028-REC-TYP.                      13980067
140400                                                                  13990000
140500*WRITE DEPT TOTAL LINE                                            14000000
140600     PERFORM 7500-PRINT-DEPT-TOTALS.                              14010000
140700                                                                  14020000
140800*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                14030000
140900     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        14040000
141000                                                                  14050000
141100*LOAD THE SUMMED BUYER VALUES TO THE REPORT DOLLAR FIELDS         14060000
141200     PERFORM 6540-PREP-OUTREC-BUYER-DLRS.                         14070000
141300                                                                  14080000
141400*LOAD THE "BUYER" REC TYP                                         14090000
141500     MOVE PC-BUYER-TOT-IND    TO RV028-REC-TYP.                   14100067
141600                                                                  14110000
141700*WRITE DEPT TOTAL LINE                                            14120000
141800     PERFORM 6600-WRITE-OUTREC.                                   14130000
141900                                                                  14140000
142000*ZERO OUT ALL OUTPUT DOLLAR FIELDS                                14150000
142100     PERFORM 6900-ZERO-OUT-ALL-DLR-FIELDS.                        14160000
142200                                                                  14170000
142300*LOAD THE SUMMED GRAND TOTAL VALUES TO THE REPORT DOLLAR FIELDS   14180000
142400     PERFORM 6550-PREP-OUTREC-GRAND-DLRS.                         14190000
142500                                                                  14200000
142600*LOAD THE "GRAND" REC TYP                                         14210000
142700     MOVE PC-GRAND-TOT-IND    TO RV028-REC-TYP.                   14220067
142800                                                                  14230000
142900*WRITE DEPT TOTAL LINE                                            14240000
143000     PERFORM 6600-WRITE-OUTREC.                                   14250000
143100                                                                  14260000
143200*INIT THE OUTREC                                                  14270000
143300     INITIALIZE RV028-INV-SUM-RPT-PREP-REC.                       14280068
143400                                                                  14290000
143500******************************************************************14300000
143600* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *14310000
143700* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *14320000
143800* WILL ABEND THE PROGRAM                                         *14330000
143900******************************************************************14340000
144000 9100-FIELD-OVERFLOW-ERROR.                                       14350000
144100     DISPLAY '** ABEND     **'.                                   14360000
144200     DISPLAY '** PROGRAM   ** = RVKUT030'.                        14370065
144300     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          14380000
144400     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   14390000
144500     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   14400000
144600     DISPLAY '** FOLLOWING FIELD WHICH WAS TOO SMALL: '.          14410000
144700     DISPLAY PV-FIELD-NAME.                                       14420000
144800                                                                  14430000
144900     MOVE +4004 TO ABEND-CODE.                                    14440000
145000     CALL 'ILBOABN0' USING ABEND-CODE.                            14450000
145100                                                                  14460000
145200******************************************************************14470000
145300* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    14480000
145400* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               14490000
145500******************************************************************14500000
145600 9999-SQL-ABEND.                                                  14510000
145700     DISPLAY '** ABEND     **'.                                   14520000
145800     DISPLAY '** PROGRAM   ** = RVKUT030'.                        14530065
145900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              14540000
146000     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     14550000
146100                                                                  14560000
146200******************************************************************14570000
146300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *14580000
146400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *14590000
146500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *14600000
146600* FORMAT.                                                        *14610000
146700******************************************************************14620000
146800     COPY DPPD004.                                                14630000
146900                                                                  14640000
147000     MOVE +4013 TO ABEND-CODE.                                    14650000
147100     CALL 'ILBOABN0' USING ABEND-CODE.                            14660000
147200****************************  END OF RVKUT030 ********************14670065
