000100 IDENTIFICATION DIVISION.                                         00020000
000200 PROGRAM-ID.    SUKCS750.                                         00040060
000300 AUTHOR.        DENNIS STEFFEN.                                   00050060
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000500 DATE-WRITTEN.  WINTER 2003.                                      00070060
000600 DATE-COMPILED.                                                   00080000
000700                                                                  00090000
000800*----------------------------------------------------------------*00100000
000900*    S750 - PRINTER CRITERIA SPECIFICATION                       *00110060
001000*                                                                *00120000
001100*    THIS PROGRAM ALLOWS THE USER ENTER A VALID DESTINATION      *00130000
001200*    PRINTER ID FOR A SPECIFIED REPORT.                          *00140000
001130*                                                                         
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099                 
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                                   
001300*----------------------------------------------------------------*00150000
001400                                                                  00160000
001500 ENVIRONMENT DIVISION.                                            00180000
001600 DATA DIVISION.                                                   00220000
001700 WORKING-STORAGE SECTION.                                         00250000
001800*                                                                 00260000
001900 01  DK-DB2-KEYS.                                                 00270000
002000     05  DK-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.     00280000
002100     05  DK-FCLTY-ID               PIC S9(04)  COMP VALUE +0.     00290000
002200     05  DK-PO-NBR                 PIC S9(09)  COMP VALUE +0.     00300000
002300     05  DK-REC-SEQ-NBR            PIC S9(09)  COMP VALUE +0.     00310000
002400*                                                                 00320000
002500 01  PC-PROGRAM-CONSTANTS.                                        00330000
002600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SU750A  '. 00340061
002700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM750 '. 00350061
002800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS750'. 00360060
002900     05  PC-DPKCS060               PIC  X(08)  VALUE  'DPKCS060'. 00400000
003000     05  PC-INTER-APPL-CODES.                                     00420000
003100         10  PC-FROM-LIST          PIC  X(01)  VALUE '1'.         00460000
003200         10  PC-FROM-CRIT-SPEC     PIC  X(01)  VALUE '2'.         00460000
003300     05  PC-TSYMSG-NUMBERS.                                       00620000
003400         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00630000
003500         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00640000
003600         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00650000
003700         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      00660000
003800         10  PC-TSYMSG-00551       PIC  9(05)  VALUE  00551.      00670000
003900         10  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.      00680000
004000         10  PC-TSYMSG-01178       PIC  9(05)  VALUE  01178.      00690000
004100*                                                                 00700000
004200 01  PV-PROGRAM-VARIABLES.                                        00710000
004300     05  PV-LOCATION.                                             00720000
004400         10  FILLER                PIC  X(01)  VALUE '0'.         00730000
004500         10  PV-DP020-LOCATION     PIC  X(03)  VALUE '000'.       00740000
004600     05  PV-LOCATION-N REDEFINES PV-LOCATION                      00750000
004700                                   PIC  9(04).                    00760000
004800                                                                  00770000
004900     05  PV-CICS-RESP              PIC S9(04)  VALUE +0           00780000
005000                                               COMP SYNC.         00790000
005100     05  PV-SEL-QUEUE-ITEM         PIC S9(04)  VALUE +0           00800000
005200                                               COMP SYNC.         00810000
005300     05  PV-RETRY-COUNT            PIC S9(04)  VALUE ZERO         00820000
005400                                               COMP SYNC.         00830000
005500     05  PV-NUM-ITEMS              PIC S9(04)  VALUE ZERO         00840000
005600                                               COMP SYNC.         00850000
005700     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           00860000
005800                                               COMP SYNC.         00870000
005900     05  PV-SUKCS750-COMMAREA.                                    00880060
006000         07  PV-PCKCS013-COMMAREA.                                00890000
006100           10  PV-PCKCS011-COMMAREA.                              00900000
006200             15  PV-CA-ORD-NBR         PIC  9(08)  VALUE ZEROS.   00910000
006300             15  PV-CA-RCVR-SEQ-NBR    PIC  9(03)  VALUE ZEROS.   00920000
006400             15  PV-CA-ORD-LNE-NBR     PIC  9(04)  VALUE ZEROS.   00930000
006500             15  PV-CA-WORK-ORD-SEQ-NBR                           00940000
006600                                       PIC  9(03)  VALUE ZEROS.   00950000
006700             15  PV-CA-PRINTER-DESTINATION                        00960000
006800                                       PIC  X(08)  VALUE SPACE.   00970000
006900             15  PV-CA-USER-ID         PIC  X(08)  VALUE SPACE.   00980000
007000             15  PV-CA-OPERATING-ID    PIC  X(04)  VALUE SPACE.   00990000
007100             15  PV-CA-FCLTY-ID        PIC  X(04)  VALUE SPACE.   01000000
007200             15  PV-CA-LINES-PER-INCH  PIC  X(03)  VALUE SPACE.   01130000
007300           10  PV-CA-NBR-OF-SELECTED-ITEMS                        01140000
007400                                       PIC S9(09)  COMP-3.        01150000
007500           10  PV-CA-NBR-OF-TS-ITEMS                              01160000
007600                                       PIC S9(05)  COMP-3.        01170000
007700           10  PV-CA-SEL-QUEUE-NAME    PIC  X(08)  VALUE SPACE.   01180000
007800           10  PV-CA-MAX-ITEMS         PIC S9(04)  COMP.          01190000
007900           10  PV-CA-MRKG-APRON-HDR-IND                           01200000
008000                                       PIC  X(01)  VALUE SPACE.   01210000
008100               88  PV-CA-PRINT-MRKG-APRON-HDR      VALUE 'Y'.     01220000
008200         07  PV-CA-STORE-NMBR          PIC  9(04)  VALUE ZERO.    01260000
008300                                                                  01270000
008400*                                                                 01850000
008500 01  PS-PROGRAM-SWITCHES.                                         01860000
008600     05  PS-COMMAREA-SW                PIC X(01) VALUE 'Y'.       01870000
008700         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01880000
008800         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01890000
008900     05  PS-ERROR-SW                   PIC X(01) VALUE 'N'.       01900000
009000         88  PS-ERROR                          VALUE  'Y'.        01910000
009100         88  PS-NO-ERROR                       VALUE  'N'.        01920000
009200     05  PS-END-OF-SEL-ITEMS-QUEUE-SW                             01930000
009300                                       PIC X(01) VALUE 'N'.       01940000
009400         88  PS-END-OF-SEL-ITEMS-QUEUE         VALUE 'Y'.         01950000
009500         88  PS-NOT-END-OF-SEL-ITEMS-QUEUE     VALUE 'N'.         01960000
009600     05  PS-APRON-CHANGE-SW            PIC X(01) VALUE 'N'.       01970000
009700         88  PS-APRON-DESC-SAME                VALUE 'N'.         01980000
009800         88  PS-APRON-DESC-CHANGED             VALUE 'Y'.         01990000
009900     05  PS-UPDATE-SW                  PIC X(01) VALUE 'N'.       02000000
010000         88  PS-NO-UPDATES-DONE                VALUE 'N'.         02010000
010100         88  PS-UPDATES-DONE                   VALUE 'Y'.         02020000
010200/                                                                 02030063
010300*  TEMP STORAGE QUEUES                                            02110063
010400     COPY SUWS010.                                                02140063
010500     COPY SUWS033.                                                02640063
010600/                                                                 02160000
010700     COPY SUKM750.                                                02210061
010800/                                                                 02220061
010900*    COMMAREA TO LINK TO DPKCS060 - PRINT DEST VALIDATION         02240061
011000     COPY DPWS072.                                                02270000
011100                                                                  02280000
011200     COPY DPWS015.                                                02330000
011300                                                                  02340000
011400     COPY DPWS016.                                                02390000
011500/                                                                 02400000
010900*    PARAMETERS FOR CALLING CICS ARCHITECTURE API                 02240061
011600     COPY DPWS030.                                                02500000
011600     COPY DPWS930.                                                02500000
011700/                                                                         
011800*    STANDARD COMMAREA.                                           02530000
011900                                                                  02550000
012000     COPY DPWS020.                                                02560000
012100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02570000
012200                                                                  02580000
012300         10  INTER-APPL-COMM-AREA PIC X(200).                     02630000
012400     COPY SUWS008.                                                02640063
012500     COPY SUWS009.                                                02640063
012600         10  ASC-SPECIFIC-COMMAREA.                               02690000
012700             15  ASC-OPER-UNT-ID             PIC  9(04).          02700000
012800             15  ASC-FCLTY-ID                PIC  9(04).          02710000
012900             15  ASC-CARTON-MANIFEST-SW      PIC  X(01).          07510000
013000             15  ASC-PACKED-DETAIL-SW        PIC  X(01).          07480000
013100*            15  ASC-SHIPT-UNT-ID            PIC  9(18).          02700000
013200             15  ASC-CUR-OPER-UNT-ID         PIC  9(04).          02720000
013300             15  ASC-CUR-FACILITY-ID         PIC  9(04).          02730000
013400             15  ASC-FCLTY-NME               PIC  X(25).          02740000
013500             15  ASC-PRINTER-DESTINATION     PIC  X(08).          02750000
013600             15  ASC-SEL-SUB                 PIC S9(04) COMP.     02850000
013700             15  ASC-SEL-ITEM                PIC S9(04) COMP.     02860000
013800             15  ASC-NBR-OF-ITEMS-READ                            02870000
013900                                             PIC S9(09) COMP-3.   02880000
014000             15  ASC-NBR-OF-SELECTED-ITEMS                        02890000
014100                                             PIC S9(09) COMP-3.   02900000
014200             15  ASC-NBR-OF-TS-ITEMS         PIC S9(05) COMP-3.   02910000
014300             15  ASC-SEL-QUEUE-NAME-IN       PIC X(08).           02920000
014400             15  ASC-SEL-QUEUE-NAME-OUT.                          02930000
014500                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               02940000
014600                 20  ASC-SEL-TASK-NBR-OUT                         02950000
014700                                         PIC S9(05) COMP-3.       02960000
014800                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               02970000
014900             15  ASC-USE-SELECTION-QUEUE-IND PIC X(01).           02980000
015000                 88  ASC-USE-SELECTION-QUEUE VALUE 'Y'.           02990000
015100             15  ASC-ORIGINATION-IND         PIC X(01).           03000000
015200                 88  ASC-CARTON-MANIFEST     VALUE '2'.           03020063
015300             15  ASC-PRINT-CTL-APRON-HEADER  PIC X(01).           03070000
015400                                                                  03080000
015500             15  ASC-PRTR-AUTO-CUTTER-IND    PIC  X(01).          03190000
015600             15  ASC-PRTR-PRTR-BRCDE-IND     PIC  X(01).          03200000
015700             15  ASC-PRTR-PRTR-CNTL-IND      PIC  X(01).          03210000
015800             15  ASC-PRTR-LOC-DESC           PIC  X(30).          03210000
015900             15  ASC-CALLED-PROGRAM         PIC  X(08).           03220000
016000                 88 ASC-CARTON-MANIFEST-PGM                       03230063
016100                                           VALUE 'SUKCS751'.      03240063
016200                 88 ASC-PACKED-DETAIL-PGM                         03230063
016300                                           VALUE 'SUKCS752'.      03240063
016400             15  ASC-KEYS OCCURS 30 TIMES                                 
016500                                      INDEXED BY ASC-IDX.                 
016600                 20  ASC-SHIPT-UNT-ID PIC S9(18) COMP-3.                  
016700/                                                                 03370000
016800 01  PV-DRS-ABEND-LINES.                                                  
016900     05 PV-DRS-ABEND-DISPLAY-LINE1.                                       
017000         10  FILLER                      PIC  X(14)  VALUE                
017100             'DRRB ID = DRRB'.                                            
017200         10  FILLER                      PIC  X(02)  VALUE SPACE.         
017300         10  FILLER                      PIC  X(12)  VALUE                
017400             'DRRB FUNC = '.                                              
017500         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE.         
017600         10  FILLER                      PIC  X(02)  VALUE SPACE.         
017700         10  FILLER                      PIC  X(11)  VALUE                
017800             'DRRB RID = '.                                               
017900         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE.         
018000         10  FILLER                      PIC  X(02)  VALUE SPACE.         
018100         10  FILLER                      PIC  X(15)  VALUE                
018200             'DRRB OPTIONS = '.                                           
018300         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE.         
018400     05  PV-DRS-ABEND-DISPLAY-LINE2.                                      
018500         10  FILLER                      PIC  X(10)  VALUE                
018600             'DRRB RC = '.                                                
018700         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE.         
018800         10  FILLER                      PIC  X(02)  VALUE SPACE.         
018900         10  FILLER                      PIC  X(18)  VALUE                
019000             'DRRB ATTR-ERROR = '.                                        
019100         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE.         
019200         10  FILLER                      PIC  X(02)  VALUE SPACE.         
019300         10  FILLER                      PIC  X(12)  VALUE                
019400             'DRRB DRDC = '.                                              
019500         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE.         
019600         10  FILLER                      PIC  X(02)  VALUE SPACE.         
019700         10  FILLER                      PIC  X(13)  VALUE                
019800             'DRRB LINES = '.                                             
019900         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE.         
020000*                                                                 03380000
020100*  SQL AND COBOL DECLARATIONS FOR THE LOCATION TABLE (XLT_LOC)    03390000
020300                                                                  03410000
020400     EXEC SQL                                                     03420000
020500         INCLUDE XLT00010                                         03430000
020600     END-EXEC.                                                    03440000
020200*                                                                 03400000
020700                                                                  03530000
020800*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03630000
020900     EXEC SQL                                                     03650000
021000         INCLUDE SQLCA                                            03660000
021100     END-EXEC.                                                    03670000
021200                                                                  03680000
021300*    ABEND PROCESSING COPYBOOK.                                  *03700000
021400     COPY DPWS013.                                                03730000
021500                                                                  03740000
021600                                                                  03750000
021700/                                                                 03760062
021800 LINKAGE SECTION.                                                 03770000
021900                                                                  03780000
022000 01  DFHCOMMAREA.                                                 03790000
022100     05  FILLER                         OCCURS  1 TO 4072 TIMES   03800000
022200                                        DEPENDING ON EIBCALEN.    03810000
022300         10  FILLER                     PIC X.                    03820000
022400                                                                  03830000
022500/                                                                 03840062
022600 PROCEDURE DIVISION.                                              03850000
022700 0000-MAIN-MODULE.                                                03940000
022800     INITIALIZE DP030-CICS-API-FIELDS.                            03950000
022900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03960000
023000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03970000
023100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03980000
023200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03990000
023300     MOVE LENGTH OF SU750AI        TO DP030-MAP-LENGTH (1).       04000000
023400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04010000
023500     PERFORM 0001-CALL-CICS-ARCH-API.                             04020000
023600*                                                                 04030000
023700     PERFORM 1000-CONTROL-PROCESSING                              04040000
023800*                                                                 04050000
023900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04060000
024000     PERFORM 0001-CALL-CICS-ARCH-API.                             04070000
024100                                                                  04080000
024200 0001-CALL-CICS-ARCH-API.                                         04090000
024300*    CALL 'DPKCS030' USING DFHEIBLK                               04100000
024300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04100000
024400                           DFHCOMMAREA                            04110000
024500                           DP030-CICS-API-FIELDS                  04120000
024600                           DP020-STANDARD-COMMAREA                04130000
024700                           SU750AI.                               04140000
024800*                                                                 04150000
024900     IF  DP030-RC-CALL-SUCCESSFUL                                 04160000
025000         CONTINUE                                                 04170000
025100     ELSE                                                         04180000
025200         SET DP013-NO-ROLLBACK                                    04190000
025300             DP013-XCTL-DISPLAY-RESTART                           04200000
025400             DP013-CICS-ABEND      TO TRUE                        04210000
025500         MOVE 'BEFORE 0000-MAIN-MODULE'                           04220000
025600                                   TO DP013-PARAGRAPH             04230000
025700*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04240000
025800*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04250000
025700         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04240000
025800-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04250000
025900         MOVE DP030-RETURN-CODE                                   04260000
026000                                   TO DP013-MESSAGE-TEXT (3)      04270000
026100         PERFORM DP013-0000-PROCESS-ABEND                         04280000
026200     END-IF.                                                      04290000
026300 EJECT                                                            04300000
026400*----------------------------------------------------------------*04310000
026500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04320000
026600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04330000
026700*----------------------------------------------------------------*04340000
026800                                                                  04350000
026900 1000-CONTROL-PROCESSING.                                         04360000
027000                                                                  04370000
027100     EVALUATE TRUE                                                04380000
027200         WHEN DP020-NEXT-ACT-INITIAL                              04390000
027300             INITIALIZE ASC-SPECIFIC-COMMAREA                     04400000
027400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04410000
027500             IF  PS-COMMAREA-NOT-VALID                            04420000
027600                 CONTINUE                                         04430000
027700             ELSE                                                 04440000
027800                 PERFORM 4000-BUILD-INITIAL-PANEL                 04450000
027900                 PERFORM 3200-RESET-ATTRIBUTES                    04460000
028000             END-IF                                               04470000
028100                                                                  04480000
028200         WHEN DP020-NEXT-ACT-READ-MAP                             04490000
028300             PERFORM 2000-FKEY-PROCESSING                         04500000
028400                                                                  04510000
028500         WHEN DP020-NEXT-ACT-RETURN                               04520000
028600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04530000
028700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04540000
028800                                                                  04550000
028900         WHEN OTHER                                               04560000
029000             SET DP013-LOGIC-ABEND                                04570000
029100                 DP013-NO-ROLLBACK TO TRUE                        04580000
029200             MOVE '1000-CONTROL-PROCESSING'                       04590000
029300                                   TO  DP013-PARAGRAPH            04600000
029400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04610000
029500                                   TO  DP013-MESSAGE-TEXT(1)      04620000
029600             MOVE DP020-NEXT-APPL-ACTIVITY                        04630000
029700                                   TO DP013-MESSAGE-TEXT(2)       04640000
029800             PERFORM DP013-0000-PROCESS-ABEND                     04650000
029900     END-EVALUATE.                                                04660000
030000/                                                                 04670000
030100 1100-PROCESS-INTER-APPL-COMM.                                    04710000
030200                                                                  04720000
030300     MOVE DP020-INT-APPL-FORMAT-IND   TO ASC-ORIGINATION-IND.     04740000
030400                                                                          
030500     EVALUATE TRUE                                                        
030600         WHEN ASC-ORIGINATION-IND = PC-FROM-LIST                          
030700             PERFORM 1120-PROC-INTER-APPL-COMM-LIST               04980000
030800         WHEN ASC-ORIGINATION-IND = PC-FROM-CRIT-SPEC                     
030900             PERFORM 1110-PROC-INTER-APPL-COMM-SPEC               04790000
031000     END-EVALUATE.                                                        
031100/                                                                 05190000
031200*----------------------------------------------------------------*05200000
031300* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA FROM THE      *05210000
031400* CRITERIA SPEC PROGRAM                                          *05220000
031500*----------------------------------------------------------------*05230000
031600 1110-PROC-INTER-APPL-COMM-SPEC.                                  05240000
031700                                                                          
031800*    THIS IS USED WHENEVER 1 AND ONLY 1 SML IS SPECIFIED                  
031900                                                                          
032000     MOVE SU008-OPER-UNT-ID        TO ASC-OPER-UNT-ID.            05260000
032100     MOVE 1                           TO ASC-FCLTY-ID             05260000
032200                                        ASC-NBR-OF-SELECTED-ITEMS.05761063
032300     MOVE SU008-SML-NBR            TO ASC-SHIPT-UNT-ID(1).        06250000
032400/                                                                 05390000
032500 1120-PROC-INTER-APPL-COMM-LIST.                                  05700000
032600                                                                  05710000
032700*    THIS IS USED WHENEVER MULTIPLE SMLS ARE SPECIFIED                    
032800                                                                  04750000
032900*    EVALUATE TRUE                                                        
033000*        WHEN ASC-ORIGINATION-IND = PC-CART-MANIFEST-REQUEST              
033100*            SET ASC-CARTON-MANIFEST-PGM TO TRUE                  04950063
033200*    END-EVALUATE.                                                        
033300                                                                          
033400     MOVE SU009-OPER-UNT-ID           TO ASC-OPER-UNT-ID.         05720063
033500     MOVE 1                           TO ASC-FCLTY-ID             05720063
033600     MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                       05760063
033700                                ASC-NBR-OF-SELECTED-ITEMS.        05761063
033800     MOVE SU009-NUMBER-OF-TS-ITEMS    TO ASC-NBR-OF-TS-ITEMS.     05770063
033900     MOVE SU009-SEL-QUEUE-NAME        TO ASC-SEL-QUEUE-NAME-IN.   05780063
034000     MOVE SU010-MAX-ITEMS             TO ASC-SEL-SUB.             05790063
034100     MOVE ZERO                        TO ASC-SEL-ITEM.            05800000
034200     PERFORM 1130-GET-NEXT-RECORD.                                05810000
034300/                                                                 05820000
034400 1130-GET-NEXT-RECORD.                                            05890000
034500                                                                  05900000
034600     ADD +1                        TO ASC-SEL-SUB.                05910000
034700     IF ASC-SEL-SUB > SU010-MAX-ITEMS                             05920000
034800         ADD +1                    TO ASC-SEL-ITEM                05930000
034900         MOVE +1                   TO ASC-SEL-SUB                 05940000
035000     END-IF.                                                      05950000
035100     IF ASC-SEL-ITEM NOT > ASC-NBR-OF-TS-ITEMS                    05960000
035200         PERFORM 9100-READ-SEL-QUEUE                              05970000
035300         IF SU010-ITEM (ASC-SEL-SUB) > ZERO                       05980000
035500             PERFORM VARYING SU010-IDX FROM 1 BY 1                        
035600                 UNTIL SU010-IDX > 20                                     
035700                 SET SU010-INQ (SU010-IDX)                                
035800                                      TO TRUE                             
035900                 SET ASC-IDX          TO SU010-IDX                        
036000                 MOVE SU010-SML(SU010-IDX)                                
036100                                      TO ASC-SHIPT-UNT-ID                 
036200                                         (ASC-IDX)                        
036300             END-PERFORM                                                  
036310             PERFORM 9200-REWRITE-SEL-QUEUE                       06000000
036400         ELSE                                                     06010000
036500             SUBTRACT +1 FROM ASC-SEL-SUB                         06020000
036600*            --- BOTTOM OF LIST ---                               06030000
036700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06040000
036800             SET DP020-MSG-INFORMATIONAL                          06050000
036900                                   TO TRUE                        06060000
037000         END-IF                                                   06070000
037100     ELSE                                                         06080000
037200         SUBTRACT +1 FROM ASC-SEL-ITEM                            06090000
037300         MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB                 06100000
037400     END-IF.                                                      06140000
037500/                                                                 06150000
037600 1140-PROC-INTER-APPL-COMM-SPEC.                                  06200000
037700                                                                  06210000
037800     MOVE SU033-OPER-UNT-ID        TO ASC-OPER-UNT-ID.            06220000
037900*    MOVE SU033-FCLTY-ID           TO ASC-FCLTY-ID                06220000
038000*    MOVE SU033-SHIPT-UNT-ID       TO ASC-SHIPT-UNT-ID.           06250000
038100/                                                                 06290000
038200*----------------------------------------------------------------*06640000
038300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06650000
038400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06660000
038500* EDITS.                                                         *06670000
038600*----------------------------------------------------------------*06680000
038700                                                                  06690000
038800 2000-FKEY-PROCESSING.                                            06700000
038900                                                                  06710000
039000     EVALUATE TRUE                                                06720000
039100                                                                  06730000
039200         WHEN DP020-SRC-AID = DP016-CLEAR                         06740000
039300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06750000
039400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06760000
039500                                                                  06770000
039600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06780000
039700             PERFORM 4000-BUILD-INITIAL-PANEL                     06790000
039800             PERFORM 3200-RESET-ATTRIBUTES                        06800000
039900                                                                  06810000
040000         WHEN OTHER                                               06820000
040100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06830000
040200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06840000
040300             IF  PS-NO-ERROR                                      06850000
040400                 SET DP030-CONTINUE-GO TO TRUE                    06860000
040500                 PERFORM 2100-CHECK-FUNCTION-KEY                  06870000
040600             ELSE                                                 06880000
040700                 SET DP030-OVERRIDE-GO TO TRUE                    06890000
040800             END-IF                                               06900000
040900     END-EVALUATE.                                                06910000
041000/                                                                         
041100******************************************************************06930000
041200** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06940000
041300** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06950000
041400** FROM THE CICS ARCHITECTURE API.                              **06960000
041500******************************************************************06970000
041600 2100-CHECK-FUNCTION-KEY.                                         06980000
041700     SET PS-NO-UPDATES-DONE           TO TRUE.                    06990000
041800     EVALUATE TRUE                                                07000000
041900         WHEN DP020-FK-LOCAL-RETURN(DP020-SRC-AID)                07010000
042000             IF  ASC-USE-SELECTION-QUEUE                          07020000
042100                 PERFORM 2400-PROCESS-SEL-ITEMS-QUEUE             07030000
042200                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         07040000
042300                 SET DP020-MSG-INFORMATIONAL TO TRUE              07050000
042400             ELSE                                                 07060000
042500                 PERFORM 2300-PREPARE-INTER-APPL-COMM             07070000
042600                 PERFORM 7000-START-TRANID-S751                   07200061
042700                                                                  07220000
042800                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         07230000
042900                 SET DP020-MSG-INFORMATIONAL TO TRUE              07240000
043000             END-IF                                               07250000
043100                                                                  07260000
043200         WHEN DP020-SRC-AID = DP016-ENTER                         07270000
043300             CONTINUE                                             07280000
043400                                                                  07290000
043500         WHEN OTHER                                               07300000
043600             SET DP013-NO-ROLLBACK                                07310000
043700                 DP013-XCTL-DISPLAY-RESTART                       07320000
043800                 DP013-CICS-ABEND  TO TRUE                        07330000
043900             MOVE '2100-CHECK-FUNCTION-KEY'                       07340000
044000                                   TO DP013-PARAGRAPH             07350000
044100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07360000
044200                                   TO DP013-MESSAGE-TEXT (1)      07370000
044300             PERFORM DP013-0000-PROCESS-ABEND                     07380000
044400     END-EVALUATE.                                                07390000
044500*----------------------------------------------------------------*07400000
044600* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*07410000
044700* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *07420000
044800* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *07430000
044900*----------------------------------------------------------------*07440000
045000 2200-MOVE-SCREEN-TO-COMMAREA.                                    07450000
045100*                                                                 07460000
045200     IF  APRDSTL > ZERO                                           07470000
045300         MOVE APRDSTI              TO ASC-PRINTER-DESTINATION     07480000
045400     ELSE                                                         07490000
045500         IF  APRDSTF = DP015-ERASE-EOF                            07500000
045600             MOVE SPACE            TO ASC-PRINTER-DESTINATION     07510000
045700         END-IF                                                   07520000
045800     END-IF.                                                      07530000
045900                                                                  07850000
046000     IF  ACTMFSTL > ZERO                                          07470000
046100         MOVE ACTMFSTI             TO ASC-CARTON-MANIFEST-SW      07480000
046200     ELSE                                                         07490000
046300         IF  ACTMFSTF = DP015-ERASE-EOF                           07500000
046400             MOVE SPACE            TO ASC-CARTON-MANIFEST-SW      07510000
046500         END-IF                                                   07520000
046600     END-IF.                                                      07530000
046700                                                                  07850000
046800*    IF  ACTDTLL > ZERO                                           07470000
046900*        MOVE ACTDTLI             TO ASC-PACKED-DETAIL-SW         07480000
047000*    ELSE                                                         07490000
047100*        IF  ACTDTLF = DP015-ERASE-EOF                            07500000
047200*            MOVE SPACE            TO ASC-PACKED-DETAIL-SW        07510000
047300*        END-IF                                                   07520000
047400*    END-IF.                                                      07530000
047500                                                                  07850000
047600******************************************************************07860000
047700** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07870000
047800** INTER-APPLICATION COMMAREA.                                  **07880000
047900******************************************************************07890000
048000 2300-PREPARE-INTER-APPL-COMM.                                    07900000
048100*    EVALUATE DP020-INT-APPL-FORMAT-IND                           07910000
048200*        WHEN PC-CART-MANIFEST-REQUEST                            07920000
048300             MOVE ASC-PRINTER-DESTINATION                         08030000
048400                                      TO SU033-PRINTER-ID         08040000
048500             MOVE DP020-USERID        TO SU033-USER-ID            08050000
048600             MOVE ASC-OPER-UNT-ID     TO SU033-OPER-UNT-ID        08070000
048700             MOVE ASC-FCLTY-ID        TO SU033-FCLTY-ID           08070000
048800             MOVE ASC-PRTR-AUTO-CUTTER-IND                        10190000
048900                                      TO                                  
049000                                 SU033-PRTR-AUTO-CUTTER-IND               
049100             MOVE ASC-PRTR-PRTR-BRCDE-IND                         10210000
049200                                      TO                                  
049300                                 SU033-PRTR-PRTR-BRCDE-IND                
049400             MOVE ASC-PRTR-PRTR-CNTL-IND                          10230000
049500                                      TO                                  
049600                                 SU033-PRTR-PRTR-CNTL-IND                 
049700             MOVE ASC-CARTON-MANIFEST-SW                          07510000
049800                                      TO SU033-CRTN-MFST-IND              
049900             MOVE ASC-PACKED-DETAIL-SW                            07480000
050000                                      TO SU033-PCKD-DETL-IND              
050100                                                                          
050200             INITIALIZE SU033-SELECTED-ITEM-ARRAY                         
050300             PERFORM VARYING ASC-IDX FROM 1 BY 1                          
050400                 UNTIL ASC-IDX > 20                                       
050500                 SET SU033-IDX        TO ASC-IDX                          
050600                 MOVE ASC-SHIPT-UNT-ID (ASC-IDX)                          
050700                                      TO SU033-SHIPT-UNT-ID               
050800                                         (SU033-IDX)                      
050900             END-PERFORM.                                                 
051000*    END-EVALUATE.                                                08370000
051100/                                                                 08380000
051200******************************************************************08400000
051300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **08410000
051400** INTER-APPLICATION COMMAREA.                                  **08420000
051500******************************************************************08430000
051600 2400-PROCESS-SEL-ITEMS-QUEUE.                                    08440000
051700*    EVALUATE DP020-INT-APPL-FORMAT-IND                           08450000
051800*        WHEN PC-CART-MANIFEST-REQUEST                            08460000
051900             INITIALIZE SU033-COMM-AREA                           08500000
052000             MOVE ASC-PRINTER-DESTINATION                         08510000
052100                                      TO PV-CA-PRINTER-DESTINATION08520000
052200             MOVE DP020-USERID        TO SU033-USER-ID            08530000
052300             MOVE ASC-OPER-UNT-ID     TO SU033-OPER-UNT-ID        08550000
052400             MOVE ASC-FCLTY-ID        TO SU033-FCLTY-ID           08550000
052500                                                                  08660000
052600             IF ASC-CARTON-MANIFEST-SW = SPACE                    07510000
052700                 SET SU033-CRTN-MFST-RPT-NO                               
052800                                      TO TRUE                             
052900             ELSE                                                         
053000                 SET SU033-CRTN-MFST-RPT                                  
053100                                      TO TRUE                             
053200             END-IF                                                       
053300                                                                          
053400             IF ASC-PACKED-DETAIL-SW = SPACE                      07480000
053500                 SET SU033-PCKD-DETL-RPT-NO                               
053600                                      TO TRUE                             
053700             ELSE                                                         
053800                 SET SU033-PCKD-DETL-RPT                                  
053900                                      TO TRUE                             
054000             END-IF                                                       
054100                                                                          
054200             MOVE LENGTH OF SU033-COMM-AREA                       08780000
054300                                      TO PV-COMMAREA-LENGTH       08790000
054400                                                                  08800000
054500             MOVE +1                  TO ASC-SEL-ITEM             08810000
054600             MOVE ASC-NBR-OF-SELECTED-ITEMS                       08820000
054700                            TO PV-CA-NBR-OF-SELECTED-ITEMS        08830000
054800             MOVE ASC-NBR-OF-TS-ITEMS                             08840000
054900                            TO PV-CA-NBR-OF-TS-ITEMS              08850000
055000             MOVE ZERO                TO ASC-SEL-SUB              08860000
055100             SET PS-NOT-END-OF-SEL-ITEMS-QUEUE                    08870000
055200                                       TO TRUE                    08880000
055300             PERFORM 9100-READ-SEL-QUEUE                          08890000
055400                                                                  09070000
055500             PERFORM 7000-START-TRANID-S751.                      09120000
055600*    END-EVALUATE.                                                09150000
055700/                                                                 09590000
055800 3000-EDIT-DATA-IN-COMMAREA.                                      09670000
055900     PERFORM 3200-RESET-ATTRIBUTES.                               09680000
056000*                                                                 09690000
056100     EVALUATE TRUE                                                        
046100     WHEN ASC-CARTON-MANIFEST-SW = 'S'                            07480000
056300         SET ASC-CARTON-MANIFEST-PGM  TO TRUE                     03230063
056400*    WHEN ACTDTLI = 'S'                                                   
056500*        SET ASC-PACKED-DETAIL-PGM    TO TRUE                     03230063
056600     WHEN OTHER                                                           
056700         SET PS-ERROR                                             09720000
056800             DP020-MSG-FATAL                                      09730000
056900             DP030-SET-CURSOR-APPL-1                              09800000
057000                                      TO TRUE                     09810000
057100             MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER         09740000
057200             MOVE DP015-UNP-ALP-BRT-MDT                           09750000
057300                                      TO ACTMFSTA                 09760000
057400*                                        ACTDTLA                  09760000
057500             MOVE DP015-RED           TO ACTMFSTC                 09770000
057600*                                        ACTDTLC                  09770000
057700             MOVE DP015-REVERSE       TO ACTMFSTH                 09780000
057800*                                        ACTDTLH                  09780000
057900             MOVE -1                  TO ACTMFSTL                 09790000
058000     END-EVALUATE                                                         
058100                                                                          
058200     EVALUATE TRUE                                                09700000
058300         WHEN ASC-PRINTER-DESTINATION = SPACES                    09710000
058400             SET PS-ERROR                                         09720000
058500                 DP020-MSG-FATAL  TO TRUE                         09730000
058600             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             09740000
058700             MOVE DP015-UNP-ALP-BRT-MDT                           09750000
058800                                  TO APRDSTA                      09760000
058900             MOVE DP015-RED       TO APRDSTC                      09770000
059000             MOVE DP015-REVERSE   TO APRDSTH                      09780000
059100             MOVE -1              TO APRDSTL                      09790000
059200             SET DP030-SET-CURSOR-APPL-1                          09800000
059300                                  TO TRUE                         09810000
059400         WHEN ASC-PRINTER-DESTINATION > SPACES                    09820000
059500*            VALIDATE USING DPKCS060                              09830000
059600             MOVE ASC-PRINTER-DESTINATION                         09840000
059700                                     TO DP072-PRINTER-ID          09850000
059800             MOVE ASC-CALLED-PROGRAM TO DP072-RPT-PGM-NME         09860000
059900             MOVE '01'               TO DP072-RPT-PGM-TYP-ID      09870000
060000             MOVE ASC-OPER-UNT-ID    TO DP072-ORIGIN-OPER-UNT-ID  09880000
060100             MOVE ASC-CUR-OPER-UNT-ID                             09890000
060200                                     TO DP072-OPER-UNT-ID         09900000
060300             MOVE ASC-FCLTY-ID       TO DP072-ORIGIN-FCLTY-ID     09910000
060400             MOVE ASC-CUR-FACILITY-ID                             09920000
060500                                     TO DP072-FCLTY-ID            09930000
060600             SET DP072-VALIDATE     TO TRUE                       09940000
060700                                                                  09950000
060800             EXEC CICS                                            09960000
060900                 LINK PROGRAM  (PC-DPKCS060)                      09970000
061000                      COMMAREA (DP072-COMM-AREA)                  09980000
061100                      RESP     (PV-CICS-RESP)                     09990000
061200             END-EXEC                                             10000000
061300                                                                  10010000
061400             EVALUATE TRUE                                        10020000
061500                 WHEN PV-CICS-RESP = DFHRESP (NORMAL)             10030000
061600                     CONTINUE                                     10040000
061700                 WHEN OTHER                                       10050000
061800                       MOVE '3000-EDIT-DATA-IN-COMMAREA'          10060000
061900                                            TO DP013-PARAGRAPH    10070000
062000                       MOVE PV-CICS-RESP                          10080000
062100                            TO DP013-MESSAGE-TEXT(1)              10090000
062200                       MOVE SQLCA           TO DP013-SQLCA        10100000
062300                       SET DP013-LINK-RETURN                      10110000
062400                           DP013-CICS-ABEND                       10120000
062500                           DP013-NO-ROLLBACK TO TRUE              10130000
062600                       PERFORM DP013-0000-PROCESS-ABEND           10140000
062700             END-EVALUATE                                         10150000
062800                                                                  10160000
062900             IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'               10170000
063000                 MOVE DP072-PRTR-AUTO-CUTTER-IND                  10180000
063100                     TO ASC-PRTR-AUTO-CUTTER-IND                  10190000
063200                 MOVE DP072-PRTR-PRTR-BRCDE-IND                   10200000
063300                     TO ASC-PRTR-PRTR-BRCDE-IND                   10210000
063400                 MOVE DP072-PRTR-PRTR-CNTL-IND                    10220000
063500                     TO ASC-PRTR-PRTR-CNTL-IND                    10230000
063600                 MOVE DP072-PRTR-LOC-DESC                                 
063700                     TO ASC-PRTR-LOC-DESC                         03210000
063800             ELSE                                                 10240000
063900                 SET PS-ERROR                                     10250000
064000                     DP020-MSG-FATAL                              10260000
064100                                  TO TRUE                         10270000
064200                 MOVE PC-TSYMSG-00746                             10280000
064300                                  TO DP020-MSG-NUMBER             10290000
064400                 MOVE DP015-UNP-ALP-BRT-MDT                       10300000
064500                                  TO APRDSTA                      10310000
064600                 MOVE DP015-RED   TO APRDSTC                      10320000
064700                 MOVE DP015-REVERSE                               10330000
064800                                  TO APRDSTH                      10340000
064900                 MOVE -1          TO APRDSTL                      10350000
065000                 SET DP030-SET-CURSOR-APPL-1                      10360000
065100                                  TO TRUE                         10370000
065200             END-IF                                               10380000
065300     END-EVALUATE.                                                10390000
065400*                                                                 10400000
065500     IF  PS-NO-ERROR                                              10410000
065600         MOVE -1                   TO APRDSTL                     10420000
065700         SET DP030-SET-CURSOR-APPL-1                              10430000
065800                                   TO TRUE                        10440000
065900     END-IF.                                                      10450000
066000/                                                                 10460000
066100******************************************************************10470000
066200** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **10480000
066300** MAP.                                                         **10490000
066400******************************************************************10500000
066500 3200-RESET-ATTRIBUTES.                                           10510000
066600     MOVE DP015-UNP-ALP-NOR-OFF       TO APRDSTA.                 10520000
066700     MOVE DP015-GREEN                 TO APRDSTC.                 10530000
066800     MOVE DP015-UNDERLINE             TO APRDSTH.                 10540000
066900                                                                          
067000*----------------------------------------------------------------*11000000
067100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *11010000
067200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *11020000
067300*  IT HERE.                                                      *11030000
067400*----------------------------------------------------------------*11040000
067500 4000-BUILD-INITIAL-PANEL.                                        11050000
067600     SET DP030-SET-CURSOR-APPL-1      TO TRUE                     11060000
067700     MOVE -1                          TO APRDSTL.                 11070000
067800     MOVE ASC-OPER-UNT-ID             TO AOPRIDO                  11080000
067900                                         DK-OPER-UNT-ID.          11090000
068000     MOVE ASC-FCLTY-ID                TO AFACIDO                  11100000
068100                                         DK-FCLTY-ID.             11110000
068200     MOVE DP020-LOCATION-NBR          TO ASC-CUR-OPER-UNT-ID.     11130000
068400     MOVE 1                           TO ASC-CUR-FACILITY-ID.     11140000
068500     PERFORM 4010-GET-FCLTY-NAME.                                 11150000
068600                                                                  11160000
068700     MOVE ASC-FCLTY-NME               TO AFDESCO.                 11170000
068800                                                                  11180000
068900     MOVE ASC-NBR-OF-SELECTED-ITEMS   TO ACTNCTO                          
069000     MOVE DP015-PRO-DRK-OFF           TO APRDSTA                  11330000
069100     MOVE DP015-HL-OFF                TO APRDSTH.                 11390000
069200/                                                                 11420000
069300*----------------------------------------------------------------*11430000
069400*    GET THE FACILITY NAME                                       *11440000
069500*----------------------------------------------------------------*11450000
069600 4010-GET-FCLTY-NAME.                                             11460000
069700                                                                  11470000
069800     EXEC SQL                                                     11560062
069900         SELECT LOC_NM                                                    
070000         INTO :XLT00010-LOC-NM                                    11580062
070100         FROM XLT_LOC                                             11590062
070200         WHERE LOC_NBR     = :DK-OPER-UNT-ID                      11600062
070400     END-EXEC                                                     11620062
070500                                                                  11630000
070600     EVALUATE TRUE                                                11640062
070700         WHEN SQLCODE = ZERO                                      11650062
070800             MOVE XLT00010-LOC-NM     TO ASC-FCLTY-NME            11670062
071000         WHEN SQLCODE = +100                                      11690062
071100             MOVE SPACES              TO ASC-FCLTY-NME            11700062
071300         WHEN SQLCODE = -904                                      11720062
071400         WHEN SQLCODE = -913                                      11730062
071500         WHEN SQLCODE = -911                                      11731062
071600             MOVE '4010-GET-FCLTY-NAME' TO DP013-PARAGRAPH        11732062
071800             MOVE 'DB2 LOCKOUT ON SELECT LOCATION TABLE'          11734062
071900                                      TO DP013-MESSAGE-TEXT (1)   11735062
072000             MOVE SQLCA               TO DP013-SQLCA              11736062
072100             MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1) 11737062
072200             SET DP013-DB2-ABEND                                  11738062
072300                 DP013-XCTL-DISPLAY-RESTART                       11739062
072400                                      TO TRUE                     11739162
072500             PERFORM DP013-0000-PROCESS-ABEND                     11739262
072600                                                                  11750000
072700         WHEN SQLWARN0 NOT = SPACES                               11760062
072800         WHEN SQLCODE < ZERO                                      11770062
072900         WHEN SQLCODE > ZERO                                      11780062
073000             MOVE '4010-GET-FCLTY-NAME'                           11790062
073100                                      TO DP013-PARAGRAPH          11800062
073200             MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'         11810062
073300                                      TO DP013-MESSAGE-TEXT (1)   11820062
073400             MOVE SQLCA               TO DP013-SQLCA              11830062
073500             MOVE 'XLT_LOC '          TO DP013-DB2-TABLE-NAME (1) 11840062
073600             SET DP013-DB2-ABEND                                  11850062
073700                 DP013-XCTL-DISPLAY-RESTART                       11860062
073800                                      TO TRUE                     11870062
073900             PERFORM DP013-0000-PROCESS-ABEND                     11880062
074000     END-EVALUATE.                                                11890062
074100/                                                                 12040000
074200*----------------------------------------------------------------*12540000
074300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12550000
074400*----------------------------------------------------------------*12560000
074500 4400-MOVE-COMMAREA-TO-SCREEN.                                    12570000
074600     MOVE ASC-OPER-UNT-ID          TO AOPRIDO.                    12580000
074700     MOVE ASC-FCLTY-NME            TO AFDESCO.                    12590000
074800     MOVE ASC-FCLTY-ID             TO AFACIDO.                    12600000
074900     MOVE ASC-PRINTER-DESTINATION  TO APRDSTO.                    12610000
075000     MOVE ASC-PRTR-LOC-DESC           TO APRLOCO.                 03210000
075100*                                                                 12620000
075200*----------------------------------------------------------------*12630000
075300*    START TRANID FOR SUKCS751 CARTON MANIFEST REPORT             12640000
075400*----------------------------------------------------------------*12650000
075500 7000-START-TRANID-S751.                                          12660000
075600                                                                  12760000
075700     MOVE LENGTH OF SU033-COMM-AREA   TO PV-COMMAREA-LENGTH       00860000
075800                                                                          
075900     EXEC CICS                                                    12900061
076000         START TRANSID ('S751')                                   12910061
076100         FROM     (SU033-COMM-AREA)                               12920061
076200         LENGTH   (PV-COMMAREA-LENGTH)                                    
076300     END-EXEC.                                                    12930061
076400/                                                                 12950000
076500 9000-WRITE-SEL-QUEUE.                                            16610000
076600                                                                  16620000
076700     MOVE ASC-SEL-QUEUE-NAME-IN    TO ASC-SEL-QUEUE-NAME-OUT.     16630000
076800     MOVE DP020-SRC-TASK-NUMBER                                   16640000
076900                                   TO ASC-SEL-TASK-NBR-OUT        16650000
077000     MOVE 9                        TO ASC-SEL-SEQ-OUT.            16660000
077100     ADD  +1                       TO PV-SEL-QUEUE-ITEM.          16670000
077200                                                                  16680000
077300     EXEC CICS                                                    16690000
077400          WRITEQ TS                                               16700000
077500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      16710000
077600              FROM  (SU010-SELECT-RECORD)                         16720000
077700              ITEM  (PV-SEL-QUEUE-ITEM)                           16730000
077800              RESP  (PV-CICS-RESP)                                16740000
077900     END-EXEC.                                                    16750000
078000                                                                  16760000
078100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          16770000
078200         CONTINUE                                                 16780000
078300     ELSE                                                         16790000
078400         SET DP013-LOGIC-ABEND                                    16800000
078500             DP013-NO-ROLLBACK     TO TRUE                        16810000
078600         MOVE '9000-WRITE-SEL-QUEUE'                              16820000
078700                                   TO DP013-PARAGRAPH             16830000
078800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          16840000
078900                                   TO DP013-MESSAGE-TEXT(1)       16850000
079000         PERFORM DP013-0000-PROCESS-ABEND                         16860000
079100     END-IF.                                                      16870000
079200******************************************************************16880000
079300* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *16890000
079400******************************************************************16900000
079500 9100-READ-SEL-QUEUE.                                             16910000
079600     EXEC CICS                                                    16920000
079700         READQ TS                                                 16930000
079800             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        16940000
079900             INTO  (SU010-SELECT-RECORD)                          16950000
080000             ITEM  (ASC-SEL-ITEM)                                 16960000
080100             NUMITEMS(PV-NUM-ITEMS)                               16970000
080200             RESP  (PV-CICS-RESP)                                 16980000
080300     END-EXEC.                                                    16990000
080400                                                                  17000000
080500     EVALUATE TRUE                                                17010000
080600     WHEN PV-CICS-RESP EQUAL DFHRESP(NORMAL)                      17020000
080700         CONTINUE                                                 17030000
080800     WHEN PV-CICS-RESP EQUAL DFHRESP(ITEMERR)                     17040000
080900         SET PS-END-OF-SEL-ITEMS-QUEUE TO TRUE                    17050000
081000     WHEN OTHER                                                   17060000
081100         SET DP013-LOGIC-ABEND                                    17070000
081200             DP013-NO-ROLLBACK     TO TRUE                        17080000
081300         MOVE '9100-READ-SEL-QUEUE'                               17090000
081400                                   TO DP013-PARAGRAPH             17100000
081500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    17110000
081600                                   TO DP013-MESSAGE-TEXT (1)      17120000
081700         PERFORM DP013-0000-PROCESS-ABEND                         17130000
081800     END-EVALUATE.                                                17140000
081900                                                                  17150000
082000/                                                                 17160000
082100******************************************************************17170000
082200* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *17180000
082300******************************************************************17190000
082400 9200-REWRITE-SEL-QUEUE.                                          17200000
082500     EXEC CICS                                                    17210000
082600          WRITEQ TS                                               17220000
082700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     17230000
082800              FROM    (SU010-SELECT-RECORD)                       17240000
082900              ITEM    (ASC-SEL-ITEM)                              17250000
083000              RESP    (PV-CICS-RESP)                              17260000
083100              REWRITE                                             17270000
083200     END-EXEC.                                                    17280000
083300                                                                  17290000
083400     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    17300000
083500         SET DP013-CICS-ABEND                                     17310000
083600             DP013-NO-ROLLBACK     TO TRUE                        17320000
083700         MOVE '9200-REWRITE-SEL-QUEUE'                            17330000
083800                                   TO DP013-PARAGRAPH             17340000
083900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   17350000
084000                                   TO DP013-MESSAGE-TEXT (1)      17360000
084100         PERFORM DP013-0000-PROCESS-ABEND                         17370000
084200     END-IF.                                                      17380000
084300                                                                  17390000
084400/                                                                 17400000
084500******************************************************************17410000
084600** THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE  **   17420000
084700** AND THE ERROR SWITCHES.                                   **   17430000
084800******************************************************************17440000
084900 9900-SOFT-ABORT.                                                 17450000
085000     SET PS-ERROR                                                 17460000
085100         DP020-MSG-FATAL   TO TRUE.                               17470000
085200                                                                  17480000
085300     IF PS-UPDATES-DONE AND SQLCODE = -913                        17490000
085400         PERFORM 9901-ROLLBACK                                    17500000
085500     END-IF.                                                      17510000
085600                                                                  17520000
085700     MOVE PC-TSYMSG-00551  TO DP020-MSG-NUMBER.                   17530000
085800     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT(1).           17540000
085900     PERFORM 0001-CALL-CICS-ARCH-API.                             17550000
086000                                                                  17560000
086100 9901-ROLLBACK.                                                   17570000
086200     EXEC CICS                                                    17580000
086300         SYNCPOINT ROLLBACK                                       17590000
086400     END-EXEC.                                                    17600000
086500                                                                  17610000
086600/                                                                 17620000
086700*----------------------------------------------------------------*17630000
086800*    ABEND PROCESSOR MODULE                                      *17640000
086900*----------------------------------------------------------------*17650000
087000                                                                  17660000
087100     COPY DPPD013.                                                17670000
