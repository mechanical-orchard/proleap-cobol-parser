000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    TRKCS151.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER (STRATAGEM).                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  06-10-97.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    Y151 - ADD/UPDATE/DELETE FOB CODES                          *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO ADD/UPDATE/DELETE FOB       *00120000
001300*    CODES.  THE FOB DESCRIPTION MUST BE ENTERED FOR THE         *00130000
001400*    ADD FUNCTION.                                               *00140000
001500*                                                                *00150000
001600*    02/19/2003     MADE CHANGES TO INCLUDE THE DECONSOLIDATOR   *00160000
001700*                   SCAC TO FOB SCREENS    -VISWA KARUTURI       *00170000
001800*----------------------------------------------------------------*00180000
P5207 *    11/20/2013   ADDED A NEW FIELD INCOTERM CODE TO TRKM151     *00181000
P5207 *    SCREEN AND HENCE CORRESPONIDNG CODE CHANGES HAVE BEEN DONE  *00182000
P5207 *    IN THIS PROGRAM.  - SHEBENA                                 *00183000
P5207 *    CHANGE TAG : P5207  CR # : CHG0081355                       *00184063
P5207 *----------------------------------------------------------------*00185000
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00186064
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00187064
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00188064
CICS  *-----------------------------------------------------------------00189064
001900                                                                  00190000
002000 ENVIRONMENT DIVISION.                                            00200000
002100                                                                  00210000
002200 DATA DIVISION.                                                   00220000
002300                                                                  00230000
002400 WORKING-STORAGE SECTION.                                         00240000
002500                                                                  00250000
002600 01  DK-DB2-KEYS.                                                 00260000
002700     05  DK-COUNTRY-CODE                PIC  X(03)  VALUE SPACE.  00270000
002800     05  DK-FOB-CODE                    PIC  X(03)  VALUE SPACE.  00280000
002900     05  DK-POE-CODE                    PIC  X(03)  VALUE SPACE.  00290000
003000     05  DK-ENT-NAME                    PIC  X(04)  VALUE SPACE.  00300000
003100     05  DK-ENT-ID                      PIC  S9(9) COMP.          00310000
003200     05  DK-STAT-CDE                    PIC  X(01)  VALUE SPACE.  00320000
003300     05  DK-FOB-STAT-CDE                PIC  X(01)  VALUE SPACE.  00330000
003400     05  DK-FUNC-CDE                    PIC  X(01)  VALUE SPACE.  00340000
P5207      05  DK-ATTR-ELEM-TXT-D.                                      00341000
P5207          49 DK-ATTR-ELEM-TXT-LEN-D      PIC S9(4) COMP.           00342054
P5207          49 DK-ATTR-ELEM-TXT-TEXT-D     PIC X(50).                00343054
003500*                                                                 00350000
003600 01  PC-PROGRAM-CONSTANTS.                                        00360000
003700     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TR151A  '.  00370000
003800     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TRKM151 '.  00380000
003900     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TRKCS151'.  00390000
004000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00400000
004100                                              COMP.               00410000
004200     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           00420000
004300                                              COMP.               00430000
004400     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1            00440000
004500                                              COMP.               00450000
004600     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00460000
004700     05  PC-PRIMARY               PIC XX      VALUE '01'.         00470000
004800     05  PC-A                     PIC  X(01)  VALUE 'A'.          00480000
004900     05  PC-I                     PIC  X(01)  VALUE 'I'.          00490000
005000     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00500000
005100     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00510000
005200     05  PC-TSYMSG-NUMBERS.                                       00520000
005300         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00530000
005400         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00540000
005500         10  PC-TSYMSG-00035      PIC  9(05)  VALUE  00035.       00550000
005600         10  PC-TSYMSG-00050      PIC  9(05)  VALUE  00050.       00560000
005700         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00570000
005800         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00580000
005900         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00590000
006000         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00600000
006100         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00610000
006200         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00620000
006300         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00630000
006400         10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       00640000
006500         10  PC-TSYMSG-00223      PIC  9(05)  VALUE  00223.       00650000
006600         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       00660000
006700         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       00670000
006800         10  PC-TSYMSG-00068      PIC  9(05)  VALUE  00068.       00680000
006900         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00690000
007000         10  PC-TSYMSG-01450      PIC  9(05)  VALUE  01450.       00700000
007100         10  PC-TSYMSG-01644      PIC  9(05)  VALUE  01644.       00710000
007200         10  PC-TSYMSG-01646      PIC  9(05)  VALUE 01646.        00720000
007300     05  PC-INTER-APPL-CODES.                                     00730000
007400         10  PC-INTER-APPL-CRIT-ADD   PIC X(01)  VALUE '1'.       00740000
007500         10  PC-INTER-APPL-CRIT-UPD   PIC X(01)  VALUE '2'.       00750000
007600         10  PC-INTER-APPL-CRIT-DEL   PIC X(01)  VALUE '3'.       00760000
007700         10  PC-INTER-APPL-LIST-UPD   PIC X(01)  VALUE '4'.       00770000
007800         10  PC-INTER-APPL-LIST-DEL   PIC X(01)  VALUE '5'.       00780000
007900         10  PC-INTER-APPL-LIST-COPY  PIC X(01)  VALUE '7'.       00790000
008000*                                                                 00800000
008100 01  PS-PROGRAM-SWITCHES.                                         00810000
008200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00820000
008300         88  PS-ERROR                         VALUE  'Y'.         00830000
008400         88  PS-NO-ERROR                      VALUE  'N'.         00840000
008500     05  PS-COMMAREA-SW           PIC X(01)   VALUE 'N'.          00850000
008600         88  PS-COMMAREA-VALID                VALUE 'Y'.          00860000
008700         88  PS-COMMAREA-NOT-VALID            VALUE 'N'.          00870000
008800     05  PS-LIST-END-SW           PIC X(01)   VALUE 'N'.          00880000
008900         88  PS-LIST-END                      VALUE 'Y'.          00890000
009000         88  PS-NO-LIST-END                   VALUE 'N'.          00900000
                                                                        00910000
009100*                                                                 00950000
009200 01  PV-PROGRAM-VARIABLES.                                        00960000
009300     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00970000
009400                                              COMP SYNC.          00980000
009500     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00990000
009600                                              COMP SYNC.          01000000
009700     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            01010000
009800                                              COMP SYNC.          01020000
009900     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            01030000
010000                                              COMP SYNC.          01040000
010100     05  PV-DISPLAY-TASK          PIC 9(05).                      01050000
010200                                                                  01060000
010300*---------------------------------------------------------------* 01070000
010400*  RECORD LAYOUT FOR THE COUNTRY CODE SELECTION TEMP STORAGE    * 01080000
010500*  QUEUE.                                                       * 01090000
010600*---------------------------------------------------------------* 01100000
010700                                                                  01110000
010800     COPY TRWS021.                                                01120000
010900                                                                  01130000
011000 EJECT                                                            01140000
011100*----------------------------------------------------------------*01150000
011200*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *01160000
011300*----------------------------------------------------------------*01170000
011400                                                                  01180000
011500     COPY DPWS044.                                                01190000
011600 EJECT                                                            01200000
011700*----------------------------------------------------------------*01210000
011800*    MAP LAYOUT                                                  *01220000
011900*----------------------------------------------------------------*01230000
012000                                                                  01240000
012100     COPY TRKM151.                                                01250000
012200                                                                  01260000
012300                                                                  01270000
012400     EJECT                                                        01280000
012500*----------------------------------------------------------------*01290000
012600*    ATTRIBUTE SETTINGS COPYBOOK.                                *01300000
012700*----------------------------------------------------------------*01310000
012800                                                                  01320000
012900     COPY DPWS015.                                                01330000
013000                                                                  01340000
013100*----------------------------------------------------------------*01350000
013200*    FUNCTION KEYS COPYBOOK                                      *01360000
013300*----------------------------------------------------------------*01370000
013400                                                                  01380000
013500     COPY DPWS016.                                                01390000
013600 EJECT                                                            01400000
013700***************************************************************** 01410000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            01420064
013900***************************************************************** 01430000
014000     COPY DPWS030.                                                01440000
CICS       COPY DPWS930.                                                01441064
014100 EJECT                                                            01450000
014200***************************************************************** 01460000
014300*    STANDARD COMMAREA.                                           01470000
014400***************************************************************** 01480000
014500                                                                  01490000
014600     COPY DPWS020.                                                01500000
014700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01510000
014800                                                                  01520000
014900***************************************************************** 01530000
015000*    INTER-APPLICATION COMMAREA.                                  01540000
015100***************************************************************** 01550000
015200                                                                  01560000
015300         10  INTER-APPL-COMM-AREA PIC X(200).                     01570000
015400     COPY TRWS019.                                                01580000
015500***************************************************************** 01590000
015600*    SPECIFIC COMMMAREA FOR TRKCS151.                             01600000
015700***************************************************************** 01610000
015800         10  ASC-SPECIFIC-COMMAREA.                               01620000
015900             15  ASC-FORMAT-IND                 PIC  X(01).       01630000
016000                 88  ASC-ADD-FOB                        VALUE '1'.01640000
016100                 88  ASC-UPD-FOB                   VALUE '2', '4'.01650000
016200                 88  ASC-DEL-FOB                        VALUE '3'.01660000
016300                 88  ASC-UPD-FROM-LIST                  VALUE '4'.01670000
016400                 88  ASC-DEL-FROM-LIST                  VALUE '5'.01680000
016500                 88  ASC-ADD-FROM-LIST                  VALUE '6'.01690000
016600             15  ASC-ADD-COMPLETE-SW            PIC  X(01).       01700000
016700                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.01710000
016800                 88  ASC-ADD-PENDING                    VALUE 'N'.01720000
016900             15  ASC-UPD-COMPLETE-SW            PIC  X(01).       01730000
017000                 88  ASC-UPD-COMPLETE                   VALUE 'Y'.01740000
017100                 88  ASC-UPD-PENDING                    VALUE 'N'.01750000
017200             15  ASC-DEL-COMPLETE-SW            PIC  X(01).       01760000
017300                 88  ASC-DEL-COMPLETE                   VALUE 'Y'.01770000
017400                 88  ASC-DEL-PENDING                    VALUE 'N'.01780000
017500             15  ASC-COUNTRY-DESC-CHANGED-SW    PIC  X(01).       01790000
017600                 88  ASC-COUNTRY-DESC-CHANGED           VALUE 'Y'.01800000
017700                 88  ASC-COUNTRY-DESC-NOT-CHANGED       VALUE ' '.01810000
017800             15  ASC-FOB-CODE                   PIC  X(03).       01820000
017900             15  ASC-COUNTRY-CODE               PIC  X(03).       01830000
018000             15  ASC-FOB-CITY-NAME              PIC  X(25).       01840000
018100             15  ASC-CONSLR-SCAC                PIC  X(04).       01850000
018200             15  ASC-CONSLR-NAME                PIC  X(30).       01860000
018300             15  ASC-CONSLR-ENT-ID              PIC  S9(9).       01870000
018400             15  ASC-CSTM-BKR-SCAC              PIC  X(04).       01880000
018500             15  ASC-CSTM-BKR-NAME              PIC  X(30).       01890000
018600             15  ASC-CSTM-BKR-ENT-ID            PIC  S9(9).       01900000
018700             15  ASC-POE-CODE                   PIC  X(03).       01910000
018800             15  ASC-POE-CITY-NAME              PIC  X(30).       01920000
018900             15  ASC-FOB-STD-EDI-CDE            PIC  X(05).       01930000
019000             15  ASC-DECONL-SCAC                PIC  X(04).       01940000
019100             15  ASC-DECONL-NAME                PIC  X(30).       01950000
019200             15  ASC-DECONL-ENT-ID              PIC  S9(9).       01960000
P5207              15  ASC-INCOTERM-CODE              PIC  X(03).       01970000
P5207              15  ASC-INCOTERM-CODE-DESC         PIC  X(30).       01980060
019300             15  ASC-COUNTRY-CODE-DESC          PIC  X(40).       01990059
019400             15  ASC-COUNTRY-CODE-IND           PIC  X(01).       02000000
019500                 88  ASC-VALID-COUNTRY-CODE    VALUE 'Y'.         02010000
019600                 88  ASC-INACTIVE-COUNTRY-CODE VALUE 'I'.         02020000
019700                 88  ASC-INVALID-COUNTRY-CODE  VALUE 'N'.         02030000
019800             15  ASC-POE-CODE-IND               PIC  X(01).       02040000
019900                 88  ASC-VALID-POE-CODE        VALUE 'Y'.         02050000
020000                 88  ASC-INACTIVE-POE-CODE     VALUE 'I'.         02060000
020100                 88  ASC-INVALID-POE-CODE      VALUE 'N'.         02070000
020200             15  ASC-FOB-CODE-IND               PIC  X(01).       02080000
020300                 88  ASC-VALID-FOB-CODE        VALUE 'Y'.         02090000
020400                 88  ASC-INVALID-FOB-CODE      VALUE 'N'.         02100000
020500             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          02110000
020600                 88  ASC-USE-SEL-QUEUE         VALUE 'Y'.         02120000
020700             15  ASC-LIST-QUEUE-NAME.                             02130000
020800                 20  ASC-LIST-TERM-ID                PIC  X(04).  02140000
020900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   02150000
021000                                                          COMP-3. 02160000
021100                 20  ASC-LIST-SEQ                    PIC  9(01).  02170000
021200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02180000
021300                                            PIC S9(09) COMP-3.    02190000
021400             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    02200000
021500             15  ASC-SEL-QUEUE-NAME.                              02210000
021600                 20  ASC-SEL-TERM-ID        PIC X(04).            02220000
021700                 20  ASC-SEL-TASK           PIC S9(05) COMP-3.    02230000
021800                 20  ASC-SEL-SEQ            PIC 9(01).            02240000
021900             15  ASC-SEL-SUB                PIC S9(04) COMP.      02250000
022000             15  ASC-SEL-ITEM               PIC S9(04) COMP.      02260000
022100     EJECT                                                        02270000
022200*----------------------------------------------------------------*02280000
022300*    ABEND PROCESSING COPYBOOK.                                  *02290000
022400*----------------------------------------------------------------*02300000
022500                                                                  02310000
022600     COPY DPWS013.                                                02320000
022700                                                                  02330000
022800*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        02340000
022900*---------------------------------------------------------------* 02350000
023000*    DB2 AREA FOR TEXTENT TABLE                                 * 02360000
023100*---------------------------------------------------------------* 02370000
023200     EXEC SQL                                                     02380000
023300          INCLUDE TEXTENT                                         02390000
023400     END-EXEC.                                                    02400000
023500                                                                  02410000
023600*---------------------------------------------------------------* 02420000
023700*    DB2 AREA FOR ENTERPRISE TABLE                              * 02430000
023800*---------------------------------------------------------------* 02440000
023900     EXEC SQL                                                     02450000
024000          INCLUDE TENTNME                                         02460000
024100     END-EXEC.                                                    02470000
024200                                                                  02480000
024300*---------------------------------------------------------------* 02490000
024400*    DB2 AREA FOR TRANSPORATION FOB TABLE                       * 02500000
024500*---------------------------------------------------------------* 02510000
024600     EXEC SQL                                                     02520000
024700          INCLUDE TIMFOB                                          02530000
024800     END-EXEC.                                                    02540000
024900                                                                  02550000
025000*---------------------------------------------------------------* 02560000
025100*    DB2 AREA FOR TRANSPORATION POE TABLE                       * 02570000
025200*---------------------------------------------------------------* 02580000
025300     EXEC SQL                                                     02590000
025400          INCLUDE TIMPOE                                          02600000
025500     END-EXEC.                                                    02610000
025600                                                                  02620000
025700*---------------------------------------------------------------* 02630000
025800*    DB2 AREA FOR COUNTRY CODE TABLE                            * 02640000
025900*---------------------------------------------------------------* 02650000
026000     EXEC SQL                                                     02660000
026100          INCLUDE TCNTRY                                          02670000
026200     END-EXEC.                                                    02680000
026300                                                                  02690000
026400                                                                  02700000
026500*---------------------------------------------------------------* 02710000
026600*    DB2 AREA FOR AUDIT FOB TABLE                               * 02720000
026700*---------------------------------------------------------------* 02730000
026800     EXEC SQL                                                     02740000
026900          INCLUDE TAUFOB                                          02750000
027000     END-EXEC.                                                    02760000
027100                                                                  02770000
P5207 *---------------------------------------------------------------* 02780000
P5207 *    DB2 AREA FOR INTEGRATION DATABASE - WST_INTGRTN_TYP        * 02790000
P5207 *---------------------------------------------------------------* 02800000
P5207      EXEC SQL                                                     02810000
P5207           INCLUDE WST00008                                        02820000
P5207      END-EXEC.                                                    02830000
P5207                                                                   02840000
P5207 *---------------------------------------------------------------* 02850000
P5207 *    INTEGRATION DATABASE - WST_ATTR_ELEM                       * 02860000
P5207 *---------------------------------------------------------------* 02870000
P5207      EXEC SQL                                                     02880000
P5207           INCLUDE WST00010                                        02890000
P5207      END-EXEC.                                                    02900000
                                                                        02910000
027200*---------------------------------------------------------------* 02920000
027300*    DB2 AREA FOR COMMUNICATIONS                                * 02930000
027400*---------------------------------------------------------------* 02940000
027500     EXEC SQL                                                     02950000
027600          INCLUDE SQLCA                                           02960000
027700     END-EXEC.                                                    02970000
027800                                                                  02980000
027900 EJECT                                                            02990000
028000*---------------------------------------------------------------* 03000000
028100*    CURSOR DECLARATION FOR SELECTING ACTIVE POE CODES          * 03010000
028200*---------------------------------------------------------------* 03020000
028300                                                                  03030000
028400     EXEC SQL                                                     03040000
028500          DECLARE  POE-CSR1 CURSOR                                03050000
028600              FOR  SELECT DISTINCT                                03060000
028700                   POE_CTY_NM                                     03070000
028800             FROM  TIMPOE                                         03080000
028900            WHERE  POE_CDE           = :DK-POE-CODE               03090000
029000              AND  STAT_CDE          = :PC-A                      03100000
029100              AND  PO_ASGMT_ALWD_IND = :PC-Y                      03110000
029200     END-EXEC.                                                    03120000
029300                                                                  03130000
029400*---------------------------------------------------------------* 03140000
029500*    CURSOR DECLARATION FOR SELECTING INACTIVE POE CODES        * 03150000
029600*---------------------------------------------------------------* 03160000
029700                                                                  03170000
029800     EXEC SQL                                                     03180000
029900          DECLARE  POE-CSR2 CURSOR                                03190000
030000              FOR  SELECT DISTINCT                                03200000
030100                   POE_CTY_NM                                     03210000
030200             FROM  TIMPOE                                         03220000
030300            WHERE  POE_CDE           = :DK-POE-CODE               03230000
030400              AND  STAT_CDE          = :PC-I                      03240000
030500              AND  PO_ASGMT_ALWD_IND = :PC-Y                      03250000
030600     END-EXEC.                                                    03260000
030700                                                                  03270000
030800 EJECT                                                            03280000
030900                                                                  03290000
031000 LINKAGE SECTION.                                                 03300000
031100 01  DFHCOMMAREA.                                                 03310000
031200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03320000
031300                                        DEPENDING ON EIBCALEN.    03330000
031400         10  FILLER                     PIC  X(01).               03340000
031500                                                                  03350000
031600                                                                  03360000
031700 PROCEDURE DIVISION.                                              03370000
031800***************************************************************** 03380000
031900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03390000
032000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03400000
032100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03410000
032200**                                                             ** 03420000
032300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03430000
032400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03440000
032500***************************************************************** 03450000
032600 0000-MAIN-MODULE.                                                03460000
032700     INITIALIZE DP030-CICS-API-FIELDS.                            03470000
032800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03480000
032900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03490000
033000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03500000
033100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03510000
033200     MOVE LENGTH OF TR151AI        TO DP030-MAP-LENGTH (1).       03521000
033300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03530000
033400     PERFORM 0001-CALL-CICS-ARCH-API.                             03540000
033500*                                                                 03550000
033600     PERFORM 1000-CONTROL-PROCESSING                              03560000
033700*                                                                 03570000
033800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03580000
033900     PERFORM 0001-CALL-CICS-ARCH-API.                             03590000
034000                                                                  03600000
034100 0001-CALL-CICS-ARCH-API.                                         03610000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03620064
034300                                    DFHCOMMAREA                   03630064
034400                                    DP030-CICS-API-FIELDS         03640064
034500                                    DP020-STANDARD-COMMAREA       03650064
034600                                    TR151AI.                      03660064
034700*                                                                 03670000
034800     IF  DP030-RC-CALL-SUCCESSFUL                                 03680000
034900         CONTINUE                                                 03690000
035000     ELSE                                                         03700000
035100         SET DP013-NO-ROLLBACK                                    03710000
035200             DP013-XCTL-DISPLAY-RESTART                           03720000
035300             DP013-CICS-ABEND      TO TRUE                        03730000
035400         MOVE 'BEFORE 0000-MAIN-MODULE'                           03740000
035500                                   TO DP013-PARAGRAPH             03750000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03760064
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03770064
035800         MOVE DP030-RETURN-CODE                                   03780000
035900                                   TO DP013-MESSAGE-TEXT (3)      03790000
036000         PERFORM DP013-0000-PROCESS-ABEND                         03800000
036100     END-IF.                                                      03810000
036200 EJECT                                                            03820000
036300*----------------------------------------------------------------*03830000
036400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03840000
036500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03850000
036600*----------------------------------------------------------------*03860000
036700                                                                  03870000
036800 1000-CONTROL-PROCESSING.                                         03880000
036900                                                                  03890000
037000     EVALUATE TRUE                                                03900000
037100         WHEN DP020-NEXT-ACT-INITIAL                              03910000
037200             INITIALIZE ASC-SPECIFIC-COMMAREA                     03920000
037300             MOVE TR019-COUNTRY-CODE TO ASC-COUNTRY-CODE          03930000
037310             PERFORM 4200-SELECT-COUNTRY-DESC                     03940000
037400*            MOVE TR019-COUNTRY-CODE-DESC TO                      03950000
037500*                                       ASC-COUNTRY-CODE-DESC     03960000
037600             MOVE TR019-CONSLR-SCAC   TO                          03970000
037700                                        ASC-CONSLR-SCAC           03980000
037800             MOVE TR019-CONSLR-NAME   TO                          03990000
037900                                        ASC-CONSLR-NAME           04000000
038000             MOVE TR019-CSTM-BKR-SCAC TO                          04010000
038100                                        ASC-CSTM-BKR-SCAC         04020000
038200             MOVE TR019-CSTM-BKR-NAME TO                          04030000
038300                                        ASC-CSTM-BKR-NAME         04040000
038400             MOVE TR019-FOB-CODE      TO                          04050000
038500                                        ASC-FOB-CODE              04060000
038600             MOVE TR019-FOB-CITY-NAME TO                          04070000
038700                                        ASC-FOB-CITY-NAME         04080000
038800             MOVE TR019-POE-CODE TO                               04090000
038900                                        ASC-POE-CODE              04100000
039000             MOVE TR019-POE-CITY-NAME TO                          04110000
039100                                        ASC-POE-CITY-NAME         04120000
039200             MOVE TR019-CONSLR-ENT-ID TO                          04130000
039300                                        ASC-CONSLR-ENT-ID         04140000
039400             MOVE TR019-DECONL-ENT-ID TO                          04150000
039500                                        ASC-DECONL-ENT-ID         04160000
039600             MOVE TR019-CSTM-BKR-ENT-ID TO                        04170000
039700                                        ASC-CSTM-BKR-ENT-ID       04180000
039800             MOVE TR019-FOB-STD-EDI-CDE TO                        04190000
039900                                        ASC-FOB-STD-EDI-CDE       04200000
040000             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND     04210000
040100             MOVE TR019-DECONL-SCAC   TO                          04220000
040200                                        ASC-DECONL-SCAC           04230000
040300             MOVE TR019-DECONL-NAME   TO                          04240000
040400                                        ASC-DECONL-NAME           04250000
P5207              MOVE TR019-INCOTERM-CODE TO                          04260000
P5207                                         ASC-INCOTERM-CODE         04270000
P5207              IF ASC-INCOTERM-CODE > SPACES OR                     04290100
P5207                 ASC-INCOTERM-CODE = SPACES                        04290200
P5207                                                                   04290300
P5207                  PERFORM 4332-SELECT-INCOTERM                     04290560
P5207                                                                   04290660
P5207                 IF DK-ATTR-ELEM-TXT-TEXT-D   = SPACES OR          04290760
P5207                   ASC-INCOTERM-CODE = SPACES OR                   04290860
P5207                   ASC-INCOTERM-CODE = LOW-VALUES                  04290960
P5207                     MOVE SPACES        TO ASC-INCOTERM-CODE-DESC  04291060
P5207                 ELSE                                              04291160
P5207                     MOVE DK-ATTR-ELEM-TXT-TEXT-D                  04291260
P5207                                TO ASC-INCOTERM-CODE-DESC          04291360
P5207                 END-IF                                            04291460
P5207              END-IF                                               04291600
040500             MOVE TR019-CSTM-BKR-SCAC TO                          04300000
040600                                        ASC-CSTM-BKR-SCAC         04310000
040700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04320000
040800             PERFORM 4000-BUILD-INITIAL-PANEL                     04330000
040900           IF ASC-ADD-FOB                                         04340000
041000             CONTINUE                                             04350000
041100           ELSE                                                   04360000
041200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04370000
041300           END-IF                                                 04380000
041400                                                                  04390000
041500         WHEN DP020-NEXT-ACT-READ-MAP                             04400000
041600             PERFORM 2000-PROCESS-PANEL                           04410000
041700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04420000
041800                                                                  04430000
041900         WHEN DP020-NEXT-ACT-RETURN                               04440000
042000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04450000
042100                                                                  04460000
042200         WHEN OTHER                                               04470000
042300             SET DP013-LOGIC-ABEND                                04480000
042400                 DP013-NO-ROLLBACK TO TRUE                        04490000
042500             MOVE '1000-CONTROL-PROCESSING'                       04500000
042600                                   TO DP013-PARAGRAPH             04510000
042700             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04520000
042800                                   TO DP013-MESSAGE-TEXT(1)       04530000
042900             MOVE DP020-NEXT-APPL-ACTIVITY                        04540000
043000                                   TO DP013-MESSAGE-TEXT(2)       04550000
043100             PERFORM DP013-0000-PROCESS-ABEND                     04560000
043200     END-EVALUATE.                                                04570000
043300                                                                  04580000
043400*----------------------------------------------------------------*04590000
043500*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *04600000
043600*    INTER-APPLICATION FORMAT CODE.                              *04610000
043700*                                                                *04620000
043800*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *04630000
043900*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *04640000
044000*----------------------------------------------------------------*04650000
044100 1100-PROCESS-INTER-APPL-COMM.                                    04660000
044200                                                                  04670000
044300     SET PS-COMMAREA-VALID         TO TRUE.                       04680000
044400                                                                  04690000
044500*    INITIALIZE ASC-SPECIFIC-COMMAREA.                            04700000
044600                                                                  04710000
044700     EVALUATE DP020-INT-APPL-FORMAT-IND                           04720000
044800* PERFORM PRE-EDITS WHEN UPDATING, COMING FROM A LIST SCREEN      04730000
044900* PERFORM PRE-EDITS WHEN DELETING, COMING FROM A LIST SCREEN      04740000
045000         WHEN PC-INTER-APPL-LIST-UPD                              04750000
045100         WHEN PC-INTER-APPL-LIST-DEL                              04760000
045200             IF TR019-NUMBER-OF-SELECTED-ITEMS  = 0               04770000
045300                 SET DP020-NEXT-ACT-APPL-ERROR                    04780000
045400                     DP030-OVERRIDE-GO                            04790000
045500                     DP020-MSG-WARNING                            04800000
045600                     PS-ERROR                                     04810000
045700                     PS-COMMAREA-NOT-VALID                        04820000
045800                                   TO TRUE                        04830000
045900                 MOVE PC-TSYMSG-00057                             04840000
046000                                   TO DP020-MSG-NUMBER            04850000
046100             ELSE                                                 04860000
046200                 SET ASC-USE-SEL-QUEUE                            04870000
046300                     DP030-SET-CURSOR-APPL-1                      04880000
046400                                   TO TRUE                        04890000
046500                 MOVE TR019-NUMBER-OF-SELECTED-ITEMS              04901000
046600                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04910000
046700                 MOVE TR019-NUMBER-OF-TS-ITEMS                    04920000
046800                                   TO ASC-NUMBER-OF-TS-ITEMS      04930000
046900                 MOVE TR019-SEL-QUEUE-NAME                        04940000
047000                                   TO ASC-SEL-QUEUE-NAME          04950000
047100                 PERFORM 1120-PREPARE-LIST-ENTRY                  04961000
047200             END-IF                                               04970000
047300                                                                  04980000
047400             IF  PS-NO-ERROR                                      04990000
047500                  MOVE DP015-HL-OFF         TO AFOBCODH           05000000
047600                  MOVE DP015-PRO-NOR-OFF    TO AFOBCODA           05010000
047700                  MOVE DP015-BLUE           TO AFOBCODC           05020000
047800                                                                  05030000
047900                                                                  05040000
048000              MOVE ASC-COUNTRY-CODE TO DK-COUNTRY-CODE            05050000
048100              PERFORM 4300-SELECT-COUNTRY-ACTIVE                  05060000
048200                                                                  05070000
048300              IF ASC-INVALID-COUNTRY-CODE                         05080000
048400                    SET PS-ERROR                                  05090000
048500                        DP020-MSG-FATAL   TO TRUE                 05100000
048600                    MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER     05110000
048700                    MOVE DP015-UNP-ALP-BRT-OFF                    05120000
048800                                          TO ACNTCODA             05130000
048900                    MOVE DP015-RED        TO ACNTCODC             05140000
049000                    MOVE DP015-REVERSE    TO ACNTCODH             05150000
049100                    MOVE -1               TO ACNTCODL             05160000
049200                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           05170000
049300                    MOVE SPACES           TO CNTRY-CNTRY-NM       05180000
049400                    PERFORM 4301-SELECT-COUNTRY-INACTIVE          05190000
049500               ELSE                                               05200000
049600                    MOVE DP015-GREEN              TO ACNTCODC     05210000
049700                    MOVE DP015-BLUE               TO ACNTDESC     05220000
049800                    MOVE DP015-UNP-ALP-BRT-OFF    TO ACNTCODA     05230000
049900                    MOVE DP015-PRO-NOR-OFF        TO ACNTDESA     05240000
050000                    MOVE DP015-HL-OFF             TO ACNTDESH     05250000
050100               END-IF                                             05260000
050200                                                                  05270000
050300              IF ASC-INACTIVE-COUNTRY-CODE                        05280000
050400                    SET PS-ERROR                                  05290000
050500                        DP020-MSG-FATAL   TO TRUE                 05300000
050600                    MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER     05310000
050700                    MOVE DP015-UNP-ALP-BRT-OFF                    05320000
050800                                          TO ACNTCODA             05330000
050900                    MOVE DP015-RED        TO ACNTCODC             05340000
051000                    MOVE DP015-REVERSE    TO ACNTCODH             05350000
051100                    MOVE -1               TO ACNTCODL             05360000
051200                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           05370000
051300                    MOVE SPACES           TO CNTRY-CNTRY-NM       05380000
051400               END-IF                                             05390000
051500             MOVE CNTRY-CNTRY-NM          TO ASC-COUNTRY-CODE-DESC05400000
051600                                             ACNTDESO             05410000
051700                 IF ASC-UPD-FROM-LIST                             05420000
051800                     SET ASC-UPD-PENDING                          05430000
051900                                   TO TRUE                        05440000
052000                 ELSE                                             05450000
052100                     MOVE PC-TSYMSG-00004                         05460000
052200                                   TO DP020-MSG-NUMBER            05470000
052300                     SET ASC-DEL-PENDING                          05480000
052400                     DP020-MSG-INFORMATIONAL                      05490000
052500                                   TO TRUE                        05500000
052600                 END-IF                                           05510000
052700             END-IF                                               05520000
052800                                                                  05530000
052900* PERFORM PRE-EDITS WHEN UPDATING, COMING FROM THE CRIT SPEC      05540000
053000* PERFORM PRE-EDITS WHEN DELETING, COMING FROM THE CRIT SPEC      05550000
053100         WHEN PC-INTER-APPL-CRIT-UPD                              05560000
053200             MOVE TR019-COUNTRY-CODE TO ASC-COUNTRY-CODE          05570000
053210             PERFORM 4200-SELECT-COUNTRY-DESC                     05580000
053300*            MOVE TR019-COUNTRY-CODE-DESC TO                      05590000
053400*                                       ASC-COUNTRY-CODE-DESC     05600000
053500             MOVE TR019-CONSLR-SCAC  TO                           05610000
053600                                        ASC-CONSLR-SCAC           05620000
053700             MOVE TR019-CONSLR-NAME  TO                           05630000
053800                                        ASC-CONSLR-NAME           05640000
053900             MOVE TR019-DECONL-SCAC  TO                           05650000
054000                                        ASC-DECONL-SCAC           05660000
054100             MOVE TR019-DECONL-NAME  TO                           05670000
054200                                        ASC-DECONL-NAME           05680000
054300             MOVE TR019-CSTM-BKR-SCAC TO                          05690000
054400                                        ASC-CSTM-BKR-SCAC         05700000
054500             MOVE TR019-CSTM-BKR-NAME TO                          05710000
054600                                        ASC-CSTM-BKR-NAME         05720000
054700             MOVE TR019-FOB-CODE      TO                          05730000
054800                                        ASC-FOB-CODE              05740000
054900             MOVE TR019-FOB-CITY-NAME TO                          05750000
055000                                        ASC-FOB-CITY-NAME         05760000
055100             MOVE TR019-POE-CODE TO                               05770000
055200                                        ASC-POE-CODE              05780000
055300             MOVE TR019-POE-CITY-NAME TO                          05790000
055400                                        ASC-POE-CITY-NAME         05800000
055500             MOVE TR019-CONSLR-ENT-ID TO                          05810000
055600                                        ASC-CONSLR-ENT-ID         05820000
055700             MOVE TR019-DECONL-ENT-ID TO                          05830000
055800                                        ASC-DECONL-ENT-ID         05840000
055900             MOVE TR019-CSTM-BKR-ENT-ID TO                        05850000
056000                                        ASC-CSTM-BKR-ENT-ID       05860000
056100             MOVE TR019-FOB-STD-EDI-CDE TO                        05870000
056200                                        ASC-FOB-STD-EDI-CDE       05880000
P5207              MOVE TR019-INCOTERM-CODE   TO                        05890000
P5207                                         ASC-INCOTERM-CODE         05900000
056300                                                                  05930000
056400         WHEN PC-INTER-APPL-CRIT-DEL                              05940000
056500              MOVE TR019-FOB-CODE     TO ASC-FOB-CODE             05950000
056600                                         DK-FOB-CODE              05960000
056700              PERFORM 4100-SELECT-FOB                             05970000
056800                                                                  05980000
056900              IF ASC-INVALID-FOB-CODE OR                          05990000
057000                 DK-FOB-CODE = SPACE                              06000000
057100                                                                  06010000
057200                    SET PS-ERROR                                  06020000
057300                        DP020-MSG-FATAL   TO TRUE                 06030000
057400                    MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER     06040000
057500                    MOVE DP015-UNP-ALP-BRT-OFF                    06050000
057600                                          TO AFOBCODA             06060000
057700                    MOVE DP015-RED        TO AFOBCODC             06070000
057800                    MOVE DP015-REVERSE    TO AFOBCODH             06080000
057900                    MOVE -1               TO AFOBCODL             06090000
058000                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           06100000
058100              END-IF                                              06110000
058200                                                                  06120000
058300              IF ASC-VALID-FOB-CODE AND                           06130000
058400                 IMFOB-STAT-CDE = PC-I                            06140000
058500                  SET  ASC-DEL-COMPLETE   TO TRUE                 06150000
058600              END-IF                                              06160000
058700                                                                  06170000
058800              MOVE TR019-POE-CODE     TO ASC-POE-CODE             06180000
058900                                         DK-POE-CODE              06190000
059000              PERFORM 4150-OPEN-POE-CURSOR1                       06200000
059100              PERFORM 4154-FETCH-POE-CURSOR1                      06210000
059200              PERFORM 4152-CLOSE-POE-CURSOR1                      06220000
059300                                                                  06230000
059400              IF ASC-INVALID-POE-CODE OR                          06240000
059500                 DK-POE-CODE = SPACE                              06250000
059600                  MOVE SPACES TO IMPOE-POE-CTY-NM                 06260000
059700                  PERFORM 4160-OPEN-POE-CURSOR2                   06270000
059800                  PERFORM 4164-FETCH-POE-CURSOR2                  06280000
059900                  PERFORM 4162-CLOSE-POE-CURSOR2                  06290000
060000              END-IF                                              06300000
060100              IF ASC-INACTIVE-POE-CODE                            06310000
060200                  MOVE SPACES TO IMPOE-POE-CTY-NM                 06320000
060300              END-IF                                              06330000
060400              MOVE IMPOE-POE-CTY-NM        TO ASC-POE-CITY-NAME   06340000
060500                                              APOEDESO            06350000
060600                                                                  06360000
060700              MOVE TR019-COUNTRY-CODE TO ASC-COUNTRY-CODE         06370000
060800                                         DK-COUNTRY-CODE          06380000
060900              PERFORM 4300-SELECT-COUNTRY-ACTIVE                  06390000
061000                                                                  06400000
061100              IF ASC-INVALID-COUNTRY-CODE                         06410000
061200**                  SET PS-ERROR                                  06420000
061300**                      DP020-MSG-FATAL   TO TRUE                 06430000
061400**                  MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER     06440000
061500**                  MOVE DP015-UNP-ALP-BRT-OFF                    06450000
061600**                                        TO ACNTCODA             06460000
061700**                  MOVE DP015-RED        TO ACNTCODC             06470000
061800**                  MOVE DP015-REVERSE    TO ACNTCODH             06480000
061900**                  MOVE -1               TO ACNTCODL             06490000
062000**                  SET DP030-SET-CURSOR-APPL-1 TO TRUE           06500000
062100                    MOVE SPACES           TO CNTRY-CNTRY-NM       06510000
062200                    PERFORM 4301-SELECT-COUNTRY-INACTIVE          06520000
062300**             ELSE                                               06530000
062400**                  MOVE DP015-GREEN              TO ACNTCODC     06540000
062500**                  MOVE DP015-BLUE               TO ACNTDESC     06550000
062600**                  MOVE DP015-UNP-ALP-BRT-OFF    TO ACNTCODA     06560000
062700**                  MOVE DP015-PRO-NOR-OFF        TO ACNTDESA     06570000
062800**                  MOVE DP015-HL-OFF             TO ACNTDESH     06580000
062900               END-IF                                             06590000
063000                                                                  06600000
063100              IF ASC-INACTIVE-COUNTRY-CODE                        06610000
063200**                  SET PS-ERROR                                  06620000
063300**                      DP020-MSG-FATAL   TO TRUE                 06630000
063400**                  MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER     06640000
063500**                  MOVE DP015-UNP-ALP-BRT-OFF                    06650000
063600**                                        TO ACNTCODA             06660000
063700**                  MOVE DP015-RED        TO ACNTCODC             06670000
063800**                  MOVE DP015-REVERSE    TO ACNTCODH             06680000
063900**                  MOVE -1               TO ACNTCODL             06690000
064000**                  SET DP030-SET-CURSOR-APPL-1 TO TRUE           06700000
064100                    MOVE SPACES           TO CNTRY-CNTRY-NM       06710000
064200               END-IF                                             06720000
064300             MOVE CNTRY-CNTRY-NM          TO ASC-COUNTRY-CODE-DESC06730000
064400                                             ACNTDESO             06740000
064500                                                                  06750000
064600             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CRIT-UPD06760000
064700                 IF  PS-NO-ERROR                                  06770000
064800                     SET ASC-UPD-PENDING                          06780000
064900                                   TO TRUE                        06790000
065000                     MOVE -1       TO AFOBCODL                    06800000
065100                 END-IF                                           06810000
065200             END-IF                                               06820000
065300                                                                  06830000
065400             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CRIT-DEL06840000
065500                 IF  PS-NO-ERROR                                  06850000
065600                     MOVE PC-TSYMSG-00004                         06860000
065700                                   TO DP020-MSG-NUMBER            06870000
065800                     SET ASC-DEL-PENDING                          06880000
065900                         DP020-MSG-INFORMATIONAL                  06890000
066000                                   TO TRUE                        06900000
066100                 END-IF                                           06910000
066200             END-IF                                               06920000
066300     END-EVALUATE.                                                06930000
066400                                                                  06940000
066500 1120-PREPARE-LIST-ENTRY.                                         06950000
066600                                                                  06960000
066700     MOVE TR021-MAX-ITEMS          TO ASC-SEL-SUB.                06970000
066800     MOVE ZERO                     TO ASC-SEL-ITEM.               06980000
066900                                                                  06990000
067000     PERFORM 2140-GET-NEXT-FOB-CODE.                              07000000
067100                                                                  07010000
067200         MOVE ASC-POE-CODE         TO DK-POE-CODE                 07020000
067300                                                                  07030000
067400         PERFORM 4150-OPEN-POE-CURSOR1                            07040000
067500         PERFORM 4154-FETCH-POE-CURSOR1                           07050000
067600         PERFORM 4152-CLOSE-POE-CURSOR1                           07060000
067700                                                                  07070000
067800                                                                  07080000
067900              IF ASC-INVALID-POE-CODE OR                          07090000
068000                 DK-POE-CODE = SPACE                              07100000
068100                                                                  07110000
068200                    SET PS-ERROR                                  07120000
068300                        DP020-MSG-FATAL   TO TRUE                 07130000
068400                    MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER     07140000
068500                    MOVE DP015-UNP-ALP-BRT-OFF                    07150000
068600                                          TO APOECODA             07160000
068700                    MOVE DP015-RED        TO APOECODC             07170000
068800                    MOVE DP015-REVERSE    TO APOECODH             07180000
068900                    MOVE -1               TO APOECODL             07190000
069000                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           07200000
069100                    MOVE SPACES           TO IMPOE-POE-CTY-NM     07210000
069200                    PERFORM 4160-OPEN-POE-CURSOR2                 07220000
069300                    PERFORM 4164-FETCH-POE-CURSOR2                07230000
069400                    PERFORM 4162-CLOSE-POE-CURSOR2                07240000
069500               END-IF.                                            07250000
069600*----------------------------------------------------------------*07260000
069700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*07270000
069800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*07280000
069900* EDITS.                                                         *07290000
070000*----------------------------------------------------------------*07300000
070100 2000-PROCESS-PANEL.                                              07310000
070200                                                                  07320000
070300     EVALUATE TRUE                                                07330000
070400                                                                  07340000
070500         WHEN DP020-SRC-AID = DP016-CLEAR                         07350000
070600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07360000
070700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07370000
070800                                                                  07380000
070900         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07390000
071000                                                                  07400000
071100              MOVE TR019-FOB-CODE     TO ASC-FOB-CODE             07410000
071200                                         DK-FOB-CODE              07420000
071300              PERFORM 4100-SELECT-FOB                             07430000
071400                                                                  07440000
071500              IF ASC-VALID-FOB-CODE AND                           07450000
071600                IMFOB-STAT-CDE = PC-I                             07460000
071700                   SET  ASC-DEL-COMPLETE   TO TRUE                07470000
071800              END-IF                                              07480000
071900                                                                  07490000
072000             IF  ASC-DEL-COMPLETE                                 07500000
072100                 MOVE PC-TSYMSG-00116                             07510000
072200                                   TO DP020-MSG-NUMBER            07520000
072300                 SET DP020-MSG-FATAL                              07530000
072400                     PS-ERROR      TO TRUE                        07540000
072500             ELSE                                                 07550000
072600                 SET DP030-CONTINUE-GO                            07560000
072700                                   TO TRUE                        07570000
072800                 PERFORM 7100-INACTIVATE-FOB                      07580000
072900                 PERFORM 7000-DEL-FOB-CODE                        07590000
073000             END-IF                                               07600000
073100                                                                  07610000
073200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07620000
073300                                                                  07630000
073400             SET TR019-RECORD-UPDATED TO TRUE                     07640000
073500                                                                  07650000
073600             PERFORM 3200-RESET-ATTRIBUTES                        07660000
073700                                                                  07670000
073800             MOVE -1                       TO AFOBCODL            07680000
073900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07690000
074000             MOVE ZEROES           TO DP020-MSG-NUMBER            07700000
074100             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND     07710000
074200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07720000
074300             MOVE ASC-CSTM-BKR-SCAC       TO DK-ENT-NAME (1:4)    07730000
074400                                                                  07740000
074500             PERFORM 4330-SELECT-ENTNME                           07750000
074600                                                                  07760000
074700             IF ENTNME-ENT-NAME-DESC = SPACES OR                  07770000
074800               ASC-CSTM-BKR-SCAC = SPACES OR                      07780000
074900               ASC-CSTM-BKR-SCAC = LOW-VALUES                     07790000
075000                   MOVE SPACES            TO ASC-CSTM-BKR-NAME    07800000
075100             ELSE                                                 07810000
075200                  MOVE ENTNME-ENT-ID     TO ASC-CSTM-BKR-ENT-ID   07820000
075300                  MOVE ENTNME-ENT-NAME-DESC TO ASC-CSTM-BKR-NAME  07830000
075400             END-IF                                               07840000
075500                                                                  07850000
075600             MOVE ASC-CSTM-BKR-NAME    TO ACSBRNOO                07860000
075700                                                                  07870000
075800             IF ASC-CONSLR-SCAC > SPACES OR                       07880000
075900                ASC-CONSLR-SCAC = SPACES                          07890000
076000                                                                  07900000
076100                 MOVE ASC-CONSLR-SCAC      TO DK-ENT-NAME (1:4)   07910000
076200                                                                  07920000
076300                 PERFORM 4330-SELECT-ENTNME                       07930000
076400                                                                  07940000
076500                IF ENTNME-ENT-NAME-DESC = SPACES OR               07950000
076600                  ASC-CONSLR-SCAC = SPACES OR                     07960000
076700                  ASC-CONSLR-SCAC = LOW-VALUES                    07970000
076800                    MOVE SPACES            TO ASC-CONSLR-NAME     07980000
076900                ELSE                                              07990000
077000                    MOVE ENTNME-ENT-ID     TO ASC-CONSLR-ENT-ID   08000000
077100                    MOVE ENTNME-ENT-NAME-DESC TO ASC-CONSLR-NAME  08010000
077200                END-IF                                            08020000
077300                    MOVE ASC-CONSLR-NAME      TO ACONSLNO         08030000
077400             END-IF                                               08040000
077500                                                                  08050000
077600             IF ASC-DECONL-SCAC > SPACES OR                       08060000
077700                ASC-DECONL-SCAC = SPACES                          08070000
077800                                                                  08080000
077900                 MOVE ASC-DECONL-SCAC      TO DK-ENT-NAME (1:4)   08090000
078000                                                                  08100000
078100                 PERFORM 4330-SELECT-ENTNME                       08110000
078200                                                                  08120000
078300                IF ENTNME-ENT-NAME-DESC = SPACES OR               08130000
078400                  ASC-CONSLR-SCAC = SPACES OR                     08140000
078500                  ASC-CONSLR-SCAC = LOW-VALUES                    08150000
078600                    MOVE SPACES            TO ASC-DECONL-NAME     08160000
078700                ELSE                                              08170000
078800                    MOVE ENTNME-ENT-ID     TO ASC-DECONL-ENT-ID   08180000
078900                    MOVE ENTNME-ENT-NAME-DESC TO ASC-DECONL-NAME  08190000
079000                END-IF                                            08200000
079100                    MOVE ASC-DECONL-NAME      TO ADECONNO         08210000
079200             END-IF                                               08220000
P5207              IF ASC-INCOTERM-CODE > SPACES OR                     08230000
P5207                 ASC-INCOTERM-CODE = SPACES                        08240000
P5207                                                                   08250000
P5207                  PERFORM 4332-SELECT-INCOTERM                     08261060
P5207                                                                   08270000
P5207                 IF DK-ATTR-ELEM-TXT-TEXT-D         = SPACES OR    08280000
P5207                   ASC-INCOTERM-CODE = SPACES OR                   08290000
P5207                   ASC-INCOTERM-CODE = LOW-VALUES                  08300000
P5207                     MOVE SPACES        TO ASC-INCOTERM-CODE-DESC  08310000
P5207                 ELSE                                              08320000
P5207                     MOVE DK-ATTR-ELEM-TXT-TEXT-D                  08330000
P5207                                TO ASC-INCOTERM-CODE-DESC          08340000
P5207                 END-IF                                            08350000
P5207                     MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO       08360000
P5207              END-IF                                               08370000
079300             PERFORM 4000-BUILD-INITIAL-PANEL                     08380000
079400****         PERFORM 3200-RESET-ATTRIBUTES                        08390000
079500****         PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08400000
079600                                                                  08410000
079700         WHEN OTHER                                               08420000
079800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08430000
079900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08440000
080000             IF  PS-NO-ERROR                                      08450000
080100                 PERFORM 2100-CHECK-FUNCTION-KEY                  08460000
080200                 SET DP030-CONTINUE-GO TO TRUE                    08470000
080300             ELSE                                                 08480000
080400                 SET DP030-OVERRIDE-GO TO TRUE                    08490000
080500             END-IF                                               08500000
080600     END-EVALUATE.                                                08510000
080700                                                                  08520000
080800 EJECT                                                            08530000
080900******************************************************************08540000
081000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **08550000
081100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **08560000
081200** FROM THE CICS ARCHITECTURE API.                              **08570000
081300******************************************************************08580000
081400 2100-CHECK-FUNCTION-KEY.                                         08590000
081500                                                                  08600000
081600     EVALUATE TRUE                                                08610000
081700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08620000
081800                                                                  08630000
081900             MOVE ASC-FOB-CODE         TO DK-FOB-CODE             08640000
082000                                                                  08650000
082100             PERFORM 4100-SELECT-FOB                              08660000
082200                                                                  08670000
082300              IF ASC-VALID-FOB-CODE                               08680000
082400                                                                  08690000
082500                 IF IMFOB-STAT-CDE = PC-A                         08700000
082600                    SET ASC-ADD-COMPLETE TO TRUE                  08710000
082700                 END-IF                                           08720000
082800                                                                  08730000
082900              END-IF                                              08740000
083000                                                                  08750000
083100             IF NOT ASC-ADD-COMPLETE                              08760000
083200                  IF DK-FOB-STAT-CDE = PC-I                       08770000
083300                       PERFORM 6010-ADD-INACTIVE-FOB              08780000
083400                  ELSE                                            08790000
083500                       PERFORM 5000-ADD-FOB-CODE                  08800000
083600                  END-IF                                          08810000
083700                  SET ASC-ADD-COMPLETE  TO TRUE                   08820000
083800***************************************************************   08830000
083900*********         THE FOB CODE HAS BEEN ADDED                     08840000
084000***************************************************************   08850000
084100                  MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER       08860000
084200                  SET ASC-ADD-FOB TO TRUE                         08870000
084300                  MOVE +1 TO TR019-NUMBER-OF-TS-ITEMS             08880000
084400                  PERFORM 3200-RESET-ATTRIBUTES                   08890000
084500***************************************************************   08900000
084600                  MOVE ASC-COUNTRY-CODE                           08910000
084700                                    TO TR019-COUNTRY-CODE         08920000
084800*                 MOVE ASC-COUNTRY-CODE-DESC                      08930000
084900*                                   TO TR019-COUNTRY-CODE-DESC    08940000
085000                  MOVE ASC-CONSLR-NAME                            08950000
085100                                    TO TR019-CONSLR-NAME          08960000
085200                  MOVE ASC-DECONL-NAME                            08970000
085300                                    TO TR019-DECONL-NAME          08980000
085400                  MOVE ASC-CSTM-BKR-NAME                          08990000
085500                                    TO TR019-CSTM-BKR-NAME        09000000
085600                  MOVE ASC-FOB-CODE                               09010000
085700                                    TO TR019-FOB-CODE             09020000
085800                  MOVE ASC-FOB-CITY-NAME                          09030000
085900                                    TO TR019-FOB-CITY-NAME        09040000
086000                  MOVE ASC-POE-CODE                               09050000
086100                                    TO TR019-POE-CODE             09060000
086200                  MOVE ASC-POE-CITY-NAME                          09070000
086300                                    TO TR019-POE-CITY-NAME        09080000
086400                  MOVE ASC-CONSLR-SCAC                            09090000
086500                                    TO TR019-CONSLR-SCAC          09100000
086600                  MOVE ASC-CONSLR-ENT-ID                          09110000
086700                                    TO TR019-CONSLR-ENT-ID        09120000
086800                  MOVE ASC-DECONL-SCAC                            09130000
086900                                    TO TR019-DECONL-SCAC          09140000
087000                  MOVE ASC-DECONL-ENT-ID                          09150000
087100                                    TO TR019-DECONL-ENT-ID        09160000
087200                  MOVE ASC-CSTM-BKR-SCAC                          09170000
087300                                    TO TR019-CSTM-BKR-SCAC        09180000
087400                  MOVE ASC-CSTM-BKR-ENT-ID                        09190000
087500                                    TO TR019-CSTM-BKR-ENT-ID      09200000
087600                  MOVE ASC-FOB-STD-EDI-CDE                        09210000
087700                                   TO TR019-FOB-STD-EDI-CDE       09220000
P5207                   MOVE ASC-INCOTERM-CODE                          09230000
P5207                                    TO TR019-INCOTERM-CODE         09240000
087800***************************************************************   09270000
087900                  SET DP020-MSG-INFORMATIONAL                     09280000
088000                                        TO TRUE                   09290000
088100                  PERFORM 2110-PREPARE-INTER-APPL-COMM            09300000
088200             ELSE                                                 09310000
088300                  MOVE PC-TSYMSG-00223  TO DP020-MSG-NUMBER       09320000
088400             END-IF                                               09330000
088500                                                                  09340000
088600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09350000
088700             PERFORM 6000-UPDATE-FOB                              09360000
088800             SET ASC-UPD-COMPLETE                                 09370000
088900                 ASC-COUNTRY-DESC-NOT-CHANGED TO TRUE             09380000
089000*********************************************************         09390000
089100*            THE FOB CODE HAS BEEN UPDATED                        09400000
089200*********************************************************         09410000
089300             MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER            09420000
089400             SET DP020-MSG-INFORMATIONAL                          09430000
089500                                   TO TRUE                        09440000
089600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 09450000
089700                                                                  09460000
089800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09470000
089900                                                                  09480000
090000             MOVE ASC-FOB-CODE         TO DK-FOB-CODE             09490000
090100                                                                  09500000
090200             PERFORM 4100-SELECT-FOB                              09510000
090300                                                                  09520000
090400              IF ASC-INVALID-FOB-CODE OR                          09530000
090500                 ASC-VALID-FOB-CODE                               09540000
090600                                                                  09550000
090700                 IF IMFOB-STAT-CDE = PC-I AND                     09560000
090800                    NOT ASC-DEL-COMPLETE                          09570000
090900                     SET PS-ERROR                                 09580000
091000                          DP020-MSG-FATAL   TO TRUE               09590000
091100                     MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER    09600000
091200                 ELSE                                             09610000
091300                     PERFORM 7000-DEL-FOB-CODE                    09620000
091400                     SET ASC-DEL-COMPLETE  TO TRUE                09630000
091500*********************************************************         09640000
091600****         THE FOB CODE HAS BEEN DELETED                        09650000
091700*********************************************************         09660000
091800                     MOVE PC-TSYMSG-00115  TO DP020-MSG-NUMBER    09670000
091900                     SET DP020-MSG-INFORMATIONAL                  09680000
092000                                           TO TRUE                09690000
092100                     PERFORM 2110-PREPARE-INTER-APPL-COMM         09700000
092200                 END-IF                                           09710000
092300              END-IF                                              09720000
092400         WHEN DP020-SRC-AID = DP016-ENTER                         09730000
092500             CONTINUE                                             09740000
092600                                                                  09750000
092700         WHEN OTHER                                               09760000
092800             SET DP013-NO-ROLLBACK                                09770000
092900                 DP013-XCTL-DISPLAY-RESTART                       09780000
093000                 DP013-CICS-ABEND  TO TRUE                        09790000
093100             MOVE '2100-CHECK-FUNCTION-KEY'                       09800000
093200                                   TO DP013-PARAGRAPH             09810000
093300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09820000
093400                                   TO DP013-MESSAGE-TEXT (1)      09830000
093500             PERFORM DP013-0000-PROCESS-ABEND                     09840000
093600     END-EVALUATE.                                                09850000
093700 EJECT                                                            09860000
093800******************************************************************09870000
093900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **09880000
094000** INTER-APPLICATION COMMAREA.                                  **09890000
094100******************************************************************09900000
094200 2110-PREPARE-INTER-APPL-COMM.                                    09910000
094300      MOVE ASC-COUNTRY-CODE TO TR019-COUNTRY-CODE.                09920000
094400      MOVE DK-FOB-STAT-CDE       TO TR019-STAT-CDE.               09930000
094500*     MOVE ASC-COUNTRY-CODE-DESC TO TR019-COUNTRY-CODE-DESC.      09940000
094600                                                                  09950000
094700                                                                  09960000
094800*-----------------------------------------------------------------09970000
094900*     GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         09980000
095000*     PROCESSED.                                                  09990000
095100*-----------------------------------------------------------------10000000
095200                                                                  10010000
095300  2140-GET-NEXT-FOB-CODE.                                         10020000
095400                                                                  10030000
095500      ADD +1                       TO ASC-SEL-SUB.                10040000
095600      IF  ASC-SEL-SUB > TR021-MAX-ITEMS                           10050000
095700          ADD +1                   TO ASC-SEL-ITEM                10060000
095800          MOVE +1                  TO ASC-SEL-SUB                 10070000
095900      END-IF.                                                     10080000
096000                                                                  10090000
096100      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS               10100000
096200          PERFORM 9100-READ-SEL-QUEUE                             10110000
096300          IF  TR021-ITEM (ASC-SEL-SUB) > ZERO                     10120000
096400              MOVE TR021-FOB-CNTRY-CODE (ASC-SEL-SUB)             10130000
096500                         TO   ASC-COUNTRY-CODE                    10140000
096600              MOVE TR021-FOB-CITY-NAME (ASC-SEL-SUB)              10150000
096700                         TO   ASC-FOB-CITY-NAME                   10160000
096800              MOVE TR021-CONSLR-SCAC (ASC-SEL-SUB)                10170000
096900                         TO   ASC-CONSLR-SCAC                     10180000
097000              MOVE TR021-CONSLR-ENT-ID (ASC-SEL-SUB)              10190000
097100                         TO   ASC-CONSLR-ENT-ID                   10200000
097200              MOVE TR021-DECONL-SCAC (ASC-SEL-SUB)                10210000
097300                         TO   ASC-DECONL-SCAC                     10220000
097400              MOVE TR021-DECONL-ENT-ID (ASC-SEL-SUB)              10230000
097500                         TO   ASC-DECONL-ENT-ID                   10240000
097600              MOVE TR021-CSTM-BKR-SCAC (ASC-SEL-SUB)              10250000
097700                         TO   ASC-CSTM-BKR-SCAC                   10260000
097800              MOVE TR021-CSTM-BKR-ENT-ID (ASC-SEL-SUB)            10270000
097900                         TO   ASC-CSTM-BKR-ENT-ID                 10280000
098000              MOVE TR021-POE-CODE (ASC-SEL-SUB)                   10290000
098100                         TO   ASC-POE-CODE                        10300000
098200              MOVE TR021-FOB-STD-EDI-CDE (ASC-SEL-SUB)            10310000
098300                         TO   ASC-FOB-STD-EDI-CDE                 10320000
P5207               MOVE TR021-INCOTERM-CODE (ASC-SEL-SUB)              10330000
P5207                          TO   ASC-INCOTERM-CODE                   10340000
098400              SET TR021-INQ (ASC-SEL-SUB) TO TRUE                 10350000
098500              PERFORM 9200-REWRITE-SEL-QUEUE                      10360000
098600          ELSE                                                    10370000
098700              SUBTRACT +1 FROM ASC-SEL-SUB                        10380000
098800*******************************************************           10390000
098900*            --- BOTTOM OF LIST ---                               10400000
099000*******************************************************           10410000
099100              MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER            10420000
099200              SET DP020-MSG-INFORMATIONAL TO TRUE                 10430000
099300              SET PS-LIST-END             TO TRUE                 10440000
099400          END-IF                                                  10450000
099500      ELSE                                                        10460000
099600          SUBTRACT +1 FROM ASC-SEL-ITEM                           10470000
099700          MOVE TR021-MAX-ITEMS     TO ASC-SEL-SUB                 10480000
099800          MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER            10490000
099900          SET DP020-MSG-INFORMATIONAL TO TRUE                     10500000
100000          SET PS-LIST-END             TO TRUE                     10510000
100100      END-IF.                                                     10520000
100200                                                                  10530000
100300*-----------------------------------------------------------------10540000
100400*     GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING     10550000
100500*     PROCESSED.                                                  10560000
100600*-----------------------------------------------------------------10570000
100700                                                                  10580000
100800  2150-GET-PREV-FOB-CODE.                                         10590000
100900                                                                  10600000
101000      SUBTRACT +1 FROM ASC-SEL-SUB.                               10610000
101100      IF  ASC-SEL-SUB < +1                                        10620000
101200          SUBTRACT +1 FROM ASC-SEL-ITEM                           10630000
101300          MOVE TR021-MAX-ITEMS     TO ASC-SEL-SUB                 10640000
101400      END-IF.                                                     10650000
101500                                                                  10660000
101600      IF  ASC-SEL-ITEM > ZERO                                     10670000
101700          PERFORM 9100-READ-SEL-QUEUE                             10680000
101800          MOVE TR021-FOB-CODE (ASC-SEL-SUB)                       10690000
101900              TO ASC-FOB-CODE                                     10700000
102000          MOVE TR021-FOB-CNTRY-CODE (ASC-SEL-SUB)                 10710000
102100                                   TO ASC-COUNTRY-CODE            10720000
102200          MOVE TR021-FOB-CNTRY-CODE (ASC-SEL-SUB)                 10730000
102300              TO ASC-COUNTRY-CODE                                 10740000
102400          MOVE TR021-FOB-CITY-NAME (ASC-SEL-SUB)                  10750000
102500              TO ASC-FOB-CITY-NAME                                10760000
102600          MOVE TR021-CONSLR-ENT-ID (ASC-SEL-SUB)                  10770000
102700              TO ASC-CONSLR-ENT-ID                                10780000
102800          MOVE TR021-DECONL-ENT-ID (ASC-SEL-SUB)                  10790000
102900              TO ASC-DECONL-ENT-ID                                10800000
103000          MOVE TR021-CSTM-BKR-ENT-ID (ASC-SEL-SUB)                10810000
103100              TO ASC-CSTM-BKR-ENT-ID                              10820000
103200          MOVE TR021-POE-CODE (ASC-SEL-SUB)                       10830000
103300              TO ASC-POE-CODE                                     10840000
103400          MOVE TR021-FOB-STD-EDI-CDE (ASC-SEL-SUB)                10850000
103500              TO ASC-FOB-STD-EDI-CDE                              10860000
P5207           MOVE TR021-INCOTERM-CODE (ASC-SEL-SUB)                  10870000
P5207               TO ASC-INCOTERM-CODE                                10880000
103600      ELSE                                                        10890000
103700          MOVE +1                  TO ASC-SEL-ITEM                10900000
103800                                      ASC-SEL-SUB                 10910000
103900*        --- TOP OF LIST ---                                      10920000
104000          MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER            10930000
104100          SET DP020-MSG-INFORMATIONAL TO TRUE                     10940000
104200          SET PS-LIST-END             TO TRUE                     10950000
104300      END-IF.                                                     10960000
104400                                                                  10970000
104500/                                                                 10980000
104600*----------------------------------------------------------------*10990000
104700*    GET THE FOB CODE OF THE PREVIOUS SELECTED                   *11000000
104800*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *11010000
104900*----------------------------------------------------------------*11020000
105000*----------------------------------------------------------------*11030000
105100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*11040000
105200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *11050000
105300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *11060000
105400*----------------------------------------------------------------*11070000
105500                                                                  11080000
105600 2200-MOVE-SCREEN-TO-COMMAREA.                                    11090000
105700                                                                  11100000
105800     IF  AFOBCODL > ZERO                                          11110000
105900         MOVE AFOBCODI             TO ASC-FOB-CODE                11120000
106000     ELSE                                                         11130000
106100         IF  AFOBCODF = DP015-ERASE-EOF                           11140000
106200             MOVE SPACE            TO ASC-FOB-CODE                11150000
106300         END-IF                                                   11160000
106400     END-IF.                                                      11170000
106500                                                                  11180000
106600     IF  AEDICODL > ZERO                                          11190000
106700         MOVE AEDICODI             TO ASC-FOB-STD-EDI-CDE         11200000
106800         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11210000
106900     ELSE                                                         11220000
107000         IF  AEDICODF = DP015-ERASE-EOF                           11230000
107100             MOVE SPACE            TO ASC-FOB-STD-EDI-CDE         11240000
107200             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11250000
107300         END-IF                                                   11260000
107400     END-IF.                                                      11270000
107500                                                                  11280000
107600     IF  AFOBCTYL > ZERO                                          11290000
107700         MOVE AFOBCTYI             TO ASC-FOB-CITY-NAME           11300000
107800     ELSE                                                         11310000
107900         IF  AFOBCTYF = DP015-ERASE-EOF                           11320000
108000             MOVE SPACE            TO ASC-FOB-CITY-NAME           11330000
108100         END-IF                                                   11340000
108200     END-IF.                                                      11350000
108300                                                                  11360000
108400     IF  ACNTCODL > ZERO                                          11370000
108500         MOVE ACNTCODI             TO ASC-COUNTRY-CODE            11380000
108600     ELSE                                                         11390000
108700         IF  ACNTCODF = DP015-ERASE-EOF                           11400000
108800             MOVE SPACE            TO ASC-COUNTRY-CODE            11410000
108900         END-IF                                                   11420000
109000     END-IF.                                                      11430000
109100                                                                  11440000
109200     IF  APOECODL > ZERO                                          11450000
109300         MOVE APOECODI             TO ASC-POE-CODE                11460000
109400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11470000
109500     ELSE                                                         11480000
109600         IF  APOECODF = DP015-ERASE-EOF                           11490000
109700             MOVE SPACE            TO ASC-POE-CODE                11500000
109800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11510000
109900         END-IF                                                   11520000
110000     END-IF.                                                      11530000
110100                                                                  11540000
110200     IF  ACNTDESL > ZERO                                          11550000
110300         MOVE ACNTDESI             TO ASC-COUNTRY-CODE-DESC       11560000
110400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11570000
110500     ELSE                                                         11580000
110600         IF  ACNTDESF = DP015-ERASE-EOF                           11590000
110700             MOVE SPACE            TO ASC-COUNTRY-CODE-DESC       11600000
110800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11610000
110900         END-IF                                                   11620000
111000     END-IF.                                                      11630000
111100                                                                  11640000
111200     IF  ACONSLCL > ZERO                                          11650000
111300         MOVE ACONSLCI             TO ASC-CONSLR-SCAC             11660000
111400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11670000
111500     ELSE                                                         11680000
111600         IF  ACONSLCF = DP015-ERASE-EOF                           11690000
111700             MOVE SPACE            TO ASC-CONSLR-SCAC             11700000
111800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11710000
111900         END-IF                                                   11720000
112000     END-IF.                                                      11730000
112100                                                                  11740000
112200     IF  ACSBRCOL > ZERO                                          11750000
112300         MOVE ACSBRCOI             TO ASC-CSTM-BKR-SCAC           11760000
112400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11770000
112500     ELSE                                                         11780000
112600         IF  ACSBRCOF = DP015-ERASE-EOF                           11790000
112700             MOVE SPACE            TO ASC-CSTM-BKR-SCAC           11800000
112800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11810000
112900         END-IF                                                   11820000
113000     END-IF.                                                      11830000
113100                                                                  11840000
113200     IF  ADECONCL > ZERO                                          11850000
113300         MOVE ADECONCI             TO ASC-DECONL-SCAC             11860000
113400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11870000
113500     ELSE                                                         11880000
113600         IF  ADECONCF = DP015-ERASE-EOF                           11890000
113700             MOVE SPACE            TO ASC-DECONL-SCAC             11900000
113800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 11910000
113900         END-IF                                                   11920000
114000     END-IF.                                                      11930000
114100                                                                  11940000
114200     IF  ACONSLNL > ZERO                                          11950000
114300         MOVE ACONSLNI             TO ASC-CSTM-BKR-SCAC           11960000
114400         SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     11970000
114500     ELSE                                                         11980000
114600         IF  ACONSLNF = DP015-ERASE-EOF                           11990000
114700             MOVE SPACE            TO ASC-CSTM-BKR-SCAC           12000000
114800             SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 12010000
114900         END-IF                                                   12020000
115000     END-IF.                                                      12030000
P5207                                                                   12040000
P5207      IF  AINCOTCL > ZERO                                          12050000
P5207          MOVE AINCOTCI             TO ASC-INCOTERM-CODE           12060000
P5207          SET ASC-COUNTRY-DESC-CHANGED TO TRUE                     12070000
P5207      ELSE                                                         12080000
P5207          IF  AINCOTCF = DP015-ERASE-EOF                           12090000
P5207              MOVE SPACE            TO ASC-INCOTERM-CODE           12100000
P5207              SET ASC-COUNTRY-DESC-CHANGED TO TRUE                 12110000
P5207          END-IF                                                   12120000
P5207      END-IF.                                                      12130000
115100                                                                  12140000
115200                                                                  12150000
115300*----------------------------------------------------------------*12160000
115400* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12170000
115500* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *12180000
115600* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12190000
115700*----------------------------------------------------------------*12200000
115800                                                                  12210000
115900 3000-EDIT-DATA-IN-COMMAREA.                                      12220000
116000                                                                  12230000
116100     PERFORM 3200-RESET-ATTRIBUTES.                               12240000
116200                                                                  12250000
116300     EVALUATE TRUE                                                12260000
116400         WHEN ASC-DEL-FROM-LIST                                   12270000
116500             PERFORM 3110-DEL-FROM-LIST                           12280000
116600                                                                  12290000
116700         WHEN ASC-UPD-FOB                                         12300000
116800             PERFORM 3120-UPD-FOB                                 12310000
116900                                                                  12320000
117000         WHEN ASC-DEL-FOB                                         12330000
117100             PERFORM 3140-DEL-FOB                                 12340000
117200                                                                  12350000
117300         WHEN ASC-ADD-FOB                                         12360000
117400             IF TR019-NUMBER-OF-TS-ITEMS < +1                     12370000
117500                 PERFORM 3150-ADD-FOB-NO-ITEMS                    12380000
117600             ELSE                                                 12390000
117700                 PERFORM 3160-ADD-FOB-WITH-ITEMS                  12400000
117800             END-IF                                               12410000
117900                                                                  12420000
118000         WHEN ASC-UPD-FOB                                         12430000
118100             CONTINUE                                             12440000
118200                                                                  12450000
118300         WHEN ASC-UPD-FROM-LIST                                   12460000
118400             PERFORM 3170-UPD-FROM-LIST                           12470000
118500                                                                  12480000
118600         WHEN ASC-ADD-FROM-LIST                                   12490000
118700             PERFORM 3180-ADD-FROM-LIST                           12500000
118800                                                                  12510000
118900     END-EVALUATE.                                                12520000
119000                                                                  12530000
119100     IF DP020-MSG-NUMBER > SPACES                                 12540000
119200        CONTINUE                                                  12550000
119300     ELSE                                                         12560000
119400       SET DP030-SET-CURSOR-APPL-1   TO TRUE                      12570000
119500       MOVE -1                       TO AFOBCODL                  12580000
119600     END-IF.                                                      12590000
119700                                                                  12600000
119800*----------------------------------------------------------------*12610000
119900* PERFORM EDITS ON EACH FIELD WHEN DATA COMES FROM A LIST        *12620000
120000*----------------------------------------------------------------*12630000
120100                                                                  12640000
120200 3110-DEL-FROM-LIST.                                              12650000
120300                                                                  12660000
120400     IF ASC-CSTM-BKR-SCAC > SPACES OR                             12670000
120500         ASC-CSTM-BKR-SCAC = SPACES                               12680000
120600                                                                  12690000
120700          MOVE ASC-CSTM-BKR-SCAC       TO DK-ENT-NAME (1:4)       12700000
120800                                                                  12710000
120900          PERFORM 4330-SELECT-ENTNME                              12720000
121000                                                                  12730000
121100         IF ENTNME-ENT-NAME-DESC = SPACES OR                      12740000
121200           ASC-CSTM-BKR-SCAC = SPACES OR                          12750000
121300           ASC-CSTM-BKR-SCAC = LOW-VALUES                         12760000
121400             MOVE DP015-BLUE            TO ACSBRCOC               12770000
121500             MOVE DP015-HL-OFF          TO ACSBRCOH               12780000
121600             MOVE DP015-PRO-NOR-OFF     TO ACSBRCOA               12790000
121700             MOVE SPACES                TO ASC-CSTM-BKR-NAME      12800000
121800             MOVE PC-TSYMSG-01450                                 12810000
121900                                   TO DP020-MSG-NUMBER            12820000
122000             MOVE -1                    TO ACSBRCOL               12830000
122100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12840000
122200             SET PS-ERROR               TO TRUE                   12850000
122300             SET DP020-MSG-FATAL        TO TRUE                   12860000
122400         ELSE                                                     12870000
122500             MOVE ENTNME-ENT-ID        TO ASC-CSTM-BKR-ENT-ID     12880000
122600             MOVE ENTNME-ENT-NAME-DESC TO ASC-CSTM-BKR-NAME       12890000
122700             MOVE DP015-BLUE           TO ACSBRCOC                12900000
122800             MOVE DP015-HL-OFF         TO ACSBRCOH                12910000
122900         END-IF                                                   12920000
123000                                                                  12930000
123100         MOVE ASC-CSTM-BKR-NAME    TO ACSBRNOO                    12940000
123200                                                                  12950000
123300     END-IF.                                                      12960000
123400                                                                  12970000
123500     IF ASC-CONSLR-SCAC > SPACES OR                               12980000
123600        ASC-CONSLR-SCAC = SPACES                                  12990000
123700                                                                  13000000
123800         MOVE ASC-CONSLR-SCAC      TO DK-ENT-NAME (1:4)           13010000
123900                                                                  13020000
124000         PERFORM 4330-SELECT-ENTNME                               13030000
124100                                                                  13040000
124200        IF ENTNME-ENT-NAME-DESC = SPACES OR                       13050000
124300          ASC-CONSLR-SCAC = SPACES OR                             13060000
124400          ASC-CONSLR-SCAC = LOW-VALUES                            13070000
124500            MOVE DP015-BLUE            TO ACONSLCC                13080000
124600            MOVE DP015-HL-OFF          TO ACONSLCH                13090000
124700            MOVE DP015-PRO-NOR-OFF     TO ACONSLCA                13100000
124800            MOVE SPACES                TO ASC-CONSLR-NAME         13110000
124900            MOVE PC-TSYMSG-01450                                  13120000
125000                               TO DP020-MSG-NUMBER                13130000
125100            MOVE -1                    TO ACONSLCL                13140000
125200            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   13150000
125300            SET PS-ERROR               TO TRUE                    13160000
125400            SET DP020-MSG-FATAL        TO TRUE                    13170000
125500        ELSE                                                      13180000
125600            MOVE ENTNME-ENT-ID        TO ASC-CONSLR-ENT-ID        13190000
125700            MOVE ENTNME-ENT-NAME-DESC TO ASC-CONSLR-NAME          13200000
125800            MOVE DP015-BLUE           TO ACONSLCC                 13210000
125900            MOVE DP015-HL-OFF         TO ACONSLCH                 13220000
126000        END-IF                                                    13230000
126100            MOVE ASC-CONSLR-NAME      TO ACONSLNO                 13240000
126200     END-IF.                                                      13250000
126300                                                                  13260000
126400     IF ASC-DECONL-SCAC > SPACES OR                               13270000
126500        ASC-DECONL-SCAC = SPACES                                  13280000
126600                                                                  13290000
126700         MOVE ASC-DECONL-SCAC      TO DK-ENT-NAME (1:4)           13300000
126800                                                                  13310000
126900         PERFORM 4330-SELECT-ENTNME                               13320000
127000                                                                  13330000
127100        IF ENTNME-ENT-NAME-DESC = SPACES OR                       13340000
127200          ASC-DECONL-SCAC = SPACES OR                             13350000
127300          ASC-DECONL-SCAC = LOW-VALUES                            13360000
127400            MOVE DP015-BLUE            TO ADECONCC                13370000
127500            MOVE DP015-HL-OFF          TO ADECONCH                13380000
127600            MOVE DP015-PRO-NOR-OFF     TO ADECONCA                13390000
127700            MOVE SPACES                TO ASC-DECONL-NAME         13400000
127800            MOVE PC-TSYMSG-01450                                  13410000
127900                               TO DP020-MSG-NUMBER                13420000
128000            MOVE -1                    TO ADECONCL                13430000
128100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   13440000
128200            SET PS-ERROR               TO TRUE                    13450000
128300            SET DP020-MSG-FATAL        TO TRUE                    13460000
128400        ELSE                                                      13470000
128500            MOVE ENTNME-ENT-ID        TO ASC-DECONL-ENT-ID        13480000
128600            MOVE ENTNME-ENT-NAME-DESC TO ASC-DECONL-NAME          13490000
128700            MOVE DP015-BLUE           TO ADECONCC                 13500000
128800            MOVE DP015-HL-OFF         TO ADECONCH                 13510000
128900        END-IF                                                    13520000
129000            MOVE ASC-DECONL-NAME      TO ADECONNO                 13530000
129100     END-IF.                                                      13540000
                                                                        13550000
P5207      IF ASC-INCOTERM-CODE > SPACES                                13571000
P5207                                                                   13580000
P5207          PERFORM 4332-SELECT-INCOTERM                             13591060
P5207                                                                   13600000
P5207         IF DK-ATTR-ELEM-TXT-TEXT-D         = SPACES OR            13610000
P5207           ASC-INCOTERM-CODE = SPACES OR                           13620000
P5207           ASC-INCOTERM-CODE = LOW-VALUES                          13630000
P5207             MOVE DP015-BLUE            TO AINCOTCC                13640000
P5207             MOVE DP015-HL-OFF          TO AINCOTCH                13650000
P5207             MOVE DP015-PRO-NOR-OFF     TO AINCOTCA                13660000
P5207             MOVE SPACES                TO ASC-INCOTERM-CODE-DESC  13670000
P5207             MOVE PC-TSYMSG-01450                                  13680000
P5207                                TO DP020-MSG-NUMBER                13690000
P5207             MOVE -1                    TO AINCOTCL                13700000
P5207             SET DP030-SET-CURSOR-APPL-1 TO TRUE                   13710000
P5207             SET PS-ERROR               TO TRUE                    13720000
P5207             SET DP020-MSG-FATAL        TO TRUE                    13730000
P5207         ELSE                                                      13740000
P5207             MOVE DK-ATTR-ELEM-TXT-TEXT-D                          13750000
P5207                  TO ASC-INCOTERM-CODE-DESC                        13760000
P5207             MOVE DP015-BLUE           TO AINCOTCC                 13770000
P5207             MOVE DP015-HL-OFF         TO AINCOTCH                 13780000
P5207         END-IF                                                    13790000
P5207             MOVE ASC-INCOTERM-CODE-DESC  TO AINCOTNO              13800000
P5207      ELSE                                                         13800200
P5207             MOVE SPACES                  TO AINCOTNO              13800300
P5207             MOVE DP015-BLUE           TO AINCOTCC                 13801000
P5207             MOVE DP015-HL-OFF         TO AINCOTCH                 13802000
P5207      END-IF.                                                      13810000
129200                                                                  13820000
129300     IF ASC-COUNTRY-CODE > SPACE OR                               13830000
129400       ASC-COUNTRY-CODE = SPACES                                  13840000
129500           MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE           13850000
129600                                                                  13860000
129700           PERFORM 4300-SELECT-COUNTRY-ACTIVE                     13870000
129800                                                                  13880000
129900            IF ASC-INVALID-COUNTRY-CODE                           13890000
130000               SET PS-ERROR                                       13900000
130100                   DP020-MSG-FATAL   TO TRUE                      13910000
130200               MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER          13920000
130300               MOVE DP015-UNP-ALP-BRT-OFF                         13930000
130400                                     TO ACNTCODA                  13940000
130500               MOVE DP015-RED        TO ACNTCODC                  13950000
130600               MOVE DP015-REVERSE    TO ACNTCODH                  13960000
130700               MOVE -1               TO ACNTCODL                  13970000
130800               SET DP030-SET-CURSOR-APPL-1 TO TRUE                13980000
130900               MOVE SPACES           TO CNTRY-CNTRY-NM            13990000
131000               PERFORM 4301-SELECT-COUNTRY-INACTIVE               14000000
131100            END-IF                                                14010000
131200                                                                  14020000
131300            IF ASC-INACTIVE-COUNTRY-CODE                          14030000
131400               SET PS-ERROR                                       14040000
131500                   DP020-MSG-FATAL   TO TRUE                      14050000
131600               MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER          14060000
131700               MOVE DP015-UNP-ALP-BRT-OFF                         14070000
131800                                     TO ACNTCODA                  14080000
131900               MOVE DP015-RED        TO ACNTCODC                  14090000
132000               MOVE DP015-REVERSE    TO ACNTCODH                  14100000
132100               MOVE -1               TO ACNTCODL                  14110000
132200               SET DP030-SET-CURSOR-APPL-1 TO TRUE                14120000
132300               MOVE SPACES           TO CNTRY-CNTRY-NM            14130000
132400            END-IF                                                14140000
132500     END-IF.                                                      14150000
132600                                                                  14160000
132700     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                14170000
132800                                     ACNTDESO.                    14180000
132900                                                                  14190000
133000 3120-UPD-FOB.                                                    14200000
133100                                                                  14210000
133200       IF ASC-CSTM-BKR-SCAC > SPACES OR                           14220000
133300          ASC-CSTM-BKR-SCAC = SPACES                              14230000
133400                                                                  14240000
133500          MOVE ASC-CSTM-BKR-SCAC       TO DK-ENT-NAME (1:4)       14250000
133600                                                                  14260000
133700          PERFORM 4330-SELECT-ENTNME                              14270000
133800                                                                  14280000
133900          IF ENTNME-ENT-NAME-DESC = SPACES OR                     14290000
134000           ASC-CSTM-BKR-SCAC = SPACES OR                          14300000
134100           ASC-CSTM-BKR-SCAC = LOW-VALUES                         14310000
134200             MOVE DP015-RED             TO ACSBRCOC               14320000
134300             MOVE DP015-REVERSE         TO ACSBRCOH               14330000
134400             MOVE DP015-UNP-ALP-BRT-OFF TO ACSBRCOA               14340000
134500             MOVE SPACES                TO ASC-CSTM-BKR-NAME      14350000
134600             MOVE PC-TSYMSG-01450                                 14360000
134700                                   TO DP020-MSG-NUMBER            14370000
134800             MOVE -1                    TO ACSBRCOL               14380000
134900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14390000
135000             SET PS-ERROR               TO TRUE                   14400000
135100             SET DP020-MSG-FATAL        TO TRUE                   14410000
135200          ELSE                                                    14420000
135300             MOVE ENTNME-ENT-ID        TO ASC-CSTM-BKR-ENT-ID     14430000
135400             MOVE ENTNME-ENT-NAME-DESC TO ASC-CSTM-BKR-NAME       14440000
135500             MOVE DP015-GREEN          TO ACSBRCOC                14450000
135600             MOVE DP015-UNDERLINE      TO ACSBRCOH                14460000
135700          END-IF                                                  14470000
135800                                                                  14480000
135900          MOVE ASC-CSTM-BKR-NAME    TO ACSBRNOO                   14490000
136000                                                                  14500000
136100     END-IF.                                                      14510000
136200                                                                  14520000
136300     IF ASC-CONSLR-SCAC > SPACES OR                               14530000
136400        ASC-CONSLR-SCAC = SPACES                                  14540000
136500                                                                  14550000
136600           MOVE ASC-CONSLR-SCAC      TO DK-ENT-NAME (1:4)         14560000
136700                                                                  14570000
136800           PERFORM 4330-SELECT-ENTNME                             14580000
136900                                                                  14590000
137000           IF ENTNME-ENT-NAME-DESC = SPACES OR                    14600000
137100            ASC-CONSLR-SCAC = SPACES OR                           14610000
137200            ASC-CONSLR-SCAC = LOW-VALUES                          14620000
137300              MOVE DP015-RED             TO ACONSLCC              14630000
137400              MOVE DP015-REVERSE         TO ACONSLCH              14640000
137500              MOVE DP015-UNP-ALP-BRT-OFF TO ACONSLCA              14650000
137600              MOVE SPACES                TO ASC-CONSLR-NAME       14660000
137700              MOVE PC-TSYMSG-01450                                14670000
137800                                 TO DP020-MSG-NUMBER              14680000
137900              MOVE -1                    TO ACONSLCL              14690000
138000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 14700000
138100              SET PS-ERROR               TO TRUE                  14710000
138200              SET DP020-MSG-FATAL        TO TRUE                  14720000
138300           ELSE                                                   14730000
138400              MOVE ENTNME-ENT-ID        TO ASC-CONSLR-ENT-ID      14740000
138500              MOVE ENTNME-ENT-NAME-DESC TO ASC-CONSLR-NAME        14750000
138600              MOVE DP015-GREEN          TO ACONSLCC               14760000
138700              MOVE DP015-UNDERLINE      TO ACONSLCH               14770000
138800           END-IF                                                 14780000
138900                                                                  14790000
139000              MOVE ASC-CONSLR-NAME      TO ACONSLNO               14800000
139100                                                                  14810000
139200       END-IF.                                                    14820000
139300                                                                  14830000
139400     IF ASC-DECONL-SCAC > SPACES OR                               14840000
139500        ASC-DECONL-SCAC = SPACES                                  14850000
139600                                                                  14860000
139700           MOVE ASC-DECONL-SCAC      TO DK-ENT-NAME (1:4)         14870000
139800                                                                  14880000
139900           PERFORM 4330-SELECT-ENTNME                             14890000
140000                                                                  14900000
140100           IF ENTNME-ENT-NAME-DESC = SPACES OR                    14910000
140200            ASC-DECONL-SCAC = SPACES OR                           14920000
140300            ASC-DECONL-SCAC = LOW-VALUES                          14930000
140400              MOVE DP015-RED             TO ADECONCC              14940000
140500              MOVE DP015-REVERSE         TO ADECONCH              14950000
140600              MOVE DP015-UNP-ALP-BRT-OFF TO ADECONCA              14960000
140700              MOVE SPACES                TO ASC-DECONL-NAME       14970000
140800              MOVE PC-TSYMSG-01450                                14980000
140900                                 TO DP020-MSG-NUMBER              14990000
141000              MOVE -1                    TO ADECONCL              15000000
141100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15010000
141200              SET PS-ERROR               TO TRUE                  15020000
141300              SET DP020-MSG-FATAL        TO TRUE                  15030000
141400           ELSE                                                   15040000
141500              MOVE ENTNME-ENT-ID        TO ASC-DECONL-ENT-ID      15050000
141600              MOVE ENTNME-ENT-NAME-DESC TO ASC-DECONL-NAME        15060000
141700              MOVE DP015-GREEN          TO ADECONCC               15070000
141800              MOVE DP015-UNDERLINE      TO ADECONCH               15080000
141900           END-IF                                                 15090000
142000                                                                  15100000
142100              MOVE ASC-DECONL-NAME      TO ADECONNO               15110000
142200                                                                  15120000
142300       END-IF.                                                    15130000
139300                                                                  15140000
P5207      IF ASC-INCOTERM-CODE > SPACES OR                             15150000
P5207         ASC-INCOTERM-CODE = SPACES                                15160000
P5207                                                                   15170000
P5207            PERFORM 4332-SELECT-INCOTERM                           15181060
P5207                                                                   15190000
P5207            IF DK-ATTR-ELEM-TXT-TEXT-D          = SPACES OR        15200000
P5207             ASC-INCOTERM-CODE = SPACES OR                         15210000
P5207             ASC-INCOTERM-CODE = LOW-VALUES                        15220000
P5207               MOVE DP015-RED             TO AINCOTCC              15230000
P5207               MOVE DP015-REVERSE         TO AINCOTCH              15240000
P5207               MOVE DP015-UNP-ALP-BRT-OFF TO AINCOTCA              15250000
P5207               MOVE SPACES               TO ASC-INCOTERM-CODE-DESC 15260000
P5207               MOVE PC-TSYMSG-01450                                15270000
P5207                                  TO DP020-MSG-NUMBER              15280000
P5207               MOVE -1                    TO AINCOTCL              15290000
P5207               SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15300000
P5207               SET PS-ERROR               TO TRUE                  15310000
P5207               SET DP020-MSG-FATAL        TO TRUE                  15320000
P5207            ELSE                                                   15330000
P5207               MOVE DK-ATTR-ELEM-TXT-TEXT-D                        15340000
P5207                      TO ASC-INCOTERM-CODE-DESC                    15350000
P5207               MOVE DP015-GREEN          TO AINCOTCC               15360000
P5207               MOVE DP015-UNDERLINE      TO AINCOTCH               15370000
P5207            END-IF                                                 15380000
P5207                                                                   15390000
P5207               MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO             15400000
P5207                                                                   15410000
P5207        END-IF.                                                    15420000
142400                                                                  15430000
142500     IF ASC-POE-CODE  > SPACES                                    15440000
142600                                                                  15450000
142700          MOVE ASC-POE-CODE         TO DK-POE-CODE                15460000
142800                                                                  15470000
142900          PERFORM 4150-OPEN-POE-CURSOR1                           15480000
143000          PERFORM 4154-FETCH-POE-CURSOR1                          15490000
143100          PERFORM 4152-CLOSE-POE-CURSOR1                          15500000
143200                                                                  15510000
143300           IF ASC-INVALID-POE-CODE OR                             15520000
143400              DK-POE-CODE = SPACE                                 15530000
143500               SET PS-ERROR                                       15540000
143600                   DP020-MSG-FATAL   TO TRUE                      15550000
143700               MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER          15560000
143800               MOVE DP015-UNP-ALP-BRT-OFF                         15570000
143900                                     TO APOECODA                  15580000
144000               MOVE DP015-RED        TO APOECODC                  15590000
144100               MOVE DP015-REVERSE    TO APOECODH                  15600000
144200               MOVE -1               TO APOECODL                  15610000
144300               SET DP030-SET-CURSOR-APPL-1 TO TRUE                15620000
144400               MOVE SPACES           TO IMPOE-POE-CTY-NM          15630000
144500               PERFORM 4160-OPEN-POE-CURSOR2                      15640000
144600               PERFORM 4164-FETCH-POE-CURSOR2                     15650000
144700               PERFORM 4162-CLOSE-POE-CURSOR2                     15660000
144800          END-IF                                                  15670000
144900                                                                  15680000
145000          IF ASC-INACTIVE-POE-CODE                                15690000
145100             SET PS-ERROR                                         15700000
145200                 DP020-MSG-FATAL   TO TRUE                        15710000
145300             MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER            15720000
145400             MOVE DP015-UNP-ALP-BRT-OFF                           15730000
145500                                   TO APOECODA                    15740000
145600             MOVE DP015-RED        TO APOECODC                    15750000
145700             MOVE DP015-REVERSE    TO APOECODH                    15760000
145800             MOVE -1               TO APOECODL                    15770000
145900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15780000
146000             MOVE SPACES           TO IMPOE-POE-CTY-NM            15790000
146100          ELSE                                                    15800000
146200             IF ASC-INVALID-POE-CODE                              15810000
146300                   SET PS-ERROR                                   15820000
146400                       DP020-MSG-FATAL   TO TRUE                  15830000
146500                   MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER      15840000
146600                   MOVE DP015-UNP-ALP-BRT-OFF                     15850000
146700                                         TO APOECODA              15860000
146800                   MOVE DP015-RED        TO APOECODC              15870000
146900                   MOVE DP015-REVERSE    TO APOECODH              15880000
147000                   MOVE -1               TO APOECODL              15890000
147100                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            15900000
147200                   MOVE SPACES           TO IMPOE-POE-CTY-NM      15910000
147300             END-IF                                               15920000
147400          END-IF                                                  15930000
147500      ELSE                                                        15940000
147600            SET PS-ERROR                                          15950000
147700                DP020-MSG-FATAL   TO TRUE                         15960000
147800            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             15970000
147900            MOVE DP015-UNP-ALP-BRT-OFF                            15980000
148000                                  TO APOECODA                     15990000
148100            MOVE DP015-RED        TO APOECODC                     16000000
148200            MOVE DP015-REVERSE    TO APOECODH                     16010000
148300            MOVE -1               TO APOECODL                     16020000
148400            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   16030000
148500            MOVE SPACES           TO IMPOE-POE-CTY-NM             16040000
148600      END-IF.                                                     16050000
148700                                                                  16060000
148800      MOVE IMPOE-POE-CTY-NM        TO ASC-POE-CITY-NAME           16070000
148900                                      APOEDESO.                   16080000
149000                                                                  16090000
149100     IF ASC-COUNTRY-CODE > SPACE OR                               16100000
149200       ASC-COUNTRY-CODE = SPACES                                  16110000
149300           MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE           16120000
149400                                                                  16130000
149500           PERFORM 4300-SELECT-COUNTRY-ACTIVE                     16140000
149600                                                                  16150000
149700            IF ASC-INVALID-COUNTRY-CODE                           16160000
149800               SET PS-ERROR                                       16170000
149900                   DP020-MSG-FATAL   TO TRUE                      16180000
150000               MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER          16190000
150100               MOVE DP015-UNP-ALP-BRT-OFF                         16200000
150200                                     TO ACNTCODA                  16210000
150300               MOVE DP015-RED        TO ACNTCODC                  16220000
150400               MOVE DP015-REVERSE    TO ACNTCODH                  16230000
150500               MOVE -1               TO ACNTCODL                  16240000
150600               SET DP030-SET-CURSOR-APPL-1 TO TRUE                16250000
150700               MOVE SPACES           TO CNTRY-CNTRY-NM            16260000
150800               PERFORM 4301-SELECT-COUNTRY-INACTIVE               16270000
150900            END-IF                                                16280000
151000                                                                  16290000
151100            IF ASC-INACTIVE-COUNTRY-CODE                          16300000
151200               SET PS-ERROR                                       16310000
151300                   DP020-MSG-FATAL   TO TRUE                      16320000
151400               MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER          16330000
151500               MOVE DP015-UNP-ALP-BRT-OFF                         16340000
151600                                     TO ACNTCODA                  16350000
151700               MOVE DP015-RED        TO ACNTCODC                  16360000
151800               MOVE DP015-REVERSE    TO ACNTCODH                  16370000
151900               MOVE -1               TO ACNTCODL                  16380000
152000               SET DP030-SET-CURSOR-APPL-1 TO TRUE                16390000
152100               MOVE SPACES           TO CNTRY-CNTRY-NM            16400000
152200            END-IF                                                16410000
152300     END-IF.                                                      16420000
152400                                                                  16430000
152500     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                16440000
152600                                     ACNTDESO.                    16450000
152700                                                                  16460000
152800     IF ASC-FOB-CITY-NAME = SPACES                                16470000
152900         SET PS-ERROR                                             16480000
153000             DP020-MSG-FATAL   TO TRUE                            16490000
153100         MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER                16500000
153200         MOVE DP015-UNP-ALP-BRT-OFF                               16510000
153300                               TO AFOBCTYA                        16520000
153400         MOVE DP015-RED        TO AFOBCTYC                        16530000
153500         MOVE DP015-REVERSE    TO AFOBCTYH                        16540000
153600         MOVE -1               TO AFOBCTYL                        16550000
153700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16560000
153800     ELSE                                                         16570000
153900         MOVE DP015-GREEN      TO AFOBCTYC                        16580000
154000         MOVE DP015-UNDERLINE  TO AFOBCTYH                        16590000
154100     END-IF.                                                      16600000
154200                                                                  16610000
154300     IF ASC-FOB-STD-EDI-CDE = SPACES                              16620000
154400                                                                  16630000
154500           SET PS-ERROR                                           16640000
154600               DP020-MSG-FATAL   TO TRUE                          16650000
154700           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              16660000
154800           MOVE DP015-UNP-ALP-BRT-OFF                             16670000
154900                                 TO AEDICODA                      16680000
155000           MOVE DP015-RED        TO AEDICODC                      16690000
155100           MOVE DP015-REVERSE    TO AEDICODH                      16700000
155200           MOVE -1               TO AEDICODL                      16710000
155300           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16720000
155400     ELSE                                                         16730000
155500           MOVE DP015-GREEN      TO AEDICODC                      16740000
155600           MOVE DP015-UNDERLINE  TO AEDICODH                      16750000
155700     END-IF.                                                      16760000
155800                                                                  16770000
155900 3140-DEL-FOB.                                                    16780000
156000                                                                  16790000
156100     MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE                 16800000
156200     MOVE ASC-COUNTRY-CODE-DESC    TO ACNTDESO                    16810000
156300                                                                  16820000
156400     IF ASC-COUNTRY-CODE-DESC = SPACE                             16830000
156500          SET PS-ERROR                                            16840000
156600              DP020-MSG-FATAL   TO TRUE                           16850000
156700          MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER               16860000
156800          MOVE DP015-UNP-ALP-BRT-OFF                              16870000
156900                                TO ACNTCODA                       16880000
157000          MOVE DP015-PRO-NOR-OFF                                  16890000
157100                                TO ACNTDESA                       16900000
157200          SET DP030-SET-CURSOR-APPL-1   TO TRUE                   16910000
157300          MOVE -1       TO ACNTCODL                               16920000
157400     END-IF.                                                      16930000
157500                                                                  16940000
157600 3150-ADD-FOB-NO-ITEMS.                                           16950000
157700                                                                  16960000
157800     IF ASC-CSTM-BKR-SCAC > SPACES OR                             16970000
157900           ASC-CSTM-BKR-SCAC = SPACES                             16980000
158000                                                                  16990000
158100           MOVE ASC-CSTM-BKR-SCAC        TO DK-ENT-NAME (1:4)     17000000
158200                                                                  17010000
158300           PERFORM 4330-SELECT-ENTNME                             17020000
158400                                                                  17030000
158500        IF ENTNME-ENT-NAME-DESC = SPACES OR                       17040000
158600           ASC-CSTM-BKR-SCAC = SPACES OR                          17050000
158700           ASC-CSTM-BKR-SCAC = LOW-VALUES                         17060000
158800                MOVE DP015-RED             TO ACSBRCOC            17070000
158900                MOVE DP015-REVERSE         TO ACSBRCOH            17080000
159000                MOVE DP015-UNP-ALP-BRT-OFF TO ACSBRCOA            17090000
159100                MOVE SPACES                TO ASC-CSTM-BKR-NAME   17100000
159200                MOVE PC-TSYMSG-01450                              17110000
159300                                    TO DP020-MSG-NUMBER           17120000
159400                MOVE -1                    TO ACSBRCOL            17130000
159500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               17140000
159600                SET PS-ERROR               TO TRUE                17150000
159700                SET DP020-MSG-FATAL        TO TRUE                17160000
159800        ELSE                                                      17170000
159900                MOVE ENTNME-ENT-ID         TO ASC-CSTM-BKR-ENT-ID 17180000
160000                                            TR019-CSTM-BKR-ENT-ID 17190000
160100                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CSTM-BKR-NAME   17200000
160200                MOVE DP015-GREEN           TO ACSBRCOC            17210000
160300                MOVE DP015-UNDERLINE       TO ACSBRCOH            17220000
160400        END-IF                                                    17230000
160500                                                                  17240000
160600      MOVE ASC-CSTM-BKR-NAME     TO ACSBRNOO                      17250000
160700                                                                  17260000
160800     END-IF.                                                      17270000
160900                                                                  17280000
161000     IF ASC-CONSLR-SCAC > SPACES OR                               17290000
161100        ASC-CONSLR-SCAC = SPACES                                  17300000
161200                                                                  17310000
161300             MOVE ASC-CONSLR-SCAC         TO DK-ENT-NAME (1:4)    17320000
161400                                                                  17330000
161500             PERFORM 4330-SELECT-ENTNME                           17340000
161600                                                                  17350000
161700           IF ENTNME-ENT-NAME-DESC = SPACES OR                    17360000
161800              ASC-CONSLR-SCAC = SPACES OR                         17370000
161900              ASC-CONSLR-SCAC = LOW-VALUES                        17380000
162000                MOVE DP015-RED             TO ACONSLCC            17390000
162100                MOVE DP015-REVERSE         TO ACONSLCH            17400000
162200                MOVE DP015-UNP-ALP-BRT-OFF TO ACONSLCA            17410000
162300                MOVE SPACE                 TO ASC-CONSLR-NAME     17420000
162400                MOVE PC-TSYMSG-01450                              17430000
162500                                    TO DP020-MSG-NUMBER           17440000
162600                MOVE -1                    TO ACONSLCL            17450000
162700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               17460000
162800                SET PS-ERROR               TO TRUE                17470000
162900                SET DP020-MSG-FATAL        TO TRUE                17480000
163000           ELSE                                                   17490000
163100                MOVE ENTNME-ENT-ID         TO ASC-CONSLR-ENT-ID   17500000
163200                                            TR019-CONSLR-ENT-ID   17510000
163300                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CONSLR-NAME     17520000
163400                MOVE DP015-GREEN           TO ACONSLCC            17530000
163500                MOVE DP015-UNDERLINE       TO ACONSLCH            17540000
163600           END-IF                                                 17550000
163700                                                                  17560000
163800        MOVE ASC-CONSLR-NAME       TO ACONSLNO                    17570000
163900                                                                  17580000
164000     END-IF.                                                      17590000
164100                                                                  17600000
164200     IF ASC-DECONL-SCAC > SPACES OR                               17610000
164300        ASC-DECONL-SCAC = SPACES                                  17620000
164400                                                                  17630000
164500             MOVE ASC-DECONL-SCAC         TO DK-ENT-NAME (1:4)    17640000
164600                                                                  17650000
164700             PERFORM 4330-SELECT-ENTNME                           17660000
164800                                                                  17670000
164900           IF ENTNME-ENT-NAME-DESC = SPACES OR                    17680000
165000              ASC-DECONL-SCAC = SPACES OR                         17690000
165100              ASC-DECONL-SCAC = LOW-VALUES                        17700000
165200                MOVE DP015-RED             TO ADECONCC            17710000
165300                MOVE DP015-REVERSE         TO ADECONCH            17720000
165400                MOVE DP015-UNP-ALP-BRT-OFF TO ADECONCA            17730000
165500                MOVE SPACE                 TO ASC-DECONL-NAME     17740000
165600                MOVE PC-TSYMSG-01450                              17750000
165700                                    TO DP020-MSG-NUMBER           17760000
165800                MOVE -1                    TO ADECONCL            17770000
165900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               17780000
166000                SET PS-ERROR               TO TRUE                17790000
166100                SET DP020-MSG-FATAL        TO TRUE                17800000
166200           ELSE                                                   17810000
166300                MOVE ENTNME-ENT-ID         TO ASC-DECONL-ENT-ID   17820000
166400                                            TR019-DECONL-ENT-ID   17830000
166500                MOVE ENTNME-ENT-NAME-DESC  TO ASC-DECONL-NAME     17840000
166600                MOVE DP015-GREEN           TO ADECONCC            17850000
166700                MOVE DP015-UNDERLINE       TO ADECONCH            17860000
166800           END-IF                                                 17870000
166900                                                                  17880000
167000        MOVE ASC-DECONL-NAME       TO ADECONNO                    17890000
167100                                                                  17900000
167200     END-IF.                                                      17910000
164100                                                                  17920000
P5207      IF ASC-INCOTERM-CODE > SPACES OR                             17930000
P5207         ASC-INCOTERM-CODE = SPACES                                17940000
P5207                                                                   17950000
P5207              PERFORM 4332-SELECT-INCOTERM                         17961060
P5207                                                                   17970000
P5207            IF DK-ATTR-ELEM-TXT-TEXT-D           = SPACES OR       17980000
P5207               ASC-INCOTERM-CODE = SPACES OR                       17990000
P5207               ASC-INCOTERM-CODE = LOW-VALUES                      18000000
P5207                 MOVE DP015-RED             TO AINCOTCC            18010000
P5207                 MOVE DP015-REVERSE         TO AINCOTCH            18020000
P5207                 MOVE DP015-UNP-ALP-BRT-OFF TO AINCOTCA            18030000
P5207                 MOVE SPACES         TO ASC-INCOTERM-CODE-DESC     18040056
P5207                 MOVE PC-TSYMSG-01450                              18050000
P5207                                     TO DP020-MSG-NUMBER           18060000
P5207                 MOVE -1                    TO AINCOTCL            18070000
P5207                 SET DP030-SET-CURSOR-APPL-1 TO TRUE               18080000
P5207                 SET PS-ERROR               TO TRUE                18090000
P5207                 SET DP020-MSG-FATAL        TO TRUE                18100000
P5207            ELSE                                                   18110000
P5207                 MOVE ASC-INCOTERM-CODE                            18120000
P5207                                         TO  TR019-INCOTERM-CODE   18130000
P5207                 MOVE DK-ATTR-ELEM-TXT-TEXT-D                      18140000
P5207                      TO ASC-INCOTERM-CODE-DESC                    18150000
P5207                 MOVE DP015-GREEN           TO AINCOTCC            18160000
P5207                 MOVE DP015-UNDERLINE       TO AINCOTCH            18170000
P5207            END-IF                                                 18180000
P5207                                                                   18190000
P5207         MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO                   18200000
P5207                                                                   18210000
P5207      END-IF.                                                      18220000
167300                                                                  18230000
167400                                                                  18240000
167500     IF ASC-POE-CODE  > SPACES                                    18250000
167600                                                                  18260000
167700          MOVE ASC-POE-CODE         TO DK-POE-CODE                18270000
167800                                    TR019-POE-CODE                18280000
167900                                                                  18290000
168000          PERFORM 4150-OPEN-POE-CURSOR1                           18300000
168100          PERFORM 4154-FETCH-POE-CURSOR1                          18310000
168200          PERFORM 4152-CLOSE-POE-CURSOR1                          18320000
168300                                                                  18330000
168400           IF ASC-INVALID-POE-CODE OR                             18340000
168500              DK-POE-CODE = SPACE                                 18350000
168600               SET PS-ERROR                                       18360000
168700                   DP020-MSG-FATAL   TO TRUE                      18370000
168800               MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER          18380000
168900               MOVE DP015-UNP-ALP-BRT-OFF                         18390000
169000                                     TO APOECODA                  18400000
169100               MOVE DP015-RED        TO APOECODC                  18410000
169200               MOVE DP015-REVERSE    TO APOECODH                  18420000
169300               MOVE -1               TO APOECODL                  18430000
169400               SET DP030-SET-CURSOR-APPL-1 TO TRUE                18440000
169500               MOVE SPACES           TO IMPOE-POE-CTY-NM          18450000
169600               PERFORM 4160-OPEN-POE-CURSOR2                      18460000
169700               PERFORM 4164-FETCH-POE-CURSOR2                     18470000
169800               PERFORM 4162-CLOSE-POE-CURSOR2                     18480000
169900          END-IF                                                  18490000
170000                                                                  18500000
170100          IF ASC-INACTIVE-POE-CODE                                18510000
170200             SET PS-ERROR                                         18520000
170300                 DP020-MSG-FATAL   TO TRUE                        18530000
170400             MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER            18540000
170500             MOVE DP015-UNP-ALP-BRT-OFF                           18550000
170600                                   TO APOECODA                    18560000
170700             MOVE DP015-RED        TO APOECODC                    18570000
170800             MOVE DP015-REVERSE    TO APOECODH                    18580000
170900             MOVE -1               TO APOECODL                    18590000
171000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18600000
171100             MOVE SPACES           TO IMPOE-POE-CTY-NM            18610000
171200          ELSE                                                    18620000
171300             IF ASC-INVALID-POE-CODE                              18630000
171400                   SET PS-ERROR                                   18640000
171500                       DP020-MSG-FATAL   TO TRUE                  18650000
171600                   MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER      18660000
171700                   MOVE DP015-UNP-ALP-BRT-OFF                     18670000
171800                                         TO APOECODA              18680000
171900                   MOVE DP015-RED        TO APOECODC              18690000
172000                   MOVE DP015-REVERSE    TO APOECODH              18700000
172100                   MOVE -1               TO APOECODL              18710000
172200                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            18720000
172300                   MOVE SPACES           TO IMPOE-POE-CTY-NM      18730000
172400             END-IF                                               18740000
172500          END-IF                                                  18750000
172600      ELSE                                                        18760000
172700            SET PS-ERROR                                          18770000
172800                DP020-MSG-FATAL   TO TRUE                         18780000
172900            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             18790000
173000            MOVE DP015-UNP-ALP-BRT-OFF                            18800000
173100                                  TO APOECODA                     18810000
173200            MOVE DP015-RED        TO APOECODC                     18820000
173300            MOVE DP015-REVERSE    TO APOECODH                     18830000
173400            MOVE -1               TO APOECODL                     18840000
173500            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   18850000
173600            MOVE SPACES           TO IMPOE-POE-CTY-NM             18860000
173700     END-IF.                                                      18870000
173800                                                                  18880000
173900     MOVE IMPOE-POE-CTY-NM        TO ASC-POE-CITY-NAME            18890000
174000                                     APOEDESO.                    18900000
174100                                                                  18910000
174200     IF ASC-COUNTRY-CODE > SPACE OR                               18920000
174300        ASC-COUNTRY-CODE = SPACE                                  18930000
174400                                                                  18940000
174500          MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE            18950000
174600                                       TR019-COUNTRY-CODE         18960000
174700                                                                  18970000
174800          PERFORM 4300-SELECT-COUNTRY-ACTIVE                      18980000
174900                                                                  18990000
175000          IF ASC-INVALID-COUNTRY-CODE OR                          19000000
175100             ASC-COUNTRY-CODE = SPACE                             19010000
175200                 SET PS-ERROR                                     19020000
175300                     DP020-MSG-FATAL   TO TRUE                    19030000
175400                 MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER        19040000
175500                 MOVE DP015-UNP-ALP-BRT-OFF                       19050000
175600                                       TO ACNTCODA                19060000
175700                 MOVE DP015-RED        TO ACNTCODC                19070000
175800                 MOVE DP015-REVERSE    TO ACNTCODH                19080000
175900                 MOVE -1               TO ACNTCODL                19090000
176000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19100000
176100                 MOVE SPACES           TO CNTRY-CNTRY-NM          19110000
176200                 PERFORM 4301-SELECT-COUNTRY-INACTIVE             19120000
176300          END-IF                                                  19130000
176400                                                                  19140000
176500          IF ASC-INACTIVE-COUNTRY-CODE                            19150000
176600                 SET PS-ERROR                                     19160000
176700                     DP020-MSG-FATAL   TO TRUE                    19170000
176800                 MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER        19180000
176900                 MOVE DP015-UNP-ALP-BRT-OFF                       19190000
177000                                       TO ACNTCODA                19200000
177100                 MOVE DP015-RED        TO ACNTCODC                19210000
177200                 MOVE DP015-REVERSE    TO ACNTCODH                19220000
177300                 MOVE -1               TO ACNTCODL                19230000
177400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19240000
177500                 MOVE SPACES           TO CNTRY-CNTRY-NM          19250000
177600          END-IF                                                  19260000
177700                                                                  19270000
177800       MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC              19280000
177900                               ACNTDESO                           19290000
178000     END-IF.                                                      19300000
178100                                                                  19310000
178200     MOVE ASC-FOB-CITY-NAME TO TR019-FOB-CITY-NAME                19320000
178300                                                                  19330000
178400     IF ASC-FOB-CITY-NAME = SPACES                                19340000
178500          SET PS-ERROR                                            19350000
178600              DP020-MSG-FATAL   TO TRUE                           19360000
178700          MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER               19370000
178800          MOVE DP015-UNP-ALP-BRT-OFF  TO AFOBCTYA                 19380000
178900          MOVE DP015-RED        TO AFOBCTYC                       19390000
179000          MOVE DP015-REVERSE    TO AFOBCTYH                       19400000
179100          MOVE -1               TO AFOBCTYL                       19410000
179200          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     19420000
179300     ELSE                                                         19430000
179400          MOVE DP015-GREEN      TO AFOBCTYC                       19440000
179500          MOVE DP015-UNDERLINE  TO AFOBCTYH                       19450000
179600     END-IF.                                                      19460000
179700                                                                  19470000
179800     MOVE ASC-FOB-STD-EDI-CDE TO TR019-FOB-STD-EDI-CDE            19480000
179900                                                                  19490000
180000     IF ASC-FOB-STD-EDI-CDE = SPACES                              19500000
180100          SET PS-ERROR                                            19510000
180200              DP020-MSG-FATAL   TO TRUE                           19520000
180300          MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER               19530000
180400          MOVE DP015-UNP-ALP-BRT-OFF TO AEDICODA                  19540000
180500          MOVE DP015-RED        TO AEDICODC                       19550000
180600          MOVE DP015-REVERSE    TO AEDICODH                       19560000
180700          MOVE -1               TO AEDICODL                       19570000
180800          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     19580000
180900     ELSE                                                         19590000
181000          MOVE DP015-GREEN      TO AEDICODC                       19600000
181100          MOVE DP015-UNDERLINE  TO AEDICODH                       19610000
181200     END-IF.                                                      19620000
                                                                        19630000
181400     IF ASC-FOB-CODE > SPACE                                      19640000
181500                                                                  19650000
181600            MOVE ASC-FOB-CODE         TO DK-FOB-CODE              19660000
181700                                         TR019-FOB-CODE           19670000
181800            PERFORM 4100-SELECT-FOB                               19680000
181900                                                                  19690000
182000          IF ASC-VALID-FOB-CODE                                   19700000
182100              IF IMFOB-STAT-CDE = PC-I                            19710000
182200                  SET PS-NO-ERROR TO TRUE                         19720000
182300                  MOVE ZEROES           TO AFOBCODL               19730000
182400                                           AEDICODL               19740000
182500                                           AFOBCTYL               19750000
182600                                           APOEDESL               19760000
182700                                           ACNTCODL               19770000
182800                                           ACONSLCL               19780000
182900                                           ADECONCL               19790000
183000                                           ACSBRCOL               19800000
183100                                           APOECODL               19810000
P5207                                            AINCOTCL               19820000
183200                  PERFORM 3200-RESET-ATTRIBUTES                   19830000
183300                  PERFORM 3300-OVERLAY-ADD-DATA                   19840000
183400                  MOVE +1               TO                        19850000
183500                                        TR019-NUMBER-OF-TS-ITEMS  19860000
183600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             19870000
183700              ELSE                                                19880000
183800                   SET PS-ERROR                                   19890000
183900                       DP020-MSG-FATAL   TO TRUE                  19900000
184000                   MOVE PC-TSYMSG-01646  TO DP020-MSG-NUMBER      19910000
184100                   MOVE DP015-UNP-ALP-BRT-OFF                     19920000
184200                                         TO AFOBCODA              19930000
184300                   MOVE DP015-RED        TO AFOBCODC              19940000
184400                   MOVE DP015-REVERSE    TO AFOBCODH              19950000
184500                   MOVE -1               TO AFOBCODL              19960000
184600                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            19970000
184700              END-IF                                              19980000
184800          ELSE                                                    19990000
184900                                                                  20000000
185000          MOVE DP015-UNDERLINE  TO AFOBCODH                       20010000
185100                                                                  20020000
185200          END-IF                                                  20030000
185300     ELSE                                                         20040000
185400            SET PS-ERROR                                          20050000
185500                DP020-MSG-FATAL   TO TRUE                         20060000
185600            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             20070000
185700            MOVE DP015-UNP-ALP-BRT-OFF                            20080000
185800                                  TO AFOBCODA                     20090000
185900            MOVE DP015-RED        TO AFOBCODC                     20100000
186000            MOVE DP015-REVERSE    TO AFOBCODH                     20110000
186100            MOVE -1               TO AFOBCODL                     20120000
186200            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   20130000
186300     END-IF.                                                      20140000
186400                                                                  20150000
186500 3160-ADD-FOB-WITH-ITEMS.                                         20160000
186600                                                                  20170000
186700                                                                  20180000
186800     IF ASC-CSTM-BKR-SCAC > SPACES OR                             20190000
186900        ASC-CSTM-BKR-SCAC = SPACES                                20200000
187000                                                                  20210000
187100           MOVE ASC-CSTM-BKR-SCAC        TO DK-ENT-NAME (1:4)     20220000
187200                                                                  20230000
187300           PERFORM 4330-SELECT-ENTNME                             20240000
187400                                                                  20250000
187500          IF ENTNME-ENT-NAME-DESC = SPACES OR                     20260000
187600             ASC-CSTM-BKR-SCAC = SPACES OR                        20270000
187700             ASC-CSTM-BKR-SCAC = LOW-VALUES                       20280000
187800                MOVE DP015-RED             TO ACSBRCOC            20290000
187900                MOVE DP015-REVERSE         TO ACSBRCOH            20300000
188000                MOVE DP015-UNP-ALP-BRT-OFF TO ACSBRCOA            20310000
188100                MOVE SPACES                TO ASC-CSTM-BKR-NAME   20320000
188200                MOVE PC-TSYMSG-01450                              20330000
188300                                    TO DP020-MSG-NUMBER           20340000
188400                MOVE -1                    TO ACSBRCOL            20350000
188500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20360000
188600                SET PS-ERROR               TO TRUE                20370000
188700                SET DP020-MSG-FATAL        TO TRUE                20380000
188800          ELSE                                                    20390000
188900                MOVE ENTNME-ENT-ID         TO ASC-CSTM-BKR-ENT-ID 20400000
189000                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CSTM-BKR-NAME   20410000
189100                MOVE DP015-BLUE            TO ACSBRCOC            20420000
189200                MOVE DP015-HL-OFF          TO ACSBRCOH            20430000
189300          END-IF                                                  20440000
189400                MOVE ASC-CSTM-BKR-NAME     TO ACSBRNOO            20450000
189500     END-IF.                                                      20460000
189600                                                                  20470000
189700     IF ASC-CONSLR-SCAC > SPACES OR                               20480000
189800        ASC-CONSLR-SCAC = SPACES                                  20490000
189900                                                                  20500000
190000           MOVE ASC-CONSLR-SCAC         TO DK-ENT-NAME (1:4)      20510000
190100                                                                  20520000
190200           PERFORM 4330-SELECT-ENTNME                             20530000
190300                                                                  20540000
190400          IF ENTNME-ENT-NAME-DESC = SPACES OR                     20550000
190500             ASC-CONSLR-SCAC = SPACES OR                          20560000
190600             ASC-CONSLR-SCAC = LOW-VALUES                         20570000
190700                MOVE DP015-RED             TO ACONSLCC            20580000
190800                MOVE DP015-REVERSE         TO ACONSLCH            20590000
190900                MOVE DP015-UNP-ALP-BRT-OFF TO ACONSLCA            20600000
191000                MOVE SPACES                TO ASC-CONSLR-NAME     20610000
191100                MOVE PC-TSYMSG-01450                              20620000
191200                                    TO DP020-MSG-NUMBER           20630000
191300                MOVE -1                    TO ACONSLCL            20640000
191400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20650000
191500                SET PS-ERROR               TO TRUE                20660000
191600                SET DP020-MSG-FATAL        TO TRUE                20670000
191700          ELSE                                                    20680000
191800                MOVE ENTNME-ENT-ID         TO ASC-CONSLR-ENT-ID   20690000
191900                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CONSLR-NAME     20700000
192000                MOVE DP015-BLUE            TO ACONSLCC            20710000
192100                MOVE DP015-HL-OFF          TO ACONSLCH            20720000
192200          END-IF                                                  20730000
192300                MOVE ASC-CONSLR-NAME       TO ACONSLNO            20740000
192400     END-IF.                                                      20750000
192500                                                                  20760000
192600                                                                  20770000
192700     IF ASC-DECONL-SCAC > SPACES OR                               20780000
192800        ASC-DECONL-SCAC = SPACES                                  20790000
192900                                                                  20800000
193000           MOVE ASC-DECONL-SCAC         TO DK-ENT-NAME (1:4)      20810000
193100                                                                  20820000
193200           PERFORM 4330-SELECT-ENTNME                             20830000
193300                                                                  20840000
193400          IF ENTNME-ENT-NAME-DESC = SPACES OR                     20850000
193500             ASC-DECONL-SCAC = SPACES OR                          20860000
193600             ASC-DECONL-SCAC = LOW-VALUES                         20870000
193700                MOVE DP015-RED             TO ADECONCC            20880000
193800                MOVE DP015-REVERSE         TO ADECONCH            20890000
193900                MOVE DP015-UNP-ALP-BRT-OFF TO ADECONCA            20900000
194000                MOVE SPACES                TO ASC-DECONL-NAME     20910000
194100                MOVE PC-TSYMSG-01450                              20920000
194200                                    TO DP020-MSG-NUMBER           20930000
194300                MOVE -1                    TO ADECONCL            20940000
194400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20950000
194500                SET PS-ERROR               TO TRUE                20960000
194600                SET DP020-MSG-FATAL        TO TRUE                20970000
194700          ELSE                                                    20980000
194800                MOVE ENTNME-ENT-ID         TO ASC-DECONL-ENT-ID   20990000
194900                MOVE ENTNME-ENT-NAME-DESC  TO ASC-DECONL-NAME     21000000
195000                MOVE DP015-BLUE            TO ADECONCC            21010000
195100                MOVE DP015-HL-OFF          TO ADECONCH            21020000
195200          END-IF                                                  21030000
195300                MOVE ASC-DECONL-NAME       TO ADECONNO            21040000
195400     END-IF.                                                      21050000
192600                                                                  21060000
P5207      IF ASC-INCOTERM-CODE > SPACES OR                             21070000
P5207         ASC-INCOTERM-CODE = SPACES                                21080000
P5207                                                                   21090000
P5207            PERFORM 4332-SELECT-INCOTERM                           21101060
P5207                                                                   21110000
P5207           IF DK-ATTR-ELEM-TXT-TEXT-D = SPACES OR                  21120000
P5207              ASC-INCOTERM-CODE = SPACES OR                        21130000
P5207              ASC-INCOTERM-CODE = LOW-VALUES                       21140000
P5207                 MOVE DP015-RED             TO AINCOTCC            21150000
P5207                 MOVE DP015-REVERSE         TO AINCOTCH            21160000
P5207                 MOVE DP015-UNP-ALP-BRT-OFF TO AINCOTCA            21170000
P5207                 MOVE SPACES      TO ASC-INCOTERM-CODE-DESC        21180000
P5207                 MOVE PC-TSYMSG-01450                              21190000
P5207                                     TO DP020-MSG-NUMBER           21200000
P5207                 MOVE -1                    TO AINCOTCL            21210000
P5207                 SET DP030-SET-CURSOR-APPL-1 TO TRUE               21220000
P5207                 SET PS-ERROR               TO TRUE                21230000
P5207                 SET DP020-MSG-FATAL        TO TRUE                21240000
P5207           ELSE                                                    21250000
P5207                 MOVE DK-ATTR-ELEM-TXT-TEXT-D                      21260000
P5207                      TO ASC-INCOTERM-CODE-DESC                    21270000
P5207                 MOVE DP015-BLUE            TO AINCOTCC            21280000
P5207                 MOVE DP015-HL-OFF          TO AINCOTCH            21290000
P5207           END-IF                                                  21300000
P5207                 MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO           21310000
P5207      END-IF.                                                      21320000
195500                                                                  21330000
195600                                                                  21340000
195700     IF ASC-POE-CODE  > SPACES                                    21350000
195800                                                                  21360000
195900          MOVE ASC-POE-CODE         TO DK-POE-CODE                21370000
196000                                                                  21380000
196100          PERFORM 4150-OPEN-POE-CURSOR1                           21390000
196200          PERFORM 4154-FETCH-POE-CURSOR1                          21400000
196300          PERFORM 4152-CLOSE-POE-CURSOR1                          21410000
196400                                                                  21420000
196500           IF ASC-INVALID-POE-CODE OR                             21430000
196600              DK-POE-CODE = SPACE                                 21440000
196700               SET PS-ERROR                                       21450000
196800                   DP020-MSG-FATAL   TO TRUE                      21460000
196900               MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER          21470000
197000               MOVE DP015-UNP-ALP-BRT-OFF                         21480000
197100                                     TO APOECODA                  21490000
197200               MOVE DP015-RED        TO APOECODC                  21500000
197300               MOVE DP015-REVERSE    TO APOECODH                  21510000
197400               MOVE -1               TO APOECODL                  21520000
197500               SET DP030-SET-CURSOR-APPL-1 TO TRUE                21530000
197600               MOVE SPACES           TO IMPOE-POE-CTY-NM          21540000
197700               PERFORM 4160-OPEN-POE-CURSOR2                      21550000
197800               PERFORM 4164-FETCH-POE-CURSOR2                     21560000
197900               PERFORM 4162-CLOSE-POE-CURSOR2                     21570000
198000          END-IF                                                  21580000
198100                                                                  21590000
198200          IF ASC-INACTIVE-POE-CODE                                21600000
198300             SET PS-ERROR                                         21610000
198400                 DP020-MSG-FATAL   TO TRUE                        21620000
198500             MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER            21630000
198600             MOVE DP015-UNP-ALP-BRT-OFF                           21640000
198700                                   TO APOECODA                    21650000
198800             MOVE DP015-RED        TO APOECODC                    21660000
198900             MOVE DP015-REVERSE    TO APOECODH                    21670000
199000             MOVE -1               TO APOECODL                    21680000
199100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21690000
199200             MOVE SPACES           TO IMPOE-POE-CTY-NM            21700000
199300          ELSE                                                    21710000
199400             IF ASC-INVALID-POE-CODE                              21720000
199500                   SET PS-ERROR                                   21730000
199600                       DP020-MSG-FATAL   TO TRUE                  21740000
199700                   MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER      21750000
199800                   MOVE DP015-UNP-ALP-BRT-OFF                     21760000
199900                                         TO APOECODA              21770000
200000                   MOVE DP015-RED        TO APOECODC              21780000
200100                   MOVE DP015-REVERSE    TO APOECODH              21790000
200200                   MOVE -1               TO APOECODL              21800000
200300                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            21810000
200400                   MOVE SPACES           TO IMPOE-POE-CTY-NM      21820000
200500             END-IF                                               21830000
200600          END-IF                                                  21840000
200700      ELSE                                                        21850000
200800            SET PS-ERROR                                          21860000
200900                DP020-MSG-FATAL   TO TRUE                         21870000
201000            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             21880000
201100            MOVE DP015-UNP-ALP-BRT-OFF                            21890000
201200                                  TO APOECODA                     21900000
201300            MOVE DP015-RED        TO APOECODC                     21910000
201400            MOVE DP015-REVERSE    TO APOECODH                     21920000
201500            MOVE -1               TO APOECODL                     21930000
201600            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   21940000
201700            MOVE SPACES           TO IMPOE-POE-CTY-NM             21950000
201800      END-IF.                                                     21960000
201900                                                                  21970000
202000      MOVE IMPOE-POE-CTY-NM        TO ASC-POE-CITY-NAME           21980000
202100                                      APOEDESO.                   21990000
202200                                                                  22000000
202300     IF ASC-COUNTRY-CODE > SPACE OR                               22010000
202400        ASC-COUNTRY-CODE = SPACE                                  22020000
202500                                                                  22030000
202600           MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE           22040000
202700                                                                  22050000
202800           PERFORM 4300-SELECT-COUNTRY-ACTIVE                     22060000
202900                                                                  22070000
203000          IF ASC-INVALID-COUNTRY-CODE                             22080000
203100                SET PS-ERROR                                      22090000
203200                    DP020-MSG-FATAL   TO TRUE                     22100000
203300                MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER         22110000
203400                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            22120000
203500                MOVE DP015-RED        TO ACNTCODC                 22130000
203600                MOVE DP015-REVERSE    TO ACNTCODH                 22140000
203700                MOVE -1               TO ACNTCODL                 22150000
203800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               22160000
203900                MOVE SPACES           TO CNTRY-CNTRY-NM           22170000
204000                PERFORM 4301-SELECT-COUNTRY-INACTIVE              22180000
204100          END-IF                                                  22190000
204200                                                                  22200000
204300          IF ASC-INACTIVE-COUNTRY-CODE                            22210000
204400                SET PS-ERROR                                      22220000
204500                    DP020-MSG-FATAL   TO TRUE                     22230000
204600                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         22240000
204700                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            22250000
204800                MOVE DP015-RED        TO ACNTCODC                 22260000
204900                MOVE DP015-REVERSE    TO ACNTCODH                 22270000
205000                MOVE -1               TO ACNTCODL                 22280000
205100                SET DP030-SET-CURSOR-APPL-1 TO TRUE               22290000
205200                MOVE SPACES           TO CNTRY-CNTRY-NM           22300000
205300          END-IF                                                  22310000
205400     END-IF.                                                      22320000
205500                                                                  22330000
205600     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                22340000
205700                             ACNTDESO.                            22350000
205800                                                                  22360000
205900     IF ASC-FOB-CITY-NAME = SPACES                                22370000
206000           SET PS-ERROR                                           22380000
206100               DP020-MSG-FATAL   TO TRUE                          22390000
206200           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              22400000
206300           MOVE DP015-UNP-ALP-BRT-OFF TO AFOBCTYA                 22410000
206400           MOVE DP015-RED        TO AFOBCTYC                      22420000
206500           MOVE DP015-REVERSE    TO AFOBCTYH                      22430000
206600           MOVE -1               TO AFOBCTYL                      22440000
206700           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    22450000
206800     ELSE                                                         22460000
206900           MOVE DP015-BLUE       TO AFOBCTYC                      22470000
207000           MOVE DP015-HL-OFF     TO AFOBCTYH                      22480000
207100     END-IF.                                                      22490000
207200                                                                  22500000
207300     IF ASC-FOB-STD-EDI-CDE = SPACES                              22510000
207400           SET PS-ERROR                                           22520000
207500               DP020-MSG-FATAL   TO TRUE                          22530000
207600           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              22540000
207700           MOVE DP015-UNP-ALP-BRT-OFF  TO AEDICODA                22550000
207800           MOVE DP015-RED              TO AEDICODC                22560000
207900           MOVE DP015-REVERSE          TO AEDICODH                22570000
208000           MOVE -1                     TO AEDICODL                22580000
208100           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    22590000
208200     ELSE                                                         22600000
208300           MOVE DP015-BLUE             TO AEDICODC                22610000
208400           MOVE DP015-HL-OFF           TO AEDICODH                22620000
208500     END-IF.                                                      22630000
208600                                                                  22640000
208700     IF ASC-FOB-CODE > SPACE                                      22650000
208800                                                                  22660000
208900           MOVE ASC-FOB-CODE         TO DK-FOB-CODE               22670000
209000                                                                  22680000
209100           PERFORM 4100-SELECT-FOB                                22690000
209200                                                                  22700000
209300          IF ASC-INVALID-FOB-CODE OR                              22710000
209400             ASC-FOB-CODE = SPACE                                 22720000
209500                                                                  22730000
209600               SET PS-ERROR                                       22740000
209700                   DP020-MSG-FATAL   TO TRUE                      22750000
209800               MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER          22760000
209900               MOVE DP015-UNP-ALP-BRT-OFF TO AFOBCODA             22770000
210000               MOVE DP015-RED        TO AFOBCODC                  22780000
210100               MOVE DP015-REVERSE    TO AFOBCODH                  22790000
210200               MOVE -1               TO AFOBCODL                  22800000
210300               SET DP030-SET-CURSOR-APPL-1 TO TRUE                22810000
210400          ELSE                                                    22820000
210500               MOVE DP015-HL-OFF     TO AFOBCODH                  22830000
210600          END-IF                                                  22840000
210700     ELSE                                                         22850000
210800            SET PS-ERROR                                          22860000
210900                DP020-MSG-FATAL   TO TRUE                         22870000
211000            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             22880000
211100            MOVE DP015-UNP-ALP-BRT-OFF                            22890000
211200                                  TO AFOBCODA                     22900000
211300            MOVE DP015-RED        TO AFOBCODC                     22910000
211400            MOVE DP015-REVERSE    TO AFOBCODH                     22920000
211500            MOVE -1               TO AFOBCODL                     22930000
211600            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   22940000
211700     END-IF.                                                      22950000
211800                                                                  22960000
211900 3170-UPD-FROM-LIST.                                              22970000
212000                                                                  22980000
212100     IF ASC-COUNTRY-CODE > SPACE OR                               22990000
212200       ASC-COUNTRY-CODE = SPACE                                   23000000
212300           MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE           23010000
212400                                                                  23020000
212500           PERFORM 4300-SELECT-COUNTRY-ACTIVE                     23030000
212600                                                                  23040000
212700          IF ASC-INVALID-COUNTRY-CODE                             23050000
212800                SET PS-ERROR                                      23060000
212900                    DP020-MSG-FATAL   TO TRUE                     23070000
213000                MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER         23080000
213100                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            23090000
213200                MOVE DP015-RED        TO ACNTCODC                 23100000
213300                MOVE DP015-REVERSE    TO ACNTCODH                 23110000
213400                MOVE -1               TO ACNTCODL                 23120000
213500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23130000
213600                MOVE SPACES           TO CNTRY-CNTRY-NM           23140000
213700                PERFORM 4301-SELECT-COUNTRY-INACTIVE              23150000
213800          END-IF                                                  23160000
213900                                                                  23170000
214000          IF ASC-INACTIVE-COUNTRY-CODE                            23180000
214100                SET PS-ERROR                                      23190000
214200                    DP020-MSG-FATAL   TO TRUE                     23200000
214300                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         23210000
214400                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            23220000
214500                MOVE DP015-RED        TO ACNTCODC                 23230000
214600                MOVE DP015-REVERSE    TO ACNTCODH                 23240000
214700                MOVE -1               TO ACNTCODL                 23250000
214800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23260000
214900                MOVE SPACES           TO CNTRY-CNTRY-NM           23270000
215000          END-IF                                                  23280000
215100     END-IF.                                                      23290000
215200                                                                  23300000
215300     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                23310000
215400                             ACNTDESO                             23320000
215500                                                                  23330000
215600     IF ASC-POE-CODE  > SPACES OR                                 23340000
215700        ASC-POE-CODE  = SPACES                                    23350000
215800           MOVE ASC-POE-CODE         TO DK-POE-CODE               23360000
215900                                                                  23370000
216000           PERFORM 4150-OPEN-POE-CURSOR1                          23380000
216100           PERFORM 4154-FETCH-POE-CURSOR1                         23390000
216200           PERFORM 4152-CLOSE-POE-CURSOR1                         23400000
216300                                                                  23410000
216400          IF ASC-INVALID-POE-CODE OR                              23420000
216500             DK-POE-CODE = SPACES                                 23430000
216600                SET PS-ERROR                                      23440000
216700                    DP020-MSG-FATAL   TO TRUE                     23450000
216800                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         23460000
216900                MOVE DP015-UNP-ALP-BRT-OFF    TO APOECODA         23470000
217000                MOVE DP015-RED        TO APOECODC                 23480000
217100                MOVE DP015-REVERSE    TO APOECODH                 23490000
217200                MOVE -1               TO APOECODL                 23500000
217300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23510000
217400                MOVE SPACES           TO IMPOE-POE-CTY-NM         23520000
217500                PERFORM 4160-OPEN-POE-CURSOR2                     23530000
217600                PERFORM 4164-FETCH-POE-CURSOR2                    23540000
217700                PERFORM 4162-CLOSE-POE-CURSOR2                    23550000
217800          END-IF                                                  23560000
217900                                                                  23570000
218000          IF ASC-INACTIVE-POE-CODE                                23580000
218100                SET PS-ERROR                                      23590000
218200                    DP020-MSG-FATAL   TO TRUE                     23600000
218300                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         23610000
218400                MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA           23620000
218500                MOVE DP015-RED        TO APOECODC                 23630000
218600                MOVE DP015-REVERSE    TO APOECODH                 23640000
218700                MOVE -1               TO APOECODL                 23650000
218800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               23660000
218900                MOVE SPACES           TO IMPOE-POE-CTY-NM         23670000
219000          END-IF                                                  23680000
219100     END-IF.                                                      23690000
219200                                                                  23700000
219300     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                23710000
219400                             ACNTDESO                             23720000
219500                                                                  23730000
219600     IF ASC-FOB-CITY-NAME = SPACES                                23740000
219700           SET PS-ERROR                                           23750000
219800               DP020-MSG-FATAL   TO TRUE                          23760000
219900           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              23770000
220000           MOVE DP015-UNP-ALP-BRT-OFF TO AFOBCTYA                 23780000
220100           MOVE DP015-RED        TO AFOBCTYC                      23790000
220200           MOVE DP015-REVERSE    TO AFOBCTYH                      23800000
220300           MOVE -1               TO AFOBCTYL                      23810000
220400           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    23820000
220500     END-IF.                                                      23830000
220600                                                                  23840000
220700     IF ASC-CONSLR-SCAC > SPACES OR                               23850000
220800        ASC-CONSLR-SCAC = SPACES                                  23860000
220900                                                                  23870000
221000           MOVE ASC-CONSLR-SCAC      TO DK-ENT-NAME (1:4)         23880000
221100                                                                  23890000
221200           PERFORM 4330-SELECT-ENTNME                             23900000
221300                                                                  23910000
221400          IF ENTNME-ENT-NAME-DESC = SPACES OR                     23920000
221500             ASC-CONSLR-SCAC = SPACES OR                          23930000
221600             ASC-CONSLR-SCAC = LOW-VALUES                         23940000
221700                MOVE DP015-RED             TO ACONSLCC            23950000
221800                MOVE DP015-REVERSE         TO ACONSLCH            23960000
221900                MOVE DP015-UNP-ALP-BRT-OFF TO ACONSLCA            23970000
222000                MOVE SPACES                TO ASC-CONSLR-NAME     23980000
222100                MOVE PC-TSYMSG-01450                              23990000
222200                                   TO DP020-MSG-NUMBER            24000000
222300                MOVE -1                    TO ACONSLCL            24010000
222400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24020000
222500                SET PS-ERROR               TO TRUE                24030000
222600                SET DP020-MSG-FATAL        TO TRUE                24040000
222700          ELSE                                                    24050000
222800                MOVE ENTNME-ENT-ID        TO ASC-CONSLR-ENT-ID    24060000
222900                MOVE ENTNME-ENT-NAME-DESC TO ASC-CONSLR-NAME      24070000
223000                MOVE DP015-GREEN          TO ACONSLCC             24080000
223100                MOVE DP015-UNDERLINE      TO ACONSLCH             24090000
223200          END-IF                                                  24100000
223300                                                                  24110000
223400          MOVE ASC-CONSLR-NAME      TO ACONSLNO                   24120000
223500                                                                  24130000
223600     END-IF.                                                      24140000
223700                                                                  24150000
223800     IF ASC-DECONL-SCAC > SPACES OR                               24160000
223900        ASC-DECONL-SCAC = SPACES                                  24170000
224000                                                                  24180000
224100           MOVE ASC-DECONL-SCAC      TO DK-ENT-NAME (1:4)         24190000
224200                                                                  24200000
224300           PERFORM 4330-SELECT-ENTNME                             24210000
224400                                                                  24220000
224500          IF ENTNME-ENT-NAME-DESC = SPACES OR                     24230000
224600             ASC-DECONL-SCAC = SPACES OR                          24240000
224700             ASC-DECONL-SCAC = LOW-VALUES                         24250000
224800                MOVE DP015-RED             TO ADECONCC            24260000
224900                MOVE DP015-REVERSE         TO ADECONCH            24270000
225000                MOVE DP015-UNP-ALP-BRT-OFF TO ADECONCA            24280000
225100                MOVE SPACES                TO ASC-DECONL-NAME     24290000
225200                MOVE PC-TSYMSG-01450                              24300000
225300                                   TO DP020-MSG-NUMBER            24310000
225400                MOVE -1                    TO ADECONCL            24320000
225500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24330000
225600                SET PS-ERROR               TO TRUE                24340000
225700                SET DP020-MSG-FATAL        TO TRUE                24350000
225800          ELSE                                                    24360000
225900                MOVE ENTNME-ENT-ID        TO ASC-DECONL-ENT-ID    24370000
226000                MOVE ENTNME-ENT-NAME-DESC TO ASC-DECONL-NAME      24380000
226100                MOVE DP015-GREEN          TO ADECONCC             24390000
226200                MOVE DP015-UNDERLINE      TO ADECONCH             24400000
226300          END-IF                                                  24410000
226400                                                                  24420000
226500          MOVE ASC-DECONL-NAME      TO ADECONNO                   24430000
226600                                                                  24440000
226700     END-IF.                                                      24450000
223700                                                                  24460000
P5207      IF ASC-INCOTERM-CODE > SPACES OR                             24470000
P5207         ASC-INCOTERM-CODE = SPACES                                24480000
P5207                                                                   24490000
P5207            PERFORM 4332-SELECT-INCOTERM                           24501060
P5207                                                                   24510000
P5207           IF DK-ATTR-ELEM-TXT-TEXT-D = SPACES OR                  24520000
P5207              ASC-INCOTERM-CODE = SPACES OR                        24530000
P5207              ASC-INCOTERM-CODE = LOW-VALUES                       24540000
P5207                 MOVE DP015-RED             TO AINCOTCC            24550000
P5207                 MOVE DP015-REVERSE         TO AINCOTCH            24560000
P5207                 MOVE DP015-UNP-ALP-BRT-OFF TO AINCOTCA            24570000
P5207                 MOVE SPACES         TO ASC-INCOTERM-CODE-DESC     24580000
P5207                 MOVE PC-TSYMSG-01450                              24590000
P5207                                    TO DP020-MSG-NUMBER            24600000
P5207                 MOVE -1                    TO AINCOTCL            24610000
P5207                 SET DP030-SET-CURSOR-APPL-1 TO TRUE               24620000
P5207                 SET PS-ERROR               TO TRUE                24630000
P5207                 SET DP020-MSG-FATAL        TO TRUE                24640000
P5207           ELSE                                                    24650000
P5207                 MOVE DK-ATTR-ELEM-TXT-TEXT-D                      24660000
P5207                      TO ASC-INCOTERM-CODE-DESC                    24670000
P5207                 MOVE DP015-GREEN          TO AINCOTCC             24680000
P5207                 MOVE DP015-UNDERLINE      TO AINCOTCH             24690000
P5207           END-IF                                                  24700000
P5207                                                                   24710000
P5207           MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO                 24720000
P5207                                                                   24730000
P5207      END-IF.                                                      24740000
226800                                                                  24750000
226900     IF ASC-CSTM-BKR-SCAC > SPACES OR                             24760000
227000        ASC-CSTM-BKR-SCAC = SPACES                                24770000
227100                                                                  24780000
227200           MOVE ASC-CSTM-BKR-SCAC       TO DK-ENT-NAME (1:4)      24790000
227300                                                                  24800000
227400           PERFORM 4330-SELECT-ENTNME                             24810000
227500                                                                  24820000
227600          IF ENTNME-ENT-NAME-DESC = SPACES OR                     24830000
227700            ASC-CSTM-BKR-SCAC = SPACES OR                         24840000
227800            ASC-CSTM-BKR-SCAC = LOW-VALUES                        24850000
227900                MOVE DP015-RED         TO ACSBRCOC                24860000
228000                MOVE DP015-REVERSE     TO ACSBRCOH                24870000
228100                MOVE -1                TO ACSBRCOL                24880000
228200                MOVE SPACES            TO ASC-CSTM-BKR-NAME       24890000
228300                MOVE PC-TSYMSG-01450                              24900000
228400                                       TO DP020-MSG-NUMBER        24910000
228500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24920000
228600                SET PS-ERROR              TO TRUE                 24930000
228700                SET DP020-MSG-FATAL       TO TRUE                 24940000
228800           ELSE                                                   24950000
228900                MOVE ENTNME-ENT-ID        TO ASC-CSTM-BKR-ENT-ID  24960000
229000                MOVE ENTNME-ENT-NAME-DESC TO ASC-CSTM-BKR-NAME    24970000
229100                MOVE DP015-GREEN          TO ACSBRCOC             24980000
229200                MOVE DP015-UNDERLINE      TO ACSBRCOH             24990000
229300           END-IF                                                 25000000
229400              MOVE ASC-CSTM-BKR-NAME    TO ACSBRNOO               25010000
229500     END-IF.                                                      25020000
229600                                                                  25030000
229700 3180-ADD-FROM-LIST.                                              25040000
229800                                                                  25050000
229900     MOVE ASC-COUNTRY-CODE TO DK-COUNTRY-CODE                     25060000
230000                                                                  25070000
230100     PERFORM 4300-SELECT-COUNTRY-ACTIVE                           25080000
230200                                                                  25090000
230300     IF ASC-INVALID-COUNTRY-CODE                                  25100000
230400           SET PS-ERROR                                           25110000
230500               DP020-MSG-FATAL   TO TRUE                          25120000
230600           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              25130000
230700           MOVE DP015-UNP-ALP-BRT-OFF                             25140000
230800                                 TO ACNTCODA                      25150000
230900           MOVE DP015-RED        TO ACNTCODC                      25160000
231000           MOVE DP015-REVERSE    TO ACNTCODH                      25170000
231100           MOVE -1               TO ACNTCODL                      25180000
231200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    25190000
231300           MOVE SPACES           TO CNTRY-CNTRY-NM                25200000
231400           PERFORM 4301-SELECT-COUNTRY-INACTIVE                   25210000
231500     ELSE                                                         25220000
231600           MOVE DP015-GREEN              TO ACNTCODC              25230000
231700           MOVE DP015-BLUE               TO ACNTDESC              25240000
231800           MOVE DP015-UNP-ALP-BRT-OFF    TO ACNTCODA              25250000
231900           MOVE DP015-PRO-NOR-OFF        TO ACNTDESA              25260000
232000           MOVE DP015-HL-OFF             TO ACNTDESH              25270000
232100     END-IF.                                                      25280000
232200                                                                  25290000
232300     IF ASC-INACTIVE-COUNTRY-CODE                                 25300000
232400           SET PS-ERROR                                           25310000
232500               DP020-MSG-FATAL   TO TRUE                          25320000
232600           MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER              25330000
232700           MOVE DP015-UNP-ALP-BRT-OFF                             25340000
232800                                 TO ACNTCODA                      25350000
232900           MOVE DP015-RED        TO ACNTCODC                      25360000
233000           MOVE DP015-REVERSE    TO ACNTCODH                      25370000
233100           MOVE -1               TO ACNTCODL                      25380000
233200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    25390000
233300           MOVE SPACES           TO CNTRY-CNTRY-NM                25400000
233400     END-IF.                                                      25410000
233500                                                                  25420000
233600     MOVE CNTRY-CNTRY-NM         TO ASC-COUNTRY-CODE-DESC         25430000
233700                                    ACNTDESO                      25440000
233800                                                                  25450000
233900     MOVE TR019-POE-CODE         TO ASC-POE-CODE                  25460000
234000                                    DK-POE-CODE                   25470000
234100     PERFORM 4150-OPEN-POE-CURSOR1                                25480000
234200     PERFORM 4154-FETCH-POE-CURSOR1                               25490000
234300     PERFORM 4152-CLOSE-POE-CURSOR1                               25500000
234400                                                                  25510000
234500     IF ASC-INVALID-POE-CODE OR                                   25520000
234600        DK-POE-CODE = SPACES                                      25530000
234700                                                                  25540000
234800            SET PS-ERROR                                          25550000
234900                DP020-MSG-FATAL   TO TRUE                         25560000
235000            MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER             25570000
235100            MOVE DP015-UNP-ALP-BRT-OFF                            25580000
235200                                  TO APOECODA                     25590000
235300            MOVE DP015-RED        TO APOECODC                     25600000
235400            MOVE DP015-REVERSE    TO APOECODH                     25610000
235500            MOVE -1               TO APOECODL                     25620000
235600            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   25630000
235700            PERFORM 4160-OPEN-POE-CURSOR2                         25640000
235800            PERFORM 4164-FETCH-POE-CURSOR2                        25650000
235900            PERFORM 4162-CLOSE-POE-CURSOR2                        25660000
236000     END-IF.                                                      25670000
236100                                                                  25680000
236200     IF ASC-INACTIVE-POE-CODE                                     25690000
236300            SET PS-ERROR                                          25700000
236400                DP020-MSG-FATAL   TO TRUE                         25710000
236500            MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER             25720000
236600            MOVE DP015-UNP-ALP-BRT-OFF  TO APOECODA               25730000
236700            MOVE DP015-RED        TO APOECODC                     25740000
236800            MOVE DP015-REVERSE    TO APOECODH                     25750000
236900            MOVE -1               TO APOECODL                     25760000
237000            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   25770000
237100     ELSE                                                         25780000
237200            MOVE DP015-GREEN              TO APOECODC             25790000
237300            MOVE DP015-BLUE               TO APOEDESC             25800000
237400            MOVE DP015-UNP-ALP-BRT-OFF    TO APOECODA             25810000
237500            MOVE DP015-PRO-NOR-OFF        TO APOEDESA             25820000
237600            MOVE DP015-HL-OFF             TO ACNTDESH             25830000
237700     END-IF.                                                      25840000
237800                                                                  25850000
237900     MOVE ASC-POE-CITY-NAME  TO APOEDESO                          25860000
238000                                                                  25870000
238100     MOVE DP015-UNP-ALP-NOR-OFF    TO AEDICODA                    25880000
238200     MOVE DP015-GREEN              TO AEDICODC                    25890000
238300     MOVE DP015-UNDERLINE          TO AEDICODH                    25900000
238400     MOVE DP015-UNP-ALP-NOR-OFF    TO ACNTCODA                    25910000
238500     MOVE DP015-GREEN              TO ACNTCODC                    25920000
238600     MOVE DP015-UNDERLINE          TO ACNTCODH                    25930000
238700     MOVE DP015-PRO-NOR-OFF        TO ACNTDESA                    25940000
238800     MOVE DP015-BLUE               TO ACNTDESC                    25950000
238900     MOVE DP015-HL-OFF             TO ACNTDESH                    25960000
239000     MOVE DP015-UNP-ALP-NOR-OFF    TO APOECODA                    25970000
239100     MOVE DP015-GREEN              TO APOECODC                    25980000
239200     MOVE DP015-UNDERLINE          TO APOECODH                    25990000
239300     MOVE DP015-PRO-NOR-OFF        TO APOEDESA                    26000000
239400     MOVE DP015-BLUE               TO APOEDESC                    26010000
239500     MOVE DP015-HL-OFF             TO APOEDESH                    26020000
239600     MOVE DP015-UNP-ALP-NOR-OFF    TO AFOBCTYA                    26030000
239700     MOVE DP015-GREEN              TO AFOBCTYC                    26040000
239800     MOVE DP015-UNDERLINE          TO AFOBCTYH                    26050000
239900     MOVE DP015-UNP-ALP-NOR-OFF    TO ACONSLCA                    26060000
240000     MOVE DP015-GREEN              TO ACONSLCC                    26070000
240100     MOVE DP015-UNDERLINE          TO ACONSLCH                    26080000
240200     MOVE DP015-UNP-ALP-NOR-OFF    TO ADECONCA                    26090000
240300     MOVE DP015-GREEN              TO ADECONCC                    26100000
240400     MOVE DP015-UNDERLINE          TO ADECONCH                    26110000
P5207      MOVE DP015-UNP-ALP-NOR-OFF    TO AINCOTCA                    26120000
P5207      MOVE DP015-GREEN              TO AINCOTCC                    26130000
P5207      MOVE DP015-UNDERLINE          TO AINCOTCH                    26140000
240500     MOVE DP015-UNP-ALP-NOR-OFF    TO ACSBRCOA                    26150000
240600     MOVE DP015-GREEN              TO ACSBRCOC                    26160000
240700     MOVE DP015-UNDERLINE          TO ACSBRCOH                    26170000
240800     MOVE DP015-UNDERLINE          TO ACNTCODH                    26180000
240900                                                                  26190000
241000     SET ASC-ADD-FOB TO TRUE                                      26200000
241100                                                                  26210000
241200     IF ASC-COUNTRY-CODE = SPACE                                  26220000
241300           SET PS-ERROR                                           26230000
241400               DP020-MSG-INFORMATIONAL TO TRUE                    26240000
241500           MOVE PC-TSYMSG-01450                                   26250000
241600                          TO DP020-MSG-NUMBER                     26260000
241700           MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA                 26270000
241800           MOVE DP015-PRO-NOR-OFF  TO ACNTDESA                    26280000
241900           SET DP030-SET-CURSOR-APPL-1   TO TRUE                  26290000
242000           MOVE -1       TO ACNTCODL                              26300000
242100     ELSE                                                         26310000
242200          IF ASC-COUNTRY-CODE-DESC = SPACE                        26320000
242300                 SET PS-ERROR                                     26330000
242400                     DP020-MSG-FATAL   TO TRUE                    26340000
242500                 MOVE PC-TSYMSG-01450                             26350000
242600                                   TO DP020-MSG-NUMBER            26360000
242700                 MOVE DP015-UNP-ALP-BRT-OFF                       26370000
242800                                   TO ACNTCODA                    26380000
242900                 MOVE DP015-PRO-NOR-OFF                           26390000
243000                                   TO ACNTDESA                    26400000
243100                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            26410000
243200          END-IF                                                  26420000
243300     END-IF.                                                      26430000
243400*                                                                 26440000
243500 3200-RESET-ATTRIBUTES.                                           26450000
243600*                                                                 26460000
243700     EVALUATE TRUE                                                26470000
243800         WHEN ASC-ADD-COMPLETE                                    26480000
243900             MOVE DP015-PRO-NOR-OFF        TO AFOBCODA            26490000
244000             MOVE DP015-BLUE               TO AFOBCODC            26500000
244100             MOVE DP015-HL-OFF             TO AFOBCODH            26510000
244200             MOVE DP015-PRO-NOR-OFF        TO AEDICODA            26520000
244300             MOVE DP015-BLUE               TO AEDICODC            26530000
244400             MOVE DP015-HL-OFF             TO AEDICODH            26540000
244500             MOVE DP015-PRO-NOR-OFF        TO ACNTCODA            26550000
244600             MOVE DP015-BLUE               TO ACNTCODC            26560000
244700             MOVE DP015-HL-OFF             TO ACNTCODH            26570000
244800             MOVE DP015-PRO-NOR-OFF        TO ACNTDESA            26580000
244900             MOVE DP015-BLUE               TO ACNTDESC            26590000
245000             MOVE DP015-HL-OFF             TO ACNTDESH            26600000
245100             MOVE DP015-PRO-NOR-OFF        TO APOECODA            26610000
245200             MOVE DP015-BLUE               TO APOECODC            26620000
245300             MOVE DP015-HL-OFF             TO APOECODH            26630000
245400             MOVE DP015-PRO-NOR-OFF        TO APOEDESA            26640000
245500             MOVE DP015-BLUE               TO APOEDESC            26650000
245600             MOVE DP015-HL-OFF             TO APOEDESH            26660000
245700             MOVE DP015-PRO-NOR-OFF        TO AFOBCTYA            26670000
245800             MOVE DP015-BLUE               TO AFOBCTYC            26680000
245900             MOVE DP015-HL-OFF             TO AFOBCTYH            26690000
246000             MOVE DP015-PRO-NOR-OFF        TO ACONSLCA            26700000
246100             MOVE DP015-BLUE               TO ACONSLCC            26710000
246200             MOVE DP015-HL-OFF             TO ACONSLCH            26720000
246300             MOVE DP015-PRO-NOR-OFF        TO ADECONCA            26730000
246400             MOVE DP015-BLUE               TO ADECONCC            26740000
246500             MOVE DP015-HL-OFF             TO ADECONCH            26750000
P5207              MOVE DP015-PRO-NOR-OFF        TO AINCOTCA            26760000
P5207              MOVE DP015-BLUE               TO AINCOTCC            26770000
P5207              MOVE DP015-HL-OFF             TO AINCOTCH            26780000
246600             MOVE DP015-PRO-NOR-OFF        TO ACSBRCOA            26790000
246700             MOVE DP015-BLUE               TO ACSBRCOC            26800000
246800             MOVE DP015-HL-OFF             TO ACSBRCOH            26810000
246900*            SET ASC-ADD-PENDING TO TRUE                          26820000
247000                                                                  26830000
247100         WHEN ASC-ADD-FOB                                         26840000
247200             IF TR019-NUMBER-OF-TS-ITEMS = ZERO                   26850000
247300                 MOVE DP015-GREEN              TO AFOBCODC        26860000
247400                 MOVE DP015-GREEN              TO AEDICODC        26870000
247500                 MOVE DP015-GREEN              TO AFOBCTYC        26880000
247600                 MOVE DP015-GREEN              TO ACNTCODC        26890000
247700                 MOVE DP015-GREEN              TO APOECODC        26900000
247800                 MOVE DP015-GREEN              TO ACONSLCC        26910000
247900                 MOVE DP015-GREEN              TO ADECONCC        26920000
P5207                  MOVE DP015-GREEN              TO AINCOTCC        26930000
248000                 MOVE DP015-GREEN              TO ACSBRCOC        26940000
248100                 MOVE DP015-UNDERLINE          TO ACNTCODH        26950000
248200                 MOVE DP015-UNDERLINE          TO APOECODH        26960000
248300                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            26970000
248400             ELSE                                                 26980000
248500                 MOVE DP015-BLUE               TO AFOBCODC        26990000
248600                 MOVE DP015-HL-OFF             TO AFOBCODH        27000000
248700                 MOVE DP015-BLUE               TO AEDICODC        27010000
248800                 MOVE DP015-HL-OFF             TO AEDICODH        27020000
248900                 MOVE DP015-BLUE               TO AFOBCTYC        27030000
249000                 MOVE DP015-HL-OFF             TO AFOBCTYH        27040000
249100                 MOVE DP015-BLUE               TO ACNTCODC        27050000
249200                 MOVE DP015-HL-OFF             TO ACNTCODH        27060000
249300                 MOVE DP015-BLUE               TO APOECODC        27070000
249400                 MOVE DP015-HL-OFF             TO APOECODH        27080000
249500                 MOVE DP015-BLUE               TO ACONSLCC        27090000
249600                 MOVE DP015-HL-OFF             TO ACONSLCH        27100000
249700                 MOVE DP015-BLUE               TO ADECONCC        27110000
249800                 MOVE DP015-HL-OFF             TO ADECONCH        27120000
P5207                  MOVE DP015-BLUE               TO AINCOTCC        27130000
P5207                  MOVE DP015-HL-OFF             TO AINCOTCH        27140000
249900                 MOVE DP015-BLUE               TO ACSBRCOC        27150000
250000                 MOVE DP015-HL-OFF             TO ACNTCODH        27160000
250100                 SET DP030-SET-CURSOR-APPL-1   TO TRUE            27170000
250200             END-IF                                               27180000
250300                                                                  27190000
250400             IF TR019-NUMBER-OF-TS-ITEMS > ZERO                   27200000
250500                 MOVE DP015-BLUE               TO AFOBCTYC        27210000
250600                 MOVE DP015-PRO-NOR-OFF        TO AFOBCTYA        27220000
250700                 MOVE DP015-HL-OFF             TO AFOBCTYH        27230000
250800                 MOVE DP015-PRO-NOR-OFF        TO AFOBCODA        27240000
250900                 MOVE DP015-BLUE               TO AFOBCODC        27250000
251000                 MOVE DP015-HL-OFF             TO AFOBCODH        27260000
251100                 MOVE DP015-PRO-NOR-OFF        TO AEDICODA        27270000
251200                 MOVE DP015-BLUE               TO AEDICODC        27280000
251300                 MOVE DP015-HL-OFF             TO AEDICODH        27290000
251400                 MOVE DP015-PRO-NOR-OFF        TO ACNTCODA        27300000
251500                 MOVE DP015-BLUE               TO ACNTCODC        27310000
251600                 MOVE DP015-HL-OFF             TO ACNTCODH        27320000
251700                 MOVE DP015-PRO-NOR-OFF        TO APOECODA        27330000
251800                 MOVE DP015-BLUE               TO APOECODC        27340000
251900                 MOVE DP015-HL-OFF             TO APOECODH        27350000
252000                 MOVE DP015-PRO-NOR-OFF        TO ACONSLCA        27360000
252100                 MOVE DP015-BLUE               TO ACONSLCC        27370000
252200                 MOVE DP015-HL-OFF             TO ACONSLCH        27380000
252300                 MOVE DP015-PRO-NOR-OFF        TO ADECONCA        27390000
252400                 MOVE DP015-BLUE               TO ADECONCC        27400000
252500                 MOVE DP015-HL-OFF             TO ADECONCH        27410000
P5207                  MOVE DP015-PRO-NOR-OFF        TO AINCOTCA        27420000
P5207                  MOVE DP015-BLUE               TO AINCOTCC        27430000
P5207                  MOVE DP015-HL-OFF             TO AINCOTCH        27440000
252600                 MOVE DP015-PRO-NOR-OFF        TO ACSBRCOA        27450000
252700                 MOVE DP015-BLUE               TO ACSBRCOC        27460000
252800                 MOVE DP015-HL-OFF             TO ACSBRCOH        27470000
252900                 MOVE DP015-HL-OFF             TO ACNTDESH        27480000
253000                 MOVE DP015-HL-OFF             TO APOECODH        27490000
253100                 MOVE DP015-HL-OFF             TO APOEDESH        27500000
253200              END-IF                                              27510000
253300                                                                  27520000
253400         WHEN ASC-UPD-FOB                                         27530000
253500             MOVE DP015-HL-OFF             TO AFOBCODH            27540000
253600             MOVE DP015-PRO-NOR-OFF        TO AFOBCODA            27550000
253700             MOVE DP015-BLUE               TO AFOBCODC            27560000
253800             MOVE DP015-UNP-ALP-NOR-OFF    TO AEDICODA            27570000
253900             MOVE DP015-GREEN              TO AEDICODC            27580000
254000             MOVE DP015-UNDERLINE          TO AEDICODH            27590000
254100             MOVE DP015-UNP-ALP-NOR-OFF    TO ACNTCODA            27600000
254200             MOVE DP015-GREEN              TO ACNTCODC            27610000
254300             MOVE DP015-UNDERLINE          TO ACNTCODH            27620000
254400             MOVE DP015-PRO-NOR-OFF        TO ACNTDESA            27630000
254500             MOVE DP015-BLUE               TO ACNTDESC            27640000
254600             MOVE DP015-HL-OFF             TO ACNTDESH            27650000
254700             MOVE DP015-UNP-ALP-NOR-OFF    TO APOECODA            27660000
254800             MOVE DP015-GREEN              TO APOECODC            27670000
254900             MOVE DP015-UNDERLINE          TO APOECODH            27680000
255000             MOVE DP015-PRO-NOR-OFF        TO APOEDESA            27690000
255100             MOVE DP015-BLUE               TO APOEDESC            27700000
255200             MOVE DP015-HL-OFF             TO APOEDESH            27710000
255300             MOVE DP015-UNP-ALP-NOR-OFF    TO AFOBCTYA            27720000
255400             MOVE DP015-GREEN              TO AFOBCTYC            27730000
255500             MOVE DP015-UNDERLINE          TO AFOBCTYH            27740000
255600             MOVE DP015-UNP-ALP-NOR-OFF    TO ACONSLCA            27750000
255700             MOVE DP015-GREEN              TO ACONSLCC            27760000
255800             MOVE DP015-UNDERLINE          TO ACONSLCH            27770000
255900             MOVE DP015-UNP-ALP-NOR-OFF    TO ADECONCA            27780000
256000             MOVE DP015-GREEN              TO ADECONCC            27790000
256100             MOVE DP015-UNDERLINE          TO ADECONCH            27800000
P5207              MOVE DP015-UNP-ALP-NOR-OFF    TO AINCOTCA            27810000
P5207              MOVE DP015-GREEN              TO AINCOTCC            27820000
P5207              MOVE DP015-UNDERLINE          TO AINCOTCH            27830000
256200             MOVE DP015-UNP-ALP-NOR-OFF    TO ACSBRCOA            27840000
256300             MOVE DP015-GREEN              TO ACSBRCOC            27850000
256400             MOVE DP015-UNDERLINE          TO ACSBRCOH            27860000
256500             MOVE DP015-UNDERLINE          TO ACNTCODH            27870000
256600             SET DP030-SET-CURSOR-APPL-1   TO TRUE                27880000
256700                                                                  27890000
256800         WHEN ASC-DEL-FOB                                         27900000
256900         WHEN ASC-DEL-FROM-LIST                                   27910000
257000             MOVE DP015-PRO-NOR-OFF        TO ACNTCODA            27920000
257100                                              ACNTDESA            27930000
257200                                              AFOBCTYA            27940000
257300                                              ACNTCODA            27950000
257400                                              ACNTDESA            27960000
257500                                              AFOBCODA            27970000
257600                                              AEDICODA            27980000
257700                                              ACNTCODA            27990000
257800                                              APOECODA            28000000
257900                                              ACONSLCA            28010000
258000                                              ADECONCA            28020000
P5207                                               AINCOTCA            28030000
258100                                              ACSBRCOA            28040000
258200             MOVE DP015-HL-OFF             TO ACNTCODH            28050000
258300                                              ACNTDESH            28060000
258400                                              AFOBCTYH            28070000
258500                                              AFOBCODH            28080000
258600                                              AEDICODH            28090000
258700                                              ACNTCODH            28100000
258800                                              APOECODH            28110000
258900                                              APOEDESH            28120000
259000                                              ACONSLCH            28130000
259100                                              ADECONCH            28140000
P5207                                               AINCOTCH            28150000
259200                                              ACSBRCOH            28160000
259300             MOVE DP015-BLUE               TO ACNTCODC            28170000
259400                                              ACNTDESC            28180000
259500                                              ACNTDESC            28190000
259600                                              AFOBCTYC            28200000
259700                                              AFOBCODC            28210000
259800                                              AEDICODC            28220000
259900                                              APOECODC            28230000
260000                                              ACONSLCC            28240000
260100                                              ADECONCC            28250000
P5207                                               AINCOTCC            28260000
260200                                              ACSBRCOC            28270000
260300             MOVE PC-TSYMSG-00004                                 28280000
260400                                   TO DP020-MSG-NUMBER            28290000
260500             SET ASC-DEL-PENDING                                  28300000
260600             DP020-MSG-INFORMATIONAL                              28310000
260700                                   TO TRUE                        28320000
260800                                                                  28330000
260900             MOVE ASC-FOB-CODE         TO DK-FOB-CODE             28340000
261000                                                                  28350000
261100             PERFORM 4100-SELECT-FOB                              28360000
261200                                                                  28370000
261300              IF ASC-INVALID-FOB-CODE OR                          28380000
261400                 ASC-VALID-FOB-CODE                               28390000
261500                                                                  28400000
261600                 IF IMFOB-STAT-CDE = PC-I                         28410000
261700                     SET PS-ERROR                                 28420000
261800                          DP020-MSG-FATAL   TO TRUE               28430000
261900                     MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER    28440000
262000                 END-IF                                           28450000
262100              END-IF                                              28460000
262200         WHEN ASC-ADD-COMPLETE                                    28470000
262300             MOVE DP015-PRO-NOR-OFF        TO ACNTCODA            28480000
262400                                              ACNTDESA            28490000
262500                                              ACNTCODA            28500000
262600                                              ACNTDESA            28510000
262700                                              AFOBCODA            28520000
262800                                              AEDICODA            28530000
262900                                              ACNTCODA            28540000
263000                                              APOECODA            28550000
263100                                              ACONSLCA            28560000
263200                                              ADECONCA            28570000
P5207                                               AINCOTCA            28580000
263300                                              ACSBRCOA            28590000
263400             MOVE DP015-BLUE               TO ACNTCODC            28600000
263500                                              ACNTDESC            28610000
263600                                              ACNTDESC            28620000
263700                                              AFOBCODC            28630000
263800                                              AEDICODC            28640000
263900                                              APOECODC            28650000
264000                                              ACONSLCC            28660000
264100                                              ADECONCC            28670000
P5207                                               AINCOTCC            28680000
264200                                              ACSBRCOC            28690000
264300             MOVE DP015-HL-OFF             TO ACNTCODH            28700000
264400                                              ACNTDESH            28710000
264500                                              AFOBCODH            28720000
264600                                              AEDICODH            28730000
264700                                              ACNTCODH            28740000
264800                                              APOECODH            28750000
264900                                              ACONSLCH            28760000
265000                                              ADECONCH            28770000
P5207                                               AINCOTCH            28780000
265100                                              ACSBRCOH            28790000
265200         WHEN OTHER                                               28800000
265300             MOVE DP015-PRO-NOR-OFF        TO AFOBCODA            28810000
265400             MOVE DP015-BLUE               TO AFOBCODC            28820000
265500             MOVE DP015-HL-OFF             TO AFOBCODH            28830000
265600             MOVE DP015-PRO-NOR-OFF        TO AEDICODA            28840000
265700             MOVE DP015-BLUE               TO AEDICODC            28850000
265800             MOVE DP015-HL-OFF             TO AEDICODH            28860000
265900             MOVE DP015-PRO-NOR-OFF        TO ACNTCODA            28870000
266000             MOVE DP015-BLUE               TO ACNTCODC            28880000
266100             MOVE DP015-HL-OFF             TO ACNTCODH            28890000
266200             MOVE DP015-PRO-NOR-OFF        TO ACNTDESA            28900000
266300             MOVE DP015-BLUE               TO ACNTDESC            28910000
266400             MOVE DP015-HL-OFF             TO ACNTDESH            28920000
266500             MOVE DP015-PRO-NOR-OFF        TO APOECODA            28930000
266600             MOVE DP015-BLUE               TO APOECODC            28940000
266700             MOVE DP015-HL-OFF             TO APOECODH            28950000
266800             MOVE DP015-PRO-NOR-OFF        TO APOEDESA            28960000
266900             MOVE DP015-BLUE               TO APOEDESC            28970000
267000             MOVE DP015-HL-OFF             TO APOEDESH            28980000
267100             MOVE DP015-PRO-NOR-OFF        TO AFOBCTYA            28990000
267200             MOVE DP015-BLUE               TO AFOBCTYC            29000000
267300             MOVE DP015-HL-OFF             TO AFOBCTYH            29010000
267400             MOVE DP015-PRO-NOR-OFF        TO ACONSLCA            29020000
267500             MOVE DP015-BLUE               TO ACONSLCC            29030000
267600             MOVE DP015-HL-OFF             TO ACONSLCH            29040000
267700             MOVE DP015-PRO-NOR-OFF        TO ADECONCA            29050000
267800             MOVE DP015-BLUE               TO ADECONCC            29060000
267900             MOVE DP015-HL-OFF             TO ADECONCH            29070000
P5207              MOVE DP015-PRO-NOR-OFF        TO AINCOTCA            29080000
P5207              MOVE DP015-BLUE               TO AINCOTCC            29090000
P5207              MOVE DP015-HL-OFF             TO AINCOTCH            29100000
268000             MOVE DP015-PRO-NOR-OFF        TO ACSBRCOA            29110000
268100             MOVE DP015-BLUE               TO ACSBRCOC            29120000
268200             MOVE DP015-HL-OFF             TO ACSBRCOH            29130000
268300     END-EVALUATE.                                                29140000
268400                                                                  29150000
268500 3300-OVERLAY-ADD-DATA.                                           29160000
268600                                                                  29170000
268700     MOVE ZEROES           TO DP020-MSG-NUMBER                    29180000
268800                                                                  29190000
268900     MOVE IMFOB-FOB-CDE TO ASC-FOB-CODE                           29200000
269000                           TR019-FOB-CODE                         29210000
269100                           AFOBCODO                               29220000
269200     MOVE DP015-PRO-NOR-OFF     TO AFOBCODA                       29230000
269300     MOVE DP015-BLUE            TO AFOBCODC                       29240000
269400     MOVE DP015-HL-OFF          TO AFOBCODH                       29250000
269500     MOVE IMFOB-FOB-STD-EDI-CDE TO ASC-FOB-STD-EDI-CDE            29260000
269600                                   TR019-FOB-STD-EDI-CDE          29270000
269700                                   AEDICODO                       29280000
269800                                                                  29290000
269900     MOVE DP015-PRO-NOR-OFF     TO AEDICODA                       29300000
270000     MOVE DP015-BLUE            TO AEDICODC                       29310000
270100     MOVE DP015-HL-OFF          TO AEDICODH                       29320000
270200     MOVE IMFOB-FOB-CTY-NM TO ASC-FOB-CITY-NAME                   29330000
270300                              TR019-FOB-CITY-NAME                 29340000
270400                              AFOBCTYO                            29350000
270500                                                                  29360000
270600     MOVE DP015-PRO-NOR-OFF     TO AFOBCTYA                       29370000
270700     MOVE DP015-BLUE            TO AFOBCTYC                       29380000
270800     MOVE DP015-HL-OFF          TO AFOBCTYH                       29390000
270900     MOVE IMFOB-FOB-CNTRY-CDE TO ASC-COUNTRY-CODE                 29400000
271000                                 TR019-COUNTRY-CODE               29410000
271100                                 DK-COUNTRY-CODE                  29420000
271200                                 ACNTCODO                         29430000
271300     MOVE DP015-PRO-NOR-OFF     TO ACNTCODA                       29440000
271400     MOVE DP015-BLUE            TO ACNTCODC                       29450000
271500     MOVE DP015-HL-OFF          TO ACNTCODH                       29460000
271600     PERFORM 4300-SELECT-COUNTRY-ACTIVE                           29470000
271700                                                                  29480000
271800     IF ASC-INVALID-COUNTRY-CODE                                  29490000
271900           SET PS-ERROR                                           29500000
272000                   DP020-MSG-FATAL   TO TRUE                      29510000
272100           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              29520000
272200           MOVE DP015-UNP-ALP-BRT-OFF                             29530000
272300                                 TO ACNTCODA                      29540000
272400           MOVE DP015-RED        TO ACNTCODC                      29550000
272500           MOVE DP015-REVERSE    TO ACNTCODH                      29560000
272600           MOVE -1               TO ACNTCODL                      29570000
272700           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    29580000
272800           MOVE SPACES           TO CNTRY-CNTRY-NM                29590000
272900           PERFORM 4301-SELECT-COUNTRY-INACTIVE                   29600000
273000      ELSE                                                        29610000
273100           MOVE DP015-BLUE               TO ACNTCODC              29620000
273200           MOVE DP015-BLUE               TO ACNTDESC              29630000
273300           MOVE DP015-PRO-NOR-OFF        TO ACNTCODA              29640000
273400           MOVE DP015-PRO-NOR-OFF        TO ACNTDESA              29650000
273500           MOVE DP015-HL-OFF             TO ACNTDESH              29660000
273600           MOVE DP015-HL-OFF             TO ACNTCODH              29670000
273700      END-IF                                                      29680000
273800                                                                  29690000
273900      IF ASC-INACTIVE-COUNTRY-CODE                                29700000
274000          SET PS-ERROR                                            29710000
274100              DP020-MSG-FATAL   TO TRUE                           29720000
274200          MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER               29730000
274300          MOVE DP015-UNP-ALP-BRT-OFF                              29740000
274400                                TO ACNTCODA                       29750000
274500          MOVE DP015-RED        TO ACNTCODC                       29760000
274600          MOVE DP015-REVERSE    TO ACNTCODH                       29770000
274700          MOVE -1               TO ACNTCODL                       29780000
274800          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     29790000
274900          MOVE SPACES           TO CNTRY-CNTRY-NM                 29800000
275000      END-IF                                                      29810000
275100                                                                  29820000
275200      MOVE CNTRY-CNTRY-NM     TO ASC-COUNTRY-CODE-DESC            29830000
275300*                                TR019-COUNTRY-CODE-DESC          29840000
275400                                 ACNTDESO                         29850000
275500                                                                  29860000
275600      MOVE IMFOB-CONSLR-ENT-ID TO                                 29870000
275700                                   ASC-CONSLR-ENT-ID              29880000
275800                                   TR019-CONSLR-ENT-ID            29890000
275900                                   DK-ENT-ID                      29900000
276000      PERFORM 4331-SELECT-ENTNME-ENT                              29910000
276100      MOVE EXTENT-SCAC-CDE TO ASC-CONSLR-SCAC                     29920000
276200                              TR019-CONSLR-SCAC                   29930000
276300                                                                  29940000
276400      MOVE ENTNME-ENT-NAME-DESC TO ACONSLNO                       29950000
276500                                   TR019-CONSLR-NAME              29960000
276600                                   ASC-CONSLR-NAME                29970000
276700                                                                  29980000
276800     MOVE DP015-PRO-NOR-OFF     TO ACONSLCA                       29990000
276900     MOVE DP015-BLUE            TO ACONSLCC                       30000000
277000     MOVE DP015-HL-OFF          TO ACONSLCH                       30010000
277100                                                                  30020000
277200      MOVE IMFOB-DCONSLR-ENT-ID TO                                30030000
277300                                   ASC-DECONL-ENT-ID              30040000
277400                                   TR019-DECONL-ENT-ID            30050000
277500                                   DK-ENT-ID                      30060000
277600      PERFORM 4331-SELECT-ENTNME-ENT                              30070000
277700      MOVE EXTENT-SCAC-CDE TO ASC-DECONL-SCAC                     30080000
277800                              TR019-DECONL-SCAC                   30090000
277900                                                                  30100000
278000      MOVE ENTNME-ENT-NAME-DESC TO ADECONNO                       30110000
278100                                   TR019-DECONL-NAME              30120000
278200                                   ASC-DECONL-NAME                30130000
278300                                                                  30140000
278400     MOVE DP015-PRO-NOR-OFF     TO ADECONCA                       30150000
278500     MOVE DP015-BLUE            TO ADECONCC                       30160000
278600     MOVE DP015-HL-OFF          TO ADECONCH                       30170000
P5207                                                                   30180000
P5207       MOVE IMFOB-INCTRM-CDE TO                                    30190000
P5207                                    ASC-INCOTERM-CODE              30200000
P5207       PERFORM 4332-SELECT-INCOTERM                                30211060
P5207       MOVE WST00010-ATTR-ELEM-TXT-TEXT TO ASC-INCOTERM-CODE       30220000
P5207                               TR019-INCOTERM-CODE                 30230000
P5207                                                                   30240000
P5207       MOVE DK-ATTR-ELEM-TXT-TEXT-D TO AINCOTNO                    30250000
P5207                                    ASC-INCOTERM-CODE-DESC         30270000
P5207                                                                   30280000
P5207      MOVE DP015-PRO-NOR-OFF     TO AINCOTCA                       30290000
P5207      MOVE DP015-BLUE            TO AINCOTCC                       30300000
P5207      MOVE DP015-HL-OFF          TO AINCOTCH                       30310000
278700                                                                  30320000
278800      MOVE IMFOB-CSTM-BKR-ENT-ID TO                               30330000
278900                                   ASC-CSTM-BKR-ENT-ID            30340000
279000                                   TR019-CSTM-BKR-ENT-ID          30350000
279100                                   DK-ENT-ID                      30360000
279200      PERFORM 4331-SELECT-ENTNME-ENT                              30370000
279300      MOVE EXTENT-SCAC-CDE TO ASC-CSTM-BKR-SCAC                   30380000
279400                              TR019-CSTM-BKR-SCAC                 30390000
279500      MOVE ENTNME-ENT-NAME-DESC TO ACSBRNOO                       30400000
279600                                   TR019-CSTM-BKR-NAME            30410000
279700                                   ASC-CSTM-BKR-NAME              30420000
279800     MOVE DP015-PRO-NOR-OFF     TO ACSBRCOA                       30430000
279900     MOVE DP015-BLUE            TO ACSBRCOC                       30440000
280000     MOVE DP015-HL-OFF          TO ACSBRCOH                       30450000
280100                                                                  30460000
280200     MOVE IMFOB-POE-CDE TO ASC-POE-CODE                           30470000
280300                           TR019-POE-CODE                         30480000
280400                           DK-POE-CODE                            30490000
280500                           APOECODO                               30500000
280600     MOVE DP015-PRO-NOR-OFF     TO APOECODA                       30510000
280700     MOVE DP015-BLUE            TO APOECODC                       30520000
280800     MOVE DP015-HL-OFF          TO APOECODH                       30530000
280900                                                                  30540000
281000      PERFORM 4150-OPEN-POE-CURSOR1                               30550000
281100      PERFORM 4154-FETCH-POE-CURSOR1                              30560000
281200      PERFORM 4152-CLOSE-POE-CURSOR1                              30570000
281300                                                                  30580000
281400      IF ASC-INVALID-POE-CODE OR                                  30590000
281500         DK-POE-CODE = SPACE                                      30600000
281600                                                                  30610000
281700           SET PS-ERROR                                           30620000
281800               DP020-MSG-FATAL   TO TRUE                          30630000
281900           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              30640000
282000           MOVE DP015-UNP-ALP-BRT-OFF                             30650000
282100                                 TO APOECODA                      30660000
282200           MOVE DP015-RED        TO APOECODC                      30670000
282300           MOVE DP015-REVERSE    TO APOECODH                      30680000
282400           MOVE -1               TO APOECODL                      30690000
282500           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    30700000
282600           MOVE SPACES           TO IMPOE-POE-CTY-NM              30710000
282700           PERFORM 4160-OPEN-POE-CURSOR2                          30720000
282800           PERFORM 4164-FETCH-POE-CURSOR2                         30730000
282900           PERFORM 4162-CLOSE-POE-CURSOR2                         30740000
283000      ELSE                                                        30750000
283100           MOVE DP015-BLUE               TO APOECODC              30760000
283200           MOVE DP015-BLUE               TO APOEDESC              30770000
283300           MOVE DP015-PRO-NOR-OFF        TO APOECODA              30780000
283400           MOVE DP015-PRO-NOR-OFF        TO APOEDESA              30790000
283500           MOVE DP015-HL-OFF             TO APOECODH              30800000
283600           MOVE DP015-HL-OFF             TO APOEDESH              30810000
283700      END-IF                                                      30820000
283800      IF ASC-INACTIVE-POE-CODE                                    30830000
283900           SET PS-ERROR                                           30840000
284000               DP020-MSG-FATAL   TO TRUE                          30850000
284100           MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER              30860000
284200           MOVE DP015-UNP-ALP-BRT-OFF                             30870000
284300                                 TO APOECODA                      30880000
284400           MOVE DP015-RED        TO APOECODC                      30890000
284500           MOVE DP015-REVERSE    TO APOECODH                      30900000
284600           MOVE -1               TO APOECODL                      30910000
284700           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    30920000
284800           MOVE SPACES           TO IMPOE-POE-CTY-NM              30930000
284900      END-IF.                                                     30940000
285000                                                                  30950000
285100      MOVE IMPOE-POE-CTY-NM      TO TR019-POE-CITY-NAME.          30960000
285200                                                                  30970000
285300                                                                  30980000
285400*----------------------------------------------------------------*30990000
285500* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *31000000
285600* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *31010000
285700*----------------------------------------------------------------*31020000
285800                                                                  31030000
285900 4000-BUILD-INITIAL-PANEL.                                        31040000
286000                                                                  31050000
286100     IF ASC-UPD-FOB                                               31060000
286200         PERFORM 4005-UPD-FOB                                     31070000
286300     END-IF                                                       31080000
286400                                                                  31090000
286500     IF ASC-DEL-FOB                                               31100000
286600         PERFORM 4010-DEL-FOB                                     31110000
286700     END-IF                                                       31120000
286800                                                                  31130000
286900     IF ASC-ADD-FOB AND                                           31140000
287000       TR019-NUMBER-OF-TS-ITEMS > ZERO                            31150000
287100         PERFORM 4020-ADD-FOB                                     31160000
287200     END-IF                                                       31170000
287300                                                                  31180000
287400     IF ASC-ADD-FOB                                               31190000
287500          IF TR019-NUMBER-OF-TS-ITEMS = ZERO                      31200000
287600               PERFORM 4030-ADD-FOB-NO-RECORDS                    31210000
287700          ELSE                                                    31220000
287800               PERFORM 4040-ADD-FOB-WITH-RECORDS                  31230000
287900          END-IF                                                  31240000
288000     END-IF.                                                      31250000
288100                                                                  31260000
288200     IF ASC-DEL-FROM-LIST                                         31270000
288300             MOVE DP015-PRO-NOR-OFF        TO AFOBCODA            31280000
288400             MOVE DP015-BLUE               TO AFOBCODC            31290000
288500             MOVE DP015-HL-OFF             TO AFOBCODH            31300000
288600             MOVE DP015-PRO-NOR-OFF        TO AEDICODA            31310000
288700             MOVE DP015-BLUE               TO AEDICODC            31320000
288800             MOVE DP015-HL-OFF             TO AEDICODH            31330000
288900             MOVE DP015-PRO-NOR-OFF        TO ACNTCODA            31340000
289000             MOVE DP015-BLUE               TO ACNTCODC            31350000
289100             MOVE DP015-HL-OFF             TO ACNTCODH            31360000
289200             MOVE DP015-PRO-NOR-OFF        TO ACNTDESA            31370000
289300             MOVE DP015-BLUE               TO ACNTDESC            31380000
289400             MOVE DP015-HL-OFF             TO ACNTDESH            31390000
289500             MOVE DP015-PRO-NOR-OFF        TO APOECODA            31400000
289600             MOVE DP015-BLUE               TO APOECODC            31410000
289700             MOVE DP015-HL-OFF             TO APOECODH            31420000
289800             MOVE DP015-PRO-NOR-OFF        TO APOEDESA            31430000
289900             MOVE DP015-BLUE               TO APOEDESC            31440000
290000             MOVE DP015-HL-OFF             TO APOEDESH            31450000
290100             MOVE DP015-PRO-NOR-OFF        TO AFOBCTYA            31460000
290200             MOVE DP015-BLUE               TO AFOBCTYC            31470000
290300             MOVE DP015-HL-OFF             TO AFOBCTYH            31480000
290400             MOVE DP015-PRO-NOR-OFF        TO ACONSLCA            31490000
290500             MOVE DP015-BLUE               TO ACONSLCC            31500000
290600             MOVE DP015-HL-OFF             TO ACONSLCH            31510000
290700             MOVE DP015-PRO-NOR-OFF        TO ADECONCA            31520000
290800             MOVE DP015-BLUE               TO ADECONCC            31530000
290900             MOVE DP015-HL-OFF             TO ADECONCH            31540000
P5207              MOVE DP015-PRO-NOR-OFF        TO AINCOTCA            31550000
P5207              MOVE DP015-BLUE               TO AINCOTCC            31560000
P5207              MOVE DP015-HL-OFF             TO AINCOTCH            31570000
291000             MOVE DP015-PRO-NOR-OFF        TO ACSBRCOA            31580000
291100             MOVE DP015-BLUE               TO ACSBRCOC            31590000
291200             MOVE DP015-HL-OFF             TO ACSBRCOH            31600000
291300     END-IF                                                       31610000
291400                                                                  31620000
291500     MOVE ASC-FOB-CODE          TO AFOBCODO                       31630000
291600     MOVE ASC-COUNTRY-CODE      TO ACNTCODO                       31640000
291700     MOVE ASC-COUNTRY-CODE-DESC TO ACNTDESO                       31650000
291800     MOVE ASC-FOB-CITY-NAME     TO AFOBCTYO                       31660000
291900     MOVE ASC-CONSLR-SCAC       TO ACONSLCO                       31670000
292000     MOVE ASC-CONSLR-NAME       TO ACONSLNO                       31680000
292100     MOVE ASC-DECONL-SCAC       TO ADECONCO                       31690000
292200     MOVE ASC-DECONL-NAME       TO ADECONNO                       31700000
P5207      MOVE ASC-INCOTERM-CODE     TO AINCOTCO                       31710000
P5207      MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO                      31720000
292300     MOVE ASC-CSTM-BKR-SCAC     TO ACSBRCOO                       31730000
292400     MOVE ASC-CSTM-BKR-NAME     TO ACSBRNOO                       31740000
292500                                                                  31750000
292600     MOVE ASC-POE-CODE          TO APOECODO                       31760000
292700     MOVE ASC-POE-CITY-NAME     TO APOEDESO                       31770000
292800                                                                  31780000
292900     MOVE ASC-FOB-STD-EDI-CDE   TO AEDICODO.                      31790000
293000                                                                  31800000
293100 4005-UPD-FOB.                                                    31810000
293200                                                                  31820000
293300     MOVE ASC-COUNTRY-CODE  TO  DK-COUNTRY-CODE                   31830000
293400                                ACNTCODO                          31840000
293500     IF ASC-COUNTRY-CODE NOT = SPACES                             31850000
293600          MOVE ASC-COUNTRY-CODE TO DK-COUNTRY-CODE                31860000
293700          PERFORM 4300-SELECT-COUNTRY-ACTIVE                      31870000
293800     END-IF.                                                      31880000
293900                                                                  31890000
294000     IF ASC-INVALID-COUNTRY-CODE                                  31900000
294100          SET PS-ERROR                                            31910000
294200              DP020-MSG-FATAL   TO TRUE                           31920000
294300          MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER               31930000
294400          MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                 31940000
294500          MOVE DP015-RED        TO ACNTCODC                       31950000
294600          MOVE DP015-REVERSE    TO ACNTCODH                       31960000
294700          MOVE -1               TO ACNTCODL                       31970000
294800          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     31980000
294900          MOVE SPACES           TO CNTRY-CNTRY-NM                 31990000
295000     END-IF.                                                      32000000
295100                                                                  32010000
295200     IF ASC-INACTIVE-COUNTRY-CODE                                 32020000
295300          SET PS-ERROR                                            32030000
295400              DP020-MSG-FATAL   TO TRUE                           32040000
295500          MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER               32050000
295600          MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA                  32060000
295700          MOVE DP015-RED        TO ACNTCODC                       32070000
295800          MOVE DP015-REVERSE    TO ACNTCODH                       32080000
295900          MOVE -1               TO ACNTCODL                       32090000
296000          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     32100000
296100          MOVE SPACES           TO CNTRY-CNTRY-NM                 32110000
296200     END-IF.                                                      32120000
296300                                                                  32130000
296400     MOVE CNTRY-CNTRY-NM          TO ASC-COUNTRY-CODE-DESC        32140000
296500                                     ACNTDESO                     32150000
296600                                                                  32160000
296700     MOVE ASC-POE-CODE     TO DK-POE-CODE                         32170000
296800                              APOECODO                            32180000
296900                                                                  32190000
297000     IF ASC-POE-CODE > SPACES OR                                  32200000
297100        ASC-POE-CODE = SPACES                                     32210000
297200                                                                  32220000
297300           PERFORM 4150-OPEN-POE-CURSOR1                          32230000
297400           PERFORM 4154-FETCH-POE-CURSOR1                         32240000
297500           PERFORM 4152-CLOSE-POE-CURSOR1                         32250000
297600                                                                  32260000
297700          IF ASC-INVALID-POE-CODE                                 32270000
297800                SET PS-ERROR                                      32280000
297900                    DP020-MSG-FATAL   TO TRUE                     32290000
298000                MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER         32300000
298100                MOVE DP015-UNP-ALP-BRT-OFF TO APOECODA            32310000
298200                MOVE DP015-RED        TO APOECODC                 32320000
298300                MOVE DP015-REVERSE    TO APOECODH                 32330000
298400                MOVE -1               TO APOECODL                 32340000
298500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               32350000
298600          ELSE                                                    32360000
298700                MOVE DP015-GREEN              TO APOECODC         32370000
298800                MOVE DP015-BLUE               TO APOEDESC         32380000
298900                MOVE DP015-UNP-ALP-BRT-OFF    TO APOECODA         32390000
299000                MOVE DP015-PRO-NOR-OFF        TO APOEDESA         32400000
299100                MOVE DP015-HL-OFF             TO APOEDESH         32410000
299200          END-IF                                                  32420000
299300     END-IF.                                                      32430000
299400                                                                  32440000
299500     MOVE ASC-POE-CITY-NAME  TO APOEDESO.                         32450000
299600                                                                  32460000
299700                                                                  32470000
299800 4010-DEL-FOB.                                                    32480000
299900                                                                  32490000
300000     MOVE ASC-COUNTRY-CODE  TO  DK-COUNTRY-CODE                   32500000
300100                                ACNTCODO                          32510000
300200     IF ASC-COUNTRY-CODE NOT = SPACES                             32520000
300300          MOVE ASC-COUNTRY-CODE TO DK-COUNTRY-CODE                32530000
300400          PERFORM 4300-SELECT-COUNTRY-ACTIVE                      32540000
300500     END-IF.                                                      32550000
300600                                                                  32560000
300700     IF ASC-INVALID-COUNTRY-CODE                                  32570000
300800**        SET PS-ERROR                                            32580000
300900**            DP020-MSG-FATAL   TO TRUE                           32590000
301000**        MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER               32600000
301100**        MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                 32610000
301200**        MOVE DP015-RED        TO ACNTCODC                       32620000
301300**        MOVE DP015-REVERSE    TO ACNTCODH                       32630000
301400**        MOVE -1               TO ACNTCODL                       32640000
301500**        SET DP030-SET-CURSOR-APPL-1 TO TRUE                     32650000
301600          MOVE SPACES           TO CNTRY-CNTRY-NM                 32660000
301700     END-IF.                                                      32670000
301800                                                                  32680000
301900     IF ASC-INACTIVE-COUNTRY-CODE                                 32690000
302000**        SET PS-ERROR                                            32700000
302100**            DP020-MSG-FATAL   TO TRUE                           32710000
302200**        MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER               32720000
302300**        MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA                  32730000
302400**        MOVE DP015-RED        TO ACNTCODC                       32740000
302500**        MOVE DP015-REVERSE    TO ACNTCODH                       32750000
302600**        MOVE -1               TO ACNTCODL                       32760000
302700**        SET DP030-SET-CURSOR-APPL-1 TO TRUE                     32770000
302800          MOVE SPACES           TO CNTRY-CNTRY-NM                 32780000
302900     END-IF.                                                      32790000
303000                                                                  32800000
303100     MOVE CNTRY-CNTRY-NM          TO ASC-COUNTRY-CODE-DESC        32810000
303200                                     ACNTDESO                     32820000
303300                                                                  32830000
303400     MOVE ASC-POE-CODE     TO DK-POE-CODE                         32840000
303500                              APOECODO.                           32850000
303600     IF ASC-POE-CODE > SPACES OR                                  32860000
303700        ASC-POE-CODE = SPACES                                     32870000
303800         PERFORM 4150-OPEN-POE-CURSOR1                            32880000
303900         PERFORM 4154-FETCH-POE-CURSOR1                           32890000
304000         PERFORM 4152-CLOSE-POE-CURSOR1                           32900000
304100     END-IF.                                                      32910000
304200     MOVE ASC-POE-CITY-NAME  TO APOEDESO.                         32920000
304300                                                                  32930000
304400 4020-ADD-FOB.                                                    32940000
304500                                                                  32950000
304600     MOVE ASC-FOB-CODE         TO DK-FOB-CODE                     32960000
304700                                  TR019-FOB-CODE                  32970000
304800                                                                  32980000
304900     PERFORM 4100-SELECT-FOB                                      32990000
305000                                                                  33000000
305100     IF ASC-INVALID-FOB-CODE OR                                   33010000
305200        ASC-FOB-CODE = SPACE                                      33020000
305300                                                                  33030000
305400           SET PS-ERROR                                           33040000
305500               DP020-MSG-FATAL   TO TRUE                          33050000
305600           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              33060000
305700           MOVE DP015-UNP-ALP-BRT-OFF                             33070000
305800                                 TO AFOBCODA                      33080000
305900           MOVE DP015-RED        TO AFOBCODC                      33090000
306000           MOVE DP015-REVERSE    TO AFOBCODH                      33100000
306100           MOVE -1               TO AFOBCODL                      33110000
306200           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    33120000
306300     ELSE                                                         33130000
306400            MOVE DP015-HL-OFF     TO AFOBCODH                     33140000
306500     END-IF.                                                      33150000
306600                                                                  33160000
306700     MOVE ASC-FOB-STD-EDI-CDE TO TR019-FOB-STD-EDI-CDE            33170000
306800                                                                  33180000
306900     IF ASC-FOB-STD-EDI-CDE = SPACES                              33190000
307000                                                                  33200000
307100           SET PS-ERROR                                           33210000
307200               DP020-MSG-FATAL   TO TRUE                          33220000
307300           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              33230000
307400           MOVE DP015-UNP-ALP-BRT-OFF                             33240000
307500                                 TO AEDICODA                      33250000
307600           MOVE DP015-RED        TO AEDICODC                      33260000
307700           MOVE DP015-REVERSE    TO AEDICODH                      33270000
307800           MOVE -1               TO AEDICODL                      33280000
307900           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    33290000
308000     ELSE                                                         33300000
308100           MOVE DP015-GREEN      TO AEDICODC                      33310000
308200           MOVE DP015-UNDERLINE  TO AEDICODH                      33320000
308300     END-IF.                                                      33330000
308400                                                                  33340000
308500     IF ASC-POE-CODE > SPACE OR                                   33350000
308600       ASC-POE-CODE = SPACE                                       33360000
308700                                                                  33370000
308800           MOVE ASC-POE-CODE         TO DK-POE-CODE               33380000
308900                                        TR019-POE-CODE            33390000
309000                                                                  33400000
309100           PERFORM 4150-OPEN-POE-CURSOR1                          33410000
309200           PERFORM 4154-FETCH-POE-CURSOR1                         33420000
309300           PERFORM 4152-CLOSE-POE-CURSOR1                         33430000
309400                                                                  33440000
309500          IF ASC-INVALID-POE-CODE OR                              33450000
309600            ASC-POE-CODE = SPACE                                  33460000
309700                SET PS-ERROR                                      33470000
309800                    DP020-MSG-FATAL   TO TRUE                     33480000
309900                MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER         33490000
310000                MOVE DP015-UNP-ALP-BRT-OFF    TO APOECODA         33500000
310100                MOVE DP015-RED        TO APOECODC                 33510000
310200                MOVE DP015-REVERSE    TO APOECODH                 33520000
310300                MOVE -1               TO APOECODL                 33530000
310400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33540000
310500                MOVE SPACES          TO IMPOE-POE-CTY-NM          33550000
310600                                        ASC-POE-CITY-NAME         33560000
310700                PERFORM 4160-OPEN-POE-CURSOR2                     33570000
310800                PERFORM 4164-FETCH-POE-CURSOR2                    33580000
310900                PERFORM 4162-CLOSE-POE-CURSOR2                    33590000
311000          END-IF                                                  33600000
311100                                                                  33610000
311200          IF ASC-INACTIVE-POE-CODE OR                             33620000
311300            ASC-POE-CODE = SPACE                                  33630000
311400                SET PS-ERROR                                      33640000
311500                    DP020-MSG-FATAL   TO TRUE                     33650000
311600                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         33660000
311700                MOVE DP015-UNP-ALP-BRT-OFF TO APOECODA            33670000
311800                MOVE DP015-RED        TO APOECODC                 33680000
311900                MOVE DP015-REVERSE    TO APOECODH                 33690000
312000                MOVE -1               TO APOECODL                 33700000
312100                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33710000
312200                MOVE SPACES           TO IMPOE-POE-CTY-NM         33720000
312300                                         ASC-POE-CITY-NAME        33730000
312400          ELSE                                                    33740000
312500                MOVE DP015-UNP-ALP-BRT-OFF TO APOECODA            33750000
312600                MOVE DP015-GREEN      TO APOECODC                 33760000
312700                MOVE DP015-UNDERLINE  TO APOECODH                 33770000
312800          END-IF                                                  33780000
312900     END-IF.                                                      33790000
313000                                                                  33800000
313100     MOVE IMPOE-POE-CTY-NM        TO ASC-POE-CITY-NAME            33810000
313200                                     APOEDESO                     33820000
313300                                                                  33830000
313400     MOVE ASC-FOB-CITY-NAME TO TR019-FOB-CITY-NAME                33840000
313500                                                                  33850000
313600     IF ASC-FOB-CITY-NAME = SPACES                                33860000
313700           SET PS-ERROR                                           33870000
313800               DP020-MSG-FATAL   TO TRUE                          33880000
313900           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              33890000
314000           MOVE DP015-UNP-ALP-BRT-OFF TO AFOBCTYA                 33900000
314100           MOVE DP015-RED        TO AFOBCTYC                      33910000
314200           MOVE DP015-REVERSE    TO AFOBCTYH                      33920000
314300           MOVE -1               TO AFOBCTYL                      33930000
314400           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    33940000
314500     ELSE                                                         33950000
314600           MOVE DP015-GREEN      TO AFOBCTYC                      33960000
314700           MOVE DP015-UNDERLINE  TO AFOBCTYH                      33970000
314800     END-IF.                                                      33980000
314900                                                                  33990000
315000     IF ASC-COUNTRY-CODE > SPACE OR                               34000000
315100       ASC-COUNTRY-CODE = SPACE                                   34010000
315200                                                                  34020000
315300           MOVE ASC-COUNTRY-CODE     TO DK-COUNTRY-CODE           34030000
315400                                                                  34040000
315500           PERFORM 4300-SELECT-COUNTRY-ACTIVE                     34050000
315600                                                                  34060000
315700          IF ASC-INVALID-COUNTRY-CODE OR                          34070000
315800            ASC-COUNTRY-CODE = SPACE                              34080000
315900                SET PS-ERROR                                      34090000
316000                    DP020-MSG-FATAL   TO TRUE                     34100000
316100                MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER         34110000
316200                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            34120000
316300                MOVE DP015-RED        TO ACNTCODC                 34130000
316400                MOVE DP015-REVERSE    TO ACNTCODH                 34140000
316500                MOVE -1               TO ACNTCODL                 34150000
316600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34160000
316700                MOVE SPACES           TO CNTRY-CNTRY-NM           34170000
316800                PERFORM 4301-SELECT-COUNTRY-INACTIVE              34180000
316900          END-IF                                                  34190000
317000                                                                  34200000
317100          IF ASC-INACTIVE-COUNTRY-CODE                            34210000
317200                SET PS-ERROR                                      34220000
317300                    DP020-MSG-FATAL   TO TRUE                     34230000
317400                MOVE PC-TSYMSG-01644  TO DP020-MSG-NUMBER         34240000
317500                MOVE DP015-UNP-ALP-BRT-OFF TO ACNTCODA            34250000
317600                MOVE DP015-RED        TO ACNTCODC                 34260000
317700                MOVE DP015-REVERSE    TO ACNTCODH                 34270000
317800                MOVE -1               TO ACNTCODL                 34280000
317900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34290000
318000                MOVE SPACES           TO CNTRY-CNTRY-NM           34300000
318100          END-IF                                                  34310000
318200     END-IF.                                                      34320000
318300                                                                  34330000
318400     MOVE CNTRY-CNTRY-NM  TO ASC-COUNTRY-CODE-DESC                34340000
318500                             ACNTDESO                             34350000
318600                                                                  34360000
318700     IF ASC-FOB-CITY-NAME = SPACES                                34370000
318800           SET PS-ERROR                                           34380000
318900               DP020-MSG-FATAL   TO TRUE                          34390000
319000           MOVE PC-TSYMSG-01450  TO DP020-MSG-NUMBER              34400000
319100           MOVE DP015-UNP-ALP-BRT-OFF TO AFOBCTYA                 34410000
319200           MOVE DP015-RED        TO AFOBCTYC                      34420000
319300           MOVE DP015-REVERSE    TO AFOBCTYH                      34430000
319400           MOVE -1               TO AFOBCTYL                      34440000
319500           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    34450000
319600     ELSE                                                         34460000
319700           MOVE DP015-GREEN      TO AFOBCTYC                      34470000
319800           MOVE DP015-UNDERLINE  TO AFOBCTYH                      34480000
319900     END-IF.                                                      34490000
320000                                                                  34500000
320100     IF ASC-CONSLR-SCAC > SPACES OR                               34510000
320200       ASC-CONSLR-SCAC = SPACES                                   34520000
320300                                                                  34530000
320400           MOVE ASC-CONSLR-SCAC         TO DK-ENT-NAME (1:4)      34540000
320500                                                                  34550000
320600           PERFORM 4330-SELECT-ENTNME                             34560000
320700                                                                  34570000
320800          IF ENTNME-ENT-NAME-DESC = SPACES OR                     34580000
320900            ASC-CONSLR-SCAC = SPACES OR                           34590000
321000            ASC-CONSLR-SCAC = LOW-VALUES                          34600000
321100                MOVE DP015-RED             TO ACONSLCC            34610000
321200                MOVE DP015-REVERSE         TO ACONSLCH            34620000
321300                MOVE DP015-UNP-ALP-BRT-OFF TO ACONSLCA            34630000
321400                MOVE SPACES                TO ASC-CONSLR-NAME     34640000
321500                MOVE PC-TSYMSG-01450                              34650000
321600                                    TO DP020-MSG-NUMBER           34660000
321700                MOVE -1                    TO ACONSLCL            34670000
321800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34680000
321900                SET PS-ERROR              TO TRUE                 34690000
322000                SET DP020-MSG-FATAL       TO TRUE                 34700000
322100          ELSE                                                    34710000
322200                MOVE ENTNME-ENT-ID         TO ASC-CONSLR-ENT-ID   34720000
322300                                            TR019-CONSLR-ENT-ID   34730000
322400                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CONSLR-NAME     34740000
322500                MOVE DP015-GREEN           TO ACONSLCC            34750000
322600                MOVE DP015-UNDERLINE       TO ACONSLCH            34760000
322700          END-IF                                                  34770000
322800                MOVE ASC-CONSLR-NAME       TO ACONSLNO            34780000
322900     END-IF.                                                      34790000
323000                                                                  34800000
323100     IF ASC-DECONL-SCAC > SPACES OR                               34810000
323200       ASC-DECONL-SCAC = SPACES                                   34820000
323300                                                                  34830000
323400           MOVE ASC-DECONL-SCAC         TO DK-ENT-NAME (1:4)      34840000
323500                                                                  34850000
323600           PERFORM 4330-SELECT-ENTNME                             34860000
323700                                                                  34870000
323800          IF ENTNME-ENT-NAME-DESC = SPACES OR                     34880000
323900            ASC-DECONL-SCAC = SPACES OR                           34890000
324000            ASC-DECONL-SCAC = LOW-VALUES                          34900000
324100                MOVE DP015-RED             TO ADECONCC            34910000
324200                MOVE DP015-REVERSE         TO ADECONCH            34920000
324300                MOVE DP015-UNP-ALP-BRT-OFF TO ADECONCA            34930000
324400                MOVE SPACES                TO ASC-DECONL-NAME     34940000
324500                MOVE PC-TSYMSG-01450                              34950000
324600                                    TO DP020-MSG-NUMBER           34960000
324700                MOVE -1                    TO ADECONCL            34970000
324800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               34980000
324900                SET PS-ERROR              TO TRUE                 34990000
325000                SET DP020-MSG-FATAL       TO TRUE                 35000000
325100          ELSE                                                    35010000
325200                MOVE ENTNME-ENT-ID         TO ASC-DECONL-ENT-ID   35020000
325300                                            TR019-DECONL-ENT-ID   35030000
325400                MOVE ENTNME-ENT-NAME-DESC  TO ASC-DECONL-NAME     35040000
325500                MOVE DP015-GREEN           TO ADECONCC            35050000
325600                MOVE DP015-UNDERLINE       TO ADECONCH            35060000
325700          END-IF                                                  35070000
325800                MOVE ASC-DECONL-NAME       TO ADECONNO            35080000
325900     END-IF.                                                      35090000
P5207                                                                   35100000
P5207      IF ASC-INCOTERM-CODE > SPACES OR                             35110000
P5207        ASC-INCOTERM-CODE = SPACES                                 35120000
P5207                                                                   35130000
P5207            PERFORM 4332-SELECT-INCOTERM                           35141060
P5207                                                                   35150000
P5207           IF DK-ATTR-ELEM-TXT-TEXT-D = SPACES OR                  35160000
P5207             ASC-INCOTERM-CODE = SPACES OR                         35170000
P5207             ASC-INCOTERM-CODE = LOW-VALUES                        35180000
P5207                 MOVE DP015-RED             TO AINCOTCC            35190000
P5207                 MOVE DP015-REVERSE         TO AINCOTCH            35200000
P5207                 MOVE DP015-UNP-ALP-BRT-OFF TO AINCOTCA            35210000
P5207                 MOVE SPACES             TO ASC-INCOTERM-CODE-DESC 35220000
P5207                 MOVE PC-TSYMSG-01450                              35230000
P5207                                     TO DP020-MSG-NUMBER           35240000
P5207                 MOVE -1                    TO AINCOTCL            35250000
P5207                 SET DP030-SET-CURSOR-APPL-1 TO TRUE               35260000
P5207                 SET PS-ERROR              TO TRUE                 35270000
P5207                 SET DP020-MSG-FATAL       TO TRUE                 35280000
P5207           ELSE                                                    35290000
P5207                 MOVE WST00010-ATTR-ELEM-TXT-TEXT TO               35300000
P5207                                            ASC-INCOTERM-CODE      35310000
P5207                                            TR019-INCOTERM-CODE    35311000
P5207                 MOVE DK-ATTR-ELEM-TXT-TEXT-D                      35320000
P5207                      TO ASC-INCOTERM-CODE-DESC                    35330000
P5207                 MOVE DP015-GREEN           TO AINCOTCC            35340000
P5207                 MOVE DP015-UNDERLINE       TO AINCOTCH            35350000
P5207           END-IF                                                  35360000
P5207                 MOVE ASC-INCOTERM-CODE-DESC TO AINCOTNO           35370000
P5207      END-IF.                                                      35380000
326000                                                                  35390000
326100     IF ASC-CSTM-BKR-SCAC > SPACES OR                             35400000
326200       ASC-CSTM-BKR-SCAC = SPACES                                 35410000
326300                                                                  35420000
326400           MOVE ASC-CSTM-BKR-SCAC        TO DK-ENT-NAME (1:4)     35430000
326500                                                                  35440000
326600           PERFORM 4330-SELECT-ENTNME                             35450000
326700                                                                  35460000
326800          IF ENTNME-ENT-NAME-DESC = SPACES OR                     35470000
326900            ASC-CSTM-BKR-SCAC = SPACES OR                         35480000
327000            ASC-CSTM-BKR-SCAC = LOW-VALUES                        35490000
327100                MOVE DP015-RED             TO ACSBRCOC            35500000
327200                MOVE DP015-REVERSE         TO ACSBRCOH            35510000
327300                MOVE SPACE                 TO ASC-CSTM-BKR-NAME   35520000
327400                MOVE PC-TSYMSG-01450                              35530000
327500                                    TO DP020-MSG-NUMBER           35540000
327600                MOVE -1                    TO ACSBRCOL            35550000
327700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               35560000
327800                SET PS-ERROR              TO TRUE                 35570000
327900                SET DP020-MSG-FATAL       TO TRUE                 35580000
328000          ELSE                                                    35590000
328100                MOVE ENTNME-ENT-ID         TO ASC-CSTM-BKR-ENT-ID 35600000
328200                                            TR019-CSTM-BKR-ENT-ID 35610000
328300                MOVE ENTNME-ENT-NAME-DESC  TO ASC-CSTM-BKR-NAME   35620000
328400                MOVE DP015-GREEN           TO ACSBRCOC            35630000
328500                MOVE DP015-UNDERLINE       TO ACSBRCOH            35640000
328600          END-IF                                                  35650000
328700                                                                  35660000
328800          MOVE ASC-CSTM-BKR-NAME     TO ACSBRNOO                  35670000
328900                                                                  35680000
329000     END-IF.                                                      35690000
329100                                                                  35700000
329200 4030-ADD-FOB-NO-RECORDS.                                         35710000
329300                                                                  35720000
329400     MOVE DP015-UNP-ALP-NOR-OFF    TO AEDICODA                    35730000
329500     MOVE DP015-GREEN              TO AEDICODC                    35740000
329600     MOVE DP015-UNDERLINE          TO AEDICODH                    35750000
329700     MOVE DP015-UNP-ALP-NOR-OFF    TO ACNTCODA                    35760000
329800     MOVE DP015-GREEN              TO ACNTCODC                    35770000
329900     MOVE DP015-UNDERLINE          TO ACNTCODH                    35780000
330000     MOVE DP015-PRO-NOR-OFF        TO ACNTDESA                    35790000
330100     MOVE DP015-BLUE               TO ACNTDESC                    35800000
330200     MOVE DP015-HL-OFF             TO ACNTDESH                    35810000
330300     MOVE DP015-UNP-ALP-NOR-OFF    TO APOECODA                    35820000
330400     MOVE DP015-GREEN              TO APOECODC                    35830000
330500     MOVE DP015-UNDERLINE          TO APOECODH                    35840000
330600     MOVE DP015-PRO-NOR-OFF        TO APOEDESA                    35850000
330700     MOVE DP015-BLUE               TO APOEDESC                    35860000
330800     MOVE DP015-HL-OFF             TO APOEDESH                    35870000
330900     MOVE DP015-UNP-ALP-NOR-OFF    TO AFOBCTYA                    35880000
331000     MOVE DP015-GREEN              TO AFOBCTYC                    35890000
331100     MOVE DP015-UNDERLINE          TO AFOBCTYH                    35900000
331200     MOVE DP015-UNP-ALP-NOR-OFF    TO ACONSLCA                    35910000
331300     MOVE DP015-GREEN              TO ACONSLCC                    35920000
331400     MOVE DP015-UNDERLINE          TO ACONSLCH                    35930000
331500     MOVE DP015-UNP-ALP-NOR-OFF    TO ADECONCA                    35940000
331600     MOVE DP015-GREEN              TO ADECONCC                    35950000
331700     MOVE DP015-UNDERLINE          TO ADECONCH                    35960000
P5207      MOVE DP015-UNP-ALP-NOR-OFF    TO AINCOTCA                    35970000
P5207      MOVE DP015-GREEN              TO AINCOTCC                    35980000
P5207      MOVE DP015-UNDERLINE          TO AINCOTCH                    35990000
331800     MOVE DP015-UNP-ALP-NOR-OFF    TO ACSBRCOA                    36000000
331900     MOVE DP015-GREEN              TO ACSBRCOC                    36010000
332000     MOVE DP015-UNDERLINE          TO ACSBRCOH                    36020000
332100     MOVE DP015-UNDERLINE          TO ACNTCODH                    36030000
332200     MOVE DP015-UNDERLINE          TO AFOBCODH                    36040000
332300     MOVE -1                       TO AFOBCODL                    36050000
332400     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         36060000
332500                                                                  36070000
332600 4040-ADD-FOB-WITH-RECORDS.                                       36080000
332700                                                                  36090000
332800                                                                  36100000
332900     IF DP015-RED = AFOBCODC                                      36110000
333000           CONTINUE                                               36120000
333100     ELSE                                                         36130000
333200           MOVE DP015-PRO-NOR-OFF      TO AFOBCODA                36140000
333300           MOVE DP015-BLUE             TO AFOBCODC                36150000
333400           MOVE DP015-HL-OFF           TO AFOBCODH                36160000
333500     END-IF                                                       36170000
333600                                                                  36180000
333700     IF DP015-RED = AEDICODC                                      36190000
333800           CONTINUE                                               36200000
333900     ELSE                                                         36210000
334000           MOVE DP015-PRO-NOR-OFF      TO AEDICODA                36220000
334100           MOVE DP015-BLUE             TO AEDICODC                36230000
334200           MOVE DP015-HL-OFF           TO AEDICODH                36240000
334300     END-IF                                                       36250000
334400                                                                  36260000
334500     IF DP015-RED = ACNTCODC                                      36270000
334600           CONTINUE                                               36280000
334700     ELSE                                                         36290000
334800           MOVE DP015-PRO-NOR-OFF      TO ACNTCODA                36300000
334900           MOVE DP015-BLUE             TO ACNTCODC                36310000
335000           MOVE DP015-HL-OFF           TO ACNTCODH                36320000
335100     END-IF                                                       36330000
335200                                                                  36340000
335300     IF DP015-RED = ACNTDESC                                      36350000
335400           CONTINUE                                               36360000
335500     ELSE                                                         36370000
335600           MOVE DP015-PRO-NOR-OFF        TO ACNTDESA              36380000
335700           MOVE DP015-BLUE               TO ACNTDESC              36390000
335800           MOVE DP015-HL-OFF             TO ACNTDESH              36400000
335900     END-IF                                                       36410000
336000                                                                  36420000
336100     IF DP015-RED = APOECODC                                      36430000
336200           CONTINUE                                               36440000
336300     ELSE                                                         36450000
336400           MOVE DP015-PRO-NOR-OFF      TO APOECODA                36460000
336500           MOVE DP015-BLUE             TO APOECODC                36470000
336600           MOVE DP015-HL-OFF           TO APOECODH                36480000
336700     END-IF                                                       36490000
336800                                                                  36500000
336900     IF DP015-RED = APOEDESC                                      36510000
337000           CONTINUE                                               36520000
337100     ELSE                                                         36530000
337200           MOVE DP015-PRO-NOR-OFF      TO APOEDESA                36540000
337300           MOVE DP015-BLUE             TO APOEDESC                36550000
337400           MOVE DP015-HL-OFF           TO APOEDESH                36560000
337500     END-IF                                                       36570000
337600                                                                  36580000
337700     IF DP015-RED = AFOBCTYC                                      36590000
337800           CONTINUE                                               36600000
337900     ELSE                                                         36610000
338000           MOVE DP015-PRO-NOR-OFF      TO AFOBCTYA                36620000
338100           MOVE DP015-BLUE             TO AFOBCTYC                36630000
338200           MOVE DP015-HL-OFF           TO AFOBCTYH                36640000
338300     END-IF                                                       36650000
338400                                                                  36660000
338500     IF DP015-RED = ACONSLCC                                      36670000
338600           CONTINUE                                               36680000
338700     ELSE                                                         36690000
338800           MOVE DP015-PRO-NOR-OFF      TO ACONSLCA                36700000
338900           MOVE DP015-BLUE             TO ACONSLCC                36710000
339000           MOVE DP015-HL-OFF           TO ACONSLCH                36720000
339100     END-IF                                                       36730000
339200                                                                  36740000
339300     IF DP015-RED = ADECONCC                                      36750000
339400           CONTINUE                                               36760000
339500     ELSE                                                         36770000
339600           MOVE DP015-PRO-NOR-OFF      TO ADECONCA                36780000
339700           MOVE DP015-BLUE             TO ADECONCC                36790000
339800           MOVE DP015-HL-OFF           TO ADECONCH                36800000
339900     END-IF                                                       36810000
339200                                                                  36820000
P5207      IF DP015-RED = AINCOTCC                                      36830000
P5207            CONTINUE                                               36840000
P5207      ELSE                                                         36850000
P5207            MOVE DP015-PRO-NOR-OFF      TO AINCOTCA                36860000
P5207            MOVE DP015-BLUE             TO AINCOTCC                36870000
P5207            MOVE DP015-HL-OFF           TO AINCOTCH                36880000
P5207      END-IF                                                       36890000
340000                                                                  36900000
340100     IF DP015-RED = ACSBRCOC                                      36910000
340200           CONTINUE                                               36920000
340300     ELSE                                                         36930000
340400           MOVE DP015-PRO-NOR-OFF      TO ACSBRCOA                36940000
340500           MOVE DP015-BLUE             TO ACSBRCOC                36950000
340600           MOVE DP015-HL-OFF           TO ACSBRCOH                36960000
340700     END-IF.                                                      36970000
340800                                                                  36980000
340900*                                                                 36990000
341000 4100-SELECT-FOB.                                                 37000000
341100                                                                  37010000
341200     EXEC SQL                                                     37020000
341300         SELECT A.FOB_CDE                                         37030000
341400               ,A.FOB_STD_EDI_CDE                                 37040000
341500               ,A.FOB_CTY_NM                                      37050000
341600               ,A.FOB_CNTRY_CDE                                   37060000
341700               ,A.CONSLR_ENT_ID                                   37070000
341800               ,A.CSTM_BKR_ENT_ID                                 37080000
341900               ,A.DCONSLR_ENT_ID                                  37090000
342000               ,A.POE_CDE                                         37100000
342100               ,A.STAT_CDE                                        37110000
P5207                ,A.INCTRM_CDE                                      37120000
342200            INTO :IMFOB-FOB-CDE                                   37130000
342300                ,:IMFOB-FOB-STD-EDI-CDE                           37140000
342400                ,:IMFOB-FOB-CTY-NM                                37150000
342500                ,:IMFOB-FOB-CNTRY-CDE                             37160000
342600                ,:IMFOB-CONSLR-ENT-ID                             37170000
342700                ,:IMFOB-CSTM-BKR-ENT-ID                           37180000
342800                ,:IMFOB-DCONSLR-ENT-ID                            37190000
342900                ,:IMFOB-POE-CDE                                   37200000
343000                ,:IMFOB-STAT-CDE                                  37210000
P5207                 ,:IMFOB-INCTRM-CDE                                37220000
343100             FROM TIMFOB A                                        37230000
343200             WHERE A.FOB_CDE   = :DK-FOB-CODE                     37240000
343300               AND A.STAT_CDE IN (:PC-A, :PC-I)                   37250000
343400     END-EXEC                                                     37260000
343500                                                                  37270000
343600         EVALUATE TRUE                                            37280000
343700             WHEN SQLCODE = ZERO                                  37290000
343800                 SET ASC-VALID-FOB-CODE TO TRUE                   37300000
343900             WHEN SQLCODE = +100                                  37310000
344000                 SET ASC-INVALID-FOB-CODE TO TRUE                 37320000
344100*            WHEN SQLCODE = -811                                  37330000
344200*                SET ASC-VALID-COUNTRY-CODE TO TRUE               37340000
344300             WHEN OTHER                                           37350000
344400                 MOVE '4100-SELECT-FOB    '                       37360000
344500                                   TO DP013-PARAGRAPH             37370000
344600                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          37380000
344700                                   TO DP013-MESSAGE-TEXT (1)      37390000
344800                 MOVE SQLCA        TO DP013-SQLCA                 37400000
344900                 MOVE 'TIMFOB  '   TO DP013-DB2-TABLE-NAME (1)    37410000
345000                 SET DP013-DB2-ABEND                              37420000
345100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37430000
345200                 PERFORM DP013-0000-PROCESS-ABEND                 37440000
345300         END-EVALUATE.                                            37450000
345400                                                                  37460000
345500 EJECT                                                            37470000
345600*----------------------------------------------------------------*37480000
345700*   OPEN THE POE CODE CURSOR1                                    *37490000
345800*----------------------------------------------------------------*37500000
345900 4150-OPEN-POE-CURSOR1.                                           37510000
346000                                                                  37520000
346100     PERFORM                                                      37530000
346200         WITH TEST AFTER                                          37540000
346300         VARYING PV-RETRY-COUNTER                                 37550000
346400         FROM 1 BY 1                                              37560000
346500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37570000
346600                   OR (SQLCODE = ZERO))                           37580000
346700                                                                  37590000
346800         MOVE 'CURSOR:  POE-CSR1'    TO DP013-MESSAGE-TEXT (2)    37600000
346900                                                                  37610000
347000         EXEC SQL                                                 37620000
347100              OPEN POE-CSR1                                       37630000
347200         END-EXEC                                                 37640000
347300                                                                  37650000
347400         EVALUATE TRUE                                            37660000
347500             WHEN SQLCODE = ZERO                                  37670000
347600             WHEN SQLCODE = -904                                  37680000
347700             WHEN SQLCODE = -913                                  37690000
347800                 CONTINUE                                         37700000
347900             WHEN SQLWARN0 NOT = SPACES                           37710000
348000             WHEN SQLCODE < ZERO                                  37720000
348100             WHEN SQLCODE > ZERO                                  37730000
348200                 MOVE '4150-OPEN-POE-CURSOR1'                     37740000
348300                                   TO DP013-PARAGRAPH             37750000
348400                 MOVE 'OPEN POE CURSOR1 - '                       37760000
348500                                   TO DP013-MESSAGE-TEXT (1)      37770000
348600                 MOVE SQLCA        TO DP013-SQLCA                 37780000
348700                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)    37790000
348800                 SET DP013-DB2-ABEND                              37800000
348900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37810000
349000                 PERFORM DP013-0000-PROCESS-ABEND                 37820000
349100         END-EVALUATE                                             37830000
349200     END-PERFORM.                                                 37840000
349300*                                                                 37850000
349400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37860000
349500         MOVE '4150-OPEN-POE-CURSOR1' TO DP013-PARAGRAPH          37870000
349600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   37880000
349700                                   TO DP013-MESSAGE-TEXT (1)      37890000
349800         MOVE SQLCA                TO DP013-SQLCA                 37900000
349900         MOVE 'TIMPOE  '           TO DP013-DB2-TABLE-NAME (1)    37910000
350000         SET DP013-DB2-ABEND                                      37920000
350100             DP013-XCTL-DISPLAY-RESTART                           37930000
350200                                   TO TRUE                        37940000
350300         PERFORM DP013-0000-PROCESS-ABEND                         37950000
350400     END-IF.                                                      37960000
350500                                                                  37970000
350600 EJECT                                                            37980000
350700*----------------------------------------------------------------*37990000
350800*   CLOSE THE POE CODE CURSOR1                                   *38000000
350900*----------------------------------------------------------------*38010000
351000 4152-CLOSE-POE-CURSOR1.                                          38020000
351100                                                                  38030000
351200     EXEC SQL                                                     38040000
351300          CLOSE POE-CSR1                                          38050000
351400     END-EXEC.                                                    38060000
351500                                                                  38070000
351600     EVALUATE TRUE                                                38080000
351700         WHEN SQLCODE = ZERO                                      38090000
351800             CONTINUE                                             38100000
351900         WHEN SQLWARN0 NOT = SPACES                               38110000
352000         WHEN SQLCODE < ZERO                                      38120000
352100         WHEN SQLCODE > ZERO                                      38130000
352200             MOVE '4152-CLOSE-POE-CURSOR1'                        38140000
352300                               TO DP013-PARAGRAPH                 38150000
352400             MOVE 'CLOSE POE CURSOR1'                             38160000
352500                               TO DP013-MESSAGE-TEXT (1)          38170000
352600             MOVE SQLCA        TO DP013-SQLCA                     38180000
352700             MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)        38190000
352800             SET DP013-DB2-ABEND                                  38200000
352900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38210000
353000             PERFORM DP013-0000-PROCESS-ABEND                     38220000
353100     END-EVALUATE.                                                38230000
353200                                                                  38240000
353300 EJECT                                                            38250000
353400*----------------------------------------------------------------*38260000
353500*    FETCH THE POE CODE CURSOR1                                  *38270000
353600*----------------------------------------------------------------*38280000
353700 4154-FETCH-POE-CURSOR1.                                          38290000
353800                                                                  38300000
353900     EXEC SQL                                                     38310000
354000          FETCH POE-CSR1                                          38320000
354100          INTO  :IMPOE-POE-CTY-NM                                 38330000
354200     END-EXEC.                                                    38340000
354300                                                                  38350000
354400     EVALUATE TRUE                                                38360000
354500         WHEN SQLCODE = ZERO                                      38370000
354600         WHEN SQLCODE = -811                                      38380000
354700             SET ASC-VALID-POE-CODE   TO TRUE                     38390000
354800             MOVE IMPOE-POE-CTY-NM    TO ASC-POE-CITY-NAME        38400000
354900         WHEN SQLCODE = +100                                      38410000
355000             SET ASC-INVALID-POE-CODE TO TRUE                     38420000
355100             MOVE SPACES              TO ASC-POE-CITY-NAME        38430000
355200         WHEN SQLWARN0 NOT = SPACE                                38440000
355300         WHEN SQLCODE NOT = ZERO                                  38450000
355400              MOVE '4154-FETCH-POE-CURSOR1'                       38460000
355500                               TO DP013-PARAGRAPH                 38470000
355600              MOVE 'FETCH POE CURSOR1'                            38480000
355700                               TO DP013-MESSAGE-TEXT (1)          38490000
355800              MOVE SQLCA       TO DP013-SQLCA                     38500000
355900              SET DP013-DB2-ABEND                                 38510000
356000                               TO TRUE                            38520000
356100              PERFORM DP013-0000-PROCESS-ABEND                    38530000
356200     END-EVALUATE.                                                38540000
356300                                                                  38550000
356400 EJECT                                                            38560000
356500*----------------------------------------------------------------*38570000
356600*   OPEN THE POE CODE CURSOR2                                    *38580000
356700*----------------------------------------------------------------*38590000
356800 4160-OPEN-POE-CURSOR2.                                           38600000
356900                                                                  38610000
357000     PERFORM                                                      38620000
357100         WITH TEST AFTER                                          38630000
357200         VARYING PV-RETRY-COUNTER                                 38640000
357300         FROM 1 BY 1                                              38650000
357400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38660000
357500                   OR (SQLCODE = ZERO))                           38670000
357600                                                                  38680000
357700         MOVE 'CURSOR:  POE-CSR2'    TO DP013-MESSAGE-TEXT (2)    38690000
357800                                                                  38700000
357900         EXEC SQL                                                 38710000
358000              OPEN POE-CSR2                                       38720000
358100         END-EXEC                                                 38730000
358200                                                                  38740000
358300         EVALUATE TRUE                                            38750000
358400             WHEN SQLCODE = ZERO                                  38760000
358500             WHEN SQLCODE = -904                                  38770000
358600             WHEN SQLCODE = -913                                  38780000
358700                 CONTINUE                                         38790000
358800             WHEN SQLWARN0 NOT = SPACES                           38800000
358900             WHEN SQLCODE < ZERO                                  38810000
359000             WHEN SQLCODE > ZERO                                  38820000
359100                 MOVE '4160-OPEN-POE-CURSOR2'                     38830000
359200                                   TO DP013-PARAGRAPH             38840000
359300                 MOVE 'OPEN POE CURSOR2 - '                       38850000
359400                                   TO DP013-MESSAGE-TEXT (1)      38860000
359500                 MOVE SQLCA        TO DP013-SQLCA                 38870000
359600                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)    38880000
359700                 SET DP013-DB2-ABEND                              38890000
359800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38900000
359900                 PERFORM DP013-0000-PROCESS-ABEND                 38910000
360000         END-EVALUATE                                             38920000
360100     END-PERFORM.                                                 38930000
360200*                                                                 38940000
360300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38950000
360400         MOVE '4160-OPEN-POE-CURSOR2' TO DP013-PARAGRAPH          38960000
360500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   38970000
360600                                   TO DP013-MESSAGE-TEXT (1)      38980000
360700         MOVE SQLCA                TO DP013-SQLCA                 38990000
360800         MOVE 'TIMPOE  '           TO DP013-DB2-TABLE-NAME (1)    39000000
360900         SET DP013-DB2-ABEND                                      39010000
361000             DP013-XCTL-DISPLAY-RESTART                           39020000
361100                                   TO TRUE                        39030000
361200         PERFORM DP013-0000-PROCESS-ABEND                         39040000
361300     END-IF.                                                      39050000
361400                                                                  39060000
361500 EJECT                                                            39070000
361600*----------------------------------------------------------------*39080000
361700*   CLOSE THE POE CODE CURSOR2                                   *39090000
361800*----------------------------------------------------------------*39100000
361900 4162-CLOSE-POE-CURSOR2.                                          39110000
362000                                                                  39120000
362100     EXEC SQL                                                     39130000
362200          CLOSE POE-CSR2                                          39140000
362300     END-EXEC.                                                    39150000
362400                                                                  39160000
362500     EVALUATE TRUE                                                39170000
362600         WHEN SQLCODE = ZERO                                      39180000
362700             CONTINUE                                             39190000
362800         WHEN SQLWARN0 NOT = SPACES                               39200000
362900         WHEN SQLCODE < ZERO                                      39210000
363000         WHEN SQLCODE > ZERO                                      39220000
363100             MOVE '4162-CLOSE-POE-CURSOR2'                        39230000
363200                               TO DP013-PARAGRAPH                 39240000
363300             MOVE 'CLOSE POE CURSOR2'                             39250000
363400                               TO DP013-MESSAGE-TEXT (1)          39260000
363500             MOVE SQLCA        TO DP013-SQLCA                     39270000
363600             MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)        39280000
363700             SET DP013-DB2-ABEND                                  39290000
363800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39300000
363900             PERFORM DP013-0000-PROCESS-ABEND                     39310000
364000     END-EVALUATE.                                                39320000
364100                                                                  39330000
364200 EJECT                                                            39340000
364300*----------------------------------------------------------------*39350000
364400*    FETCH THE POE CODE CURSOR2                                  *39360000
364500*----------------------------------------------------------------*39370000
364600 4164-FETCH-POE-CURSOR2.                                          39380000
364700                                                                  39390000
364800     EXEC SQL                                                     39400000
364900          FETCH POE-CSR2                                          39410000
365000          INTO  :IMPOE-POE-CTY-NM                                 39420000
365100     END-EXEC.                                                    39430000
365200                                                                  39440000
365300     EVALUATE TRUE                                                39450000
365400         WHEN SQLCODE = ZERO                                      39460000
365500         WHEN SQLCODE = -811                                      39470000
365600             SET ASC-INACTIVE-POE-CODE TO TRUE                    39480000
365700             MOVE IMPOE-POE-CTY-NM     TO ASC-POE-CITY-NAME       39490000
365800         WHEN SQLCODE = +100                                      39500000
365900             SET ASC-INVALID-POE-CODE  TO TRUE                    39510000
366000             MOVE SPACES               TO ASC-POE-CITY-NAME       39520000
366100         WHEN SQLWARN0 NOT = SPACE                                39530000
366200         WHEN SQLCODE NOT = ZERO                                  39540000
366300              MOVE '4164-FETCH-POE-CURSOR2'                       39550000
366400                               TO DP013-PARAGRAPH                 39560000
366500              MOVE 'FETCH POE CURSOR'                             39570000
366600                               TO DP013-MESSAGE-TEXT (1)          39580000
366700              MOVE SQLCA       TO DP013-SQLCA                     39590000
366800              SET DP013-DB2-ABEND                                 39600000
366900                               TO TRUE                            39610000
367000              PERFORM DP013-0000-PROCESS-ABEND                    39620000
367100     END-EVALUATE.                                                39630000
367200                                                                  39640000
367201 4200-SELECT-COUNTRY-DESC.                                        39650000
367202                                                                  39660000
367203     EXEC SQL                                                     39670000
367204         SELECT A.CNTRY_NM                                        39680000
367205            INTO :CNTRY-CNTRY-NM                                  39690000
367206             FROM TCNTRY A                                        39700000
367207             WHERE A.CNTRY_CDE = :DK-COUNTRY-CODE                 39710000
367208               AND A.STAT_CDE IN (:PC-A, :PC-I)                   39720000
367209     END-EXEC                                                     39730000
367210                                                                  39740000
367211         EVALUATE TRUE                                            39750000
367212             WHEN SQLCODE = ZERO                                  39760000
367213*            WHEN SQLCODE = -811                                  39770000
367214                 MOVE CNTRY-CNTRY-NM TO ASC-COUNTRY-CODE-DESC     39780000
367215             WHEN SQLCODE = +100                                  39790000
367216                 MOVE SPACES TO ASC-COUNTRY-CODE-DESC             39800000
367217             WHEN OTHER                                           39810000
367218                 MOVE '4200-SELECT-COUNTRY-DESC'                  39820000
367219                                   TO DP013-PARAGRAPH             39830000
367220                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          39840000
367221                                   TO DP013-MESSAGE-TEXT (1)      39850000
367222                 MOVE SQLCA        TO DP013-SQLCA                 39860000
367223                 MOVE 'TCNTRY  '   TO DP013-DB2-TABLE-NAME (1)    39870000
367224                 SET DP013-DB2-ABEND                              39880000
367225                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39890000
367226                 PERFORM DP013-0000-PROCESS-ABEND                 39900000
367227         END-EVALUATE.                                            39910000
367228                                                                  39920000
367229 EJECT                                                            39930000
367230                                                                  39940000
367300 EJECT                                                            39950000
367400*                                                                 39960000
367500 4300-SELECT-COUNTRY-ACTIVE.                                      39970000
367600                                                                  39980000
367700     EXEC SQL                                                     39990000
367800         SELECT A.CNTRY_NM                                        40000000
367900            INTO :CNTRY-CNTRY-NM                                  40010000
368000             FROM TCNTRY A                                        40020000
368100             WHERE A.CNTRY_CDE = :DK-COUNTRY-CODE                 40030000
368200               AND A.STAT_CDE  = :PC-A                            40040000
368300     END-EXEC                                                     40050000
368400                                                                  40060000
368500         EVALUATE TRUE                                            40070000
368600             WHEN SQLCODE = ZERO                                  40080000
368700                 SET ASC-VALID-COUNTRY-CODE TO TRUE               40090000
368800             WHEN SQLCODE = +100                                  40100000
368900                 SET ASC-INVALID-COUNTRY-CODE TO TRUE             40110000
369000                 MOVE SPACES TO CNTRY-CNTRY-NM                    40120000
369100             WHEN OTHER                                           40130000
369200                 MOVE '4300-SELECT-COUNTRY-ACTIVE'                40140000
369300                                   TO DP013-PARAGRAPH             40150000
369400                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          40160000
369500                                   TO DP013-MESSAGE-TEXT (1)      40170000
369600                 MOVE SQLCA        TO DP013-SQLCA                 40180000
369700                 MOVE 'TCNTRY  '   TO DP013-DB2-TABLE-NAME (1)    40190000
369800                 SET DP013-DB2-ABEND                              40200000
369900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40210000
370000                 PERFORM DP013-0000-PROCESS-ABEND                 40220000
370100         END-EVALUATE.                                            40230000
370200*                                                                 40240000
370300 4301-SELECT-COUNTRY-INACTIVE.                                    40250000
370400                                                                  40260000
370500     EXEC SQL                                                     40270000
370600         SELECT A.CNTRY_NM                                        40280000
370700            INTO :CNTRY-CNTRY-NM                                  40290000
370800             FROM TCNTRY A                                        40300000
370900             WHERE A.CNTRY_CDE = :DK-COUNTRY-CODE                 40310000
371000               AND A.STAT_CDE  = :PC-I                            40320000
371100     END-EXEC                                                     40330000
371200                                                                  40340000
371300         EVALUATE TRUE                                            40350000
371400             WHEN SQLCODE = ZERO                                  40360000
371500                 SET ASC-INACTIVE-COUNTRY-CODE TO TRUE            40370000
371600             WHEN SQLCODE = +100                                  40380000
371700                 SET ASC-INVALID-COUNTRY-CODE TO TRUE             40390000
371800                 MOVE SPACES TO CNTRY-CNTRY-NM                    40400000
371900             WHEN OTHER                                           40410000
372000                 MOVE '4301-SELECT-COUNTRY-INACTIVE'              40420000
372100                                   TO DP013-PARAGRAPH             40430000
372200                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          40440000
372300                                   TO DP013-MESSAGE-TEXT (1)      40450000
372400                 MOVE SQLCA        TO DP013-SQLCA                 40460000
372500                 MOVE 'TCNTRY  '   TO DP013-DB2-TABLE-NAME (1)    40470000
372600                 SET DP013-DB2-ABEND                              40480000
372700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40490000
372800                 PERFORM DP013-0000-PROCESS-ABEND                 40500000
372900         END-EVALUATE.                                            40510000
373000                                                                  40520000
373100                                                                  40530000
373200 4330-SELECT-ENTNME.                                              40540000
373300                                                                  40550000
373400     EXEC SQL                                                     40560000
373500         SELECT A.ENT_ID,                                         40570000
373600                A.ENT_NAME_DESC                                   40580000
373700            INTO :ENTNME-ENT-ID,                                  40590000
373800                 :ENTNME-ENT-NAME-DESC                            40600000
373900             FROM TENTNME A,                                      40610000
374000                  TEXTENT B                                       40620000
374100             WHERE A.ENT_ID = B.ENT_ID                            40630000
374200               AND B.SCAC_CDE LIKE :DK-ENT-NAME                   40640000
374300               AND A.TYPE_CDE = :PC-PRIMARY                       40650000
374400     END-EXEC                                                     40660000
374500                                                                  40670000
374600         EVALUATE TRUE                                            40680000
374700             WHEN SQLCODE = ZERO                                  40690000
374800             WHEN SQLCODE = -811                                  40700000
374900                 CONTINUE                                         40710000
375000             WHEN SQLCODE = +100                                  40720000
375100                 SET PS-ERROR                                     40730000
375200                        DP020-MSG-FATAL   TO TRUE                 40740000
375300                 MOVE ZEROES TO ENTNME-ENT-ID                     40750000
375400                 MOVE SPACES TO ENTNME-ENT-NAME-DESC              40760000
375500                 CONTINUE                                         40770000
375600             WHEN OTHER                                           40780000
375700                 MOVE '4330-SELECT-ENTNME'                        40790000
375800                                   TO DP013-PARAGRAPH             40800000
375900                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           40810000
376000                                   TO DP013-MESSAGE-TEXT (1)      40820000
376100                 MOVE SQLCA        TO DP013-SQLCA                 40830000
376200                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    40840000
376300                 SET DP013-DB2-ABEND                              40850000
376400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40860000
376500                 PERFORM DP013-0000-PROCESS-ABEND                 40870000
376600         END-EVALUATE.                                            40880000
376700                                                                  40890000
376800                                                                  40900000
376900 4331-SELECT-ENTNME-ENT.                                          40910000
377000                                                                  40920000
377100     EXEC SQL                                                     40930000
377200         SELECT B.SCAC_CDE,                                       40940000
377300                A.ENT_ID,                                         40950000
377400                A.ENT_NAME_DESC                                   40960000
377500            INTO :EXTENT-SCAC-CDE,                                40970000
377600                 :ENTNME-ENT-ID,                                  40980000
377700                 :ENTNME-ENT-NAME-DESC                            40990000
377800             FROM TENTNME A,                                      41000000
377900                  TEXTENT B                                       41010000
378000             WHERE A.ENT_ID = B.ENT_ID                            41020000
378100               AND A.ENT_ID = :DK-ENT-ID                          41030000
378200               AND A.TYPE_CDE = :PC-PRIMARY                       41040000
378300     END-EXEC                                                     41050000
378400                                                                  41060000
378500         EVALUATE TRUE                                            41070000
378600             WHEN SQLCODE = ZERO                                  41080000
378700             WHEN SQLCODE = -811                                  41090000
378800                 CONTINUE                                         41100000
378900             WHEN SQLCODE = +100                                  41110000
379000                 MOVE SPACES TO EXTENT-SCAC-CDE                   41120000
379100                 MOVE SPACES TO ENTNME-ENT-NAME-DESC              41130000
379200                 CONTINUE                                         41140000
379300             WHEN OTHER                                           41150000
379400                 MOVE '4331-SELECT-ENTNME-ID'                     41160000
379500                                   TO DP013-PARAGRAPH             41170000
379600                 MOVE 'SQL ERROR SELECTING ENTNME NAME'           41180000
379700                                   TO DP013-MESSAGE-TEXT (1)      41190000
379800                 MOVE SQLCA        TO DP013-SQLCA                 41200000
379900                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    41210000
380000                 SET DP013-DB2-ABEND                              41220000
380100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41230000
380200                 PERFORM DP013-0000-PROCESS-ABEND                 41240000
380300         END-EVALUATE.                                            41250000
380400                                                                  41260000
P5207  4332-SELECT-INCOTERM.                                            41270000
P5207                                                                   41280000
P5207      INITIALIZE DK-ATTR-ELEM-TXT-D.                               41281060
P5207                                                                   41282060
P5207      EXEC SQL                                                     41290000
P5207       SELECT   B.ATTR_ELEM_TXT,                                   41300000
P5207                C.ATTR_ELEM_TXT                                    41310000
P5207           INTO :WST00010-ATTR-ELEM-TXT,                           41320000
P5207                :DK-ATTR-ELEM-TXT-D                                41330000
P5207         FROM                                                      41340000
P5207               WST_INTGRTN_TYP  A                                  41350000
P5207            ,  WST_ATTR_ELEM    B                                  41360000
P5207            ,  WST_ATTR_ELEM    C                                  41370000
P5207            ,  WST_ATTR_ELEM    D                                  41380000
P5207         WHERE                                                     41390000
P5207               A.INTGRTN_TYP_CDE   = 'INCOTERMS'                   41400000
P5207           AND B.INTGRTN_TYP_CDE   = A.INTGRTN_TYP_CDE             41410000
P5207           AND B.ATTR_DEFN_SEQ_NBR = 1                             41420000
P5207           AND C.INTGRTN_TYP_CDE   = A.INTGRTN_TYP_CDE             41430000
P5207           AND C.ATTR_DEFN_SEQ_NBR = 2                             41440000
P5207           AND C.ATTR_ELEM_SEQ_NBR = B.ATTR_ELEM_SEQ_NBR           41450000
P5207           AND D.INTGRTN_TYP_CDE   = A.INTGRTN_TYP_CDE             41460000
P5207           AND D.ATTR_DEFN_SEQ_NBR = 3                             41470000
P5207           AND D.ATTR_ELEM_SEQ_NBR = B.ATTR_ELEM_SEQ_NBR           41480000
P5207           AND B.ATTR_ELEM_TXT     = :ASC-INCOTERM-CODE            41490000
P5207           AND D.ATTR_ELEM_TXT     = 'Y'                           41500000
P5207           WITH UR                                                 41501000
P5207      END-EXEC                                                     41510000
P5207                                                                   41520000
P5207          EVALUATE TRUE                                            41530000
P5207              WHEN SQLCODE = ZERO                                  41540000
P5207                  CONTINUE                                         41550000
P5207              WHEN SQLCODE = +100                                  41560000
P5207                  MOVE SPACES TO DK-ATTR-ELEM-TXT-TEXT-D           41570000
P5207                  CONTINUE                                         41580000
P5207              WHEN OTHER                                           41590000
P5207                  MOVE '4333-SELECT-INCOTERM '                     41600000
P5207                                    TO DP013-PARAGRAPH             41610000
P5207                  MOVE 'SQL ERROR SELECTING INCOTERM NAME'         41620000
P5207                                    TO DP013-MESSAGE-TEXT (1)      41630000
P5207                  MOVE SQLCA        TO DP013-SQLCA                 41640000
P5207                  MOVE 'WST_INTGRTN_TYP'                           41650000
P5207                        TO DP013-DB2-TABLE-NAME (1)                41660000
P5207                  SET DP013-DB2-ABEND                              41670000
P5207                      DP013-XCTL-DISPLAY-RESTART TO TRUE           41680000
P5207                  PERFORM DP013-0000-PROCESS-ABEND                 41690000
P5207          END-EVALUATE.                                            41700000
P5207                                                                   41710000
380500                                                                  41720000
380600 EJECT                                                            41730000
380700*----------------------------------------------------------------*41740000
380800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *41750000
380900*----------------------------------------------------------------*41760000
381000                                                                  41770000
381100 4400-MOVE-COMMAREA-TO-SCREEN.                                    41780000
381200                                                                  41790000
381300     MOVE ASC-COUNTRY-CODE         TO ACNTCODO.                   41800000
381400     MOVE ASC-COUNTRY-CODE-DESC    TO ACNTDESO.                   41810000
381500     MOVE ASC-COUNTRY-CODE         TO ACNTCODO                    41820000
381600     MOVE ASC-COUNTRY-CODE-DESC    TO ACNTDESO                    41830000
381700     MOVE ASC-CONSLR-SCAC          TO ACONSLCO                    41840000
381800     MOVE ASC-CONSLR-NAME          TO ACONSLNO                    41850000
381900     MOVE ASC-DECONL-SCAC          TO ADECONCO                    41860000
382000     MOVE ASC-DECONL-NAME          TO ADECONNO                    41870000
P5207      MOVE ASC-INCOTERM-CODE        TO AINCOTCO                    41880000
P5207      MOVE ASC-INCOTERM-CODE-DESC   TO AINCOTNO                    41890000
382100     MOVE ASC-CSTM-BKR-SCAC        TO ACSBRCOO                    41900000
382200     MOVE ASC-CSTM-BKR-NAME        TO ACSBRNOO                    41910000
382300     MOVE ASC-POE-CODE             TO APOECODO.                   41920000
382400     MOVE ASC-POE-CITY-NAME        TO APOEDESO.                   41930000
382500     MOVE ASC-FOB-STD-EDI-CDE      TO AEDICODO.                   41940000
382600                                                                  41950000
382700 EJECT                                                            41960000
382800*----------------------------------------------------------------*41970000
382900* CREATE THE COUNTRY CODE OBJECT ON THE TIMFOB TABLE.            *41980000
383000*----------------------------------------------------------------*41990000
383100 5000-ADD-FOB-CODE.                                               42000000
383200     MOVE ASC-COUNTRY-CODE         TO CNTRY-CNTRY-CDE             42010000
383300                                                                  42020000
383400     MOVE 'A'                      TO DK-FOB-STAT-CDE.            42030000
383500     PERFORM 5100-UPDATE-FOB-CODE.                                42040000
383600                                                                  42050000
383700     IF  ASC-USE-SEL-QUEUE                                        42060000
383800         PERFORM 5200-UPDATE-SELECTION-QUEUE                      42070000
383900     END-IF.                                                      42080000
384000*----------------------------------------------------------------*42090000
384100* UPDATE A ROW OF THE TIMFOB TABLE.                              *42100000
384200*----------------------------------------------------------------*42110000
384300 5100-UPDATE-FOB-CODE.                                            42120000
384400                                                                  42130000
384500     MOVE ASC-FOB-CODE         TO IMFOB-FOB-CDE                   42140000
384600     MOVE ASC-COUNTRY-CODE     TO IMFOB-FOB-CNTRY-CDE             42150000
384700     MOVE ASC-FOB-CITY-NAME    TO IMFOB-FOB-CTY-NM                42160000
384800     MOVE ASC-CONSLR-ENT-ID    TO IMFOB-CONSLR-ENT-ID             42170000
384900     MOVE ASC-DECONL-ENT-ID    TO IMFOB-DCONSLR-ENT-ID            42180000
P5207      MOVE ASC-INCOTERM-CODE    TO IMFOB-INCTRM-CDE                42190000
385000     MOVE ASC-CSTM-BKR-ENT-ID  TO IMFOB-CSTM-BKR-ENT-ID           42200000
385100     MOVE ASC-POE-CODE         TO IMFOB-POE-CDE                   42210000
385200     MOVE ASC-FOB-STD-EDI-CDE  TO IMFOB-FOB-STD-EDI-CDE           42220000
385300     MOVE DP020-USERID         TO IMFOB-LAST-UPD-USR-ID           42230000
385400     MOVE PC-A                 TO IMFOB-STAT-CDE                  42240000
385500     MOVE PC-I                 TO DK-STAT-CDE                     42250000
385600                                                                  42260000
385700     EXEC SQL                                                     42270000
385800       UPDATE TIMFOB                                              42280000
385900         SET  FOB_STD_EDI_CDE  = :IMFOB-FOB-STD-EDI-CDE           42290000
386000            , FOB_CTY_NM       = :IMFOB-FOB-CTY-NM                42300000
386100            , FOB_CNTRY_CDE    = :IMFOB-FOB-CNTRY-CDE             42310000
386200            , CONSLR_ENT_ID    = :IMFOB-CONSLR-ENT-ID             42320000
386300            , CSTM_BKR_ENT_ID  = :IMFOB-CSTM-BKR-ENT-ID           42330000
386400            , DCONSLR_ENT_ID   = :IMFOB-DCONSLR-ENT-ID            42340000
386500            , POE_CDE          = :IMFOB-POE-CDE                   42350000
386600            , STAT_CDE         = :IMFOB-STAT-CDE                  42360000
P5207             , INCTRM_CDE       = :IMFOB-INCTRM-CDE                42370000
386700            , LAST_UPD_TMST    = CURRENT TIMESTAMP                42380000
386800            , LAST_UPD_USR_ID  = :IMFOB-LAST-UPD-USR-ID           42390000
386900       WHERE  FOB_CDE       = :IMFOB-FOB-CDE                      42400000
387000         AND  STAT_CDE      =  :DK-STAT-CDE                       42410000
387100     END-EXEC.                                                    42420000
387200                                                                  42430000
387300                                                                  42440000
387400     EVALUATE TRUE                                                42450000
387500         WHEN SQLCODE = ZERO                                      42460000
387600             MOVE 'U'    TO DK-FUNC-CDE                           42470000
387700             PERFORM 6200-UPDATE-AUDIT-FOB-CODE                   42480000
387800             CONTINUE                                             42490000
387900         WHEN SQLCODE = +100                                      42500000
388000         WHEN SQLCODE = -803                                      42510000
388100             PERFORM 6010-ADD-INACTIVE-FOB                        42520000
388200         WHEN SQLWARN0 NOT = SPACES                               42530000
388300         WHEN SQLCODE < ZERO                                      42540000
388400         WHEN SQLCODE > ZERO                                      42550000
388500             MOVE '5100-UPDATE-FOB-CODE'                          42560000
388600                               TO DP013-PARAGRAPH                 42570000
388700             MOVE 'INSERT A ROW INTO THE FOB CODE TABLE'          42580000
388800                               TO DP013-MESSAGE-TEXT(1)           42590000
388900             MOVE SQLCA        TO DP013-SQLCA                     42600000
389000             MOVE 'TIMFOB'     TO DP013-DB2-TABLE-NAME (1)        42610000
389100             SET DP013-DB2-ABEND                                  42620000
389200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42630000
389300             PERFORM DP013-0000-PROCESS-ABEND                     42640000
389400     END-EVALUATE.                                                42650000
389500 EJECT                                                            42660000
389600                                                                  42670000
389700 5200-UPDATE-SELECTION-QUEUE.                                     42680000
389800                                                                  42690000
389900     PERFORM 9100-READ-SEL-QUEUE.                                 42700000
390000                                                                  42710000
390100     IF  ASC-DEL-COMPLETE                                         42720000
390200         SET TR021-DEL (ASC-SEL-SUB) TO TRUE                      42730000
390300         SET TR019-RECORD-UPDATED TO TRUE                         42740000
390400                                                                  42750000
390500*        MOVE CNTRY-CNTRY-NM TO TR019-COUNTRY-CODE-DESC           42760000
390600         MOVE CNTRY-CNTRY-NM TO TR019-COUNTRY-CODE                42770000
390700                                                                  42780000
390800         MOVE 'A'            TO TR019-STAT-CDE                    42790000
390900         MOVE ASC-COUNTRY-CODE                                    42800000
391000           TO TR021-FOB-CNTRY-CODE (ASC-SEL-SUB)                  42810000
391100         MOVE ASC-FOB-CITY-NAME                                   42820000
391200           TO TR021-FOB-CITY-NAME (ASC-SEL-SUB)                   42830000
391300         MOVE ASC-CONSLR-SCAC                                     42840000
391400           TO TR021-CONSLR-SCAC (ASC-SEL-SUB)                     42850000
391500         MOVE ASC-CONSLR-ENT-ID                                   42860000
391600           TO TR021-CONSLR-ENT-ID (ASC-SEL-SUB)                   42870000
391700         MOVE ASC-DECONL-SCAC                                     42880000
391800           TO TR021-DECONL-SCAC (ASC-SEL-SUB)                     42890000
391900         MOVE ASC-DECONL-ENT-ID                                   42900000
392000           TO TR021-DECONL-ENT-ID (ASC-SEL-SUB)                   42910000
P5207          MOVE ASC-INCOTERM-CODE                                   42920000
P5207            TO TR021-INCOTERM-CODE (ASC-SEL-SUB)                   42930000
392100         MOVE ASC-CSTM-BKR-SCAC                                   42940000
392200           TO TR021-CSTM-BKR-SCAC (ASC-SEL-SUB)                   42950000
392300         MOVE ASC-CSTM-BKR-ENT-ID                                 42960000
392400           TO TR021-CSTM-BKR-ENT-ID (ASC-SEL-SUB)                 42970000
392500         MOVE ASC-POE-CODE                                        42980000
392600           TO TR021-POE-CODE (ASC-SEL-SUB)                        42990000
392700         MOVE ASC-FOB-STD-EDI-CDE                                 43000000
392800           TO TR021-FOB-STD-EDI-CDE (ASC-SEL-SUB)                 43010000
392900     ELSE                                                         43020000
393000         SET TR021-UPD (ASC-SEL-SUB) TO TRUE                      43030000
393100*        MOVE CNTRY-CNTRY-NM TO TR019-COUNTRY-CODE-DESC           43040000
393200         MOVE CNTRY-CNTRY-NM TO TR019-COUNTRY-CODE                43050000
393300         MOVE ASC-FOB-CODE                                        43060000
393400                             TO TR019-FOB-CODE                    43070000
393500         MOVE ASC-FOB-CITY-NAME                                   43080000
393600                             TO TR019-FOB-CITY-NAME               43090000
393700         MOVE ASC-COUNTRY-CODE                                    43100000
393800                             TO TR019-COUNTRY-CODE                43110000
393900         MOVE ASC-CONSLR-SCAC                                     43120000
394000                             TO TR019-CONSLR-SCAC                 43130000
394100         MOVE ASC-CONSLR-NAME                                     43140000
394200                             TO TR019-CONSLR-NAME                 43150000
394300         MOVE ASC-CONSLR-ENT-ID                                   43160000
394400                             TO TR019-CONSLR-ENT-ID               43170000
394500         MOVE ASC-DECONL-SCAC                                     43180000
394600                             TO TR019-DECONL-SCAC                 43190000
394700         MOVE ASC-DECONL-NAME                                     43200000
394800                             TO TR019-DECONL-NAME                 43210000
394900         MOVE ASC-DECONL-ENT-ID                                   43220000
395000                             TO TR019-DECONL-ENT-ID               43230000
P5207          MOVE ASC-INCOTERM-CODE                                   43240000
P5207                              TO TR019-INCOTERM-CODE               43250000
395100         MOVE ASC-CSTM-BKR-SCAC                                   43280000
395200                             TO TR019-CSTM-BKR-SCAC               43290000
395300         MOVE ASC-CSTM-BKR-NAME                                   43300000
395400                             TO TR019-CSTM-BKR-NAME               43310000
395500         MOVE ASC-CSTM-BKR-ENT-ID                                 43320000
395600                             TO TR019-CSTM-BKR-ENT-ID             43330000
395700         MOVE ASC-POE-CODE                                        43340000
395800                             TO TR019-POE-CODE                    43350000
395900         MOVE ASC-POE-CITY-NAME                                   43360000
396000                             TO TR019-POE-CITY-NAME               43370000
396100         MOVE ASC-FOB-STD-EDI-CDE                                 43380000
396200                             TO TR019-FOB-STD-EDI-CDE             43390000
396300         MOVE ASC-COUNTRY-CODE                                    43400000
396400           TO TR021-FOB-CNTRY-CODE (ASC-SEL-SUB)                  43410000
396500         MOVE ASC-FOB-CITY-NAME                                   43420000
396600           TO TR021-FOB-CITY-NAME (ASC-SEL-SUB)                   43430000
396700         MOVE ASC-CONSLR-SCAC                                     43440000
396800           TO TR021-CONSLR-SCAC (ASC-SEL-SUB)                     43450000
396900         MOVE ASC-CONSLR-ENT-ID                                   43460000
397000           TO TR021-CONSLR-ENT-ID (ASC-SEL-SUB)                   43470000
397100         MOVE ASC-DECONL-SCAC                                     43480000
397200           TO TR021-DECONL-SCAC (ASC-SEL-SUB)                     43490000
397300         MOVE ASC-DECONL-ENT-ID                                   43500000
397400           TO TR021-DECONL-ENT-ID (ASC-SEL-SUB)                   43510000
P5207          MOVE ASC-INCOTERM-CODE                                   43520000
P5207            TO TR021-INCOTERM-CODE (ASC-SEL-SUB)                   43530000
397500         MOVE ASC-CSTM-BKR-SCAC                                   43540000
397600           TO TR021-CSTM-BKR-SCAC (ASC-SEL-SUB)                   43550000
397700         MOVE ASC-CSTM-BKR-ENT-ID                                 43560000
397800           TO TR021-CSTM-BKR-ENT-ID (ASC-SEL-SUB)                 43570000
397900         MOVE ASC-POE-CODE                                        43580000
398000           TO TR021-POE-CODE (ASC-SEL-SUB)                        43590000
398100         MOVE ASC-FOB-STD-EDI-CDE                                 43600000
398200           TO TR021-FOB-STD-EDI-CDE (ASC-SEL-SUB)                 43610000
398300     END-IF.                                                      43620000
398400                                                                  43630000
398500     PERFORM 9200-REWRITE-SEL-QUEUE.                              43640000
398600                                                                  43650000
398700 6000-UPDATE-FOB.                                                 43660000
398800                                                                  43670000
398900     MOVE ASC-COUNTRY-CODE         TO CNTRY-CNTRY-CDE.            43680000
399000     MOVE ASC-COUNTRY-CODE-DESC    TO CNTRY-CNTRY-NM.             43690000
399100     MOVE 'A'                      TO DK-FOB-STAT-CDE.            43700000
399200     PERFORM 6100-UPDATE-FOB-CODE.                                43710000
399300     IF  ASC-USE-SEL-QUEUE                                        43720000
399400         PERFORM 5200-UPDATE-SELECTION-QUEUE                      43730000
399500     END-IF.                                                      43740000
399600                                                                  43750000
399700 6010-ADD-INACTIVE-FOB.                                           43760000
399800                                                                  43770000
399900     MOVE 'I'                      TO DK-STAT-CDE.                43780000
400000     MOVE 'A'                      TO DK-FOB-STAT-CDE.            43790000
400100                                                                  43800000
400200     PERFORM 6100-UPDATE-FOB-CODE.                                43810000
400300                                                                  43820000
400400     IF ASC-COUNTRY-CODE-DESC = SPACE                             43830000
400500         MOVE CNTRY-CNTRY-NM TO                                   43840000
400600             ASC-COUNTRY-CODE-DESC                                43850000
400700             ACNTDESO                                             43860000
400800     END-IF.                                                      43870000
400900     MOVE DP015-GREEN              TO ACNTCODC                    43880000
401000     MOVE DP015-BLUE               TO ACNTDESC.                   43890000
401100     MOVE DP015-UNP-ALP-BRT-OFF    TO ACNTCODA                    43900000
401200     MOVE DP015-PRO-NOR-OFF        TO ACNTDESA.                   43910000
401300     MOVE DP015-HL-OFF             TO ACNTDESH.                   43920000
401400                                                                  43930000
401500     IF  ASC-USE-SEL-QUEUE                                        43940000
401600         PERFORM 5200-UPDATE-SELECTION-QUEUE                      43950000
401700     END-IF.                                                      43960000
401800                                                                  43970000
401900*----------------------------------------------------------------*43980000
402000* UPDATE A ROW IN THE TIMFOB TABLE.                              *43990000
402100*----------------------------------------------------------------*44000000
402200 6100-UPDATE-FOB-CODE.                                            44010000
402300                                                                  44020000
402400     MOVE ASC-FOB-CODE          TO IMFOB-FOB-CDE                  44030000
402500     MOVE ASC-FOB-STD-EDI-CDE   TO IMFOB-FOB-STD-EDI-CDE          44040000
402600     MOVE ASC-FOB-CITY-NAME     TO IMFOB-FOB-CTY-NM               44050000
402700     MOVE ASC-COUNTRY-CODE      TO IMFOB-FOB-CNTRY-CDE            44060000
402800*    MOVE ASC-COUNTRY-CODE-DESC TO TR019-COUNTRY-CODE-DESC        44070000
402900     MOVE ASC-POE-CODE          TO IMFOB-POE-CDE                  44080000
403000     MOVE ASC-POE-CITY-NAME     TO TR019-POE-CITY-NAME            44090000
403100                                                                  44100000
403200     MOVE ASC-CONSLR-SCAC       TO TR019-CONSLR-SCAC              44110000
403300     MOVE ASC-CONSLR-NAME       TO TR019-CONSLR-NAME              44120000
403400     MOVE ASC-CONSLR-ENT-ID     TO IMFOB-CONSLR-ENT-ID            44130000
403500     MOVE ASC-DECONL-SCAC       TO TR019-DECONL-SCAC              44140000
403600     MOVE ASC-DECONL-NAME       TO TR019-DECONL-NAME              44150000
403700     MOVE ASC-DECONL-ENT-ID     TO IMFOB-DCONSLR-ENT-ID           44160000
P5207      MOVE ASC-INCOTERM-CODE     TO TR019-INCOTERM-CODE            44170000
P5207      MOVE ASC-INCOTERM-CODE     TO IMFOB-INCTRM-CDE               44180000
403800     MOVE ASC-CSTM-BKR-SCAC     TO TR019-CSTM-BKR-SCAC            44190000
403900     MOVE ASC-CSTM-BKR-NAME     TO TR019-CSTM-BKR-NAME            44200000
404000     MOVE ASC-CSTM-BKR-ENT-ID   TO IMFOB-CSTM-BKR-ENT-ID          44210000
404100     MOVE DP020-USERID          TO IMFOB-LAST-UPD-USR-ID          44220000
404200     MOVE 'A'                   TO DK-STAT-CDE                    44230000
404300                                                                  44240000
404400     EXEC SQL                                                     44250000
404500       UPDATE TIMFOB                                              44260000
404600         SET  FOB_STD_EDI_CDE  = :IMFOB-FOB-STD-EDI-CDE           44270000
404700            , FOB_CTY_NM       = :IMFOB-FOB-CTY-NM                44280000
404800            , FOB_CNTRY_CDE    = :IMFOB-FOB-CNTRY-CDE             44290000
404900            , CONSLR_ENT_ID    = :IMFOB-CONSLR-ENT-ID             44300000
405000            , CSTM_BKR_ENT_ID  = :IMFOB-CSTM-BKR-ENT-ID           44310000
405100            , DCONSLR_ENT_ID   = :IMFOB-DCONSLR-ENT-ID            44320000
405200            , LAST_UPD_TMST    = CURRENT TIMESTAMP                44330000
405300            , LAST_UPD_USR_ID  = :IMFOB-LAST-UPD-USR-ID           44340000
405400            , POE_CDE          = :IMFOB-POE-CDE                   44350000
P5207             , INCTRM_CDE       = :IMFOB-INCTRM-CDE                44360000
405500       WHERE  FOB_CDE       = :IMFOB-FOB-CDE                      44370000
405600         AND  STAT_CDE      =  :DK-STAT-CDE                       44380000
405700     END-EXEC.                                                    44390000
405800                                                                  44400000
405900     EVALUATE TRUE                                                44410000
406000         WHEN SQLCODE = ZERO                                      44420000
406100             MOVE 'U' TO DK-FUNC-CDE                              44430000
406200             PERFORM 6200-UPDATE-AUDIT-FOB-CODE                   44440000
406300             CONTINUE                                             44450000
406400         WHEN SQLCODE = +100                                      44460000
406500             PERFORM 6150-INSERT-FOB-CODE                         44470000
406600         WHEN SQLWARN0 NOT = SPACES                               44480000
406700         WHEN SQLCODE < ZERO                                      44490000
406800         WHEN SQLCODE > ZERO                                      44500000
406900             MOVE '6100-UPDATE-FOB-CODE'                          44510000
407000                               TO DP013-PARAGRAPH                 44520000
407100             MOVE 'UPDATE A ROW INTO THE FOB CODE TABLE'          44530000
407200                               TO DP013-MESSAGE-TEXT(1)           44540000
407300             MOVE SQLCA        TO DP013-SQLCA                     44550000
407400             MOVE 'TIMFOB'     TO DP013-DB2-TABLE-NAME (1)        44560000
407500             SET DP013-DB2-ABEND                                  44570000
407600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               44580000
407700             PERFORM DP013-0000-PROCESS-ABEND                     44590000
407800     END-EVALUATE.                                                44600000
407900                                                                  44610000
408000                                                                  44620000
408100*----------------------------------------------------------------*44630000
408200* INSERT A ROW IN THE TIMFOB TABLE.                              *44640000
408300*----------------------------------------------------------------*44650000
408400 6150-INSERT-FOB-CODE.                                            44660000
408500                                                                  44670000
408600     MOVE ASC-FOB-CODE          TO IMFOB-FOB-CDE                  44680000
408700     MOVE ASC-COUNTRY-CODE      TO IMFOB-FOB-CNTRY-CDE            44690000
408800     MOVE ASC-FOB-CITY-NAME     TO IMFOB-FOB-CTY-NM               44700000
408900     MOVE ASC-CONSLR-ENT-ID     TO IMFOB-CONSLR-ENT-ID            44710000
409000     MOVE ASC-DECONL-ENT-ID     TO IMFOB-DCONSLR-ENT-ID           44720000
P5207      MOVE ASC-INCOTERM-CODE     TO IMFOB-INCTRM-CDE               44730000
409100     MOVE ASC-CSTM-BKR-ENT-ID   TO IMFOB-CSTM-BKR-ENT-ID          44740000
409200     MOVE ASC-POE-CODE          TO IMFOB-POE-CDE                  44750000
409300     MOVE ASC-FOB-STD-EDI-CDE   TO IMFOB-FOB-STD-EDI-CDE          44760000
409400     MOVE DP020-USERID          TO IMFOB-LAST-UPD-USR-ID          44770000
409500                                                                  44780000
409600     EXEC SQL                                                     44790000
409700                                                                  44800000
409800       INSERT INTO TIMFOB                                         44810000
409900             ( FOB_CDE                                            44820000
410000              ,FOB_STD_EDI_CDE                                    44830000
410100              ,FOB_CTY_NM                                         44840000
410200              ,FOB_CNTRY_CDE                                      44850000
410300              ,CONSLR_ENT_ID                                      44860000
410400              ,CSTM_BKR_ENT_ID                                    44870000
410500              ,POE_CDE                                            44880000
410600              ,STAT_CDE                                           44890000
410700              ,LAST_UPD_TMST                                      44900000
410800              ,LAST_UPD_USR_ID                                    44910000
P5207               ,DCONSLR_ENT_ID                                     44920000
P5207               ,INCTRM_CDE)                                        44930000
411000       VALUES                                                     44940000
411100            ( :IMFOB-FOB-CDE                                      44950000
411200            , :IMFOB-FOB-STD-EDI-CDE                              44960000
411300            , :IMFOB-FOB-CTY-NM                                   44970000
411400            , :IMFOB-FOB-CNTRY-CDE                                44980000
411500            , :IMFOB-CONSLR-ENT-ID                                44990000
411600            , :IMFOB-CSTM-BKR-ENT-ID                              45000000
411700            , :IMFOB-POE-CDE                                      45010000
411800            , :PC-A                                               45020000
411900            ,  CURRENT TIMESTAMP                                  45030000
412000            , :IMFOB-LAST-UPD-USR-ID                              45040000
P5207             , :IMFOB-DCONSLR-ENT-ID                               45050000
P5207             , :IMFOB-INCTRM-CDE)                                  45060000
412200                                                                  45070000
412300     END-EXEC.                                                    45080000
412400                                                                  45090000
412500     EVALUATE TRUE                                                45100000
412600         WHEN SQLCODE = ZERO                                      45110000
412700             CONTINUE                                             45120000
412800         WHEN SQLWARN0 NOT = SPACES                               45130000
412900         WHEN SQLCODE < ZERO                                      45140000
413000         WHEN SQLCODE > ZERO                                      45150000
413100             MOVE '6150-INSERT-FOB-CODE'                          45160000
413200                               TO DP013-PARAGRAPH                 45170000
413300             MOVE 'UPDATE A ROW INTO THE FOB CODE TABLE'          45180000
413400                               TO DP013-MESSAGE-TEXT(1)           45190000
413500             MOVE SQLCA        TO DP013-SQLCA                     45200000
413600             MOVE 'TIMFOB'     TO DP013-DB2-TABLE-NAME (1)        45210000
413700             SET DP013-DB2-ABEND                                  45220000
413800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               45230000
413900             PERFORM DP013-0000-PROCESS-ABEND                     45240000
414000     END-EVALUATE.                                                45250000
414100                                                                  45260000
414200*----------------------------------------------------------------*45270000
414300* UPDATE A ROW IN THE FOB AUDIT TABLE.                           *45280000
414400*----------------------------------------------------------------*45290000
414500 6200-UPDATE-AUDIT-FOB-CODE.                                      45300000
414600                                                                  45310000
414700     MOVE TR019-FOB-CODE        TO AUFOB-FOB-CDE                  45320000
414800     MOVE ASC-FOB-CODE          TO TR019-FOB-CODE                 45330000
414900                                                                  45340000
415000     MOVE TR019-COUNTRY-CODE    TO AUFOB-FOB-CNTRY-CDE            45350000
415100     MOVE ASC-COUNTRY-CODE      TO TR019-COUNTRY-CODE             45360000
415200                                                                  45370000
415300     MOVE TR019-FOB-CITY-NAME   TO AUFOB-FOB-CTY-NM               45380000
415400     MOVE ASC-FOB-CITY-NAME     TO TR019-FOB-CITY-NAME            45390000
415500                                                                  45400000
415600     MOVE TR019-CONSLR-ENT-ID   TO AUFOB-CONSLR-ENT-ID            45410000
415700     MOVE ASC-CONSLR-ENT-ID     TO TR019-CONSLR-ENT-ID            45420000
415800                                                                  45430000
415900     MOVE TR019-CSTM-BKR-ENT-ID TO AUFOB-CSTM-BKR-ENT-ID          45440000
416000     MOVE ASC-CSTM-BKR-ENT-ID   TO TR019-CSTM-BKR-ENT-ID          45450000
416100                                                                  45460000
416200     MOVE TR019-POE-CODE        TO AUFOB-POE-CDE                  45470000
416300     MOVE ASC-POE-CODE          TO TR019-POE-CODE                 45480000
416400                                                                  45490000
416500     MOVE TR019-FOB-STD-EDI-CDE TO AUFOB-FOB-STD-EDI-CDE          45500000
416600     MOVE ASC-FOB-STD-EDI-CDE   TO TR019-FOB-STD-EDI-CDE          45510000
416700                                                                  45520000
416710     MOVE TR019-DECONL-ENT-ID    TO AUFOB-DCONSLR-ENT-ID          45530000
416720     MOVE ASC-DECONL-ENT-ID      TO TR019-DECONL-ENT-ID           45540000
P5207                                                                   45550000
P5207      MOVE TR019-INCOTERM-CODE    TO AUFOB-INCTRM-CDE              45560000
P5207      MOVE ASC-INCOTERM-CODE      TO TR019-INCOTERM-CODE           45570000
416730                                                                  45580000
416800     MOVE DP020-USERID          TO AUFOB-LAST-UPD-USR-ID          45590000
416900     MOVE DK-STAT-CDE           TO AUFOB-STAT-CDE                 45600000
417000     MOVE DK-FUNC-CDE           TO AUFOB-AUD-FUNC-CDE             45610000
417100                                                                  45620000
417200     EXEC SQL                                                     45630000
417300       INSERT INTO TAUFOB                                         45640000
417400             ( FOB_CDE                                            45650000
417500              ,FOB_STD_EDI_CDE                                    45660000
417600              ,FOB_CTY_NM                                         45670000
417700              ,FOB_CNTRY_CDE                                      45680000
417800              ,CONSLR_ENT_ID                                      45690000
417900              ,CSTM_BKR_ENT_ID                                    45700000
418000              ,POE_CDE                                            45710000
418100              ,STAT_CDE                                           45720000
418200              ,LAST_UPD_TMST                                      45730000
418300              ,LAST_UPD_USR_ID                                    45740000
418400              ,AUD_FUNC_CDE                                       45750000
P5207               ,DCONSLR_ENT_ID                                     45760000
P5207               ,INCTRM_CDE)                                        45770000
418500       VALUES                                                     45780000
418600            (:AUFOB-FOB-CDE,                                      45790000
418700             :AUFOB-FOB-STD-EDI-CDE,                              45800000
418800             :AUFOB-FOB-CTY-NM,                                   45810000
418900             :AUFOB-FOB-CNTRY-CDE,                                45820000
419000             :AUFOB-CONSLR-ENT-ID,                                45830000
419100             :AUFOB-CSTM-BKR-ENT-ID,                              45840000
419200             :AUFOB-POE-CDE,                                      45850000
419300             :AUFOB-STAT-CDE,                                     45860000
419400              CURRENT TIMESTAMP,                                  45870000
419500             :AUFOB-LAST-UPD-USR-ID,                              45880000
419600             :AUFOB-AUD-FUNC-CDE,                                 45890000
P5207              :AUFOB-DCONSLR-ENT-ID,                               45900000
P5207              :AUFOB-INCTRM-CDE)                                   45910000
419700     END-EXEC.                                                    45920000
419800                                                                  45930000
419900     EVALUATE TRUE                                                45940000
420000         WHEN SQLCODE = ZERO                                      45950000
420100             CONTINUE                                             45960000
420200         WHEN SQLWARN0 NOT = SPACES                               45970000
420300         WHEN SQLCODE < ZERO                                      45980000
420400         WHEN SQLCODE > ZERO                                      45990000
420500             MOVE '6200-UPDATE-AUDCIT-FOB-CODE'                   46000000
420600                               TO DP013-PARAGRAPH                 46010000
420700             MOVE 'UPDATE A ROW INTO THE FOB CODE TABLE'          46020000
420800                               TO DP013-MESSAGE-TEXT(1)           46030000
420900             MOVE SQLCA        TO DP013-SQLCA                     46040000
421000             MOVE 'TAUFOB'     TO DP013-DB2-TABLE-NAME (1)        46050000
421100             SET DP013-DB2-ABEND                                  46060000
421200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               46070000
421300             PERFORM DP013-0000-PROCESS-ABEND                     46080000
421400     END-EVALUATE.                                                46090000
421500                                                                  46100000
421600 7000-DEL-FOB-CODE.                                               46110000
421700                                                                  46120000
421800     MOVE 'A'         TO DK-STAT-CDE                              46130000
421900     MOVE 'I'         TO DK-FOB-STAT-CDE                          46140000
422000     MOVE 'D'         TO DK-FUNC-CDE                              46150000
422100                                                                  46160000
422200     PERFORM 6200-UPDATE-AUDIT-FOB-CODE                           46170000
422300     PERFORM 7100-INACTIVATE-FOB                                  46180000
422400                                                                  46190000
422500     MOVE PC-TSYMSG-00115    TO DP020-MSG-NUMBER                  46200000
422600     SET DP020-MSG-INFORMATIONAL                                  46210000
422700         ASC-DEL-COMPLETE    TO TRUE                              46220000
422800                                                                  46230000
422900     IF  ASC-USE-SEL-QUEUE                                        46240000
423000         PERFORM 5200-UPDATE-SELECTION-QUEUE                      46250000
423100     END-IF.                                                      46260000
423200                                                                  46270000
423300*----------------------------------------------------------------*46280000
423400* DELETE A ROW IN THE TIMFOB TABLE.                              *46290000
423500*----------------------------------------------------------------*46300000
423600 7100-INACTIVATE-FOB.                                             46310000
423700                                                                  46320000
423800     MOVE TR019-FOB-CODE TO IMFOB-FOB-CDE                         46330000
423900     MOVE DP020-USERID         TO IMFOB-LAST-UPD-USR-ID           46340000
424000                                                                  46350000
424100     EXEC SQL                                                     46360000
424200       UPDATE TIMFOB                                              46370000
424300         SET  STAT_CDE         = :PC-I                            46380000
424400            , LAST_UPD_TMST = CURRENT TIMESTAMP                   46390000
424500            , LAST_UPD_USR_ID = :IMFOB-LAST-UPD-USR-ID            46400000
424600       WHERE  FOB_CDE       = :IMFOB-FOB-CDE                      46410000
424700     END-EXEC.                                                    46420000
424800                                                                  46430000
424900     EVALUATE TRUE                                                46440000
425000         WHEN SQLCODE = ZERO                                      46450000
425100             CONTINUE                                             46460000
425200         WHEN SQLWARN0 NOT = SPACES                               46470000
425300         WHEN SQLCODE < ZERO                                      46480000
425400         WHEN SQLCODE > ZERO                                      46490000
425500             MOVE '7100-INACTIVATE-FOB'                           46500000
425600                               TO DP013-PARAGRAPH                 46510000
425700             MOVE 'UPDATE A ROW INTO THE FOB CODE TABLE'          46520000
425800                               TO DP013-MESSAGE-TEXT(1)           46530000
425900             MOVE SQLCA        TO DP013-SQLCA                     46540000
426000             MOVE 'TIMFOB'     TO DP013-DB2-TABLE-NAME (1)        46550000
426100             SET DP013-DB2-ABEND                                  46560000
426200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               46570000
426300             PERFORM DP013-0000-PROCESS-ABEND                     46580000
426400     END-EVALUATE.                                                46590000
426500 EJECT                                                            46600000
426600/                                                                 46610000
426700*----------------------------------------------------------------*46620000
426800*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *46630000
426900*----------------------------------------------------------------*46640000
427000                                                                  46650000
427100 9100-READ-SEL-QUEUE.                                             46660000
427200                                                                  46670000
427300     EXEC CICS                                                    46680000
427400         READQ TS                                                 46690000
427500             QUEUE (ASC-SEL-QUEUE-NAME)                           46700000
427600             INTO  ( TR021-FOB-SEL-REC )                          46710000
427700             ITEM  (ASC-SEL-ITEM)                                 46720000
427800             RESP  (PV-CICS-RESPONSE)                             46730000
427900     END-EXEC.                                                    46740000
428000                                                                  46750000
428100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       46760000
428200         CONTINUE                                                 46770000
428300     ELSE                                                         46780000
428400         SET DP013-LOGIC-ABEND                                    46790000
428500             DP013-NO-ROLLBACK     TO TRUE                        46800000
428600         MOVE '9100-READ-SEL-QUEUE'                               46810000
428700                                   TO DP013-PARAGRAPH             46820000
428800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46830000
428900                                   TO DP013-MESSAGE-TEXT (1)      46840000
429000         MOVE ASC-SEL-TASK         TO PV-DISPLAY-TASK             46850000
429100         STRING 'QUEUE ID: '                                      46860000
429200                ASC-SEL-TERM-ID                                   46870000
429300                ' '                                               46880000
429400                PV-DISPLAY-TASK                                   46890000
429500                ' '                                               46900000
429600                ASC-SEL-SEQ DELIMITED BY SIZE                     46910000
429700                               INTO DP013-MESSAGE-TEXT (2)        46920000
429800         PERFORM DP013-0000-PROCESS-ABEND                         46930000
429900     END-IF.                                                      46940000
430000                                                                  46950000
430100/                                                                 46960000
430200*----------------------------------------------------------------*46970000
430300*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *46980000
430400*----------------------------------------------------------------*46990000
430500 9200-REWRITE-SEL-QUEUE.                                          47000000
430600                                                                  47010000
430700     EXEC CICS                                                    47020000
430800          WRITEQ TS                                               47030000
430900              QUEUE  (ASC-SEL-QUEUE-NAME)                         47040000
431000              FROM   (TR021-FOB-SEL-REC)                          47050000
431100              ITEM   (ASC-SEL-ITEM)                               47060000
431200              RESP   (PV-CICS-RESPONSE)                           47070000
431300              REWRITE                                             47080000
431400     END-EXEC.                                                    47090000
431500                                                                  47100000
431600     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   47110000
431700         SET DP013-CICS-ABEND                                     47120000
431800             DP013-NO-ROLLBACK     TO TRUE                        47130000
431900         MOVE '9200-REWRITE-SEL-QUEUE'                            47140000
432000                                   TO DP013-PARAGRAPH             47150000
432100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   47160000
432200                                   TO DP013-MESSAGE-TEXT (1)      47170000
432300         PERFORM DP013-0000-PROCESS-ABEND                         47180000
432400     END-IF.                                                      47190000
432500                                                                  47200000
432600*----------------------------------------------------------------*47210000
432700*    ABEND PROCESSOR MODULE                                      *47220000
432800*----------------------------------------------------------------*47230000
432900                                                                  47240000
433000     COPY DPPD013.                                                47250000
433100                                                                  47260000
433200*----------------------------------------------------------------*47270000
433300*    LINK TO CICS OBJECT LOCKING MODULE                          *47280000
433400*----------------------------------------------------------------*47290000
433500                                                                  47300000
433600     COPY DPPD044.                                                47310000
