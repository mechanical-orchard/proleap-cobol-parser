000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS591.                                         00040000
000500 AUTHOR.        LYNN MCADAMS.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  FEB, 2002.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S591 - AUDITED CARTON LIST PROGRAM.                        * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF THE CARTONS THAT WERE     * 00130000
001400*    SCANNED/SELECTED FOR AN AUDIT.  CARTON ID, AUDIT STATUS,   * 00140000
001500*    AUDIT START DATE/TIME, AUDIT STOP DATE/TIME, USER ID,      * 00150000
001600*    AUDIT QUANTITY AND ERROR COUNT WILL BE DISPLAYED.          * 00160000
001700*    THE APPROPRIATE PROGRAM IS INVOKED WHEN THE OPERATOR       * 00170000
001800*    SELECTS ONE OR MORE ITEMS AND PRESSES A FUNCTION KEY.      * 00180000
001900*                                                               * 00190000
002000*    THIS SCREEN CAN BE ACCESSED THROUGH THE AUDIT RESULTS      * 00200000
002100*    LIST SCREEN (SUKCS589) OR THE AUDIT RESULTS DETAIL         * 00210000
002200*    SCREEN (SUKCS590).                                         * 00220000
002300*---------------------------------------------------------------* 00230000
001500*    CHANGES                                                     *00231000
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00232000
      *    DATE:    10/15/2013                                         *00233000
      *                                                                *00234000
      *    NEW PACKAGING TYPE 'RFID' WAS ADDED TO BE DISPLAYED FOR AN  *00235000
      *    RFID AUDIT. A MESSAGE WAS ADDED TO BE DISPLAYED FOR RFID    *00236000
      *    AND QC AUDITS. CHANGE WAS DONE TO HIGHLIGHT STATUS FOR      *00236100
      *    COMBINED AUDITS AND F22 WAS PROGRAMMED TO TOGGLE BETWEEN    *00236200
      *    RFID AND QC AUDITS WHEN COMBINED.                           *00236300
      *    CHANGES CAN BE FOUND WITH *SB 10/15/13                      *00236400
      *                                                                *00237000
002300*---------------------------------------------------------------* 00237100
001500*    CHANGES                                                     *00237200
      *    MADE BY: VENKATESH SHANMUGAM  PR#5148D                      *00237300
      *    DATE:    11/20/2013                                         *00237400
      *                                                                *00237500
      *              ADDED A LOGIC TO FIND OUT THE WHETHER THE AUDIT   *00237600
      *              NUMBER IS PART OF COMBINED AUDIT OR NOT.          *00237700
      *              THE TOGGLE FUNTION KEY WAS ALSO ADDED TO TOGGLE   *00237800
      *              BETWEEN TWO AUDITS OF THE COMBINED AUDIT.         *00237900
      *              THE ERROR MESSAGE WAS DISPLAYED IF THE TOGGLE FN  *00238000
      *              IS APPLIED FOR A NON-COMBINED AUDIT OR IF THE     *00238100
      *              RFID AUDIT IS ASSOCIATED WITH MULTIPLE QC AUDITS  *00238200
      *              THE TYPE OF AUDIT WHICH IS DISPLAYED DOWN BELOW IS*00238300
      *              CHANGED FROM 'QA' AND 'RFID ONLY' TO 'QC AUDIT'   *00238400
      *              AND 'RFID AUDIT' RESPECTIVELY.                    *00238500
      *              CHANGES TAGGED VSH 11/20/2013                     *00238600
      *                                                                *00238700
      *----------------------------------------------------------------*00239000
      *    CHANGES                                                     *00239100
      *    MADE BY: SHOBHIT BAIJAL       PR#5148D                      *00239200
      *    DATE:    04/28/2014                                         *00239300
      *                                                                *00239400
      *    NEW CHECK ADDED FOR DEPARTMENT TO SEE IF THEY ARE TAGGING   *00239500
      *    OR NOT AND DISPLAY THE AUDIT TYPE MESSAGE ACCORDINGLY.      *00239600
      *                                                                *00240100
002300*----------------------------------------------------------------*00240200
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00240499
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00240599
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00240699
001130*                                                                 00240799
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00240899
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00240999
263968*---------------------------------------------------------------* 00241099
002400                                                                  00242000
002500                                                                  00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900                                                                  00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100                                                                  00310000
003200 01  DK-DB2-KEYS.                                                 00320000
003300     05  DK-ENT-ID                      PIC S9(09)  COMP.         00330000
003400     05  DK-AUDIT-NBR                   PIC S9(09)  COMP.         00340000
003500     05  DK-SHIPT-UNT-ID                PIC  S9(18)V COMP-3.      00350000
003600     05  DK-AUDIT-STATUS                PIC  X(01)  VALUE SPACES. 00360000
003700     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP.         00370000
003800     05  DK-PO                          PIC S9(09)  COMP.         00380000
003900     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00390000
004000     05  DK-PACK-LINE                   PIC  X(04).               00400000
004100     05  DK-LNE-NBR                     PIC S9(09)  COMP.         00410000
004200     05  DK-PREPK-ID                    PIC S9(04)  COMP.         00420000
004300     05  DK-DEPT-NBR                    PIC S9(04)  COMP-3.       00430000
004400     05  DK-DEPT                        PIC  X(03)  VALUE SPACES. 00440000
004500                                                                  00450000
004600 01  PC-PROGRAM-CONSTANTS.                                        00460000
004700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00470000
004800                                                    'SU591A  '.   00480000
004900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00490000
005000                                                    'SUKM591 '.   00500000
005100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00510000
005200                                                    'SUKCS591'.   00520000
005300     05  PC-LOCATION-MODULE             PIC X(08)   VALUE         00530000
005400                                                    'XLKUT071'.   00540000
005500                                                                  00550000
005600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00560000
005700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00570000
005800                                                                  00580000
005900     05  PC-DETAIL-FORMAT          PIC  X(01)  VALUE '1'.         00590000
006000     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00600000
006100                                                                  00610000
006200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00620000
006300                                                    COMP SYNC.    00630000
006400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00640000
006500                                                    COMP SYNC.    00650000
006600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00660000
006700                                                    +1000000      00670000
006800                                                    COMP-3.       00680000
006900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00690000
007000                                                    COMP SYNC.    00700000
007100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00710000
007200                                                    COMP-3.       00720000
007300     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00730000
007400     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00740000
007500     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00750000
007600     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00760000
007700     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00770000
007800     05  PC-01                          PIC  X(02)  VALUE '01'.   00780000
007900     05  PC-0                           PIC  X(01)  VALUE '0'.    00790000
008000     05  PC-A                           PIC  X(01)  VALUE 'A'.    00800000
008100     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00810000
008200     05  PC-E                           PIC  X(01)  VALUE 'E'.    00820000
008300     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00830000
008400     05  PC-N                      PIC  X(01)  VALUE  'N'.        00840000
008500     05  PC-MAX-DATE               PIC  X(10)  VALUE '9999-09-09'.00850000
008600     05  PC-MULT-ERRORS            PIC  X(15)  VALUE              00860000
008700                                    'MULTIPLE ERRORS'.            00870000
008800     05  PC-NO-ERRORS              PIC  X(15)  VALUE              00880000
008900                                    'NO ERRORS      '.            00890000
009000     05  PC-PASS                   PIC  X(10)  VALUE              00900000
009100                                    'PASS      '.                 00910000
009200     05  PC-FAIL                   PIC  X(10)  VALUE              00920000
009300                                    'FAIL      '.                 00930000
009400     05  PC-IN-PROCESS             PIC  X(10)  VALUE              00940000
009500                                    'IN PROCESS'.                 00950000
009600     05  PC-PROMPT                 PIC  X(10)  VALUE              00960000
009700                                    'PROMPT    '.                 00970000
009800     05  PC-NOT-NEEDED             PIC  X(10)  VALUE              00980000
009900                                    'NOT NEEDED'.                 00990000
010000     05  PC-ALL                    PIC  X(10)  VALUE              01000000
010100                                    'ALL       '.                 01010000
010200     05  PC-BULK-CSPK              PIC  X(10)  VALUE              01020000
010300                                    'BULK/CSEPK'.                 01030000
010400     05  PC-PRE-PACK               PIC  X(10)  VALUE              01040000
010500                                    'PRE-PACK  '.                 01050000
010600     05  PC-PBS                    PIC  X(10)  VALUE              01060000
010700                                    'PBS       '.                 01070000
      *SB 10/15/13 - BEGIN PR#5148D                                     01070100
010600     05  PC-RFID                   PIC  X(10)  VALUE              01071000
010700                                    'RFID      '.                 01072000
      *SB 10/15/13 - END PR#5148D                                       01073000
010800     05  PC-MANUAL                 PIC  X(06)  VALUE 'MANUAL'.    01080000
010900     05  PC-SYSTEM                 PIC  X(06)  VALUE 'SYSTEM'.    01090000
011000     05  PC-DASH                   PIC  X(01)  VALUE '-'.         01100000
011100     05  PC-COLON                  PIC  X(01)  VALUE ':'.         01110000
011200     05  PV-PACK-LINE              PIC  X(01).                    01120000
011300     05  PC-PACK-ID                PIC  X(09)  VALUE 'PACK ID: '. 01130000
011400     05  PC-LINE-NBR               PIC  X(09)  VALUE 'LINE NBR:'. 01140000
011500     05  PV-AUDIT-TYPE             PIC  X(06)  VALUE SPACES.      01150000
011510     05  PV-DIRV-RSN-CDE           PIC  X(03)  VALUE SPACES.      01151000
011600*                                                                 01160000
011700******************************************************************01170000
011800*   SYSTEM MESSAGES                                              *01180000
011900******************************************************************01190000
012000* 00005 - INVALID VALUE                                          *01200000
012100* 00008 - MUST BE NUMERIC                                        *01210000
012200* 00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED    *01220000
012300* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                     *01230000
012400* 00052 - END OF RANGE PRECEDES START OF RANGE                   *01240000
012500* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                   *01250000
012600* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED     *01260000
012700* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED       *01270000
012800* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION         *01280000
012900* 00069 - TOP OF LIST                                            *01290000
013000* 00070 - BOTTOM OF LIST                                         *01300000
013100* 00101 - VALUE MUST BE GREATER THAN ZERO AND LESS THAN 100,000,0*01310000
013200* 00148 - DATA DOES NOT EXIST                                    *01320000
013300* 00279 - MORE ITEMS TO DISPLAY                                  *01330000
013400* 00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID             *01340000
013500* 00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL CA*01350000
013600* 02844 - YOU DO NOT HAVE THE AUTHORITY TO UPDATE RANK           *01360000
013700* 99901 - INVALID COMMAND WAS ENTERED                            *01370000
013800******************************************************************01380000
013900     05  PC-TSYMSG-NUMBERS.                                       01390000
014000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01400000
014100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01410000
014200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01420000
014300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01430000
014400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01440000
014500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01450000
014600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01460000
014700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01470000
014800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01480000
014900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01490000
015000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01500000
015100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01510000
015200         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01520000
015300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01530000
015400         10  PC-TSYMSG-00302            PIC  9(05)  VALUE 00302.  01540000
015500         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01550000
015600         10  PC-TSYMSG-02844            PIC  9(05)  VALUE 02844.  01560000
015700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01570000
      *VSH 11/21/13 - BEGIN PR#5148D                                    01570100
015700         10  PC-TSYMSG-03739            PIC  9(05)  VALUE 03739.  01571000
015700         10  PC-TSYMSG-03740            PIC  9(05)  VALUE 03740.  01572000
      *VSH 11/21/13 - END PR#5148D                                      01573000
015800*                                                                 01580000
015900 01  PS-PROGRAM-SWITCHES.                                         01590000
016000     05  PS-MULTIPLE-ERRORS-SW          PIC  X(01)  VALUE ' '.    01600000
016100         88  PS-MULTIPLE-ERRORS                     VALUE 'Y'.    01610000
016200         88  PS-NOT-MULTIPLE-ERRORS                 VALUE 'N'.    01620000
016300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01630000
016400         88  PS-NO-ERROR                            VALUE 'Y'.    01640000
016500         88  PS-ERROR                               VALUE 'N'.    01650000
016600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01660000
016700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01670000
016800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01680000
016900     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01690000
017000         88  PS-DONE                                VALUE 'Y'.    01700000
017100         88  PS-NOT-DONE                            VALUE 'N'.    01710000
017200     05  PS-END-OF-RANKINGS-SW          PIC  X(01)  VALUE 'N'.    01720000
017300         88  PS-END-OF-RANKINGS                     VALUE 'Y'.    01730000
017400         88  PS-NOT-END-OF-RANKINGS                 VALUE 'N'.    01740000
017500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01750000
017600         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01760000
017700         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01770000
017800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01780000
017900         88  PS-LIST-END                            VALUE  'Y'.   01790000
018000         88  PS-NO-LIST-END                         VALUE  'N'.   01800000
018100*                                                                 01810000
018200 01  PV-PROGRAM-VARIABLES.                                        01820000
018300     05  PV-DISPLAY-AUDIT-CNTL-NBR      PIC  9(09).               01830000
018400     05  PV-DISPLAY-SHIPT-UNT-ID        PIC  9(18).               01840000
018500     05  PV-OPER-UNT-ID                 PIC  Z(04).               01850000
018600     05  PV-SCND-UNT-QTY                PIC S9(09)  VALUE +0      01860000
018700                                                    COMP.         01870000
      *SB 10/15/13 - BEGIN PR#5148D                                     01870100
018600     05  PV-RFID-TGD-QTY                PIC S9(09)  VALUE +0      01871000
018700                                                    COMP.         01872000
018600     05  PV-RFID-TGD-QTY2               PIC S9(09)  VALUE +0      01873000
018700                                                    COMP.         01874000
           05  PV-CARTON-COUNT                PIC S9(04)  COMP.         01874100
      *SB 10/15/13 - END PR#5148D                                       01875000
018800     05  PV-ERROR-COUNT                 PIC S9(09)  VALUE +0      01880000
018900                                                    COMP.         01890000
019000     05  PV-ERROR-COUNT2                PIC S9(09)  VALUE +0      01900000
019100                                                    COMP.         01910000
019200     05  PV-AUDIT-QTY                   PIC S9(09)  VALUE +0      01920000
019300                                                    COMP.         01930000
019400     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01940000
019500                                                    COMP SYNC.    01950000
019600     05  PV-CICS-MSG-AREA               PIC  X(100) VALUE SPACE.  01960000
019700     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-SUB                         PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02010000
020200                                                    COMP SYNC.    02020000
020300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02030000
020400                                                    COMP-3.       02040000
020500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02050000
020600                                                    COMP-3.       02060000
020700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02070000
020800                                                    COMP-3.       02080000
020900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02090000
021000                                                    COMP-3.       02100000
021100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02110000
021200                                                    COMP-3.       02120000
021300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02130000
021400                                                    COMP-3.       02140000
021500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02150000
021600                                                    COMP-3.       02160000
021700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02170000
021800                                                    COMP SYNC.    02180000
021900     05  PV-ITEM                        PIC S9(04)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02230000
022400                                                    COMP SYNC.    02240000
022500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02250000
022600                                                    COMP SYNC.    02260000
022700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02270000
022800                                                    COMP SYNC.    02280000
022900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02290000
023000                                                    COMP SYNC.    02300000
023100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02310000
023200                                                    COMP SYNC.    02320000
023300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02330000
023400                                                    COMP SYNC.    02340000
023500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02350000
023600                                                    COMP SYNC.    02360000
023700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02370000
023800                                                    COMP SYNC.    02380000
023900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02390000
024000                                                    COMP SYNC.    02400000
024100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02410000
024200                                                    COMP SYNC.    02420000
024300     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02430000
024400                                                    COMP SYNC.    02440000
024500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02450000
024600                                                    COMP SYNC.    02460000
024700     05  PV-BULK-VND-RNKG-CDE           PIC  X(06).               02470000
024800     05  PV-PREPACK-VND-RNKG-CDE        PIC  X(06).               02480000
024900     05  PV-PBS-VND-RNKG-CDE            PIC  X(06).               02490000
025000     05  PV-COUNT-DEPT-RANKGS           PIC S9(04)  COMP.         02500000
025100     05  PV-ENT-ID                      PIC ZZZZZZZZ9.            02510000
025200     05  PV-DEPT-NBR                    PIC ZZZ9.                 02520000
025300     05  PV-PO-RECEIVER.                                          02530000
025400         10  PV-PO-NBR                  PIC ZZZZZZZZ9.            02540000
025500         10  FILLER                     PIC X(1)  VALUE '-'.      02550000
025600         10  PV-RECEIVER                PIC 999.                  02560000
025700     05  PV-STRT-TMST                   PIC X(26)   VALUE SPACES. 02570000
025800     05  PV-STRT-TMST-R REDEFINES  PV-STRT-TMST.                  02580000
025900         10   PV-STRT-TMST-CC           PIC X(02).                02590000
026000         10   PV-STRT-TMST-YY           PIC X(02).                02600000
026100         10   FILLER                    PIC X(01).                02610000
026200         10   PV-STRT-TMST-MM           PIC X(02).                02620000
026300         10   FILLER                    PIC X(01).                02630000
026400         10   PV-STRT-TMST-DD           PIC X(02).                02640000
026500         10   FILLER                    PIC X(01).                02650000
026600         10   PV-STRT-TMST-HRS          PIC X(02).                02660000
026700         10   FILLER                    PIC X(01).                02670000
026800         10   PV-STRT-TMST-MIN          PIC X(02).                02680000
026900         10   FILLER                    PIC X(01).                02690000
027000         10   PV-STRT-TMST-SEC          PIC X(02).                02700000
027100         10   FILLER                    PIC X(07).                02710000
027200     05  PV-STP-TMST                    PIC X(26)   VALUE SPACES. 02720000
027300     05  PV-STP-TMST-R REDEFINES  PV-STP-TMST.                    02730000
027400         10   PV-STP-TMST-CC            PIC X(02).                02740000
027500         10   PV-STP-TMST-YY            PIC X(02).                02750000
027600         10   FILLER                    PIC X(01).                02760000
027700         10   PV-STP-TMST-MM            PIC X(02).                02770000
027800         10   FILLER                    PIC X(01).                02780000
027900         10   PV-STP-TMST-DD            PIC X(02).                02790000
028000         10   FILLER                    PIC X(01).                02800000
028100         10   PV-STP-TMST-HRS           PIC X(02).                02810000
028200         10   FILLER                    PIC X(01).                02820000
028300         10   PV-STP-TMST-MIN           PIC X(02).                02830000
028400         10   FILLER                    PIC X(01).                02840000
028500         10   PV-STP-TMST-SEC           PIC X(02).                02850000
028600         10   FILLER                    PIC X(07).                02860000
028700     05  PV-STRT-DATE-TIME              PIC X(26)   VALUE SPACES. 02870000
028800     05  PV-STRT-DATE-TIME-DISPLAY REDEFINES PV-STRT-DATE-TIME.   02880000
028900         10   PV-STRT-DISPLAY-MM        PIC X(02).                02890000
029000         10   PV-STRT-DASH-1            PIC X(01).                02900000
029100         10   PV-STRT-DISPLAY-DD        PIC X(02).                02910000
029200         10   PV-STRT-DASH-2            PIC X(01).                02920000
029300         10   PV-STRT-DISPLAY-YY        PIC X(02).                02930000
029400         10   PV-STRT-SPACE             PIC X(01).                02940000
029500         10   PV-STRT-DISPLAY-HRS       PIC X(02).                02950000
029600         10   PV-STRT-COLON             PIC X(01).                02960000
029700         10   PV-STRT-DISPLAY-MIN       PIC X(02).                02970000
029800         10   FILLER                    PIC X(12).                02980000
029900     05  PV-STP-DATE-TIME               PIC X(26)   VALUE SPACES. 02990000
030000     05  PV-STP-DATE-TIME-DISPLAY REDEFINES PV-STP-DATE-TIME.     03000000
030100         10   PV-STP-DISPLAY-MM         PIC X(02).                03010000
030200         10   PV-STP-DASH-1             PIC X(01).                03020000
030300         10   PV-STP-DISPLAY-DD         PIC X(02).                03030000
030400         10   PV-STP-DASH-2             PIC X(01).                03040000
030500         10   PV-STP-DISPLAY-YY         PIC X(02).                03050000
030600         10   PV-STP-SPACE              PIC X(01).                03060000
030700         10   PV-STP-DISPLAY-HRS        PIC X(02).                03070000
030800         10   PV-STP-COLON              PIC X(01).                03080000
030900         10   PV-STP-DISPLAY-MIN        PIC X(02).                03090000
031000         10   FILLER                    PIC X(12).                03100000
      *VSH 11/21/13 - BEGIN PR#5148D                                    03100100
           05  PV-REQ-DATE-MDCY.                                        03101000
               10  PV-REQ-DATE-MDCY-MM        PIC 9(02).                03102000
               10  FILLER                     PIC X(1)  VALUE '-'.      03103000
               10  PV-REQ-DATE-MDCY-DD        PIC 9(02).                03104000
               10  FILLER                     PIC X(1)  VALUE '-'.      03105000
               10  PV-REQ-DATE-MDCY-CCYY      PIC 9(04).                03106000
                                                                        03107000
                                                                        03108000
           05  PV-REQ-TIME.                                             03109000
               10  PV-REQ-TIME-HR             PIC 9(02).                03109100
               10  FILLER                     PIC X(1)  VALUE ':'.      03109200
               10  PV-REQ-TIME-MN             PIC 9(02).                03109300
      **VSH 11/21/13 - END PR#5148D                                     03109400
                                                                        03109500
031100*                                                                 03110000
031200******************************************************************03120000
031300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03130000
031400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03140000
031500**  APPLICATION-SPECIFIC COMMAREA.                              **03150000
031600******************************************************************03160000
031700 01  LQW-LIST-QUEUE-WORK-AREA.                                    03170000
031800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03180000
031900     05  LQW-ITEM-ENTRIES               OCCURS 9 TIMES            03190000
032000                                        INDEXED BY LQW-IDX.       03200000
032100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03210000
032200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03220000
032300         10  LQW-SELECTED-SW            PIC  X(01).               03230000
032400             88  LQW-SELECT                         VALUE 'S'.    03240000
032500             88  LQW-DESELECT                       VALUE ' '.    03250000
032600         10  LQW-ACTION                 PIC  X(03).               03260000
032700         10  LQW-TBL-CARTON-ID          PIC S9(18).               03270000
032800         10  LQW-TBL-CART-STATUS        PIC  X(02).               03280000
      *SB 10/15/13 - BEGIN PR#5148D                                     03280100
               10  LQW-TBL-CART-COMBINED      PIC  X(01).               03281000
      *SB 10/15/13 - END PR#5148D                                       03282000
032900         10  LQW-TBL-STRT-DATE          PIC  X(14).               03290000
033000         10  LQW-TBL-STOP-DATE          PIC  X(14).               03300000
033100         10  LQW-TBL-AUD-USER-ID        PIC  X(08).               03310000
033200         10  LQW-TBL-AUDIT-QTY          PIC S9(09)                03320000
033300                                            COMP.                 03330000
033400         10  LQW-TBL-ERROR-CNT          PIC  X(01).               03340000
033410         10  LQW-TBL-RLSED-IND          PIC  X(01).               03341000
033500                                                                  03350000
033600*---------------------------------------------------------------* 03360000
033700*  SELECTION QUEUE LAYOUT                                       * 03370000
033800*---------------------------------------------------------------* 03380000
033900     COPY SUWS025.                                                03390000
034000                                                                  03400000
034100*---------------------------------------------------------------* 03410000
034200*  SELECTION QUEUE LAYOUT                                       * 03420000
034300*---------------------------------------------------------------* 03430000
034400     COPY SUWS039.                                                03440000
034500                                                                  03450000
034600*---------------------------------------------------------------* 03460000
034700*  RECORD LAYOUT FOR THE AUDIT CARTON LIST TEMP STORAGE QUEUE.  * 03470000
034800*---------------------------------------------------------------* 03480000
034900     COPY SUWS028.                                                03490000
035000                                                                  03500000
035100*----------------------------------------------------------------*03510000
035200**  SECURITY SUBROUTINE PARAMETERS                                03520000
035300*----------------------------------------------------------------*03530000
035400     COPY DPWS008.                                                03540000
035500                                                                  03550000
035600*---------------------------------------------------------------* 03560000
035700*    MAP LAYOUT                                                 * 03570000
035800*---------------------------------------------------------------* 03580000
035900     COPY SUKM591.                                                03590000
036000*                                                                 03600000
036100 01  MR-OCCURS-LAYOUT                   REDEFINES  SU591AO.       03610000
036200*    05  FILLER                         PIC X(308).               03620000
036300     05  FILLER                         PIC X(355).               03630000
036400     05  MR-SCROLL-AREA                 OCCURS 9 TIMES.           03640000
036500         10  MR-SELECTL                 PIC S9(04) COMP.          03650000
036600         10  MR-SELECTA                 PIC  X(01).               03660000
036700         10  MR-SELECTC                 PIC  X(01).               03670000
036800         10  MR-SELECTH                 PIC  X(01).               03680000
036900         10  MR-SELECTI                 PIC  X(01).               03690000
037000                                                                  03700000
037100         10  MR-ACTIONL                 PIC S9(04) COMP.          03710000
037200         10  MR-ACTIONA                 PIC  X(01).               03720000
037300         10  MR-ACTIONC                 PIC  X(01).               03730000
037400         10  MR-ACTIONH                 PIC  X(01).               03740000
037500         10  MR-ACTION                  PIC  X(03).               03750000
037600                                                                  03760000
037700         10  MR-CARTONL                 PIC S9(04) COMP.          03770000
037800         10  MR-CARTONA                 PIC  X(01).               03780000
037900         10  MR-CARTONC                 PIC  X(01).               03790000
038000         10  MR-CARTONH                 PIC  X(01).               03800000
038100         10  MR-CARTON                  PIC  X(18).               03810000
038200                                                                  03820000
038300         10  MR-CART-STATUSL            PIC S9(04) COMP.          03830000
038400         10  MR-CART-STATUSA            PIC  X(01).               03840000
038500         10  MR-CART-STATUSC            PIC  X(01).               03850000
038600         10  MR-CART-STATUSH            PIC  X(01).               03860000
038700         10  MR-CART-STATUS-X.                                    03870000
038800             15  MR-CART-STATUS         PIC  X(02).               03880000
038900                                                                  03890000
039000         10  MR-STRT-DATEL              PIC S9(04) COMP.          03900000
039100         10  MR-STRT-DATEA              PIC  X(01).               03910000
039200         10  MR-STRT-DATEC              PIC  X(01).               03920000
039300         10  MR-STRT-DATEH              PIC  X(01).               03930000
039400         10  MR-STRT-DATE               PIC  X(14).               03940000
039500                                                                  03950000
039600         10  MR-STOP-DATEL              PIC S9(04) COMP.          03960000
039700         10  MR-STOP-DATEA              PIC  X(01).               03970000
039800         10  MR-STOP-DATEC              PIC  X(01).               03980000
039900         10  MR-STOP-DATEH              PIC  X(01).               03990000
040000         10  MR-STOP-DATE               PIC  X(14).               04000000
040100                                                                  04010000
040200         10  MR-AUD-USER-IDL            PIC S9(04) COMP.          04020000
040300         10  MR-AUD-USER-IDA            PIC  X(01).               04030000
040400         10  MR-AUD-USER-IDC            PIC  X(01).               04040000
040500         10  MR-AUD-USER-IDH            PIC  X(01).               04050000
040600         10  MR-AUD-USER-ID-X.                                    04060000
040700             15  MR-AUD-USER-ID         PIC  X(08).               04070000
040800                                                                  04080000
040900         10  MR-AUDIT-QTYL              PIC S9(04) COMP.          04090000
041000         10  MR-AUDIT-QTYA              PIC  X(01).               04100000
041100         10  MR-AUDIT-QTYC              PIC  X(01).               04110000
041200         10  MR-AUDIT-QTYH              PIC  X(01).               04120000
041300         10  MR-AUDIT-QTY-X.                                      04130000
041400             15  MR-AUDIT-QTY           PIC  ZZZ9.                04140000
041500                                                                  04150000
041600         10  MR-ERROR-INDL              PIC S9(04) COMP.          04160000
041700         10  MR-ERROR-INDA              PIC  X(01).               04170000
041800         10  MR-ERROR-INDC              PIC  X(01).               04180000
041900         10  MR-ERROR-INDH              PIC  X(01).               04190000
042000         10  MR-ERROR-IND               PIC  X(01).               04200000
042100                                                                  04210000
042110         10  MR-RLSED-INDL              PIC S9(04) COMP.          04211000
042120         10  MR-RLSED-INDA              PIC  X(01).               04212000
042130         10  MR-RLSED-INDC              PIC  X(01).               04213000
042140         10  MR-RLSED-INDH              PIC  X(01).               04214000
042150         10  MR-RLSED-IND               PIC  X(01).               04215000
042160                                                                  04216000
042200     05  FILLER                         PIC X(12).                04220000
042300                                                                  04230000
042400***************************************************************** 04240000
042500*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04250000
042600*             LOCATION MODULE (XLKUT071)                        * 04260000
042700***************************************************************** 04270000
042800     COPY XLWS071.                                                04280000
042900*---------------------------------------------------------------* 04290000
043000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04300000
043100*---------------------------------------------------------------* 04310000
043200                                                                  04320000
043300     COPY DPWS015.                                                04330000
043400                                                                  04340000
043500*---------------------------------------------------------------* 04350000
043600*    FUNCTION KEYS COPYBOOK.                                    * 04360000
043700*---------------------------------------------------------------* 04370000
043800                                                                  04380000
043900     COPY DPWS016.                                                04390000
044000                                                                  04400000
044100*---------------------------------------------------------------* 04410000
044200*    NUMERIC EDIT LAYOUT.                                       * 04420000
044300*---------------------------------------------------------------* 04430000
044400                                                                  04440000
044500     COPY DPWS010I.                                               04450000
044600                                                                  04460000
044700*---------------------------------------------------------------* 04470000
044800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04480099
044900*---------------------------------------------------------------* 04490000
045000                                                                  04500000
045100     COPY DPWS030.                                                04510000
045100     COPY DPWS930.                                                04511099
045200                                                                  04520000
045300*---------------------------------------------------------------* 04530000
045400*    STANDARD COMMAREA.                                         * 04540000
045500*---------------------------------------------------------------* 04550000
045600                                                                  04560000
045700     COPY DPWS020.                                                04570000
045800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04580000
045900                                                                  04590000
046000*---------------------------------------------------------------* 04600000
046100* INTER-APPLICATION COMMAREA.                                   * 04610000
046200*   SUWS024 - IS THE INPUT LAYOUT WHEN COMING FROM THE AUDIT    * 04620000
046300*             RESULTS LIST SCREEN.                              * 04630000
046400*   SUWS027 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04640000
046500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04650000
046600*---------------------------------------------------------------* 04660000
046700                                                                  04670000
046800         10  INTER-APPL-COMM-AREA       PIC X(200).               04680000
046900     COPY SUWS024.                                                04690000
047000     COPY SUWS027.                                                04700000
047100     COPY SUWS038.                                                04710000
047200*---------------------------------------------------------------* 04720000
047300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04730000
047400*---------------------------------------------------------------* 04740000
047500         10  ASC-SPECIFIC-COMMAREA.                               04750000
047600             15  ASC-LIST-KEYS.                                   04760000
047700                 20  ASC-AUDIT-NBR                   PIC  Z(09).  04770000
047800                 20  ASC-REQUEST-DATE                PIC  X(08).  04780000
047900                 20  ASC-REQUEST-MDCY                PIC  X(10).  04790000
048000                 20  ASC-REQUEST-TIME                PIC  X(05).  04800000
048100                 20  ASC-PROCESS-STATUS              PIC  X(01).  04810000
048200                 20  ASC-PO-RECEIVER.                             04820000
048300                     25  ASC-PO-NBR                PIC ZZZZZZZZ9. 04830000
048400                     25  ASC-PO-RCVR-DASH            PIC X(1).    04840000
048500                     25  ASC-RECEIVER                PIC 999.     04850000
048600                 20  ASC-PO-RCVR REDEFINES ASC-PO-RECEIVER        04860000
048700                                                     PIC X(13).   04870000
048800                                                                  04880000
048900                 20  ASC-PACK-LINE.                               04890000
049000                     25  ASC-PACK-LINE-NBR           PIC  Z(04).  04900000
049100                     25  ASC-PACK-LINE-C REDEFINES                04910000
049200                                  ASC-PACK-LINE-NBR.              04920000
049300                         30  ASC-PACK-LINE-NBR-CHAR  PIC  X(04).  04930000
049400                                                                  04940000
049500                 20  ASC-SOURCE                      PIC  X(06).  04950000
049600                 20  ASC-OPER-UNT-ID                 PIC  9(04).  04960000
049700                 20  ASC-OPER-DESC                   PIC  X(30).  04970000
049800                 20  ASC-PACKAGING-TYPE              PIC  X(02).  04980000
049900                 20  ASC-VENDOR-NAME                 PIC  X(30).  04990000
050000                 20  ASC-ENT-ID.                                  05000000
050100                     25  ASC-ENT-ID-N                PIC 9(09).   05010000
050200                 20  ASC-DEPARTMENT-DESC             PIC  X(30).  05020000
050300                 20  ASC-DEPT-NBR.                                05030000
050400                     25  ASC-DEPT-NBR-N              PIC  9(04).  05040000
050500                 20  ASC-MODIFIED-IND                PIC  X(01).  05050000
050600                 20  ASC-CARTON-ID                   PIC  9(18).  05060000
050700             15  ASC-BLK-SUB                    PIC S9(04) COMP   05070000
050800                                                            SYNC. 05080000
050900             15  ASC-ITEM-SUB                   PIC S9(04) COMP   05090000
051000                                                            SYNC. 05100000
051100             15  ASC-FORMAT-IND                      PIC X(01).   05110000
051200                 88  ASC-DETAIL-FORMAT               VALUE '1'.   05120000
051300                 88  ASC-LIST-FORMAT                 VALUE '2'.   05130000
051400                                                                  05140000
051500             15  ASC-NUMBER-OF-ITEMS-READ       PIC S9(09) COMP-3.05150000
051600             15  ASC-NUMBER-OF-SELECTED-ITEMS   PIC S9(09) COMP-3.05160000
051700             15  ASC-ITEMS-DISPLAYED            PIC S9(03) COMP-3.05170000
051800             15  ASC-ITEM-AT-TOP-OF-PANEL       PIC S9(09) COMP-3.05180000
051900             15  ASC-ITEM-AT-BOT-OF-PANEL       PIC S9(09) COMP-3.05190000
052000             15  ASC-HIGHEST-BLOCK-WRITTEN      PIC S9(04) COMP   05200000
052100                                                             SYNC.05210000
052200             15  ASC-START-OF-SELECTED-RANGE    PIC S9(09) COMP-3.05220000
052300             15  ASC-END-OF-SELECTED-RANGE      PIC S9(09) COMP-3.05230000
052400             15  ASC-MOD-QTY-IND                PIC  X(01).       05240000
052500             15  ASC-ITEMS-LEFT-INDICATOR       PIC  X(01).       05250000
052600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05260000
052700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05270000
052800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05280000
052900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05290000
053000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05300000
053100             15  ASC-LIST-QUEUE-NAME.                             05310000
053200                 20  ASC-LIST-TERM-ID                PIC  X(04).  05320000
053300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05330000
053400                                                          COMP-3. 05340000
053500                 20  ASC-LIST-SEQ                    PIC  9(01).  05350000
053600                                                                  05360000
053700             15  ASC-SEL-QUEUE-NAME.                              05370000
053800                 20  ASC-SEL-TERM-ID                 PIC  X(04).  05380000
053900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05390000
054000                                                          COMP-3. 05400000
054100                 20  ASC-SEL-SEQ                     PIC  9(01).  05410000
054200*                                                                 05420000
054300             15  ASC-SEL-QUEUE-NAME-IN.                           05430000
054400                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               05440000
054500                 20  ASC-SEL-TASK-NUMBER-IN                       05450000
054600                                      PIC S9(05) COMP-3.          05460000
054700                 20  ASC-SEL-SEQ-IN      PIC 9(01).               05470000
054800*                                                                 05480000
054900             15  ASC-SEL-QUEUE-NAME-IN-2.                         05490000
055000                 20  ASC-SEL-TERM-ID-IN-2     PIC  X(04).         05500000
055100                 20  ASC-SEL-TASK-NUMBER-IN-2 PIC S9(05) COMP-3.  05510000
055200                 20  ASC-SEL-SEQ-IN-2         PIC  9(01).         05520000
055300*                                                                 05530000
055400                                                                  05540000
055500             15  ASC-USE-SELECTION-QUEUE-IND                      05550000
055600                                           PIC  X(01).            05560000
055700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05570000
055800             15  ASC-START-ITEM-REQUEST.                          05580000
055900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05590000
056000             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    05600000
056100             15  ASC-SEL-SUB               PIC S9(04)  COMP.      05610000
056200             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      05620000
      *SB 10/15/2013 BEGIN - PR5148D                                    05621000
                   15  ASC-MULTIPLE-AUDITS-IND   PIC  X(01).            05622000
                       88  ASC-MULTIPLE-AUD                   VALUE 'Y'.05623000
                       88  ASC-NOT-MULTIPLE-AUD               VALUE 'N'.05624000
                   15  ASC-RFID-AUDIT-IND        PIC  X(01).            05625000
                       88  ASC-RFID-AUD                       VALUE 'Y'.05626000
                       88  ASC-NO-RFID-AUD                    VALUE 'N'.05627000
      *VSH 11/21/13 - BEGIN PR#5148D                                    05627100
                   15  ASC-QC-AUDIT-IND          PIC  X(01).            05627200
                       88  ASC-QC-AUD                         VALUE 'Y'.05627300
                       88  ASC-NO-QC-AUD                      VALUE 'N'.05627400
      *VSH 11/21/13 - END PR#5148D                                      05627500
      *SB 01/02/14 - BEGIN PR#5148D                                     05627600
                   15  ASC-SYSTEM-MAN-IND        PIC  X(01).            05627700
                       88  ASC-SYSTEM-AUD                     VALUE 'S'.05627800
                       88  ASC-MANUAL-AUD                     VALUE 'M'.05627900
017800             15  ASC-PO-EXCEPTION-SW       PIC  X(01).            05628100
017900                 88  ASC-PO-EXCEPTION                  VALUE  'Y'.05628200
018000                 88  ASC-NO-PO-EXCEPTION               VALUE  'N'.05628300
017800             15  ASC-VENDOR-TAGGING-SW     PIC  X(01).            05628400
017900                 88  ASC-VENDOR-TAGGING                VALUE  'Y'.05628500
018000                 88  ASC-VENDOR-NOT-TAGGING            VALUE  'N'.05628600
      *SB 01/02/14 - END PR#5148D                                       05628700
      *SB 04/28/14 - BEGIN PR#5148D                                     05628800
017800             15  ASC-DEPT-TAGGING-SW       PIC  X(01).            05628900
017900                 88  ASC-DEPT-TAGGING                  VALUE  'Y'.05629000
018000                 88  ASC-DEPT-NOT-TAGGING              VALUE  'N'.05629100
      *SB 04/28/14 - END PR#5148D                                       05629200
                   15  ASC-OTHER-AUDIT           PIC S9(09)  COMP.      05629300
                   15  ASC-OTHER-AUDIT-TEMP      PIC S9(09)  COMP.      05629400
                   15  ASC-OTHER-AUDIT-DB        PIC S9(09)  COMP.      05629500
      *VSH 11/21/13 - BEGIN PR#5148D                                    05629600
                   15  ASC-COUNT                 PIC S9(04)  COMP.      05629700
                   15  ASC-RFID-AUD-CNTL-NBR     PIC S9(09)  COMP.      05629800
      *SB 10/15/2013 END  - PR5148D                                     05629900
      *VSH 11/21/13 - END PR#5148D                                      05630000
056300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05631000
056400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05640000
056500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05650000
056600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05660000
056700                                                                  05670000
056800                 20  ASC-ITEM-ARRAY.                              05680000
056900                     25  ASC-ITEM-ENTRIES OCCURS 9 TIMES.         05690000
057000                         30  ASC-LIST-ITEM-NUMBER                 05700000
057100                                                     PIC S9(09)   05710000
057200                                                     COMP-3.      05720000
057300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05730000
057400                             88  ASC-VALID-SELECT    VALUE ' '    05740000
057500                                                           'S'    05750000
057600                                                           'B'    05760000
057700                                                           'E'.   05770000
057800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05780000
057900                             88  ASC-TEMP-SELECT     VALUE 'S'.   05790000
058000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05800000
058100                             88  ASC-TEMP-END        VALUE 'E'.   05810000
058200                         30  ASC-SELECTED-SW         PIC  X(01).  05820000
058300                             88  ASC-NO-SELECT       VALUE ' '.   05830000
058400                             88  ASC-SELECT          VALUE 'S'.   05840000
058500                             88  ASC-BEGIN           VALUE 'B'.   05850000
058600                             88  ASC-END             VALUE 'E'.   05860000
058700                         30  ASC-ACTION              PIC  X(03).  05870000
058800                         30  ASC-TBL-CARTON-ID       PIC S9(18).  05880000
058900                         30  ASC-TBL-CART-STATUS     PIC  X(02).  05890000
      *SB 10/15/13 - BEGIN PR#5148D                                     05890100
058900                         30  ASC-TBL-CART-COMBINED   PIC  X(01).  05891000
                                   88 ASC-COMBINED-YES     VALUE 'Y'.   05892000
                                   88 ASC-COMBINED-NO      VALUE 'N'.   05893000
      *SB 10/15/13 - END PR#5148D                                       05894000
059000                         30  ASC-TBL-STRT-DATE       PIC  X(14).  05900000
059100                         30  ASC-TBL-STOP-DATE       PIC  X(14).  05910000
059200                         30  ASC-TBL-AUD-USER-ID     PIC  X(08).  05920000
059300                         30  ASC-TBL-AUDIT-QTY       PIC S9(09)   05930000
059400                                                     COMP.        05940000
059500                         30  ASC-TBL-ERROR-IND       PIC  X(01).  05950000
059510                         30  ASC-TBL-RLSED-IND       PIC  X(01).  05951000
059800*---------------------------------------------------------------* 05980000
059900*    ABEND PROCESSING COPYBOOK.                                 * 05990000
060000*---------------------------------------------------------------* 06000000
060100                                                                  06010000
060200     COPY DPWS013.                                                06020000
060300                                                                  06030000
060400*----------------------------------------------------------------*06040000
060500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06050000
060600*  AUDIT TRANSACTION TABLE                                        06060000
060700*----------------------------------------------------------------*06070000
060800     EXEC SQL                                                     06080000
060900         INCLUDE TSUATRN                                          06090000
061000     END-EXEC.                                                    06100000
061100                                                                  06110000
061200*---------------------------------------------------------------* 06120000
061300*  DCLGEN FOR THE DB2 EX-EXTERNAL ENTERPRISE TABLE                06130000
061400*---------------------------------------------------------------* 06140000
061500     EXEC SQL                                                     06150000
061600         INCLUDE TEXTENT                                          06160000
061700     END-EXEC.                                                    06170000
061800                                                                  06180000
061900*---------------------------------------------------------------* 06190000
062000*  DCLGEN FOR THE DB2 EX-EXTERNAL ENTERPRISE NAME TABLE           06200000
062100*---------------------------------------------------------------* 06210000
062200     EXEC SQL                                                     06220000
062300         INCLUDE TENTNME                                          06230000
062400     END-EXEC.                                                    06240000
062500                                                                  06250000
062600*---------------------------------------------------------------* 06260000
062700*  DCLGEN FOR THE DB2 VENDOR DEPARTMENT TABLE                     06270000
062800*---------------------------------------------------------------* 06280000
062900     EXEC SQL                                                     06290000
063000         INCLUDE TVNDDPT                                          06300000
063100     END-EXEC.                                                    06310000
063200                                                                  06320000
063300*----------------------------------------------------------------*06330000
063400*    DB2 DCLGEN FOR THE MERCHANDISE AREA TABLE                    06340000
063500*----------------------------------------------------------------*06350000
063600     EXEC SQL                                                     06360000
063700          INCLUDE TMDSEAR                                         06370000
063800     END-EXEC.                                                    06380000
063900                                                                  06390000
064000                                                                  06400000
064100*----------------------------------------------------------------*06410000
064200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  06420000
064300*  TABLE                                                          06430000
064400*----------------------------------------------------------------*06440000
064500     EXEC SQL                                                     06450000
064600         INCLUDE TSHUUPC                                          06460000
064700     END-EXEC.                                                    06470000
064800                                                                  06480000
064900*----------------------------------------------------------------*06490000
065000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT SHIPPING UPC 06500000
065100*  TABLE                                                          06510000
065200*----------------------------------------------------------------*06520000
065300     EXEC SQL                                                     06530000
065400         INCLUDE TSUAUPC                                          06540000
065500     END-EXEC.                                                    06550000
065600                                                                  06560000
065700*----------------------------------------------------------------*06570000
065800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06580000
065900*  AUDIT TABLE (TSUNAUD)                                          06590000
066000*----------------------------------------------------------------*06600000
066100     EXEC SQL                                                     06610000
066200         INCLUDE TSUNAUD                                          06620000
066300     END-EXEC.                                                    06630000
066400                                                                  06640000
066500*----------------------------------------------------------------*06650000
066600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06660000
066700*  AUDIT EXCEPTION TABLE (TCTEXCP)                                06670000
066800*----------------------------------------------------------------*06680000
066900     EXEC SQL                                                     06690000
067000         INCLUDE TCTEXCP                                          06700000
067100     END-EXEC.                                                    06710000
067200                                                                  06720000
067300*----------------------------------------------------------------*06730000
067400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06740000
067500*  CONTENT AUDIT EXCEPTION TABLE (TSUEXCP)                        06750000
067600*----------------------------------------------------------------*06760000
067700     EXEC SQL                                                     06770000
067800         INCLUDE TSUEXCP                                          06780000
067900     END-EXEC.                                                    06790000
068000                                                                  06800000
068100*----------------------------------------------------------------*06810000
068200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VIOLATION CODE     06820000
068300*  TABLE (TVILNCD)                                                06830000
068400*----------------------------------------------------------------*06840000
068500     EXEC SQL                                                     06850000
068600         INCLUDE TVILNCD                                          06860000
068700     END-EXEC.                                                    06870000
068800                                                                  06880000
068900*----------------------------------------------------------------*06890000
069000*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             06900000
069100*    (SUT_PO_AUD_REQ)                                             06910000
069200*----------------------------------------------------------------*06920000
069300     EXEC SQL                                                     06930000
069400          INCLUDE SUT00015                                        06940000
069500     END-EXEC.                                                    06950000
069600                                                                  06960000
      *SB 10/15/13 - BEGIN PR#5148D                                     06960100
068900*----------------------------------------------------------------*06961000
069000*    DB2 DCLGEN FOR THE VENDOR PO AUDIT EXCEPTION TABLE           06962000
069100*    (SUT_PO_AUD_EXC)                                             06963000
069200*----------------------------------------------------------------*06964000
069300     EXEC SQL                                                     06965000
069400          INCLUDE SUT00014                                        06966000
069500     END-EXEC.                                                    06967000
069600                                                                  06968000
068900*----------------------------------------------------------------*06969000
069000*    DB2 DCLGEN FOR THE VENDOR PURCHASE TABLE                     06969100
069100*    (TPURCHS)                                                    06969200
069200*----------------------------------------------------------------*06969300
069300     EXEC SQL                                                     06969400
069400          INCLUDE TPURCHS                                         06969500
069500     END-EXEC.                                                    06969600
069600                                                                  06969700
068900*----------------------------------------------------------------*06969800
069000*    DB2 DCLGEN FOR THE VENDOR AGREEMENT TABLE                    06969900
069100*    (TVNDAGR)                                                    06970000
069200*----------------------------------------------------------------*06970100
069300     EXEC SQL                                                     06970200
069400          INCLUDE TVNDAGR                                         06970300
069500     END-EXEC.                                                    06970400
      *SB 10/15/13 - END PR#5148D                                       06970500
069600                                                                  06970600
      *SB 04/28/14 - BEGIN PR#5148D                                     06970700
      ******************************************************************06970800
      *    DB2 AREA FOR THE RIT_RFID_VRFN TABLE                       * 06970900
      ******************************************************************06971000
           EXEC SQL                                                     06971100
               INCLUDE RIT00000                                         06971200
           END-EXEC.                                                    06971300
      *SB 04/28/14 - END PR#5148D                                       06971400
                                                                        06971500
      *----------------------------------------------------------------*06972000
      *    DB2 SQL COMMUNICATION AREA                                   06980000
      *----------------------------------------------------------------*06990000
           EXEC SQL                                                     07000000
                INCLUDE SQLCA                                           07010000
           END-EXEC.                                                    07020000
070400                                                                  07040000
070500*---------------------------------------------------------------* 07050000
070600*    CURSOR FOR ALL CARTONS FOR AUDIT NUMBER                    * 07060000
070700*---------------------------------------------------------------* 07070000
070800                                                                  07080000
070900     EXEC SQL                                                     07090000
071000          DECLARE AUD-CARTON-CSR CURSOR                           07100000
071100          FOR SELECT SHIPT_UNT_ID                                 07110000
071200                   , UNT_AUD_STAT_CDE                             07120000
071300                   , UNT_AUD_STRT_TMST                            07130000
071400                   , UNT_AUD_STP_TMST                             07140000
071500                   , UNT_AUD_USR_ID                               07150000
071600            FROM TSUATRN                                          07160000
071700           WHERE AUD_CNTL_NBR   = :DK-AUDIT-NBR                   07170000
071800*            AND TRN_NBR        = :DK-PO-NBR                      07180000
071900     END-EXEC.                                                    07190000
072000                                                                  07200000
072100                                                                  07210000
072200 LINKAGE SECTION.                                                 07220000
072300                                                                  07230000
072400 01  DFHCOMMAREA.                                                 07240000
072500     05  FILLER                         OCCURS  1 TO 4072 TIMES   07250000
072600                                        DEPENDING ON EIBCALEN.    07260000
072700         10  FILLER                     PIC X.                    07270000
072800                                                                  07280000
072900                                                                  07290000
073000 PROCEDURE DIVISION.                                              07300000
073100******************************************************************07310000
073200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07320000
073300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07330000
073400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07340000
073500******************************************************************07350000
073600 0000-MAIN-MODULE.                                                07360000
073700     INITIALIZE DP030-CICS-API-FIELDS.                            07370000
073800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07380000
073900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07390000
074000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07400000
074100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07410000
074200     MOVE LENGTH OF SU591AI        TO DP030-MAP-LENGTH (1).       07420000
074300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07430000
074400     PERFORM 0001-CALL-CICS-ARCH-API.                             07440000
074500                                                                  07450000
074600     PERFORM 1000-CONTROL-PROCESSING                              07460000
074700                                                                  07470000
074800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07480000
074900     PERFORM 0001-CALL-CICS-ARCH-API.                             07490000
075000*                                                                 07500000
075100*                                                                 07510000
075200******************************************************************07520000
075300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07530000
075400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07540000
075500******************************************************************07550000
075600 0001-CALL-CICS-ARCH-API.                                         07560000
075700*    CALL 'DPKCS030' USING DFHEIBLK                               07570099
075700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07571099
075800                           DFHCOMMAREA                            07580000
075900                           DP030-CICS-API-FIELDS                  07590000
076000                           DP020-STANDARD-COMMAREA                07600000
076100                           SU591AI.                               07610000
076200                                                                  07620000
076300     IF  DP030-RC-CALL-SUCCESSFUL                                 07630000
076400         CONTINUE                                                 07640000
076500     ELSE                                                         07650000
076600         SET DP013-NO-ROLLBACK                                    07660000
076700             DP013-XCTL-DISPLAY-RESTART                           07670000
076800             DP013-CICS-ABEND      TO TRUE                        07680000
076900         MOVE '0001-CALL-CICS-ARCH-API'                           07690000
077000                                   TO DP013-PARAGRAPH             07700000
077100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07710099
077200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07720099
077100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07721099
077200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07722099
077300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07730000
077400         PERFORM DP013-0000-PROCESS-ABEND                         07740000
077500     END-IF.                                                      07750000
077600*                                                                 07760000
077700*                                                                 07770000
077800*----------------------------------------------------------------*07780000
077900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07790000
078000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07800000
078100*                                                                *07810000
078200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07820000
078300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07830000
078400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07840000
078500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07850000
078600*----------------------------------------------------------------*07860000
078700 1000-CONTROL-PROCESSING.                                         07870000
078800                                                                  07880000
078900     EVALUATE TRUE                                                07890000
079000         WHEN DP020-NEXT-ACT-INITIAL                              07900000
079100             INITIALIZE ASC-SPECIFIC-COMMAREA                     07910000
079200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07920000
079300                                      ASC-SEL-TERM-ID             07930000
079400             MOVE DP020-SRC-TASK-NUMBER                           07940000
079500                                   TO ASC-LIST-TASK-NUMBER        07950000
079600                                      ASC-SEL-TASK-NUMBER         07960000
079700             MOVE PC-LIST-QUEUE-SEQ                               07970000
079800                                   TO ASC-LIST-SEQ                07980000
079900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07990000
080000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08000000
080100***-----$TEMPLATE NOTE$-------------------------------------------08010000
080200*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08020000
080300*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08030000
080400*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08040000
080500***---------------------------------------------------------------08050000
080600             IF  PS-COMMAREA-NOT-VALID                            08060000
080700***              MOVE PC-TSYMSG-99901                             08070000
080800***                                TO DP020-MSG-NUMBER            08080000
080900***              SET DP020-MSG-FATAL                              08090000
081000***                                TO TRUE                        08100000
081100                 SET DP020-NEXT-ACT-APPL-ERROR                    08110000
081200                                   TO TRUE                        08120000
081300             ELSE                                                 08130000
081400                 PERFORM 4000-BUILD-INITIAL-PANEL                 08140000
081500             END-IF                                               08150000
081600                                                                  08160000
081700         WHEN DP020-NEXT-ACT-READ-MAP                             08170000
081800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08180000
081900                                   TO PV-TOP-ITEM                 08190000
082000             PERFORM 2000-PROCESS-PANEL                           08200000
082100                                                                  08210000
082200         WHEN DP020-NEXT-ACT-RETURN                               08220000
082300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08230000
082400                                   TO PV-TOP-ITEM                 08240000
082500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08250000
082600             PERFORM 2050-DELETE-LIST-QUEUE                       08260000
082700             PERFORM 4000-BUILD-INITIAL-PANEL                     08270000
082800*            PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08280000
082900*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08290000
083000*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08300000
083100                                                                  08310000
083200         WHEN OTHER                                               08320000
083300             SET DP013-LOGIC-ABEND TO TRUE                        08330000
083400             SET DP013-NO-ROLLBACK TO TRUE                        08340000
083500             MOVE '1000-CONTROL-PROCESSING'                       08350000
083600                                   TO DP013-PARAGRAPH             08360000
083700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08370000
083800                                   TO DP013-MESSAGE-TEXT(1)       08380000
083900             PERFORM DP013-0000-PROCESS-ABEND                     08390000
084000     END-EVALUATE.                                                08400000
084100                                                                  08410000
084200*----------------------------------------------------------------*08420000
084300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08430000
084400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08440000
084500*----------------------------------------------------------------*08450000
084600 1100-PROCESS-INTER-APPL-COMM.                                    08460000
084700                                                                  08470000
084800     SET PS-COMMAREA-VALID         TO TRUE.                       08480000
084900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08490000
085000     EVALUATE DP020-INT-APPL-FORMAT-IND                           08500000
085100*FROM SUKCS589                                                    08510000
085200         WHEN PC-LIST-FORMAT                                      08520000
085300             SET ASC-LIST-FORMAT TO TRUE                          08530000
085400             MOVE SU024-OPER-UNIT-ID    TO ASC-OPER-UNT-ID        08540000
085500             IF SU024-OPER-DESC = SPACES                          08550000
085600                 MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID         08560000
085700                 PERFORM 1500-SELECT-OPER-UNIT                    08570000
085800                 MOVE XL071-LOC-NM                                08580000
085900                                        TO ASC-OPER-DESC          08590000
086000             ELSE                                                 08600000
086100                 MOVE SU024-OPER-DESC   TO ASC-OPER-DESC          08610000
086200             END-IF                                               08620000
086300             MOVE SU024-PROCESS-STATUS  TO ASC-PROCESS-STATUS     08630000
086400             MOVE SU024-PACKAGING-TYPE  TO ASC-PACKAGING-TYPE     08640000
086500             MOVE SU024-ENT-ID          TO ASC-ENT-ID             08650000
086600             MOVE SU024-VENDOR-NAME     TO ASC-VENDOR-NAME        08660000
086700             MOVE SU024-DEPT-NBR        TO ASC-DEPT-NBR-N         08670000
086800             MOVE SU024-DEPARTMENT-DESC TO ASC-DEPARTMENT-DESC    08680000
086900             MOVE SU024-MODIFIED-IND    TO ASC-MODIFIED-IND       08690000
087000                                                                  08700000
087100             SET ASC-USE-SELECTION-QUEUE TO TRUE                  08710000
087200             MOVE SU024-NUMBER-OF-SELECTED-ITEMS                  08720000
087300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08730000
087400             MOVE SU024-NUMBER-OF-TS-ITEMS                        08740000
087500                                   TO ASC-NUMBER-OF-TS-ITEMS      08750000
087600             MOVE SU024-SEL-QUEUE-NAME                            08760000
087700                                   TO ASC-SEL-QUEUE-NAME-IN-2     08770000
087800             PERFORM 1120-PREPARE-LIST-ENTRY                      08780000
087900*FROM SUKCS590                                                    08790000
088000         WHEN PC-DETAIL-FORMAT                                    08800000
088100             SET ASC-DETAIL-FORMAT TO TRUE                        08810000
088200             MOVE SU024-AUDIT-NBR       TO ASC-AUDIT-NBR          08820000
088300             MOVE SU024-OPER-UNIT-ID    TO ASC-OPER-UNT-ID        08830000
088400             MOVE SU024-OPER-DESC       TO ASC-OPER-DESC          08840000
088500             MOVE SU024-PROCESS-STATUS  TO ASC-PROCESS-STATUS     08850000
088600             MOVE SU024-SOURCE          TO ASC-SOURCE             08860000
088700             MOVE SU024-PACKAGING-TYPE  TO ASC-PACKAGING-TYPE     08870000
088800             MOVE SU024-ENT-ID          TO ASC-ENT-ID             08880000
088900             MOVE SU024-VENDOR-NAME     TO ASC-VENDOR-NAME        08890000
089000             MOVE SU024-DEPT-NBR        TO ASC-DEPT-NBR-N         08900000
089100             MOVE SU024-DEPARTMENT-DESC TO ASC-DEPARTMENT-DESC    08910000
089200             MOVE SU024-MODIFIED-IND    TO ASC-MODIFIED-IND       08920000
089300             MOVE SU024-REQUEST-DATE    TO ASC-REQUEST-MDCY       08930000
089400             MOVE SU024-PO              TO ASC-PO-NBR             08940000
089500             MOVE SU024-RECEIVER-SEQ    TO ASC-RECEIVER           08950000
089600             MOVE '-'                   TO ASC-PO-RCVR-DASH       08960000
089700                                                                  08970000
089800         WHEN OTHER                                               08980000
089900             IF  DP020-NAV-KEY-DATA > SPACE                       08990000
090000                 PERFORM 1110-EDIT-NAV-KEY                        09000000
090100             ELSE                                                 09010000
090200                 MOVE PC-TSYMSG-00148                             09020000
090300                                   TO DP020-MSG-NUMBER            09030000
090400                 SET DP020-MSG-FATAL                              09040000
090500                     DP020-NEXT-ACT-APPL-ERROR                    09050000
090600                                   TO TRUE                        09060000
090700             END-IF                                               09070000
090800     END-EVALUATE.                                                09080000
090900*                                                                 09090000
091000*                                                                 09100000
091100******************************************************************09110000
091200** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **09120000
091300** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **09130000
091400** ACCEPTED.                                                    **09140000
091500******************************************************************09150000
091600 1110-EDIT-NAV-KEY.                                               09160000
091700     IF  ASC-ENT-ID > SPACE                                       09170000
091800         MOVE DP020-NAV-KEY-DATA   TO DP010I-UNEDITED-FIELD       09180000
091900         MOVE LENGTH OF ASC-ENT-ID                                09190000
092000                                   TO DP010I-MAXIMUM-DIGITS       09200000
092100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09210000
092200         SET DP010I-NEGATIVE-NOT-ALLOWED                          09220000
092300                                   TO TRUE                        09230000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09241099
263968              USING DP010I-NUMERIC-EDIT-AREA                      09242099
092500         IF  DP010I-ERROR-DETECTED                                09250000
092600             SET PS-ERROR                                         09260000
092700                 DP020-MSG-FATAL   TO TRUE                        09270000
092800*            -- INVALID DATA IN KEY FIELD ---                     09280000
092900             MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER            09290000
093000             SET DP020-NEXT-ACT-APPL-ERROR                        09300000
093100                                   TO TRUE                        09310000
093200         ELSE                                                     09320000
093300             MOVE DP010I-NUMERIC-FIELD                            09330000
093400                                   TO ASC-ENT-ID-N                09340000
093500         END-IF                                                   09350000
093600     END-IF.                                                      09360000
093700*                                                                 09370000
093800*                                                                 09380000
093900*----------------------------------------------------------------*09390000
094000* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *09400000
094100* STORAGE QUEUE PASSED FROM THE LIST.                            *09410000
094200*----------------------------------------------------------------*09420000
094300 1120-PREPARE-LIST-ENTRY.                                         09430000
094400     MOVE SU025-MAX-ITEMS          TO ASC-SEL-SUB.                09440000
094500     MOVE ZERO                     TO ASC-SEL-ITEM.               09450000
094600     PERFORM 1130-GET-NEXT-RECORD.                                09460000
094700                                                                  09470000
094800*                                                                 09480000
094900*                                                                 09490000
095000 1200-GET-AUDIT-QTY.                                              09500000
095100                                                                  09510000
095200     MOVE 0  TO PV-SCND-UNT-QTY                                   09520000
      *SB 10/15/13 - BEGIN PR#5148D                                     09520100
      *CHANGED THE QUERY TO FETCH RFID_TGD_QTY                          09520200
095200                PV-RFID-TGD-QTY.                                  09521000
095300     EXEC SQL                                                     09530000
095400         SELECT SUM(SCND_UNT_QTY)                                 09540000
095400               ,SUM(RFID_TGD_QTY)                                 09541000
095500         INTO  :PV-SCND-UNT-QTY                                   09550000
095500              ,:PV-RFID-TGD-QTY                                   09551000
095600         FROM   TSUAUPC A                                         09560000
                    , TSUATRN B                                         09561000
095700         WHERE                                                    09570000
095800             A.AUD_CNTL_NBR   = :DK-AUDIT-NBR                     09580000
095900         AND A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                  09590000
096000         AND A.SCN_TYP_CDE   <> 'E'                               09600000
               AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                    09601000
               AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                    09602000
               AND A.SCN_TMST      >= B.UNT_AUD_STRT_TMST               09603000
      *SB 10/15/13 - END PR#5148D                                       09604000
096100     END-EXEC.                                                    09610000
096200                                                                  09620000
096300     EVALUATE TRUE                                                09630000
096400         WHEN SQLCODE = +0                                        09640000
096500         WHEN SQLCODE = +100                                      09650000
096600         WHEN SQLCODE = -305                                      09660000
096700         WHEN SQLCODE = -904                                      09670000
096800         WHEN SQLCODE = -913                                      09680000
096900             CONTINUE                                             09690000
097000         WHEN SQLWARN0 NOT = SPACES                               09700000
097100         WHEN SQLCODE < +0                                        09710000
097200         WHEN SQLCODE > ZERO                                      09720000
097300             MOVE '1200-GET-AUDIT-QTY'                            09730000
097400                             TO DP013-PARAGRAPH                   09740000
097500             MOVE 'SELECT AUDIT QTY'                              09750000
097600                             TO DP013-MESSAGE-TEXT (1)            09760000
097700             MOVE SQLCA      TO DP013-SQLCA                       09770000
097800             MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME (1)          09780000
097900             SET DP013-DB2-ABEND                                  09790000
098000                             TO TRUE                              09800000
098100             SET DP013-XCTL-DISPLAY-RESTART                       09810000
098200                             TO TRUE                              09820000
098300             PERFORM DP013-0000-PROCESS-ABEND                     09830000
098400     END-EVALUATE.                                                09840000
                                                                        09850000
098600******************************************************************09863000
098700 1250-MOD-QTY-IND.                                                09870000
098800                                                                  09880000
      *VSH 11/21/13 - BEGIN PR#5148D                                    09880100
           INITIALIZE ASC-RFID-AUDIT-IND                                09881000
      *    SET ASC-NO-QC-AUD TO TRUE                                    09881100
           SET ASC-NO-RFID-AUD TO TRUE                                  09881200
           INITIALIZE ASC-COUNT                                         09882000
      *VSH 11/21/13 - END PR#5148D                                      09883000
098900     MOVE ASC-AUDIT-NBR  TO DK-AUDIT-NBR.                         09890000
099000     MOVE 0              TO ASC-OTHER-AUDIT.                      09900000
099100     EXEC SQL                                                     09910000
099200         SELECT MOD_QTY_IND                                       09920000
      *SB 10/15/2013 BEGIN - PR5148D                                    09920100
                     ,VALUE(RWRK_AUD_CNTL_NBR,0)                        09921000
      *VSH 11/21/13 - BEGIN PR#5148D                                    09921100
                     ,PO_PREPK_ID                                       09921200
                     ,PKGNG_TYP_CDE                                     09921300
                     ,AUD_STAT_CDE                                      09921400
                     ,PO_LNE_NBR                                        09921500
                     ,CRE_TMST                                          09921600
      *SB 10/15/2013 END  - PR5148D                                     09922000
099300         INTO  :SUT00015-MOD-QTY-IND                              09930000
      *SB 10/15/2013 BEGIN - PR5148D                                    09930100
                    ,:SUT00015-RWRK-AUD-CNTL-NBR                        09931000
      *SB 10/15/2013 END  - PR5148D                                     09932000
                    ,:SUT00015-PO-PREPK-ID                              09933000
                    ,:SUT00015-PKGNG-TYP-CDE                            09934000
                    ,:SUT00015-AUD-STAT-CDE                             09935000
                    ,:SUT00015-PO-LNE-NBR                               09936000
                    ,:SUT00015-CRE-TMST                                 09937000
      *VSH 11/21/13 - END PR#5148D                                      09938000
099400         FROM   SUT_PO_AUD_REQ                                    09940000
099500         WHERE                                                    09950000
099600             AUD_CNTL_NBR   = :DK-AUDIT-NBR                       09960000
099700     END-EXEC.                                                    09970000
099800                                                                  09980000
099900     EVALUATE TRUE                                                09990000
100000         WHEN SQLCODE = +0                                        10000000
100100              MOVE SUT00015-MOD-QTY-IND   TO ASC-MOD-QTY-IND      10010000
      *SB 10/15/2013 BEGIN - PR5148D                                    10010100
      *VSH 11/21/13 - BEGIN PR#5148D                                    10010200
                   SET ASC-SYSTEM-AUD TO TRUE                           10010400
                   IF SUT00015-PKGNG-TYP-CDE = 'RF' AND                 10010600
                      SUT00015-PO-PREPK-ID       < 0                    10010700
      *               ITS A RFID AUDIT                                  10010800
                      PERFORM 4432-QC-RFID-COMB-COUNT                   10010900
                      SET ASC-RFID-AUD          TO TRUE                 10011000
                   ELSE                                                 10011100
                      SET ASC-QC-AUD TO TRUE                            10011400
                      SET ASC-NO-RFID-AUD TO TRUE                       10011500
                      CONTINUE                                          10011600
                   END-IF                                               10011700
                   IF (DK-AUDIT-NBR > 0 AND                             10011800
                      (SUT00015-RWRK-AUD-CNTL-NBR > 0 OR ASC-COUNT > 0))10011900
      *               ITS A QC AND RFID AUDIT                           10012000
                       SET ASC-MULTIPLE-AUD      TO TRUE                10012100
                       MOVE SUT00015-AUD-STAT-CDE TO ASC-PROCESS-STATUS 10012200
                       MOVE SUT00015-PKGNG-TYP-CDE TO ASC-PACKAGING-TYPE10012300
                       MOVE SUT00015-CRE-TMST(1:04) TO                  10012400
                                            PV-REQ-DATE-MDCY-CCYY       10012500
                       MOVE SUT00015-CRE-TMST(6:02) TO                  10012600
                                            PV-REQ-DATE-MDCY-MM         10012700
                       MOVE SUT00015-CRE-TMST(9:02) TO                  10012800
                                            PV-REQ-DATE-MDCY-DD         10012900
                       MOVE SUT00015-CRE-TMST(12:02) TO                 10013000
                                            PV-REQ-TIME-HR              10013100
                       MOVE SUT00015-CRE-TMST(15:02) TO                 10013200
                                            PV-REQ-TIME-MN              10013300
                       MOVE PV-REQ-DATE-MDCY TO ASC-REQUEST-MDCY        10013400
                       MOVE PV-REQ-TIME TO ASC-REQUEST-TIME             10013500
                                                                        10013600
                       IF ASC-RFID-AUD AND ASC-COUNT > 0                10013700
      *                 ITS A RFID AND HAS ONLY ONE QA AUDIT ASSOCIATE  10013800
      *                   WITH IT                                       10013900
                          PERFORM 4433-RFID-AUD-CNTL-NBR                10014000
                          MOVE ASC-RFID-AUD-CNTL-NBR TO ASC-OTHER-AUDIT 10014100
                       ELSE                                             10014200
                          IF ASC-QC-AUD AND ASC-NO-RFID-AUD             10014300
                             MOVE SUT00015-RWRK-AUD-CNTL-NBR            10014500
                                                TO ASC-OTHER-AUDIT      10014600
                          ELSE                                          10014700
                             IF ASC-QC-AUD AND ASC-RFID-AUD             10014800
                                PERFORM 4433-RFID-AUD-CNTL-NBR          10014900
                                MOVE ASC-RFID-AUD-CNTL-NBR TO           10015000
                                     ASC-OTHER-AUDIT                    10015100
      *VSH 11/21/13 - END PR#5148D                                      10015200
                             END-IF                                     10015300
                          END-IF                                        10015400
                       END-IF                                           10015500
                   ELSE                                                 10015600
                       SET ASC-NOT-MULTIPLE-AUD  TO TRUE                10015700
                   END-IF                                               10015800
      *VSH 11/21/13 - BEGIN PR#5148D                                    10015900
                   EVALUATE SUT00015-PKGNG-TYP-CDE                      10016000
                      WHEN 'BC'                                         10016100
                          MOVE SUT00015-PO-LNE-NBR  TO ASC-PACK-LINE-NBR10016200
                      WHEN 'PP'                                         10016300
                          MOVE SUT00015-PO-PREPK-ID TO ASC-PACK-LINE-NBR10016400
                      WHEN 'PS'                                         10016500
                      WHEN 'RF'                                         10016600
                          MOVE SPACES TO ASC-PACK-LINE-NBR-CHAR         10016700
                   END-EVALUATE                                         10016800
      *VSH 11/21/13 - END PR#5148D                                      10016900
                                                                        10017000
      *SB 10/15/2013 END  - PR5148D                                     10018000
100200         WHEN SQLCODE = +100                                      10020000
100300              MOVE 'N'                    TO ASC-MOD-QTY-IND      10030000
      *SB 10/15/2013 BEGIN - PR5148D                                    10030100
                    SET ASC-MANUAL-AUD          TO TRUE                 10030200
                    SET ASC-NOT-MULTIPLE-AUD    TO TRUE                 10031000
      *SB 10/15/2013 END  - PR5148D                                     10032000
100400         WHEN SQLWARN0 NOT = SPACES                               10040000
100500         WHEN SQLCODE < +0                                        10050000
100600         WHEN SQLCODE > ZERO                                      10060000
100700             MOVE '1250-MOD-QTY-IND'                              10070000
100800                             TO DP013-PARAGRAPH                   10080000
100900             MOVE 'SELECT MOD QTY IND'                            10090000
101000                             TO DP013-MESSAGE-TEXT (1)            10100000
101100             MOVE SQLCA      TO DP013-SQLCA                       10110000
101200             MOVE 'SUT_PO_AUD_REQ' TO DP013-DB2-TABLE-NAME (1)    10120000
101300             SET DP013-DB2-ABEND                                  10130000
101400                             TO TRUE                              10140000
101500             SET DP013-XCTL-DISPLAY-RESTART                       10150000
101600                             TO TRUE                              10160000
101700             PERFORM DP013-0000-PROCESS-ABEND                     10170000
101800     END-EVALUATE.                                                10180000
101900*                                                                 10190000
102000 1300-GET-ERROR-COUNT.                                            10200000
102100                                                                  10210000
102200     MOVE ZERO               TO PV-ERROR-COUNT                    10220000
102300                                PV-ERROR-COUNT2.                  10230000
102400                                                                  10240000
102500* CARTON LEVEL ERRORS                                             10250000
102600                                                                  10260000
102700     EXEC SQL                                                     10270000
102800         SELECT  COUNT(*)                                         10280000
102900           INTO  :PV-ERROR-COUNT                                  10290000
103000           FROM   TCTEXCP B                                       10300000
103100                , TVILNCD C                                       10310000
103200          WHERE  B.AUD_CNTL_NBR     = :DK-AUDIT-NBR               10320000
103300            AND  B.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID            10330000
103400            AND  B.VILN_GP_CDE      = C.VILN_GP_CDE               10340000
103500            AND  B.VILN_GP_SEQ_NBR  = C.VILN_GP_SEQ_NBR           10350000
103600     END-EXEC.                                                    10360000
103700                                                                  10370000
103800     EVALUATE TRUE                                                10380000
103900         WHEN SQLCODE = ZERO                                      10390000
104000         WHEN SQLCODE = +100                                      10400000
104100         WHEN SQLCODE = -305                                      10410000
104200             CONTINUE                                             10420000
104300         WHEN SQLWARN0 NOT = SPACES                               10430000
104400         WHEN SQLCODE < +0                                        10440000
104500         WHEN SQLCODE > ZERO                                      10450000
104600             MOVE '1300-GET-ERROR-COUNT'                          10460000
104700                             TO DP013-PARAGRAPH                   10470000
104800             MOVE 'GET ERROR COUNT'                               10480000
104900                             TO DP013-MESSAGE-TEXT (1)            10490000
105000             MOVE DK-AUDIT-NBR                                    10500000
105100                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     10510000
105200             MOVE PV-DISPLAY-AUDIT-CNTL-NBR                       10520000
105300                                       TO DP013-MESSAGE-TEXT (2)  10530000
105400             MOVE DK-SHIPT-UNT-ID                                 10540000
105500                                 TO PV-DISPLAY-SHIPT-UNT-ID       10550000
105600             MOVE PV-DISPLAY-SHIPT-UNT-ID                         10560000
105700                                       TO DP013-MESSAGE-TEXT (3)  10570000
105800             MOVE SQLCA      TO DP013-SQLCA                       10580000
105900             MOVE 'TCTEXCP'  TO DP013-DB2-TABLE-NAME (1)          10590000
106000             MOVE 'TVILNCD'  TO DP013-DB2-TABLE-NAME (2)          10600000
106100             SET DP013-DB2-ABEND                                  10610000
106200                             TO TRUE                              10620000
106300             SET DP013-XCTL-DISPLAY-RESTART                       10630000
106400                             TO TRUE                              10640000
106500             PERFORM DP013-0000-PROCESS-ABEND                     10650000
106600     END-EVALUATE.                                                10660000
106700                                                                  10670000
106800     EXEC SQL                                                     10680000
106900         SELECT  COUNT(*)                                         10690000
107000           INTO  :PV-ERROR-COUNT2                                 10700000
107100         FROM    TSUAUPC A                                        10710000
107200              ,  TSUEXCP B                                        10720000
107300              ,  TVILNCD C                                        10730000
107400         WHERE                                                    10740000
107500             A.AUD_CNTL_NBR       = :DK-AUDIT-NBR                 10750000
107600         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              10760000
107700         AND A.AUD_CNTL_NBR       = B.AUD_CNTL_NBR                10770000
107800         AND A.SCN_TMST           = B.SCN_TMST                    10780000
107900         AND B.VILN_GP_CDE        = C.VILN_GP_CDE                 10790000
108000         AND B.VILN_GP_SEQ_NBR    = C.VILN_GP_SEQ_NBR             10800000
108100         AND C.FALR_IND           = 'Y'                           10810000
108200     END-EXEC.                                                    10820000
108300                                                                  10830000
108400     EVALUATE TRUE                                                10840000
108500       WHEN SQLCODE = ZERO                                        10850000
108600           ADD  PV-ERROR-COUNT2  TO  PV-ERROR-COUNT               10860000
108700       WHEN SQLCODE = +100                                        10870000
108800       WHEN SQLCODE = -305                                        10880000
108900           CONTINUE                                               10890000
109000       WHEN OTHER                                                 10900000
109100           MOVE '1300-GET-ERROR-COUNT'                            10910000
109200                                         TO DP013-PARAGRAPH       10920000
109300           MOVE 'SELECT OVER/SHORTS'   TO DP013-MESSAGE-TEXT (1)  10930000
109400           MOVE DK-AUDIT-NBR                                      10940000
109500                                 TO PV-DISPLAY-AUDIT-CNTL-NBR     10950000
109600           MOVE PV-DISPLAY-AUDIT-CNTL-NBR                         10960000
109700                                       TO DP013-MESSAGE-TEXT (2)  10970000
109800           MOVE DK-SHIPT-UNT-ID                                   10980000
109900                                 TO PV-DISPLAY-SHIPT-UNT-ID       10990000
110000           MOVE PV-DISPLAY-SHIPT-UNT-ID                           11000000
110100                                       TO DP013-MESSAGE-TEXT (3)  11010000
110200           MOVE SQLCA                  TO DP013-SQLCA             11020000
110300           MOVE 'TSUAUPC'            TO DP013-DB2-TABLE-NAME (1)  11030000
110400           MOVE 'TSUEXCP'            TO DP013-DB2-TABLE-NAME (2)  11040000
110500           SET DP013-DB2-ABEND                                    11050000
110600                           TO TRUE                                11060000
110700           SET DP013-XCTL-DISPLAY-RESTART                         11070000
110800                           TO TRUE                                11080000
110900           PERFORM DP013-0000-PROCESS-ABEND                       11090000
111000     END-EVALUATE.                                                11100000
111100                                                                  11110000
111200* UNIT LEVEL ERRORS "ERROR"                                       11120000
111300*                                                                 11130000
111400*    EXEC SQL                                                     11140000
111500*        SELECT  SUM(A.SCND_UNT_QTY)                              11150000
111600*          INTO  :PV-ERROR-COUNT2                                 11160000
111700*          FROM   TSUAUPC A                                       11170000
111800*               , TSUEXCP B                                       11180000
111900*               , TVILNCD C                                       11190000
112000*         WHERE  A.AUD_CNTL_NBR     = :DK-AUDIT-NBR               11200000
112100*           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID            11210000
112200*           AND  B.AUD_CNTL_NBR     = A.AUD_CNTL_NBR              11220000
112300*           AND  B.SHIPT_UNT_ID     = A.SHIPT_UNT_ID              11230000
112400*           AND  B.UPC_NBR          = A.UPC_NBR                   11240000
112500*           AND  A.SCN_TMST         = B.SCN_TMST                  11250000
112600*           AND  A.SCN_TYP_CDE      = 'E'                         11260000
112700*           AND  C.VILN_GP_CDE      = 'VA'                        11270000
112800*           AND  B.VILN_GP_CDE      = C.VILN_GP_CDE               11280000
112900*           AND  B.VILN_GP_SEQ_NBR  = C.VILN_GP_SEQ_NBR           11290000
113000*    END-EXEC.                                                    11300000
113100*                                                                 11310000
113200*    EVALUATE TRUE                                                11320000
113300*        WHEN SQLCODE = ZERO                                      11330000
113400*            ADD  PV-ERROR-COUNT2  TO  PV-ERROR-COUNT             11340000
113500*        WHEN SQLCODE = +100                                      11350000
113600*        WHEN SQLCODE = -305                                      11360000
113700*            CONTINUE                                             11370000
113800*        WHEN SQLWARN0 NOT = SPACES                               11380000
113900*        WHEN SQLCODE < +0                                        11390000
114000*        WHEN SQLCODE > ZERO                                      11400000
114100*            MOVE '1300-GET-ERROR-COUNT'                          11410000
114200*                            TO DP013-PARAGRAPH                   11420000
114300*            MOVE 'GET ERROR COUNT'                               11430000
114400*                            TO DP013-MESSAGE-TEXT (1)            11440000
114500*            MOVE SQLCA      TO DP013-SQLCA                       11450000
114600*            MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME (1)          11460000
114700*            MOVE 'TSUEXCP'  TO DP013-DB2-TABLE-NAME (2)          11470000
114800*            MOVE 'TVILNCD'  TO DP013-DB2-TABLE-NAME (3)          11480000
114900*            SET DP013-DB2-ABEND                                  11490000
115000*                            TO TRUE                              11500000
115100*            SET DP013-XCTL-DISPLAY-RESTART                       11510000
115200*                            TO TRUE                              11520000
115300*            PERFORM DP013-0000-PROCESS-ABEND                     11530000
115400*    END-EVALUATE.                                                11540000
115500                                                                  11550000
115600* UNIT LEVEL ERRORS "SCANNED" ITEMS                               11560000
115700                                                                  11570000
115800*   COMMENTED OUT THIS SQL BECAUSE IT INCORRECTLY COUNTED 79 ERROR11580000
115900*   FOR AUDIT 150012568, SHIPT UNT 197181135857921.               11590000
116000*                                                                 11600000
116100*    EXEC SQL                                                     11610000
116200*        SELECT  SUM(A.SCND_UNT_QTY)                              11620000
116300*          INTO  :PV-ERROR-COUNT2                                 11630000
116400*          FROM   TSUAUPC A                                       11640000
116500*               , TSUEXCP B                                       11650000
116600*               , TVILNCD C                                       11660000
116700*         WHERE  A.AUD_CNTL_NBR     = :DK-AUDIT-NBR               11670000
116800*           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID            11680000
116900*           AND  B.AUD_CNTL_NBR     = A.AUD_CNTL_NBR              11690000
117000*           AND  B.SHIPT_UNT_ID     = A.SHIPT_UNT_ID              11700000
117100*           AND  B.UPC_NBR          = A.UPC_NBR                   11710000
117200*           AND  A.SCN_TMST         = B.SCN_TMST                  11720000
117300*           AND  A.SCN_TYP_CDE     <> 'E'                         11730000
117400*           AND  C.VILN_GP_CDE      = 'VA'                        11740000
117500*           AND  B.VILN_GP_CDE      = C.VILN_GP_CDE               11750000
117600*           AND  B.VILN_GP_SEQ_NBR  = C.VILN_GP_SEQ_NBR           11760000
117700*           AND A.UPC_NBR  NOT IN                                 11770000
117800*               (SELECT D.UPC_NBR                                 11780000
117900*                  FROM TSUAUPC D                                 11790000
118000*                 WHERE D.AUD_CNTL_NBR      = A.AUD_CNTL_NBR      11800000
118100*                   AND D.SHIPT_UNT_ID      = A.SHIPT_UNT_ID      11810000
118200*                   AND D.SCN_TYP_CDE       = 'E')                11820000
118300*    END-EXEC.                                                    11830000
118400*                                                                 11840000
118500*    EVALUATE TRUE                                                11850000
118600*        WHEN SQLCODE = ZERO                                      11860000
118700*            ADD  PV-ERROR-COUNT2  TO  PV-ERROR-COUNT             11870000
118800*        WHEN SQLCODE = +100                                      11880000
118900*        WHEN SQLCODE = -305                                      11890000
119000*            CONTINUE                                             11900000
119100*        WHEN SQLWARN0 NOT = SPACES                               11910000
119200*        WHEN SQLCODE < +0                                        11920000
119300*        WHEN SQLCODE > ZERO                                      11930000
119400*            MOVE '1300-GET-ERROR-COUNT'                          11940000
119500*                            TO DP013-PARAGRAPH                   11950000
119600*            MOVE 'GET ERROR COUNT'                               11960000
119700*                            TO DP013-MESSAGE-TEXT (1)            11970000
119800*            MOVE SQLCA      TO DP013-SQLCA                       11980000
119900*            MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME (1)          11990000
120000*            MOVE 'TSUEXCP'  TO DP013-DB2-TABLE-NAME (2)          12000000
120100*            MOVE 'TVILNCD'  TO DP013-DB2-TABLE-NAME (3)          12010000
120200*            SET DP013-DB2-ABEND                                  12020000
120300*                            TO TRUE                              12030000
120400*            SET DP013-XCTL-DISPLAY-RESTART                       12040000
120500*                            TO TRUE                              12050000
120600*            PERFORM DP013-0000-PROCESS-ABEND                     12060000
120700*    END-EVALUATE.                                                12070000
                                                                        12070100
      *SB 10/15/13 - BEGIN PR#5148D                                     12071000
120800 1350-CHECK-CARTON-COMBINED.                                      12080000
                                                                        12080100
           MOVE ASC-PO-NBR   TO DK-PO                                   12080200
           MOVE ASC-RECEIVER TO DK-REC-SEQ-NBR                          12080300
                                                                        12080400
           EXEC SQL                                                     12080500
              SELECT COUNT(*)                                           12080600
               INTO :PV-CARTON-COUNT                                    12080700
               FROM TSUATRN                                             12080800
              WHERE TRN_NBR        = :DK-PO                             12080900
                AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                    12081000
                AND SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                   12081100
           END-EXEC.                                                    12081200
                                                                        12081300
           EVALUATE SQLCODE                                             12081400
              WHEN 0                                                    12081500
                   IF PV-CARTON-COUNT > 1                               12081600
                      SET ASC-COMBINED-YES (ASC-BLK-SUB ASC-ITEM-SUB)   12081700
                                           TO TRUE                      12081800
                   ELSE                                                 12081900
                      SET ASC-COMBINED-NO (ASC-BLK-SUB ASC-ITEM-SUB)    12082000
                                           TO TRUE                      12082100
                   END-IF                                               12082200
              WHEN 100                                                  12082300
                   SET ASC-COMBINED-NO (ASC-BLK-SUB ASC-ITEM-SUB)       12082400
                                        TO TRUE                         12082500
              WHEN OTHER                                                12082600
123900              MOVE '1350-CHECK-CARTON-COMBINED'                   12082700
124000                               TO DP013-PARAGRAPH                 12082800
124100              MOVE 'CHECK CARTON HAS COMBINED AUDIT'              12082900
124200                               TO DP013-MESSAGE-TEXT (1)          12083000
124300              MOVE 'TSUATRN '  TO DP013-DB2-TABLE-NAME (1)        12083100
124500              MOVE SQLCA       TO DP013-SQLCA                     12083200
124600              SET DP013-DB2-ABEND                                 12083300
124700                               TO TRUE                            12083400
124800              PERFORM DP013-0000-PROCESS-ABEND                    12083500
           END-EVALUATE.                                                12083600
      *SB 10/15/13 - END PR#5148D                                       12083700
                                                                        12084000
120900 1400-COUNT-ERRORS.                                               12090000
121000                                                                  12100000
121100* ERRORS NOT ON TSUAUPC                                           12110000
121200                                                                  12120000
121300     EXEC SQL                                                     12130000
121400         SELECT  COUNT(*)                                         12140000
121500          INTO  :PV-ERROR-COUNT2                                  12150000
121600          FROM  TSUEXCP        A                                  12160000
121700             ,  TVILNCD        B                                  12170000
121800          WHERE A.AUD_CNTL_NBR      = :DK-AUDIT-NBR               12180000
121900            AND A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID            12190000
122000            AND A.VILN_GP_CDE       = B.VILN_GP_CDE               12200000
122100            AND A.VILN_GP_SEQ_NBR   = B.VILN_GP_SEQ_NBR           12210000
122200            AND A.UPC_NBR  NOT IN                                 12220000
122300                (SELECT C.UPC_NBR                                 12230000
122400                   FROM TSUAUPC C                                 12240000
122500                  WHERE C.AUD_CNTL_NBR      = A.AUD_CNTL_NBR      12250000
122600                    AND C.SHIPT_UNT_ID      = A.SHIPT_UNT_ID)     12260000
122700                                                                  12270000
122800     END-EXEC.                                                    12280000
122900                                                                  12290000
123000     EVALUATE TRUE                                                12300000
123100         WHEN SQLCODE = ZERO                                      12310000
123200             ADD  PV-ERROR-COUNT2  TO  PV-ERROR-COUNT             12320000
123300                                                                  12330000
123400         WHEN SQLCODE = +100                                      12340000
123500              CONTINUE                                            12350000
123600                                                                  12360000
123700         WHEN SQLWARN0 NOT = SPACE                                12370000
123800         WHEN SQLCODE NOT = ZERO                                  12380000
123900              MOVE '1400-COUNT-ERRORS'                            12390000
124000                               TO DP013-PARAGRAPH                 12400000
124100              MOVE 'COUNT ERROR RECORDS'                          12410000
124200                               TO DP013-MESSAGE-TEXT (1)          12420000
124300              MOVE 'TSUEXCP '  TO DP013-DB2-TABLE-NAME (1)        12430000
124400              MOVE 'TVILNCD '  TO DP013-DB2-TABLE-NAME (2)        12440000
124500              MOVE SQLCA       TO DP013-SQLCA                     12450000
124600              SET DP013-DB2-ABEND                                 12460000
124700                               TO TRUE                            12470000
124800              PERFORM DP013-0000-PROCESS-ABEND                    12480000
124900     END-EVALUATE.                                                12490000
125000                                                                  12500000
125100*----------------------------------------------------------------*12510000
125200*       GET THE FACILITY NAME                                    *12520000
125300*----------------------------------------------------------------*12530000
125400 1500-SELECT-OPER-UNIT.                                           12540000
125700                                                                  12570000
125800     INITIALIZE XL071-COMMAREA-REC.                               12580000
125900     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               12590000
126000                                                                  12600000
126100     CALL PC-LOCATION-MODULE  USING                               12610000
126200                                    DFHEIBLK                      12620000
126300                                    XL071-COMMAREA                12630000
126400                                    XL071-COMMAREA-REC.           12640000
126500                                                                  12650000
126600     EVALUATE TRUE                                                12660000
126700         WHEN XL071-NO-ERRORS                                     12670000
126800              CONTINUE                                            12680000
126900                                                                  12690000
127000         WHEN OTHER                                               12700000
127100              INITIALIZE PV-CICS-MSG-AREA                         12710000
127200              STRING ' SUKCS591 - CALL XLTUT071 -'                12720000
127300                     ' SQLCODE=' XL071-SQLCODE                    12730000
127400                     ' TABLE='   XL071-DB2-TABLE                  12740000
127500                                              DELIMITED BY SIZE   12750000
127600                                         INTO PV-CICS-MSG-AREA    12760000
127700              MOVE LENGTH OF PV-CICS-MSG-AREA                     12770000
127800                                        TO PV-COMMAREA-LENGTH     12780000
127900              EXEC CICS                                           12790000
128000                   WRITEQ TD                                      12800000
128100                    QUEUE  ('CSSL')                               12810000
128200                     FROM  (PV-CICS-MSG-AREA)                     12820000
128300                   LENGTH  (PV-COMMAREA-LENGTH)                   12830000
128400                     RESP  (PV-CICS-RESPONSE)                     12840000
128500              END-EXEC                                            12850000
128600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12860000
128700              PERFORM 9900-SOFT-ABORT                             12870000
128800     END-EVALUATE.                                                12880000
128900                                                                  12890000
129000*                                                                 12900000
129100*----------------------------------------------------------------*12910000
129200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *12920000
129300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12930000
129400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12940000
129500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12950000
129600* FUNCTION KEYS CAN GET THIS FAR.                                *12960000
129700*----------------------------------------------------------------*12970000
129800 2000-PROCESS-PANEL.                                              12980000
129900     EVALUATE TRUE                                                12990000
130000         WHEN DP020-SRC-AID = DP016-CLEAR                         13000000
130100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13010000
130200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13020000
130300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13030000
130400                                                                  13040000
130500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13050000
130600             MOVE ASC-AUDIT-NBR    TO DK-AUDIT-NBR                13060000
130700             PERFORM 2050-DELETE-LIST-QUEUE                       13070000
130800             PERFORM 4000-BUILD-INITIAL-PANEL                     13080000
130900                                                                  13090000
131000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13100000
131100             IF ASC-USE-SELECTION-QUEUE                           13110000
131200                 IF ASC-DETAIL-FORMAT                             13120000
131300                    MOVE '1' TO DP020-INT-APPL-FORMAT-IND         13130000
131400                 END-IF                                           13140000
131500                 IF ASC-LIST-FORMAT                               13150000
131600                    MOVE '2' TO DP020-INT-APPL-FORMAT-IND         13160000
131700                 END-IF                                           13170000
131800                 PERFORM 1130-GET-NEXT-RECORD                     13180000
131900                 IF PS-LIST-END                                   13190000
132000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13200000
132100                     SET PS-NO-LIST-END TO TRUE                   13210000
132200                 ELSE                                             13220000
132300                     PERFORM 2050-DELETE-LIST-QUEUE               13230000
132400                     PERFORM 3200-RESET-ATTRIBUTES                13240000
132500                     PERFORM 4000-BUILD-INITIAL-PANEL             13250000
132600                 END-IF                                           13260000
132700              ELSE                                                13270000
132800*                --- BOTTOM OF LIST ---                           13280000
132900                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         13290000
133000                 SET DP020-MSG-INFORMATIONAL TO TRUE              13300000
133100             END-IF                                               13310000
133200                                                                  13320000
133300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13330000
133400             IF ASC-USE-SELECTION-QUEUE                           13340000
133500                 IF ASC-DETAIL-FORMAT                             13350000
133600                    MOVE '1' TO DP020-INT-APPL-FORMAT-IND         13360000
133700                 END-IF                                           13370000
133800                 IF ASC-LIST-FORMAT                               13380000
133900                    MOVE '2' TO DP020-INT-APPL-FORMAT-IND         13390000
134000                 END-IF                                           13400000
134100                 PERFORM 1140-GET-PREV-RECORD                     13410000
134200                 IF PS-LIST-END                                   13420000
134300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13430000
134400                     SET PS-NO-LIST-END TO TRUE                   13440000
134500                 ELSE                                             13450000
134600                     PERFORM 2050-DELETE-LIST-QUEUE               13460000
134700                     PERFORM 3200-RESET-ATTRIBUTES                13470000
134800                     PERFORM 4000-BUILD-INITIAL-PANEL             13480000
134900                 END-IF                                           13490000
135000             ELSE                                                 13500000
135100                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         13510000
135200                 SET DP020-MSG-INFORMATIONAL TO TRUE              13520000
135300             END-IF                                               13530000
135400                                                                  13540000
135500         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13550000
135600             PERFORM 2140-DESELECT-ALL-ITEMS                      13560000
135700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13570000
135800                                                                  13580000
135900         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  13590000
136000             PERFORM 2150-SELECT-ALL-ITEMS                        13600000
136100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13610000
136200                                                                  13620000
136300         WHEN OTHER                                               13630000
136400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13640000
136500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13650000
136600             IF  PS-NO-ERROR                                      13660000
136700                 SET DP030-CONTINUE-GO                            13670000
136800                                 TO TRUE                          13680000
136900                 PERFORM 2100-CHECK-FUNCTION-KEY                  13690000
137000             ELSE                                                 13700000
137100                 SET DP030-OVERRIDE-GO                            13710000
137200                                 TO TRUE                          13720000
137300             END-IF                                               13730000
137400     END-EVALUATE.                                                13740000
137500                                                                  13750000
137600*                                                                 13760000
137700*                                                                 13770000
137800*----------------------------------------------------------------*13780000
137900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *13790000
138000*----------------------------------------------------------------*13800000
138100 2050-DELETE-LIST-QUEUE.                                          13810000
138200                                                                  13820000
138300     EXEC CICS                                                    13830000
138400         DELETEQ TS                                               13840000
138500             QUEUE (ASC-LIST-QUEUE-NAME)                          13850000
138600             RESP  (PV-CICS-RESPONSE)                             13860000
138700     END-EXEC.                                                    13870000
138800                                                                  13880000
138900     IF (PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                   13890000
139000        (PV-CICS-RESPONSE = DFHRESP(QIDERR))                      13900000
139100         CONTINUE                                                 13910000
139200     ELSE                                                         13920000
139300         SET DP013-CICS-ABEND      TO TRUE                        13930000
139400         SET DP013-NO-ROLLBACK     TO TRUE                        13940000
139500                                                                  13950000
139600         MOVE '2050-DELETE-LIST-QUEUE'                            13960000
139700                                   TO DP013-PARAGRAPH             13970000
139800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13980000
139900                                   TO DP013-MESSAGE-TEXT (1)      13990000
140000         PERFORM DP013-0000-PROCESS-ABEND                         14000000
140100     END-IF.                                                      14010000
140200                                                                  14020000
140300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14030000
140400*                                                                 14040000
140500*----------------------------------------------------------------*14050000
140600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14060000
140700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14070000
140800* CICS ARCHITECTURE API.                                         *14080000
140900*----------------------------------------------------------------*14090000
141000 2100-CHECK-FUNCTION-KEY.                                         14100000
141100     EVALUATE TRUE                                                14110000
141200                                                                  14120000
141300* F18 - CARTON DETAIL LIST   (LOCAL-FUNC-01)                      14130000
141400*                                                                 14140000
141500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14150000
141600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14160000
141700                 INITIALIZE SU027-INTER-APPL-COMMAREA             14170000
141800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14180000
141900                            TO SU027-NUMBER-OF-SELECTED-ITEMS     14190000
142000                 PERFORM 5000-PREPARE-SEL-QUEUE                   14200000
142100                 MOVE ASC-AUDIT-NBR                               14210000
142200                                    TO SU027-AUDIT-NBR            14220000
142300                 MOVE ASC-REQUEST-DATE                            14230000
142400                                    TO SU027-REQUEST-DATE         14240000
142500                 MOVE ASC-REQUEST-MDCY                            14250000
142600                                    TO SU027-REQUEST-MDCY         14260000
142700                 MOVE ASC-REQUEST-TIME                            14270000
142800                                    TO SU027-REQUEST-TIME         14280000
142900                 MOVE ASC-PROCESS-STATUS                          14290000
143000                                    TO SU027-PROCESS-STATUS       14300000
143100                 MOVE ASC-PO-RECEIVER                             14310000
143200                                    TO SU027-PO-RECEIVER          14320000
143300                 MOVE ASC-SOURCE                                  14330000
143400                                    TO SU027-SOURCE               14340000
143500                 MOVE ASC-OPER-UNT-ID                             14350000
143600                                    TO SU027-OPER-UNIT-ID         14360000
143700                 MOVE ASC-OPER-DESC                               14370000
143800                                    TO SU027-OPER-DESC            14380000
143900                 MOVE ASC-PACKAGING-TYPE                          14390000
144000                                    TO SU027-PACKAGING-TYPE       14400000
144100                 MOVE ASC-ENT-ID                                  14410000
144200                                    TO SU027-ENT-ID               14420000
144300                 MOVE ASC-VENDOR-NAME                             14430000
144400                                    TO SU027-VENDOR-NAME          14440000
144500                 MOVE ASC-DEPT-NBR-N                              14450000
144600                                    TO SU027-DEPT-NBR             14460000
144700                 MOVE ASC-DEPARTMENT-DESC                         14470000
144800                                    TO SU027-DEPARTMENT-DESC      14480000
144900             ELSE                                                 14490000
145000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14500000
145100                 SET DP030-OVERRIDE-GO                            14510000
145200                                   TO TRUE                        14520000
145300                 MOVE PC-TSYMSG-00057                             14530000
145400                                   TO DP020-MSG-NUMBER            14540000
145500                 SET DP020-MSG-WARNING                            14550000
145600                                   TO TRUE                        14560000
145700             END-IF                                               14570000
145800                                                                  14580000
145900                                                                  14590000
146000* F23 - STORE UNIT ADJ TRANS (LOCAL-FUNC-02)                      14600000
146100*                                                                 14610000
146200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14620000
146300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14630000
146400                 INITIALIZE SU038-INTER-APPL-COMMAREA             14640000
146500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14650000
146600                            TO SU038-NUMBER-OF-SELECTED-ITEMS     14660000
146700                 MOVE ASC-AUDIT-NBR     TO SU038-AUDIT            14670000
146800                 MOVE ASC-PO-RECEIVER   TO SU038-PO-RCVR          14680000
146900                 MOVE ASC-PACK-LINE-NBR TO SU038-LINE             14690000
147000                 MOVE ASC-OPER-UNT-ID   TO SU038-OPER-UNT-ID      14700000
147100                 MOVE ASC-OPER-DESC     TO SU038-OPER-NAME        14710000
147200                 MOVE 'A'               TO SU038-UNT-ADJ-TYP      14720000
147300                 MOVE 'A'               TO SU038-FAIL-SUCCSS      14730000
147400                 PERFORM 5010-PREPARE-SEL-QUEUE                   14740000
147500             ELSE                                                 14750000
147600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14760000
147700                 SET DP030-OVERRIDE-GO  TO TRUE                   14770000
147800                 MOVE PC-TSYMSG-00057   TO DP020-MSG-NUMBER       14780000
147900                 SET DP020-MSG-WARNING  TO TRUE                   14790000
148000             END-IF                                               14800000
148100                                                                  14810000
      *SB 10/15/13 - BEGIN PR#5148D                                     14810100
146000* F22 - OTHER AUDIT QC/RFID (LOCAL-FUNC-03)                       14811000
146100*                                                                 14812000
      *VSH 11/21/13 - BEGIN PR#5148D                                    14812100
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14813000
                   IF ASC-MULTIPLE-AUD                                  14813100
                      IF (ASC-OTHER-AUDIT-TEMP > 0 AND ASC-RFID-AUD) OR 14813400
                         (ASC-RFID-AUD AND ASC-COUNT = 1) OR            14813500
                         ASC-QC-AUD                                     14813600
                         IF ASC-RFID-AUD AND ASC-OTHER-AUDIT-TEMP > 0   14813700
                            MOVE ASC-OTHER-AUDIT-TEMP TO DK-AUDIT-NBR   14813800
                            MOVE ZERO TO ASC-OTHER-AUDIT-TEMP           14813900
                         ELSE                                           14814000
                            MOVE ASC-OTHER-AUDIT   TO DK-AUDIT-NBR      14814100
                         END-IF                                         14814200
                         MOVE ASC-AUDIT-NBR     TO ASC-OTHER-AUDIT      14814300
                         MOVE DK-AUDIT-NBR      TO ASC-AUDIT-NBR        14814400
      *                  IF ASC-OTHER-AUDIT-TEMP = 0                    14814500
                           MOVE ASC-OTHER-AUDIT TO ASC-OTHER-AUDIT-TEMP 14814600
      *                  END-IF                                         14814700
                         PERFORM 2050-DELETE-LIST-QUEUE                 14814800
                         PERFORM 3200-RESET-ATTRIBUTES                  14814900
                         PERFORM 4000-BUILD-INITIAL-PANEL               14815000
                      ELSE                                              14815100
                            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        14815200
                            SET DP030-OVERRIDE-GO TO TRUE               14815300
                            MOVE PC-TSYMSG-03740 TO DP020-MSG-NUMBER    14815400
                            SET DP020-MSG-WARNING TO TRUE               14815500
                      END-IF                                            14816700
      *VSH 11/21/13 - END PR#5148D                                      14816800
                   ELSE                                                 14817000
                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14818000
                      SET DP030-OVERRIDE-GO TO TRUE                     14818100
                      MOVE PC-TSYMSG-03739 TO DP020-MSG-NUMBER          14818200
                      SET DP020-MSG-WARNING TO TRUE                     14818300
                   END-IF                                               14820000
      *SB 10/15/13 - END PR#5148D                                       14820300
                                                                        14820400
148200*F6                                                               14821000
148300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14830000
148400             MOVE +1               TO PV-TOP-ITEM                 14840000
148500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14850000
148600*F7                                                               14860000
148700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14870000
148800             PERFORM 2110-BROWSE-BACKWARD                         14880000
148900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14890000
149000*F8                                                               14900000
149100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14910000
149200             PERFORM 2120-BROWSE-FORWARD                          14920000
149300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14930000
149400                                                                  14940000
149500         WHEN DP020-SRC-AID = DP016-ENTER                         14950000
149600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14960000
149700             IF  PS-ERROR                                         14970000
149800                 CONTINUE                                         14980000
149900             ELSE                                                 14990000
150000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15000000
150100             END-IF                                               15010000
150200                                                                  15020000
150300         WHEN OTHER                                               15030000
150400             PERFORM 2050-DELETE-LIST-QUEUE                       15040000
150500             PERFORM 4000-BUILD-INITIAL-PANEL                     15050000
150600             PERFORM 3200-RESET-ATTRIBUTES                        15060000
150700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15070000
150800**LS         SET DP013-NO-ROLLBACK                                15080000
150900**LS             DP013-XCTL-DISPLAY-RESTART                       15090000
151000**LS             DP013-CICS-ABEND  TO TRUE                        15100000
151100**LS         MOVE '2100-CHECK-FUNCTION-KEY'                       15110000
151200**LS                               TO DP013-PARAGRAPH             15120000
151300**LS         MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15130000
151400**LS                               TO DP013-MESSAGE-TEXT (1)      15140000
151500**LS         PERFORM DP013-0000-PROCESS-ABEND                     15150000
151600     END-EVALUATE.                                                15160000
151700*                                                                 15170000
151800*                                                                 15180000
151900*----------------------------------------------------------------*15190000
152000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15200000
152100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15210000
152200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15220000
152300*    MESSAGE.                                                    *15230000
152400*----------------------------------------------------------------*15240000
152500 2110-BROWSE-BACKWARD.                                            15250000
152600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15260000
152700         GIVING PV-TOP-ITEM.                                      15270000
152800                                                                  15280000
152900     IF  ((PV-TOP-ITEM < +1)                                      15290000
153000       OR (PV-TOP-ITEM = +1))                                     15300000
153100         MOVE +1                   TO PV-TOP-ITEM                 15310000
153200*        -- TOP OF LIST --                                        15320000
153300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15330000
153400         SET DP020-MSG-INFORMATIONAL TO TRUE                      15340000
153500     END-IF.                                                      15350000
153600                                                                  15360000
153700                                                                  15370000
153800*                                                                 15380000
153900*                                                                 15390000
154000*----------------------------------------------------------------*15400000
154100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15410000
154200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15420000
154300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15430000
154400*----------------------------------------------------------------*15440000
154500 2120-BROWSE-FORWARD.                                             15450000
154600                                                                  15460000
154700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15470000
154800         GIVING PV-TOP-ITEM.                                      15480000
154900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15490000
155000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15500000
155100                                   TO PV-TOP-ITEM                 15510000
155200*        -- BOTTOM OF LIST --                                     15520000
155300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15530000
155400         SET DP020-MSG-INFORMATIONAL                              15540000
155500                                   TO TRUE                        15550000
155600     ELSE                                                         15560000
155700         COMPUTE PV-BOTTOM-ITEM =                                 15570000
155800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15580000
155900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15590000
156000*            -- BOTTOM OF LIST --                                 15600000
156100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15610000
156200             SET DP020-MSG-INFORMATIONAL                          15620000
156300                                   TO TRUE                        15630000
156400         END-IF                                                   15640000
156500     END-IF.                                                      15650000
156600                                                                  15660000
156700*                                                                 15670000
156800*                                                                 15680000
156900*----------------------------------------------------------------*15690000
157000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *15700000
157100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *15710000
157200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *15720000
157300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *15730000
157400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *15740000
157500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15750000
157600*----------------------------------------------------------------*15760000
157700 2130-CHECK-FOR-JUMP-BROWSE.                                      15770000
157800     SET PS-NO-ERROR               TO TRUE.                       15780000
157900     IF (ASC-START-ITEM-REQUEST = SPACE)                          15790000
158000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15800000
158100                                   TO PV-TOP-ITEM                 15810000
158200     ELSE                                                         15820000
158300         MOVE ASC-START-ITEM-REQUEST                              15830000
158400                                   TO DP010I-UNEDITED-FIELD       15840000
158500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15850000
158600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15860000
158700         SET DP010I-NEGATIVE-NOT-ALLOWED                          15870000
158800                                   TO TRUE                        15880000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15891099
263968              USING DP010I-NUMERIC-EDIT-AREA                      15892099
159000                                                                  15900000
159100         IF  NOT DP010I-ERROR-DETECTED                            15910000
159200             MOVE DP010I-NUMERIC-FIELD                            15920000
159300                                   TO  ASC-START-ITEM-REQUEST-N   15930000
159400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15940000
159500                 IF  ASC-START-ITEM-REQUEST-N >                   15950000
159600                                          ASC-NUMBER-OF-ITEMS-READ15960000
159700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15970000
159800                     COMPUTE PV-TOP-ITEM =                        15980000
159900                             ASC-NUMBER-OF-ITEMS-READ             15990000
160000                             - PC-ITEMS-PER-PANEL + 1             16000000
160100                     IF  PV-TOP-ITEM < +1                         16010000
160200                         MOVE +1   TO PV-TOP-ITEM                 16020000
160300                         MOVE PC-TSYMSG-00070                     16030000
160400                                   TO DP020-MSG-NUMBER            16040000
160500                         SET DP020-MSG-INFORMATIONAL              16050000
160600                                   TO TRUE                        16060000
160700                     END-IF                                       16070000
160800                 ELSE                                             16080000
160900                     MOVE ASC-START-ITEM-REQUEST-N                16090000
161000                                   TO PV-TOP-ITEM                 16100000
161100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16110000
161200                     COMPUTE PV-BOTTOM-ITEM =                     16120000
161300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16130000
161400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16140000
161500*                        -- BOTTOM OF LIST --                     16150000
161600                         MOVE PC-TSYMSG-00070                     16160000
161700                                   TO DP020-MSG-NUMBER            16170000
161800                         SET DP020-MSG-INFORMATIONAL              16180000
161900                                   TO TRUE                        16190000
162000                     END-IF                                       16200000
162100                 END-IF                                           16210000
162200             ELSE                                                 16220000
162300*                --- VALUE OUT OF RANGE ----                      16230000
162400                 MOVE PC-TSYMSG-00101                             16240000
162500                                   TO DP020-MSG-NUMBER            16250000
162600                 MOVE -1           TO ASTRTITL                    16260000
162700                 SET DP030-SET-CURSOR-APPL-1                      16270000
162800                                   TO TRUE                        16280000
162900                 MOVE DP015-REVERSE                               16290000
163000                                   TO ASTRTITH                    16300000
163100                 MOVE DP015-RED    TO ASTRTITC                    16310000
163200                 MOVE DP015-UNP-NUM-BRT-MDT                       16320000
163300                                   TO ASTRTITA                    16330000
163400                 SET DP020-MSG-FATAL                              16340000
163500                                   TO TRUE                        16350000
163600                 SET PS-ERROR      TO TRUE                        16360000
163700             END-IF                                               16370000
163800                                                                  16380000
163900         ELSE                                                     16390000
164000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16400000
164100             MOVE -1               TO ASTRTITL                    16410000
164200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16420000
164300             MOVE DP015-REVERSE    TO ASTRTITH                    16430000
164400             MOVE DP015-RED        TO ASTRTITC                    16440000
164500             MOVE DP015-UNP-NUM-BRT-MDT                           16450000
164600                                   TO ASTRTITA                    16460000
164700             SET DP020-MSG-FATAL   TO TRUE                        16470000
164800             SET PS-ERROR          TO TRUE                        16480000
164900         END-IF                                                   16490000
165000     END-IF.                                                      16500000
165100                                                                  16510000
165200*                                                                 16520000
165300*                                                                 16530000
165400*----------------------------------------------------------------*16540000
165500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16550000
165600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16560000
165700*----------------------------------------------------------------*16570000
165800 2140-DESELECT-ALL-ITEMS.                                         16580000
165900     MOVE +1                       TO ASC-BLK-SUB.                16590000
166000                                                                  16600000
166100     PERFORM 2141-CLEAR-SELECTED-INDS                             16610000
166200         VARYING ASC-ITEM-SUB                                     16620000
166300         FROM 1 BY 1                                              16630000
166400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16640000
166500                                                                  16650000
166600     ADD +1                        TO ASC-BLK-SUB.                16660000
166700                                                                  16670000
166800     PERFORM 2141-CLEAR-SELECTED-INDS                             16680000
166900         VARYING ASC-ITEM-SUB                                     16690000
167000         FROM 1 BY 1                                              16700000
167100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16710000
167200                                                                  16720000
167300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16730000
167400                                   TO PV-LIST-ITEM-NUMBER.        16740000
167500                                                                  16750000
167600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16760000
167700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16770000
167800                                                                  16780000
167900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16790000
168000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16800000
168100         MOVE +1                   TO ASC-BLK-SUB                 16810000
168200                                                                  16820000
168300         PERFORM 5100-WRITE-TEMP-STORAGE                          16830000
168400                                                                  16840000
168500         MOVE +1                   TO PV-BLOCK-NUMBER             16850000
168600                                                                  16860000
168700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16870000
168800             PV-FIRST-BLOCK-IN-ARRAY - 1                          16880000
168900                                                                  16890000
169000         PERFORM                                                  16900000
169100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16910000
169200                                                                  16920000
169300             PERFORM 4410-READ-TEMP-STORAGE                       16930000
169400                                                                  16940000
169500             PERFORM 2141-CLEAR-SELECTED-INDS                     16950000
169600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16960000
169700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16970000
169800                                                                  16980000
169900             PERFORM 5100-WRITE-TEMP-STORAGE                      16990000
170000                                                                  17000000
170100             ADD +1                TO PV-BLOCK-NUMBER             17010000
170200                                                                  17020000
170300         END-PERFORM                                              17030000
170400                                                                  17040000
170500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17050000
170600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17060000
170700                                                                  17070000
170800         PERFORM                                                  17080000
170900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17090000
171000                   ASC-HIGHEST-BLOCK-WRITTEN                      17100000
171100                                                                  17110000
171200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17120000
171300                                   TO PV-BLOCK-NUMBER             17130000
171400                                                                  17140000
171500             PERFORM 4410-READ-TEMP-STORAGE                       17150000
171600                                                                  17160000
171700             PERFORM 2141-CLEAR-SELECTED-INDS                     17170000
171800                 VARYING ASC-ITEM-SUB                             17180000
171900                 FROM 1 BY 1                                      17190000
172000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17200000
172100                                                                  17210000
172200             PERFORM 5100-WRITE-TEMP-STORAGE                      17220000
172300                                                                  17230000
172400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17240000
172500                                                                  17250000
172600         END-PERFORM                                              17260000
172700                                                                  17270000
172800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17280000
172900                                   TO PV-BLOCK-NUMBER             17290000
173000                                                                  17300000
173100         PERFORM 4410-READ-TEMP-STORAGE                           17310000
173200     END-IF.                                                      17320000
173300                                                                  17330000
173400                                                                  17340000
173500     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17350000
173600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17360000
173700     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17370000
173800                                                                  17380000
173900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17390000
174000                                                                  17400000
174100                                                                  17410000
174200*                                                                 17420000
174300*                                                                 17430000
174400*----------------------------------------------------------------*17440000
174500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17450000
174600*----------------------------------------------------------------*17460000
174700 2141-CLEAR-SELECTED-INDS.                                        17470000
174800                                                                  17480000
174900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17490000
175000             NOT EQUAL ZERO                                       17500000
175100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17510000
175200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17520000
175300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17530000
175400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17540000
175500                                   TO TRUE                        17550000
175600         END-IF                                                   17560000
175700     END-IF.                                                      17570000
175800                                                                  17580000
175900                                                                  17590000
176000*                                                                 17600000
176100*                                                                 17610000
176200*----------------------------------------------------------------*17620000
176300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17630000
176400*  FOR ALL ITEMS.                                                *17640000
176500*----------------------------------------------------------------*17650000
176600 2150-SELECT-ALL-ITEMS.                                           17660000
176700                                                                  17670000
176800     MOVE +1                       TO ASC-BLK-SUB.                17680000
176900                                                                  17690000
177000     PERFORM 2151-SET-SELECTED-INDS                               17700000
177100         VARYING ASC-ITEM-SUB                                     17710000
177200         FROM 1 BY 1                                              17720000
177300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17730000
177400                                                                  17740000
177500     ADD +1                        TO ASC-BLK-SUB.                17750000
177600                                                                  17760000
177700     PERFORM 2151-SET-SELECTED-INDS                               17770000
177800         VARYING ASC-ITEM-SUB                                     17780000
177900         FROM 1 BY 1                                              17790000
178000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17800000
178100                                                                  17810000
178200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17820000
178300                                   TO PV-LIST-ITEM-NUMBER.        17830000
178400                                                                  17840000
178500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17850000
178600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17860000
178700                                                                  17870000
178800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17880000
178900        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17890000
179000         MOVE +1                   TO ASC-BLK-SUB                 17900000
179100                                                                  17910000
179200         PERFORM 5100-WRITE-TEMP-STORAGE                          17920000
179300                                                                  17930000
179400         MOVE +1                   TO PV-BLOCK-NUMBER             17940000
179500                                                                  17950000
179600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17960000
179700             PV-FIRST-BLOCK-IN-ARRAY - 1                          17970000
179800                                                                  17980000
179900         PERFORM                                                  17990000
180000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18000000
180100                                                                  18010000
180200             PERFORM 4410-READ-TEMP-STORAGE                       18020000
180300                                                                  18030000
180400             PERFORM 2151-SET-SELECTED-INDS                       18040000
180500                 VARYING ASC-ITEM-SUB                             18050000
180600                 FROM 1 BY 1                                      18060000
180700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18070000
180800                                                                  18080000
180900             PERFORM 5100-WRITE-TEMP-STORAGE                      18090000
181000                                                                  18100000
181100             ADD +1                TO PV-BLOCK-NUMBER             18110000
181200                                                                  18120000
181300         END-PERFORM                                              18130000
181400                                                                  18140000
181500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18150000
181600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18160000
181700                                                                  18170000
181800         PERFORM                                                  18180000
181900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18190000
182000                   ASC-HIGHEST-BLOCK-WRITTEN                      18200000
182100                                                                  18210000
182200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18220000
182300                                   TO PV-BLOCK-NUMBER             18230000
182400                                                                  18240000
182500             PERFORM 4410-READ-TEMP-STORAGE                       18250000
182600                                                                  18260000
182700             PERFORM 2151-SET-SELECTED-INDS                       18270000
182800                 VARYING ASC-ITEM-SUB                             18280000
182900                 FROM 1 BY 1                                      18290000
183000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18300000
183100                                                                  18310000
183200             PERFORM 5100-WRITE-TEMP-STORAGE                      18320000
183300                                                                  18330000
183400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18340000
183500                                                                  18350000
183600         END-PERFORM                                              18360000
183700                                                                  18370000
183800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18380000
183900                                   TO PV-BLOCK-NUMBER             18390000
184000                                                                  18400000
184100         PERFORM 4410-READ-TEMP-STORAGE                           18410000
184200     END-IF.                                                      18420000
184300                                                                  18430000
184400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18440000
184500                       ASC-NUMBER-OF-SELECTED-ITEMS.              18450000
184600                                                                  18460000
184700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18470000
184800                                                                  18480000
184900                                                                  18490000
185000*                                                                 18500000
185100*                                                                 18510000
185200*----------------------------------------------------------------*18520000
185300*    MARK EACH ITEM AS BEING SELECTED.                           *18530000
185400*----------------------------------------------------------------*18540000
185500 2151-SET-SELECTED-INDS.                                          18550000
185600                                                                  18560000
185700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18570000
185800             NOT EQUAL ZERO                                       18580000
185900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18590000
186000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18600000
186100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18610000
186200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18620000
186300                               TO  TRUE                           18630000
186400         END-IF                                                   18640000
186500     END-IF.                                                      18650000
186600*                                                                 18660000
186700*                                                                 18670000
186800******************************************************************18680000
186900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18690000
187000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18700000
187100******************************************************************18710000
187200 2200-MOVE-SCREEN-TO-COMMAREA.                                    18720000
187300                                                                  18730000
187400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18740000
187500     MOVE +1                       TO PV-SUB.                     18750000
187600                                                                  18760000
187700     PERFORM 3100-SET-SUBSCRIPTS.                                 18770000
187800     IF  ASTRTITL > ZERO                                          18780000
187900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          18790000
188000     ELSE                                                         18800000
188100         IF  ASTRTITF = DP015-ERASE-EOF                           18810000
188200             INITIALIZE ASC-START-ITEM-REQUEST                    18820000
188300         END-IF                                                   18830000
188400     END-IF.                                                      18840000
188500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18850000
188600         VARYING PV-SUB                                           18860000
188700         FROM 1 BY 1                                              18870000
188800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18880000
188900*                                                                 18890000
189000*                                                                 18900000
189100******************************************************************18910000
189200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**18920000
189300******************************************************************18930000
189400 2210-MOVE-LINES-TO-COMMAREA.                                     18940000
189500     IF  MR-SELECTL (PV-SUB) > ZERO                               18950000
189600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18960000
189700         MOVE MR-SELECTI (PV-SUB)                                 18970000
189800                                   TO ASC-TEMP-SELECTED-SW        18980000
189900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18990000
190000     ELSE                                                         19000000
190100         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19010000
190200                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19020000
190300                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19030000
190400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19040000
190500         END-IF                                                   19050000
190600     END-IF.                                                      19060000
190700     ADD +1                        TO ASC-ITEM-SUB.               19070000
190800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19080000
190900         ADD +1                    TO ASC-BLK-SUB                 19090000
191000         MOVE +1                   TO ASC-ITEM-SUB                19100000
191100     END-IF.                                                      19110000
191200*                                                                 19120000
191300*                                                                 19130000
191400 1130-GET-NEXT-RECORD.                                            19140000
191500     ADD +1                        TO ASC-SEL-SUB.                19150000
191600     IF  ASC-SEL-SUB > SU025-MAX-ITEMS                            19160000
191700         ADD +1                    TO ASC-SEL-ITEM                19170000
191800         MOVE +1                   TO ASC-SEL-SUB                 19180000
191900     END-IF.                                                      19190000
192000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                19200000
192100         IF  DP020-INT-APPL-FORMAT-IND = PC-DETAIL-FORMAT         19210000
192200            MOVE SU027-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN19220000
192300             PERFORM 9100-READ-SEL-QUEUE                          19230000
192400             IF  SU025-ITEM (ASC-SEL-SUB) > ZERO                  19240000
192500                 MOVE SU025-AUDIT-NBR  (ASC-SEL-SUB)              19250000
192600                                       TO ASC-AUDIT-NBR           19260000
192700                 MOVE SU025-SOURCE     (ASC-SEL-SUB)              19270000
192800                                       TO ASC-SOURCE              19280000
192900                 MOVE SU025-PO-RECEIVER(ASC-SEL-SUB)              19290000
193000                                       TO ASC-PO-RECEIVER         19300000
193100                                                                  19310000
193200                 IF SU025-PACK-LINE (ASC-SEL-SUB) = 'PBS' OR      19320000
      *SB 10/15/13 - BEGIN PR#5148D                                     19320100
                          SU025-PACK-LINE (ASC-SEL-SUB) = 'RFID'        19321000
      *SB 10/15/13 - END PR#5148D                                       19322000
193300                    MOVE SPACES TO ASC-PACK-LINE-NBR-CHAR         19330000
193400                    MOVE ZEROES TO DK-LNE-NBR                     19340000
193500                                   DK-PREPK-ID                    19350000
193600                 ELSE                                             19360000
193700                    MOVE SU025-PACK-LINE  (ASC-SEL-SUB)           19370000
193800                                TO ASC-PACK-LINE-NBR              19380000
193900                 END-IF                                           19390000
194000                                                                  19400000
194100*                IF SU025-PACK-LINE(1:2) = 'P-'                   19410000
194200                                                                  19420000
194300                     MOVE SU025-PACK-LINE(ASC-SEL-SUB)(3:4)       19430000
194400                                TO DK-PACK-LINE                   19440000
194500                                                                  19450000
194600*                    MOVE ZERO  TO DK-LNE-NBR                     19460000
194700*                ELSE                                             19470000
194800*                    IF SU025-PACK-LINE(1:2) = 'L-'               19480000
194900*                        MOVE SU025-PACK-LINE(3:4)                19490000
195000*                               TO DK-PACK-LINE                   19500000
195100*                        MOVE ZERO  TO DK-PREPK-ID                19510000
195200*                    END-IF                                       19520000
195300*                END-IF                                           19530000
195400                                                                  19540000
195500                 MOVE SU025-REQUEST-DATE (ASC-SEL-SUB)            19550000
195600                                       TO ASC-REQUEST-DATE        19560000
195700                 MOVE SU025-REQUEST-MDCY (ASC-SEL-SUB)            19570000
195800                                       TO ASC-REQUEST-MDCY        19580000
195900                 MOVE SU025-REQUEST-TIME (ASC-SEL-SUB)            19590000
196000                                       TO ASC-REQUEST-TIME        19600000
196100* DMH BEGIN 4/4/02                                                19610000
196200                 MOVE SU025-PROCESS-ST-CDE  (ASC-SEL-SUB)         19620000
196300                                       TO ASC-PROCESS-STATUS      19630000
196400                 MOVE SU025-PKG-TYPE (ASC-SEL-SUB)                19640000
196500                                            TO ASC-PACKAGING-TYPE 19650000
196600                 MOVE SU025-MODIFIED-IND (ASC-SEL-SUB)            19660000
196700                                            TO ASC-MODIFIED-IND   19670000
196800* DMH END 4/4/02                                                  19680000
196900                                                                  19690000
197000                 PERFORM 7000-SELECT-PO-AUD-REQ                   19700000
197100                 PERFORM 7050-DEPT-DESC                           19710000
197200                 SET SU025-INQ (ASC-SEL-SUB)                      19720000
197300                                       TO TRUE                    19730000
197400                 PERFORM 9200-REWRITE-SEL-QUEUE                   19740000
197500             ELSE                                                 19750000
197600                 SUBTRACT +1 FROM ASC-SEL-SUB                     19760000
197700*            --- BOTTOM OF LIST ---                               19770000
197800                 MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER        19780000
197900                 SET DP020-MSG-INFORMATIONAL                      19790000
198000                                       TO TRUE                    19800000
198100             END-IF                                               19810000
198200         ELSE                                                     19820000
198300            IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT        19830000
198400                 PERFORM 9300-READ-SEL-QUEUE-2                    19840000
198500                 IF  SU025-ITEM (ASC-SEL-SUB) > ZERO              19850000
198600                     MOVE SU025-AUDIT-NBR  (ASC-SEL-SUB)          19860000
198700                                           TO ASC-AUDIT-NBR       19870000
198800                     MOVE SU025-SOURCE     (ASC-SEL-SUB)          19880000
198900                                           TO ASC-SOURCE          19890000
199000                     MOVE SU025-PO-RECEIVER(ASC-SEL-SUB)          19900000
199100                                           TO ASC-PO-RECEIVER     19910000
199200                                                                  19920000
199300                     IF SU025-PACK-LINE (ASC-SEL-SUB) = 'PBS' OR  19930000
      *SB 10/15/13 - BEGIN PR#5148D                                     19931000
                              SU025-PACK-LINE (ASC-SEL-SUB) = 'RFID'    19932000
      *SB 10/15/13 - END PR#5148D                                       19933000
199400                        MOVE SPACES TO ASC-PACK-LINE-NBR-CHAR     19940000
199500                        MOVE ZEROES TO DK-LNE-NBR                 19950000
199600                                       DK-PREPK-ID                19960000
199700                     ELSE                                         19970000
199800                        MOVE SU025-PACK-LINE  (ASC-SEL-SUB)       19980000
199900                                    TO ASC-PACK-LINE-NBR          19990000
200000                     END-IF                                       20000000
200100                                                                  20010000
200200*                    IF SU025-PACK-LINE(1:2) = 'P-'               20020000
200300                                                                  20030000
200400                         MOVE SU025-PACK-LINE(ASC-SEL-SUB)(3:4)   20040000
200500                                    TO DK-PACK-LINE               20050000
200600                                                                  20060000
200700*                        MOVE ZERO  TO DK-LNE-NBR                 20070000
200800*                    ELSE                                         20080000
200900*                        IF SU025-PACK-LINE(1:2) = 'L-'           20090000
201000*                            MOVE SU025-PACK-LINE(3:4)            20100000
201100*                                   TO DK-PACK-LINE               20110000
201200*                            MOVE ZERO  TO DK-PREPK-ID            20120000
201300*                        END-IF                                   20130000
201400*                    END-IF                                       20140000
201500                                                                  20150000
201600                     MOVE SU025-REQUEST-DATE (ASC-SEL-SUB)        20160000
201700                                           TO ASC-REQUEST-DATE    20170000
201800                     MOVE SU025-REQUEST-MDCY (ASC-SEL-SUB)        20180000
201900                                           TO ASC-REQUEST-MDCY    20190000
202000                     MOVE SU025-REQUEST-TIME (ASC-SEL-SUB)        20200000
202100                                           TO ASC-REQUEST-TIME    20210000
202200* DMH BEGIN 4/4/02                                                20220000
202300                     MOVE SU025-PROCESS-ST-CDE  (ASC-SEL-SUB)     20230000
202400                                           TO ASC-PROCESS-STATUS  20240000
202500                     MOVE SU025-PKG-TYPE (ASC-SEL-SUB)            20250000
202600                                        TO ASC-PACKAGING-TYPE     20260000
202700                     MOVE SU025-MODIFIED-IND (ASC-SEL-SUB)        20270000
202800                                               TO ASC-MODIFIED-IND20280000
202900* DMH END 4/4/02                                                  20290000
203000                                                                  20300000
203100                     PERFORM 7000-SELECT-PO-AUD-REQ               20310000
203200                     PERFORM 7050-DEPT-DESC                       20320000
203300                     SET SU025-INQ (ASC-SEL-SUB)                  20330000
203400                                           TO TRUE                20340000
203500                     PERFORM 9400-REWRITE-SEL-QUEUE-2             20350000
203600                 ELSE                                             20360000
203700                     SUBTRACT +1 FROM ASC-SEL-SUB                 20370000
203800*                     --- BOTTOM OF LIST ---                      20380000
203900                     MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER    20390000
204000                     SET DP020-MSG-INFORMATIONAL                  20400000
204100                                           TO TRUE                20410000
204200                 END-IF                                           20420000
204300     ELSE                                                         20430000
204400         SUBTRACT +1 FROM ASC-SEL-ITEM                            20440000
204500         MOVE SU025-MAX-ITEMS      TO ASC-SEL-SUB                 20450000
204600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            20460000
204700         SET DP020-MSG-INFORMATIONAL                              20470000
204800                                   TO TRUE                        20480000
204900     END-IF.                                                      20490000
205000*                                                                 20500000
205100*                                                                 20510000
205200 1140-GET-PREV-RECORD.                                            20520000
205300     SUBTRACT +1                 FROM ASC-SEL-SUB.                20530000
205400     IF ASC-SEL-SUB < +1                                          20540000
205500         SUBTRACT +1             FROM ASC-SEL-ITEM                20550000
205600         MOVE SU025-MAX-ITEMS      TO ASC-SEL-SUB                 20560000
205700     END-IF.                                                      20570000
205800                                                                  20580000
205900     MOVE SU027-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       20590000
206000     IF ASC-SEL-ITEM > ZERO                                       20600000
206100         PERFORM 9100-READ-SEL-QUEUE                              20610000
206200         MOVE SU025-AUDIT-NBR  (ASC-SEL-SUB)                      20620000
206300                               TO ASC-AUDIT-NBR                   20630000
206400         MOVE SU025-SOURCE     (ASC-SEL-SUB)                      20640000
206500                               TO ASC-SOURCE                      20650000
206600         MOVE SU025-PO-RECEIVER(ASC-SEL-SUB)                      20660000
206700                               TO ASC-PO-RECEIVER                 20670000
206800                                                                  20680000
206900         IF SU025-PACK-LINE (ASC-SEL-SUB) = 'PBS' OR              20690000
      *SB 10/15/13 - BEGIN PR#5148D                                     20691000
                  SU025-PACK-LINE (ASC-SEL-SUB) = 'RFID'                20692000
      *SB 10/15/13 - END PR#5148D                                       20693000
207000            MOVE SPACES TO ASC-PACK-LINE-NBR-CHAR                 20700000
207100         ELSE                                                     20710000
207200            MOVE SU025-PACK-LINE  (ASC-SEL-SUB)                   20720000
207300                        TO ASC-PACK-LINE-NBR                      20730000
207400         END-IF                                                   20740000
207500                                                                  20750000
202500         MOVE SU025-PKG-TYPE (ASC-SEL-SUB)                        20751000
202600                               TO ASC-PACKAGING-TYPE              20752000
207600         MOVE SU025-REQUEST-DATE (ASC-SEL-SUB)                    20760000
207700                               TO ASC-REQUEST-DATE                20770000
207800         MOVE SU025-REQUEST-MDCY (ASC-SEL-SUB)                    20780000
207900                               TO ASC-REQUEST-MDCY                20790000
208000         MOVE SU025-REQUEST-TIME (ASC-SEL-SUB)                    20800000
208100                               TO ASC-REQUEST-TIME                20810000
208200         SET SU025-INQ (ASC-SEL-SUB) TO TRUE                      20820000
208300         PERFORM 9200-REWRITE-SEL-QUEUE                           20830000
208400     ELSE                                                         20840000
208500             MOVE +1 TO  ASC-SEL-SUB                              20850000
208600                         ASC-SEL-ITEM                             20860000
208700*            --- TOP OF LIST ---                                  20870000
208800             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            20880000
208900             SET DP020-MSG-INFORMATIONAL                          20890000
209000                                   TO TRUE                        20900000
209100     END-IF.                                                      20910000
209200*                                                                 20920000
209300*                                                                 20930000
209400*                                                                 20940000
209500*                                                                 20950000
209600******************************************************************20960000
209700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **20970000
209800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **20980000
209900******************************************************************20990000
210000 3000-EDIT-DATA-IN-COMMAREA.                                      21000000
210100     SET PS-NO-ERROR               TO TRUE.                       21010000
210200     PERFORM 3200-RESET-ATTRIBUTES.                               21020000
210300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21030000
210400**                                                                21040000
210500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              21050000
210600* EDITING IS DONE FROM THE BOTTOM UP.                             21060000
210700**                                                                21070000
210800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       21080000
210900         ASC-ITEMS-DISPLAYED - 1.                                 21090000
211000     PERFORM 3100-SET-SUBSCRIPTS.                                 21100000
211100     PERFORM 3300-EDIT-SELECTIONS                                 21110000
211200         VARYING PV-SUB                                           21120000
211300         FROM PV-SUB BY -1                                        21130000
211400         UNTIL PV-SUB < +1                                        21140000
211500                                                                  21150000
211600     IF  PS-NO-ERROR                                              21160000
211700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        21170000
211800     END-IF.                                                      21180000
211900*                                                                 21190000
212000     IF  ((PS-NO-ERROR)                                           21200000
212100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   21210000
212200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    21220000
212300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  21230000
212400     END-IF.                                                      21240000
212500                                                                  21250000
212600*                                                                 21260000
212700*                                                                 21270000
212800*----------------------------------------------------------------*21280000
212900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21290000
213000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21300000
213100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21310000
213200*                                                                *21320000
213300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21330000
213400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21340000
213500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21350000
213600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21360000
213700*----------------------------------------------------------------*21370000
213800 3100-SET-SUBSCRIPTS.                                             21380000
213900                                                                  21390000
214000     COMPUTE ASC-ITEM-SUB =                                       21400000
214100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21410000
214200                                                                  21420000
214300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21430000
214400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21440000
214500                                                                  21450000
214600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21460000
214700     ELSE                                                         21470000
214800         MOVE +1                     TO ASC-BLK-SUB               21480000
214900     END-IF.                                                      21490000
215000*                                                                 21500000
215100*                                                                 21510000
215200******************************************************************21520000
215300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **21530000
215400******************************************************************21540000
215500 3200-RESET-ATTRIBUTES.                                           21550000
215600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   21560000
215700     MOVE DP015-GREEN              TO ASTRTITC.                   21570000
215800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   21580000
215900                                                                  21590000
216000     PERFORM                                                      21600000
216100         VARYING PV-SUB                                           21610000
216200         FROM 1 BY 1                                              21620000
216300         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        21630000
216400         MOVE DP015-UNP-ALP-NOR-OFF                               21640000
216500                                   TO MR-SELECTA (PV-SUB)         21650000
216600         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         21660000
216700         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         21670000
216800     END-PERFORM.                                                 21680000
216900*                                                                 21690000
217000*                                                                 21700000
217100******************************************************************21710000
217200** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **21720000
217300** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **21730000
217400** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **21740000
217500** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **21750000
217600******************************************************************21760000
217700 3300-EDIT-SELECTIONS.                                            21770000
217800     EVALUATE TRUE                                                21780000
217900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21790000
218000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         21800000
218100                 CONTINUE                                         21810000
218200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         21820000
218300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21830000
218400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   21840000
218500                 MOVE ASC-TEMP-SELECTED-SW                        21850000
218600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21860000
218700                                TO ASC-SELECTED-SW                21870000
218800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21880000
218900             END-IF                                               21890000
219000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21900000
219100                 = SPACE                                          21910000
219200             EVALUATE TRUE                                        21920000
219300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       21930000
219400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21940000
219500                     MOVE SPACE TO ASC-SELECTED-SW                21950000
219600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21960000
219700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        21970000
219800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    21980000
219900                     MOVE SPACE TO ASC-SELECTED-SW                21990000
220000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22000000
220100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22010000
220200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22020000
220300                     MOVE SPACE TO ASC-SELECTED-SW                22030000
220400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22040000
220500             END-EVALUATE                                         22050000
220600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22060000
220700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22070000
220800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22080000
220900             END-IF                                               22090000
221000             PERFORM 3310-EDIT-RANGE                              22100000
221100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22110000
221200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22120000
221300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22130000
221400             END-IF                                               22140000
221500             PERFORM 3310-EDIT-RANGE                              22150000
221600         WHEN OTHER                                               22160000
221700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22170000
221800             SET DP020-MSG-FATAL    TO TRUE                       22180000
221900             MOVE -1                TO MR-SELECTL (PV-SUB)        22190000
222000             SET DP030-SET-CURSOR-APPL-1                          22200000
222100                                    TO TRUE                       22210000
222200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22220000
222300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22230000
222400             SET PS-ERROR TO TRUE                                 22240000
222500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22250000
222600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22260000
222700                 MOVE SPACE         TO ASC-SELECTED-SW            22270000
222800                                        (ASC-BLK-SUB ASC-ITEM-SUB)22280000
222900             END-IF                                               22290000
223000     END-EVALUATE.                                                22300000
223100                                                                  22310000
223200     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 22320000
223300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22330000
223400     IF  ASC-ITEM-SUB < 1                                         22340000
223500         SUBTRACT +1 FROM ASC-BLK-SUB                             22350000
223600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22360000
223700     END-IF.                                                      22370000
223800*                                                                 22380000
223900*                                                                 22390000
224000******************************************************************22400000
224100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **22410000
224200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **22420000
224300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**22430000
224400** THE ENDING.                                                  **22440000
224500******************************************************************22450000
224600 3310-EDIT-RANGE.                                                 22460000
224700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22470000
224800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   22480000
224900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)22490000
225000                                   TO ASC-SELECTED-SW             22500000
225100                                        (ASC-BLK-SUB ASC-ITEM-SUB)22510000
225200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22520000
225300         ELSE                                                     22530000
225400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22540000
225500                 CONTINUE                                         22550000
225600             ELSE                                                 22560000
225700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22570000
225800                 MOVE PC-TSYMSG-00054                             22580000
225900                                   TO DP020-MSG-NUMBER            22590000
226000                 SET DP020-MSG-FATAL                              22600000
226100                                   TO TRUE                        22610000
226200                 MOVE -1           TO MR-SELECTL (PV-SUB)         22620000
226300                 SET DP030-SET-CURSOR-APPL-1                      22630000
226400                                   TO TRUE                        22640000
226500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         22650000
226600                 MOVE DP015-UNDERLINE                             22660000
226700                                   TO MR-SELECTH (PV-SUB)         22670000
226800                 SET PS-ERROR      TO TRUE                        22680000
226900             END-IF                                               22690000
227000         END-IF                                                   22700000
227100     ELSE                                                         22710000
227200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22720000
227300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22730000
227400                                   TO ASC-SELECTED-SW             22740000
227500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22750000
227600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22760000
227700         ELSE                                                     22770000
227800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22780000
227900                 CONTINUE                                         22790000
228000             ELSE                                                 22800000
228100*                -- ONLY ONE END-OF-RANGE ALLOWED --              22810000
228200                 MOVE PC-TSYMSG-00055                             22820000
228300                                   TO DP020-MSG-NUMBER            22830000
228400                 SET DP020-MSG-FATAL                              22840000
228500                                   TO TRUE                        22850000
228600                 MOVE -1           TO MR-SELECTL (PV-SUB)         22860000
228700                 SET DP030-SET-CURSOR-APPL-1                      22870000
228800                                   TO TRUE                        22880000
228900                 SET PS-ERROR      TO TRUE                        22890000
229000             END-IF                                               22900000
229100         END-IF                                                   22910000
229200     END-IF.                                                      22920000
229300*                                                                 22930000
229400*                                                                 22940000
229500******************************************************************22950000
229600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **22960000
229700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **22970000
229800******************************************************************22980000
229900 3400-CHECK-RANGE-SEQUENCE.                                       22990000
230000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23000000
230100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23010000
230200       AND  ASC-START-OF-SELECTED-RANGE >                         23020000
230300                                         ASC-END-OF-SELECTED-RANGE23030000
230400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23040000
230500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23050000
230600         SET DP020-MSG-FATAL TO TRUE                              23060000
230700         SET PS-ERROR TO TRUE                                     23070000
230800         PERFORM 3410-POSITION-AT-ERROR                           23080000
230900     END-IF.                                                      23090000
231000*                                                                 23100000
231100*                                                                 23110000
231200******************************************************************23120000
231300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **23130000
231400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **23140000
231500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **23150000
231600******************************************************************23160000
231700 3410-POSITION-AT-ERROR.                                          23170000
231800     SET DP030-SET-CURSOR-APPL-1                                  23180000
231900                                   TO TRUE.                       23190000
232000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23200000
232100                    - PV-TOP-ITEM + 1.                            23210000
232200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23220000
232300         CONTINUE                                                 23230000
232400     ELSE                                                         23240000
232500         MOVE -1                   TO MR-SELECTL (PV-SUB)         23250000
232600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23260000
232700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23270000
232800     END-IF.                                                      23280000
232900                                                                  23290000
233000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23300000
233100                    - PV-TOP-ITEM + 1.                            23310000
233200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23320000
233300         CONTINUE                                                 23330000
233400     ELSE                                                         23340000
233500         MOVE -1                   TO MR-SELECTL (PV-SUB)         23350000
233600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23360000
233700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23370000
233800     END-IF.                                                      23380000
233900                                                                  23390000
234000*                                                                 23400000
234100*                                                                 23410000
234200*----------------------------------------------------------------*23420000
234300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23430000
234400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23440000
234500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23450000
234600*----------------------------------------------------------------*23460000
234700 3500-MARK-RANGE-AS-SELECTED.                                     23470000
234800     MOVE +1                       TO  ASC-BLK-SUB.               23480000
234900     PERFORM 3510-MARK-SELECTED-INDS                              23490000
235000         VARYING ASC-ITEM-SUB                                     23500000
235100         FROM 1 BY 1                                              23510000
235200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23520000
235300                                                                  23530000
235400     ADD +1                        TO ASC-BLK-SUB.                23540000
235500     PERFORM 3510-MARK-SELECTED-INDS                              23550000
235600         VARYING ASC-ITEM-SUB                                     23560000
235700         FROM 1 BY 1                                              23570000
235800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23580000
235900                                                                  23590000
236000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23600000
236100                                   TO  PV-LIST-ITEM-NUMBER.       23610000
236200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23620000
236300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23630000
236400               PC-ITEMS-PER-PANEL).                               23640000
236500                                                                  23650000
236600     MOVE ASC-START-OF-SELECTED-RANGE                             23660000
236700                                   TO PV-START-OF-SELECTED-RANGE. 23670000
236800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            23680000
236900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  23690000
237000               PC-ITEMS-PER-PANEL).                               23700000
237100                                                                  23710000
237200     MOVE ASC-END-OF-SELECTED-RANGE                               23720000
237300                                   TO  PV-END-OF-SELECTED-RANGE.  23730000
237400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             23740000
237500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    23750000
237600               PC-ITEMS-PER-PANEL).                               23760000
237700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             23770000
237800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             23780000
237900                                                                  23790000
238000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23800000
238100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23810000
238200         MOVE +1                   TO ASC-BLK-SUB                 23820000
238300         PERFORM 5100-WRITE-TEMP-STORAGE                          23830000
238400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23840000
238500             PV-FIRST-BLOCK-IN-ARRAY - 1                          23850000
238600                                                                  23860000
238700         PERFORM                                                  23870000
238800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      23880000
238900                   PV-PREV-BLOCK-IN-ARRAY                         23890000
239000             MOVE PV-FIRST-BLOCK-IN-RANGE                         23900000
239100                                   TO PV-BLOCK-NUMBER             23910000
239200             PERFORM 4410-READ-TEMP-STORAGE                       23920000
239300             PERFORM 3510-MARK-SELECTED-INDS                      23930000
239400                 VARYING ASC-ITEM-SUB                             23940000
239500                 FROM 1 BY 1                                      23950000
239600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23960000
239700             PERFORM 5100-WRITE-TEMP-STORAGE                      23970000
239800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23980000
239900         END-PERFORM                                              23990000
240000                                                                  24000000
240100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24010000
240200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24020000
240300         PERFORM                                                  24030000
240400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24040000
240500                   PV-LAST-BLOCK-IN-RANGE                         24050000
240600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24060000
240700                                   TO PV-BLOCK-NUMBER             24070000
240800             PERFORM 4410-READ-TEMP-STORAGE                       24080000
240900             PERFORM 3510-MARK-SELECTED-INDS                      24090000
241000                 VARYING ASC-ITEM-SUB                             24100000
241100                 FROM 1 BY 1                                      24110000
241200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24120000
241300             PERFORM 5100-WRITE-TEMP-STORAGE                      24130000
241400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24140000
241500         END-PERFORM                                              24150000
241600                                                                  24160000
241700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24170000
241800                                   TO PV-BLOCK-NUMBER             24180000
241900         PERFORM 4410-READ-TEMP-STORAGE                           24190000
242000     END-IF.                                                      24200000
242100                                                                  24210000
242200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24220000
242300                                      ASC-END-OF-SELECTED-RANGE.  24230000
242400                                                                  24240000
242500                                                                  24250000
242600*                                                                 24260000
242700*                                                                 24270000
242800*----------------------------------------------------------------*24280000
242900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24290000
243000*----------------------------------------------------------------*24300000
243100 3510-MARK-SELECTED-INDS.                                         24310000
243200                                                                  24320000
243300     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24330000
243400                                ASC-ITEM-SUB) >                   24340000
243500         ASC-START-OF-SELECTED-RANGE)                             24350000
243600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24360000
243700                                ASC-ITEM-SUB) =                   24370000
243800         ASC-START-OF-SELECTED-RANGE)                             24380000
243900                                                                  24390000
244000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24400000
244100                                    ASC-ITEM-SUB) <               24410000
244200             ASC-END-OF-SELECTED-RANGE)                           24420000
244300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     24430000
244400                                    ASC-ITEM-SUB) =               24440000
244500             ASC-END-OF-SELECTED-RANGE)                           24450000
244600                                                                  24460000
244700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          24470000
244800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   24480000
244900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   24490000
245000                               TO TRUE                            24500000
245100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              24510000
245200                               TO TRUE                            24520000
245300                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    24530000
245400             END-IF                                               24540000
245500         END-IF                                                   24550000
245600     END-IF.                                                      24560000
245700                                                                  24570000
245800                                                                  24580000
245900*                                                                 24590000
246000*                                                                 24600000
246100*----------------------------------------------------------------*24610000
246200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *24620000
246300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *24630000
246400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *24640000
246500*    DISPLAY THE PANEL TO USER.                                  *24650000
246600*----------------------------------------------------------------*24660000
246700 4000-BUILD-INITIAL-PANEL.                                        24670000
246800                                                                  24680000
246900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            24690000
247000                                 ASC-BLOCK-ENTRIES (2).           24700000
247100     MOVE +1                 TO ASC-BLK-SUB.                      24710000
247200     SET ASC-ITEMS-LEFT-ON-DB                                     24720000
247300                             TO TRUE.                             24730000
247400                                                                  24740000
247500     MOVE +0                 TO ASC-ITEM-SUB                      24750000
247600                                ASC-NUMBER-OF-ITEMS-READ          24760000
247700                                ASC-NUMBER-OF-SELECTED-ITEMS      24770000
247800                                ASC-HIGHEST-BLOCK-WRITTEN         24780000
247900                                ASC-START-OF-SELECTED-RANGE       24790000
248000                                ASC-END-OF-SELECTED-RANGE         24800000
248100                                ASC-ITEM-AT-TOP-OF-PANEL.         24810000
248300     PERFORM 1250-MOD-QTY-IND.                                    24830000
      *SB 10/15/13 - BEGIN PR#5148D                                     24830100
           PERFORM 8000-CHECK-PO-EXCEPTION.                             24831000
           PERFORM 8100-CHECK-VENDOR-TAGGING.                           24832000
      *SB 10/15/13 - END PR#5148D                                       24832100
      *SB 04/28/14 - BEGIN PR#5148D                                     24832200
           IF ASC-VENDOR-TAGGING                                        24832300
              PERFORM 8200-CHECK-DEPT-TAGGING                           24832400
           END-IF.                                                      24832500
      *SB 04/28/14 - END PR#5148D                                       24833000
248400                                                                  24840000
248500     PERFORM 4100-PREPARE-CURSOR.                                 24850000
248600     PERFORM 4010-OPEN-CURSOR.                                    24860000
248700                                                                  24870000
248800     PERFORM 4300-READ-ITEMS-FROM-DB.                             24880000
248900                                                                  24890000
249000     PERFORM 4020-CLOSE-CURSOR.                                   24900000
249100                                                                  24910000
249200     MOVE +1                   TO  PV-TOP-ITEM                    24920000
249300     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24930000
249400         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    24940000
249500         SET DP020-MSG-FATAL   TO  TRUE                           24950000
249600         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24960000
249700     ELSE                                                         24970000
249800         MOVE -1               TO MR-SELECTL (1)                  24980000
249900         SET DP030-SET-CURSOR-APPL-1                              24990000
250000                               TO TRUE                            25000000
250100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25010000
250200     END-IF.                                                      25020000
250300                                                                  25030000
250400*                                                                 25040000
250500*                                                                 25050000
250600*----------------------------------------------------------------*25060000
250700* OPEN THE AUDIT CARTON CURSOR.                                  *25070000
250800*----------------------------------------------------------------*25080000
250900 4010-OPEN-CURSOR.                                                25090000
251000     PERFORM                                                      25100000
251100         WITH TEST AFTER                                          25110000
251200         VARYING PV-RETRY-COUNTER                                 25120000
251300         FROM 1 BY 1                                              25130000
251400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25140000
251500                   OR (SQLCODE = ZERO))                           25150000
251600         EXEC SQL                                                 25160000
251700              OPEN AUD-CARTON-CSR                                 25170000
251800         END-EXEC                                                 25180000
251900                                                                  25190000
252000         EVALUATE TRUE                                            25200000
252100             WHEN SQLCODE = ZERO                                  25210000
252200             WHEN SQLCODE = -904                                  25220000
252300             WHEN SQLCODE = -913                                  25230000
252400                 CONTINUE                                         25240000
252500             WHEN SQLWARN0 NOT = SPACES                           25250000
252600             WHEN SQLCODE < ZERO                                  25260000
252700             WHEN SQLCODE > ZERO                                  25270000
252800                 MOVE '4010-OPEN-CURSOR'                          25280000
252900                                   TO DP013-PARAGRAPH             25290000
253000                 MOVE 'OPEN AUDIT CARTON CURSOR - '               25300000
253100                                   TO DP013-MESSAGE-TEXT (1)      25310000
253200                 MOVE 'CURSOR:  AUD-CARTON-CSR'                   25320000
253300                                   TO DP013-MESSAGE-TEXT (2)      25330000
253400                 MOVE SQLCA        TO DP013-SQLCA                 25340000
253500                 MOVE 'TSUATRN '  TO DP013-DB2-TABLE-NAME (1)     25350000
253600                 SET DP013-DB2-ABEND                              25360000
253700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25370000
253800                 PERFORM DP013-0000-PROCESS-ABEND                 25380000
253900         END-EVALUATE                                             25390000
254000     END-PERFORM.                                                 25400000
254100                                                                  25410000
254200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25420000
254300         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             25430000
254400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   25440000
254500                                   TO DP013-MESSAGE-TEXT (1)      25450000
254600         MOVE SQLCA                TO DP013-SQLCA                 25460000
254700         MOVE 'TSUATRN '  TO DP013-DB2-TABLE-NAME (1)             25470000
254800         SET DP013-DB2-ABEND                                      25480000
254900             DP013-XCTL-DISPLAY-RESTART                           25490000
255000                                   TO TRUE                        25500000
255100         PERFORM DP013-0000-PROCESS-ABEND                         25510000
255200     END-IF.                                                      25520000
255300                                                                  25530000
255400                                                                  25540000
255500*                                                                 25550000
255600*                                                                 25560000
255700*----------------------------------------------------------------*25570000
255800* CLOSE THE AUDIT CARTON CURSOR                                  *25580000
255900*----------------------------------------------------------------*25590000
256000 4020-CLOSE-CURSOR.                                               25600000
256100                                                                  25610000
256200     EXEC SQL                                                     25620000
256300          CLOSE AUD-CARTON-CSR                                    25630000
256400     END-EXEC.                                                    25640000
256500                                                                  25650000
256600     EVALUATE TRUE                                                25660000
256700         WHEN SQLCODE = ZERO                                      25670000
256800             CONTINUE                                             25680000
256900         WHEN SQLWARN0 NOT = SPACES                               25690000
257000         WHEN SQLCODE < ZERO                                      25700000
257100         WHEN SQLCODE > ZERO                                      25710000
257200             MOVE '4020-CLOSE-CURSOR'                             25720000
257300                               TO DP013-PARAGRAPH                 25730000
257400             MOVE 'CLOSE THE AUDIT CARTON CURSOR'                 25740000
257500                               TO DP013-MESSAGE-TEXT (1)          25750000
257600             MOVE 'CURSOR:  AUD-CARTON-CSR'                       25760000
257700                               TO DP013-MESSAGE-TEXT (2)          25770000
257800             MOVE SQLCA        TO DP013-SQLCA                     25780000
257900             MOVE 'TSUATRN '  TO DP013-DB2-TABLE-NAME (1)         25790000
258000             SET DP013-DB2-ABEND                                  25800000
258100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25810000
258200             PERFORM DP013-0000-PROCESS-ABEND                     25820000
258300     END-EVALUATE.                                                25830000
258400                                                                  25840000
258500                                                                  25850000
258600*                                                                 25860000
258700*                                                                 25870000
258800*----------------------------------------------------------------*25880000
258900*    SET UP THE HOST VARIABLES.                                  *25890000
259000*----------------------------------------------------------------*25900000
259100 4100-PREPARE-CURSOR.                                             25910000
259200                                                                  25920000
259300     MOVE ASC-AUDIT-NBR          TO DK-AUDIT-NBR.                 25930000
259400                                                                  25940000
259500                                                                  25950000
259600*                                                                 25960000
259700*                                                                 25970000
259800*----------------------------------------------------------------*25980000
259900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25990000
260000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26000000
260100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26010000
260200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26020000
260300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26030000
260400*                                                                *26040000
260500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26050000
260600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26060000
260700*    UPON INITIALIZATION.                                        *26070000
260800*----------------------------------------------------------------*26080000
260900 4300-READ-ITEMS-FROM-DB.                                         26090000
261000                                                                  26100000
261100     PERFORM                                                      26110000
261200         VARYING PV-READ-COUNT                                    26120000
261300         FROM 1 BY 1                                              26130000
261400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26140000
261500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26150000
261600                                                                  26160000
261700         PERFORM 4310-FETCH                                       26170000
261800         IF  ASC-ITEMS-LEFT-ON-DB                                 26180000
261900             MOVE SUATRN-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID          26190000
262000             PERFORM 1200-GET-AUDIT-QTY                           26200000
262100             PERFORM 1300-GET-ERROR-COUNT                         26210000
262200***          PERFORM 1400-COUNT-ERRORS                            26220000
262300         END-IF                                                   26230000
262400                                                                  26240000
262500         IF  ASC-ITEMS-LEFT-ON-DB                                 26250000
262600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26260000
262700               ADD +1            TO ASC-ITEM-SUB                  26260100
262200***          PERFORM 1400-COUNT-ERRORS                            26269300
262800             ELSE                                                 26280000
262900                 ADD +1            TO ASC-BLK-SUB                 26290000
263000                 MOVE +1           TO ASC-ITEM-SUB                26300000
263100                                                                  26310000
263200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26320000
263300                     MOVE +1       TO ASC-BLK-SUB                 26330000
263400                     SET ASC-BLOCK-MODIFIED (1)                   26340000
263500                                   TO TRUE                        26350000
263600                     PERFORM 5100-WRITE-TEMP-STORAGE              26360000
263700                     MOVE ASC-BLOCK-ENTRIES                       26370000
263800                               (PC-MAX-BLOCKS-IN-ARRAY)           26380000
263900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26390000
264000                     ADD +1        TO ASC-BLK-SUB                 26400000
264100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26410000
264200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26420000
264300                                   TO TRUE                        26430000
264400                 END-IF                                           26440000
264500             END-IF                                               26450000
                                                                        26450100
      *SB 10/15/13 - BEGIN PR#5148D                                     26450200
                   IF ASC-MULTIPLE-AUD                                  26451000
                      PERFORM 1350-CHECK-CARTON-COMBINED                26452000
                   ELSE                                                 26453000
                      SET ASC-COMBINED-NO (ASC-BLK-SUB ASC-ITEM-SUB)    26454000
                                       TO TRUE                          26455000
                   END-IF                                               26456000
      *SB 10/15/13 - END PR#5148D                                       26456100
264600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26460000
264700             MOVE SPACES                                          26470000
264800                                   TO ASC-ACTION                  26480000
264900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26490000
265000             MOVE ASC-NUMBER-OF-ITEMS-READ                        26500000
265100                                   TO ASC-LIST-ITEM-NUMBER        26510000
265200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26520000
265300             MOVE SUATRN-SHIPT-UNT-ID                             26530000
265400                                   TO ASC-TBL-CARTON-ID           26540000
265500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26550000
265600             MOVE SUATRN-UNT-AUD-STAT-CDE                         26560000
265700                                   TO ASC-TBL-CART-STATUS         26570000
265800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26580000
265900             MOVE PV-STRT-DATE-TIME-DISPLAY                       26590000
266000                                   TO ASC-TBL-STRT-DATE           26600000
266100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26610000
266200             MOVE PV-STP-DATE-TIME-DISPLAY                        26620000
266300                                   TO ASC-TBL-STOP-DATE           26630000
266400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26640000
266500             MOVE SUATRN-UNT-AUD-USR-ID                           26650000
266600                                   TO ASC-TBL-AUD-USER-ID         26660000
266700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26670000
                   MOVE PV-SCND-UNT-QTY TO ASC-TBL-AUDIT-QTY            26700200
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  26700400
                                                                        26703000
267100             IF PV-ERROR-COUNT > 0                                26710000
267200                 MOVE 'Y'               TO ASC-TBL-ERROR-IND      26720000
267300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26730000
267400             ELSE                                                 26740000
267500                 MOVE 'N'               TO ASC-TBL-ERROR-IND      26750000
267600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26760000
267700             END-IF                                               26770000
267710             PERFORM 4330-GET-LAST-DIRECTIVE                      26771000
267800* DMH                                                             26780000
267900             IF  SUATRN-UNT-AUD-USR-ID  >  SPACE                  26790000
268000                 CONTINUE                                         26800000
268100             ELSE                                                 26810000
268200                 PERFORM 4320-GET-USER-ID                         26820000
268300                 MOVE SUAUPC-AUD-USR-ID                           26830000
268400                                   TO ASC-TBL-AUD-USER-ID         26840000
268500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26850000
268600             END-IF                                               26860000
268700* DMH                                                             26870000
268800         END-IF                                                   26880000
268900     END-PERFORM.                                                 26890000
269000                                                                  26900000
269100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          26910000
269200         MOVE +1               TO ASC-BLK-SUB                     26920000
269300         PERFORM 5100-WRITE-TEMP-STORAGE                          26930000
269400         ADD +1                TO ASC-BLK-SUB                     26940000
269500         PERFORM 5100-WRITE-TEMP-STORAGE                          26950000
269600                                                                  26960000
269700         MOVE 1                TO ASC-BLK-SUB                     26970000
269800                                  PV-BLOCK-NUMBER                 26980000
269900         PERFORM 4410-READ-TEMP-STORAGE                           26990000
270000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27000000
270100             MOVE 2            TO ASC-BLK-SUB                     27010000
270200                                  PV-BLOCK-NUMBER                 27020000
270300             PERFORM 4410-READ-TEMP-STORAGE                       27030000
270400         END-IF                                                   27040000
270500     END-IF.                                                      27050000
270600                                                                  27060000
270700*                                                                 27070000
270800*                                                                 27080000
270900*----------------------------------------------------------------*27090000
271000*    FETCH THE AUDIT CARTON-CURSOR                               *27100000
271100*----------------------------------------------------------------*27110000
271200 4310-FETCH.                                                      27120000
271300                                                                  27130000
271400     EXEC SQL                                                     27140000
271500          FETCH AUD-CARTON-CSR                                    27150000
271600          INTO  :SUATRN-SHIPT-UNT-ID                              27160000
271700               ,:SUATRN-UNT-AUD-STAT-CDE                          27170000
271800               ,:SUATRN-UNT-AUD-STRT-TMST                         27180000
271900               ,:SUATRN-UNT-AUD-STP-TMST                          27190000
272000               ,:SUATRN-UNT-AUD-USR-ID                            27200000
272100     END-EXEC.                                                    27210000
272200                                                                  27220000
272300     EVALUATE TRUE                                                27230000
272400         WHEN SQLCODE = ZERO                                      27240000
272500              MOVE SUATRN-UNT-AUD-STRT-TMST TO PV-STRT-TMST-R     27250000
272600              MOVE PV-STRT-TMST-YY      TO PV-STRT-DISPLAY-YY     27260000
272700              MOVE PC-DASH              TO PV-STRT-DASH-1         27270000
272800              MOVE PV-STRT-TMST-MM      TO PV-STRT-DISPLAY-MM     27280000
272900              MOVE PC-DASH              TO PV-STRT-DASH-2         27290000
273000              MOVE PV-STRT-TMST-DD      TO PV-STRT-DISPLAY-DD     27300000
273100              MOVE PV-STRT-TMST-HRS     TO PV-STRT-DISPLAY-HRS    27310000
273200              MOVE PC-COLON             TO PV-STRT-COLON          27320000
273300              MOVE PV-STRT-TMST-MIN     TO PV-STRT-DISPLAY-MIN    27330000
273400                                                                  27340000
273500              MOVE SUATRN-UNT-AUD-STP-TMST TO PV-STP-TMST-R       27350000
273600              MOVE PV-STP-TMST-YY       TO PV-STP-DISPLAY-YY      27360000
273700              MOVE PC-DASH              TO PV-STP-DASH-1          27370000
273800              MOVE PV-STP-TMST-MM       TO PV-STP-DISPLAY-MM      27380000
273900              MOVE PC-DASH              TO PV-STP-DASH-2          27390000
274000              MOVE PV-STP-TMST-DD       TO PV-STP-DISPLAY-DD      27400000
274100              MOVE PV-STP-TMST-HRS      TO PV-STP-DISPLAY-HRS     27410000
274200              MOVE PC-COLON             TO PV-STP-COLON           27420000
274300              MOVE PV-STP-TMST-MIN      TO PV-STP-DISPLAY-MIN     27430000
274400         WHEN SQLCODE = +100                                      27440000
274500              MOVE SPACES          TO PV-STRT-TMST-R              27450000
274600                                      PV-STP-TMST-R               27460000
274700              MOVE SPACES          TO PV-STRT-DISPLAY-YY          27470000
274800                                      PV-STP-DISPLAY-YY           27480000
274900              MOVE SPACES          TO PV-STRT-DASH-1              27490000
275000                                      PV-STP-DASH-1               27500000
275100              MOVE SPACES          TO PV-STRT-DISPLAY-MM          27510000
275200                                      PV-STP-DISPLAY-MM           27520000
275300              MOVE SPACES          TO PV-STRT-DASH-2              27530000
275400                                      PV-STP-DASH-2               27540000
275500              MOVE SPACES          TO PV-STRT-DISPLAY-DD          27550000
275600                                      PV-STP-DISPLAY-DD           27560000
275700              MOVE SPACES          TO PV-STRT-DISPLAY-HRS         27570000
275800                                      PV-STP-DISPLAY-HRS          27580000
275900              MOVE SPACES          TO PV-STRT-COLON               27590000
276000                                      PV-STP-COLON                27600000
276100              MOVE SPACES          TO PV-STRT-DISPLAY-MIN         27610000
276200                                      PV-STP-DISPLAY-MIN          27620000
276300         WHEN SQLWARN0 NOT = SPACE                                27630000
276400         WHEN SQLCODE NOT = ZERO                                  27640000
276500              MOVE '4310-FETCH-CURSOR'                            27650000
276600                               TO DP013-PARAGRAPH                 27660000
276700              MOVE 'FETCH AUDIT CURSOR'                           27670000
276800                               TO DP013-MESSAGE-TEXT (1)          27680000
276900              MOVE 'CURSOR:  AUD-CARTON-CSR'                      27690000
277000                               TO DP013-MESSAGE-TEXT (2)          27700000
277100              MOVE 'TSUATRN '  TO DP013-DB2-TABLE-NAME (1)        27710000
277200              MOVE SQLCA       TO DP013-SQLCA                     27720000
277300              SET DP013-DB2-ABEND                                 27730000
277400                               TO TRUE                            27740000
277500              PERFORM DP013-0000-PROCESS-ABEND                    27750000
277600     END-EVALUATE.                                                27760000
277700                                                                  27770000
277800     IF  SQLCODE EQUAL +100                                       27780000
277900         SET ASC-NO-ITEMS-LEFT-ON-DB                              27790000
278000                                   TO TRUE                        27800000
278100     END-IF.                                                      27810000
278200                                                                  27820000
278300                                                                  27830000
278400*----------------------------------------------------------------*27840000
278500* GET USERID FROM TSUAUPC IF USERID IS BLANK ON TSUATRN          *27850000
278600*----------------------------------------------------------------*27860000
278700 4320-GET-USER-ID.                                                27870000
278800                                                                  27880000
278900     EXEC SQL                                                     27890000
279000        SELECT  DISTINCT(AUD_USR_ID)                              27900000
279100          INTO :SUAUPC-AUD-USR-ID                                 27910000
279200          FROM  TSUAUPC                                           27920000
279300         WHERE  AUD_CNTL_NBR         = :DK-AUDIT-NBR              27930000
279400           AND  SHIPT_UNT_ID         = :SUATRN-SHIPT-UNT-ID       27940000
279500     END-EXEC.                                                    27950000
279600                                                                  27960000
279700     EVALUATE TRUE                                                27970000
279800         WHEN SQLCODE = ZERO                                      27980000
279900         WHEN SQLCODE = -811                                      27990000
280000             CONTINUE                                             28000000
280100                                                                  28010000
280200         WHEN SQLCODE = +100                                      28020000
280300             MOVE SPACES   TO  SUAUPC-AUD-USR-ID                  28030000
280400                                                                  28040000
280500         WHEN SQLWARN0 NOT = SPACE                                28050000
280600         WHEN SQLCODE NOT = ZERO                                  28060000
280700              MOVE '4320-GET-USER-ID '                            28070000
280800                               TO DP013-PARAGRAPH                 28080000
280900              MOVE 'GET USER ID FROM TSUAUPC'                     28090000
281000                               TO DP013-MESSAGE-TEXT (1)          28100000
281100              MOVE 'TSUAUPC '  TO DP013-DB2-TABLE-NAME (1)        28110000
281200              MOVE SQLCA       TO DP013-SQLCA                     28120000
281300              SET DP013-DB2-ABEND                                 28130000
281400                               TO TRUE                            28140000
281500              PERFORM DP013-0000-PROCESS-ABEND                    28150000
281600     END-EVALUATE.                                                28160000
281700/                                                                 28170000
281710*----------------------------------------------------------------*28171000
281720* GET LATEST DIRECTIVE FOR SHIP-UNT-ID. FILL IN INDICATOR        *28172000
281730*----------------------------------------------------------------*28173000
281740 4330-GET-LAST-DIRECTIVE.                                         28174000
281750                                                                  28175000
281751     EXEC SQL                                                     28175100
281760         SELECT DT1.DIRV_RSN_CDE                                  28176000
281761         INTO  :PV-DIRV-RSN-CDE                                   28176100
281770         FROM   SUT_CART_DIRV_TRKG  DT1                           28177000
281780         JOIN   TSULBXF             XF                            28178000
281790           ON   XF.BRCDE_NBR    = DT1.BRCDE_NBR                   28179000
281800          AND   XF.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                28180000
281801         WHERE  DT1.CRE_TMST =                                    28180100
281802                 (                                                28180200
281803                  SELECT MAX(DT2.CRE_TMST)                        28180300
281804                  FROM   SUT_CART_DIRV_TRKG  DT2                  28180400
281805                  WHERE  DT2.BRCDE_NBR = DT1.BRCDE_NBR            28180500
281806                 )                                                28180600
281807         AND  DT1.DIRV_RSN_CDE IN (                               28180700
281808                                   'AUN'                          28180800
281809                                  ,'AUP'                          28180900
281810                                  ,'BRC'                          28181000
281811                                  ,'RLC'                          28181100
281812                                  ,'RLF'                          28181200
281813                                  ,'RLO'                          28181300
281814                                  ,'RLR'                          28181400
281815                                  )                               28181500
281816     END-EXEC.                                                    28181600
281817                                                                  28181700
281818     EVALUATE TRUE                                                28181800
281819         WHEN SQLCODE = ZERO                                      28181900
281820             MOVE 'Y'               TO ASC-TBL-RLSED-IND          28182000
281830                                  (ASC-BLK-SUB ASC-ITEM-SUB)      28183000
281838         WHEN SQLCODE = +100                                      28183800
281839             MOVE 'N'               TO ASC-TBL-RLSED-IND          28183900
281840                                  (ASC-BLK-SUB ASC-ITEM-SUB)      28184000
281859         WHEN SQLWARN0 NOT = SPACE                                28185900
281860         WHEN SQLCODE NOT = ZERO                                  28186000
281861              MOVE '4330-GET-LAST-DIRECTIVE'                      28186100
281862                               TO DP013-PARAGRAPH                 28186200
281863              MOVE 'UNABLE TO SELECT'                             28186300
281864                               TO DP013-MESSAGE-TEXT (1)          28186400
281867              MOVE 'SUT_CART_DIRV_TRKG'                           28186700
281868                               TO DP013-DB2-TABLE-NAME (1)        28186800
281869              MOVE 'TSULBXF '  TO DP013-DB2-TABLE-NAME (2)        28186900
281870              MOVE SQLCA       TO DP013-SQLCA                     28187000
281871              SET DP013-DB2-ABEND                                 28187100
281872                               TO TRUE                            28187200
281873              PERFORM DP013-0000-PROCESS-ABEND                    28187300
281874     END-EVALUATE.                                                28187400
281880/                                                                 28188000
281900*----------------------------------------------------------------*28190000
282000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *28200000
282100*----------------------------------------------------------------*28210000
282200 4400-MOVE-COMMAREA-TO-SCREEN.                                    28220000
282300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             28230000
282400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          28240000
282500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          28250000
282600             MOVE +1    TO ASC-BLK-SUB                            28260000
282700             PERFORM 5100-WRITE-TEMP-STORAGE                      28270000
282800             ADD +1     TO ASC-BLK-SUB                            28280000
282900             PERFORM 5100-WRITE-TEMP-STORAGE                      28290000
283000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             28300000
283100                 GIVING PV-BLOCK-NUMBER                           28310000
283200                 REMAINDER PV-REMAINDER                           28320000
283300             IF  PV-REMAINDER > ZERO                              28330000
283400                 ADD +1 TO PV-BLOCK-NUMBER                        28340000
283500             END-IF                                               28350000
283600             MOVE +1    TO ASC-BLK-SUB                            28360000
283700             PERFORM 4410-READ-TEMP-STORAGE                       28370000
283800             ADD +1     TO ASC-BLK-SUB                            28380000
283900                           PV-BLOCK-NUMBER                        28390000
284000             PERFORM 4410-READ-TEMP-STORAGE                       28400000
284100     END-IF.                                                      28410000
284200     MOVE +1            TO ASC-BLK-SUB.                           28420000
284300     COMPUTE ASC-ITEM-SUB =                                       28430000
284400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              28440000
284500         + PC-ITEMS-PER-PANEL).                                   28450000
284600                                                                  28460000
284700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        28470000
284800         ADD +1         TO ASC-BLK-SUB                            28480000
284900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            28490000
285000     END-IF.                                                      28500000
285100                                                                  28510000
285200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           28520000
285300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                28530000
285400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        28540000
285500     PERFORM 4420-FORMAT-LIST-LINES                               28550000
285600         VARYING PV-SUB                                           28560000
285700         FROM PC-ITEMS-PER-PANEL BY -1                            28570000
285800         UNTIL PV-SUB < +1.                                       28580000
285900*TOP PART OF SCREEN                                               28590000
286000     MOVE ASC-AUDIT-NBR                TO AAUDITO.                28600000
286100                                                                  28610000
286200     MOVE ASC-REQUEST-MDCY             TO AREQDTEO.               28620000
286300     MOVE ASC-REQUEST-TIME             TO AREQTMEO.               28630000
286400                                                                  28640000
286500     EVALUATE ASC-PROCESS-STATUS                                  28650000
286600        WHEN 'P' MOVE PC-PASS          TO AAUDSTAO                28660000
286700        WHEN 'F' MOVE PC-FAIL          TO AAUDSTAO                28670000
286800        WHEN 'I' MOVE PC-IN-PROCESS    TO AAUDSTAO                28680000
286900        WHEN 'N' MOVE PC-NOT-NEEDED    TO AAUDSTAO                28690000
287000        WHEN 'R' MOVE PC-PROMPT        TO AAUDSTAO                28700000
287100        WHEN 'A' MOVE PC-ALL           TO AAUDSTAO                28710000
287200     END-EVALUATE.                                                28720000
287300                                                                  28730000
287400     IF ASC-PO-RECEIVER > SPACES                                  28740000
287500         MOVE ASC-PO-RECEIVER          TO APORCVRO                28750000
287600     ELSE                                                         28760000
287700         MOVE SPACES                   TO APORCVRO                28770000
287800     END-IF.                                                      28780000
287900                                                                  28790000
288000     MOVE SU025-PACK-LINE  (ASC-SEL-SUB) (1:1) TO PV-PACK-LINE    28800000
      *VSH 11/21/13 - BEGIN PR#5148D                                    28800100
           IF ASC-MULTIPLE-AUD                                          28801000
              EVALUATE ASC-PACKAGING-TYPE                               28801100
                 WHEN 'PP'                                              28801200
                        MOVE PC-PACK-ID         TO APKLNEO              28801300
                 WHEN 'BC'                                              28801400
                        MOVE PC-LINE-NBR        TO APKLNEO              28801500
                 WHEN 'RF'                                              28801600
                 WHEN 'PS'                                              28801700
                        MOVE SPACES             TO APKLNEO              28801800
              END-EVALUATE                                              28801900
           ELSE                                                         28802000
      *VSH 11/21/13 - END PR#5148D                                      28803000
288100        EVALUATE SU025-PKG-TYPE (ASC-SEL-SUB)                     28810000
288200           WHEN 'PP'                                              28820000
288300                  MOVE PC-PACK-ID         TO APKLNEO              28830000
288400           WHEN 'BC'                                              28840000
288500                  MOVE PC-LINE-NBR        TO APKLNEO              28850000
288600        END-EVALUATE                                              28860000
288700     END-IF.                                                      28870000
      *VSH 11/21/13 - BEGIN PR#5148D                                    28870100
           IF ASC-MULTIPLE-AUD                                          28871000
              EVALUATE ASC-PACKAGING-TYPE                               28873000
                 WHEN 'PP'                                              28874000
                 WHEN 'BC'                                              28874100
                        MOVE ASC-PACK-LINE-NBR         TO ALNENBRO      28875000
                 WHEN 'RF'                                              28878000
                 WHEN 'PS'                                              28879000
                        MOVE ASC-PACK-LINE-NBR-CHAR    TO ALNENBRO      28880000
              END-EVALUATE                                              28890000
      *VSH 11/21/13 - END PR#5148D                                      28900000
           ELSE                                                         28921000
              IF SU025-PACK-LINE (ASC-SEL-SUB) = 'PBS' OR               28921100
      *SB 10/15/13 - BEGIN PR#5148D                                     28921200
                 SU025-PACK-LINE (ASC-SEL-SUB) = 'RFID'                 28921300
      *SB 10/15/13 - END PR#5148D                                       28921400
                 MOVE ASC-PACK-LINE-NBR-CHAR    TO ALNENBRO             28921500
              ELSE                                                      28921600
                 MOVE ASC-PACK-LINE-NBR         TO ALNENBRO             28921700
              END-IF                                                    28921800
289300     END-IF                                                       28930000
                                                                        28931000
289400     EVALUATE ASC-SOURCE                                          28940000
289500         WHEN 'MAN' MOVE PC-MANUAL     TO ASOURCEO                28950000
289600         WHEN 'SYS' MOVE PC-SYSTEM     TO ASOURCEO                28960000
289700     END-EVALUATE.                                                28970000
289800                                                                  28980000
289900     MOVE ASC-OPER-UNT-ID              TO PV-OPER-UNT-ID.         28990000
290000     MOVE PV-OPER-UNT-ID               TO AOPRUNTO.               29000000
290100     MOVE ASC-OPER-DESC                TO AOPRDSCO.               29010000
290200                                                                  29020000
290300     EVALUATE ASC-PACKAGING-TYPE                                  29030000
290400        WHEN 'BC' MOVE PC-BULK-CSPK    TO APKGTYPO                29040000
290500        WHEN 'PP' MOVE PC-PRE-PACK     TO APKGTYPO                29050000
290600        WHEN 'PS' MOVE PC-PBS          TO APKGTYPO                29060000
      *SB 10/15/13 - BEGIN PR#5148D                                     29060100
290600        WHEN 'RF' MOVE PC-RFID         TO APKGTYPO                29061000
      *SB 10/15/13 - END PR#5148D                                       29062000
290700        WHEN 'AL' MOVE PC-ALL          TO APKGTYPO                29070000
290800     END-EVALUATE.                                                29080000
                                                                        29081000
      *SB 10/15/13 - BEGIN PR#5148D                                     29081100
           MOVE DP015-YELLOW                 TO ATYPMSGC                29081200
                                                                        29081300
           IF ASC-SYSTEM-AUD                                            29081500
290300        EVALUATE ASC-PACKAGING-TYPE                               29081600
                 WHEN 'RF'                                              29081700
                      MOVE 'RFID AUDIT     '         TO ATYPMSGO        29081800
                 WHEN OTHER                                             29081900
                      MOVE 'QC AUDIT       '         TO ATYPMSGO        29082000
290800        END-EVALUATE                                              29082100
           ELSE                                                         29082200
              IF ASC-PO-EXCEPTION                                       29082600
                 EVALUATE SUT00014-AUD-TYP-CDE                          29082700
                   WHEN 'Q'                                             29082800
                        MOVE 'QC 100%        '       TO ATYPMSGO        29082900
                   WHEN 'R'                                             29083000
                        MOVE 'RFID 100%      '       TO ATYPMSGO        29083100
                   WHEN 'A'                                             29083200
                        MOVE '100%           '       TO ATYPMSGO        29083300
                   WHEN 'N'                                             29083400
                        IF ASC-VENDOR-TAGGING AND ASC-DEPT-TAGGING      29083600
                           MOVE 'DC MANUAL COMBO'    TO ATYPMSGO        29083800
                        ELSE                                            29083900
                           MOVE 'DC MANUAL QC   '    TO ATYPMSGO        29084000
                        END-IF                                          29084100
                 END-EVALUATE                                           29084200
              ELSE                                                      29084300
                 IF ASC-VENDOR-TAGGING AND ASC-DEPT-TAGGING             29084400
                    MOVE 'DC MANUAL COMBO'           TO ATYPMSGO        29084500
                 ELSE                                                   29084600
                    MOVE 'DC MANUAL QC   '           TO ATYPMSGO        29084700
                 END-IF                                                 29084800
              END-IF                                                    29084900
           END-IF.                                                      29085000
      *SB 10/15/13 - END PR#5148D                                       29085100
                                                                        29086000
290900     PERFORM 7100-SELECT-AUDIT-TYPE.                              29090000
291000                                                                  29100000
291100     MOVE PV-AUDIT-TYPE            TO AAUDTYPO.                   29110000
291200     IF ASC-ENT-ID-N > 0                                          29120000
291300         MOVE ASC-ENT-ID-N             TO PV-ENT-ID               29130000
291400         MOVE PV-ENT-ID                TO AVENDIDO                29140000
291500     ELSE                                                         29150000
291600         MOVE SPACES                   TO AVENDIDO                29160000
291700     END-IF.                                                      29170000
291800     MOVE ASC-VENDOR-NAME              TO AVENDNMO.               29180000
291900                                                                  29190000
292000     IF ASC-DEPT-NBR-N > 0                                        29200000
292100         MOVE ASC-DEPT-NBR-N           TO PV-DEPT-NBR             29210000
292200         MOVE PV-DEPT-NBR              TO ADEPTO                  29220000
292300     ELSE                                                         29230000
292400         MOVE SPACES                   TO ADEPTO                  29240000
292500     END-IF.                                                      29250000
292600     MOVE ASC-DEPARTMENT-DESC          TO ADPTDSCO.               29260000
292700     MOVE ASC-MODIFIED-IND             TO AMODINDO.               29270000
292800                                                                  29280000
292900     IF  ASC-MOD-QTY-IND  = 'N'                                   29290000
293000        CONTINUE                                                  29300000
293100     ELSE                                                         29310000
293200        MOVE '*RECLAIM PERFORMED OR NOT ENOUGH CARTONS*'          29320000
293300                                       TO ARCLMSGO                29330000
293400     END-IF.                                                      29340000
293500                                                                  29350000
293600     COMPUTE ASC-ITEMS-DISPLAYED =                                29360000
293700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          29370000
293800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    29380000
293900                                      ASTRTITO.                   29390000
294000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    29400000
294100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    29410000
294200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            29420000
294300                                   TO ASELITO.                    29430000
294400                                                                  29440000
294500     IF  DP020-MSG-NUMBER-X = SPACE                               29450000
294600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  29460000
294700*            --- MORE ITEMS TO DISPLAY ----                       29470000
294800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            29480000
294900             SET DP020-MSG-INFORMATIONAL TO TRUE                  29490000
295000         END-IF                                                   29500000
295100     END-IF.                                                      29510000
295200*                                                                 29520000
295300*                                                                 29530000
295400*----------------------------------------------------------------*29540000
295500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *29550000
295600*----------------------------------------------------------------*29560000
295700 4410-READ-TEMP-STORAGE.                                          29570000
295800                                                                  29580000
295900     EXEC CICS                                                    29590000
296000         READQ TS                                                 29600000
296100             QUEUE (ASC-LIST-QUEUE-NAME)                          29610000
296200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29620000
296300             ITEM  (PV-BLOCK-NUMBER)                              29630000
296400             RESP  (PV-CICS-RESPONSE)                             29640000
296500     END-EXEC.                                                    29650000
296600                                                                  29660000
296700     IF  ((PV-CICS-RESPONSE = DFHRESP (NORMAL))                   29670000
296800       OR (PV-CICS-RESPONSE = DFHRESP (ITEMERR)))                 29680000
296900         CONTINUE                                                 29690000
297000     ELSE                                                         29700000
297100         SET DP013-CICS-ABEND     TO TRUE                         29710000
297200         SET DP013-NO-ROLLBACK    TO TRUE                         29720000
297300         MOVE '4410-READ-TEMP-STORAGE'                            29730000
297400                                  TO DP013-PARAGRAPH              29740000
297500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      29750000
297600                                  TO DP013-MESSAGE-TEXT(1)        29760000
297700         PERFORM DP013-0000-PROCESS-ABEND                         29770000
297800     END-IF.                                                      29780000
297900                                                                  29790000
298000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             29800000
298100                                                                  29810000
298200     IF  PV-CICS-RESPONSE = DFHRESP (ITEMERR)                     29820000
298300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               29830000
298400     END-IF.                                                      29840000
298500                                                                  29850000
298600*                                                                 29860000
298700*                                                                 29870000
298800*----------------------------------------------------------------*29880000
298900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *29890000
299000*----------------------------------------------------------------*29900000
299100 4420-FORMAT-LIST-LINES.                                          29910000
299200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      29920000
299300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                29930000
299400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           29940000
299500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           29950000
299600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           29960000
299700                                    MR-ACTION (PV-SUB)            29970000
299800                                    MR-CARTON   (PV-SUB)          29980000
299900                                    MR-CART-STATUS-X (PV-SUB)     29990000
300000                                    MR-STRT-DATE (PV-SUB)         30000000
300100                                    MR-STOP-DATE (PV-SUB)         30010000
300200                                    MR-AUD-USER-ID-X (PV-SUB)     30020000
300300                                    MR-AUDIT-QTY-X (PV-SUB)       30030000
300400                                    MR-ERROR-IND   (PV-SUB)       30040000
300410                                    MR-RLSED-IND   (PV-SUB)       30041000
300500     ELSE                                                         30050000
300600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30060000
300700                                                   > SPACE        30070000
300800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 30080000
300900                                 TO MR-SELECTI (PV-SUB)           30090000
301000         ELSE                                                     30100000
301100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30110000
301200                                 TO MR-SELECTI (PV-SUB)           30120000
301300         END-IF                                                   30130000
301400                                                                  30140000
301500         IF  DP030-SET-CURSOR-TRAILER                             30150000
301600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)30160000
301700                 > SPACE)                                         30170000
301800               OR (PV-SUB = 1))                                   30180000
301900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               30190000
302000                MOVE -1          TO MR-SELECTL (PV-SUB)           30200000
302100             END-IF                                               30210000
302200         END-IF                                                   30220000
302300                                                                  30230000
302400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           30240000
302500             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           30250000
302600                                 TO MR-ACTION (PV-SUB)            30260000
302700             MOVE ASC-TBL-CARTON-ID (ASC-BLK-SUB ASC-ITEM-SUB)    30270000
302800                                 TO MR-CARTON (PV-SUB)            30280000
302900             MOVE ASC-TBL-CART-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)  30290000
303000                                 TO MR-CART-STATUS (PV-SUB)       30300000
      *SB 10/15/13 - BEGIN PR#5148D                                     30300100
                   IF ASC-COMBINED-YES (ASC-BLK-SUB ASC-ITEM-SUB)       30300200
303000                 MOVE DP015-YELLOW TO MR-CART-STATUSC (PV-SUB)    30301000
                   END-IF                                               30301100
      *SB 10/15/13 - END PR#5148D                                       30302000
303100             IF ASC-TBL-STRT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) NOT =30310000
303200                '09-09-99 09:09'                                  30320000
303300                 MOVE ASC-TBL-STRT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)30330000
303400                                 TO MR-STRT-DATE (PV-SUB)         30340000
303500             END-IF                                               30350000
303600             IF ASC-TBL-STOP-DATE (ASC-BLK-SUB ASC-ITEM-SUB) NOT =30360000
303700                '09-09-99 09:09'                                  30370000
303800                 MOVE ASC-TBL-STOP-DATE (ASC-BLK-SUB ASC-ITEM-SUB)30380000
303900                                 TO MR-STOP-DATE (PV-SUB)         30390000
304000             END-IF                                               30400000
304100             MOVE ASC-TBL-AUD-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)  30410000
304200                                 TO MR-AUD-USER-ID (PV-SUB)       30420000
304300             MOVE ASC-TBL-AUDIT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    30430000
304400                                 TO MR-AUDIT-QTY (PV-SUB)         30440000
304500             MOVE ASC-TBL-ERROR-IND (ASC-BLK-SUB ASC-ITEM-SUB)    30450000
304600                                 TO MR-ERROR-IND (PV-SUB)         30460000
304610             MOVE ASC-TBL-RLSED-IND (ASC-BLK-SUB ASC-ITEM-SUB)    30461000
304620                                 TO MR-RLSED-IND (PV-SUB)         30462000
304700         END-IF                                                   30470000
304800     END-IF.                                                      30480000
304900     SUBTRACT +1 FROM ASC-ITEM-SUB                                30490000
305000     IF  ASC-ITEM-SUB < + 1                                       30500000
305100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  30510000
305200         MOVE +1                 TO ASC-BLK-SUB                   30520000
305300     END-IF.                                                      30530000
305400*                                                                 30540000
305500*                                                                 30550000
305600******************************************************************30560000
305700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **30570000
305800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **30580000
305900** ISSUE A WARNING.                                             **30590000
306000******************************************************************30600000
306100 4430-CHECK-FOR-BEGIN-AND-END.                                    30610000
306200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       30620000
306300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     30630000
306400*            -- NO END-OF-RANGE SPECFIED ---                      30640000
306500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            30650000
306600             SET DP020-MSG-WARNING TO TRUE                        30660000
306700             PERFORM 4431-POSITION-AT-WARNING                     30670000
306800         END-IF                                                   30680000
306900     ELSE                                                         30690000
307000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     30700000
307100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                30710000
307200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            30720000
307300             SET DP020-MSG-WARNING TO TRUE                        30730000
307400             PERFORM 4431-POSITION-AT-WARNING                     30740000
307500         END-IF                                                   30750000
307600     END-IF.                                                      30760000
307700*                                                                 30770000
307800*                                                                 30780000
307900******************************************************************30790000
308000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **30800000
308100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **30810000
308200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **30820000
308300** POSITION THE CURSOR THERE.                                   **30830000
308400******************************************************************30840000
308500 4431-POSITION-AT-WARNING.                                        30850000
308600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 30860000
308700                    - PV-TOP-ITEM + 1.                            30870000
308800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      30880000
308900         CONTINUE                                                 30890000
309000     ELSE                                                         30900000
309100         SET DP030-SET-CURSOR-APPL-1                              30910000
309200                                   TO TRUE                        30920000
309300         MOVE -1                   TO MR-SELECTL (PV-SUB)         30930000
309400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         30940000
309500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         30950000
309600     END-IF.                                                      30960000
309700                                                                  30970000
309800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   30980000
309900                    - PV-TOP-ITEM + 1.                            30990000
310000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31000000
310100         CONTINUE                                                 31010000
310200     ELSE                                                         31020000
310300         SET DP030-SET-CURSOR-APPL-1                              31030000
310400                                   TO TRUE                        31040000
310500         MOVE -1                   TO MR-SELECTL (PV-SUB)         31050000
310600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31060000
310700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31070000
310800     END-IF.                                                      31080000
310900                                                                  31090000
311000*                                                                 31100000
      *VSH 11/21/13 - BEGIN PR#5148D                                    31100100
       4432-QC-RFID-COMB-COUNT.                                         31101000
                                                                        31102000
           EXEC SQL                                                     31103000
               SELECT VALUE(COUNT(*), 0)                                31104000
                INTO :ASC-COUNT                                         31105000
                FROM SUT_PO_AUD_REQ                                     31106000
                WHERE RWRK_AUD_CNTL_NBR = :DK-AUDIT-NBR                 31107000
           END-EXEC.                                                    31108000
                                                                        31109000
           EVALUATE TRUE                                                31109100
               WHEN SQLCODE = ZERO                                      31109200
               WHEN SQLCODE = +100                                      31109300
               WHEN SQLCODE = -811                                      31109400
                   CONTINUE                                             31109500
               WHEN SQLWARN0 NOT = SPACES                               31109600
               WHEN SQLCODE < +0                                        31109700
               WHEN SQLCODE > ZERO                                      31109800
                   MOVE '4432-QC-RFID-COMB-COUNT'                       31109900
                                   TO DP013-PARAGRAPH                   31110000
                   MOVE 'SELECT SUT_PO_AUD_REQ'                         31110100
                                   TO DP013-MESSAGE-TEXT (1)            31110200
                   MOVE SQLCA      TO DP013-SQLCA                       31110300
                   MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME (1)   31110400
                   SET DP013-DB2-ABEND                                  31110500
                                   TO TRUE                              31110600
                   SET DP013-XCTL-DISPLAY-RESTART                       31110700
                                   TO TRUE                              31110800
                   PERFORM DP013-0000-PROCESS-ABEND                     31110900
           END-EVALUATE.                                                31111000
      *                                                                 31111100
       4433-RFID-AUD-CNTL-NBR.                                          31111200
                                                                        31111300
           EXEC SQL                                                     31111400
               SELECT AUD_CNTL_NBR                                      31111500
                INTO :ASC-RFID-AUD-CNTL-NBR                             31111600
                FROM SUT_PO_AUD_REQ                                     31111700
                WHERE RWRK_AUD_CNTL_NBR = :DK-AUDIT-NBR                 31111800
           END-EXEC.                                                    31111900
                                                                        31112000
           EVALUATE TRUE                                                31112100
               WHEN SQLCODE = ZERO                                      31112200
               WHEN SQLCODE = +100                                      31112300
               WHEN SQLCODE = -811                                      31112400
                   CONTINUE                                             31112500
               WHEN SQLWARN0 NOT = SPACES                               31112600
               WHEN SQLCODE < +0                                        31112700
               WHEN SQLCODE > ZERO                                      31112800
                   MOVE '4433-QC-RFID-COMB-COUNT'                       31112900
                                   TO DP013-PARAGRAPH                   31113000
                   MOVE 'SELECT SUT_PO_AUD_REQ'                         31113100
                                   TO DP013-MESSAGE-TEXT (1)            31113200
                   MOVE SQLCA      TO DP013-SQLCA                       31113300
                   MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME (1)   31113400
                   SET DP013-DB2-ABEND                                  31113500
                                   TO TRUE                              31113600
                   SET DP013-XCTL-DISPLAY-RESTART                       31113700
                                   TO TRUE                              31113800
                   PERFORM DP013-0000-PROCESS-ABEND                     31113900
           END-EVALUATE.                                                31114000
      *                                                                 31114100
      *VSH 11/21/13 - END PR#5148D                                      31114200
311100*                                                                 31115000
311200*----------------------------------------------------------------*31120000
311300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *31130000
311400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *31140000
311500* FOR THE SELECTED ITEMS QUEUE.                                  *31150000
311600*                                                                *31160000
311700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *31170000
311800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *31180000
311900* THE ARRAY IS FULL.                                             *31190000
312000*----------------------------------------------------------------*31200000
312100 5000-PREPARE-SEL-QUEUE.                                          31210000
312200                                                                  31220000
312300     MOVE +1                   TO  ASC-BLK-SUB.                   31230000
312400     PERFORM 5100-WRITE-TEMP-STORAGE.                             31240000
312500     ADD +1                    TO  ASC-BLK-SUB.                   31250000
312600     PERFORM 5100-WRITE-TEMP-STORAGE.                             31260000
312700                                                                  31270000
312800     MOVE ASC-SEL-QUEUE-NAME   TO  SU027-SEL-QUEUE-NAME.          31280000
312900     PERFORM 6010-DELETE-SEL-QUEUE.                               31290000
313000                                                                  31300000
313100     SET ASC-UPDATE-TSQ        TO  TRUE.                          31310000
313200                                                                  31320000
313300     SET SU028-IDX             TO  1.                             31330000
313400     MOVE ZERO                 TO SU027-NUMBER-OF-TS-ITEMS.       31340000
313500     INITIALIZE SU028-SELECTED-ITEM-ARRAY.                        31350000
313600                                                                  31360000
313700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           31370000
313800             VARYING PV-ITEM                                      31380000
313900             FROM 1 BY 1                                          31390000
314000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     31400000
314100                                                                  31410000
314200     IF  SU028-IDX > 1                                            31420000
314300         PERFORM 5205-WRITE-SEL-QUEUE                             31430000
314400         ADD +1                TO SU027-NUMBER-OF-TS-ITEMS        31440000
314500     END-IF.                                                      31450000
314600                                                                  31460000
314700*                                                                 31470000
314800*----------------------------------------------------------------*31480000
314900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *31490000
315000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *31500000
315100* FOR THE SELECTED ITEMS QUEUE.                                  *31510000
315200*                                                                *31520000
315300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *31530000
315400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *31540000
315500* THE ARRAY IS FULL.                                             *31550000
315600*----------------------------------------------------------------*31560000
315700 5010-PREPARE-SEL-QUEUE.                                          31570000
315800                                                                  31580000
315900     MOVE +1                   TO  ASC-BLK-SUB.                   31590000
316000     PERFORM 5100-WRITE-TEMP-STORAGE.                             31600000
316100     ADD +1                    TO  ASC-BLK-SUB.                   31610000
316200     PERFORM 5100-WRITE-TEMP-STORAGE.                             31620000
316300                                                                  31630000
316400     MOVE ASC-SEL-QUEUE-NAME   TO  SU038-SEL-QUEUE-NAME.          31640000
316500     PERFORM 6010-DELETE-SEL-QUEUE.                               31650000
316600                                                                  31660000
316700     SET ASC-UPDATE-TSQ        TO  TRUE.                          31670000
316800                                                                  31680000
316900     SET SU039-IDX             TO  1.                             31690000
317000     MOVE ZERO                 TO SU038-NUMBER-OF-TS-ITEMS.       31700000
317100     INITIALIZE SU039-SELECTED-ITEM-ARRAY.                        31710000
317200                                                                  31720000
317300     PERFORM 5300-FILL-SEL-QUEUE-RECORD                           31730000
317400             VARYING PV-ITEM                                      31740000
317500             FROM 1 BY 1                                          31750000
317600             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     31760000
317700                                                                  31770000
317800     IF  SU039-IDX > 1                                            31780000
317900         PERFORM 5305-WRITE-SEL-QUEUE                             31790000
318000         ADD +1                TO SU038-NUMBER-OF-TS-ITEMS        31800000
318100     END-IF.                                                      31810000
318200                                                                  31820000
318300*                                                                 31830000
318400*----------------------------------------------------------------*31840000
318500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *31850000
318600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *31860000
318700*----------------------------------------------------------------*31870000
318800 5100-WRITE-TEMP-STORAGE.                                         31880000
318900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     31890000
319000                                   TO PV-LIST-ITEM-NUMBER.        31900000
319100     COMPUTE PV-BLOCK-NUMBER =                                    31910000
319200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    31920000
319300                                                                  31930000
319400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             31940000
319500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             31950000
319600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      31960000
319700             PERFORM 5105-REWRITE-ASC-LISTQ                       31970000
319800         END-IF                                                   31980000
319900     ELSE                                                         31990000
320000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       32000000
320100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            32010000
320200         PERFORM 5110-WRITE-ASC-LISTQ                             32020000
320300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   32030000
320400     END-IF.                                                      32040000
320500                                                                  32050000
320600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32060000
320700*                                                                 32070000
320800*                                                                 32080000
320900******************************************************************32090000
321000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **32100000
321100** SPECIFIC COMMAREA.                                           **32110000
321200******************************************************************32120000
321300 5105-REWRITE-ASC-LISTQ.                                          32130000
321400     EXEC CICS                                                    32140000
321500         WRITEQ TS                                                32150000
321600             QUEUE (ASC-LIST-QUEUE-NAME)                          32160000
321700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32170000
321800             ITEM  (PV-BLOCK-NUMBER)                              32180000
321900             REWRITE                                              32190000
322000             RESP  (PV-CICS-RESPONSE)                             32200000
322100     END-EXEC.                                                    32210000
322200                                                                  32220000
322300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       32230000
322400         CONTINUE                                                 32240000
322500     ELSE                                                         32250000
322600         SET DP013-CICS-ABEND            TO TRUE                  32260000
322700         SET DP013-NO-ROLLBACK           TO TRUE                  32270000
322800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       32280000
322900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     32290000
323000                                         TO DP013-MESSAGE-TEXT(1) 32300000
323100         PERFORM DP013-0000-PROCESS-ABEND                         32310000
323200     END-IF.                                                      32320000
323300*                                                                 32330000
323400*                                                                 32340000
323500******************************************************************32350000
323600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **32360000
323700** SPECIFIC COMMAREA.                                           **32370000
323800******************************************************************32380000
323900 5110-WRITE-ASC-LISTQ.                                            32390000
324000     EXEC CICS                                                    32400000
324100         WRITEQ TS                                                32410000
324200             QUEUE (ASC-LIST-QUEUE-NAME)                          32420000
324300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32430000
324400             ITEM  (PV-BLOCK-NUMBER)                              32440000
324500             RESP  (PV-CICS-RESPONSE)                             32450000
324600     END-EXEC.                                                    32460000
324700     IF  PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                  32470000
324800         SET DP013-CICS-ABEND      TO TRUE                        32480000
324900         SET DP013-NO-ROLLBACK     TO TRUE                        32490000
325000         MOVE '5110-WRITE-ASC-LISTQ'                              32500000
325100                                   TO DP013-PARAGRAPH             32510000
325200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           32520000
325300                                   TO DP013-MESSAGE-TEXT(1)       32530000
325400         PERFORM DP013-0000-PROCESS-ABEND                         32540000
325500     END-IF.                                                      32550000
325600*                                                                 32560000
325700*                                                                 32570000
325800 5200-FILL-SEL-QUEUE-RECORD.                                      32580000
325900                                                                  32590000
326000     PERFORM 6112-READ-LIST-QUEUE.                                32600000
326100                                                                  32610000
326200     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   32620000
326300         PERFORM                                                  32630000
326400         VARYING LQW-IDX                                          32640000
326500         FROM 1 BY 1                                              32650000
326600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            32660000
326700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          32670000
326800                                                                  32680000
326900             IF  LQW-SELECT (LQW-IDX)                             32690000
327000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              32700000
327100                                   TO SU028-ITEM (SU028-IDX)      32710000
327200                 MOVE LQW-TBL-CARTON-ID (LQW-IDX)                 32720000
327300                                   TO SU028-CARTON (SU028-IDX)    32730000
327400                 MOVE SPACE        TO SU028-ACTION-SW (SU028-IDX) 32740000
327500                 SET SU028-IDX UP BY 1                            32750000
327600                 IF  SU028-IDX > SU028-MAX-ITEMS                  32760000
327700                     PERFORM 5205-WRITE-SEL-QUEUE                 32770000
327800                     ADD +1        TO SU027-NUMBER-OF-TS-ITEMS    32780000
327900                     INITIALIZE SU028-SELECTED-ITEM-ARRAY         32790000
328000                     SET SU028-IDX TO  1                          32800000
328100                 END-IF                                           32810000
328200             END-IF                                               32820000
328300         END-PERFORM                                              32830000
328400     END-IF.                                                      32840000
328500*                                                                 32850000
328600*----------------------------------------------------------------*32860000
328700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *32870000
328800*----------------------------------------------------------------*32880000
328900 5205-WRITE-SEL-QUEUE.                                            32890000
329000                                                                  32900000
329100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32910000
329200                                   TO SU028-SELECTED-ITEMS.       32920000
329300                                                                  32930000
329400     EXEC CICS                                                    32940000
329500          WRITEQ TS                                               32950000
329600              QUEUE (ASC-SEL-QUEUE-NAME)                          32960000
329700              FROM  (SU028-SELECT-RECORD)                         32970000
329800              ITEM  (PV-SEL-QUEUE-ITEM)                           32980000
329900              RESP  (PV-CICS-RESPONSE)                            32990000
330000     END-EXEC.                                                    33000000
330100                                                                  33010000
330200     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      33020000
330300         CONTINUE                                                 33030000
330400     ELSE                                                         33040000
330500         SET DP013-CICS-ABEND      TO TRUE                        33050000
330600         SET DP013-NO-ROLLBACK     TO TRUE                        33060000
330700         MOVE '5205-WRITE-SEL-QUEUE'                              33070000
330800                                   TO DP013-PARAGRAPH             33080000
330900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          33090000
331000                                   TO DP013-MESSAGE-TEXT(1)       33100000
331100         PERFORM DP013-0000-PROCESS-ABEND                         33110000
331200     END-IF.                                                      33120000
331300                                                                  33130000
331400 5300-FILL-SEL-QUEUE-RECORD.                                      33140000
331500                                                                  33150000
331600     PERFORM 6112-READ-LIST-QUEUE.                                33160000
331700                                                                  33170000
331800     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   33180000
331900         PERFORM                                                  33190000
332000         VARYING LQW-IDX                                          33200000
332100         FROM 1 BY 1                                              33210000
332200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            33220000
332300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          33230000
332400                                                                  33240000
332500             IF  LQW-SELECT (LQW-IDX)                             33250000
332600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              33260000
332700                                   TO SU039-ITEM (SU039-IDX)      33270000
332800                 MOVE LQW-TBL-CARTON-ID (LQW-IDX)                 33280000
332900                                TO SU039-SHIPT-UNT-ID (SU039-IDX) 33290000
333000                 MOVE SPACE        TO SU039-ACTION-SW (SU039-IDX) 33300000
333100                 SET SU039-IDX UP BY 1                            33310000
333200                 IF  SU039-IDX > SU039-MAX-ITEMS                  33320000
333300                     PERFORM 5305-WRITE-SEL-QUEUE                 33330000
333400                     ADD +1        TO SU038-NUMBER-OF-TS-ITEMS    33340000
333500                     INITIALIZE SU039-SELECTED-ITEM-ARRAY         33350000
333600                     SET SU039-IDX TO  1                          33360000
333700                 END-IF                                           33370000
333800             END-IF                                               33380000
333900         END-PERFORM                                              33390000
334000     END-IF.                                                      33400000
334100*                                                                 33410000
334200*----------------------------------------------------------------*33420000
334300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *33430000
334400*----------------------------------------------------------------*33440000
334500 5305-WRITE-SEL-QUEUE.                                            33450000
334600                                                                  33460000
334700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33470000
334800                                   TO SU039-SELECTED-ITEMS.       33480000
334900                                                                  33490000
335000     EXEC CICS                                                    33500000
335100          WRITEQ TS                                               33510000
335200              QUEUE (ASC-SEL-QUEUE-NAME)                          33520000
335300              FROM  (SU039-SELECT-RECORD)                         33530000
335400              ITEM  (PV-SEL-QUEUE-ITEM)                           33540000
335500              RESP  (PV-CICS-RESPONSE)                            33550000
335600     END-EXEC.                                                    33560000
335700                                                                  33570000
335800     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      33580000
335900         CONTINUE                                                 33590000
336000     ELSE                                                         33600000
336100         SET DP013-CICS-ABEND      TO TRUE                        33610000
336200         SET DP013-NO-ROLLBACK     TO TRUE                        33620000
336300         MOVE '5305-WRITE-SEL-QUEUE'                              33630000
336400                                   TO DP013-PARAGRAPH             33640000
336500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          33650000
336600                                   TO DP013-MESSAGE-TEXT(1)       33660000
336700         PERFORM DP013-0000-PROCESS-ABEND                         33670000
336800     END-IF.                                                      33680000
336900                                                                  33690000
337000******************************************************************33700000
337100** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **33710000
337200** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **33720000
337300** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **33730000
337400** THE USER.                                                    **33740000
337500******************************************************************33750000
337600 6000-REFRESH-PANEL-FROM-TEMP.                                    33760000
337700     IF  ASC-UPDATE-TSQ                                           33770000
337800         SET ASC-NO-TSQ-UPDATE TO TRUE                            33780000
337900         MOVE ZERO                 TO PV-SAVE-ITEM                33790000
338000                                      PV-SEL-QUEUE-ITEM           33800000
338100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        33810000
338200                                   TO PV-HOLD-SELECTED-ITEMS      33820000
338300         MOVE +1                   TO PV-ITEMS-PROCESSED          33830000
338400         PERFORM 6100-UPDATE-TSQ                                  33840000
338500             UNTIL PV-ITEMS-PROCESSED >                           33850000
338600                                     PV-HOLD-SELECTED-ITEMS       33860000
338700         PERFORM 6010-DELETE-SEL-QUEUE                            33870000
338800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         33880000
338900                    ASC-BLOCK-ENTRIES (2)                         33890000
339000     END-IF.                                                      33900000
339100*                                                                 33910000
339200*                                                                 33920000
339300*----------------------------------------------------------------*33930000
339400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *33940000
339500*----------------------------------------------------------------*33950000
339600 6010-DELETE-SEL-QUEUE.                                           33960000
339700                                                                  33970000
339800     EXEC CICS                                                    33980000
339900         DELETEQ TS                                               33990000
340000             QUEUE (ASC-SEL-QUEUE-NAME)                           34000000
340100             RESP  (PV-CICS-RESPONSE)                             34010000
340200     END-EXEC.                                                    34020000
340300                                                                  34030000
340400     IF ((PV-CICS-RESPONSE = DFHRESP(NORMAL)) OR                  34040000
340500        (PV-CICS-RESPONSE = DFHRESP(QIDERR)))                     34050000
340600         CONTINUE                                                 34060000
340700     ELSE                                                         34070000
340800         SET DP013-CICS-ABEND TO TRUE                             34080000
340900         SET DP013-NO-ROLLBACK TO TRUE                            34090000
341000         MOVE '6010-DELETE-SEL-QUEUE'                             34100000
341100                        TO DP013-PARAGRAPH                        34110000
341200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         34120000
341300                        TO DP013-MESSAGE-TEXT (1)                 34130000
341400         PERFORM DP013-0000-PROCESS-ABEND                         34140000
341500     END-IF.                                                      34150000
341600*                                                                 34160000
341700*                                                                 34170000
341800*----------------------------------------------------------------*34180000
341900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *34190000
342000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *34200000
342100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *34210000
342200*    THE TEMP QUEUE.                                             *34220000
342300*----------------------------------------------------------------*34230000
342400 6100-UPDATE-TSQ.                                                 34240000
342500                                                                  34250000
342600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             34260000
342700     PERFORM 6105-READ-SEL-QUEUE.                                 34270000
342800     PERFORM                                                      34280000
342900         VARYING SU028-IDX                                        34290000
343000         FROM 1 BY 1                                              34300000
343100         UNTIL ((PV-ITEMS-PROCESSED >                             34310000
343200                              PV-HOLD-SELECTED-ITEMS)             34320000
343300         OR (SU028-IDX GREATER THAN SU028-MAX-ITEMS))             34330000
343400         IF  SU028-ACTION-SW (SU028-IDX) > SPACE                  34340000
343500             PERFORM 6110-PROCESS-ITEMS                           34350000
343600         END-IF                                                   34360000
343700         ADD +1                TO PV-ITEMS-PROCESSED              34370000
343800     END-PERFORM.                                                 34380000
343900     PERFORM 6111-WRITE-LIST-QUEUE.                               34390000
344000*                                                                 34400000
344100*                                                                 34410000
344200*----------------------------------------------------------------*34420000
344300*    READ THE LIST QUEUE RECORD.                                 *34430000
344400*----------------------------------------------------------------*34440000
344500 6105-READ-SEL-QUEUE.                                             34450000
344600                                                                  34460000
344700     EXEC CICS                                                    34470000
344800          READQ TS                                                34480000
344900              QUEUE (ASC-SEL-QUEUE-NAME)                          34490000
345000              INTO  (SU028-SELECT-RECORD)                         34500000
345100              ITEM  (PV-SEL-QUEUE-ITEM)                           34510000
345200              RESP  (PV-CICS-RESPONSE)                            34520000
345300     END-EXEC.                                                    34530000
345400                                                                  34540000
345500     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      34550000
345600         CONTINUE                                                 34560000
345700     ELSE                                                         34570000
345800         SET DP013-CICS-ABEND      TO  TRUE                       34580000
345900         SET DP013-NO-ROLLBACK     TO  TRUE                       34590000
346000         MOVE '6105-READ-SEL-QUEUE'                               34600000
346100                                   TO  DP013-PARAGRAPH            34610000
346200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           34620000
346300                                   TO  DP013-MESSAGE-TEXT(1)      34630000
346400         PERFORM DP013-0000-PROCESS-ABEND                         34640000
346500     END-IF.                                                      34650000
346600                                                                  34660000
346700*                                                                 34670000
346800*                                                                 34680000
346900*----------------------------------------------------------------*34690000
347000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*34700000
347100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*34710000
347200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *34720000
347300*----------------------------------------------------------------*34730000
347400 6110-PROCESS-ITEMS.                                              34740000
347500                                                                  34750000
347600     COMPUTE PV-ITEM = 1 + ((SU028-ITEM (SU028-IDX) - 1)          34760000
347700                     / PC-ITEMS-PER-PANEL).                       34770000
347800                                                                  34780000
347900     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           34790000
348000         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          34800000
348100             PERFORM 6111-WRITE-LIST-QUEUE                        34810000
348200         END-IF                                                   34820000
348300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    34830000
348400                                                                  34840000
348500         PERFORM 6112-READ-LIST-QUEUE                             34850000
348600         IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)           34860000
348700             CONTINUE                                             34870000
348800         END-IF                                                   34880000
348900     END-IF.                                                      34890000
349000                                                                  34900000
349100     COMPUTE PV-SUB = (SU028-ITEM (SU028-IDX)                     34910000
349200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              34920000
349300     SET LQW-DESELECT (PV-SUB) TO    TRUE                         34930000
349400     MOVE LQW-SELECTED-SW (PV-SUB)                                34940000
349500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  34950000
349600     EVALUATE TRUE                                                34960000
349700         WHEN SU028-INQ (SU028-IDX)                               34970000
349800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             34980000
349900                                                                  34990000
350000         WHEN SU028-UPD (SU028-IDX)                               35000000
350100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             35010000
350200                                                                  35020000
350300         WHEN SU028-DEL (SU028-IDX)                               35030000
350400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             35040000
350500                                                                  35050000
350600         WHEN SU028-ERR (SU028-IDX)                               35060000
350700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             35070000
350800     END-EVALUATE.                                                35080000
350900                                                                  35090000
351000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                35100000
351100*                                                                 35110000
351200*                                                                 35120000
351300*----------------------------------------------------------------*35130000
351400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *35140000
351500*----------------------------------------------------------------*35150000
351600 6111-WRITE-LIST-QUEUE.                                           35160000
351700                                                                  35170000
351800     EXEC CICS                                                    35180000
351900         WRITEQ TS                                                35190000
352000             QUEUE (ASC-LIST-QUEUE-NAME)                          35200000
352100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     35210000
352200             ITEM  (PV-SAVE-ITEM)                                 35220000
352300             REWRITE                                              35230000
352400             RESP  (PV-CICS-RESPONSE)                             35240000
352500     END-EXEC.                                                    35250000
352600                                                                  35260000
352700     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      35270000
352800         CONTINUE                                                 35280000
352900     ELSE                                                         35290000
353000         SET DP013-CICS-ABEND  TO  TRUE                           35300000
353100         SET DP013-NO-ROLLBACK TO  TRUE                           35310000
353200         MOVE '6111-WRITE-LIST-QUEUE'                             35320000
353300                               TO  DP013-PARAGRAPH                35330000
353400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  35340000
353500                               TO  DP013-MESSAGE-TEXT(1)          35350000
353600         PERFORM DP013-0000-PROCESS-ABEND                         35360000
353700     END-IF.                                                      35370000
353800                                                                  35380000
353900                                                                  35390000
354000*                                                                 35400000
354100*                                                                 35410000
354200*----------------------------------------------------------------*35420000
354300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*35430000
354400*----------------------------------------------------------------*35440000
354500 6112-READ-LIST-QUEUE.                                            35450000
354600                                                                  35460000
354700     EXEC CICS                                                    35470000
354800         READQ TS                                                 35480000
354900             QUEUE (ASC-LIST-QUEUE-NAME)                          35490000
355000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     35500000
355100             ITEM  (PV-ITEM)                                      35510000
355200             RESP  (PV-CICS-RESPONSE)                             35520000
355300     END-EXEC.                                                    35530000
355400                                                                  35540000
355500     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      35550000
355600         CONTINUE                                                 35560000
355700     ELSE                                                         35570000
355800         SET DP013-CICS-ABEND        TO TRUE                      35580000
355900         SET DP013-NO-ROLLBACK       TO TRUE                      35590000
356000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           35600000
356100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    35610000
356200                                     TO DP013-MESSAGE-TEXT(1)     35620000
356300         PERFORM DP013-0000-PROCESS-ABEND                         35630000
356400     END-IF.                                                      35640000
356500/                                                                 35650000
356600 7000-SELECT-PO-AUD-REQ.                                          35660000
356700                                                                  35670000
356800     MOVE ASC-OPER-UNT-ID             TO DK-OPER-UNT-ID           35680000
356900     EVALUATE TRUE                                                35690000
357000     WHEN SU025-PACK-LINE (ASC-SEL-SUB) = 'PBS'                   35700000
357100     EXEC SQL                                                     35710000
357200         SELECT DISTINCT                                          35720000
357300             REQ.ENT_ID                                           35730000
357400         ,   NME.ENT_NAME_DESC                                    35740000
357500         ,   REQ.DEPT_NBR                                         35750000
357600         INTO                                                     35760000
357700             :SUT00015-ENT-ID                                     35770000
357800         ,   :ENTNME-ENT-NAME-DESC                                35780000
357900         ,   :SUT00015-DEPT-NBR                                   35790000
358000         FROM   SUT_PO_AUD_REQ REQ                                35800000
358100         ,      TENTNME        NME                                35810000
358200         WHERE                                                    35820000
358300               REQ.ENT_ID = NME.ENT_ID                            35830000
358400           AND NME.TYPE_CDE = '01'                                35840000
358500           AND REQ.PO_NBR  = INT (SUBSTR(:ASC-PO-RCVR,1,9))       35850000
358600           AND REQ.PO_LNE_NBR       = 0                           35860000
358700           AND REQ.PO_PREPK_ID      = 0                           35870000
358800           AND REQ.OPER_UNT_ID      = :DK-OPER-UNT-ID             35880000
358900     END-EXEC                                                     35890000
359000                                                                  35900000
      *SB 10/15/13 - BEGIN PR#5148D                                     35901000
           WHEN SU025-PACK-LINE (ASC-SEL-SUB) = 'RFID'                  35902000
                                                                        35902100
357100     EXEC SQL                                                     35902200
357200         SELECT DISTINCT                                          35902300
357300             REQ.ENT_ID                                           35902400
357400         ,   NME.ENT_NAME_DESC                                    35902500
357500         ,   REQ.DEPT_NBR                                         35902600
357600         INTO                                                     35902700
357700             :SUT00015-ENT-ID                                     35902800
357800         ,   :ENTNME-ENT-NAME-DESC                                35902900
357900         ,   :SUT00015-DEPT-NBR                                   35903000
358000         FROM   SUT_PO_AUD_REQ REQ                                35903100
358100         ,      TENTNME        NME                                35903200
358200         WHERE                                                    35903300
358300               REQ.ENT_ID = NME.ENT_ID                            35903400
358400           AND NME.TYPE_CDE = '01'                                35903500
358500           AND REQ.PO_NBR  = INT (SUBSTR(:ASC-PO-RCVR,1,9))       35903600
358600           AND REQ.PO_LNE_NBR       = 0                           35903700
358700           AND REQ.PO_PREPK_ID      = -9999                       35903800
358800           AND REQ.OPER_UNT_ID      = :DK-OPER-UNT-ID             35903900
358900     END-EXEC                                                     35904000
      *SB 10/15/13 - END PR#5148D                                       35905000
359100                                                                  35910000
359200     WHEN SU025-PACK-LINE(ASC-SEL-SUB)(1:2) = 'P-'                35920000
359300                                                                  35930000
359400     EXEC SQL                                                     35940000
359500         SELECT DISTINCT                                          35950000
359600             REQ.ENT_ID                                           35960000
359700         ,   NME.ENT_NAME_DESC                                    35970000
359800         ,   REQ.DEPT_NBR                                         35980000
359900         INTO                                                     35990000
360000             :SUT00015-ENT-ID                                     36000000
360100         ,   :ENTNME-ENT-NAME-DESC                                36010000
360200         ,   :SUT00015-DEPT-NBR                                   36020000
360300         FROM   SUT_PO_AUD_REQ REQ                                36030000
360400         ,      TENTNME        NME                                36040000
360500         WHERE                                                    36050000
360600               REQ.ENT_ID = NME.ENT_ID                            36060000
360700           AND NME.TYPE_CDE = '01'                                36070000
360800           AND REQ.PO_NBR = INT (SUBSTR(:ASC-PO-RCVR,1,9) )       36080000
360900           AND REQ.PO_LNE_NBR       = 0                           36090000
361000           AND REQ.PO_PREPK_ID      =  SMALLINT(:DK-PACK-LINE)    36100000
361100           AND REQ.OPER_UNT_ID      = :DK-OPER-UNT-ID             36110000
361200     END-EXEC                                                     36120000
361300                                                                  36130000
361400     WHEN SU025-PACK-LINE(ASC-SEL-SUB)(1:2) = 'L-'                36140000
361500                                                                  36150000
361600     EXEC SQL                                                     36160000
361700         SELECT DISTINCT                                          36170000
361800             REQ.ENT_ID                                           36180000
361900         ,   NME.ENT_NAME_DESC                                    36190000
362000         ,   REQ.DEPT_NBR                                         36200000
362100         INTO                                                     36210000
362200             :SUT00015-ENT-ID                                     36220000
362300         ,   :ENTNME-ENT-NAME-DESC                                36230000
362400         ,   :SUT00015-DEPT-NBR                                   36240000
362500         FROM   SUT_PO_AUD_REQ REQ                                36250000
362600         ,      TENTNME        NME                                36260000
362700         WHERE                                                    36270000
362800               REQ.ENT_ID = NME.ENT_ID                            36280000
362900           AND NME.TYPE_CDE = '01'                                36290000
363000           AND REQ.PO_NBR = INT (SUBSTR(:ASC-PO-RCVR,1,9))        36300000
363100           AND REQ.PO_LNE_NBR       = INT(:DK-PACK-LINE)          36310000
363200           AND REQ.PO_PREPK_ID      =  0                          36320000
363300           AND REQ.OPER_UNT_ID      = :DK-OPER-UNT-ID             36330000
363400     END-EXEC                                                     36340000
363500     END-EVALUATE.                                                36350000
363600                                                                  36360000
363700     EVALUATE TRUE                                                36370000
363800         WHEN SQLCODE = ZERO                                      36380000
363900             MOVE SUT00015-ENT-ID     TO ASC-ENT-ID-N             36390000
364000             MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-NAME         36400000
364100         ,   MOVE SUT00015-DEPT-NBR   TO ASC-DEPT-NBR-N           36410000
364200         WHEN SQLCODE = +100                                      36420000
364300             CONTINUE                                             36430000
364400         WHEN SQLWARN0 NOT = SPACES                               36440000
364500         WHEN SQLCODE < +0                                        36450000
364600         WHEN SQLCODE > ZERO                                      36460000
364700             MOVE '7000-SELECT-PO-AUD-REQ'                        36470000
364800                             TO DP013-PARAGRAPH                   36480000
364900             MOVE 'SELECT AUDIT QTY'                              36490000
365000                             TO DP013-MESSAGE-TEXT (1)            36500000
365100             MOVE SQLCA      TO DP013-SQLCA                       36510000
365200             MOVE 'SUT_PO_AUD_REQ'                                36520000
365300                             TO DP013-DB2-TABLE-NAME (1)          36530000
365400             MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (2)          36540000
365500             SET DP013-DB2-ABEND                                  36550000
365600                             TO TRUE                              36560000
365700             SET DP013-XCTL-DISPLAY-RESTART                       36570000
365800                             TO TRUE                              36580000
365900             PERFORM DP013-0000-PROCESS-ABEND                     36590000
366000     END-EVALUATE.                                                36600000
366100                                                                  36610000
366200 7050-DEPT-DESC.                                                  36620000
366300                                                                  36630000
366400     MOVE ASC-DEPT-NBR(2:3)           TO DK-DEPT                  36640000
366500     EXEC SQL                                                     36650000
366600         SELECT                                                   36660000
366700                EAR.MDSEAR_DESC                                   36670000
366800          INTO                                                    36680000
366900                :MDSEAR-DESC                                      36690000
367000          FROM                                                    36700000
367100                TMDSEAR EAR                                       36710000
367200          WHERE                                                   36720000
367300             EAR.DEPT_NBR       = :DK-DEPT                        36730000
367400         AND EAR.MDSELV_CDE     = 'DPT'                           36740000
367500         AND EAR.OPERCO_NBR     = '03'                            36750000
367600         AND (EAR.STRT_DTE     <= CURRENT DATE AND                36760000
367700              EAR.END_DTE       > CURRENT DATE)                   36770000
367800     END-EXEC.                                                    36780000
367900                                                                  36790000
368000                                                                  36800000
368100     EVALUATE TRUE                                                36810000
368200         WHEN SQLCODE = ZERO                                      36820000
368300             MOVE MDSEAR-DESC         TO ASC-DEPARTMENT-DESC      36830000
368400         WHEN SQLCODE = +100                                      36840000
368500             CONTINUE                                             36850000
368600         WHEN SQLWARN0 NOT = SPACES                               36860000
368700         WHEN SQLCODE < +0                                        36870000
368800         WHEN SQLCODE > ZERO                                      36880000
368900             MOVE '7050-DEPT-DESC'                                36890000
369000                             TO DP013-PARAGRAPH                   36900000
369100             MOVE 'SELECT DEPT DESC'                              36910000
369200                             TO DP013-MESSAGE-TEXT (1)            36920000
369300             MOVE SQLCA      TO DP013-SQLCA                       36930000
369400             MOVE 'TMDSEAR'  TO DP013-DB2-TABLE-NAME (1)          36940000
369500             SET DP013-DB2-ABEND                                  36950000
369600                             TO TRUE                              36960000
369700             SET DP013-XCTL-DISPLAY-RESTART                       36970000
369800                             TO TRUE                              36980000
369900             PERFORM DP013-0000-PROCESS-ABEND                     36990000
370000     END-EVALUATE.                                                37000000
370100                                                                  37010000
370200                                                                  37020000
370300                                                                  37030000
370400 7100-SELECT-AUDIT-TYPE.                                          37040000
370500     MOVE ASC-AUDIT-NBR    TO DK-AUDIT-NBR.                       37050000
370600                                                                  37060000
370700     EXEC SQL                                                     37070000
370800          SELECT                                                  37080000
370900                CASE                                              37090000
371000                   AUD_TYP_CDE                                    37100000
371100                WHEN '01' THEN '100%  '                           37110000
371200                WHEN '02' THEN 'SPOT  '                           37120000
371300                WHEN '03' THEN 'REWORK'                           37130000
371400                END                                               37140000
371500          INTO                                                    37150000
371600                :PV-AUDIT-TYPE                                    37160000
371700          FROM                                                    37170000
371800                TSUNAUD                                           37180000
371900          WHERE AUD_CNTL_NBR    = :DK-AUDIT-NBR                   37190000
372000     END-EXEC                                                     37200000
372100                                                                  37210000
372200                                                                  37220000
372300     EVALUATE TRUE                                                37230000
372400         WHEN SQLCODE = ZERO                                      37240000
372500             CONTINUE                                             37250000
372600                                                                  37260000
372700         WHEN SQLWARN0 NOT = SPACES                               37270000
372800         WHEN SQLCODE < +0                                        37280000
372900         WHEN SQLCODE > ZERO                                      37290000
373000             MOVE '7100-SELECT-AUDIT-TYPE'                        37300000
373100                             TO DP013-PARAGRAPH                   37310000
373200             MOVE 'SELECT AUDIT INFO'                             37320000
373300                             TO DP013-MESSAGE-TEXT (1)            37330000
373400             MOVE SQLCA      TO DP013-SQLCA                       37340000
373500             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME (1)          37350000
373600             MOVE 'TSUNAUD'  TO DP013-DB2-TABLE-NAME (2)          37360000
373700             SET DP013-DB2-ABEND                                  37370000
373800                             TO TRUE                              37380000
373900             SET DP013-XCTL-DISPLAY-RESTART                       37390000
374000                             TO TRUE                              37400000
374100             PERFORM DP013-0000-PROCESS-ABEND                     37410000
374200     END-EVALUATE.                                                37420000
374300                                                                  37430000
      *SB 12/20/13 - BEGIN PR#5148D                                     37431000
       8000-CHECK-PO-EXCEPTION.                                         37432000
                                                                        37432100
           INITIALIZE DCLSUT00014.                                      37432200
           MOVE ASC-PO-NBR      TO SUT00014-PO-NBR                      37432300
           MOVE ASC-OPER-UNT-ID TO SUT00014-OPER-UNT-ID                 37432500
                                                                        37432600
           EXEC SQL                                                     37432700
               SELECT DISTINCT                                          37432899
                      AUD_TYP_CDE                                       37432999
               INTO   :SUT00014-AUD-TYP-CDE                             37433100
               FROM  SUT_PO_AUD_EXC                                     37433400
               WHERE PO_NBR      = :SUT00014-PO-NBR                     37433500
               AND   OPER_UNT_ID = :SUT00014-OPER-UNT-ID                37433600
           END-EXEC.                                                    37433700
                                                                        37433800
372300     EVALUATE SQLCODE                                             37433900
372400         WHEN 0                                                   37434000
                   SET ASC-PO-EXCEPTION    TO TRUE                      37434400
372400         WHEN 100                                                 37434800
372500             SET ASC-NO-PO-EXCEPTION TO TRUE                      37434900
372700         WHEN OTHER                                               37435100
373000             MOVE '8000-CHECK-PO-EXCEPTION'                       37435400
373100                             TO DP013-PARAGRAPH                   37435500
373200             MOVE 'SELECT AUDIT EXCEPTION'                        37435600
373300                             TO DP013-MESSAGE-TEXT (1)            37435700
373400             MOVE SQLCA      TO DP013-SQLCA                       37435800
373500             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME (1)          37435900
373600             MOVE 'SUT_PO_AUD_EXC' TO DP013-DB2-TABLE-NAME (2)    37436000
373700             SET DP013-DB2-ABEND                                  37436100
373800                             TO TRUE                              37436200
373900             SET DP013-XCTL-DISPLAY-RESTART                       37436300
374000                             TO TRUE                              37436400
374100             PERFORM DP013-0000-PROCESS-ABEND                     37436500
374200     END-EVALUATE.                                                37436600
                                                                        37436700
       8100-CHECK-VENDOR-TAGGING.                                       37436800
                                                                        37436900
           INITIALIZE DCLTPURCHS                                        37437000
                      DCLTVNDAGR.                                       37437100
                                                                        37437200
           MOVE ASC-PO-NBR      TO PURCHS-PO-NBR                        37437300
                                                                        37437400
           EXEC SQL                                                     37437500
               SELECT DEPT_NBR                                          37437600
                     ,ENT_ID                                            37437700
               INTO   :PURCHS-DEPT-NBR                                  37437800
                     ,:PURCHS-ENT-ID                                    37437900
               FROM TPURCHS                                             37438000
               WHERE PO_NBR = :PURCHS-PO-NBR                            37438100
               AND   VER_STATUS_CDE = 'A'                               37438200
           END-EXEC.                                                    37438300
                                                                        37438400
           EVALUATE SQLCODE                                             37438500
              WHEN 0                                                    37438600
                   MOVE PURCHS-DEPT-NBR TO VNDAGR-DEPT-NBR              37438700
                   MOVE PURCHS-ENT-ID   TO VNDAGR-ENT-ID                37438800
                   EXEC SQL                                             37438900
                        SELECT TYP_CDE                                  37439000
                        INTO :VNDAGR-TYP-CDE                            37439100
                        FROM TVNDAGR                                    37439200
                        WHERE ENT_ID        = :VNDAGR-ENT-ID            37439300
                        AND DEPT_NBR        = :VNDAGR-DEPT-NBR          37439400
                        AND AGRMT_TYP_ID    = '4'                       37439500
                        AND TYP_CDE         = 11                        37439600
                        AND EFFECTIVE_DATE <= CURRENT DATE              37439700
                        AND EXPIRATION_DATE > CURRENT DATE              37439800
                        ORDER BY TYP_CDE                                37439900
                        FETCH FIRST 1 ROW ONLY                          37440000
                   END-EXEC                                             37440200
                                                                        37440300
                   EVALUATE SQLCODE                                     37440400
                      WHEN 0                                            37440500
                           SET ASC-VENDOR-TAGGING     TO TRUE           37440600
                      WHEN 100                                          37440700
                           SET ASC-VENDOR-NOT-TAGGING TO TRUE           37440800
                      WHEN OTHER                                        37440900
373000                     MOVE '8100-CHECK-VENDOR-TAGGING'             37441000
373100                                  TO DP013-PARAGRAPH              37441100
373200                     MOVE 'SELECT VENDOR AGREEMENT'               37441200
373300                                  TO DP013-MESSAGE-TEXT (1)       37441300
373400                     MOVE SQLCA      TO DP013-SQLCA               37441400
373500                     MOVE 'TVNDAGR' TO DP013-DB2-TABLE-NAME (1)   37441500
373700                     SET DP013-DB2-ABEND                          37441600
373800                                     TO TRUE                      37441700
373900                     SET DP013-XCTL-DISPLAY-RESTART               37441800
374000                                     TO TRUE                      37441900
374100                     PERFORM DP013-0000-PROCESS-ABEND             37442000
                   END-EVALUATE                                         37442100
                                                                        37442200
              WHEN 100                                                  37442300
                   SET ASC-VENDOR-NOT-TAGGING TO TRUE                   37442400
              WHEN OTHER                                                37442500
373000             MOVE '8100-CHECK-VENDOR-TAGGING'                     37442600
373100                             TO DP013-PARAGRAPH                   37442700
373200             MOVE 'SELECT VENDOR AND DEPT'                        37442800
373300                             TO DP013-MESSAGE-TEXT (1)            37442900
373400             MOVE SQLCA      TO DP013-SQLCA                       37443000
373500             MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)           37443100
373700             SET DP013-DB2-ABEND                                  37443200
373800                             TO TRUE                              37443300
373900             SET DP013-XCTL-DISPLAY-RESTART                       37443400
374000                             TO TRUE                              37443500
374100             PERFORM DP013-0000-PROCESS-ABEND                     37443600
           END-EVALUATE.                                                37443700
                                                                        37443800
      *SB 12/20/13 - END   PR#5148D                                     37443900
374400                                                                  37444000
      *SB 04/28/14 - BEGIN PR#5148D                                     37444100
       8200-CHECK-DEPT-TAGGING.                                         37445000
                                                                        37445100
           MOVE PURCHS-DEPT-NBR TO RIT00000-DEPT-NBR                    37445200
                                                                        37445300
122000     EXEC SQL                                                     37445400
122100          SELECT  'Y'                                             37445500
122100          INTO   :ASC-DEPT-TAGGING-SW                             37445600
122200          FROM RIT_RFID_VRFN A                                    37445700
122200          WHERE RFID_LVL_CDE = 'STRDPT'                           37445800
122500            AND DEPT_NBR     = :RIT00000-DEPT-NBR                 37445900
                  AND (CURRENT TIMESTAMP BETWEEN EFF_STRT_TMST          37446000
                      AND EFF_END_TMST)                                 37446100
                FETCH FIRST ROW ONLY                                    37446200
122600     END-EXEC                                                     37446300
122700                                                                  37446400
122800     EVALUATE TRUE                                                37446500
122900         WHEN SQLCODE = +0                                        37446600
122900         WHEN SQLCODE = -811                                      37446700
123200             SET ASC-DEPT-TAGGING TO TRUE                         37446800
123100         WHEN SQLCODE = +100                                      37446900
123200             SET ASC-DEPT-NOT-TAGGING TO TRUE                     37447000
123700         WHEN OTHER                                               37447100
373000             MOVE '8200-CHECK-DEPT-TAGGING'                       37447200
373100                             TO DP013-PARAGRAPH                   37447300
373200             MOVE 'SELECT DEPT '                                  37447400
373300                             TO DP013-MESSAGE-TEXT (1)            37447500
373400             MOVE SQLCA      TO DP013-SQLCA                       37447600
373500             MOVE 'RIT_RFID_VRFN' TO DP013-DB2-TABLE-NAME (1)     37447700
373700             SET DP013-DB2-ABEND                                  37447800
373800                             TO TRUE                              37447900
373900             SET DP013-XCTL-DISPLAY-RESTART                       37448000
374000                             TO TRUE                              37448100
374100             PERFORM DP013-0000-PROCESS-ABEND                     37449000
125600     END-EVALUATE.                                                37449900
      *SB 04/28/14 - END PR#5148D                                       37450000
374500*                                                                 37451000
374600*                                                                 37460000
374700*----------------------------------------------------------------*37470000
374800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37480000
374900*----------------------------------------------------------------*37490000
375000 9100-READ-SEL-QUEUE.                                             37500000
375100     EXEC CICS                                                    37510000
375200         READQ TS                                                 37520000
375300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        37530000
375400             INTO  (SU025-SELECT-RECORD)                          37540000
375500             ITEM  (ASC-SEL-ITEM)                                 37550000
375600             RESP  (PV-CICS-RESPONSE)                             37560000
375700     END-EXEC.                                                    37570000
375800                                                                  37580000
375900     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   37590000
376000         CONTINUE                                                 37600000
376100     ELSE                                                         37610000
376200         SET DP013-LOGIC-ABEND                                    37620000
376300             DP013-NO-ROLLBACK     TO TRUE                        37630000
376400         MOVE '9100-READ-SEL-QUEUE'                               37640000
376500                                   TO DP013-PARAGRAPH             37650000
376600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   37660000
376700                                   TO DP013-MESSAGE-TEXT (1)      37670000
376800         PERFORM DP013-0000-PROCESS-ABEND                         37680000
376900     END-IF.                                                      37690000
377000*                                                                 37700000
377100*                                                                 37710000
377200*----------------------------------------------------------------*37720000
377300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37730000
377400*----------------------------------------------------------------*37740000
377500 9200-REWRITE-SEL-QUEUE.                                          37750000
377600     EXEC CICS                                                    37760000
377700          WRITEQ TS                                               37770000
377800              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      37780000
377900              FROM   (SU025-SELECT-RECORD)                        37790000
378000              ITEM   (ASC-SEL-ITEM)                               37800000
378100              RESP   (PV-CICS-RESPONSE)                           37810000
378200              REWRITE                                             37820000
378300     END-EXEC.                                                    37830000
378400                                                                  37840000
378500     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               37850000
378600         SET DP013-CICS-ABEND                                     37860000
378700             DP013-NO-ROLLBACK     TO TRUE                        37870000
378800         MOVE '9200-REWRITE-SEL-QUEUE'                            37880000
378900                                   TO DP013-PARAGRAPH             37890000
379000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   37900000
379100                                   TO DP013-MESSAGE-TEXT (1)      37910000
379200         PERFORM DP013-0000-PROCESS-ABEND                         37920000
379300     END-IF.                                                      37930000
379400                                                                  37940000
379500*-----------------------------------------------------------------37950000
379600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37960000
379700*-----------------------------------------------------------------37970000
379800 9300-READ-SEL-QUEUE-2.                                           37980000
379900                                                                  37990000
380000     EXEC CICS                                                    38000000
380100         READQ TS                                                 38010000
380200             QUEUE (ASC-SEL-QUEUE-NAME-IN-2)                      38020000
380300             INTO  (SU025-SELECT-RECORD)                          38030000
380400             ITEM  (ASC-SEL-ITEM)                                 38040000
380500             RESP  (PV-CICS-RESPONSE)                             38050000
380600     END-EXEC.                                                    38060000
380700     IF PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                    38070000
380800         CONTINUE                                                 38080000
380900     ELSE                                                         38090000
381000         SET DP013-LOGIC-ABEND                                    38100000
381100             DP013-NO-ROLLBACK   TO   TRUE                        38110000
381200         MOVE '9300-READ-SEL-QUEUE-2' TO   DP013-PARAGRAPH        38120000
381300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   38130000
381400                                 TO   DP013-MESSAGE-TEXT (1)      38140000
381500         PERFORM DP013-0000-PROCESS-ABEND                         38150000
381600     END-IF.                                                      38160000
381700                                                                  38170000
381800*-----------------------------------------------------------------38180000
381900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *38190000
382000*-----------------------------------------------------------------38200000
382100 9400-REWRITE-SEL-QUEUE-2.                                        38210000
382200                                                                  38220000
382300     EXEC CICS                                                    38230000
382400          WRITEQ TS                                               38240000
382500              QUEUE  (ASC-SEL-QUEUE-NAME-IN-2)                    38250000
382600              FROM   (SU025-SELECT-RECORD)                        38260000
382700              ITEM   (ASC-SEL-ITEM)                               38270000
382800              RESP   (PV-CICS-RESPONSE)                           38280000
382900              REWRITE                                             38290000
383000     END-EXEC.                                                    38300000
383100                                                                  38310000
383200     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               38320000
383300         SET DP013-CICS-ABEND                                     38330000
383400             DP013-NO-ROLLBACK     TO TRUE                        38340000
383500         MOVE '9400-REWRITE-SEL-QUEUE-2'                          38350000
383600                                   TO DP013-PARAGRAPH             38360000
383700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   38370000
383800                                   TO DP013-MESSAGE-TEXT (1)      38380000
383900         PERFORM DP013-0000-PROCESS-ABEND                         38390000
384000     END-IF.                                                      38400000
384100                                                                  38410000
384200*----------------------------------------------------------------*38420000
384300*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *38430000
384400*    AND THE ERROR SWITCHES.                                     *38440000
384500*----------------------------------------------------------------*38450000
384600 9900-SOFT-ABORT.                                                 38460000
384700     SET PS-ERROR         TO TRUE.                                38470000
384800     SET DP020-MSG-FATAL  TO TRUE.                                38480000
384900     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    38490000
385000     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       38500000
385100     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          38510000
385200     PERFORM 0001-CALL-CICS-ARCH-API.                             38520000
385300                                                                  38530000
385400******************************************************************38540000
385500 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  38550000
385600                                                                  38560000
385700     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           38570000
385800     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          38580000
385900     INITIALIZE DP013-SRC-TASK-NUMBER                             38590000
386000                DP013-STACK.                                      38600000
386100     SET DP013-LINK-RETURN            TO TRUE.                    38610000
386200                                                                  38620000
386300     EXEC CICS                                                    38630000
386400         LINK                                                     38640000
386500             PROGRAM   (DP013-NAME)                               38650000
386600             COMMAREA  (DP013-PARAMETERS)                         38660000
386700             LENGTH    (DP013-LENGTH)                             38670000
386800     END-EXEC.                                                    38680000
386900/                                                                 38690000
387000*----------------------------------------------------------------*38700000
387100*    ABEND PROCESSOR MODULE                                      *38710000
387200*----------------------------------------------------------------*38720000
387300                                                                  38730000
387400     COPY DPPD013.                                                38740000
