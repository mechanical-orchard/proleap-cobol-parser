000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00040000
000500* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00050000
000600* PROGRAM IS USING "EZASOKET".                                   *00060000
000700******************************************************************00070000
000800                                                                  00080000
000900 PROGRAM-ID.             PCKCS728.                                00090000
001000 AUTHOR.                 GERMAN BANDA.                            00100000
001100 INSTALLATION.           KOHLS.                                   00110000
001200 DATE-WRITTEN            MAY, 2000.                               00120000
001300 DATE-COMPILED.                                                   00130000
001400                                                                  00140000
001500******************************************************************00150000
001600* THIS PROGRAM WILL PROCESS THE SMOOTHING FUNCTIONS. THIS INCLUDES00160000
001700* ALLOCATING UNITS TO CARTONS FOR PACK BY STORE RECEIVERS.        00170000
001800* THE PROGRAM WILL HANDLE INTIAL SMOOTHING, ADDING AND DELETING   00180000
001810* CARTONS WHICH INVOLVES RESMOOTHING, AS WELL AS PRINTING AND     00181000
001820* REPRINTING LABELS FOR THE STORES.                               00182000
001410* 06/06/2013  SHOBHIT BAIJAL           TKID: TKMALR7             *00182100
001411*             MODIFIED FOR THE RFID PROJECT #5148B. THIS CHANGE  *00182200
001412*             IS TO NOT PRINT RFID LABELS IF EITHER THE VENDOR   *00182300
001413*             IS RFID COMPLIANT OR THE DEPT WITHIN THE DC DOES   *00182400
001413*             NOT DO TAGGING.                                    *00182500
001414*             CHANGES TAGGED AS SB 06/06/13 PR5148B              *00182600
001410* 07/26/2013  CHERI PARMLEY            TKID: TKMAF76             *00182700
001411*             MODIFY TO GET RFID TO PRINT ON LABEL WHEN NON AUTO *00182800
001412*             CONVEYOR DC.                                       *00182900
001414*             CHANGES TAGGED AS SB 06/06/13 PR5148B              *00183200
000121******************************************************************00183302
000116* 06/24/2015  Cheri Parmley           CHG                        *00183402
000117*             RETIRING THE MDSE_PGM_ID TABLE AND REPLACING IT    *00183502
000118*             WITH XLT_BRND FOR BRAND DESCRTIPTION               *00183602
000121******************************************************************00183702
001830******************************************************************00183800
001840                                                                  00183900
001850******************************************************************00184000
001860 ENVIRONMENT DIVISION.                                            00184100
001870******************************************************************00184200
001880                                                                  00185000
001890******************************************************************00186000
001900 DATA DIVISION.                                                   00187000
002000******************************************************************00188000
002100                                                                  00189000
002200******************************************************************00190000
002300 WORKING-STORAGE SECTION.                                         00200000
002400******************************************************************00210000
002500*                                                                 00220000
002600     COPY DPWS020.                                                00230000
002700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00240000
002800                                                                  00250000
002900*---------------------------------------------------------------* 00260000
003000* INTER-APPLICATION COMMAREA.                                     00270000
003100*   PCWS204 - IS THE INPUT LAYOUT FOR PASSING INFORMATION FROM  * 00280000
003200*             THE LIST SCREENS THAT DOES NOT CHANGE FOR A         00290000
003300*             GIVEN RECEIVER                                      00300000
003310*   PCWS206 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM      * 00310000
003311*             THE PBS-SMOOTHING STORE LIST OR CARTON LIST THAT    00320000
003312*             BUILDS A QUEUE TO REPRINT LABELS.                   00330000
003313*---------------------------------------------------------------* 00331000
003314                                                                  00331100
003315         10  INTER-APPL-COMM-AREA       PIC X(200).               00331200
003316     COPY PCWS204.                                                00331300
003317                                                                  00331400
003318*----------------------------------------------------------------*00331500
003319*  DB2 KEYS                                                      *00331600
003320*----------------------------------------------------------------*00331700
003330 01  DK-DB2-KEYS.                                                 00331800
003340     05  DK-OPER-UNT-ID                  PIC  S9(04)  COMP.       00331900
003350     05  DK-LPMS-TRANS-ID                PIC  S9(09)  COMP.       00332000
003360     05  DK-BARCODE-NBR                  PIC  S9(18)V COMP-3.     00333000
003370     05  DK-PO-NBR                       PIC  S9(09)  COMP.       00334000
003380     05  DK-REC-SEQ-NBR                  PIC  S9(09)  COMP.       00335000
003390     05  DK-STR-NBR                      PIC  S9(04)  COMP.       00336000
003400     05  DK-STORE                        PIC  S9(04)  COMP.       00337000
003500     05  DK-SMTHG-PRC-IND                PIC  S9(09)  COMP.       00338000
003600     05  DK-PO-LNE-NBR                   PIC  S9(09)  COMP.       00339000
003700*----------------------------------------------------------------*00340000
003800*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *00350000
003900*----------------------------------------------------------------*00360000
004000     COPY DPWS081.                                                00370000
004100*----------------------------------------------------------------*00380000
004200*----------------------------------------------------------------*00390000
004300                                                                  00400000
004400     COPY PCWS206.                                                00410000
004500                                                                  00420000
004600*----------------------------------------------------------------*00430000
004700*                                                                *00440000
004800*----------------------------------------------------------------*00450000
004900 01  CONNECT-ERR.                                                 00460000
005000     05  FILLER                       PIC X(12)                   00470000
005100         VALUE ' PCKCS728 - '.                                    00480000
005200     05  FILLER                       PIC X(24)                   00490000
005300         VALUE 'CONNECT-SOCKET FAILED   '.                        00500000
005400     05  FILLER                       PIC X(9)                    00510000
005500         VALUE ' ERRNO = '.                                       00520000
005600     05  CONNECT-ERRNO                PIC 9(8).                   00530000
005700                                                                  00540000
005800                                                                  00550000
005900*----------------------------------------------------------------*00560000
006000*                                                                *00570000
006100*----------------------------------------------------------------*00580000
006200 01  RECEIVE-ERR.                                                 00590000
006300     05  FILLER                       PIC X(10)                   00600000
006400         VALUE ' PCKCS728-'.                                      00610000
006500     05  FILLER                       PIC X(17)                   00620000
006600         VALUE 'RCV CNFRM FAILED '.                               00630000
006700     05  FILLER                       PIC X(7)                    00640000
006800         VALUE ' ERRNO='.                                         00650000
006900     05  RECEIVE-RETCODE              PIC 9(10)-.                 00660000
007000     05  FILLER                       PIC X(2) VALUE SPACES.      00670000
007100     05  RECEIVE-ERRNO                PIC 9(8).                   00680000
007200     05  FILLER                       PIC X(2) VALUE SPACES.      00690000
007300     05  RECEIVE-RECEIVER             PIC 9(8).                   00700000
007400     05  FILLER                       PIC X(1) VALUE '-'.         00710000
007500     05  RECEIVE-SEQ                  PIC 9(3).                   00720000
007600     05  FILLER                       PIC X(1) VALUE '-'.         00730000
007700     05  RECEIVE-STORE                PIC 9(4).                   00740000
007800                                                                  00750000
007900                                                                  00760000
008000 01  TCP-BUF2.                                                    00770000
008100     05 TCP-BUF                          PIC  X(50)  VALUE SPACE. 00780000
008200     05 TCP-BUF-DATA                     PIC X(254)  VALUE SPACE. 00790000
008300                                                                  00800000
008400                                                                  00810000
008500*----------------------------------------------------------------*00820000
008600*  PROGRAM CONSTANTS                                             *00830000
008700*----------------------------------------------------------------*00840000
008800 01  PC-PROGRAM-CONSTANTS.                                        00850000
008900     05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         00860000
009000                                                       COMP SYNC. 00870000
009100     05  PV-READ-LENGTH               PIC S9(04) VALUE ZERO       00880000
009200                                                 COMP SYNC.       00890000
009300     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      00900000
009400                                                 COMP.            00910000
009500     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         00920000
009600                                                 COMP SYNC.       00930000
009700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'PCKCS728'.00940000
009800     05  PC-MANIFEST-NBR-MODULE      PIC  X(08)  VALUE 'PCKCS721'.00950000
009810     05  PC-DPKUT038                 PIC  X(08)  VALUE 'DPKUT038'.00960000
009820     05  PC-PRTR-VALIDATION-PGM      PIC  X(08)  VALUE 'DPKCS060'.00970000
009830     05  PC-REPORT-PGM-1             PIC  X(08)  VALUE 'PCKCS126'.00980000
009840     05  PC-RANDOM-PGM               PIC  X(08)  VALUE 'DPKUT902'.00981000
009850*                                                                 00982000
009860     05  PV-SQL-RETURN-CD             PIC 999-.                   00983000
009870                                                                  00984000
009871* BBR WR41309 - RFID PROCESSING                                   00985000
009872     05  PV-RFID-STORE.                                           00986000
009873         10 PV-RFID-STORE-TXT-4       PIC X(12) VALUE             00987000
009874                                       '***@RFID@***'.            00988000
009875* BBR WR41309 - END                                               00989000
009880     05  PV-FIRST-STORE-RCPT.                                     00990000
009890         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             00990100
009900                                       '@@@@NEW@@@@@'.            00990200
009910         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             00990300
009920                                       '@@@@@TO@@@@@'.            00990400
009930         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             00990500
009940                                       '@@@STORE@@@@'.            00990600
009950                                                                  00990700
009960     05  PC-SMOOTHING-LBL-APPL       PIC  X(03)  VALUE 'SMO'.     00990800
009970     05  PC-SOCKET-INTERFACE         PIC  X(01)  VALUE 'S'.       00990900
009980                                                                  00991000
009990     05  PC-A                        PIC  X(01)  VALUE 'A'.       00992000
010000     05  PC-MGMX                     PIC  X(04)  VALUE 'MGMX'.    00993000
010100     05  PC-N                        PIC  X(01)  VALUE 'N'.       00994000
010200     05  PC-R                        PIC  X(01)  VALUE 'R'.       00995000
010300     05  PC-T                        PIC  X(01)  VALUE 'T'.       00996000
010400     05  PC-Y                        PIC  X(01)  VALUE 'Y'.       00997000
010500     05  PC-01                       PIC  X(02)  VALUE '01'.      00998000
010600     05  PC-OF                       PIC  X(04)  VALUE ' OF '.    00999000
010700     05  PC-90                       PIC  9(02)  VALUE  90.       01000000
010800                                                                  01010000
010900 01  PC-LABEL-TYPE.                                               01020000
011000     05  PC-SMO                      PIC  X(03)  VALUE 'SMO'.     01030000
011100                                                                  01040000
011200     COPY SUWS001.                                                01050000
011300     COPY PCWS180.                                                01060000
011400     COPY PCWS187.                                                01070000
011500******************************************************************01080000
011600** copybook used for called module xlkut073 used to return      **01090000
011700** merchandise department **                                      01100000
011800******************************************************************01110000
011801     COPY XLWS073.                                                01120000
011802*----------------------------------------------------------------*01130000
011803*  COPYBOOK FOR CALLED ITEM MODULE                                01140000
011804*----------------------------------------------------------------*01150000
011805     COPY XLWS001.                                                01160000
011806*----------------------------------------------------------------*01170000
011807*  COPYBOOK FOR CALLED MODULE TO RETURN SEASONAL SET AND DIVERT   01180000
011808*  CODE                                                           01180100
011809*----------------------------------------------------------------*01180200
011810     COPY PCWS240.                                                01180300
011811*----------------------------------------------------------------*01180400
011812*  COPYBOOK FOR CALLED MODULE TO RETURN THE STORE BALANCE ON HAND 01180500
011813*----------------------------------------------------------------*01180600
011814     COPY XLWS088.                                                01180700
011814* BBR WR41309 - ADD COPYBOOK FOR CALL TO SUKUT149                 01180800
011814*---------------------------------------------------------------* 01180900
011814*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   01181000
011814*---------------------------------------------------------------* 01181100
011814     COPY SUWS093.                                                01181200
011814* BBR WR41309 - END                                               01181300
011815/                                                                 01181400
011816                                                                  01181500
011817 01  PV-SAVE-FIELDS.                                              01181600
011818                                                                  01181700
011819     05  PV-LINE-UNIT-QTY            PIC S9(9) COMP.              01181800
011820     05  PV-CARTON-NBR               PIC S9(9) COMP.              01181900
011830     05  PV-SAVE-CARTON-NBR          PIC S9(9) COMP.              01182000
011840     05  PV-SAVE-STORE               PIC S9(9) COMP.              01183000
011850     05  PV-TOTAL-UNITS-ALLOCATED    PIC S9(9) COMP.              01184000
011860     05  PV-UNITS-PER-CARTON         PIC S9(9) COMP.              01185000
011870     05  PV-MAX-CTN-NBR              PIC S9(9) COMP.              01186000
011880     05  PV-TOT-CRTNS-FOR-STORE      PIC S9(04)  VALUE +0         01187000
011890                                                    COMP.         01188000
011900     05  PV-TOT-LABELS-ADD           PIC S9(04) COMP.             01189000
012000     05  PV-TOT-INSERTS-BY-STORE     PIC S9(04) COMP.             01190000
012100     05  PV-TOT-INSERTS-BY-STR-D     PIC 9(04).                   01200000
012200     05  PV-TOT-INSERTS-BY-LINE      PIC S9(04) COMP.             01210000
012300     05  PV-TOT-INSERTS-BY-LNE-D     PIC 9(04).                   01220000
012400     05  PV-SHIPT-UNT-ID-WRK                 PIC 9(18).           01230000
012500*                                                                 01240000
012600     05  PV-HNG-FOLD-SEQ-NBR         PIC  S9(4) COMP.             01250000
012700     05  PV-PREV-HANG-FOLD-IND       PIC  X(01) VALUE SPACE.      01260000
012800     05  PV-HANG-FOLD-IND            PIC  X(01) VALUE SPACE.      01270000
012900*                                                                 01280000
013000     05  PV-DISPLAY-CARTON               PIC  9(18) VALUE ZEROES. 01290000
013010                                                                  01300000
013020*----------------------------------------------------------------*01301000
013030 01  PC-LABEL-MESSAGES.                                           01302000
013040*----------------------------------------------------------------*01303000
013050     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               01304000
013060                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 01305000
013070                                                                  01306000
013080                                                                  01307000
013090 01  PS-PROGRAM-SWITCHES.                                         01308000
013100     05  PS-SOCKET-ERROR-SW              PIC  X(01)  VALUE 'N'.   01309000
013200         88  PS-SOCKET-ERROR                         VALUE 'Y'.   01310000
013300         88  PS-NO-SOCKET-ERROR                      VALUE 'N'.   01320000
013400     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01330000
013500         88  PS-VALID-INPUT                          VALUE 'Y'.   01340000
013600         88  PS-INVALID-INPUT                        VALUE 'N'.   01350000
013700     05  PS-VALID-TRANS-ID-SW            PIC  X(01)  VALUE 'Y'.   01360000
013800         88  PS-VALID-TRANS-ID                       VALUE 'Y'.   01370000
013900         88  PS-INVALID-TRANS-ID                     VALUE 'N'.   01380000
014000     05  PS-VALID-PRINTER-SW             PIC  X(01)  VALUE 'Y'.   01390000
014100         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   01400000
014200         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   01410000
014300     05  PS-EOF-LINE-UNITS-CSR-SW        PIC  X(01)  VALUE 'N'.   01420000
014400         88  PS-EOF-LINE-UNITS-CSR                   VALUE 'Y'.   01430000
014500         88  PS-NOT-EOF-LINE-UNITS-CSR               VALUE 'N'.   01440000
014600     05  PS-EOF-UPDATE-CARTN-CSR-SW      PIC  X(01)  VALUE 'N'.   01450000
014700         88  PS-EOF-UPDATE-CARTN-CSR                 VALUE 'Y'.   01460000
014800         88  PS-NOT-EOF-UPD-CRTN-CSR                 VALUE 'N'.   01470000
014900     05  PS-EOF-RESMTH-CSR-SW            PIC  X(01)  VALUE 'N'.   01480000
015000         88  PS-EOF-RESMTH-CSR                       VALUE 'Y'.   01490000
015100         88  PS-NOT-EOF-RESMTH-CSR                   VALUE 'N'.   01500000
015200     05  PS-REPRINT-BATCH-SW             PIC  X(01)  VALUE 'N'.   01510000
015300         88  PS-REPRINT-BATCH                        VALUE 'Y'.   01520000
015400         88  PS-NOT-REPRINT-BATCH                    VALUE 'N'.   01530000
015500     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   01540000
015600         88  PS-REPRINT-FORM                         VALUE 'Y'.   01550000
015700         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   01560000
015800     05  PS-EOF-SMTHNG-PRC-CSR-SW        PIC  X(01)  VALUE 'N'.   01570000
015900         88  PS-EOF-SMTHNG-PRC-CSR                   VALUE 'Y'.   01580000
016000         88  PS-NOT-EOF-SMTHNG-PRC-CSR               VALUE 'N'.   01590000
016100     05  PS-RPRT-REQST-QUEUE-EOF-SW      PIC  X(01)  VALUE 'N'.   01600000
016200         88  PS-RPRT-REQST-QUEUE-EOF                 VALUE 'Y'.   01610000
016300         88  PS-NOT-RPRT-REQST-QUEUE-EOF             VALUE 'N'.   01620000
016400     05  PS-FIRST-PROCESS-LINE-SW        PIC  X(01)  VALUE 'Y'.   01630000
016500         88  PS-FIRST-PROCESS-LINE                   VALUE 'Y'.   01640000
016600         88  PS-NOT-FIRST-PROCESS-LINE               VALUE 'N'.   01650000
016700     05  PS-ALL-UNTS-ALLOCATED-SW        PIC  X(01)  VALUE 'N'.   01660000
016800         88  PS-ALL-UNTS-ALLOCATED                   VALUE 'Y'.   01670000
016900         88  PS-NOT-ALL-UNTS-ALLOCATED               VALUE 'N'.   01680000
017000     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   01690000
017100         88  PS-NO-MSG-1                             VALUE 'N'.   01700000
017200         88  PS-YES-MSG-1                            VALUE 'Y'.   01710000
017300     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   01720000
017400         88  PS-NO-MSG-2                             VALUE 'N'.   01730000
017500         88  PS-YES-MSG-2                            VALUE 'Y'.   01740000
017600     05  PS-TRANS-ID-DUP-SW              PIC  X(01)  VALUE 'Y'.   01750000
017700         88  PS-TRANS-ID-NOT-DUP                     VALUE 'N'.   01760000
017800         88  PS-TRANS-ID-DUP                         VALUE 'Y'.   01770000
017900     05  PS-FIRST-LABEL-SW               PIC  X(01)  VALUE 'Y'.   01780000
018000         88  PS-FIRST-LABEL                          VALUE 'Y'.   01790000
018100         88  PS-NOT-FIRST-LABEL                      VALUE 'N'.   01800000
018200     05  PS-NEW-STORE-FIXTURE-IND        PIC X(1)    VALUE 'N'.   01810000
018300         88  PS-NO-NEW-STORE-FIXTURE                 VALUE 'N'.   01820000
018400         88  PS-NEW-STORE-FIXTURE                    VALUE 'Y'.   01830000
018500     05  PS-CREATE-NEW-CRTN-BRCE-SW      PIC X(1)    VALUE 'Y'.   01840000
018600         88  PS-CREATE-NEW-CRTN-BRCE                 VALUE 'Y'.   01850000
018700         88  PS-NOT-NEW-CRTN-BRCE                    VALUE 'Y'.   01860000
018800     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01870000
018900         88  PS-ERROR                                VALUE 'Y'.   01880000
019000         88  PS-NO-ERROR                             VALUE 'N'.   01890000
019100     05  PS-MULTIPLE-LINES-FND-SW        PIC  X(01)  VALUE 'N'.   01900000
019200         88  PS-MULTIPLE-LINES-FND                   VALUE 'Y'.   01910000
019300         88  PS-MULTIPLE-LINES-NOT-FND               VALUE 'N'.   01920000
019310     05  PS-HANG-FOLD-CSR-SW             PIC  X(01)  VALUE 'N'.   01930000
019320         88  PS-EO-HANG-FOLD-CSR                     VALUE 'Y'.   01931000
019330         88  PS-NOT-EO-HANG-FOLD-CSR                 VALUE 'N'.   01932000
019331     05  PS-HANG-FOLD-MIXED-SW           PIC  X(01)  VALUE 'N'.   01933000
019332         88  PS-HANG-FOLD-MIXED                      VALUE 'Y'.   01933100
019333         88  PS-NOT-HANG-FOLD-MIXED                  VALUE 'N'.   01933200
019334     05  PS-FIRST-UPC-CALL-SW            PIC  X(01)  VALUE 'N'.   01933300
019335         88  PS-FIRST-UPC-CALL                       VALUE 'Y'.   01933400
019336         88  PS-NOT-FIRST-UPC-CALL                   VALUE 'N'.   01933500
019337     05  PS-BAL-ON-HAND-QTY-SW           PIC  X(01)  VALUE 'N'.   01933600
019338         88  PS-BAL-ON-HND-QTY-ZERO                  VALUE 'Y'.   01933700
019339         88  PS-BAL-ON-HND-QTY-NOT-ZERO              VALUE 'N'.   01933800
019340     05  PS-EOF-STORE-ITEMS-CSR-SW       PIC  X(01)  VALUE 'N'.   01933900
019341         88  PS-EO-STORE-ITEMS-CSR                   VALUE 'Y'.   01934000
019342         88  PS-NOT-EO-STORE-ITEMS-CSR               VALUE 'N'.   01934100
019343     05  PS-PREV-PROCESS-MESSAGE-SW      PIC  X(01)  VALUE 'N'.   01934200
019344         88  PS-PREV-PROCESS-MESSAGE-Y               VALUE 'Y'.   01934300
019345         88  PS-PREV-PROCESS-MESSAGE-N               VALUE 'N'.   01934400
019346     05  PS-PRESENTATION-FOUND-SW        PIC  X(01)  VALUE 'N'.   01934500
019347         88  PS-PRESENTATION-FOUND-YES               VALUE 'Y'.   01934600
019348         88  PS-PRESENTATION-FOUND-NO                VALUE 'N'.   01934700
      *CLP 06/24/2015 - START                                           01934802
019349     05  PS-BRAND-FOUND-SW     PIC  X(01)  VALUE 'N'.             01934902
019350         88  PS-BRAND-FOUND-YES            VALUE 'Y'.             01935002
019351         88  PS-BRAND-FOUND-NO             VALUE 'N'.             01935102
      *CLP 06/24/2015 - END                                             01935202
019352     05  PS-PRSNT-MRCH-PGM-CHECKED-SW    PIC  X(01)  VALUE 'N'.   01935300
019353         88  PS-PRSNT-MRCH-PGM-CKD-YES               VALUE 'Y'.   01935400
019354         88  PS-PRSNT-MRCH-PGM-CKD-NO                VALUE 'N'.   01935500
019355                                                                  01935600
019356 01  PV-PROGRAM-VARIABLES.                                        01935700
019357     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   01935800
019358                                                     COMP SYNC.   01935900
019359     05  PV-CICS-MSG-AREA-A.                                      01936000
019360         10  FILLER                      PIC  X(01)  VALUE SPACE. 01936100
019370         10  PV-CICS-MSG-AREA-B          PIC  X(80)  VALUE SPACE. 01936200
019380     05  PV-CICS-MSG-AREA-C.                                      01937000
019390         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01938000
019400         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01939000
019500         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01940000
019600         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01950000
019700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.01960000
019800     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  01970000
019900     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  01980000
020000     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  01990000
020100     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  02000000
020200     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  02010000
020300                                                                  02020000
020400     05  PV-SHIPT-UNT-ID                 PIC  X(18)  VALUE SPACES.02030000
020500     05  PV-SHIPT-UNT-ID-R REDEFINES PV-SHIPT-UNT-ID.             02040000
020600         10  FILLER                      PIC  9(13).              02050000
020700         10  PV-LAST-FIVE-DIGITS         PIC  9(05).              02060000
020800     05  PV-PO-NBR                       PIC  X(09)  VALUE SPACES.02070000
020900     05  PV-PO-NBR-R REDEFINES PV-PO-NBR.                         02080000
021000         10  FILLER                      PIC  9(01).              02090000
021100         10  PV-PO-NBR-7POS              PIC  9(08).              02100000
021200*                                                                 02110000
021300     05  PV-RCVR-NBR                     PIC  9(09).              02120000
021400     05  PV-RCVR-NBR-R REDEFINES PV-RCVR-NBR.                     02130000
021500         10  FILLER                      PIC  9(06).              02140000
021600         10  PV-RCVR-NBR-3               PIC  9(03).              02150000
021700*                                                                 02160000
021800     05  PV-LINE-NBR                     PIC  X(09)  VALUE SPACES.02170000
021900     05  PV-LINE-NBR-R REDEFINES PV-LINE-NBR.                     02180000
022000         10  FILLER                      PIC  9(06).              02190000
022100         10  PV-PO-LINE-NBR              PIC  9(03).              02200000
022200*                                                                 02210000
022300     05  PV-LINE-RATO                    PIC  9(04).              02220000
022400     05  PV-LINE-RATO-R REDEFINES PV-LINE-RATO.                   02230000
022500         10  FILLER                      PIC  X(01).              02240000
022600         10  PV-LINE-RATO-NBR            PIC  X(03).              02250000
022700*                                                                 02260000
022800                                                                  02270000
022900     05  PV-STORE-NBR                    PIC  9(04)  VALUE ZEROES.02280000
023000                                                                  02290000
023100     05  PV-LNE-NBR                      PIC  9(04)  VALUE ZEROES.02300000
023200     05  PV-LNE-NBR-R REDEFINES PV-LNE-NBR.                       02310000
023300         10  FILLER                      PIC  9(01).              02320000
023400         10  PV-LNE-NUMBER               PIC  9(03).              02330000
023401                                                                  02340000
023402     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.02340100
023403     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          02340200
023404         10  PV-RANDOM-1-8               PIC  9(08).              02340300
023405         10  FILLER                      PIC  9(01).              02340400
023406     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.02340500
023407     05  PV-LPMS-XMIT-RETURN             PIC  X(01)  VALUE SPACES.02340600
023408                                                                  02340700
023409     05  PV-TRAILER-COUNT                PIC  9(07)  VALUE ZERO.  02340800
      *CLP 06/24/2015 START                                             02340903
           05  PV-BUS-AREA-BRAND        PIC  X(35)    VALUE SPACES.     02341203
032310     05  PV-DESC-LEN              PIC S9(04) VALUE +0             02341306
032320                                                COMP.             02341406
           05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     02341506
      *CLP 06/24/2015 END                                               02341603
023410*                                                                 02341700
023420                                                                  02341800
023430     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  02342000
023440     05  PV-9999-X REDEFINES PV-9999-9.                           02343000
023450         10  PV-9999-1-2                 PIC  X(02).              02344000
023460         10  PV-9999-3-4                 PIC  X(02).              02345000
023470*                                                                 02346000
023480     05  PV-DEPT-NUMBER                  PIC  X(03) VALUE SPACES. 02347000
023490     05  PV-CL-NBR                       PIC  X(02) VALUE SPACES. 02348000
023500*                                                                 02349000
023600*EXAMPLE:  (055-31)12345678   (USED ON SML LABELS).               02350000
023700     05  PV-SML-SKU-NUMBER.                                       02360000
023800         10  FILLER                      PIC  X(01)  VALUE '('.   02370000
023900         10  PV-SML-DEPT1                PIC  X(03).              02380000
024000         10  FILLER                      PIC  X(01)  VALUE '-'.   02390000
024100         10  PV-SML-CLASS-NBR1           PIC  X(02).              02400000
024200         10  FILLER                      PIC  X(01)  VALUE ')'.   02410000
024300         10  PV-SML-SKU-NBR              PIC  X(08).              02420000
024400                                                                  02430000
024500*                                                                 02440000
024600     05  PV-PO-RCVR.                                              02450000
024700         10  PV-PO-NUMBER                PIC  9(08)  VALUE ZEROES.02460000
024800         10  FILLER                      PIC  X(01)  VALUE '-'.   02470000
024900         10  PV-PO-RECEIVER              PIC  9(03)  VALUE ZEROES.02480000
025000                                                                  02490000
025100     05  PV-BARCODE-sml.                                          02500000
025200         10  PV-PO                       PIC S9(09)  COMP.        02510000
025300         10  PV-ITEM                     PIC S9(15)V COMP-3.      02520000
025400         10  PV-OUTERPACK                PIC S9(09)  COMP.        02530000
025500*                                                                 02540000
025600*                                                                 02550000
025700     05  PV-PRINTER-HOLD.                                         02560000
025800         10  PV-PRINTER-1-3              PIC  9(03).              02570000
025900         10  FILLER                      PIC  X(05).              02580000
026000*                                                                 02590000
026100     05  PV-DSPLY-PRTR                   PIC  X(06)  VALUE SPACES.02600000
026200     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 02610000
026300         10  PV-DSPLY-DC                 PIC  X(02).              02620000
026400         10  PV-DSPLY-DASH               PIC  X(01).              02630000
026500         10  PV-DSPLY-PRTR-ID            PIC  X(03).              02640000
026600*                                                                 02650000
026700     05  PV-DISPLAY-PRTR                 PIC  X(07)  VALUE SPACES.02660000
026800     05  PV-DISPLAY-PRTR-R REDEFINES PV-DISPLAY-PRTR.             02670000
026900         10  PV-DISPLAY-NUM              PIC  X(01).              02680000
027000         10  PV-DISPLAY-DC               PIC  X(02).              02690000
027100         10  PV-DISPLAY-DASH             PIC  X(01).              02700000
027200         10  PV-DISPLAY-PRTR-ID          PIC  X(03).              02710000
027300*                                                                 02720000
027400     05  PV-PRINTER-ID                   PIC  X(03)  VALUE SPACES.02730000
027500*                                                                 02740000
027600*                                                                 02750000
027700     05  PV-BATCH-NUMBER-HOLD            PIC  X(04)  VALUE SPACES.02760000
027800*    05  PV-BATCH-NUMBER-HOLD-R REDEFINES PV-BATCH-NUMBER-HOLD.   02770000
027900*        10  FILLER                      PIC  X(01).              02780000
028000*        10  PV-BATCH-NUMBER-3-POS       PIC  X(03).              02790000
028100     05  PV-BATCH-NUMBER                 PIC  X(04)  VALUE SPACES.02800000
028200     05  PV-BATCH-NUMBER-R REDEFINES PV-BATCH-NUMBER.             02810000
028300         10  PV-BATCH-NUMBER-N           PIC  9(04).              02820000
028400*                                                                 02830000
028500*                                                                 02840000
028600     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     02850000
028700                                                     COMP-3.      02860000
028800     05  PV-SHUUPC-MULT-CNT              PIC S9(09)  VALUE +0     02870000
028900                                                     COMP-3.      02880000
029000     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  02890000
029100                                                     COMP SYNC.   02900000
029200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02910000
029300     05  PV-DISPLAY-LPMS-TRAN            PIC  X(08)  VALUE SPACE. 02920000
029400     05  PV-DISPLAY-MANIFEST             PIC  X(09)  VALUE SPACE. 02930000
029500     05  PV-DISPLAY-BATCH-NO             PIC  9(04)  VALUE ZEROS. 02940000
029600     05  PV-DISPLAY-SOCK-ID              PIC  9(04)  VALUE ZEROS. 02950000
029700     05  PV-DISPLAY-FLAG                 PIC  9(08)  VALUE ZEROS. 02960000
029800     05  PV-DISPLAY-NBR-BYTES            PIC  9(08)  VALUE ZEROS. 02970000
029900     05  PV-DISPLAY-FAMILY               PIC  9(04)  VALUE ZEROS. 02980000
030000     05  PV-DISPLAY-PORT                 PIC  9(04)  VALUE ZEROS. 02990000
030100     05  PV-DISPLAY-IP-ADDR              PIC  9(08)  VALUE ZEROS. 03000000
030200     05  PV-DISPLAY-CURR-OPER            PIC  9(04)  VALUE ZEROS. 03010000
030300     05  PV-DISPLAY-EIBCALEN             PIC s9(04)  VALUE zeroes.03020000
030400                                                                  03030000
030500     05  PV-DISPLAY-OPER                 PIC  9(04)  VALUE ZEROES.03040000
030600     05  PV-DISPLAY-TRIP                 PIC  9(09)  VALUE ZEROES.03050000
030700     05  PV-DISPLAY-BATCH                PIC  9(04)  VALUE ZEROES.03060000
030800     05  PV-DISPLAY-PO                   PIC  9(09)  VALUE ZEROES.03070000
030900     05  PV-DISPLAY-RCVR                 PIC  9(09)  VALUE ZEROES.03080000
031000     05  PV-DISPLAY-LINE                 PIC  9(09)  VALUE ZEROES.03090000
031100     05  PV-DISPLAY-DEST                 PIC  9(04)  VALUE ZEROES.03100000
031200                                                                  03110000
031300     05  PV-IP-ADDRESS.                                           03120000
031400         10  PV-IP-ADDR-NUM1             PIC 9(03).               03130000
031500             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  03140000
031600                                                          255.    03150000
031700         10  PV-IP-ADDR-DOT1             PIC X(01).               03160000
031800             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    03170000
031900         10  PV-IP-ADDR-NUM2             PIC 9(03).               03180000
032000             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  03190000
032100                                                          255.    03200000
032200         10  PV-IP-ADDR-DOT2             PIC X(01).               03210000
032300             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    03220000
032400         10  PV-IP-ADDR-NUM3             PIC 9(03).               03230000
032500             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  03240000
032600                                                          255.    03250000
032700         10  PV-IP-ADDR-DOT3             PIC X(01).               03260000
032800             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    03270000
032900         10  PV-IP-ADDR-NUM4             PIC 9(03).               03280000
033000             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  03290000
033100                                                          255.    03300000
033200                                                                  03310000
033300     05  PV-HEX-FIELD.                                            03320000
033400         10  PV-HEX-FIELD-1              PIC X(01).               03330000
033500         10  PV-HEX-FIELD-2              PIC X(01).               03340000
033600         10  PV-HEX-FIELD-3              PIC X(01).               03350000
033700         10  PV-HEX-FIELD-4              PIC X(01).               03360000
033800     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               03370000
033900                                         PIC 9(08)  COMP.         03380000
034000     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        03390000
034100     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    03400000
034200         10  PV-HEX-CHAR-1               PIC X(01).               03410000
034300         10  PV-HEX-CHAR-2               PIC X(01).               03420000
034400                                                                  03430000
034500     05 PV-CURRENT-DB2-DATE              PIC X(10)   VALUE SPACES.03440000
034600     05 PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.      03450000
034700         10 PV-CURRENT-CCYY              PIC  9(04).              03460000
034800         10 FILLER                       PIC  X(01).              03470000
034900         10 PV-CURRENT-MM-DD             PIC  9(05).              03480000
035000                                                                  03490000
035100     05 PV-LBL-DATE                      PIC  X(08)  VALUE SPACES.03500000
035200     05 PV-LBL-DATE-R REDEFINES PV-LBL-DATE.                      03510000
035300        10  PV-LBL-DATE-MM               PIC  X(02).              03520000
035400        10  PV-LBL-DASH1                 PIC  X(01).              03530000
035500        10  PV-LBL-DATE-DD               PIC  X(02).              03540000
035600        10  PV-LBL-DASH2                 PIC  X(01).              03550000
035700        10  PV-LBL-DATE-YY               PIC  X(02).              03560000
035800                                                                  03570000
035900     05 PV-WORK-DB2-DATE                 PIC X(10)   VALUE SPACES.03580000
036000     05 PV-WORK-DB2-DATE-R    REDEFINES PV-WORK-DB2-DATE.         03590000
036100         10 PV-WORK-CC                   PIC  9(02).              03600000
036200         10 PV-WORK-YY                   PIC  9(02).              03610000
036300         10 FILLER                       PIC  X(01).              03620000
036400         10 PV-WORK-MM                   PIC  9(02).              03630000
036500         10 FILLER                       PIC  X(01).              03640000
036600         10 PV-WORK-DD                   PIC  9(02).              03650000
036700                                                                  03660000
036800     05 PV-CURRENT-DB2-TIME              PIC  X(08)  VALUE SPACES.03670000
036900     05 PV-CURRENT-DB2-TIME-R REDEFINES PV-CURRENT-DB2-TIME.      03680000
037000         10 PV-CURRENT-HR                PIC  9(02).              03690000
037100         10 FILLER                       PIC  X(01).              03700000
037200         10 PV-CURRENT-MN                PIC  9(02).              03710000
037300         10 FILLER                       PIC  X(01).              03720000
037400         10 PV-CURRENT-SC                PIC  9(02).              03730000
037500                                                                  03740000
037600     05  PV-CURRENT-DB2-TIMESTAMP        PIC  X(26).              03750000
037700                                                                  03760000
037800     05 PV-CURRENT-TIME.                                          03770000
037900         10 PV-CURRENT-HOUR              PIC  9(02)  VALUE ZEROES.03780000
038000         10 FILLER                       PIC  X(01)  VALUE ':'.   03790000
038100         10 PV-CURRENT-MIN               PIC  9(02)  VALUE ZEROES.03800000
038200                                                                  03810000
038300     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    03820000
038400     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           03830000
038500         10 PV-DPKUT038-YY               PIC  X(02).              03840000
038600         10 PV-DPKUT038-MM               PIC  X(02).              03850000
038700         10 PV-DPKUT038-DD               PIC  X(02).              03860000
038800     05  PV-DPKUT038-MJR-CL.                                      03870000
038900         10 FILLER                       PIC  X(01) VALUE SPACE.  03880000
039000         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  03890000
039100                                                                  03900000
039200     05  PV-DEPT-DESC                   PIC   X(25) VALUE SPACES. 03910000
039300     05  PV-MAJ-CL-DESC                 PIC   X(25) VALUE SPACES. 03920000
039400                                                                  03930000
039500*                                                                 03940000
039600     05  PV-USER-ID                      PIC  X(08)  VALUE SPACE. 03950000
039700     05  PV-SEL-SUB                      PIC S9(4) COMP.          03960000
039800     05  PV-NBR-PROCESSED                PIC S9(4) COMP.          03970000
039900     05  PV-SEL-ITEM                     PIC S9(4) COMP.          03980000
040000*                                                                 03990000
040100     05  PV-MAX-USER-BATCH               PIC S9(04)  VALUE ZEROES 04000000
040200                                                     COMP.        04010000
040300     05  PV-LAST-BATCH-NUMBER            PIC S9(04)  VALUE ZEROES 04020000
040400                                                     COMP.        04030000
040500     05  PV-LAST-BATCH-NO                PIC  9(03)  VALUE ZEROES.04040000
040600                                                                  04050000
040700     05  PV-DISPLAY-DOWNLOAD.                                     04060000
040800         10  PV-DISPLAY-DOWNLOAD-1       PIC  X(80)  VALUE SPACE. 04070000
040900         10  PV-DISPLAY-DOWNLOAD-2       PIC  X(80)  VALUE SPACE. 04080000
041000         10  PV-DISPLAY-DOWNLOAD-3       PIC  X(80)  VALUE SPACE. 04090000
041100     05  PV-CICS-MESSAGE-AREA            PIC  X(80)  VALUE SPACES.04100000
041200     05  PV-DB2-LABEL-COUNT              PIC S9(09)  VALUE ZEROS  04110000
041300                                                     COMP-3.      04120000
041400     05  PV-DB2-REPRINT-LBL-CNT          PIC S9(09)  VALUE ZEROS  04130000
041500                                                     COMP-3.      04140000
041600     05  PV-DB2-EXCEPT-LBL-CNT           PIC S9(09)  VALUE ZEROS  04150000
041700                                                     COMP-3.      04160000
041800     05  PV-OWNER-SCAC-ID                PIC  X(04)  VALUE SPACES.04170000
041900     05  PV-VEH-NBR                      PIC  X(10)  VALUE SPACES.04180000
042000     05  PV-DC-5-CHAR-ABBR               PIC  X(05)  VALUE SPACES.04190000
042100     05  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.         04200000
042200         10  FILLER                      PIC  X(03).              04210000
042300         10  PV-2-DIGIT-DC-ABBR          PIC  X(02).              04220000
042400                                                                  04230000
042500     05  PV-PRINTER-FORMAT.                                       04240000
042600         10  FILLER                      PIC  X(01)  VALUE '#'.   04250000
042700         10  PV-DC-PRTD-AT               PIC  X(02)  VALUE SPACES.04260000
042800         10  FILLER                      PIC  X(01)  VALUE '-'.   04270000
042900         10  PV-PRTR-ID                  PIC  X(03)  VALUE SPACES.04280000
043000                                                                  04290000
043100* DISPLAY TCP BUFFER DATA                                         04300000
043200     05  PV-TCP-BUF-DATA-FORMAT.                                  04310000
043300         10  PV-TCP-BUF-DATA-FORMAT1     PIC  X(51)  VALUE SPACE. 04320000
043400         10  PV-TCP-BUF-DATA-FORMAT2     PIC  X(51)  VALUE SPACE. 04330000
043500     05  PV-20-DIGIT-BARCODE.                                     04340000
043600         10  PV-20-SML-CONTAINER-CDE             PIC 9(02).       04350000
043700         10  PV-20-DIGIT-BRCDE-18.                                04360000
043800             15  PV-20-SML-PACKAGING-TYP         PIC 9(01).       04370000
043900             15  PV-20-SML-SOFTWARE-SRC          PIC 9(01).       04380000
044000             15  PV-20-SML-BC-DIVERT             PIC 9(05).       04390000
044100             15  PV-20-SML-BC-DC-ORIGIN          PIC 9(03).       04400000
044200             15  PV-20-SML-BC-MNFST-NBR          PIC 9(08).       04410000
044300                                                                  04420000
044400                                                                  04430000
044500*----------------------------------------------------------------*04440000
044600*  RANDOM NUMBER AREA                                            *04450000
044700*----------------------------------------------------------------*04460000
044800     COPY DPWS902.                                                04470000
044900                                                                  04480000
045000*----------------------------------------------------------------*04490000
045100*  RECORD LAYOUTS FOR LABEL PRINT MGMT SYSTEM (LPMS)             *04500000
045200*----------------------------------------------------------------*04510000
045300     COPY PCWS133.                                                04520000
045400                                                                  04530000
045500*----------------------------------------------------------------*04540000
045600*  BATCH LABEL - LABEL HEADER                                    *04550000
045700*----------------------------------------------------------------*04560000
045800     COPY PCWS207.                                                04570000
045900                                                                  04580000
046000*----------------------------------------------------------------*04590000
046100*  BATCH LABEL - SML LABEL FORM                                  *04600000
046200*----------------------------------------------------------------*04610000
046300     COPY PCWS255.                                                04620000
046400                                                                  04630000
046500*----------------------------------------------------------------*04640000
046600*  BATCH LABEL - SML LABEL DATA                                  *04650000
046700*----------------------------------------------------------------*04660000
046800     COPY PCWS256.                                                04670000
046900                                                                  04680000
047000*----------------------------------------------------------------*04690000
047100*  BATCH LABEL - LABEL TRAILER                                   *04700000
047200*----------------------------------------------------------------*04710000
047300     COPY PCWS137.                                                04720000
047400                                                                  04730000
047500*----------------------------------------------------------------*04740000
047600*  BARCODE COPYBOOK                                              *04750000
047700*----------------------------------------------------------------*04760000
047800     COPY PCWS160.                                                04770000
047900                                                                  04780000
048000*----------------------------------------------------------------*04790000
048100*  LABEL PRINT MANAGEMENT SYSTEM - 'EZASOKET' ERROR MESSAGES     *04800000
048200*----------------------------------------------------------------*04810000
048300     COPY PCWS138.                                                04820000
048400                                                                  04830000
048500*----------------------------------------------------------------*04840000
048600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               04850000
048700*----------------------------------------------------------------*04860000
048800     COPY DPWS013.                                                04870000
048900                                                                  04880000
049000*----------------------------------------------------------------*04890000
049100*  SENDING/RECEIVING AREA FOR THE                                *04900000
049200*  PRINTER VALIDATION ROUTING (DPKCS060)                         *04910000
049300*----------------------------------------------------------------*04920000
049400     COPY DPWS072.                                                04930000
049500                                                                  04940000
049600******************************************************************04950000
049700*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        04960000
049800******************************************************************04970000
049900*    COPY DPWS008.                                                04980000
050000*                                                                 04990000
050100******************************************************************05000000
050200*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 05010000
050300******************************************************************05020000
050400     COPY DPWS010I.                                               05030000
050500                                                                  05040000
050600******************************************************************05050000
050700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   05060000
050800******************************************************************05070000
050900     COPY DPWS015.                                                05080000
051000                                                                  05090000
051100*----------------------------------------------------------------*05100000
051200*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME                05110000
051300*----------------------------------------------------------------*05120000
051400     COPY DPWS003.                                                05130000
051500******************************************************************05140000
051600*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      05150000
051700******************************************************************05160000
051800     COPY DFHAID.                                                 05170000
051900                                                                  05180000
052000*----------------------------------------------------------------*05190000
052100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE                   *05200000
052200*  SUT_SMOOTHING_PRC WHICH IS THE SMOOTHING WORK TABLE           *05210000
052300*----------------------------------------------------------------*05220000
052400     EXEC SQL                                                     05230000
052500         INCLUDE SUT00003                                         05240000
052600     END-EXEC.                                                    05250000
052700                                                                  05260000
052800*----------------------------------------------------------------*05270000
052900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE                   *05280000
053000*----------------------------------------------------------------*05290000
053100     EXEC SQL                                                     05300000
053200         INCLUDE TRECITM                                          05310000
053300     END-EXEC.                                                    05320000
053400                                                                  05330000
053500*----------------------------------------------------------------*05340000
053600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *05350000
053700*  HISTORY TABLE                                                 *05360000
053800*----------------------------------------------------------------*05370000
053900     EXEC SQL                                                     05380000
054000         INCLUDE TLBTKHS                                          05390000
054100     END-EXEC.                                                    05400000
054200                                                                  05410000
054300*----------------------------------------------------------------*05420000
054400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *05430000
054500*  ID TABLE                                                      *05440000
054600*----------------------------------------------------------------*05450000
054700     EXEC SQL                                                     05460000
054800         INCLUDE TLBTKID                                          05470000
054900     END-EXEC.                                                    05480000
055000                                                                  05490000
055100*----------------------------------------------------------------*05500000
055200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTROL TABLE     *05510000
055300*----------------------------------------------------------------*05520000
055400     EXEC SQL                                                     05530000
055500         INCLUDE TCOCNTL                                          05540000
055600     END-EXEC.                                                    05550000
055700                                                                  05560000
055800*----------------------------------------------------------------*05570000
055900*  DCLGEN XLT_LOC database                                       *05580000
056000*----------------------------------------------------------------*05590000
056100     EXEC SQL                                                     05600000
056200         INCLUDE XLT00010                                         05610000
056300     END-EXEC.                                                    05620000
056400                                                                  05630000
056500*----------------------------------------------------------------*05640000
056600*  DCLGEN LAYOUT AND COBOL DECLARATION                           *05650000
056700*----------------------------------------------------------------*05660000
056800     EXEC SQL                                                     05670000
056900         INCLUDE TRECDIS                                          05680000
057000     END-EXEC.                                                    05690000
057100                                                                  05700000
057200*----------------------------------------------------------------*05710000
057300*----------------------------------------------------------------*05720000
057400*  DCLGEN LAYOUT AND COBOL DECLARATION                           *05730000
057500*----------------------------------------------------------------*05740000
057600     EXEC SQL                                                     05750000
057700         INCLUDE TPURITM                                          05760000
057800     END-EXEC.                                                    05770000
057900                                                                  05780000
058000*----------------------------------------------------------------*05790000
058100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *05800000
058200*----------------------------------------------------------------*05810000
058300     EXEC SQL                                                     05820000
058400         INCLUDE TUPCSKU                                          05830000
058500     END-EXEC.                                                    05840000
058600                                                                  05850000
058700*----------------------------------------------------------------*05860000
058800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *05870000
058900*----------------------------------------------------------------*05880000
059000     EXEC SQL                                                     05890000
059100         INCLUDE SUT00024                                         05900000
059200     END-EXEC.                                                    05910000
059300                                                                  05920000
059400*----------------------------------------------------------------*05930000
059500*  DCLGEN LAYOUT AND COBOL DECLARATION                           *05940000
059600*----------------------------------------------------------------*05950000
059700     EXEC SQL                                                     05960000
059800         INCLUDE SUT00028                                         05970000
059900     END-EXEC.                                                    05980000
060000                                                                  05990000
060100*----------------------------------------------------------------*06000000
060200*----------------------------------------------------------------*06010000
060300*  DCLGEN LAYOUT AND COBOL DECLARATION                           *06020000
060400*----------------------------------------------------------------*06030000
060500     EXEC SQL                                                     06040000
060600         INCLUDE TPURCHS                                          06050000
060700     END-EXEC.                                                    06060000
060800                                                                  06070000
060900*----------------------------------------------------------------*06080000
061000*  DCLGEN LAYOUT AND COBOL DECLARATION                           *06090000
061100*----------------------------------------------------------------*06100000
061200     EXEC SQL                                                     06110000
061300         INCLUDE TVNDDPT                                          06120000
061400     END-EXEC.                                                    06130000
061500                                                                  06140000
061600*----------------------------------------------------------------*06150000
061700*  DCLGEN LAYOUT AND COBOL DECLARATION                           *06160000
061800*----------------------------------------------------------------*06170000
061900     EXEC SQL                                                     06180000
062000         INCLUDE TSEASET                                          06190000
062100     END-EXEC.                                                    06200000
062200                                                                  06210000
063000*----------------------------------------------------------------*06220000
063100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *06230000
063200*----------------------------------------------------------------*06240000
063300     EXEC SQL                                                     06250000
063400         INCLUDE TSULBXF                                          06260000
063500     END-EXEC.                                                    06270000
063600                                                                  06280000
063700*----------------------------------------------------------------*06290000
063800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *06300000
063900*----------------------------------------------------------------*06310000
064000     EXEC SQL                                                     06320000
064100         INCLUDE XLT00003                                         06330000
064200     END-EXEC.                                                    06340000
064300                                                                  06350000
064400*================================================================*06360000
064410* DC DOOR TABLE                                                  *06370000
064420*================================================================*06380000
064430     EXEC SQL                                                     06390000
064440          INCLUDE TCNDCDR                                         06400000
064450     END-EXEC.                                                    06410000
064460                                                                  06420000
064470*================================================================*06430000
064471* DC DOOR TO STORE TABLE                                         *06440000
064472*================================================================*06441000
064473     EXEC SQL                                                     06442000
064474          INCLUDE TCNDRST                                         06443000
064475     END-EXEC.                                                    06444000
064476                                                                  06445000
064477*----------------------------------------------------------------*06446000
      *CLP 06/24/2015 - START                                           06447002
012270*----------------------------------------------------------------*06447802
012280* VENDOR STYLE TABLE (XLT_VND_STYL)                               06447902
012290*----------------------------------------------------------------*06448002
012300     EXEC SQL                                                     06448102
012310          INCLUDE XLT00004                                        06448202
012320     END-EXEC.                                                    06448302
012330                                                                  06448402
064494*================================================================*06448500
064495* BRAND TABLE (XLT_BRND)                                          06448602
064496*================================================================*06448700
064497     EXEC SQL                                                     06448800
064498          INCLUDE XLT00043                                        06449002
064499     END-EXEC.                                                    06449100
064500                                                                  06449200
      *CLP 06/24/2015 - END                                             06449302
064501*----------------------------------------------------------------*06449400
064502*----------------------------------------------------------------*06449500
064503*  CURSOR TO DETERMINE LINE NUMBER AND UNITS TOTAL PER LINE   *   06449600
064504*----------------------------------------------------------------*06449700
064505     EXEC SQL                                                     06449800
064506          DECLARE LINE_UNITS_CSR CURSOR WITH HOLD FOR             06449900
064507          SELECT   A.ORD_LNE_NBR                                  06450000
064508                 , SUM(B.VERIFY_ITM_QTY)                          06450100
064509                 , A.ITM_NBR                                      06450200
064510           FROM    TRECITM A                                      06450300
064520                 , TRECDIS B                                      06450400
064530           WHERE     A.ORD_NBR        = :DK-PO-NBR                06450500
064540              AND    A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           06450600
064550              AND    B.STR_NBR        = :DK-STR-NBR               06450700
064560              AND    A.ORD_NBR        =  B.ORD_NBR                06450800
064570              AND    A.ORD_LNE_NBR    =  B.ORD_LNE_NBR            06450900
064580              AND    A.REC_SEQ_NBR    =  B.REC_SEQ_NBR            06451000
064590              AND    A.VER_STATUS_CDE = 'A'                       06451100
064600           GROUP BY                                               06452000
064700                  A.ORD_LNE_NBR                                   06453000
064800                , A.ITM_NBR                                       06454000
064900     END-EXEC.                                                    06455000
065000                                                                  06456000
065100*----------------------------------------------------------------*06457000
065200*  CURSOR TO UNLOAD WORK TABLE, POPULATE SUT_OTBND_CART,        * 06458000
065300*  SUT_OTBND_UPC AND CREATE LABELS                                06459000
065400*----------------------------------------------------------------*06460000
065500     EXEC SQL                                                     06470000
065600          DECLARE SMTHG_PROCESS_CSR CURSOR WITH HOLD FOR          06480000
065700          SELECT   CART_NBR                                       06490000
065800                 , PO_LNE_NBR                                     06500000
065900                 , SUM(UNT_QTY)                                   06510000
066000                 , STR_NBR                                        06520000
066100           FROM    SUT_SMOOTHING_PRC                              06530000
066200           WHERE     SMTHG_PRC_ID     = :DK-SMTHG-PRC-IND         06540000
066300              AND    PO_NBR           = :DK-PO-NBR                06550000
066400              AND    RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR           06560000
066500           GROUP BY                                               06570000
066600                  STR_NBR, CART_NBR, PO_LNE_NBR                   06580000
066700     END-EXEC.                                                    06590000
066800*---------------------------------------------------------------* 06600000
066900* CARTON CURSOR FOR SELECTING FROM SUT_OTBND_CART AND           * 06610000
067000* SUT_OTBND_UPC                                                 * 06620000
067100*---------------------------------------------------------------* 06630000
067200     EXEC SQL                                                     06640000
067300          DECLARE RESMOOTH_CRTN_CSR CURSOR WITH HOLD FOR          06650000
067400              SELECT DISTINCT                                     06660000
067500                     B.SHIPT_UNT_ID                               06670000
067600              FROM  SUT_OTBND_UPC A,                              06680000
067700                    SUT_OTBND_CART B                              06690000
067800              WHERE A.TRN_NBR           =  :DK-PO-NBR             06700000
067900               AND   A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR        06710000
068000               AND   A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID        06720000
068100               AND   B.DEST_LOC_NBR     =  :DK-STR-NBR            06730000
068200               AND   B.ACTV_IND         =  'Y'                    06740000
068300     END-EXEC.                                                    06750000
068400                                                                  06760000
068500*----------------------------------------------------------------*06770000
068600*  CURSOR TO DETERMINE ALL THE ITEMS FOR A PO,RCVR,STORE        * 06780000
068700*  USED TO DETERMINE BALANCE ON HAND                            * 06790000
068800*---------------------------------------------------------------* 06800000
068900     EXEC SQL                                                     06810000
069000          DECLARE STORE_ITEM_CSR CURSOR FOR                       06820000
069100          SELECT   DISTINCT A.ITM_NBR                             06830000
069200           FROM    TRECITM A                                      06840000
069300                 , TRECDIS B                                      06850000
069400           WHERE     A.ORD_NBR        = :DK-PO-NBR                06860000
069500              AND    A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           06870000
069600              AND    B.STR_NBR        = :DK-STR-NBR               06880000
069700              AND    A.ORD_NBR        =  B.ORD_NBR                06890000
069800              AND    A.ORD_LNE_NBR    =  B.ORD_LNE_NBR            06900000
069900              AND    A.REC_SEQ_NBR    =  B.REC_SEQ_NBR            06910000
070000              AND    A.VER_STATUS_CDE = 'A'                       06920000
070100     END-EXEC                                                     06930000
070200*----------------------------------------------------------------*06940000
070300*  COMMUNICATIONS AREA FOR DB2                                   *06950000
070310*----------------------------------------------------------------*06960000
070320     EXEC SQL                                                     06970000
070330         INCLUDE SQLCA                                            06980000
070340     END-EXEC.                                                    06990000
070350                                                                  07000000
070360******************************************************************07010000
070370 LINKAGE SECTION.                                                 07020000
070380******************************************************************07030000
070390 01  DFHCOMMAREA.                                                 07031000
070400     05  FILLER                       OCCURS 1 TO 4072 TIMES      07032000
070500                                      DEPENDING ON EIBCALEN.      07033000
070600         10  FILLER                   PIC X.                      07034000
070700                                                                  07035000
070800******************************************************************07036000
070900 PROCEDURE DIVISION.                                              07037000
071000******************************************************************07038000
071100 0000-PROGRAM-MAINLINE.                                           07039000
071200                                                                  07040000
071300     PERFORM 1000-INITIAL-PROCESS.                                07050000
071400                                                                  07060000
071500*                                                                 07070000
071600     PERFORM 9000-RETURN-CALL.                                    07080000
071700                                                                  07090000
071800                                                                  07100000
071900     GOBACK.                                                      07110000
072000                                                                  07120000
072100                                                                  07130000
072200******************************************************************07140000
072300 1000-INITIAL-PROCESS.                                            07150000
072400                                                                  07160000
072500     MOVE DFHCOMMAREA             TO   PC204-INTER-APPL-COMMAREA. 07170000
072600                                                                  07180000
072700                                                                  07190000
072800******************************************************************07200000
072900     EXEC CICS                                                    07210000
073000         ASSIGN USERID  (PV-USER-ID)                              07220000
073100                RESP    (PV-CICS-RESPONSE)                        07230000
073200     END-EXEC.                                                    07240000
073300                                                                  07250000
073400******************************************************************07260000
073500                                                                  07270000
073600     SET PC204-SUCCESSFUL-REQ  TO   TRUE.                         07280000
073700                                                                  07290000
073800     MOVE PV-USER-ID                                              07300000
073900                              TO SUT00003-CRE-USR-ID              07310000
074000     MOVE PC204-OPER-UNT-ID                                       07320000
074100                              TO DK-OPER-UNT-ID                   07330000
074200                                                                  07340000
074300     MOVE PC204-SMTHG-PRC-ID                                      07350000
074400                              TO SUT00003-SMTHG-PRC-ID            07360000
074500                                 DK-SMTHG-PRC-IND                 07370000
074600                                                                  07380000
074700     MOVE PC204-PO-NBR        TO DK-PO-NBR                        07390000
074800                                 SUT00003-PO-NBR                  07400000
074900                                 PV-PO-NUMBER                     07410000
075000                                 PV-PO-NBR                        07420000
075100     MOVE PC204-REC-SEQ-NBR   TO DK-REC-SEQ-NBR                   07430000
075200                                 SUT00003-RCVR-SEQ-NBR            07440000
075300                                 PV-RCVR-NBR                      07450000
075400                                 PV-PO-RECEIVER                   07460000
075500     MOVE PC204-STR-NBR       TO DK-STR-NBR                       07470000
075600                                 SUT00003-STR-NBR                 07480000
075700                                 PV-STORE-NBR                     07490000
075800     MOVE PC204-LABELS-NEEDED TO PV-TOT-CRTNS-FOR-STORE           07500000
075900     EVALUATE TRUE                                                07510000
076000        WHEN PC204-INITIAL-SMOOTH                                 07520000
076100             PERFORM 2000-SELECT-LINE-UNITS                       07530000
076200        WHEN PC204-UNLOAD-AND-PRINT                               07540000
076300             PERFORM 6000-GET-LABEL-INFORMATION                   07550000
076400             PERFORM 4000-LABEL-ROUTINE                           07560000
076500        WHEN PC204-RESMOOTH-CRTNS-ADD                             07570000
076600             PERFORM 2000-SELECT-LINE-UNITS                       07580000
076700             SET PS-CREATE-NEW-CRTN-BRCE TO TRUE                  07590000
076800             PERFORM 6000-GET-LABEL-INFORMATION                   07600000
076900             PERFORM 4000-LABEL-ROUTINE                           07610000
077000        WHEN PC204-RESMOOTH-CRTNS-DEL                             07620000
077100             PERFORM 2000-SELECT-LINE-UNITS                       07630000
077200             PERFORM 6005-DATE-TIME                               07640000
077300             PERFORM 7000-SELECT-CRTNS-RESMOOTH                   07650000
077400        WHEN PC204-REPRINT-CTN-LIST                               07660000
077500             SET PS-REPRINT-BATCH  TO TRUE                        07670000
077600             PERFORM 6000-GET-LABEL-INFORMATION                   07680000
077700             PERFORM 4000-LABEL-ROUTINE                           07690000
077800        WHEN PC204-REPRINT-STORE-LIST                             07700000
077900             SET PS-REPRINT-BATCH  TO TRUE                        07710000
078000             PERFORM 6000-GET-LABEL-INFORMATION                   07720000
078100             PERFORM 4000-LABEL-ROUTINE                           07730000
078200     END-EVALUATE.                                                07740000
078300                                                                  07750000
078400                                                                  07760000
078500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07770000
078600 1120-PREPARE-LIST-ENTRY.                                         07780000
078700     MOVE PC206-MAX-ITEMS          TO PV-SEL-SUB.                 07790000
078800     MOVE ZERO                     TO PV-SEL-ITEM                 07800000
078900                                      SUT00024-LBL-PRT-SEQ-NBR.   07810000
079000     PERFORM 1130-GET-NEXT-RECORD.                                07820000
079100                                                                  07830000
079200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07840000
079300*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07850000
079400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07860000
079500 1130-GET-NEXT-RECORD.                                            07870000
079600                                                                  07880000
079700                                                                  07890000
079800     ADD +1                       TO PV-SEL-SUB.                  07900000
079900                                                                  07910000
080000     IF  PV-SEL-SUB > PC206-MAX-ITEMS                             07920000
080100         ADD +1                   TO PV-SEL-ITEM                  07930000
080200         MOVE +1                  TO PV-SEL-SUB                   07940000
080300     END-IF.                                                      07950000
080400                                                                  07960000
080500                                                                  07970000
080600     MOVE LENGTH OF  PC204-INTER-APPL-COMMAREA                    07980000
080700                                      TO PV-READ-LENGTH.          07990000
080800     SET PS-NOT-RPRT-REQST-QUEUE-EOF TO TRUE.                     08000000
080900                                                                  08010000
081000     IF  PV-SEL-ITEM NOT > PC204-NUMBER-OF-TS-ITEMS               08020000
081100     PERFORM UNTIL PS-RPRT-REQST-QUEUE-EOF                        08030000
081200             OR PS-SOCKET-ERROR                                   08040000
081300             OR PV-SEL-SUB > PC204-TOT-LABELS-CNT                 08050000
081400                                                                  08060000
081500             PERFORM 9100-READ-SEL-QUEUE                          08070000
081600                                                                  08080000
081700             MOVE PC206-SHIPT-UNT-ID (PV-SEL-SUB)                 08090000
081800                                  TO PV-SHIPT-UNT-ID-WRK          08100000
081900                                     SUT00028-SHIPT-UNT-ID        08110000
082000             MOVE PV-SHIPT-UNT-ID-WRK                             08120000
082100                                  to PC180-SML-BARCODE            08130000
082200             SET PC206-UPD (PV-SEL-SUB)  TO TRUE                  08140000
082300             PERFORM 9200-REWRITE-SEL-QUEUE                       08150000
082400             ADD +1 TO SUT00024-LBL-PRT-SEQ-NBR                   08160000
082500             PERFORM 4900-CREATE-SML-LABEL                        08170000
082600             ADD +1 TO PV-SEL-SUB                                 08180000
082700     END-PERFORM.                                                 08190000
082800                                                                  08200000
082900/                                                                 08210000
083000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08220000
083100 1140-PREPARE-LIST-ENTRY.                                         08230000
083200     MOVE PC206-MAX-ITEMS          TO PV-SEL-SUB.                 08240000
083300     MOVE ZERO                     TO PV-SEL-ITEM                 08250000
083400                                      SUT00024-LBL-PRT-SEQ-NBR.   08260000
083500     PERFORM 1150-GET-NEXT-RECORD.                                08270000
083600                                                                  08280000
083700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08290000
083800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08300000
083900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08310000
084000 1150-GET-NEXT-RECORD.                                            08320000
084100                                                                  08330000
084200                                                                  08340000
084300     ADD +1                       TO PV-SEL-SUB.                  08350000
084400                                                                  08360000
084500     IF  PV-SEL-SUB > PC206-MAX-ITEMS                             08370000
084600         ADD +1                   TO PV-SEL-ITEM                  08380000
084700         MOVE +1                  TO PV-SEL-SUB                   08390000
084800     END-IF.                                                      08400000
084900                                                                  08410000
085000                                                                  08420000
085100     MOVE LENGTH OF  PC204-INTER-APPL-COMMAREA                    08430000
085200                                      TO PV-READ-LENGTH.          08440000
085300     SET PS-NOT-RPRT-REQST-QUEUE-EOF TO TRUE.                     08450000
085400                                                                  08460000
085500*    IF  PV-SEL-ITEM NOT > PC204-NUMBER-OF-TS-ITEMS               08470000
085600     PERFORM UNTIL PS-RPRT-REQST-QUEUE-EOF                        08480000
085700             OR PV-SEL-SUB > PC204-TOT-STORES-REQ                 08490000
085800             OR PS-SOCKET-ERROR                                   08500000
085900             OR PV-NBR-PROCESSED  >= PC204-TOT-STORES-REQ         08510000
086000                                                                  08520000
086100             PERFORM 9100-READ-SEL-QUEUE                          08530000
086200                                                                  08540000
086300             MOVE PC206-STR-NUMBER(PV-SEL-SUB)                    08550000
086400                                  TO DK-STR-NBR                   08560000
086500                                     PV-STORE-NBR                 08570000
086600             SET PC206-UPD (PV-SEL-SUB)  TO TRUE                  08580000
086700             PERFORM 9200-REWRITE-SEL-QUEUE                       08590000
086710             PERFORM 8000-PROCESS-LABELS-STORE                    08600000
086720             SET PS-PRSNT-MRCH-PGM-CKD-NO TO TRUE                 08610000
086730             ADD +1 TO PV-SEL-SUB                                 08620000
086740             ADD +1 TO PV-NBR-PROCESSED                           08630000
086750* DMH 12/17/01 - BEGIN                                            08640000
086760             IF  PV-SEL-SUB  >  PC206-MAX-ITEMS                   08650000
086770                 ADD +1         TO PV-SEL-ITEM                    08660000
086780                 MOVE +1        TO PV-SEL-SUB                     08670000
086790             END-IF                                               08671000
086800* DMH 12/17/01 - END                                              08672000
086900                                                                  08673000
087000     END-PERFORM.                                                 08674000
087100                                                                  08675000
087200/                                                                 08676000
087300*----------------------------------------------------------------*08677000
087400* SELECT LINE AND UNITS FROM TRECITM AND TRECDIS                  08678000
087500*----------------------------------------------------------------*08679000
087600 2000-SELECT-LINE-UNITS.                                          08680000
087700                                                                  08690000
087800     SET  PS-NOT-EOF-LINE-UNITS-CSR TO TRUE.                      08700000
087900     PERFORM 2010-OPEN-LINE-UNITS-CSR                             08710000
088000     PERFORM 2020-FETCH-LINE-UNITS-CSR                            08720000
088100             UNTIL PS-EOF-LINE-UNITS-CSR OR                       08730000
088200             PS-ERROR                                             08740000
088300*       INITIALIZE  PV-CICS-MSG-AREA                              08750000
088400*       MOVE PV-TOT-INSERTS-BY-STORE TO PV-TOT-INSERTS-BY-STR-D   08760000
088500*       STRING ' PCKCS728 - '            DELIMITED BY SIZE        08770000
088600*              ' STORE '                 DELIMITED BY SIZE        08780000
088700*              PV-STORE-NBR              DELIMITED BY SIZE        08790000
088800*              ' NBR INSERTS '           DELIMITED BY SIZE        08800000
088900*              PV-TOT-INSERTS-BY-STR-D   DELIMITED BY SIZE        08810000
089000*                                    INTO PV-CICS-MSG-AREA        08820000
089100*       MOVE LENGTH OF PV-CICS-MSG-AREA                           08830000
089200*              TO PV-COMMAREA-LENGTH                              08840000
089300*          EXEC CICS                                              08850000
089400*              WRITEQ TD                                          08860000
089500*                  QUEUE   ('CSSL')                               08870000
089600*                  FROM    (PV-CICS-MSG-AREA)                     08880000
089700*                  LENGTH  (PV-COMMAREA-LENGTH)                   08890000
089800*                  RESP    (PV-CICS-RESPONSE)                     08900000
089900*          END-EXEC                                               08910000
090000     PERFORM 2030-CLOSE-LINE-UNITS-CSR.                           08920000
090100                                                                  08930000
090200*----------------------------------------------------------------*08940000
090300* OPEN LABEL CURSOR                                              *08950000
090400*----------------------------------------------------------------*08960000
090401 2010-OPEN-LINE-UNITS-CSR.                                        08970000
090402                                                                  08980000
090403     EXEC SQL                                                     08990000
090404         OPEN LINE_UNITS_CSR                                      09000000
090405     END-EXEC.                                                    09010000
090406                                                                  09020000
090407     EVALUATE TRUE                                                09030000
090408         WHEN SQLCODE = +0                                        09040000
090409              SET PS-NOT-EOF-LINE-UNITS-CSR TO  TRUE              09040100
090410         WHEN SQLCODE  NOT =  +0                                  09040200
090411              INITIALIZE  PV-CICS-MSG-AREA                        09040300
090412              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09040400
090413              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09040500
090414                     '2010-OPEN-LINE-UNITS-CSR' DELIMITED BY SIZE 09040600
090415                     '  SQL - '                 DELIMITED BY SIZE 09040700
090416                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09040800
090417                                           INTO PV-CICS-MSG-AREA  09040900
090418              MOVE LENGTH OF PV-CICS-MSG-AREA                     09041000
090419                     TO PV-COMMAREA-LENGTH                        09041100
090420              PERFORM 9990-WRITE-CICS                             09041200
090421              INITIALIZE  PV-CICS-MSG-AREA                        09041300
090422              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09041400
090423                     ' PO:'                    DELIMITED BY SIZE  09041500
090424                     PV-PO-NBR                 DELIMITED BY SIZE  09041600
090425                     ' RCVR:'                  DELIMITED BY SIZE  09041700
090426                     PV-RCVR-NBR               DELIMITED BY SIZE  09041800
090427                     ' STR:'                   DELIMITED BY SIZE  09041900
090428                     PV-STORE-NBR              DELIMITED BY SIZE  09042000
090429                                           INTO PV-CICS-MSG-AREA  09042100
090430              MOVE LENGTH OF PV-CICS-MSG-AREA                     09042200
090440                     TO PV-COMMAREA-LENGTH                        09042300
090450              PERFORM 9990-WRITE-CICS                             09042400
090460              SET PC204-SQL-ERROR  TO TRUE                        09042500
090470     END-EVALUATE.                                                09042600
090480                                                                  09042700
090490                                                                  09042800
090500                                                                  09042900
090600 2020-FETCH-LINE-UNITS-CSR.                                       09043000
090700                                                                  09044000
090800     MOVE 'CURSOR:  LINE-UNITS-CSR '                              09045000
090900                       TO DP013-MESSAGE-TEXT (1).                 09046000
091000                                                                  09047000
091100     EXEC SQL                                                     09048000
091200          FETCH LINE_UNITS_CSR                                    09049000
091300           INTO :RECITM-ORD-LNE-NBR                               09050000
091400              , :PV-LINE-UNIT-QTY                                 09060000
091500     END-EXEC.                                                    09070000
091600                                                                  09080000
091700     EVALUATE TRUE                                                09090000
091800         WHEN SQLCODE = ZERO                                      09100000
091900              INITIALIZE PV-TOT-INSERTS-BY-LINE                   09110000
092000              IF PV-LINE-UNIT-QTY = 0                             09120000
092100                 CONTINUE                                         09130000
092200              ELSE                                                09140000
092210                 PERFORM 2050-SMOOTH-UNITS-OVR-CRTNS              09150000
092220              END-IF                                              09160000
092230*             MOVE RECITM-ORD-LNE-NBR TO PV-LNE-NBR               09170000
092240*             INITIALIZE  PV-CICS-MSG-AREA                        09180000
092250*             MOVE PV-TOT-INSERTS-BY-LINE                         09190000
092260*                                     TO PV-TOT-INSERTS-BY-LNE-D  09200000
092270*             STRING ' PCKCS728 - '            DELIMITED BY SIZE  09210000
092280*                    ' STORE '                 DELIMITED BY SIZE  09220000
092290*                    PV-STORE-NBR              DELIMITED BY SIZE  09221000
092300*                    ' LINE  '                 DELIMITED BY SIZE  09222000
092400*                    PV-LNE-NBR                DELIMITED BY SIZE  09223000
092500*                    ' NBR INSERTS '           DELIMITED BY SIZE  09224000
092600*                    PV-TOT-INSERTS-BY-LNE-D   DELIMITED BY SIZE  09225000
092700*                                          INTO PV-CICS-MSG-AREA  09226000
092800*                MOVE LENGTH OF PV-CICS-MSG-AREA                  09227000
092900*                       TO PV-COMMAREA-LENGTH                     09228000
093000*                EXEC CICS                                        09229000
093100*                    WRITEQ TD                                    09230000
093200*                        QUEUE   ('CSSL')                         09240000
093300*                        FROM    (PV-CICS-MSG-AREA)               09250000
093400*                        LENGTH  (PV-COMMAREA-LENGTH)             09260000
093500*                        RESP    (PV-CICS-RESPONSE)               09270000
093600*                END-EXEC                                         09280000
093700         WHEN SQLCODE = +100                                      09290000
093800              SET PS-EOF-LINE-UNITS-CSR                           09300000
093900                                   TO TRUE                        09310000
094000         WHEN SQLCODE = -904                                      09320000
094100         WHEN SQLCODE = -911                                      09330000
094101         WHEN SQLCODE = -913                                      09340000
094102         WHEN SQLWARN0 NOT = SPACE                                09350000
094103         WHEN SQLCODE NOT = ZERO                                  09360000
094104              INITIALIZE  PV-CICS-MSG-AREA                        09370000
094105              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09380000
094106              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09390000
094107                     '2020-FETCH-LINE-UNITS '   DELIMITED BY SIZE 09400000
094108                     '  SQL - '                 DELIMITED BY SIZE 09410000
094109                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09410100
094110                                           INTO PV-CICS-MSG-AREA  09410200
094111              MOVE LENGTH OF PV-CICS-MSG-AREA                     09410300
094112                     TO PV-COMMAREA-LENGTH                        09410400
094113              PERFORM 9990-WRITE-CICS                             09410500
094114              INITIALIZE  PV-CICS-MSG-AREA                        09410600
094115              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09410700
094116                     ' PO:'                    DELIMITED BY SIZE  09410800
094117                     PV-PO-NBR                 DELIMITED BY SIZE  09410900
094118                     ' RCVR:'                  DELIMITED BY SIZE  09411000
094119                     PV-RCVR-NBR               DELIMITED BY SIZE  09411100
094120                     ' STR:'                   DELIMITED BY SIZE  09411200
094121                     PV-STORE-NBR              DELIMITED BY SIZE  09411300
094122                                           INTO PV-CICS-MSG-AREA  09411400
094123              MOVE LENGTH OF PV-CICS-MSG-AREA                     09411500
094124                     TO PV-COMMAREA-LENGTH                        09411600
094125              PERFORM 9990-WRITE-CICS                             09411700
094126              SET PC204-SQL-ERROR                                 09411800
094127                  PS-ERROR        TO  TRUE                        09411900
094128     END-EVALUATE.                                                09412000
094129                                                                  09412100
094130*----------------------------------------------------------------*09412200
094131* CLOSE LABEL CURSOR                                             *09412300
094132*----------------------------------------------------------------*09412400
094133 2030-CLOSE-LINE-UNITS-CSR.                                       09412500
094134                                                                  09412600
094135     EXEC SQL                                                     09412700
094136         CLOSE LINE_UNITS_CSR                                     09412800
094137     END-EXEC.                                                    09412900
094138                                                                  09413000
094139     EVALUATE TRUE                                                09413100
094140         WHEN SQLCODE = +0                                        09413200
094150              CONTINUE                                            09413300
094160         WHEN SQLCODE  NOT =  +0                                  09413400
094170              INITIALIZE  PV-CICS-MSG-AREA                        09413500
094180              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09413600
094190              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09413700
094200                     '2030-CLOSE-LINE-UNITS'    DELIMITED BY SIZE 09413800
094300                     '  SQL - '                 DELIMITED BY SIZE 09413900
094400                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09414000
094500                                           INTO PV-CICS-MSG-AREA  09415000
094600              MOVE LENGTH OF PV-CICS-MSG-AREA                     09416000
094700                     TO PV-COMMAREA-LENGTH                        09417000
094800              PERFORM 9990-WRITE-CICS                             09418000
094900              INITIALIZE  PV-CICS-MSG-AREA                        09419000
095000              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09420000
095100                     ' PO:'                    DELIMITED BY SIZE  09430000
095200                     PV-PO-NBR                 DELIMITED BY SIZE  09440000
095300                     ' RCVR:'                  DELIMITED BY SIZE  09450000
095400                     PV-RCVR-NBR               DELIMITED BY SIZE  09460000
095500                     ' STR:'                   DELIMITED BY SIZE  09470000
095600                     PV-STORE-NBR              DELIMITED BY SIZE  09480000
095700                                           INTO PV-CICS-MSG-AREA  09490000
095800              MOVE LENGTH OF PV-CICS-MSG-AREA                     09500000
095900                     TO PV-COMMAREA-LENGTH                        09510000
096000              PERFORM 9990-WRITE-CICS                             09520000
096100              SET PC204-SQL-ERROR                                 09530000
096200                  PS-ERROR         TO TRUE                        09540000
096300     END-EVALUATE.                                                09550000
096400                                                                  09560000
096500                                                                  09570000
096600*----------------------------------------------------------------*09580000
096700 2050-SMOOTH-UNITS-OVR-CRTNS.                                     09590000
096800*----------------------------------------------------------------*09600000
096900                                                                  09610000
097000     INITIALIZE PV-UNITS-PER-CARTON.                              09620000
097100                                                                  09630000
097101        IF PS-FIRST-PROCESS-LINE                                  09640000
097102           MOVE +1 TO  PV-CARTON-NBR                              09650000
097103           SET PS-NOT-FIRST-PROCESS-LINE TO TRUE                  09660000
097104        ELSE                                                      09670000
097105           MOVE PV-SAVE-CARTON-NBR TO PV-CARTON-NBR               09680000
097106        END-IF                                                    09690000
097107                                                                  09700000
097108        SET PS-NOT-ALL-UNTS-ALLOCATED  TO TRUE                    09710000
097109        PERFORM UNTIL PS-ALL-UNTS-ALLOCATED                       09710100
097110               OR PS-ERROR                                        09710200
097111            IF PV-CARTON-NBR > PV-TOT-CRTNS-FOR-STORE             09710300
097112               MOVE +1 TO PV-CARTON-NBR                           09710400
097113            END-IF                                                09710500
097114                                                                  09710600
097115            MOVE 1 TO SUT00003-UNT-QTY                            09710700
097116            ADD +1 TO  PV-TOTAL-UNITS-ALLOCATED                   09710800
097117            IF PV-TOTAL-UNITS-ALLOCATED = PV-LINE-UNIT-QTY        09710900
097118               SET PS-ALL-UNTS-ALLOCATED TO TRUE                  09711000
097119            END-IF                                                09711100
097120                                                                  09711200
097121            PERFORM 2070-INSERT-SMOOTHING-TBL                     09711300
097122            ADD +1 TO PV-CARTON-NBR                               09711400
097123        END-PERFORM                                               09711500
097124        MOVE PV-CARTON-NBR  TO PV-SAVE-CARTON-NBR.                09711600
097125        MOVE +0   TO PV-TOTAL-UNITS-ALLOCATED.                    09711700
097126                                                                  09711800
097127******************************************************************09711900
097128 2070-INSERT-SMOOTHING-TBL.                                       09712000
097129******************************************************************09712100
097130                                                                  09712200
097131     MOVE RECITM-ORD-LNE-NBR TO SUT00003-PO-LNE-NBR.              09712300
097132     MOVE PV-CARTON-NBR      TO SUT00003-CART-NBR.                09712400
097133                                                                  09712500
097134                                                                  09712600
097135     EXEC SQL                                                     09712700
097136         INSERT INTO SUT_SMOOTHING_PRC                            09712800
097137               (SMTHG_PRC_ID                                      09712900
097138              , PO_NBR                                            09713000
097139              , RCVR_SEQ_NBR                                      09713100
097140              , PO_LNE_NBR                                        09713200
097141              , STR_NBR                                           09713300
097142              , CART_NBR                                          09713400
097143              , UNT_QTY                                           09713500
097144              , CRE_USR_ID                                        09713600
097145              , CRE_TMST )                                        09713700
097146         VALUES                                                   09713800
097147              (:SUT00003-SMTHG-PRC-ID                             09713900
097148             , :SUT00003-PO-NBR                                   09714000
097149             , :SUT00003-RCVR-SEQ-NBR                             09714100
097150             , :SUT00003-PO-LNE-NBR                               09714200
097151             , :SUT00003-STR-NBR                                  09714300
097152             , :SUT00003-CART-NBR                                 09714400
097153             , :SUT00003-UNT-QTY                                  09714500
097154             , :SUT00003-CRE-USR-ID                               09714600
097155             ,  CURRENT TIMESTAMP)                                09714700
097156     END-EXEC.                                                    09714800
097157                                                                  09714900
097158     EVALUATE TRUE                                                09715000
097159         WHEN SQLCODE = ZERO                                      09715100
097160              ADD +1 TO PV-TOT-INSERTS-BY-STORE                   09715200
097161                        PV-TOT-INSERTS-BY-LINE                    09715300
097162         WHEN SQLWARN0 NOT = SPACES                               09715400
097163         WHEN SQLCODE NOT EQUAL ZERO                              09715500
097164              INITIALIZE  PV-CICS-MSG-AREA                        09715600
097165              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09715700
097166              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09715800
097167                    '2070-INSERT-SMOOTHING-TBL' DELIMITED BY SIZE 09715900
097168                     '  SQL - '                 DELIMITED BY SIZE 09716000
097169                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09716100
097170                                           INTO PV-CICS-MSG-AREA  09716200
097171              MOVE LENGTH OF PV-CICS-MSG-AREA                     09716300
097172                     TO PV-COMMAREA-LENGTH                        09716400
097173              PERFORM 9990-WRITE-CICS                             09716500
097174              INITIALIZE  PV-CICS-MSG-AREA                        09716600
097175              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09716700
097176                     ' PO:'                    DELIMITED BY SIZE  09716800
097177                     PV-PO-NBR                 DELIMITED BY SIZE  09716900
097178                     ' RCVR:'                  DELIMITED BY SIZE  09717000
097179                     PV-RCVR-NBR               DELIMITED BY SIZE  09717100
097180                     ' STR:'                   DELIMITED BY SIZE  09717200
097181                     PV-STORE-NBR              DELIMITED BY SIZE  09717300
097182                                           INTO PV-CICS-MSG-AREA  09717400
097183              MOVE LENGTH OF PV-CICS-MSG-AREA                     09717500
097184                     TO PV-COMMAREA-LENGTH                        09717600
097185              PERFORM 9990-WRITE-CICS                             09717700
097186              SET PC204-SQL-ERROR                                 09717800
097187                  PS-ERROR         TO TRUE                        09717900
097188     END-EVALUATE.                                                09718000
097189                                                                  09718100
097190******************************************************************09718200
097191 2300-DETERMINE-STORE-ITEMS.                                      09718300
097192                                                                  09718400
097193      SET PS-NOT-EO-STORE-ITEMS-CSR TO TRUE                       09718500
097194                                                                  09718600
097195      PERFORM 2350-OPEN-STORE-ITEMS-CSR                           09718700
097196      PERFORM 2400-FETCH-STORE-ITEMS-CSR                          09718800
097197        UNTIL PS-EO-STORE-ITEMS-CSR OR                            09718900
097198              PS-ERROR                                            09719000
097199      PERFORM 2450-CLOSE-STORE-ITEMS-CSR.                         09719100
097200                                                                  09719200
097210******************************************************************09719300
097211 2350-OPEN-STORE-ITEMS-CSR.                                       09719400
097212                                                                  09719500
097213         EXEC SQL                                                 09719600
097214              OPEN STORE_ITEM_CSR                                 09719700
097215         END-EXEC                                                 09719800
097216                                                                  09719900
097217                                                                  09720000
097218         EVALUATE TRUE                                            09721000
097219             WHEN SQLCODE = ZERO                                  09721100
097220                 CONTINUE                                         09721200
097221             WHEN SQLWARN0 NOT = SPACES                           09721300
097222             WHEN SQLCODE < ZERO                                  09721400
097223             WHEN SQLCODE > ZERO                                  09721500
097224              INITIALIZE  PV-CICS-MSG-AREA                        09721600
097225              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09721700
097226              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09721800
097227                     '2350-OPEN-STORE-ITEMS-CSR' DELIMITED BY SIZE09721900
097228                     '  SQL - '                 DELIMITED BY SIZE 09722000
097229                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09722100
097230                                           INTO PV-CICS-MSG-AREA  09722200
097231              MOVE LENGTH OF PV-CICS-MSG-AREA                     09722300
097232                     TO PV-COMMAREA-LENGTH                        09722400
097233              PERFORM 9990-WRITE-CICS                             09722500
097234              INITIALIZE  PV-CICS-MSG-AREA                        09722600
097235              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09722700
097236                     ' PO:'                    DELIMITED BY SIZE  09722800
097237                     PV-PO-NBR                 DELIMITED BY SIZE  09722900
097238                     ' RCVR:'                  DELIMITED BY SIZE  09723000
097239                     PV-RCVR-NBR               DELIMITED BY SIZE  09723100
097240                     ' STR:'                   DELIMITED BY SIZE  09723200
097241                     PV-STORE-NBR              DELIMITED BY SIZE  09723300
097242                                           INTO PV-CICS-MSG-AREA  09723400
097243              MOVE LENGTH OF PV-CICS-MSG-AREA                     09723500
097244                     TO PV-COMMAREA-LENGTH                        09723600
097245              PERFORM 9990-WRITE-CICS                             09723700
097246              SET PC204-SQL-ERROR                                 09723800
097247                  PS-ERROR  TO TRUE                               09723900
097248         END-EVALUATE.                                            09724000
097249                                                                  09724100
097250 EJECT                                                            09724200
097251*----------------------------------------------------------------*09724300
097252*                                                                *09724400
097253*----------------------------------------------------------------*09724500
097254 2400-FETCH-STORE-ITEMS-CSR.                                      09724600
097255                                                                  09724700
097256                                                                  09724800
097257     EXEC SQL                                                     09724900
097258        FETCH   STORE_ITEM_CSR                                    09725000
097259        INTO   :RECITM-ITM-NBR                                    09725100
097260     END-EXEC.                                                    09725200
097261                                                                  09725300
097262     EVALUATE TRUE                                                09725400
097263       WHEN SQLCODE = ZEROS                                       09725500
097264            PERFORM 6680-CALL-XLKUT001                            09725600
097265                                                                  09725700
097266            IF PS-PRESENTATION-FOUND-NO                           09725800
097267               EVALUATE TRUE                                      09725900
097268                 WHEN PV-HANG-FOLD-IND = 'H'                      09726000
097269                    MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR                09726100
097270                    SET PS-PRESENTATION-FOUND-YES TO TRUE         09726200
097271                 WHEN PV-HANG-FOLD-IND = 'F'                      09726300
097272                    MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR                09726400
097273                    SET PS-PRESENTATION-FOUND-YES TO TRUE         09726500
097274                 WHEN OTHER                                       09726600
097275                    MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                09726700
097276               END-EVALUATE                                       09726800
097277            END-IF                                                09726900
097278                                                                  09727000
      *CLP 06/24/2015 START                                             09727102
097279            IF PS-BRAND-FOUND-NO                                  09727202
097280               PERFORM 6700-CHECK-BRAND                           09727302
097281            END-IF                                                09727400
      *CLP 06/24/2015 END                                               09727502
097282                                                                  09727600
097283            IF PS-PRESENTATION-FOUND-YES AND                      09727700
097284               PS-BRAND-FOUND-YES                                 09727802
097285                 SET  PS-EO-STORE-ITEMS-CSR TO TRUE               09727900
097286            END-IF                                                09728000
097287                                                                  09728100
097288       WHEN SQLCODE = +100                                        09728200
097289                SET  PS-EO-STORE-ITEMS-CSR TO TRUE                09728300
097290       WHEN OTHER                                                 09728400
097291              INITIALIZE  PV-CICS-MSG-AREA                        09728500
097292              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09728600
097293              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09728700
097294                   '2400-FETCH-STORE-ITEMS-CSR' DELIMITED BY SIZE 09728800
097295                     '  SQL - '                 DELIMITED BY SIZE 09728900
097296                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09729000
097297                                           INTO PV-CICS-MSG-AREA  09729100
097298              MOVE LENGTH OF PV-CICS-MSG-AREA                     09729200
097299                     TO PV-COMMAREA-LENGTH                        09729300
097300              PERFORM 9990-WRITE-CICS                             09729400
097301              INITIALIZE  PV-CICS-MSG-AREA                        09729500
097302              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09729600
097303                     ' PO:'                    DELIMITED BY SIZE  09729700
097304                     PV-PO-NBR                 DELIMITED BY SIZE  09729800
097305                     ' RCVR:'                  DELIMITED BY SIZE  09729900
097306                     PV-RCVR-NBR               DELIMITED BY SIZE  09730000
097307                     ' STR:'                   DELIMITED BY SIZE  09730100
097308                     PV-STORE-NBR              DELIMITED BY SIZE  09730200
097309                                           INTO PV-CICS-MSG-AREA  09730300
097310              MOVE LENGTH OF PV-CICS-MSG-AREA                     09730400
097311                     TO PV-COMMAREA-LENGTH                        09730500
097312              PERFORM 9990-WRITE-CICS                             09730600
097313              SET PC204-SQL-ERROR                                 09730700
097314                  PS-ERROR         TO TRUE                        09730800
097315     END-EVALUATE.                                                09730900
097316                                                                  09731000
097317                                                                  09731100
097318 2450-CLOSE-STORE-ITEMS-CSR.                                      09731200
097319                                                                  09731300
097320         EXEC SQL                                                 09731400
097321             CLOSE STORE_ITEM_CSR                                 09731500
097322         END-EXEC                                                 09731600
097323                                                                  09731700
097324                                                                  09731800
097325         EVALUATE TRUE                                            09731900
097326             WHEN SQLCODE = ZERO                                  09732000
097327                 CONTINUE                                         09732100
097328             WHEN SQLWARN0 NOT = SPACES                           09732200
097329             WHEN SQLCODE < ZERO                                  09732300
097330             WHEN SQLCODE > ZERO                                  09732400
097331              INITIALIZE  PV-CICS-MSG-AREA                        09732500
097332              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09732600
097333              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09732700
097334                   '2450-CLOSE-STORE-ITEMS-CSR' DELIMITED BY SIZE 09732800
097335                     '  SQL - '                 DELIMITED BY SIZE 09732900
097336                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09733000
097337                                           INTO PV-CICS-MSG-AREA  09733100
097338              MOVE LENGTH OF PV-CICS-MSG-AREA                     09733200
097339                     TO PV-COMMAREA-LENGTH                        09733300
097340              PERFORM 9990-WRITE-CICS                             09733400
097341              SET PC204-SQL-ERROR                                 09733500
097342                  PS-ERROR  TO TRUE                               09733600
097343         END-EVALUATE.                                            09733700
097344                                                                  09733800
097345                                                                  09733900
097346*----------------------------------------------------------------*09734000
097347 2800-CALL-STORE-ON-HAND-MOD.                                     09734100
097348     INITIALIZE XL088-ITEM-COMMAREA.                              09734200
097349     SET  XL088-ONHAND-YES  TO TRUE                               09734300
097350     MOVE PC-CURRENT-PROGRAM-NAME TO XL088-CALLING-PROGRAM        09734400
097351     MOVE PC204-PO-NBR      TO XL088-KEY-PO                       09734500
097352     MOVE PC204-REC-SEQ-NBR TO XL088-KEY-REC-SEQ-NBR              09734600
097353     MOVE PV-STORE-NBR      TO XL088-KEY-STR-NBR                  09734700
097354     MOVE PC204-OPER-UNT-ID TO XL088-OPER-UNT-ID                  09734800
097355     MOVE PC180-SML-BARCODE TO XL088-OTBND-CRTN                   09734900
097356     SET XL088-BY-OTBND-CRTN TO TRUE                              09735000
097357                                                                  09735100
097358     CALL XL088-USER-PGM USING DFHEIBLK                           09735200
097359                               XL088-COMMAREA                     09735300
097360                               XL088-ITEM-COMMAREA.               09735400
097361     EVALUATE TRUE                                                09735500
097362                                                                  09735600
097363       WHEN XL088-SUCCESSFUL                                      09735700
097364         IF XL088-PROCESS-MSG-YES                                 09735800
097365            SET PC255-OH-ZERO-YES TO TRUE                         09735900
097366            MOVE XL088-PROCESS-MESSAGE-TXT                        09736000
097367                            TO PC256-ON-HAND-ERR-MSG              09736100
097368            IF XL088-FIRST-STORE-RCPT                             09736200
097369               MOVE PV-FIRST-STORE-RCPT-TXT-1 TO PC256-TEXT-1     09736300
097370               MOVE PV-FIRST-STORE-RCPT-TXT-2 TO PC256-TEXT-2     09736400
097371               MOVE PV-FIRST-STORE-RCPT-TXT-3 TO PC256-TEXT-3     09736500
097372               SET PC256-TEXT-4-NO            TO TRUE             09736600
097373            ELSE                                                  09736700
097374               SET PC256-TEXT-1-NO                                09736800
097375                   PC256-TEXT-2-NO                                09736900
097376                   PC256-TEXT-3-NO                                09737000
097377                   PC256-TEXT-4-NO            TO TRUE             09737100
097378            END-IF                                                09737200
097379         ELSE                                                     09737300
097380            SET PC255-OH-ZERO-NO                                  09737400
097381                PC256-OH-ZERO-MSG-NO                              09737500
097382                PC256-TEXT-1-NO                                   09737600
097383                PC256-TEXT-2-NO                                   09737700
097384                PC256-TEXT-3-NO                                   09737800
097385                PC256-TEXT-4-NO            TO TRUE                09737900
097386         END-IF                                                   09738000
097387       WHEN OTHER                                                 09738100
097388         INITIALIZE  PV-CICS-MSG-AREA                             09738200
097389         MOVE XL088-RETURN-SQLCODE TO PV-SQL-RETURN-CD            09738300
097390         STRING ' PCKCS728 - '           DELIMITED BY SIZE        09738400
097391               '2800-CALL-STORE-ON-HAND-MOD'                      09738500
097392                                         DELIMITED BY SIZE        09738600
097393                '  SQL - '               DELIMITED BY SIZE        09738700
097394                PV-SQL-RETURN-CD         DELIMITED BY SIZE        09738800
097395                                   INTO PV-CICS-MSG-AREA          09738900
097396         MOVE LENGTH OF PV-CICS-MSG-AREA                          09739000
097397                TO PV-COMMAREA-LENGTH                             09739100
097398         PERFORM 9990-WRITE-CICS                                  09739200
097399         INITIALIZE  PV-CICS-MSG-AREA                             09739300
097400         STRING ' PCKCS728 -'          DELIMITED BY SIZE          09739400
097401                ' PO:'                 DELIMITED BY SIZE          09739500
097402                PV-PO-NBR              DELIMITED BY SIZE          09739600
097403                ' RCVR:'               DELIMITED BY SIZE          09739700
097404                PV-RCVR-NBR            DELIMITED BY SIZE          09739800
097405                ' STR:'                DELIMITED BY SIZE          09739900
097406                PV-STORE-NBR           DELIMITED BY SIZE          09740000
097407                                   INTO PV-CICS-MSG-AREA          09740100
097408         MOVE LENGTH OF PV-CICS-MSG-AREA                          09740200
097409                TO PV-COMMAREA-LENGTH                             09740300
097410         PERFORM 9990-WRITE-CICS                                  09740400
097411         SET PC204-SQL-ERROR                                      09740500
097412             PS-ERROR         TO TRUE                             09740600
097413     END-EVALUATE.                                                09740700
097414                                                                  09740800
097415*----------------------------------------------------------------*09740900
097416* SELECT LINE AND UNITS FROM TRECITM AND TRECDIS                  09741000
097417*----------------------------------------------------------------*09741100
097418 3000-SELECT-CARTONS-LINES.                                       09741200
097419     SET  PS-NOT-EOF-SMTHNG-PRC-CSR TO TRUE.                      09741300
097420     MOVE +1 TO SUT00024-LBL-PRT-SEQ-NBR.                         09741400
097421     PERFORM 3010-OPEN-SMTHG-PROCESS-CSR                          09741500
097422                                                                  09741600
097423*INITIAL FETCH                                                    09741700
097424     PERFORM 3020-FETCH-SMTHG-PROCESS-CSR                         09741800
097425*                                                                 09741900
097426*    IF PS-NO-ERROR                                               09742000
097427       PERFORM UNTIL PS-EOF-SMTHNG-PRC-CSR                        09742100
097428               OR PS-ERROR                                        09742200
097429         MOVE SUT00003-STR-NBR TO PV-SAVE-STORE                   09742300
097430         PERFORM 3600-SELECT-MAX-CTN-NBR                          09742400
097431         PERFORM 3700-GET-MANIFEST-NBR                            09742500
097432                                                                  09742600
097433         SET PC180-SML-INTERNAL-LBL                               09742700
097434             PC180-SML-FROM-KOHLS  TO  TRUE                       09742800
097435                                                                  09742900
097436         PERFORM UNTIL SUT00003-STR-NBR NOT EQUAL PV-SAVE-STORE   09743000
097437              OR PS-EOF-SMTHNG-PRC-CSR                            09743100
097438              OR PS-ERROR                                         09743200
097439                 MOVE SUT00003-CART-NBR TO PV-SAVE-CARTON-NBR     09743300
097440                 PERFORM 3800-INSERT-OTBND-CART                   09743400
097441                 PERFORM 3900-INSERT-TSULBXF                      09743500
097442                 PERFORM UNTIL ((SUT00003-CART-NBR NOT EQUAL      09743600
097443                              PV-SAVE-CARTON-NBR) OR              09743700
097444                                (SUT00003-STR-NBR NOT EQUAL       09743800
097445                                 PV-SAVE-STORE )  OR              09743900
097446                                 PS-EOF-SMTHNG-PRC-CSR) OR        09744000
097447                                 PS-ERROR                         09744100
097448                    PERFORM 3500-SELECT-UPC-NBRS                  09744200
097449                    PERFORM 3850-INSERT-OTBND-UPC                 09744300
097450                    PERFORM 3020-FETCH-SMTHG-PROCESS-CSR          09744400
097451                 END-PERFORM                                      09744500
097452                 PERFORM 4900-CREATE-SML-LABEL                    09744600
097453                 ADD +1 TO  PC180-SML-MNFST-NBR                   09744700
097454                 ADD +1 TO  SUT00024-LBL-PRT-SEQ-NBR              09744800
097455         END-PERFORM                                              09744900
097456       END-PERFORM                                                09745000
097457     PERFORM 3030-CLOSE-SMTHG-PROCESS-CSR.                        09745100
097458                                                                  09745200
097459*----------------------------------------------------------------*09745300
097460* OPEN SMOOTHING CURSOR                                          *09745400
097470*----------------------------------------------------------------*09745500
097480 3010-OPEN-SMTHG-PROCESS-CSR.                                     09745600
097490                                                                  09745700
097500     EXEC SQL                                                     09745800
097600         OPEN SMTHG_PROCESS_CSR                                   09745900
097700     END-EXEC.                                                    09746000
097701                                                                  09746100
097702     EVALUATE TRUE                                                09746200
097703         WHEN SQLCODE = +0                                        09747000
097704              SET PS-NOT-EOF-SMTHNG-PRC-CSR     TO  TRUE          09748000
097705         WHEN SQLCODE  NOT =  +0                                  09749000
097706              INITIALIZE  PV-CICS-MSG-AREA                        09750000
097707              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09760000
097708              STRING ' PCKCS728 - '             DELIMITED BY SIZE 09770000
097709                     '3010-OPEN-SMTHG-PROCESS'  DELIMITED BY SIZE 09770100
097710                     '  SQL - '                 DELIMITED BY SIZE 09770200
097720                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 09770300
097730                                           INTO PV-CICS-MSG-AREA  09770400
097740              MOVE LENGTH OF PV-CICS-MSG-AREA                     09770500
097750                     TO PV-COMMAREA-LENGTH                        09770600
097760              PERFORM 9990-WRITE-CICS                             09770700
097770              INITIALIZE  PV-CICS-MSG-AREA                        09770800
097780              STRING ' PCKCS728 -'             DELIMITED BY SIZE  09770900
097790                     ' PO:'                    DELIMITED BY SIZE  09771000
097800                     PV-PO-NBR                 DELIMITED BY SIZE  09772000
097900                     ' RCVR:'                  DELIMITED BY SIZE  09773000
098000                     PV-RCVR-NBR               DELIMITED BY SIZE  09774000
098100                     ' STR:'                   DELIMITED BY SIZE  09775000
098200                     PV-STORE-NBR              DELIMITED BY SIZE  09776000
098300                                           INTO PV-CICS-MSG-AREA  09777000
098400              MOVE LENGTH OF PV-CICS-MSG-AREA                     09778000
098500                     TO PV-COMMAREA-LENGTH                        09779000
098600              PERFORM 9990-WRITE-CICS                             09780000
098700              SET PC204-SQL-ERROR                                 09790000
098800                  PS-ERROR         TO TRUE                        09800000
098900     END-EVALUATE.                                                09810000
099000                                                                  09820000
099100                                                                  09830000
099200                                                                  09840000
099300                                                                  09850000
099400 3020-FETCH-SMTHG-PROCESS-CSR.                                    09860000
099500                                                                  09870000
099600     MOVE 'CURSOR: SMTHG_PROCESS_CSR'                             09880000
099700                       TO DP013-MESSAGE-TEXT (1).                 09890000
099710                                                                  09900000
099720     EXEC SQL                                                     09910000
099730          FETCH SMTHG_PROCESS_CSR                                 09920000
099740           INTO  :SUT00003-CART-NBR                               09930000
099750                ,:SUT00003-PO-LNE-NBR                             09940000
099760                ,:SUT00003-UNT-QTY                                09950000
099770                ,:SUT00003-STR-NBR                                09960000
099780     END-EXEC.                                                    09970000
099790                                                                  09971000
099800     EVALUATE TRUE                                                09972000
099900         WHEN SQLCODE = ZERO                                      09973000
100000              CONTINUE                                            09974000
100100         WHEN SQLCODE = +100                                      09975000
100110              SET PS-EOF-SMTHNG-PRC-CSR                           09976000
100120                                   TO TRUE                        09977000
100130         WHEN SQLCODE = -904                                      09978000
100140         WHEN SQLCODE = -911                                      09979000
100150         WHEN SQLCODE = -913                                      09980000
100160         WHEN SQLWARN0 NOT = SPACE                                09990000
100170         WHEN SQLCODE NOT = ZERO                                  10000000
100180              INITIALIZE  PV-CICS-MSG-AREA                        10010000
100190              MOVE SQLCODE             TO PV-SQL-RETURN-CD        10011000
100200              STRING ' PCKCS728 - '             DELIMITED BY SIZE 10012000
100300                     '3020-FETCH-SMTHG-PROCESS' DELIMITED BY SIZE 10013000
100400                     '  SQL - '                 DELIMITED BY SIZE 10014000
100500                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 10015000
100600                                           INTO PV-CICS-MSG-AREA  10016000
100700              MOVE LENGTH OF PV-CICS-MSG-AREA                     10017000
100800                     TO PV-COMMAREA-LENGTH                        10018000
100900              PERFORM 9990-WRITE-CICS                             10019000
101000              INITIALIZE  PV-CICS-MSG-AREA                        10020000
101100              STRING ' PCKCS728 -'             DELIMITED BY SIZE  10030000
101200                     ' PO:'                    DELIMITED BY SIZE  10040000
101300                     PV-PO-NBR                 DELIMITED BY SIZE  10050000
101400                     ' RCVR:'                  DELIMITED BY SIZE  10060000
101500                     PV-RCVR-NBR               DELIMITED BY SIZE  10070000
101600                     ' STR:'                   DELIMITED BY SIZE  10080000
101700                     PV-STORE-NBR              DELIMITED BY SIZE  10090000
101800                                           INTO PV-CICS-MSG-AREA  10100000
101900              MOVE LENGTH OF PV-CICS-MSG-AREA                     10110000
102000                     TO PV-COMMAREA-LENGTH                        10120000
102100              PERFORM 9990-WRITE-CICS                             10130000
102200              SET PC204-SQL-ERROR                                 10140000
102300                  PS-ERROR         TO TRUE                        10150000
102400     END-EVALUATE.                                                10160000
102500                                                                  10170000
102600*----------------------------------------------------------------*10180000
102700* CLOSE SMOOTHING CURSOR                                         *10190000
102800*----------------------------------------------------------------*10200000
102900 3030-CLOSE-SMTHG-PROCESS-CSR.                                    10210000
103000                                                                  10220000
103100     EXEC SQL                                                     10230000
103200        CLOSE SMTHG_PROCESS_CSR                                   10240000
103300     END-EXEC.                                                    10250000
103400                                                                  10260000
103500     EVALUATE TRUE                                                10270000
103600         WHEN SQLCODE = +0                                        10280000
103700              SET PS-NOT-EOF-LINE-UNITS-CSR TO  TRUE              10290000
103800         WHEN SQLCODE  NOT =  +0                                  10300000
103900              INITIALIZE  PV-CICS-MSG-AREA                        10310000
104000              MOVE SQLCODE             TO PV-SQL-RETURN-CD        10320000
104100              STRING ' PCKCS728 - '             DELIMITED BY SIZE 10330000
104200                     '3030-CLOSE-SMTHG-PROCESS' DELIMITED BY SIZE 10340000
104300                     '  SQL - '                 DELIMITED BY SIZE 10350000
104400                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 10360000
104500                                           INTO PV-CICS-MSG-AREA  10370000
104600              MOVE LENGTH OF PV-CICS-MSG-AREA                     10380000
104700                     TO PV-COMMAREA-LENGTH                        10390000
104800              PERFORM 9990-WRITE-CICS                             10400000
104900              INITIALIZE  PV-CICS-MSG-AREA                        10410000
105000              STRING ' PCKCS728 -'             DELIMITED BY SIZE  10420000
105100                     ' PO:'                    DELIMITED BY SIZE  10430000
105200                     PV-PO-NBR                 DELIMITED BY SIZE  10440000
105300                     ' RCVR:'                  DELIMITED BY SIZE  10450000
105400                     PV-RCVR-NBR               DELIMITED BY SIZE  10460000
105500                     ' STR:'                   DELIMITED BY SIZE  10470000
105600                     PV-STORE-NBR              DELIMITED BY SIZE  10480000
105700                                           INTO PV-CICS-MSG-AREA  10490000
105800              MOVE LENGTH OF PV-CICS-MSG-AREA                     10500000
105900                     TO PV-COMMAREA-LENGTH                        10510000
106000              PERFORM 9990-WRITE-CICS                             10520000
106100              SET PC204-SQL-ERROR                                 10530000
106200                  PS-ERROR         TO TRUE                        10540000
106300     END-EVALUATE.                                                10550000
106400                                                                  10560000
106500                                                                  10570000
106600                                                                  10580000
106700*----------------------------------------------------------------*10590000
106800*----------------------------------------------------------------*10600000
106900 3500-SELECT-UPC-NBRS.                                            10610000
107000                                                                  10620000
107100     EXEC SQL                                                     10630000
107200          SELECT A.ITM_NBR                                        10640000
107300          INTO  :PURITM-ITM-NBR                                   10650000
107400          FROM   TPURITM A                                        10660000
107500          WHERE  A.PO_NBR         = :DK-PO-NBR                    10670000
107600            AND  A.APP_PO_LNE_NBR = :SUT00003-PO-LNE-NBR          10680000
107700            AND  A.VER_STATUS_CDE = 'A'                           10690000
107800     END-EXEC.                                                    10700000
107900                                                                  10710000
108000     EVALUATE TRUE                                                10720000
108100         WHEN SQLCODE = ZERO                                      10730000
108200             PERFORM 3510-CALL-XLKUT-DOMAIN                       10740000
108300         WHEN OTHER                                               10750000
108400              INITIALIZE  PV-CICS-MSG-AREA                        10760000
108500              MOVE SQLCODE             TO PV-SQL-RETURN-CD        10770000
108600              STRING ' PCKCS728 - '             DELIMITED BY SIZE 10780000
108700                     '3500-SELECT-UPC-NBRS'    DELIMITED BY SIZE  10790000
108800                     '  SQL - '                 DELIMITED BY SIZE 10800000
108900                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 10810000
109000                                           INTO PV-CICS-MSG-AREA  10820000
109100              MOVE LENGTH OF PV-CICS-MSG-AREA                     10830000
109200                     TO PV-COMMAREA-LENGTH                        10840000
109300              PERFORM 9990-WRITE-CICS                             10850000
109400              INITIALIZE  PV-CICS-MSG-AREA                        10860000
109500              STRING ' PCKCS728 -'             DELIMITED BY SIZE  10870000
109600                     ' PO:'                    DELIMITED BY SIZE  10880000
109700                     PV-PO-NBR                 DELIMITED BY SIZE  10890000
109800                     ' RCVR:'                  DELIMITED BY SIZE  10900000
109900                     PV-RCVR-NBR               DELIMITED BY SIZE  10910000
110000                     ' STR:'                   DELIMITED BY SIZE  10920000
110100                     PV-STORE-NBR              DELIMITED BY SIZE  10930000
110200                                           INTO PV-CICS-MSG-AREA  10940000
110300              MOVE LENGTH OF PV-CICS-MSG-AREA                     10950000
110400                     TO PV-COMMAREA-LENGTH                        10960000
110500              PERFORM 9990-WRITE-CICS                             10970000
110600              SET PC204-SQL-ERROR                                 10980000
110700                  PS-ERROR         TO TRUE                        10990000
110800     END-EVALUATE.                                                11000000
110900                                                                  11010000
111000 3510-CALL-XLKUT-DOMAIN.                                          11020000
111100     INITIALIZE XL001-ITEM-COMMAREA.                              11030000
111200                                                                  11040000
111300     MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             11050000
111400     MOVE  'V'                  TO XL001-KEY-UPC-TYP-CDE.         11060000
111500                                                                  11070000
111600     SET  XL001-BY-ITEM                                           11080000
111700          XL001-SELECT-UPC      TO TRUE                           11090000
111800                                                                  11100000
111900     CALL XL001-VSM-PGM USING  DFHEIBLK                           11110000
112000                               XL001-COMMAREA                     11120000
112100                               XL001-ITEM-COMMAREA.               11130000
112200     EVALUATE TRUE                                                11140000
112300                                                                  11150000
112400         WHEN XL001-SUCCESSFUL                                    11160000
112500         WHEN XL001-UPC-SQLCODE = -811                            11170000
112600             MOVE XL001-UPC-NBR TO SUT00028-UPC-NBR               11180000
112700         WHEN XL001-SQL-ERROR                                     11190000
112800            IF XL001-UPC-SQLCODE = +100                           11200000
112900               PERFORM 3515-CALL-XLKUT-DOMAIN-INT                 11210000
113000            ELSE                                                  11220000
113100                INITIALIZE  PV-CICS-MSG-AREA                      11230000
113200                MOVE SQLCODE             TO PV-SQL-RETURN-CD      11240000
113300                STRING ' PCKCS728 - '           DELIMITED BY SIZE 11250000
113400                       '3510-CALL-XLKUT-DOMAIN' DELIMITED BY SIZE 11260000
113500                       '  SQL - '               DELIMITED BY SIZE 11270000
113600                       PV-SQL-RETURN-CD         DELIMITED BY SIZE 11280000
113700                                          INTO PV-CICS-MSG-AREA   11290000
113800                MOVE LENGTH OF PV-CICS-MSG-AREA                   11300000
113900                       TO PV-COMMAREA-LENGTH                      11310000
114000                PERFORM 9990-WRITE-CICS                           11320000
114100                INITIALIZE  PV-CICS-MSG-AREA                      11330000
114200                STRING ' PCKCS728 -'          DELIMITED BY SIZE   11340000
114300                       ' PO:'                 DELIMITED BY SIZE   11350000
114400                       PV-PO-NBR              DELIMITED BY SIZE   11360000
114500                       ' RCVR:'               DELIMITED BY SIZE   11370000
114600                       PV-RCVR-NBR            DELIMITED BY SIZE   11380000
114700                       ' STR:'                DELIMITED BY SIZE   11390000
114800                       PV-STORE-NBR           DELIMITED BY SIZE   11400000
114900                                          INTO PV-CICS-MSG-AREA   11410000
115000                MOVE LENGTH OF PV-CICS-MSG-AREA                   11420000
115100                       TO PV-COMMAREA-LENGTH                      11430000
115200                PERFORM 9990-WRITE-CICS                           11440000
115300                SET PC204-SQL-ERROR                               11450000
115400                    PS-ERROR         TO TRUE                      11460000
115500                                                                  11470000
115600            END-IF                                                11480000
115700       WHEN OTHER                                                 11490000
115800            INITIALIZE  PV-CICS-MSG-AREA                          11500000
115900            MOVE SQLCODE             TO PV-SQL-RETURN-CD          11510000
116000            STRING ' PCKCS728 - '             DELIMITED BY SIZE   11520000
116100                   '3510-CALL-XLKUT-DOMAIN'  DELIMITED BY SIZE    11530000
116200                   '  SQL - '                 DELIMITED BY SIZE   11540000
116300                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   11550000
116400                                         INTO PV-CICS-MSG-AREA    11560000
116500            MOVE LENGTH OF PV-CICS-MSG-AREA                       11570000
116600                   TO PV-COMMAREA-LENGTH                          11580000
116700            PERFORM 9990-WRITE-CICS                               11590000
116800            INITIALIZE  PV-CICS-MSG-AREA                          11600000
116900            STRING ' PCKCS728 -'             DELIMITED BY SIZE    11610000
117000                   ' PO:'                    DELIMITED BY SIZE    11620000
117100                   PV-PO-NBR                 DELIMITED BY SIZE    11630000
117200                   ' RCVR:'                  DELIMITED BY SIZE    11640000
117300                   PV-RCVR-NBR               DELIMITED BY SIZE    11650000
117400                   ' STR:'                   DELIMITED BY SIZE    11660000
117500                   PV-STORE-NBR              DELIMITED BY SIZE    11670000
117600                                         INTO PV-CICS-MSG-AREA    11680000
117700            MOVE LENGTH OF PV-CICS-MSG-AREA                       11690000
117800                   TO PV-COMMAREA-LENGTH                          11700000
117900            PERFORM 9990-WRITE-CICS                               11710000
118000            SET PC204-SQL-ERROR                                   11720000
118100                PS-ERROR         TO TRUE                          11730000
118200                                                                  11740000
118300     END-EVALUATE.                                                11750000
118400                                                                  11760000
118500 3515-CALL-XLKUT-DOMAIN-INT.                                      11770000
118600     INITIALIZE XL001-ITEM-COMMAREA.                              11780000
118700                                                                  11790000
118800     MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             11800000
118900     MOVE  'I'                  TO XL001-KEY-UPC-TYP-CDE.         11810000
118901                                                                  11820000
118902     SET  XL001-BY-ITEM                                           11830000
118903          XL001-SELECT-UPC      TO TRUE                           11840000
118904                                                                  11850000
118905     CALL XL001-VSM-PGM USING  DFHEIBLK                           11860000
118906                               XL001-COMMAREA                     11870000
118907                               XL001-ITEM-COMMAREA.               11880000
118908     EVALUATE TRUE                                                11890000
118909                                                                  11890100
118910         WHEN XL001-SUCCESSFUL                                    11890200
118911             MOVE XL001-UPC-NBR TO SUT00028-UPC-NBR               11890300
118912         WHEN XL001-SQL-ERROR                                     11890400
118913            IF XL001-UPC-SQLCODE = +100                           11890500
118914               MOVE ZEROES   TO SUT00028-UPC-NBR                  11890600
118915            ELSE                                                  11890700
118916                INITIALIZE  PV-CICS-MSG-AREA                      11890800
118917                MOVE SQLCODE             TO PV-SQL-RETURN-CD      11890900
118918                STRING ' PCKCS728 - '           DELIMITED BY SIZE 11891000
118919                       '3515-CALL-XLKUT-DOMAIN' DELIMITED BY SIZE 11891100
118920                       '  SQL - '               DELIMITED BY SIZE 11891200
118921                       PV-SQL-RETURN-CD         DELIMITED BY SIZE 11891300
118922                                          INTO PV-CICS-MSG-AREA   11891400
118923                MOVE LENGTH OF PV-CICS-MSG-AREA                   11891500
118924                       TO PV-COMMAREA-LENGTH                      11891600
118925                PERFORM 9990-WRITE-CICS                           11891700
118926                INITIALIZE  PV-CICS-MSG-AREA                      11891800
118927                STRING ' PCKCS728 -'          DELIMITED BY SIZE   11891900
118928                       ' PO:'                 DELIMITED BY SIZE   11892000
118929                       PV-PO-NBR              DELIMITED BY SIZE   11892100
118930                       ' RCVR:'               DELIMITED BY SIZE   11892200
118931                       PV-RCVR-NBR            DELIMITED BY SIZE   11892300
118932                       ' STR:'                DELIMITED BY SIZE   11892400
118933                       PV-STORE-NBR           DELIMITED BY SIZE   11892500
118934                                          INTO PV-CICS-MSG-AREA   11892600
118935                MOVE LENGTH OF PV-CICS-MSG-AREA                   11892700
118936                       TO PV-COMMAREA-LENGTH                      11892800
118937                PERFORM 9990-WRITE-CICS                           11892900
118938                SET PC204-SQL-ERROR                               11893000
118939                    PS-ERROR         TO TRUE                      11893100
118940                                                                  11893200
118941            END-IF                                                11893300
118942       WHEN OTHER                                                 11893400
118943            INITIALIZE  PV-CICS-MSG-AREA                          11893500
118944            MOVE SQLCODE             TO PV-SQL-RETURN-CD          11893600
118945            STRING ' PCKCS728 - '             DELIMITED BY SIZE   11893700
118946                   '3510-CALL-XLKUT-DOMAIN'  DELIMITED BY SIZE    11893800
118947                   '  SQL - '                 DELIMITED BY SIZE   11893900
118948                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   11894000
118949                                         INTO PV-CICS-MSG-AREA    11894100
118950            MOVE LENGTH OF PV-CICS-MSG-AREA                       11894200
118951                   TO PV-COMMAREA-LENGTH                          11894300
118952            PERFORM 9990-WRITE-CICS                               11894400
118953            INITIALIZE  PV-CICS-MSG-AREA                          11894500
118954            STRING ' PCKCS728 -'             DELIMITED BY SIZE    11894600
118955                   ' PO:'                    DELIMITED BY SIZE    11894700
118956                   PV-PO-NBR                 DELIMITED BY SIZE    11894800
118957                   ' RCVR:'                  DELIMITED BY SIZE    11894900
118958                   PV-RCVR-NBR               DELIMITED BY SIZE    11895000
118959                   ' STR:'                   DELIMITED BY SIZE    11895100
118960                   PV-STORE-NBR              DELIMITED BY SIZE    11895200
118961                                         INTO PV-CICS-MSG-AREA    11895300
118962            MOVE LENGTH OF PV-CICS-MSG-AREA                       11895400
118963                   TO PV-COMMAREA-LENGTH                          11895500
118964            PERFORM 9990-WRITE-CICS                               11895600
118965            SET PC204-SQL-ERROR                                   11895700
118966                PS-ERROR         TO TRUE                          11895800
118967                                                                  11895900
118968     END-EVALUATE.                                                11896000
118969*----------------------------------------------------------------*11896100
118970*----------------------------------------------------------------*11896200
118971*  CHECK TO SEE IF LABEL TRANSACTION ID ALREADY EXISTS           *11896300
118972*----------------------------------------------------------------*11896400
118973 3600-SELECT-MAX-CTN-NBR.                                         11896500
118974                                                                  11896600
118975                                                                  11896700
118976     EXEC SQL                                                     11896800
118977          SELECT MAX(CART_NBR)                                    11896900
118978          INTO  :PV-MAX-CTN-NBR                                   11897000
118979          FROM   SUT_SMOOTHING_PRC                                11897100
118980          WHERE  SMTHG_PRC_ID     = :DK-SMTHG-PRC-IND             11897200
118981            AND  PO_NBR           = :DK-PO-NBR                    11897300
118982            AND  RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR               11897400
118983     END-EXEC.                                                    11897500
118984                                                                  11897600
118985     EVALUATE TRUE                                                11897700
118986         WHEN SQLCODE = ZERO                                      11897800
118987         WHEN SQLCODE = -811                                      11897900
118988              CONTINUE                                            11898000
118989         WHEN OTHER                                               11898100
118990              INITIALIZE  PV-CICS-MSG-AREA                        11898200
118991              MOVE SQLCODE             TO PV-SQL-RETURN-CD        11898300
118992              STRING ' PCKCS728 - '             DELIMITED BY SIZE 11898400
118993                     '3600-SELECT-MAX-CTN-NBR' DELIMITED BY SIZE  11898500
118994                     '  SQL - '                 DELIMITED BY SIZE 11898600
118995                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 11898700
118996                                           INTO PV-CICS-MSG-AREA  11898800
118997              MOVE LENGTH OF PV-CICS-MSG-AREA                     11898900
118998                     TO PV-COMMAREA-LENGTH                        11899000
118999              PERFORM 9990-WRITE-CICS                             11899100
119000              INITIALIZE  PV-CICS-MSG-AREA                        11899200
119100              STRING ' PCKCS728 -'             DELIMITED BY SIZE  11899300
119200                     ' PO:'                    DELIMITED BY SIZE  11899400
119300                     PV-PO-NBR                 DELIMITED BY SIZE  11899500
119400                     ' RCVR:'                  DELIMITED BY SIZE  11899600
119500                     PV-RCVR-NBR               DELIMITED BY SIZE  11899700
119600                     ' STR:'                   DELIMITED BY SIZE  11899800
119700                     PV-STORE-NBR              DELIMITED BY SIZE  11899900
119800                                           INTO PV-CICS-MSG-AREA  11900000
119900              MOVE LENGTH OF PV-CICS-MSG-AREA                     11910000
120000                     TO PV-COMMAREA-LENGTH                        11920000
120100              PERFORM 9990-WRITE-CICS                             11930000
120200              SET PC204-SQL-ERROR                                 11940000
120300                  PS-ERROR         TO TRUE                        11950000
120400     END-EVALUATE.                                                11960000
120500                                                                  11970000
120600******************************************************************11980000
120700*                                                                 11990000
120800******************************************************************12000000
120900 3700-GET-MANIFEST-NBR.                                           12010000
121000                                                                  12020000
121100     MOVE SUT00003-STR-NBR              TO  PC187-STR-NBR.        12030000
121200     MOVE PV-MAX-CTN-NBR                TO  PC187-NO-OF-LBLS.     12040000
121300                                                                  12050000
121400     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   12060000
121500                                                                  12070000
121600     EXEC CICS                                                    12080000
121700         LINK PROGRAM  (PC-MANIFEST-NBR-MODULE)                   12090000
121800              COMMAREA (PC187-COMMAREA-REC)                       12100000
121900              LENGTH   (PV-COMMAREA-LENGTH)                       12110000
122000              RESP     (PV-CICS-RESPONSE)                         12120000
122100     END-EXEC.                                                    12130000
122200                                                                  12140000
122300     EVALUATE TRUE                                                12150000
122400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12160000
122500           IF  PC187-CRA-SUCCESSFUL                               12170000
122600                  MOVE  PC187-START-MFST-NBR                      12180000
122700                    TO  PC180-SML-MNFST-NBR                       12190000
122800           ELSE                                                   12200000
122900             INITIALIZE  PV-CICS-MSG-AREA                         12210000
123000             MOVE SQLCODE             TO PV-SQL-RETURN-CD         12220000
123100             STRING ' PCKCS728 - '             DELIMITED BY SIZe  12230000
123200                    '3700-GET-MANIFEST-NBR  ' DELIMITED BY SIZE   12240000
123300                    '  SQL - '                 DELIMITED BY SIZe  12250000
123400                    PV-SQL-RETURN-CD           DELIMITED BY SIZe  12260000
123500                                          INTO PV-CICS-MSG-AREA   12270000
123600             MOVE LENGTH OF PV-CICS-MSG-AREA                      12280000
123700                    TO PV-COMMAREA-LENGTH                         12290000
123800             PERFORM 9990-WRITE-CICS                              12300000
123900             INITIALIZE  PV-CICS-MSG-AREA                         12310000
124000             STRING ' PCKCS728 -'             DELIMITED BY SIZE   12320000
124100                    ' PO:'                    DELIMITED BY SIZE   12330000
124200                    PV-PO-NBR                 DELIMITED BY SIZE   12340000
124300                    ' RCVR:'                  DELIMITED BY SIZE   12350000
124400                    PV-RCVR-NBR               DELIMITED BY SIZE   12360000
124500                    ' STR:'                   DELIMITED BY SIZE   12370000
124600                    PV-STORE-NBR              DELIMITED BY SIZE   12380000
124700                                          INTO PV-CICS-MSG-AREA   12390000
124800             MOVE LENGTH OF PV-CICS-MSG-AREA                      12400000
124900                    TO PV-COMMAREA-LENGTH                         12410000
125000             PERFORM 9990-WRITE-CICS                              12420000
125100             SET PC204-SQL-ERROR                                  12430000
125200                 PS-ERROR         TO TRUE                         12440000
125300           END-IF                                                 12450000
125400         WHEN OTHER                                               12460000
125500             INITIALIZE  PV-CICS-MSG-AREA                         12470000
125600             MOVE SQLCODE             TO PV-SQL-RETURN-CD         12480000
125700             STRING ' PCKCS728 - '             DELIMITED BY SIZe  12490000
125800                    '3700-GET-MANIFEST-NBR  ' DELIMITED BY SIZE   12500000
125900                    '  SQL - '                 DELIMITED BY SIZE  12510000
126000                    PV-SQL-RETURN-CD           DELIMITED BY SIZE  12520000
126100                                          INTO PV-CICS-MSG-AREA   12530000
126200             MOVE LENGTH OF PV-CICS-MSG-AREA                      12540000
126300                    TO PV-COMMAREA-LENGTH                         12550000
126400             PERFORM 9990-WRITE-CICS                              12560000
126500             INITIALIZE  PV-CICS-MSG-AREA                         12570000
126600             STRING ' PCKCS728 -'             DELIMITED BY SIZE   12580000
126700                    ' PO:'                    DELIMITED BY SIZE   12590000
126800                    PV-PO-NBR                 DELIMITED BY SIZE   12600000
126900                    ' RCVR:'                  DELIMITED BY SIZE   12610000
127000                    PV-RCVR-NBR               DELIMITED BY SIZE   12620000
127100                    ' STR:'                   DELIMITED BY SIZE   12630000
127200                    PV-STORE-NBR              DELIMITED BY SIZE   12640000
127300                                          INTO PV-CICS-MSG-AREA   12650000
127400             MOVE LENGTH OF PV-CICS-MSG-AREA                      12660000
127500                    TO PV-COMMAREA-LENGTH                         12670000
127600             PERFORM 9990-WRITE-CICS                              12680000
127700             SET PC204-SQL-ERROR                                  12690000
127800                 PS-ERROR         TO TRUE                         12700000
127900     END-EVALUATE.                                                12710000
128000                                                                  12720000
128100                                                                  12730000
128200******************************************************************12740000
128300 3800-INSERT-OTBND-CART.                                          12750000
128400******************************************************************12760000
128500                                                                  12770000
128600     MOVE DK-OPER-UNT-ID      TO   PC180-SML-DC-ORIGIN            12780000
128700                                                                  12790000
128800     MOVE SUT00003-STR-NBR    TO                                  12800000
128900                                   SUT00024-DEST-LOC-NBR          12810000
129000                                   PV-STORE-NBR                   12820000
129100     MOVE PV-STORE-NBR        TO   PC180-SML-DIVERT-CDE           12830000
129200     MOVE 'N'                 TO   SUT00024-MSTR-CART-IND         12840000
129300     MOVE ZEROES              TO   SUT00024-CART-RVSN-NBR         12850000
129400     MOVE PC-CURRENT-PROGRAM-NAME    TO                           12860000
129500                                   SUT00024-CRE-PGM-NM            12870000
129600                                                                  12880000
129700     MOVE PC180-SML-BARCODE   TO   SUT00024-SHIPT-UNT-ID.         12890000
129800     MOVE 'S'                 TO   SUT00024-CART-TYP-CDE.         12900000
129900     MOVE PS-PRESENTATION-FOUND-SW TO                             12910000
130000                                   SUT00024-EAS-TAG-IND.          12920000
130100                                                                  12930000
130200     EXEC SQL                                                     12940000
130300         INSERT INTO SUT_OTBND_CART                               12950000
130400               (SHIPT_UNT_ID                                      12960000
130500              , ORGN_LOC_NBR                                      12970000
130600              , DEST_LOC_NBR                                      12980000
130700              , CART_SRC_CDE                                      12990000
130800              , MSTR_CART_IND                                     13000000
130900              , PRNT_CART_ID                                      13010000
131000              , ORIG_CART_ID                                      13020000
131100              , ACTV_IND                                          13030000
131200              , CRE_DTE                                           13040000
131300              , CRE_TM                                            13050000
131400              , CRE_USR_ID                                        13060000
131500              , CRE_PGM_NM                                        13070000
131600              , CART_RVSN_NBR                                     13080000
131700              , CART_TYP_CDE                                      13090000
131800              , LBL_PRT_SEQ_NBR                                   13100000
131900              , EAS_TAG_IND)                                      13110000
132000         VALUES                                                   13120000
132100              (:SUT00024-SHIPT-UNT-ID                             13130000
132200             , :DK-OPER-UNT-ID                                    13140000
132300             , :SUT00024-DEST-LOC-NBR                             13150000
132400             , :PC-SMO                                            13160000
132500             , :SUT00024-MSTR-CART-IND                            13170000
132600             , :SUT00024-SHIPT-UNT-ID                             13180000
132700             , :SUT00024-SHIPT-UNT-ID                             13190000
132800             , :PC-Y                                              13200000
132900             , :PV-CURRENT-DB2-DATE                               13210000
133000             , :PV-CURRENT-DB2-TIME                               13220000
133100             , :PV-USER-ID                                        13230000
133200             , :SUT00024-CRE-PGM-NM                               13240000
133300             , :SUT00024-CART-RVSN-NBR                            13250000
133400             , :SUT00024-CART-TYP-CDE                             13260000
133500             , :SUT00024-LBL-PRT-SEQ-NBR                          13270000
133600             , :SUT00024-EAS-TAG-IND)                             13280000
133700     END-EXEC.                                                    13290000
133800                                                                  13300000
133900     EVALUATE TRUE                                                13310000
134000         WHEN SQLCODE = ZERO                                      13320000
134100              CONTINUE                                            13330000
134200         WHEN SQLWARN0 NOT = SPACES                               13340000
134300         WHEN SQLCODE NOT EQUAL ZERO                              13350000
134400              INITIALIZE  PV-CICS-MSG-AREA                        13360000
134500              MOVE SQLCODE             TO PV-SQL-RETURN-CD        13370000
134600              STRING ' PCKCS728 - '             DELIMITED BY SIZE 13380000
134700                     '3800-INSERT-OTBND-CART ' DELIMITED BY SIZE  13390000
134800                     '  SQL - '                 DELIMITED BY SIZE 13400000
134900                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 13410000
135000                                           INTO PV-CICS-MSG-AREA  13420000
135100              MOVE LENGTH OF PV-CICS-MSG-AREA                     13430000
135200                     TO PV-COMMAREA-LENGTH                        13440000
135300              PERFORM 9990-WRITE-CICS                             13450000
135400              INITIALIZE  PV-CICS-MSG-AREA                        13460000
135500              STRING ' PCKCS728 -'             DELIMITED BY SIZE  13470000
135600                     ' PO:'                    DELIMITED BY SIZE  13480000
135700                     PV-PO-NBR                 DELIMITED BY SIZE  13490000
135800                     ' RCVR:'                  DELIMITED BY SIZE  13500000
135900                     PV-RCVR-NBR               DELIMITED BY SIZE  13510000
136000                     ' STR:'                   DELIMITED BY SIZE  13520000
136100                     PV-STORE-NBR              DELIMITED BY SIZE  13530000
136200                                           INTO PV-CICS-MSG-AREA  13540000
136300              MOVE LENGTH OF PV-CICS-MSG-AREA                     13550000
136400                     TO PV-COMMAREA-LENGTH                        13560000
136500              PERFORM 9990-WRITE-CICS                             13570000
136600              SET PC204-SQL-ERROR                                 13580000
136700                  PS-ERROR         TO TRUE                        13590000
136800     END-EVALUATE.                                                13600000
136900                                                                  13610000
137000******************************************************************13620000
137100 3850-INSERT-OTBND-UPC.                                           13630000
137200******************************************************************13640000
137300     IF PS-CREATE-NEW-CRTN-BRCE                                   13650000
137400        MOVE SUT00024-SHIPT-UNT-ID TO SUT00028-SHIPT-UNT-ID       13660000
137500        MOVE 'PO'                TO   SUT00028-TRN-TYP-CDE        13670000
137600     ELSE                                                         13680000
137700        MOVE SUT00024-SHIPT-UNT-ID TO SUT00028-SHIPT-UNT-ID       13690000
137800     END-IF.                                                      13700000
137900                                                                  13710000
138000     EXEC SQL                                                     13720000
138100         INSERT INTO SUT_OTBND_UPC                                13730000
138200            (SHIPT_UNT_ID                                         13740000
138300            ,TRN_NBR                                              13750000
138400            ,TRN_LNE_NBR                                          13760000
138500            ,TRN_TYP_CDE                                          13770000
138600            ,UPC_NBR                                              13780000
138700            ,SHPD_UNT_QTY                                         13790000
138800            ,RCVR_SEQ_NBR )                                       13800000
138900         VALUES                                                   13810000
139000            (:SUT00028-SHIPT-UNT-ID                               13820000
139100            ,:SUT00003-PO-NBR                                     13830000
139200            ,:SUT00003-PO-LNE-NBR                                 13840000
139300            ,:SUT00028-TRN-TYP-CDE                                13850000
139400            ,:SUT00028-UPC-NBR                                    13860000
139500            ,:SUT00003-UNT-QTY                                    13870000
139600            ,:SUT00003-RCVR-SEQ-NBR)                              13880000
139700     END-EXEC                                                     13890000
139800                                                                  13900000
139900     EVALUATE TRUE                                                13910000
140000         WHEN SQLCODE = ZERO                                      13920000
140100              CONTINUE                                            13930000
140200         WHEN SQLWARN0 NOT = SPACES                               13940000
140300         WHEN SQLCODE NOT EQUAL ZERO                              13950000
140400              INITIALIZE  PV-CICS-MSG-AREA                        13960000
140500              MOVE SQLCODE             TO PV-SQL-RETURN-CD        13970000
140600              STRING ' PCKCS728 - '             DELIMITED BY SIZE 13980000
140700                     '3850-INSERT-OTBND-UPC ' DELIMITED BY SIZE   13990000
140800                     '  SQL - '                 DELIMITED BY SIZE 14000000
140900                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 14010000
141000                                           INTO PV-CICS-MSG-AREA  14020000
141100              MOVE LENGTH OF PV-CICS-MSG-AREA                     14030000
141200                     TO PV-COMMAREA-LENGTH                        14040000
141300              PERFORM 9990-WRITE-CICS                             14050000
141400              INITIALIZE  PV-CICS-MSG-AREA                        14060000
141500              STRING ' PCKCS728 -'             DELIMITED BY SIZE  14070000
141600                     ' PO:'                    DELIMITED BY SIZE  14080000
141700                     PV-PO-NBR                 DELIMITED BY SIZE  14090000
141800                     ' RCVR:'                  DELIMITED BY SIZE  14100000
141900                     PV-RCVR-NBR               DELIMITED BY SIZE  14110000
142000                     ' STR:'                   DELIMITED BY SIZE  14120000
142100                     PV-STORE-NBR              DELIMITED BY SIZE  14130000
142200                                           INTO PV-CICS-MSG-AREA  14140000
142300              MOVE LENGTH OF PV-CICS-MSG-AREA                     14150000
142400                     TO PV-COMMAREA-LENGTH                        14160000
142500              PERFORM 9990-WRITE-CICS                             14170000
142600              SET PC204-SQL-ERROR                                 14180000
142700                  PS-ERROR         TO TRUE                        14190000
142800     END-EVALUATE.                                                14200000
142900                                                                  14210000
143000                                                                  14220000
143100**********************************************************        14230000
143200 3900-INSERT-TSULBXF.                                             14240000
143300**********************************************************        14250000
143400                                                                  14260000
143500     MOVE PC180-SML-BARCODE   TO   SULBXF-SHIPT-UNT-ID.           14270000
143600     MOVE SPACES              TO   SULBXF-BRCDE-NBR.              14280000
143700     MOVE '00'                TO   SULBXF-BRCDE-NBR (1:2).        14290000
143800     MOVE PC180-SML-BARCODE-R TO   SULBXF-BRCDE-NBR (3:18).       14300000
143900     MOVE 'K'                 TO   SULBXF-CART-LBL-TYP-CDE.       14310000
144000     MOVE SUT00003-STR-NBR    TO   SULBXF-DEST-OPER-UNT-ID.       14320000
144100                                                                  14330000
144200     EXEC SQL                                                     14340000
144300         INSERT INTO TSULBXF                                      14350000
144400               ( SHIPT_UNT_ID                                     14360000
144500                ,BRCDE_NBR                                        14370000
144600                ,CART_LBL_TYP_CDE                                 14380000
144700                ,DEST_OPER_UNT_ID                                 14390000
144800                ,STAT_CDE                                         14400000
144900                ,LAST_STAT_CHG_TMST                               14410000
145000                ,CRE_TMST)                                        14420000
145100         VALUES (:SULBXF-SHIPT-UNT-ID                             14430000
145200               , :SULBXF-BRCDE-NBR                                14440000
145300               , :SULBXF-CART-LBL-TYP-CDE                         14450000
145400               , :SULBXF-DEST-OPER-UNT-ID                         14460000
145500               , :PC-A                                            14470000
145600               ,  CURRENT TIMESTAMP                               14480000
145700               ,  CURRENT TIMESTAMP)                              14490000
145800*              , :SULBXF-CRE-TMST)                                14500000
145900     END-EXEC                                                     14510000
146000                                                                  14520000
146100         EVALUATE TRUE                                            14530000
146200             WHEN SQLCODE = ZERO                                  14540000
146300                CONTINUE                                          14550000
146400             WHEN SQLWARN0 NOT = SPACES                           14560000
146500             WHEN SQLCODE < ZERO                                  14570000
146600             WHEN SQLCODE > ZERO                                  14580000
146700                 MOVE '3900-INSERT-TSULBXF'                       14590000
146800                                             TO PV-CICS-MSG-AREA  14600000
146900                 MOVE LENGTH OF PV-CICS-MSG-AREA                  14610000
147000                        TO PV-COMMAREA-LENGTH                     14620000
147100                 PERFORM 9990-WRITE-CICS                          14630000
147200                 STRING ' PCKCS728 -'      DELIMITED BY SIZE      14640000
147300                        ' CARTON: '        DELIMITED BY SIZE      14650000
147400                        SULBXF-BRCDE-NBR   DELIMITED BY SIZE      14660000
147500                                           INTO PV-CICS-MSG-AREA  14670000
147600                 PERFORM 9990-WRITE-CICS                          14680000
147700                 SET PC204-SQL-ERROR                              14690000
147800                     PS-ERROR         TO TRUE                     14700000
147900         END-EVALUATE.                                            14710000
148000                                                                  14720000
148100                                                                  14730000
148200                                                                  14740000
148300                                                                  14750000
148400*----------------------------------------------------------------*14760000
148500* PRINT LABEL ROUTINE                                            *14770000
148501*----------------------------------------------------------------*14780000
148502 4000-LABEL-ROUTINE.                                              14790000
148503                                                                  14800000
148504                                                                  14810000
148505     PERFORM 4300-FORMAT-IP-ADDR.                                 14820000
148506     PERFORM 4310-CALL-SOCKET.                                    14830000
148507     IF  PS-NO-SOCKET-ERROR                                       14840000
148508         PERFORM 4320-CONNECT-SOCKET                              14850000
148509     END-IF.                                                      14850100
148510     IF  PS-NO-SOCKET-ERROR                                       14850200
148511         PERFORM 4400-BLD-HDR-REC                                 14850300
148512     END-IF.                                                      14850400
148513*                                                                 14850500
148514*                                                                 14850600
148515     IF  PS-NO-SOCKET-ERROR                                       14850700
148516         PERFORM 4500-BLD-DTL-REC                                 14850800
148517     END-IF.                                                      14850900
148518*                                                                 14851000
148519*                                                                 14851100
148520     IF  PS-NO-SOCKET-ERROR                                       14851200
148521         PERFORM 4600-BLD-TLR-REC                                 14851300
148522     END-IF.                                                      14851400
148523     IF  PS-NO-SOCKET-ERROR                                       14851500
148524         PERFORM 4340-CLOSE-SOCKET                                14851600
148525     END-IF.                                                      14851700
148526     IF  PS-NO-SOCKET-ERROR                                       14851800
148527         PERFORM 4700-LABEL-HISTORY                               14851900
148528     END-IF.                                                      14852000
148529     IF PS-SOCKET-ERROR                                           14852100
148530        SET PC204-SOCKET-ERROR TO TRUE                            14852200
148531     END-IF.                                                      14852300
148532*----------------------------------------------------------------*14852400
148533*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *14852500
148534*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *14852600
148535*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *14852700
148536*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *14852800
148537*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *14852900
148538*  IP ADDRESS.                                                   *14853000
148539*----------------------------------------------------------------*14853100
148540 4300-FORMAT-IP-ADDR.                                             14853200
148541                                                                  14853300
148542     MOVE PC204-SHP-PRTR-IP-ADDR TO PV-IP-ADDRESS.                14853400
148543                                                                  14853500
148544     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      14853600
148545     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        14853700
148546                                                                  14853800
148547     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      14853900
148548     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        14854000
148549                                                                  14854100
148550     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      14854200
148560     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        14854300
148570                                                                  14854400
148580     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      14854500
148590     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        14854600
148600                                                                  14854700
148700     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              14854800
148800                                                                  14854900
148900                                                                  14855000
149000*----------------------------------------------------------------*14856000
149100*  CALL SOCKET                                                   *14857000
149200*----------------------------------------------------------------*14858000
149300 4310-CALL-SOCKET.                                                14859000
149400                                                                  14860000
149500     CALL 'EZASOKET'                                              14870000
149600         USING DP081-SOCKET-CMD                                   14880000
149700               DP081-AF-INET                                      14890000
149800               DP081-SOCK-TYPE                                    14900000
149900               DP081-PROTOCOL                                     14910000
150000               DP081-ERRNO                                        14920000
150100               DP081-RETCODE.                                     14930000
150200                                                                  14940000
150300     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         14950000
150400                                                                  14960000
150500     IF DP081-RETCODE < ZERO                                      14970000
150600        SET  PS-SOCKET-ERROR         TO TRUE                      14980000
150700        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     14990000
150800        SET  DP081-TCP-IP-SOCKET-ERR TO TRUE                      15000000
150900        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      15010000
151000        SET  DP013-OTHER-ABEND       TO TRUE                      15020000
151100        SET  DP013-NO-ROLLBACK       TO TRUE                      15030000
151200        MOVE '4310-CALL-SOCKET'      TO DP013-PARAGRAPH           15040000
151300        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   15050000
151400        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        15060000
151500        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          15070000
151600        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       15080000
151700        STRING ' PCKCS728 - '            DELIMITED BY SIZE        15090000
151800               'DP081-FAMILY='           DELIMITED BY SIZE        15100000
151900               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        15110000
152000               ' DP081-PORT='            DELIMITED BY SIZE        15120000
152100               PV-DISPLAY-PORT           DELIMITED BY SIZE        15130000
152200               ' DP081-IP-ADDR='         DELIMITED BY SIZE        15140000
152300               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        15150000
152400                                    INTO DP013-MESSAGE-TEXT (2)   15160000
152500        MOVE DP081-RETCODE            TO  PV-RETCODE              15170000
152600        MOVE DP081-ERRNO              TO  PV-ERRNO                15180000
152700        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       15190000
152800               ' DP081-RETCODE - '        DELIMITED BY SIZE       15200000
152900               PV-RETCODE                 DELIMITED BY SIZE       15210000
153000               ' DP081-ERRNO - '          DELIMITED BY SIZE       15220000
153100               PV-ERRNO                   DELIMITED BY SIZE       15230000
153200                                     INTO DP013-MESSAGE-TEXT (3)  15240000
153300        MOVE   SUT00003-PO-NBR         TO  PV-DISPLAY-PO          15250000
153400        MOVE   SUT00003-RCVR-SEQ-NBR   TO  PV-DISPLAY-RCVR        15260000
153500        MOVE   SUT00003-PO-LNE-NBR     TO  PV-DISPLAY-LINE        15270000
153600        MOVE   PC204-OPER-UNT-ID       TO  PV-DISPLAY-DEST        15280000
153700        STRING ' PRTR ID: '                DELIMITED BY SIZE      15290000
153800               PC204-SML-PRINTER           DELIMITED BY SIZE      15300000
153900               '   PO: '                   DELIMITED BY SIZE      15310000
154000               PV-DISPLAY-PO               DELIMITED BY SIZE      15320000
154100               '   RCVR: '                 DELIMITED BY SIZE      15330000
154200               PV-DISPLAY-RCVR             DELIMITED BY SIZE      15340000
154300               '   LINE: '                 DELIMITED BY SIZE      15350000
154400               PV-DISPLAY-LINE             DELIMITED BY SIZE      15360000
154500               '   DEST: '                 DELIMITED BY SIZE      15370000
154600               PV-DISPLAY-DEST             DELIMITED BY SIZE      15380000
154700                                      INTO DP013-MESSAGE-TEXT (4) 15390000
154800        PERFORM 9999-WRITE-CICS-LOG-MSG                           15400000
154900                                                                  15410000
155000*** BEGIN - FOR TESTING ONLY                                      15420000
155100*    ELSE                                                         15430000
155200*       MOVE ' PCKCS728 - CALL SOCKET SUCCESSFUL'                 15440000
155300*                                           TO PV-CICS-MSG-AREA   15450000
155400*       PERFORM 9990-WRITE-CICS                                   15460000
155500*** END - FOR TESTING ONLY                                        15470000
155600                                                                  15480000
155700     END-IF.                                                      15490000
155800                                                                  15500000
155900                                                                  15510000
156000*----------------------------------------------------------------*15520000
156100*  CONNECT THE PATH (SOCKET).                                    *15530000
156200*----------------------------------------------------------------*15540000
156300 4320-CONNECT-SOCKET.                                             15550000
156400                                                                  15560000
156500                                                                  15570000
156600     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             15580000
156700     MOVE DP081-COM-PORT        TO DP081-NAME-PORT.               15590000
156800                                                                  15600000
156900     CALL 'EZASOKET'                                              15610000
157000         USING DP081-CONNECT-CMD                                  15620000
157100               DP081-SOCK-ID                                      15630000
157200               DP081-SOCK-NAME                                    15640000
157300               DP081-ERRNO                                        15650000
157400               DP081-RETCODE.                                     15660000
157500                                                                  15670000
157600     IF DP081-RETCODE < ZERO                                      15680000
157700        SET  PS-SOCKET-ERROR         TO TRUE                      15690000
157800        MOVE PC-CURRENT-PROGRAM-NAME  TO DP081-TCP-IP-PGM-NAME    15700000
157900        SET  DP081-TCP-IP-CONNECT-ERR TO TRUE                     15710000
158000        MOVE DP081-ERRNO              TO DP081-TCP-IP-ERR-NBR     15720000
158100                                         CONNECT-ERRNO            15730000
158200        MOVE CONNECT-ERR              TO PV-CICS-MSG-AREA         15740000
158300                                                                  15750000
158400        PERFORM 9990-WRITE-CICS                                   15760000
158500                                                                  15770000
158600        SET  DP013-OTHER-ABEND        TO TRUE                     15780000
158700        SET  DP013-NO-ROLLBACK        TO TRUE                     15790000
158800        MOVE '4320-CONNECT-SOCKET'    TO DP013-PARAGRAPH          15800000
158900        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   15810000
159000        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        15820000
159100        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          15830000
159200        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       15840000
159300        STRING ' PCKCS728 - '            DELIMITED BY SIZE        15850000
159400               'DP081-FAMILY='           DELIMITED BY SIZE        15860000
159500               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        15870000
159600               ' DP081-PORT='            DELIMITED BY SIZE        15880000
159700               PV-DISPLAY-PORT           DELIMITED BY SIZE        15890000
159800               ' DP081-IP-ADDR='         DELIMITED BY SIZE        15900000
159900               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        15910000
160000                                    INTO DP013-MESSAGE-TEXT (2)   15920000
160100        MOVE DP081-RETCODE            TO  PV-RETCODE              15930000
160200        MOVE DP081-ERRNO              TO  PV-ERRNO                15940000
160300        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       15950000
160400               ' DP081-RETCODE - '        DELIMITED BY SIZE       15960000
160500               PV-RETCODE                 DELIMITED BY SIZE       15970000
160600               ' DP081-ERRNO - '          DELIMITED BY SIZE       15980000
160700               PV-ERRNO                   DELIMITED BY SIZE       15990000
160800                                     INTO DP013-MESSAGE-TEXT (3)  16000000
160900        MOVE   PV-PO-NBR               TO  PV-DISPLAY-PO          16010000
161000        MOVE   PV-RCVR-NBR             TO  PV-DISPLAY-RCVR        16020000
161100        MOVE   PV-STORE-NBR            TO  PV-DISPLAY-DEST        16030000
161200        STRING ' PRTR ID: '                DELIMITED BY SIZE      16040000
161300               PC204-SML-PRINTER           DELIMITED BY SIZE      16050000
161400               '   PO: '                   DELIMITED BY SIZE      16060000
161500               PV-DISPLAY-PO               DELIMITED BY SIZE      16070000
161600               '   RCVR: '                 DELIMITED BY SIZE      16080000
161700               PV-DISPLAY-RCVR             DELIMITED BY SIZE      16090000
161800               '  STORE: '                 DELIMITED BY SIZE      16100000
161900               PV-DISPLAY-DEST             DELIMITED BY SIZE      16110000
162000                                      INTO DP013-MESSAGE-TEXT (4) 16120000
162100        PERFORM 9999-WRITE-CICS-LOG-MSG                           16130000
162200                                                                  16140000
162300*** BEGIN - FOR TESTING ONLY                                      16150000
162400*    ELSE                                                         16160000
162500*       MOVE ' PCKCS728 - CONNECT SOCKET SUCCESSFUL'              16170000
162600*                                           TO PV-CICS-MSG-AREA   16180000
162700*       PERFORM 9990-WRITE-CICS                                   16190000
162800*** END - FOR TESTING ONLY                                        16200000
162900     END-IF.                                                      16210000
163000                                                                  16220000
163100                                                                  16230000
163200*----------------------------------------------------------------*16240000
163300*  CLOSE THE SOCKET                                              *16250000
163400*----------------------------------------------------------------*16260000
163500 4340-CLOSE-SOCKET.                                               16270000
163600                                                                  16280000
163700     CALL 'EZASOKET'                                              16290000
163800         USING DP081-CLOSE-CMD                                    16300000
163900               DP081-SOCK-ID                                      16310000
164000               DP081-ERRNO                                        16320000
164100               DP081-RETCODE.                                     16330000
164200                                                                  16340000
164300     IF DP081-RETCODE < ZERO                                      16350000
164400        SET  PS-SOCKET-ERROR         TO TRUE                      16360000
164500        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     16370000
164600        SET  DP081-TCP-IP-CLOSE-ERR  TO TRUE                      16380000
164700        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      16390000
164800        SET  DP013-OTHER-ABEND       TO TRUE                      16400000
164900        SET  DP013-NO-ROLLBACK       TO TRUE                      16410000
165000        MOVE '4340-CLOSE-SOCKET'     TO DP013-PARAGRAPH           16420000
165100        MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)   16430000
165200        MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY        16440000
165300        MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT          16450000
165400        MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR       16460000
165500        STRING ' PCKCS728 - '            DELIMITED BY SIZE        16470000
165600               'DP081-FAMILY='           DELIMITED BY SIZE        16480000
165700               PV-DISPLAY-FAMILY         DELIMITED BY SIZE        16490000
165800               ' DP081-PORT='            DELIMITED BY SIZE        16500000
165900               PV-DISPLAY-PORT           DELIMITED BY SIZE        16510000
166000               ' DP081-IP-ADDR='         DELIMITED BY SIZE        16520000
166100               PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE        16530000
166200                                    INTO DP013-MESSAGE-TEXT (2)   16540000
166300        MOVE DP081-RETCODE            TO  PV-RETCODE              16550000
166400        MOVE DP081-ERRNO              TO  PV-ERRNO                16560000
166500        STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE       16570000
166600               ' DP081-RETCODE - '        DELIMITED BY SIZE       16580000
166700               PV-RETCODE                 DELIMITED BY SIZE       16590000
166800               ' DP081-ERRNO - '          DELIMITED BY SIZE       16600000
166900               PV-ERRNO                   DELIMITED BY SIZE       16610000
167000                                     INTO DP013-MESSAGE-TEXT (3)  16620000
167100        MOVE   PV-PO-NBR               TO  PV-DISPLAY-PO          16630000
167200        MOVE   PV-RCVR-NBR             TO  PV-DISPLAY-RCVR        16640000
167300        MOVE   PV-STORE-NBR            TO  PV-DISPLAY-DEST        16650000
167400        STRING ' PRTR ID: '                DELIMITED BY SIZE      16660000
167500               PC204-SML-PRINTER           DELIMITED BY SIZE      16670000
167600               '   PO: '                   DELIMITED BY SIZE      16680000
167700               PV-DISPLAY-PO               DELIMITED BY SIZE      16690000
167800               '   RCVR: '                 DELIMITED BY SIZE      16700000
167900               PV-DISPLAY-RCVR             DELIMITED BY SIZE      16710000
168000               '  STORE: '                 DELIMITED BY SIZE      16720000
168100               PV-DISPLAY-DEST             DELIMITED BY SIZE      16730000
168200                                      INTO DP013-MESSAGE-TEXT (4) 16740000
168300        PERFORM 9999-WRITE-CICS-LOG-MSG                           16750000
168400                                                                  16760000
168500*** BEGIN - FOR TESTING ONLY                                      16770000
168600*    ELSE                                                         16780000
168700*       MOVE ' PCKCS728 - CLOSE SOCKET SUCCESSFUL'                16790000
168800*                                           TO PV-CICS-MSG-AREA   16800000
168900*       PERFORM 9990-WRITE-CICS                                   16810000
169000*** END - FOR TESTING ONLY                                        16820000
169100                                                                  16830000
169200     END-IF.                                                      16840000
169300                                                                  16850000
169400                                                                  16860000
169500*----------------------------------------------------------------*16870000
169600*----------------------------------------------------------------*16880000
169700 4400-BLD-HDR-REC.                                                16890000
169800     INITIALIZE PC133-LABEL-HDR-REC.                              16900000
169900     SET  PC133-LABEL-HDR           TO  TRUE.                     16910000
170000                                                                  16920000
170100     MOVE PC204-SMTHG-PRC-ID        TO  PC133-HDR-TRANS-ID.       16930000
170200     MOVE PC204-SML-PRINTER         TO  PV-PRINTER-HOLD.          16940000
170300     MOVE PV-PRINTER-1-3            TO  PC133-HDR-PRTR-ID.        16950000
170400     MOVE SPACES                    TO  PC133-HDR-LBL-TYPE.       16960000
170500     MOVE PC204-PO-NBR              TO  PC133-HDR-PO-NBR.         16970000
170600     MOVE PV-RCVR-NBR-3             TO  PC133-HDR-RCVR-SEQ.       16980000
170700     MOVE ZEROES                    TO  PC133-HDR-STORE-NBR.      16990000
170800     MOVE SPACES                    TO  PC133-HDR-PROC-AREA.      17000000
170900                                                                  17010000
171000     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    17020000
171100         '' BY SPACES.                                           17030000
171200     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    17040000
171300         ';' BY SPACES.                                           17050000
171400     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    17060000
171500         LOW-VALUES BY SPACES.                                    17070000
171600                                                                  17080000
171700     MOVE PC133-HDR-REC-LENGTH    TO DP081-TCPLENG                17090000
171800                                     DP081-NBR-BYTES.             17100000
171900     PERFORM 5100-SEND-DATA-TO-LPMS.                              17110000
172000                                                                  17120000
172100                                                                  17130000
172200*----------------------------------------------------------------*17140000
172300* BUILD DETAIL RECORD                                            *17150000
172400*----------------------------------------------------------------*17160000
172500 4500-BLD-DTL-REC.                                                17170000
172600                                                                  17180000
172700     PERFORM 4800-CREATE-HEADER-LABEL.                            17190000
172800                                                                  17200000
172900*routine to create barcode/update/print                           17210000
173000     IF  PS-NO-SOCKET-ERROR                                       17220000
173100        EVALUATE TRUE                                             17230000
173200          WHEN PC204-UNLOAD-AND-PRINT                             17240000
173300            PERFORM 3000-SELECT-CARTONS-LINES                     17250000
173400          WHEN PC204-RESMOOTH-CRTNS-ADD                           17260000
173500               PERFORM 7000-SELECT-CRTNS-RESMOOTH                 17270000
173600          WHEN PC204-REPRINT-CTN-LIST                             17280000
173700               PERFORM 1120-PREPARE-LIST-ENTRY                    17290000
173800          WHEN PC204-REPRINT-STORE-LIST                           17300000
173900               PERFORM 1140-PREPARE-LIST-ENTRY                    17310000
174000        END-EVALUATE                                              17320000
174100     END-IF                                                       17330000
174200*                                                                 17340000
174300                                                                  17350000
174400     IF  PS-NO-SOCKET-ERROR                                       17360000
174500         PERFORM 4810-CREATE-TRAILER-LABEL                        17370000
174600     END-IF.                                                      17380000
174700*                                                                 17390000
174800*----------------------------------------------------------------*17400000
174900* SEND HEADER LABEL                                              *17410000
175000*----------------------------------------------------------------*17420000
175100 4511-HDR-LABEL.                                                  17430000
175200     INITIALIZE PC133-LABEL-DTL-REC.                              17440000
175300     SET  PC133-LABEL-DTL           TO  TRUE.                     17450000
175400                                                                  17460000
175500     MOVE PC204-SMTHG-PRC-ID        TO  PC133-DTL-TRANS-ID.       17470000
175600     SET  pc207-IDX-2               TO  pc207-IDX.                17480000
175700     MOVE pc207-HDR-LINE-LENGTH (pc207-IDX-2)                     17490000
175800                                    TO  PC133-DTL-LENGTH.         17500000
175900     MOVE pc207-SML-HEADER-LINE (pc207-IDX)                       17510000
176000                                    TO  PC133-DTL-DATA.           17520000
176100                                                                  17530000
176200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    17540000
176300         '' BY SPACES.                                           17550000
176400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    17560000
176500         ';' BY SPACES.                                           17570000
176600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    17580000
176700         LOW-VALUES BY SPACES.                                    17590000
176800                                                                  17600000
176900******************************************************************17610000
177000* LENGTH CALCULATION:                                            *17620000
177100*       LINE LENGTH HEADER LABEL (pc207-HDR-LINE-LENGTH)         *17630000
177200*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *17640000
177300*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *17650000
177400*              PC133-DTL-LENGTH        (3 POSITIONS)             *17660000
177500*              HEX 03-END EACH DTL REC (1 POSITIONS)             *17670000
177600*              FILLER                  (6 POSITIONS)             *17680000
177700******************************************************************17690000
177800     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        17700000
177900     MOVE pc207-HDR-LINE-LENGTH (pc207-IDX-2)                     17710000
178000                                  TO PC133-DTL-REC-LENGTH.        17720000
178100     ADD  20                      TO PC133-DTL-REC-LENGTH.        17730000
178200     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                17740000
178300                                     DP081-NBR-BYTES.             17750000
178400                                                                  17760000
178500     PERFORM 5100-SEND-DATA-TO-LPMS.                              17770000
178600                                                                  17780000
178700     ADD  1  TO  PV-TRAILER-COUNT.                                17790000
178800                                                                  17800000
178900                                                                  17810000
179000*                                                                 17820000
179100*----------------------------------------------------------------*17830000
179200* BUILD SML LABEL FORM                                           *17840000
179300*----------------------------------------------------------------*17850000
179400 4559-BUILD-SML-FORM.                                             17860000
179500     INITIALIZE PC133-LABEL-DTL-REC.                              17870000
179600     SET  PC133-LABEL-DTL           TO  TRUE.                     17880000
179700                                                                  17890000
179800                                                                  17900000
179900     SET  PC255-SMTH-HDG                                          17910000
180000          PC255-STR-REV-YES                                       17920000
180100          PC255-ZONE-HDG                                          17930000
180200          PC255-DOOR-HDG-YES                                      17940000
180300          PC255-FORM-NO-INPK-BOX    TO  TRUE.                     17950000
180400                                                                  17960000
180500*LINE                                                             17970000
180600     MOVE 'LINE NO:'                TO PC255-LNE-PCK-HDG          17980000
180700*DO NOT PRINT OTPK HEADING                                        17990000
180800     SET  PC255-FORM-NO-UNT-HDG     TO  TRUE                      18000000
180900                                                                  18010000
181000*REPRINT                                                          18020000
181100     IF  PS-REPRINT-BATCH                                         18030000
181200         SET  PC255-FORM-REPRT-BOX      TO  TRUE                  18040000
181300         SET  PC255-FORM-REPRT-FLD      TO  TRUE                  18050000
181400         SET  PS-REPRINT-FORM           TO  TRUE                  18060000
181500     ELSE                                                         18070000
181600         SET  PC255-FORM-NO-RPRT-BOX    TO  TRUE                  18080000
181700         SET  PC255-FORM-NO-RPRT-FLD    TO  TRUE                  18090000
181800         SET  PS-NOT-REPRINT-FORM       TO  TRUE                  18100000
181900     END-IF.                                                      18110000
182000***                                                               18120000
182100     MOVE PV-DC-PRTD-AT             TO  PV-DSPLY-DC.              18130000
182200     MOVE '-'                       TO  PV-DSPLY-DASH.            18140000
182300     MOVE PC204-SML-PRINTER         TO  PV-DSPLY-PRTR-ID.         18150000
182400     MOVE PV-DSPLY-PRTR             TO  PC255-SML-PRTR-NBR.       18160000
182500*                                                                 18170000
182600     MOVE PV-CURRENT-DB2-DATE       TO  PV-WORK-DB2-DATE.         18180000
182700     MOVE PV-WORK-YY                TO  PV-LBL-DATE-YY.           18190000
182800     MOVE PV-WORK-MM                TO  PV-LBL-DATE-MM.           18200000
182900     MOVE PV-WORK-DD                TO  PV-LBL-DATE-DD.           18210000
183000     MOVE '-'                       TO  PV-LBL-DASH1              18220000
183100                                        PV-LBL-DASH2.             18230000
183200     MOVE PV-LBL-DATE               TO  PC255-LBL-PRT-DATE.       18240000
183300*                                                                 18250000
183400     MOVE PV-CURRENT-TIME           TO  PC255-LBL-PRT-TIME.       18260000
183500*                                                                 18270000
183600     MOVE 'SM'                      TO  PC255-FROM-APPLICATION.   18280000
183700     MOVE 'LABEL'                   TO  PC255-PRTR-ATTACHED.      18290000
183800     MOVE '-SML-'                   TO  PC255-LBL-DESC.           18300000
183900     MOVE PC255-LABEL-INFO-WORK TO  PC255-LABEL-INFO.             18310000
184000                                                                  18320000
184100     SET  PC255-FORM-NO-FIX-HDG TO  TRUE.                         18330000
184200     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                             18340000
184300                                TO  PC255-SET.                    18350000
184400     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   18360000
184500                                TO  PC255-ERROR-MSG-1.            18370000
184600     MOVE PV-USER-ID            TO  PC255-USER-ID.                18380000
184700*gb 12/15/01 beg                                                  18390000
184800     MOVE '@@@@@@@@@@@@@@@@@@@@'                                  18400000
184900                                TO  PC255-SML-BARCODE.            18410000
185000     MOVE '@'                                                     18420000
185100                                TO  PC255-AUDIT-CASI.             18430000
185200                                                                  18440000
185300     SET PC255-SML-BRCD                                           18450000
185400         PC255-AUDIT-HDG-NO                                       18460000
185500         PC255-MFST-BOX-YES                                       18470000
185600         PC255-TEST-LNE-YES                                       18480000
185700         PC255-BRCD-NBR-ABOVE                                     18490000
185800         PC255-DEFLT-PRESENTATION                                 18500000
185900         PC255-SET-HDG             TO TRUE.                       18510000
186000                                                                  18520000
186100**audit complete level is space on label                          18530000
186200***  SET PC255-AUDIT-COMPLETE TO TRUE.                            18540000
186300                                                                  18550000
186400*gb 12/15/01 end                                                  18560000
186500*    IF PS-BAL-ON-HND-QTY-ZERO                                    18570000
186600*       SET PC255-OH-ZERO-YES TO TRUE                             18580000
186610*    ELSE                                                         18590000
186620*       SET PC255-OH-ZERO-NO TO TRUE                              18600000
186630*    END-IF.                                                      18610000
186640*                                                                 18620000
186650*----------------------------------------------------------------*18630000
186660* SEND SML LABEL FORM                                            *18640000
186670*----------------------------------------------------------------*18650000
186680 4560-SEND-SML-FORM.                                              18660000
186690     INITIALIZE PC133-LABEL-DTL-REC.                              18661000
186700     SET  PC133-LABEL-DTL           TO  TRUE.                     18662000
186800                                                                  18663000
186900     MOVE PC204-SMTHG-PRC-ID        TO  PC133-DTL-TRANS-ID.       18664000
187000     SET  PC255-IDX-2               TO  PC255-IDX.                18665000
187100     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  18666000
187200                                    TO  PC133-DTL-LENGTH.         18667000
187300     MOVE PC255-SHIP-MFST-LBL-LINE (PC255-IDX)                    18668000
187400                                    TO  PC133-DTL-DATA.           18669000
187500                                                                  18670000
187600     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    18680000
187700         '' BY SPACES.                                           18690000
187800     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    18700000
187900         ';' BY SPACES.                                           18710000
188000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    18720000
188100         LOW-VALUES BY SPACES.                                    18730000
188200                                                                  18740000
188300******************************************************************18750000
188400* LENGTH CALCULATION:                                            *18760000
188500*       LINE LENGTH SML FORM     (PC255-DTL-FORM-LNE-LNGTH)      *18770000
188600*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *18780000
188700*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *18790000
188800*              PC133-DTL-LENGTH        (3 POSITIONS)             *18800000
188900*              HEX 03-END EACH DTL REC (1 POSITIONS)             *18810000
189000*              FILLER                  (6 POSITIONS)             *18820000
189100******************************************************************18830000
189200     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        18840000
189300     MOVE PC255-DTL-FORM-LNE-LNGTH (PC255-IDX-2)                  18850000
189400                                  TO PC133-DTL-REC-LENGTH.        18860000
189500     ADD  20                      TO PC133-DTL-REC-LENGTH.        18870000
189600     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                18880000
189700                                     DP081-NBR-BYTES.             18890000
189800                                                                  18900000
189900     PERFORM 5100-SEND-DATA-TO-LPMS.                              18910000
190000                                                                  18920000
190100     ADD  1  TO  PV-TRAILER-COUNT.                                18930000
190200*                                                                 18940000
190300*                                                                 18950000
190400*----------------------------------------------------------------*18960000
190500*  BUILD SML LABEL DATA                                          *18970000
190600*----------------------------------------------------------------*18980000
190700 4561-BUILD-SML-DATA.                                             18990000
190800         INITIALIZE PC133-LABEL-DTL-REC.                          19000000
190900         SET PC133-LABEL-DTL           TO  TRUE.                  19010000
190910                                                                  19020000
190920         IF PS-PRSNT-MRCH-PGM-CKD-NO                              19030000
190930            PERFORM 2300-DETERMINE-STORE-ITEMS                    19040000
190940            SET PS-PRSNT-MRCH-PGM-CKD-YES TO TRUE                 19050000
190950         END-IF                                                   19060000
190960                                                                  19070000
190970*STORE NAME AND NUMBER                                            19080000
190980         MOVE PV-STORE-NBR             TO  PC256-SML-STR-NBR      19090000
190990*CRTN                                                             19091000
191000         SET PC256-SMTH-CRTN   TO TRUE                            19092000
191100*PO/RCVR                                                          19093000
191200         MOVE PC204-PO-NBR             TO  PV-PO-NUMBER           19094000
191300*                                                                 19095000
191400         MOVE PC204-REC-SEQ-NBR        TO  PV-RCVR-NBR            19096000
191500         MOVE PV-RCVR-NBR              TO PV-PO-RECEIVER          19097000
191600*                                                                 19098000
191700         MOVE PV-PO-RCVR               TO  PC256-PO-RCVR          19099000
191800****CHECK FOR MULTIPLE LINES                                      19100000
191900* LINE NUMBER                                                     19110000
192000         PERFORM 6250-CHECK-FOR-MULT                              19120000
192100         IF PS-MULTIPLE-LINES-FND                                 19130000
192200             MOVE ZEROES                   TO PC256-LINE-NBR      19140000
192300             MOVE '@@@@@@@@@@@@@@@@'       TO PC256-SKU           19150000
192400             MOVE '*MULTIPLE LINES *'      TO PC256-STYLE         19160000
192500             PERFORM 6275-SELECT-PO-DEPT                          19170000
192600         ELSE                                                     19180000
192700             MOVE SUT00028-TRN-LNE-NBR     TO  PV-LINE-NBR        19190000
192800             MOVE PV-PO-LINE-NBR           TO  PC256-LINE-NBR     19200000
192900*SKU                                                              19210000
193000             PERFORM 6300-GET-DEPT-CL-SKU                         19220000
193100             MOVE PV-SML-SKU-NUMBER        TO PC256-SKU           19230000
193200*STYLE                                                            19240000
193300             MOVE PURITM-VEND-STYL-NAME    TO PC256-STYLE         19250000
193400         END-IF                                                   19260000
193500         PERFORM 6400-LINK-XLKUT073                               19270000
193600                                                                  19280000
193610*OUTER PACK UNITS                                                 19290000
193620         MOVE '@@@@@'                  TO PC256-OTPK-UNIT         19300000
193630                                                                  19310000
193640         SET  PS-NO-MSG-1                                         19320000
193650              PS-NO-MSG-2              TO TRUE                    19330000
193660                                                                  19340000
193670*BARCODE                                                          19350000
193680         MOVE PC180-SML-BARCODE TO PV-20-DIGIT-BRCDE-18.          19360000
193690         MOVE ZEROES TO PC160-20-SML-NBR-CONTAINER-CDE            19361000
193700                        PV-20-SML-CONTAINER-CDE                   19362000
193800*                                                                 19363000
193900         MOVE  PV-20-SML-PACKAGING-TYP                            19364000
194000           TO  PC160-20-SML-NBR-PACKAGING-TYP                     19365000
194100         MOVE  PV-20-SML-SOFTWARE-SRC                             19366000
194200           TO  PC160-20-SML-NBR-SOFTWARE-SRC                      19367000
194300         MOVE  PV-20-SML-BC-DIVERT                                19368000
194400           TO  PC160-20-SML-NBR-BC-DIVERT                         19369000
194500         MOVE  PV-20-SML-BC-DC-ORIGIN                             19370000
194600           TO  PC160-20-SML-NBR-BC-DC-ORIGIN                      19380000
194700         MOVE  PV-20-SML-BC-MNFST-NBR                             19390000
194800           TO  PC160-20-SML-NBR-BC-MNFST-NBR                      19400000
194900         MOVE PC160-20-DIGIT-BARCODE-NBR TO PC256-BARCODE-TEXT    19410000
195000                                                                  19420000
195100         MOVE PV-20-DIGIT-BARCODE        TO PC256-SML-BARCODE     19430000
195200                                                                  19440000
195300*gb 12/20/01                                                      19450000
195400                                                                  19460000
195500         EVALUATE PV-HNG-FOLD-SEQ-NBR                             19470000
195600            WHEN  1                                               19480000
195700                SET PC256-HANG  TO TRUE                           19490000
195800            WHEN  2                                               19500000
195900                SET PC256-FOLD  TO TRUE                           19510000
196000            WHEN  OTHER                                           19520000
196100                SET PC256-DEFLT-PRESENTATION TO TRUE              19530000
196200         END-EVALUATE                                             19540000
196300                                                                  19550000
196400         MOVE PC-01                    TO PC256-SML-LBL-QTY       19560000
196500                                                                  19570000
196600*                                                                 19580000
196700         MOVE SUT00024-LBL-PRT-SEQ-NBR                            19590000
196800                                       TO PC256-LABEL-NBR.        19600000
196900         MOVE PC-OF                    TO PC256-LABEL-OF.         19610000
197000         MOVE PC204-TOT-LABELS-CNT     TO PC256-TOT-LABEL.        19620000
197100* Department name (inside of box)                                 19630000
197200         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'               19640000
197300                                      TO  PC256-POG-PROGRAM-NAME  19650000
      *CLP 06/24/2015 START                                             19651009
197310         IF PS-BRAND-FOUND-YES                                    19660002
                  PERFORM 4560-INSPECT-BUS-AREA                         19660102
                  MOVE PV-BUS-AREA-BRAND    TO PC256-POG-PROGRAM-NAME   19660202
      *CLP 06/24/2015 END                                               19660309
197331         ELSE                                                     19690000
197332            MOVE SUT00028-TRN-LNE-NBR     TO DK-PO-LNE-NBR        19700000
197333            PERFORM 6050-GET-CLASS-MAJ-CLASS                      19710000
197334            STRING PV-DEPT-DESC           DELIMITED BY '  '       19720000
197335                  '/'                   DELIMITED BY SIZE         19730000
197336                  PV-MAJ-CL-DESC        DELIMITED BY '   '        19731000
197337                                 INTO  PC256-POG-PROGRAM-NAME     19732000
197338         END-IF                                                   19733000
197339* fixture id                                                      19733100
197340***                                                               19733200
197341*** note:  smoothing manifest is a guess.  we really do           19733300
197350***        not know what is in the carton.  could be for          19733400
197360***        multiple lines on a po.  So we are not able to         19733500
197370***        display the actual fixture number since it             19733600
197371***        could be different for each line.                      19733700
197372***                                                               19733800
197380         SET  PC256-FIXTURE-HDG-NO  TO TRUE                       19733900
197390         MOVE '@@@@@'              to  PC256-FIXTURE              19734000
197400                                                                  19735000
197500* DOOR NUMBER                                                     19736000
197600         SET PC256-DOOR-HDG-YES  TO TRUE                          19737000
197700         PERFORM 6200-GET-CURRENT-DOOR                            19738000
197800         IF CNDCDR-DOOR-ID  > SPACES                              19739000
197900            MOVE CNDCDR-DOOR-ID  TO PC256-DOOR-NUMBER             19740000
198000         ELSE                                                     19750000
198100            SET PC256-DOOR-NBR-NO TO TRUE                         19760000
198200         END-IF                                                   19770000
198300* seasonal set                                                    19780000
198400*        IF  SEASET-SEASET-NM  >  SPACES                          19790000
198500*            MOVE SEASET-SEASET-NM     TO  PC256-SEASET           19800000
198600*        ELSE                                                     19810000
198700*            MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     19820000
198800*                                      TO  PC256-SEASET           19830000
198900*        END-IF.                                                  19840000
199000* ZONE                                                            19850000
199100*            MOVE '@@@@'               TO  PC256-ZONE             19860000
199200*            MOVE '@@@@@'              TO  PC256-ZONE-DESC.       19870000
199300*                                                                 19880000
199400***gb 12/20/01 beg                                                19890000
199500**                                                                19900000
199600         SET  PC256-AUDIT-COMPLETE TO TRUE.                       19910000
199700***                                                               19920000
199800***gb 12/20/01 end                                                19930000
199900*                                                                 19940000
200000*    IF PS-BAL-ON-HND-QTY-ZERO                                    19950000
200100*       SET PC256-OH-ZERO-MSG-YES TO TRUE                         19960000
200200*    ELSE                                                         19970000
200300*       SET PC256-OH-ZERO-MSG-NO TO TRUE                          19980000
200400*    END-IF.                                                      19990000
                                                                        19990102
      *CLP 06/24/2015 START                                             19991002
      ***************************************************************** 19992002
      * ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     19993002
      * AREA DESCRIPTION - PERFORM CALCULATES THE LENGTH OF THE FIELD   19994006
      * THEN MOVE AS MANY CHARACTERS AS THERE ARE UP TO 9               19994106
      ***************************************************************** 19995002
085610 4560-INSPECT-BUS-AREA.                                           19996002
                                                                        19997002
           MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         19997206
                                                                        19997306
126579     MOVE +0                               TO PV-DESC-LEN.        19997406
126580     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        19997506
126581                                                                  19997606
126582     PERFORM                                                      19997706
126583       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        19997806
126584         PV-DESC-LEN = +0                                         19997906
126585       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    19998006
126586     END-PERFORM.                                                 19998106
                                                                        19998204
           MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          19999502
                                                                        19999602
           EVALUATE TRUE                                                19999702
              WHEN  PV-DESC-LEN   =  9                                  19999806
                  STRING   PV-BUS-AREA-DESC-9(1:9)                      19999906
                                       '-'                              20000002
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20000102
                  INTO  PV-BUS-AREA-BRAND                               20000202
              WHEN  PV-DESC-LEN   =  8                                  20000306
                  STRING   PV-BUS-AREA-DESC-9(1:8)                      20000406
                                       '-'                              20000502
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20000602
                  INTO  PV-BUS-AREA-BRAND                               20000702
              WHEN  PV-DESC-LEN   =  7                                  20000806
                  STRING   PV-BUS-AREA-DESC-9(1:7)                      20000906
                                       '-'                              20001002
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20001102
                  INTO  PV-BUS-AREA-BRAND                               20001202
              WHEN  PV-DESC-LEN   =  6                                  20001306
                  STRING   PV-BUS-AREA-DESC-9(1:6)                      20001406
                                       '-'                              20001502
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20001602
                  INTO  PV-BUS-AREA-BRAND                               20001702
              WHEN  PV-DESC-LEN   =  5                                  20001806
                  STRING   PV-BUS-AREA-DESC-9(1:5)                      20001907
                                       '-'                              20002002
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20002102
                  INTO  PV-BUS-AREA-BRAND                               20002202
              WHEN  PV-DESC-LEN   =  4                                  20002306
                  STRING   PV-BUS-AREA-DESC-9(1:4)                      20002406
                                       '-'                              20002502
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20002602
                  INTO  PV-BUS-AREA-BRAND                               20002702
              WHEN  PV-DESC-LEN   =  3                                  20002806
                  STRING   PV-BUS-AREA-DESC-9(1:3)                      20002906
                                       '-'                              20003002
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20003102
                  INTO  PV-BUS-AREA-BRAND                               20003202
              WHEN  PV-DESC-LEN   =  2                                  20003306
                  STRING   PV-BUS-AREA-DESC-9(1:2)                      20003406
                                       '-'                              20003506
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20003606
                  INTO  PV-BUS-AREA-BRAND                               20003706
              WHEN  PV-DESC-LEN   =  1                                  20003806
                  STRING   PV-BUS-AREA-DESC-9(1:1)                      20003906
                                       '-'                              20004006
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20004106
                  INTO  PV-BUS-AREA-BRAND                               20004206
              WHEN  OTHER                                               20004302
      *           NO BUSINESS AREA AVAILABLE                            20004406
                  STRING   PV-BUS-AREA-DESC-9(1:9)                      20004506
                                       '-'                              20004606
                           XLT00043-BRND-DESC DELIMITED BY SIZE         20004702
                  INTO  PV-BUS-AREA-BRAND                               20004802
           END-EVALUATE.                                                20004902
                                                                        20005002
      *CLP 06/24/2015 END                                               20005102
200500*----------------------------------------------------------------*20006000
200600* SEND SML LABEL DATA                                            *20010000
200700*----------------------------------------------------------------*20020000
200800 4562-SEND-SML-DATA.                                              20030000
200900     SET  PC133-LABEL-DTL           TO  TRUE.                     20040000
201000     MOVE PC204-SMTHG-PRC-ID        TO  PC133-DTL-TRANS-ID.       20050000
201100     SET  PC256-IDX-2               TO  PC256-IDX.                20060000
201200     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  20070000
201300                                    TO  PC133-DTL-LENGTH.         20080000
201400     MOVE PC256-SML-LABEL-LINE (PC256-IDX)                        20090000
201500                                    TO  PC133-DTL-DATA.           20100000
201600                                                                  20110000
201700     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20120000
201800         '' BY SPACES.                                           20130000
201900     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20140000
202000         ';' BY SPACES.                                           20150000
202100     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20160000
202200         LOW-VALUES BY SPACES.                                    20170000
202300                                                                  20180000
202400******************************************************************20190000
202500* LENGTH CALCULATION:                                            *20200000
202600*       LINE LENGTH SML DATA     (PC256-DTL-DATA-LNE-LNGTH)      *20210000
202700*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *20220000
202800*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *20230000
202900*              PC133-DTL-LENGTH        (3 POSITIONS)             *20240000
203000*              HEX 03-END EACH DTL REC (1 POSITIONS)             *20250000
203100*              FILLER                  (6 POSITIONS)             *20260000
203200******************************************************************20270000
203300     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        20280000
203400     MOVE PC256-DTL-DATA-LNE-LNGTH (PC256-IDX-2)                  20290000
203500                                  TO PC133-DTL-REC-LENGTH.        20300000
203600     ADD  20                      TO PC133-DTL-REC-LENGTH.        20310000
203700     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                20320000
203800                                     DP081-NBR-BYTES.             20330000
203900                                                                  20340000
204000     PERFORM 5100-SEND-DATA-TO-LPMS.                              20350000
204100                                                                  20360000
204200     ADD  1  TO  PV-TRAILER-COUNT.                                20370000
204300*                                                                 20380000
204400*                                                                 20390000
204500*----------------------------------------------------------------*20400000
204600* SEND TRAILER LABEL                                             *20410000
204700*----------------------------------------------------------------*20420000
204800 4590-TLR-LABEL.                                                  20430000
204900                                                                  20440000
205000     INITIALIZE PC133-LABEL-DTL-REC.                              20450000
205100     SET  PC133-LABEL-DTL           TO  TRUE.                     20460000
205200                                                                  20470000
205300     MOVE PC204-SMTHG-PRC-ID        TO  PC133-DTL-TRANS-ID.       20480000
205400     SET  PC137-IDX-2               TO  PC137-IDX.                20490000
205500     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     20500000
205600                                    TO  PC133-DTL-LENGTH.         20510000
205700     MOVE PC137-SML-TRAILER-LABEL-LINE (PC137-IDX)                20520000
205800                                    TO  PC133-DTL-DATA.           20530000
205900                                                                  20540000
206000     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20550000
206100         '' BY SPACES.                                           20560000
206200     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20570000
206300         ';' BY SPACES.                                           20580000
206400     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    20590000
206500         LOW-VALUES BY SPACES.                                    20600000
206600                                                                  20610000
206700******************************************************************20620000
206800* LENGTH CALCULATION:                                            *20630000
206900*       LINE LENGTH TRAILER LBL  (PC137-TLR-LINE-LENGTH)         *20640000
207000*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *20650000
207100*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *20660000
207200*              PC133-DTL-LENGTH        (3 POSITIONS)             *20670000
207300*              HEX 03-END EACH DTL REC (1 POSITIONS)             *20680000
207400*              FILLER                  (6 POSITIONS)             *20690000
207500******************************************************************20700000
207600     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        20710000
207700     MOVE PC137-TLR-LINE-LENGTH (PC137-IDX-2)                     20720000
207800                                  TO PC133-DTL-REC-LENGTH.        20730000
207900     ADD  20                      TO PC133-DTL-REC-LENGTH.        20740000
208000     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                20750000
208100                                     DP081-NBR-BYTES.             20760000
208200                                                                  20770000
208300     PERFORM 5100-SEND-DATA-TO-LPMS.                              20780000
208400                                                                  20790000
208500     ADD  1  TO  PV-TRAILER-COUNT.                                20800000
208600                                                                  20810000
208700                                                                  20820000
208800*----------------------------------------------------------------*20830000
208900*                                                                *20840000
209000*----------------------------------------------------------------*20850000
209100 4600-BLD-TLR-REC.                                                20860000
209200                                                                  20870000
209300     INITIALIZE PC133-LABEL-TLR-REC.                              20880000
209400     SET  PC133-LABEL-TLR           TO  TRUE.                     20890000
209500                                                                  20900000
209600     MOVE PC204-SMTHG-PRC-ID        TO  PC133-TLR-TRANS-ID.       20910000
209700     MOVE PV-TRAILER-COUNT          TO  PC133-TLR-RECORD-COUNT.   20920000
209800                                                                  20930000
209900     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    20940000
210000         '' BY SPACES.                                           20950000
210100     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    20960000
210200         ';' BY SPACES.                                           20970000
210300     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    20980000
210400         LOW-VALUES BY SPACES.                                    20990000
210500                                                                  21000000
210600     MOVE PC133-TLR-REC-LENGTH    TO DP081-TCPLENG                21010000
210700                                     DP081-NBR-BYTES.             21020000
210800                                                                  21030000
210900     PERFORM 5100-SEND-DATA-TO-LPMS.                              21040000
211000                                                                  21050000
211100                                                                  21060000
211200*----------------------------------------------------------------*21070000
211300* GENERATE LABEL HISTORY INFORMATION                             *21080000
211400*----------------------------------------------------------------*21090000
211500 4700-LABEL-HISTORY.                                              21100000
211600                                                                  21110000
211700     INITIALIZE  DCLTLBTKHS                                       21120000
211800                 DCLTLBTKID.                                      21130000
211900                                                                  21140000
212000     MOVE  PC204-SMTHG-PRC-ID       TO LBTKHS-LBL-REQ-TRN-ID.     21150000
212100     MOVE  PC-SMOOTHING-LBL-APPL    TO LBTKHS-LBL-TYP-CDE.        21160000
212200     MOVE  PV-USER-ID               TO LBTKHS-CRED-BY-USR-ID.     21170000
212300     MOVE  PC-CURRENT-PROGRAM-NAME  TO LBTKHS-REQ-PGM-NM.         21180000
212400     MOVE  ZEROES                   TO LBTKHS-LOC-ID.             21190000
212500     MOVE  PC204-TOT-LABELS-CNT     TO LBTKHS-LBL-PRT-QTY.        21200000
212600     ADD   2                        TO LBTKHS-LBL-PRT-QTY.        21210000
212700     MOVE  PC204-SML-PRINTER        TO LBTKHS-PRTR-ID.            21220000
212800     MOVE  PC204-OPER-UNT-ID        TO LBTKHS-PRTR-OPER-UNT-ID.   21230000
212900     MOVE  PC204-FCLTY-ID           TO LBTKHS-PRTR-FCLTY-ID.      21240000
213000     MOVE  PC-SOCKET-INTERFACE      TO LBTKHS-XMIT-INTFC-CDE.     21250000
213100     MOVE  PC-A                     TO LBTKHS-XMIT-STAT-CDE.      21260000
213200     MOVE  ZERO                     TO LBTKHS-USR-LBL-ID-LEN.     21270000
213300                                                                  21280000
213400     PERFORM 4710-INSERT-TLBTKHS.                                 21290000
213500                                                                  21300000
213600     MOVE  PC204-SMTHG-PRC-ID       TO LBTKID-LBL-REQ-TRN-ID.     21310000
213700     MOVE  PC-SMOOTHING-LBL-APPL    TO LBTKID-LBL-TYP-CDE.        21320000
213800     MOVE  PC204-PO-NBR             TO LBTKID-PO-NBR.             21330000
213900     MOVE  PC204-REC-SEQ-NBR        TO LBTKID-RCVR-SEQ-NBR.       21340000
214000     MOVE  ZEROES                   TO LBTKID-PO-LNE-NBR.         21350000
214100     MOVE  ZEROES                   TO LBTKID-TRIP-ID.            21360000
214200     MOVE  ZEROES                   TO LBTKID-LBL-PRT-BTCH-ID.    21370000
214300     MOVE  PC204-TOT-LABELS-CNT     TO LBTKID-LBL-PRT-QTY.        21380000
214400     MOVE  2                        TO LBTKID-SEPOR-LBL-PRT-QTY.  21390000
214500                                                                  21400000
214600     PERFORM 4720-INSERT-LBTKID.                                  21410000
214700                                                                  21420000
214800     PERFORM 9100-SYNCPOINT.                                      21430000
214900                                                                  21440000
215000*----------------------------------------------------------------*21450000
215100* INSERT INTO TLBTKHS - LABEL HISTORY                            *21460000
215200*----------------------------------------------------------------*21470000
215300 4710-INSERT-TLBTKHS.                                             21480000
215400                                                                  21490000
215500     EXEC SQL                                                     21500000
215600         INSERT INTO TLBTKHS                                      21510000
215700               (LBL_REQ_TRN_ID,                                   21520000
215800                LBL_TYP_CDE,                                      21530000
215900                CRE_TMST,                                         21540000
216000                CRED_BY_USR_ID,                                   21550000
216100                REQ_PGM_NM,                                       21560000
216200                LOC_ID,                                           21570000
216300                LBL_PRT_QTY,                                      21580000
216400                PRTR_ID,                                          21590000
216500                PRTR_OPER_UNT_ID,                                 21600000
216600                PRTR_FCLTY_ID,                                    21610000
216700                XMIT_INTFC_CDE,                                   21620000
216800                XMIT_STAT_CDE,                                    21630000
216900                USR_LBL_ID)                                       21640000
217000         VALUES                                                   21650000
217100               (:LBTKHS-LBL-REQ-TRN-ID,                           21660000
217200                :LBTKHS-LBL-TYP-CDE,                              21670000
217300                CURRENT TIMESTAMP,                                21680000
217400                :LBTKHS-CRED-BY-USR-ID,                           21690000
217500                :LBTKHS-REQ-PGM-NM,                               21700000
217600                :LBTKHS-LOC-ID,                                   21710000
217700                :LBTKHS-LBL-PRT-QTY,                              21720000
217800                :LBTKHS-PRTR-ID,                                  21730000
217900                :LBTKHS-PRTR-OPER-UNT-ID,                         21740000
218000                :LBTKHS-PRTR-FCLTY-ID,                            21750000
218100                :LBTKHS-XMIT-INTFC-CDE,                           21760000
218200                :LBTKHS-XMIT-STAT-CDE,                            21770000
218300                :LBTKHS-USR-LBL-ID)                               21780000
218400     END-EXEC.                                                    21790000
218500                                                                  21800000
218600     EVALUATE TRUE                                                21810000
218700         WHEN SQLCODE = ZERO                                      21820000
218800             CONTINUE                                             21830000
218900         WHEN SQLWARN0 NOT = SPACES                               21840000
219000         WHEN SQLCODE NOT EQUAL ZERO                              21850000
219100              INITIALIZE  PV-CICS-MSG-AREA                        21860000
219200              MOVE SQLCODE             TO PV-SQL-RETURN-CD        21870000
219300              STRING ' PCKCS728 - '             DELIMITED BY SIZE 21880000
219400                     '4710-INSERT-TLBTKHS    ' DELIMITED BY SIZE  21890000
219500                     '  SQL - '                 DELIMITED BY SIZE 21900000
219600                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 21910000
219700                                           INTO PV-CICS-MSG-AREA  21920000
219800              MOVE LENGTH OF PV-CICS-MSG-AREA                     21930000
219900                     TO PV-COMMAREA-LENGTH                        21940000
220000              PERFORM 9990-WRITE-CICS                             21950000
220100              INITIALIZE  PV-CICS-MSG-AREA                        21960000
220200              STRING ' PCKCS728 -'             DELIMITED BY SIZE  21970000
220300                     ' PO:'                    DELIMITED BY SIZE  21980000
220400                     PV-PO-NBR                 DELIMITED BY SIZE  21990000
220500                     ' RCVR:'                  DELIMITED BY SIZE  22000000
220600                     PV-RCVR-NBR               DELIMITED BY SIZE  22010000
220700                     ' STR:'                   DELIMITED BY SIZE  22020000
220800                     PV-STORE-NBR              DELIMITED BY SIZE  22030000
220900                                           INTO PV-CICS-MSG-AREA  22040000
221000              MOVE LENGTH OF PV-CICS-MSG-AREA                     22050000
221100                     TO PV-COMMAREA-LENGTH                        22060000
221200              PERFORM 9990-WRITE-CICS                             22070000
221300              SET PC204-SQL-ERROR                                 22080000
221400                  PS-ERROR         TO TRUE                        22090000
221500     END-EVALUATE.                                                22100000
221600                                                                  22110000
221700                                                                  22120000
221800*----------------------------------------------------------------*22130000
221900* INSERT INTO TLBTKID - LABEL IDENTIFICATION                     *22140000
222000*----------------------------------------------------------------*22150000
222100 4720-INSERT-LBTKID.                                              22160000
222200                                                                  22170000
222300     EXEC SQL                                                     22180000
222400         INSERT INTO TLBTKID                                      22190000
222500               (LBL_REQ_TRN_ID,                                   22200000
222600                LBL_TYP_CDE,                                      22210000
222700                PO_NBR,                                           22220000
222800                RCVR_SEQ_NBR,                                     22230000
222900                PO_LNE_NBR,                                       22240000
223000                TRIP_ID,                                          22250000
223100                LBL_PRT_BTCH_ID,                                  22260000
223200                LBL_PRT_QTY,                                      22270000
223300                SEPOR_LBL_PRT_QTY)                                22280000
223400         VALUES                                                   22290000
223500               (:LBTKID-LBL-REQ-TRN-ID,                           22300000
223600                :LBTKID-LBL-TYP-CDE,                              22310000
223700                :LBTKID-PO-NBR,                                   22320000
223800                :LBTKID-RCVR-SEQ-NBR,                             22330000
223900                :LBTKID-PO-LNE-NBR,                               22340000
224000                :LBTKID-TRIP-ID,                                  22350000
224100                :LBTKID-LBL-PRT-BTCH-ID,                          22360000
224200                :LBTKID-LBL-PRT-QTY,                              22370000
224300                :LBTKID-SEPOR-LBL-PRT-QTY)                        22380000
224400     END-EXEC.                                                    22390000
224500                                                                  22400000
224600     EVALUATE TRUE                                                22410000
224700         WHEN SQLCODE = ZERO                                      22420000
224800             CONTINUE                                             22430000
224900         WHEN SQLWARN0 NOT = SPACES                               22440000
225000         WHEN SQLCODE NOT EQUAL ZERO                              22450000
225100              INITIALIZE  PV-CICS-MSG-AREA                        22460000
225200              MOVE SQLCODE             TO PV-SQL-RETURN-CD        22470000
225300              STRING ' PCKCS728 - '             DELIMITED BY SIZE 22480000
225400                     '4720-INSERT-LBTKID     ' DELIMITED BY SIZE  22490000
225500                     '  SQL - '                 DELIMITED BY SIZE 22500000
225600                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 22510000
225700                                           INTO PV-CICS-MSG-AREA  22520000
225800              MOVE LENGTH OF PV-CICS-MSG-AREA                     22530000
225900                     TO PV-COMMAREA-LENGTH                        22540000
226000              PERFORM 9990-WRITE-CICS                             22550000
226100              INITIALIZE  PV-CICS-MSG-AREA                        22560000
226200              STRING ' PCKCS728 -'             DELIMITED BY SIZE  22570000
226300                     ' PO:'                    DELIMITED BY SIZE  22580000
226400                     PV-PO-NBR                 DELIMITED BY SIZE  22590000
226500                     ' RCVR:'                  DELIMITED BY SIZE  22600000
226600                     PV-RCVR-NBR               DELIMITED BY SIZE  22610000
226700                     ' STR:'                   DELIMITED BY SIZE  22620000
226800                     PV-STORE-NBR              DELIMITED BY SIZE  22630000
226900                                           INTO PV-CICS-MSG-AREA  22640000
227000              MOVE LENGTH OF PV-CICS-MSG-AREA                     22650000
227100                     TO PV-COMMAREA-LENGTH                        22660000
227200              PERFORM 9990-WRITE-CICS                             22670000
227300              SET PC204-SQL-ERROR                                 22680000
227400                  PS-ERROR         TO TRUE                        22690000
227500     END-EVALUATE.                                                22700000
227600*----------------------------------------------------------------*22710000
227700*  GET LPMS RETURN CODE                                          *22720000
227800*----------------------------------------------------------------*22730000
227900 4740-GET-LPMS-RETURN.                                            22740000
228000                                                                  22750000
228100     SEARCH ALL PC138-SOCKET-ERRORS                               22760000
228200            AT END                                                22770000
228300                MOVE 'Z' TO  PV-LPMS-XMIT-RETURN                  22780000
228400            WHEN                                                  22790000
228500                PC138-CONFIRM-CODE(PC138-IDX)  =                  22800000
228600                PC133-CONFIRM-CODE                                22810000
228700                    MOVE PC138-XREF-CODE(PC138-IDX)               22820000
228800                      TO PV-LPMS-XMIT-RETURN.                     22830000
228900                                                                  22840000
229000                                                                  22850000
229100                                                                  22860000
229200*----------------------------------------------------------------*22870000
229300*  SEND HEADER LABEL                                             *22880000
229400*----------------------------------------------------------------*22890000
229500 4800-CREATE-HEADER-LABEL.                                        22900000
229600* SEND HEADER LABEL                                               22910000
229700                                                                  22920000
229800     SET  PC133-LABEL-DTL             TO TRUE.                    22930000
229900     MOVE PV-USER-ID                  TO PC207-REQUESTED-BY.      22940000
230000     IF  PS-REPRINT-BATCH                                         22950000
230100         MOVE '1X1100000100045L115025'   TO PC207-REPRINT-BOX     22960000
230200         MOVE '341100500320150*REPRINT*' TO PC207-REPRINT-FIELD   22970000
230300         MOVE PC204-TOT-LABELS-CNT       TO PC207-REPRINT-LBL-CNT 22980000
230400     ELSE                                                         22990000
230500         MOVE '1X1100000100045L000000'   TO PC207-REPRINT-BOX     23000000
230600         MOVE '341100500320150@@@@@@@@@' TO PC207-REPRINT-FIELD   23010000
230700         MOVE  ZERO                      TO PC207-REPRINT-LBL-CNT 23020000
230800     END-IF.                                                      23030000
230900     MOVE '@@@@@@@@@@'                TO PC207-TRAILER.           23040000
231000     MOVE  PV-PO-RCVR                 TO PC207-RECEIVER.          23050000
231100                                                                  23060000
231200     IF PC204-RESMOOTH-CRTNS-ADD                                  23070000
231300        MOVE PC204-ADDL-LABELS-REQ       TO PV-TOT-LABELS-ADD     23080000
231400        MOVE PV-TOT-LABELS-ADD           TO PC207-SML-LBL-CNT     23090000
231500     ELSE                                                         23100000
231600        MOVE PC204-TOT-LABELS-CNT        TO PC207-SML-LBL-CNT     23110000
231700     END-IF                                                       23120000
231800     MOVE PC204-SML-PRINTER           TO PC207-PRINTER-ID.        23130000
231900     MOVE PV-CURRENT-MM-DD            TO PC207-SUBMIT-MMDD.       23140000
232000     MOVE PV-CURRENT-TIME             TO PC207-SUBMIT-HHMM.       23150000
232100                                                                  23160000
232200     IF  PV-DB2-EXCEPT-LBL-CNT  >  ZERO                           23170000
232300         MOVE '1X1100003300045L465050' TO PC207-EXCEPT-BOX        23180000
232400         MOVE '342200503720390EXCEPTIONS EXIST'                   23190000
232500                                       TO PC207-EXCEPT-FIELD      23200000
232600     ELSE                                                         23210000
232700         MOVE '1X1100003300045L000000' TO PC207-EXCEPT-BOX        23220000
232800         MOVE '342200503720390@@@@@@@@@@@@@@@@'                   23230000
232900                                       TO PC207-EXCEPT-FIELD      23240000
233000     END-IF.                                                      23250000
233100                                                                  23260000
233200     PERFORM 4511-HDR-LABEL                                       23270000
233300             VARYING PC207-IDX FROM 1 BY 1                        23280000
233400               UNTIL PC207-IDX > PC207-HEADER-LABEL-MAX-LN        23290000
233500                  OR PS-SOCKET-ERROR.                             23300000
233600                                                                  23310000
233700*----------------------------------------------------------------*23320000
233800*  SEND TRAILER LABEL                                            *23330000
233900*----------------------------------------------------------------*23340000
234000 4810-CREATE-TRAILER-LABEL.                                       23350000
234100                                                                  23360000
234200     MOVE PV-USER-ID                 TO PC137-REQUESTED-BY.       23370000
234300     MOVE '@@@@'                     TO PC137-SCAC.               23380000
234400     MOVE '@@@@@@@@@@'               TO PC137-TRAILER.            23390000
234500     MOVE '@@@@@@@@@'                TO PC137-TRIP.               23400000
234600     MOVE '1'                        TO PC137-BATCH-NBR.          23410000
234700                                                                  23420000
234800     IF  PS-REPRINT-BATCH                                         23430000
234900         MOVE '1X1100000100045L115025'   TO PC137-REPRINT-BOX     23440000
235000         MOVE '341100500320150*REPRINT*' TO PC137-REPRINT-FIELD   23450000
235100         SET  PS-REPRINT-BATCH           TO TRUE                  23460000
235200     ELSE                                                         23470000
235300         MOVE '1X1100000100045L000000'   TO PC137-REPRINT-BOX     23480000
235400         MOVE '341100500320150@@@@@@@@@' TO PC137-REPRINT-FIELD   23490000
235500         SET  PS-NOT-REPRINT-BATCH       TO TRUE                  23500000
235600     END-IF.                                                      23510000
235700                                                                  23520000
235800     MOVE '1X1100003300045L000000' TO PC137-EXCEPT-BOX            23530000
235900     MOVE '342200503720390@@@@@@@@@@@@@@@@'                       23540000
236000                                       TO PC137-EXCEPT-FIELD      23550000
236100                                                                  23560000
236200     PERFORM 4590-TLR-LABEL                                       23570000
236300             VARYING PC137-IDX FROM 1 BY 1                        23580000
236400               UNTIL PC137-IDX > PC137-SML-TRAILER-LABEL-MAX-LN   23590000
236500                  OR PS-SOCKET-ERROR.                             23600000
236600                                                                  23610000
236700                                                                  23620000
236800*----------------------------------------------------------------*23630000
236900*  CREATE SHIPPING MANIFEST LABEL                                *23640000
237000*----------------------------------------------------------------*23650000
237100 4900-CREATE-SML-LABEL.                                           23660000
237200*                                                                 23670000
237300     PERFORM 2800-CALL-STORE-ON-HAND-MOD.                         23680000
237301* BBR WR41309 - RFID PROCESSING                                   23690000
237302**** IF NOT PC204-AUTO-CONVEY-NO-CRTNS                            23700000
237303         PERFORM 5000-CALL-RFID-MODULE.                           23710001
237304* BBR WR41309 - END                                               23720000
237310     IF PS-PREV-PROCESS-MESSAGE-SW NOT = XL088-PROCESS-MSG-IND    23730000
237320        SET PS-FIRST-LABEL TO TRUE                                23731000
237330     END-IF                                                       23732000
237340*  SEND SML LABEL FORM                                            23733000
237350*                                                                 23734000
237360     IF PS-FIRST-LABEL                                            23735000
237370        PERFORM 4559-BUILD-SML-FORM                               23736000
237380        PERFORM 4560-SEND-SML-FORM                                23737000
237390            VARYING PC255-IDX FROM 1 BY 1                         23738000
237400            UNTIL PC255-IDX >                                     23739000
237500                  PC255-SML-BATCH-LBL-MAX-LN                      23740000
237600            OR PS-SOCKET-ERROR                                    23750000
237700        SET PS-NOT-FIRST-LABEL TO TRUE                            23760000
237800     END-IF.                                                      23770000
237900*                                                                 23780000
238000     PERFORM 4561-BUILD-SML-DATA                                  23790000
238100     PERFORM 4562-SEND-SML-DATA                                   23800000
238200         VARYING PC256-IDX FROM 1 BY 1                            23810000
238300           UNTIL PC256-IDX > PC256-MAX-LABEL-LINES                23820000
238400              OR PS-SOCKET-ERROR                                  23830000
238500              OR PS-ERROR.                                        23840000
238600                                                                  23850000
238700*                                                                 23860000
238800     MOVE XL088-PROCESS-MSG-IND TO PS-PREV-PROCESS-MESSAGE-SW.    23870000
238900*                                                                 23880000
088690* BBR WR41309 - CALL RFID DETERMINATION MODULE                    23890000
088690*----------------------------------------------------------------*23891000
088690 5000-CALL-RFID-MODULE.                                           23892000
088690                                                                  23893000
088690     INITIALIZE SU093-ITEM-COMMAREA.                              23894000
088690                                                                  23895000
088690     SET SU093-SMOOTHING              TO TRUE.                    23896000
           SET SU093-RFID-STR-CHK-NEEDED-YES TO TRUE.                   23897000
088775     SET SU093-CHECK-BY-DEPT-SUBCLS-YES  TO TRUE                  23898000
088776     SET SU093-CHECK-BY-DEPT-IN-STR-YES  TO TRUE                  23899000
088778     SET SU093-CHECK-BY-DC               TO TRUE                  23899100
                                                                        23899200
088690     MOVE PC204-PO-NBR                 TO SU093-KEY-PO.           23899300
088690     MOVE PC204-REC-SEQ-NBR            TO SU093-KEY-REC-SEQ-NBR.  23899400
088690     MOVE PV-STORE-NBR                 TO SU093-KEY-DEST-LOC.     23899500
088690     MOVE PC204-OPER-UNT-ID            TO SU093-KEY-OPER-UNT-ID   23899600
088690                                                                  23899700
088690     CALL SU093-RFID-PGM       USING DFHEIBLK                     23899800
088690                                     SU093-COMMAREA               23899900
088690                                     SU093-ITEM-COMMAREA.         23900000
088690                                                                  23900100
088690     EVALUATE TRUE                                                23900200
088690       WHEN SU093-SUCCESSFUL                                      23900300
088690            IF SU093-RFID-YES                                     23900400
088690** SB 06/06/13 PR5148B START                                      23900500
8690               IF SU093-VNDR-DPT-RFID-COMPLI-YES AND                23900600
8690                  SU093-DC-DEPT-TAGS-NO                             23900700
8690                  SET  PC256-TEXT-4-NO      TO TRUE                 23900800
8690               ELSE                                                 23900900
8690  **SB 06/06/13 PR5148B END                                         23901000
                     IF SU093-RFID-KOHL-DPT-IN-STR-YES                  23902000
8690                    MOVE PV-RFID-STORE-TXT-4  TO PC256-TEXT-4       23903000
8690                    SET  PC204-RFID-STORE-YES TO TRUE               23904000
                     ELSE                                               23905000
8690                    SET  PC256-TEXT-4-NO      TO TRUE               23905100
                     END-IF                                             23905200
088690             END-IF                                               23905300
088690            ELSE                                                  23905400
088690               SET     PC256-TEXT-4-NO      TO TRUE               23905500
088690            END-IF                                                23905600
088690       WHEN OTHER                                                 23905700
088690            INITIALIZE  PV-CICS-MSG-AREA                          23905800
088690            MOVE SU093-SQLCODE TO PV-SQL-RETURN-CD                23905900
088690            STRING ' PCKCS728 - '             DELIMITED BY SIZE   23906000
088690                   '5000-CALL-RFID-MODULE'    DELIMITED BY SIZE   23906100
088690                   '  SQL - '                 DELIMITED BY SIZE   23906200
088690                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   23906300
088690                                         INTO PV-CICS-MSG-AREA    23906400
088690            MOVE LENGTH OF PV-CICS-MSG-AREA                       23906500
088690                   TO PV-COMMAREA-LENGTH                          23906600
097398            PERFORM 9990-WRITE-CICS                               23906700
088690            INITIALIZE  PV-CICS-MSG-AREA                          23906800
088690            STRING ' PCKCS728 -'             DELIMITED BY SIZE    23906900
088690                   ' PO:'                    DELIMITED BY SIZE    23907000
088690                   PV-PO-NBR                 DELIMITED BY SIZE    23907100
088690                   ' RCVR:'                  DELIMITED BY SIZE    23907200
088690                   PV-RCVR-NBR               DELIMITED BY SIZE    23907300
088690                                         INTO PV-CICS-MSG-AREA    23907400
088690            MOVE LENGTH OF PV-CICS-MSG-AREA                       23907500
088690                   TO PV-COMMAREA-LENGTH                          23907600
097398            PERFORM 9990-WRITE-CICS                               23907700
097408            MOVE LENGTH OF PV-CICS-MSG-AREA                       23907800
097409                TO PV-COMMAREA-LENGTH                             23907900
097410            PERFORM 9990-WRITE-CICS                               23908000
097411            SET PC204-SQL-ERROR                                   23908100
097412                PS-ERROR         TO TRUE                          23908200
097413     END-EVALUATE.                                                23908300
239000*----------------------------------------------------------------*23908400
239100*  CONNECT THE PATH (SOCKET).                                    *23908500
239200*----------------------------------------------------------------*23908600
239300 5100-SEND-DATA-TO-LPMS.                                          23908700
239400                                                                  23908800
239500     MOVE LOW-VALUES              TO TCP-BUF2.                    23908900
239600**   MOVE 100                     TO DP081-TCPLENG                23909000
239700**                                   DP081-NBR-BYTES.             23910000
239800     MOVE PC133-LABEL-RECORD      TO TCP-BUF2.                    23920000
239900     MOVE PC133-LABEL-RECORD      TO PV-DISPLAY-DOWNLOAD.         23930000
240000                                                                  23940000
240100*** BEGIN - FOR TESTING ONLY                                      23950000
240200*    STRING '  '                 DELIMITED BY SIZE                23960000
240300*           'PCKCS728 '          DELIMITED BY SIZE                23970000
240400*                                INTO PV-CICS-MSG-AREA.           23980000
240500*    PERFORM 9990-WRITE-CICS.                                     23990000
240600*    STRING ' '                   DELIMITED BY SIZE               24000000
240700*           PV-DISPLAY-DOWNLOAD-1 DELIMITED BY SIZE               24010000
240800*                                INTO PV-CICS-MSG-AREA.           24020000
240900*    PERFORM 9990-WRITE-CICS.                                     24030000
241000*    STRING ' '                   DELIMITED BY SIZE               24040000
241100*           PV-DISPLAY-DOWNLOAD-2 DELIMITED BY SIZE               24050000
241200*                                INTO PV-CICS-MSG-AREA.           24060000
241300*    PERFORM 9990-WRITE-CICS.                                     24070000
241400*    STRING ' '                   DELIMITED BY SIZE               24080000
241500*           PV-DISPLAY-DOWNLOAD-3 DELIMITED BY SIZE               24090000
241600*                                INTO PV-CICS-MSG-AREA.           24100000
241700*    PERFORM 9990-WRITE-CICS.                                     24110000
241800*** END - FOR TESTING ONLY                                        24120000
241900                                                                  24130000
242000*-----------------------------------------------------*           24140000
242100*                                                     *           24150000
242200*-----------------------------------------------------*           24160000
242300     CALL 'EZACIC04'                                              24170000
242400         USING DP081-TOASCII-TOKEN                                24180000
242500               TCP-BUF2                                           24190000
242600               DP081-TCPLENG.                                     24200000
242700                                                                  24210000
242800*-----------------------------------------------------*           24220000
242900*                                                     *           24230000
243000*-----------------------------------------------------*           24240000
243100*                                                                 24250000
243200*** BEGIN - FOR TESTING ONLY                                      24260000
243300*    MOVE  DP081-SOCK-ID    TO  PV-DISPLAY-SOCK-ID.               24270000
243400*    MOVE  DP081-FLAG       TO  PV-DISPLAY-FLAG.                  24280000
243500*    MOVE  DP081-NBR-BYTES  TO  PV-DISPLAY-NBR-BYTES.             24290000
243600*    STRING ' '                  DELIMITED BY SIZE                24300000
243700*           'PCKCS728-'          DELIMITED BY SIZE                24310000
243800*           'DP081-SEND-CMD-'    DELIMITED BY SIZE                24320000
243900*           DP081-SEND-CMD       DELIMITED BY SIZE                24330000
244000*           ' DP081-SOCK-ID-'    DELIMITED BY SIZE                24340000
244100*           PV-DISPLAY-SOCK-ID   DELIMITED BY SIZE                24350000
244200*           ' DP081-FLAG-'       DELIMITED BY SIZE                24360000
244300*           PV-DISPLAY-FLAG      DELIMITED BY SIZE                24370000
244400*                                INTO PV-CICS-MSG-AREA.           24380000
244500*    PERFORM 9990-WRITE-CICS.                                     24390000
244600*    STRING ' '                  DELIMITED BY SIZE                24400000
244700*           'PCKCS728-'          DELIMITED BY SIZE                24410000
244800*           ' DP081-NBR-BYTES'   DELIMITED BY SIZE                24420000
244900*           PV-DISPLAY-NBR-BYTES DELIMITED BY SIZE                24430000
245000*                                INTO PV-CICS-MSG-AREA.           24440000
245100*    PERFORM 9990-WRITE-CICS.                                     24450000
245200*** END - FOR TESTING ONLY                                        24460000
245300                                                                  24470000
245400     SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         24480000
245500                                                                  24490000
245600     CALL 'EZASOKET'                                              24500000
245700         USING DP081-SEND-CMD                                     24510000
245800               DP081-SOCK-ID                                      24520000
245900               DP081-FLAG                                         24530000
246000               DP081-NBR-BYTES                                    24540000
246100               TCP-BUF2                                           24550000
246200               DP081-ERRNO                                        24560000
246300               DP081-RETCODE.                                     24570000
246400                                                                  24580000
246500*-----------------------------------------------------*           24590000
246600*                                                     *           24600000
246700*-----------------------------------------------------*           24610000
246800                                                                  24620000
246900     IF  DP081-RETCODE < ZERO                                     24630000
247000         SET  PS-SOCKET-ERROR        TO TRUE                      24640000
247100         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    24650000
247200         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    24660000
247300         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      24670000
247400                                        RECEIVE-ERRNO             24680000
247500         MOVE DP081-RETCODE          TO RECEIVE-RETCODE           24690000
247600         MOVE PC204-PO-NBR           TO RECEIVE-RECEIVER          24700000
247700         MOVE PC204-REC-SEQ-NBR      TO RECEIVE-SEQ               24710000
247800         MOVE SUT00003-STR-NBR       TO RECEIVE-STORE             24720000
247900                                                                  24730000
248000         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          24740000
248100         PERFORM 9990-WRITE-CICS                                  24750000
248200                                                                  24760000
248300         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      24770000
248400         SET  DP013-OTHER-ABEND      TO TRUE                      24780000
248500         SET  DP013-ROLLBACK         TO TRUE                      24790000
248600                                                                  24800000
248700         MOVE '5100-SEND-DATA-TO-LPMS' TO DP013-PARAGRAPH         24810000
248800         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  24820000
248900         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       24830000
249000         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         24840000
249100         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      24850000
249200         STRING ' PCKCS728 - '            DELIMITED BY SIZE       24860000
249300                'DP081-FAMILY='           DELIMITED BY SIZE       24870000
249400                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       24880000
249500                ' DP081-PORT='            DELIMITED BY SIZE       24890000
249600                PV-DISPLAY-PORT           DELIMITED BY SIZE       24900000
249700                ' DP081-IP-ADDR='         DELIMITED BY SIZE       24910000
249800                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       24920000
249900                                     INTO DP013-MESSAGE-TEXT (2)  24930000
250000         MOVE DP081-RETCODE            TO  PV-RETCODE             24940000
250100         MOVE DP081-ERRNO              TO  PV-ERRNO               24950000
250200         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      24960000
250300                ' DP081-RETCODE - '        DELIMITED BY SIZE      24970000
250400                PV-RETCODE                 DELIMITED BY SIZE      24980000
250500                ' DP081-ERRNO - '          DELIMITED BY SIZE      24990000
250600                PV-ERRNO                   DELIMITED BY SIZE      25000000
250700                                      INTO DP013-MESSAGE-TEXT (3) 25010000
250800        MOVE   PV-PO-NBR               TO  PV-DISPLAY-PO          25020000
250900        MOVE   PV-RCVR-NBR             TO  PV-DISPLAY-RCVR        25030000
251000        MOVE   PV-STORE-NBR            TO  PV-DISPLAY-DEST        25040000
251100        STRING ' PRTR ID: '                DELIMITED BY SIZE      25050000
251200               PC204-SML-PRINTER           DELIMITED BY SIZE      25060000
251300               '   PO: '                   DELIMITED BY SIZE      25070000
251400               PV-DISPLAY-PO               DELIMITED BY SIZE      25080000
251500               '   RCVR: '                 DELIMITED BY SIZE      25090000
251600               PV-DISPLAY-RCVR             DELIMITED BY SIZE      25100000
251700               '  STORE: '                 DELIMITED BY SIZE      25110000
251800               PV-DISPLAY-DEST             DELIMITED BY SIZE      25120000
251900                                      INTO DP013-MESSAGE-TEXT (4) 25130000
252000         PERFORM 9999-WRITE-CICS-LOG-MSG                          25140000
252100*                                                                 25150000
252200*** BEGIN - FOR TESTING ONLY                                      25160000
252300*    ELSE                                                         25170000
252400*        MOVE ' PCKCS728 - SEND SUCCESSFUL'                       25180000
252500*                                     TO PV-CICS-MSG-AREA         25190000
252600*        PERFORM 9990-WRITE-CICS                                  25200000
252700*        IF  PC133-LABEL-HDR                                      25210000
252800*            STRING ' PCKCS728 - '           DELIMITED BY SIZE    25220000
252900*                   PC133-HDR-PO-NBR         DELIMITED BY SIZE    25230000
253000*                   '-'                      DELIMITED BY SIZE    25240000
253100*                   PC133-HDR-RCVR-SEQ       DELIMITED BY SIZE    25250000
253200*                   '-'                      DELIMITED BY SIZE    25260000
253300*                   PC133-HDR-LINE-NBR       DELIMITED BY SIZE    25270000
253400*                   '  -  PRINTER ID-'       DELIMITED BY SIZE    25280000
253500*                   PC133-HDR-PRTR-ID        DELIMITED BY SIZE    25290000
253600*                                       INTO PV-CICS-MSG-AREA     25300000
253700*            PERFORM 9990-WRITE-CICS                              25310000
253800*        END-IF                                                   25320000
253900*** END - FOR TESTING ONLY                                        25330000
254000                                                                  25340000
254100     END-IF.                                                      25350000
254200*                                                                 25360000
254300     PERFORM 5400-RECEIVE-CONFIRM-FROM-LPMS.                      25370000
254400                                                                  25380000
254500                                                                  25390000
254600*----------------------------------------------------------------*25400000
254700*  RECEIVE CONFIRMATION BACK FROM AL SYSTEMS THAT THEY RECEIVED  *25410000
254800*  ALL RECORDS CORRECTLY.                                        *25420000
254900*----------------------------------------------------------------*25430000
255000 5400-RECEIVE-CONFIRM-FROM-LPMS.                                  25440000
255100                                                                  25450000
255200*** BEGIN - FOR TESTING ONLY                                      25460000
255300*    MOVE ' PCKCS728 - START OF RECEIVE CONFIRM FROM LPMS'        25470000
255400*                                        TO PV-CICS-MSG-AREA.     25480000
255500*    PERFORM 9990-WRITE-CICS.                                     25490000
255600*** END - FOR TESTING ONLY                                        25500000
255700                                                                  25510000
255800                                                                  25520000
255900     MOVE LOW-VALUES  TO  TCP-BUF2.                               25530000
256000     MOVE 50          TO  DP081-TCPLENG                           25540000
256100                          DP081-NBR-BYTES.                        25550000
256200                                                                  25560000
256300     SET  DP081-NO-FLAG  TO  TRUE.                                25570000
256400                                                                  25580000
256500     CALL 'EZASOKET'                                              25590000
256600         USING DP081-RECV-CMD                                     25600000
256700               DP081-SOCK-ID                                      25610000
256800               DP081-FLAG                                         25620000
256900               DP081-NBR-BYTES                                    25630000
257000               TCP-BUF                                            25640000
257100               DP081-ERRNO                                        25650000
257200               DP081-RETCODE.                                     25660000
257300                                                                  25670000
257400*-----------------------------------------------------*           25680000
257500*                                                     *           25690000
257600*-----------------------------------------------------*           25700000
257700     CALL 'EZACIC05'                                              25710000
257800         USING DP081-TOEBCDIC-TOKEN                               25720000
257900               TCP-BUF                                            25730000
258000               DP081-TCPLENG.                                     25740000
258100                                                                  25750000
258200     IF  DP081-RETCODE < ZERO                                     25760000
258300         SET  PS-SOCKET-ERROR         TO TRUE                     25770000
258400         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    25780000
258500         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      25790000
258600         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      25800000
258700         SET  DP013-OTHER-ABEND      TO TRUE                      25810000
258800         SET  DP013-ROLLBACK         TO TRUE                      25820000
258900                                                                  25830000
259000         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    25840000
259100                                     TO DP013-PARAGRAPH           25850000
259200         MOVE DP081-TCP-IP-LOGGING-MSG TO DP013-MESSAGE-TEXT (1)  25860000
259300         MOVE DP081-NAME-FAMILY        TO PV-DISPLAY-FAMILY       25870000
259400         MOVE DP081-NAME-PORT          TO PV-DISPLAY-PORT         25880000
259500         MOVE DP081-NAME-IP-ADDR       TO PV-DISPLAY-IP-ADDR      25890000
259600         STRING ' PCKCS728 - '            DELIMITED BY SIZE       25900000
259700                'DP081-FAMILY='           DELIMITED BY SIZE       25910000
259800                PV-DISPLAY-FAMILY         DELIMITED BY SIZE       25920000
259900                ' DP081-PORT='            DELIMITED BY SIZE       25930000
260000                PV-DISPLAY-PORT           DELIMITED BY SIZE       25940000
260100                ' DP081-IP-ADDR='         DELIMITED BY SIZE       25950000
260200                PV-DISPLAY-IP-ADDR        DELIMITED BY SIZE       25960000
260300                                     INTO DP013-MESSAGE-TEXT (2)  25970000
260400         MOVE DP081-RETCODE            TO  PV-RETCODE             25980000
260500         MOVE DP081-ERRNO              TO  PV-ERRNO               25990000
260600         STRING ' EZASOKET CONNECT -'      DELIMITED BY SIZE      26000000
260700                ' DP081-RETCODE - '        DELIMITED BY SIZE      26010000
260800                PV-RETCODE                 DELIMITED BY SIZE      26020000
260900                ' DP081-ERRNO - '          DELIMITED BY SIZE      26030000
261000                PV-ERRNO                   DELIMITED BY SIZE      26040000
261100                                      INTO DP013-MESSAGE-TEXT (3) 26050000
261200        MOVE   PV-PO-NBR               TO  PV-DISPLAY-PO          26060000
261300        MOVE   PV-RCVR-NBR             TO  PV-DISPLAY-RCVR        26070000
261400        MOVE   PV-STORE-NBR            TO  PV-DISPLAY-DEST        26080000
261500        STRING ' PRTR ID: '                DELIMITED BY SIZE      26090000
261600               PC204-SML-PRINTER           DELIMITED BY SIZE      26100000
261700               '   PO: '                   DELIMITED BY SIZE      26110000
261800               PV-DISPLAY-PO               DELIMITED BY SIZE      26120000
261900               '   RCVR: '                 DELIMITED BY SIZE      26130000
262000               PV-DISPLAY-RCVR             DELIMITED BY SIZE      26140000
262100               '  STORE: '                 DELIMITED BY SIZE      26150000
262200               PV-DISPLAY-DEST             DELIMITED BY SIZE      26160000
262300                                      INTO DP013-MESSAGE-TEXT (4) 26170000
262400         PERFORM 9999-WRITE-CICS-LOG-MSG                          26180000
262500                                                                  26190000
262600*** BEGIN - FOR TESTING ONLY                                      26200000
262700*    ELSE                                                         26210000
262800*        MOVE ' PCKCS728 - CONFIRM SUCCESSFUL'                    26220000
262900*                                            TO PV-CICS-MSG-AREA  26230000
263000*        PERFORM 9990-WRITE-CICS                                  26240000
263100*** END - FOR TESTING ONLY                                        26250000
263200                                                                  26260000
263300     END-IF.                                                      26270000
263400                                                                  26280000
263500*-----------------------------------------------------*           26290000
263600*                                                     *           26300000
263700*-----------------------------------------------------*           26310000
263800     MOVE TCP-BUF TO PC133-LABEL-RECORD.                          26320000
263900                                                                  26330000
264000     IF  NOT PC133-SEND-SUCCESSFUL                                26340000
264100         PERFORM 4340-CLOSE-SOCKET                                26350000
264200         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    26360000
264300         SET  PS-SOCKET-ERROR         TO TRUE                     26370000
264400         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      26380000
264500         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      26390000
264600                                        RECEIVE-ERRNO             26400000
264700         MOVE PC204-PO-NBR           TO RECEIVE-RECEIVER          26410000
264800         MOVE PC204-REC-SEQ-NBR      TO RECEIVE-SEQ               26420000
264900         MOVE SUT00003-STR-NBR       TO RECEIVE-STORE             26430000
265000                                                                  26440000
265100         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          26450000
265200         PERFORM 9990-WRITE-CICS                                  26460000
265300         STRING '  '                 DELIMITED BY SIZE            26470000
265400                PC133-LABEL-RECORD   DELIMITED BY SIZE            26480000
265500                                     INTO PV-CICS-MSG-AREA        26490000
265600         PERFORM 9990-WRITE-CICS                                  26500000
265700                                                                  26510000
265800         PERFORM 4740-GET-LPMS-RETURN                             26520000
265900                                                                  26530000
266000         EVALUATE TRUE                                            26540000
266100             WHEN  PC133-INVALID-PRINTER                          26550000
266200               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26560000
266300                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   26570000
266400                                          INTO PV-CICS-MSG-AREA   26580000
266500             WHEN  PC133-DTL-WITHOUT-HDR                          26590000
266600               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26600000
266700                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   26610000
266800                                          INTO PV-CICS-MSG-AREA   26620000
266900             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      26630000
267000               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26640000
267100                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   26650000
267200                                          INTO PV-CICS-MSG-AREA   26660000
267300             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     26670000
267400               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26680000
267500                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   26690000
267600                                          INTO PV-CICS-MSG-AREA   26700000
267700             WHEN  PC133-TRAN-IDS-NOT-MTCH                        26710000
267800               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26720000
267900                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   26730000
268000                                          INTO PV-CICS-MSG-AREA   26740000
268100             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       26750000
268200               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26760000
268300                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   26770000
268400                                          INTO PV-CICS-MSG-AREA   26780000
268500             WHEN  PC133-DISK-ERROR                               26790000
268600               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26800000
268700                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   26810000
268800                                          INTO PV-CICS-MSG-AREA   26820000
268900             WHEN  PC133-TIMEOUT                                  26830000
269000               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26840000
269100                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   26850000
269200                                          INTO PV-CICS-MSG-AREA   26860000
269300             WHEN  PC133-ADDR-NOT-FND                             26870000
269400               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26880000
269500                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   26890000
269600                                          INTO PV-CICS-MSG-AREA   26900000
269700             WHEN  PC133-INVALID-PACKET                           26910000
269800               STRING ' PCKCS728 -'           DELIMITED BY SIZE   26920000
269900                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   26930000
270000                                          INTO PV-CICS-MSG-AREA   26940000
270100         END-EVALUATE                                             26950000
270200         PERFORM 9990-WRITE-CICS                                  26960000
270300                                                                  26970000
270400         SET  DP013-OTHER-ABEND      TO TRUE                      26980000
270500         SET  DP013-ROLLBACK         TO TRUE                      26990000
270600                                                                  27000000
270700         MOVE '5400-RECEIVE-CONFIRM-FROM-LPMS'                    27010000
270800                                     TO DP013-PARAGRAPH           27020000
270900         STRING ' PCKCS728 - '           DELIMITED BY SIZE        27030000
271000                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        27040000
271100                                     INTO DP013-MESSAGE-TEXT (1)  27050000
271200         PERFORM 9999-WRITE-CICS-LOG-MSG                          27060000
271300*** BEGIN - FOR TESTING ONLY                                      27070000
271400*    ELSE                                                         27080000
271500*        MOVE ' PCKCS728 - CONFIRM SUCCESSFUL'                    27090000
271600*                                    TO PV-CICS-MSG-AREA          27100000
271700*        PERFORM 9990-WRITE-CICS                                  27110000
271800*** END - FOR TESTING ONLY                                        27120000
271900     END-IF.                                                      27130000
272000                                                                  27140000
272100*----------------------------------------------------------------*27150000
272200* GET LABEL INFORMATION                                          *27160000
272300*----------------------------------------------------------------*27170000
272400 6000-GET-LABEL-INFORMATION.                                      27180000
272500     PERFORM 6005-DATE-TIME.                                      27190000
272600     PERFORM 6040-GET-DC-PRTD-AT.                                 27200000
272700*    PERFORM 6050-GET-CLASS-MAJ-CLASS.                            27210000
272800     PERFORM 6100-CALL-SEASET-MODULE.                             27220000
272900                                                                  27230000
273000*----------------------------------------------------------------*27240000
273100* GET CURRENT DATE/TIME FROM CONTROL TABLE                       *27250000
273200*----------------------------------------------------------------*27260000
273300 6005-DATE-TIME.                                                  27270000
273400     EXEC SQL                                                     27280000
273500         SELECT  CURRENT DATE                                     27290000
273600               , CURRENT TIME                                     27300000
273700               , CURRENT TIMESTAMP                                27310000
273800           INTO  :PV-CURRENT-DB2-DATE                             27320000
273900               , :PV-CURRENT-DB2-TIME                             27330000
274000               , :PV-CURRENT-DB2-TIMESTAMP                        27340000
274100           FROM  TCOCNTL                                          27350000
274200          WHERE  OPER_UNT_ID = 90                                 27360000
274300     END-EXEC.                                                    27370000
274400                                                                  27380000
274500     EVALUATE TRUE                                                27390000
274600         WHEN SQLCODE = ZERO                                      27400000
274700              MOVE  PV-CURRENT-HR  TO  PV-CURRENT-HOUR            27410000
274800              MOVE  PV-CURRENT-MN  TO  PV-CURRENT-MIN             27420000
274810              MOVE  PV-CURRENT-DB2-DATE TO                        27430000
274820                                       PV-WORK-DB2-DATE           27440000
274830                                                                  27450000
274840         WHEN OTHER                                               27460000
274850              INITIALIZE  PV-CICS-MSG-AREA                        27470000
274860              MOVE SQLCODE             TO PV-SQL-RETURN-CD        27480000
274870              STRING ' PCKCS728 - '             DELIMITED BY SIZE 27481000
274880                     '6005-DATE-TIME  '        DELIMITED BY SIZE  27482000
274890                     '  SQL - '                 DELIMITED BY SIZE 27483000
274900                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 27484000
275000                                           INTO PV-CICS-MSG-AREA  27485000
275100              MOVE LENGTH OF PV-CICS-MSG-AREA                     27486000
275200                     TO PV-COMMAREA-LENGTH                        27487000
275300              PERFORM 9990-WRITE-CICS                             27488000
275400              INITIALIZE  PV-CICS-MSG-AREA                        27489000
275500              STRING ' PCKCS728 -'             DELIMITED BY SIZE  27490000
275600                     ' PO:'                    DELIMITED BY SIZE  27500000
275700                     PV-PO-NBR                 DELIMITED BY SIZE  27510000
275800                     ' RCVR:'                  DELIMITED BY SIZE  27520000
275900                     PV-RCVR-NBR               DELIMITED BY SIZE  27530000
276000                     ' STR:'                   DELIMITED BY SIZE  27540000
276100                     PV-STORE-NBR              DELIMITED BY SIZE  27550000
276200                                           INTO PV-CICS-MSG-AREA  27560000
276300              MOVE LENGTH OF PV-CICS-MSG-AREA                     27570000
276400                     TO PV-COMMAREA-LENGTH                        27580000
276500              PERFORM 9990-WRITE-CICS                             27590000
276600              SET PC204-SQL-ERROR                                 27600000
276700                  PS-ERROR         TO TRUE                        27610000
276800      END-EVALUATE.                                               27620000
276900                                                                  27630000
277000                                                                  27640000
277100                                                                  27650000
277200*----------------------------------------------------------------*27660000
277300*  GET THE DC WHERE LABEL PRINTED AT                             *27670000
277400*----------------------------------------------------------------*27680000
277500 6040-GET-DC-PRTD-AT.                                             27690000
277600                                                                  27700000
277700     EXEC SQL                                                     27710000
277800          SELECT LOC_5_ABBR_NM                                    27720000
277900          INTO  :PV-DC-5-CHAR-ABBR                                27730000
278000          FROM   XLT_LOC                                          27740000
278100          WHERE  LOC_TYP_CDE = 'DC'                               27750000
278200          AND    LOC_NBR     = :DK-OPER-UNT-ID                    27760000
278300     END-EXEC.                                                    27770000
278400                                                                  27780000
278500     EVALUATE TRUE                                                27790000
278600         WHEN SQLCODE = ZERO                                      27800000
278700         WHEN SQLCODE = -811                                      27810000
278800              MOVE  PV-2-DIGIT-DC-ABBR  TO  PV-DC-PRTD-AT         27820000
278900                                                                  27830000
279000         WHEN SQLCODE = +100                                      27840000
279100              MOVE  PC-90   TO  PV-DC-PRTD-AT                     27850000
279200                                                                  27860000
279300         WHEN SQLWARN0 NOT = SPACES                               27870000
279400         WHEN SQLCODE < +0                                        27880000
279500         WHEN SQLCODE > +0                                        27890000
279600              INITIALIZE  PV-CICS-MSG-AREA                        27900000
279700              MOVE SQLCODE             TO PV-SQL-RETURN-CD        27910000
279800              STRING ' PCKCS728 - '             DELIMITED BY SIZE 27920000
279900                     '6040-GET-DC-PRTD-AT'     DELIMITED BY SIZE  27930000
280000                     '  SQL - '                 DELIMITED BY SIZE 27940000
280100                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 27950000
280200                                           INTO PV-CICS-MSG-AREA  27960000
280300              MOVE LENGTH OF PV-CICS-MSG-AREA                     27970000
280400                     TO PV-COMMAREA-LENGTH                        27980000
280500              PERFORM 9990-WRITE-CICS                             27990000
280600              INITIALIZE  PV-CICS-MSG-AREA                        28000000
280700              STRING ' PCKCS728 -'             DELIMITED BY SIZE  28010000
280800                     ' PO:'                    DELIMITED BY SIZE  28020000
280900                     PV-PO-NBR                 DELIMITED BY SIZE  28030000
281000                     ' RCVR:'                  DELIMITED BY SIZE  28040000
281100                     PV-RCVR-NBR               DELIMITED BY SIZE  28050000
281200                     ' STR:'                   DELIMITED BY SIZE  28060000
281300                     PV-STORE-NBR              DELIMITED BY SIZE  28070000
281400                                           INTO PV-CICS-MSG-AREA  28080000
281500              MOVE LENGTH OF PV-CICS-MSG-AREA                     28090000
281600                     TO PV-COMMAREA-LENGTH                        28100000
281700              PERFORM 9990-WRITE-CICS                             28110000
281800              SET PC204-SQL-ERROR                                 28120000
281900                  PS-ERROR         TO TRUE                        28130000
282000     END-EVALUATE.                                                28140000
282100*----------------------------------------------------------------*28150000
282200*  GET THE DC WHERE LABEL PRINTED AT                             *28160000
282300*----------------------------------------------------------------*28170000
282400 6050-GET-CLASS-MAJ-CLASS.                                        28180000
282500                                                                  28190000
282600     EXEC SQL                                                     28200000
282700          SELECT DISTINCT(A.DEPT_NBR)                             28210000
282800               , D.CL_NBR                                         28220000
282900          INTO  :PV-DEPT-NUMBER                                   28230000
283000              , :PV-CL-NBR                                        28240000
283100           FROM TPURCHS A                                         28250000
283200               ,TVNDDPT B                                         28260000
283300               ,TRECITM C                                         28270000
283400               ,TPURITM D                                         28280000
283500          WHERE A.PO_NBR         =  :DK-PO-NBR                    28290000
283600            AND A.VER_STATUS_CDE =  'A'                           28300000
283700            AND A.ENT_ID         =  B.ENT_ID                      28310000
283800            AND A.DEPT_NBR       =  B.DEPT_NBR                    28320000
283900            AND C.ORD_NBR        =  A.PO_NBR                      28330000
284000            AND C.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                28340000
284100            AND C.ORD_NBR        =  D.PO_NBR                      28350000
284200            AND C.ORD_LNE_NBR    =  :DK-PO-LNE-NBR                28360000
284300            AND C.ORD_LNE_NBR    =  D.APP_PO_LNE_NBR              28370000
284400            AND C.VER_STATUS_CDE =  'A'                           28380000
284500            AND C.PO_VER_NBR     =  D.VER_NBR                     28390000
284600     END-EXEC.                                                    28400000
284700                                                                  28410000
284800     EVALUATE TRUE                                                28420000
284900         WHEN SQLCODE = ZERO                                      28430000
285000              PERFORM 6070-GET-DEPT-NAME                          28440000
285100         WHEN SQLCODE = +100                                      28450000
285200              MOVE  PC-90   TO  PV-DC-PRTD-AT                     28460000
285300                                                                  28470000
285400         WHEN SQLWARN0 NOT = SPACES                               28480000
285500         WHEN SQLCODE < +0                                        28490000
285600         WHEN SQLCODE > +0                                        28500000
285700              INITIALIZE  PV-CICS-MSG-AREA                        28510000
285800              MOVE SQLCODE             TO PV-SQL-RETURN-CD        28520000
285900              STRING ' PCKCS728 - '             DELIMITED BY SIZE 28530000
286000                     '6050-GET-CLASS-MAJ-CL'   DELIMITED BY SIZE  28540000
286100                     '  SQL - '                 DELIMITED BY SIZE 28550000
286200                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 28560000
286300                                           INTO PV-CICS-MSG-AREA  28570000
286400              MOVE LENGTH OF PV-CICS-MSG-AREA                     28580000
286500                     TO PV-COMMAREA-LENGTH                        28590000
286600              PERFORM 9990-WRITE-CICS                             28600000
286700              INITIALIZE  PV-CICS-MSG-AREA                        28610000
286800              STRING ' PCKCS728 -'             DELIMITED BY SIZE  28620000
286900                     ' PO:'                    DELIMITED BY SIZE  28630000
287000                     PV-PO-NBR                 DELIMITED BY SIZE  28640000
287100                     ' RCVR:'                  DELIMITED BY SIZE  28650000
287200                     PV-RCVR-NBR               DELIMITED BY SIZE  28660000
287300                     ' STR:'                   DELIMITED BY SIZE  28670000
287400                     PV-STORE-NBR              DELIMITED BY SIZE  28680000
287500                                           INTO PV-CICS-MSG-AREA  28690000
287600              MOVE LENGTH OF PV-CICS-MSG-AREA                     28700000
287700                     TO PV-COMMAREA-LENGTH                        28710000
287800              PERFORM 9990-WRITE-CICS                             28720000
287900              SET PC204-SQL-ERROR                                 28730000
288000                  PS-ERROR         TO TRUE                        28740000
288100     END-EVALUATE.                                                28750000
288200*----------------------------------------------------------------*28760000
288300* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         28770000
288400*----------------------------------------------------------------*28780000
288500 6070-GET-DEPT-NAME.                                              28790000
288600                                                                  28800000
288700     SET DP003-MCL-LOOKUP              TO TRUE.                   28810000
288800     SET DP003-DPT-LOOKUP              TO TRUE.                   28820000
288900     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      28830000
289000     MOVE '03'                         TO DP003-OP-CO-NMBR.       28840000
289100     MOVE PV-WORK-YY                   TO PV-DPKUT038-YY.         28850000
289200     MOVE PV-WORK-MM                   TO PV-DPKUT038-MM.         28860000
289300     MOVE PV-WORK-DD                   TO PV-DPKUT038-DD          28870000
289400     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      28880000
289500                                          DP003-EFF-DATE.         28890000
289600                                                                  28900000
289700     MOVE PV-DEPT-NUMBER               TO DP003-DPT-INPUT.        28910000
289800     MOVE PV-CL-NBR                    TO PV-DPKUT038-MJR-CL.     28920000
289900     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   28930000
290000     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        28940000
290100                                                                  28950000
290200     EXEC CICS                                                    28960000
290300         LINK PROGRAM  (PC-DPKUT038)                              28970000
290400              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              28980000
290500              LENGTH   (PV-DPKUT038-CA-LENGTH)                    28990000
290600              RESP     (PV-DPKUT038-CICS-RESP)                    29000000
290700     END-EXEC.                                                    29010000
290800                                                                  29020000
290900     EVALUATE TRUE                                                29030000
291000         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            29040000
291100              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-DESC          29050000
291200              MOVE DP003-MCL-DESCRIPTION TO PV-MAJ-CL-DESC        29060000
291300         WHEN OTHER                                               29070000
291400              MOVE SPACES          TO   PV-DEPT-DESC              29080000
291500                                        PV-MAJ-CL-DESC            29090000
291600     END-EVALUATE.                                                29100000
291700******************************************************************29110000
291800 6100-CALL-SEASET-MODULE.                                         29120000
291900*-----------------------------------------------------------------29130000
292000     INITIALIZE PC240-ITEM-COMMAREA                               29140000
292100     MOVE PC204-PO-NBR                  TO PC240-KEY-PO           29150000
292200     MOVE PC204-REC-SEQ-NBR             TO PC240-KEY-REC-SEQ-NBR  29160000
292300     MOVE PC204-STR-NBR                 TO PC240-KEY-DEST-LOC     29170000
292400                                                                  29180000
292500     SET  PC240-SMOOTHING               TO TRUE                   29190000
292600     CALL PC240-VSM-PGM USING DFHEIBLK                            29200000
292700                              PC240-COMMAREA                      29210000
292800                              PC240-ITEM-COMMAREA                 29220000
292900     EVALUATE TRUE                                                29230000
293000         WHEN PC240-SUCCESSFUL                                    29240000
293100             IF PC240-SEASONAL-SET-FOUND                          29250000
293200                MOVE PC240-SEASET-NM TO  PC256-SEASET             29260000
293300             ELSE                                                 29270000
293400                MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                  29280000
293500                                        TO  PC256-SEASET          29290000
293600             END-IF                                               29300000
293700                                                                  29310000
293800             IF PC240-DIVERT-PFX-NBR = ZEROES                     29320000
293900                MOVE ZEROES TO PC180-SML-DIVERT-PFX               29330000
294000             ELSE                                                 29340000
294100                MOVE PC240-DIVERT-PFX-NBR  TO PV-9999-9           29350000
294200                MOVE PV-9999-3-4           TO PC180-SML-DIVERT-PFX29360000
294300             END-IF                                               29370000
294400                                                                  29380000
294500         WHEN PC240-ITEM-NOT-FOUND                                29390000
294600             MOVE ZEROES               TO PC180-SML-DIVERT-PFX    29400000
294700             MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@'                     29410000
294800                                        TO  PC256-SEASET          29420000
294900         WHEN PC240-SQL-ERROR                                     29430000
295000         WHEN PC240-INVALID-ACCESS                                29440000
295100            INITIALIZE  PV-CICS-MSG-AREA                          29450000
295200            MOVE PC240-ERROR-NBR     TO PV-SQL-RETURN-CD          29460000
295300            STRING ' PCKCS728 - '          DELIMITED BY SIZE      29470000
295400                   '6100-CALL-SEASET-MODULE' DELIMITED BY SIZE    29480000
295500                    ' SQL - '              DELIMITED BY SIZE      29490000
295600                   PV-SQL-RETURN-CD        DELIMITED BY SIZE      29500000
295700                                         INTO PV-CICS-MSG-AREA    29510000
295800            MOVE LENGTH OF PV-CICS-MSG-AREA                       29520000
295900                   TO PV-COMMAREA-LENGTH                          29530000
296000            PERFORM 9990-WRITE-CICS                               29540000
296100            INITIALIZE  PV-CICS-MSG-AREA                          29550000
296200            STRING ' PCKCS728 -'             DELIMITED BY SIZE    29560000
296300                   ' PO:'                    DELIMITED BY SIZE    29570000
296400                   PV-PO-NBR                 DELIMITED BY SIZE    29580000
296500                   ' RCVR:'                  DELIMITED BY SIZE    29590000
296600                   PV-RCVR-NBR               DELIMITED BY SIZE    29600000
296700                                         INTO PV-CICS-MSG-AREA    29610000
296800            MOVE LENGTH OF PV-CICS-MSG-AREA                       29620000
296900                   TO PV-COMMAREA-LENGTH                          29630000
297000            PERFORM 9990-WRITE-CICS                               29640000
297100            SET PC204-SQL-ERROR                                   29650000
297200                PS-ERROR         TO TRUE                          29660000
297300                                                                  29670000
297400         WHEN OTHER                                               29680000
297500            INITIALIZE  PV-CICS-MSG-AREA                          29690000
297600            MOVE PC240-ERROR-NBR     TO PV-SQL-RETURN-CD          29700000
297700            STRING ' PCKCS728 - '          DELIMITED BY SIZE      29710000
297800                   '6100-CALL-SEASET-MODULE' DELIMITED BY SIZE    29720000
297900                    ' SQL - '              DELIMITED BY SIZE      29730000
298000                   PV-SQL-RETURN-CD        DELIMITED BY SIZE      29740000
298100                                         INTO PV-CICS-MSG-AREA    29750000
298200            MOVE LENGTH OF PV-CICS-MSG-AREA                       29760000
298300                   TO PV-COMMAREA-LENGTH                          29770000
298400            PERFORM 9990-WRITE-CICS                               29780000
298500            INITIALIZE  PV-CICS-MSG-AREA                          29790000
298600            STRING ' PCKCS728 -'             DELIMITED BY SIZE    29800000
298700                   ' PO:'                    DELIMITED BY SIZE    29810000
298800                   PV-PO-NBR                 DELIMITED BY SIZE    29820000
298900                   ' RCVR:'                  DELIMITED BY SIZE    29830000
299000                   PV-RCVR-NBR               DELIMITED BY SIZE    29840000
299100                                         INTO PV-CICS-MSG-AREA    29850000
299200            MOVE LENGTH OF PV-CICS-MSG-AREA                       29860000
299300                   TO PV-COMMAREA-LENGTH                          29870000
299400            PERFORM 9990-WRITE-CICS                               29880000
299500            SET PC204-SQL-ERROR                                   29890000
299600                PS-ERROR         TO TRUE                          29900000
299700                                                                  29910000
299800                                                                  29920000
299900     END-EVALUATE.                                                29930000
300000                                                                  29940000
300100*----------------------------------------------------------------*29950000
300200*  GET THE CURRENT DC DOOR ASSIGNED TO STORE                     *29960000
300300*----------------------------------------------------------------*29970000
300400 6200-GET-CURRENT-DOOR.                                           29980000
300410                                                                  29990000
300420     MOVE PV-STORE-NBR               TO CNDRST-STR-NBR.           30000000
300430     MOVE PC204-OPER-UNT-ID          TO CNDCDR-OPER-UNT-ID.       30010000
300440                                                                  30020000
300450     EXEC SQL                                                     30030000
300460        SELECT A.DOOR_ID                                          30040000
300470        INTO   :CNDCDR-DOOR-ID                                    30041000
300480        FROM   TCNDCDR A                                          30042000
300490             , TCNDRST B                                          30043000
300491        WHERE  A.DOOR_ID         = B.DOOR_ID                      30044000
300492          AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID            30045000
300493          AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                  30046000
300494          AND  A.DOOR_TYP_CDE    = 'SH'                           30047000
300495          AND  B.STR_NBR         = :CNDRST-STR-NBR                30048000
300496          AND  B.END_TMST        = '9999-09-09-09.09.09.999999'   30049000
300497          AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR         30049100
300498                      DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR         30049200
300499                      DOOR_LOC_DESC  LIKE  '%RE-OPEN%'            30049300
300500                     )                                            30049400
300501     END-EXEC.                                                    30049500
300502                                                                  30049600
300503     EVALUATE TRUE                                                30049700
300504         WHEN SQLCODE = ZERO                                      30049800
300505              CONTINUE                                            30049900
300506         WHEN SQLCODE = +100                                      30050000
300507         WHEN SQLCODE = -811                                      30050100
300508              MOVE  SPACES  TO  CNDCDR-DOOR-ID                    30050200
300509                                                                  30050300
300510         WHEN SQLWARN0 NOT = SPACES                               30050400
300520         WHEN SQLCODE < +0                                        30050500
300530         WHEN SQLCODE > +0                                        30050600
300540              INITIALIZE  PV-CICS-MSG-AREA                        30050700
300550              MOVE SQLCODE             TO PV-SQL-RETURN-CD        30050800
300560              STRING ' PCKCS728 - '             DELIMITED BY SIZE 30050900
300570                     '6200-GET-CURRENT-DOOR '  DELIMITED BY SIZE  30051000
300580                     '  SQL - '                 DELIMITED BY SIZE 30052000
300590                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 30053000
300591                                           INTO PV-CICS-MSG-AREA  30054000
300592              MOVE LENGTH OF PV-CICS-MSG-AREA                     30055000
300593                     TO PV-COMMAREA-LENGTH                        30056000
300594              PERFORM 9990-WRITE-CICS                             30057000
300595              INITIALIZE  PV-CICS-MSG-AREA                        30058000
300596              STRING ' PCKCS728 -'             DELIMITED BY SIZE  30059000
300597                     ' PO:'                    DELIMITED BY SIZE  30059100
300598                     PV-PO-NBR                 DELIMITED BY SIZE  30059200
300599                     ' RCVR:'                  DELIMITED BY SIZE  30059300
300600                     PV-RCVR-NBR               DELIMITED BY SIZE  30059400
300610                     ' STR:'                   DELIMITED BY SIZE  30059500
300620                     PV-STORE-NBR              DELIMITED BY SIZE  30059600
300630                                           INTO PV-CICS-MSG-AREA  30059700
300640              MOVE LENGTH OF PV-CICS-MSG-AREA                     30059800
300650                     TO PV-COMMAREA-LENGTH                        30059900
300660              PERFORM 9990-WRITE-CICS                             30060000
300670              SET PC204-SQL-ERROR                                 30061000
300680                  PS-ERROR         TO TRUE                        30062000
300690     END-EVALUATE.                                                30063000
300700*-----------------------------------------------------------------30064000
300800*                                                                 30065000
300900*-----------------------------------------------------------------30066000
301000 6250-CHECK-FOR-MULT.                                             30067000
301100*-----------------------------------------------------------------30068000
301200     SET PS-MULTIPLE-LINES-NOT-FND  TO TRUE.                      30069000
301300     MOVE  PC180-SML-BARCODE  TO   DK-BARCODE-NBR.                30070000
301400     INITIALIZE PV-SHUUPC-MULT-CNT.                               30080000
301500                                                                  30090000
301600     EXEC SQL                                                     30100000
301700         SELECT   TRN_LNE_NBR                                     30110000
301800          INTO    :SUT00028-TRN-LNE-NBR                           30120000
301900          FROM    SUT_OTBND_UPC                                   30130000
302000          WHERE   SHIPT_UNT_ID     = :DK-BARCODE-NBR              30140000
302100            AND   TRN_NBR          = :DK-PO-NBR                   30150000
302200            AND   RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              30160000
302300     END-EXEC                                                     30170000
302400                                                                  30180000
302500         EVALUATE TRUE                                            30190000
302600             WHEN SQLCODE = +0                                    30200000
302700                  CONTINUE                                        30210000
302800             WHEN SQLCODE = -811                                  30220000
302900                  SET PS-MULTIPLE-LINES-FND TO TRUE               30230000
303000             WHEN SQLWARN0 NOT = +0                               30240000
303100             WHEN SQLCODE < +0                                    30250000
303200             WHEN SQLCODE > +0                                    30260000
303300              INITIALIZE  PV-CICS-MSG-AREA                        30270000
303400              MOVE SQLCODE             TO PV-SQL-RETURN-CD        30280000
303500              STRING ' PCKCS728 - '             DELIMITED BY SIZE 30290000
303600                     '6250-CHECK-FOR-MULT  '   DELIMITED BY SIZE  30300000
303700                     '  SQL - '                 DELIMITED BY SIZE 30310000
303800                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 30320000
303900                                           INTO PV-CICS-MSG-AREA  30330000
304000              MOVE LENGTH OF PV-CICS-MSG-AREA                     30340000
304100                     TO PV-COMMAREA-LENGTH                        30350000
304200              PERFORM 9990-WRITE-CICS                             30360000
304300              INITIALIZE  PV-CICS-MSG-AREA                        30370000
304400              STRING ' PCKCS728 -'             DELIMITED BY SIZE  30380000
304500                     ' PO:'                    DELIMITED BY SIZE  30390000
304600                     PV-PO-NBR                 DELIMITED BY SIZE  30400000
304700                     ' RCVR:'                  DELIMITED BY SIZE  30410000
304800                     PV-RCVR-NBR               DELIMITED BY SIZE  30420000
304900                     ' STR:'                   DELIMITED BY SIZE  30430000
305000                     PV-STORE-NBR              DELIMITED BY SIZE  30440000
305100                                           INTO PV-CICS-MSG-AREA  30450000
305200              MOVE LENGTH OF PV-CICS-MSG-AREA                     30460000
305300                     TO PV-COMMAREA-LENGTH                        30470000
305400              PERFORM 9990-WRITE-CICS                             30480000
305500              SET PC204-SQL-ERROR                                 30490000
305600                  PS-ERROR         TO TRUE                        30500000
305700         END-EVALUATE.                                            30510000
305800                                                                  30520000
305900                                                                  30530000
306000*                                                                 30540000
306100*                                                                 30550000
306200*-----------------------------------------------------------------30560000
306300 6275-SELECT-PO-DEPT.                                             30570000
306400*-----------------------------------------------------------------30580000
306500                                                                  30590000
306600     EXEC SQL                                                     30600000
306700         SELECT   DEPT_NBR                                        30610000
306800          INTO    :PURCHS-DEPT-NBR                                30620000
306900          FROM    TPURCHS                                         30630000
307000          WHERE   PO_NBR           = :DK-PO-NBR                   30640000
307100            AND   VER_STATUS_CDE   = 'A'                          30650000
307200     END-EXEC                                                     30660000
307300                                                                  30670000
307400         EVALUATE TRUE                                            30680000
307500             WHEN SQLCODE = +0                                    30690000
307600                  CONTINUE                                        30700000
307700             WHEN SQLWARN0 NOT = +0                               30710000
307800             WHEN SQLCODE < +0                                    30720000
307900             WHEN SQLCODE > +0                                    30730000
308000              INITIALIZE  PV-CICS-MSG-AREA                        30740000
308100              MOVE SQLCODE             TO PV-SQL-RETURN-CD        30750000
308200              STRING ' PCKCS728 - '             DELIMITED BY SIZE 30760000
308300                     '6275-SELECT-PO-DEPT  '    DELIMITED BY SIZE 30770000
308400                     '  SQL - '                 DELIMITED BY SIZE 30780000
308500                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 30790000
308600                                           INTO PV-CICS-MSG-AREA  30800000
308700              MOVE LENGTH OF PV-CICS-MSG-AREA                     30810000
308800                     TO PV-COMMAREA-LENGTH                        30820000
308900              PERFORM 9990-WRITE-CICS                             30830000
309000              INITIALIZE  PV-CICS-MSG-AREA                        30840000
309100              STRING ' PCKCS728 -'             DELIMITED BY SIZE  30850000
309200                     ' PO:'                    DELIMITED BY SIZE  30860000
309300                     PV-PO-NBR                 DELIMITED BY SIZE  30870000
309400                     ' RCVR:'                  DELIMITED BY SIZE  30880000
309500                     PV-RCVR-NBR               DELIMITED BY SIZE  30890000
309600                     ' STR:'                   DELIMITED BY SIZE  30900000
309700                     PV-STORE-NBR              DELIMITED BY SIZE  30910000
309800                                           INTO PV-CICS-MSG-AREA  30920000
309900              MOVE LENGTH OF PV-CICS-MSG-AREA                     30930000
310000                     TO PV-COMMAREA-LENGTH                        30940000
310100              PERFORM 9990-WRITE-CICS                             30950000
310200              SET PC204-SQL-ERROR                                 30960000
310300                  PS-ERROR         TO TRUE                        30970000
310400         END-EVALUATE.                                            30980000
310500                                                                  30990000
310600                                                                  31000000
310700*                                                                 31010000
310800*----------------------------------------------------------------*31020000
310900 6300-GET-DEPT-CL-SKU.                                            31030000
311000                                                                  31040000
311100     EXEC SQL                                                     31050000
311200         SELECT A.DEPT_NBR                                        31060000
311300               ,D.CL_NBR                                          31070000
311400               ,D.VEND_STYL_NAME                                  31080000
311500               ,E.SKU_NBR                                         31090000
311600           INTO :PURCHS-DEPT-NBR                                  31100000
311700              , :PURITM-CL-NBR                                    31110000
311800              , :PURITM-VEND-STYL-NAME                            31120000
311900              , :XLT00003-SKU-NBR                                 31130000
312000           FROM TPURCHS A                                         31140000
312100               ,TVNDDPT B                                         31150000
312200               ,TRECITM C                                         31160000
312300               ,TPURITM D                                         31170000
312400               ,XLT_SKU E                                         31180000
312500          WHERE A.PO_NBR         =  :DK-PO-NBR                    31190000
312600            AND A.VER_STATUS_CDE =  'A'                           31200000
312700            AND A.ENT_ID         =  B.ENT_ID                      31210000
312710            AND A.DEPT_NBR       =  B.DEPT_NBR                    31220000
312720            AND C.ORD_NBR        =  A.PO_NBR                      31230000
312730            AND C.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR               31240000
312740            AND C.ORD_NBR        =  D.PO_NBR                      31250000
312750            AND C.ORD_LNE_NBR    =  :SUT00028-TRN-LNE-NBR         31260000
312751            AND C.ORD_LNE_NBR    =  D.APP_PO_LNE_NBR              31270000
312752            AND C.VER_STATUS_CDE =  'A'                           31271000
312753            AND C.PO_VER_NBR     =  D.VER_NBR                     31272000
312754            AND D.ITM_NBR        =  E.ITM_NBR                     31273000
312755     END-EXEC.                                                    31274000
312756                                                                  31275000
312757     EVALUATE TRUE                                                31275100
312758         WHEN SQLCODE = ZERO                                      31275200
312759            MOVE PURCHS-DEPT-NBR    TO PV-SML-DEPT1               31275300
312760            MOVE PURITM-CL-NBR      TO PV-SML-CLASS-NBR1          31275400
312770            MOVE XLT00003-SKU-NBR   TO PV-SML-SKU-NBR             31275500
312780                                                                  31275600
312790         WHEN SQLCODE = +100                                      31275700
312800             MOVE SPACES TO PV-SML-SKU-NUMBER                     31275800
312900                                                                  31275900
313000         WHEN SQLWARN0 NOT = SPACES                               31276000
313100         WHEN SQLCODE NOT EQUAL ZERO                              31277000
313200              INITIALIZE  PV-CICS-MSG-AREA                        31278000
313300              MOVE SQLCODE             TO PV-SQL-RETURN-CD        31279000
313400              STRING ' PCKCS728 - '             DELIMITED BY SIZE 31280000
313500                     '6300-GET-DEPT-CL-SKU '   DELIMITED BY SIZE  31290000
313600                     '  SQL - '                 DELIMITED BY SIZE 31300000
313700                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 31310000
313800                                           INTO PV-CICS-MSG-AREA  31320000
313900              MOVE LENGTH OF PV-CICS-MSG-AREA                     31330000
314000                     TO PV-COMMAREA-LENGTH                        31340000
314100              PERFORM 9990-WRITE-CICS                             31350000
314200              INITIALIZE  PV-CICS-MSG-AREA                        31360000
314300              STRING ' PCKCS728 -'             DELIMITED BY SIZE  31370000
314400                     ' PO:'                    DELIMITED BY SIZE  31380000
314500                     PV-PO-NBR                 DELIMITED BY SIZE  31390000
314600                     ' RCVR:'                  DELIMITED BY SIZE  31400000
314700                     PV-RCVR-NBR               DELIMITED BY SIZE  31410000
314800                     ' STR:'                   DELIMITED BY SIZE  31420000
314900                     PV-STORE-NBR              DELIMITED BY SIZE  31430000
315000                                           INTO PV-CICS-MSG-AREA  31440000
315100              MOVE LENGTH OF PV-CICS-MSG-AREA                     31450000
315200                     TO PV-COMMAREA-LENGTH                        31460000
315300              PERFORM 9990-WRITE-CICS                             31470000
315400              SET PC204-SQL-ERROR                                 31480000
315500                  PS-ERROR         TO TRUE                        31490000
315600     END-EVALUATE.                                                31500000
315700                                                                  31510000
315800 6400-LINK-XLKUT073.                                              31520000
315900                                                                  31530000
316000     INITIALIZE XL073-COMMAREA-REC                                31540000
316100     MOVE PURCHS-DEPT-NBR             TO XL073-DEPT-NBR           31550000
316200     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     31560000
316300                                     XL073-COMMAREA               31570000
316400                                     XL073-COMMAREA-REC           31580000
316500     EVALUATE TRUE                                                31590000
316600         WHEN XL073-NO-ERRORS                                     31600000
316700             MOVE XL073-BUS-AREA-ID  TO PC256-MDSE-GROUP          31610000
316800         WHEN XL073-DEPT-NOT-FND                                  31620000
316900         WHEN XL073-MAJ-CL-NOT-FND                                31630000
317000         WHEN XL073-SUB-CL-NOT-FND                                31640000
317100              MOVE ZEROES            TO PC256-MDSE-GROUP          31650000
317200         WHEN OTHER                                               31660000
317300            INITIALIZE  PV-CICS-MSG-AREA                          31670000
317400            MOVE XL073-SQLCODE       TO PV-SQL-RETURN-CD          31680000
317500            STRING ' PCKCS728 - '          DELIMITED BY SIZE      31690000
317600                   '6400-LINK-XLKUT073     ' DELIMITED BY SIZE    31700000
317700                    ' SQL - '              DELIMITED BY SIZE      31710000
317800                   PV-SQL-RETURN-CD        DELIMITED BY SIZE      31720000
317900                                         INTO PV-CICS-MSG-AREA    31730000
318000            MOVE LENGTH OF PV-CICS-MSG-AREA                       31740000
318100                   TO PV-COMMAREA-LENGTH                          31750000
318200            PERFORM 9990-WRITE-CICS                               31760000
318300            INITIALIZE  PV-CICS-MSG-AREA                          31770000
318400            STRING ' PCKCS728 -'             DELIMITED BY SIZE    31780000
318500                   ' PO:'                    DELIMITED BY SIZE    31790000
318600                   PV-PO-NBR                 DELIMITED BY SIZE    31800000
318700                   ' RCVR:'                  DELIMITED BY SIZE    31810000
318800                   PV-RCVR-NBR               DELIMITED BY SIZE    31820000
318900                   ' STR:'                   DELIMITED BY SIZE    31830000
319000                   PV-STORE-NBR              DELIMITED BY SIZE    31840000
319100                                         INTO PV-CICS-MSG-AREA    31850000
319200            MOVE LENGTH OF PV-CICS-MSG-AREA                       31860000
319300                   TO PV-COMMAREA-LENGTH                          31870000
319400            PERFORM 9990-WRITE-CICS                               31880000
319500            SET PC204-SQL-ERROR                                   31890000
319501                PS-ERROR         TO TRUE                          31900000
319502     END-EVALUATE.                                                31910000
319503                                                                  31920000
319504*----------------------------------------------------------------*31930000
319505 6680-CALL-XLKUT001.                                              31940000
319506                                                                  31950000
319507     INITIALIZE XL001-ITEM-COMMAREA.                              31950100
319508                                                                  31950200
319509     MOVE RECITM-ITM-NBR              TO XL001-KEY-ITM-NBR        31950300
319510                                                                  31950400
319520     SET  XL001-BY-ITEM                                           31950500
319530          XL001-SELECT-VND-STYL                                   31950600
319540          XL001-SELECT-SKU            TO TRUE                     31950700
319550                                                                  31950800
319560     CALL XL001-VSM-PGM USING  DFHEIBLK                           31950900
319570                               XL001-COMMAREA                     31951000
319580                               XL001-ITEM-COMMAREA.               31952000
319590     EVALUATE TRUE                                                31953000
319600         WHEN XL001-SUCCESSFUL                                    31954000
319700         WHEN XL001-UPC-SQLCODE = -811                            31955000
319800             MOVE XL001-HNG-FOLD-CDE  TO PV-HANG-FOLD-IND         31956000
319810         WHEN XL001-VND-STYL-NOT-FOUND                            31957000
319820                MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                    31958000
319830       WHEN OTHER                                                 31959000
319840            INITIALIZE  PV-CICS-MSG-AREA                          31960000
319850            MOVE SQLCODE             TO PV-SQL-RETURN-CD          31970000
319860            STRING ' PCKCS728 - '             DELIMITED BY SIZE   31980000
319870                   '6680-CALL-XLKUT001 '  DELIMITED BY SIZE       31981000
319880                   '  SQL - '                 DELIMITED BY SIZE   31982000
319890                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   31983000
319900                                         INTO PV-CICS-MSG-AREA    31984000
319910            MOVE LENGTH OF PV-CICS-MSG-AREA                       31985000
319920                   TO PV-COMMAREA-LENGTH                          31986000
319930            PERFORM 9990-WRITE-CICS                               31987000
319940            INITIALIZE  PV-CICS-MSG-AREA                          31988000
319941            STRING ' PCKCS728 -'             DELIMITED BY SIZE    31989000
319942                   ' PO:'                    DELIMITED BY SIZE    31990000
319943                   PV-PO-NBR                 DELIMITED BY SIZE    31991000
319944                   ' RCVR:'                  DELIMITED BY SIZE    31992000
319945                   PV-RCVR-NBR               DELIMITED BY SIZE    31993000
319946                   ' STR:'                   DELIMITED BY SIZE    31994000
319947                   PV-STORE-NBR              DELIMITED BY SIZE    31994100
319948                                         INTO PV-CICS-MSG-AREA    31994200
319949            MOVE LENGTH OF PV-CICS-MSG-AREA                       31994300
319950                   TO PV-COMMAREA-LENGTH                          31994400
319951            PERFORM 9990-WRITE-CICS                               31994500
319952            SET PC204-SQL-ERROR                                   31994600
319953                PS-ERROR         TO TRUE                          31994700
319954                                                                  31994800
319955                                                                  31994900
319956     END-EVALUATE.                                                31995000
319957                                                                  31995100
      *CLP 06/24/2015 - START                                           31995202
319958 6700-CHECK-BRAND.                                                31995302
319959                                                                  31995400
319960     MOVE XL001-SKU-NBR TO   XLT00003-SKU-NBR.                    31995502
319973                                                                  31996700
024720     EXEC SQL                                                     31996902
024730        SELECT  BRND_DESC                                         31997002
024740         INTO   :XLT00043-BRND-DESC                               31997302
024750          FROM  XLT_SKU      A                                    31997602
024750             ,  XLT_VND_STYL B                                    31997702
024760             ,  XLT_BRND     C                                    31997802
024770         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            31997902
024770           AND  A.STYL_ID         =  B.STYL_ID                    31998002
024780           AND  B.BRND_ID         =  C.BRND_ID                    31998102
024780           AND  c.BRND_ID         >  0                            31998208
024820     END-EXEC.                                                    31998308
024830                                                                  31998408
319974     EVALUATE TRUE                                                31998900
319975         WHEN SQLCODE = ZERO                                      31999000
319976              SET PS-BRAND-FOUND-YES TO TRUE                      31999102
319977         WHEN SQLCODE = +100                                      31999200
319978              SET PS-BRAND-FOUND-NO  TO TRUE                      31999302
319979         WHEN SQLWARN0 NOT = SPACE                                31999400
319980         WHEN SQLCODE NOT = ZERO                                  31999500
319981              INITIALIZE  PV-CICS-MSG-AREA                        31999600
319982              MOVE SQLCODE             TO PV-SQL-RETURN-CD        31999700
319983              STRING ' PCKCS728 - '             DELIMITED BY SIZE 31999800
319984                     '6700-CHECK-BRAND'         DELIMITED BY SIZE 31999902
319985                     '  SQL - '                 DELIMITED BY SIZE 32000000
319986                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 32000100
319987                                           INTO PV-CICS-MSG-AREA  32000200
319988              MOVE LENGTH OF PV-CICS-MSG-AREA                     32000300
319989                     TO PV-COMMAREA-LENGTH                        32000400
319990              PERFORM 9990-WRITE-CICS                             32000500
319991              INITIALIZE  PV-CICS-MSG-AREA                        32000600
319992              STRING ' PCKCS728 -'             DELIMITED BY SIZE  32000700
319993                     ' PO:'                    DELIMITED BY SIZE  32000800
319994                     PV-PO-NBR                 DELIMITED BY SIZE  32000900
319995                     ' RCVR:'                  DELIMITED BY SIZE  32001000
319996                     PV-RCVR-NBR               DELIMITED BY SIZE  32001100
319997                     ' STR:'                   DELIMITED BY SIZE  32001200
319998                     PV-STORE-NBR              DELIMITED BY SIZE  32001300
319999                                           INTO PV-CICS-MSG-AREA  32001400
320000              MOVE LENGTH OF PV-CICS-MSG-AREA                     32001500
320001                     TO PV-COMMAREA-LENGTH                        32001600
320002              PERFORM 9990-WRITE-CICS                             32001700
320003              SET PC204-SQL-ERROR                                 32001800
320004                  PS-ERROR         TO TRUE                        32001900
320005     END-EVALUATE.                                                32002000
      *CLP 06/24/2015 - END                                             32002102
320006*----------------------------------------------------------------*32002200
320007                                                                  32002300
320008*----------------------------------------------------------------*32002400
320009* SELECT LINE AND UNITS FROM TRECITM AND TRECDIS                  32002500
320010*----------------------------------------------------------------*32002600
320011 7000-SELECT-CRTNS-RESMOOTH.                                      32002700
320012     SET  PS-NOT-EOF-RESMTH-CSR TO TRUE.                          32002800
320013     SET  PS-NOT-EOF-SMTHNG-PRC-CSR TO TRUE.                      32002900
320014     SET  PS-NOT-NEW-CRTN-BRCE      TO TRUE.                      32003000
320015     SET  PS-NO-ERROR              TO TRUE.                       32003100
320016     PERFORM 7010-OPEN-RESMTH-CSR.                                32003200
320017*RESMOOTH_CRTN-CSR                                                32003300
320018*INITIAL FETCH of original carton id's                            32003400
320019     PERFORM 7020-FETCH-RESMTH-CSR.                               32003500
320020                                                                  32003600
320021     PERFORM 3010-OPEN-SMTHG-PROCESS-CSR                          32003700
320022                                                                  32003800
320023*INITIAL FETCH from work request table                            32003900
320024     PERFORM 3020-FETCH-SMTHG-PROCESS-CSR                         32004000
320025                                                                  32004100
320026       PERFORM UNTIL PS-EOF-SMTHNG-PRC-CSR                        32004200
320027                   OR PS-EOF-RESMTH-CSR                           32004300
320028                   OR PS-ERROR                                    32004400
320029         PERFORM 7100-UPD-OTBND-CART-DTE-TME                      32004500
320030         PERFORM 7150-UPD-SULBXF-TIMESTAMP                        32004600
320040         PERFORM 7200-DELETE-TSHHUPC                              32004700
320050                 MOVE SUT00003-CART-NBR TO PV-SAVE-CARTON-NBR     32004800
320060                 PERFORM UNTIL (SUT00003-CART-NBR NOT EQUAL       32004900
320070                                PV-SAVE-CARTON-NBR)    OR         32005000
320080                                PS-EOF-SMTHNG-PRC-CSR  OR         32005100
320090                                PS-EOF-RESMTH-CSR      OR         32005200
320100                                PS-ERROR                          32005300
320200                    PERFORM 3500-SELECT-UPC-NBRS                  32005400
320300                    PERFORM 3850-INSERT-OTBND-UPC                 32006000
320400                    PERFORM 3020-FETCH-SMTHG-PROCESS-CSR          32007000
320500                 END-PERFORM                                      32008000
320600                 PERFORM 7020-FETCH-RESMTH-CSR                    32009000
320700       END-PERFORM                                                32010000
320800                                                                  32020000
320900       IF PC204-RESMOOTH-CRTNS-ADD AND                            32030000
321000             PS-NOT-EOF-SMTHNG-PRC-CSR                            32040000
321100               PERFORM 7300-PROCESS-ADDL-LABELS                   32050000
321200       END-IF                                                     32060000
321300                                                                  32070000
321400                                                                  32080000
321500     PERFORM 3030-CLOSE-SMTHG-PROCESS-CSR.                        32090000
321600*----------------------------------------------------------------*32100000
321700* OPEN LABEL CURSOR                                              *32110000
321800*----------------------------------------------------------------*32120000
321900 7010-OPEN-RESMTH-CSR.                                            32130000
322000                                                                  32140000
322100     EXEC SQL                                                     32150000
322200         OPEN RESMOOTH_CRTN_CSR                                   32160000
322300     END-EXEC.                                                    32170000
322400                                                                  32180000
322500     EVALUATE TRUE                                                32190000
322600         WHEN SQLCODE = +0                                        32200000
322700              SET PS-NOT-EOF-LINE-UNITS-CSR TO  TRUE              32210000
322800         WHEN SQLCODE  NOT =  +0                                  32220000
322900              INITIALIZE  PV-CICS-MSG-AREA                        32230000
323000              MOVE SQLCODE             TO PV-SQL-RETURN-CD        32240000
323100              STRING ' PCKCS728 - '             DELIMITED BY SIZE 32250000
323200                     '7010-OPEN-RESMTH-CSR '   DELIMITED BY SIZE  32260000
323300                     '  SQL - '                 DELIMITED BY SIZE 32270000
323400                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 32280000
323500                                           INTO PV-CICS-MSG-AREA  32290000
323600              MOVE LENGTH OF PV-CICS-MSG-AREA                     32300000
323700                     TO PV-COMMAREA-LENGTH                        32310000
323800              PERFORM 9990-WRITE-CICS                             32320000
323900              INITIALIZE  PV-CICS-MSG-AREA                        32330000
324000              STRING ' PCKCS728 -'             DELIMITED BY SIZE  32340000
324100                     ' PO:'                    DELIMITED BY SIZE  32350000
324200                     PV-PO-NBR                 DELIMITED BY SIZE  32360000
324300                     ' RCVR:'                  DELIMITED BY SIZE  32370000
324400                     PV-RCVR-NBR               DELIMITED BY SIZE  32380000
324500                     ' STR:'                   DELIMITED BY SIZE  32390000
324600                     PV-STORE-NBR              DELIMITED BY SIZE  32400000
324700                                           INTO PV-CICS-MSG-AREA  32410000
324800              MOVE LENGTH OF PV-CICS-MSG-AREA                     32420000
324900                     TO PV-COMMAREA-LENGTH                        32430000
325000              PERFORM 9990-WRITE-CICS                             32440000
325100              SET PC204-SQL-ERROR                                 32450000
325200                  PS-ERROR  TO TRUE                               32460000
325300     END-EVALUATE.                                                32470000
325400                                                                  32480000
325500                                                                  32490000
325600                                                                  32500000
325700 7020-FETCH-RESMTH-CSR.                                           32510000
325800                                                                  32520000
325900     EXEC SQL                                                     32530000
326000          FETCH RESMOOTH_CRTN_CSR                                 32540000
326100           INTO :SUT00024-SHIPT-UNT-ID                            32550000
326200     END-EXEC.                                                    32560000
326300                                                                  32570000
326400     EVALUATE TRUE                                                32580000
326500         WHEN SQLCODE = ZERO                                      32590000
326600               MOVE SUT00024-SHIPT-UNT-ID                         32600000
326700                                    TO SUT00028-SHIPT-UNT-ID      32610000
326800         WHEN SQLCODE = +100                                      32620000
326900              SET PS-EOF-RESMTH-CSR                               32630000
327000                                   TO TRUE                        32640000
327100         WHEN SQLWARN0 NOT = SPACE                                32650000
327200         WHEN SQLCODE NOT = ZERO                                  32660000
327300              INITIALIZE  PV-CICS-MSG-AREA                        32670000
327400              MOVE SQLCODE             TO PV-SQL-RETURN-CD        32680000
327500              STRING ' PCKCS728 - '             DELIMITED BY SIZE 32690000
327600                     '7020-FETCH-RESMTH-CSR'   DELIMITED BY SIZE  32700000
327700                     '  SQL - '                 DELIMITED BY SIZE 32710000
327800                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 32720000
327900                                           INTO PV-CICS-MSG-AREA  32730000
328000              MOVE LENGTH OF PV-CICS-MSG-AREA                     32740000
328100                     TO PV-COMMAREA-LENGTH                        32750000
328200              PERFORM 9990-WRITE-CICS                             32760000
328300              INITIALIZE  PV-CICS-MSG-AREA                        32770000
328400              STRING ' PCKCS728 -'             DELIMITED BY SIZE  32780000
328500                     ' PO:'                    DELIMITED BY SIZE  32790000
328600                     PV-PO-NBR                 DELIMITED BY SIZE  32800000
328700                     ' RCVR:'                  DELIMITED BY SIZE  32810000
328800                     PV-RCVR-NBR               DELIMITED BY SIZE  32820000
328900                     ' STR:'                   DELIMITED BY SIZE  32830000
329000                     PV-STORE-NBR              DELIMITED BY SIZE  32840000
329100                                           INTO PV-CICS-MSG-AREA  32850000
329200              MOVE LENGTH OF PV-CICS-MSG-AREA                     32860000
329300                     TO PV-COMMAREA-LENGTH                        32870000
329400              PERFORM 9990-WRITE-CICS                             32880000
329500              SET PC204-SQL-ERROR                                 32890000
329600                  PS-ERROR         TO TRUE                        32900000
329700     END-EVALUATE.                                                32910000
329800                                                                  32920000
329900*----------------------------------------------------------------*32930000
330000* CLOSE LABEL CURSOR                                             *32940000
330100*----------------------------------------------------------------*32950000
330200 7030-CLOSE-RESMTH-CSR.                                           32960000
330300                                                                  32970000
330400     EXEC SQL                                                     32980000
330500         CLOSE RESMOOTH_CRTN_CSR                                  32990000
330600     END-EXEC.                                                    33000000
330700                                                                  33010000
330800     EVALUATE TRUE                                                33020000
330900         WHEN SQLCODE = +0                                        33030000
331000              CONTINUE                                            33040000
331100         WHEN SQLCODE  NOT =  +0                                  33050000
331200              INITIALIZE  PV-CICS-MSG-AREA                        33060000
331300              MOVE SQLCODE             TO PV-SQL-RETURN-CD        33070000
331400              STRING ' PCKCS728 - '             DELIMITED BY SIZE 33080000
331500                     '7030-CLOSE-RESMTH-CSR'   DELIMITED BY SIZE  33090000
331600                     '  SQL - '                 DELIMITED BY SIZE 33100000
331700                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 33110000
331800                                           INTO PV-CICS-MSG-AREA  33120000
331900              MOVE LENGTH OF PV-CICS-MSG-AREA                     33130000
332000                     TO PV-COMMAREA-LENGTH                        33140000
332100              PERFORM 9990-WRITE-CICS                             33150000
332200              INITIALIZE  PV-CICS-MSG-AREA                        33160000
332300              STRING ' PCKCS728 -'             DELIMITED BY SIZE  33170000
332400                     ' PO:'                    DELIMITED BY SIZE  33180000
332500                     PV-PO-NBR                 DELIMITED BY SIZE  33190000
332600                     ' RCVR:'                  DELIMITED BY SIZE  33200000
332700                     PV-RCVR-NBR               DELIMITED BY SIZE  33210000
332800                     ' STR:'                   DELIMITED BY SIZE  33220000
332900                     PV-STORE-NBR              DELIMITED BY SIZE  33230000
333000                                           INTO PV-CICS-MSG-AREA  33240000
333100              MOVE LENGTH OF PV-CICS-MSG-AREA                     33250000
333200                     TO PV-COMMAREA-LENGTH                        33260000
333300              PERFORM 9990-WRITE-CICS                             33270000
333400              SET PC204-SQL-ERROR                                 33280000
333500                  PS-ERROR         TO TRUE                        33290000
333600     END-EVALUATE.                                                33300000
333700                                                                  33310000
333800                                                                  33320000
333900*----------------------------------------------------------------*33330000
334000*  INACTIVATE LABEL CROSS REFERENCE ROW                           33340000
334100*----------------------------------------------------------------*33350000
334200 7100-UPD-OTBND-CART-DTE-TME.                                     33360000
334300                                                                  33370000
334400                                                                  33380000
334500     EXEC SQL                                                     33390000
334600          UPDATE SUT_OTBND_CART                                   33400000
334700             SET                                                  33410000
334800                  CRE_DTE            = :PV-CURRENT-DB2-DATE       33420000
334900                , CRE_TM             = :PV-CURRENT-DB2-TIME       33430000
335000           WHERE  SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID     33440000
335100     END-EXEC.                                                    33450000
335200                                                                  33460000
335300     EVALUATE TRUE                                                33470000
335400         WHEN SQLCODE = +0                                        33480000
335500              CONTINUE                                            33490000
335600         WHEN SQLCODE  NOT =  +0                                  33500000
335700              INITIALIZE  PV-CICS-MSG-AREA                        33510000
335800              MOVE SQLCODE             TO PV-SQL-RETURN-CD        33520000
335900              STRING ' PCKCS728 - '             DELIMITED BY SIZE 33530000
336000                     '7100-UPD-OTBND-CART-DTE-TME'                33540000
336100                                               DELIMITED BY SIZE  33550000
336200                     '  SQL - '                 DELIMITED BY SIZE 33560000
336300                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 33570000
336400                                           INTO PV-CICS-MSG-AREA  33580000
336500              MOVE LENGTH OF PV-CICS-MSG-AREA                     33590000
336600                     TO PV-COMMAREA-LENGTH                        33600000
336700              PERFORM 9990-WRITE-CICS                             33610000
336800              INITIALIZE  PV-CICS-MSG-AREA                        33620000
336900              STRING ' PCKCS728 -'             DELIMITED BY SIZE  33630000
337000                     ' PO:'                    DELIMITED BY SIZE  33640000
337100                     PV-PO-NBR                 DELIMITED BY SIZE  33650000
337200                     ' RCVR:'                  DELIMITED BY SIZE  33660000
337300                     PV-RCVR-NBR               DELIMITED BY SIZE  33670000
337400                     ' STR:'                   DELIMITED BY SIZE  33680000
337500                     PV-STORE-NBR              DELIMITED BY SIZE  33690000
337600                                           INTO PV-CICS-MSG-AREA  33700000
337700              MOVE LENGTH OF PV-CICS-MSG-AREA                     33710000
337800                     TO PV-COMMAREA-LENGTH                        33720000
337900              PERFORM 9990-WRITE-CICS                             33730000
338000              SET PC204-SQL-ERROR                                 33740000
338100                  PS-ERROR         TO TRUE                        33750000
338200     END-EVALUATE.                                                33760000
338300                                                                  33770000
338400                                                                  33780000
338500*----------------------------------------------------------------*33790000
338600*  INACTIVATE LABEL CROSS REFERENCE ROW                           33800000
338700*----------------------------------------------------------------*33810000
338800 7150-UPD-SULBXF-TIMESTAMP.                                       33820000
338900                                                                  33830000
339000                                                                  33840000
339100     EXEC SQL                                                     33850000
339200          UPDATE TSULBXF                                          33860000
339300             SET                                                  33870000
339400                  CRE_TMST           = :PV-CURRENT-DB2-TIMESTAMP  33880000
339500           WHERE  SHIPT_UNT_ID       = :SUT00024-SHIPT-UNT-ID     33890000
339600     END-EXEC.                                                    33900000
339700                                                                  33910000
339800     EVALUATE TRUE                                                33920000
339900         WHEN SQLCODE = +0                                        33930000
340000              CONTINUE                                            33940000
340100         WHEN SQLCODE  NOT =  +0                                  33950000
340200              INITIALIZE  PV-CICS-MSG-AREA                        33960000
340300              MOVE SQLCODE             TO PV-SQL-RETURN-CD        33970000
340400              STRING ' PCKCS728 - '             DELIMITED BY SIZE 33980000
340500                     '7150-UPD-SULBXF-TIMESTAMP' DELIMITED BY SIZE33990000
340600                     '  SQL - '                 DELIMITED BY SIZE 34000000
340700                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 34010000
340800                                           INTO PV-CICS-MSG-AREA  34020000
340900              MOVE LENGTH OF PV-CICS-MSG-AREA                     34030000
341000                     TO PV-COMMAREA-LENGTH                        34040000
341100              PERFORM 9990-WRITE-CICS                             34050000
341200              MOVE SUT00024-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID       34060000
341300              INITIALIZE  PV-CICS-MSG-AREA                        34070000
341400              STRING ' PCKCS728 -'             DELIMITED BY SIZE  34080000
341500                     ' PO:'                    DELIMITED BY SIZE  34090000
341600                     PV-PO-NBR                 DELIMITED BY SIZE  34100000
341700                     ' RCVR:'                  DELIMITED BY SIZE  34110000
341800                     PV-RCVR-NBR               DELIMITED BY SIZE  34120000
341900                     ' STR:'                   DELIMITED BY SIZE  34130000
342000                     PV-STORE-NBR              DELIMITED BY SIZE  34140000
342100                     ' ship unt:'              DELIMITED BY SIZE  34150000
342200                     PV-SHIPT-UNT-ID           DELIMITED BY SIZE  34160000
342300                                           INTO PV-CICS-MSG-AREA  34170000
342400              MOVE LENGTH OF PV-CICS-MSG-AREA                     34180000
342500                     TO PV-COMMAREA-LENGTH                        34190000
342600              PERFORM 9990-WRITE-CICS                             34200000
342700              SET PC204-SQL-ERROR                                 34210000
342800                  PS-ERROR         TO TRUE                        34220000
342900     END-EVALUATE.                                                34230000
343000                                                                  34240000
343100*----------------------------------------------------------------*34250000
343200*  DELETE THE VIRTUAL LABEL ROWS                                  34260000
343300*----------------------------------------------------------------*34270000
343400 7200-DELETE-TSHHUPC.                                             34280000
343500                                                                  34290000
343600     EXEC SQL                                                     34300000
343700          DELETE FROM SUT_OTBND_UPC                               34310000
343800           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         34320000
343900             AND TRN_NBR         = :DK-PO-NBR                     34330000
344000             AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                34340000
344100     END-EXEC.                                                    34350000
344200                                                                  34360000
344210     EVALUATE TRUE                                                34370000
344211         WHEN SQLCODE = ZERO                                      34380000
344212         WHEN SQLCODE = +100                                      34390000
344213              CONTINUE                                            34400000
344214         WHEN OTHER                                               34410000
344215              INITIALIZE  PV-CICS-MSG-AREA                        34420000
344216              MOVE SQLCODE             TO PV-SQL-RETURN-CD        34421000
344217              STRING ' PCKCS728 - '             DELIMITED BY SIZE 34421100
344218                     '7200-DELETE-TSHHUPC    ' DELIMITED BY SIZE  34421200
344219                     '  SQL - '                 DELIMITED BY SIZE 34421300
344220                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 34421400
344221                                           INTO PV-CICS-MSG-AREA  34421500
344222              MOVE LENGTH OF PV-CICS-MSG-AREA                     34421600
344223                     TO PV-COMMAREA-LENGTH                        34421700
344224              PERFORM 9990-WRITE-CICS                             34421800
344225              INITIALIZE  PV-CICS-MSG-AREA                        34421900
344226              MOVE SUT00024-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID       34422000
344227              STRING ' PCKCS728 -'             DELIMITED BY SIZE  34422100
344228                     ' PO:'                    DELIMITED BY SIZE  34422200
344229                     PV-PO-NBR                 DELIMITED BY SIZE  34422300
344230                     ' RCVR:'                  DELIMITED BY SIZE  34422400
344231                     PV-RCVR-NBR               DELIMITED BY SIZE  34422500
344232                     ' STR:'                   DELIMITED BY SIZE  34422600
344233                     PV-STORE-NBR              DELIMITED BY SIZE  34422700
344234                     ' ship unt:'              DELIMITED BY SIZE  34422800
344235                     PV-SHIPT-UNT-ID           DELIMITED BY SIZE  34422900
344236                                           INTO PV-CICS-MSG-AREA  34423000
344237              MOVE LENGTH OF PV-CICS-MSG-AREA                     34423100
344238                     TO PV-COMMAREA-LENGTH                        34423200
344239              PERFORM 9990-WRITE-CICS                             34423300
344240              SET PC204-SQL-ERROR                                 34423400
344241                  PS-ERROR         TO TRUE                        34423500
344242                                                                  34423600
344243     END-EVALUATE.                                                34423700
344244                                                                  34423800
344245 7300-PROCESS-ADDL-LABELS.                                        34423900
344246                                                                  34424000
344247     MOVE PC204-ADDL-LABELS-REQ TO PV-MAX-CTN-NBR                 34424100
344248                                                                  34424200
344249     PERFORM 3700-GET-MANIFEST-NBR                                34424300
344250                                                                  34424400
344251     SET PC180-SML-INTERNAL-LBL                                   34424500
344252         PC180-SML-FROM-KOHLS  TO  TRUE                           34424600
344253                                                                  34424700
344254     MOVE SUT00003-CART-NBR TO SUT00024-LBL-PRT-SEQ-NBR           34424800
344255                                                                  34424900
344256     PERFORM UNTIL PS-EOF-SMTHNG-PRC-CSR                          34425000
344257             OR PS-ERROR                                          34425100
344258             OR PS-SOCKET-ERROR                                   34425200
344259             MOVE SUT00003-CART-NBR TO PV-SAVE-CARTON-NBR         34425300
344260             PERFORM 3800-INSERT-OTBND-CART                       34425400
344270             PERFORM 3900-INSERT-TSULBXF                          34425500
344280             PERFORM UNTIL ((SUT00003-CART-NBR NOT EQUAL          34425600
344290                          PV-SAVE-CARTON-NBR) OR                  34425700
344300                             PS-EOF-SMTHNG-PRC-CSR) OR            34425800
344400                             PS-ERROR OR                          34425900
344500                             PS-SOCKET-ERROR                      34426000
344600                PERFORM 3500-SELECT-UPC-NBRS                      34427000
344700                PERFORM 3850-INSERT-OTBND-UPC                     34428000
344800                PERFORM 3020-FETCH-SMTHG-PROCESS-CSR              34429000
344900             END-PERFORM                                          34430000
345000             PERFORM 4900-CREATE-SML-LABEL                        34440000
345100             ADD +1 TO  PC180-SML-MNFST-NBR                       34450000
345200             ADD +1 TO  SUT00024-LBL-PRT-SEQ-NBR                  34460000
345300     END-PERFORM.                                                 34470000
345400                                                                  34480000
345500 8000-PROCESS-LABELS-STORE.                                       34490000
345600                                                                  34500000
345700     PERFORM 7010-OPEN-RESMTH-CSR.                                34510000
345800                                                                  34520000
345900     PERFORM  8005-REPRINT-LABELS-STORE                           34530000
346000           UNTIL PS-EOF-RESMTH-CSR OR                             34540000
346100                 PS-SOCKET-ERROR OR                               34550000
346200                 PS-ERROR                                         34560000
346300     PERFORM 7030-CLOSE-RESMTH-CSR.                               34570000
346400     SET PS-NOT-EOF-RESMTH-CSR TO TRUE.                           34580000
346500                                                                  34590000
346600 8005-REPRINT-LABELS-STORE.                                       34600000
346700     PERFORM  7020-FETCH-RESMTH-CSR                               34610000
346800     IF PS-NOT-EOF-RESMTH-CSR                                     34620000
346900         MOVE SUT00024-SHIPT-UNT-ID                               34630000
347000                             TO PV-SHIPT-UNT-ID-WRK               34640000
347100         MOVE PV-SHIPT-UNT-ID-WRK                                 34650000
347200                             TO PC180-SML-BARCODE                 34660000
347300         ADD +1  TO SUT00024-LBL-PRT-SEQ-NBR                      34670000
347400         PERFORM 4900-CREATE-SML-LABEL                            34680000
347500     END-IF.                                                      34690000
347600                                                                  34700000
347700 9000-RETURN-CALL.                                                34710000
347800*----------------------------------------------------------------*34720000
347900*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.         34730000
348000*----------------------------------------------------------------*34740000
348100                                                                  34750000
348200     MOVE  PC204-INTER-APPL-COMMAREA   TO DFHCOMMAREA.            34760000
348300                                                                  34770000
348400     EXEC CICS                                                    34780000
348500         RETURN                                                   34790000
348600     END-EXEC.                                                    34800000
348700                                                                  34810000
348800                                                                  34820000
348900 9100-SYNCPOINT.                                                  34830000
349000                                                                  34840000
349100     EXEC CICS                                                    34850000
349200         SYNCPOINT                                                34860000
349300     END-EXEC.                                                    34870000
349400                                                                  34880000
349500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 34890000
349600 9100-READ-SEL-QUEUE.                                             34900000
349700     EXEC CICS                                                    34910000
349800         READQ TS                                                 34920000
349900             QUEUE (PC204-SEL-QUEUE-NAME)                         34930000
350000             INTO  (PC206-DC-SELECT-RECORD)                       34940000
350100             ITEM  (PV-SEL-ITEM)                                  34950000
350200             RESP  (PV-CICS-RESPONSE)                             34960000
350300     END-EXEC.                                                    34970000
350400*                                                                 34980000
350500     EVALUATE PV-CICS-RESPONSE                                    34990000
350600         WHEN DFHRESP(NORMAL)                                     35000000
350700             CONTINUE                                             35010000
350800         WHEN DFHRESP(ITEMERR)                                    35020000
350900             SET PS-RPRT-REQST-QUEUE-EOF      TO TRUE             35030000
351000         WHEN OTHER                                               35040000
351100             PERFORM 9000-RETURN-CALL                             35050000
351200     END-EVALUATE.                                                35060000
351300                                                                  35070000
351400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*35080000
351500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        35090000
351600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 35100000
351700 9200-REWRITE-SEL-QUEUE.                                          35110000
351800                                                                  35120000
351900     EXEC CICS                                                    35130000
352000          WRITEQ TS                                               35140000
352100              QUEUE  (PC204-SEL-QUEUE-NAME)                       35150000
352200              FROM   (PC206-DC-SELECT-RECORD)                     35160000
352300              ITEM   (PV-SEL-ITEM)                                35170000
352400              RESP   (PV-CICS-RESPONSE)                           35180000
352500              REWRITE                                             35190000
352600     END-EXEC.                                                    35200000
352700                                                                  35210000
352800     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               35220000
352900         SET DP013-CICS-ABEND                                     35230000
353000             DP013-NO-ROLLBACK     TO TRUE                        35240000
353100         MOVE '9200-REWRITE-SEL-QUEUE'                            35250000
353200                                   TO DP013-PARAGRAPH             35260000
353300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   35270000
353400                                   TO DP013-MESSAGE-TEXT (1)      35280000
353500     END-IF.                                                      35290000
353600*----------------------------------------------------------------*35300000
353700*                                                                *35310000
353800*----------------------------------------------------------------*35320000
353900 9990-WRITE-CICS.                                                 35330000
354000     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     35340000
354100                                                                  35350000
354200     EXEC CICS WRITEQ TD                                          35360000
354300                      QUEUE('CSSL')                               35370000
354400                      FROM(PV-CICS-MSG-AREA)                      35380000
354500                      LENGTH(PV-COMMAREA-LENGTH)                  35390000
354600                      RESP (PV-CICS-RESPONSE)                     35400000
354700     END-EXEC.                                                    35410000
354800                                                                  35420000
354900     MOVE SPACES TO PV-CICS-MSG-AREA.                             35430000
355000                                                                  35440000
355100                                                                  35450000
355200*----------------------------------------------------------------*35460000
355300 9999-WRITE-CICS-LOG-MSG.                                         35470000
355400     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            35480000
355500     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           35490000
355600     INITIALIZE DP013-SRC-TASK-NUMBER                             35500000
355700                DP013-STACK.                                      35510000
355800     SET DP013-LINK-RETURN           TO TRUE.                     35520000
355900                                                                  35530000
356000     EXEC CICS                                                    35540000
356100         LINK                                                     35550000
356200             PROGRAM   (DP013-NAME)                               35560000
356300             COMMAREA  (DP013-PARAMETERS)                         35570000
356400             LENGTH    (DP013-LENGTH)                             35580000
356500     END-EXEC.                                                    35590000
356600                                                                  35600000
356700                                                                  35610000
356800*----------------------------------------------------------------*35620000
356900*    ABEND PROCESSOR MODULE                                      *35630000
357000*----------------------------------------------------------------*35640000
357100                                                                  35650000
357200     COPY DPPD014.                                                35660000
357300                                                                  35670000
