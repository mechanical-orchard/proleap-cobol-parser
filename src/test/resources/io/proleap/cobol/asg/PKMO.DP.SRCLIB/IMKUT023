000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020063
000300******************************************************************00030099
000400 PROGRAM-ID.    IMKUT023.                                         00040099
000500 AUTHOR.        COGNIZANT.                                        00050099
000600 INSTALLATION.  KOHLS.                                            00060063
000700 DATE-WRITTEN   JUNE, 2014.                                       00070099
000800 DATE-COMPILED.                                                   00080063
000900******************************************************************00090099
001000* IMKUT023 - DE-COMPRESS THE IM STYLE DELCAN FILE                 00100099
001100*                                                                 00111099
001200* THIS PROGRAM CONVERTS BINARY AND PACKED DECIMAL FORMAT RECORDS  00120099
001300* OF THE IM STYLE DELCAN FILE TO EDITABLE FORMAT                  00130099
001400*                                                                 00140099
001600******************************************************************00160099
001700* CHANGE DESCRIPTION                                              00170063
001800******************************************************************00180099
001900* DATE  06/20/2014                                                00190099
002000*  CHANGE MADE: INITIAL VERSION.                                  00200063
002100* MADE BY: VENKATSUBBU T (COGNIZANT)    TKID: TKMAGJ8             00210099
002100* CR NO : CHG0090773                                              00220099
002200***************************************************************** 00230063
002300 ENVIRONMENT DIVISION.                                            00240063
002310 CONFIGURATION SECTION.                                           00250099
002320 SOURCE-COMPUTER.        IBM-3090.                                00260099
002330 OBJECT-COMPUTER.        IBM-3090.                                00270099
002400 INPUT-OUTPUT SECTION.                                            00280063
002500*                                                                 00290063
002600 FILE-CONTROL.                                                    00300063
002700*                                                                 00310063
002800     SELECT INPUT-STYLE-SUM                                       00320099
002900         ASSIGN TO INP01.                                         00330063
003000*                                                                 00340063
003400     SELECT DECOMP-OUT-FILE                                       00350099
003500         ASSIGN TO OUT01.                                         00360063
003600*                                                                 00370063
003700***************************************************************** 00380063
003800 DATA DIVISION.                                                   00390063
003900***************************************************************** 00400063
004000 FILE SECTION.                                                    00410063
004100*                                                                 00420063
004200 FD  INPUT-STYLE-SUM                                              00430099
004300     RECORDING MODE IS F                                          00440063
004400     BLOCK CONTAINS 0 RECORDS                                     00450063
004500     LABEL RECORDS ARE STANDARD.                                  00460063
004600*                                                                 00470063
004700 01  IM-STYLE-REC                   PIC X(100).                   00480099
004800*                                                                 00490063
005600 FD  DECOMP-OUT-FILE                                              00500099
005700     RECORDING MODE IS F                                          00510063
005800     BLOCK CONTAINS 0 RECORDS                                     00520063
005900     LABEL RECORDS ARE STANDARD.                                  00530063
006000*                                                                 00540063
006100 01  DECOMP-OUT-REC                  PIC X(139).                  00550099
006200*                                                                 00560063
006300***************************************************************** 00570063
006400 WORKING-STORAGE SECTION.                                         00580063
006500*                                                                 00590063
006600 01  PS-PROGRAM-SWITCHES.                                         00600063
007000     05  PS-EOF-STYLE-SW              PIC X(01)  VALUE 'N'.       00610099
007100         88  PS-EOF-STYLE-YES                    VALUE 'Y'.       00620099
007200         88  PS-EOF-STYLE-NO                     VALUE 'N'.       00630099
007900*                                                                 00640063
008000 01  PC-PROGRAM-CONSTANTS.                                        00650063
008100     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'IMKUT023'.00660099
008400*                                                                 00670063
008500 01  PV-PROGRAM-VARIABLES.                                        00680063
008600     05  PV-INTR-UPC-ID               PIC  S9(10) COMP            00690099
008600                                                 VALUE  0.        00690199
008600     05  PV-RECS-READ-STYLE           PIC  9(09) VALUE  0.        00691099
008800     05  PV-RECS-WRITE-DECOMP         PIC  9(09) VALUE  0.        00700099
009800*                                                                 00710063
009900 01  PV-ABEND-FIELDS.                                             00720063
010000     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'IMKUT023'.00730099
010100     05  FILLER                       PIC  X(01) VALUE SPACES.    00740063
010200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00750063
010300     05  FILLER                       PIC  X(01) VALUE SPACES.    00760063
010400     05  PV-ABEND-MESSAGE             PIC  X(50) VALUE SPACES.    00770099
010500     05  FILLER                       PIC  X(01) VALUE SPACES.    00780078
010600     05  PV-OPERATION-ATTEMPTED       PIC  X(50) VALUE SPACE.     00790078
010700     05  FILLER                       PIC  X(01) VALUE SPACES.    00800063
010800     05  PV-ABEND-CODE                PIC  S9(04) VALUE +0  COMP. 00810078
010900*                                                                 00820077
013410***************************************************************** 00830099
013420*  RECORD LAYOUT FOR STYLE FILE                                 * 00840099
013430***************************************************************** 00850099
013500 01  WS020-STYLE-DELETE-REC.                                      00862099
013500     05  WS020-SUB-CL-MDSEAR-ID  PIC S9(06)    COMP-3             00863099
013500                                               VALUE ZERO.        00864099
013500     05  WS020-VS-ID             PIC S9(09)    COMP               00865099
013500                                               VALUE ZERO.        00866099
013500     05  WS020-INTR-UPC-ID       PIC S9(09)    COMP               00867099
013500                                               VALUE ZERO.        00868099
013500     05  WS020-ITM-NBR           PIC S9(15)    COMP-3.            00869099
013500     05  WS020-SKU               PIC S9(08)V   COMP-3             00870099
013500                                               VALUE ZERO.        00880099
013500     05  WS020-SKU-STAT          PIC X(02).                       00890099
013500     05  WS020-SKU-CNTR          PIC 9(08)     COMP               00900099
013500                                               VALUE ZERO.        00910099
013500     05  WS020-FILLER            PIC X(02)     VALUE SPACES.      00911099
013500     05  WS020-TWEBITM-IND       PIC X(01).                       00912099
013500     05  WS020-RMS-STYL-ID       PIC S9(08)    COMP-3             00913099
013500                                               VALUE ZERO.        00920099
013500     05  WS020-ENT-ID            PIC S9(9)     COMP               00930099
013500                                               VALUE ZERO.        00931099
013500     05  WS020-LAST-SALES-DTE    PIC X(08)     VALUE SPACES.      00932099
013500     05  WS020-LAST-RECEIPT-DTE  PIC X(08)     VALUE SPACES.      00933099
013500     05  WS020-VS-NBR            PIC X(20).                       00934099
013500     05  FILLER                  PIC X(21)     VALUE SPACES.      00950099
013500*                                                                 00960099
013570***************************************************************** 01120099
013580*  RECORD LAYOUT FOR DE-COMP OUTPUT FILE                        * 01130099
013590***************************************************************** 01140099
013591 01  WS-STYLE-DELETE-REC.                                         01150099
013593     05  WS-SUB-CL-MDSEAR-ID          PIC 9(06)  VALUE ZEROES.    01160099
013594     05  WS-VS-ID                     PIC 9(10)  VALUE ZEROES.    01170099
013595     05  WS-INTR-UPC-ID               PIC 9(10)  VALUE ZEROES.    01180099
013595     05  WS-ITM-NBR                   PIC 9(15)  VALUE ZEROES.    01190099
013595     05  WS-SKU                       PIC 9(08)  VALUE ZEROES.    01200099
013595     05  WS-SKU-STAT                  PIC X(02)  VALUE SPACES.    01210099
013595     05  WS-SKU-CNTR                  PIC 9(10)  VALUE ZEROES.    01220099
013595     05  WS-FILLER                    PIC X(02)  VALUE SPACES.    01230099
013595     05  WS-TWEBITM-IND               PIC X(01)  VALUE SPACES.    01240099
013595     05  WS-RMS-STYL-ID               PIC 9(08)  VALUE ZEROES.    01250099
013595     05  WS-ENT-ID                    PIC 9(10)  VALUE ZEROES.    01260099
013595     05  WS-LAST-SALES-DTE            PIC X(08)  VALUE SPACES.    01270099
013595     05  WS-LAST-RECEIPT-DTE          PIC X(08)  VALUE SPACES.    01280099
013595     05  WS-VS-NBR                    PIC X(20)  VALUE SPACES.    01290099
013597     05  FILLER                       PIC X(21)  VALUE SPACES.    01300099
013600*                                                                 01310099
013591 01  WS-STYLE-DELETE-REC-X.                                       01320099
013593     05  WS-SUB-CL-MDSEAR-ID-X        PIC X(06)  VALUE ZEROES.    01330099
013594     05  WS-VS-ID-X                   PIC X(10)  VALUE ZEROES.    01340099
013595     05  WS-INTR-UPC-ID-X             PIC X(10)  VALUE ZEROES.    01350099
013595     05  WS-ITM-NBR-X                 PIC X(15)  VALUE ZEROES.    01360099
013595     05  WS-SKU-X                     PIC X(08)  VALUE ZEROES.    01370099
013595     05  WS-SKU-STAT-X                PIC X(02)  VALUE SPACES.    01380099
013595     05  WS-SKU-CNTR-X                PIC X(10)  VALUE ZEROES.    01390099
013595     05  WS-FILLER-X                  PIC X(02)  VALUE SPACES.    01400099
013595     05  WS-TWEBITM-IND-X             PIC X(01)  VALUE SPACES.    01410099
013595     05  WS-RMS-STYL-ID-X             PIC X(08)  VALUE ZEROES.    01420099
013595     05  WS-ENT-ID-X                  PIC X(10)  VALUE ZEROES.    01430099
013595     05  WS-LAST-SALES-DTE-X          PIC X(08)  VALUE SPACES.    01440099
013595     05  WS-LAST-RECEIPT-DTE-X        PIC X(08)  VALUE SPACES.    01450099
013595     05  WS-VS-NBR-X                  PIC X(20)  VALUE SPACES.    01460099
013597     05  FILLER                       PIC X(21)  VALUE SPACES.    01470099
013600*                                                                 01480099
017100***************************************************************** 01490063
017200 PROCEDURE DIVISION.                                              01500063
017300***************************************************************** 01510063
017400     DISPLAY '**** BEGINNING IMKUT023 ****'.                      01520099
017500     DISPLAY ' '.                                                 01530063
017600*                                                                 01540063
017700 0000-MAIN-PARA.                                                  01550063
017800     PERFORM 1000-INITIALIZATION.                                 01560063
017900     PERFORM 2000-MAIN-PROCESS.                                   01570063
018000     PERFORM 9000-EOJ.                                            01580064
018100*                                                                 01590065
018200        STOP RUN.                                                 01600067
018300*                                                                 01610063
018400***************************************************************** 01620063
018500*  INITIALIZE PARA                                                01630063
018600***************************************************************** 01640063
018700 1000-INITIALIZATION.                                             01650063
018800*                                                                 01660084
018900     MOVE '1000-INITIALIZATION ' TO PV-ABEND-PARAGRAPH.           01670063
019000*                                                                 01680063
019300     OPEN INPUT  INPUT-STYLE-SUM                                  01690099
019500          OUTPUT DECOMP-OUT-FILE.                                 01700099
019600*                                                                 01710063
019700     INITIALIZE PV-PROGRAM-VARIABLES.                             01720063
020000     INITIALIZE WS-STYLE-DELETE-REC.                              01730099
020100*                                                                 01740063
020200***************************************************************** 01750063
020300*  MAIN PROCESS PARA                                              01760063
020400***************************************************************** 01770063
020500 2000-MAIN-PROCESS.                                               01780063
020600*                                                                 01790063
020700     MOVE '2000-MAIN-PROCESS ' TO PV-ABEND-PARAGRAPH.             01800063
020800*                                                                 01810063
020900      PERFORM 2100-READ-STYLE-FILE                                01820099
021000        UNTIL PS-EOF-STYLE-YES.                                   01830099
021010*                                                                 01840099
022100*                                                                 01850063
027600***************************************************************** 01860063
027700*  READ IM STYLE DELCAN FILE                                   *  01870099
027800***************************************************************** 01880063
027900 2100-READ-STYLE-FILE.                                            01890099
028000*                                                                 01900063
028100     MOVE '2100-READ-STYLE-FILE ' TO PV-ABEND-PARAGRAPH.          01910099
028200*                                                                 01920063
028300       READ INPUT-STYLE-SUM                                       01930099
028400          INTO WS020-STYLE-DELETE-REC                             01940099
028500       AT END                                                     01950063
028600          SET PS-EOF-STYLE-YES       TO TRUE                      01960099
028700       END-READ.                                                  01970063
028800*                                                                 01980063
028900       IF PS-EOF-STYLE-NO                                         01990099
029000            ADD 1                   TO PV-RECS-READ-STYLE         02000099
029100            PERFORM 2200-WRITE-DECOMP-FILE                        02010099
029100       END-IF.                                                    02020063
029100                                                                  02030099
029200*                                                                 02040063
029307***************************************************************** 02050099
029308* WRITE DECOMP OUTPUT FILE                                        02060099
029309***************************************************************** 02070099
029310 2200-WRITE-DECOMP-FILE.                                          02080099
029311*                                                                 02090099
029312     MOVE '2200-WRITE-DECOMP-FILE'  TO PV-ABEND-PARAGRAPH.        02100099
029313*                                                                 02110099
029314     MOVE WS020-SUB-CL-MDSEAR-ID TO WS-SUB-CL-MDSEAR-ID           02120099
029314     MOVE WS020-VS-ID            TO WS-VS-ID                      02130099
029314     MOVE WS020-INTR-UPC-ID      TO PV-INTR-UPC-ID                02140099
029314     MOVE PV-INTR-UPC-ID         TO WS-INTR-UPC-ID                02141099
029314     MOVE WS020-ITM-NBR          TO WS-ITM-NBR                    02150099
029314     MOVE WS020-SKU              TO WS-SKU                        02160099
029314     MOVE WS020-SKU-STAT         TO WS-SKU-STAT                   02170099
029314     MOVE WS020-SKU-CNTR         TO WS-SKU-CNTR                   02180099
029314     MOVE WS020-FILLER           TO WS-FILLER                     02181099
029314     MOVE WS020-TWEBITM-IND      TO WS-TWEBITM-IND                02190099
029314     MOVE WS020-RMS-STYL-ID      TO WS-RMS-STYL-ID                02200099
029314     MOVE WS020-ENT-ID           TO WS-ENT-ID                     02210099
029314     MOVE WS020-LAST-SALES-DTE   TO WS-LAST-SALES-DTE             02220099
029314     MOVE WS020-LAST-RECEIPT-DTE TO WS-LAST-RECEIPT-DTE           02230099
029314     MOVE WS020-VS-NBR           TO WS-VS-NBR                     02240099
029323                                                                  02250099
029323     MOVE WS-SUB-CL-MDSEAR-ID TO WS-SUB-CL-MDSEAR-ID-X            02260099
029323     MOVE WS-VS-ID            TO WS-VS-ID-X                       02270099
029323     MOVE WS-INTR-UPC-ID      TO WS-INTR-UPC-ID-X                 02280099
029323     MOVE WS-ITM-NBR          TO WS-ITM-NBR-X                     02290099
029323     MOVE WS-SKU              TO WS-SKU-X                         02300099
029323     MOVE WS-SKU-STAT         TO WS-SKU-STAT-X                    02310099
029323     MOVE WS-SKU-CNTR         TO WS-SKU-CNTR-X                    02320099
029314     MOVE WS-FILLER           TO WS-FILLER-X                      02321099
029323     MOVE WS-TWEBITM-IND      TO WS-TWEBITM-IND-X                 02330099
029323     MOVE WS-RMS-STYL-ID      TO WS-RMS-STYL-ID-X                 02340099
029323     MOVE WS-ENT-ID           TO WS-ENT-ID-X                      02350099
029323     MOVE WS-LAST-SALES-DTE   TO WS-LAST-SALES-DTE-X              02360099
029323     MOVE WS-LAST-RECEIPT-DTE TO WS-LAST-RECEIPT-DTE-X            02370099
029323     MOVE WS-VS-NBR           TO WS-VS-NBR-X                      02380099
029323*                                                                 02390099
029323     WRITE DECOMP-OUT-REC FROM WS-STYLE-DELETE-REC-X              02450099
029323     ADD 1                       TO PV-RECS-WRITE-DECOMP.         02460099
029323*                                                                 02470099
039700***************************************************************** 02480071
039800*  END OF JOB OPERATIONS                                        * 02490063
039900***************************************************************** 02500063
040000 9000-EOJ.                                                        02510063
040100*                                                                 02520063
040200     MOVE '9000-EOJ ' TO PV-ABEND-PARAGRAPH.                      02530063
040300*                                                                 02540063
040400     CLOSE INPUT-STYLE-SUM                                        02550099
040600           DECOMP-OUT-FILE.                                       02560099
040700*                                                                 02570063
041114*                                                                 02580090
041200      DISPLAY 'STYLE REC READ COUNT   : ' PV-RECS-READ-STYLE.     02590099
041300      DISPLAY 'DECOMP REC WRITE COUNT : ' PV-RECS-WRITE-DECOMP.   02600099
041700*                                                                 02610063
044400******************************************************************02620098
044500*  THIS ROUTINE FORCES AN ABEND                                   02630098
044600******************************************************************02640098
044700 9999-ABEND.                                                      02650098
044800                                                                  02660098
044900     MOVE +4013 TO PV-ABEND-CODE.                                 02670098
044910     DISPLAY 'PARA : ' PV-ABEND-PARAGRAPH.                        02680099
044920     DISPLAY 'CODE : ' PV-ABEND-CODE.                             02690099
044930     DISPLAY 'ERROR: ' PV-ABEND-MESSAGE.                          02700099
045000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         02710099
