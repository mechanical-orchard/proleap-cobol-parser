000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUT180.                                00050000
000600 AUTHOR.                 RON KRIER.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JUNE 2021.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO TAKE IN A FILE FROM THE SKU     * 00120001
001210*  SORT APPLICATION THAT REPRESENTS DATA FOR A PO THAT HAS BEEN * 00121001
001220*  PROCESSED BY THAT APPLICATION AND NOW NEEDS TO HAVE A        * 00122001
001230*  PACKSLIP CREATED FOR THE PO/DC.  THE INPUT FILE WILL USE     * 00123001
001240*  COPYBOOK RCRD108 WHICH IS THE PARSED XML DATA FROM THE SKU   * 00124001
001250*  SORT APPLICATION.  THIS PROGRAM WILL VALIDATE THE DATA ON    * 00125001
001260*  THE INPUT FILE AND THEN CREATE AN OUTPUT RECORD USING THE    * 00126001
001270*  RCRD101 COPYBOOK WHICH CAN THEN BE FED THROUGH OTHER         * 00127001
001280*  PROGRAMS TO CREATE THE PACKSLIP BUILD PROCESS.               * 00128001
001400*                                                               * 00140000
001500*  THIS PROGRAM WILL TAKE THE INPUT DATA AND VALIDATE THE DATA  * 00150001
001600*  IN THE FILE (LIKE VALIDATE THE DC NUMBER, THE PO NUMBER,     * 00160001
001700*  THE SSCC CARTON NUMBER AND SKU NUMBER (ALSO VALIDATE THAT    * 00170001
001800*  THE SKU IS FOUND ON THE PO).                                 * 00180001
002000***************************************************************** 00200000
002010* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00201017
002020* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00202018
002030* MAKING THE CALL DYNAMIC VS STATIC.                              00203018
002040*---------------------------------------------------------------* 00204018
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 SOURCE-COMPUTER.        IBM-3090.                                00260000
002700 OBJECT-COMPUTER.        IBM-3090.                                00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT SKU-SORT-DATA-FILE                                    00330001
003400         ASSIGN TO INP01.                                         00340000
003500                                                                  00350000
003600     SELECT SKU-SORT-OUTPUT-FILE                                  00360001
003700         ASSIGN TO OUT01.                                         00370000
003800                                                                  00380000
003900     SELECT SKU-SORT-ERROR-FILE                                   00390001
004000         ASSIGN TO OUT02.                                         00400000
004100                                                                  00410000
004200     SELECT ERROR-REPORT-FILE                                     00420000
004300         ASSIGN TO RPT01.                                         00430000
004400                                                                  00440000
004500******************************************************************00450000
004600 DATA DIVISION.                                                   00460000
004700******************************************************************00470000
004800                                                                  00480000
004900 FILE SECTION.                                                    00490000
005000                                                                  00500000
005100 FD  SKU-SORT-DATA-FILE                                           00510001
005200     RECORDING MODE IS F                                          00520000
005300     LABEL RECORDS ARE STANDARD                                   00530000
005400     BLOCK CONTAINS 0 RECORDS.                                    00540000
005500 01  SKU-SORT-DATA-RECORD             PIC  X(100).                00550001
005600                                                                  00560000
005700 FD  SKU-SORT-OUTPUT-FILE                                         00570001
005800     RECORDING MODE IS F                                          00580000
005900     BLOCK CONTAINS 0  RECORDS.                                   00590000
006000 01  SKU-SORT-OUTPUT-RECORD           PIC  X(150).                00600001
006100                                                                  00610000
006200 FD  SKU-SORT-ERROR-FILE                                          00620001
006300     RECORDING MODE IS F                                          00630000
006400     BLOCK CONTAINS 0  RECORDS.                                   00640000
006500 01  SKU-SORT-ERROR-RECORD            PIC  X(100).                00650001
006600                                                                  00660000
006700 FD  ERROR-REPORT-FILE                                            00670000
006800     RECORDING MODE IS F                                          00680000
006900     BLOCK CONTAINS 0  RECORDS.                                   00690000
007000 01  ERROR-REPORT-RECORD              PIC  X(150).                00700001
007100                                                                  00710000
007200 WORKING-STORAGE SECTION.                                         00720000
007300                                                                  00730000
007400 01  FILLER                      PIC  X(46)    VALUE              00740000
007500     '** WORKING STORAGE FOR RCKUT180 STARTS HERE **'.            00750000
007600                                                                  00760000
007610 01  DATABASE-KEY-FIELDS.                                         00761000
007620     05  DK-PO-NUMBER                PIC  S9(9)  COMP.            00762000
007630     05  DK-DC-NUMBER                PIC  S9(4)  COMP.            00763000
007640     05  DK-UPC-NUMBER               PIC  S9(15) COMP-3.          00764000
007650     05  DK-SKU-NUMBER               PIC  S9(8)  COMP-3.          00765000
007660     05  DK-SSCC-NUMBER              PIC  S9(18) COMP-3.          00766000
007670     05  DK-MDSE-SOURCE              PIC   X(03).                 00767000
007680                                                                  00768000
007690 01  PV-CSV-RECORD.                                               00769000
007700     05  PV-CSV-FIELDS               PIC  X(100)   VALUE SPACES.  00770000
007800                                                                  00780000
007900 01  PROGRAM-SWITCHES.                                            00790000
008000     05  END-OF-FILE-SW              PIC  X(01)    VALUE 'Y'.     00800000
008100         88  END-OF-FILE                           VALUE 'N'.     00810000
008200     05  PS-WRITE-ERROR-DATA-SW      PIC X(01)     VALUE 'N'.     00820002
008300         88  PS-WRITE-ERROR-DATA-NO                VALUE 'N'.     00830002
008400         88  PS-WRITE-ERROR-DATA-YES               VALUE 'Y'.     00840002
008500     05  PS-ERROR-SW                 PIC X(01)     VALUE 'N'.     00850000
008600         88  PS-ERROR-NO                           VALUE 'N'.     00860000
008700         88  PS-ERROR-YES                          VALUE 'Y'.     00870000
008800     05  PS-NUMERIC-ERROR-SW         PIC X(01)     VALUE 'N'.     00880000
008900         88  PS-NUMERIC-ERROR-NO                   VALUE 'N'.     00890000
009000         88  PS-NUMERIC-ERROR-YES                  VALUE 'Y'.     00900000
009100     05  PS-PO-FOUND-SW              PIC X(01)     VALUE 'N'.     00910000
009200         88  PS-PO-NOT-FOUND                       VALUE 'N'.     00920000
009300         88  PS-PO-FOUND                           VALUE 'Y'.     00930002
009500     05  PS-PREV-PO-FOUND-SW         PIC X(01)     VALUE 'N'.     00950000
009600         88  PS-PREV-PO-NOT-FOUND                  VALUE 'N'.     00960000
009700         88  PS-PREV-SINGLE-PO-FOUND               VALUE 'Y'.     00970000
009800         88  PS-PREV-MULT-PO-FOUND                 VALUE 'M'.     00980000
009900     05  PS-UPC-FOUND-SW             PIC X(01)     VALUE 'N'.     00990000
010000         88  PS-UPC-NOT-FOUND                      VALUE 'N'.     01000000
010100         88  PS-UPC-FOUND                          VALUE 'Y'.     01010000
010110     05  PS-SKU-FOUND-SW             PIC X(01)     VALUE 'N'.     01011002
010120         88  PS-SKU-NOT-FOUND                      VALUE 'N'.     01012002
010130         88  PS-SKU-FOUND                          VALUE 'Y'.     01013002
010200     05  PS-PO-LINE-FOUND-SW         PIC X(01)     VALUE 'N'.     01020000
010300         88  PS-PO-LINE-NOT-FOUND                  VALUE 'N'.     01030000
010400         88  PS-PO-LINE-FOUND                      VALUE 'Y'.     01040000
010500     05  PS-SSCC-FOUND-SW            PIC X(01)     VALUE 'N'.     01050000
010600         88  PS-SSCC-NOT-FOUND                     VALUE 'N'.     01060000
010700         88  PS-SSCC-FOUND                         VALUE 'Y'.     01070000
010710         88  PS-SSCC-FOUND-MULT-PO                 VALUE 'P'.     01071014
010800     05  PS-DC-FOUND-SW              PIC X(01)     VALUE 'N'.     01080000
010900         88  PS-DC-NOT-FOUND                       VALUE 'N'.     01090000
011000         88  PS-DC-FOUND                           VALUE 'Y'.     01100000
011100     05  PS-SSCC-F10-NUMERIC-SW      PIC X(01)     VALUE 'N'.     01110000
011110         88  PS-SSCC-F10-NOT-NUMERIC               VALUE 'N'.     01111000
011120         88  PS-SSCC-F10-NUMERIC                   VALUE 'Y'.     01112000
011130     05  PS-SSCC-L10-NUMERIC-SW      PIC X(01)     VALUE 'N'.     01113000
011140         88  PS-SSCC-L10-NOT-NUMERIC               VALUE 'N'.     01114000
011150         88  PS-SSCC-L10-NUMERIC                   VALUE 'Y'.     01115000
011160     05  PS-COMMENT-TYPE-SW          PIC X(01)     VALUE 'N'.     01116000
011170         88  PS-COMMENT-TYPE-ERROR                 VALUE 'E'.     01117000
011180         88  PS-COMMENT-TYPE-WARNING               VALUE 'W'.     01118000
011190     05  PS-REPORT-WRITE-SW          PIC X(01)     VALUE 'N'.     01119000
011200         88  PS-REPORT-WRITE-YES                   VALUE 'Y'.     01120000
011210         88  PS-REPORT-WRITE-NO                    VALUE 'N'.     01121000
011211     05  PS-DEFAULT-CARTON-SW        PIC X(01)     VALUE 'N'.     01121118
011212         88  PS-DEFAULT-CARTON-YES                 VALUE 'Y'.     01121218
011213         88  PS-DEFAULT-CARTON-NO                  VALUE 'N'.     01121318
011220                                                                  01122000
011230 01  PC-CONSTANTS.                                                01123000
011240     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01124000
011250                                                   COMP SYNC.     01125000
011260     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +65.     01126000
011270     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01127000
011280                                                   'RCKUT180'.    01128000
011290     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       01129000
011300                                                                  01130000
011400     05  PC-COMMA                    PIC X(01)     VALUE ','.     01140000
011500     05  PC-PERIOD                   PIC X(01)     VALUE '.'.     01150000
011600     05  PC-D                        PIC X(01)     VALUE 'D'.     01160000
011700     05  PC-T                        PIC X(01)     VALUE 'T'.     01170000
011800     05  PC-PROGRESSIVE-READ-LIMIT   PIC S9(9)     VALUE 10       01180002
011900                                                    COMP-3.       01190000
011910     05  PC-DEFAULT-TRN              PIC S9(09)    VALUE          01191018
012000                                                    -999999999.   01200018
012010     05  PC-RCV                      PIC X(03)     VALUE 'RCV'.   01201023
012020                                                                  01202023
012100 01  PV-ACCUMULATOR-FIELDS.                                       01210000
012200     05  PV-RETRY-COUNT              PIC S9(04)  VALUE +0         01220000
012300                                                   COMP SYNC.     01230000
012400     05  PV-COMMA-COUNT              PIC S9(04)  VALUE +0         01240000
012500                                                   COMP SYNC.     01250000
012600     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01260000
012700                                                   COMP-3.        01270000
012800     05  PV-LINE-CNT                 PIC S9(04)    VALUE ZERO     01280000
012900                                                   COMP SYNC.     01290000
013000                                                                  01300000
013700 01  PV-ABEND-FIELDS.                                             01370000
013800     05  PV-ABEND-CODE               PIC S9(04)  VALUE ZERO       01380000
013900                                                   COMP SYNC.     01390000
014000     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)  VALUE SPACES.    01400000
014100     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT180'.01410000
014200     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01420000
014300     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01430000
014400     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01440000
014500     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01450000
014600     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01460000
014700     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01470000
014800     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      01480000
016100                                                                  01610000
016200 01  PV-MISC-FIELDS.                                              01620000
016300     05  PV-READ-COUNT               PIC  S9(9)     VALUE ZERO    01630000
016400                                                    COMP-3.       01640000
016500     05  PV-PROGRESSIVE-READ-COUNT   PIC  S9(9)     VALUE ZERO    01650000
016600                                                    COMP-3.       01660000
017300     05  PV-GOOD-WRITE-COUNT         PIC  S9(9)     VALUE ZERO    01730000
017400                                                    COMP-3.       01740000
017500     05  PV-ERROR-WRITE-COUNT        PIC  S9(9)     VALUE ZERO    01750000
017600                                                    COMP-3.       01760000
017700     05  PV-TOTAL-RECORD-QTY         PIC  S9(9)     VALUE ZERO    01770000
017800                                                    COMP-3.       01780000
018300     05  PV-ERR-SSCC-NOT-00-CNT      PIC S9(9)  VALUE ZERO COMP-3.01830005
018400     05  PV-ERR-NON-NUMERIC-CNT      PIC S9(9)  VALUE ZERO COMP-3.01840005
018500     05  PV-ERR-PO-NOT-FOUND-CNT     PIC S9(9)  VALUE ZERO COMP-3.01850005
018600     05  PV-ERR-SKU-NOT-FOUND-CNT    PIC S9(9)  VALUE ZERO COMP-3.01860005
018700     05  PV-ERR-SKU-NOT-ON-PO-CNT    PIC S9(9)  VALUE ZERO COMP-3.01870005
018800     05  PV-ERR-SSCC-SAME-PO-CNT     PIC S9(9)  VALUE ZERO COMP-3.01880014
018900     05  PV-ERR-SSCC-DIFF-PO-CNT     PIC S9(9)  VALUE ZERO COMP-3.01890014
018910     05  PV-ERR-SSCC-MULT-PO-CNT     PIC S9(9)  VALUE ZERO COMP-3.01891014
019000     05  PV-ERR-LOC-NOT-A-KDC-CNT    PIC S9(9)  VALUE ZERO COMP-3.01900005
019100     05  PV-ERR-NOT-ON-LOCMST-CNT    PIC S9(9)  VALUE ZERO COMP-3.01910005
019200     05  PV-DSP-NO-DEL-SCAC-CNT      PIC S9(9)  VALUE ZERO COMP-3.01920005
019300     05  PV-ERR-QTY-EQ-ZERO-CNT      PIC S9(9)  VALUE ZERO COMP-3.01930005
019800     05  PV-PREV-KOHLS-ORD-NBR       PIC 9(10)     VALUE ZERO.    01980002
019810     05  PV-PREV-DC-NBR              PIC 9(04)     VALUE ZERO.    01981004
019900     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACES.  01990000
020000     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02000000
020100                                                   COMP SYNC.     02010000
020200     05  PV-CURRENT-TMST-DB2         PIC X(26)     VALUE SPACE.   02020000
020300     05  PV-CURRENT-TMST.                                         02030000
020400         10  PV-CURR-DATE.                                        02040000
020500             15  PV-CURR-DATE-CC     PIC  9(02)    VALUE ZERO.    02050000
020600             15  PV-CURR-DATE-YY     PIC  9(02)    VALUE ZERO.    02060000
020700             15  PV-CURR-DASH1       PIC  X        VALUE SPACE.   02070000
020800             15  PV-CURR-DATE-MM     PIC  9(02)    VALUE ZERO.    02080000
020900             15  PV-CURR-DASH2       PIC  X        VALUE SPACE.   02090000
021000             15  PV-CURR-DATE-DD     PIC  9(02)    VALUE ZERO.    02100000
021100             15  PV-CURR-DASH3       PIC  X        VALUE SPACE.   02110000
021200         10  PV-CURR-TIME.                                        02120000
021300             15  PV-CURR-TIME-HH     PIC  9(02)    VALUE ZERO.    02130000
021400             15  PV-CURR-TIME-P1     PIC  X        VALUE SPACE.   02140000
021500             15  PV-CURR-TIME-MM     PIC  9(02)    VALUE ZERO.    02150000
021600             15  PV-CURR-TIME-P2     PIC  X        VALUE SPACE.   02160000
021700             15  PV-CURR-TIME-SS     PIC  9(02)    VALUE ZERO.    02170000
021800             15  FILL                PIC  X(07)    VALUE SPACE.   02180000
021900                                                                  02190000
022000     05  PV-NULL-IND                 PIC  S9(4)    VALUE ZERO     02200000
022100                                                   COMP SYNC.     02210000
022200     05  PV-DB2-COUNT                PIC  S9(9)    VALUE ZERO     02220000
022300                                                   COMP-3.        02230000
022400     05  PV-DISP-NBR-C               PIC  ZZ,ZZZ,ZZ9.             02240000
022500     05  PV-DISP-NBR-C2              PIC  ZZ,ZZZ,ZZ9.             02250000
022600     05  PV-DISP-NBR                 PIC  ZZZZZZZ9.               02260000
022700     05  PV-DISP-NBR-15              PIC  999999999999999.        02270000
022800     05  PV-DISP-NBR-10              PIC  9999999999.             02280000
022900     05  PV-DISP-NBR-8               PIC  99999999.               02290000
023000     05  PV-DISP-NBR-18              PIC  999999999999999999.     02300000
023100     05  PV-DISP-NBR-4               PIC  9999.                   02310000
023200                                                                  02320000
023300     05  PV-CURR-CCYY.                                            02330000
023400         10  PV-CURR-CC              PIC  X(02)    VALUE SPACE.   02340000
023500         10  PV-CURR-YY              PIC  X(02)    VALUE SPACE.   02350000
023600                                                                  02360000
023700     05  PV-SPLIT-SSCC-NBR.                                       02370000
023800         10  PV-SPLIT-SSCC-NBR-F10   PIC  X(10)    VALUE SPACE.   02380000
023900         10  PV-SPLIT-SSCC-NBR-L10   PIC  X(10)    VALUE SPACE.   02390000
024000                                                                  02400000
024100     05  PV-SSCC-NBR-FINAL.                                       02410000
024200         10  PV-SSCC-NBR-FINAL-F2    PIC  9(02)    VALUE ZERO.    02420000
024300         10  PV-SSCC-NBR-FINAL-L18   PIC  9(18)    VALUE ZERO.    02430000
024400                                                                  02440000
024520     05  PV-ERROR-MESSAGE            PIC  X(60)    VALUE SPACE.   02452002
024600                                                                  02460000
024700******************************************************************02470000
024800*  WORK FIELDS FOR PRINTING A 200 CHARACTER REPORT.               02480000
024900******************************************************************02490000
025000     COPY DPWS150O.                                               02500001
025100                                                                  02510000
025200******************************************************************02520000
025300*  REPORT HEADING/DETAIL LINES. WSKRP007                          02530001
025400******************************************************************02540000
025410                                                                  02541001
025411 01  HL1-HEADING-LINE-1.                                          02541101
025412     05  FILLER                       PIC X(58)   VALUE SPACES.   02541202
025413     05  FILLER                       PIC X(32)   VALUE           02541302
025414         'SKU-SORT APPLICATION DATA ERRORS'.                      02541402
025415     05  FILLER                       PIC X(60)   VALUE SPACES.   02541502
025416                                                                  02541601
025426 01  HL2-HEADING-LINE-2.                                          02542602
025427     05  FILLER                       PIC X(14)   VALUE           02542702
025428         'DATA FILE NAME'.                                        02542802
025429     05  FILLER                       PIC X(7)    VALUE SPACES.   02542902
025430     05  FILLER                       PIC X(8)    VALUE           02543002
025431         'KOHLS PO'.                                              02543102
025432     05  FILLER                       PIC X(01)   VALUE SPACES.   02543202
025433     05  FILLER                       PIC X(07)   VALUE           02543301
025434         'VEND PO'.                                               02543402
025435     05  FILLER                       PIC X(02)   VALUE SPACES.   02543502
025436     05  FILLER                       PIC X(03)   VALUE           02543602
025437         'SEQ'.                                                   02543702
025438     05  FILLER                       PIC X(02)   VALUE SPACES.   02543801
025439     05  FILLER                       PIC X(02)   VALUE           02543902
025440         'DC'.                                                    02544002
025441     05  FILLER                       PIC X(03)   VALUE SPACES.   02544102
025442     05  FILLER                       PIC X(11)   VALUE           02544201
025443         'SSCC NUMBER'.                                           02544302
025444     05  FILLER                       PIC X(10)   VALUE SPACES.   02544401
025445     05  FILLER                       PIC X(07)   VALUE           02544502
025446         'SKU NBR'.                                               02544602
025447     05  FILLER                       PIC X(02)   VALUE SPACES.   02544702
025448     05  FILLER                       PIC X(03)   VALUE           02544802
025449         'QTY'.                                                   02544902
025450     05  FILLER                       PIC X(03)   VALUE SPACES.   02545002
025451     05  FILLER                       PIC X(13)   VALUE           02545102
025452         'ERROR MESSAGE'.                                         02545202
025453     05  FILLER                       PIC X(52)   VALUE SPACES.   02545302
025469                                                                  02546901
025470 01  HL3-HEADING-LINE-3.                                          02547002
025471     05  FILLER                       PIC X(20)   VALUE           02547102
025472         '--------------------'.                                  02547202
025473     05  FILLER                       PIC X(1)    VALUE SPACES.   02547302
025474     05  FILLER                       PIC X(8)    VALUE           02547402
025475         '--------'.                                              02547502
025476     05  FILLER                       PIC X(01)   VALUE SPACES.   02547602
025477     05  FILLER                       PIC X(08)   VALUE           02547702
025478         '--------'.                                              02547802
025479     05  FILLER                       PIC X(01)   VALUE SPACES.   02547902
025480     05  FILLER                       PIC X(04)   VALUE           02548002
025481         '----'.                                                  02548102
025482     05  FILLER                       PIC X(01)   VALUE SPACES.   02548202
025483     05  FILLER                       PIC X(04)   VALUE           02548302
025484         '----'.                                                  02548402
025485     05  FILLER                       PIC X(01)   VALUE SPACES.   02548502
025486     05  FILLER                       PIC X(20)   VALUE           02548602
025487         '--------------------'.                                  02548702
025488     05  FILLER                       PIC X(1)    VALUE SPACES.   02548802
025489     05  FILLER                       PIC X(08)   VALUE           02548902
025490         '--------'.                                              02549002
025491     05  FILLER                       PIC X(01)   VALUE SPACES.   02549102
025492     05  FILLER                       PIC X(05)   VALUE           02549202
025493         '-----'.                                                 02549302
025494     05  FILLER                       PIC X(01)   VALUE SPACES.   02549402
025495     05  FILLER                       PIC X(30)   VALUE           02549502
025496         '------------------------------'.                        02549602
025497     05  FILLER                       PIC X(30)   VALUE           02549702
025498         '------------------------------'.                        02549802
025499     05  FILLER                       PIC X(05)   VALUE SPACES.   02549902
025500                                                                  02550002
025544 01  DL1-DETAIL-LINE-1.                                           02554402
025545     05  DT1-FILE-NAME                PIC X(20).                  02554502
025546     05  FILLER                       PIC X(01)   VALUE SPACE.    02554602
025547     05  DT1-KOHLS-PO                 PIC X(08).                  02554702
025548     05  FILLER                       PIC X(01)   VALUE SPACE.    02554802
025549     05  DT1-VENDOR-PO                PIC X(08).                  02554902
025550     05  FILLER                       PIC X(01)   VALUE SPACE.    02555002
025551     05  DT1-SEQ-NBR                  PIC X(04).                  02555102
025552     05  FILLER                       PIC X(01)   VALUE SPACE.    02555202
025553     05  DT1-DC-NBR                   PIC X(04).                  02555302
025554     05  FILLER                       PIC X(01)   VALUE SPACE.    02555402
025555     05  DT1-SSCC-NBR                 PIC X(20).                  02555502
025556     05  FILLER                       PIC X(01)   VALUE SPACE.    02555602
025557     05  DT1-SKU-NBR                  PIC X(08).                  02555702
025558     05  FILLER                       PIC X(01)   VALUE SPACE.    02555802
025559     05  DT1-QTY                      PIC X(05).                  02555902
025560     05  FILLER                       PIC X(01)   VALUE SPACE.    02556002
025561     05  DT1-ERROR-MESSAGE            PIC X(60).                  02556102
025562     05  FILLER                       PIC X(05)   VALUE SPACE.    02556202
025563                                                                  02556302
029000 01  MISCELLANEOUS-LINES.                                         02900000
029100     05  END-OF-REPORT-LINE.                                      02910000
029200         10  FILLER                  PIC  X(90)    VALUE SPACES.  02920000
029300         10  FILLER                  PIC  X(45)    VALUE          02930000
029400             '*******   E N D   O F   R E P O R T   *******'.     02940000
029500         10  FILLER                  PIC  X(65)    VALUE SPACES.  02950000
029600                                                                  02960000
029700     05  NO-ERROR-LINE.                                           02970000
029800         10  FILLER                  PIC  X(45)    VALUE          02980000
029900             '  NO ERRORS IN THIS RUN OF THE PROCESS       '.     02990000
030000         10  FILLER                  PIC  X(90)    VALUE SPACES.  03000000
030100         10  FILLER                  PIC  X(65)    VALUE SPACES.  03010000
030200                                                                  03020000
030300     05  EMPTY-FILE-LINE.                                         03030000
030400         10  FILLER                  PIC  X(45)    VALUE          03040000
030500             '  INPUT FILE EMPTY IN THIS RUN OF THE PROCESS'.     03050000
030600         10  FILLER                  PIC  X(90)    VALUE SPACES.  03060000
030700         10  FILLER                  PIC  X(65)    VALUE SPACES.  03070000
030800                                                                  03080000
030900******************************************************************03090000
031000*  COPYBOOKS.                                                     03100000
031100******************************************************************03110000
031200                                                                  03120000
031300*----------------------------------------------------------------*03130000
031400*    NUMERIC EDIT ROUTINE LAYOUT                                  03140000
031500*----------------------------------------------------------------*03150000
031600     COPY DPWS010I.                                               03160000
031700                                                                  03170000
031800*----------------------------------------------------------------*03180000
031900*    SKU SORT DATA INPUT FILE LAYOUT                              03190002
032000*----------------------------------------------------------------*03200000
032100     COPY RCRD108.                                                03210002
032200                                                                  03220000
032300*----------------------------------------------------------------*03230000
032400*    SKU SORT DATA OUPTPUT FILE LAYOUT                            03240002
032500*----------------------------------------------------------------*03250000
032600     COPY RCRD101.                                                03260000
032700                                                                  03270000
032800***************************************************************** 03280000
032900*  *** DB2 MESSAGE AREAS ****                                   * 03290000
033000***************************************************************** 03300000
033100     COPY DPWS004.                                                03310000
033200                                                                  03320000
033300*---------------------------------------------------------------* 03330000
033400*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 03340000
033500*---------------------------------------------------------------* 03350000
033600     EXEC SQL                                                     03360000
033700          INCLUDE TPURCHS                                         03370000
033800     END-EXEC.                                                    03380000
033900                                                                  03390000
036100*---------------------------------------------------------------* 03610000
036200*    DB2 AREA FOR TPURITM - PURCHASE ORDER ITEM TABLE           * 03620000
036300*---------------------------------------------------------------* 03630000
036400     EXEC SQL                                                     03640000
036500          INCLUDE TPURITM                                         03650000
036600     END-EXEC.                                                    03660000
036700                                                                  03670000
036800*---------------------------------------------------------------* 03680000
036900*    DB2 AREA FOR XLT_LOC - DC LOCATION TABLE                   * 03690000
037000*---------------------------------------------------------------* 03700000
037100     EXEC SQL                                                     03710000
037200          INCLUDE XLT00010                                        03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500*---------------------------------------------------------------* 03750000
037600*    DB2 AREA FOR XLT_UPC - LOGISTICS DOMAIN UPC TABLE          * 03760000
037700*---------------------------------------------------------------* 03770000
037800     EXEC SQL                                                     03780000
037900          INCLUDE XLT00006                                        03790000
038000     END-EXEC.                                                    03800000
038100                                                                  03810000
038200*---------------------------------------------------------------* 03820000
038300*    DB2 AREA FOR XLT_SKU - LOGISTICS DOMAIN SKU TABLE          * 03830000
038400*---------------------------------------------------------------* 03840000
038500     EXEC SQL                                                     03850000
038600          INCLUDE XLT00003                                        03860000
038700     END-EXEC.                                                    03870000
038701                                                                  03870106
038710*---------------------------------------------------------------* 03871006
038720*    DB2 AREA FOR XLT_VND_STYL - LOGISTICS DOMAIN STYLE TABLE   * 03872006
038730*---------------------------------------------------------------* 03873006
038740     EXEC SQL                                                     03874006
038750          INCLUDE XLT00004                                        03875006
038760     END-EXEC.                                                    03876006
038800                                                                  03880000
039600*---------------------------------------------------------------* 03960000
039700*    DB2 AREA FOR TSHPUNT - INBOUND CARTON HEADER TABLE         * 03970000
039800*---------------------------------------------------------------* 03980000
039900     EXEC SQL                                                     03990000
040000          INCLUDE TSHPUNT                                         04000000
040100     END-EXEC.                                                    04010000
040200                                                                  04020000
040300*---------------------------------------------------------------* 04030000
040400*    DB2 AREA FOR TSHUUPC - INBOUND CARTON UPC TABLE            * 04040000
040500*---------------------------------------------------------------* 04050000
040600     EXEC SQL                                                     04060000
040700          INCLUDE TSHUUPC                                         04070000
040800     END-EXEC.                                                    04080000
040900                                                                  04090000
042400*-----------------------------------------------------------------04240000
042500*    DB2 AREA FOR TKRPRPM - PARM TABLE                            04250002
042600*-----------------------------------------------------------------04260000
042700     EXEC SQL                                                     04270000
042800         INCLUDE TKRPRPM                                          04280002
042900     END-EXEC.                                                    04290000
043000                                                                  04300000
043100*---------------------------------------------------------------* 04310000
043200*    DB2 AREA FOR COMMUNICATIONS                                * 04320000
043300*---------------------------------------------------------------* 04330000
043400     EXEC SQL                                                     04340000
043500          INCLUDE SQLCA                                           04350000
043600     END-EXEC.                                                    04360000
043700                                                                  04370000
043800***************************************************************** 04380000
043900                                                                  04390000
044000 LINKAGE SECTION.                                                 04400000
044100                                                                  04410000
044200***************************************************************** 04420000
044300 PROCEDURE DIVISION.                                              04430000
044400***************************************************************** 04440000
044500                                                                  04450000
044600 0000-MAINLINE-PROCESSING.                                        04460000
044700                                                                  04470000
044800     DISPLAY ' '.                                                 04480027
044810     DISPLAY 'START OF PROGRAM RCKUT180'.                         04481027
044820     DISPLAY ' '.                                                 04482027
044900                                                                  04490000
045000     MOVE PC-PROGRESSIVE-READ-LIMIT TO PV-DISP-NBR.               04500000
045100     DISPLAY 'PROGRESSIVE READ DISPLAY TRIGGER IS:  '             04510000
045200             PV-DISP-NBR.                                         04520000
045300                                                                  04530000
045400     PERFORM 1000-INITIALIZATION.                                 04540000
045500                                                                  04550000
045600     PERFORM 2000-PROCESS-DATA-RECS                               04560002
045700       UNTIL END-OF-FILE.                                         04570000
045800                                                                  04580000
045900     IF  PV-READ-COUNT = 0                                        04590000
046000         DISPLAY '*** EMPTY INPUT FILE ***'                       04600000
046100     END-IF.                                                      04610000
046200                                                                  04620000
046300     PERFORM 8050-PRINT-END-OF-RPT-LINE.                          04630000
046400                                                                  04640000
046500     PERFORM 8500-SHOW-COUNTERS.                                  04650000
046600                                                                  04660000
046700     CLOSE SKU-SORT-DATA-FILE                                     04670002
046800           SKU-SORT-OUTPUT-FILE                                   04680002
046900           SKU-SORT-ERROR-FILE                                    04690002
047000           ERROR-REPORT-FILE.                                     04700000
047100                                                                  04710000
047200     IF  PS-REPORT-WRITE-YES                                      04720000
047300         MOVE 4050 TO RETURN-CODE                                 04730000
047400     END-IF.                                                      04740000
047500                                                                  04750000
047600     STOP RUN.                                                    04760000
047700                                                                  04770000
047800                                                                  04780000
047900******************************************************************04790000
048000*  OPEN FILES, READ THE FIRST INPUT RECORD AND PRINT THE REPORT  *04800000
048100*  HEADINGS.                                                     *04810000
048200******************************************************************04820000
048300 1000-INITIALIZATION.                                             04830000
048400                                                                  04840000
048500     OPEN INPUT  SKU-SORT-DATA-FILE.                              04850002
048600     OPEN OUTPUT SKU-SORT-OUTPUT-FILE                             04860007
048700                 SKU-SORT-ERROR-FILE                              04870002
048800                 ERROR-REPORT-FILE.                               04880000
048900                                                                  04890000
049000** GET CURRENT TIMESTAMP                                          04900000
049100                                                                  04910000
049200     EXEC SQL                                                     04920000
049300         SET :PV-CURRENT-TMST-DB2 = CURRENT TIMESTAMP             04930000
049400     END-EXEC.                                                    04940000
049500                                                                  04950000
049600     EVALUATE TRUE                                                04960000
049700         WHEN SQLCODE = ZERO                                      04970000
049800             MOVE PV-CURRENT-TMST-DB2    TO PV-CURRENT-TMST       04980000
049900                                                                  04990000
050000             MOVE PV-CURR-DATE-MM        TO DP150O-RUN-MONTH      05000007
050100             MOVE PV-CURR-DATE-DD        TO DP150O-RUN-DAY        05010007
050200             MOVE PV-CURR-DATE-YY        TO DP150O-RUN-YEAR       05020007
050300                                                                  05030000
050400             MOVE PV-CURR-TIME-HH        TO DP150O-RUN-HOUR       05040007
050500             MOVE PV-CURR-TIME-MM        TO DP150O-RUN-MINUTE     05050007
050600         WHEN OTHER                                               05060000
050700             MOVE '1000-INITIALIZATION'  TO PV-ABEND-PARAGRAPH    05070000
050800             MOVE 'SET CURRENT TIMESTAMP'                         05080000
050900                                         TO PV-ABEND-OPERATION    05090000
051000             PERFORM 9900-DB2-ABEND                               05100000
051100         END-EVALUATE.                                            05110000
051200                                                                  05120000
051300     MOVE PC-CURRENT-PROGRAM-NAME                                 05130000
051400                                 TO DP150O-PROGRAM-NAME.          05140007
051500                                                                  05150000
051600     PERFORM 8000-PRINT-HEADINGS                                  05160000
051700                                                                  05170000
051800     PERFORM 7000-READ-INPUT.                                     05180000
051900                                                                  05190000
052000                                                                  05200000
052100******************************************************************05210000
052200*  THIS IS THE CONTROL PARAGRAPH FOR THE PROCESSING OF THE DATA  *05220000
052300*  FROM THE INPUT FILE.  IT WILL DO SOME INTIAL DATA CHECKS AND  *05230000
052400*  THEN PERFORM OTHER PARAGRAPHS TO FURTHER EDIT THE DATA BEFORE *05240000
052500*  THE DATA IS EITHER WRITTEN TO THE FURTHER PROCESSING OUTPUT   *05250000
052600*  FILE OR THE ERROR FILE IF ERRORS ARE FOUND.                   *05260000
052700******************************************************************05270000
052800 2000-PROCESS-DATA-RECS.                                          05280002
052900                                                                  05290000
055400     PERFORM 3000-PROCESS-INPUT-RECORD.                           05540002
055500                                                                  05550002
057700     PERFORM 7000-READ-INPUT.                                     05770000
057800                                                                  05780000
057900******************************************************************05790000
058000*  THIS WILL CONTROL THE PROCESSING OF THE INDIVDIDUAL           *05800002
058100*  RECORDS FROM THE INPUT FILE.  THIS WILL CALL PARAGRAPHS TO    *05810000
058200*  EDIT THE DIFFERENT FIELDS ON THE RECORD AND THEN IF NO ERRORS *05820002
058300*  FOUND IT WILL WRITE OUT THE RCRD101 OUTPUT RECORD FOR FURTHER *05830002
058400*  PROCESSING.  ANY ERRORS WILL GENERATE A LINE TO THE ERROR     *05840002
058500*  REPORT AND THE RECORD WILL BE WRITTEN TO THE RCRD108 ERROR    *05850002
058510*  FILE AND WILL NOT BE PROCESSED ANY FURTHER.                   *05851002
058600******************************************************************05860000
058700 3000-PROCESS-INPUT-RECORD.                                       05870002
058800                                                                  05880000
058900     SET PS-ERROR-NO TO TRUE.                                     05890016
059000                                                                  05900016
060000     PERFORM 3200-CHECK-NUMERIC-FIELDS.                           06000002
060200                                                                  06020000
060300     IF  PS-ERROR-NO                                              06030000
060400         PERFORM 3300-VALIDATE-PO-NUMBER                          06040000
060500     END-IF.                                                      06050000
060600                                                                  06060000
060700     IF  PS-ERROR-NO                                              06070000
060800         PERFORM 3400-VALIDATE-SKU-NUMBER                         06080002
060900     END-IF.                                                      06090000
061000                                                                  06100000
061100     IF  PS-ERROR-NO                                              06110000
061101         MOVE RC108-CARTON-ID TO PV-SSCC-NBR-FINAL                06110105
061102         IF  PV-SSCC-NBR-FINAL-F2 = 00                            06110204
061200             PERFORM 3500-VALIDATE-SSCC-NUMBER                    06120004
061210         ELSE                                                     06121004
061230             SET PS-ERROR-YES TO TRUE                             06123004
061240             MOVE PV-READ-COUNT       TO PV-DISP-NBR              06124004
061260             DISPLAY 'INPUT RECORD ' PV-DISP-NBR                  06126004
061270                     ' SSCC CARTON ID NOT STARTING WITH 00'       06127004
061280             DISPLAY ' SKIPPING TO NEXT RECORD'                   06128004
061281             DISPLAY RC108-SKU-SRT-CARTON-REC                     06128105
061282             DISPLAY ' '                                          06128205
061283             DISPLAY '------------------------'                   06128305
061290             DISPLAY ' '                                          06129004
061291             MOVE SPACES TO PV-ERROR-MESSAGE                      06129104
061292             STRING 'SSCC CARTON NUMBER D' DELIMITED BY SIZE      06129204
061293                    'OES NOT START WITH 0' DELIMITED BY SIZE      06129304
061294                    '0 - INVALID SSCC NBR' DELIMITED BY SIZE      06129404
061295               INTO PV-ERROR-MESSAGE                              06129504
061296             SET PS-WRITE-ERROR-DATA-YES TO TRUE                  06129604
061297             SET PS-COMMENT-TYPE-ERROR TO TRUE                    06129704
061298             ADD +1 TO PV-ERR-SSCC-NOT-00-CNT                     06129805
061299             PERFORM 8300-INVALID-RECORD                          06129904
061300         END-IF                                                   06130004
061310     END-IF.                                                      06131000
061400                                                                  06140000
061500     IF  PS-ERROR-NO                                              06150000
061600         PERFORM 3600-VALIDATE-DC-NUMBER                          06160000
061700     END-IF.                                                      06170000
061800                                                                  06180000
061900     IF  PS-ERROR-NO                                              06190000
061910         IF  RC108-DC-NBR = PV-PREV-DC-NBR                        06191004
061920             MOVE KRPRPM-FUNC-TXT TO RC101-DELIVERY-SCAC          06192004
061930         ELSE                                                     06193004
062000             PERFORM 3700-GET-DELIVERY-SCAC                       06200004
062100             MOVE RC108-DC-NBR TO PV-PREV-DC-NBR                  06210004
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900     IF  PS-ERROR-NO                                              06290000
063000         PERFORM 3800-VALIDATE-UNIT-QUANTITY                      06300000
063100     END-IF.                                                      06310000
063200                                                                  06320000
063300     SET  RC101-FILE-SOURCE-SKU-SORT TO TRUE.                     06330004
063301     MOVE RC108-FILE-NAME TO RC101-FILE-NAME.                     06330104
063302     MOVE 'KSS' TO RC101-MDSE-SOURCE.                             06330204
063303     MOVE 0 TO RC101-SENT-ORD-NBR.                                06330312
063320                                                                  06332000
063330     IF  PS-ERROR-NO                                              06333000
063340         WRITE SKU-SORT-OUTPUT-RECORD                             06334004
063350          FROM RC101-SHIPPED-MDSE-REC                             06335000
063360         ADD +1 TO PV-GOOD-WRITE-COUNT                            06336000
063370     END-IF.                                                      06337000
063380                                                                  06338000
063390                                                                  06339000
066100******************************************************************06610000
066200*  THIS PARAGRAPH WILL TAKE THE INDIVIDUAL FIELDS THAT SHOULD    *06620000
066300*  CONTAIN ONLY NUMERIC DATA AND PERFORM A CHECK TO CONFIRM THAT *06630000
066400*  THEY CONTAIN ONLY NUMERIC VALUES.  ANYTHING OTHER THAN A      *06640000
066500*  NUMBER VALUE IN THE CHECKED FIELDS WILL INDICATE AN ERROR AND *06650000
066600*  DATA WILL BE WRITTEN TO THE ERROR REPORT AND REJECTED FROM    *06660000
066700*  FURTHER PROCESSING.                                           *06670000
066800******************************************************************06680000
066900 3200-CHECK-NUMERIC-FIELDS.                                       06690000
067000                                                                  06700000
067100     SET PS-NUMERIC-ERROR-NO TO TRUE.                             06710000
067200                                                                  06720000
067300* NUMERIC CHECK THE PO NUMBER                                     06730000
067400     MOVE RC108-KOHLS-ORD-NBR TO DP010I-UNEDITED-FIELD.           06740002
067500     MOVE 8                   TO DP010I-MAXIMUM-DIGITS.           06750002
067600     MOVE 0                   TO DP010I-MAXIMUM-DECIMALS.         06760002
067700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06770000
067800     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06780018
067810          USING DP010I-NUMERIC-EDIT-AREA.                         06781018
067900     IF  DP010I-ERROR-DETECTED                                    06790000
068000         SET PS-NUMERIC-ERROR-YES TO TRUE                         06800000
068010         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  06801005
068020         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      06802005
068030                 ' FOUND NON-NUMERIC DATA IN RECORD'              06803005
068200         DISPLAY 'PO NUMBER NUMERIC CHECK: ' RC108-KOHLS-ORD-NBR  06820002
068300         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        06830000
068310         DISPLAY RC108-SKU-SRT-CARTON-REC                         06831005
068311         DISPLAY ' '                                              06831105
068320         DISPLAY '------------------------'                       06832005
068400         DISPLAY ' '                                              06840000
068500     ELSE                                                         06850000
068600         MOVE RC108-KOHLS-ORD-NBR  TO RC101-KOHLS-ORD-NBR         06860002
068700     END-IF.                                                      06870000
068800                                                                  06880000
068900* NUMERIC CHECK THE DC NUMBER                                     06890000
069000     MOVE RC108-DC-NBR       TO DP010I-UNEDITED-FIELD.            06900002
069100     MOVE 4                  TO DP010I-MAXIMUM-DIGITS.            06910000
069200     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          06920000
069300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     06930000
069400     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06940018
069410          USING DP010I-NUMERIC-EDIT-AREA.                         06941018
069500     IF  DP010I-ERROR-DETECTED                                    06950000
069600         SET PS-NUMERIC-ERROR-YES TO TRUE                         06960000
069601         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  06960105
069610         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      06961005
069620                 ' FOUND NON-NUMERIC DATA IN RECORD'              06962005
069631         DISPLAY 'DC NUMBER NUMERIC CHECK: ' RC108-DC-NBR         06963105
069640         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        06964005
069650         DISPLAY RC108-SKU-SRT-CARTON-REC                         06965005
069660         DISPLAY ' '                                              06966005
069670         DISPLAY '------------------------'                       06967005
069680         DISPLAY ' '                                              06968005
070100     ELSE                                                         07010000
070200         MOVE RC108-DC-NBR         TO RC101-DC-NBR                07020002
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500* NUMERIC CHECK THE FIRST 10 DIGITS OF THE SSCC NUMBER            07050000
070510     MOVE RC108-CARTON-ID    TO PV-SPLIT-SSCC-NBR.                07051002
070511     SET PS-SSCC-F10-NOT-NUMERIC TO TRUE.                         07051100
070512                                                                  07051200
070513     MOVE PV-SPLIT-SSCC-NBR-F10 TO DP010I-UNEDITED-FIELD.         07051300
070514     MOVE 10                 TO DP010I-MAXIMUM-DIGITS.            07051400
070515     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          07051500
070516     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07051600
070517     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07051718
070518          USING DP010I-NUMERIC-EDIT-AREA.                         07051818
070520     IF  DP010I-ERROR-DETECTED                                    07052000
070521         SET PS-NUMERIC-ERROR-YES TO TRUE                         07052100
070522         SET PS-SSCC-F10-NOT-NUMERIC TO TRUE                      07052200
070523         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07052305
070524         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07052405
070525                 ' FOUND NON-NUMERIC DATA IN RECORD'              07052505
070526         DISPLAY 'SSCC FIRST 10 DIGIT NUMERIC CHECK: '            07052605
070527                 PV-SPLIT-SSCC-NBR-F10                            07052705
070528         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07052805
070529         DISPLAY RC108-SKU-SRT-CARTON-REC                         07052905
070530         DISPLAY ' '                                              07053005
070531         DISPLAY '------------------------'                       07053105
070532         DISPLAY ' '                                              07053205
070580     ELSE                                                         07058000
070590         SET PS-SSCC-F10-NUMERIC TO TRUE                          07059000
070600     END-IF.                                                      07060000
070700                                                                  07070000
070800* NUMERIC CHECK THE SECOND 10 DIGITS OF THE SSCC NUMBER           07080000
070900     MOVE RC108-CARTON-ID    TO PV-SPLIT-SSCC-NBR.                07090002
071000     SET PS-SSCC-L10-NOT-NUMERIC TO TRUE.                         07100000
071100                                                                  07110000
071200     MOVE PV-SPLIT-SSCC-NBR-L10 TO DP010I-UNEDITED-FIELD.         07120000
071300     MOVE 10                 TO DP010I-MAXIMUM-DIGITS.            07130000
071400     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          07140000
071500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07150000
071610     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07161017
071620          USING DP010I-NUMERIC-EDIT-AREA.                         07162017
071700     IF  DP010I-ERROR-DETECTED                                    07170000
071800         SET PS-NUMERIC-ERROR-YES TO TRUE                         07180000
071900         SET PS-SSCC-L10-NOT-NUMERIC TO TRUE                      07190000
071910         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07191005
071920         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07192005
071930                 ' FOUND NON-NUMERIC DATA IN RECORD'              07193005
071931         DISPLAY 'SSCC SECOND 10 DIGIT NUMERIC CHECK: '           07193105
071932                 PV-SPLIT-SSCC-NBR-L10                            07193205
071960         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07196005
071970         DISPLAY RC108-SKU-SRT-CARTON-REC                         07197005
071980         DISPLAY ' '                                              07198005
071990         DISPLAY '------------------------'                       07199005
071991         DISPLAY ' '                                              07199105
072050     ELSE                                                         07205000
072060         SET PS-SSCC-L10-NUMERIC TO TRUE                          07206000
072070         IF  PS-SSCC-F10-NUMERIC                                  07207000
072071             MOVE RC108-CARTON-ID TO PV-SSCC-NBR-FINAL            07207107
072090             MOVE PV-SSCC-NBR-FINAL-L18                           07209000
072100                               TO RC101-SENT-SSCC-NBR             07210000
072101         ELSE                                                     07210100
072102             MOVE ZEROS        TO RC101-SENT-SSCC-NBR             07210200
072103         END-IF                                                   07210300
072104     END-IF.                                                      07210400
072105                                                                  07210500
072106* NUMERIC CHECK THE SKU NUMBER                                    07210602
072107     MOVE RC108-SKU-NBR      TO DP010I-UNEDITED-FIELD.            07210702
072108     MOVE 8                  TO DP010I-MAXIMUM-DIGITS.            07210802
072109     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          07210900
072110     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07211000
072121     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07212117
072122          USING DP010I-NUMERIC-EDIT-AREA.                         07212217
072130     IF  DP010I-ERROR-DETECTED                                    07213000
072140         SET PS-NUMERIC-ERROR-YES TO TRUE                         07214000
072141         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07214105
072142         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07214205
072143                 ' FOUND NON-NUMERIC DATA IN RECORD'              07214305
072144         DISPLAY 'SKU NUMBER NUMERIC CHECK: ' RC108-SKU-NBR       07214405
072147         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07214705
072148         DISPLAY RC108-SKU-SRT-CARTON-REC                         07214805
072149         DISPLAY ' '                                              07214905
072150         DISPLAY '------------------------'                       07215005
072151         DISPLAY ' '                                              07215105
072190     ELSE                                                         07219000
072200         MOVE RC108-SKU-NBR                 TO RC101-SKU-NBR      07220007
072400     END-IF.                                                      07240000
072500                                                                  07250000
072600* NUMERIC CHECK THE SHIPPED QUANTITY                              07260000
072700     MOVE RC108-SHIP-QTY     TO DP010I-UNEDITED-FIELD.            07270002
072800     MOVE 5                  TO DP010I-MAXIMUM-DIGITS.            07280000
072900     MOVE 0                  TO DP010I-MAXIMUM-DECIMALS.          07290000
073000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07300000
073110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07311017
073120          USING DP010I-NUMERIC-EDIT-AREA.                         07312017
073200     IF  DP010I-ERROR-DETECTED                                    07320000
073300         SET PS-NUMERIC-ERROR-YES TO TRUE                         07330000
073310         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07331005
073320         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07332005
073330                 ' FOUND NON-NUMERIC DATA IN RECORD'              07333005
073340         DISPLAY 'SHIP QTY NUMERIC CHECK: ' RC108-SHIP-QTY        07334005
073350         DISPLAY '** DP010I-ERROR-IND = ' DP010I-ERROR-IND        07335005
073360         DISPLAY RC108-SKU-SRT-CARTON-REC                         07336005
073370         DISPLAY ' '                                              07337005
073380         DISPLAY '------------------------'                       07338005
073390         DISPLAY ' '                                              07339005
073800     ELSE                                                         07380000
073900         MOVE RC108-SHIP-QTY       TO RC101-SHIP-QTY              07390002
074000     END-IF.                                                      07400000
074100                                                                  07410000
074200     IF  PS-NUMERIC-ERROR-YES                                     07420000
074300         SET PS-ERROR-YES TO TRUE                                 07430000
074400         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07440000
074500         MOVE SPACES TO PV-ERROR-MESSAGE                          07450002
074600         STRING 'DATA WITHIN INDIVIDU' DELIMITED BY SIZE          07460002
074700                'AL FIELDS OF THIS RE' DELIMITED BY SIZE          07470002
074800                'CORD ARE NOT NUMERIC' DELIMITED BY SIZE          07480002
075000           INTO PV-ERROR-MESSAGE                                  07500002
075100         SET PS-WRITE-ERROR-DATA-YES TO TRUE                      07510002
075200         SET PS-COMMENT-TYPE-ERROR TO TRUE                        07520000
075300         ADD +1 TO PV-ERR-NON-NUMERIC-CNT                         07530000
075400         PERFORM 8300-INVALID-RECORD                              07540000
075500     END-IF.                                                      07550000
075600                                                                  07560000
075700                                                                  07570000
075800******************************************************************07580000
075900* THIS PARAGRAPH WILL TAKE THE PO NUMBER AND CHECK TO MAKE SURE  *07590002
076000* THAT THE PO IS FOUND ON THE PO HEADER TABLE (TPURCHS).         *07600002
076992******************************************************************07699200
076993 3300-VALIDATE-PO-NUMBER.                                         07699300
076994                                                                  07699400
076995     IF  RC108-KOHLS-ORD-NBR = PV-PREV-KOHLS-ORD-NBR              07699502
076996         NEXT SENTENCE                                            07699611
076997     ELSE                                                         07699700
077000         SET PS-PO-NOT-FOUND TO TRUE                              07700000
077010         MOVE RC108-KOHLS-ORD-NBR TO DK-PO-NUMBER                 07701007
077100         PERFORM 3310-FIND-PO-NUMBER                              07710000
077200         MOVE RC108-KOHLS-ORD-NBR TO PV-PREV-KOHLS-ORD-NBR        07720002
077300     END-IF.                                                      07730000
077400                                                                  07740000
077500     IF  PS-PO-FOUND                                              07750002
077600         MOVE RC108-KOHLS-ORD-NBR TO RC101-KOHLS-ORD-NBR          07760002
077800     ELSE                                                         07780000
078000         SET PS-PREV-PO-NOT-FOUND TO TRUE                         07800002
078100         SET PS-ERROR-YES TO TRUE                                 07810002
078200         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  07820002
078400         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      07840002
078500                 ' COULD NOT FIND KOHLS PO NUMBER'                07850002
078600         DISPLAY ' SKIPPING TO NEXT RECORD'                       07860002
078610         DISPLAY RC108-SKU-SRT-CARTON-REC                         07861005
078700         DISPLAY ' '                                              07870002
078701         DISPLAY '------------------------'                       07870105
078702         DISPLAY ' '                                              07870205
078800         MOVE SPACES TO PV-ERROR-MESSAGE                          07880004
078900         STRING 'COULD NOT FIND THE K' DELIMITED BY SIZE          07890002
079000                'OHLS PO NUMBER ON THE ' DELIMITED BY SIZE        07900002
079100                'PO MASTER TABLE       ' DELIMITED BY SIZE        07910002
079300           INTO PV-ERROR-MESSAGE                                  07930002
079400         SET PS-WRITE-ERROR-DATA-YES TO TRUE                      07940002
079500         SET PS-COMMENT-TYPE-ERROR TO TRUE                        07950002
079510         ADD +1 TO PV-ERR-PO-NOT-FOUND-CNT                        07951002
079520         PERFORM 8300-INVALID-RECORD                              07952002
079521     END-IF.                                                      07952102
092400                                                                  09240000
092520                                                                  09252007
092530******************************************************************09253007
092540* THIS PARAGRAPH WILL DO A SELECT TO THE TPURCHS TABLE TO ENSURE *09254007
092550* THE PO NUMBER ON THE INPUT RECORD IS A VALID PO NUMBER.        *09255007
092595******************************************************************09259507
092596 3310-FIND-PO-NUMBER.                                             09259607
092597                                                                  09259707
092600     EXEC SQL                                                     09260007
092601          SELECT A.PO_NBR                                         09260107
092602               , A.PKGNG_CDE                                      09260225
092606            INTO :PURCHS-PO-NBR                                   09260607
092607               , :PURCHS-PKGNG-CDE                                09260725
092613            FROM TPURCHS A                                        09261310
092617          WHERE A.PO_NBR            = :DK-PO-NUMBER               09261707
092618            AND A.VER_STATUS_CDE    = 'A'                         09261807
092620          WITH UR                                                 09262025
092621     END-EXEC                                                     09262125
092622                                                                  09262225
092623     EVALUATE TRUE                                                09262325
092624         WHEN SQLCODE  = +0                                       09262425
092625         WHEN SQLCODE  = -811                                     09262525
092626             SET PS-PO-FOUND TO TRUE                              09262625
092627         WHEN SQLCODE  = +100                                     09262725
092628             SET PS-PO-NOT-FOUND TO TRUE                          09262825
092630         WHEN OTHER                                               09263007
092631             DISPLAY '3310-FIND-PO-NUMBER DB2 ERROR'              09263107
092632             DISPLAY 'PO NUMBER IS: ' RC108-KOHLS-ORD-NBR         09263207
092633             DISPLAY 'INPUT RECORD IS: '                          09263307
092634             DISPLAY RC108-SKU-SRT-CARTON-REC                     09263407
092635             DISPLAY '-----------------------'                    09263507
092636             MOVE '3310-FIND-PO-NUMBER' TO PV-ABEND-PARAGRAPH     09263607
092637             MOVE 'SELECT FROM TPURCHS'                           09263707
092638                                            TO PV-ABEND-OPERATION 09263807
092639             PERFORM 9900-DB2-ABEND                               09263907
092640     END-EVALUATE.                                                09264007
092641                                                                  09264107
092642                                                                  09264207
092650******************************************************************09265000
092700* THIS PARAGRAPH WILL BE USED TO VALIDATE THE SKU NUMBER PASSED  *09270002
092800* IN THE INPUT FILE IS A VALID SKU AND THAT THE SKU IS ON THE    *09280002
092900* KOHLS PO NUMBER ON THE INPUT FILE.                             *09290002
093000* IF THE SKU IS VALID, THEN THE PROGRAM WILL GET A VENDOR UPC    *09300002
093010* NUMBER TO PUT ON THE RCRD101 OUTPUT RECORD.                    *09301002
093100******************************************************************09310000
093200 3400-VALIDATE-SKU-NUMBER.                                        09320002
093300                                                                  09330000
093400     MOVE RC108-SKU-NBR TO DK-SKU-NUMBER.                         09340002
093500     SET PS-SKU-NOT-FOUND TO TRUE.                                09350002
093510                                                                  09351000
093511     PERFORM 3410-FIND-SKU-NBR.                                   09351102
093512                                                                  09351200
093513     IF  PS-SKU-NOT-FOUND                                         09351302
093514         SET PS-ERROR-YES TO TRUE                                 09351400
093515         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  09351505
093516         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      09351605
093517                 ' COULD NOT FIND SKU NUMBER ' RC108-SKU-NBR      09351705
093518                 'ON SKU MASTER '                                 09351805
093519         DISPLAY ' SKIPPING TO NEXT RECORD'                       09351905
093520         DISPLAY RC108-SKU-SRT-CARTON-REC                         09352005
093521         DISPLAY ' '                                              09352105
093522         DISPLAY '------------------------'                       09352205
093523         DISPLAY ' '                                              09352305
093530         MOVE SPACES TO PV-ERROR-MESSAGE                          09353002
093531         STRING 'COULD NOT FIND SKU N' DELIMITED BY SIZE          09353102
093532                'UMBER FROM INPUT FIL' DELIMITED BY SIZE          09353202
093533                'E ON SKU MASTER     ' DELIMITED BY SIZE          09353302
093534           INTO PV-ERROR-MESSAGE                                  09353402
093535         SET PS-WRITE-ERROR-DATA-YES TO TRUE                      09353502
093536         SET PS-COMMENT-TYPE-ERROR TO TRUE                        09353600
093537         ADD +1 TO PV-ERR-SKU-NOT-FOUND-CNT                       09353705
093538         PERFORM 8300-INVALID-RECORD                              09353800
093539     ELSE                                                         09353900
093540         SET PS-PO-LINE-NOT-FOUND TO TRUE                         09354000
093541         MOVE RC108-KOHLS-ORD-NBR TO DK-PO-NUMBER                 09354103
093542         MOVE RC108-SKU-NBR       TO DK-SKU-NUMBER                09354203
093543                                                                  09354325
093544         IF  PURCHS-PKGNG-CDE = 'M'                               09354425
093545             PERFORM 3425-FIND-PO-LINE-NBR-PREPK                  09354525
093546         ELSE                                                     09354625
093547             PERFORM 3420-FIND-PO-LINE-NBR                        09354725
093548         END-IF                                                   09354825
093549                                                                  09354925
093550         IF  PS-PO-LINE-NOT-FOUND                                 09355025
093551             SET PS-ERROR-YES TO TRUE                             09355125
093552             MOVE PV-READ-COUNT       TO PV-DISP-NBR              09355225
093553             DISPLAY 'INPUT RECORD ' PV-DISP-NBR                  09355325
093554                     ' COULD NOT SKU ON KOHLS PO'                 09355425
093555             DISPLAY ' SKIPPING TO NEXT RECORD'                   09355525
093556             DISPLAY 'KOHLS PO NUMBER IS:  ' RC108-KOHLS-ORD-NBR  09355625
093557             DISPLAY 'SKU NUMBER IS:  ' RC108-SKU-NBR             09355725
093558             DISPLAY RC108-SKU-SRT-CARTON-REC                     09355825
093559             DISPLAY ' '                                          09355925
093560             DISPLAY '------------------------'                   09356025
093561             DISPLAY ' '                                          09356125
093567             MOVE SPACES TO PV-ERROR-MESSAGE                      09356703
093568             STRING 'COULD NOT FIND THE S' DELIMITED BY SIZE      09356803
093569                    'KU ON THE KOHLS PO  ' DELIMITED BY SIZE      09356903
093570               INTO PV-ERROR-MESSAGE                              09357003
093571             SET PS-WRITE-ERROR-DATA-YES TO TRUE                  09357102
093572             SET PS-COMMENT-TYPE-ERROR TO TRUE                    09357200
093573             ADD +1 TO PV-ERR-SKU-NOT-ON-PO-CNT                   09357300
093574             PERFORM 8300-INVALID-RECORD                          09357400
093575         END-IF                                                   09357500
093576     END-IF.                                                      09357600
093577                                                                  09357700
093578                                                                  09357800
093579******************************************************************09357900
093580* THIS PARAGRAPH WILL BE USED TO CHECK IF THE SKU NUMBER IS ON   *09358003
093581* THE SKU MASTER TABLE AND WILL PULL BACK A UPC NUMBER FOR THE   *09358103
093582* SKU AS WELL AS THE DEPARTMENT.                                 *09358203
093583******************************************************************09358303
093584 3410-FIND-SKU-NBR.                                               09358403
093585                                                                  09358503
093586     EXEC SQL                                                     09358603
093587          SELECT A.SKU_NBR                                        09358703
093588               , B.UPC_NBR                                        09358803
093589               , B.UPC_TYP_CDE                                    09358903
093590               , C.DEPT_NBR                                       09359003
093591            INTO :XLT00003-SKU-NBR                                09359103
093592               , :XLT00006-UPC-NBR                                09359203
093593               , :XLT00006-UPC-TYP-CDE                            09359303
093594               , :XLT00004-DEPT-NBR                               09359403
093595            FROM XLT_SKU A                                        09359503
093596               , XLT_UPC B                                        09359603
093597               , XLT_VND_STYL C                                   09359703
093598          WHERE A.SKU_NBR     = :DK-SKU-NUMBER                    09359803
093599            AND B.INTR_UPC_ID = A.INTR_UPC_ID                     09359903
093600            AND C.STYL_ID     = A.STYL_ID                         09360003
093601          ORDER BY B.UPC_TYP_CDE DESC                             09360103
093602          FETCH FIRST ROW ONLY                                    09360213
093603          WITH UR                                                 09360303
093604     END-EXEC                                                     09360403
093605                                                                  09360503
093606     EVALUATE TRUE                                                09360603
093607         WHEN SQLCODE  = +0                                       09360703
093608         WHEN SQLCODE  = -811                                     09360803
093609             SET PS-SKU-FOUND TO TRUE                             09360903
093610             MOVE XLT00003-SKU-NBR TO RC101-SKU-NBR               09361003
093611             MOVE XLT00004-DEPT-NBR TO RC101-DEPT-NBR             09361103
093612             MOVE XLT00006-UPC-NBR TO RC101-UPC-NBR               09361203
093620         WHEN SQLCODE  = +100                                     09362000
093700             SET PS-SKU-NOT-FOUND TO TRUE                         09370003
093800         WHEN OTHER                                               09380000
093801             DISPLAY '3410-FIND-SKU-NBR DB2 ERROR'                09380102
093802             DISPLAY 'INPUT RECORD IS: '                          09380200
093803             DISPLAY RC108-SKU-SRT-CARTON-REC                     09380303
093805             DISPLAY 'SKU NUMBER IS:  ' RC108-SKU-NBR             09380503
093806             MOVE '3410-FIND-SKU-NBR' TO PV-ABEND-PARAGRAPH       09380602
093807             MOVE 'VALIDATE SKU NUMBER' TO PV-ABEND-OPERATION     09380703
093809             PERFORM 9900-DB2-ABEND                               09380900
093810     END-EVALUATE.                                                09381000
093820                                                                  09382000
093830                                                                  09383000
093840******************************************************************09384000
093850* THIS PARAGRAPH WILL BE USED TO TAKE THE KOHLS PO NUMBER        *09385000
093860* RETRIEVED EARLIER AND THE SKU NUMBER RETRIEVED EARLIER         *09386000
093870* AND FIND THE PO LINE NUMBER THAT THE SKU IS ON.                *09387000
093880******************************************************************09388000
093890 3420-FIND-PO-LINE-NBR.                                           09389000
093900                                                                  09390000
094000     EXEC SQL                                                     09400000
094100          SELECT PO_NBR                                           09410000
094200               , PO_LNE_NBR                                       09420000
094300               , RMS_PO_SKU_NBR                                   09430000
094400            INTO :PURITM-PO-NBR                                   09440000
094500               , :PURITM-PO-LNE-NBR                               09450000
094600               , :PURITM-RMS-PO-SKU-NBR                           09460000
094700            FROM TPURITM                                          09470000
094800          WHERE PO_NBR         = :DK-PO-NUMBER                    09480000
094900            AND RMS_PO_SKU_NBR = :DK-SKU-NUMBER                   09490000
095000            AND VER_STATUS_CDE = 'A'                              09500000
095010            AND PO_PREPK_ID    = 0                                09501026
095100          WITH UR                                                 09510000
095200     END-EXEC                                                     09520000
095300                                                                  09530000
095400     EVALUATE TRUE                                                09540000
095500         WHEN SQLCODE  = +0                                       09550000
095600             SET PS-PO-LINE-FOUND TO TRUE                         09560000
095700             MOVE PURITM-PO-LNE-NBR TO RC101-ORD-LNE-NBR          09570000
095800         WHEN SQLCODE  = +100                                     09580000
095900             SET PS-PO-LINE-NOT-FOUND TO TRUE                     09590000
096000         WHEN OTHER                                               09600000
096100             DISPLAY '3420-FIND-PO-LINE-NBR DB2 ERROR'            09610000
096200             DISPLAY 'INPUT RECORD IS: '                          09620000
096300             DISPLAY RC108-SKU-SRT-CARTON-REC                     09630003
096500             DISPLAY 'KOHLS PO NUMBER IS:  ' RC108-KOHLS-ORD-NBR  09650003
096520             DISPLAY 'SKU NUMBER IS:  ' RC108-SKU-NBR             09652003
096530             MOVE '3420-FIND-PO-LINE-NBR' TO PV-ABEND-PARAGRAPH   09653000
096550             MOVE 'GET PO LINE NUMBER'      TO PV-ABEND-OPERATION 09655003
096551             PERFORM 9900-DB2-ABEND                               09655100
096552     END-EVALUATE.                                                09655200
096553                                                                  09655300
096554                                                                  09655400
096556******************************************************************09655625
096557* THIS PARAGRAPH WILL BE USED TO TAKE THE KOHLS PO NUMBER        *09655725
096558* RETRIEVED EARLIER AND THE SKU NUMBER RETRIEVED EARLIER         *09655825
096559* AND FIND THE PO LINE NUMBER THAT THE SKU IS ON.                *09655925
096560* THIS PARAGRAPH IS ONLY USED IF THE PO IS CODED AS A PREPK      *09656025
096561******************************************************************09656125
096562 3425-FIND-PO-LINE-NBR-PREPK.                                     09656225
096563                                                                  09656325
096564     EXEC SQL                                                     09656425
096565          SELECT PO_NBR                                           09656525
096566               , PO_LNE_NBR                                       09656625
096567               , RMS_PO_SKU_NBR                                   09656725
096568               , LAST_UPD_TMST                                    09656825
096569            INTO :PURITM-PO-NBR                                   09656925
096570               , :PURITM-PO-LNE-NBR                               09657025
096571               , :PURITM-RMS-PO-SKU-NBR                           09657125
096572               , :PURITM-LAST-UPD-TMST                            09657225
096573            FROM TPURITM                                          09657325
096574          WHERE PO_NBR         = :DK-PO-NUMBER                    09657425
096575            AND RMS_PO_SKU_NBR = :DK-SKU-NUMBER                   09657525
096576            AND VER_STATUS_CDE = 'A'                              09657625
096577            AND PO_PREPK_ID    > 0                                09657726
096578          ORDER BY LAST_UPD_TMST DESC                             09657825
096579          FETCH FIRST 1 ROW ONLY                                  09657925
096580          WITH UR                                                 09658025
096581     END-EXEC                                                     09658125
096582                                                                  09658225
096583     EVALUATE TRUE                                                09658325
096584         WHEN SQLCODE  = +0                                       09658425
096585             SET PS-PO-LINE-FOUND TO TRUE                         09658525
096586             MOVE PURITM-PO-LNE-NBR TO RC101-ORD-LNE-NBR          09658625
096587         WHEN SQLCODE  = +100                                     09658725
096588             SET PS-PO-LINE-NOT-FOUND TO TRUE                     09658825
096589         WHEN OTHER                                               09658925
096590             DISPLAY '3425-FIND-PO-LINE-NBR DB2 ERROR'            09659031
096591             DISPLAY 'INPUT RECORD IS: '                          09659125
096592             DISPLAY RC108-SKU-SRT-CARTON-REC                     09659225
096593             DISPLAY 'KOHLS PO NUMBER IS:  ' RC108-KOHLS-ORD-NBR  09659325
096594             DISPLAY 'SKU NUMBER IS:  ' RC108-SKU-NBR             09659425
096595             MOVE '3425-FIND-PO-LINE-NBR' TO PV-ABEND-PARAGRAPH   09659531
096596             MOVE 'GET PO LINE NUMBER'      TO PV-ABEND-OPERATION 09659625
096597             PERFORM 9900-DB2-ABEND                               09659725
096598     END-EVALUATE.                                                09659825
096599                                                                  09659925
096600                                                                  09660025
096601                                                                  09660125
096602                                                                  09660225
096603******************************************************************09660325
096604*  THIS PARAGRAPH WILL MANAGE THE CHECKING OF THE SSCC NUMBER    *09660425
096605*  FROM THE INPUT FILE.  BASICALLY, WE WILL BE DOING A CHECK TO  *09660525
096606*  SEE IF THAT NUMBER IS ALREADY IN USE ON THE INBOUND CARTON    *09660625
096607*  TABLES.                                                       *09660725
096608******************************************************************09660825
096609 3500-VALIDATE-SSCC-NUMBER.                                       09660925
096610                                                                  09661025
096611     MOVE RC101-SENT-SSCC-NBR TO DK-SSCC-NUMBER.                  09661125
096612     SET PS-SSCC-NOT-FOUND TO TRUE.                               09661225
096613                                                                  09661325
096614     PERFORM 3510-FIND-SSCC-NBR.                                  09661425
096615                                                                  09661525
096616     IF  PS-SSCC-FOUND                                            09661625
096617         SET PS-ERROR-YES TO TRUE                                 09661725
096618         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  09661825
096619         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      09661925
096620                 ' SSCC NUMBER ALREADY EXISTS'                    09662025
096621         DISPLAY ' SKIPPING TO NEXT RECORD'                       09662125
096622         DISPLAY RC108-SKU-SRT-CARTON-REC                         09662225
096623         DISPLAY ' '                                              09662325
096624         DISPLAY '------------------------'                       09662425
096625         DISPLAY ' '                                              09662525
096626         MOVE SHUUPC-TRN-NBR TO PV-DISP-NBR-8                     09662625
096627         MOVE SPACES TO PV-ERROR-MESSAGE                          09662725
096628         IF  PV-DISP-NBR-8 = RC108-KOHLS-ORD-NBR                  09662825
096629             STRING 'SSCC IS IN INBOUND C' DELIMITED BY SIZE      09662925
096630                    'ARTON TABLE WITH SAM' DELIMITED BY SIZE      09663025
096631                    'E PO NBR: '           DELIMITED BY SIZE      09663125
096632                    RC108-KOHLS-ORD-NBR    DELIMITED BY SIZE      09663225
096633               INTO PV-ERROR-MESSAGE                              09663325
096634             SET PS-WRITE-ERROR-DATA-YES TO TRUE                  09663425
096635             SET PS-COMMENT-TYPE-ERROR TO TRUE                    09663525
096636             ADD +1 TO PV-ERR-SSCC-SAME-PO-CNT                    09663625
096637             PERFORM 8300-INVALID-RECORD                          09663725
096638         ELSE                                                     09663825
096639             STRING 'SSCC IS IN INBOUND C' DELIMITED BY SIZE      09663925
096640                    'ARTON TABLE WITH DIF' DELIMITED BY SIZE      09664025
096641                    'F PO NBR: '           DELIMITED BY SIZE      09664125
096642                    PV-DISP-NBR-8          DELIMITED BY SIZE      09664225
096643               INTO PV-ERROR-MESSAGE                              09664325
096644             SET PS-WRITE-ERROR-DATA-YES TO TRUE                  09664425
096645             SET PS-COMMENT-TYPE-ERROR TO TRUE                    09664525
096646             ADD +1 TO PV-ERR-SSCC-DIFF-PO-CNT                    09664625
096647             PERFORM 8300-INVALID-RECORD                          09664725
096648         END-IF                                                   09664825
096649     ELSE                                                         09664925
096650         IF  PS-DEFAULT-CARTON-YES                                09665025
096651             PERFORM 3520-DELETE-SHPUNT                           09665130
096653             PERFORM 3530-COMMIT                                  09665330
096654         ELSE                                                     09665429
096655           IF  PS-SSCC-FOUND-MULT-PO                              09665529
096656               SET PS-ERROR-YES TO TRUE                           09665629
096657               MOVE PV-READ-COUNT       TO PV-DISP-NBR            09665729
096658               DISPLAY 'INPUT RECORD ' PV-DISP-NBR                09665829
096659                       ' SSCC NUMBER ALREADY EXISTS WITH MULTIPLE'09665929
096660                       ' ORDER NUMBERS IN THE CARTON'             09666029
096661               DISPLAY ' SKIPPING TO NEXT RECORD'                 09666129
096662               DISPLAY RC108-SKU-SRT-CARTON-REC                   09666229
096663               DISPLAY ' '                                        09666329
096664               DISPLAY '------------------------'                 09666429
096665               DISPLAY ' '                                        09666529
096666               MOVE SPACES TO PV-ERROR-MESSAGE                    09666629
096667               STRING 'SSCC IS IN INBOUND C' DELIMITED BY SIZE    09666729
096668                      'ARTON TABLE WITH MUL' DELIMITED BY SIZE    09666829
096669                      'TIPLE PO NUMBERS'     DELIMITED BY SIZE    09666929
096670                 INTO PV-ERROR-MESSAGE                            09667029
096671               SET PS-WRITE-ERROR-DATA-YES TO TRUE                09667129
096672               SET PS-COMMENT-TYPE-ERROR TO TRUE                  09667229
096673               ADD +1 TO PV-ERR-SSCC-MULT-PO-CNT                  09667329
096674               PERFORM 8300-INVALID-RECORD                        09667429
096675           END-IF                                                 09667529
096676         END-IF                                                   09667629
096677     END-IF.                                                      09667729
096678                                                                  09667829
096679                                                                  09667929
096680******************************************************************09668029
096681*  THIS PARAGRAPH WILL CHECK TO SEE IF THE SSCC NUMBER IS FOUND  *09668129
096682*  ON THE INBOUND CARTON HEADER TABLE.                           *09668229
096683******************************************************************09668329
096684 3510-FIND-SSCC-NBR.                                              09668429
096685     SET PS-DEFAULT-CARTON-NO  TO TRUE                            09668529
096686                                                                  09668629
096687     EXEC SQL                                                     09668729
096688          SELECT DISTINCT A.SHIPT_UNT_ID                          09668829
096689               , B.TRN_NBR                                        09668929
096690               , A.SHIPT_UNT_SRC_ID                               09669029
096691            INTO :SHPUNT-SHIPT-UNT-ID                             09669129
096692               , :SHUUPC-TRN-NBR                                  09669229
096693               , :SHPUNT-SHIPT-UNT-SRC-ID                         09669329
096694            FROM TSHPUNT A                                        09669429
096695               , TSHUUPC B                                        09669529
096696          WHERE A.SHIPT_UNT_ID = :DK-SSCC-NUMBER                  09669629
096697            AND B.SHIPT_UNT_ID = A.SHIPT_UNT_ID                   09669729
096698          WITH UR                                                 09669829
096699     END-EXEC                                                     09669929
096700                                                                  09670029
096701     EVALUATE TRUE                                                09670129
096702         WHEN SQLCODE  = +0                                       09670229
096703             IF (SHUUPC-TRN-NBR = PC-DEFAULT-TRN) AND             09670329
096704                (SHPUNT-SHIPT-UNT-SRC-ID  = PC-RCV)               09670429
096705                SET PS-DEFAULT-CARTON-YES TO TRUE                 09670529
096706             ELSE                                                 09670629
096707               SET PS-SSCC-FOUND TO TRUE                          09670729
096708               MOVE SHUUPC-TRN-NBR TO PV-DISP-NBR-8               09670829
096709               IF  PV-DISP-NBR-8 = RC101-KOHLS-ORD-NBR            09670929
096710                   SET RC101-SSCC-EXISTS-SAME-PO TO TRUE          09671029
096711               ELSE                                               09671129
096712                   SET RC101-SSCC-EXISTS-DIFF-PO TO TRUE          09671229
096713               END-IF                                             09671329
096714             END-IF                                               09671429
096715         WHEN SQLCODE  = -811                                     09671529
096716             SET PS-SSCC-FOUND-MULT-PO TO TRUE                    09671629
096717         WHEN SQLCODE  = +100                                     09671729
096718             SET PS-SSCC-NOT-FOUND TO TRUE                        09671829
096719             SET RC101-SSCC-NOT-EXISTS TO TRUE                    09671929
096720         WHEN OTHER                                               09672029
096721             DISPLAY '3510-FIND-SSCC-NBR DB2 ERROR'               09672129
096722             DISPLAY 'INPUT RECORD IS: '                          09672229
096723             DISPLAY RC108-SKU-SRT-CARTON-REC                     09672329
096724             MOVE '3510-FIND-SSCC-NBR' TO PV-ABEND-PARAGRAPH      09672429
096725             MOVE 'CHECK TO SEE IF SSCC EXISTS'                   09672529
096726                                            TO PV-ABEND-OPERATION 09672629
096727             PERFORM 9900-DB2-ABEND                               09672729
096728     END-EVALUATE.                                                09672829
096729                                                                  09672929
096730                                                                  09673029
096731******************************************************************09673129
096732*  DELETE THE ROW FROM THE SHIP UNIT  TABLE                       09673229
096733*  DELETE OF TSHPUNT WILL CASCADE DELETE ROWS ON TSHUUPC,TSHUNLO  09673329
096734******************************************************************09673429
096735 3520-DELETE-SHPUNT.                                              09673529
096736                                                                  09673629
096737     EXEC SQL                                                     09673730
096738         DELETE                                                   09673830
096739             FROM  TSHPUNT                                        09673930
096740             WHERE SHIPT_UNT_ID = :DK-SSCC-NUMBER                 09674030
096741     END-EXEC.                                                    09674130
096742                                                                  09674229
096743     EVALUATE TRUE                                                09674329
096744         WHEN SQLCODE = 0                                         09674429
096745             DISPLAY 'CARTON ALREADY EXISTS'                      09674529
096746             DISPLAY RC108-SKU-SRT-CARTON-REC                     09674629
096747         WHEN SQLCODE = +100                                      09674729
096748             CONTINUE                                             09674829
096749         WHEN OTHER                                               09674929
096750             DISPLAY '3520-DELETE-SHPUNT '                        09675029
096751             DISPLAY 'INPUT RECORD IS: '                          09675129
096752             DISPLAY RC108-SKU-SRT-CARTON-REC                     09675229
096753             MOVE '3520-DELETE-SHPUNT' TO PV-ABEND-PARAGRAPH      09675329
096754             MOVE 'DELETE OF TSHPUNT ENTRY   '                    09675429
096755                                            TO PV-ABEND-OPERATION 09675529
096756             PERFORM 9900-DB2-ABEND                               09675629
096760     END-EVALUATE.                                                09676018
096761                                                                  09676118
096763******************************************************************09676319
096764 3530-COMMIT.                                                     09676420
096765                                                                  09676520
096766     EXEC SQL                                                     09676620
096767          COMMIT                                                  09676720
096768     END-EXEC                                                     09676820
096769                                                                  09676920
096770     IF SQLCODE = ZERO                                            09677020
096780         CONTINUE                                                 09678020
096790     ELSE                                                         09679020
096791         DISPLAY '3530-COMMIT'                                    09679120
096792         DISPLAY 'INPUT RECORD IS: '                              09679220
096793         DISPLAY RC108-SKU-SRT-CARTON-REC                         09679320
096794         MOVE '3530-COMMIT' TO PV-ABEND-PARAGRAPH                 09679420
096795         MOVE 'COMMIT TSHPUNT DELETE   '                          09679521
096796                            TO PV-ABEND-OPERATION                 09679622
096815         PERFORM 9900-DB2-ABEND                                   09681520
096816     END-IF.                                                      09681620
096817*                                                                 09681720
096818******************************************************************09681819
096819*  THIS PARAGRAPH WILL CHECK TO SEE IF THE DC NUMBER ON THE      *09681919
096820*  INPUT RECORD IS A VALID DC NUMBER.                            *09682019
096821******************************************************************09682119
096822 3600-VALIDATE-DC-NUMBER.                                         09682219
096823                                                                  09682319
096824     MOVE RC108-DC-NBR TO DK-DC-NUMBER.                           09682419
096825     SET PS-DC-NOT-FOUND TO TRUE.                                 09682519
096826                                                                  09682619
096827     PERFORM 3610-FIND-DC-NBR.                                    09682719
096828                                                                  09682819
096829     IF  PS-DC-FOUND                                              09682919
096830         IF  XLT00010-LOC-TYP-CDE = 'DC'                          09683019
096831             NEXT SENTENCE                                        09683119
096832         ELSE                                                     09683219
096833             SET PS-ERROR-YES TO TRUE                             09683319
096834             MOVE PV-READ-COUNT       TO PV-DISP-NBR              09683419
096835             DISPLAY 'INPUT RECORD ' PV-DISP-NBR                  09683519
096836                     ' LOCATION NUMBER NOT A DC'                  09683619
096837             DISPLAY ' SKIPPING TO NEXT RECORD'                   09683719
096838             DISPLAY RC108-SKU-SRT-CARTON-REC                     09683819
096839             DISPLAY ' '                                          09683919
096840             DISPLAY '------------------------'                   09684019
096841             DISPLAY ' '                                          09684119
096842             MOVE XLT00010-LOC-NBR TO PV-DISP-NBR-4               09684219
096843             MOVE SPACES TO PV-ERROR-MESSAGE                      09684319
096844             STRING 'DC NUMBER '           DELIMITED BY SIZE      09684419
096845                    RC108-DC-NBR           DELIMITED BY SIZE      09684519
096846                    ' IS NOT A DC - TYPE ' DELIMITED BY SIZE      09684619
096847                    'IS: '                 DELIMITED BY SIZE      09684719
096848                    XLT00010-LOC-TYP-CDE   DELIMITED BY SIZE      09684819
096849               INTO PV-ERROR-MESSAGE                              09684919
096850             SET PS-WRITE-ERROR-DATA-YES TO TRUE                  09685019
096851             SET PS-COMMENT-TYPE-ERROR TO TRUE                    09685119
096852             ADD +1 TO PV-ERR-LOC-NOT-A-KDC-CNT                   09685219
096853             PERFORM 8300-INVALID-RECORD                          09685319
096854         END-IF                                                   09685419
096855     ELSE                                                         09685519
096856         SET PS-ERROR-YES TO TRUE                                 09685619
096857         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  09685719
096858         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      09685819
096859                 ' DC NUMBER ENTRY NOT FOUND'                     09685919
096860         DISPLAY ' SKIPPING TO NEXT RECORD'                       09686019
096861         DISPLAY RC108-SKU-SRT-CARTON-REC                         09686119
096862         DISPLAY ' '                                              09686219
096863         DISPLAY '------------------------'                       09686319
096864         DISPLAY ' '                                              09686419
096865         MOVE SPACES TO PV-ERROR-MESSAGE                          09686519
096866         STRING 'DC NUMBER ON INPUT R' DELIMITED BY SIZE          09686619
096867                'ECORD IS NOT IN LOCA' DELIMITED BY SIZE          09686719
096868                'TION MASTER DATABASE' DELIMITED BY SIZE          09686819
096869           INTO PV-ERROR-MESSAGE                                  09686919
096870         SET PS-WRITE-ERROR-DATA-YES TO TRUE                      09687019
096871         SET PS-COMMENT-TYPE-ERROR TO TRUE                        09687119
096872         ADD +1 TO PV-ERR-NOT-ON-LOCMST-CNT                       09687219
096873         PERFORM 8300-INVALID-RECORD                              09687319
096874     END-IF.                                                      09687419
096875                                                                  09687519
096876                                                                  09687619
096877******************************************************************09687719
096878*  THIS PARAGRAPH WILL DO A SELECT TO THE XLT_LOC TABLE TO SEE   *09687819
096879*  IF THE DC NUMBER IS VALID.                                    *09687919
096880******************************************************************09688019
096881 3610-FIND-DC-NBR.                                                09688119
096882                                                                  09688219
096883     EXEC SQL                                                     09688319
096884          SELECT LOC_NBR                                          09688419
096885               , LOC_TYP_CDE                                      09688519
096886               , LOC_5_ABBR_NM                                    09688619
096887               , OPN_DTE                                          09688719
096888               , CLO_DTE                                          09688819
096889            INTO :XLT00010-LOC-NBR                                09688919
096890               , :XLT00010-LOC-TYP-CDE                            09689019
096891               , :XLT00010-LOC-5-ABBR-NM                          09689119
096892               , :XLT00010-OPN-DTE                                09689219
096893               , :XLT00010-CLO-DTE                                09689319
096894            FROM XLT_LOC                                          09689419
096895          WHERE LOC_NBR = :DK-DC-NUMBER                           09689519
096896          WITH UR                                                 09689619
096897     END-EXEC                                                     09689719
096898                                                                  09689819
096899     EVALUATE TRUE                                                09689919
096900         WHEN SQLCODE  = +0                                       09690019
096901             SET PS-DC-FOUND TO TRUE                              09690119
096902             MOVE XLT00010-LOC-5-ABBR-NM (4:2) TO RC101-DC-ABBR   09690219
096903         WHEN SQLCODE  = +100                                     09690319
096904             SET PS-DC-NOT-FOUND TO TRUE                          09690419
096905             MOVE '  '                         TO RC101-DC-ABBR   09690519
096906         WHEN OTHER                                               09690619
096907             DISPLAY '3610-FIND-DC-NBR DB2 ERROR'                 09690719
096908             DISPLAY 'INPUT RECORD IS: '                          09690819
096909             DISPLAY RC108-SKU-SRT-CARTON-REC                     09690919
096910             MOVE '3610-FIND-DC-NBR' TO PV-ABEND-PARAGRAPH        09691019
096911             MOVE 'CHECK TO SEE IF DC NBR EXISTS'                 09691119
096912                                            TO PV-ABEND-OPERATION 09691219
096913             PERFORM 9900-DB2-ABEND                               09691319
096914     END-EVALUATE.                                                09691419
096915                                                                  09691519
096916                                                                  09691619
096917******************************************************************09691719
096918*  THIS PARAGRAPH WILL TAKE THE DC NUMBER FROM THE INPUT RECORD  *09691819
096919*  AND DO A LOOK UP OF THE PARM TABLE TO FIND THE DELIVERY SCAC  *09691919
096920*  TO POPULATE TO THE OUTPUT RECORD.  IF THE SELECT COMES BACK   *09692019
096921*  WITH A +100, THEN SPACES WILL BE MOVED TO THE FIELD.          *09692119
096922*  IF WE GET A +100 FROM THIS SELECT, THIS IS NOT CONSIDERED AN  *09692219
096923*  ERROR, THE TRANSPORTATION TABLES WOULD NOT BE POPULATED WITH  *09692319
096924*  DATA IN THE RCK010 JOB.                                       *09692419
096925******************************************************************09692519
096926 3700-GET-DELIVERY-SCAC.                                          09692619
096927                                                                  09692719
096928     MOVE RC108-DC-NBR TO DK-DC-NUMBER.                           09692819
096929                                                                  09692919
096930     EXEC SQL                                                     09693019
096931         SELECT FUNC_TXT                                          09693119
096932           INTO :KRPRPM-FUNC-TXT                                  09693219
096933           FROM TKRPRPM                                           09693319
096934          WHERE LOC_ID            = :DK-DC-NUMBER                 09693419
096935            AND INTFC_SYS_CDE     = 'KHL'                         09693519
096936            AND SYS_PRC_FUNC_CDE  = 'SSDYSC'                      09693619
096937            AND FUNC_PRC_STAT_CDE = 'AC'                          09693719
096938         WITH UR                                                  09693819
096939     END-EXEC.                                                    09693919
096940                                                                  09694019
096941     EVALUATE TRUE                                                09694119
096942         WHEN SQLCODE  = +0                                       09694219
096943             MOVE KRPRPM-FUNC-TXT  TO RC101-DELIVERY-SCAC         09694319
096944         WHEN SQLCODE  = +100                                     09694419
096945             MOVE SPACES TO RC101-DELIVERY-SCAC                   09694519
096946                            KRPRPM-FUNC-TXT                       09694619
096947             MOVE PV-READ-COUNT       TO PV-DISP-NBR              09694719
096948             DISPLAY 'INPUT RECORD ' PV-DISP-NBR                  09694819
096949                     ' DC NBR NOT FOUND ON TKRPRPM PARM'          09694919
096950             DISPLAY ' PROCESSING RECORD BUT WITH SPACES IN SCAC' 09695019
096951             DISPLAY ' DK-DC-NUMBER IS  : ' RC108-DC-NBR          09695119
096952             DISPLAY RC108-SKU-SRT-CARTON-REC                     09695219
096953             DISPLAY ' '                                          09695319
096954             DISPLAY '------------------------'                   09695419
096955             DISPLAY ' '                                          09695519
096956             ADD +1 TO PV-DSP-NO-DEL-SCAC-CNT                     09695619
096957         WHEN OTHER                                               09695719
096958             DISPLAY '3700-GET-DELIVERY-SCAC'                     09695819
096959             DISPLAY 'INPUT RECORD IS: '                          09695919
096960             DISPLAY RC108-SKU-SRT-CARTON-REC                     09696019
096961             MOVE '3700-VALIDATE-MDSE-SOURCE' TO                  09696119
096962                  PV-ABEND-PARAGRAPH                              09696219
096963             MOVE 'READ TKRPRM TO GET DELIVERY SCAC'              09696319
096964                                            TO PV-ABEND-OPERATION 09696419
096965             PERFORM 9900-DB2-ABEND                               09696519
096966     END-EVALUATE.                                                09696619
096967                                                                  09696719
096968                                                                  09696819
096969******************************************************************09696919
096970* THIS PARAGRAPH WILL CHECK TO SEE IF THE UNIT QUANTITY IS       *09697019
096971* GREATER THAN A VALUE OF ZERO.  IF THE QUANTITY IS EQUAL TO     *09697119
096972* ZERO, THEN THE RECORD WILL BE BYPASSED AND WRITTEN TO THE      *09697219
096973* ERROR FILE AND LINE WILL BE WRITTEN TO THE ERROR REPORT.       *09697319
096974******************************************************************09697419
096975 3800-VALIDATE-UNIT-QUANTITY.                                     09697519
096976                                                                  09697619
096977     IF  RC101-SHIP-QTY = 0                                       09697719
096978         SET PS-ERROR-YES TO TRUE                                 09697819
096979         MOVE PV-READ-COUNT       TO PV-DISP-NBR                  09697919
096980         DISPLAY 'INPUT RECORD ' PV-DISP-NBR                      09698019
096981                 ' SHIP QUANTITY IS EQUAL TO ZERO'                09698119
096982         DISPLAY ' SKIPPING TO NEXT RECORD'                       09698219
096983         DISPLAY RC108-SKU-SRT-CARTON-REC                         09698319
096984         DISPLAY ' '                                              09698419
096985         DISPLAY '------------------------'                       09698519
096986         DISPLAY ' '                                              09698619
096987         MOVE SPACES TO PV-ERROR-MESSAGE                          09698719
096988         STRING 'THE UNIT QUANTITY FI' DELIMITED BY SIZE          09698819
096989                'ELD ON THE INPUT REC'   DELIMITED BY SIZE        09698919
096990                'ORD IS ZERO         '   DELIMITED BY SIZE        09699019
096991           INTO PV-ERROR-MESSAGE                                  09699119
096992         SET PS-WRITE-ERROR-DATA-YES TO TRUE                      09699219
096993         SET PS-COMMENT-TYPE-ERROR TO TRUE                        09699319
096994         ADD +1 TO PV-ERR-QTY-EQ-ZERO-CNT                         09699419
096995         PERFORM 8300-INVALID-RECORD                              09699519
096996     END-IF.                                                      09699619
096997                                                                  09699719
096998                                                                  09699819
096999******************************************************************09699919
097000*  READ A SHIPPED MERCHANDISE COMMA DELIMITED INPUT RECORD       *09700019
097001******************************************************************09700119
097002 7000-READ-INPUT.                                                 09700219
097003                                                                  09700319
097004     READ SKU-SORT-DATA-FILE                                      09700419
097005       INTO RC108-SKU-SRT-CARTON-REC                              09700519
097006         AT END                                                   09700619
097007           SET END-OF-FILE TO TRUE                                09700719
097008         NOT AT END                                               09700819
097010           ADD 1                      TO PV-READ-COUNT            09701019
097100                                         PV-PROGRESSIVE-READ-COUNT09710019
097500           IF  PV-PROGRESSIVE-READ-COUNT =                        09750000
097600               PC-PROGRESSIVE-READ-LIMIT                          09760000
097700               MOVE PV-READ-COUNT TO PV-DISP-NBR                  09770000
097800               DISPLAY 'PROGRESSIVE READ COUNT IS: '              09780000
097900                       PV-DISP-NBR                                09790000
098000               MOVE ZEROS TO PV-PROGRESSIVE-READ-COUNT            09800000
098100           END-IF                                                 09810000
098200     END-READ.                                                    09820000
098300                                                                  09830000
098400                                                                  09840000
098500******************************************************************09850000
098600*  PRINT ALL REPORT HEADING LINES.                               *09860000
098700******************************************************************09870000
098800 8000-PRINT-HEADINGS.                                             09880000
098900                                                                  09890000
099000     ADD 1                       TO PV-PAGE-CNT.                  09900000
099100                                                                  09910000
099200     MOVE PV-PAGE-CNT            TO DP150O-PAGE-NUMBER.           09920004
099300     MOVE PC-REPORT-NBR-1        TO DP150O-REPORT-NUMBER.         09930004
099400     MOVE DP150O-STANDRD-HEADER-150-COLS                          09940004
099500                                 TO PV-PRINT-RECORD.              09950000
099600     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                          09960000
099700                                                                  09970000
099800     MOVE HL1-HEADING-LINE-1     TO PV-PRINT-RECORD.              09980000
099900     MOVE +1                     TO PV-LINE-SPACING.              09990000
100000     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           10000000
100100                                                                  10010000
100200     MOVE HL2-HEADING-LINE-2     TO PV-PRINT-RECORD.              10020000
100300     MOVE +1                     TO PV-LINE-SPACING.              10030000
100400     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           10040000
100500                                                                  10050000
100600     MOVE HL3-HEADING-LINE-3     TO PV-PRINT-RECORD.              10060000
100700     MOVE +2                     TO PV-LINE-SPACING.              10070000
100800     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           10080000
100900                                                                  10090000
101000                                                                  10100000
101100******************************************************************10110000
101200*  THIS PARAGRAPH WILL PRINT THE 'END OF REPORT' LINE.           *10120000
101300******************************************************************10130000
101400 8050-PRINT-END-OF-RPT-LINE.                                      10140000
101500                                                                  10150000
101600     IF  PV-LINE-CNT > PC-LINE-LIMIT                              10160000
101700         PERFORM 8000-PRINT-HEADINGS                              10170000
101800     END-IF.                                                      10180000
101900                                                                  10190000
102000     IF  PV-READ-COUNT = 0                                        10200000
102100         MOVE EMPTY-FILE-LINE  TO PV-PRINT-RECORD                 10210000
102200         MOVE +2               TO PV-LINE-SPACING                 10220000
102300         PERFORM 8200-WRITE-ERROR-RPT-LINE                        10230000
102400     ELSE                                                         10240000
102500         IF  PS-REPORT-WRITE-NO                                   10250000
102600             MOVE NO-ERROR-LINE    TO PV-PRINT-RECORD             10260000
102700             MOVE +2               TO PV-LINE-SPACING             10270000
102800             PERFORM 8200-WRITE-ERROR-RPT-LINE                    10280000
102900         END-IF                                                   10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200     MOVE END-OF-REPORT-LINE   TO PV-PRINT-RECORD.                10320000
103300     MOVE +2                   TO PV-LINE-SPACING.                10330000
103400     PERFORM 8200-WRITE-ERROR-RPT-LINE.                           10340000
103500                                                                  10350000
103600                                                                  10360000
103700******************************************************************10370000
103800*  WRITE FIRST REPORT LINE AFTER PAGE BREAK.                     *10380000
103900******************************************************************10390000
104000 8100-WRITE-RPT-TOP-OF-PAGE.                                      10400000
104100                                                                  10410000
104200     WRITE ERROR-REPORT-RECORD                                    10420000
104300       FROM PV-PRINT-RECORD                                       10430000
104400         AFTER ADVANCING PAGE.                                    10440000
104500     MOVE +1             TO PV-LINE-CNT.                          10450000
104600                                                                  10460000
104700                                                                  10470000
104800******************************************************************10480000
104900*  WRITE ERROR REPORT LINE AFTER ADVANCING LINE SPACING.         *10490000
105000******************************************************************10500000
105100 8200-WRITE-ERROR-RPT-LINE.                                       10510000
105200                                                                  10520000
105300     WRITE ERROR-REPORT-RECORD                                    10530000
105400       FROM PV-PRINT-RECORD                                       10540000
105500         AFTER ADVANCING PV-LINE-SPACING.                         10550000
105600     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          10560000
105700                                                                  10570000
105800                                                                  10580000
105900******************************************************************10590000
106000*  THIS PARAGRAPH WILL BE USED TO WRITE THE INPUT RECORD TO THE  *10600000
106100*  ERROR FILE.  THIS WILL ALSO CONTROL THE WRITING OF DATA FOR   *10610000
106200*  THE ERROR FOUND TO THE REPORT.                                *10620000
106300******************************************************************10630000
106400 8300-INVALID-RECORD.                                             10640000
106500                                                                  10650000
106600     SET PS-REPORT-WRITE-YES TO TRUE.                             10660000
106700                                                                  10670000
106800     IF  PS-WRITE-ERROR-DATA-YES                                  10680002
106900         WRITE SKU-SORT-ERROR-RECORD                              10690004
107000          FROM RC108-SKU-SRT-CARTON-REC                           10700004
107100         ADD +1 TO PV-ERROR-WRITE-COUNT                           10710000
107200     END-IF.                                                      10720000
107300                                                                  10730000
107400     IF  PV-LINE-CNT > PC-LINE-LIMIT                              10740000
107500         PERFORM 8000-PRINT-HEADINGS                              10750000
107600     END-IF.                                                      10760000
107700                                                                  10770000
107800     MOVE SPACES              TO DL1-DETAIL-LINE-1.               10780004
107810     MOVE RC108-FILE-NAME     TO DT1-FILE-NAME.                   10781004
107820     MOVE RC108-KOHLS-ORD-NBR TO DT1-KOHLS-PO.                    10782004
107830     MOVE RC108-VENDR-ORD-NBR TO DT1-VENDOR-PO.                   10783004
107840     MOVE RC108-DC-NBR        TO DT1-DC-NBR.                      10784015
107850     MOVE RC108-SEQ-NBR       TO DT1-SEQ-NBR.                     10785015
107860     MOVE RC108-CARTON-ID     TO DT1-SSCC-NBR.                    10786004
107870     MOVE RC108-SKU-NBR       TO DT1-SKU-NBR.                     10787004
107880     MOVE RC108-SHIP-QTY      TO DT1-QTY.                         10788004
107881     MOVE PV-ERROR-MESSAGE    TO DT1-ERROR-MESSAGE.               10788104
107890                                                                  10789004
107900     MOVE +1                     TO PV-LINE-SPACING.              10790004
108000                                                                  10800000
108100     WRITE ERROR-REPORT-RECORD                                    10810000
108200       FROM DL1-DETAIL-LINE-1                                     10820000
108300         AFTER ADVANCING PV-LINE-SPACING.                         10830000
108400                                                                  10840000
108500     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          10850000
109900                                                                  10990000
110000******************************************************************11000000
110100*  SHOW RECORD COUNTS AND AMOUNTS IN SYSOUT                       11010000
110200******************************************************************11020000
110300 8500-SHOW-COUNTERS.                                              11030000
110310     DISPLAY ' '.                                                 11031005
110400     DISPLAY ' *********  RCKUT180 STATISTICS *********'          11040000
110500     MOVE PV-READ-COUNT           TO PV-DISP-NBR-C.               11050000
110600     DISPLAY 'RECORDS READ             = ' PV-DISP-NBR-C.         11060000
111300     MOVE PV-GOOD-WRITE-COUNT     TO PV-DISP-NBR-C.               11130000
111400     DISPLAY 'VALID DETAIL WRITE COUNT = ' PV-DISP-NBR-C.         11140005
111500     MOVE PV-ERROR-WRITE-COUNT    TO PV-DISP-NBR-C.               11150000
111600     DISPLAY 'ERROR FILE WRITE COUNT   = ' PV-DISP-NBR-C.         11160005
111700     DISPLAY ' '.                                                 11170000
112300     DISPLAY ' **ERROR COUNTS**'                                  11230000
112800     MOVE PV-ERR-NON-NUMERIC-CNT   TO PV-DISP-NBR-C.              11280000
112900     DISPLAY 'RECORDS WITH NON NUMERIC DATA     = ' PV-DISP-NBR-C.11290000
113000     MOVE PV-ERR-PO-NOT-FOUND-CNT  TO PV-DISP-NBR-C.              11300000
113100     DISPLAY 'RECORDS WITH PO NOT FOUND         = ' PV-DISP-NBR-C.11310000
113400     MOVE PV-ERR-SKU-NOT-FOUND-CNT TO PV-DISP-NBR-C.              11340005
113500     DISPLAY 'RECORDS WITH SKU NOT FOUND        = ' PV-DISP-NBR-C.11350005
113600     MOVE PV-ERR-SKU-NOT-ON-PO-CNT TO PV-DISP-NBR-C.              11360000
113700     DISPLAY 'RECORDS WITH SKU NOT FOUND ON PO  = ' PV-DISP-NBR-C.11370005
113800     MOVE PV-ERR-LOC-NOT-A-KDC-CNT TO PV-DISP-NBR-C.              11380000
113900     DISPLAY 'RECORDS WITH KOHLS LOC NOT A DC   = ' PV-DISP-NBR-C.11390000
114000     MOVE PV-ERR-NOT-ON-LOCMST-CNT TO PV-DISP-NBR-C.              11400000
114100     DISPLAY 'RECORDS WITH KOHLS LOC NOT FOUND  = ' PV-DISP-NBR-C.11410000
114200     MOVE PV-ERR-QTY-EQ-ZERO-CNT   TO PV-DISP-NBR-C.              11420000
114300     DISPLAY 'RECORDS WITH SHIP QTY EQUAL TO 0  = ' PV-DISP-NBR-C.11430000
114600     MOVE PV-ERR-SSCC-SAME-PO-CNT  TO PV-DISP-NBR-C.              11460014
114700     DISPLAY 'SSCC EXISTS WITH SAME PO          = ' PV-DISP-NBR-C.11470000
114800     MOVE PV-ERR-SSCC-DIFF-PO-CNT  TO PV-DISP-NBR-C.              11480014
114900     DISPLAY 'SSCC EXISTS BUT DIFFERENT PO      = ' PV-DISP-NBR-C.11490000
114910     MOVE PV-ERR-SSCC-MULT-PO-CNT  TO PV-DISP-NBR-C.              11491014
114920     DISPLAY 'SSCC EXISTS BUT MULTIPLE PO       = ' PV-DISP-NBR-C.11492014
115000     DISPLAY ' '.                                                 11500000
115100     DISPLAY ' **DISPLAY COUNTS**'                                11510000
115200     MOVE PV-DSP-NO-DEL-SCAC-CNT   TO PV-DISP-NBR-C.              11520005
115300     DISPLAY 'PARM NOT FOUND FOR DELIVERY SCAC  = ' PV-DISP-NBR-C.11530005
115600******************************************************************11560000
115700*  DB2 ABEND ROUTINE                                             *11570000
115800******************************************************************11580000
115900 9900-DB2-ABEND.                                                  11590000
116000*    DISPLAY '9900-DB2-ABEND'.                                    11600000
116100                                                                  11610000
116200     MOVE SQLCODE TO PV-SQLCODE.                                  11620000
116300     DISPLAY '*** DB2 ERROR '.                                    11630000
116400     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       11640000
116500     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 11650000
116600     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               11660000
116700     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               11670000
116800     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       11680000
116900     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             11690000
117000                                                                  11700000
117100     IF PV-ABEND-STRUCTURE-2 > SPACES                             11710000
117200         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          11720000
117300     END-IF.                                                      11730000
117400                                                                  11740000
117500     COPY DPPD004.                                                11750000
117600                                                                  11760000
117700     MOVE +4013                  TO PV-ABEND-CODE.                11770000
117800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11780000
117900*                                                                 11790000
118000* ************************ END OF RCKUT180 ********************** 11800000
