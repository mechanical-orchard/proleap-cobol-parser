000100 IDENTIFICATION DIVISION.                                         00010097
000200                                                                  00020098
000300 PROGRAM-ID.             RVKRP026.                                00030098
000400 AUTHOR.                 CHRIS STRODTHOFF.                        00040098
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050098
000600 DATE-WRITTEN.           JUNE 2011.                               00060098
000700 DATE-COMPILED.                                                   00070098
000800                                                                  00080098
000900******************************************************************00090098
001000*                                                                 00100098
001100*  PROGRAM NARRATIVE:                                             00110098
001200*                                                                 00120098
001300*  INPUT TRANSFER SUMMARY REPORT FILE.                            00130098
001400*  CREATE A DAILY GENCO TRANSFER SUMMARY REPORT FOR MULTIPLE LOCS.00140098
001500*                                                                 00150098
001600******************************************************************00160098
001700*  CHANGE LOG.                                                    00170098
001800*  DATE         CHANGED BY      DESC                              00180098
001900*  -----------  --------------  ----------------------------------00190098
002000*  10/30/2011   C. STRODTHOFF - GENCO / RTV UPGRADE. NEW PROGRAM  00200098
002100*                               TO SHOW MULTIPLE RTV LOCATIONS.   00210098
002200*                               PRJ ID 3219 - WR40134.            00220098
002201*                                                                 00220198
002202*  04/25/2013   COGNIZANT     - THE FOLLOWING ARE THE CHANGES     00220298
002203*                               DONE AS PART OF THIS PRB0040383.  00220398
002204*                               1. THIS PROGRAM IS CHANGED TO     00220498
002205*                               HAVE THE RTV LOCATIONS ARE        00220598
002206*                               FETCHED FROM TKRPRPM TABLE        00220698
002207*                               INSTEAD OF THE CONTROL CARD       00220798
002208*                               (RVCC026).                        00220898
002209*                               2. BELOW ARE THE PARAGRAPHS       00220998
002210*                               WHICH ARE AFFECTED FOR            00221098
002220*                               HANDLING OF THE RTV-CSR.          00222098
002230*                               1110-POPULATE-LOC-TABLE           00223098
002240*                               1111-OPEN-RTV-CURSOR              00224098
002250*                               1112-FETCH-RTV-CURSOR             00225098
002260*                               1113-CLOSE-RTV-CURSOR             00226098
002270*                               3. RENAMED THE FOLLOWING PARA     00227098
002280*                               1150-VALIDATE-LOC-CONTROL-CARD    00228098
002290*                               TO 1150-VALIDATE-LOC-PARM-TABLE   00229098
002300******************************************************************00230098
002400*                                                                 00240098
002500 ENVIRONMENT DIVISION.                                            00250098
002600                                                                  00260098
002700 CONFIGURATION SECTION.                                           00270098
002800                                                                  00280098
002900 SOURCE-COMPUTER.                        IBM-3090.                00290098
003000 OBJECT-COMPUTER.                        IBM-3090.                00300098
003100                                                                  00310098
003200 INPUT-OUTPUT SECTION.                                            00320098
003300                                                                  00330098
003400 FILE-CONTROL.                                                    00340098
003500                                                                  00350098
003600     SELECT TFRD-REPORT-FILE                                      00360098
003700         ASSIGN TO INP01.                                         00370098
003800                                                                  00380098
003900     SELECT REPORT-FILE                                           00390098
004000         ASSIGN TO RPT01.                                         00400098
004100******************************************************************00410098
004200 DATA DIVISION.                                                   00420098
004300******************************************************************00430098
004400                                                                  00440098
004500 FILE SECTION.                                                    00450098
004600                                                                  00460098
004700 FD  TFRD-REPORT-FILE                                             00470098
004800     RECORDING MODE IS F                                          00480098
004900     LABEL RECORDS ARE STANDARD                                   00490098
005000     BLOCK CONTAINS 0 RECORDS.                                    00500098
005100 01  TFRD-REPORT-RECORD               PIC  X(75).                 00510098
005200                                                                  00520098
005300 FD  REPORT-FILE                                                  00530098
005400     RECORDING MODE F                                             00540098
005500     BLOCK CONTAINS 0 RECORDS                                     00550098
005600     LABEL RECORDS ARE OMITTED                                    00560098
005700     DATA RECORD IS REPORT-RECORD.                                00570098
005800 01  REPORT-RECORD                    PIC X(132).                 00580098
005900                                                                  00590098
006000 WORKING-STORAGE SECTION.                                         00600098
006100***************************************************************** 00610098
006200*    CONTROL CARD INPUT                                           00620098
006300***************************************************************** 00630098
006400 01  CC-CONTROL-CARD-LOC-TABLE.                                   00640098
006500*** 'LOC NBRS = 01 0804 02 0805 03 0811 04 9999 05 9999 06 9999..'00650098
006600***  9999 ARE FOR FUTURE LOC NUMBERS IN LOWEST TO HIGHEST ORDER.  00660098
006700***  DO NOT CHANGE CC-INDEX-NBR FIELD WHEN ADDING FUTURE LOC NUM. 00670098
006800     05  FILLER                       PIC X(10).                  00680098
006900     05  CC-LOC-NBR                   OCCURS 20 TIMES             00690098
007000                                      INDEXED BY CC-IDX.          00700098
007100         10  FILLER                   PIC X(01).                  00710098
007200         10  CC-INDEX-NBR             PIC 9(02).                  00720098
007300         10  FILLER                   PIC X(01).                  00730098
007400         10  CC-LOC                   PIC 9(04).                  00740098
007500                                                                  00750098
007600***************************************************************** 00760098
007700*    PROGRAM HOLDS                                                00770098
007800***************************************************************** 00780098
007900 01  PH-LOC-HOLD-TABLE.                                           00790098
008000     05  PH-LOC-NUMBER                OCCURS 20 TIMES             00800098
008100                                      INDEXED BY HOLD-IDX.        00810098
008200         10  PH-LOC                   PIC 9(04).                  00820098
008300 01  PH-PROGRAM-HOLD-TOTAL-FIELDS.                                00830098
008400** ADD TOTALS                                                     00840098
008500     05  PH-A-DEFDAM-SORT1-TOT        PIC  9(09)V99 VALUE ZEROS.  00850098
008600     05  PH-A-DEFDAM-SORT2-TOT        PIC  9(09)V99 VALUE ZEROS.  00860098
008700     05  PH-A-CALLBACK-TOT            PIC  9(09)V99 VALUE ZEROS.  00870098
008800     05  PH-A-COMBINE-TOT             PIC  9(10)V99 VALUE ZEROS.  00880098
008900** DELETE TOTALS                                                  00890098
009000     05  PH-D-DEFDAM-SORT1-TOT        PIC  9(09)V99 VALUE ZEROS.  00900098
009100     05  PH-D-DEFDAM-SORT2-TOT        PIC  9(09)V99 VALUE ZEROS.  00910098
009200     05  PH-D-CALLBACK-TOT            PIC  9(09)V99 VALUE ZEROS.  00920098
009300     05  PH-D-COMBINE-TOT             PIC  9(10)V99 VALUE ZEROS.  00930098
009400** GRAND TOTAL                                                    00940098
009500     05  PH-G-COMBINE-TOT             PIC  9(11)V99 VALUE ZEROS.  00950098
009600** FINAL ADD TOTALS                                               00960098
009700     05  PH-FA-DEFDAM-SORT1-TOT       PIC  9(09)V99 VALUE ZEROS.  00970098
009800     05  PH-FA-DEFDAM-SORT2-TOT       PIC  9(09)V99 VALUE ZEROS.  00980098
009900     05  PH-FA-CALLBACK-TOT           PIC  9(09)V99 VALUE ZEROS.  00990098
010000     05  PH-FA-COMBINE-TOT            PIC  9(10)V99 VALUE ZEROS.  01000098
010100** FINAL DELETE TOTALS                                            01010098
010200     05  PH-FD-DEFDAM-SORT1-TOT       PIC  9(09)V99 VALUE ZEROS.  01020098
010300     05  PH-FD-DEFDAM-SORT2-TOT       PIC  9(09)V99 VALUE ZEROS.  01030098
010400     05  PH-FD-CALLBACK-TOT           PIC  9(09)V99 VALUE ZEROS.  01040098
010500     05  PH-FD-COMBINE-TOT            PIC  9(10)V99 VALUE ZEROS.  01050098
010600** FINAL GRAND TOTAL                                              01060098
010700     05  PH-FG-COMBINE-TOT            PIC  9(11)V99 VALUE ZEROS.  01070098
010800** LOC NUMBER                                                     01080098
010900     05  PH-LOC-NBR                   PIC  9(04)    VALUE ZEROS.  01090098
011000** BATCH NUMBER                                                   01100098
011100     05  PH-BATCH-NBR                 PIC  9(04)    VALUE ZEROS.  01110098
011200***************************************************************** 01120098
011300*    PROGRAM CONSTANTS                                            01130098
011400***************************************************************** 01140098
011500 01  PC-CONSTANTS.                                                01150098
011600     05  PC-CURRENT-PGM-RVKRP026      PIC  X(08) VALUE 'RVKRP026'.01160098
011700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         01170098
011800                                                 COMP SYNC.       01180098
011900     05  PC-DEFDAM-SORT1                 PIC X(16) VALUE          01190098
012000                                         'DEF/DAMAGE-SORT1'.      01200098
012100     05  PC-DEFDAM-SORT2                 PIC X(16) VALUE          01210098
012200                                         'DEF/DAMAGE-SORT2'.      01220098
012300     05  PC-CALLBACK                     PIC X(16) VALUE          01230098
012400                                         'CALLBACK        '.      01240098
012500     05  PC-TOTAL                        PIC X(16) VALUE          01250098
012600                                         'TOTAL           '.      01260098
012700     05  PC-GTOTAL                       PIC X(16) VALUE          01270098
012800                                         'GRAND TOTAL     '.      01280098
012900******************************************************************01290098
013000**LAYOUT FOR THE TRANSFER DAILY SUMMARY REPORTS                   01300098
013100******************************************************************01310098
013200 01  HL-HEADER-LINE1.                                             01320098
013300     05  FILLER                          PIC X(52) VALUE SPACES.  01330098
013400     05  FILLER                          PIC X(28)                01340098
013500         VALUE 'GENCO TRANSFERS DAILY REPORT'.                    01350098
013600 01  HL-HEADER-LINE2.                                             01360098
013700     05  FILLER                          PIC X(51) VALUE SPACES.  01370098
013800     05  FILLER                          PIC X(30)                01380098
013900         VALUE 'ADJUSTMENTS/RECEIVED TRANSFERS'.                  01390098
014000 01  HL-HEADER-LINE3.                                             01400098
014100     05  FILLER                          PIC X(64) VALUE SPACES.  01410098
014200     05  FILLER                          PIC X(07)                01420098
014300         VALUE 'SUMMARY'.                                         01430098
014400 01  HL-HEADER-LINE4.                                             01440098
014500     05  FILLER                          PIC X(17)                01450098
014600         VALUE 'DATE          :  '.                               01460098
014700     05  HL4-REPORT-DATE                 PIC X(10) VALUE SPACES.  01470098
014800 01  HL-HEADER-LINE5.                                             01480098
014900     05  FILLER                          PIC X(17)                01490098
015000         VALUE 'BATCH NBR     :  '.                               01500098
015100     05  HL5-BATCH-NBR                   PIC 9999  VALUE ZEROES.  01510098
015200 01  HL-HEADER-LINE5A.                                            01520098
015300     05  FILLER                          PIC X(17)                01530098
015400         VALUE 'RTV LOCATION  :  '.                               01540098
015500     05  HL5A-RTV-LOC-NBR                PIC 9999  VALUE ZEROES.  01550098
015600     05  FILLER                          PIC X(02) VALUE SPACES.  01560098
015700     05  HL5A-RTV-LOC-NM                 PIC X(10) VALUE SPACES.  01570098
015800 01  HL-HEADER-LINE5B.                                            01580098
015900     05  FILLER                          PIC X(20)                01590098
016000         VALUE 'RTV LOCATION  :  ALL'.                            01600098
016100 01  HL-HEADER-LINE6.                                             01610098
016200     05  FILLER                          PIC X(16) VALUE SPACES.  01620098
016300     05  FILLER                          PIC X(17)                01630098
016400         VALUE 'SUMMARY RECEIVED:'.                               01640098
016500 01  HL-HEADER-LINE7.                                             01650098
016600     05  FILLER                          PIC X(13)                01660098
016700         VALUE 'TRANSFER TYPE'.                                   01670098
016800     05  FILLER                          PIC X(10) VALUE SPACES.  01680098
016900     05  FILLER                          PIC X(14)                01690098
017000         VALUE 'TOTAL RETAIL  '.                                  01700098
017100 01  HL-HEADER-LINE8.                                             01710098
017200     05  FILLER                          PIC X(16) VALUE SPACES.  01720098
017300     05  FILLER                          PIC X(20)                01730098
017400         VALUE 'SUMMARY ADJUSTMENTS:'.                            01740098
017500 01  HL-HEADER-LINE9.                                             01750098
017600     05  FILLER                          PIC X(09)                01760098
017700         VALUE 'VOID TYPE'.                                       01770098
017800     05  FILLER                          PIC X(14) VALUE SPACES.  01780098
017900     05  FILLER                          PIC X(14)                01790098
018000         VALUE 'TOTAL RETAIL  '.                                  01800098
018100                                                                  01810098
018200 01  HL-DOTTED-HEADER-LINE1.                                      01820098
018300     05  FILLER                          PIC X(23)                01830098
018400         VALUE '---------------------  '.                         01840098
018500     05  FILLER                          PIC X(14)                01850098
018600         VALUE '--------------'.                                  01860098
018700                                                                  01870098
018800 01  DL-TOTAL-LINE1.                                              01880098
018900     05  DL1-TRANSFER-TYPE               PIC X(16)  VALUE SPACES. 01890098
019000     05  FILLER                          PIC X(04)  VALUE SPACES. 01900098
019100     05  DL1-TOTAL-RETAIL                PIC ZZ,ZZZ,ZZZ,ZZ9.99    01910098
019200                                                    VALUE ZEROES. 01920098
019300 01  DL-EMPTY-LINE1.                                              01930098
019400     05  FILLER                          PIC X(31)                01940098
019500         VALUE 'NO DAILY TRANSFER RECORDS FOUND'.                 01950098
019600                                                                  01960098
019700******************************************************************01970098
019800**PROGRAM COUNTERS                                                01980098
019900******************************************************************01990098
020000 01  PC-PROGRAM-COUNTER.                                          02000098
020100     05  PC-REPORT-LINE-COUNTER          PIC 9(03) VALUE ZEROS.   02010098
020200     05  PC-PAGE-COUNTER                 PIC 9(03) VALUE ZEROS.   02020098
020300***************************************************************** 02030098
020400*    PROGRAM SWITCHES                                             02040098
020500***************************************************************** 02050098
020600 01  PS-SWITCHES.                                                 02060098
020700     05  PS-END-RPT-FILE-SWITCH       PIC  X(01) VALUE 'N'.       02070098
020800         88  PS-END-RPT-FILE                     VALUE 'Y'.       02080098
020900         88  PS-NOT-END-RPT-FILE                 VALUE 'N'.       02090098
021000     05  PS-XLT00010-SWITCH           PIC  X(01) VALUE 'N'.       02100098
021100         88  PS-XLT00010-FOUND                   VALUE 'Y'.       02110098
021200         88  PS-XLT00010-NOTFND                  VALUE 'N'.       02120098
021210     05  PS-EOF-RTVCSR-SW             PIC X(01)  VALUE 'N'.       02121098
021220         88  PS-EOF-RTV-CSR                      VALUE 'Y'.       02122098
021230                                                                  02123098
021240***************************************************************** 02124098
021250*    PROGRAM VARIABLES                                            02125098
021260***************************************************************** 02126098
021270 01  PV-VARIABLES.                                                02127098
021280     05  PV-KEY-LOC-NBR               PIC S9(04) VALUE +0         02128098
021290                                                 COMP SYNC.       02129098
021300     05  PV-LOC-NBR                   PIC S9(04) VALUE ZERO       02130098
021400                                                 COMP.            02140098
021500     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         02150098
021600                                                 COMP SYNC.       02160098
021700     05  PV-NULL                      PIC S9(04) VALUE +0 COMP.   02170098
021800     05  PV-ABEND-CODE                PIC S9(04) VALUE ZERO       02180098
021900                                                 COMP SYNC.       02190098
022000     05  PV-REPORT-NUMBER             PIC  9(01) VALUE 1.         02200098
022100     05  PV-PARAGRAPH                 PIC  X(30) VALUE SPACES.    02210098
022200     05  PV-DB2-FUNCTION              PIC  X(30) VALUE SPACES.    02220098
022300     05  PV-ABEND-TABLE-1             PIC  X(20) VALUE SPACES.    02230098
022400     05  PV-ABEND-TABLE-2             PIC  X(20) VALUE SPACES.    02240098
022500     05  PV-ABEND-TABLE-3             PIC  X(20) VALUE SPACES.    02250098
022600     05  PV-ABEND-TABLE-4             PIC  X(20) VALUE SPACES.    02260098
022700     05  PV-ABEND-TABLE-5             PIC  X(20) VALUE SPACES.    02270098
022800     05  PV-ERROR-MSG-1               PIC  X(60) VALUE SPACES.    02280098
022900     05  PV-ERROR-MSG-2               PIC  X(60) VALUE SPACES.    02290098
023000     05  PV-ERROR-MSG-3               PIC  X(60) VALUE SPACES.    02300098
023100     05  PV-ASTERISK-LINE             PIC  X(80) VALUE ALL '*'.   02310098
023200     05  PV-RPT-RECS-READ             PIC  9(09) VALUE ZERO.      02320098
023300                                                                  02330098
023400     05  PV-RUN-DATE-CN               PIC  X(08)  VALUE SPACES.   02340098
023500     05  PV-RUN-TIME-CN               PIC  X(06)  VALUE SPACES.   02350098
023600                                                                  02360098
023700     05  PV-CURRENT-TMST-DB2          PIC X(26)   VALUE SPACE.    02370098
023800     05  PV-CURRENT-TMST.                                         02380098
023900         10  PV-CURR-DATE.                                        02390098
024000             15  PV-CURR-DATE-CC     PIC  9(02)    VALUE ZERO.    02400098
024100             15  PV-CURR-DATE-YY     PIC  9(02)    VALUE ZERO.    02410098
024200             15  PV-CURR-SLASH1      PIC  X        VALUE SPACE.   02420098
024300             15  PV-CURR-DATE-MM     PIC  9(02)    VALUE ZERO.    02430098
024400             15  PV-CURR-SLASH2      PIC  X        VALUE SPACE.   02440098
024500             15  PV-CURR-DATE-DD     PIC  9(02)    VALUE ZERO.    02450098
024600             15  PV-CURR-SLASH3      PIC  X        VALUE SPACE.   02460098
024700         10  PV-CURR-TIME.                                        02470098
024800             15  PV-CURR-TIME-HH     PIC  9(02)    VALUE ZERO.    02480098
024900             15  PV-CURR-TIME-P1     PIC  X        VALUE SPACE.   02490098
025000             15  PV-CURR-TIME-MM     PIC  9(02)    VALUE ZERO.    02500098
025100             15  PV-CURR-TIME-P2     PIC  X        VALUE SPACE.   02510098
025200             15  PV-CURR-TIME-SS     PIC  9(02)    VALUE ZERO.    02520098
025300             15  FILL                PIC  X(07)    VALUE SPACE.   02530098
025400                                                                  02540098
025500     05  PV-CURR-CCYY.                                            02550098
025600         10  PV-CURR-CC              PIC  X(02)    VALUE SPACE.   02560098
025700         10  PV-CURR-YY              PIC  X(02)    VALUE SPACE.   02570098
025800                                                                  02580098
025900     05  PV-DATE.                                                 02590098
026000         10  PV-DATE-CCYY            PIC  X(04)    VALUE SPACE.   02600098
026100         10  PV-DATE-MM              PIC  X(02)    VALUE SPACE.   02610098
026200         10  PV-DATE-DD              PIC  X(02)    VALUE SPACE.   02620098
026300                                                                  02630098
026400     05  PV-RPT-DATE.                                             02640098
026500         10  PV-RPT-CCYY             PIC  X(04)    VALUE SPACE.   02650098
026600         10  FILLER                  PIC  X(01)    VALUE '-'.     02660098
026700         10  PV-RPT-MM               PIC  X(02)    VALUE SPACE.   02670098
026800         10  FILLER                  PIC  X(01)    VALUE '-'.     02680098
026900         10  PV-RPT-DD               PIC  X(02)    VALUE SPACE.   02690098
027000                                                                  02700098
027100     05  PV-RTV-CNTR                 PIC  9(02)    VALUE ZERO.    02710098
027200     05  PV-TMP-LOC-ID               PIC  9(04)    VALUE 9999.    02720098
027300*                                                                 02730098
027400***  TFRD INPUT REPORT FILE LAYOUT                                02740098
027500     COPY RVRD061.                                                02750098
027600**--------------------------------------------------------------**02760098
027700** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02770098
027800** SUB-ROUTINE (DPKUT100).                                      **02780098
027900**--------------------------------------------------------------**02790098
028000     COPY DPWS010I.                                               02800098
028100                                                                  02810098
028200***STANDARD KOHLS HEADING FOR 132 BYTE REPORT                     02820098
028300     COPY DPWS132O.                                               02830098
028400**--------------------------------------------------------------**02840098
028500                                                                  02850098
028600***  DATE ROUTINE COPYBOOK                                        02860098
028700***PARAMETER LIST FOR THE CALENDAR ROUTINE                        02870098
028800     COPY DPWS500.                                                02880098
028900                                                                  02890098
029000***  DB2 ABEND COPYBOOK                                           02900098
029100     COPY DPWS004.                                                02910098
029200                                                                  02920098
029300     EXEC SQL                                                     02930098
029400         INCLUDE SQLCA                                            02940098
029500     END-EXEC.                                                    02950098
029600                                                                  02960098
029700     COPY SQLCA2.                                                 02970098
029800                                                                  02980098
029900*---------------------------------------------------------------* 02990098
030000*    TCOCNTL TABLE                                              * 03000098
030100*---------------------------------------------------------------* 03010098
030200     EXEC SQL                                                     03020098
030300         INCLUDE TCOCNTL                                          03030098
030400     END-EXEC.                                                    03040098
030500                                                                  03050098
030600*---------------------------------------------------------------* 03060098
030700*    DCLGEN FOR THE LOGISTICS LOCATION TABLE                    * 03070098
030800*---------------------------------------------------------------* 03080098
030900     EXEC SQL                                                     03090098
031000         INCLUDE XLT00010                                         03100098
031100     END-EXEC.                                                    03110098
031200                                                                  03120098
031300*---------------------------------------------------------------* 03130098
031400*    DCLGEN FOR THE TKRPRPM TABLE                               * 03140098
031500*---------------------------------------------------------------* 03150098
031501     EXEC SQL                                                     03150198
031502         INCLUDE TKRPRPM                                          03150298
031503     END-EXEC.                                                    03150398
031504*                                                                 03150498
031505*---------------------------------------------------------------* 03150598
031506*   CURSOR USED TO RETRIVE RTV LOCATION FROM TKRPRPM TABLE      * 03150698
031507*---------------------------------------------------------------* 03150798
031508     EXEC SQL                                                     03150898
031509          DECLARE    RTV-CSR CURSOR FOR                           03150998
031510           SELECT    LOC_ID                                       03151098
031520              FROM   TKRPRPM                                      03152098
031530              WHERE  INTFC_SYS_CDE      = 'KHL'                   03153098
031540              AND    SYS_PRC_FUNC_CDE   = 'VRTVLC'                03154098
031550              AND    FUNC_PRC_STAT_CDE  = 'AC'                    03155098
031560           ORDER BY  LOC_ID                                       03156098
031570           WITH UR                                                03157098
031580     END-EXEC.                                                    03158098
031590                                                                  03159098
031600 LINKAGE SECTION.                                                 03160098
031700                                                                  03170098
031800 PROCEDURE DIVISION.                                              03180098
031900***************************************************************** 03190098
032000*  MAINLINE LOGIC FOR PROGRAM                                     03200098
032100***************************************************************** 03210098
032200 0000-MAINLINE.                                                   03220098
032210                                                                  03221098
032300     PERFORM 1000-INITIALIZE.                                     03230098
032400                                                                  03240098
032500     PERFORM 2000-PROCESS-RPT-FILE                                03250098
032600         UNTIL PS-END-RPT-FILE.                                   03260098
032700                                                                  03270098
032800     PERFORM 9000-EOJ.                                            03280098
032900                                                                  03290098
033000     GOBACK.                                                      03300098
033100                                                                  03310098
033200***************************************************************** 03320098
033300*  INITIALIZATION PARAGRAPH                                       03330098
033400***************************************************************** 03340098
033500 1000-INITIALIZE.                                                 03350098
033600     OPEN INPUT  TFRD-REPORT-FILE                                 03360098
033700          OUTPUT REPORT-FILE.                                     03370098
033800                                                                  03380098
033900     PERFORM 9550-SELECT-TCOCNTL.                                 03390098
034000                                                                  03400098
034010     DISPLAY 'VERSION OF PROGRAM WITH 20 OCCURRENCE TABLES'.      03401099
034100     DISPLAY 'COCNTL TABLE DATE  ====> ' COCNTL-BTCH-PRC-DTE.     03410098
034200                                                                  03420098
034300     PERFORM 1100-POPULATE-DATES.                                 03430098
034400                                                                  03440098
034500******* TIME IS CONTAINED CURRENT-DATE IN POSITION 9 FOR 9        03450098
034600     MOVE FUNCTION CURRENT-DATE(9:8) TO PV-RUN-TIME-CN.           03460098
034700                                                                  03470098
034800     DISPLAY '****** RUN TIME  => ' PV-RUN-TIME-CN.               03480098
034900                                                                  03490098
035000** GET CURRENT TIMESTAMP                                          03500098
035100                                                                  03510098
035200     EXEC SQL                                                     03520098
035300         SET :PV-CURRENT-TMST-DB2 = CURRENT TIMESTAMP             03530098
035400     END-EXEC.                                                    03540098
035500                                                                  03550098
035600     EVALUATE TRUE                                                03560098
035700         WHEN SQLCODE = ZERO                                      03570098
035800             MOVE PV-CURRENT-TMST-DB2    TO PV-CURRENT-TMST       03580098
035900             MOVE PV-CURR-DATE-CC        TO PV-CURR-CC            03590098
036000             MOVE PV-CURR-DATE-YY        TO PV-CURR-YY            03600098
036100                                                                  03610098
036200                                                                  03620098
036300         WHEN OTHER                                               03630098
036400             MOVE '1000-INITIALIZATION'  TO PV-PARAGRAPH          03640098
036500             MOVE 'SET CURRENT TIMESTAMP'                         03650098
036600                                         TO PV-DB2-FUNCTION       03660098
036700             PERFORM 9200-SQL-ERROR                               03670098
036800         END-EVALUATE.                                            03680098
036900                                                                  03690098
037000                                                                  03700098
037100     PERFORM 1110-POPULATE-LOC-TABLE.                             03710098
037200     PERFORM 1150-VALIDATE-LOC-PARM-TABLE.                        03720098
037300***  RESET INDEXES FOR NEXT LOC TABLE MATCH IN PARAGRAPH 7900.    03730098
037400     SET CC-IDX                TO 1.                              03740098
037500     SET HOLD-IDX              TO 1.                              03750098
037600                                                                  03760098
037700     SET PS-NOT-END-RPT-FILE                                      03770098
037800         PS-XLT00010-NOTFND TO TRUE.                              03780098
037900                                                                  03790098
038000     PERFORM 9500-READ-TFRD-REP-INPUT.                            03800098
038100     IF PS-NOT-END-RPT-FILE                                       03810098
038200         PERFORM 7800-CHECK-LOC-NBR                               03820098
038300     END-IF.                                                      03830098
038400                                                                  03840098
038500******************************************************************03850098
038600**  POPULATE DATES FROM TCOCNTL TABLE.                            03860098
038700******************************************************************03870098
038800 1100-POPULATE-DATES.                                             03880098
038900     MOVE COCNTL-BTCH-PRC-DTE  TO PV-RPT-DATE.                    03890098
039000     MOVE PV-RPT-CCYY          TO PV-DATE-CCYY.                   03900098
039100     MOVE PV-RPT-MM            TO PV-DATE-MM.                     03910098
039200     MOVE PV-RPT-DD            TO PV-DATE-DD.                     03920098
039300     MOVE PV-DATE              TO PV-RUN-DATE-CN.                 03930098
039400                                                                  03940098
039500******************************************************************03950098
039600**  POPULATE THE RTV LOCATION TABLE FROM TKRPRPM TABLE            03960098
039700******************************************************************03970098
039800 1110-POPULATE-LOC-TABLE.                                         03980098
039801                                                                  03980198
039802     PERFORM 1111-OPEN-RTV-CURSOR.                                03980298
039803                                                                  03980398
039804     MOVE 1        TO PV-RTV-CNTR.                                03980498
039805     SET  CC-IDX   TO 1.                                          03980598
039806                                                                  03980698
039807     PERFORM 1112-FETCH-RTV-CURSOR                                03980798
039808             UNTIL  PS-EOF-RTV-CSR.                               03980898
039809                                                                  03980998
039810     PERFORM 1113-CLOSE-RTV-CURSOR.                               03981098
039811                                                                  03981198
039812******************************************************************03981298
039813*    OPEN THE RTV-CSR CURSOR                                      03981398
039814******************************************************************03981498
039815 1111-OPEN-RTV-CURSOR.                                            03981598
039816                                                                  03981698
039817         EXEC SQL                                                 03981798
039818             OPEN RTV-CSR                                         03981898
039819         END-EXEC                                                 03981998
039820                                                                  03982098
039821     EVALUATE TRUE                                                03982198
039822                                                                  03982298
039823         WHEN SQLCODE = ZEROS                                     03982398
039824             CONTINUE                                             03982498
039825         WHEN OTHER                                               03982598
039826             MOVE '1111-OPEN-RTV-CURSOR'  TO PV-PARAGRAPH         03982698
039827             DISPLAY '** ABEND **'                                03982798
039828             DISPLAY '** PROGRAM = RVKUT022 **'                   03982898
039829             MOVE 'SELECT TKRPRPM'        TO PV-ERROR-MSG-1       03982998
039830             MOVE 'TKRPRPM'               TO PV-ABEND-TABLE-1     03983098
039831             PERFORM 9200-SQL-ERROR                               03983198
039832     END-EVALUATE.                                                03983298
039833                                                                  03983398
039834******************************************************************03983498
039835*    FETCH THE RTV-CSR CURSOR                                     03983598
039836******************************************************************03983698
039837 1112-FETCH-RTV-CURSOR.                                           03983798
039838                                                                  03983898
039839     EXEC SQL                                                     03983998
039840          FETCH RTV-CSR                                           03984098
039850           INTO :KRPRPM-LOC-ID                                    03985098
039851     END-EXEC.                                                    03985198
039852                                                                  03985298
039853     EVALUATE TRUE                                                03985398
039854                                                                  03985498
039855         WHEN SQLCODE = ZEROS                                     03985598
039856             MOVE PV-RTV-CNTR             TO CC-INDEX-NBR (CC-IDX)03985698
039857             MOVE KRPRPM-LOC-ID           TO CC-LOC (CC-IDX)      03985798
039858             ADD  1                       TO PV-RTV-CNTR          03985898
039859             SET  CC-IDX                  UP BY 1                 03985998
039860                                                                  03986098
039870         WHEN SQLCODE = +100                                      03987098
039871             SET  PS-EOF-RTV-CSR          TO TRUE                 03987198
039872             MOVE PV-RTV-CNTR             TO CC-INDEX-NBR (CC-IDX)03987298
039873             MOVE PV-TMP-LOC-ID           TO CC-LOC (CC-IDX)      03987398
039874             MOVE 1                       TO PV-RTV-CNTR          03987498
039875             SET  CC-IDX                  TO 1                    03987598
039876                                                                  03987698
039877         WHEN OTHER                                               03987798
039878             MOVE '1112-FETCH-RTV-CURSOR' TO PV-PARAGRAPH         03987898
039879             DISPLAY '** ABEND **'                                03987998
039880             DISPLAY '** PROGRAM = RVKUT022 **'                   03988098
039890             MOVE 'FETCH  TKRPRPM'        TO PV-ERROR-MSG-1       03989098
039891             MOVE 'TKRPRPM'               TO PV-ABEND-TABLE-1     03989198
039892             PERFORM 9200-SQL-ERROR                               03989298
039893     END-EVALUATE.                                                03989398
039894                                                                  03989498
039895******************************************************************03989598
039896*    CLOSE THE RTV-CSR CURSOR                                     03989698
039897******************************************************************03989798
039898 1113-CLOSE-RTV-CURSOR.                                           03989898
039899                                                                  03989998
039900         EXEC SQL                                                 03990098
039901             CLOSE RTV-CSR                                        03990198
039902         END-EXEC                                                 03990298
039903                                                                  03990398
039904     EVALUATE TRUE                                                03990498
039905                                                                  03990598
039906         WHEN SQLCODE = ZEROS                                     03990698
039907             CONTINUE                                             03990798
039908         WHEN OTHER                                               03990898
039909             MOVE '1113-CLOSE-RTV-CURSOR' TO PV-PARAGRAPH         03990998
039910             DISPLAY '** ABEND **'                                03991098
039911             DISPLAY '** PROGRAM = RVKUT022 **'                   03991198
039912             MOVE 'CLOSE  TKRPRPM'        TO PV-ERROR-MSG-1       03991298
039913             MOVE 'TKRPRPM'               TO PV-ABEND-TABLE-1     03991398
039914             PERFORM 9200-SQL-ERROR                               03991498
039915     END-EVALUATE.                                                03991598
039916                                                                  03991698
039917******************************************************************03991798
039918**  VALIDATE THE LOC NUMBER ORDER.                                03991898
039919******************************************************************03991998
039920 1150-VALIDATE-LOC-PARM-TABLE.                                    03992098
039930     SET CC-IDX                TO 1.                              03993098
039940     SET HOLD-IDX              TO 1.                              03994098
039950     MOVE +0                   TO PH-LOC (CC-IDX).                03995098
039960     IF CC-LOC (CC-IDX) IS NUMERIC                                03996098
039970         PERFORM 1160-VALIDATE-LOC-ORDER                          03997098
039980                 VARYING CC-IDX FROM 1 BY 1                       03998098
039990                  UNTIL CC-IDX > 20 OR                            03999098
040000                         CC-LOC (CC-IDX) = 9999                   04000098
040100     ELSE                                                         04010098
040200         DISPLAY '** ABEND **'                                    04020098
040300         DISPLAY '** PARAGRAPH '                                  04030098
040400                 '= 1150-VALIDATE-LOC-PARM-TABLE   **'            04040098
040500         DISPLAY '** INVALID LOC NBR IN PARM TABLE   **'          04050098
040600         MOVE +4003 TO PV-ABEND-CODE                              04060098
040700         CALL 'ILBOABN0' USING PV-ABEND-CODE                      04070098
040800     END-IF.                                                      04080098
040900                                                                  04090098
041000 1160-VALIDATE-LOC-ORDER.                                         04100098
041100     IF (CC-LOC (CC-IDX) = PH-LOC (HOLD-IDX)) OR                  04110098
041200        (CC-LOC (CC-IDX) < PH-LOC (HOLD-IDX))                     04120098
041300         DISPLAY '** ABEND **'                                    04130098
041400         DISPLAY '** PARAGRAPH '                                  04140098
041500                 '= 1160-VALIDATE-LOC-ORDER **'                   04150098
041600         DISPLAY '** INVALID LOC NBR IN PARM TABLE   **'          04160098
041700         MOVE +4003 TO PV-ABEND-CODE                              04170098
041800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      04180098
041900     END-IF.                                                      04190098
042000     SET HOLD-IDX              UP BY  1.                          04200098
042100     MOVE CC-LOC (CC-IDX)      TO PH-LOC (HOLD-IDX).              04210098
042200                                                                  04220098
042300******************************************************************04230098
042400**  INITIALIZE HOLD TOTALS FOR EACH NEW LOC NBR.                  04240098
042500*   DO NOT INITIALIZE FINAL TOTALS                                04250098
042600******************************************************************04260098
042700 1200-INITIALIZE-HOLD-TOTALS.                                     04270098
042800     MOVE +0       TO   PH-A-DEFDAM-SORT1-TOT                     04280098
042900                        PH-A-DEFDAM-SORT2-TOT                     04290098
043000                        PH-A-CALLBACK-TOT                         04300098
043100                        PH-A-COMBINE-TOT                          04310098
043200                        PH-D-DEFDAM-SORT1-TOT                     04320098
043300                        PH-D-DEFDAM-SORT2-TOT                     04330098
043400                        PH-D-CALLBACK-TOT                         04340098
043500                        PH-D-COMBINE-TOT                          04350098
043600                        PH-G-COMBINE-TOT.                         04360098
043700                                                                  04370098
043800***************************************************************** 04380098
043900* PROCESS DATA FROM DAILY TRANSFER REPORT FILE. CREATE REPORT.    04390098
044000***************************************************************** 04400098
044100 2000-PROCESS-RPT-FILE.                                           04410098
044200                                                                  04420098
044300     PERFORM 7700-SUM-REPORT-RECORDS.                             04430098
044400                                                                  04440098
044500     PERFORM 9500-READ-TFRD-REP-INPUT.                            04450098
044600     PERFORM 7800-CHECK-LOC-NBR.                                  04460098
044700                                                                  04470098
044800******************************************************************04480098
044900*  SUM DETAIL REPORT RECORDS                                      04490098
045000******************************************************************04500098
045100 7700-SUM-REPORT-RECORDS.                                         04510098
045200                                                                  04520098
045300* TOTAL D&D TYPE CODE - ADD                                       04530098
045400     IF RV061-TRANSFER-TYPE = 'A' AND                             04540098
045500        RV061-ACD-INDICATOR = 'A'                                 04550098
045600           ADD RV061-EXTENDED-RETAIL TO PH-A-DEFDAM-SORT1-TOT     04560098
045700                                        PH-A-COMBINE-TOT          04570098
045800                                        PH-G-COMBINE-TOT          04580098
045900                                        PH-FA-DEFDAM-SORT1-TOT    04590098
046000                                        PH-FA-COMBINE-TOT         04600098
046100                                        PH-FG-COMBINE-TOT         04610098
046200     END-IF.                                                      04620098
046300* TOTAL RTV TYPE CODE - ADD                                       04630098
046400     IF RV061-TRANSFER-TYPE = 'B' AND                             04640098
046500        RV061-ACD-INDICATOR = 'A'                                 04650098
046600           ADD RV061-EXTENDED-RETAIL TO PH-A-DEFDAM-SORT2-TOT     04660098
046700                                        PH-A-COMBINE-TOT          04670098
046800                                        PH-G-COMBINE-TOT          04680098
046900                                        PH-FA-DEFDAM-SORT2-TOT    04690098
047000                                        PH-FA-COMBINE-TOT         04700098
047100                                        PH-FG-COMBINE-TOT         04710098
047200     END-IF.                                                      04720098
047300* TOTAL CALLBACK TYPE CODE - ADD                                  04730098
047400     IF RV061-TRANSFER-TYPE = 'C' AND                             04740098
047500        RV061-ACD-INDICATOR = 'A'                                 04750098
047600           ADD RV061-EXTENDED-RETAIL TO PH-A-CALLBACK-TOT         04760098
047700                                        PH-A-COMBINE-TOT          04770098
047800                                        PH-G-COMBINE-TOT          04780098
047900                                        PH-FA-CALLBACK-TOT        04790098
048000                                        PH-FA-COMBINE-TOT         04800098
048100                                        PH-FG-COMBINE-TOT         04810098
048200     END-IF.                                                      04820098
048300* TOTAL D&D TYPE CODE - DELETE                                    04830098
048400     IF RV061-TRANSFER-TYPE = 'A' AND                             04840098
048500        RV061-ACD-INDICATOR = 'D'                                 04850098
048600           ADD RV061-EXTENDED-RETAIL TO PH-D-DEFDAM-SORT1-TOT     04860098
048700                                        PH-D-COMBINE-TOT          04870098
048800                                        PH-G-COMBINE-TOT          04880098
048900                                        PH-FD-DEFDAM-SORT1-TOT    04890098
049000                                        PH-FD-COMBINE-TOT         04900098
049100                                        PH-FG-COMBINE-TOT         04910098
049200     END-IF.                                                      04920098
049300* TOTAL RTV TYPE CODE - DELETE                                    04930098
049400     IF RV061-TRANSFER-TYPE = 'B' AND                             04940098
049500        RV061-ACD-INDICATOR = 'D'                                 04950098
049600           ADD RV061-EXTENDED-RETAIL TO PH-D-DEFDAM-SORT2-TOT     04960098
049700                                        PH-D-COMBINE-TOT          04970098
049800                                        PH-G-COMBINE-TOT          04980098
049900                                        PH-FD-DEFDAM-SORT2-TOT    04990098
050000                                        PH-FD-COMBINE-TOT         05000098
050100                                        PH-FG-COMBINE-TOT         05010098
050200     END-IF.                                                      05020098
050300* TOTAL CALLBACK TYPE CODE - DELETE                               05030098
050400     IF RV061-TRANSFER-TYPE = 'C' AND                             05040098
050500        RV061-ACD-INDICATOR = 'D'                                 05050098
050600           ADD RV061-EXTENDED-RETAIL TO PH-D-CALLBACK-TOT         05060098
050700                                        PH-D-COMBINE-TOT          05070098
050800                                        PH-G-COMBINE-TOT          05080098
050900                                        PH-FD-CALLBACK-TOT        05090098
051000                                        PH-FD-COMBINE-TOT         05100098
051100                                        PH-FG-COMBINE-TOT         05110098
051200     END-IF.                                                      05120098
051300                                                                  05130098
051400******************************************************************05140098
051500*  CHECK IF LOC NBR CHANGED.                                      05150098
051600******************************************************************05160098
051700 7800-CHECK-LOC-NBR.                                              05170098
051800     IF PS-NOT-END-RPT-FILE                                       05180098
051900         IF ((RV061-TO-LOC-NBR IS NUMERIC AND                     05190098
052000              RV061-TO-LOC-NBR IS NOT EQUAL TO PH-LOC-NBR) AND    05200098
052100             (PV-RPT-RECS-READ IS GREATER THAN +1))               05210098
052200             PERFORM 7900-CHECK-FOR-NO-MATCH-LOC                  05220098
052300             MOVE PH-LOC-NBR   TO PV-KEY-LOC-NBR                  05230098
052400             PERFORM 9600-READ-XLT00010                           05240098
052500             PERFORM 8500-WRITE-LOC-NBR-REPORT                    05250098
052600             PERFORM 1200-INITIALIZE-HOLD-TOTALS                  05260098
052700         END-IF                                                   05270098
052800     ELSE                                                         05280098
052900     IF PS-END-RPT-FILE                                           05290098
053000         PERFORM 7900-CHECK-FOR-NO-MATCH-LOC                      05300098
053100         MOVE PH-LOC-NBR       TO PV-KEY-LOC-NBR                  05310098
053200         PERFORM 9600-READ-XLT00010                               05320098
053300     END-IF.                                                      05330098
053400                                                                  05340098
053500     IF PS-NOT-END-RPT-FILE                                       05350098
053600         MOVE RV061-TO-LOC-NBR TO PH-LOC-NBR                      05360098
053700         MOVE RV061-BATCH-NBR  TO PH-BATCH-NBR                    05370098
053800     END-IF.                                                      05380098
053900                                                                  05390098
054000***************************************************************** 05400098
054100*  MATCH LOC CONTROL CARD TABLE TO HOLDING PH-LOC-NBR.            05410098
054200*  IF THERE IS NO MATCH TO LOC CONTROL CARD, WRITE EMPTY REPORT.  05420098
054300***************************************************************** 05430098
054400 7900-CHECK-FOR-NO-MATCH-LOC.                                     05440098
054500     PERFORM 7950-GET-NAME-FOR-EMPTY-FILE                         05450098
054600         VARYING CC-IDX FROM HOLD-IDX BY 1                        05460098
054700           UNTIL CC-LOC (CC-IDX) = PH-LOC-NBR OR                  05470098
054800                 CC-LOC (CC-IDX) = 9999                           05480098
054900         SET HOLD-IDX              UP BY  1.                      05490098
055000                                                                  05500098
055100 7950-GET-NAME-FOR-EMPTY-FILE.                                    05510098
055200     MOVE CC-LOC (CC-IDX)      TO PV-KEY-LOC-NBR.                 05520098
055300     PERFORM 9600-READ-XLT00010.                                  05530098
055400     PERFORM 8775-WRITE-EMPTY-FILE.                               05540098
055500                                                                  05550098
055600***************************************************************** 05560098
055700*  WRITE EACH NEW REPORT BASED ON EACH LOC NBR.                   05570098
055800***************************************************************** 05580098
055900 8500-WRITE-LOC-NBR-REPORT.                                       05590098
056000     PERFORM 8600-WRITE-HEADING-LINES.                            05600098
056100     PERFORM 8700-WRITE-TRANS-TOTAL-LINES.                        05610098
056200     PERFORM 8800-WRITE-ADJ-TOTAL-LINES.                          05620098
056300     PERFORM 8900-WRITE-GRD-TOTAL-LINE.                           05630098
056400                                                                  05640098
056500***************************************************************** 05650098
056600*  WRITE FINAL REPORT TOTALING ALL LOC NBRS.                      05660098
056700***************************************************************** 05670098
056800 8550-WRITE-FINAL-LOC-NBR-REPRT.                                  05680098
056900     PERFORM 8650-WRITE-FINAL-HEADING-LINES.                      05690098
057000     PERFORM 8750-WRITE-FINAL-TRANS-TOTALS.                       05700098
057100     PERFORM 8850-WRITE-FINAL-ADJ-TOTALS.                         05710098
057200     PERFORM 8950-WRITE-FINAL-GRD-TOTAL.                          05720098
057300                                                                  05730098
057400***************************************************************** 05740098
057500*  WRITE HEADING LINES                                            05750098
057600***************************************************************** 05760098
057700 8600-WRITE-HEADING-LINES.                                        05770098
057800     INITIALIZE PC-REPORT-LINE-COUNTER.                           05780098
057900     ADD +1                       TO PC-PAGE-COUNTER.             05790098
058000     MOVE PC-PAGE-COUNTER         TO DP132O-PAGE-NUMBER.          05800098
058100     MOVE PC-CURRENT-PGM-RVKRP026 TO DP132O-PROGRAM-NAME.         05810098
058200     MOVE PV-REPORT-NUMBER        TO DP132O-REPORT-NUMBER.        05820098
058300     MOVE PV-CURR-DATE-YY         TO DP132O-RUN-YEAR.             05830098
058400     MOVE PV-CURR-DATE-MM         TO DP132O-RUN-MONTH.            05840098
058500     MOVE PV-CURR-DATE-DD         TO DP132O-RUN-DAY.              05850098
058600     MOVE PV-CURR-TIME-HH         TO DP132O-RUN-HOUR.             05860098
058700     MOVE PV-CURR-TIME-MM         TO DP132O-RUN-MINUTE.           05870098
058800     MOVE PV-RPT-DATE             TO HL4-REPORT-DATE.             05880098
058900     IF PH-BATCH-NBR IS NUMERIC                                   05890098
059000         MOVE PH-BATCH-NBR        TO HL5-BATCH-NBR                05900098
059100     ELSE                                                         05910098
059200         MOVE +0                  TO HL5-BATCH-NBR                05920098
059300     END-IF.                                                      05930098
059400     IF PH-LOC-NBR IS NUMERIC                                     05940098
059500         MOVE PH-LOC-NBR          TO HL5A-RTV-LOC-NBR             05950098
059600     ELSE                                                         05960098
059700         MOVE +0                  TO HL5A-RTV-LOC-NBR             05970098
059800     END-IF.                                                      05980098
059900     MOVE XLT00010-LOC-10-ABBR-NM TO HL5A-RTV-LOC-NM.             05990098
060000     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      06000098
060100                         AFTER ADVANCING PAGE.                    06010098
060200     WRITE REPORT-RECORD FROM HL-HEADER-LINE1                     06020098
060300                         AFTER ADVANCING 1 LINE.                  06030098
060400     WRITE REPORT-RECORD FROM HL-HEADER-LINE2                     06040098
060500                         AFTER ADVANCING 1 LINE.                  06050098
060600     WRITE REPORT-RECORD FROM HL-HEADER-LINE3                     06060098
060700                         AFTER ADVANCING 1 LINE.                  06070098
060800     WRITE REPORT-RECORD FROM HL-HEADER-LINE5A                    06080098
060900                         AFTER ADVANCING 1 LINE.                  06090098
061000     WRITE REPORT-RECORD FROM HL-HEADER-LINE4                     06100098
061100                         AFTER ADVANCING 2 LINES.                 06110098
061200     WRITE REPORT-RECORD FROM HL-HEADER-LINE5                     06120098
061300                         AFTER ADVANCING 1 LINE.                  06130098
061400     WRITE REPORT-RECORD FROM HL-HEADER-LINE6                     06140098
061500                         AFTER ADVANCING 3 LINES.                 06150098
061600     WRITE REPORT-RECORD FROM HL-HEADER-LINE7                     06160098
061700                         AFTER ADVANCING 2 LINES.                 06170098
061800     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              06180098
061900                         AFTER ADVANCING 1 LINE.                  06190098
062000                                                                  06200098
062100***************************************************************** 06210098
062200*  WRITE FINAL HEADING LINES                                      06220098
062300***************************************************************** 06230098
062400 8650-WRITE-FINAL-HEADING-LINES.                                  06240098
062500     INITIALIZE PC-REPORT-LINE-COUNTER.                           06250098
062600     ADD +1                       TO PC-PAGE-COUNTER.             06260098
062700     MOVE PC-PAGE-COUNTER         TO DP132O-PAGE-NUMBER.          06270098
062800     MOVE PC-CURRENT-PGM-RVKRP026 TO DP132O-PROGRAM-NAME.         06280098
062900     MOVE PV-REPORT-NUMBER        TO DP132O-REPORT-NUMBER.        06290098
063000     MOVE PV-CURR-DATE-YY         TO DP132O-RUN-YEAR.             06300098
063100     MOVE PV-CURR-DATE-MM         TO DP132O-RUN-MONTH.            06310098
063200     MOVE PV-CURR-DATE-DD         TO DP132O-RUN-DAY.              06320098
063300     MOVE PV-CURR-TIME-HH         TO DP132O-RUN-HOUR.             06330098
063400     MOVE PV-CURR-TIME-MM         TO DP132O-RUN-MINUTE.           06340098
063500     MOVE PV-RPT-DATE             TO HL4-REPORT-DATE.             06350098
063600     IF PH-BATCH-NBR IS NUMERIC                                   06360098
063700         MOVE PH-BATCH-NBR        TO HL5-BATCH-NBR                06370098
063800     ELSE                                                         06380098
063900         MOVE +0                  TO HL5-BATCH-NBR                06390098
064000     END-IF.                                                      06400098
064100     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      06410098
064200                         AFTER ADVANCING PAGE.                    06420098
064300     WRITE REPORT-RECORD FROM HL-HEADER-LINE1                     06430098
064400                         AFTER ADVANCING 1 LINE.                  06440098
064500     WRITE REPORT-RECORD FROM HL-HEADER-LINE2                     06450098
064600                         AFTER ADVANCING 1 LINE.                  06460098
064700     WRITE REPORT-RECORD FROM HL-HEADER-LINE3                     06470098
064800                         AFTER ADVANCING 1 LINE.                  06480098
064900     WRITE REPORT-RECORD FROM HL-HEADER-LINE5B                    06490098
065000                         AFTER ADVANCING 1 LINE.                  06500098
065100     WRITE REPORT-RECORD FROM HL-HEADER-LINE4                     06510098
065200                         AFTER ADVANCING 2 LINES.                 06520098
065300     WRITE REPORT-RECORD FROM HL-HEADER-LINE5                     06530098
065400                         AFTER ADVANCING 1 LINE.                  06540098
065500     WRITE REPORT-RECORD FROM HL-HEADER-LINE6                     06550098
065600                         AFTER ADVANCING 3 LINES.                 06560098
065700     WRITE REPORT-RECORD FROM HL-HEADER-LINE7                     06570098
065800                         AFTER ADVANCING 2 LINES.                 06580098
065900     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              06590098
066000                         AFTER ADVANCING 1 LINE.                  06600098
066100                                                                  06610098
066200***************************************************************** 06620098
066300*  WRITE TRANSFER TOTAL LINES                                     06630098
066400***************************************************************** 06640098
066500 8700-WRITE-TRANS-TOTAL-LINES.                                    06650098
066600     MOVE PC-CALLBACK             TO DL1-TRANSFER-TYPE.           06660098
066700     MOVE PH-A-CALLBACK-TOT       TO DL1-TOTAL-RETAIL.            06670098
066800     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06680098
066900                         AFTER ADVANCING 1 LINE.                  06690098
067000     MOVE PC-DEFDAM-SORT1         TO DL1-TRANSFER-TYPE.           06700098
067100     MOVE PH-A-DEFDAM-SORT1-TOT   TO DL1-TOTAL-RETAIL.            06710098
067200     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06720098
067300                         AFTER ADVANCING 1 LINE.                  06730098
067400     MOVE PC-DEFDAM-SORT2         TO DL1-TRANSFER-TYPE.           06740098
067500     MOVE PH-A-DEFDAM-SORT2-TOT   TO DL1-TOTAL-RETAIL.            06750098
067600     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06760098
067700                         AFTER ADVANCING 1 LINE.                  06770098
067800     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              06780098
067900                         AFTER ADVANCING 1 LINE.                  06790098
068000     MOVE PC-TOTAL                TO DL1-TRANSFER-TYPE.           06800098
068100     MOVE PH-A-COMBINE-TOT        TO DL1-TOTAL-RETAIL.            06810098
068200     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06820098
068300                         AFTER ADVANCING 1 LINE.                  06830098
068400                                                                  06840098
068500***************************************************************** 06850098
068600*  WRITE FINAL TRANSFER TOTAL LINES                               06860098
068700***************************************************************** 06870098
068800 8750-WRITE-FINAL-TRANS-TOTALS.                                   06880098
068900     MOVE PC-CALLBACK             TO DL1-TRANSFER-TYPE.           06890098
069000     MOVE PH-FA-CALLBACK-TOT      TO DL1-TOTAL-RETAIL.            06900098
069100     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06910098
069200                         AFTER ADVANCING 1 LINE.                  06920098
069300     MOVE PC-DEFDAM-SORT1         TO DL1-TRANSFER-TYPE.           06930098
069400     MOVE PH-FA-DEFDAM-SORT1-TOT  TO DL1-TOTAL-RETAIL.            06940098
069500     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06950098
069600                         AFTER ADVANCING 1 LINE.                  06960098
069700     MOVE PC-DEFDAM-SORT2         TO DL1-TRANSFER-TYPE.           06970098
069800     MOVE PH-FA-DEFDAM-SORT2-TOT  TO DL1-TOTAL-RETAIL.            06980098
069900     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      06990098
070000                         AFTER ADVANCING 1 LINE.                  07000098
070100     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              07010098
070200                         AFTER ADVANCING 1 LINE.                  07020098
070300     MOVE PC-TOTAL                TO DL1-TRANSFER-TYPE.           07030098
070400     MOVE PH-FA-COMBINE-TOT       TO DL1-TOTAL-RETAIL.            07040098
070500     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07050098
070600                         AFTER ADVANCING 1 LINE.                  07060098
070700                                                                  07070098
070800***************************************************************** 07080098
070900*  WRITE EMPTY FILE MESSAGE                                       07090098
071000***************************************************************** 07100098
071100 8775-WRITE-EMPTY-FILE.                                           07110098
071200     INITIALIZE PC-REPORT-LINE-COUNTER.                           07120098
071300     ADD +1                       TO PC-PAGE-COUNTER.             07130098
071400     MOVE PC-PAGE-COUNTER         TO DP132O-PAGE-NUMBER.          07140098
071500     MOVE PC-CURRENT-PGM-RVKRP026 TO DP132O-PROGRAM-NAME.         07150098
071600     MOVE PV-REPORT-NUMBER        TO DP132O-REPORT-NUMBER.        07160098
071700     MOVE PV-CURR-DATE-YY         TO DP132O-RUN-YEAR.             07170098
071800     MOVE PV-CURR-DATE-MM         TO DP132O-RUN-MONTH.            07180098
071900     MOVE PV-CURR-DATE-DD         TO DP132O-RUN-DAY.              07190098
072000     MOVE PV-CURR-TIME-HH         TO DP132O-RUN-HOUR.             07200098
072100     MOVE PV-CURR-TIME-MM         TO DP132O-RUN-MINUTE.           07210098
072200     MOVE PV-RPT-DATE             TO HL4-REPORT-DATE.             07220098
072300     MOVE +0                      TO HL5-BATCH-NBR.               07230098
072400     IF (CC-LOC (CC-IDX)) NUMERIC AND                             07240098
072500        (CC-LOC (CC-IDX)) IS NOT EQUAL TO 9999                    07250098
072600         MOVE CC-LOC (CC-IDX)     TO HL5A-RTV-LOC-NBR             07260098
072700     ELSE                                                         07270098
072800         MOVE +0                  TO HL5A-RTV-LOC-NBR             07280098
072900     END-IF.                                                      07290098
073000     MOVE XLT00010-LOC-10-ABBR-NM TO HL5A-RTV-LOC-NM.             07300098
073100     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      07310098
073200                         AFTER ADVANCING PAGE.                    07320098
073300     WRITE REPORT-RECORD FROM HL-HEADER-LINE1                     07330098
073400                         AFTER ADVANCING 1 LINE.                  07340098
073500     WRITE REPORT-RECORD FROM HL-HEADER-LINE2                     07350098
073600                         AFTER ADVANCING 1 LINE.                  07360098
073700     WRITE REPORT-RECORD FROM HL-HEADER-LINE3                     07370098
073800                         AFTER ADVANCING 1 LINE.                  07380098
073900     WRITE REPORT-RECORD FROM HL-HEADER-LINE5A                    07390098
074000                         AFTER ADVANCING 1 LINE.                  07400098
074100     WRITE REPORT-RECORD FROM HL-HEADER-LINE4                     07410098
074200                         AFTER ADVANCING 2 LINES.                 07420098
074300     WRITE REPORT-RECORD FROM HL-HEADER-LINE5                     07430098
074400                         AFTER ADVANCING 1 LINE.                  07440098
074500     WRITE REPORT-RECORD FROM DL-EMPTY-LINE1                      07450098
074600                         AFTER ADVANCING 3 LINES.                 07460098
074700                                                                  07470098
074800***************************************************************** 07480098
074900*  WRITE ADJUSTMENT TOTAL LINES                                   07490098
075000***************************************************************** 07500098
075100 8800-WRITE-ADJ-TOTAL-LINES.                                      07510098
075200     WRITE REPORT-RECORD FROM HL-HEADER-LINE8                     07520098
075300                         AFTER ADVANCING 3 LINES.                 07530098
075400     WRITE REPORT-RECORD FROM HL-HEADER-LINE9                     07540098
075500                         AFTER ADVANCING 2 LINES.                 07550098
075600     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              07560098
075700                         AFTER ADVANCING 1 LINE.                  07570098
075800     MOVE PC-CALLBACK             TO DL1-TRANSFER-TYPE.           07580098
075900     MOVE PH-D-CALLBACK-TOT       TO DL1-TOTAL-RETAIL.            07590098
076000     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07600098
076100                         AFTER ADVANCING 1 LINE.                  07610098
076200     MOVE PC-DEFDAM-SORT1         TO DL1-TRANSFER-TYPE.           07620098
076300     MOVE PH-D-DEFDAM-SORT1-TOT   TO DL1-TOTAL-RETAIL.            07630098
076400     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07640098
076500                         AFTER ADVANCING 1 LINE.                  07650098
076600     MOVE PC-DEFDAM-SORT2         TO DL1-TRANSFER-TYPE.           07660098
076700     MOVE PH-D-DEFDAM-SORT2-TOT   TO DL1-TOTAL-RETAIL.            07670098
076800     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07680098
076900                         AFTER ADVANCING 1 LINE.                  07690098
077000     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              07700098
077100                         AFTER ADVANCING 1 LINE.                  07710098
077200     MOVE PC-TOTAL                TO DL1-TRANSFER-TYPE.           07720098
077300     MOVE PH-D-COMBINE-TOT        TO DL1-TOTAL-RETAIL.            07730098
077400     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07740098
077500                         AFTER ADVANCING 1 LINE.                  07750098
077600                                                                  07760098
077700***************************************************************** 07770098
077800*  WRITE FINAL ADJUSTMENT TOTAL LINES                             07780098
077900***************************************************************** 07790098
078000 8850-WRITE-FINAL-ADJ-TOTALS.                                     07800098
078100     WRITE REPORT-RECORD FROM HL-HEADER-LINE8                     07810098
078200                         AFTER ADVANCING 3 LINES.                 07820098
078300     WRITE REPORT-RECORD FROM HL-HEADER-LINE9                     07830098
078400                         AFTER ADVANCING 2 LINES.                 07840098
078500     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              07850098
078600                         AFTER ADVANCING 1 LINE.                  07860098
078700     MOVE PC-CALLBACK             TO DL1-TRANSFER-TYPE.           07870098
078800     MOVE PH-FD-CALLBACK-TOT      TO DL1-TOTAL-RETAIL.            07880098
078900     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07890098
079000                         AFTER ADVANCING 1 LINE.                  07900098
079100     MOVE PC-DEFDAM-SORT1         TO DL1-TRANSFER-TYPE.           07910098
079200     MOVE PH-FD-DEFDAM-SORT1-TOT  TO DL1-TOTAL-RETAIL.            07920098
079300     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07930098
079400                         AFTER ADVANCING 1 LINE.                  07940098
079500     MOVE PC-DEFDAM-SORT2         TO DL1-TRANSFER-TYPE.           07950098
079600     MOVE PH-FD-DEFDAM-SORT2-TOT  TO DL1-TOTAL-RETAIL.            07960098
079700     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      07970098
079800                         AFTER ADVANCING 1 LINE.                  07980098
079900     WRITE REPORT-RECORD FROM HL-DOTTED-HEADER-LINE1              07990098
080000                         AFTER ADVANCING 1 LINE.                  08000098
080100     MOVE PC-TOTAL                TO DL1-TRANSFER-TYPE.           08010098
080200     MOVE PH-FD-COMBINE-TOT       TO DL1-TOTAL-RETAIL.            08020098
080300     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      08030098
080400                         AFTER ADVANCING 1 LINE.                  08040098
080500                                                                  08050098
080600***************************************************************** 08060098
080700*  WRITE GRAND TOTAL LINE                                         08070098
080800***************************************************************** 08080098
080900 8900-WRITE-GRD-TOTAL-LINE.                                       08090098
081000     MOVE PC-GTOTAL               TO DL1-TRANSFER-TYPE.           08100098
081100     MOVE PH-G-COMBINE-TOT        TO DL1-TOTAL-RETAIL.            08110098
081200     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      08120098
081300                         AFTER ADVANCING 2 LINES.                 08130098
081400                                                                  08140098
081500***************************************************************** 08150098
081600*  WRITE FINAL GRAND TOTAL LINE                                   08160098
081700***************************************************************** 08170098
081800 8950-WRITE-FINAL-GRD-TOTAL.                                      08180098
081900     MOVE PC-GTOTAL               TO DL1-TRANSFER-TYPE.           08190098
082000     MOVE PH-FG-COMBINE-TOT       TO DL1-TOTAL-RETAIL.            08200098
082100     WRITE REPORT-RECORD FROM DL-TOTAL-LINE1                      08210098
082200                         AFTER ADVANCING 2 LINES.                 08220098
082300                                                                  08230098
082400***************************************************************** 08240098
082500*  READ THE DAILY TRANSFER REPORT FILE                            08250098
082600***************************************************************** 08260098
082700 9500-READ-TFRD-REP-INPUT.                                        08270098
082800     READ TFRD-REPORT-FILE                                        08280098
082900         INTO RV061-TRNSFR-REPORT-RECORD                          08290098
083000            AT END                                                08300098
083100               SET PS-END-RPT-FILE                                08310098
083200                          TO TRUE.                                08320098
083300     IF PS-NOT-END-RPT-FILE                                       08330098
083400         ADD 1    TO PV-RPT-RECS-READ                             08340098
083500     END-IF.                                                      08350098
083600                                                                  08360098
083700******************************************************************08370098
083800*    READ THE CURRENT BATCH PROCESSING DATE FROM TCOCNTL          08380098
083900******************************************************************08390098
084000                                                                  08400098
084100 9550-SELECT-TCOCNTL.                                             08410098
084200                                                                  08420098
084300     EXEC SQL                                                     08430098
084400        SELECT  A.BTCH_PRC_DTE                                    08440098
084500          INTO :COCNTL-BTCH-PRC-DTE                               08450098
084600          FROM  TCOCNTL A                                         08460098
084700          WHERE A.OPER_UNT_ID   =  90                             08470098
084800     END-EXEC.                                                    08480098
084900                                                                  08490098
085000     EVALUATE TRUE                                                08500098
085100                                                                  08510098
085200         WHEN SQLCODE = ZEROS                                     08520098
085300             CONTINUE                                             08530098
085400         WHEN OTHER                                               08540098
085500             MOVE '9550-SELECT-TCOCNTL'  TO PV-PARAGRAPH          08550098
085600             DISPLAY '** ABEND **'                                08560098
085700             DISPLAY '** PROGRAM = RVKUT022 **'                   08570098
085800             MOVE 'SELECT TCOCNTL'       TO PV-ERROR-MSG-1        08580098
085900             MOVE 'TCOCNTL'              TO PV-ABEND-TABLE-1      08590098
086000             PERFORM 9200-SQL-ERROR                               08600098
086100     END-EVALUATE.                                                08610098
086200                                                                  08620098
086300******************************************************************08630098
086400*  READ XLT00010 - XLT_LOC TABLE.                                 08640098
086500******************************************************************08650098
086600 9600-READ-XLT00010.                                              08660098
086700     INITIALIZE DCLXLT00010.                                      08670098
086800     SET PS-XLT00010-NOTFND        TO TRUE.                       08680098
086900                                                                  08690098
087000     PERFORM                                                      08700098
087100         WITH TEST AFTER                                          08710098
087200         VARYING PV-RETRY-COUNTER                                 08720098
087300         FROM 1 BY 1                                              08730098
087400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08740098
087500                   OR (SQLCODE = ZERO)                            08750098
087600                   OR (SQLCODE = +100))                           08760098
087700         EXEC SQL                                                 08770098
087800              SELECT  LOC_10_ABBR_NM                              08780098
087900              INTO  :XLT00010-LOC-10-ABBR-NM:PV-NULL              08790098
088000              FROM XLT_LOC                                        08800098
088100              WHERE LOC_NBR = :PV-KEY-LOC-NBR                     08810098
088200         END-EXEC                                                 08820098
088300                                                                  08830098
088400         EVALUATE TRUE                                            08840098
088500             WHEN SQLCODE = ZERO                                  08850098
088600               IF PV-NULL < 0                                     08860098
088700                   MOVE SPACES TO XLT00010-LOC-10-ABBR-NM         08870098
088800               END-IF                                             08880098
088900             WHEN SQLCODE = -904                                  08890098
089000             WHEN SQLCODE = -911                                  08900098
089100             WHEN SQLCODE = -913                                  08910098
089200                 SET PS-XLT00010-FOUND TO TRUE                    08920098
089300             WHEN SQLCODE = +100                                  08930098
089400                 SET PS-XLT00010-NOTFND TO TRUE                   08940098
089500             WHEN SQLWARN0 NOT EQUAL SPACE                        08950098
089600             WHEN SQLCODE NOT EQUAL ZERO                          08960098
089700                 DISPLAY '** ABEND **'                            08970098
089800                 DISPLAY '** PROGRAM = RVKRP026 **'               08980098
089900                 DISPLAY '** PARAGRAPH = '                        08990098
090000                         '9600-READ-XLT00010 **'                  09000098
090100                 MOVE 'SELECT XLT_LOC'  TO PV-ERROR-MSG-1         09010098
090200                 MOVE PV-KEY-LOC-NBR            TO PV-LOC-NBR     09020098
090300                 MOVE 'XLT_LOC'       TO PV-ABEND-TABLE-1         09030098
090400                 PERFORM 9200-SQL-ERROR                           09040098
090500         END-EVALUATE                                             09050098
090600     END-PERFORM.                                                 09060098
090700                                                                  09070098
090800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09080098
090900         DISPLAY '** ABEND **'                                    09090098
091000         DISPLAY '** PROGRAM = RVKRP026 **'                       09100098
091100         DISPLAY '** PARAGRAPH = 9600-READ-XLT00010 **'           09110098
091200         MOVE 'SELECT MAX RETRIES'                                09120098
091300                                        TO PV-ERROR-MSG-1         09130098
091400         MOVE PV-KEY-LOC-NBR            TO PV-LOC-NBR             09140098
091500         MOVE 'XLT_LOC'                 TO PV-ABEND-TABLE-1       09150098
091600         PERFORM 9200-SQL-ERROR                                   09160098
091700     END-IF.                                                      09170098
091800                                                                  09180098
091900***************************************************************** 09190098
092000*  END OF JOB PROCESSING                                          09200098
092100***************************************************************** 09210098
092200 9000-EOJ.                                                        09220098
092300                                                                  09230098
092400     IF PV-RPT-RECS-READ = +0                                     09240098
092500***      NO RECORDS FOUND FOR ALL LOC - EMPTY FILE                09250098
092600         MOVE 9999        TO CC-LOC (CC-IDX)                      09260098
092700         PERFORM 8775-WRITE-EMPTY-FILE                            09270098
092800     ELSE                                                         09280098
092900         PERFORM 8500-WRITE-LOC-NBR-REPORT                        09290098
093000***      POSITION INDEX TO CAPTURE LAST TABLE LOC                 09300098
093100         SET CC-IDX                UP BY  1                       09310098
093200         SET HOLD-IDX              TO CC-INDEX-NBR (CC-IDX)       09320098
093300         IF CC-LOC (CC-IDX) IS NOT EQUAL TO 9999                  09330098
093400             PERFORM 7900-CHECK-FOR-NO-MATCH-LOC                  09340098
093500         END-IF                                                   09350098
093600         PERFORM 8550-WRITE-FINAL-LOC-NBR-REPRT                   09360098
093700     END-IF.                                                      09370098
093800                                                                  09380098
093900     DISPLAY PV-ASTERISK-LINE                                     09390098
094000     DISPLAY 'TFRD REPORT RECORDS READ   ===>  '                  09400098
094100              PV-RPT-RECS-READ.                                   09410098
094200                                                                  09420098
094300     CLOSE TFRD-REPORT-FILE                                       09430098
094400           REPORT-FILE.                                           09440098
094500                                                                  09450098
094600***************************************************************** 09460098
094700*  PARAGRAPH EXECUTED WHEN SERIOUS DB2 ERROR OCCURRED             09470098
094800***************************************************************** 09480098
094900 9200-SQL-ERROR.                                                  09490098
095000     CLOSE TFRD-REPORT-FILE                                       09500098
095100           REPORT-FILE.                                           09510098
095200                                                                  09520098
095300     MOVE SQLCODE                     TO SQLCODE2.                09530098
095400     MOVE SQLERRD(3)                  TO SQLERRD3.                09540098
095500                                                                  09550098
095600     DISPLAY '** ABEND **         ** = SQLERROR'.                 09560098
095700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PGM-RVKRP026.        09570098
095800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   09580098
095900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                09590098
096000     DISPLAY '** LOC NBR   ** = ' PV-LOC-NBR.                     09600098
096100     DISPLAY '**           ** = ' PV-ABEND-TABLE-1.               09610098
096200     DISPLAY '**           ** = ' PV-ABEND-TABLE-2.               09620098
096300     DISPLAY '**           ** = ' PV-ABEND-TABLE-3.               09630098
096400     DISPLAY '**           ** = ' PV-ABEND-TABLE-4.               09640098
096500     DISPLAY '**           ** = ' PV-ABEND-TABLE-5.               09650098
096600     DISPLAY '**           ** = ' PV-ERROR-MSG-1                  09660098
096700     DISPLAY '**           ** = ' PV-ERROR-MSG-2                  09670098
096800     DISPLAY '**           ** = ' PV-ERROR-MSG-3                  09680098
096900                                                                  09690098
097000     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                09700098
097100     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                09710098
097200     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 09720098
097300     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                09730098
097400                                                                  09740098
097500     COPY DPPD004.                                                09750098
097600                                                                  09760098
097700     MOVE +4013                       TO PV-ABEND-CODE.           09770098
097800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09780098
097900                                                                  09790098
098000*************  END OF RVKRP026  ********************************  09800098
