000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         XSKRP007.                                    00020000
000300 AUTHOR.             JIM LEIKNESS.                                00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       12-18-2002.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700*                                                                 00070000
000800 ENVIRONMENT DIVISION.                                            00080000
000900                                                                  00090000
001000 CONFIGURATION SECTION.                                           00100000
001100                                                                  00110000
001200 SOURCE-COMPUTER.    IBM-3090.                                    00120000
001300 OBJECT-COMPUTER.    IBM-3090.                                    00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT XST-INPUT-FILE       ASSIGN TO INP01.                 00190000
002000     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00200000
002100     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00210000
002200                                                                  00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  RMS-INPUT-FILE                                               00270000
002800     RECORDING MODE IS F                                          00280000
002900     BLOCK CONTAINS 0 RECORDS                                     00290000
003000     LABEL RECORDS ARE OMITTED.                                   00300000
003100 01  RMS-INPUT-RECORD                    PIC  X(44).              00310000
003200                                                                  00320000
003300 FD  XST-INPUT-FILE                                               00330000
003400     RECORDING MODE IS F                                          00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     LABEL RECORDS ARE OMITTED.                                   00360000
003700 01  XST-INPUT-RECORD                    PIC  X(37).              00370000
003800                                                                  00380000
003900 FD  ERROR-REPORT                                                 00390000
004000     RECORDING MODE IS F                                          00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     LABEL RECORDS ARE OMITTED.                                   00420000
004300 01  ERR-RPT-LINE                        PIC  X(200).             00430000
004400                                                                  00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700     COPY HORD007.                                                00470000
004800                                                                  00480000
005300     COPY DPWS150O.                                               00490000
005301                                                                  00500000
005310 01 XST-REC.                                                      00510000
005320     05 XST-STR-GP-TYP-CDE         PIC S9(04) COMP.               00520000
005330     05 XST-STR-GP-ID              PIC S9(04) COMP.               00530000
005340     05 XST-GP-NM                  PIC X(30) VALUE SPACE.         00531000
005341     05 XST-ST-CDE                 PIC X(02) VALUE SPACE.         00532000
005342     05 XST-RPT-FLSH-SLS-IND       PIC X(01) VALUE SPACE.         00533000
005350                                                                  00534000
005351 01 PC-PROGRAM-CONSTANTS.                                         00535000
005352     05 PC-PGM-NAME                PIC X(08)  VALUE 'XSKRP007'.   00535100
005353                                                                  00535200
005360 01 PV-PROGRAM-VARIABLES.                                         00535300
005370     05 PV-XST-KEY.                                               00535400
005380        10 PV-XST-STR-GP-TYP-CDE   PIC 9(04).                     00535500
005381        10 PV-XST-STR-GP-ID        PIC 9(04).                     00535600
005390     05 PV-XST-GP-NM               PIC X(30) VALUE SPACE.         00535700
005391     05 PV-XST-ST-CDE              PIC X(02) VALUE SPACE.         00535800
005392     05 PV-XST-RPT-FLSH-SLS-IND    PIC X(01) VALUE SPACE.         00535900
005400                                                                  00536000
005410     05 PV-RMS-KEY.                                               00537000
005420         10 PV-RMS-STR-GP-TYP-CDE  PIC 9(04).                     00538000
005421         10 PV-RMS-STR-GP-ID       PIC 9(04).                     00539000
005430     05 PV-RMS-GP-NM               PIC X(30) VALUE SPACE.         00540000
005431     05 PV-RMS-ST-CDE              PIC X(02) VALUE SPACE.         00541000
005432     05 PV-RMS-RPT-FLSH-SLS-IND    PIC X(01) VALUE SPACE.         00542000
005433                                                                  00543000
005440     05 PV-PAGE-CNT                PIC S9(05)  VALUE ZERO.        00544000
005450     05 PV-LINE-CNT                PIC S9(04)  COMP VALUE ZERO.   00545000
005460     05 PV-MAX-LINES               PIC S9(04)  COMP VALUE +71.    00546000
005470                                                                  00547000
005480     05 PV-DISPLAY-CNT             PIC ZZZZ9.                     00548000
005492     05 PV-NBR-ERRORS              PIC S9(04)  COMP               00549000
005493                                                VALUE ZERO.       00549100
005494     05 PV-DATE-YYMMDD.                                           00549200
005495          10 PV-YYMMDD-YY          PIC X(02)  VALUE SPACE.        00549300
005496          10 PV-YYMMDD-MM          PIC X(02)  VALUE SPACE.        00549400
005497          10 PV-YYMMDD-DD          PIC X(02)  VALUE SPACE.        00549500
005498     05 PV-TIME-HHMMSS.                                           00549600
005499          10 PV-HHMMSS-HH          PIC X(02)  VALUE SPACE.        00549700
005500          10 PV-HHMMSS-MM          PIC X(02)  VALUE SPACE.        00549800
005501          10 PV-HHMMSS-SS          PIC X(02)  VALUE SPACE.        00549900
005502     05 PV-MESSAGE                 PIC X(40)  VALUE SPACE.        00550000
005510                                                                  00551000
005530 01 RPT-TOTAL-LINE.                                               00552000
005540     05 FILLER     PIC  X(23) VALUE                               00553000
005550                         'TOTAL NUMBER OF ERRORS '.               00554000
005560     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00555000
005561                                                                  00556000
005562 01 RPT-END-OF-REPORT-LINE.                                       00556100
005563     05 FILLER     PIC  X(21) VALUE                               00556200
005564                            '*** END OF REPORT ***'.              00556300
005565 01 PA-PROGRAM-ACCUMULATORS.                                      00556400
005566     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              00556500
005567     05 PA-XST-RECS-READ       PIC 9(13) VALUE ZERO.              00556600
005568     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              00556700
005569                                                                  00556800
005571 01 PS-PROGRAM-SWITCHES.                                          00556900
005572     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557000
005573         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           00557100
005574         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           00557200
005575     05 PS-MORE-XST-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557300
005576         88 PS-MORE-XST-INPUT-RECS           VALUE 'Y'.           00557400
005577         88 PS-END-OF-XST-INPUT-RECS         VALUE 'N'.           00557500
005578     05 PS-RMS-OR-XST-ERR        PIC X(01)   VALUE '0'.           00557600
005579         88 PS-RMS-ERROR                     VALUE '1'.           00557700
005580         88 PS-XST-ERROR                     VALUE '2'.           00557800
005581         88 PS-DATA-ERROR                    VALUE '3'.           00557900
005582                                                                  00558000
005583 01 RPT-REPORT-HEADING.                                           00558100
005584     05 FILLER     PIC  X(58)    VALUE SPACES.                    00558200
005585     05 FILLER     PIC  X(38)    VALUE                            00558300
005586         'XS STORE GROUP DATA INTEGRITY ERRORS'.                  00558400
005587                                                                  00558500
005588 01 RPT-COL-HEADING-1.                                            00558600
005589     05 FILLER     PIC  X(01) VALUE SPACE.                        00558700
005590     05 FILLER     PIC  X(07) VALUE ALL '-'.                      00558800
005591     05 FILLER     PIC  X(03) VALUE 'KEY'.                        00558900
005592     05 FILLER     PIC  X(05) VALUE ALL '-'.                      00559000
005593                                                                  00559100
005594 01 RPT-COL-HEADING-2.                                            00559200
005595     05 FILLER     PIC  X(01) VALUE SPACE.                        00559300
005596     05 FILLER     PIC  X(07) VALUE 'STR_GP'.                     00559400
005597     05 FILLER     PIC  X(02) VALUE SPACE.                        00559500
005598     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     00559600
005599     05 FILLER     PIC  X(06) VALUE SPACE.                        00559700
005600     05 FILLER     PIC  X(37) VALUE 'XSDOMAIN'.                   00559800
005601     05 FILLER     PIC  X(37) VALUE 'SYSTEM OF RECORD'.           00559900
005602     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    00560000
005603                                                                  00560100
005604 01 RPT-COL-HEADING-3.                                            00560200
005605     05 FILLER     PIC  X(01) VALUE SPACE.                        00560300
005606     05 FILLER     PIC  X(07) VALUE 'TYP_CDE'.                    00560400
005607     05 FILLER     PIC  X(02) VALUE SPACE.                        00560500
005608     05 FILLER     PIC  X(07) VALUE '_ID '.                       00560600
005609     05 FILLER     PIC  X(06) VALUE SPACE.                        00560700
005610     05 FILLER     PIC  X(37) VALUE 'VALUE'.                      00560800
005611     05 FILLER     PIC  X(05) VALUE 'VALUE'.                      00560900
005612                                                                  00561000
005613 01 RPT-COL-HEADING-4.                                            00561100
005614     05 FILLER     PIC  X(132) VALUE ALL '-'.                     00561200
005615                                                                  00561300
005616 01 DL-DETAIL-LINE.                                               00561400
005617     05 FILLER                PIC  X(01) VALUE SPACE.             00561500
005618     05 DL-STR-GP-TYP-CDE     PIC  X(04) VALUE SPACE.             00561600
005619     05 FILLER                PIC  X(05) VALUE SPACE.             00561700
005620     05 DL-STR-GP-ID          PIC  X(04) VALUE SPACE.             00561800
005621     05 FILLER                PIC  X(05) VALUE SPACE.             00561900
005622     05 DL-XST-NM-VALUE       PIC  X(30) VALUE SPACE.             00562000
005623     05 FILLER                PIC  X(01) VALUE SPACE.             00562100
005624     05 DL-XST-ST-VALUE       PIC  X(02) VALUE SPACE.             00562200
005625     05 FILLER                PIC  X(01) VALUE SPACE.             00562300
005626     05 DL-XST-SLS-IND-VALUE  PIC  X(01) VALUE SPACE.             00562400
005627     05 FILLER                PIC  X(04) VALUE SPACE.             00562500
005628     05 DL-RMS-NM-VALUE       PIC  X(30) VALUE SPACE.             00562600
005629     05 FILLER                PIC  X(01) VALUE SPACE.             00562700
005630     05 DL-RMS-ST-VALUE       PIC  X(02) VALUE SPACE.             00562800
005631     05 FILLER                PIC  X(01) VALUE SPACE.             00562900
005632     05 DL-RMS-SLS-IND-VALUE  PIC  X(01) VALUE SPACE.             00563000
005633     05 FILLER                PIC  X(04) VALUE SPACE.             00563100
005634     05 DL-MESSAGE            PIC  X(41) VALUE SPACE.             00563200
005635                                                                  00563300
005636 PROCEDURE DIVISION.                                              00563400
005637                                                                  00563500
005640 0000-MAIN-MODULE.                                                00563600
005650                                                                  00563700
005660       OPEN INPUT RMS-INPUT-FILE                                  00563800
005670                  XST-INPUT-FILE                                  00563900
005680            OUTPUT ERROR-REPORT.                                  00564000
005681                                                                  00565000
005690       PERFORM 1000-INITIALIZE.                                   00566000
005691       PERFORM 7000-READ-XST-INPUT-FILE.                          00567000
005692       PERFORM 7100-READ-RMS-INPUT-FILE.                          00568000
005693                                                                  00569000
005694       PERFORM 2000-PROCESS-RECS                                  00569100
005695          UNTIL (PS-END-OF-XST-INPUT-RECS                         00569200
005696            AND PS-END-OF-RMS-INPUT-RECS).                        00569300
005700                                                                  00569400
005710       PERFORM 8400-WRITE-TOTALS.                                 00569500
005720                                                                  00569600
005800       CLOSE RMS-INPUT-FILE                                       00569700
005900             XST-INPUT-FILE                                       00569800
006000             ERROR-REPORT.                                        00569900
006010                                                                  00570000
006100       DISPLAY '**** XSKRP007 STATISTICS ****'                    00580000
006200       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     00590000
006300       DISPLAY 'TOTAL XST RECORDS READ : ' PA-XST-RECS-READ.      00600000
006400       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      00610000
006500       DISPLAY ' '                                                00620000
006600                                                                  00630000
006700       STOP RUN.                                                  00640000
006710                                                                  00650000
006800 1000-INITIALIZE.                                                 00660000
006900                                                                  00670000
007000       ACCEPT PV-DATE-YYMMDD FROM DATE.                           00680000
007100       MOVE PV-YYMMDD-YY TO DP150O-RUN-YEAR.                      00690000
007200       MOVE PV-YYMMDD-MM TO DP150O-RUN-MONTH.                     00700000
007300       MOVE PV-YYMMDD-DD TO DP150O-RUN-DAY.                       00710000
007400                                                                  00720000
007500       ACCEPT PV-TIME-HHMMSS FROM TIME.                           00730000
007600       MOVE PV-HHMMSS-HH TO DP150O-RUN-HOUR.                      00740000
007700       MOVE PV-HHMMSS-MM TO DP150O-RUN-MINUTE.                    00750000
007800       MOVE PC-PGM-NAME TO DP150O-PROGRAM-NAME.                   00760000
007900       MOVE 1        TO DP150O-REPORT-NUMBER.                     00770000
008000                                                                  00780000
008100       PERFORM 8100-WRITE-STD-RPT-HEADING.                        00790000
008200       PERFORM 8200-WRITE-REPORT-HEADING.                         00800000
008300       PERFORM 8300-WRITE-COLUMN-HEADING.                         00810000
008400                                                                  00820000
008500 2000-PROCESS-RECS.                                               00830000
008501                                                                  00840000
008510       MOVE HO007-SGD-STR-GP-TYP-CDE  TO  PV-RMS-STR-GP-TYP-CDE.  00850000
008511       MOVE HO007-SGD-STR-GP-ID  TO  PV-RMS-STR-GP-ID.            00851000
008520       MOVE HO007-SGD-GP-NM      TO  PV-RMS-GP-NM.                00852000
008521       MOVE HO007-SGD-ST-CDE     TO  PV-RMS-ST-CDE.               00852100
008522       MOVE HO007-SGD-RPT-FLSH-SLS-IND                            00852200
008523                                 TO PV-RMS-RPT-FLSH-SLS-IND.      00852300
008530                                                                  00852400
008540       MOVE XST-STR-GP-TYP-CDE  TO  PV-XST-STR-GP-TYP-CDE.        00852500
008550       MOVE XST-STR-GP-ID   TO  PV-XST-STR-GP-ID.                 00852600
008551       MOVE XST-GP-NM       TO  PV-XST-GP-NM.                     00852700
008552       MOVE XST-ST-CDE      TO  PV-XST-ST-CDE.                    00852800
008553       MOVE XST-RPT-FLSH-SLS-IND  TO  PV-XST-RPT-FLSH-SLS-IND.    00852900
008560                                                                  00853000
008561      IF PV-XST-KEY = PV-RMS-KEY                                  00854000
008563         PERFORM 3000-COMPARE-FIELDS                              00855000
008564         PERFORM 7000-READ-XST-INPUT-FILE                         00856000
008565         PERFORM 7100-READ-RMS-INPUT-FILE                         00856100
008566      ELSE                                                        00856200
008571          IF ((PV-RMS-KEY < PV-XST-KEY)                           00856300
008572             OR PS-END-OF-XST-INPUT-RECS) AND                     00856400
008573             PS-MORE-RMS-INPUT-RECS                               00856500
008593             MOVE '1' TO PS-RMS-OR-XST-ERR                        00856600
008594             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           00856700
008595                 TO PV-MESSAGE                                    00856800
008596             PERFORM 8000-WRITE-OUTPUT-REC                        00856900
008597             PERFORM 7100-READ-RMS-INPUT-FILE                     00857000
008598          ELSE                                                    00858000
008630              IF ((PV-RMS-KEY > PV-XST-KEY)                       00859000
008640                 OR PS-END-OF-RMS-INPUT-RECS) AND                 00860000
008641                 PS-MORE-XST-INPUT-RECS                           00861000
008650                 MOVE '2' TO PS-RMS-OR-XST-ERR                    00862000
008660                 MOVE 'KEY ON XS DOMAIN TABLES ONLY'              00863000
008661                     TO PV-MESSAGE                                00864000
008670                 PERFORM 8000-WRITE-OUTPUT-REC                    00865000
008680                 PERFORM 7000-READ-XST-INPUT-FILE                 00866000
008690              END-IF                                              00867000
008691          END-IF                                                  00868000
008692      END-IF.                                                     00869000
008693                                                                  00869100
008694 3000-COMPARE-FIELDS.                                             00869200
008695                                                                  00869300
008696      EVALUATE TRUE                                               00869400
008697         WHEN HO007-SGD-GP-NM NOT = PV-XST-GP-NM                  00869500
008703             MOVE '3' TO PS-RMS-OR-XST-ERR                        00869600
008704             MOVE 'STR_GP NAME DOES NOT MATCH'                    00869700
008705                        TO PV-MESSAGE                             00869800
008706             PERFORM 8000-WRITE-OUTPUT-REC                        00869900
008707         WHEN HO007-SGD-ST-CDE NOT = XST-ST-CDE                   00870000
008708             MOVE '3' TO PS-RMS-OR-XST-ERR                        00870100
008709             MOVE 'STR_GP STATE CODE DOES NOT MATCH'              00870200
008710                        TO PV-MESSAGE                             00870300
008711             PERFORM 8000-WRITE-OUTPUT-REC                        00870400
008712         WHEN HO007-SGD-RPT-FLSH-SLS-IND                          00870500
008713                                      NOT = XST-RPT-FLSH-SLS-IND  00870600
008714             MOVE '3' TO PS-RMS-OR-XST-ERR                        00870700
008715             MOVE 'SALES IND. CODE DOES NOT MATCH'                00870800
008716                        TO PV-MESSAGE                             00870900
008717             PERFORM 8000-WRITE-OUTPUT-REC                        00871000
008718      END-EVALUATE.                                               00871100
008719                                                                  00871200
008720 7000-READ-XST-INPUT-FILE.                                        00871300
008800                                                                  00871400
008900       INITIALIZE XST-REC.                                        00871500
009000                                                                  00871600
009100       READ XST-INPUT-FILE INTO XST-REC                           00871700
009200           AT END SET PS-END-OF-XST-INPUT-RECS TO TRUE.           00871800
009300                                                                  00871900
009400       ADD 1 TO PA-XST-RECS-READ.                                 00872000
009500                                                                  00873000
009600 7100-READ-RMS-INPUT-FILE.                                        00874000
009700                                                                  00875000
009800       INITIALIZE HO007-STR-GP-DATA.                              00876000
009900                                                                  00877000
010000       READ RMS-INPUT-FILE INTO HO007-STR-GP-DATA                 00878000
010100            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          00879000
010200                                                                  00880000
010300       ADD 1 TO PA-RMS-RECS-READ.                                 00890000
010400                                                                  00900000
010500 8000-WRITE-OUTPUT-REC.                                           00910000
010600                                                                  00920000
010620                                                                  00930000
010700       IF PS-RMS-ERROR                                            00940000
010800          MOVE SPACES TO DL-DETAIL-LINE                           00950000
010900          MOVE PV-RMS-STR-GP-TYP-CDE   TO DL-STR-GP-TYP-CDE       00960000
010910          MOVE PV-RMS-STR-GP-ID        TO DL-STR-GP-ID            00970000
011000          MOVE PV-RMS-GP-NM            TO DL-RMS-NM-VALUE         00980000
011010          MOVE PV-RMS-ST-CDE           TO DL-RMS-ST-VALUE         00990000
011020          MOVE PV-RMS-RPT-FLSH-SLS-IND TO DL-RMS-SLS-IND-VALUE    01000000
011100          MOVE PV-MESSAGE TO DL-MESSAGE                           01010000
011200       ELSE                                                       01020000
011300          IF PS-XST-ERROR                                         01030000
011310             MOVE SPACES TO DL-DETAIL-LINE                        01040000
011320             MOVE PV-XST-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01050000
011330             MOVE PV-XST-STR-GP-ID TO DL-STR-GP-ID                01060000
011340             MOVE PV-XST-GP-NM  TO DL-XST-NM-VALUE                01070000
011350             MOVE PV-XST-ST-CDE TO DL-XST-ST-VALUE                01080000
011360             MOVE PV-XST-RPT-FLSH-SLS-IND                         01090000
011370                             TO DL-XST-SLS-IND-VALUE              01100000
011600             MOVE PV-MESSAGE TO DL-MESSAGE                        01110000
011610          ELSE                                                    01120000
011611             MOVE SPACES TO DL-DETAIL-LINE                        01130000
011612             MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01140000
011614             MOVE PV-RMS-STR-GP-ID TO DL-STR-GP-ID                01150000
011615             MOVE PV-RMS-GP-NM  TO DL-RMS-NM-VALUE                01160000
011616             MOVE PV-XST-GP-NM  TO DL-XST-NM-VALUE                01161000
011617             MOVE PV-RMS-ST-CDE TO DL-RMS-ST-VALUE                01161100
011618             MOVE PV-XST-ST-CDE TO DL-XST-ST-VALUE                01161200
011619             MOVE PV-RMS-RPT-FLSH-SLS-IND                         01161300
011620                                 TO  DL-RMS-SLS-IND-VALUE         01161400
011621             MOVE PV-XST-RPT-FLSH-SLS-IND                         01161500
011622                                 TO  DL-XST-SLS-IND-VALUE         01161600
011625             MOVE PV-MESSAGE TO DL-MESSAGE                        01161700
011630          END-IF                                                  01161800
011700       END-IF.                                                    01161900
011710                                                                  01162000
011800       IF PV-LINE-CNT > PV-MAX-LINES                              01163000
011810          PERFORM 8100-WRITE-STD-RPT-HEADING                      01164000
011820          PERFORM 8200-WRITE-REPORT-HEADING                       01165000
011830          PERFORM 8300-WRITE-COLUMN-HEADING                       01166000
011840       END-IF.                                                    01167000
011850                                                                  01168000
011900       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     01169000
012000             AFTER ADVANCING 1 LINE.                              01170000
012100       ADD +1 TO PV-LINE-CNT.                                     01180000
012200       MOVE 4095 TO RETURN-CODE.                                  01190000
012300       ADD 1 TO PA-ERROR-MESSAGES.                                01200000
012400                                                                  01210000
012500 8100-WRITE-STD-RPT-HEADING.                                      01220000
012600                                                                  01230000
012610       INITIALIZE PV-LINE-CNT.                                    01240000
012700       ADD 1  TO PV-PAGE-CNT.                                     01250000
012800       MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                    01260000
012900       WRITE ERR-RPT-LINE FROM DP150O-STANDRD-HEADER-150-COLS     01270000
013000             AFTER ADVANCING PAGE.                                01280000
013110       ADD +1 TO PV-LINE-CNT.                                     01290000
013200                                                                  01300000
013300 8200-WRITE-REPORT-HEADING.                                       01310000
013400                                                                  01320000
013500       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 01330000
013600            AFTER ADVANCING 1 LINES.                              01340000
013700       ADD +1 TO PV-LINE-CNT.                                     01350000
013800                                                                  01360000
013900 8300-WRITE-COLUMN-HEADING.                                       01370000
013910                                                                  01380000
013920       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  01390000
013930            AFTER ADVANCING 2 LINES.                              01391000
013940       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  01392000
013950            AFTER ADVANCING 1 LINES.                              01393000
013960       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  01394000
013970            AFTER ADVANCING 1 LINES.                              01395000
013971       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  01396000
013972            AFTER ADVANCING 1 LINES.                              01397000
013980       ADD +5 TO PV-LINE-CNT.                                     01398000
014000                                                                  01399000
014100 8400-WRITE-TOTALS.                                               01400000
014101                                                                  01410000
014102       IF PV-LINE-CNT > PV-MAX-LINES                              01410100
014103          PERFORM 8100-WRITE-STD-RPT-HEADING                      01410200
014104          PERFORM 8200-WRITE-REPORT-HEADING                       01410300
014105          PERFORM 8300-WRITE-COLUMN-HEADING                       01410400
014106       END-IF.                                                    01410500
014107                                                                  01410600
014110      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    01410700
014200      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      01410800
014210            AFTER ADVANCING 2 LINES.                              01410900
014211      ADD +2 TO PV-LINE-CNT.                                      01411000
014212                                                                  01412000
014220      IF PV-LINE-CNT > PV-MAX-LINES                               01413000
014230         PERFORM 8100-WRITE-STD-RPT-HEADING                       01414000
014240         PERFORM 8200-WRITE-REPORT-HEADING                        01415000
014250         PERFORM 8300-WRITE-COLUMN-HEADING                        01416000
014260      END-IF.                                                     01417000
014300      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              01418000
014400            AFTER ADVANCING 1 LINES.                              01419000
014500                                                                  01420000
