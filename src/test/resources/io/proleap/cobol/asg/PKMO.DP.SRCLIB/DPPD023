000100******************************************************************00010000
000200**  THIS PROCEDURE DIVISION COPY BOOK IS USED TO CALL THE       **00020000
000300**  DYNAMIC ALLOCATION PROGRAM.                                 **00030000
000400**                                                              **00040000
000500**  OTHER COPYBOOKS TO INCLUDE:  DPWS023.                       **00050000
000600**                                                              **00060000
000700**  USAGE:                                                      **00070000
000800**      FILL THE APPROPRIATE FIELDS IN DPWS023 AND PERFORM      **00080000
000900**      DP023-0000-DYNALC.                                      **00090000
001000**                                                              **00100000
001100**  IF THE DISPLAY AND ABEND PROCESS IN DISABLED FOR A GIVEN    **00110000
001200**  ALLOCATION, IF WILL BECOME THE APPLICATION'S RESPONSIBILITY **00120000
001300**  TO CHECK IF DP023-LASTRC NOT = ZERO AND IF NOT, TAKE THE    **00130000
001400**  APPROPRIATE ACTION, AND MAKE USE OF THE RETURN CODE AND     **00140000
001500**  MESSAGE IN THE DP023-SUB OCCURRANCE OF THE RETURN CODES     **00150000
001600**  TABLE.                                                      **00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 DP023-0000-DYNALC.                                               00190000
002000     CALL DP023-DYNALC USING DP023-DYNALC-PARMS.                  00200008
002900                                                                  00290000
003000     IF DP023-LASTRC = ZERO                                       00300000
003100         MOVE ZERO TO DP023-ABEND-CODE                            00310000
003200     ELSE                                                         00320000
003300         PERFORM  VARYING DP023-SUB FROM 1 BY 1                   00330000
003400                    UNTIL DP023-SUB    > DP023-MAX                00340000
003500                       OR DP023-LASTRC = DP023-RC (DP023-SUB)     00350000
003600             CONTINUE                                             00360000
003700         END-PERFORM                                              00370000
003800         IF DP023-SUB > DP023-MAX                                 00380000
003900             MOVE DP023-LASTRC    TO DP023-RC   (DP023-SUB)       00390000
004000         END-IF                                                   00400000
004100         MOVE DP023-LASTRC        TO DP023-ABEND-CODE             00410000
004200         IF DP023-ENABLE-DISPLAY-ABEND                            00420000
004300             DISPLAY '*** DYNALC ERROR ' DP023-RC   (DP023-SUB)   00430000
004400                                    ': ' DP023-DESC (DP023-SUB)   00440000
004500             CALL 'ILBOABN0' USING DP023-ABEND-CODE               00450000
004600         END-IF                                                   00460000
004700     END-IF.                                                      00470000
