000100 IDENTIFICATION DIVISION.                                         00010059
000200 PROGRAM-ID.      XLKUT023.                                       00020059
000300**************************** DESTRUCTIVE READS                    00030059
000400**                                                                00040059
000500 AUTHOR.          AL PETERS.                                      00050059
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060059
000700 DATE-WRITTEN.    02/24/2003.                                     00070059
000800 DATE-COMPILED.                                                   00080059
000900******************************************************************00090059
001000**XL MQ RMS PO MESSAGE BUSINESS EVENTS:                           00100059
001100**                     (ORDER HEADER BUSINESS EVENTS)             00110059
001200**                          HDR_ADD                               00120059
001300**                          HDR_CHANGE                            00130059
001400**                          HDR_ATTR_CHANGE                       00140059
001500**                          HDR_IMPRT_CHANGE                      00150059
001600**                          HDR_IMPRT_ATT_CHANGE                  00160059
001700**                          HDR_STATUS_CHANGE                     00170059
001800**                          HDR_ORIG_CTRY_CHANGE                  00180059
001900**                          HDR_DELETE                            00190059
002000                                                                  00200059
002100**                     (ORDER DISCOUNT BUSINESS EVENTS)           00210059
002200**                          ORD_DISCOUNT_ADD                      00220059
002300**                          ORD_DISCOUNT_CHANGE                   00230059
002400**                          ORD_DISCOUNT_DELETE                   00240059
002500                                                                  00250059
002600**                     (SPECIAL INSTRUCTION BUSINESS EVENTS)      00260059
002700**                          SPECIAL_INSTR_ADD                     00270059
002800**                          SPECIAL_INSTR_DELETE                  00280059
002900                                                                  00290059
003000**                     (SKU BUSINESS EVENTS)                      00300059
003100**                          ORD_SKU_ADD                           00310059
003200**                          ORD_SKU_COST_CHANGE                   00320059
003300**                          ORD_SKU_ATTR_CHANGE                   00330059
003400**                          ORD_QTY_CHANGE                        00340059
003500**                          ORD_SKU_DELETE                        00350059
003600**                          ORD_PACK_ADD                          00360059
003700**                          ORD_PACK_HDR_CHANGE                   00370059
003800**                          ORD_PACK_REPLACE                      00380059
003900**                          ORD_PACK_COST_CHANGE                  00390059
004000                                                                  00400059
004100**                     (PACK BUSINESS EVENTS)                     00410059
004200**                          PACK_COMP_ADD                         00420059
004300**                          PACK_COMP_CHANGE                      00430059
004400**                                                                00440059
004500**                     (LOCATION BUSINESS EVENTS)                 00450059
004600**                          ORD_LOCATION_ADD                      00460059
004700**                          ORD_LOC_QTY_CHANGE                    00470059
004800**                          ORD_LOC_ATT_CHANGE                    00480059
004900**                          ORD_LOCATION_DELETE                   00490059
005000**                          ORD_PACK_RTL_CHANGE                   00500059
005100**                                                                00510059
005200**                     (STORE BUSINESS EVENTS)                    00520059
005300**                          STORE_ADD                             00530059
005400**                          STORE_QTY_CHANGE                      00540059
005500**                          STORE_ATTR_CHANGE                     00550059
005600**                          STORE_DELETE                          00560059
005700**                                                                00570059
005800**     THESE MESSAGES, THEN CALLS THE APPLICABLE PROGRAM TO       00580059
005900**     DO THE MAINTENANCE REQUIRED FOR THAT MESSAGE.              00590059
006000******************************************************************00600059
006100*                                                                 00610059
006200*      THE FOLLOWING MESSAGES ARE PROCESSED BY XLKUP017 PACK CONTR00620059
006300*                                                                 00630059
006400*                                                                 00640059
006500*       ORD_PACK_ADD                                              00650059
006600*       ORD_PACK_HDR_CHANGE                                       00660059
006700*       ORD_PACK_REPLACE                                          00670059
006800*       ORD_PACK_COST_CHANGE                                      00680059
006900*       PACK_COMP_ADD                                             00690059
007000*       PACK_COMP_CHANGE                                          00700059
007100*       ORD_PACK_RTL_CHANGE                                       00710059
007200                                                                  00720059
007300***                                                               00730059
007400*** PACK LOCATION BUSINESS EVENTS                                 00740059
007401***                                                               00740159
007402*DATE:12/12/2013   MADE BY:SHEBENA (COGNIZANT)                   *00740207
007403* AFTER RMS13 GO LIVE THE HANGER CAPABILITY INDICATOR VALUE WILL *00740307
007404* COME WITH SPACE FOR HDR_ADD AND HDR_ATTR_CHANGE MESSAGES.      *00740407
007405* HENCE THE PROGRAM HAS BEEN MODIFIED AS TO MOVE THE VALUE FOR   *00740507
007406* HANGER CAPABILITY INDICATOR DURING THE CALL TO PROGRAM         *00740607
007407* XLKUP007.                                                      *00740707
007408* ALL CHANGES ARE TAGGED WITH 'P5207G'. CR: CHG0081355           *00740807
007409******************************************************************00740907
007410******************************************************************00741059
007420 ENVIRONMENT DIVISION.                                            00742059
007430 CONFIGURATION SECTION.                                           00743059
007440 SOURCE-COMPUTER.        IBM-3090.                                00744059
007450 OBJECT-COMPUTER.        IBM-3090.                                00745059
007460 INPUT-OUTPUT SECTION.                                            00746059
007470 FILE-CONTROL.                                                    00747059
007480                                                                  00748059
007490     SELECT CONTROL-CARD-1                                        00749059
007500            ASSIGN TO INP01.                                      00750059
007600     SELECT CONTROL-CARD-2                                        00760059
007700            ASSIGN TO INP02.                                      00770059
007800     SELECT CONTROL-CARD-3                                        00780059
007900            ASSIGN TO INP03.                                      00790059
008000                                                                  00800059
008100 DATA DIVISION.                                                   00810059
008200 FILE SECTION.                                                    00820059
008300                                                                  00830059
008400 FD  CONTROL-CARD-1                                               00840059
008500     RECORDING MODE F                                             00850059
008600     BLOCK CONTAINS 0 RECORDS                                     00860059
008700     LABEL RECORDS ARE OMITTED                                    00870059
008800     DATA RECORD IS CONTROL-CARD-1-RECORD.                        00880059
008900 01  CONTROL-CARD-1-RECORD           PIC X(080).                  00890059
009000                                                                  00900059
009100 FD  CONTROL-CARD-2                                               00910059
009200     RECORDING MODE F                                             00920059
009300     BLOCK CONTAINS 0 RECORDS                                     00930059
009400     LABEL RECORDS ARE OMITTED                                    00940059
009500     DATA RECORD IS CONTROL-CARD-2-RECORD.                        00950059
009600 01  CONTROL-CARD-2-RECORD           PIC X(080).                  00960059
009700                                                                  00970059
009800 FD  CONTROL-CARD-3                                               00980059
009900     RECORDING MODE F                                             00990059
010000     BLOCK CONTAINS 0 RECORDS                                     01000059
010100     LABEL RECORDS ARE OMITTED                                    01010059
010200     DATA RECORD IS CONTROL-CARD-3-RECORD.                        01020059
010300 01  CONTROL-CARD-3-RECORD           PIC X(080).                  01030059
010400                                                                  01040059
010500                                                                  01050059
010600 WORKING-STORAGE SECTION.                                         01060059
010700******************************************************************01070059
010800 01  WS-ERROR-Q-REC.                                              01080059
010900     05  WS-TIMESTAMP                    PIC X(26).               01090059
011000     05  WS-XLRD011-REC                  PIC X(1000).             01100059
011100******************************************************************01110059
011200**PROGRAM SWITCHES                                                01120059
011300******************************************************************01130059
011400 01  PS-PROGRAM-SWITCHES.                                         01140059
011500     05  PS-PROCESS-INDICATOR-SW         PIC X(01)   VALUE 'N'.   01150059
011600         88  PS-PROCESS-CONTINUE-YES                 VALUE 'Y'.   01160059
011700         88  PS-PROCESS-CONTINUE-NO                  VALUE 'N'.   01170059
011800                                                                  01180059
011900     05  PS-PROCESS-COMP-SW              PIC X(01)   VALUE 'N'.   01190059
012000         88  PS-PROCESS-COMPLETE-YES                 VALUE 'Y'.   01200059
012100         88  PS-PROCESS-COMPLETE-NO                  VALUE 'N'.   01210059
012200                                                                  01220059
012300     05  PS-PACK-SW                      PIC X(01)   VALUE 'N'.   01230059
012400         88  PS-PACK-YES                            VALUE 'Y'.    01240059
012500         88  PS-PACK-NO                             VALUE 'N'.    01250059
012600                                                                  01260059
012700     05  PS-PRINT-SW                     PIC X(01)   VALUE 'N'.   01270059
012800         88  PS-PRINT-YES                           VALUE 'Y'.    01280059
012900         88  PS-PRINT-NO                            VALUE 'N'.    01290059
013000                                                                  01300059
013100     05  PS-ODD-UNIT-SKU-SW           PIC X(01) VALUE 'N'.        01310059
013200         88  PS-ODD-UNIT-SKU-NO                 VALUE 'N'.        01320059
013300         88  PS-ODD-UNIT-SKU-YES                VALUE 'Y'.        01330059
013400                                                                  01340059
013500     05  PS-EXISTENCE-PO              PIC S9 COMP-3 VALUE ZERO.   01350059
013600         88  PS-PO-EXISTS-YES                       VALUE 1.      01360059
013700         88  PS-PO-EXISTS-NO                        VALUE ZERO.   01370059
013800     05  PS-EXISTENCE-PURITM          PIC S9 COMP-3 VALUE ZERO.   01380059
013900         88  PS-PURITM-EXISTS-YES                   VALUE 1.      01390059
014000         88  PS-PURITM-EXISTS-NO                    VALUE ZERO.   01400059
014100     05  PS-PROCESS-CONTINUE-SW       PIC X(01)     VALUE 'Y'.    01410059
014200         88  PS-PROCESS-CONTINUE                    VALUE 'Y'.    01420059
014300         88  PS-PROCESS-END                         VALUE 'N'.    01430059
014400     05  PS-MQ-DISCONNECT-SW          PIC X(01)     VALUE 'N'.    01440059
014500         88  PS-DISCONNECT-YES                      VALUE 'Y'.    01450059
014600         88  PS-DISCONNECT-NO                       VALUE 'N'.    01460059
014700                                                                  01470059
014800******************************************************************01480059
014900**CONTROL CARD 1 RECORD LAYOUT - QUEUE MANAGER NAME               01490059
015000******************************************************************01500059
015100 01  CC-CONTROL-CARD-1-LAYOUT.                                    01510059
015200     05  CC-QUEUE-MANAGER-NAME      PIC X(48)   VALUE SPACES.     01520059
015300     05  FILLER                     PIC X(32)   VALUE SPACES.     01530059
015400******************************************************************01540059
015500**CONTROL CARD 2 RECORD LAYOUT - LOCATION QUEUE NAME              01550059
015600******************************************************************01560059
015700 01  CC-CONTROL-CARD-2-LAYOUT.                                    01570059
015800     05  CC-LOCATION-QUEUE-NAME     PIC X(48)   VALUE SPACES.     01580059
015900     05  FILLER                     PIC X(32)   VALUE SPACES.     01590059
016000******************************************************************01600059
016100**CONTROL CARD 3 RECORD LAYOUT - LOCATION ERROR QUEUE NAME        01610059
016200******************************************************************01620059
016300 01  CC-CONTROL-CARD-3-LAYOUT.                                    01630059
016400     05  CC-LOC-ERROR-QUEUE-NAME    PIC X(48)   VALUE SPACES.     01640059
016500     05  FILLER                     PIC X(32)   VALUE SPACES.     01650059
016600******************************************************************01660059
016700**PROGRAM CONSTANTS                                               01670059
016800******************************************************************01680059
016900 01  PC-PROGRAM-CONSTANTS.                                        01690059
017000     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)   VALUE 'XLKUT023'. 01700059
017100     05  PC-CALLED-PROGRAM          PIC X(08).                    01710059
017200         88  PC-CALL-TPURCHS-PGM                VALUE 'XLKUP005'. 01720059
017300         88  PC-CALL-TPLNSHP-PGM                VALUE 'XLKUP006'. 01730059
017400         88  PC-CALL-TPOAGMT-PGM                VALUE 'XLKUP007'. 01740059
017500         88  PC-CALL-TIMPORL-PGM                VALUE 'XLKUP008'. 01750059
017600         88  PC-CALL-TPURITM-PGM                VALUE 'XLKUP009'. 01760059
017700         88  PC-CALL-TALLPLN-PGM                VALUE 'XLKUP010'. 01770059
017800         88  PC-CALL-TPOPRPK-PGM                VALUE 'XLKUP011'. 01780059
017900         88  PC-CALL-TPOINST-PGM                VALUE 'XLKUP012'. 01790059
018000         88  PC-CALL-TOTALIZ-PGM                VALUE 'XLKUP013'. 01800059
018100*        DRS OBSOLETE                                             01810059
018200*        88  PC-CALL-TRAUDIT-PGM                VALUE 'XLKUP014'. 01820059
018300         88  PC-CALL-TMESTDS-PGM                VALUE 'XLKUP016'. 01830059
018400         88  PC-CALL-PAKCNTL-PGM                VALUE 'XLKUP017'. 01840059
018500         88  PC-CALL-MSGCNTL-PGM                VALUE 'XLKUP018'. 01850059
018600         88  PC-CALL-PRTCNTL-PGM                VALUE 'POKUT096'. 01860059
018700                                                                  01870059
018800******************************************************************01880059
018900** DB2 KEYS                                                       01890059
019000******************************************************************01900059
019100 01  DK-DB2-KEYS.                                                 01910059
019200*    05  DK-DST00004-BEG-MSG-TMST  PIC X(26).                     01920059
019300     05  DK-PO-NBR                 PIC S9(9) COMP.                01930059
019400     05  DN-RTL-NULL               PIC S9(4) COMP VALUE ZERO.     01940059
019500     05  DK-SKU-NBR                PIC S9(8)V COMP-3.             01950059
019600     05  DK-DEST-NBR               PIC S9(04) COMP.               01960059
019700     05  DK-STR-NBR                PIC S9(04) COMP.               01970059
019800                                                                  01980059
019900******************************************************************01990059
020000**MQ WORKING STORAGE                                              02000059
020100******************************************************************02010059
020200 01  MQV-WORKING-STORAGE.                                         02020059
020300     05  MQV-MQCONN                 PIC  X(08) VALUE 'CSQBCONN'.  02030059
020400     05  MQV-MQOPEN                 PIC  X(08) VALUE 'CSQBOPEN'.  02040059
020500     05  MQV-MQPUT                  PIC  X(08) VALUE 'CSQBPUT'.   02050059
020600     05  MQV-MQGET                  PIC  X(08) VALUE 'CSQBGET'.   02060059
020700     05  MQV-MQCMIT                 PIC  X(08) VALUE 'CSQBCOMM'.  02070059
020800     05  MQV-MQBACK                 PIC  X(08) VALUE 'CSQBBACK'.  02080059
020900     05  MQV-MQCLOSE                PIC  X(08) VALUE 'CSQBCLOS'.  02090059
021000     05  MQV-MQDISC                 PIC  X(08) VALUE 'CSQBDISC'.  02100059
021100     05  MQV-MQCHECK                PIC  X(08) VALUE 'MQR2C'.     02110059
021200     05  MQV-HCONN                  PIC S9(09) BINARY VALUE 0.    02120059
021300     05  MQV-COMPLETION-CODE        PIC S9(09) BINARY.            02130059
021400     05  MQV-REASON                 PIC S9(09) BINARY.            02140059
021500     05  MQV-OPEN-OPTIONS           PIC S9(09) BINARY.            02150059
021600     05  MQV-LOC-HANDLE1            PIC S9(09) BINARY VALUE 0.    02160059
021700     05  MQV-LOC-HANDLE2            PIC S9(09) BINARY VALUE 0.    02170059
021800     05  MQV-ERROR-HANDLE           PIC S9(09) BINARY VALUE 0.    02180059
021900     05  MQV-REASON-TEXT            PIC X(30)  VALUE SPACES.      02190059
022000     05  MQV-MSGBUFFER            PIC X(1000000)  VALUE SPACES.   02200059
022100     05  MQV-MSG                  PIC X(1000000)  VALUE SPACES.   02210059
022200     05  MQV-ERRMSGBUF            PIC X(1000000)  VALUE SPACES.   02220059
022300     05  MQV-MSG-LENGTH           PIC S9(09)                      02230059
022400                                     BINARY VALUE +1000000.       02240059
022500     05  MQV-DATA-LENGTH          PIC S9(09) BINARY.              02250059
022501                                                                  02250159
022502 01  WS-MQINQ                  PIC X(8)  VALUE 'CSQBINQ'.         02250207
022503                                                                  02250359
022504 01  PV-MQ-STUFF.                                                 02250459
022505     05  PV-SELECTORS.                                            02250506
022506         10  PV-Q-DEPTH          PIC S9(9)  BINARY VALUE 0.       02250606
022507     05  PV-INTATTR-COUNT        PIC S9(9)  BINARY VALUE 1.       02250706
022508     05  PV-INTATTRS.                                             02250806
022509         10  PV-Q-DEPTH-ATTR     PIC S9(9)  BINARY VALUE 0.       02250906
022510     05  PV-CHARATTR-LENGTH      PIC S9(9)  BINARY VALUE 0.       02251006
022520     05  PV-CHARATTRS            PIC X(48).                       02252006
022521*    DISABLED 10/3/2007                                           02252159
022522*    05  PV-GQ-HANDLE            PIC S9(9)  BINARY VALUE 0.       02252200
022523*    DISABLED 10/3/2007                                           02252359
022524     05  PV-COMPLETION-CODE      PIC S9(9)  BINARY.               02252400
022525     05  PV-REASON               PIC S9(9)  BINARY.               02252526
022526     05  PV-SELECT-COUNT         PIC S9(9)  BINARY VALUE 1.       02252659
022527                                                                  02252700
022528 01  PV-CURR-KEY.                                                 02252859
022529     05  PV-CURR-PO-NBR               PIC 9(09) VALUE ZERO.       02252959
022530     05  PV-CURR-SKU-NBR              PIC 9(09) VALUE ZERO.       02253059
022540     05  PV-CURR-DEST                 PIC 9(04) VALUE ZERO.       02254059
022550 01  PV-PREV-KEY.                                                 02255059
022560     05  PV-PREV-PO-NBR               PIC 9(09) VALUE ZERO.       02256059
022570     05  PV-PREV-SKU-NBR              PIC 9(09) VALUE ZERO.       02257059
022580     05  PV-PREV-DEST                 PIC 9(04) VALUE ZERO.       02258059
022590                                                                  02259059
022600 01  PV-OTHER-STUFF.                                              02260059
022700     05  PV-SAVE-LINE-NBR             PIC S9(09) COMP VALUE ZERO. 02270059
022800     05  PV-SAVE-PLAN-NBR             PIC S9(09) COMP VALUE ZERO. 02280059
022900     05  PV-DISP-PO-NBR               PIC 9(09) VALUE ZERO.       02290059
023000     05  PV-DISP-SKU-NBR              PIC 9(09) VALUE ZERO.       02300059
023100     05  PV-DISP-DEST                 PIC 9(04) VALUE ZERO.       02310059
023200******************************************************************02320059
023300**COPYBOOKS                                                       02330059
023400******************************************************************02340059
023500***INPUT FILE LAYOUT - LOCATION MESSAGE COPYBOOK                  02350059
023600 01  XLRD011-RECORD.                                              02360059
023700     COPY XLRD011.                                                02370059
023800*                                                                 02380059
023900***PO PACK BRIDGE - RMS TO MAINFRAME COPYBOOK                     02390059
024000     COPY XLRD012.                                                02400059
024100                                                                  02410059
024200* ------------------------------------------------------------- * 02420059
024300*  COMMUNICATION AREAS FOR DB2                                    02430059
024400* ------------------------------------------------------------- * 02440059
024500     EXEC SQL                                                     02450059
024600         INCLUDE SQLCA                                            02460059
024700     END-EXEC.                                                    02470059
024800                                                                  02480059
024900* --------------------------------------------------------------* 02490059
025000*     DB2 TABLE DECLARATION                                       02500059
025100*   (DST_EVENT_MSG_LOG)    MESSAGE LOG BACKUP                     02510059
025200* --------------------------------------------------------------* 02520059
025300     EXEC SQL                                                     02530059
025400          INCLUDE DST00004                                        02540059
025500     END-EXEC.                                                    02550059
025600                                                                  02560059
025700*    DRS  OBSOLETE                                                02570059
025800*    DST_PO_ITM_MODIF  TABLE                                      02580059
025900*    EXEC SQL                                                     02590059
026000*         INCLUDE DST00000                                        02600059
026100*    END-EXEC.                                                    02610059
026200                                                                  02620059
026300* --------------------------------------------------------------* 02630059
026400*     DB2 TABLE DECLARATION                                       02640059
026500*   (TPURCHS)              PURCHASE TABLE                         02650059
026600* --------------------------------------------------------------* 02660059
026700     EXEC SQL                                                     02670059
026800          INCLUDE TPURCHS                                         02680059
026900     END-EXEC.                                                    02690059
027000                                                                  02700059
027100*   PURCHASE ORDER LINE TABLE                                     02710059
027200     EXEC SQL                                                     02720059
027300          INCLUDE TPURITM                                         02730059
027400     END-EXEC.                                                    02740059
027500                                                                  02750059
027600*   DOMAIN SKU TABLE                                              02760059
027700     EXEC SQL                                                     02770059
027800          INCLUDE XLT00003                                        02780059
027900     END-EXEC.                                                    02790059
028000                                                                  02800059
028100*    PARM TABLE                                                   02810059
028200     EXEC SQL                                                     02820059
028300         INCLUDE TKRPRPM                                          02830059
028400     END-EXEC.                                                    02840059
028500                                                                  02850059
028600     EXEC SQL                                                     02860059
028700         INCLUDE TALLPLN                                          02870059
028800     END-EXEC.                                                    02880059
028900                                                                  02890059
029000*    VENDOR AGREEMENT TABLE                                       02900059
029100     EXEC SQL                                                     02910059
029200         INCLUDE TVNDAGR                                          02920059
029300     END-EXEC.                                                    02930059
029400*                                                                 02940059
029500* ------------------------------------------------------------- * 02950059
029600*  ERROR MESSAGE AREA FOR DB2                                   * 02960059
029700* ------------------------------------------------------------- * 02970059
029800     COPY DPWS004.                                                02980059
029900                                                                  02990059
030000 01  ABEND-CODE              PIC S9(04)  VALUE +0                 03000059
030100                                         COMP SYNC.               03010059
030200                                                                  03020059
030300***OBJECT-DESCRIPTOR.                                             03030059
030400 01  MQM-OBJECT-DESCRIPTOR.                                       03040059
030500     COPY CMQODV.                                                 03050059
030600***MESSAGE-DESCRIPTOR.                                            03060059
030700 01  MQM-MESSAGE-DESCRIPTOR.                                      03070059
030800     COPY CMQMDV.                                                 03080059
030900***GET-MESSAGE-OPTIONS.                                           03090059
031000 01  MQM-GET-MESSAGE-OPTIONS.                                     03100059
031100     COPY CMQGMOV.                                                03110059
031200***PUT-MESSAGE-OPTIONS.                                           03120059
031300 01  MQM-PUT-MESSAGE-OPTIONS.                                     03130059
031400     COPY CMQPMOV.                                                03140059
031500***CONSTANTS.                                                     03150059
031600 01  MQM-CONSTANTS.                                               03160059
031700     COPY CMQV.                                                   03170059
031800******************************************************************03180059
031900**PROGRAM ACCUMULATORS                                            03190059
032000******************************************************************03200059
032100 01  PA-PROGRAM-ACCUMULATORS COMP-3.                              03210059
032200     05  PA-MESSAGE-FROM-QUEUE        PIC S9(09) VALUE ZEROS.     03220059
032300     05  PA-MESSAGES-WRITTEN-TO-BKUP  PIC S9(09) VALUE ZEROS.     03230059
032400     05  PA-MESSAGES-UPDATED          PIC S9(09) VALUE ZEROS.     03240059
032500     05  PA-MESSAGES-TO-ERROR-QUEUE   PIC S9(09) VALUE ZEROS.     03250059
032600     05  PA-PO-LIST-MESSAGES          PIC S9(09) VALUE 0.         03260059
032700     05  PA-END-OF-RUN-MESSAGES       PIC S9(09) VALUE 0.         03270059
032800     05  PA-STOP-PROC-MESSAGES        PIC S9(09) VALUE 0.         03280059
032900     05  PA-HDR-ADD-MESSAGES          PIC S9(09) VALUE 0.         03290059
033000     05  PA-HDR-CHG-MESSAGES          PIC S9(09) VALUE 0.         03300059
033100     05  PA-HDR-ATTR-CHG-MESSAGES     PIC S9(09) VALUE 0.         03310059
033200     05  PA-HDR-IMPRT-CHG-MESSAGES    PIC S9(09) VALUE 0.         03320059
033300     05  PA-HDR-IMPRT-ATTCHG-MESSAGES PIC S9(09) VALUE 0.         03330059
033400     05  PA-HDR-STAT-CHG-MESSAGES     PIC S9(09) VALUE 0.         03340059
033500     05  PA-HDR-ORIG-CTRYCHG-MESSAGES PIC S9(09) VALUE 0.         03350059
033600     05  PA-HDR-DEL-MESSAGES          PIC S9(09) VALUE 0.         03360059
033700     05  PA-TOT-DATA-LENGTH           PIC S9(13) VALUE 0.         03370059
033800     05  PA-TOT-DATA-LENGTH-350       PIC S9(13) VALUE 0.         03380059
033900                                                                  03390059
034000**                                                                03400059
034100     05  PA-ORD-DISC-ADD-MESSAGES     PIC S9(09) VALUE 0.         03410059
034200     05  PA-ORD-DISC-CHG-MESSAGES     PIC S9(09) VALUE 0.         03420059
034300     05  PA-ORD-DISC-DEL-MESSAGES     PIC S9(09) VALUE 0.         03430059
034400**                                                                03440059
034500     05  PA-SPEC-INSTR-ADD-MESSAGES   PIC S9(09) VALUE 0.         03450059
034600     05  PA-SPEC-INSTR-DEL-MESSAGES   PIC S9(09) VALUE 0.         03460059
034700**                                                                03470059
034800     05  PA-ORD-SKU-ADD-MESSAGES      PIC S9(09) VALUE 0.         03480059
034900     05  PA-ORD-SKU-CHG-MESSAGES      PIC S9(09) VALUE 0.         03490059
035000     05  PA-ORD-SKU-ATTR-CHG-MESSAGES PIC S9(09) VALUE 0.         03500059
035100     05  PA-ORD-QTY-CHG-MESSAGES      PIC S9(09) VALUE 0.         03510059
035200     05  PA-ORD-QTY-DEL-MESSAGES      PIC S9(09) VALUE 0.         03520059
035300     05  PA-ORD-PAK-ADD-MESSAGES      PIC S9(09) VALUE 0.         03530059
035400     05  PA-ORD-PAK-HDRCHG-MESSAGES   PIC S9(09) VALUE 0.         03540059
035500     05  PA-ORD-PAK-RPL-MESSAGES      PIC S9(09) VALUE 0.         03550059
035600     05  PA-ORD-PAK-CSTCHG-MESSAGES   PIC S9(09) VALUE 0.         03560059
035700**                                                                03570059
035800     05  PA-PACK-COMP-ADD-MESSAGES    PIC S9(09) VALUE 0.         03580059
035900     05  PA-PACK-COMP-CHG-MESSAGES    PIC S9(09) VALUE 0.         03590059
036000                                                                  03600059
036100**                                                                03610059
036200     05  PA-PACK-COMP-RTL-MESSAGES    PIC S9(09) VALUE 0.         03620059
036300                                                                  03630059
036400**                                                                03640059
036500     05  PA-ORD-LOC-ADD-MESSAGES      PIC S9(09) VALUE 0.         03650059
036600     05  PA-ORD-LOC-PAKADD-MESSAGES   PIC S9(09) VALUE 0.         03660059
036700     05  PA-ORD-LOC-QTYCHG-MESSAGES   PIC S9(09) VALUE 0.         03670059
036800     05  PA-ORD-LOC-RTLCHG-MESSAGES   PIC S9(09) VALUE 0.         03680059
036900     05  PA-ORD-LOC-ATTCHG-MESSAGES   PIC S9(09) VALUE 0.         03690059
037000     05  PA-ORD-LOC-DEL-MESSAGES      PIC S9(09) VALUE 0.         03700059
037100     05  PA-ORD-PAK-RTLCHG-MESSAGES   PIC S9(09) VALUE 0.         03710059
037200**                                                                03720059
037300     05  PA-STORE-ADD-MESSAGES        PIC S9(09) VALUE 0.         03730059
037400     05  PA-STORE-QTY-CHG-MESSAGES    PIC S9(09) VALUE 0.         03740059
037500     05  PA-STORE-ATTR-CHG-MESSAGES   PIC S9(09) VALUE 0.         03750059
037600     05  PA-STORE-DEL-MESSAGES        PIC S9(09) VALUE 0.         03760059
037700**                                                                03770059
037800     05  PA-NOT-PROCESSED             PIC S9(09) VALUE 0.         03780059
037900     05  PA-DEBUG-MESSAGES            PIC S9(09) VALUE 0.         03790059
038000     05  PA-ODD-UNITS                 PIC S9(09) VALUE 0.         03800059
038100     05  PA-RMS-TMST-UPD-CNT          PIC S9(09) VALUE 0.         03810059
038200******************************************************************03820059
038300**PROGRAM VARIABLES                                               03830059
038400******************************************************************03840059
038500 01  PV-PROGRAM-VARIABLES.                                        03850059
038600     05  PV-PREV-ORDER-NBR         PIC 9(8)   VALUE ZERO.         03860059
038700     05  PV-SAVE-ORDER-NBR         PIC 9(8)   VALUE ZERO.         03870059
038800     05  PV-SQLCODE                PIC S9(9)  VALUE +0.           03880059
038900     05  PV-ABEND-PROGRAM          PIC X(08)  VALUE SPACES.       03890059
039000     05  PV-ABEND-PARAGRAPH        PIC X(30)  VALUE SPACES.       03900059
039100     05  PV-ABEND-TABLE-1          PIC X(18)  VALUE SPACES.       03910059
039200     05  PV-ABEND-TABLE-2          PIC X(18)  VALUE SPACES.       03920059
039300     05  PV-ABEND-TABLE-3          PIC X(18)  VALUE SPACES.       03930059
039400     05  PV-ABEND-TABLE-4          PIC X(18)  VALUE SPACES.       03940059
039500     05  PV-ABEND-TABLE-5          PIC X(18)  VALUE SPACES.       03950059
039600     05  PV-DISP-NBR               PIC ZZZ,ZZZ,ZZ9.               03960059
039601     05  PV-DISP-NBR-BIG           PIC ZZZ,ZZZ,ZZZ,ZZZ,ZZ9.       03960159
039602     05  PV-COMPILE-DATE              PIC X(016) VALUE SPACES.    03960200
039603                                                                  03960359
039604*    05  PV-PO-CORRELID.                                          03960459
039605*        10  PV-PO-NBR-TO-GET      PIC 9(08)  VALUE ZEROES.       03960559
039606*        10  FILLER                PIC X(16)  VALUE SPACES.       03960659
039607                                                                  03960759
039608                                                                  03960859
039609     05  PV-WORK-AREA              PIC X(500) VALUE SPACES.       03960959
039610     05  PV-LENGTH                 PIC S9(5)  COMP-3              03961059
039620                                              VALUE ZERO.         03962059
039630     05  PV-DEBUG-SW               PIC X(01) VALUE 'N'.           03963059
039640     05  PV-POPRT-SW               PIC X(01) VALUE 'N'.           03964059
039650     05  PV-PARM-TIMESTAMP         PIC X(26).                     03965059
039660     05  PV-HOUR                   PIC S9(9) COMP VALUE ZERO.     03966059
039670     05  PV-DATE                   PIC X(10).                     03967059
039680     05  PV-TIME                   PIC X(08).                     03968059
039690******************************************************************03969059
039700** PV-MSG IS WHAT GETS BROKEN DOWN INTO END MESSAGE               03970059
039800******************************************************************03980059
039900 01  PV-MSG.                                                      03990059
040000     05  PV-MSG-END                   PIC X(33).                  04000059
040100         88  PV-END-RUN-MSG       VALUE 'END RUN OF PROGRAM'.     04010059
040200         88  PV-STOP-SUB-MSG                                      04020059
040300                VALUE 'STOP SUBSCRIBING TO THE PO PUBSUB'.        04030059
040400         88  PV-DEBUG-YES                                         04040059
040500                VALUE 'START DEBUG'.                              04050059
040600         88  PV-DEBUG-NO                                          04060059
040700                VALUE 'STOP DEBUG'.                               04070059
040800         88  PV-SNAPSHOT                                          04080059
040900                VALUE 'TRAFFIC SNAPSHOT'.                         04090059
041000     05  FILLER                       PIC X(967).                 04100059
041100******************************************************************04110059
041200** CURRENT TIME INFORMATION                                       04120059
041300******************************************************************04130059
041400 01  PV-DEFAULT-TMST                PIC X(26)  VALUE              04140059
041500                               '0001-01-01-00.00.00.000000'.      04150059
041600 01  PV-CURRENT-TMST                PIC X(26)  VALUE SPACES.      04160059
041700 01  FILLER REDEFINES                                             04170059
041800     PV-CURRENT-TMST.                                             04180059
041900     05  PV-TMST-CCYY-MM-DD         PIC X(10).                    04190059
042000     05  FILLER                     PIC X(01).                    04200059
042100     05  PV-TMST-HH-MM-SS           PIC 9(08).                    04210059
042200     05  FILLER                     PIC X(01).                    04220059
042300     05  PV-TMST-LAST6              PIC 9(06).                    04230059
042400                                                                  04240059
042500 01  PV-BEGIN-TMST                  PIC X(26)  VALUE SPACES.      04250059
042600******************************************************************04260059
042700** CURRENT DATE INFORMATION                                       04270059
042800*  REMOVED BY STEFFEN - IT'S NOT REALLY NEEDED                    04280059
042900*01  PV-CURRENT-DATE                PIC X(10)  VALUE SPACE.       04290059
043000                                                                  04300059
043100******************************************************************04310059
043200**ERROR HANDLING                                                  04320059
043300******************************************************************04330059
043400 01  PV-MISC-ABEND-FIELDS.                                        04340059
043500     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      04350059
043600     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      04360059
043700     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      04370059
043800     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      04380059
043900     05  PV-DISPLAY-RETURN-CODE       PIC ZZZZ9- VALUE ZERO.      04390059
044000 01  PV-ABEND-VARIABLES.                                          04400059
044100     05  PV-ABEND-CODE         PIC S9(04) VALUE +0 COMP SYNC.     04410059
044200     88  ABEND-4013-DB2-ERROR             VALUE +4013.            04420059
044300     88  ABEND-4020-MQ-ERROR              VALUE +4020.            04430059
044400     88  ABEND-4095-NOTIFY                VALUE +4095.            04440059
044500                                                                  04450059
044600 01  PV-OVERRIDE-PRICES.                                          04460059
044700     10  PV-OVR-UNT-RTL-PR-AMT         PIC  S9(6)V9(2) COMP-3.    04470059
044800     10  PV-OVR-GP-RTL-AMT             PIC  S9(5)V9(2) COMP-3.    04480059
044900     10  PV-OVR-GP-QTY                 PIC  S9(4) COMP.           04490059
045000                                                                  04500059
045100*  DISABLED 10/3/2007                                             04510059
045200*01  DL-STATS-HDR-LINE.                                           04520059
045300*    05  FILLER                       PIC X(04) VALUE 'HOUR'.     04530059
045400*    05  FILLER                       PIC X(28) VALUE SPACES.     04540059
045500*    05  FILLER                       PIC X(06) VALUE 'VOLUME'.   04550059
045600*    05  FILLER                       PIC X(17) VALUE SPACES.     04560059
045700*    05  FILLER                       PIC X(05) VALUE 'DEPTH'.    04570059
045800*    05  FILLER                       PIC X(17) VALUE SPACES.     04580059
045900*    05  FILLER                       PIC X(09) VALUE 'MSGS READ'.04590059
046000*01  DL-STATS-DTL-LINE.                                           04600059
046100*    05  DL-HOUR                      PIC 99 VALUE ZERO.          04610059
046200*    05  FILLER                       PIC X(20) VALUE SPACE.      04620059
046300*    05  DL-VOLUME                    PIC ZZZ,ZZZ,ZZZ,ZZ9.        04630059
046400*    05  FILLER                       PIC X(10) VALUE SPACE.      04640059
046500*    05  DL-DEPTH                     PIC ZZZ,ZZZ,ZZ9.            04650059
046600*    05  FILLER                       PIC X(10) VALUE SPACE.      04660059
046700*    05  DL-COUNT                     PIC ZZZ,ZZZ,ZZ9.            04670059
046800*                                                                 04680059
046900*01  PT-TRAFFIC-VALUES.                                           04690059
047000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04700059
047100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04710059
047200*    05  FILLER                       PIC X(01) VALUE SPACE.      04720059
047300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04730059
047400*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04740059
047500*                                                                 04750059
047600*    05  FILLER                       PIC S9(9) COMP VALUE 1.     04760059
047700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04770059
047800*    05  FILLER                       PIC X(01) VALUE SPACE.      04780059
047900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04790059
048000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04800059
048100*                                                                 04810059
048200*    05  FILLER                       PIC S9(9) COMP VALUE 2.     04820059
048300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04830059
048400*    05  FILLER                       PIC X(01) VALUE SPACE.      04840059
048500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04850059
048600*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04860059
048700*                                                                 04870059
048800*    05  FILLER                       PIC S9(9) COMP VALUE 3.     04880059
048900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04890059
049000*    05  FILLER                       PIC X(01) VALUE SPACE.      04900059
049100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04910059
049200*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04920059
049300*                                                                 04930059
049400*    05  FILLER                       PIC S9(9) COMP VALUE 4.     04940059
049500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04950059
049600*    05  FILLER                       PIC X(01) VALUE SPACE.      04960059
049700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04970059
049800*    05  FILLER                       PIC S9(9) COMP VALUE 0.     04980059
049900*                                                                 04990059
050000*    05  FILLER                       PIC S9(9) COMP VALUE 5.     05000059
050100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05010059
050200*    05  FILLER                       PIC X(01) VALUE SPACE.      05020059
050300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05030059
050400*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05040059
050500*                                                                 05050059
050600*    05  FILLER                       PIC S9(9) COMP VALUE 6.     05060059
050700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05070059
050800*    05  FILLER                       PIC X(01) VALUE SPACE.      05080059
050900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05090059
051000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05100059
051100*                                                                 05110059
051200*    05  FILLER                       PIC S9(9) COMP VALUE 7.     05120059
051300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05130059
051400*    05  FILLER                       PIC X(01) VALUE SPACE.      05140059
051500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05150059
051600*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05160059
051700*                                                                 05170059
051800*    05  FILLER                       PIC S9(9) COMP VALUE 8.     05180059
051900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05190059
052000*    05  FILLER                       PIC X(01) VALUE SPACE.      05200059
052100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05210059
052200*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05220059
052300*                                                                 05230059
052400*    05  FILLER                       PIC S9(9) COMP VALUE 9.     05240059
052500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05250059
052600*    05  FILLER                       PIC X(01) VALUE SPACE.      05260059
052700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05270059
052800*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05280059
052900*                                                                 05290059
053000*    05  FILLER                       PIC S9(9) COMP VALUE 10.    05300059
053100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05310059
053200*    05  FILLER                       PIC X(01) VALUE SPACE.      05320059
053300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05330059
053400*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05340059
053500*                                                                 05350059
053600*    05  FILLER                       PIC S9(9) COMP VALUE 11.    05360059
053700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05370059
053800*    05  FILLER                       PIC X(01) VALUE SPACE.      05380059
053900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05390059
054000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05400059
054100*                                                                 05410059
054200*    05  FILLER                       PIC S9(9) COMP VALUE 12.    05420059
054300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05430059
054400*    05  FILLER                       PIC X(01) VALUE SPACE.      05440059
054500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05450059
054600*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05460059
054700*                                                                 05470059
054800*    05  FILLER                       PIC S9(9) COMP VALUE 13.    05480059
054900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05490059
055000*    05  FILLER                       PIC X(01) VALUE SPACE.      05500059
055100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05510059
055200*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05520059
055300*                                                                 05530059
055400*    05  FILLER                       PIC S9(9) COMP VALUE 14.    05540059
055500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05550059
055600*    05  FILLER                       PIC X(01) VALUE SPACE.      05560059
055700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05570059
055800*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05580059
055900*                                                                 05590059
056000*    05  FILLER                       PIC S9(9) COMP VALUE 15.    05600059
056100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05610059
056200*    05  FILLER                       PIC X(01) VALUE SPACE.      05620059
056300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05630059
056400*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05640059
056500*                                                                 05650059
056600*    05  FILLER                       PIC S9(9) COMP VALUE 16.    05660059
056700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05670059
056800*    05  FILLER                       PIC X(01) VALUE SPACE.      05680059
056900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05690059
057000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05700059
057100*                                                                 05710059
057200*    05  FILLER                       PIC S9(9) COMP VALUE 17.    05720059
057300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05730059
057400*    05  FILLER                       PIC X(01) VALUE SPACE.      05740059
057500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05750059
057600*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05760059
057700*                                                                 05770059
057800*    05  FILLER                       PIC S9(9) COMP VALUE 18.    05780059
057900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05790059
058000*    05  FILLER                       PIC X(01) VALUE SPACE.      05800059
058100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05810059
058200*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05820059
058300*                                                                 05830059
058400*    05  FILLER                       PIC S9(9) COMP VALUE 19.    05840059
058500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05850059
058600*    05  FILLER                       PIC X(01) VALUE SPACE.      05860059
058700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05870059
058800*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05880059
058900*                                                                 05890059
059000*    05  FILLER                       PIC S9(9) COMP VALUE 20.    05900059
059100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05910059
059200*    05  FILLER                       PIC X(01) VALUE SPACE.      05920059
059300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05930059
059400*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05940059
059500*                                                                 05950059
059600*    05  FILLER                       PIC S9(9) COMP VALUE 21.    05960059
059700*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05970059
059800*    05  FILLER                       PIC X(01) VALUE SPACE.      05980059
059900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     05990059
060000*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06000059
060100*                                                                 06010059
060200*    05  FILLER                       PIC S9(9) COMP VALUE 22.    06020059
060300*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06030059
060400*    05  FILLER                       PIC X(01) VALUE SPACE.      06040059
060500*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06050059
060600*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06060059
060700*                                                                 06070059
060800*    05  FILLER                       PIC S9(9) COMP VALUE 23.    06080059
060900*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06090059
061000*    05  FILLER                       PIC X(01) VALUE SPACE.      06100059
061100*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06110059
061200*    05  FILLER                       PIC S9(9) COMP VALUE 0.     06120059
061300*  DISABLED 10/3/2007                                             06130059
061400                                                                  06140059
061500****  DISABLED 10/4/2007                                          06150059
061600*01  PT-TRAFFIC-TABLE REDEFINES PT-TRAFFIC-VALUES.                06160059
061700*    05  PT-TRAFFIC OCCURS 24 TIMES INDEXED BY PT-TRAFFIC-IDX.    06170059
061800*        10  PT-HOUR                  PIC 9(9) COMP.              06180059
061900*                                                                 06190059
062000*        VOLUME IS THE SUM OF THE DATA LENGTHS                    06200059
062100*        10  PT-VOLUME                PIC 9(9) COMP.              06210059
062200*                                                                 06220059
062300*        DEPTH IS THE NUMBER OF MESSAGES REMAINING ON THE QUEUE   06230059
062400*        10  PT-DEPTH-SW              PIC X(01).                  06240059
062500*        10  PT-DEPTH                 PIC 9(9) COMP.              06250059
062600*                                                                 06260059
062700*        COUNT IS THE SUM OF THE NUMBER OF MESSAGES               06270059
062800*        10  PT-COUNT                 PIC 9(9) COMP.              06280059
062900****  DISABLED 10/4/2007                                          06290059
063000                                                                  06300059
063100                                                                  06310059
063200******************************************************************06320059
063300**LINKAGE VARIABLES                                               06330059
063400******************************************************************06340059
063500 01  CA-LINKAGE                   PIC X(1000).                    06350059
063600                                                                  06360059
063700 PROCEDURE DIVISION.                                              06370059
063800***************************************************************** 06380059
063900                                                                  06390059
064000     PERFORM 1000-INITIALIZATION.                                 06400059
064100     PERFORM 2000-PROCESS-RECORDS                                 06410059
064200             UNTIL PS-PROCESS-COMPLETE-YES.                       06420059
064300     PERFORM 8200-WRAPUP.                                         06430059
064400     GOBACK.                                                      06440059
064500                                                                  06450059
064600******************************************************************06460059
064700**INITIALIZATION AREA - SETUP QUEUES FOR PROCESSING               06470059
064800******************************************************************06480059
064900 1000-INITIALIZATION.                                             06490059
065000                                                                  06500059
065100     DISPLAY ' VERSION 2'                                         06510059
065200     DISPLAY SPACES                                               06520059
065300     MOVE WHEN-COMPILED           TO PV-COMPILE-DATE              06530059
065400     DISPLAY ' COMPILED ON: ' PV-COMPILE-DATE (1:8)               06540059
065500                          ' ' PV-COMPILE-DATE (9:8)               06550059
065600                                                                  06560059
065700     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             06570059
065800                                                                  06580059
065900     OPEN INPUT  CONTROL-CARD-1                                   06590059
066000                 CONTROL-CARD-2                                   06600059
066100                 CONTROL-CARD-3                                   06610059
066200                                                                  06620059
066300     PERFORM 8500-READ-CONTROL-CARD-1.                            06630059
066400     PERFORM 8600-READ-CONTROL-CARD-2.                            06640059
066500     PERFORM 8700-READ-CONTROL-CARD-3.                            06650059
066600                                                                  06660059
066700     IF  CC-QUEUE-MANAGER-NAME    =  SPACES                       06670059
066800      OR CC-LOCATION-QUEUE-NAME =    SPACES                       06680059
066900      OR CC-LOC-ERROR-QUEUE-NAME =     SPACES                     06690059
067000         DISPLAY 'EMPTY CONTROL CARD'                             06700059
067100         DISPLAY 'QUEUE MANAGER NAME    ' CC-QUEUE-MANAGER-NAME   06710059
067200         DISPLAY 'LOCATION QUEUE NAME ' CC-LOCATION-QUEUE-NAME    06720059
067300         DISPLAY 'LOCATION ERROR QUEUE NAME '                     06730059
067400                                   CC-LOC-ERROR-QUEUE-NAME        06740059
067500         PERFORM 9000-MQ-ABEND                                    06750059
067600     END-IF.                                                      06760059
067700                                                                  06770059
067800     PERFORM 1100-CONNECT-TO-QMGR.                                06780059
067900     PERFORM 1200-OPEN-LOCATION-QUEUE.                            06790059
068000     PERFORM 1250-OPEN-ERROR-QUEUE.                               06800059
068001*  DISABLED 10/3/2007                                             06800159
068002*    PERFORM 1300-MQ-INQUIRY-OPEN.                                06800205
068003*  DISABLED 10/3/2007                                             06800359
068004                                                                  06800459
068005     PERFORM 2150-SET-CURRENT-TMST.                               06800559
068006*    PERFORM 2155-SET-CURRENT-DATE.                               06800659
068007     PERFORM 7005-SELECT-TKRPRPM-PRT.                             06800759
068008                                                                  06800859
068009*    GET THE FIRST MESSAGE                                        06800959
068010     PERFORM 8000-RETRIEVE-MESSAGE.                               06801059
068020/                                                                 06802059
068030******************************************************************06803059
068040**CONNECT TO THE QUEUE MANAGER                                    06804059
068050******************************************************************06805059
068060 1100-CONNECT-TO-QMGR.                                            06806059
068070                                                                  06807059
068080     MOVE '1100-CONNECT-TO-QMGR'       TO PV-PARAGRAPH-NAME.      06808059
068090                                                                  06809059
068100     CALL MQV-MQCONN USING CC-QUEUE-MANAGER-NAME                  06810059
068200                           MQV-HCONN                              06820059
068300                           MQV-COMPLETION-CODE                    06830059
068400                           MQV-REASON.                            06840059
068500                                                                  06850059
068600     EVALUATE TRUE                                                06860059
068700        WHEN MQV-COMPLETION-CODE = MQCC-OK                        06870059
068800             DISPLAY 'SUCCESSFULLY CONNECTED TO: '                06880059
068900                                            CC-QUEUE-MANAGER-NAME 06890059
069000        WHEN OTHER                                                06900059
069100             CALL MQV-MQCHECK USING MQV-REASON                    06910059
069200                                    MQV-REASON-TEXT               06920059
069300             DISPLAY 'QUEUE CONNECTING TO ' CC-QUEUE-MANAGER-NAME 06930059
069400             MOVE 'UNABLE TO CONNECT'  TO PV-OPERATION-MSG-1      06940059
069500             PERFORM 9000-MQ-ABEND                                06950059
069600     END-EVALUATE.                                                06960059
069700                                                                  06970059
069800******************************************************************06980059
069900**OPEN THE LOCATION QUEUE                                         06990059
070000******************************************************************07000059
070100 1200-OPEN-LOCATION-QUEUE.                                        07010059
070200                                                                  07020059
070300     MOVE '1200-OPEN-LOCATION-QUEUE' TO PV-PARAGRAPH-NAME.        07030059
070400                                                                  07040059
070500     MOVE CC-LOCATION-QUEUE-NAME TO MQOD-OBJECTNAME               07050059
070600     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        07060059
070700                                                                  07070059
070800                                                                  07080059
070900* MQOPEN COMPUTE LINE USE FOR NON-DESTRUCTIVE READ **             07090059
071000**   COMPUTE MQV-OPEN-OPTIONS      = MQOO-BROWSE +                07100059
071100                                                                  07110059
071200** THIS COMPUTE LINE USE FOR DESTRUCTIVE READ **                  07120059
071300     COMPUTE MQV-OPEN-OPTIONS      = MQOO-INPUT-SHARED            07130059
071400                                   + MQOO-OUTPUT                  07140059
071500                                   + MQOO-FAIL-IF-QUIESCING.      07150059
071600                                                                  07160059
071700     CALL MQV-MQOPEN USING MQV-HCONN                              07170059
071800                           MQM-OBJECT-DESCRIPTOR                  07180059
071900                           MQV-OPEN-OPTIONS                       07190059
072000                           MQV-LOC-HANDLE1                        07200059
072100                           MQV-COMPLETION-CODE                    07210059
072200                           MQV-REASON.                            07220059
072300                                                                  07230059
072400     EVALUATE TRUE                                                07240059
072500        WHEN MQV-COMPLETION-CODE = MQCC-OK                        07250059
072600             DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                07260059
072700                                        CC-LOCATION-QUEUE-NAME    07270059
072800        WHEN OTHER                                                07280059
072900             CALL MQV-MQCHECK USING MQV-REASON                    07290059
073000                                   MQV-REASON-TEXT                07300059
073100             DISPLAY 'CANNOT OPEN QUEUE ' CC-LOCATION-QUEUE-NAME  07310059
073200             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      07320059
073300*            PERFORM 8300-DISCONNECT-QMGR                         07330059
073400             SET PS-DISCONNECT-YES TO TRUE                        07340059
073500             PERFORM 9000-MQ-ABEND                                07350059
073600     END-EVALUATE.                                                07360059
073700                                                                  07370059
073800******************************************************************07380059
073900**OPEN THE ERROR QUEUE                                            07390059
074000******************************************************************07400059
074100 1250-OPEN-ERROR-QUEUE.                                           07410059
074200                                                                  07420059
074300     MOVE '1250-OPEN-ERROR-QUEUE' TO PV-PARAGRAPH-NAME.           07430059
074400                                                                  07440059
074500     MOVE CC-LOC-ERROR-QUEUE-NAME  TO MQOD-OBJECTNAME.            07450059
074600     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        07460059
074700                                                                  07470059
074800     COMPUTE MQV-OPEN-OPTIONS      = MQOO-BROWSE +                07480059
074900                                     MQOO-OUTPUT +                07490059
075000*                                    MQOO-INPUT-SHARED +          07500059
075100                                     MQOO-FAIL-IF-QUIESCING.      07510059
075200                                                                  07520059
075300     CALL MQV-MQOPEN USING MQV-HCONN                              07530059
075400                           MQM-OBJECT-DESCRIPTOR                  07540059
075500                           MQV-OPEN-OPTIONS                       07550059
075600                           MQV-LOC-HANDLE2                        07560059
075700                           MQV-COMPLETION-CODE                    07570059
075800                           MQV-REASON.                            07580059
075900                                                                  07590059
076000     EVALUATE TRUE                                                07600059
076100        WHEN MQV-COMPLETION-CODE = MQCC-OK                        07610059
076200             DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                07620059
076300                                 CC-LOC-ERROR-QUEUE-NAME          07630059
076400        WHEN OTHER                                                07640059
076500             CALL MQV-MQCHECK USING MQV-REASON                    07650059
076600                                   MQV-REASON-TEXT                07660059
076700             DISPLAY 'CANNOT OPEN QUEUE '                         07670059
076800                                   CC-LOC-ERROR-QUEUE-NAME        07680059
076900             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      07690059
077000*            PERFORM 8300-DISCONNECT-QMGR                         07700059
077100             SET PS-DISCONNECT-YES TO TRUE                        07710059
077200             PERFORM 9000-MQ-ABEND                                07720059
077300     END-EVALUATE.                                                07730059
077400                                                                  07740059
077401*  DISABLED 103.2007                                              07740159
077402***************************************************************** 07740204
077403*  MQ - OPEN THE ADJUSTMENT QUEUE FOR INQUIRY.                    07740356
077404***************************************************************** 07740405
077405*1300-MQ-INQUIRY-OPEN.                                            07740505
077406*                                                                 07740604
077407*    OPEN ADJUSTMENT QUEUE FOR INQUIRY OF QUEUE DEPTH             07740756
077408*    MOVE CC-LOCATION-QUEUE-NAME   TO MQOD-OBJECTNAME             07740859
077409*    MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        07740959
077410*                                                                 07741059
077411*    COMPUTE MQV-OPEN-OPTIONS = MQOO-INQUIRE +                    07741100
077412*                           MQOO-FAIL-IF-QUIESCING.               07741200
077413*                                                                 07741300
077414*    MOVE MQOT-Q            TO MQOD-OBJECTTYPE.                   07741404
077415*                                                                 07741500
077416*    CALL MQV-MQOPEN USING MQV-HCONN                              07741600
077417*                         MQM-OBJECT-DESCRIPTOR                   07741724
077418*                         MQV-OPEN-OPTIONS                        07741824
077419*                         PV-GQ-HANDLE                            07741924
077420*                         PV-COMPLETION-CODE                      07742024
077430*                         PV-REASON.                              07743024
077431*  DISABLED 10/3/2007                                             07743159
077432                                                                  07743200
077433******************************************************************07743359
077434**READ ITEM MESSAGE AND BASED ON BUSINESS EVENT CALL PROGRAM      07743459
077435**     TO EXECUTE BUSINESS LOGIC.                                 07743559
077436******************************************************************07743659
077437 2000-PROCESS-RECORDS.                                            07743759
077438                                                                  07743859
077439                                                                  07743959
077440     IF PV-DEBUG-SW = 'Y'                                         07744059
077450         DISPLAY 'XLKUT023 - 2000-PROCESS-RECORDS'                07745059
077460     END-IF.                                                      07746059
077470                                                                  07747059
077480     MOVE '2000-PROCESS-RECORDS'         TO PV-PARAGRAPH-NAME.    07748059
077490                                                                  07749059
077500*INITIALIZE VARIABLES FOR EACH MESSAGE RETRIEVED                  07750059
077600     INITIALIZE PV-MSG.                                           07760059
077700                                                                  07770059
077800     IF XL011-MSG-ID = 'START DEBUG' OR 'STOP DEBUG'              07780059
077900                    OR 'TRAFFIC SNAPSHOT   '                      07790059
078000         SET XL011-BYPASS-MESSAGES    TO TRUE                     07800059
078100                                                                  07810059
078200     ELSE                                                         07820059
078300                                                                  07830059
078400*        CHECK FOR ODD UNIT SKU MESSAGES.  THE RESULT DEPENDS     07840059
078500*        ON PURCHS-PKGNG-CDE AND XL011-MSG-ID.  SO IT MUST        07850059
078600*        BE DONE FOR EVERY MESSAGE EVEN THO THE PKGNG-CDE         07860059
078700*        IS PROBABLY THE SAME.                                    07870059
078800*                                                                 07880059
078900*        IF A DELETE IS ABOUT TO HAPPEN, WE DON'T CARE            07890059
079000*        ABOUT THE PKGNG CODE FROM TPURCHS WHICH SETS             07900059
079100*        THE ODD UNIT FLAG                                        07910059
079200*        HDR_ADD IS ALSO SKIPPED BECAUSE IT IS NOT ONE OF         07920059
079300*        THE TYPES THAT WOULD CAUSE AN ERROR AND THE PO           07930059
079400*        WOULD NOT BE FOUND ANYHOW                                07940059
079500                                                                  07950059
079600         IF XL011-MSG-ID = 'HDR_DELETE' OR 'HDR_ADD'              07960059
079700             SET PS-PROCESS-CONTINUE-YES                          07970059
079800                 XL011-PROCESS-MESSAGES  TO TRUE                  07980059
079900                                                                  07990059
080000         ELSE                                                     08000059
080100                                                                  08010059
080200             SET PC-CALL-MSGCNTL-PGM                              08020059
080300                 PS-ODD-UNIT-SKU-NO  TO TRUE                      08030059
080400             PERFORM 2100-CALL-PROGRAM                            08040059
080500             IF XL011-ODD-UNIT-SKU                                08050059
080600                 SET PS-ODD-UNIT-SKU-YES  TO TRUE                 08060059
080700                 ADD 1                TO PA-ODD-UNITS             08070059
080800             END-IF                                               08080059
080900                                                                  08090059
081000         END-IF                                                   08100059
081100                                                                  08110059
081200         IF XL011-DEBUG-YES                                       08120059
081300             DISPLAY 'XL011-PROCESS-MSGS-SW = '                   08130059
081400                      XL011-PROCESS-MSGS-SW                       08140059
081500         END-IF                                                   08150059
081600     END-IF.                                                      08160059
081700                                                                  08170059
081800                                                                  08180059
081900*    THIS IS WHERE THE WORK IS DONE.  ODD UNIT SKUS ARE SKIPPED   08190059
082000     IF XL011-PROCESS-MESSAGES                                    08200059
082100                                                                  08210059
082200        EVALUATE XL011-MSG-ID                                     08220059
082300                                                                  08230059
082400***     ORDER HEADER BUSINESS EVENTS                              08240059
082500        WHEN 'HDR_ADD'                                            08250059
082600             SET PC-CALL-TPURCHS-PGM TO TRUE                      08260059
082700             PERFORM 2100-CALL-PROGRAM                            08270059
082800             IF PS-PROCESS-CONTINUE-YES                           08280059
082900                 SET PC-CALL-TPOAGMT-PGM TO TRUE                  08290059
083000                 PERFORM 2120-POPULATE-HANG-IND                   08300059
083100                 PERFORM 2100-CALL-PROGRAM                        08310059
083200             END-IF                                               08320059
083300             IF PS-PROCESS-CONTINUE-YES                           08330059
083400                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  08340059
083500                 PERFORM 2100-CALL-PROGRAM                        08350059
083600             END-IF                                               08360059
083700             IF PS-PROCESS-CONTINUE-YES                           08370059
083800                 SET PC-CALL-TIMPORL-PGM TO TRUE                  08380059
083900                 PERFORM 2100-CALL-PROGRAM                        08390059
084000                 ADD +1              TO PA-HDR-ADD-MESSAGES       08400059
084100             END-IF                                               08410059
084200        WHEN 'HDR_CHANGE'                                         08420059
084300             SET PC-CALL-TPURCHS-PGM TO TRUE                      08430059
084400             PERFORM 2100-CALL-PROGRAM                            08440059
084500             IF PS-PROCESS-CONTINUE-YES                           08450059
084600                 SET PC-CALL-TPOAGMT-PGM TO TRUE                  08460059
084700                 PERFORM 2100-CALL-PROGRAM                        08470059
084800             END-IF                                               08480059
084900             IF PS-PROCESS-CONTINUE-YES                           08490059
085000                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  08500059
085100                 PERFORM 2100-CALL-PROGRAM                        08510059
085200                 ADD +1              TO PA-HDR-CHG-MESSAGES       08520059
085300             END-IF                                               08530059
085400        WHEN 'HDR_ATTR_CHANGE'                                    08540059
085500             SET PC-CALL-TPURCHS-PGM TO TRUE                      08550059
085600             PERFORM 2100-CALL-PROGRAM                            08560059
085700             IF PS-PROCESS-CONTINUE-YES                           08570059
085800                 SET PC-CALL-TPOAGMT-PGM TO TRUE                  08580059
085900                 PERFORM 2120-POPULATE-HANG-IND                   08590059
086000                 PERFORM 2100-CALL-PROGRAM                        08600059
086100             END-IF                                               08610059
086200             IF PS-PROCESS-CONTINUE-YES                           08620059
086300                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  08630059
086400                 PERFORM 2100-CALL-PROGRAM                        08640059
086500                 ADD +1        TO PA-HDR-ATTR-CHG-MESSAGES        08650059
086600             END-IF                                               08660059
086700        WHEN 'HDR_IMPRT_CHANGE'                                   08670059
086800             SET PC-CALL-TPURCHS-PGM TO TRUE                      08680059
086900             PERFORM 2100-CALL-PROGRAM                            08690059
087000             IF PS-PROCESS-CONTINUE-YES                           08700059
087100                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  08710059
087200                 PERFORM 2100-CALL-PROGRAM                        08720059
087300                 ADD +1        TO PA-HDR-IMPRT-CHG-MESSAGES       08730059
087400             END-IF                                               08740059
087500        WHEN 'HDR_IMPRT_ATT_CHANGE'                               08750059
087600             SET PC-CALL-TIMPORL-PGM    TO TRUE                   08760059
087700             PERFORM 2100-CALL-PROGRAM                            08770059
087800             IF PS-PROCESS-CONTINUE-YES                           08780059
087900                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  08790059
088000                 PERFORM 2100-CALL-PROGRAM                        08800059
088100             END-IF                                               08810059
088200             IF PS-PROCESS-CONTINUE-YES                           08820059
088300                 SET PC-CALL-TPURCHS-PGM TO TRUE                  08830059
088400                 PERFORM 2100-CALL-PROGRAM                        08840059
088500                 ADD +1        TO PA-HDR-IMPRT-ATTCHG-MESSAGES    08850059
088600             END-IF                                               08860059
088700                                                                  08870059
088800        WHEN 'HDR_STATUS_CHANGE'                                  08880059
088900*** PV-POPRT-SW = 'Y' WILL ACTIVATE P.O. PRINT LISTS              08890059
089000             IF PV-POPRT-SW = 'Y'                                 08900059
089100                 SET PS-PRINT-NO   TO TRUE                        08910059
089200                 PERFORM 2160-CHECK-PO-BEFORE-UPDATE              08920059
089300             END-IF                                               08930059
089400                                                                  08940059
089500             SET PC-CALL-TPURCHS-PGM TO TRUE                      08950059
089600             PERFORM 2100-CALL-PROGRAM                            08960059
089700             ADD +1                  TO PA-HDR-STAT-CHG-MESSAGES  08970059
089800                                                                  08980059
089900             IF PV-POPRT-SW = 'Y'                                 08990059
090000*                NOT NEEDED UNTIL WE KNOW IF THE PO WILL PRINT    09000059
090100*                (WE ARE ON THE SAME UNIT OF WORK)                09010059
090200*                PERFORM 2200-COMMIT-DB2                          09020059
090300                                                                  09030059
090400                 IF PS-PRINT-YES                                  09040059
090500                 PERFORM 2165-CHECK-PO-AFTER-UPDATE               09050059
090600                 END-IF                                           09060059
090700                                                                  09070059
090800             END-IF                                               09080059
090900                                                                  09090059
091000             IF PV-DEBUG-SW = 'Y'                                 09100059
091100                DISPLAY 'PS-PRINT-SW = ' PS-PRINT-SW              09110059
091200                   ' / PS-PROCESS-INDICATOR-SW= '                 09120059
091300                          PS-PROCESS-INDICATOR-SW                 09130059
091400                     ' /  PV-POPRT-SW = ' PV-POPRT-SW             09140059
091500             END-IF                                               09150059
091600                                                                  09160059
091700***          P.O. PRINT PROGRAM IS CALLED HERE                    09170059
091800             IF (PS-PROCESS-CONTINUE-YES AND PS-PRINT-YES         09180059
091900                AND PV-POPRT-SW = 'Y')                            09190059
092000                                                                  09200059
092100***              COMMIT IS NEEDED HERE SO THAT POKUT096 WILL      09210059
092200***              PRINT THE CORRECT VERSION OF THE PO              09220059
092300                                                                  09230059
092400                 PERFORM 2200-COMMIT-DB2                          09240059
092500                                                                  09250059
092600*                NOW PRINT THE PO                                 09260059
092700                 SET PC-CALL-PRTCNTL-PGM TO TRUE                  09270059
092800                 PERFORM 2100-CALL-PROGRAM                        09280059
092900                 ADD +1            TO PA-PO-LIST-MESSAGES         09290059
093000             END-IF                                               09300059
093100                                                                  09310059
093200        WHEN 'HDR_ORIG_CTRY_CHANGE'                               09320059
093300             SET PC-CALL-TPURCHS-PGM TO TRUE                      09330059
093400             PERFORM 2100-CALL-PROGRAM                            09340059
093500             ADD +1            TO PA-HDR-ORIG-CTRYCHG-MESSAGES    09350059
093600                                                                  09360059
093700        WHEN 'HDR_DELETE'                                         09370059
093800*        DRS OBSOLETE                                             09380059
093900*            SET PC-CALL-TRAUDIT-PGM    TO TRUE                   09390059
094000*            PERFORM 2100-CALL-PROGRAM                            09400059
094100*            IF XL011-SQL-NOT-FOUND                               09410059
094200*                SET PS-PROCESS-CONTINUE-YES TO TRUE              09420059
094300*            END-IF                                               09430059
094400                                                                  09440059
094500             IF PS-PROCESS-CONTINUE-YES                           09450059
094600                 SET PC-CALL-TPOPRPK-PGM TO TRUE                  09460059
094700                 PERFORM 2100-CALL-PROGRAM                        09470059
094800             END-IF                                               09480059
094900             IF XL011-SQL-NOT-FOUND                               09490059
095000                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09500059
095100             END-IF                                               09510059
095200                                                                  09520059
095300             IF PS-PROCESS-CONTINUE-YES                           09530059
095400                 SET PC-CALL-TMESTDS-PGM TO TRUE                  09540059
095500                 PERFORM 2100-CALL-PROGRAM                        09550059
095600             END-IF                                               09560059
095700             IF XL011-SQL-NOT-FOUND                               09570059
095800                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09580059
095900             END-IF                                               09590059
096000                                                                  09600059
096100             IF PS-PROCESS-CONTINUE-YES                           09610059
096200                 SET PC-CALL-TALLPLN-PGM TO TRUE                  09620059
096300                 PERFORM 2100-CALL-PROGRAM                        09630059
096400             END-IF                                               09640059
096500             IF XL011-SQL-NOT-FOUND                               09650059
096600                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09660059
096700             END-IF                                               09670059
096800                                                                  09680059
096900             IF PS-PROCESS-CONTINUE-YES                           09690059
097000                 SET PC-CALL-TPOINST-PGM TO TRUE                  09700059
097100                 PERFORM 2100-CALL-PROGRAM                        09710059
097200             END-IF                                               09720059
097300             IF XL011-SQL-NOT-FOUND                               09730059
097400                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09740059
097500             END-IF                                               09750059
097600                                                                  09760059
097700             IF PS-PROCESS-CONTINUE-YES                           09770059
097800                 SET PC-CALL-TPURITM-PGM TO TRUE                  09780059
097900                 PERFORM 2100-CALL-PROGRAM                        09790059
098000             END-IF                                               09800059
098100             IF XL011-SQL-NOT-FOUND                               09810059
098200                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09820059
098300             END-IF                                               09830059
098400                                                                  09840059
098500             IF PS-PROCESS-CONTINUE-YES                           09850059
098600                 SET PC-CALL-TIMPORL-PGM TO TRUE                  09860059
098700                 PERFORM 2100-CALL-PROGRAM                        09870059
098800             END-IF                                               09880059
098900             IF XL011-SQL-NOT-FOUND                               09890059
099000                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09900059
099100             END-IF                                               09910059
099200                                                                  09920059
099300             IF PS-PROCESS-CONTINUE-YES                           09930059
099400                 SET PC-CALL-TPLNSHP-PGM TO TRUE                  09940059
099500                 PERFORM 2100-CALL-PROGRAM                        09950059
099600             END-IF                                               09960059
099700             IF XL011-SQL-NOT-FOUND                               09970059
099800                 SET PS-PROCESS-CONTINUE-YES TO TRUE              09980059
099900             END-IF                                               09990059
100000                                                                  10000059
100100             IF PS-PROCESS-CONTINUE-YES                           10010059
100200                 SET PC-CALL-TPOAGMT-PGM TO TRUE                  10020059
100300                 PERFORM 2100-CALL-PROGRAM                        10030059
100400             END-IF                                               10040059
100500             IF XL011-SQL-NOT-FOUND                               10050059
100600                 SET PS-PROCESS-CONTINUE-YES TO TRUE              10060059
100700             END-IF                                               10070059
100800                                                                  10080059
100900             IF PS-PROCESS-CONTINUE-YES                           10090059
101000                 SET PC-CALL-TPURCHS-PGM TO TRUE                  10100059
101100                 PERFORM 2100-CALL-PROGRAM                        10110059
101200                 ADD +1          TO PA-HDR-DEL-MESSAGES           10120059
101300             END-IF                                               10130059
101400             IF XL011-SQL-NOT-FOUND                               10140059
101500                 SET PS-PROCESS-CONTINUE-YES TO TRUE              10150059
101600             END-IF                                               10160059
101700                                                                  10170059
101800                                                                  10180059
101900***     ORDER DISCOUNT BUSINESS EVENTS                            10190059
102000                                                                  10200059
102100        WHEN 'ORD_DISCOUNT_ADD'                                   10210059
102200             SET PC-CALL-TPOAGMT-PGM TO TRUE                      10220059
102300             PERFORM 2100-CALL-PROGRAM                            10230059
102400             ADD +1               TO PA-ORD-DISC-ADD-MESSAGES     10240059
102500        WHEN 'ORD_DISCOUNT_CHANGE'                                10250059
102600             SET PC-CALL-TPOAGMT-PGM TO TRUE                      10260059
102700             PERFORM 2100-CALL-PROGRAM                            10270059
102800             ADD +1               TO PA-ORD-DISC-CHG-MESSAGES     10280059
102900        WHEN 'ORD_DISCOUNT_DELETE'                                10290059
103000             SET PC-CALL-TPOAGMT-PGM TO TRUE                      10300059
103100             PERFORM 2100-CALL-PROGRAM                            10310059
103200             ADD +1               TO PA-ORD-DISC-DEL-MESSAGES     10320059
103300*                                                                 10330059
103400***     SPECIAL INSTRUCTIONS BUSINESS EVENTS                      10340059
103500*                                                                 10350059
103600        WHEN 'SPECIAL_INSTR_ADD'                                  10360059
103700             SET PC-CALL-TPOAGMT-PGM    TO TRUE                   10370059
103800             PERFORM 2100-CALL-PROGRAM                            10380059
103900             IF PS-PROCESS-CONTINUE-YES                           10390059
104000                 SET PC-CALL-TPOINST-PGM  TO TRUE                 10400059
104100                 PERFORM 2100-CALL-PROGRAM                        10410059
104200                 ADD +1           TO PA-SPEC-INSTR-ADD-MESSAGES   10420059
104300             END-IF                                               10430059
104400        WHEN 'SPECIAL_INSTR_DELETE'                               10440059
104500             SET PC-CALL-TPOAGMT-PGM    TO TRUE                   10450059
104600             PERFORM 2100-CALL-PROGRAM                            10460059
104700             IF PS-PROCESS-CONTINUE-YES                           10470059
104800                 SET PC-CALL-TPOINST-PGM  TO TRUE                 10480059
104900                 PERFORM 2100-CALL-PROGRAM                        10490059
105000                 ADD +1           TO PA-SPEC-INSTR-DEL-MESSAGES   10500059
105100             END-IF                                               10510059
105200*                                                                 10520059
105300***     SKU BUSINESS EVENTS                                       10530059
105400*                                                                 10540059
105500        WHEN 'ORD_SKU_ADD'                                        10550059
105600             SET PC-CALL-TPURITM-PGM    TO TRUE                   10560059
105700             PERFORM 2100-CALL-PROGRAM                            10570059
105800             IF PS-PROCESS-CONTINUE-YES                           10580059
105900                 SET PC-CALL-TOTALIZ-PGM    TO TRUE               10590059
106000                 PERFORM 2100-CALL-PROGRAM                        10600059
106100                 ADD +1           TO PA-ORD-SKU-ADD-MESSAGES      10610059
106200             END-IF                                               10620059
106300        WHEN 'ORD_SKU_COST_CHANGE'                                10630059
106400*       DRS OBSOLETE                                              10640059
106500*            SET PC-CALL-TRAUDIT-PGM    TO TRUE                   10650059
106600*            PERFORM 2100-CALL-PROGRAM                            10660059
106700*            IF PS-PROCESS-CONTINUE-YES                           10670059
106800                 SET PC-CALL-TPURITM-PGM    TO TRUE               10680059
106900                 PERFORM 2100-CALL-PROGRAM                        10690059
107000*            END-IF                                               10700059
107100             IF PS-PROCESS-CONTINUE-YES                           10710059
107200                 SET PC-CALL-TOTALIZ-PGM    TO TRUE               10720059
107300                 PERFORM 2100-CALL-PROGRAM                        10730059
107400                 ADD +1           TO PA-ORD-SKU-CHG-MESSAGES      10740059
107500             END-IF                                               10750059
107600        WHEN 'ORD_SKU_ATTR_CHANGE'                                10760059
107700*       DRS OBSOLETE                                              10770059
107800*            SET PC-CALL-TRAUDIT-PGM    TO TRUE                   10780059
107900*            PERFORM 2100-CALL-PROGRAM                            10790059
108000*            IF PS-PROCESS-CONTINUE-YES                           10800059
108100                 SET PC-CALL-TPURITM-PGM    TO TRUE               10810059
108200                 PERFORM 2100-CALL-PROGRAM                        10820059
108300*            END-IF                                               10830059
108400             IF PS-PROCESS-CONTINUE-YES                           10840059
108500                 SET PC-CALL-TOTALIZ-PGM    TO TRUE               10850059
108600                 PERFORM 2100-CALL-PROGRAM                        10860059
108700                 ADD +1      TO PA-ORD-SKU-ATTR-CHG-MESSAGES      10870059
108800             END-IF                                               10880059
108900        WHEN 'ORD_QTY_CHANGE'                                     10890059
109000*       DRS OBSOLETE                                              10900059
109100*            SET PC-CALL-TRAUDIT-PGM    TO TRUE                   10910059
109200*            PERFORM 2100-CALL-PROGRAM                            10920059
109300*            IF PS-PROCESS-CONTINUE-YES                           10930059
109400                 SET PC-CALL-TPURITM-PGM    TO TRUE               10940059
109500                 PERFORM 2100-CALL-PROGRAM                        10950059
109600*            END-IF                                               10960059
109700             IF PS-PROCESS-CONTINUE-YES                           10970059
109800             SET PC-CALL-TOTALIZ-PGM    TO TRUE                   10980059
109900             PERFORM 2100-CALL-PROGRAM                            10990059
110000             END-IF                                               11000059
110100*LMM                                                              11010059
110200             IF PS-PROCESS-CONTINUE-YES                           11020059
110300             SET XL011-PACK-CALC-YES    TO TRUE                   11030059
110400             SET PC-CALL-TPOPRPK-PGM    TO TRUE                   11040059
110500             PERFORM 2100-CALL-PROGRAM                            11050059
110600                 ADD +1      TO PA-ORD-QTY-CHG-MESSAGES           11060059
110700             END-IF                                               11070059
110800        WHEN 'ORD_SKU_DELETE'                                     11080059
110900             SET PC-CALL-TPURITM-PGM    TO TRUE                   11090059
111000             PERFORM 2100-CALL-PROGRAM                            11100059
111100             IF PS-PROCESS-CONTINUE-YES                           11110059
111200                 SET PC-CALL-TPOPRPK-PGM    TO TRUE               11120059
111300                 PERFORM 2100-CALL-PROGRAM                        11130059
111400             END-IF                                               11140059
111500             IF PS-PROCESS-CONTINUE-YES                           11150059
111600                 SET PC-CALL-TOTALIZ-PGM    TO TRUE               11160059
111700                 PERFORM 2100-CALL-PROGRAM                        11170059
111800                 ADD +1      TO PA-ORD-QTY-DEL-MESSAGES           11180059
111900             END-IF                                               11190059
112000        WHEN 'ORD_PACK_ADD'                                       11200059
112100             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11210059
112200             PERFORM 2100P-CALL-PROGRAM                           11220059
112300             ADD +1          TO PA-ORD-PAK-ADD-MESSAGES           11230059
112400        WHEN 'ORD_PACK_HDR_CHANGE'                                11240059
112500             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11250059
112600             PERFORM 2100P-CALL-PROGRAM                           11260059
112700             ADD +1          TO PA-ORD-PAK-HDRCHG-MESSAGES        11270059
112800        WHEN 'ORD_PACK_REPLACE'                                   11280059
112900             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11290059
113000             PERFORM 2100P-CALL-PROGRAM                           11300059
113100             ADD +1          TO PA-ORD-PAK-RPL-MESSAGES           11310059
113200        WHEN 'ORD_PACK_COST_CHANGE'                               11320059
113300             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11330059
113400             PERFORM 2100P-CALL-PROGRAM                           11340059
113500             ADD +1               TO PA-ORD-PAK-CSTCHG-MESSAGES   11350059
113600                                                                  11360059
113700*                                                                 11370059
113800***     PACK BUSINESS EVENTS                                      11380059
113900*                                                                 11390059
114000        WHEN 'PACK_COMP_ADD'                                      11400059
114100             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11410059
114200             PERFORM 2100P-CALL-PROGRAM                           11420059
114300             ADD +1               TO PA-PACK-COMP-ADD-MESSAGES    11430059
114400                                                                  11440059
114500        WHEN 'PACK_COMP_CHANGE'                                   11450059
114600             SET PC-CALL-PAKCNTL-PGM  TO TRUE                     11460059
114700             PERFORM 2100P-CALL-PROGRAM                           11470059
114800             ADD +1               TO PA-PACK-COMP-CHG-MESSAGES    11480059
114900                                                                  11490059
115000*                                                                 11500059
115100***     LOCATION BUSINESS EVENTS                                  11510059
115200*                                                                 11520059
115300        WHEN 'ORD_LOCATION_ADD'                                   11530059
115400             SET PC-CALL-TALLPLN-PGM TO TRUE                      11540059
115500             PERFORM 2100-CALL-PROGRAM                            11550059
115600             IF PS-PROCESS-CONTINUE-YES                           11560059
115700                 SET PC-CALL-TPURCHS-PGM TO TRUE                  11570059
115800                 PERFORM 2100-CALL-PROGRAM                        11580059
115900                 ADD +1           TO PA-ORD-LOC-ADD-MESSAGES      11590059
116000             END-IF                                               11600059
116100                                                                  11610059
116200        WHEN 'ORD_LOC_QTY_CHANGE'                                 11620059
116300             SET PC-CALL-TALLPLN-PGM    TO TRUE                   11630059
116400             PERFORM 2100-CALL-PROGRAM                            11640059
116500             ADD +1           TO PA-ORD-LOC-QTYCHG-MESSAGES       11650059
116600                                                                  11660059
116700        WHEN 'ORD_LOC_ATT_CHANGE'                                 11670059
116800             SET PC-CALL-TALLPLN-PGM TO TRUE                      11680059
116900             PERFORM 2100-CALL-PROGRAM                            11690059
117000             ADD +1           TO PA-ORD-LOC-ATTCHG-MESSAGES       11700059
117100                                                                  11710059
117200        WHEN 'ORD_LOCATION_DELETE'                                11720059
117300             SET PC-CALL-TMESTDS-PGM TO TRUE                      11730059
117400             PERFORM 2100-CALL-PROGRAM                            11740059
117500             IF PS-PROCESS-CONTINUE-YES                           11750059
117600                 SET PC-CALL-TALLPLN-PGM    TO TRUE               11760059
117700                 PERFORM 2100-CALL-PROGRAM                        11770059
117800             END-IF                                               11780059
117900             IF PS-PROCESS-CONTINUE-YES                           11790059
118000                 SET PC-CALL-TPURCHS-PGM    TO TRUE               11800059
118100                 PERFORM 2100-CALL-PROGRAM                        11810059
118200             END-IF                                               11820059
118300             IF PS-PROCESS-CONTINUE-YES                           11830059
118400                 SET PC-CALL-TOTALIZ-PGM    TO TRUE               11840059
118500                 PERFORM 2100-CALL-PROGRAM                        11850059
118600                 ADD +1           TO PA-ORD-LOC-DEL-MESSAGES      11860059
118700             END-IF                                               11870059
118800                                                                  11880059
118900        WHEN 'ORD_PACK_RTL_CHANGE'                                11890059
119000             SET PC-CALL-PAKCNTL-PGM    TO TRUE                   11900059
119100             PERFORM 2100P-CALL-PROGRAM                           11910059
119200             ADD +1               TO PA-ORD-PAK-RTLCHG-MESSAGES   11920059
119300                                                                  11930059
119400*                                                                 11940059
119500*       STORE BUSINESS EVENTS (ALLOCATIONS)                       11950059
119600*                                                                 11960059
119700        WHEN 'STORE_ADD'                                          11970059
119800                                                                  11980059
119900             IF XL011-STRA-PK-SKU-IND = 'Y'                       11990059
120000                 SET PS-PO-EXISTS-YES TO TRUE                     12000059
120100             ELSE                                                 12010059
120200                 PERFORM 2101-PREP-STORE-ADD                      12020059
120300             END-IF                                               12030059
120400**GB ADD CHECK IF PO NOT FOUND DO NOT                             12040059
120500**PROCESS STORE ADD MESSAGE   T                                   12050059
120600**SET SWITCH TO WRITE MESSAGE TO ERROR QUEUE                      12060059
120700             IF PV-DEBUG-SW = 'Y'                                 12070059
120800                DISPLAY 'XLKUT023 -'                              12080059
120900                DISPLAY 'PS-EXISTENCE-PO' PS-EXISTENCE-PO         12090059
121000                DISPLAY 'PS-PROCESS-CONTINUE-SW '                 12100059
121100                DISPLAY  PS-PROCESS-CONTINUE-SW                   12110059
121200                DISPLAY 'XL011-PO-LINE-NBR' XL011-PO-LINE-NBR     12120059
121300                DISPLAY 'XL011-PLAN-NBR ' XL011-PLAN-NBR          12130059
121400             END-IF                                               12140059
121500             IF PS-PO-EXISTS-NO                                   12150059
121600               SET PS-PROCESS-CONTINUE-NO TO TRUE                 12160059
121700             ELSE                                                 12170059
121800                SET PC-CALL-TMESTDS-PGM    TO TRUE                12180059
121900                PERFORM 2100-CALL-PROGRAM                         12190059
122000                ADD +1               TO PA-STORE-ADD-MESSAGES     12200059
122100             END-IF                                               12210059
122200                                                                  12220059
122300        WHEN 'STORE_QTY_CHANGE'                                   12230059
122400             SET PC-CALL-TMESTDS-PGM    TO TRUE                   12240059
122500             PERFORM 2100-CALL-PROGRAM                            12250059
122600             ADD +1               TO PA-STORE-QTY-CHG-MESSAGES    12260059
122700                                                                  12270059
122800        WHEN 'STORE_ATTR_CHANGE'                                  12280059
122900             SET PC-CALL-TMESTDS-PGM    TO TRUE                   12290059
123000             PERFORM 2100-CALL-PROGRAM                            12300059
123100             ADD +1               TO PA-STORE-ATTR-CHG-MESSAGES   12310059
123200                                                                  12320059
123300        WHEN 'STORE_DELETE'                                       12330059
123400             SET PC-CALL-TMESTDS-PGM    TO TRUE                   12340059
123500             PERFORM 2100-CALL-PROGRAM                            12350059
123600             ADD +1               TO PA-STORE-DEL-MESSAGES        12360059
123700                                                                  12370059
123800                                                                  12380059
123900         WHEN OTHER                                               12390059
124000*            (ODD-UNIT-SKU FROM XLKUP018)                         12400059
124100             IF XL011-MSG-ID = 'START DEBUG' OR 'STOP DEBUG'      12410059
124200                  OR 'TRAFFIC SNAPSHOT'                           12420059
124300                 CONTINUE                                         12430059
124400             ELSE                                                 12440059
124500                 ADD +1         TO PA-NOT-PROCESSED               12450059
124600                 SET PS-PROCESS-CONTINUE-NO TO TRUE               12460059
124700             END-IF                                               12470059
124800        END-EVALUATE                                              12480059
124900     END-IF.                                                      12490059
125000                                                                  12500059
125100*                                                                 12510059
125200* THE MESSAGE HAS BEEN PROCESSED.                                 12520059
125300*                                                                 12530059
125400                                                                  12540059
125500                                                                  12550059
125600*    IF THERE WERE NO PROCESSING ERRORS, COMMIT ELSE ROLLBACK     12560059
125700     IF PS-PROCESS-CONTINUE-YES                                   12570059
125800         PERFORM 2200-COMMIT-DB2                                  12580059
125900     ELSE                                                         12590059
126000         PERFORM 2600-ROLLBACK-DB2                                12600059
126100         PERFORM 2500-PUT-ON-ERROR-QUEUE                          12610059
126200     END-IF                                                       12620059
126300                                                                  12630059
126400     PERFORM 2300-COMMIT-MESSAGE.                                 12640059
126500                                                                  12650059
126600     PERFORM 8000-RETRIEVE-MESSAGE.                               12660059
126700                                                                  12670059
126800                                                                  12680059
126900*    UPDATE TPURCHS RMS_PO_UPD_TMST ONLY WHEN THE PO CHANGES      12690059
127000                                                                  12700059
127100                                                                  12710059
127200     IF XL011-ORDER-NBR NOT = PV-PREV-ORDER-NBR                   12720059
127300             PERFORM 2125-TPURCH-END-PROCESS                      12730059
127400*        (ALSO DOES A COMMIT)                                     12740059
127500         MOVE XL011-ORDER-NBR         TO PV-PREV-ORDER-NBR        12750059
127600                                                                  12760059
127700     END-IF.                                                      12770059
127800/                                                                 12780059
127900**********      OLD STUFF         *****************************   12790059
128000*                                                                 12800059
128100*                                                                 12810059
128200** UPDATE MESSAGES AND TABLES AFTER EACH BUSINESS EVENT           12820059
128300** BYPASS FOR XLKUP017 (PACKS)                                    12830059
128400*                                                                 12840059
128500*    IF THE PO IS NOT IN A RMS DEPT THEN WE SKIP IT ENTIRELY      12850059
128600*                                                                 12860059
128700*    IF XL011-PROCESS-MESSAGES                                    12870059
128800*        IF PS-PACK-YES                                           12880059
128900*            PERFORM 2125-TPURCH-END-PROCESS                      12890059
129000*            IF PS-PROCESS-CONTINUE-YES                           12900059
129100*                PERFORM 2200-COMMIT-DB2                          12910059
129200*            ELSE                                                 12920059
129300*                PERFORM 2600-ROLLBACK-DB2                        12930059
129400*            END-IF                                               12940059
129500*        ELSE                                                     12950059
129600*            PERFORM 2175-UPDATE-MESSAGES-TABLES                  12960059
129700*            IF PS-PROCESS-CONTINUE-YES                           12970059
129800*                PERFORM 2200-COMMIT-DB2                          12980059
129900*            ELSE                                                 12990059
130000*                PERFORM 2600-ROLLBACK-DB2                        13000059
130100*            END-IF                                               13010059
130200*        END-IF                                                   13020059
130300*    ELSE                                                         13030059
130400** FOR ODD UNIT SKU MESSAGES WE WANT THE PROGRAM TO UPDATE        13040059
130500** TPURCHS.RMS.PO.UPD.TMST (PARAGRAPH 2125-)                      13050059
130600*        IF XL011-ODD-UNIT-SKU                                    13060059
130700*            PERFORM 2125-TPURCH-END-PROCESS                      13070059
130800*            IF PS-PROCESS-CONTINUE-YES                           13080059
130900*                PERFORM 2200-COMMIT-DB2                          13090059
131000*            ELSE                                                 13100059
131100*                PERFORM 2600-ROLLBACK-DB2                        13110059
131200*            END-IF                                               13120059
131300*        END-IF                                                   13130059
131400*                                                                 13140059
131500*        PERFORM 2175-UPDATE-MESSAGES-TABLES                      13150059
131600*        IF PS-PROCESS-CONTINUE-YES                               13160059
131700*            PERFORM 2200-COMMIT-DB2                              13170059
131800*        ELSE                                                     13180059
131900*            PERFORM 2600-ROLLBACK-DB2                            13190059
132000*        END-IF                                                   13200059
132100*    END-IF.                                                      13210059
132200                                                                  13220059
132300 2101-PREP-STORE-ADD.                                             13230059
132400                                                                  13240059
132500     IF PV-DEBUG-SW = 'Y'                                         13250059
132600         DISPLAY 'XLKUT023 - 2101-PREP-STORE-ADD '                13260059
132700         DISPLAY 'PV-CURR-KEY ' PV-CURR-KEY                       13270059
132800         DISPLAY 'PV-PREV-KEY ' PV-PREV-KEY                       13280059
132900         DISPLAY 'PV-SAVE-LINE-NBR ' PV-SAVE-LINE-NBR             13290059
133000         DISPLAY 'XL011-PO-LINE-NBR ' XL011-PO-LINE-NBR           13300059
133100         DISPLAY 'PV-SAVE-PLAN-NBR  ' PV-SAVE-PLAN-NBR            13310059
133200         DISPLAY 'XL011-PLAN-NBR    ' XL011-PLAN-NBR              13320059
133300     END-IF.                                                      13330059
133400     IF PV-CURR-KEY = PV-PREV-KEY                                 13340059
133500         MOVE   +0                    TO XL011-PO-LINE-NBR        13350059
133600                                         XL011-PLAN-NBR           13360059
133700         MOVE PV-SAVE-LINE-NBR        TO XL011-PO-LINE-NBR        13370059
133800         MOVE PV-SAVE-PLAN-NBR        TO XL011-PLAN-NBR           13380059
133900     ELSE                                                         13390059
134000         MOVE   +0                    TO XL011-PO-LINE-NBR        13400059
134100                                         XL011-PLAN-NBR           13410059
134200                                         PV-SAVE-LINE-NBR         13420059
134300                                         PV-SAVE-PLAN-NBR         13430059
134400         MOVE PV-CURR-PO-NBR          TO PV-PREV-PO-NBR           13440059
134500         MOVE PV-CURR-SKU-NBR         TO PV-PREV-SKU-NBR          13450059
134600         MOVE PV-CURR-DEST            TO PV-PREV-DEST             13460059
134700                                                                  13470059
134701         MOVE XL011-ORDER-NBR          TO DK-PO-NBR               13470159
134702         MOVE XL011-STRA-COMP-SKU-NBR  TO DK-SKU-NBR              13470207
134703         MOVE XL011-STRA-LOCATION      TO DK-DEST-NBR             13470307
134704         MOVE XL011-STRA-STORE-NBR     TO DK-STR-NBR              13470407
134705         MOVE XL011-STRA-PK-SKU-IND    TO PS-PACK-SW              13470507
134706*GB 07/21/14                                                      13470659
134707         SET PS-PROCESS-CONTINUE  TO TRUE                         13470759
134708*GB 07/21/14                                                      13470859
134709         PERFORM 7200-FIND-PO-LINE-TALLPLN                        13470959
134710         IF PS-PROCESS-CONTINUE                                   13471016
134711             IF PS-PO-EXISTS-NO                                   13471116
134712                 STRING 'NO PO/LINE/TALLPLN FOR PO = '            13471207
134713                     XL011-ORDER-NBR ' / '                        13471359
134714                    'SKU = '  ' / ' PV-CURR-SKU-NBR               13471459
134715                    'DEST = '   XL011-STRA-LOCATION               13471559
134716                     DELIMITED BY SIZE    INTO XL011-ERROR-TEXT   13471607
134717                 SET XL011-SYSTEM-ERROR                           13471707
134718                     PS-PROCESS-END       TO TRUE                 13471807
134719             ELSE                                                 13471916
134720                 MOVE PURITM-PO-LNE-NBR   TO XL011-PO-LINE-NBR    13472059
134730                                             PV-SAVE-LINE-NBR     13473059
134740                 MOVE ALLPLN-PLAN-NBR     TO XL011-PLAN-NBR       13474059
134741                                             PV-SAVE-PLAN-NBR     13474159
134742             END-IF                                               13474207
134743         END-IF                                                   13474316
134744     END-IF.                                                      13474459
134745                                                                  13474559
134746                                                                  13474607
134747*    IF XL011-SUCCESSFUL                                          13474707
134748*        MOVE PURITM-PO-LNE-NBR       TO XL011-PO-LINE-NBR        13474859
134749*        MOVE ALLPLN-PLAN-NBR         TO                          13474907
134750*                                        XL011-PLAN-NBR           13475059
134760*    END-IF.                                                      13476007
134770                                                                  13477059
134780******************************************************************13478059
134790**CALL PROGRAM TO EXECUTE MESSAGE                                 13479059
134800******************************************************************13480059
134900 2100-CALL-PROGRAM.                                               13490059
135000                                                                  13500059
135100                                                                  13510059
135200     MOVE '2100-CALL-PROGRAM' TO PV-PARAGRAPH-NAME.               13520059
135300                                                                  13530059
135400     MOVE PV-DEBUG-SW         TO XL011-DEBUG-SW                   13540059
135500                                                                  13550059
135600     IF PV-DEBUG-SW = 'Y'                                         13560059
135700         DISPLAY 'XLKUT023 - 2100-CALL-PROGRAM '                  13570059
135800                          PC-CALLED-PROGRAM                       13580059
135900     END-IF.                                                      13590059
136000                                                                  13600059
136100     CALL PC-CALLED-PROGRAM USING XLRD011-RECORD                  13610059
136200                                                                  13620059
136300     EVALUATE TRUE                                                13630059
136400        WHEN XL011-SUCCESSFUL                                     13640059
136500             SET PS-PROCESS-CONTINUE-YES TO TRUE                  13650059
136600                                                                  13660059
136700        WHEN XL011-SQL-ERROR                                      13670059
136800             SET PS-PROCESS-CONTINUE-NO  TO TRUE                  13680059
136900                                                                  13690059
137000        WHEN XL011-SYSTEM-ERROR                                   13700059
137100             SET PS-PROCESS-CONTINUE-NO  TO TRUE                  13710059
137200                                                                  13720059
137300     END-EVALUATE.                                                13730059
137400                                                                  13740059
137500******************************************************************13750059
137600**CALL PACK PROGRAM TO EXECUTE MESSAGE                            13760059
137700******************************************************************13770059
137800 2100P-CALL-PROGRAM.                                              13780059
137900                                                                  13790059
138000     MOVE '2100P-CALL-PROGRAM'                                    13800059
138100                      TO PV-PARAGRAPH-NAME.                       13810059
138200                                                                  13820059
138300     MOVE 'XLKUP017'            TO PC-CALLED-PROGRAM              13830059
138400     MOVE MQV-DATA-LENGTH       TO XL012-DATA-LENGTH              13840059
138500     MOVE MQV-MSGBUFFER         TO XL012-PACK-BUFFER              13850059
138600                                                                  13860059
138700*    THIS STUFF IS INFORMATIONAL ONLY (I THINK)                   13870059
138800     MOVE CC-QUEUE-MANAGER-NAME TO XL012-QUEUE-MANAGER-NAME       13880059
138900     MOVE CC-LOCATION-QUEUE-NAME  TO XL012-LOCATION-QUEUE-NAME    13890059
139000     MOVE CC-LOC-ERROR-QUEUE-NAME TO XL012-LOC-ERROR-QUEUE-NAME   13900059
139100                                                                  13910059
139200*    TRANSFER THE MQ HANDLES FOR USE BY XLKUP024                  13920059
139300     MOVE MQV-HCONN               TO XL012-CONNECT-HANDLE         13930059
139400     MOVE MQV-LOC-HANDLE2         TO XL012-OPEN-HANDLE            13940059
139500     MOVE PV-DEBUG-SW             TO XL012-DEBUG-SW               13950059
139600                                                                  13960059
139700                                                                  13970059
139800     IF PV-DEBUG-SW = 'Y'                                         13980059
139900         DISPLAY 'XLKUT023 - 2100-CALL-PROGRAM '                  13990059
140000                          PC-CALLED-PROGRAM                       14000059
140100     END-IF.                                                      14010059
140200                                                                  14020059
140300                                                                  14030059
140400     CALL PC-CALLED-PROGRAM USING XLRD012-RECORD                  14040059
140500                                                                  14050059
140600     EVALUATE TRUE                                                14060059
140700         WHEN XL012-SUCCESSFUL                                    14070059
140800                SET PS-PROCESS-CONTINUE-YES TO TRUE               14080059
140900                                                                  14090059
141000         WHEN XL012-SQL-ERROR                                     14100059
141100                SET PS-PROCESS-CONTINUE-NO  TO TRUE               14110059
141200                                                                  14120059
141300         WHEN XL012-SYSTEM-ERROR                                  14130059
141400                SET PS-PROCESS-CONTINUE-NO  TO TRUE               14140059
141500                                                                  14150059
141600         WHEN XL012-MQPUT-ERROR                                   14160059
141700                SET PS-PROCESS-CONTINUE-NO  TO TRUE               14170059
141800                MOVE 'MQPUT ERROR'      TO PV-OPERATION-MSG-1     14180059
141900                MOVE '2100P-CALL-PROGRAM' TO PV-PARAGRAPH-NAME    14190059
142000*               PERFORM 8300-DISCONNECT-QMGR                      14200059
142100                SET PS-DISCONNECT-YES TO TRUE                     14210059
142200                PERFORM 9000-MQ-ABEND                             14220059
142300                                                                  14230059
142400     END-EVALUATE.                                                14240059
142500                                                                  14250059
142600***************************************************************   14260059
142700* POPULATE HANGER CAPABILITY INDICATOR TO HDR ADD/HDR ATTR CHG    14270059
142800***************************************************************   14280059
142900 2120-POPULATE-HANG-IND.                                          14290059
143000      IF PV-DEBUG-SW = 'Y'                                        14300059
143100         DISPLAY 'XLKUT023- 2120-POPULATE-HANG-IND'               14310059
143200      END-IF.                                                     14320059
143300                                                                  14330059
143400      MOVE XL011-ORDER-NBR TO DK-PO-NBR.                          14340059
143500                                                                  14350059
143600      EXEC SQL                                                    14360059
143700           SELECT A.AGRMT_TYP_ID,                                 14370059
143800                  A.TYP_CDE                                       14380059
143900             INTO :VNDAGR-AGRMT-TYP-ID,                           14390059
144000                  :VNDAGR-TYP-CDE                                 14400059
144100             FROM TVNDAGR A,                                      14410059
144200                  TPURCHS B                                       14420059
144300             WHERE B.PO_NBR          = :DK-PO-NBR   AND           14430059
144400                   B.VER_STATUS_CDE  = 'A'          AND           14440059
144500                   A.ENT_ID          = B.ENT_ID     AND           14450059
144600                   A.DEPT_NBR        = B.DEPT_NBR   AND           14460059
144700                   A.AGRMT_TYP_ID    = '4'          AND           14470059
144800                   A.TYP_CDE         =  2           AND           14480059
144900                   A.EFFECTIVE_DATE <= CURRENT DATE AND           14490059
145000                   A.EXPIRATION_DATE > CURRENT DATE               14500059
145100             WITH UR                                              14510059
145200      END-EXEC.                                                   14520059
145300                                                                  14530059
145400      EVALUATE TRUE                                               14540059
145500       WHEN SQLCODE =0                                            14550059
145600            SET PS-PRINT-YES TO TRUE                              14560059
145610** INC1479698 START                                               14561060
145700*           MOVE 'Y' TO XL011-HA-HANG-IND                         14570060
145800*                       XL011-HAC-HANG-IND                        14580060
145810            IF XL011-MSG-ID = 'HDR_ADD'                           14581060
145820               MOVE 'Y' TO XL011-HA-HANG-IND                      14582060
145830            END-IF                                                14583060
145840            IF XL011-MSG-ID = 'HDR_ATTR_CHANGE'                   14584060
145850               MOVE 'Y' TO XL011-HAC-HANG-IND                     14585060
145860            END-IF                                                14586060
145870** INC1479698 END                                                 14587060
145900                                                                  14590059
146000       WHEN SQLCODE = 100                                         14600059
146100            SET PS-PRINT-NO  TO TRUE                              14610059
146110** INC1479698 START                                               14611060
146200*           MOVE 'N' TO XL011-HA-HANG-IND                         14620060
146300*                       XL011-HAC-HANG-IND                        14630060
146310            IF XL011-MSG-ID = 'HDR_ADD'                           14631060
146320               MOVE 'N' TO XL011-HA-HANG-IND                      14632060
146330            END-IF                                                14633060
146340            IF XL011-MSG-ID = 'HDR_ATTR_CHANGE'                   14634060
146350               MOVE 'N' TO XL011-HAC-HANG-IND                     14635060
146360            END-IF                                                14636060
146370** INC1479698 END                                                 14637060
146400                                                                  14640059
146500       WHEN SQLCODE = -904                                        14650059
146600       WHEN SQLCODE = -913                                        14660059
146700            CONTINUE                                              14670059
146800                                                                  14680059
146900       WHEN OTHER                                                 14690059
147000            SET PS-PRINT-NO  TO TRUE                              14700059
147100      END-EVALUATE.                                               14710059
147200                                                                  14720059
147300      IF PV-DEBUG-SW = 'Y'                                        14730059
147400         DISPLAY 'PS-PRINT-SW = ' PS-PRINT-SW                     14740059
147500      END-IF.                                                     14750059
147600******************************************************************14760059
147700* CALL XLKUP005 TO UPDATE RMS_PO_UPD_TMST                         14770059
147800******************************************************************14780059
147900 2125-TPURCH-END-PROCESS.                                         14790059
148000                                                                  14800059
148100     IF PV-DEBUG-SW = 'Y'                                         14810059
148200         DISPLAY 'XLKUT023- 2125-TPURCH-END-PROCESS'              14820059
148300     END-IF.                                                      14830059
148400                                                                  14840059
148500     MOVE XL011-ORDER-NBR             TO PV-SAVE-ORDER-NBR        14850059
148600     MOVE PV-PREV-ORDER-NBR           TO XL011-ORDER-NBR          14860059
148700                                                                  14870059
148800     SET XL011-ROW-COMMITTED-YES    TO TRUE.                      14880059
148900     SET PC-CALL-TPURCHS-PGM        TO TRUE.                      14890059
149000     PERFORM 2100-CALL-PROGRAM.                                   14900059
149100     ADD 1                            TO PA-RMS-TMST-UPD-CNT      14910059
149200                                                                  14920059
149300     MOVE PV-SAVE-ORDER-NBR           TO XL011-ORDER-NBR          14930059
149400                                                                  14940059
149500     IF PS-PROCESS-CONTINUE-YES                                   14950059
149600         PERFORM 2200-COMMIT-DB2                                  14960059
149700     ELSE                                                         14970059
149800         PERFORM 2600-ROLLBACK-DB2                                14980059
149900     END-IF.                                                      14990059
150000                                                                  15000059
150100******************************************************************15010059
150200* SET THE BEGINNING TIMESTAMP.                                    15020059
150300******************************************************************15030059
150400 2140-SET-BEGIN-TMST.                                             15040059
150500                                                                  15050059
150600                                                                  15060059
150700     IF PV-DEBUG-SW = 'Y'                                         15070059
150800         DISPLAY 'XLKUT023 - 2140-SET-BEGIN-TMST'                 15080059
150900     END-IF.                                                      15090059
151000                                                                  15100059
151100     EXEC SQL                                                     15110059
151200         SET :PV-BEGIN-TMST = CURRENT TIMESTAMP                   15120059
151300     END-EXEC                                                     15130059
151400                                                                  15140059
151500     EVALUATE TRUE                                                15150059
151600        WHEN SQLCODE = ZERO                                       15160059
151700            CONTINUE                                              15170059
151800                                                                  15180059
151900        WHEN SQLWARN0 NOT = SPACES                                15190059
152000        WHEN SQLCODE  NOT = ZERO                                  15200059
152100            DISPLAY '**************************************'      15210059
152200            DISPLAY '** ABEND                            **'      15220059
152300            DISPLAY '** PROGRAM = XLKUT023               **'      15230059
152400            DISPLAY '** PARAGRAPH = 2140-SET-BEGIN-TMST  **'      15240059
152500            DISPLAY '** SET CURRENT TIMESTAMP            **'      15250059
152600            DISPLAY '** SQLCODE = ' SQLCODE                       15260059
152700            DISPLAY '**************************************'      15270059
152800            PERFORM 9100-SQL-ABEND-ROUTINE                        15280059
152900     END-EVALUATE.                                                15290059
153000                                                                  15300059
153100******************************************************************15310059
153200**RETRIEVE TIME AND DATE FROM DB2                                 15320059
153300******************************************************************15330059
153400* SET THE CURRENT TIMESTAMP.                                      15340059
153500******************************************************************15350059
153600 2150-SET-CURRENT-TMST.                                           15360059
153700                                                                  15370059
153800                                                                  15380059
153900     IF PV-DEBUG-SW = 'Y'                                         15390059
154000         DISPLAY 'XLKUT023 - 2150-SET-CURRENT-TMST'               15400059
154100     END-IF.                                                      15410059
154200                                                                  15420059
154300     EXEC SQL                                                     15430059
154400         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 15440059
154500     END-EXEC                                                     15450059
154600                                                                  15460059
154700     EVALUATE TRUE                                                15470059
154800        WHEN SQLCODE = ZERO                                       15480059
154900            CONTINUE                                              15490059
155000                                                                  15500059
155100        WHEN SQLWARN0 NOT = SPACES                                15510059
155200        WHEN SQLCODE  NOT = ZERO                                  15520059
155300            DISPLAY '**************************************'      15530059
155400            DISPLAY '** ABEND                            **'      15540059
155500            DISPLAY '** PROGRAM = XLKUT023               **'      15550059
155600            DISPLAY '** PARAGRAPH = 2150-SET-CURRENT-TMST**'      15560059
155700            DISPLAY '** SET CURRENT TIMESTAMP            **'      15570059
155800            DISPLAY '** SQLCODE = ' SQLCODE                       15580059
155900            DISPLAY '**************************************'      15590059
156000            PERFORM 9100-SQL-ABEND-ROUTINE                        15600059
156100     END-EVALUATE.                                                15610059
156200                                                                  15620059
156300******************************************************************15630059
156400* SET THE CURRENT DATE.                                           15640059
156500* PV-CURRENT-DATE IS ONLY USED IN PARA 2165-CHECK-PO-AFTER-UPDATE 15650059
156600* TO CONTROL TH PRINTING OF A PO AFTER A HDR_STATUS_CHANGE.       15660059
156700* PRINTING OF PO'S IS RESTRICTED TO THOSE WITH STATUS-CDE = 'AP'  15670059
156800* AND ORD-DTE = CURRENT DATE.                                     15680059
156900                                                                  15690059
157000* TO KEEP THIS WORKING STORAGE DATE REALLY CURRENT,               15700059
157100* THE XLPO TASK HAD TO BE ENDED AND RESTARTED                     15710059
157200* EVERY NIGHT AT JUST PAST MIDNIGHT.                              15720059
157300* PARA 2165- HAS BEEN CHANGED TO USE THE DB2 'CURRENT DATE'       15730059
157400* PREDICATE INSTEAD.                                              15740059
157500******************************************************************15750059
157600*2155-SET-CURRENT-DATE.                                           15760059
157700*                                                                 15770059
157800*                                                                 15780059
157900*    IF PV-DEBUG-SW = 'Y'                                         15790059
158000*        DISPLAY 'XLKUT023 - 2155-SET-CURRENT-DATE'               15800059
158100*    END-IF.                                                      15810059
158200*                                                                 15820059
158300*    EXEC SQL                                                     15830059
158400*        SET :PV-CURRENT-DATE = CURRENT DATE                      15840059
158500*    END-EXEC                                                     15850059
158600*                                                                 15860059
158700*    EVALUATE TRUE                                                15870059
158800*       WHEN SQLCODE = ZERO                                       15880059
158900*           CONTINUE                                              15890059
159000*                                                                 15900059
159100*       WHEN SQLWARN0 NOT = SPACES                                15910059
159200*       WHEN SQLCODE  NOT = ZERO                                  15920059
159300*           DISPLAY '**************************************'      15930059
159400*           DISPLAY '** ABEND                            **'      15940059
159500*           DISPLAY '** PROGRAM = XLKUT023               **'      15950059
159600*           DISPLAY '** PARAGRAPH = 2155-SET-CURRENT-DATE**'      15960059
159700*           DISPLAY '** SET CURRENT DATE                 **'      15970059
159800*           DISPLAY '** SQLCODE = ' SQLCODE                       15980059
159900*           DISPLAY '**************************************'      15990059
160000*           PERFORM 9100-SQL-ABEND-ROUTINE                        16000059
160100*    END-EVALUATE.                                                16010059
160200*                                                                 16020059
160300****************************************************************  16030059
160400*CHECK PO BEFORE UPDATE                                           16040059
160500****************************************************************  16050059
160600 2160-CHECK-PO-BEFORE-UPDATE.                                     16060059
160700                                                                  16070059
160800     IF PV-DEBUG-SW = 'Y'                                         16080059
160900         DISPLAY 'XLKUT023 - 2160-CHECK-PO-BEFORE-UPDATE'         16090059
161000     END-IF.                                                      16100059
161100                                                                  16110059
161200     MOVE '2160-CHECK-PO-BEFORE-UPDATE' TO PV-PARAGRAPH-NAME.     16120059
161300     MOVE XL011-ORDER-NBR               TO DK-PO-NBR.             16130059
161400                                                                  16140059
161500     EXEC SQL                                                     16150059
161600          SELECT PO_NBR                                           16160059
161700            INTO :PURCHS-PO-NBR                                   16170059
161800            FROM TPURCHS                                          16180059
161900          WHERE PO_NBR         = :DK-PO-NBR                       16190059
162000            AND VER_STATUS_CDE = 'A'                              16200059
162100            AND STATUS_CDE     IN ('WK', 'PA')                    16210059
162200            AND ORD_DTE        = '0001-01-01'                     16220059
162300            AND PO_TYP_CDE NOT IN ('VN', 'IN', 'CD')              16230059
162400     END-EXEC.                                                    16240059
162500                                                                  16250059
162600     EVALUATE TRUE                                                16260059
162700        WHEN SQLCODE = 0                                          16270059
162800             SET PS-PRINT-YES TO TRUE                             16280059
162900        WHEN OTHER                                                16290059
163000             SET PS-PRINT-NO  TO TRUE                             16300059
163100     END-EVALUATE.                                                16310059
163200     IF PV-DEBUG-SW = 'Y'                                         16320059
163300         DISPLAY 'PS-PRINT-SW = ' PS-PRINT-SW                     16330059
163400     END-IF.                                                      16340059
163500                                                                  16350059
163600                                                                  16360059
163700****************************************************************  16370059
163800*CHECK PO AFTER UPDATE                                            16380059
163900****************************************************************  16390059
164000 2165-CHECK-PO-AFTER-UPDATE.                                      16400059
164100                                                                  16410059
164200     IF PV-DEBUG-SW = 'Y'                                         16420059
164300         DISPLAY 'XLKUT023 - 2165-CHECK-PO-AFTER-UPDATE'          16430059
164400     END-IF.                                                      16440059
164500                                                                  16450059
164600     MOVE '2165-CHECK-PO-AFTER-UPDATE'  TO PV-PARAGRAPH-NAME.     16460059
164700     MOVE XL011-ORDER-NBR               TO DK-PO-NBR.             16470059
164800                                                                  16480059
164900     EXEC SQL                                                     16490059
165000          SELECT PO_NBR                                           16500059
165100            INTO :PURCHS-PO-NBR                                   16510059
165200            FROM TPURCHS                                          16520059
165300          WHERE PO_NBR         = :DK-PO-NBR                       16530059
165400            AND VER_STATUS_CDE = 'A'                              16540059
165500            AND STATUS_CDE     = 'AP'                             16550059
165600            AND ORD_DTE        = CURRENT DATE                     16560059
165700     END-EXEC.                                                    16570059
165800                                                                  16580059
165900     EVALUATE TRUE                                                16590059
166000        WHEN SQLCODE = 0                                          16600059
166100             SET PS-PRINT-YES TO TRUE                             16610059
166200        WHEN OTHER                                                16620059
166300             SET PS-PRINT-NO  TO TRUE                             16630059
166400     END-EVALUATE.                                                16640059
166500     IF PV-DEBUG-SW = 'Y'                                         16650059
166600         DISPLAY 'PS-PRINT-SW = ' PS-PRINT-SW                     16660059
166700     END-IF.                                                      16670059
166800                                                                  16680059
166900******************************************************************16690059
167000**UPDATE MESSAGES AND TABLES AFTER EACH BUSINESS EVENT            16700059
167100******************************************************************16710059
167200 2175-UPDATE-MESSAGES-TABLES.                                     16720059
167300                                                                  16730059
167400     IF PV-DEBUG-SW = 'Y'                                         16740059
167500         DISPLAY 'XLKUT023 - 2175-UPDATE-MESSAGES-TABLES'         16750059
167600     END-IF.                                                      16760059
167700                                                                  16770059
167800     IF PS-PROCESS-CONTINUE-YES                                   16780059
167900         PERFORM 2300-COMMIT-MESSAGE                              16790059
168000     ELSE                                                         16800059
168100         IF (PC-CALL-MSGCNTL-PGM AND XL011-SQL-NOT-FOUND)         16810059
168200           OR XL011-BYPASS-MESSAGES                               16820059
168300             PERFORM 2300-COMMIT-MESSAGE                          16830059
168400             PERFORM 2600-ROLLBACK-DB2                            16840059
168500         ELSE                                                     16850059
168600             PERFORM 2500-PUT-ON-ERROR-QUEUE                      16860059
168700             PERFORM 2300-COMMIT-MESSAGE                          16870059
168800             PERFORM 2600-ROLLBACK-DB2                            16880059
168900         END-IF                                                   16890059
169000     END-IF.                                                      16900059
169100****************************************************************  16910059
169200*COMMIT DATA TO DB2                                               16920059
169300****************************************************************  16930059
169400 2200-COMMIT-DB2.                                                 16940059
169500                                                                  16950059
169600     IF PV-DEBUG-SW = 'Y'                                         16960059
169700         DISPLAY 'XLKUT023 - 2200-COMMIT-DB2'                     16970059
169800     END-IF.                                                      16980059
169900                                                                  16990059
170000     MOVE '2200-COMMIT-DB2' TO PV-PARAGRAPH-NAME.                 17000059
170100                                                                  17010059
170200     EXEC SQL                                                     17020059
170300          COMMIT                                                  17030059
170400     END-EXEC.                                                    17040059
170500                                                                  17050059
170600     EVALUATE TRUE                                                17060059
170700        WHEN SQLCODE = 0                                          17070059
170800             CONTINUE                                             17080059
170900        WHEN OTHER                                                17090059
171000             DISPLAY 'UNABLE TO COMMIT DATA'                      17100059
171100             PERFORM 8100-BACK-OUT-MQV-CHANGES                    17110059
171200*            PERFORM 8300-DISCONNECT-QMGR                         17120059
171300             SET PS-DISCONNECT-YES TO TRUE                        17130059
171400             PERFORM 9100-SQL-ABEND-ROUTINE                       17140059
171500     END-EVALUATE.                                                17150059
171600                                                                  17160059
171700******************************************************************17170059
171800**REMOVES MESSAGE FROM QUEUE                                      17180059
171900******************************************************************17190059
172000 2300-COMMIT-MESSAGE.                                             17200059
172100                                                                  17210059
172200     IF PV-DEBUG-SW = 'Y'                                         17220059
172300         DISPLAY 'XLKUT023 - 2300-COMMIT-MESSAGE'                 17230059
172400     END-IF.                                                      17240059
172500                                                                  17250059
172600     MOVE '2300-COMMIT-MESSAGE'          TO PV-PARAGRAPH-NAME.    17260059
172700                                                                  17270059
172800     CALL MQV-MQCMIT USING MQV-HCONN                              17280059
172900                           MQV-COMPLETION-CODE                    17290059
173000                           MQV-REASON.                            17300059
173100                                                                  17310059
173200     EVALUATE TRUE                                                17320059
173300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        17330059
173400             CONTINUE                                             17340059
173500        WHEN OTHER                                                17350059
173600             CALL MQV-MQCHECK USING MQV-REASON                    17360059
173700                                    MQV-REASON-TEXT               17370059
173800             MOVE 'ERROR COMMITING DATA' TO PV-OPERATION-MSG-1    17380059
173900             PERFORM 8100-BACK-OUT-MQV-CHANGES                    17390059
174000*            PERFORM 8300-DISCONNECT-QMGR                         17400059
174100             SET PS-DISCONNECT-YES TO TRUE                        17410059
174200             PERFORM 9000-MQ-ABEND                                17420059
174300     END-EVALUATE.                                                17430059
174400                                                                  17440059
174500******************************************************************17450059
174600**WRITES MESSAGE TO A LOG TABLE IN CASE RECOVERY IS NEEDED        17460059
174700******************************************************************17470059
174800 2400-BACKUP-MESSAGE.                                             17480059
174900                                                                  17490059
175000     IF PV-DEBUG-SW = 'Y'                                         17500059
175100         DISPLAY 'XLKUT023 - 2400-BACKUP-MESSAGE'                 17510059
175200     END-IF.                                                      17520059
175300                                                                  17530059
175400     PERFORM 2401-IS-THIS-A-PACK                                  17540059
175500** DO NOT BACKUP MESSAGE FOR CALLED PROGRAM XLKUP017              17550059
175600                                                                  17560059
175700     IF PS-PACK-NO                                                17570059
175800         INITIALIZE DCLDST00004                                   17580059
175900                                                                  17590059
176000         PERFORM 2405-FIND-SEGMENT-LENGTH                         17600059
176100         ADD 28                  TO PV-LENGTH                     17610059
176200         MOVE PV-LENGTH          TO DST00004-MSG-TXT-LEN          17620059
176300         MOVE XL011-DATA         TO DST00004-MSG-TXT-TEXT         17630059
176400                                                                  17640059
176500**       INSERT BACKUP RECORD                                     17650059
176600                                                                  17660059
176700         EXEC SQL                                                 17670059
176800             INSERT INTO DST_EVNT_MSG_LOG                         17680059
176900                  (BEG_MSG_TMST,                                  17690059
177000                   END_MSG_TMST,                                  17700059
177100                   MSG_TXT)                                       17710059
177200             VALUES                                               17720059
177300                  (CURRENT TIMESTAMP                              17730059
177400                ,  CURRENT TIMESTAMP                              17740059
177500                ,  :DST00004-MSG-TXT)                             17750059
177600         END-EXEC                                                 17760059
177700                                                                  17770059
177800         EVALUATE TRUE                                            17780059
177900             WHEN SQLCODE = +0                                    17790059
178000                 ADD +1     TO PA-MESSAGES-WRITTEN-TO-BKUP        17800059
178100             WHEN OTHER                                           17810059
178200                 DISPLAY '************************************'   17820059
178300                 DISPLAY '** ABEND                          **'   17830059
178400                 DISPLAY '** PROGRAM = XLKUT023             **'   17840059
178500                 DISPLAY '** PARAGRAPH = 2400-BACKUP-MESSAGE *'   17850059
178600                 DISPLAY '** TABLE = DST_EVNT_MSG_LOG       **'   17860059
178700                 DISPLAY '** SQLCODE = ' SQLCODE                  17870059
178800                 DISPLAY '************************************'   17880059
178900                 PERFORM 9100-SQL-ABEND-ROUTINE                   17890059
179000         END-EVALUATE                                             17900059
179100     ELSE                                                         17910059
179200         CONTINUE                                                 17920059
179300     END-IF.                                                      17930059
179400                                                                  17940059
179500 2401-IS-THIS-A-PACK.                                             17950059
179600        EVALUATE XL011-MSG-ID                                     17960059
179700            WHEN 'ORD_PACK_ADD'                                   17970059
179800            WHEN 'ORD_PACK_HDR_CHANGE'                            17980059
179900            WHEN 'ORD_PACK_REPLACE'                               17990059
180000            WHEN 'ORD_PACK_COST_CHANGE'                           18000059
180100            WHEN 'PACK_COMP_ADD'                                  18010059
180200            WHEN 'PACK_COMP_CHANGE'                               18020059
180300            WHEN 'ORD_PACK_RTL_CHANGE'                            18030059
180400                 SET PS-PACK-YES      TO TRUE                     18040059
180500             WHEN OTHER                                           18050059
180600                 SET PS-PACK-NO       TO TRUE                     18060059
180700                                                                  18070059
180800     END-EVALUATE.                                                18080059
180900                                                                  18090059
181000 2405-FIND-SEGMENT-LENGTH.                                        18100059
181100                                                                  18110059
181200     IF PV-DEBUG-SW = 'Y'                                         18120059
181300         DISPLAY 'XLKUT023 - 2405-FIND-SEGMENT-LENGTH'            18130059
181400     END-IF.                                                      18140059
181500                                                                  18150059
181600     EVALUATE XL011-MSG-ID                                        18160059
181700         WHEN 'HDR_ADD'                                           18170059
181800             MOVE LENGTH OF XL011-HDR-ADD          TO PV-LENGTH   18180059
181900         WHEN 'HDR_CHANGE'                                        18190059
182000             MOVE LENGTH OF XL011-HDR-CHANGE       TO PV-LENGTH   18200059
182100         WHEN 'HDR_ATTR_CHANGE'                                   18210059
182200             MOVE LENGTH OF XL011-HDR-ATTR-CHG     TO PV-LENGTH   18220059
182300         WHEN 'HDR_IMPRT_CHANGE'                                  18230059
182400             MOVE LENGTH OF XL011-IMPRT-CHG        TO PV-LENGTH   18240059
182500         WHEN 'HDR_IMPRT_ATT_CHANGE'                              18250059
182600             MOVE LENGTH OF XL011-IMPRT-ATT-CHG    TO PV-LENGTH   18260059
182700         WHEN 'HDR_STATUS_CHANGE'                                 18270059
182800             MOVE LENGTH OF XL011-STATUS-CHG       TO PV-LENGTH   18280059
182900         WHEN 'ORD_ORIG_CTRY_CHANGE'                              18290059
183000             MOVE LENGTH OF XL011-HDR-ORIG-CTY-CHG TO PV-LENGTH   18300059
183100         WHEN 'HDR_DELETE'                                        18310059
183200             MOVE 28                               TO PV-LENGTH   18320059
183300         WHEN 'ORD_DISCOUNT_ADD'                                  18330059
183400             MOVE LENGTH OF XL011-ORD-DISC-ADD     TO PV-LENGTH   18340059
183500         WHEN 'ORD_DISCOUNT_CHANGE'                               18350059
183600             MOVE LENGTH OF XL011-ORD-DISC-CHG     TO PV-LENGTH   18360059
183700         WHEN 'ORD_DISCOUNT_DELETE'                               18370059
183800             MOVE LENGTH OF XL011-ORD-DISC-DEL     TO PV-LENGTH   18380059
183900         WHEN 'SPECIAL_INSTR_ADD'                                 18390059
184000             MOVE LENGTH OF XL011-SPEC-INSTR-ADD   TO PV-LENGTH   18400059
184100         WHEN 'SPECIAL_INSTR_DELETE'                              18410059
184200             MOVE LENGTH OF XL011-SPEC-INSTR-DEL   TO PV-LENGTH   18420059
184300         WHEN 'ORD_SKU_ADD'                                       18430059
184400             MOVE LENGTH OF XL011-SKU-ADD          TO PV-LENGTH   18440059
184500         WHEN 'ORD_SKU_COST_CHANGE'                               18450059
184600             MOVE LENGTH OF XL011-SKU-COST-CHG     TO PV-LENGTH   18460059
184700         WHEN 'ORD_SKU_ATTR_CHANGE'                               18470059
184800             MOVE LENGTH OF XL011-SKU-ATTR-CHG     TO PV-LENGTH   18480059
184900         WHEN 'ORD_QTY_CHANGE'                                    18490059
185000             MOVE LENGTH OF XL011-SKU-QTY-CHG      TO PV-LENGTH   18500059
185100         WHEN 'ORD_SKU_DELETE'                                    18510059
185200             MOVE LENGTH OF XL011-SKU-DEL          TO PV-LENGTH   18520059
185300         WHEN 'ORD_LOCATION_ADD'                                  18530059
185400             MOVE LENGTH OF XL011-LOCATION-ADD     TO PV-LENGTH   18540059
185500         WHEN 'ORD_LOC_QTY_CHANGE'                                18550059
185600             MOVE LENGTH OF XL011-LOC-QTY-CHNG     TO PV-LENGTH   18560059
185700         WHEN 'ORD_LOC_ATT_CHANGE'                                18570059
185800             MOVE LENGTH OF XL011-LOC-ATT-CHG      TO PV-LENGTH   18580059
185900         WHEN 'ORD_LOCATION_DELETE'                               18590059
186000             MOVE LENGTH OF XL011-LOC-DEL          TO PV-LENGTH   18600059
186100         WHEN 'STORE_ADD'                                         18610059
186200             MOVE LENGTH OF XL011-STORE-ADD        TO PV-LENGTH   18620059
186300         WHEN 'STORE_QTY_CHANGE'                                  18630059
186400             MOVE LENGTH OF XL011-STORE-QTY-CHG    TO PV-LENGTH   18640059
186500         WHEN 'STORE_ATTR_CHANGE'                                 18650059
186600             MOVE LENGTH OF XL011-STORE-ATTR-CHG   TO PV-LENGTH   18660059
186700         WHEN 'STORE_DELETE'                                      18670059
186800             MOVE LENGTH OF XL011-STORE-DEL        TO PV-LENGTH   18680059
186900         WHEN OTHER                                               18690059
187000             MOVE 500                              TO PV-LENGTH   18700059
187100     END-EVALUATE.                                                18710059
187200/                                                                 18720059
187300******************************************************************18730059
187400**PUTS MESSAGE THAT HAD ERROR ON ERROR QUEUE                      18740059
187500******************************************************************18750059
187600 2500-PUT-ON-ERROR-QUEUE.                                         18760059
187700                                                                  18770059
187800     IF PV-DEBUG-SW = 'Y'                                         18780059
187900         DISPLAY 'XLKUT023 - 2500-PUT-ON-ERROR-QUEUE'             18790059
188000     END-IF.                                                      18800059
188100                                                                  18810059
188200     INITIALIZE WS-ERROR-Q-REC.                                   18820059
188300     MOVE '2500-PUT-ON-ERROR-QUEUE' TO PV-PARAGRAPH-NAME.         18830059
188400                                                                  18840059
188500     MOVE CC-LOC-ERROR-QUEUE-NAME TO MQOD-OBJECTNAME.             18850059
188600     MOVE CC-QUEUE-MANAGER-NAME   TO MQOD-OBJECTQMGRNAME.         18860059
188700                                                                  18870059
188800     COMPUTE MQPMO-OPTIONS = MQPMO-NONE                           18880059
188900                           + MQPMO-FAIL-IF-QUIESCING.             18890059
189000* POPULATE ERROR QUEUE WITH TIMESTAMP AND DATA                    18900059
189100     PERFORM 2150-SET-CURRENT-TMST.                               18910059
189200     MOVE PV-CURRENT-TMST         TO WS-TIMESTAMP.                18920059
189300     MOVE XLRD011-RECORD          TO WS-XLRD011-REC.              18930059
189400     MOVE WS-ERROR-Q-REC          TO MQV-ERRMSGBUF.               18940059
189500                                                                  18950059
189600* POPULATE CORRELID FIELD                                         18960059
189700     MOVE XL011-ORDER-NBR         TO MQMD-CORRELID.               18970059
189800     MOVE +1026                   TO MQV-MSG-LENGTH               18980059
189900                                                                  18990059
190000     CALL MQV-MQPUT USING MQV-HCONN                               19000059
190100                          MQV-LOC-HANDLE2                         19010059
190200                          MQM-MESSAGE-DESCRIPTOR                  19020059
190300                          MQM-PUT-MESSAGE-OPTIONS                 19030059
190400                          MQV-MSG-LENGTH                          19040059
190500                          MQV-ERRMSGBUF                           19050059
190600                          MQV-COMPLETION-CODE                     19060059
190700                          MQV-REASON.                             19070059
190800                                                                  19080059
190900     EVALUATE TRUE                                                19090059
191000        WHEN MQV-COMPLETION-CODE = MQCC-OK                        19100059
191100             ADD +1                 TO PA-MESSAGES-TO-ERROR-QUEUE 19110059
191200        WHEN OTHER                                                19120059
191300             DISPLAY 'UNABLE TO WRITE TO LOC ERROR QUEUE'         19130059
191400             CALL MQV-MQCHECK USING MQV-REASON                    19140059
191500                                    MQV-REASON-TEXT               19150059
191600             MOVE 'MQPUT ERROR'      TO PV-OPERATION-MSG-1        19160059
191700*            PERFORM 8300-DISCONNECT-QMGR                         19170059
191800             SET PS-DISCONNECT-YES TO TRUE                        19180059
191900             PERFORM 9000-MQ-ABEND                                19190059
192000     END-EVALUATE.                                                19200059
192100                                                                  19210059
192200******************************************************************19220059
192300**ROLLBACK DB2 CHANGES                                            19230059
192400******************************************************************19240059
192500 2600-ROLLBACK-DB2.                                               19250059
192600                                                                  19260059
192700     IF PV-DEBUG-SW = 'Y'                                         19270059
192800         DISPLAY 'XLKUT023 - 2600-ROLLBACK-DB2'                   19280059
192900     END-IF.                                                      19290059
193000                                                                  19300059
193100*    COPY DPPD004.                                                19310059
193200                                                                  19320059
193300     IF SQLCODE NOT = -911                                        19330059
193400         EXEC SQL                                                 19340059
193500              ROLLBACK                                            19350059
193600         END-EXEC                                                 19360059
193700     END-IF.                                                      19370059
193800                                                                  19380059
193900                                                                  19390059
194000*    MOVE +4013                TO PV-ABEND-CODE.                  19400059
194100*    CALL 'ILBOABN0' USING PV-ABEND-CODE.                         19410061
194200/                                                                 19420059
194300******************************************************************19430059
194400**RETRIEVES NEXT MESSAGE FROM THE LOCATION QUEUE                  19440059
194500******************************************************************19450059
194600 8000-RETRIEVE-MESSAGE.                                           19460059
194700                                                                  19470059
194800     IF PV-DEBUG-SW = 'Y'                                         19480059
194900         DISPLAY '##############################'                 19490059
195000         DISPLAY 'XLKUT023 - 8000-RETRIEVE-MESSAGE'               19500059
195100     END-IF.                                                      19510059
195200                                                                  19520059
195300     MOVE '8000-RETRIEVE-MESSAGE' TO PV-PARAGRAPH-NAME.           19530059
195400                                                                  19540059
195500     INITIALIZE MQV-MSGBUFFER                                     19550059
195600                MQV-ERRMSGBUF                                     19560059
195700                MQV-MSG.                                          19570059
195800                                                                  19580059
195900     MOVE MQMI-NONE            TO MQMD-MSGID.                     19590059
196000     MOVE MQCI-NONE            TO MQMD-CORRELID.                  19600059
196100     MOVE MQFMT-STRING         TO MQMD-FORMAT.                    19610059
196200                                                                  19620059
196300*** THE UNLIMITED WAIT INTERVAL MEANS THAT PROCESSING WILL        19630059
196400*** CONTINUE UNTIL A END-OF-RUN MESSAGE APPEARS ON THE Q.         19640059
196500     MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.             19650059
196600                                                                  19660059
196700     MOVE +1000000                TO MQV-MSG-LENGTH               19670059
196800                                                                  19680059
196900     COMPUTE MQGMO-OPTIONS  =  MQGMO-WAIT +                       19690059
197000                               MQGMO-SYNCPOINT +                  19700059
197100                               MQGMO-CONVERT   +                  19710059
197200                               MQGMO-FAIL-IF-QUIESCING.           19720059
197300                                                                  19730059
197400     CALL MQV-MQGET USING MQV-HCONN                               19740059
197500                          MQV-LOC-HANDLE1                         19750059
197600                          MQM-MESSAGE-DESCRIPTOR                  19760059
197700                          MQM-GET-MESSAGE-OPTIONS                 19770059
197800                          MQV-MSG-LENGTH                          19780059
197900                          MQV-MSGBUFFER                           19790059
198000                          MQV-DATA-LENGTH                         19800059
198100                          MQV-COMPLETION-CODE                     19810059
198200                          MQV-REASON.                             19820059
198300                                                                  19830059
198400                                                                  19840059
198500     IF  MQV-COMPLETION-CODE = MQCC-OK                            19850059
198600         ADD +1                TO PA-MESSAGE-FROM-QUEUE           19860059
198700         INITIALIZE XLRD011-RECORD                                19870059
198800         MOVE MQV-MSGBUFFER    TO XLRD011-RECORD                  19880059
198900         MOVE MQV-MSGBUFFER    TO PV-MSG                          19890059
199000         ADD MQV-DATA-LENGTH   TO PA-TOT-DATA-LENGTH              19900059
199100         COMPUTE PA-TOT-DATA-LENGTH-350 =                         19910059
199200                 PA-TOT-DATA-LENGTH-350 +                         19920059
199300                 (MQV-DATA-LENGTH + 350)                          19930059
199400         END-COMPUTE                                              19940059
199500                                                                  19950059
199600         IF XL011-MSG-ID = 'STORE_ADD'                            19960059
199700             MOVE XL011-ORDER-NBR         TO PV-CURR-PO-NBR       19970059
199800             MOVE XL011-STRA-COMP-SKU-NBR TO PV-CURR-SKU-NBR      19980059
199900             MOVE XL011-STRA-LOCATION     TO PV-CURR-DEST         19990059
200000         END-IF                                                   20000059
200100                                                                  20010059
200200*   DISABLED 10/3/2007                                            20020059
200300*        EXEC SQL                                                 20030059
200400*            SELECT                                               20040059
200500*                HOUR (CURRENT TIME)                              20050059
200600*            ,   CURRENT TIME                                     20060059
200700*            INTO                                                 20070059
200800*                :PV-HOUR                                         20080059
200900*            ,   :PV-TIME                                         20090059
201000*            FROM SYSIBM.SYSDUMMY1                                20100059
201100*        END-EXEC                                                 20110059
201200*        SET PT-TRAFFIC-IDX           TO 1                        20120059
201300*        SEARCH PT-TRAFFIC                                        20130059
201400*            WHEN PT-HOUR(PT-TRAFFIC-IDX) = PV-HOUR               20140059
201500*                ADD +1              TO PT-COUNT(PT-TRAFFIC-IDX)  20150059
201600*                ADD MQV-DATA-LENGTH TO                           20160059
201700*                        PT-VOLUME (PT-TRAFFIC-IDX)               20170059
201800*                ADD 350             TO PT-VOLUME (PT-TRAFFIC-IDX)20180059
201900*                IF PT-DEPTH-SW (PT-TRAFFIC-IDX) = 'Y'            20190059
202000*                    CONTINUE                                     20200059
202100*                ELSE                                             20210059
202200*                    PERFORM 8001-INQ-QUEUE-DEPTH                 20220059
202300*                    MOVE 'Y' TO PT-DEPTH-SW (PT-TRAFFIC-IDX)     20230059
202400*                END-IF                                           20240059
202500*        END-SEARCH                                               20250059
202600*   DISABLED 10/3/2007                                            20260059
202700                                                                  20270059
202800                                                                  20280059
202900*        REPLACE TKRPRPM WITH AN MQ MESSAGE                       20290059
203000                                                                  20300059
203100         EVALUATE TRUE                                            20310059
203200         WHEN PV-DEBUG-SW = 'N'                                   20320059
203300             IF PV-DEBUG-YES                                      20330059
203400               MOVE 'Y'                 TO PV-DEBUG-SW            20340059
203500               DISPLAY '**************************************'   20350059
203600               DISPLAY 'TURNING DEBUG SWITCH ON'                  20360059
203700               DISPLAY '**************************************'   20370059
203800             END-IF                                               20380059
203900         WHEN PV-DEBUG-SW = 'Y'                                   20390059
204000             IF PV-DEBUG-NO                                       20400059
204100               MOVE 'N'                 TO PV-DEBUG-SW            20410059
204200               DISPLAY '**************************************'   20420059
204300               DISPLAY 'TURNING DEBUG SWITCH OFF'                 20430059
204400               DISPLAY '**************************************'   20440059
204500             END-IF                                               20450059
204600         WHEN OTHER                                               20460059
204700               MOVE 'N'                 TO PV-DEBUG-SW            20470059
204800         END-EVALUATE                                             20480059
204900                                                                  20490059
205000*        MOVE XL011-ORDER-NBR  TO PV-PO-NBR-TO-GET                20500059
205100*                                 PV-CURR-PO-NBR                  20510059
205200                                                                  20520059
205300         PERFORM 7010-DISPLAY-MSGS                                20530059
205400                                                                  20540059
205500         EXEC SQL SET :PV-PARM-TIMESTAMP = CURRENT TIMESTAMP      20550059
205600         END-EXEC                                                 20560059
205700                                                                  20570059
205800*    REMOVED 4/30/2009.  TOO MANY LINES TO SYSOUT                 20580059
205900*        DISPLAY 'P.O.=' XL011-ORDER-NBR, ' MSG ID. ='            20590059
206000*        XL011-MSG-ID '/' PV-PARM-TIMESTAMP                       20600059
206100*        ' / ' XL011-DATA-AREA(1:45)                              20610059
206200                                                                  20620059
206300         PERFORM 2400-BACKUP-MESSAGE                              20630059
206400         PERFORM 2200-COMMIT-DB2                                  20640059
206500         PERFORM 2300-COMMIT-MESSAGE                              20650059
206600                                                                  20660059
206700     ELSE                                                         20670059
206800         EVALUATE TRUE                                            20680059
206900             WHEN MQV-REASON = MQRC-NO-MSG-AVAILABLE              20690059
207000                 SET PS-PROCESS-COMPLETE-YES TO TRUE              20700059
207100             WHEN OTHER                                           20710059
207200                 CALL MQV-MQCHECK USING MQV-REASON                20720059
207300                                   MQV-REASON-TEXT                20730059
207400                 MOVE 'ERROR RETRIEVING MESSAGE'                  20740059
207500                                TO PV-OPERATION-MSG-1             20750059
207600                 PERFORM 8100-BACK-OUT-MQV-CHANGES                20760059
207700*                PERFORM 8300-DISCONNECT-QMGR                     20770059
207800                 SET PS-DISCONNECT-YES TO TRUE                    20780059
207900                 PERFORM 9000-MQ-ABEND                            20790059
208000         END-EVALUATE                                             20800059
208100     END-IF.                                                      20810059
208200                                                                  20820059
208300     IF PV-DEBUG-YES OR PV-DEBUG-NO                               20830059
208400         ADD 1                        TO PA-DEBUG-MESSAGES        20840059
208500     END-IF                                                       20850059
208600                                                                  20860059
208700*** THE END OF PROGRAM MSG WILL SHUT DOWN THE STARTED TASK        20870059
208800*** AND SET A 4050 RETURN CODE.                                   20880059
208900                                                                  20890059
209000     IF PV-END-RUN-MSG                                            20900059
209100                                                                  20910059
209200         ADD +1      TO PA-END-OF-RUN-MESSAGES                    20920059
209300         SUBTRACT 1 FROM PA-MESSAGE-FROM-QUEUE                    20930059
209400         PERFORM 8200-WRAPUP                                      20940059
209500         MOVE 4050 TO RETURN-CODE                                 20950059
209600         GOBACK                                                   20960059
209700     END-IF.                                                      20970059
209800                                                                  20980059
209900*** THE STOP SUBSCRIBING MESSAGE WILL SHUT DOWN                   20990059
210000*** THE STARTED TASK WITH A ZERO RETURN CODE                      21000059
210100     IF PV-STOP-SUB-MSG                                           21010059
210200                                                                  21020059
210300         ADD +1      TO PA-STOP-PROC-MESSAGES                     21030059
210400         SUBTRACT 1 FROM PA-MESSAGE-FROM-QUEUE                    21040059
210500         PERFORM 8200-WRAPUP                                      21050059
210600         GOBACK                                                   21060059
210700     END-IF.                                                      21070059
210800                                                                  21080059
210900     IF PV-SNAPSHOT                                               21090059
211000         DISPLAY SPACES                                           21100059
211100         DISPLAY '*****************  SNAPSHOT ***************'    21110059
211200         PERFORM 8800-DISPLAY-STATISTICS                          21120059
211300     END-IF.                                                      21130059
211301                                                                  21130159
211302*   DISABLED 10/3/2007                                            21130200
211303*8001-INQ-QUEUE-DEPTH.                                            21130359
211304*                                                                 21130405
211305*    THIS RETURNS THE NUMBER OF MESSAGE STILL IN THE QUEUE.       21130559
211306*                                                                 21130659
211307*    MOVE MQIA-CURRENT-Q-DEPTH TO PV-Q-DEPTH.                     21130705
211308*                                                                 21130804
211309*    CALL WS-MQINQ USING                                          21130929
211310*                 MQV-HCONN                                       21131005
211311*                 PV-GQ-HANDLE                                    21131105
211312*                 PV-SELECT-COUNT                                 21131226
211313*                 PV-SELECTORS                                    21131306
211314*                 PV-INTATTR-COUNT                                21131406
211315*                 PV-INTATTRS                                     21131506
211316*                 PV-CHARATTR-LENGTH                              21131606
211317*                 PV-CHARATTRS                                    21131706
211318*                 MQV-COMPLETION-CODE                             21131859
211319*                 MQV-REASON.                                     21131959
211320*                                                                 21132006
211330*    IF PV-COMPLETION-CODE = MQCC-OK                              21133000
211331*        DISPLAY SPACES                                           21133159
211332*        MOVE PV-Q-DEPTH-ATTR         TO PV-DISP-NBR              21133206
211333*        DISPLAY PV-TIME ' QUEUE DEPTH: ', PV-DISP-NBR            21133306
211334*        MOVE PV-Q-DEPTH-ATTR TO PT-DEPTH (PT-TRAFFIC-IDX)        21133427
211335*    END-IF.                                                      21133500
211336*   DISABLED 10/3/2007                                            21133600
211337                                                                  21133700
211338/                                                                 21133859
211339                                                                  21133959
211340 7005-SELECT-TKRPRPM-PRT.                                         21134059
211350                                                                  21135059
211360*    THIS PARMS DOES NOT EXIST IN DB2P AS OF 1/18/2007            21136059
211370*    THEREFORE THE SWITCH IS ALWAYS 'Y'                           21137059
211380*    IF IT WERE TO EXIST IN PROD THE SWITCH WOULD ALWAYS          21138059
211390*    BE AN 'N'.   THIS IS TRULY WIERD.                            21139059
211400                                                                  21140059
211500     MOVE 'N'                         TO PV-POPRT-SW              21150059
211600     EXEC SQL                                                     21160059
211700         SELECT                                                   21170059
211800             FUNC_TXT                                             21180059
211900         INTO                                                     21190059
212000            :PV-POPRT-SW                                          21200059
212100         FROM TKRPRPM                                             21210059
212200         WHERE                                                    21220059
212300             LOC_ID = 90                                          21230059
212400         AND INTFC_SYS_CDE = 'KHL'                                21240059
212500         AND SYS_PRC_FUNC_CDE = 'RMSPRT'                          21250059
212600     END-EXEC.                                                    21260059
212700                                                                  21270059
212800     EVALUATE TRUE                                                21280059
212900         WHEN SQLCODE = +0                                        21290059
213000             CONTINUE                                             21300059
213100         WHEN SQLCODE = +100                                      21310059
213200             MOVE 'Y'                 TO PV-POPRT-SW              21320059
213300         WHEN OTHER                                               21330059
213400             MOVE SQLCODE    TO XL011-SQLCODE                     21340059
213500             MOVE '7005-SELECT-TKRPRPM-PRT'                       21350059
213600                             TO XL011-ERROR-PARAGRAPH             21360059
213700             MOVE 'XLKUT023' TO XL011-ERROR-PROGRAM               21370059
213800             MOVE 'TKRPRPM'  TO XL011-DB2-TABLE-NAME(1)           21380059
213900     END-EVALUATE.                                                21390059
214000                                                                  21400059
214100***************************************************************** 21410059
214200**DISPLAY MESSAGES BASED ON DEBUG SWITCH BEING 'Y'                21420059
214300***************************************************************** 21430059
214400 7010-DISPLAY-MSGS.                                               21440059
214500     IF PV-DEBUG-SW = 'Y'                                         21450059
214600         DISPLAY 'P.O.= ' XL011-ORDER-NBR, DISPLAY ' MSG ID. = '  21460059
214700         XL011-MSG-ID '  ' PV-PARM-TIMESTAMP                      21470059
214800     END-IF.                                                      21480059
214900/                                                                 21490059
215000 7100-GET-PURITM-RTL.                                             21500059
215100                                                                  21510059
215200     IF PV-DEBUG-SW = 'Y'                                         21520059
215300         DISPLAY 'XLKUT023 - 7100-GET-PURITM-RTL'                 21530059
215400     END-IF.                                                      21540059
215500                                                                  21550059
215600     EXEC SQL                                                     21560059
215700         SELECT                                                   21570059
215800             PO_LNE_NBR                                           21580059
215900         ,   PUR.ITM_NBR                                          21590059
216000         ,   UNT_RTL_PR_AMT                                       21600059
216100         ,   GP_RTL_AMT                                           21610059
216200         ,   GP_QTY                                               21620059
216300         INTO                                                     21630059
216400             :PURITM-PO-LNE-NBR                                   21640059
216500         ,   :PURITM-ITM-NBR                                      21650059
216600         ,   :PURITM-UNT-RTL-PR-AMT                               21660059
216700         ,   :PURITM-GP-RTL-AMT                                   21670059
216800         ,   :PURITM-GP-QTY                                       21680059
216900     FROM                                                         21690059
217000         TPURITM PUR                                              21700059
217100       , XLT_SKU SKU                                              21710059
217200     WHERE                                                        21720059
217300         PO_NBR                   = :PURITM-PO-NBR                21730059
217400     AND                                                          21740059
217500         SKU.SKU_NBR              = :XLT00003-SKU-NBR             21750059
217600     AND                                                          21760059
217700         PUR.ITM_NBR              = SKU.ITM_NBR                   21770059
217800     AND                                                          21780059
217900         PUR.VER_STATUS_CDE       = 'A'                           21790059
218000     AND  PUR.CRE_TMST =                                          21800059
218100         ( SELECT MAX(B.CRE_TMST)                                 21810059
218200           FROM                                                   21820059
218300           TPURITM B                                              21830059
218400           WHERE                                                  21840059
218500                 PUR.PO_NBR            = B.PO_NBR                 21850059
218600            AND  PUR.ITM_NBR           = B.ITM_NBR                21860059
218700            )                                                     21870059
218800     END-EXEC.                                                    21880059
218900                                                                  21890059
219000     EVALUATE TRUE                                                21900059
219100         WHEN SQLCODE = ZERO                                      21910059
219200         WHEN SQLCODE = +100                                      21920059
219300             CONTINUE                                             21930059
219400         WHEN OTHER                                               21940059
219500             MOVE SQLCODE    TO XL011-SQLCODE                     21950059
219600             MOVE '7100-GET-PURITM-RTL'                           21960059
219700                             TO XL011-ERROR-PARAGRAPH             21970059
219800             MOVE 'XLKUT023' TO XL011-ERROR-PROGRAM               21980059
219900             MOVE 'TPURITM'  TO XL011-DB2-TABLE-NAME(1)           21990059
220000             MOVE 'XLT_SKU'  TO XL011-DB2-TABLE-NAME(2)           22000059
220100     END-EVALUATE.                                                22010059
220200/                                                                 22020059
220300*7110-GET-AUDIT.                                                  22030059
220400*                                                                 22040059
220500*    IF PV-DEBUG-SW = 'Y'                                         22050059
220600*        DISPLAY 'XLKUT023 - 7110-GET-AUDIT'                      22060059
220700*    END-IF.                                                      22070059
220800*                                                                 22080059
220900*    EXEC SQL                                                     22090059
221000*        SELECT                                                   22100059
221100*            SUM (UNT_RTL_AMT)                                    22110059
221200*        INTO                                                     22120059
221300*            :DST00000-UNT-RTL-AMT:DN-RTL-NULL                    22130059
221400*    FROM                                                         22140059
221500*        DST_PO_ITM_MODIF AUD                                     22150059
221600*    WHERE                                                        22160059
221700*        PO_NBR                   = :PURITM-PO-NBR                22170059
221800*    AND                                                          22180059
221900*        ITM_NBR                  = :PURITM-ITM-NBR               22190059
222000*    AND                                                          22200059
222100*        PO_PREPK_ID              = 0                             22210059
222200*                                                                 22220059
222300*    END-EXEC.                                                    22230059
222400*                                                                 22240059
222500*    IF PV-DEBUG-SW = 'Y'                                         22250059
222600*        DISPLAY 'XLKUT023 - RTL-AMT: '                           22260059
222700*             DST00000-UNT-RTL-AMT ' NULLID= '                    22270059
222800*             DN-RTL-NULL                                         22280059
222900*    END-IF.                                                      22290059
223000*                                                                 22300059
223100*    EVALUATE TRUE                                                22310059
223200*        WHEN SQLCODE = ZERO                                      22320059
223300*        WHEN SQLCODE = +100                                      22330059
223400*            CONTINUE                                             22340059
223500*        WHEN OTHER                                               22350059
223600*            MOVE SQLCODE    TO XL011-SQLCODE                     22360059
223700*            MOVE '7110-GET-AUDIT'                                22370059
223800*                            TO XL011-ERROR-PARAGRAPH             22380059
223900*            MOVE 'XLKUT023'         TO XL011-ERROR-PROGRAM       22390059
224000*            MOVE 'DST_PO_ITM_MODIF'  TO XL011-DB2-TABLE-NAME(1)  22400059
224100*    END-EVALUATE.                                                22410059
224200/                                                                 22420059
224201                                                                  22420159
224202 7200-FIND-PO-LINE-TALLPLN.                                       22420210
224203     IF XL011-DEBUG-YES                                           22420310
224204         DISPLAY 'XLKUT023 - 7200-FIND-PO-LINE-TALLPLN'           22420410
224205         DISPLAY 'DK-SKU-NBR ' DK-SKU-NBR                         22420510
224206         DISPLAY 'DK-PO-NBR  ' DK-PO-NBR                          22420610
224207         DISPLAY 'DK-DEST-NBR '  DK-DEST-NBR                      22420710
224208     END-IF                                                       22420810
224209                                                                  22420910
224210     MOVE +0   TO      PURITM-PO-LNE-NBR                          22421059
224220                       PURITM-PREPK-RATO-QTY                      22422059
224230                       ALLPLN-PLAN-NBR                            22423059
224231                                                                  22423159
224232     EXEC SQL                                                     22423210
224233     SELECT                                                       22423310
224234            PUR.PO_LNE_NBR                                        22423410
224235     ,      PUR.PREPK_RATO_QTY                                    22423510
224236     ,      TALL.PLAN_NBR                                         22423611
224237     INTO                                                         22423710
224238         :PURITM-PO-LNE-NBR                                       22423810
224239     ,   :PURITM-PREPK-RATO-QTY                                   22423910
224240     ,   :ALLPLN-PLAN-NBR                                         22424011
224241     FROM                                                         22424110
224242         XLT_SKU      SKU                                         22424210
224243     ,   TPURITM      PUR                                         22424310
224244     ,   TALLPLN      TALL                                        22424410
224245     ,   TPURCHS      PO                                          22424510
224246     WHERE                                                        22424610
224247        SKU.SKU_NBR                = :DK-SKU-NBR                  22424710
224248    AND PUR.PO_NBR                 = :DK-PO-NBR                   22424810
224249    AND PO.PO_NBR                  = PUR.PO_NBR                   22424910
224250    AND PUR.PO_PREPK_ID            = 0                            22425010
224251    AND PUR.VER_STATUS_CDE         = 'A'                          22425110
224252    AND PUR.ITM_NBR                = SKU.ITM_NBR                  22425210
224253    AND PUR.PO_NBR                 = TALL.PO_NBR                  22425310
224254    AND PUR.PO_LNE_NBR             = TALL.PO_LNE_NBR              22425410
224255    AND TALL.DEST_NBR              = :DK-DEST-NBR                 22425510
224256     END-EXEC.                                                    22425610
224257                                                                  22425710
224258     MOVE SQLCODE                     TO XL011-SQLCODE            22425810
224259     EVALUATE TRUE                                                22425910
224260         WHEN SQLCODE = ZERO                                      22426010
224261         WHEN SQLCODE = -811                                      22426110
224262             SET PS-PURITM-EXISTS-YES                             22426213
224263                 PS-PO-EXISTS-YES     TO TRUE                     22426316
224264         WHEN SQLCODE = +100                                      22426410
224265             IF PV-DEBUG-SW = 'Y'                                 22426559
224266                DISPLAY 'XL023 -7200 NOT FOUND +100 '             22426659
224267             END-IF                                               22426759
224268             SET PS-PURITM-EXISTS-NO                              22426813
224269                 PS-PO-EXISTS-NO      TO TRUE                     22426916
224270       WHEN OTHER                                                 22427010
224271             SET XL011-SQL-ERROR                                  22427110
224272                 PS-PROCESS-END       TO TRUE                     22427210
224273             MOVE '7201-FIND-TPURITM-TALLPLN'                     22427313
224274                                      TO XL011-ERROR-PARAGRAPH    22427410
224275             MOVE 'XLT_SKU'           TO XL011-DB2-TABLE-NAME(1)  22427510
224276             MOVE 'TPURITM'           TO XL011-DB2-TABLE-NAME(2)  22427610
224277             MOVE 'TALLPLN'           TO XL011-DB2-TABLE-NAME(3)  22427713
224278             MOVE 'TPURCHS'           TO XL011-DB2-TABLE-NAME(4)  22427813
224279                                                                  22427959
224280             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           22428059
224290             MOVE DK-SKU-NBR          TO PV-DISP-SKU-NBR          22429059
224300             MOVE DK-DEST-NBR         TO PV-DISP-DEST             22430059
224400             DISPLAY 'XLKUT023 -'                                 22440059
224500             DISPLAY 'XL023-7200 WHEN OTHER LOGIC '               22450059
224600             DISPLAY 'XL023-7200-SQLCODE = ' SQLCODE              22460059
224700             DISPLAY 'XL023-PO NUMBER ' PV-DISP-PO-NBR            22470059
224800             DISPLAY 'XL023-SKU-NBR   ' PV-DISP-SKU-NBR           22480059
224900             DISPLAY 'XL023-DEST-NBR  ' PV-DISP-DEST              22490059
225000             PERFORM 2150-SET-CURRENT-TMST                        22500059
225100             MOVE PV-CURRENT-TMST       TO WS-TIMESTAMP           22510059
225101             DISPLAY 'XL023-7200-TMST' WS-TIMESTAMP               22510159
225102     END-EVALUATE.                                                22510210
225103/                                                                 22510359
225104***************************************************************** 22510459
225105**ROLLBACK MQ CHANGES                                             22510559
225106***************************************************************** 22510659
225107*                                                                 22510759
225108 8100-BACK-OUT-MQV-CHANGES.                                       22510859
225109                                                                  22510959
225110     IF PV-DEBUG-SW = 'Y'                                         22511059
225120         DISPLAY 'XLKUT023 - 8100-BACK-OUT-MQV-CHANGES'           22512059
225130     END-IF.                                                      22513059
225140                                                                  22514059
225150     CALL MQV-MQBACK USING MQV-HCONN                              22515059
225160                           MQV-COMPLETION-CODE                    22516059
225170                           MQV-REASON.                            22517059
225180                                                                  22518059
225190     EVALUATE TRUE                                                22519059
225200        WHEN MQV-COMPLETION-CODE = MQCC-OK                        22520059
225300             CONTINUE                                             22530059
225400        WHEN OTHER                                                22540059
225500             CALL MQV-MQCHECK USING MQV-REASON                    22550059
225600                                    MQV-REASON-TEXT               22560059
225700             MOVE 'MQBACK ERROR'  TO PV-OPERATION-MSG-1           22570059
225800*            PERFORM 8300-DISCONNECT-QMGR                         22580059
225900             SET PS-DISCONNECT-YES TO TRUE                        22590059
226000             PERFORM 9000-MQ-ABEND                                22600059
226100     END-EVALUATE.                                                22610059
226200                                                                  22620059
226300****************************************************************  22630059
226400*END OF PROGRAM ROUTINE                                           22640059
226500****************************************************************  22650059
226600 8200-WRAPUP.                                                     22660059
226700                                                                  22670059
226800*        UPDATE TPURCHS FOR LAST PROCESSED MESSAGE                22680059
226900     PERFORM 2125-TPURCH-END-PROCESS                              22690059
227000                                                                  22700059
227100     PERFORM 8400-CLOSE-MSG-QUEUE.                                22710059
227200     PERFORM 8450-CLOSE-ERR-QUEUE.                                22720059
227300                                                                  22730059
227400*    DISABLED 10/3/2007                                           22740059
227500*    PERFORM 8460-CLOSE-INQ-THREAD.                               22750059
227600*    DISABLED 10/3/2007                                           22760059
227700                                                                  22770059
227800*    PERFORM 8300-DISCONNECT-QMGR                                 22780059
227900     SET PS-DISCONNECT-YES TO TRUE                                22790059
228000                                                                  22800059
228100     CLOSE CONTROL-CARD-1                                         22810059
228200           CONTROL-CARD-2                                         22820059
228300           CONTROL-CARD-3                                         22830059
228400                                                                  22840059
228500     PERFORM 8800-DISPLAY-STATISTICS.                             22850059
228600                                                                  22860059
228700     IF PA-MESSAGES-TO-ERROR-QUEUE > 0                            22870059
228800         SET ABEND-4095-NOTIFY TO TRUE                            22880059
228900         MOVE ABEND-CODE TO RETURN-CODE                           22890059
229000     END-IF.                                                      22900059
229100                                                                  22910059
229200***************************************************************** 22920059
229300**DISCONNECT FROM THE QUEUE MANAGER                               22930059
229400***************************************************************** 22940059
229500 8300-DISCONNECT-QMGR.                                            22950059
229600                                                                  22960059
229700     CALL MQV-MQDISC USING MQV-HCONN                              22970059
229800                           MQV-COMPLETION-CODE                    22980059
229900                           MQV-REASON.                            22990059
230000                                                                  23000059
230100     EVALUATE TRUE                                                23010059
230200        WHEN MQV-COMPLETION-CODE = MQCC-OK                        23020059
230300             CONTINUE                                             23030059
230400        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                23040059
230500             CALL MQV-MQCHECK USING MQV-REASON                    23050059
230600                                    MQV-REASON-TEXT               23060059
230700             MOVE 'MQDISC ERROR'       TO PV-OPERATION-MSG-1      23070059
230800             SET PS-DISCONNECT-NO TO TRUE                         23080059
230900             PERFORM 9000-MQ-ABEND                                23090059
231000     END-EVALUATE.                                                23100059
231100                                                                  23110059
231200***************************************************************** 23120059
231300**CLOSE MSG AND ERROR QUEUES                                      23130059
231400***************************************************************** 23140059
231500 8400-CLOSE-MSG-QUEUE.                                            23150059
231600                                                                  23160059
231700     CALL MQV-MQCLOSE USING MQV-HCONN                             23170059
231800                            MQV-LOC-HANDLE1                       23180059
231900                            MQCO-NONE                             23190059
232000                            MQV-COMPLETION-CODE                   23200059
232100                            MQV-REASON.                           23210059
232200                                                                  23220059
232300     EVALUATE TRUE                                                23230059
232400        WHEN MQV-COMPLETION-CODE = MQCC-OK                        23240059
232500             CONTINUE                                             23250059
232600        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                23260059
232700             CALL MQV-MQCHECK USING MQV-REASON                    23270059
232800                                    MQV-REASON-TEXT               23280059
232900             MOVE 'CANNOT CLOSE MSG QUEUE' TO PV-OPERATION-MSG-1  23290059
233000             PERFORM 9000-MQ-ABEND                                23300059
233100     END-EVALUATE.                                                23310059
233200                                                                  23320059
233300***************************************************************** 23330059
233400 8450-CLOSE-ERR-QUEUE.                                            23340059
233500                                                                  23350059
233600     CALL MQV-MQCLOSE USING MQV-HCONN                             23360059
233700                            MQV-LOC-HANDLE2                       23370059
233800                            MQCO-NONE                             23380059
233900                            MQV-COMPLETION-CODE                   23390059
234000                            MQV-REASON.                           23400059
234100                                                                  23410059
234200     EVALUATE TRUE                                                23420059
234300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        23430059
234400             CONTINUE                                             23440059
234500        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                23450059
234600             CALL MQV-MQCHECK USING MQV-REASON                    23460059
234700                                    MQV-REASON-TEXT               23470059
234800             MOVE 'CANNOT CLOSE ERR QUEUE' TO PV-OPERATION-MSG-1  23480059
234900             PERFORM 9000-MQ-ABEND                                23490059
235000     END-EVALUATE.                                                23500059
235100                                                                  23510059
235200* DISABLED 10/3/2007                                              23520059
235300*                                                                 23530059
235301*8460-CLOSE-INQ-THREAD.                                           23530159
235302*                                                                 23530206
235303*    CALL MQV-MQCLOSE USING MQV-HCONN                             23530359
235304*                           PV-GQ-HANDLE                          23530459
235305*                           MQCO-NONE                             23530559
235306*                           MQV-COMPLETION-CODE                   23530659
235307*                           MQV-REASON.                           23530759
235308*                                                                 23530859
235309*    EVALUATE TRUE                                                23530959
235310*       WHEN MQV-COMPLETION-CODE = MQCC-OK                        23531059
235320*            CONTINUE                                             23532059
235330*       WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                23533059
235340*            CALL MQV-MQCHECK USING MQV-REASON                    23534059
235350*                                   MQV-REASON-TEXT               23535059
235360*            MOVE 'CANNOT CLOSE INQ QUEUE' TO PV-OPERATION-MSG-1  23536059
235370*            DISPLAY PV-OPERATION-MSG-1                           23537059
235380*    END-EVALUATE.                                                23538059
235381* DISABLED 10/3/2007                                              23538159
235382                                                                  23538206
235383***************************************************************** 23538359
235384**READ CONTROL CARD 1                                             23538459
235385***************************************************************** 23538559
235386 8500-READ-CONTROL-CARD-1.                                        23538659
235387                                                                  23538759
235388     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1-LAYOUT.           23538859
235389                                                                  23538959
235390***************************************************************** 23539059
235400**READ CONTROL CARD 2                                             23540059
235500***************************************************************** 23550059
235600 8600-READ-CONTROL-CARD-2.                                        23560059
235700                                                                  23570059
235800     READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2-LAYOUT.           23580059
235900                                                                  23590059
236000***************************************************************** 23600059
236100**READ CONTROL CARD 3                                             23610059
236200***************************************************************** 23620059
236300 8700-READ-CONTROL-CARD-3.                                        23630059
236400                                                                  23640059
236500     READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3-LAYOUT.           23650059
236600                                                                  23660059
236700****************************************************************  23670059
236800*DISPLAY PROGRAM STATISTICS FOR THIS RUN                          23680059
236900****************************************************************  23690059
237000 8800-DISPLAY-STATISTICS.                                         23700059
237100                                                                  23710059
237200     EXEC SQL                                                     23720059
237300         SELECT                                                   23730059
237400             DATE (CURRENT TIMESTAMP)                             23740059
237500         ,   TIME (CURRENT TIMESTAMP)                             23750059
237600         INTO                                                     23760059
237700             :PV-DATE                                             23770059
237800         ,   :PV-TIME                                             23780059
237900         FROM SYSIBM.SYSDUMMY1                                    23790059
238000     END-EXEC.                                                    23800059
238100       DISPLAY '*********************************************'.   23810059
238200       DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.          23820059
238300       DISPLAY 'DATE: ' PV-DATE '  TIME: ' PV-TIME.               23830059
238400       DISPLAY '*********************************************'.   23840059
238500                                                                  23850059
238600       MOVE PA-MESSAGE-FROM-QUEUE           TO PV-DISP-NBR        23860059
238700       DISPLAY 'MESSAGES FROM QUEUE:             ' PV-DISP-NBR    23870059
238800                                                                  23880059
238900       MOVE PA-MESSAGES-WRITTEN-TO-BKUP TO PV-DISP-NBR            23890059
239000       DISPLAY 'MESSAGES WRITTEN TO BKUP:        ' PV-DISP-NBR    23900059
239100                                                                  23910059
239200       MOVE PA-MESSAGES-TO-ERROR-QUEUE      TO PV-DISP-NBR        23920059
239300       DISPLAY 'MESSAGES WRITTEN TO ERROR QUEUE: ' PV-DISP-NBR    23930059
239400                                                                  23940059
239500       MOVE PA-MESSAGES-UPDATED             TO PV-DISP-NBR        23950059
239600       DISPLAY 'MESSAGES UPDATED ON BKUP:        ' PV-DISP-NBR    23960059
239700                                                                  23970059
239800       MOVE PA-PO-LIST-MESSAGES             TO PV-DISP-NBR        23980059
239900       DISPLAY 'PO LISTS PRINTED:                ' PV-DISP-NBR    23990059
240000                                                                  24000059
240100       MOVE PA-END-OF-RUN-MESSAGES          TO PV-DISP-NBR        24010059
240200       DISPLAY 'END OF RUN MESSAGES              ' PV-DISP-NBR    24020059
240300                                                                  24030059
240400       MOVE PA-STOP-PROC-MESSAGES           TO PV-DISP-NBR        24040059
240500       DISPLAY 'STOP PROC MESSAGES               ' PV-DISP-NBR    24050059
240600                                                                  24060059
240700       MOVE PA-ODD-UNITS                    TO PV-DISP-NBR        24070059
240800       DISPLAY 'ODD UNIT SKU MESSAGES            ' PV-DISP-NBR    24080059
240900                                                                  24090059
241000       MOVE PA-RMS-TMST-UPD-CNT             TO PV-DISP-NBR        24100059
241100       DISPLAY 'TPURCHS RMS-TMST UPDATES         ' PV-DISP-NBR    24110059
241200                                                                  24120059
241300       MOVE PA-DEBUG-MESSAGES               TO PV-DISP-NBR        24130059
241400       DISPLAY 'DEBUG MESSAGES                   ' PV-DISP-NBR    24140059
241500                                                                  24150059
241600       MOVE PA-NOT-PROCESSED                 TO PV-DISP-NBR       24160059
241700       DISPLAY 'MESSAGES NOT PROCESSED           ' PV-DISP-NBR    24170059
241800                                                                  24180059
241900       MOVE PA-TOT-DATA-LENGTH              TO PV-DISP-NBR-BIG    24190059
242000       DISPLAY 'TOTAL LENGTH OF ALL MESSAGES     '                24200059
242100                                      PV-DISP-NBR-BIG             24210059
242200                                                                  24220059
242300       MOVE PA-TOT-DATA-LENGTH-350          TO PV-DISP-NBR-BIG    24230059
242400       DISPLAY 'TOTAL MSG LENGTH PLUS MQ HEADERS '                24240059
242500                                      PV-DISP-NBR-BIG             24250059
242600                                                                  24260059
242700       DISPLAY SPACES                                             24270059
242800                                                                  24280059
242900       MOVE PA-HDR-ADD-MESSAGES             TO PV-DISP-NBR        24290059
243000       DISPLAY 'HDR_ADD                          ' PV-DISP-NBR    24300059
243100                                                                  24310059
243200       MOVE PA-HDR-CHG-MESSAGES             TO PV-DISP-NBR        24320059
243300       DISPLAY 'HDR_CHANGE                       ' PV-DISP-NBR    24330059
243400                                                                  24340059
243500       MOVE PA-HDR-ATTR-CHG-MESSAGES        TO PV-DISP-NBR        24350059
243600       DISPLAY 'HDR_ATTR_CHANGE                  ' PV-DISP-NBR    24360059
243700                                                                  24370059
243800       MOVE PA-HDR-IMPRT-CHG-MESSAGES       TO PV-DISP-NBR        24380059
243900       DISPLAY 'HDR_IMPRT_CHANGE                 ' PV-DISP-NBR    24390059
244000                                                                  24400059
244100       MOVE PA-HDR-IMPRT-ATTCHG-MESSAGES TO PV-DISP-NBR           24410059
244200       DISPLAY 'HDR_IMPRT_ATT_CHANGE             ' PV-DISP-NBR    24420059
244300                                                                  24430059
244400       MOVE PA-HDR-STAT-CHG-MESSAGES         TO PV-DISP-NBR       24440059
244500       DISPLAY 'HDR_STATUS_CHANGE                ' PV-DISP-NBR    24450059
244600                                                                  24460059
244700       MOVE PA-HDR-ORIG-CTRYCHG-MESSAGES TO PV-DISP-NBR           24470059
244800       DISPLAY 'HDR_ORIG_CTRY_CHANGE             ' PV-DISP-NBR    24480059
244900                                                                  24490059
245000       MOVE PA-HDR-DEL-MESSAGES              TO PV-DISP-NBR       24500059
245100       DISPLAY 'HDR_DELETE                       ' PV-DISP-NBR    24510059
245200                                                                  24520059
245300       DISPLAY SPACES                                             24530059
245400                                                                  24540059
245500       MOVE PA-ORD-DISC-ADD-MESSAGES         TO PV-DISP-NBR       24550059
245600       DISPLAY 'ORD_DISCOUNT_ADD                 ' PV-DISP-NBR    24560059
245700                                                                  24570059
245800       MOVE PA-ORD-DISC-CHG-MESSAGES         TO PV-DISP-NBR       24580059
245900       DISPLAY 'ORD_DISCOUNT_CHANGE              ' PV-DISP-NBR    24590059
246000                                                                  24600059
246100       MOVE PA-ORD-DISC-DEL-MESSAGES         TO PV-DISP-NBR       24610059
246200       DISPLAY 'ORD_DISCOUNT_DELETE              ' PV-DISP-NBR    24620059
246300                                                                  24630059
246400       MOVE PA-SPEC-INSTR-ADD-MESSAGES       TO PV-DISP-NBR       24640059
246500       DISPLAY 'SPECIAL_INSTR_ADD                ' PV-DISP-NBR    24650059
246600                                                                  24660059
246700       MOVE PA-SPEC-INSTR-DEL-MESSAGES       TO PV-DISP-NBR       24670059
246800       DISPLAY 'SPECIAL_INSTR_DELETE             ' PV-DISP-NBR    24680059
246900                                                                  24690059
247000       DISPLAY SPACES                                             24700059
247100                                                                  24710059
247200       MOVE PA-ORD-SKU-ADD-MESSAGES          TO PV-DISP-NBR       24720059
247300       DISPLAY 'ORD_SKU_ADD                      ' PV-DISP-NBR    24730059
247400                                                                  24740059
247500       MOVE PA-ORD-SKU-CHG-MESSAGES          TO PV-DISP-NBR       24750059
247600       DISPLAY 'ORD_SKU_COST_CHANGE              ' PV-DISP-NBR    24760059
247700                                                                  24770059
247800       MOVE PA-ORD-SKU-ATTR-CHG-MESSAGES TO PV-DISP-NBR           24780059
247900       DISPLAY 'ORD_SKU_ATTR_CHANGE              ' PV-DISP-NBR    24790059
248000                                                                  24800059
248100       MOVE PA-ORD-QTY-CHG-MESSAGES          TO PV-DISP-NBR       24810059
248200       DISPLAY 'ORD_QTY_CHANGE                   ' PV-DISP-NBR    24820059
248300                                                                  24830059
248400       MOVE PA-ORD-QTY-DEL-MESSAGES          TO PV-DISP-NBR       24840059
248500       DISPLAY 'ORD_SKU_DELETE                   ' PV-DISP-NBR    24850059
248600                                                                  24860059
248700       DISPLAY SPACES                                             24870059
248800                                                                  24880059
248900       MOVE PA-ORD-PAK-ADD-MESSAGES          TO PV-DISP-NBR       24890059
249000       DISPLAY 'ORD_PACK_ADD                     ' PV-DISP-NBR    24900059
249100                                                                  24910059
249200       MOVE PA-ORD-PAK-HDRCHG-MESSAGES       TO PV-DISP-NBR       24920059
249300       DISPLAY 'ORD_PACK_HDR_CHANGE              ' PV-DISP-NBR    24930059
249400                                                                  24940059
249500       MOVE PA-ORD-PAK-RPL-MESSAGES          TO PV-DISP-NBR       24950059
249600       DISPLAY 'ORD_PACK_REPLACE                 ' PV-DISP-NBR    24960059
249700                                                                  24970059
249800       MOVE PA-ORD-PAK-RTLCHG-MESSAGES       TO PV-DISP-NBR       24980059
249900       DISPLAY 'ORD_PACK_RTL_CHANGE              ' PV-DISP-NBR    24990059
250000                                                                  25000059
250100       MOVE PA-ORD-PAK-CSTCHG-MESSAGES       TO PV-DISP-NBR       25010059
250200       DISPLAY 'ORD_PACK_COST_CHANGE             ' PV-DISP-NBR    25020059
250300                                                                  25030059
250400       MOVE PA-PACK-COMP-ADD-MESSAGES        TO PV-DISP-NBR       25040059
250500       DISPLAY 'PACK_COMP_ADD                    ' PV-DISP-NBR    25050059
250600                                                                  25060059
250700       MOVE PA-PACK-COMP-CHG-MESSAGES        TO PV-DISP-NBR       25070059
250800       DISPLAY 'PACK_COMP_CHANGE                 ' PV-DISP-NBR    25080059
250900                                                                  25090059
251000       DISPLAY SPACES                                             25100059
251100                                                                  25110059
251200       MOVE PA-ORD-LOC-ADD-MESSAGES          TO PV-DISP-NBR       25120059
251300       DISPLAY 'ORD_LOCATION_ADD                 ' PV-DISP-NBR    25130059
251400                                                                  25140059
251500       MOVE PA-ORD-LOC-QTYCHG-MESSAGES       TO PV-DISP-NBR       25150059
251600       DISPLAY 'ORD_LOC_QTY_CHANGE               ' PV-DISP-NBR    25160059
251700                                                                  25170059
251800       MOVE PA-ORD-LOC-ATTCHG-MESSAGES       TO PV-DISP-NBR       25180059
251900       DISPLAY 'ORD_LOC_ATT_CHANGE               ' PV-DISP-NBR    25190059
252000                                                                  25200059
252100       MOVE PA-ORD-LOC-DEL-MESSAGES          TO PV-DISP-NBR       25210059
252200       DISPLAY 'ORD_LOCATION_DELETE              ' PV-DISP-NBR    25220059
252300                                                                  25230059
252400       DISPLAY SPACES                                             25240059
252500                                                                  25250059
252600       MOVE PA-STORE-ADD-MESSAGES            TO PV-DISP-NBR       25260059
252700       DISPLAY 'STORE_ADD                        ' PV-DISP-NBR    25270059
252800                                                                  25280059
252900       MOVE PA-STORE-QTY-CHG-MESSAGES        TO PV-DISP-NBR       25290059
253000       DISPLAY 'STORE_QTY_CHANGE                 ' PV-DISP-NBR    25300059
253100                                                                  25310059
253200       MOVE PA-STORE-ATTR-CHG-MESSAGES       TO PV-DISP-NBR       25320059
253300       DISPLAY 'STORE_ATTR_CHANGE                ' PV-DISP-NBR    25330059
253400                                                                  25340059
253500       MOVE PA-STORE-DEL-MESSAGES            TO PV-DISP-NBR       25350059
253600       DISPLAY 'STORE_DELETE                     ' PV-DISP-NBR    25360059
253700                                                                  25370059
253800*    DISABLED 10/3/2007                                           25380059
253900*    DISPLAY SPACES                                               25390059
254000*    DISPLAY DL-STATS-HDR-LINE                                    25400059
254100*    PERFORM VARYING PT-TRAFFIC-IDX FROM 1 BY 1 UNTIL             25410059
254200*                       PT-TRAFFIC-IDX > 24                       25420059
254300*        MOVE PT-HOUR (PT-TRAFFIC-IDX)                            25430059
254400*                                     TO DL-HOUR                  25440059
254500*        MOVE PT-VOLUME (PT-TRAFFIC-IDX)                          25450059
254600*                                     TO DL-VOLUME                25460059
254700*        MOVE PT-DEPTH  (PT-TRAFFIC-IDX)                          25470059
254800*                                     TO DL-DEPTH                 25480059
254900*        MOVE PT-COUNT (PT-TRAFFIC-IDX)                           25490059
255000*                                     TO DL-COUNT                 25500059
255100*        DISPLAY DL-STATS-DTL-LINE                                25510059
255200*    END-PERFORM.                                                 25520059
255300*    DISABLED 10/3/2007                                           25530059
255400                                                                  25540059
255500     DISPLAY '*********************************************'.     25550059
255600                                                                  25560059
255700******************************************************************25570059
255800**MQ ABEND ROUTINE                                                25580059
255900******************************************************************25590059
256000 9000-MQ-ABEND.                                                   25600059
256100                                                                  25610059
256200     MOVE +4020 TO ABEND-CODE.                                    25620059
256300                                                                  25630059
256400     DISPLAY '**** ABEND *************************************'.  25640059
256500     DISPLAY '** MQSERIES ERROR **'.                              25650059
256600     DISPLAY '** PROGRAM:    ' PC-CURRENT-PROGRAM-NAME.           25660059
256700     DISPLAY '** ABEND CODE: ' ABEND-CODE.                        25670059
256800     DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH-NAME.                 25680059
256900     DISPLAY '** MESSAGE:    ' PV-OPERATION-MSG-1.                25690059
257000     DISPLAY '** COMP CODE:  ' MQV-COMPLETION-CODE.               25700059
257100     DISPLAY '** RSN CODE:   ' MQV-REASON.                        25710059
257200     DISPLAY '** RSN TEXT:   ' MQV-REASON-TEXT.                   25720059
257300     DISPLAY '************************************************'.  25730059
257400     IF PS-DISCONNECT-YES                                         25740059
257500        PERFORM 8300-DISCONNECT-QMGR                              25750059
257600     END-IF                                                       25760059
257700     CALL 'ILBOABN0' USING ABEND-CODE.                            25770059
257800                                                                  25780059
257900******************************************************************25790059
258000**SQL ABEND ROUTINE                                               25800059
258100******************************************************************25810059
258200 9100-SQL-ABEND-ROUTINE.                                          25820059
258300                                                                  25830059
258400     DISPLAY '************************************************'.  25840059
258500     DISPLAY '** MSG ORDER NUMBER ' XL011-ORDER-NBR.              25850059
258600     DISPLAY '** MSG ID ' XL011-MSG-ID.                           25860059
258700     DISPLAY '** MSG Q '  XLRD011-RECORD.                         25870059
258800     DISPLAY '************************************************'.  25880059
258900******************************************************************25890059
259000* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     25900059
259100* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      25910059
259200******************************************************************25920059
259300     COPY DPPD004.                                                25930059
259400     SET ABEND-4013-DB2-ERROR TO TRUE.                            25940059
259500     CALL 'ILBOABN0' USING ABEND-CODE.                            25950059
259600                                                                  25960059
