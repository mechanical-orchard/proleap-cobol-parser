000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.             RVKRP002.                                00050099
000600 AUTHOR.                 MICHAEL WALTERS.                         00060099
000700 INSTALLATION.           KOHLS.                                   00070099
000800 DATE-WRITTEN            JANUARY, 1995.                           00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*       THIS PROGRAM PRINTS A LIST OF DEFECTIVE ITEMS THAT ARE    00120099
001300*  GOING TO BE RETURNED TO VENDOR.  IT WILL REPORT ON EVERY ITEM  00130099
001400*  THAT MEETS THE SELECTION CRITERIA ENTERED BY THE USER.         00140099
001500******************************************************************00150099
001600*  CHANGE LOG.                                                    00160099
001700*  DATE         CHANGED BY      DESC                              00170099
001800*  -----------  --------------  ----------------------------------00180099
001900* 04/15/03 - S PRABHAKAR RAO, IGSI - WR NO. 23022                 00190099
002000*    - REPLACED ALL REFERENCES TO TSK, TUPC, TVNDSTL TABLE        00200099
002100*      WITH XLT_SKU,XLT_VND_STYL TABLES                           00210099
002200*    - REPLACED DEPARTMENT, CLASS AND 3 DIGIT SEQUENCE NUMBER     00220099
002300*      WITH 3 DIGIT DEPARTMENT AND 8 DIGIT SKU NUMBER             00230099
002400*      RESPECTIVELY FOR NI SKU CONVERSION.                        00240099
002500*    - INCREASED THE LENGTH OF SORT-WORK-FILE FROM 167 TO 170     00250099
002600*      BYTES.                                                     00260099
002700*    - DELETED THE CODE CALLING PROGRAM UPC CHECK DIGIT ROUTINE   00270099
002800*                                                                 00280099
002900* 10/30/2011   C. STRODTHOFF - GENCO / RTV UPGRADE. CHANGE        00290099
003000*                              OPER-UNT-ID TO RTV-LOC AND ADD TO  00300099
003100*                              REPORT. PRJ ID 3219 - WR40134.     00310099
003200***************************************************************** 00320099
003300                                                                  00330099
003400******************************************************************00340099
003500 ENVIRONMENT DIVISION.                                            00350099
003600******************************************************************00360099
003700                                                                  00370099
003800 CONFIGURATION SECTION.                                           00380099
003900                                                                  00390099
004000 SOURCE-COMPUTER.        IBM-3090.                                00400099
004100 OBJECT-COMPUTER.        IBM-3090.                                00410099
004200                                                                  00420099
004300 INPUT-OUTPUT SECTION.                                            00430099
004400                                                                  00440099
004500 FILE-CONTROL.                                                    00450099
004600                                                                  00460099
004700     SELECT SORT-WORK-FILE                                        00470099
004800         ASSIGN TO SORTWK01                                       00480099
004900                   SORTWK02                                       00490099
005000                   SORTWK03.                                      00500099
005100                                                                  00510099
005200     SELECT DI-DEFECT-ITM-DETAIL-RPT                              00520099
005300         ASSIGN TO RPT01.                                         00530099
005400                                                                  00540099
005500     SELECT DI-DEFECT-ITM-SUM-RPT                                 00550099
005600         ASSIGN TO RPT02.                                         00560099
005700                                                                  00570099
005800******************************************************************00580099
005900 DATA DIVISION.                                                   00590099
006000******************************************************************00600099
006100                                                                  00610099
006200 FILE SECTION.                                                    00620099
006300                                                                  00630099
006400 FD  DI-DEFECT-ITM-DETAIL-RPT                                     00640099
006500     RECORDING MODE IS F                                          00650099
006600     LABEL RECORDS ARE STANDARD                                   00660099
006700     BLOCK CONTAINS 0 RECORDS.                                    00670099
006800                                                                  00680099
006900 01  DI-DEFECT-ITM-DETAIL-LINE           PIC  X(132).             00690099
007000                                                                  00700099
007100 FD  DI-DEFECT-ITM-SUM-RPT                                        00710099
007200     RECORDING MODE IS F                                          00720099
007300     LABEL RECORDS ARE STANDARD                                   00730099
007400     BLOCK CONTAINS 0 RECORDS.                                    00740099
007500                                                                  00750099
007600 01  DI-DEFECT-ITM-SUM-LINE              PIC  X(132).             00760099
007700                                                                  00770099
007800                                                                  00780099
007900 SD  SORT-WORK-FILE                                               00790099
008000     RECORD CONTAINS 170 CHARACTERS                               00800099
008100     DATA RECORD IS SORT-WORK-RECORD.                             00810099
008200                                                                  00820099
008300 01  SORT-WORK-RECORD.                                            00830099
008400     05  SW-BUYER-NBR                PIC X(03).                   00840099
008500     05  SW-BUYER-NAME               PIC X(32).                   00850099
008600     05  SW-STATUS-CHG-DTE           PIC X(10).                   00860099
008700     05  SW-DEPT-NBR                 PIC X(03).                   00870099
008800     05  SW-SKU-NBR                  PIC X(08).                   00880099
008900     05  SW-VND-NBR                  PIC X(09).                   00890099
009000     05  SW-DFCT-ORD-ID              PIC X(06).                   00900099
009100     05  SW-VND-NAME                 PIC X(25).                   00910099
009200     05  SW-VND-STYLE                PIC X(13).                   00920099
009300     05  SW-ORD-DTE                  PIC X(10).                   00930099
009400     05  SW-SKU-DESC                 PIC X(25).                   00940099
009500     05  SW-UNIT-COST-AMT            PIC S9(05)V99 COMP-3.        00950099
009600     05  SW-RETL-COST-AMT            PIC S9(05)V99 COMP-3.        00960099
009700     05  SW-LOC-ID                   PIC X(15).                   00970099
009800     05  SW-DFCT-ORD-ID-CDE          PIC X(01).                   00980099
009900     05  SW-DFCT-ORD-STAT-CDE        PIC X(01).                   00990099
010000     05  SW-MKOUT-ORD-STAT-CDE       PIC X(01).                   01000099
010100******************************************************************01010099
010200 WORKING-STORAGE SECTION.                                         01020099
010300******************************************************************01030099
010400                                                                  01040099
010500*                                                                 01050099
010600*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                01060099
010700*                                                                 01070099
010800     COPY DPWS132O.                                               01080099
010900*                                                                 01090099
011000*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         01100099
011100*                                                                 01110099
011200     COPY DPWS500.                                                01120099
011300                                                                  01130099
011400*                                                                 01140099
011500*  WORK AREA FOR THE NUMERIC EDIT SUBROUTINE.                     01150099
011600*                                                                 01160099
011700     COPY DPWS010I.                                               01170099
011800                                                                  01180099
011900 01  ABEND-CODE                          PIC S9(04) VALUE +0      01190099
012000                                                     COMP SYNC.   01200099
012100                                                                  01210099
012200*                                                                 01220099
012300*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01230099
012400*                                                                 01240099
012500     COPY DPWS004.                                                01250099
012600                                                                  01260099
012700 01  CC-CONTROL-CARD.                                             01270099
012800     05  CC-OPER-UNT-ID                  PIC X(04).               01280099
012900     05  CC-LIST-TYPE-CD                 PIC X(01) VALUE SPACE.   01290099
013000         88  CC-VALID-LIST-TYPE          VALUE 'M', 'R', 'D', 'X',01300099
013100                                               '*'.               01310099
013200         88  CC-LIST-TYPE-MARKOUT        VALUE 'M'.               01320099
013300         88  CC-LIST-TYPE-RTV            VALUE 'R'.               01330099
013400         88  CC-LIST-TYPE-D-AND-D        VALUE 'D'.               01340099
013500         88  CC-LIST-TYPE-ALL            VALUE 'X', '*'.          01350099
013600     05  CC-LIST-STATUS-CD               PIC X(01) VALUE SPACE.   01360099
013700         88  CC-VALID-LIST-STATUS        VALUE 'N', 'O', 'C', 'P',01370099
013800                                          'A', 'S', 'D', 'X', '*'.01380099
013900         88  CC-LIST-STATUS-NEW          VALUE 'N'.               01390099
014000         88  CC-LIST-STATUS-OPEN         VALUE 'O'.               01400099
014100         88  CC-LIST-STATUS-CLOSED       VALUE 'C'.               01410099
014200         88  CC-LIST-STATUS-PENDING      VALUE 'P'.               01420099
014300         88  CC-LIST-STATUS-APPROVED     VALUE 'A'.               01430099
014400         88  CC-LIST-STATUS-SHIPPED      VALUE 'S'.               01440099
014500         88  CC-LIST-STATUS-DISPOSED     VALUE 'D'.               01450099
014600         88  CC-LIST-STATUS-ALL          VALUE 'X', '*'.          01460099
014700     05  CC-STORAGE-LOC-ID               PIC  X(13).              01470099
014800         88  CC-ALL-STORAGE-LOC-ID       VALUE 'SSSSSSSSSSSSS',   01480099
014900                                               '*************'.   01490099
015000     05  CC-BUYER-NBR                    PIC  X(03).              01500099
015100         88  CC-ALL-BUYERS               VALUE 'BBB', '***'.      01510099
015200     05  CC-DEPT-NBR                     PIC  X(03).              01520099
015300         88  CC-ALL-DEPTS                VALUE 'DDD', '***'.      01530099
015400     05  CC-VNDUN-NBR                    PIC  X(09).              01540099
015500         88  CC-ALL-VENDORS              VALUE 'VVVVVVVVV',       01550099
015600                                               '*********'.       01560099
015700     05  CC-START-DATE                   PIC  X(10)  VALUE SPACE. 01570099
015800         88  CC-DEFAULT-START-DATE       VALUE 'DEFAULT   '.      01580099
015900         88  CC-CURRENT-START-DATE       VALUE 'CURRENT   '.      01590099
016000     05  FILLER REDEFINES CC-START-DATE.                          01600099
016100         10  CC-START-CENTURY            PIC  9(02).              01610099
016200         10  CC-START-YEAR               PIC  9(02).              01620099
016300         10  FILLER                      PIC  X(01).              01630099
016400         10  CC-START-MONTH              PIC  9(02).              01640099
016500         10  FILLER                      PIC  X(01).              01650099
016600         10  CC-START-DAY                PIC  9(02).              01660099
016700     05  CC-END-DATE                     PIC  X(10)  VALUE SPACE. 01670099
016800         88  CC-DEFAULT-END-DATE         VALUE 'DEFAULT   '.      01680099
016900         88  CC-CURRENT-END-DATE         VALUE 'CURRENT   '.      01690099
017000     05  FILLER REDEFINES CC-END-DATE.                            01700099
017100         10  CC-END-CENTURY              PIC  9(02).              01710099
017200         10  CC-END-YEAR                 PIC  9(02).              01720099
017300         10  FILLER                      PIC  X(01).              01730099
017400         10  CC-END-MONTH                PIC  9(02).              01740099
017500         10  FILLER                      PIC  X(01).              01750099
017600         10  CC-END-DAY                  PIC  9(02).              01760099
017700     05  CC-REPORT-TYPE                  PIC  X(01).              01770099
017800         88  CC-VALID-REPORT-TYPE       VALUE 'B', 'S', 'D', 'T'. 01780099
017900         88  CC-BOTH-REPORTS             VALUE 'B'.               01790099
018000         88  CC-SUMMARY-REPORT           VALUE 'S', 'B'.          01800099
018100         88  CC-DETAIL-REPORT            VALUE 'D', 'B'.          01810099
018200         88  CC-TOTAL-REPORT             VALUE 'T'.               01820099
018300                                                                  01830099
018400 01  SORT-OUT-RECORD.                                             01840099
018500     05  SO-BUYER-NBR                PIC X(03).                   01850099
018600     05  SO-BUYER-NAME               PIC X(32).                   01860099
018700     05  SO-STATUS-CHG-DTE           PIC X(10).                   01870099
018800     05  SO-DEPT-NBR                 PIC X(03).                   01880099
018900     05  SO-SKU-NBR                  PIC X(08).                   01890099
019000     05  SO-VND-NBR                  PIC X(09).                   01900099
019100     05  SO-DFCT-ORD-ID              PIC X(06).                   01910099
019200     05  SO-VND-NAME                 PIC X(25).                   01920099
019300     05  SO-VND-STYLE                PIC X(13).                   01930099
019400     05  SO-ORD-DTE                  PIC X(10).                   01940099
019500     05  SO-SKU-DESC                 PIC X(25).                   01950099
019600     05  SO-UNIT-COST-AMT            PIC S9(05)V99 COMP-3.        01960099
019700     05  SO-RETL-COST-AMT            PIC S9(05)V99 COMP-3.        01970099
019800     05  SO-LOC-ID                   PIC X(15).                   01980099
019900     05  SO-DFCT-ORD-ID-CDE          PIC X(01).                   01990099
020000     05  SO-DFCT-ORD-STAT-CDE        PIC X(01).                   02000099
020100     05  SO-MKOUT-ORD-STAT-CDE       PIC X(01).                   02010099
020200                                                                  02020099
020300 01  PH2-PAGE-HEADING-2.                                          02030099
020400     05  FILLER                          PIC  X(33)  VALUE SPACE. 02040099
020500     05  FILLER                          PIC  X(45)  VALUE        02050099
020600         'RETURN-TO-VENDOR - INVENTORY DETAIL REPORT - '.         02060099
020700     05  PH2-STORE-NUMBER                PIC  X(4).               02070099
020800     05  FILLER                          PIC  X(1)   VALUE ' '.   02080099
020900     05  PH2-STORE-DESC                  PIC  X(15).              02090099
021000     05  FILLER                          PIC  X(33)  VALUE SPACE. 02100099
021100                                                                  02110099
021200 01  PH2-PAGE-HEADING-2-SUM.                                      02120099
021300     05  FILLER                          PIC  X(33)  VALUE SPACE. 02130099
021400     05  FILLER                          PIC  X(46)  VALUE        02140099
021500         'RETURN-TO-VENDOR - INVENTORY SUMMARY REPORT - '.        02150099
021600     05  PH2S-STORE-NUMBER               PIC  X(4).               02160099
021700     05  FILLER                          PIC  X(1)   VALUE ' '.   02170099
021800     05  PH2S-STORE-DESC                 PIC  X(15).              02180099
021900     05  FILLER                          PIC  X(33)  VALUE SPACE. 02190099
022000                                                                  02200099
022100 01  PH2-PAGE-HEADING-2-TOT.                                      02210099
022200     05  FILLER                          PIC  X(33)  VALUE SPACE. 02220099
022300     05  FILLER                          PIC  X(46)  VALUE        02230099
022400         'RETURN-TO-VENDOR - INVENTORY TOTAL REPORT -   '.        02240099
022500     05  PH2T-STORE-NUMBER               PIC  X(4).               02250099
022600     05  FILLER                          PIC  X(1)   VALUE ' '.   02260099
022700     05  PH2T-STORE-DESC                 PIC  X(15).              02270099
022800     05  FILLER                          PIC  X(33)  VALUE SPACE. 02280099
022900                                                                  02290099
023000 01  PH3-PAGE-HEADING-3.                                          02300099
023100     05  FILLER                          PIC  X(44)  VALUE SPACE. 02310099
023200     05  FILLER                          PIC  X(12)  VALUE        02320099
023300         'BEGIN DATE: '.                                          02330099
023400     05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. 02340099
023500     05  FILLER                          PIC  X(13)  VALUE        02350099
023600         ' - END DATE: '.                                         02360099
023700     05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. 02370099
023800     05  FILLER                          PIC  X(42)  VALUE SPACE. 02380099
023900                                                                  02390099
024000 01  PH5-PAGE-HEADING-5.                                          02400099
024100     05  FILLER                          PIC  X(14)  VALUE        02410099
024200         '  BUYER NAME: '.                                        02420099
024300     05  PH5-BUYER-NAME                  PIC  X(32)  VALUE SPACE. 02430099
024400     05  FILLER                          PIC  X(86)  VALUE SPACE. 02440099
024500                                                                  02450099
024600 01  PH6-PAGE-HEADING-6.                                          02460099
024700     05  FILLER                          PIC  X(14)  VALUE        02470099
024800         'BUYER NUMBER: '.                                        02480099
024900     05  PH6-BUYER-NUMBER                PIC  X(03)  VALUE SPACE. 02490099
025000     05  FILLER                          PIC  X(115) VALUE SPACE. 02500099
025100                                                                  02510099
025200 01  DH1-DETAIL-HEADING-1.                                        02520099
025300     05  FILLER                          PIC  X(03)  VALUE SPACES.02530099
025400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02540099
025500     05  FILLER                          PIC  X(06)  VALUE        02550099
025600         ' LIST '.                                                02560099
025700     05  FILLER                          PIC  X(01)  VALUE SPACE. 02570099
025800     05  FILLER                          PIC  X(05)  VALUE        02580099
025900         'LIST '.                                                 02590099
026000     05  FILLER                          PIC  X(01)  VALUE SPACE. 02600099
026100     05  FILLER                          PIC  X(05)  VALUE        02610099
026200         'LIST '.                                                 02620099
026300     05  FILLER                          PIC  X(02)  VALUE SPACE. 02630099
026400     05  FILLER                          PIC  X(08)  VALUE        02640099
026500         'STATUS  '.                                              02650099
026600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02660099
026700     05  FILLER                          PIC  X(09)  VALUE        02670099
026800         ' CURRENT '.                                             02680099
026900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02690099
027000     05  FILLER                          PIC  X(12)  VALUE SPACES.02700099
027100     05  FILLER                          PIC  X(01)  VALUE SPACE. 02710099
027200     05  FILLER                          PIC  X(10)  VALUE SPACES.02720099
027300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02730099
027400     05  FILLER                          PIC  X(12)  VALUE SPACES.02740099
027500     05  FILLER                          PIC  X(01)  VALUE SPACE. 02750099
027600     05  FILLER                          PIC  X(13)  VALUE SPACES.02760099
027700     05  FILLER                          PIC  X(02)  VALUE SPACE. 02770099
027800     05  FILLER                          PIC  X(08)  VALUE SPACES.02780099
027900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02790099
028000     05  FILLER                          PIC  X(12)  VALUE SPACES.02800099
028100     05  FILLER                          PIC  X(01)  VALUE SPACE. 02810099
028200     05  FILLER                          PIC  X(12)  VALUE SPACES.02820099
028300                                                                  02830099
028400 01  DH1-DETAIL-HEADING-1-SUM.                                    02840099
028500     05  FILLER                          PIC  X(20)  VALUE SPACES.02850099
028600     05  FILLER                          PIC  X(03)  VALUE SPACES.02860099
028700     05  FILLER                          PIC  X(01)  VALUE SPACE. 02870099
028800     05  FILLER                          PIC  X(06)  VALUE        02880099
028900         ' LIST '.                                                02890099
029000     05  FILLER                          PIC  X(01)  VALUE SPACE. 02900099
029100     05  FILLER                          PIC  X(05)  VALUE        02910099
029200         'LIST '.                                                 02920099
029300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02930099
029400     05  FILLER                          PIC  X(05)  VALUE        02940099
029500         'LIST '.                                                 02950099
029600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02960099
029700     05  FILLER                          PIC  X(08)  VALUE        02970099
029800         ' STATUS '.                                              02980099
029900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02990099
030000     05  FILLER                          PIC  X(13)  VALUE        03000099
030100         '  CURRENT    '.                                         03010099
030200     05  FILLER                          PIC  X(01)  VALUE SPACES.03020099
030300     05  FILLER                          PIC  X(08)               03030099
030400                                         VALUE '  TOTAL '.        03040099
030500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03050099
030600     05  FILLER                          PIC  X(12)  VALUE SPACES.03060099
030700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03070099
030800     05  FILLER                          PIC  X(12)  VALUE SPACES.03080099
030900     05  FILLER                          PIC  X(32)  VALUE SPACES.03090099
031000                                                                  03100099
031100 01  DH2-DETAIL-HEADING-2.                                        03110099
031200     05  FILLER                          PIC  X(03)  VALUE        03120099
031300         'DPT'.                                                   03130099
031400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03140099
031500     05  FILLER                          PIC  X(06)  VALUE        03150099
031600         'NUMBER'.                                                03160099
031700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03170099
031800     05  FILLER                          PIC  X(05)  VALUE        03180099
031900         'TYPE '.                                                 03190099
032000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03200099
032100     05  FILLER                          PIC  X(05)  VALUE        03210099
032200         'STAT '.                                                 03220099
032300     05  FILLER                          PIC  X(01)  VALUE SPACE. 03230099
032400     05  FILLER                          PIC  X(08)  VALUE        03240099
032500         '  DATE  '.                                              03250099
032600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03260099
032700     05  FILLER                          PIC  X(09)  VALUE        03270099
032800         ' LOCATION'.                                             03280099
032900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03290099
033000     05  FILLER                          PIC  X(12)  VALUE        03300099
033100         ' VENDOR NAME'.                                          03310099
033200     05  FILLER                          PIC  X(01)  VALUE SPACE. 03320099
033300     05  FILLER                          PIC  X(10)  VALUE        03330099
033400         'SKU NUMBER'.                                            03340099
033500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03350099
033600     05  FILLER                          PIC  X(12)  VALUE        03360099
033700         'DESCRIPTION '.                                          03370099
033800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03380099
033900     05  FILLER                          PIC  X(13)  VALUE        03390099
034000         ' VENDOR STYLE'.                                         03400099
034100     05  FILLER                          PIC  X(07)  VALUE SPACE. 03410099
034200     05  FILLER                          PIC  X(03)  VALUE        03420099
034300         'QTY'.                                                   03430099
034400     05  FILLER                          PIC  X(10)  VALUE SPACE. 03440099
034500     05  FILLER                          PIC  X(05)  VALUE        03450099
034600         'COST'.                                                  03460099
034700     05  FILLER                          PIC  X(09)  VALUE SPACE. 03470099
034800     05  FILLER                          PIC  X(06)  VALUE        03480099
034900         'RETAIL'.                                                03490099
035000                                                                  03500099
035100 01  DH2-DETAIL-HEADING-2-SUM.                                    03510099
035200     05  FILLER                          PIC  X(20)  VALUE SPACE. 03520099
035300     05  FILLER                          PIC  X(03)  VALUE        03530099
035400         'DPT'.                                                   03540099
035500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03550099
035600     05  FILLER                          PIC  X(06)  VALUE        03560099
035700         'NUMBER'.                                                03570099
035800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03580099
035900     05  FILLER                          PIC  X(05)  VALUE        03590099
036000         'TYPE '.                                                 03600099
036100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03610099
036200     05  FILLER                          PIC  X(05)  VALUE        03620099
036300         'STAT '.                                                 03630099
036400     05  FILLER                          PIC  X(01)  VALUE SPACE. 03640099
036500     05  FILLER                          PIC  X(08)  VALUE        03650099
036600         '  DATE  '.                                              03660099
036700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03670099
036800     05  FILLER                          PIC  X(13)  VALUE        03680099
036900         '  LOCATION   '.                                         03690099
037000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03700099
037100     05  FILLER                          PIC  X(08)  VALUE        03710099
037200         '    QTY '.                                              03720099
037300     05  FILLER                          PIC  X(03)  VALUE SPACE. 03730099
037400     05  FILLER                          PIC  X(12)  VALUE        03740099
037500         '  TOTAL COST'.                                          03750099
037600     05  FILLER                          PIC  X(03)  VALUE SPACE. 03760099
037700     05  FILLER                          PIC  X(12)  VALUE        03770099
037800         'TOTAL RETAIL'.                                          03780099
037900                                                                  03790099
038000 01  DH3-DETAIL-HEADING-3.                                        03800099
038100     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 03810099
038200     05  FILLER                        PIC  X(01)  VALUE SPACE.   03820099
038300     05  FILLER                        PIC  X(06)  VALUE ALL '_'. 03830099
038400     05  FILLER                        PIC  X(01)  VALUE SPACE.   03840099
038500     05  FILLER                        PIC  X(05)  VALUE ALL '_'. 03850099
038600     05  FILLER                        PIC  X(01)  VALUE SPACE.   03860099
038700     05  FILLER                        PIC  X(05)  VALUE ALL '_'. 03870099
038800     05  FILLER                        PIC  X(01)  VALUE SPACE.   03880099
038900     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 03890099
039000     05  FILLER                        PIC  X(01)  VALUE SPACE.   03900099
039100     05  FILLER                        PIC  X(09)  VALUE ALL '_'. 03910099
039200     05  FILLER                        PIC  X(01)  VALUE SPACE.   03920099
039300     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 03930099
039400     05  FILLER                        PIC  X(01)  VALUE SPACE.   03940099
039500     05  FILLER                        PIC  X(10)  VALUE ALL '_'. 03950099
039600     05  FILLER                        PIC  X(01)  VALUE SPACE.   03960099
039700     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 03970099
039800     05  FILLER                        PIC  X(01)  VALUE SPACE.   03980099
039900     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 03990099
040000     05  FILLER                        PIC  X(02)  VALUE SPACE.   04000099
040100     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 04010099
040200     05  FILLER                        PIC  X(03)  VALUE SPACE.   04020099
040300     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 04030099
040400     05  FILLER                        PIC  X(04)  VALUE SPACE.   04040099
040500     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 04050099
040600                                                                  04060099
040700 01  DH3-DETAIL-HEADING-3-SUM.                                    04070099
040800     05  FILLER                        PIC  X(20)  VALUE SPACE.   04080099
040900     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 04090099
041000     05  FILLER                        PIC  X(01)  VALUE SPACE.   04100099
041100     05  FILLER                        PIC  X(06)  VALUE ALL '_'. 04110099
041200     05  FILLER                        PIC  X(01)  VALUE SPACE.   04120099
041300     05  FILLER                        PIC  X(05)  VALUE ALL '_'. 04130099
041400     05  FILLER                        PIC  X(01)  VALUE SPACE.   04140099
041500     05  FILLER                        PIC  X(05)  VALUE ALL '_'. 04150099
041600     05  FILLER                        PIC  X(01)  VALUE SPACE.   04160099
041700     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 04170099
041800     05  FILLER                        PIC  X(01)  VALUE SPACE.   04180099
041900     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 04190099
042000     05  FILLER                        PIC  X(01)  VALUE SPACE.   04200099
042100     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 04210099
042200     05  FILLER                        PIC  X(03)  VALUE SPACE.   04220099
042300     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 04230099
042400     05  FILLER                        PIC  X(03)  VALUE SPACE.   04240099
042500     05  FILLER                        PIC  X(12)  VALUE ALL '_'. 04250099
042600                                                                  04260099
042700 01  DL-DETAIL-LINE.                                              04270099
042800     05  DL-DEPT-NBR                     PIC  X(03)  VALUE SPACE. 04280099
042900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04290099
043000     05  DL-LIST-NBR                     PIC  X(06)  VALUE SPACE. 04300099
043100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04310099
043200     05  DL-LIST-TYPE                    PIC  X(05)  VALUE SPACE. 04320099
043300     05  FILLER                          PIC  X(01)  VALUE SPACE. 04330099
043400     05  DL-LIST-STATUS                  PIC  X(05)  VALUE SPACE. 04340099
043500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04350099
043600     05  DL-LIST-STAT-DATE               PIC  X(08)  VALUE SPACE. 04360099
043700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04370099
043800     05  DL-LIST-LOCATION                PIC  X(09)  VALUE SPACE. 04380099
043900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04390099
044000     05  DL-VENDOR-NAME                  PIC  X(12)  VALUE SPACE. 04400099
044100     05  FILLER                          PIC  X(02)  VALUE SPACE. 04410099
044200     05  DL-SKU-NUMBER                   PIC  X(08)  VALUE SPACE. 04420099
044300     05  FILLER                          PIC  X(02)  VALUE SPACE. 04430099
044400     05  DL-SKU-DESCRIPTION              PIC  X(12)  VALUE SPACE. 04440099
044500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04450099
044600     05  DL-VENDOR-STYLE                 PIC  X(13)  VALUE SPACE. 04460099
044700     05  FILLER                          PIC  X(02)  VALUE SPACE. 04470099
044800     05  DL-QTY                          PIC  ZZZZ,ZZ9.           04480099
044900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04490099
045000     05  DL-TOTAL-COST                   PIC  ZZZ,ZZZ,ZZ9.99.     04500099
045100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04510099
045200     05  DL-TOTAL-RETAIL                 PIC  ZZZ,ZZZ,ZZ9.99.     04520099
045300                                                                  04530099
045400 01  DLS-DETAIL-LINE-SUM.                                         04540099
045500     05  FILLER                          PIC  X(20)  VALUE SPACE. 04550099
045600     05  DLS-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 04560099
045700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04570099
045800     05  DLS-LIST-NBR                    PIC  X(06)  VALUE SPACE. 04580099
045900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04590099
046000     05  DLS-LIST-TYPE                   PIC  X(05)  VALUE SPACE. 04600099
046100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04610099
046200     05  DLS-LIST-STATUS                 PIC  X(05)  VALUE SPACE. 04620099
046300     05  FILLER                          PIC  X(01)  VALUE SPACE. 04630099
046400     05  DLS-LIST-STAT-DATE              PIC  X(08)  VALUE SPACE. 04640099
046500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04650099
046600     05  DLS-LIST-LOCATION               PIC  X(13)  VALUE SPACE. 04660099
046700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04670099
046800     05  DLS-QTY                         PIC  ZZZZ,ZZ9.           04680099
046900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04690099
047000     05  DLS-TOTAL-COST                  PIC  ZZZ,ZZZ,ZZ9.99.     04700099
047100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04710099
047200     05  DLS-TOTAL-RETAIL                PIC  ZZZ,ZZZ,ZZ9.99.     04720099
047300                                                                  04730099
047400                                                                  04740099
047500 01  TL-TOTAL-LINE.                                               04750099
047600     05  FILLER                          PIC  X(72)  VALUE SPACE. 04760099
047700     05  TL-TOTAL-DESCRIPTION            PIC  X(21)  VALUE SPACE. 04770099
047800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04780099
047900     05  TL-QTY                          PIC  ZZZZ,ZZ9.           04790099
048000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04800099
048100     05  TL-TOTAL-COST                   PIC  ZZZ,ZZZ,ZZ9.99.     04810099
048200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04820099
048300     05  TL-TOTAL-RETAIL                 PIC  ZZZ,ZZZ,ZZ9.99.     04830099
048400                                                                  04840099
048500 01  TL-TOTAL-LINE-SUM.                                           04850099
048600     05  FILLER                          PIC  X(43)  VALUE SPACE. 04860099
048700     05  TLS-TOTAL-DESCRIPTION           PIC  X(21)  VALUE SPACE. 04870099
048800     05  FILLER                          PIC  X(02)  VALUE SPACE. 04880099
048900     05  TLS-QTY                         PIC  ZZZZ,ZZ9.           04890099
049000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04900099
049100     05  TLS-TOTAL-COST                  PIC  ZZZ,ZZZ,ZZ9.99.     04910099
049200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04920099
049300     05  TLS-TOTAL-RETAIL                PIC  ZZZ,ZZZ,ZZ9.99.     04930099
049400                                                                  04940099
049500 01  BLANK-LINE.                                                  04950099
049600     05  FILLER                          PIC  X(132) VALUE SPACE. 04960099
049700                                                                  04970099
049800 01  CD-CC-DISPLAY-LINE.                                          04980099
049900     05  CD-CONTROL-FIELD-DESC           PIC  X(35)  VALUE SPACE. 04990099
050000     05  FILLER                          PIC  X(02)  VALUE ': '.  05000099
050100     05  CD-CONTROL-FIELD-VALUE          PIC  X(50)  VALUE SPACE. 05010099
050200                                                                  05020099
050300 01  CD-CC-DISPLAY-LINE1.                                         05030099
050400     05  FILLER                          PIC  X(50)  VALUE        05040099
050500         '  THE FOLLOWING CONTROL CARD CREATED THIS REPORT: '.    05050099
050600                                                                  05060099
050700 01  END-OF-REPORT-LINE.                                          05070099
050800     05  FILLER                          PIC  X(88)  VALUE SPACE. 05080099
050900     05  FILLER                          PIC  X(25)  VALUE        05090099
051000         '***** END OF REPORT *****'.                             05100099
051100     05  FILLER                          PIC  X(87)  VALUE SPACE. 05110099
051200                                                                  05120099
051300 01  GT-GRAND-TOTAL-HEADER.                                       05130099
051400     05  FILLER                          PIC  X(54)  VALUE        05140099
051500                                                     ALL '* '.    05150099
051600     05  FILLER                          PIC  X(25)  VALUE        05160099
051700         '  G R A N D   T O T A L  '.                             05170099
051800     05  FILLER                          PIC  X(52)  VALUE        05180099
051900                                                     ALL '* '.    05190099
052000                                                                  05200099
052100 01  GT-GRAND-TOTAL-QTY.                                          05210099
052200     05  FILLER                          PIC  X(10)  VALUE SPACE. 05220099
052300     05  FILLER                          PIC  X(30)  VALUE        05230099
052400         'REPORT TOTAL      (QUANTITY): '.                        05240099
052500     05  FILLER                          PIC  X(12)  VALUE SPACE. 05250099
052600     05  GT-QTY                          PIC  ZZZ,ZZ9.            05260099
052700                                                                  05270099
052800 01  GT-GRAND-TOTAL-COST.                                         05280099
052900     05  FILLER                          PIC  X(10)  VALUE SPACE. 05290099
053000     05  FILLER                          PIC  X(30)  VALUE        05300099
053100         '                (TOTAL COST): '.                        05310099
053200     05  FILLER                          PIC  X(04)  VALUE SPACE. 05320099
053300     05  GT-TOTAL-COST                   PIC  $$$$,$$$,$$9.99.    05330099
053400     05  FILLER                          PIC  X(03)  VALUE SPACE. 05340099
053500                                                                  05350099
053600 01  GT-GRAND-TOTAL-RETAIL.                                       05360099
053700     05  FILLER                          PIC  X(10)  VALUE SPACE. 05370099
053800     05  FILLER                          PIC  X(30)  VALUE        05380099
053900         '              (TOTAL RETAIL): '.                        05390099
054000     05  FILLER                          PIC  X(04)  VALUE SPACE. 05400099
054100     05  GT-TOTAL-RETAIL                 PIC  $$$$,$$$,$$9.99.    05410099
054200     05  FILLER                          PIC  X(03)  VALUE SPACE. 05420099
054300                                                                  05430099
054400 01  ER-EMPTY-REPORT-LINE.                                        05440099
054500     05  FILLER                          PIC  X(42)  VALUE SPACE. 05450099
054600     05  FILLER                          PIC  X(48)  VALUE        05460099
054700         '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      05470099
054800     05  FILLER                          PIC  X(42)  VALUE SPACE. 05480099
054900                                                                  05490099
055000 01  PA-PROGRAM-ACCUMULATORS.                                     05500099
055100     05  PA-QTY-COST-TOTAL               PIC S9(07)  VALUE +0     05510099
055200                                                     COMP-3.      05520099
055300     05  PA-TOT-UNIT-COST-TOTAL          PIC S9(09)V99            05530099
055400                                                     VALUE +0     05540099
055500                                                     COMP-3.      05550099
055600     05  PA-TOT-RETL-COST-TOTAL          PIC S9(09)V99            05560099
055700                                                     VALUE +0     05570099
055800                                                     COMP-3.      05580099
055900     05  PA-QTY-SKU-TOTAL                PIC S9(07)  VALUE +0     05590099
056000                                                     COMP-3.      05600099
056100     05  PA-UNIT-COST-SKU-TOTAL          PIC S9(09)V99            05610099
056200                                                     VALUE +0     05620099
056300                                                     COMP-3.      05630099
056400     05  PA-RETL-COST-SKU-TOTAL          PIC S9(09)V99            05640099
056500                                                     VALUE +0     05650099
056600                                                     COMP-3.      05660099
056700     05  PA-QTY-LIST-TOTAL               PIC S9(07)  VALUE +0     05670099
056800                                                     COMP-3.      05680099
056900     05  PA-UNIT-COST-LIST-TOTAL         PIC S9(09)V99            05690099
057000                                                     VALUE +0     05700099
057100                                                     COMP-3.      05710099
057200     05  PA-RETL-COST-LIST-TOTAL         PIC S9(09)V99            05720099
057300                                                     VALUE +0     05730099
057400                                                     COMP-3.      05740099
057500     05  PA-QTY-BUYER-TOTAL              PIC S9(07)  VALUE +0     05750099
057600                                                     COMP-3.      05760099
057700     05  PA-UNIT-COST-BUYER-TOTAL        PIC S9(09)V99            05770099
057800                                                     VALUE +0     05780099
057900                                                     COMP-3.      05790099
058000     05  PA-RETL-COST-BUYER-TOTAL        PIC S9(09)V99            05800099
058100                                                     VALUE +0     05810099
058200                                                     COMP-3.      05820099
058300     05  PA-QTY-GRAND-TOTAL              PIC S9(07)  VALUE +0     05830099
058400                                                     COMP-3.      05840099
058500     05  PA-UNIT-COST-GRAND-TOTAL        PIC S9(09)V99            05850099
058600                                                     VALUE +0     05860099
058700                                                     COMP-3.      05870099
058800     05  PA-RETL-COST-GRAND-TOTAL        PIC S9(09)V99            05880099
058900                                                     VALUE +0     05890099
059000                                                     COMP-3.      05900099
059100                                                                  05910099
059200 01  PC-CONSTANTS.                                                05920099
059300     05  PC-OPER-UNT-ID-TEST-CORP        PIC  X(04)  VALUE '0090'.05930099
059400     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    05940099
059500                                                     COMP SYNC.   05950099
059600     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   05960099
059700                                                     COMP SYNC.   05970099
059800     05  PC-ZERO                         PIC  9(01)  VALUE 0.     05980099
059900     05  PC-THREE                        PIC  9(01)  VALUE 3.     05990099
060000     05  PC-FOUR                         PIC  9(01)  VALUE 4.     06000099
060100     05  PC-NINE                         PIC  9(01)  VALUE 9.     06010099
060200     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  06020099
060300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        06030099
060400         'RVKRP002'.                                              06040099
060500     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        06050099
060600         'RVK900C '.                                              06060099
060700     05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        06070099
060800         'V E N D O R    '.                                       06080099
060900     05  PC-SKU-DESC-NOT-FOUND           PIC  X(15)  VALUE        06090099
061000         'SKU NOT FOUND  '.                                       06100099
061100     05  PC-TOTAL-DESRIPTIONS.                                    06110099
061200         10  PC-LIST-TOTAL               PIC  X(21)  VALUE        06120099
061300             '  LIST NUMBER TOTAL: '.                             06130099
061400         10  PC-BUYER-TOTAL              PIC  X(21)  VALUE        06140099
061500             '        BUYER TOTAL: '.                             06150099
061600     05 PC-MBS-SYSTEM-CODE-RV            PIC  X(02)  VALUE 'RV'.  06160099
061700     05 PC-MBS-OP-CO-03                  PIC  X(02)  VALUE '03'.  06170099
061800     05 PC-PGM-DPKUT039                  PIC  X(08)               06180099
061900                                         VALUE 'DPKUT039'.        06190099
062000                                                                  06200099
062100                                                                  06210099
062200 01  PS-PROGRAM-SWITCHES.                                         06220099
062300     05  PS-VALID-SORT-REC-IND           PIC  X(01)  VALUE 'N'.   06230099
062400         88  PS-VALID-SORT-RECORD                    VALUE 'Y'.   06240099
062500         88  PS-INVALID-SORT-RECORD                  VALUE 'N'.   06250099
062600                                                                  06260099
062700     05  PS-NEW-LINE-IND                 PIC  X(01)  VALUE 'N'.   06270099
062800         88  PS-NEW-LINE                             VALUE 'Y'.   06280099
062900         88  PS-NO-NEW-LINE                          VALUE 'N'.   06290099
063000                                                                  06300099
063100     05  PS-END-OF-DRIVER-CURSOR-IND     PIC  X(01)  VALUE 'N'.   06310099
063200         88  PS-END-OF-DRIVER-CURSOR                 VALUE 'Y'.   06320099
063300         88  PS-NOT-END-OF-DRIVER-CURSOR             VALUE 'N'.   06330099
063400                                                                  06340099
063500     05  PS-DEPT-PRINT-CONTROL           PIC  X(01)  VALUE 'S'.   06350099
063600         88  PS-DEPT-PRINT-START                     VALUE 'S'.   06360099
063700         88  PS-DEPT-PRINT-END                       VALUE 'E'.   06370099
063800                                                                  06380099
063900     05  PS-DEPT-PRINT-IND               PIC  X(01)  VALUE 'N'.   06390099
064000         88  PS-NO-DEPT-PRINTED                      VALUE 'N'.   06400099
064100         88  PS-DEPT-PRINTED                         VALUE 'Y'.   06410099
064200                                                                  06420099
064300     05  PS-END-OF-SORT-WORK-FILE-IND    PIC  X(01)  VALUE 'N'.   06430099
064400         88  PS-END-OF-SORT-WORK-FILE                VALUE 'Y'.   06440099
064500         88  PS-NOT-END-OF-SORT-WORK-FILE            VALUE 'N'.   06450099
064600                                                                  06460099
064700     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   06470099
064800         88  PS-NO-DATA                              VALUE 'Y'.   06480099
064900                                                                  06490099
065000     05  PS-DRIVER-CURSOR-IND            PIC  X(01)  VALUE 'D'.   06500099
065100         88  PS-USE-DEFECT-CURSOR                    VALUE 'D'.   06510099
065200         88  PS-USE-LOC-CURSOR                       VALUE 'L'.   06520099
065300         88  PS-USE-STATUS-CURSOR                    VALUE 'S'.   06530099
065400                                                                  06540099
065500 01  PV-PROGRAM-VARIABLES.                                        06550099
065600     05  PV-SKU                          PIC  9(08)  VALUE ZEROES.06560099
065700     05  PV-DEPT                         PIC  9(04)  VALUE ZEROES.06570099
065800     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.06580099
065900     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.06590099
066000     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.06600099
066100     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.06610099
066200     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.06620099
066300     05  PV-SORT-RETURN              PIC  9(02)      VALUE ZERO.  06630099
066400     05  PV-DISPLAY-LIST-NBR             PIC  Z(5)9.              06640099
066500     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     06650099
066600                                                     COMP SYNC.   06660099
066700     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     06670099
066800                                                     COMP SYNC.   06680099
066900     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     06690099
067000                                                     COMP SYNC.   06700099
067100     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     06710099
067200                                                     COMP SYNC.   06720099
067300     05  PV-CRSR-TYPE-CD1                PIC  X(01) VALUE SPACE.  06730099
067400     05  PV-CRSR-TYPE-CD2                PIC  X(01) VALUE SPACE.  06740099
067500     05  PV-CRSR-TYPE-CD3                PIC  X(01) VALUE SPACE.  06750099
067600     05  PV-CRSR-STAT-CD1                PIC  X(01) VALUE SPACE.  06760099
067700     05  PV-CRSR-STAT-CD2                PIC  X(01) VALUE SPACE.  06770099
067800     05  PV-CRSR-STAT-CD3                PIC  X(01) VALUE SPACE.  06780099
067900     05  PV-CRSR-STAT-CD4                PIC  X(01) VALUE SPACE.  06790099
068000     05  PV-CRSR-BUYER-HIGH              PIC  S9(03) COMP-3.      06800099
068100     05  PV-CRSR-BUYER-LOW               PIC  S9(03) COMP-3.      06810099
068200     05  PV-CRSR-OPER-UNT-ID             PIC  S9(04) COMP-3.      06820099
068300     05  PV-CRSR-DEPT-HIGH               PIC  X(03).              06830099
068400     05  PV-CRSR-DEPT-LOW                PIC  X(03).              06840099
068500     05  PV-CRSR-VNDUN-HIGH              PIC  X(09).              06850099
068600     05  PV-CRSR-VNDUN-LOW               PIC  X(09).              06860099
068700     05  PV-CRSR-DATE-HIGH               PIC  X(10)  VALUE SPACE. 06870099
068800     05  PV-CRSR-DATE-LOW                PIC  X(10)  VALUE SPACE. 06880099
068900                                                                  06890099
069000     05  PV-HOLD-BUYER-NBR               PIC  9(03).              06900099
069100     05  PV-HOLD-BUYER-NAME              PIC  X(32).              06910099
069200     05  PV-HOLD-VNDUN-NBR               PIC  X(09).              06920099
069300     05  PV-HOLD-VENDOR-NAME             PIC  X(25).              06930099
069400     05  PV-HOLD-LIST-NBR                PIC  9(06).              06940099
069500     05  PV-HOLD-LIST-LOCATION           PIC  X(13).              06950099
069600     05  PV-HOLD-LIST-STATUS             PIC  X(05).              06960099
069700     05  PV-HOLD-LIST-TYPE               PIC  X(05).              06970099
069800     05  PV-HOLD-STAT-DATE.                                       06980099
069900         10  PV-HOLD-STAT-CENTURY        PIC  9(02).              06990099
070000         10  PV-HOLD-STAT-YEAR           PIC  9(02).              07000099
070100         10  FILLER                      PIC  X(01) VALUE '-'.    07010099
070200         10  PV-HOLD-STAT-MONTH          PIC  9(02).              07020099
070300         10  FILLER                      PIC  X(01) VALUE '-'.    07030099
070400         10  PV-HOLD-STAT-DAY            PIC  9(02).              07040099
070500     05  PV-CURRENT-DATE                 PIC  X(10).              07050099
070600     05  PV-CURR-DATE.                                            07060099
070700         10  PV-CURR-CENTURY             PIC  9(02).              07070099
070800         10  PV-CURR-YEAR                PIC  9(02).              07080099
070900         10  FILLER                      PIC  X(01) VALUE '-'.    07090099
071000         10  PV-CURR-MONTH               PIC  9(02).              07100099
071100         10  FILLER                      PIC  X(01) VALUE '-'.    07110099
071200         10  PV-CURR-DAY                 PIC  9(02).              07120099
071300                                                                  07130099
071400     05  PV-PREVIOUS-DATE                PIC  X(10).              07140099
071500     05  PV-HOLD-DEPT-NBR                PIC  X(03).              07150099
071600     05  PV-HOLD-SKU-NBR                 PIC  X(08).              07160099
071700     05  PV-HOLD-COST                    PIC  9(05)V99.           07170099
071800     05  PV-HOLD-SKU-DESC                PIC  X(25).              07180099
071900     05  PV-HOLD-VENDOR-STYLE            PIC  X(13).              07190099
072000*    05  PV-HOLD-OPER-UNT-ID             PIC  9(04).              07200099
072100     05  PV-HOLD-RTV-LOC-NBR             PIC  9(04).              07210099
072200                                                                  07220099
072300     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 07230099
072400     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 07240099
072500*    05  PV-DB2-OPER-UNT-ID              PIC S9(04) COMP VALUE +0.07250099
072600     05  PV-DB2-RTV-LOC-NBR              PIC S9(04) COMP VALUE +0.07260099
072700     05  PV-START-DATE.                                           07270099
072800         10  PV-START-MONTH              PIC  9(02).              07280099
072900         10  FILLER                      PIC  X(01) VALUE '/'.    07290099
073000         10  PV-START-DAY                PIC  9(02).              07300099
073100         10  FILLER                      PIC  X(01) VALUE '/'.    07310099
073200         10  PV-START-CENTURY            PIC  9(02).              07320099
073300         10  PV-START-YEAR               PIC  9(02).              07330099
073400     05  PV-END-DATE.                                             07340099
073500         10  PV-END-MONTH                PIC  9(02).              07350099
073600         10  FILLER                      PIC  X(01) VALUE '/'.    07360099
073700         10  PV-END-DAY                  PIC  9(02).              07370099
073800         10  FILLER                      PIC  X(01) VALUE '/'.    07380099
073900         10  PV-END-CENTURY              PIC  9(02).              07390099
074000         10  PV-END-YEAR                 PIC  9(02).              07400099
074100     05  PV-WORK-DATE.                                            07410099
074200         10  PV-WORK-MONTH               PIC  9(02).              07420099
074300         10  FILLER                      PIC  X(01) VALUE '/'.    07430099
074400         10  PV-WORK-DAY                 PIC  9(02).              07440099
074500         10  FILLER                      PIC  X(01) VALUE '/'.    07450099
074600         10  PV-WORK-YEAR                PIC  9(02).              07460099
074700     05  PV-WORK-LIST-TYPE               PIC  X(01).              07470099
074800         88  PV-TYPE-MARKOUT            VALUE 'M'.                07480099
074900         88  PV-TYPE-RTV                VALUE 'R'.                07490099
075000         88  PV-TYPE-D-AND-D            VALUE 'D'.                07500099
075100     05  PV-WORK-LIST-STATUS             PIC  X(01).              07510099
075200         88  PV-STATUS-NEW              VALUE 'N'.                07520099
075300         88  PV-STATUS-OPEN             VALUE 'O'.                07530099
075400         88  PV-STATUS-CLOSED           VALUE 'C'.                07540099
075500         88  PV-STATUS-SHIPPED          VALUE 'S'.                07550099
075600         88  PV-STATUS-PENDING          VALUE 'P'.                07560099
075700         88  PV-STATUS-APPROVED         VALUE 'A'.                07570099
075800         88  PV-STATUS-DISPOSED         VALUE 'D'.                07580099
075900     05  PV-DEPT-TOTAL-LINE.                                      07590099
076000         10  FILLER                     PIC X(11)                 07600099
076100             VALUE 'DEPARTMENT '.                                 07610099
076200         10  PV-TOTAL-LINE-DPT          PIC X(03).                07620099
076300         10  FILLER                     PIC X(07)                 07630099
076400             VALUE ' TOTAL:'.                                     07640099
076500                                                                  07650099
076600 01  SD-SYSTEM-DATE.                                              07660099
076700     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 07670099
076800     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 07680099
076900     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 07690099
077000                                                                  07700099
077100 01  DT-DEPARTMENT-TOTALS.                                        07710099
077200     05  DT-MAX-DEPTS                    PIC S9(3) VALUE +25      07720099
077300                                                     COMP-3.      07730099
077400     05  DT-HOLD-DEPT-NBR                PIC X(03) VALUE SPACE.   07740099
077500                                                                  07750099
077600 01  DT-DEPT-TOTAL-TABLE.                                         07760099
077700     05  DT-DEPT-TOTAL-ENTRIES           OCCURS 25 TIMES          07770099
077800                                         INDEXED BY DT-IDX.       07780099
077900         10  DT-DEPT-NBR                 PIC  X(03)  VALUE SPACES.07790099
078000         10  DT-QTY-DEPT-TOTAL           PIC S9(05)  VALUE +0     07800099
078100                                                     COMP-3.      07810099
078200         10  DT-UNIT-COST-DEPT-TOTAL     PIC S9(07)V99            07820099
078300                                                     VALUE +0     07830099
078400                                                     COMP-3.      07840099
078500         10  DT-RETL-COST-DEPT-TOTAL     PIC S9(07)V99            07850099
078600                                                     VALUE +0     07860099
078700                                                     COMP-3.      07870099
078800                                                                  07880099
078900 01  ST-SYSTEM-TIME.                                              07890099
079000     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 07900099
079100     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 07910099
079200                                                                  07920099
079300*                                                                 07930099
079400******************************************************************07940099
079500*  WORK FIELDS FOR THE MBS SUBROUTINE                             07950099
079600******************************************************************07960099
079700     COPY DPWS003.                                                07970099
079800*                                                                 07980099
079900*                                                                 07990099
080000******************************************************************08000099
080100*  DB2 COMMUNICATION AREA.                                        08010099
080200******************************************************************08020099
080300     EXEC SQL                                                     08030099
080400          INCLUDE SQLCA                                           08040099
080500     END-EXEC.                                                    08050099
080600*                                                                 08060099
080700******************************************************************08070099
080800*  DB2 TABLE DB2PDBA.TCKRSTCN                                     08080099
080900******************************************************************08090099
081000     EXEC SQL                                                     08100099
081100          INCLUDE TCKRSTCN                                        08110099
081200     END-EXEC.                                                    08120099
081300*                                                                 08130099
081400*                                                                 08140099
081500******************************************************************08150099
081600*  DB2 TABLE DB2PDBA.TDFCTOR                                      08160099
081700******************************************************************08170099
081800     EXEC SQL                                                     08180099
081900          INCLUDE TDFCTOR                                         08190099
082000     END-EXEC.                                                    08200099
082100*                                                                 08210099
082200*                                                                 08220099
082300******************************************************************08230099
082400*  DB2 TABLE DB2PDBA.TVNDDPT                                      08240099
082500******************************************************************08250099
082600     EXEC SQL                                                     08260099
082700          INCLUDE TVNDDPT                                         08270099
082800     END-EXEC.                                                    08280099
082900*                                                                 08290099
083000*                                                                 08300099
083100******************************************************************08310099
083200*  DB2 TABLE DB2PDBA.TENTNME                                      08320099
083300******************************************************************08330099
083400     EXEC SQL                                                     08340099
083500          INCLUDE TENTNME                                         08350099
083600     END-EXEC.                                                    08360099
083700*                                                                 08370099
083800*                                                                 08380099
083900******************************************************************08390099
084000*  DB2 TABLE DB2PDBA.TEXTENT                                      08400099
084100******************************************************************08410099
084200     EXEC SQL                                                     08420099
084300          INCLUDE TEXTENT                                         08430099
084400     END-EXEC.                                                    08440099
084500*                                                                 08450099
084600*                                                                 08460099
084700******************************************************************08470099
084800*  DB2 TABLE DB2PDBA.TDFMEIT                                      08480099
084900******************************************************************08490099
085000     EXEC SQL                                                     08500099
085100          INCLUDE TDFMEIT                                         08510099
085200     END-EXEC.                                                    08520099
085300*                                                                 08530099
085400******************************************************************08540099
085500*  DB2 TABLE DB2PDBA.XLT_SKU                                      08550099
085600******************************************************************08560099
085700     EXEC SQL                                                     08570099
085800          INCLUDE XLT00003                                        08580099
085900     END-EXEC.                                                    08590099
086000*                                                                 08600099
086100******************************************************************08610099
086200*  DB2 TABLE DB2PDBA.XLT_VND_STYL                                 08620099
086300******************************************************************08630099
086400     EXEC SQL                                                     08640099
086500          INCLUDE XLT00004                                        08650099
086600     END-EXEC.                                                    08660099
086700*                                                                 08670099
086800******************************************************************08680099
086900*  DB2 TABLE DB2PDBA.XLT_LOC                                      08690099
087000******************************************************************08700099
087100     EXEC SQL                                                     08710099
087200          INCLUDE XLT00010                                        08720099
087300     END-EXEC.                                                    08730099
087400*                                                                 08740099
087500******************************************************************08750099
087600*  DB2 TABLE DB2PDBA.XLT_DC_LOC_ASGMT                             08760099
087700******************************************************************08770099
087800     EXEC SQL                                                     08780099
087900          INCLUDE XLT00014                                        08790099
088000     END-EXEC.                                                    08800099
088100*                                                                 08810099
088200******************************************************************08820099
088300*                                                                 08830099
088400*   DB2 COMMUNICATIONS AREA2                                      08840099
088500*                                                                 08850099
088600     COPY SQLCA2.                                                 08860099
088700 EJECT                                                            08870099
088800                                                                  08880099
088900***************************************************************** 08890099
089000*    DEFECTIVE ITEM CURSOR                                        08900099
089100***************************************************************** 08910099
089200     EXEC SQL                                                     08920099
089300          DECLARE  DEFECT_CURSOR  CURSOR WITH HOLD FOR            08930099
089400          SELECT                                                  08940099
089500                B.MDSE_DEPT_NBR                                   08950099
089600            ,   B.MDSE_CLASS_NBR                                  08960099
089700            ,   A.VENDOR_DUNS_NBR                                 08970099
089800            ,   A.VEND_NAME                                       08980099
089900            ,   A.DFCT_ORD_ID                                     08990099
090000            ,   A.ORD_DTE                                         09000099
090100            ,   B.UNIT_COST_AMT                                   09010099
090200            ,   B.RTL_COST_AMT                                    09020099
090300            ,   A.LOC_ID                                          09030099
090400            ,   A.DFCT_ORD_ID_CDE                                 09040099
090500            ,   A.DFCT_ORD_STAT_CDE                               09050099
090600            ,   A.STATUS_CHG_DTE                                  09060099
090700            ,   B.MKOUT_ORD_STAT_CDE                              09070099
090800            ,   B.DFCT_ITEM_NBR                                   09080099
090900          FROM                                                    09090099
091000                TDFCTOR A                                         09100099
091100            ,   TDFMEIT B                                         09110099
091200          WHERE                                                   09120099
091300              ((B.MDSE_DEPT_NBR  BETWEEN                          09130099
091400                     :PV-CRSR-DEPT-LOW  AND :PV-CRSR-DEPT-HIGH  ) 09140099
091500                                                                  09150099
091600          AND  (A.VENDOR_DUNS_NBR  BETWEEN                        09160099
091700                :PV-CRSR-VNDUN-LOW AND :PV-CRSR-VNDUN-HIGH )      09170099
091800                                                                  09180099
091900          AND  (A.DFCT_ORD_ID_CDE  IN (:PV-CRSR-TYPE-CD1          09190099
092000                                     , :PV-CRSR-TYPE-CD2          09200099
092100                                     , :PV-CRSR-TYPE-CD3 ))       09210099
092200                                                                  09220099
092300          AND  (A.DFCT_ORD_STAT_CDE                               09230099
092400                                   IN (:PV-CRSR-STAT-CD1          09240099
092500                                     , :PV-CRSR-STAT-CD2          09250099
092600                                     , :PV-CRSR-STAT-CD3          09260099
092700                                     , :PV-CRSR-STAT-CD4 ))       09270099
092800                                                                  09280099
092900          AND  (A.OPER_UNT_ID      = :PV-CRSR-OPER-UNT-ID )       09290099
093000                                                                  09300099
093100          AND  (A.STATUS_CHG_DTE BETWEEN                          09310099
093200                                  :PV-CRSR-DATE-LOW AND           09320099
093300                                  :PV-CRSR-DATE-HIGH )            09330099
093400                                                                  09340099
093500          AND  (A.DFCT_ORD_ID      = B.DFCT_ORD_ID ))             09350099
093600          ORDER BY                                                09360099
093700                B.DFCT_ITEM_NBR                                   09370099
093800     END-EXEC.                                                    09380099
093900                                                                  09390099
094000***************************************************************** 09400099
094100*    STATUS CURSOR - SAME AS DEFECT-CURSOR BUT WITH NO CHECKING   09410099
094200*    OF DFCT_ORD_ID_CDE OR DFCT_ORD_STAT_CDE                      09420099
094300***************************************************************** 09430099
094400     EXEC SQL                                                     09440099
094500          DECLARE  STATUS_CURSOR  CURSOR WITH HOLD FOR            09450099
094600          SELECT                                                  09460099
094700                B.MDSE_DEPT_NBR                                   09470099
094800            ,   B.MDSE_CLASS_NBR                                  09480099
094900            ,   A.VENDOR_DUNS_NBR                                 09490099
095000            ,   A.VEND_NAME                                       09500099
095100            ,   A.DFCT_ORD_ID                                     09510099
095200            ,   A.ORD_DTE                                         09520099
095300            ,   B.UNIT_COST_AMT                                   09530099
095400            ,   B.RTL_COST_AMT                                    09540099
095500            ,   A.LOC_ID                                          09550099
095600            ,   A.DFCT_ORD_ID_CDE                                 09560099
095700            ,   A.DFCT_ORD_STAT_CDE                               09570099
095800            ,   A.STATUS_CHG_DTE                                  09580099
095900            ,   B.MKOUT_ORD_STAT_CDE                              09590099
096000            ,   B.DFCT_ITEM_NBR                                   09600099
096100          FROM                                                    09610099
096200                TDFCTOR A                                         09620099
096300            ,   TDFMEIT B                                         09630099
096400          WHERE                                                   09640099
096500              ((B.MDSE_DEPT_NBR  BETWEEN                          09650099
096600                     :PV-CRSR-DEPT-LOW  AND :PV-CRSR-DEPT-HIGH  ) 09660099
096700                                                                  09670099
096800          AND  (A.VENDOR_DUNS_NBR  BETWEEN                        09680099
096900                :PV-CRSR-VNDUN-LOW AND :PV-CRSR-VNDUN-HIGH )      09690099
097000                                                                  09700099
097100          AND  (A.OPER_UNT_ID      = :PV-CRSR-OPER-UNT-ID )       09710099
097200                                                                  09720099
097300          AND  (A.STATUS_CHG_DTE BETWEEN                          09730099
097400                                  :PV-CRSR-DATE-LOW AND           09740099
097500                                  :PV-CRSR-DATE-HIGH )            09750099
097600                                                                  09760099
097700          AND  (A.DFCT_ORD_ID      = B.DFCT_ORD_ID ))             09770099
097800          ORDER BY                                                09780099
097900                B.DFCT_ITEM_NBR                                   09790099
098000     END-EXEC.                                                    09800099
098100                                                                  09810099
098200***************************************************************** 09820099
098300*    DEFECTIVE ITEM CURSOR FOR ONE LOCATION                       09830099
098400***************************************************************** 09840099
098500     EXEC SQL                                                     09850099
098600          DECLARE  LOC_CURSOR  CURSOR WITH HOLD FOR               09860099
098700          SELECT                                                  09870099
098800                B.MDSE_DEPT_NBR                                   09880099
098900            ,   B.MDSE_CLASS_NBR                                  09890099
099000            ,   A.VENDOR_DUNS_NBR                                 09900099
099100            ,   A.VEND_NAME                                       09910099
099200            ,   A.DFCT_ORD_ID                                     09920099
099300            ,   A.ORD_DTE                                         09930099
099400            ,   B.UNIT_COST_AMT                                   09940099
099500            ,   B.RTL_COST_AMT                                    09950099
099600            ,   A.LOC_ID                                          09960099
099700            ,   A.DFCT_ORD_ID_CDE                                 09970099
099800            ,   A.DFCT_ORD_STAT_CDE                               09980099
099900            ,   A.STATUS_CHG_DTE                                  09990099
100000            ,   B.MKOUT_ORD_STAT_CDE                              10000099
100100            ,   B.DFCT_ITEM_NBR                                   10010099
100200          FROM                                                    10020099
100300                TDFCTOR A                                         10030099
100400            ,   TDFMEIT B                                         10040099
100500          WHERE                                                   10050099
100600              ( A.LOC_ID           = :CC-STORAGE-LOC-ID           10060099
100700          AND   A.OPER_UNT_ID      = :PV-CRSR-OPER-UNT-ID         10070099
100800          AND   A.DFCT_ORD_ID      = B.DFCT_ORD_ID                10080099
100900                                                                  10090099
101000          AND  (B.MDSE_DEPT_NBR  BETWEEN                          10100099
101100                     :PV-CRSR-DEPT-LOW  AND :PV-CRSR-DEPT-HIGH  ) 10110099
101200                                                                  10120099
101300          AND  (A.VENDOR_DUNS_NBR  BETWEEN                        10130099
101400                :PV-CRSR-VNDUN-LOW AND :PV-CRSR-VNDUN-HIGH )      10140099
101500                                                                  10150099
101600          AND  (A.STATUS_CHG_DTE BETWEEN                          10160099
101700                                  :PV-CRSR-DATE-LOW AND           10170099
101800                                  :PV-CRSR-DATE-HIGH ))           10180099
101900          ORDER BY                                                10190099
102000                B.DFCT_ITEM_NBR                                   10200099
102100     END-EXEC.                                                    10210099
102200 EJECT                                                            10220099
102300                                                                  10230099
102400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 10240099
102500 PROCEDURE DIVISION.                                              10250099
102600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 10260099
102700                                                                  10270099
102800******************************************************************10280099
102900*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    10290099
103000******************************************************************10300099
103100 0000-PROGRAM-MAINLINE.                                           10310099
103200                                                                  10320099
103300     PERFORM 1000-INITIALIZE.                                     10330099
103400                                                                  10340099
103500* FOR "REGULAR" DEFECTIVE LISTINGS, AND FOR DEBIT AND DISPOSE LIST10350099
103600* SORT BY BUYER/VENDOR/STATUS CHANGE DATE/LISTING                 10360099
103700     IF  CC-LIST-TYPE-RTV OR  CC-LIST-TYPE-D-AND-D                10370099
103800         DISPLAY '** RVKRP002 - LIST TYPE REQUESTED ('            10380099
103900                 CC-LIST-TYPE-CD                                  10390099
104000                 ') WILL SORT BY BUYER/VND/STAT CHG DTE/LIST NBR' 10400099
104100         DISPLAY '**'                                             10410099
104200         SORT SORT-WORK-FILE                                      10420099
104300         ON ASCENDING KEY SW-BUYER-NBR                            10430099
104400                          SW-VND-NAME                             10440099
104500                          SW-STATUS-CHG-DTE                       10450099
104600                          SW-DFCT-ORD-ID                          10460099
104700                          SW-DEPT-NBR                             10470099
104800                          SW-SKU-NBR                              10480099
104900                          SW-UNIT-COST-AMT                        10490099
105000         INPUT  PROCEDURE IS 2000-RELEASE-RECORDS-TO-SORT         10500099
105100         OUTPUT PROCEDURE IS 3000-RETURN-SORT-WORK-FILE           10510099
105200     ELSE                                                         10520099
105300* FOR MARKOUT LISTINGS, SORT BY BUYER/STATUS CHANGE DATE/         10530099
105400* DEPARTMENT NUMBER/LIST NUMBER                                   10540099
105500         DISPLAY '** RVKRP002 - LIST TYPE REQUESTED ('            10550099
105600                 CC-LIST-TYPE-CD                                  10560099
105700                 ') WILL SORT BY BUYER/STAT CHG DTE/DPT/LIST NBR' 10570099
105800         DISPLAY '**'                                             10580099
105900         SORT SORT-WORK-FILE                                      10590099
106000         ON ASCENDING KEY SW-BUYER-NBR                            10600099
106100                          SW-STATUS-CHG-DTE                       10610099
106200                          SW-DEPT-NBR                             10620099
106300                          SW-DFCT-ORD-ID                          10630099
106400                          SW-SKU-NBR                              10640099
106500                          SW-UNIT-COST-AMT                        10650099
106600         INPUT  PROCEDURE IS 2000-RELEASE-RECORDS-TO-SORT         10660099
106700         OUTPUT PROCEDURE IS 3000-RETURN-SORT-WORK-FILE           10670099
106800     END-IF.                                                      10680099
106900                                                                  10690099
107000     MOVE SORT-RETURN            TO PV-SORT-RETURN.               10700099
107100                                                                  10710099
107200     IF  PV-SORT-RETURN NOT = ZERO                                10720099
107300         DISPLAY '** ABEND **'                                    10730099
107400         DISPLAY '** PROGRAM **  = RVKRP002'                      10740099
107500         DISPLAY '** INTERNAL SORT ERROR'                         10750099
107600         DISPLAY '** SORT RETURN CODE = ' PV-SORT-RETURN          10760099
107700         MOVE +4012              TO ABEND-CODE                    10770099
107800         CALL 'ILBOABN0' USING ABEND-CODE                         10780099
107900     END-IF.                                                      10790099
108000     PERFORM 9000-EOJ-ROUTINE.                                    10800099
108100                                                                  10810099
108200     GOBACK.                                                      10820099
108300*0000-EXIT.                                                       10830099
108400                                                                  10840099
108500******************************************************************10850099
108600*  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  10860099
108700*  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST 10870099
108800*  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT 10880099
108900*  FILE.                                                          10890099
109000******************************************************************10900099
109100 1000-INITIALIZE.                                                 10910099
109200                                                                  10920099
109300     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           10930099
109400     DISPLAY '**'                                                 10940099
109500     DISPLAY '** RVKRP002 - CONTROL CARD = ' CC-CONTROL-CARD.     10950099
109600                                                                  10960099
109700     PERFORM 1050-GET-DATES                                       10970099
109800                                                                  10980099
109900     PERFORM 1100-VALIDATE-CONTROL-CARD.                          10990099
110000                                                                  11000099
110100     PERFORM 1060-READ-DC-STORE-NUMBER.                           11010099
110200                                                                  11020099
110300**   SET THE DRIVER CURSOR TO USE:                                11030099
110400**    IF A SPECIFIC STORAGE LOCATION IS SUPPLIED, THE             11040099
110500**        LOC-CURSOR WILL BE USED                                 11050099
110600**    IF ALL TYPES OF ORDERS AND ALL ORDER STATUS ARE REQUESTED,  11060099
110700**        THE STATUS_CURSOR WILL BE USED                          11070099
110800**    OTHERWISE, USE THE DEFECT-CURSOR                            11080099
110900**                                                                11090099
111000                                                                  11100099
111100     IF CC-ALL-STORAGE-LOC-ID                                     11110099
111200         IF CC-LIST-STATUS-ALL AND CC-LIST-TYPE-ALL               11120099
111300             SET PS-USE-STATUS-CURSOR TO TRUE                     11130099
111400             DISPLAY '** RVKRP002 - STATUS_CURSOR IS USED'        11140099
111500         ELSE                                                     11150099
111600             SET PS-USE-DEFECT-CURSOR TO TRUE                     11160099
111700             DISPLAY '** RVKRP002 - DEFECT_CURSOR IS USED'        11170099
111800         END-IF                                                   11180099
111900     ELSE                                                         11190099
112000         DISPLAY '** RVKRP002 - LOC_CURSOR IS USED'               11200099
112100         SET PS-USE-LOC-CURSOR    TO TRUE                         11210099
112200     END-IF.                                                      11220099
112300                                                                  11230099
112400     MOVE CC-END-MONTH           TO PV-END-MONTH.                 11240099
112500     MOVE CC-END-DAY             TO PV-END-DAY.                   11250099
112600     MOVE CC-END-CENTURY         TO PV-END-CENTURY.               11260099
112700     MOVE CC-END-YEAR            TO PV-END-YEAR.                  11270099
112800                                                                  11280099
112900     MOVE CC-START-MONTH         TO PV-START-MONTH.               11290099
113000     MOVE CC-START-DAY           TO PV-START-DAY.                 11300099
113100     MOVE CC-START-CENTURY       TO PV-START-CENTURY.             11310099
113200     MOVE CC-START-YEAR          TO PV-START-YEAR.                11320099
113300                                                                  11330099
113400     MOVE PV-START-DATE          TO PH3-START-DATE.               11340099
113500     MOVE CC-START-DATE          TO PV-CRSR-DATE-LOW.             11350099
113600     MOVE PV-END-DATE            TO PH3-END-DATE.                 11360099
113700     MOVE CC-END-DATE            TO PV-CRSR-DATE-HIGH.            11370099
113800     DISPLAY '** RVKRP002 - DATES: '                              11380099
113900             PV-CRSR-DATE-LOW ' '                                 11390099
114000             PV-CRSR-DATE-HIGH.                                   11400099
114100                                                                  11410099
114200     MOVE SD-SYSTEM-YEAR   TO DP132O-RUN-YEAR.                    11420099
114300     MOVE SD-SYSTEM-MONTH  TO DP132O-RUN-MONTH.                   11430099
114400     MOVE SD-SYSTEM-DAY    TO DP132O-RUN-DAY.                     11440099
114500                                                                  11450099
114600     ACCEPT ST-SYSTEM-TIME FROM TIME.                             11460099
114700     MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR.                    11470099
114800     MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE.                  11480099
114900                                                                  11490099
115000     MOVE 'RVKRP002'       TO DP132O-PROGRAM-NAME.                11500099
115100                                                                  11510099
115200     INITIALIZE DL-DETAIL-LINE                                    11520099
115300                PA-PROGRAM-ACCUMULATORS.                          11530099
115400                                                                  11540099
115500     OPEN OUTPUT DI-DEFECT-ITM-DETAIL-RPT                         11550099
115600                 DI-DEFECT-ITM-SUM-RPT.                           11560099
115700                                                                  11570099
115800     SET PS-NO-NEW-LINE              TO TRUE.                     11580099
115900                                                                  11590099
116000*1000-EXIT.                                                       11600099
116100******************************************************************11610099
116200*  1050-GET-DATES - GETS CURRENT-DATE AND CURRENT DATE +1 YEAR    11620099
116300*  FROM DB2.                                                      11630099
116400******************************************************************11640099
116500 1050-GET-DATES.                                                  11650099
116600                                                                  11660099
116700     EXEC SQL                                                     11670099
116800         SELECT CURRENT DATE                                      11680099
116900             ,  CURRENT DATE - 1 YEAR                             11690099
117000         INTO                                                     11700099
117100               :PV-CURRENT-DATE                                   11710099
117200             , :PV-PREVIOUS-DATE                                  11720099
117300         FROM                                                     11730099
117400             TCKRSTCNTL                                           11740099
117500         WHERE                                                    11750099
117600             JOB_NAME =  :PC-CURRENT-JOB-NAME                     11760099
117700         AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 11770099
117800     END-EXEC.                                                    11780099
117900                                                                  11790099
118000     EVALUATE TRUE                                                11800099
118100         WHEN SQLCODE = ZERO                                      11810099
118200             MOVE PV-CURRENT-DATE    TO PV-CURR-DATE              11820099
118300             MOVE PV-CURR-YEAR       TO SD-SYSTEM-YEAR            11830099
118400             MOVE PV-CURR-MONTH      TO SD-SYSTEM-MONTH           11840099
118500             MOVE PV-CURR-DAY        TO SD-SYSTEM-DAY             11850099
118600         WHEN OTHER                                               11860099
118700              MOVE '1050-GET-DATES'                               11870099
118800                               TO  PV-PARAGRAPH-NAME              11880099
118900              MOVE 'SET REPORT DATES FROM CURRENT DATE'           11890099
119000                               TO  PV-DB2-OPERATION-ATTEMPTED     11900099
119100              PERFORM 9999-SQL-ABEND                              11910099
119200     END-EVALUATE.                                                11920099
119300                                                                  11930099
119400                                                                  11940099
119500                                                                  11950099
119600*1050-EXIT.                                                       11960099
119700******************************************************************11970099
119800* 1060-READ-DC-STORE-NUMBER.                                      11980099
119900* ==> PROCESSES:                                                  11990099
120000*   - READS THE LOCATION DATA                                     12000099
120100*                                                                 12010099
120200*     PERFORMED BY : 1000-INITIALIZE.                             12020099
120300******************************************************************12030099
120400 1060-READ-DC-STORE-NUMBER.                                       12040099
120500                                                                  12050099
120600     IF CC-OPER-UNT-ID = PC-OPER-UNT-ID-TEST-CORP                 12060099
120700         MOVE '0090'        TO  PH2-STORE-NUMBER                  12070099
120800                               PH2S-STORE-NUMBER                  12080099
120900                               PH2T-STORE-NUMBER                  12090099
121000         MOVE 'CORPORATE'  TO  PH2-STORE-DESC                     12100099
121100                               PH2S-STORE-DESC                    12110099
121200                               PH2T-STORE-DESC                    12120099
121300     ELSE                                                         12130099
121400         PERFORM 1061-GET-DC-STORE-NBR-NM                         12140099
121500     END-IF.                                                      12150099
121600*1060-EXIT.                                                       12160099
121700******************************************************************12170099
121800* 1061-GET-DC-STORE-NBR-NM.                                       12180099
121900* ==> PROCESSES:                                                  12190099
122000*   - READS THE LOCATION DATA                                     12200099
122100*                                                                 12210099
122200*     PERFORMED BY : 1160-READ-DC-STORE-NUMBER                    12220099
122300******************************************************************12230099
122400*     NOTE: DC-NBR HAS BEEN CHANGED TO USE RTV-LOC-NBR.           12240099
122500******************************************************************12250099
122600 1061-GET-DC-STORE-NBR-NM.                                        12260099
122700     MOVE PV-HOLD-RTV-LOC-NBR TO PV-DB2-RTV-LOC-NBR.              12270099
122800                                                                  12280099
122900     EXEC SQL                                                     12290099
123000         SELECT B.LOC_NBR                                         12300099
123100              , B.LOC_NM                                          12310099
123200              , A.DC_NBR                                          12320099
123300           INTO :XLT00010-LOC-NBR                                 12330099
123400              , :XLT00010-LOC-NM                                  12340099
123500              , :XLT00014-DC-NBR                                  12350099
123600           FROM XLT_DC_LOC_ASGMT A                                12360099
123700              , XLT_LOC B                                         12370099
123800          WHERE A.LOC_NBR     = :PV-DB2-RTV-LOC-NBR               12380099
123900            AND A.LOC_NBR     = B.LOC_NBR                         12390099
124000            AND B.LOC_TYP_CDE = 'RV'                              12400099
124100            AND ((CHAR(CURRENT DATE, ISO))                        12410099
124200                  BETWEEN                                         12420099
124300                 (CHAR(B.OPN_DTE,ISO))                            12430099
124400                      AND                                         12440099
124500                 (CHAR(B.CLO_DTE,ISO)))                           12450099
124600     END-EXEC.                                                    12460099
124700                                                                  12470099
124800     EVALUATE TRUE                                                12480099
124900         WHEN SQLCODE = ZERO                                      12490099
125000              MOVE XLT00010-LOC-NBR TO                            12500099
125100                                     PH2-STORE-NUMBER             12510099
125200                                     PH2S-STORE-NUMBER            12520099
125300                                     PH2T-STORE-NUMBER            12530099
125400              MOVE XLT00010-LOC-NM      TO                        12540099
125500                                     PH2-STORE-DESC               12550099
125600                                     PH2S-STORE-DESC              12560099
125700                                     PH2T-STORE-DESC              12570099
125800                                                                  12580099
125900         WHEN SQLWARN0 NOT EQUAL SPACE                            12590099
126000         WHEN SQLCODE NOT EQUAL ZERO                              12600099
126100              MOVE '1061-GET-DC-STORE-NBR-NM'                     12610099
126200                           TO      PV-PARAGRAPH-NAME              12620099
126300              MOVE 'GET LOCATION INFORMATION'                     12630099
126400                           TO      PV-DB2-OPERATION-ATTEMPTED     12640099
126500              PERFORM 9999-SQL-ABEND                              12650099
126600     END-EVALUATE.                                                12660099
126700                                                                  12670099
126800*1061-EXIT.                                                       12680099
126900******************************************************************12690099
127000* 1100-VALIDATE-CONTROL-CARD - VERIFIES THAT THE DATE RANGE SUP-  12700099
127100* PLIED IS NUMERIC AND WITHIN VALID VALUES.                       12710099
127200******************************************************************12720099
127300 1100-VALIDATE-CONTROL-CARD.                                      12730099
127400                                                                  12740099
127500     IF CC-DEFAULT-START-DATE                                     12750099
127600         MOVE PV-PREVIOUS-DATE       TO CC-START-DATE             12760099
127700     ELSE                                                         12770099
127800         IF CC-CURRENT-START-DATE                                 12780099
127900             MOVE PV-CURRENT-DATE    TO CC-START-DATE             12790099
128000         END-IF                                                   12800099
128100     END-IF.                                                      12810099
128200                                                                  12820099
128300     IF CC-DEFAULT-END-DATE                                       12830099
128400     OR CC-CURRENT-END-DATE                                       12840099
128500         MOVE PV-CURRENT-DATE        TO CC-END-DATE               12850099
128600     END-IF.                                                      12860099
128700                                                                  12870099
128800     PERFORM 1200-VALIDATE-DATES.                                 12880099
128900                                                                  12890099
129000     MOVE CC-OPER-UNT-ID             TO DP010I-UNEDITED-FIELD.    12900099
129100     MOVE PC-FOUR                    TO DP010I-MAXIMUM-DIGITS.    12910099
129200     MOVE PC-ZERO                    TO DP010I-MAXIMUM-DECIMALS.  12920099
129300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     12930099
129400     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12940099
129500         USING DP010I-NUMERIC-EDIT-AREA.                          12950099
129600                                                                  12960099
129700     IF DP010I-NO-ERROR-DETECTED                                  12970099
129800         MOVE DP010I-NUMERIC-FIELD TO PV-HOLD-RTV-LOC-NBR         12980099
129900         MOVE CC-OPER-UNT-ID TO PV-CRSR-OPER-UNT-ID               12990099
130000     ELSE                                                         13000099
130100         DISPLAY '** ABEND **'                                    13010099
130200         DISPLAY '** PROGRAM = RVKRP002 **'                       13020099
130300         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'   13030099
130400         DISPLAY '** ERROR CONVERTING RTV LOC NBR TO NUMERIC:'    13040099
130500         DISPLAY '** OPER-UNT ID CODE ENTERED = '                 13050099
130600                 CC-OPER-UNT-ID ' **'                             13060099
130700         MOVE +4003 TO ABEND-CODE                                 13070099
130800         CALL 'ILBOABN0' USING ABEND-CODE                         13080099
130900     END-IF.                                                      13090099
131000                                                                  13100099
131100*                                                                 13110099
131200*    IF BOTH LIST TYPE AND STATUS ARE VALID, SET UP CURSOR EXTREME13120099
131300*                                                                 13130099
131400     IF CC-VALID-LIST-TYPE AND CC-VALID-LIST-STATUS               13140099
131500         EVALUATE TRUE                                            13150099
131600             WHEN CC-LIST-TYPE-MARKOUT                            13160099
131700             WHEN CC-LIST-TYPE-RTV                                13170099
131800             WHEN CC-LIST-TYPE-D-AND-D                            13180099
131900                  MOVE CC-LIST-TYPE-CD  TO  PV-CRSR-TYPE-CD1      13190099
132000                                            PV-CRSR-TYPE-CD2      13200099
132100                                            PV-CRSR-TYPE-CD3      13210099
132200             WHEN CC-LIST-TYPE-ALL                                13220099
132300                  MOVE 'M'              TO  PV-CRSR-TYPE-CD1      13230099
132400                  MOVE 'R'              TO  PV-CRSR-TYPE-CD2      13240099
132500                  MOVE 'D'              TO  PV-CRSR-TYPE-CD3      13250099
132600         END-EVALUATE                                             13260099
132700* IF THE STATUS IS SET TO PENDING OR APPROVED, BRING BACK BOTH    13270099
132800* PENDING AND APPROVED MARKOUT ORDERS.  THE FETCH WILL SKIP THE   13280099
132900* INCORRECT ROWS ACCORDING TO THE DETAIL STATUS CODE.             13290099
133000*                                                                 13300099
133100* IF STATUS IS SET TO ALL, SUPPLY POSSIBLE STATUS ACCORDING TO THE13310099
133200* LIST TYPE -- MARKOUTS ==========> "OPEN"-"PENDING"-"APPROVED"   13320099
133300*           -- RETURN TO VENDOR ==> "OPEN"-"CLOSED"-"SHIPPED"     13330099
133400*           --                      "APPROVED"                    13340099
133500*           -- DEBIT & DISPOSED => "DISPOSED" -"SHIPPED" -        13350099
133600*           --                      "APPROVED"                    13360099
133700*           -- ALL => USE THE STATUS CURSOR WHICH DOES NOT CHECK  13370099
133800*                     THE STATUS OR TYPE CODE                     13380099
133900         EVALUATE TRUE                                            13390099
134000             WHEN CC-LIST-STATUS-OPEN                             13400099
134100             WHEN CC-LIST-STATUS-NEW                              13410099
134200             WHEN CC-LIST-STATUS-CLOSED                           13420099
134300             WHEN CC-LIST-STATUS-SHIPPED                          13430099
134400             WHEN CC-LIST-STATUS-DISPOSED                         13440099
134500             WHEN CC-LIST-STATUS-APPROVED                         13450099
134600                 MOVE CC-LIST-STATUS-CD TO PV-CRSR-STAT-CD1       13460099
134700                                           PV-CRSR-STAT-CD2       13470099
134800                                           PV-CRSR-STAT-CD3       13480099
134900                                           PV-CRSR-STAT-CD4       13490099
135000             WHEN CC-LIST-STATUS-PENDING                          13500099
135100             WHEN CC-LIST-STATUS-APPROVED                         13510099
135200                 MOVE 'A'               TO PV-CRSR-STAT-CD1       13520099
135300                 MOVE 'P'               TO PV-CRSR-STAT-CD2       13530099
135400                                           PV-CRSR-STAT-CD3       13540099
135500                                           PV-CRSR-STAT-CD4       13550099
135600             WHEN CC-LIST-STATUS-ALL                              13560099
135700                 EVALUATE TRUE                                    13570099
135800                     WHEN CC-LIST-TYPE-MARKOUT                    13580099
135900                         MOVE 'O'       TO PV-CRSR-STAT-CD1       13590099
136000                         MOVE 'P'       TO PV-CRSR-STAT-CD2       13600099
136100                         MOVE 'A'       TO PV-CRSR-STAT-CD3       13610099
136200                     WHEN CC-LIST-TYPE-RTV                        13620099
136300                         MOVE 'O'       TO PV-CRSR-STAT-CD1       13630099
136400                         MOVE 'C'       TO PV-CRSR-STAT-CD2       13640099
136500                         MOVE 'S'       TO PV-CRSR-STAT-CD3       13650099
136600                         MOVE 'A'       TO PV-CRSR-STAT-CD4       13660099
136700                     WHEN CC-LIST-TYPE-D-AND-D                    13670099
136800                         MOVE 'D'       TO PV-CRSR-STAT-CD1       13680099
136900                         MOVE 'S'       TO PV-CRSR-STAT-CD2       13690099
137000                         MOVE 'A'       TO PV-CRSR-STAT-CD3       13700099
137100                     WHEN CC-LIST-TYPE-ALL                        13710099
137200                         CONTINUE                                 13720099
137300                 END-EVALUATE                                     13730099
137400         END-EVALUATE                                             13740099
137500     ELSE                                                         13750099
137600         DISPLAY '** ABEND **'                                    13760099
137700         DISPLAY '** PROGRAM = RVKRP002 **'                       13770099
137800         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'   13780099
137900         DISPLAY '** LIST STATUS/TYPE NOT VALID CODES  **'        13790099
138000         DISPLAY '** LIST STATUS CODE ENTERED = '                 13800099
138100                 CC-LIST-STATUS-CD ' **'                          13810099
138200         DISPLAY '**   LIST TYPE CODE ENTERED = '                 13820099
138300                 CC-LIST-TYPE-CD ' **'                            13830099
138400         MOVE +4003 TO ABEND-CODE                                 13840099
138500         CALL 'ILBOABN0' USING ABEND-CODE                         13850099
138600     END-IF.                                                      13860099
138700**                                                                13870099
138800**                                                                13880099
138900**                                                                13890099
139000**  SET UP BUYER NUMBER EXTREMES FOR USE IN DB2 CURSOR            13900099
139100**                                                                13910099
139200     IF CC-ALL-BUYERS                                             13920099
139300         MOVE 999                   TO PV-CRSR-BUYER-HIGH         13930099
139400         MOVE 000                   TO PV-CRSR-BUYER-LOW          13940099
139500     ELSE                                                         13950099
139600         MOVE CC-BUYER-NBR          TO DP010I-UNEDITED-FIELD      13960099
139700         MOVE PC-THREE              TO DP010I-MAXIMUM-DIGITS      13970099
139800         MOVE PC-ZERO               TO DP010I-MAXIMUM-DECIMALS    13980099
139900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13990099
140000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14000099
140100             USING DP010I-NUMERIC-EDIT-AREA                       14010099
140200                                                                  14020099
140300         IF DP010I-NO-ERROR-DETECTED                              14030099
140400             MOVE CC-BUYER-NBR      TO PV-CRSR-BUYER-HIGH         14040099
140500                                       PV-CRSR-BUYER-LOW          14050099
140600         ELSE                                                     14060099
140700             DISPLAY '** ABEND **'                                14070099
140800             DISPLAY '** PROGRAM = RVKRP002 **'                   14080099
140900             DISPLAY                                              14090099
141000               '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'     14100099
141100             DISPLAY                                              14110099
141200               '** ERROR CONVERTING BUYER NUMBER TO NUMERIC:'     14120099
141300             DISPLAY '** BUYER NUMBER ENTERED = '                 14130099
141400                     CC-BUYER-NBR ' **'                           14140099
141500             MOVE +4003             TO ABEND-CODE                 14150099
141600             CALL 'ILBOABN0' USING ABEND-CODE                     14160099
141700         END-IF                                                   14170099
141800     END-IF.                                                      14180099
141900**                                                                14190099
142000**                                                                14200099
142100**                                                                14210099
142200**  SET UP DEPARTMENT NUMBER RANGES FOR USE IN DB2 CURSOR         14220099
142300**                                                                14230099
142400     IF CC-ALL-DEPTS                                              14240099
142500*        MOVE HIGHVALUES                                          14250099
142600         MOVE ''                 TO PV-CRSR-DEPT-HIGH          14260099
142700                                                                  14270099
142800*        MOVE LOW VALUES                                          14280099
142900         MOVE '   '                 TO PV-CRSR-DEPT-LOW           14290099
143000     ELSE                                                         14300099
143100         MOVE CC-DEPT-NBR           TO DP010I-UNEDITED-FIELD      14310099
143200         MOVE PC-THREE              TO DP010I-MAXIMUM-DIGITS      14320099
143300         MOVE PC-ZERO               TO DP010I-MAXIMUM-DECIMALS    14330099
143400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14340099
143500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14350099
143600             USING DP010I-NUMERIC-EDIT-AREA                       14360099
143700                                                                  14370099
143800         IF DP010I-NO-ERROR-DETECTED                              14380099
143900                 MOVE CC-DEPT-NBR     TO PV-CRSR-DEPT-LOW         14390099
144000                                         PV-CRSR-DEPT-HIGH        14400099
144100         ELSE                                                     14410099
144200             DISPLAY '** ABEND **'                                14420099
144300             DISPLAY '** PROGRAM = RVKRP002 **'                   14430099
144400             DISPLAY                                              14440099
144500               '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'     14450099
144600             DISPLAY '** ERROR CONVERTING DEPARTMENT TO NUMERIC: '14460099
144700             DISPLAY '** DEPARTMENT NUMBER ENTERED = '            14470099
144800                     CC-DEPT-NBR ' **'                            14480099
144900             MOVE +4003               TO ABEND-CODE               14490099
145000             CALL 'ILBOABN0' USING ABEND-CODE                     14500099
145100         END-IF                                                   14510099
145200     END-IF.                                                      14520099
145300**                                                                14530099
145400**                                                                14540099
145500**                                                                14550099
145600**  SET UP VENDOR NUMBER RANGES FOR USE IN DB2 CURSOR             14560099
145700**                                                                14570099
145800     IF CC-ALL-VENDORS                                            14580099
145900*        MOVE HIGHVALUES                                          14590099
146000         MOVE ''             TO PV-CRSR-VNDUN-HIGH       14600099
146100*        MOVE LOW VALUES                                          14610099
146200         MOVE '         '             TO PV-CRSR-VNDUN-LOW        14620099
146300     ELSE                                                         14630099
146400         MOVE CC-VNDUN-NBR            TO DP010I-UNEDITED-FIELD    14640099
146500         MOVE PC-NINE                 TO DP010I-MAXIMUM-DIGITS    14650099
146600         MOVE PC-ZERO                 TO DP010I-MAXIMUM-DECIMALS  14660099
146700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14670099
146800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14680099
146900             USING DP010I-NUMERIC-EDIT-AREA                       14690099
147000                                                                  14700099
147100         IF DP010I-NO-ERROR-DETECTED                              14710099
147200             MOVE CC-VNDUN-NBR    TO PV-CRSR-VNDUN-HIGH           14720099
147300                                     PV-CRSR-VNDUN-LOW            14730099
147400         ELSE                                                     14740099
147500             DISPLAY '** ABEND **'                                14750099
147600             DISPLAY '** PROGRAM = RVKRP002 **'                   14760099
147700             DISPLAY                                              14770099
147800               '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'     14780099
147900             DISPLAY '** ERROR CONVERTING VENDOR NUM TO NUMERIC: '14790099
148000             DISPLAY '** VENDOR NUMBER ENTERED = '                14800099
148100                     CC-VNDUN-NBR '  **'                          14810099
148200             MOVE +4003 TO ABEND-CODE                             14820099
148300             CALL 'ILBOABN0' USING ABEND-CODE                     14830099
148400         END-IF                                                   14840099
148500     END-IF.                                                      14850099
148600**                                                                14860099
148700**                                                                14870099
148800**                                                                14880099
148900**  CHECK REPORT TYPE                                             14890099
149000**                                                                14900099
149100     IF CC-VALID-REPORT-TYPE                                      14910099
149200         CONTINUE                                                 14920099
149300     ELSE                                                         14930099
149400         DISPLAY '** ABEND **'                                    14940099
149500         DISPLAY '** PROGRAM = RVKRP002 **'                       14950099
149600         DISPLAY                                                  14960099
149700           '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD **'         14970099
149800         DISPLAY '** INVALID REPORT TYPE.  VALID VALUES ARE: **'  14980099
149900         DISPLAY '** D = DETAIL REPORT  **'                       14990099
150000         DISPLAY '** S = SUMMARY REPORT **'                       15000099
150100         DISPLAY '** B = BOTH REPORTS   **'                       15010099
150200         DISPLAY '** T = TOTAL REPORT   **'                       15020099
150300         DISPLAY '** REPORT TYPE ENTERED = '                      15030099
150400                 CC-REPORT-TYPE '  **'                            15040099
150500         MOVE +4003 TO ABEND-CODE                                 15050099
150600         CALL 'ILBOABN0' USING ABEND-CODE                         15060099
150700     END-IF.                                                      15070099
150800                                                                  15080099
150900******************************************************************15090099
151000* 1200-VALIDATE-DATES - USES CALLED MODULE DPKUT500 TO VALIDATE   15100099
151100*     THE BEGIN AND END DATES.                                    15110099
151200******************************************************************15120099
151300 1200-VALIDATE-DATES.                                             15130099
151400                                                                  15140099
151500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15150099
151600                                                                  15160099
151700     MOVE SD-SYSTEM-DATE            TO DPG51-SYSTEM-DATE.         15170099
151800     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      15180099
151900                                                                  15190099
152000     MOVE CC-START-DATE             TO DPG52-LK-DATE-INPUT.       15200099
152100     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      15210099
152200                                                                  15220099
152300     MOVE CC-END-DATE               TO DPG53-LK-CMPR-DATE-INPUT.  15230099
152400     SET DPG53-LK-CMPR-DTE-ISO-FMT  TO TRUE.                      15240099
152500                                                                  15250099
152600     CALL DP500-KOHLS-CALENDAR-ROUTINE                            15260099
152700                      USING DPG51 DPG52 DPG53                     15270099
152800                            DPG54 DPG55 DPG56.                    15280099
152900                                                                  15290099
153000     EVALUATE TRUE                                                15300099
153100         WHEN DPG54-DATE-INVALID                                  15310099
153200             DISPLAY '** ABEND **'                                15320099
153300             DISPLAY '** PROGRAM = RVKRP002 -- CALLED MODULE '    15330099
153400                     'DPKUT500 **'                                15340099
153500             DISPLAY '** PARAGRAPH = 1200-VALIDATE-DATES. **'     15350099
153600             DISPLAY '** INVALID START DATE: ' CC-START-DATE      15360099
153700             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    15370099
153800             DISPLAY DPG54-ERROR-MESSAGE                          15380099
153900             MOVE +4003 TO ABEND-CODE                             15390099
154000             CALL 'ILBOABN0' USING ABEND-CODE                     15400099
154100                                                                  15410099
154200         WHEN DPG54-CMPR-DATE-INVALID                             15420099
154300             DISPLAY '** ABEND **'                                15430099
154400             DISPLAY '** PROGRAM = RVKRP002 -- CALLED MODULE '    15440099
154500                     'DPKUT500 **'                                15450099
154600             DISPLAY '** PARAGRAPH = 1200-VALIDATE-DATES. **'     15460099
154700             DISPLAY '** INVALID END DATE: ' CC-END-DATE          15470099
154800             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    15480099
154900             DISPLAY DPG54-ERROR-MESSAGE                          15490099
155000             MOVE +4003 TO ABEND-CODE                             15500099
155100             CALL 'ILBOABN0' USING ABEND-CODE                     15510099
155200                                                                  15520099
155300         WHEN DPG55-DAYS-DIFFERENCE > ZERO                        15530099
155400             DISPLAY '** ABEND **'                                15540099
155500             DISPLAY '** PROGRAM = RVKRP002 -- CALLED MODULE '    15550099
155600                     'DPKUT500 **'                                15560099
155700             DISPLAY '** PARAGRAPH = 1200-VALIDATE-DATES. **'     15570099
155800             DISPLAY '** END DATE IS NOT AFTER START DATE **'     15580099
155900             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    15590099
156000             DISPLAY DPG54-ERROR-MESSAGE                          15600099
156100             MOVE +4003 TO ABEND-CODE                             15610099
156200             CALL 'ILBOABN0' USING ABEND-CODE                     15620099
156300                                                                  15630099
156400         WHEN OTHER                                               15640099
156500             DISPLAY DPG54-ERROR-MESSAGE                          15650099
156600                                                                  15660099
156700     END-EVALUATE.                                                15670099
156800                                                                  15680099
156900******************************************************************15690099
157000* 2000-RELEASE-RECORDS-TO-SORT                                    15700099
157100* PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNA15710099
157200* SORT FILE.                                                      15720099
157300******************************************************************15730099
157400 2000-RELEASE-RECORDS-TO-SORT.                                    15740099
157500                                                                  15750099
157600     DISPLAY '**'                                                 15760099
157700     DISPLAY '** RVKRP002 - INPROCESS - OPEN CURSOR **'.          15770099
157800                                                                  15780099
157900     PERFORM 7000-OPEN-DRIVER-CURSOR.                             15790099
158000                                                                  15800099
158100     DISPLAY '** RVKRP002 - EXTRACTING DATA FROM DB2 ***'         15810099
158200                                                                  15820099
158300     PERFORM 7200-FETCH-DRIVER-CURSOR.                            15830099
158400     MOVE ZERO                  TO PV-HOLD-DEPT-NBR.              15840099
158500                                                                  15850099
158600*    TAKE COMMITS EVERY FEW SECONDS TO RELEASE LOCKS ON TABLES    15860099
158700*                                                                 15870099
158800     PERFORM UNTIL PS-END-OF-DRIVER-CURSOR                        15880099
158900                                                                  15890099
159000         PERFORM 2010-GET-INITIAL-TIMESTMPS                       15900099
159100                                                                  15910099
159200         PERFORM UNTIL PV-CURR-TMST > PV-COMMIT-TMST              15920099
159300                    OR PS-END-OF-DRIVER-CURSOR                    15930099
159400                                                                  15940099
159500             PERFORM 2020-GET-CURRENT-TIMESTMP                    15950099
159600                                                                  15960099
159700             IF PV-CURR-TMST > PV-COMMIT-TMST                     15970099
159800                 PERFORM 2030-TAKE-COMMIT                         15980099
159900             ELSE                                                 15990099
160000                 PERFORM 2100-PROCESS-RECORDS                     16000099
160100             END-IF                                               16010099
160200                                                                  16020099
160300         END-PERFORM                                              16030099
160400                                                                  16040099
160500     END-PERFORM.                                                 16050099
160600                                                                  16060099
160700     PERFORM 7100-CLOSE-DRIVER-CURSOR.                            16070099
160800                                                                  16080099
160900     DISPLAY '** RVKRP002 - SORTING EXTRACTED DATA **'.           16090099
161000                                                                  16100099
161100                                                                  16110099
161200******************************************************************16120099
161300* 2010-GET-INITIAL-TIMESTMPS                                      16130099
161400* PROCESS:  THIS PARAGRAPH WILL GET THE INITIAL TIMESTAMPS NEEDED 16140099
161500* TO DETERMIN IF A COMMIT IS NEEDED OR NOT.                       16150099
161600******************************************************************16160099
161700 2010-GET-INITIAL-TIMESTMPS.                                      16170099
161800                                                                  16180099
161900     EXEC SQL                                                     16190099
162000         SELECT CURRENT TIMESTAMP                                 16200099
162100             , (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)      16210099
162200         INTO                                                     16220099
162300               :PV-CURR-TMST                                      16230099
162400             , :PV-COMMIT-TMST                                    16240099
162500         FROM                                                     16250099
162600             TCKRSTCNTL                                           16260099
162700         WHERE                                                    16270099
162800             JOB_NAME =  :PC-CURRENT-JOB-NAME                     16280099
162900         AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 16290099
163000     END-EXEC.                                                    16300099
163100                                                                  16310099
163200     EVALUATE TRUE                                                16320099
163300         WHEN SQLCODE = ZERO                                      16330099
163400             CONTINUE                                             16340099
163500         WHEN OTHER                                               16350099
163600              MOVE '2010-GET-INITIAL-TIMESTMPS'                   16360099
163700                               TO  PV-PARAGRAPH-NAME              16370099
163800              MOVE 'SET INITIAL TIMESTAMPS'                       16380099
163900                               TO  PV-DB2-OPERATION-ATTEMPTED     16390099
164000              PERFORM 9999-SQL-ABEND                              16400099
164100     END-EVALUATE.                                                16410099
164200                                                                  16420099
164300                                                                  16430099
164400******************************************************************16440099
164500* 2020-GET-CURRENT-TIMESTMPS                                      16450099
164600* PROCESS:  THIS PARAGRAPH WILL GET THE CURRENT TIMESTAMP NEEDED  16460099
164700* TO DETERMINE IF A COMMIT IS NEEDED.                             16470099
164800******************************************************************16480099
164900 2020-GET-CURRENT-TIMESTMP.                                       16490099
165000     EXEC SQL                                                     16500099
165100         SET :PV-CURR-TMST = CURRENT TIMESTAMP                    16510099
165200     END-EXEC                                                     16520099
165300                                                                  16530099
165400     EVALUATE TRUE                                                16540099
165500         WHEN SQLCODE = ZERO                                      16550099
165600             CONTINUE                                             16560099
165700         WHEN OTHER                                               16570099
165800              MOVE '2020-GET-CURRENT-TIMESTMP'                    16580099
165900                               TO  PV-PARAGRAPH-NAME              16590099
166000              MOVE 'SET CURRENT TIMESTAMP'                        16600099
166100                               TO  PV-DB2-OPERATION-ATTEMPTED     16610099
166200              PERFORM 9999-SQL-ABEND                              16620099
166300     END-EVALUATE.                                                16630099
166400                                                                  16640099
166500                                                                  16650099
166600******************************************************************16660099
166700* 2030-TAKE-COMMIT                                                16670099
166800* PROCESS:  THIS PARAGRAPH WILL TAKE A COMMIT TO FREE ANY LOCKS   16680099
166900*  THAT ARE NOT NEEDED.                                           16690099
167000******************************************************************16700099
167100 2030-TAKE-COMMIT.                                                16710099
167200     EXEC SQL                                                     16720099
167300         COMMIT                                                   16730099
167400     END-EXEC.                                                    16740099
167500                                                                  16750099
167600     EVALUATE TRUE                                                16760099
167700         WHEN SQLCODE = ZERO                                      16770099
167800             CONTINUE                                             16780099
167900         WHEN OTHER                                               16790099
168000              MOVE '2030-TAKE-COMMIT'                             16800099
168100                               TO  PV-PARAGRAPH-NAME              16810099
168200              MOVE 'COMMITING THE UNIT OF WORK'                   16820099
168300                               TO  PV-DB2-OPERATION-ATTEMPTED     16830099
168400              PERFORM 9999-SQL-ABEND                              16840099
168500     END-EVALUATE.                                                16850099
168600                                                                  16860099
168700                                                                  16870099
168800******************************************************************16880099
168900* 2100-PROCESS-RECORDS                                           *16890099
169000* PROCESS:  THIS PARAGRAPH WILL GET AND MOVE THE INFORMATION TO  *16900099
169100* THE SORT-WORK-FILE, AND THEN RELASE THE RECORD.                *16910099
169200******************************************************************16920099
169300 2100-PROCESS-RECORDS.                                            16930099
169400                                                                  16940099
169500     SET PS-VALID-SORT-RECORD TO TRUE                             16950099
169600     MOVE SPACES              TO SW-VND-STYLE                     16960099
169700                                                                  16970099
169800     IF DFMEIT-DFCT-ITEM-NBR = ZERO                               16980099
169900         IF CC-ALL-VENDORS                                        16990099
170000             MOVE DFMEIT-MDSE-DEPT-NBR   TO  SW-DEPT-NBR          17000099
170100                                             SW-SKU-NBR(1:3)      17010099
170200             MOVE DFMEIT-MDSE-CLASS-NBR  TO  SW-SKU-NBR(4:2)      17020099
170300             MOVE PC-SKU-DESC-ZERO       TO  SW-VND-NAME          17030099
170400             MOVE '???'                  TO  SW-SKU-NBR(6:3)      17040099
170500             MOVE SPACES                 TO  SW-SKU-DESC          17050099
170600                                             SW-VND-NBR           17060099
170700         ELSE                                                     17070099
170800             SET PS-INVALID-SORT-RECORD  TO TRUE                  17080099
170900         END-IF                                                   17090099
171000     ELSE                                                         17100099
171100         PERFORM 7300-SELECT-SKU-INFO                             17110099
171200         IF SQLCODE = PC-ROW-NOT-FOUND                            17120099
171300             IF CC-ALL-VENDORS                                    17130099
171400                 MOVE DFMEIT-MDSE-DEPT-NBR                        17140099
171500                                         TO  SW-DEPT-NBR          17150099
171600                 MOVE PC-SKU-DESC-NOT-FOUND                       17160099
171700                                         TO  SW-VND-NAME          17170099
171800                 STRING DFMEIT-MDSE-DEPT-NBR                      17180099
171900                        DFMEIT-MDSE-CLASS-NBR                     17190099
172000                        '???'                                     17200099
172100                        DELIMITED BY SIZE                         17210099
172200                        INTO SW-SKU-NBR                           17220099
172300                 END-STRING                                       17230099
172400                 MOVE SPACES             TO  SW-SKU-DESC          17240099
172500                                             SW-VND-NBR           17250099
172600             ELSE                                                 17260099
172700                 SET PS-INVALID-SORT-RECORD                       17270099
172800                                         TO TRUE                  17280099
172900             END-IF                                               17290099
173000         ELSE                                                     17300099
173100             MOVE XLT00004-DEPT-NBR      TO  PV-DEPT              17310099
173200             MOVE PV-DEPT(2:3)           TO  SW-DEPT-NBR          17320099
173300             MOVE XLT00003-SKU-NBR       TO  PV-SKU               17330099
173400             MOVE PV-SKU                 TO  SW-SKU-NBR           17340099
173500             MOVE XLT00003-SKU-DESC      TO  SW-SKU-DESC          17350099
173600             MOVE XLT00004-VS-NBR        TO  SW-VND-STYLE         17360099
173700             MOVE EXTENT-DUN-NBR         TO  SW-VND-NBR           17370099
173800             MOVE ENTNME-ENT-NAME-DESC   TO  SW-VND-NAME          17380099
173900         END-IF                                                   17390099
174000     END-IF.                                                      17400099
174100                                                                  17410099
174200     IF SW-DEPT-NBR                  = PV-HOLD-DEPT-NBR           17420099
174300     OR  PS-INVALID-SORT-RECORD                                   17430099
174400         CONTINUE                                                 17440099
174500     ELSE                                                         17450099
174600         MOVE SW-DEPT-NBR           TO PV-HOLD-DEPT-NBR           17460099
174700         PERFORM 6100-GET-BUYER-NAME                              17470099
174800     END-IF.                                                      17480099
174900                                                                  17490099
175000     IF (( DP003-BYR-NMBR = CC-BUYER-NBR )                        17500099
175100     OR  ( CC-ALL-BUYERS ))                                       17510099
175200         MOVE DP003-BYR-NAME         TO SW-BUYER-NAME             17520099
175300         MOVE DP003-BYR-NMBR         TO SW-BUYER-NBR              17530099
175400     ELSE                                                         17540099
175500         SET PS-INVALID-SORT-RECORD  TO TRUE                      17550099
175600     END-IF.                                                      17560099
175700                                                                  17570099
175800     MOVE DFCTOR-DFCT-ORD-ID             TO  SW-DFCT-ORD-ID.      17580099
175900     MOVE DFCTOR-ORD-DTE                 TO  SW-ORD-DTE.          17590099
176000     MOVE DFMEIT-UNIT-COST-AMT           TO  SW-UNIT-COST-AMT.    17600099
176100     MOVE DFMEIT-RTL-COST-AMT            TO  SW-RETL-COST-AMT.    17610099
176200     MOVE DFCTOR-LOC-ID                  TO  SW-LOC-ID.           17620099
176300     MOVE DFCTOR-DFCT-ORD-ID-CDE         TO  SW-DFCT-ORD-ID-CDE.  17630099
176400     MOVE DFCTOR-DFCT-ORD-STAT-CDE       TO  SW-DFCT-ORD-STAT-CDE.17640099
176500     MOVE DFCTOR-STATUS-CHG-DTE          TO  SW-STATUS-CHG-DTE.   17650099
176600     MOVE DFMEIT-MKOUT-ORD-STAT-CDE      TO  SW-MKOUT-ORD-STAT-CDE17660099
176700                                                                  17670099
176800     IF SW-SKU-NBR            = PV-HOLD-SKU-NBR                   17680099
176900         CONTINUE                                                 17690099
177000     ELSE                                                         17700099
177100         MOVE SW-SKU-NBR     TO PV-HOLD-SKU-NBR                   17710099
177200     END-IF.                                                      17720099
177300                                                                  17730099
177400     IF PS-INVALID-SORT-RECORD                                    17740099
177500         CONTINUE                                                 17750099
177600     ELSE                                                         17760099
177700         RELEASE SORT-WORK-RECORD                                 17770099
177800     END-IF.                                                      17780099
177900                                                                  17790099
178000     PERFORM 7200-FETCH-DRIVER-CURSOR.                            17800099
178100*                                                                 17810099
178200******************************************************************17820099
178300* 3000-RETURN-SORT-WORK-FILE                                     *17830099
178400* PROCESS:  THIS PARAGRAPH WILL GET AND MOVE THE INFORMATION TO  *17840099
178500* THE SORT-WORK-FILE, AND THEN RELASE THE RECORD.                *17850099
178600******************************************************************17860099
178700 3000-RETURN-SORT-WORK-FILE.                                      17870099
178800                                                                  17880099
178900     DISPLAY '** RVKRP002 - RETURNING SORTED DATA **'.            17890099
179000     DISPLAY '**'.                                                17900099
179100                                                                  17910099
179200     PERFORM 7400-RETURN-SORT-WORK-FILE.                          17920099
179300                                                                  17930099
179400     IF PS-END-OF-SORT-WORK-FILE                                  17940099
179500         SET PS-NO-DATA              TO TRUE                      17950099
179600         PERFORM 8900-EMPTY-DEFECT-RPT                            17960099
179700     ELSE                                                         17970099
179800         MOVE SO-BUYER-NBR           TO PV-HOLD-BUYER-NBR         17980099
179900         MOVE SO-BUYER-NAME          TO PV-HOLD-BUYER-NAME        17990099
180000         MOVE SO-DEPT-NBR            TO PV-HOLD-DEPT-NBR          18000099
180100         MOVE SO-VND-NBR             TO PV-HOLD-VNDUN-NBR         18010099
180200         MOVE SO-VND-NAME            TO PV-HOLD-VENDOR-NAME       18020099
180300         MOVE SO-DFCT-ORD-ID         TO PV-HOLD-LIST-NBR          18030099
180400         MOVE SO-LOC-ID              TO PV-HOLD-LIST-LOCATION     18040099
180500         MOVE SO-DFCT-ORD-ID-CDE     TO PV-WORK-LIST-TYPE         18050099
180600         MOVE SO-DFCT-ORD-STAT-CDE   TO PV-WORK-LIST-STATUS       18060099
180700                                                                  18070099
180800* IF THE ORDER IS A MARKOUT PENDING APPROVAL, USE THE DETAIL      18080099
180900* STATUS.  THIS IS NEEDED BECAUSE SOME OF THE DETAIL MAY BE       18090099
181000* "APPROVED" WHILE THE HEADER RECORD IS STILL "PENDING"           18100099
181100         IF PV-TYPE-MARKOUT AND PV-STATUS-PENDING                 18110099
181200             MOVE SO-MKOUT-ORD-STAT-CDE                           18120099
181300                                     TO PV-WORK-LIST-STATUS       18130099
181400         END-IF                                                   18140099
181500         PERFORM 6000-GET-LIST-STATUS                             18150099
181600         MOVE SO-STATUS-CHG-DTE      TO PV-HOLD-STAT-DATE         18160099
181700         MOVE SO-SKU-NBR             TO PV-HOLD-SKU-NBR           18170099
181800         MOVE SO-SKU-DESC            TO PV-HOLD-SKU-DESC          18180099
181900         MOVE SO-VND-STYLE           TO PV-HOLD-VENDOR-STYLE      18190099
182000         MOVE SO-UNIT-COST-AMT       TO PV-HOLD-COST              18200099
182100         MOVE SO-BUYER-NAME          TO PV-HOLD-BUYER-NAME        18210099
182200         MOVE SO-BUYER-NBR           TO PV-HOLD-BUYER-NBR         18220099
182300         MOVE PC-MAX-REPORT-LINES    TO PV-DETAIL-LINE-COUNT      18230099
182400                                        PV-SUM-LINE-COUNT         18240099
182500     END-IF.                                                      18250099
182600                                                                  18260099
182700     PERFORM 3100-PROCESS-DEFECT-ITEMS                            18270099
182800         UNTIL PS-END-OF-SORT-WORK-FILE.                          18280099
182900                                                                  18290099
183000******************************************************************18300099
183100* 3100-PROCESS-DEFECT-ITEMS                                       18310099
183200* PROCESS:  THIS PARAGRAPH WILL READ THROUGH EACH VALID ROW FROM  18320099
183300* THE CURSOR; PRINTING DETAIL ROWS, AND KEEPING A TOTAL FOR EACH  18330099
183400* BREAK LEVEL. EACH BREAK LEVEL WILL FIRST PERFORM THE LOWER      18340099
183500* LEVEL BREAK LOGIC, THE ITS OWN LOGIC.                           18350099
183600******************************************************************18360099
183700 3100-PROCESS-DEFECT-ITEMS.                                       18370099
183800     IF SO-BUYER-NBR                  =  PV-HOLD-BUYER-NBR        18380099
183900        IF SO-DFCT-ORD-ID             =  PV-HOLD-LIST-NBR         18390099
184000           IF SO-SKU-NBR              =  PV-HOLD-SKU-NBR          18400099
184100              IF SO-UNIT-COST-AMT     =  PV-HOLD-COST             18410099
184200                 PERFORM  5000-ACCUM-SKU-COST-TOTALS              18420099
184300              ELSE                                                18430099
184400                 PERFORM  5100-COST-BREAK                         18440099
184500           ELSE                                                   18450099
184600              PERFORM  5200-SKU-BREAK                             18460099
184700           END-IF                                                 18470099
184800        ELSE                                                      18480099
184900           PERFORM  5300-LIST-BREAK                               18490099
185000        END-IF                                                    18500099
185100     ELSE                                                         18510099
185200        PERFORM  5400-BUYER-BREAK                                 18520099
185300     END-IF.                                                      18530099
185400                                                                  18540099
185500     PERFORM 6300-ACCUM-DEPT-TOTALS.                              18550099
185600                                                                  18560099
185700     PERFORM 7400-RETURN-SORT-WORK-FILE.                          18570099
185800                                                                  18580099
185900*3000-EXIT.                                                       18590099
186000******************************************************************18600099
186100* 4000-SET-UP-DETAIL-LINE.                                       *18610099
186200* PROCESS:  THIS PARAGRAPH WILL MOVE THE DETAIL INFORMATION THAT *18620099
186300* IS NEEDED FOR EVER ROW (IE. NONE OF THESE FIELDS WILL BE SPACED*18630099
186400* OUT FOR THE BREAK LOGIC)                                       *18640099
186500******************************************************************18650099
186600 4000-SET-UP-DETAIL-LINE.                                         18660099
186700                                                                  18670099
186800     MOVE PV-HOLD-VENDOR-NAME          TO DL-VENDOR-NAME.         18680099
186900     MOVE PV-HOLD-SKU-NBR              TO DL-SKU-NUMBER .         18690099
187000     MOVE PV-HOLD-SKU-DESC             TO DL-SKU-DESCRIPTION.     18700099
187100     MOVE PV-HOLD-VENDOR-STYLE         TO DL-VENDOR-STYLE.        18710099
187200     MOVE PA-QTY-COST-TOTAL            TO DL-QTY.                 18720099
187300     MOVE PA-TOT-UNIT-COST-TOTAL       TO DL-TOTAL-COST.          18730099
187400     MOVE PA-TOT-RETL-COST-TOTAL       TO DL-TOTAL-RETAIL.        18740099
187500                                                                  18750099
187600*4000-EXIT.                                                       18760099
187700*                                                                 18770099
187800******************************************************************18780099
187900* 4100-SETUP-NEW-DETAIL-LINE.                                     18790099
188000* PROCESS:  THIS PARAGRAPH WILL BE PERFORMED IF THERE IS A PAGE   18800099
188100* BREAK.  IT WILL RESET THE DETAIL LINE, FILLING IN ALL THE FIELDS18810099
188200* THAT HAVE BEEN SPACED OUT.                                      18820099
188300******************************************************************18830099
188400 4100-SETUP-NEW-DETAIL-LINE.                                      18840099
188500                                                                  18850099
188600     MOVE PV-HOLD-DEPT-NBR             TO DL-DEPT-NBR.            18860099
188700     MOVE PV-HOLD-LIST-NBR             TO PV-DISPLAY-LIST-NBR.    18870099
188800     MOVE PV-DISPLAY-LIST-NBR          TO DL-LIST-NBR.            18880099
188900                                                                  18890099
189000     MOVE PV-HOLD-STAT-YEAR            TO PV-WORK-YEAR.           18900099
189100     MOVE PV-HOLD-STAT-DAY             TO PV-WORK-DAY.            18910099
189200     MOVE PV-HOLD-STAT-MONTH           TO PV-WORK-MONTH.          18920099
189300     MOVE PV-WORK-DATE                 TO DL-LIST-STAT-DATE.      18930099
189400                                                                  18940099
189500     MOVE PV-HOLD-LIST-LOCATION        TO DL-LIST-LOCATION.       18950099
189600     MOVE PV-HOLD-LIST-STATUS          TO DL-LIST-STATUS.         18960099
189700     MOVE PV-HOLD-LIST-TYPE            TO DL-LIST-TYPE.           18970099
189800                                                                  18980099
189900     SET PS-NO-NEW-LINE                TO TRUE.                   18990099
190000                                                                  19000099
190100*                                                                 19010099
190200******************************************************************19020099
190300* 4101-SETUP-SUM-DETAIL-LINE.                                     19030099
190400* PROCESS:  THIS PARAGRAPH WILL BE PERFORMED TO SET UP THE SUMMARY19040099
190500* DETAILL LINE                                                    19050099
190600******************************************************************19060099
190700 4101-SETUP-SUM-DETAIL-LINE.                                      19070099
190800                                                                  19080099
190900     MOVE PV-HOLD-DEPT-NBR             TO DLS-DEPT-NBR.           19090099
191000     MOVE PV-HOLD-LIST-NBR             TO PV-DISPLAY-LIST-NBR.    19100099
191100     MOVE PV-DISPLAY-LIST-NBR          TO DLS-LIST-NBR.           19110099
191200                                                                  19120099
191300     MOVE PV-HOLD-STAT-YEAR            TO PV-WORK-YEAR.           19130099
191400     MOVE PV-HOLD-STAT-DAY             TO PV-WORK-DAY.            19140099
191500     MOVE PV-HOLD-STAT-MONTH           TO PV-WORK-MONTH.          19150099
191600     MOVE PV-WORK-DATE                 TO DLS-LIST-STAT-DATE.     19160099
191700                                                                  19170099
191800     MOVE PV-HOLD-LIST-LOCATION        TO DLS-LIST-LOCATION.      19180099
191900     MOVE PV-HOLD-LIST-STATUS          TO DLS-LIST-STATUS.        19190099
192000     MOVE PV-HOLD-LIST-TYPE            TO DLS-LIST-TYPE.          19200099
192100                                                                  19210099
192200*4100-EXIT.                                                       19220099
192300*                                                                 19230099
192400                                                                  19240099
192500******************************************************************19250099
192600* 5000-ACCUM-SKU-COST-TOTALS.                                     19260099
192700* PROCESS:  THIS PARAGRAPH ADD THE COST OF THE CURRENT   ITEM     19270099
192800* TO THE TOTAL FIELD AT THE SKU/PRICE FIELD.  THIS WILL SUM ITEMS 19280099
192900* WITH THE SAME SKU NUMBER, AND PRICE.                            19290099
193000******************************************************************19300099
193100 5000-ACCUM-SKU-COST-TOTALS.                                      19310099
193200                                                                  19320099
193300     ADD  1                            TO PA-QTY-COST-TOTAL.      19330099
193400     ADD  SO-UNIT-COST-AMT             TO PA-TOT-UNIT-COST-TOTAL. 19340099
193500     ADD  SO-RETL-COST-AMT             TO PA-TOT-RETL-COST-TOTAL. 19350099
193600                                                                  19360099
193700*5000-EXIT.                                                       19370099
193800*                                                                 19380099
193900******************************************************************19390099
194000* 5100-COST-BREAK.                                                19400099
194100* PROCESS:  THIS PARAGRAPH WILL PERFORM THE COST BREAK ROUTINE.   19410099
194200* FIRST WRITE THE DETAIL LINE WITH THE PREVIOUSLY ACCUMULATED     19420099
194300*      TOTALS.                                                    19430099
194400* THEN ADD THOSE TOTALS TO THE SKU'S TOTALS AND INITIALIZE        19440099
194500*      THE SKU/COST TOTAL FIELDS WITH THE NEW SKU/COST'S COST.    19450099
194600* FINALLY, SPACE OUT ALL THE DPT, VENDOR, LIST INFORMATION -- THIS19460099
194700*      INFO WILL BE FILLED IN BY EACH APPROPRIATE BREAK ROUTINE.  19470099
194800******************************************************************19480099
194900 5100-COST-BREAK.                                                 19490099
195000                                                                  19500099
195100     IF CC-TOTAL-REPORT                                           19510099
195200         CONTINUE                                                 19520099
195300     ELSE                                                         19530099
195400         IF CC-DETAIL-REPORT                                      19540099
195500             PERFORM 8000-WRITE-DETAIL-LINE                       19550099
195600         END-IF                                                   19560099
195700     END-IF.                                                      19570099
195800                                                                  19580099
195900*    SET UP THE DETAIL LINE BEFORE ANY OF THE "NEW" DATA IS MOVED 19590099
196000*    TO THE HOLD FIELDS                                           19600099
196100     IF CC-SUMMARY-REPORT                                         19610099
196200         PERFORM 4101-SETUP-SUM-DETAIL-LINE                       19620099
196300     END-IF.                                                      19630099
196400                                                                  19640099
196500     ADD  PA-QTY-COST-TOTAL        TO PA-QTY-SKU-TOTAL.           19650099
196600     ADD  PA-TOT-UNIT-COST-TOTAL   TO PA-UNIT-COST-SKU-TOTAL.     19660099
196700     ADD  PA-TOT-RETL-COST-TOTAL   TO PA-RETL-COST-SKU-TOTAL.     19670099
196800                                                                  19680099
196900     MOVE 1                        TO PA-QTY-COST-TOTAL.          19690099
197000     MOVE SO-UNIT-COST-AMT         TO PA-TOT-UNIT-COST-TOTAL.     19700099
197100     MOVE SO-RETL-COST-AMT         TO PA-TOT-RETL-COST-TOTAL.     19710099
197200                                                                  19720099
197300     MOVE SO-UNIT-COST-AMT         TO PV-HOLD-COST.               19730099
197400                                                                  19740099
197500     MOVE SPACES TO DL-DEPT-NBR                                   19750099
197600                    DL-LIST-STAT-DATE                             19760099
197700                    DL-LIST-LOCATION                              19770099
197800                    DL-LIST-STATUS                                19780099
197900                    DL-LIST-TYPE                                  19790099
198000                    DL-LIST-NBR.                                  19800099
198100                                                                  19810099
198200*5100-EXIT.                                                       19820099
198300*                                                                 19830099
198400******************************************************************19840099
198500* 5200-SKU-BREAK.                                                 19850099
198600* PROCESS:  THIS PARAGRAPH WILL PERFORM THE SKU BREAK ROUTINE.    19860099
198700* FIRST PERFORM THE COST BREAK PROCEDURE TO ADD THE FINAL SKU/COST19870099
198800*      TOTAL TO THE SKU TOTALS.                                   19880099
198900* THEN ADD THOSE TOTALS TO THE LIST'S TOTALS AND INITIALIZE       19890099
199000*      THE SKU TOTAL FIELDS.                                      19900099
199100* FINALLY, MOVE THE NEW SKU DETAIL INFO TO THE HOLD FIELDS.       19910099
199200******************************************************************19920099
199300 5200-SKU-BREAK.                                                  19930099
199400                                                                  19940099
199500     PERFORM 5100-COST-BREAK.                                     19950099
199600                                                                  19960099
199700     MOVE 'PA-QTY-LIST-TOTAL             ' TO PV-FIELD-NAME.      19970099
199800     COMPUTE PA-QTY-LIST-TOTAL =                                  19980099
199900             PA-QTY-LIST-TOTAL + PA-QTY-SKU-TOTAL                 19990099
200000     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20000099
200100*    ADD  PA-QTY-SKU-TOTAL         TO PA-QTY-LIST-TOTAL.          20010099
200200                                                                  20020099
200300     MOVE 'PA-UNIT-COST-LIST-TOTAL         ' TO PV-FIELD-NAME.    20030099
200400     COMPUTE PA-UNIT-COST-LIST-TOTAL =                            20040099
200500             PA-UNIT-COST-LIST-TOTAL + PA-UNIT-COST-SKU-TOTAL     20050099
200600     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20060099
200700*    ADD  PA-UNIT-COST-SKU-TOTAL   TO PA-UNIT-COST-LIST-TOTAL.    20070099
200800                                                                  20080099
200900     MOVE 'PA-RETL-COST-LIST-TOTAL         ' TO PV-FIELD-NAME.    20090099
201000     COMPUTE PA-RETL-COST-LIST-TOTAL =                            20100099
201100             PA-RETL-COST-LIST-TOTAL + PA-RETL-COST-SKU-TOTAL     20110099
201200     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20120099
201300*    ADD  PA-UNIT-COST-SKU-TOTAL   TO PA-UNIT-COST-LIST-TOTAL.    20130099
201400                                                                  20140099
201500     MOVE 0                        TO PA-QTY-SKU-TOTAL            20150099
201600                                      PA-UNIT-COST-SKU-TOTAL      20160099
201700                                      PA-RETL-COST-SKU-TOTAL.     20170099
201800                                                                  20180099
201900     MOVE SO-VND-NAME              TO PV-HOLD-VENDOR-NAME.        20190099
202000     MOVE SO-VND-STYLE             TO PV-HOLD-VENDOR-STYLE.       20200099
202100     MOVE SO-SKU-NBR               TO PV-HOLD-SKU-NBR.            20210099
202200     MOVE SO-SKU-DESC              TO PV-HOLD-SKU-DESC.           20220099
202300                                                                  20230099
202400*5200-EXIT.                                                       20240099
202500*                                                                 20250099
202600******************************************************************20260099
202700* 5300-LIST-BREAK.                                               *20270099
202800* PROCESS:  THIS PARAGRAPH WILL PERFORM THE LIST BREAK ROUTINE.  *20280099
202900* FIRST PERFORM THE SKU BREAK PROCEDURE TO ADD THE FINAL SKU'S   *20290099
203000*      TOTALS TO THE LIST TOTALS.                                *20300099
203100* THEN PRINT THE LIST TOTALS TO THE REPORT.                      *20310099
203200* THEN ADD THE LIST TOTALS TO THE VENDOR TOTALS AND INITIALIZE   *20320099
203300*      THE LIST TOTAL FIELDS.                                    *20330099
203400* FINALLY, MOVE THE NEW LIST DETAIL INFO TO THE HOLD FIELDS.     *20340099
203500******************************************************************20350099
203600 5300-LIST-BREAK.                                                 20360099
203700                                                                  20370099
203800     PERFORM 5200-SKU-BREAK.                                      20380099
203900                                                                  20390099
204000     MOVE PA-QTY-LIST-TOTAL        TO TL-QTY                      20400099
204100                                      DLS-QTY.                    20410099
204200     MOVE PA-UNIT-COST-LIST-TOTAL  TO TL-TOTAL-COST               20420099
204300                                      DLS-TOTAL-COST.             20430099
204400     MOVE PA-RETL-COST-LIST-TOTAL  TO TL-TOTAL-RETAIL             20440099
204500                                      DLS-TOTAL-RETAIL.           20450099
204600     MOVE PC-LIST-TOTAL            TO TL-TOTAL-DESCRIPTION.       20460099
204700                                                                  20470099
204800*    ADD THE LIST COUNT AND COST TO THE BUYER COUNT AND COST      20480099
204900     MOVE 'PA-QTY-BUYER-TOTAL            ' TO PV-FIELD-NAME.      20490099
205000     COMPUTE PA-QTY-BUYER-TOTAL =                                 20500099
205100             PA-QTY-BUYER-TOTAL + PA-QTY-LIST-TOTAL               20510099
205200     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20520099
205300*    ADD  PA-QTY-LIST-TOTAL        TO PA-QTY-BUYER-TOTAL.         20530099
205400                                                                  20540099
205500     MOVE 'PA-UNIT-COST-BUYER-TOTAL        ' TO PV-FIELD-NAME.    20550099
205600     COMPUTE PA-UNIT-COST-BUYER-TOTAL =                           20560099
205700             PA-UNIT-COST-BUYER-TOTAL + PA-UNIT-COST-LIST-TOTAL   20570099
205800     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20580099
205900*    ADD  PA-UNIT-COST-LIST-TOTAL  TO PA-UNIT-COST-BUYER-TOTAL.   20590099
206000                                                                  20600099
206100     MOVE 'PA-RETL-COST-BUYER-TOTAL        ' TO PV-FIELD-NAME.    20610099
206200     COMPUTE PA-RETL-COST-BUYER-TOTAL =                           20620099
206300             PA-RETL-COST-BUYER-TOTAL + PA-RETL-COST-LIST-TOTAL   20630099
206400     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             20640099
206500*    ADD  PA-RETL-COST-LIST-TOTAL  TO PA-RETL-COST-BUYER-TOTAL.   20650099
206600                                                                  20660099
206700     IF CC-TOTAL-REPORT                                           20670099
206800         CONTINUE                                                 20680099
206900     ELSE                                                         20690099
207000         IF CC-SUMMARY-REPORT                                     20700099
207100             PERFORM 8000-WRITE-SUM-LINE                          20710099
207200          END-IF                                                  20720099
207300     END-IF.                                                      20730099
207400                                                                  20740099
207500     IF CC-TOTAL-REPORT                                           20750099
207600         CONTINUE                                                 20760099
207700     ELSE                                                         20770099
207800         IF CC-DETAIL-REPORT                                      20780099
207900             PERFORM 8200-WRITE-BLANK-DETAIL-LINE                 20790099
208000             PERFORM 8100-WRITE-TOTAL-DETAIL-LINE                 20800099
208100         END-IF                                                   20810099
208200     END-IF.                                                      20820099
208300                                                                  20830099
208400     MOVE 0                        TO PA-QTY-LIST-TOTAL           20840099
208500                                      PA-UNIT-COST-LIST-TOTAL     20850099
208600                                      PA-RETL-COST-LIST-TOTAL.    20860099
208700                                                                  20870099
208800     MOVE SO-STATUS-CHG-DTE        TO PV-HOLD-STAT-DATE.          20880099
208900     MOVE PV-HOLD-STAT-YEAR        TO PV-WORK-YEAR.               20890099
209000     MOVE PV-HOLD-STAT-DAY         TO PV-WORK-DAY.                20900099
209100     MOVE PV-HOLD-STAT-MONTH       TO PV-WORK-MONTH.              20910099
209200     MOVE PV-WORK-DATE             TO DL-LIST-STAT-DATE.          20920099
209300                                                                  20930099
209400     MOVE SO-LOC-ID                TO PV-HOLD-LIST-LOCATION       20940099
209500                                      DL-LIST-LOCATION.           20950099
209600     MOVE SO-DFCT-ORD-ID-CDE       TO PV-WORK-LIST-TYPE.          20960099
209700     MOVE SO-DFCT-ORD-STAT-CDE     TO PV-WORK-LIST-STATUS.        20970099
209800                                                                  20980099
209900* IF THE ORDER IS A MARKOUT PENDING APPROVAL, USE THE DETAIL      20990099
210000* STATUS.  THIS IS NEEDED BECAUSE SOME OF THE DETAIL MAY BE       21000099
210100* "APPROVED" WHILE THE HEADER RECORD IS STILL "PENDING".          21010099
210200     IF PV-TYPE-MARKOUT AND PV-STATUS-PENDING                     21020099
210300         MOVE SO-MKOUT-ORD-STAT-CDE TO PV-WORK-LIST-STATUS        21030099
210400     END-IF.                                                      21040099
210500                                                                  21050099
210600     PERFORM 6000-GET-LIST-STATUS.                                21060099
210700     MOVE PV-HOLD-LIST-STATUS          TO DL-LIST-STATUS          21070099
210800                                          DLS-LIST-STATUS.        21080099
210900     MOVE PV-HOLD-LIST-TYPE            TO DL-LIST-TYPE            21090099
211000                                          DLS-LIST-TYPE.          21100099
211100     MOVE SO-DFCT-ORD-ID               TO PV-DISPLAY-LIST-NBR     21110099
211200                                          PV-HOLD-LIST-NBR.       21120099
211300     MOVE PV-DISPLAY-LIST-NBR          TO DL-LIST-NBR             21130099
211400                                          DLS-LIST-NBR.           21140099
211500     MOVE SO-VND-NBR                   TO PV-HOLD-VNDUN-NBR.      21150099
211600     MOVE SO-DEPT-NBR                  TO DL-DEPT-NBR             21160099
211700                                          PV-HOLD-DEPT-NBR.       21170099
211800                                                                  21180099
211900                                                                  21190099
212000*5300-EXIT.                                                       21200099
212100*                                                                 21210099
212200******************************************************************21220099
212300* 5400-BUYER-BREAK.                                               21230099
212400* PROCESS:  THIS PARAGRAPH WILL PERFORM THE BUYER BREAK ROUTINE.  21240099
212500* FIRST PERFORM THE DEPARTMENT BREAK ROUTINE TO ADD THE FINAL DEPT21250099
212600*      TOTALS TO THE BUYER TOTALS.                                21260099
212700* THEN PRINT THE BUYER TOTALS TO THE REPORT.                      21270099
212800* THEN ADD THE BUYER TOTALS TO THE GRAND TOTAL AND INITIALZIAE THE21280099
212900*      THE BUYER TOTAL FIELDS.                                    21290099
213000* FINALLY, MOVE THE NEW BUYER INFO TO THE HOLD FIELDS.            21300099
213100******************************************************************21310099
213200 5400-BUYER-BREAK.                                                21320099
213300                                                                  21330099
213400     PERFORM 5300-LIST-BREAK.                                     21340099
213500                                                                  21350099
213600     PERFORM 5600-PRINT-DEPT-TOTALS.                              21360099
213700                                                                  21370099
213800     MOVE PA-QTY-BUYER-TOTAL       TO TL-QTY                      21380099
213900                                      TLS-QTY.                    21390099
214000     MOVE PA-UNIT-COST-BUYER-TOTAL TO TL-TOTAL-COST               21400099
214100                                      TLS-TOTAL-COST.             21410099
214200     MOVE PA-RETL-COST-BUYER-TOTAL TO TL-TOTAL-RETAIL             21420099
214300                                      TLS-TOTAL-RETAIL.           21430099
214400     MOVE PC-BUYER-TOTAL           TO TL-TOTAL-DESCRIPTION        21440099
214500                                      TLS-TOTAL-DESCRIPTION.      21450099
214600                                                                  21460099
214700     IF CC-TOTAL-REPORT                                           21470099
214800         CONTINUE                                                 21480099
214900     ELSE                                                         21490099
215000         IF CC-DETAIL-REPORT                                      21500099
215100             PERFORM 8100-WRITE-TOTAL-DETAIL-LINE                 21510099
215200         END-IF                                                   21520099
215300     END-IF.                                                      21530099
215400                                                                  21540099
215500     IF CC-TOTAL-REPORT                                           21550099
215600         CONTINUE                                                 21560099
215700     ELSE                                                         21570099
215800         IF CC-SUMMARY-REPORT                                     21580099
215900             PERFORM 8100-WRITE-TOTAL-SUM-LINE                    21590099
216000         END-IF                                                   21600099
216100     END-IF.                                                      21610099
216200                                                                  21620099
216300                                                                  21630099
216400*    ADD THE BUYER COUNT AND TOTAL COST TO THE REPORT GRAND       21640099
216500*    TOTAL COUNT AND TOTAL COST AND TOTAL RETAIL                  21650099
216600     MOVE 'PA-QTY-GRAND-TOTAL            ' TO PV-FIELD-NAME.      21660099
216700     COMPUTE PA-QTY-GRAND-TOTAL =                                 21670099
216800             PA-QTY-GRAND-TOTAL + PA-QTY-BUYER-TOTAL              21680099
216900     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             21690099
217000*    ADD  PA-QTY-BUYER-TOTAL       TO PA-QTY-GRAND-TOTAL.         21700099
217100                                                                  21710099
217200     MOVE 'PA-UNIT-COST-GRAND-TOTAL        ' TO PV-FIELD-NAME.    21720099
217300     COMPUTE PA-UNIT-COST-GRAND-TOTAL =                           21730099
217400             PA-UNIT-COST-GRAND-TOTAL + PA-UNIT-COST-BUYER-TOTAL  21740099
217500     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             21750099
217600*    ADD  PA-UNIT-COST-BUYER-TOTAL TO PA-UNIT-COST-GRAND-TOTAL.   21760099
217700                                                                  21770099
217800     MOVE 'PA-RETL-COST-GRAND-TOTAL        ' TO PV-FIELD-NAME.    21780099
217900     COMPUTE PA-RETL-COST-GRAND-TOTAL =                           21790099
218000             PA-RETL-COST-GRAND-TOTAL + PA-RETL-COST-BUYER-TOTAL  21800099
218100     ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR.             21810099
218200*    ADD  PA-RETL-COST-BUYER-TOTAL TO PA-RETL-COST-GRAND-TOTAL.   21820099
218300                                                                  21830099
218400     MOVE 0                        TO PA-QTY-BUYER-TOTAL          21840099
218500                                      PA-UNIT-COST-BUYER-TOTAL    21850099
218600                                      PA-RETL-COST-BUYER-TOTAL.   21860099
218700                                                                  21870099
218800     MOVE SO-BUYER-NBR             TO PV-HOLD-BUYER-NBR.          21880099
218900     MOVE SO-BUYER-NAME            TO PV-HOLD-BUYER-NAME          21890099
219000                                                                  21900099
219100     MOVE PC-MAX-REPORT-LINES      TO PV-DETAIL-LINE-COUNT.       21910099
219200                                                                  21920099
219300     IF  PS-END-OF-SORT-WORK-FILE                                 21930099
219400         CONTINUE                                                 21940099
219500     ELSE                                                         21950099
219600         IF CC-SUMMARY-REPORT                                     21960099
219700             PERFORM 8400-WRITE-SUM-COL-HEAD                      21970099
219800         END-IF                                                   21980099
219900     END-IF.                                                      21990099
220000                                                                  22000099
220100*5400-EXIT.                                                       22010099
220200*                                                                 22020099
220300******************************************************************22030099
220400* 5500-GRAND-TOTAL.                                               22040099
220500* PROCESS:  THIS PARAGRAPH WILL PERFORM THE GRAND TOTAL ROUTINE.  22050099
220600* FIRST PERFORM THE BUYER BREAK ROUTINE TO ADD THE FINAL BUYER'S  22060099
220700*      TOTALS TO THE GRAND TOTALS.                                22070099
220800* THEN PRINT THE GRAND TOTAL PAGE.                                22080099
220900* THEN ADD THE BUYER TOTALS TO THE GRAND TOTAL AND INITIALZIAE THE22090099
221000*      THE BUYER TOTAL FIELDS.                                    22100099
221100******************************************************************22110099
221200 5500-GRAND-TOTAL.                                                22120099
221300                                                                  22130099
221400     PERFORM 5400-BUYER-BREAK.                                    22140099
221500                                                                  22150099
221600     IF CC-DETAIL-REPORT                                          22160099
221700         PERFORM 8300-WRITE-DETAIL-PAGE-HEAD                      22170099
221800         WRITE DI-DEFECT-ITM-DETAIL-LINE                          22180099
221900             FROM GT-GRAND-TOTAL-HEADER                           22190099
222000             AFTER ADVANCING 2 LINES                              22200099
222100     END-IF.                                                      22210099
222200                                                                  22220099
222300     IF CC-SUMMARY-REPORT                                         22230099
222400         PERFORM 8300-WRITE-SUM-PAGE-HEAD                         22240099
222500         WRITE DI-DEFECT-ITM-SUM-LINE                             22250099
222600             FROM GT-GRAND-TOTAL-HEADER                           22260099
222700             AFTER ADVANCING 2 LINES                              22270099
222800     END-IF.                                                      22280099
222900                                                                  22290099
223000     IF CC-TOTAL-REPORT                                           22300099
223100         PERFORM 8300-WRITE-SUM-PAGE-HEAD                         22310099
223200         WRITE DI-DEFECT-ITM-SUM-LINE                             22320099
223300             FROM GT-GRAND-TOTAL-HEADER                           22330099
223400             AFTER ADVANCING 2 LINES                              22340099
223500     END-IF.                                                      22350099
223600                                                                  22360099
223700     MOVE PA-QTY-GRAND-TOTAL       TO GT-QTY.                     22370099
223800     MOVE PA-UNIT-COST-GRAND-TOTAL TO GT-TOTAL-COST.              22380099
223900     MOVE PA-RETL-COST-GRAND-TOTAL TO GT-TOTAL-RETAIL.            22390099
224000                                                                  22400099
224100     IF CC-DETAIL-REPORT                                          22410099
224200         WRITE DI-DEFECT-ITM-DETAIL-LINE                          22420099
224300             FROM GT-GRAND-TOTAL-QTY                              22430099
224400             AFTER ADVANCING 2 LINES                              22440099
224500         WRITE DI-DEFECT-ITM-DETAIL-LINE                          22450099
224600             FROM GT-GRAND-TOTAL-COST                             22460099
224700             AFTER ADVANCING 2 LINES                              22470099
224800         WRITE DI-DEFECT-ITM-DETAIL-LINE                          22480099
224900             FROM GT-GRAND-TOTAL-RETAIL                           22490099
225000             AFTER ADVANCING 2 LINES                              22500099
225100     END-IF.                                                      22510099
225200                                                                  22520099
225300     IF CC-SUMMARY-REPORT                                         22530099
225400         WRITE DI-DEFECT-ITM-SUM-LINE                             22540099
225500             FROM GT-GRAND-TOTAL-QTY                              22550099
225600             AFTER ADVANCING 2 LINES                              22560099
225700         WRITE DI-DEFECT-ITM-SUM-LINE                             22570099
225800             FROM GT-GRAND-TOTAL-COST                             22580099
225900             AFTER ADVANCING 2 LINES                              22590099
226000         WRITE DI-DEFECT-ITM-SUM-LINE                             22600099
226100             FROM GT-GRAND-TOTAL-RETAIL                           22610099
226200             AFTER ADVANCING 2 LINES                              22620099
226300     END-IF.                                                      22630099
226400                                                                  22640099
226500     IF CC-TOTAL-REPORT                                           22650099
226600         WRITE DI-DEFECT-ITM-SUM-LINE                             22660099
226700             FROM GT-GRAND-TOTAL-QTY                              22670099
226800             AFTER ADVANCING 2 LINES                              22680099
226900         WRITE DI-DEFECT-ITM-SUM-LINE                             22690099
227000             FROM GT-GRAND-TOTAL-COST                             22700099
227100             AFTER ADVANCING 2 LINES                              22710099
227200         WRITE DI-DEFECT-ITM-SUM-LINE                             22720099
227300             FROM GT-GRAND-TOTAL-RETAIL                           22730099
227400             AFTER ADVANCING 2 LINES                              22740099
227500     END-IF.                                                      22750099
227600                                                                  22760099
227700*5500-EXIT.                                                       22770099
227800                                                                  22780099
227900******************************************************************22790099
228000* 5600-PRINT-DEPT-TOTALS.                                         22800099
228100* PROCESS:  THIS PARAGRAPH WILL PRINT THE DEPARTMENT TOTALS FROM  22810099
228200*  THE DEPARTMENT TOTALS WORKING STORAGE TABLE.  IT GOES THROUGH  22820099
228300*  TWO "PERFORMS" SO THAT THE TOTALS WILL BE PRINTED IN DEPARTMENT22830099
228400*  ORDER.  THE IF STATMENT WILL CHECK IF THE DEPT IS LESS THAN    22840099
228500* PV-TOTAL-LINE-DPT (THE CURRENT "HIGH" DEPT) AND GREATER THAN    22850099
228600* PV-PREV-DEPT (THE PREVIOUS DEPT PRINTED).  THAT WILL SELECT     22860099
228700* THE NEXT DEPT TO PRINT.                                         22870099
228800******************************************************************22880099
228900 5600-PRINT-DEPT-TOTALS.                                          22890099
229000                                                                  22900099
229100     SET PS-DEPT-PRINT-START          TO TRUE.                    22910099
229200                                                                  22920099
229300     MOVE '999'                       TO PV-TOTAL-LINE-DPT.       22930099
229400     MOVE '   '                       TO PV-PREV-DEPT.            22940099
229500                                                                  22950099
229600     PERFORM UNTIL PS-DEPT-PRINT-END                              22960099
229700                                                                  22970099
229800         SET PS-NO-DEPT-PRINTED       TO TRUE                     22980099
229900                                                                  22990099
230000         PERFORM                                                  23000099
230100         VARYING DT-IDX FROM 1 BY 1                               23010099
230200         UNTIL DT-IDX > DT-MAX-DEPTS                              23020099
230300         OR    DT-DEPT-NBR(DT-IDX) = '   '                        23030099
230400                                                                  23040099
230500             IF  DT-DEPT-NBR(DT-IDX) < PV-TOTAL-LINE-DPT          23050099
230600             AND DT-DEPT-NBR(DT-IDX) > PV-PREV-DEPT               23060099
230700                 MOVE DT-DEPT-NBR (DT-IDX)                        23070099
230800                                      TO PV-TOTAL-LINE-DPT        23080099
230900                 MOVE PV-DEPT-TOTAL-LINE                          23090099
231000                                      TO TL-TOTAL-DESCRIPTION     23100099
231100                                         TLS-TOTAL-DESCRIPTION    23110099
231200                 MOVE DT-UNIT-COST-DEPT-TOTAL(DT-IDX)             23120099
231300                                      TO TL-TOTAL-COST            23130099
231400                                         TLS-TOTAL-COST           23140099
231500                 MOVE DT-RETL-COST-DEPT-TOTAL(DT-IDX)             23150099
231600                                      TO TL-TOTAL-RETAIL          23160099
231700                                         TLS-TOTAL-RETAIL         23170099
231800                 MOVE DT-QTY-DEPT-TOTAL(DT-IDX)                   23180099
231900                                      TO TL-QTY                   23190099
232000                                         TLS-QTY                  23200099
232100                 SET PS-DEPT-PRINTED  TO TRUE                     23210099
232200             END-IF                                               23220099
232300                                                                  23230099
232400         END-PERFORM                                              23240099
232500                                                                  23250099
232600         IF PS-DEPT-PRINTED                                       23260099
232700             IF CC-DETAIL-REPORT                                  23270099
232800                 PERFORM 8100-WRITE-TOTAL-DETAIL-LINE             23280099
232900             END-IF                                               23290099
233000                                                                  23300099
233100             IF CC-SUMMARY-REPORT                                 23310099
233200                 PERFORM 8100-WRITE-TOTAL-SUM-LINE                23320099
233300             END-IF                                               23330099
233400                                                                  23340099
233500             MOVE PV-TOTAL-LINE-DPT   TO PV-PREV-DEPT             23350099
233600             MOVE '999'               TO PV-TOTAL-LINE-DPT        23360099
233700         ELSE                                                     23370099
233800             SET PS-DEPT-PRINT-END    TO TRUE                     23380099
233900         END-IF                                                   23390099
234000                                                                  23400099
234100     END-PERFORM.                                                 23410099
234200                                                                  23420099
234300     INITIALIZE DT-DEPT-TOTAL-TABLE.                              23430099
234400*                                                                 23440099
234500*5600-EXIT.                                                       23450099
234600*                                                                 23460099
234700******************************************************************23470099
234800* 6000-GET-LIST-STATUS.                                           23480099
234900* PROCESS:  THIS PARAGRAPH WILL SET UP THE HOLD LIST AND STATUS   23490099
235000* FIELDS.  THESE FIELDS MUST BE THE REPORT LITERAL BECAUSE THE HOL23500099
235100* FIELDS WILL BE MOVED TO THE DETAIL LINES DURING BREAK LOGIC.    23510099
235200******************************************************************23520099
235300 6000-GET-LIST-STATUS.                                            23530099
235400     EVALUATE TRUE                                                23540099
235500         WHEN PV-TYPE-MARKOUT                                     23550099
235600             MOVE 'MKOUT' TO PV-HOLD-LIST-TYPE                    23560099
235700         WHEN PV-TYPE-RTV                                         23570099
235800             MOVE 'RTV  ' TO PV-HOLD-LIST-TYPE                    23580099
235900         WHEN PV-TYPE-D-AND-D                                     23590099
236000             MOVE 'D & D' TO PV-HOLD-LIST-TYPE                    23600099
236100         WHEN OTHER                                               23610099
236200             MOVE 'ERROR' TO PV-HOLD-LIST-TYPE                    23620099
236300     END-EVALUATE.                                                23630099
236400     EVALUATE TRUE                                                23640099
236500         WHEN PV-STATUS-NEW                                       23650099
236600             MOVE 'NEW  ' TO PV-HOLD-LIST-STATUS                  23660099
236700         WHEN PV-STATUS-OPEN                                      23670099
236800             MOVE 'OPEN ' TO PV-HOLD-LIST-STATUS                  23680099
236900         WHEN PV-STATUS-CLOSED                                    23690099
237000             MOVE 'CLOSE' TO PV-HOLD-LIST-STATUS                  23700099
237100         WHEN PV-STATUS-SHIPPED                                   23710099
237200             MOVE 'SHIP ' TO PV-HOLD-LIST-STATUS                  23720099
237300         WHEN PV-STATUS-PENDING                                   23730099
237400             MOVE 'PEND ' TO PV-HOLD-LIST-STATUS                  23740099
237500         WHEN PV-STATUS-DISPOSED                                  23750099
237600             MOVE 'DISP ' TO PV-HOLD-LIST-STATUS                  23760099
237700         WHEN PV-STATUS-APPROVED                                  23770099
237800             MOVE 'APP  ' TO PV-HOLD-LIST-STATUS                  23780099
237900         WHEN OTHER                                               23790099
238000             MOVE 'ERROR' TO PV-HOLD-LIST-STATUS                  23800099
238100     END-EVALUATE.                                                23810099
238200*6000-EXIT.                                                       23820099
238300*                                                                 23830099
238400 6100-GET-BUYER-NAME.                                             23840099
238500******************************************************************23850099
238600*  CALL MBS SUBROUTINE TO GET BUYER NAME.                        *23860099
238700******************************************************************23870099
238800     INITIALIZE DP003-MBS-SUBROUTINE-FIELDS.                      23880099
238900     SET DP003-BYR-LOOKUP-NAME       TO TRUE.                     23890099
239000     SET DP003-BYR-NAME-FIRST-LAST   TO TRUE.                     23900099
239100     MOVE PC-MBS-SYSTEM-CODE-RV      TO DP003-SYSTEM-CODE.        23910099
239200     MOVE PC-MBS-OP-CO-03            TO DP003-OP-CO-NMBR.         23920099
239300     MOVE SD-SYSTEM-DATE             TO DP003-CURRENT-DATE        23930099
239400                                        DP003-EFF-DATE.           23940099
239500     MOVE PV-HOLD-DEPT-NBR           TO DP003-DPT-INPUT.          23950099
239600*                                                                 23960099
239700     CALL PC-PGM-DPKUT039 USING DP003-MBS-SUBROUTINE-FIELDS.      23970099
239800*                                                                 23980099
239900     EVALUATE TRUE                                                23990099
240000         WHEN DP003-SUCCESSFUL                                    24000099
240100             CONTINUE                                             24010099
240200         WHEN DP003-BYR-NAME-NOT-FOUND                            24020099
240300             MOVE 'BUYER NOT FOUND'  TO  DP003-BYR-NAME           24030099
240400             MOVE '999'              TO  DP003-BYR-NMBR           24040099
240500         WHEN OTHER                                               24050099
240600             DISPLAY '** ABEND **'                                24060099
240700             DISPLAY '** PROGRAM = RVKRP002 **'                   24070099
240800             DISPLAY '** PARAGRAPH = 6100-GET-BUYER-NAME **'      24080099
240900             DISPLAY '** INVALID RETURN CODE FROM DPKUT039 **'    24090099
241000             DISPLAY '** INPUT FIELDS: ' DP003-INPUT-FIELDS       24100099
241100             DISPLAY '**  RETURN DATA: ' DP003-RETURN-DATA        24110099
241200             IF DP003-BYR-NAME-DB2-ERROR                          24120099
241300                 DISPLAY '** SQLCA: ' DP003-SQLCA                 24130099
241400                 DISPLAY '** SQLCODE: ' DP003-SQLCODE             24140099
241500             END-IF                                               24150099
241600             MOVE +4008 TO ABEND-CODE                             24160099
241700             CALL 'ILBOABN0' USING ABEND-CODE                     24170099
241800     END-EVALUATE.                                                24180099
241900*                                                                 24190099
242000******************************************************************24200099
242100* 6300-ACCUM-DEPT-TOTALS                                         *24210099
242200*  THIS PROCEDURE WILL OPEN THE APPROPRIATE CURSOR DEPENDING     *24220099
242300*  UPON THE CONTROL CARD SUPPLIED.                               *24230099
242400******************************************************************24240099
242500 6300-ACCUM-DEPT-TOTALS.                                          24250099
242600                                                                  24260099
242700      IF PV-HOLD-DEPT-NBR = DT-DEPT-NBR(DT-IDX)                   24270099
242800          ADD SO-UNIT-COST-AMT         TO DT-UNIT-COST-DEPT-TOTAL 24280099
242900                                          (DT-IDX)                24290099
243000          ADD SO-RETL-COST-AMT         TO DT-RETL-COST-DEPT-TOTAL 24300099
243100                                          (DT-IDX)                24310099
243200          ADD +1                       TO DT-QTY-DEPT-TOTAL       24320099
243300                                          (DT-IDX)                24330099
243400      ELSE                                                        24340099
243500          SET DT-IDX                   TO +1                      24350099
243600          PERFORM UNTIL                                           24360099
243700              ( DT-DEPT-NBR(DT-IDX) = PV-HOLD-DEPT-NBR )          24370099
243800           OR ( DT-DEPT-NBR(DT-IDX) = '   '            )          24380099
243900           OR ( DT-IDX > DT-MAX-DEPTS                  )          24390099
244000              SET DT-IDX               UP BY +1                   24400099
244100          END-PERFORM                                             24410099
244200                                                                  24420099
244300          IF PV-HOLD-DEPT-NBR = DT-DEPT-NBR(DT-IDX)               24430099
244400             ADD SO-UNIT-COST-AMT      TO DT-UNIT-COST-DEPT-TOTAL 24440099
244500                                          (DT-IDX)                24450099
244600             ADD SO-RETL-COST-AMT      TO DT-RETL-COST-DEPT-TOTAL 24460099
244700                                          (DT-IDX)                24470099
244800             ADD +1                    TO DT-QTY-DEPT-TOTAL       24480099
244900                                          (DT-IDX)                24490099
245000          ELSE                                                    24500099
245100             IF DT-DEPT-NBR(DT-IDX) = '   '                       24510099
245200                 MOVE PV-HOLD-DEPT-NBR TO DT-DEPT-NBR(DT-IDX)     24520099
245300                 MOVE SO-UNIT-COST-AMT TO DT-UNIT-COST-DEPT-TOTAL 24530099
245400                                          (DT-IDX)                24540099
245500                 MOVE SO-RETL-COST-AMT TO DT-RETL-COST-DEPT-TOTAL 24550099
245600                                          (DT-IDX)                24560099
245700                 MOVE +1               TO DT-QTY-DEPT-TOTAL       24570099
245800                                          (DT-IDX)                24580099
245900             ELSE                                                 24590099
246000                IF DT-IDX > DT-MAX-DEPTS                          24600099
246100                   DISPLAY '** ABEND **'                          24610099
246200                   DISPLAY '** PROGRAM = RVKRP002 **'             24620099
246300                   DISPLAY                                        24630099
246400                   '** PARAGRAPH = 6300-ACCUM-DEPT-TOTALS     **' 24640099
246500                   DISPLAY                                        24650099
246600                   '** TABLE OVERFLOW ERROR SEARCHING DEPT TOTALS'24660099
246700                   DISPLAY '** DEPARTMENT NUMBER = '              24670099
246800                           PV-HOLD-DEPT-NBR ' **'                 24680099
246900                   MOVE +4004 TO ABEND-CODE                       24690099
247000                   CALL 'ILBOABN0' USING ABEND-CODE               24700099
247100                END-IF                                            24710099
247200             END-IF                                               24720099
247300          END-IF                                                  24730099
247400      END-IF.                                                     24740099
247500*                                                                 24750099
247600******************************************************************24760099
247700* 7000-OPEN-DRIVER-CURSOR.                                       *24770099
247800*  THIS PROCEDURE WILL OPEN THE APPROPRIATE CURSOR DEPENDING     *24780099
247900*  UPON THE CONTROL CARD SUPPLIED.                               *24790099
248000******************************************************************24800099
248100 7000-OPEN-DRIVER-CURSOR.                                         24810099
248200                                                                  24820099
248300     EVALUATE TRUE                                                24830099
248400         WHEN PS-USE-DEFECT-CURSOR                                24840099
248500             PERFORM 7001-OPEN-DEFECT-CURSOR                      24850099
248600         WHEN PS-USE-LOC-CURSOR                                   24860099
248700             PERFORM 7002-OPEN-LOC-CURSOR                         24870099
248800         WHEN PS-USE-STATUS-CURSOR                                24880099
248900             PERFORM 7003-OPEN-STATUS-CURSOR                      24890099
249000     END-EVALUATE.                                                24900099
249100                                                                  24910099
249200******************************************************************24920099
249300* 7001-OPEN-DEFECT-CURSOR.                                       *24930099
249400*                                                                *24940099
249500******************************************************************24950099
249600                                                                  24960099
249700 7001-OPEN-DEFECT-CURSOR.                                         24970099
249800                                                                  24980099
249900     EXEC SQL                                                     24990099
250000          OPEN DEFECT_CURSOR                                      25000099
250100     END-EXEC.                                                    25010099
250200                                                                  25020099
250300     EVALUATE TRUE                                                25030099
250400         WHEN SQLWARN0 NOT EQUAL SPACE                            25040099
250500         WHEN SQLCODE NOT EQUAL ZERO                              25050099
250600              MOVE '7001-OPEN-DEFECT-CURSOR'                      25060099
250700                               TO  PV-PARAGRAPH-NAME              25070099
250800              MOVE 'OPEN DEFECT_CURSOR'                           25080099
250900                               TO  PV-DB2-OPERATION-ATTEMPTED     25090099
251000              PERFORM 9999-SQL-ABEND                              25100099
251100     END-EVALUATE.                                                25110099
251200                                                                  25120099
251300                                                                  25130099
251400******************************************************************25140099
251500* 7002-OPEN-LOC-CURSOR.                                          *25150099
251600*                                                                *25160099
251700******************************************************************25170099
251800                                                                  25180099
251900 7002-OPEN-LOC-CURSOR.                                            25190099
252000                                                                  25200099
252100     EXEC SQL                                                     25210099
252200          OPEN LOC_CURSOR                                         25220099
252300     END-EXEC.                                                    25230099
252400                                                                  25240099
252500     EVALUATE TRUE                                                25250099
252600         WHEN SQLWARN0 NOT EQUAL SPACE                            25260099
252700         WHEN SQLCODE NOT EQUAL ZERO                              25270099
252800              MOVE '7002-OPEN-LOC-CURSOR'                         25280099
252900                               TO  PV-PARAGRAPH-NAME              25290099
253000              MOVE 'OPEN LOC_CURSOR'                              25300099
253100                               TO  PV-DB2-OPERATION-ATTEMPTED     25310099
253200              PERFORM 9999-SQL-ABEND                              25320099
253300     END-EVALUATE.                                                25330099
253400                                                                  25340099
253500                                                                  25350099
253600******************************************************************25360099
253700* 7003-OPEN-STATUS-CURSOR.                                       *25370099
253800*                                                                *25380099
253900******************************************************************25390099
254000                                                                  25400099
254100 7003-OPEN-STATUS-CURSOR.                                         25410099
254200                                                                  25420099
254300     EXEC SQL                                                     25430099
254400          OPEN STATUS_CURSOR                                      25440099
254500     END-EXEC.                                                    25450099
254600                                                                  25460099
254700     EVALUATE TRUE                                                25470099
254800         WHEN SQLWARN0 NOT EQUAL SPACE                            25480099
254900         WHEN SQLCODE NOT EQUAL ZERO                              25490099
255000              MOVE '7003-OPEN-STATUS-CURSOR'                      25500099
255100                               TO  PV-PARAGRAPH-NAME              25510099
255200              MOVE 'OPEN STATUS_CURSOR'                           25520099
255300                               TO  PV-DB2-OPERATION-ATTEMPTED     25530099
255400              PERFORM 9999-SQL-ABEND                              25540099
255500     END-EVALUATE.                                                25550099
255600*                                                                 25560099
255700******************************************************************25570099
255800* 7100-CLOSE-DRIVER-CURSOR.                                      *25580099
255900*  THIS PROCEDURE WILL CLOSE THE APPROPRIATE CURSOR DEPENDING    *25590099
256000*  UPON THE CONTROL CARD SUPPLIED.                               *25600099
256100******************************************************************25610099
256200 7100-CLOSE-DRIVER-CURSOR.                                        25620099
256300                                                                  25630099
256400     EVALUATE TRUE                                                25640099
256500         WHEN PS-USE-DEFECT-CURSOR                                25650099
256600             PERFORM 7101-CLOSE-DEFECT-CURSOR                     25660099
256700         WHEN PS-USE-LOC-CURSOR                                   25670099
256800             PERFORM 7102-CLOSE-LOC-CURSOR                        25680099
256900         WHEN PS-USE-STATUS-CURSOR                                25690099
257000             PERFORM 7103-CLOSE-STATUS-CURSOR                     25700099
257100     END-EVALUATE.                                                25710099
257200                                                                  25720099
257300******************************************************************25730099
257400* 7101-CLOSE-DEFECT-CURSOR.                                      *25740099
257500*                                                                *25750099
257600******************************************************************25760099
257700 7101-CLOSE-DEFECT-CURSOR.                                        25770099
257800                                                                  25780099
257900     EXEC SQL                                                     25790099
258000         CLOSE DEFECT_CURSOR                                      25800099
258100     END-EXEC.                                                    25810099
258200                                                                  25820099
258300     EVALUATE TRUE                                                25830099
258400         WHEN SQLWARN0 NOT EQUAL SPACE                            25840099
258500         WHEN SQLCODE NOT EQUAL ZERO                              25850099
258600              MOVE '7101-CLOSE-DEFECT-CURSOR'                     25860099
258700                               TO  PV-PARAGRAPH-NAME              25870099
258800              MOVE 'CLOSE DEFECT_CURSOR'                          25880099
258900                               TO  PV-DB2-OPERATION-ATTEMPTED     25890099
259000              PERFORM 9999-SQL-ABEND                              25900099
259100     END-EVALUATE.                                                25910099
259200                                                                  25920099
259300                                                                  25930099
259400******************************************************************25940099
259500* 7102-CLOSE-LOC-CURSOR.                                         *25950099
259600*                                                                *25960099
259700******************************************************************25970099
259800 7102-CLOSE-LOC-CURSOR.                                           25980099
259900                                                                  25990099
260000     EXEC SQL                                                     26000099
260100         CLOSE LOC_CURSOR                                         26010099
260200     END-EXEC.                                                    26020099
260300                                                                  26030099
260400     EVALUATE TRUE                                                26040099
260500         WHEN SQLWARN0 NOT EQUAL SPACE                            26050099
260600         WHEN SQLCODE NOT EQUAL ZERO                              26060099
260700              MOVE '7102-CLOSE-LOC-CURSOR'                        26070099
260800                               TO  PV-PARAGRAPH-NAME              26080099
260900              MOVE 'CLOSE LOC_CURSOR'                             26090099
261000                               TO  PV-DB2-OPERATION-ATTEMPTED     26100099
261100              PERFORM 9999-SQL-ABEND                              26110099
261200     END-EVALUATE.                                                26120099
261300                                                                  26130099
261400                                                                  26140099
261500******************************************************************26150099
261600* 7103-CLOSE-STATUS-CURSOR.                                      *26160099
261700*                                                                *26170099
261800******************************************************************26180099
261900 7103-CLOSE-STATUS-CURSOR.                                        26190099
262000                                                                  26200099
262100     EXEC SQL                                                     26210099
262200         CLOSE STATUS_CURSOR                                      26220099
262300     END-EXEC.                                                    26230099
262400                                                                  26240099
262500     EVALUATE TRUE                                                26250099
262600         WHEN SQLWARN0 NOT EQUAL SPACE                            26260099
262700         WHEN SQLCODE NOT EQUAL ZERO                              26270099
262800              MOVE '7103-CLOSE-STATUS-CURSOR'                     26280099
262900                               TO  PV-PARAGRAPH-NAME              26290099
263000              MOVE 'CLOSE STATUS_CURSOR'                          26300099
263100                               TO  PV-DB2-OPERATION-ATTEMPTED     26310099
263200              PERFORM 9999-SQL-ABEND                              26320099
263300     END-EVALUATE.                                                26330099
263400                                                                  26340099
263500*                                                                 26350099
263600******************************************************************26360099
263700* 7200-FETCH-DRIVER-CURSOR.                                      *26370099
263800*  THIS PROCEDURE WILL FETCH THE APPROPRIATE CURSOR DEPENDING    *26380099
263900*  UPON THE CONTROL CARD SUPPLIED.                               *26390099
264000*  IF CERTAIN STATUS CODES ARE REQUESTED, THIS PROCEDURE WILL    *26400099
264100*  SKIP THROUGHT THE ROWS THAT ARE NOT NEEDED.                   *26410099
264200******************************************************************26420099
264300 7200-FETCH-DRIVER-CURSOR.                                        26430099
264400                                                                  26440099
264500     EVALUATE TRUE                                                26450099
264600         WHEN PS-USE-DEFECT-CURSOR                                26460099
264700             PERFORM 7201-FETCH-DEFECT-CURSOR                     26470099
264800         WHEN PS-USE-LOC-CURSOR                                   26480099
264900             PERFORM 7202-FETCH-LOC-CURSOR                        26490099
265000         WHEN PS-USE-STATUS-CURSOR                                26500099
265100             PERFORM 7203-FETCH-STATUS-CURSOR                     26510099
265200     END-EVALUATE.                                                26520099
265300                                                                  26530099
265400* IF THE CONTROL CARD STATUS IS PENDING OR APPROVED (MARKOUTS)    26540099
265500* THEN CHECK THE DETAIL STATUS CODE, AND SKIP RECORDS ACCORDINGLY 26550099
265600                                                                  26560099
265700                                                                  26570099
265800**** SKIPPING RECORDS ONLY APPLIES TO MARKOUTS,  RTV & D&D ARE    26580099
265900****     PROCESSED EVEN IF THEY HAVE AN APPROVED STATUS           26590099
266000****     APPROVED STATUS WAS MADE A VALID STATUS FOR THESE        26600099
266100****     TYPES AS PART OF THE AP INTERFACE SO THAT WE DON'T       26610099
266200****     PASS DEBITS THAT HAVE ALREADY BEEN SENT TO AP            26620099
266300     IF CC-LIST-TYPE-MARKOUT                                      26630099
266400         IF CC-LIST-STATUS-PENDING OR CC-LIST-STATUS-APPROVED     26640099
266500                                                                  26650099
266600             PERFORM UNTIL ( (PS-END-OF-DRIVER-CURSOR) OR         26660099
266700                (DFMEIT-MKOUT-ORD-STAT-CDE = CC-LIST-STATUS-CD) ) 26670099
266800                                                                  26680099
266900                 EVALUATE TRUE                                    26690099
267000                     WHEN PS-USE-DEFECT-CURSOR                    26700099
267100                         PERFORM 7201-FETCH-DEFECT-CURSOR         26710099
267200                     WHEN PS-USE-LOC-CURSOR                       26720099
267300                         PERFORM 7202-FETCH-LOC-CURSOR            26730099
267400                     WHEN PS-USE-STATUS-CURSOR                    26740099
267500                         PERFORM 7203-FETCH-STATUS-CURSOR         26750099
267600                 END-EVALUATE                                     26760099
267700                                                                  26770099
267800             END-PERFORM                                          26780099
267900         END-IF                                                   26790099
268000     END-IF.                                                      26800099
268100                                                                  26810099
268200******************************************************************26820099
268300* 7201-FETCH-DEFECT-CURSOR.                                      *26830099
268400*                                                                *26840099
268500******************************************************************26850099
268600 7201-FETCH-DEFECT-CURSOR.                                        26860099
268700                                                                  26870099
268800     EXEC SQL                                                     26880099
268900          FETCH DEFECT_CURSOR                                     26890099
269000          INTO                                                    26900099
269100                :DFMEIT-MDSE-DEPT-NBR                             26910099
269200            ,   :DFMEIT-MDSE-CLASS-NBR                            26920099
269300            ,   :DFCTOR-VENDOR-DUNS-NBR                           26930099
269400            ,   :DFCTOR-VEND-NAME                                 26940099
269500            ,   :DFCTOR-DFCT-ORD-ID                               26950099
269600            ,   :DFCTOR-ORD-DTE                                   26960099
269700            ,   :DFMEIT-UNIT-COST-AMT                             26970099
269800            ,   :DFMEIT-RTL-COST-AMT                              26980099
269900            ,   :DFCTOR-LOC-ID                                    26990099
270000            ,   :DFCTOR-DFCT-ORD-ID-CDE                           27000099
270100            ,   :DFCTOR-DFCT-ORD-STAT-CDE                         27010099
270200            ,   :DFCTOR-STATUS-CHG-DTE                            27020099
270300            ,   :DFMEIT-MKOUT-ORD-STAT-CDE                        27030099
270400            ,   :DFMEIT-DFCT-ITEM-NBR                             27040099
270500     END-EXEC.                                                    27050099
270600                                                                  27060099
270700     EVALUATE TRUE                                                27070099
270800         WHEN SQLCODE = ZERO                                      27080099
270900              CONTINUE                                            27090099
271000                                                                  27100099
271100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          27110099
271200              SET PS-END-OF-DRIVER-CURSOR                         27120099
271300                               TO  TRUE                           27130099
271400                                                                  27140099
271500         WHEN SQLWARN0 NOT EQUAL SPACE                            27150099
271600         WHEN SQLCODE NOT EQUAL ZERO                              27160099
271700              MOVE '7201-FETCH-DEFECT-CURSOR'                     27170099
271800                               TO  PV-PARAGRAPH-NAME              27180099
271900              MOVE 'FETCH DEFECT_CURSOR'                          27190099
272000                               TO  PV-DB2-OPERATION-ATTEMPTED     27200099
272100              PERFORM 9999-SQL-ABEND                              27210099
272200     END-EVALUATE.                                                27220099
272300                                                                  27230099
272400******************************************************************27240099
272500* 7202-FETCH-LOC-CURSOR.                                         *27250099
272600*                                                                *27260099
272700******************************************************************27270099
272800 7202-FETCH-LOC-CURSOR.                                           27280099
272900                                                                  27290099
273000     EXEC SQL                                                     27300099
273100          FETCH LOC_CURSOR                                        27310099
273200          INTO                                                    27320099
273300                :DFMEIT-MDSE-DEPT-NBR                             27330099
273400            ,   :DFMEIT-MDSE-CLASS-NBR                            27340099
273500            ,   :DFCTOR-VENDOR-DUNS-NBR                           27350099
273600            ,   :DFCTOR-VEND-NAME                                 27360099
273700            ,   :DFCTOR-DFCT-ORD-ID                               27370099
273800            ,   :DFCTOR-ORD-DTE                                   27380099
273900            ,   :DFMEIT-UNIT-COST-AMT                             27390099
274000            ,   :DFMEIT-RTL-COST-AMT                              27400099
274100            ,   :DFCTOR-LOC-ID                                    27410099
274200            ,   :DFCTOR-DFCT-ORD-ID-CDE                           27420099
274300            ,   :DFCTOR-DFCT-ORD-STAT-CDE                         27430099
274400            ,   :DFCTOR-STATUS-CHG-DTE                            27440099
274500            ,   :DFMEIT-MKOUT-ORD-STAT-CDE                        27450099
274600            ,   :DFMEIT-DFCT-ITEM-NBR                             27460099
274700     END-EXEC.                                                    27470099
274800                                                                  27480099
274900     EVALUATE TRUE                                                27490099
275000         WHEN SQLCODE = ZERO                                      27500099
275100              CONTINUE                                            27510099
275200                                                                  27520099
275300         WHEN SQLCODE = PC-ROW-NOT-FOUND                          27530099
275400              SET PS-END-OF-DRIVER-CURSOR                         27540099
275500                               TO  TRUE                           27550099
275600                                                                  27560099
275700         WHEN SQLWARN0 NOT EQUAL SPACE                            27570099
275800         WHEN SQLCODE NOT EQUAL ZERO                              27580099
275900              MOVE '7202-FETCH-LOC-CURSOR'                        27590099
276000                               TO  PV-PARAGRAPH-NAME              27600099
276100              MOVE 'FETCH LOC_CURSOR'                             27610099
276200                               TO  PV-DB2-OPERATION-ATTEMPTED     27620099
276300              PERFORM 9999-SQL-ABEND                              27630099
276400     END-EVALUATE.                                                27640099
276500                                                                  27650099
276600                                                                  27660099
276700******************************************************************27670099
276800* 7203-FETCH-STATUS-CURSOR.                                      *27680099
276900*                                                                *27690099
277000******************************************************************27700099
277100 7203-FETCH-STATUS-CURSOR.                                        27710099
277200                                                                  27720099
277300     EXEC SQL                                                     27730099
277400          FETCH STATUS_CURSOR                                     27740099
277500          INTO                                                    27750099
277600                :DFMEIT-MDSE-DEPT-NBR                             27760099
277700            ,   :DFMEIT-MDSE-CLASS-NBR                            27770099
277800            ,   :DFCTOR-VENDOR-DUNS-NBR                           27780099
277900            ,   :DFCTOR-VEND-NAME                                 27790099
278000            ,   :DFCTOR-DFCT-ORD-ID                               27800099
278100            ,   :DFCTOR-ORD-DTE                                   27810099
278200            ,   :DFMEIT-UNIT-COST-AMT                             27820099
278300            ,   :DFMEIT-RTL-COST-AMT                              27830099
278400            ,   :DFCTOR-LOC-ID                                    27840099
278500            ,   :DFCTOR-DFCT-ORD-ID-CDE                           27850099
278600            ,   :DFCTOR-DFCT-ORD-STAT-CDE                         27860099
278700            ,   :DFCTOR-STATUS-CHG-DTE                            27870099
278800            ,   :DFMEIT-MKOUT-ORD-STAT-CDE                        27880099
278900            ,   :DFMEIT-DFCT-ITEM-NBR                             27890099
279000     END-EXEC.                                                    27900099
279100                                                                  27910099
279200     EVALUATE TRUE                                                27920099
279300         WHEN SQLCODE = ZERO                                      27930099
279400              CONTINUE                                            27940099
279500                                                                  27950099
279600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          27960099
279700              SET PS-END-OF-DRIVER-CURSOR                         27970099
279800                               TO  TRUE                           27980099
279900                                                                  27990099
280000         WHEN SQLWARN0 NOT EQUAL SPACE                            28000099
280100         WHEN SQLCODE NOT EQUAL ZERO                              28010099
280200              MOVE '7203-FETCH-STATUS-CURSOR'                     28020099
280300                               TO  PV-PARAGRAPH-NAME              28030099
280400              MOVE 'FETCH STATUS_CURSOR'                          28040099
280500                               TO  PV-DB2-OPERATION-ATTEMPTED     28050099
280600              PERFORM 9999-SQL-ABEND                              28060099
280700     END-EVALUATE.                                                28070099
280800                                                                  28080099
280900 EJECT                                                            28090099
281000*7000-EXIT.                                                       28100099
281100                                                                  28110099
281200******************************************************************28120099
281300* 7300-SELECT-SKU-INFO.                                          *28130099
281400*                                                                *28140099
281500******************************************************************28150099
281600 7300-SELECT-SKU-INFO.                                            28160099
281700                                                                  28170099
281800     MOVE DFMEIT-DFCT-ITEM-NBR TO XLT00003-ITM-NBR                28180099
281900     EXEC SQL                                                     28190099
282000         SELECT  B.ENT_ID                                         28200099
282100            ,    B.ENT_NAME_DESC                                  28210099
282200            ,    C.DUN_NBR                                        28220099
282300            ,    E.DEPT_NBR                                       28230099
282400            ,    D.SKU_NBR                                        28240099
282500            ,    D.SKU_DESC                                       28250099
282600            ,    D.SIZE_DESC                                      28260099
282700            ,    D.SHRT_CLOR_DESC                                 28270099
282800            ,    E.VS_NBR                                         28280099
282900           INTO  :ENTNME-ENT-ID                                   28290099
283000            ,    :ENTNME-ENT-NAME-DESC                            28300099
283100            ,    :EXTENT-DUN-NBR                                  28310099
283200            ,    :XLT00004-DEPT-NBR                               28320099
283300            ,    :XLT00003-SKU-NBR                                28330099
283400            ,    :XLT00003-SKU-DESC                               28340099
283500            ,    :XLT00003-SIZE-DESC                              28350099
283600            ,    :XLT00003-SHRT-CLOR-DESC                         28360099
283700            ,    :XLT00004-VS-NBR                                 28370099
283800           FROM  TVNDDPT A                                        28380099
283900            ,    TENTNME B                                        28390099
284000            ,    TEXTENT C                                        28400099
284100            ,    XLT_SKU D                                        28410099
284200            ,    XLT_VND_STYL E                                   28420099
284300          WHERE (D.ITM_NBR      = :XLT00003-ITM-NBR               28430099
284400            AND  A.DEPT_NBR     = SUBSTR(DIGITS(E.DEPT_NBR),2,3)  28440099
284500            AND  A.ENT_ID       =  E.ENT_ID                       28450099
284600            AND  A.ENT_ID       =  B.ENT_ID                       28460099
284700            AND  A.ENT_ID       =  C.ENT_ID                       28470099
284800            AND  D.STYL_ID      =  E.STYL_ID                      28480099
284900            AND  B.TYPE_CDE     =  '01'  )                        28490099
285000                                                                  28500099
285100     END-EXEC.                                                    28510099
285200                                                                  28520099
285300     EVALUATE TRUE                                                28530099
285400         WHEN SQLCODE = ZERO                                      28540099
285500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          28550099
285600              CONTINUE                                            28560099
285700                                                                  28570099
285800         WHEN SQLWARN0 NOT EQUAL SPACE                            28580099
285900         WHEN SQLCODE NOT EQUAL ZERO                              28590099
286000              MOVE '7300-SELECT-SKU-INFO'                         28600099
286100                               TO  PV-PARAGRAPH-NAME              28610099
286200              MOVE 'SELECT OF XLT_SKU BY ITEM NUMBER'             28620099
286300                               TO  PV-DB2-OPERATION-ATTEMPTED     28630099
286400              PERFORM 9999-SQL-ABEND                              28640099
286500     END-EVALUATE.                                                28650099
286600                                                                  28660099
286700 EJECT                                                            28670099
286800*7300-EXIT.                                                       28680099
286900                                                                  28690099
287000 7400-RETURN-SORT-WORK-FILE.                                      28700099
287100******************************************************************28710099
287200*  RETURNS THE SORT WORK FILE INTO THE EXCEPTION RECORD LAYOUT.   28720099
287300******************************************************************28730099
287400     RETURN SORT-WORK-FILE                                        28740099
287500         INTO SORT-OUT-RECORD                                     28750099
287600             AT END                                               28760099
287700                 SET PS-END-OF-SORT-WORK-FILE TO TRUE.            28770099
287800*7400-EXIT.                                                       28780099
287900*                                                                 28790099
288000******************************************************************28800099
288100* 8000-WRITE-DETAIL-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   28810099
288200* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT28820099
288300* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  28830099
288400******************************************************************28840099
288500 8000-WRITE-DETAIL-LINE.                                          28850099
288600                                                                  28860099
288700     IF CC-DETAIL-REPORT                                          28870099
288800         ADD +1 TO PV-DETAIL-LINE-COUNT                           28880099
288900                                                                  28890099
289000         IF PV-DETAIL-LINE-COUNT >= PC-MAX-REPORT-LINES           28900099
289100             PERFORM 8300-WRITE-DETAIL-PAGE-HEAD                  28910099
289200             PERFORM 8400-WRITE-DETAIL-COL-HEAD                   28920099
289300             SET PS-NEW-LINE           TO TRUE                    28930099
289400         END-IF                                                   28940099
289500                                                                  28950099
289600         IF PS-NEW-LINE                                           28960099
289700             PERFORM 4100-SETUP-NEW-DETAIL-LINE                   28970099
289800         END-IF                                                   28980099
289900                                                                  28990099
290000         PERFORM 4000-SET-UP-DETAIL-LINE                          29000099
290100                                                                  29010099
290200         WRITE DI-DEFECT-ITM-DETAIL-LINE                          29020099
290300             FROM DL-DETAIL-LINE                                  29030099
290400             AFTER ADVANCING 1 LINES                              29040099
290500     END-IF.                                                      29050099
290600                                                                  29060099
290700 8000-WRITE-SUM-LINE.                                             29070099
290800                                                                  29080099
290900     IF CC-SUMMARY-REPORT                                         29090099
291000         ADD +1 TO PV-SUM-LINE-COUNT                              29100099
291100                                                                  29110099
291200         IF PV-SUM-LINE-COUNT >= PC-MAX-REPORT-LINES              29120099
291300             PERFORM 8300-WRITE-SUM-PAGE-HEAD                     29130099
291400             PERFORM 8400-WRITE-SUM-COL-HEAD                      29140099
291500         END-IF                                                   29150099
291600                                                                  29160099
291700         WRITE DI-DEFECT-ITM-SUM-LINE                             29170099
291800             FROM DLS-DETAIL-LINE-SUM                             29180099
291900             AFTER ADVANCING 1 LINES                              29190099
292000     END-IF.                                                      29200099
292100                                                                  29210099
292200*8000-EXIT.                                                       29220099
292300                                                                  29230099
292400******************************************************************29240099
292500* 8100-WRITE-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES    *29250099
292600******************************************************************29260099
292700 8100-WRITE-TOTAL-DETAIL-LINE.                                    29270099
292800                                                                  29280099
292900     IF ( PV-DETAIL-LINE-COUNT + 2 ) > PC-MAX-REPORT-LINES        29290099
293000         PERFORM 8300-WRITE-DETAIL-PAGE-HEAD                      29300099
293100         PERFORM 8400-WRITE-DETAIL-COL-HEAD                       29310099
293200         SET PS-NEW-LINE           TO TRUE                        29320099
293300     END-IF.                                                      29330099
293400                                                                  29340099
293500     WRITE DI-DEFECT-ITM-DETAIL-LINE                              29350099
293600         FROM TL-TOTAL-LINE                                       29360099
293700         AFTER ADVANCING 1 LINES.                                 29370099
293800                                                                  29380099
293900     ADD +1                        TO PV-DETAIL-LINE-COUNT.       29390099
294000                                                                  29400099
294100     PERFORM 8200-WRITE-BLANK-DETAIL-LINE.                        29410099
294200                                                                  29420099
294300                                                                  29430099
294400 8100-WRITE-TOTAL-SUM-LINE.                                       29440099
294500                                                                  29450099
294600     IF ( PV-SUM-LINE-COUNT + 2 ) > PC-MAX-REPORT-LINES           29460099
294700         PERFORM 8300-WRITE-SUM-PAGE-HEAD                         29470099
294800         PERFORM 8400-WRITE-SUM-COL-HEAD                          29480099
294900     END-IF.                                                      29490099
295000                                                                  29500099
295100     WRITE DI-DEFECT-ITM-SUM-LINE                                 29510099
295200         FROM TL-TOTAL-LINE-SUM                                   29520099
295300         AFTER ADVANCING 1 LINES.                                 29530099
295400                                                                  29540099
295500     ADD +1                        TO PV-SUM-LINE-COUNT.          29550099
295600                                                                  29560099
295700     PERFORM 8200-WRITE-BLANK-SUM-LINE.                           29570099
295800                                                                  29580099
295900                                                                  29590099
296000*8100-EXIT.                                                       29600099
296100                                                                  29610099
296200******************************************************************29620099
296300* 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.     *29630099
296400******************************************************************29640099
296500 8200-WRITE-BLANK-DETAIL-LINE.                                    29650099
296600                                                                  29660099
296700     WRITE DI-DEFECT-ITM-DETAIL-LINE                              29670099
296800         FROM BLANK-LINE                                          29680099
296900         AFTER ADVANCING 1 LINES.                                 29690099
297000                                                                  29700099
297100     ADD +1                        TO PV-DETAIL-LINE-COUNT.       29710099
297200                                                                  29720099
297300 8200-WRITE-BLANK-SUM-LINE.                                       29730099
297400                                                                  29740099
297500     WRITE DI-DEFECT-ITM-SUM-LINE                                 29750099
297600         FROM BLANK-LINE                                          29760099
297700         AFTER ADVANCING 1 LINES.                                 29770099
297800                                                                  29780099
297900     ADD +1                        TO PV-SUM-LINE-COUNT.          29790099
298000                                                                  29800099
298100                                                                  29810099
298200*8100-EXIT.                                                       29820099
298300******************************************************************29830099
298400* 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR29840099
298500* THE DEFECTIVE ITEM DETAIL REPORT.                               29850099
298600******************************************************************29860099
298700 8300-WRITE-DETAIL-PAGE-HEAD.                                     29870099
298800                                                                  29880099
298900     ADD 1                     TO PV-DETAIL-PAGE-COUNT.           29890099
299000     MOVE +3                   TO PV-DETAIL-LINE-COUNT.           29900099
299100     MOVE 1                    TO DP132O-REPORT-NUMBER.           29910099
299200     MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER.             29920099
299300                                                                  29930099
299400     WRITE DI-DEFECT-ITM-DETAIL-LINE                              29940099
299500         FROM DP132O-STANDRD-HEADER-132-COLS                      29950099
299600         AFTER ADVANCING PAGE.                                    29960099
299700                                                                  29970099
299800     WRITE DI-DEFECT-ITM-DETAIL-LINE                              29980099
299900         FROM PH2-PAGE-HEADING-2                                  29990099
300000         AFTER ADVANCING 1 LINES.                                 30000099
300100                                                                  30010099
300200     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30020099
300300         FROM PH3-PAGE-HEADING-3                                  30030099
300400         AFTER ADVANCING 1 LINES.                                 30040099
300500                                                                  30050099
300600 8300-WRITE-SUM-PAGE-HEAD.                                        30060099
300700                                                                  30070099
300800     ADD 1                     TO PV-SUM-PAGE-COUNT.              30080099
300900     IF CC-SUMMARY-REPORT                                         30090099
301000         MOVE 2                TO DP132O-REPORT-NUMBER            30100099
301100      ELSE                                                        30110099
301200***    THE REPORT NUMBER 3 IS USED WHEN PRINTING JUST THE         30120099
301300***    TOTAL PAGE FROM THE ON-LINE SCREEN.                        30130099
301400         MOVE 3                TO DP132O-REPORT-NUMBER            30140099
301500     END-IF.                                                      30150099
301600     MOVE +3                   TO PV-SUM-LINE-COUNT.              30160099
301700     MOVE PV-SUM-PAGE-COUNT    TO DP132O-PAGE-NUMBER.             30170099
301800                                                                  30180099
301900     WRITE DI-DEFECT-ITM-SUM-LINE                                 30190099
302000         FROM DP132O-STANDRD-HEADER-132-COLS                      30200099
302100         AFTER ADVANCING PAGE.                                    30210099
302200                                                                  30220099
302300     IF CC-SUMMARY-REPORT                                         30230099
302400         WRITE DI-DEFECT-ITM-SUM-LINE                             30240099
302500             FROM PH2-PAGE-HEADING-2-SUM                          30250099
302600         AFTER ADVANCING 1 LINES                                  30260099
302700     END-IF.                                                      30270099
302800                                                                  30280099
302900     IF CC-TOTAL-REPORT                                           30290099
303000         WRITE DI-DEFECT-ITM-SUM-LINE                             30300099
303100             FROM PH2-PAGE-HEADING-2-TOT                          30310099
303200         AFTER ADVANCING 1 LINES                                  30320099
303300     END-IF.                                                      30330099
303400                                                                  30340099
303500     WRITE DI-DEFECT-ITM-SUM-LINE                                 30350099
303600         FROM PH3-PAGE-HEADING-3                                  30360099
303700         AFTER ADVANCING 1 LINES.                                 30370099
303800*8300-EXIT.                                                       30380099
303900                                                                  30390099
304000******************************************************************30400099
304100* 8400-WRITE-DETAIL-COL-HEAD - WRITE THE COLUMN HEADINGS FOR     *30410099
304200* THE DEFECTIVE ITEM REPORT.                                     *30420099
304300******************************************************************30430099
304400 8400-WRITE-DETAIL-COL-HEAD.                                      30440099
304500                                                                  30450099
304600     MOVE PV-HOLD-BUYER-NAME TO  PH5-BUYER-NAME.                  30460099
304700     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30470099
304800         FROM PH5-PAGE-HEADING-5                                  30480099
304900         AFTER ADVANCING 1 LINES.                                 30490099
305000                                                                  30500099
305100     MOVE PV-HOLD-BUYER-NBR  TO  PH6-BUYER-NUMBER.                30510099
305200     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30520099
305300         FROM PH6-PAGE-HEADING-6                                  30530099
305400         AFTER ADVANCING 1 LINES.                                 30540099
305500                                                                  30550099
305600     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30560099
305700         FROM DH1-DETAIL-HEADING-1                                30570099
305800         AFTER ADVANCING 2 LINES.                                 30580099
305900                                                                  30590099
306000     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30600099
306100         FROM DH2-DETAIL-HEADING-2                                30610099
306200         AFTER ADVANCING 1 LINES.                                 30620099
306300                                                                  30630099
306400     WRITE DI-DEFECT-ITM-DETAIL-LINE                              30640099
306500         FROM DH3-DETAIL-HEADING-3                                30650099
306600         AFTER ADVANCING 0 LINES.                                 30660099
306700                                                                  30670099
306800     ADD +6 TO PV-DETAIL-LINE-COUNT.                              30680099
306900******************************************************************30690099
307000 8400-WRITE-SUM-COL-HEAD.                                         30700099
307100                                                                  30710099
307200     MOVE PV-HOLD-BUYER-NAME TO  PH5-BUYER-NAME.                  30720099
307300     WRITE DI-DEFECT-ITM-SUM-LINE                                 30730099
307400         FROM PH5-PAGE-HEADING-5                                  30740099
307500         AFTER ADVANCING 1 LINES.                                 30750099
307600                                                                  30760099
307700     MOVE PV-HOLD-BUYER-NBR  TO  PH6-BUYER-NUMBER.                30770099
307800     WRITE DI-DEFECT-ITM-SUM-LINE                                 30780099
307900         FROM PH6-PAGE-HEADING-6                                  30790099
308000         AFTER ADVANCING 1 LINES.                                 30800099
308100                                                                  30810099
308200     WRITE DI-DEFECT-ITM-SUM-LINE                                 30820099
308300         FROM DH1-DETAIL-HEADING-1-SUM                            30830099
308400         AFTER ADVANCING 2 LINES.                                 30840099
308500                                                                  30850099
308600     WRITE DI-DEFECT-ITM-SUM-LINE                                 30860099
308700         FROM DH2-DETAIL-HEADING-2-SUM                            30870099
308800         AFTER ADVANCING 1 LINES.                                 30880099
308900                                                                  30890099
309000     WRITE DI-DEFECT-ITM-SUM-LINE                                 30900099
309100         FROM DH3-DETAIL-HEADING-3-SUM                            30910099
309200         AFTER ADVANCING 0 LINES.                                 30920099
309300                                                                  30930099
309400     ADD +6      TO PV-SUM-LINE-COUNT.                            30940099
309500*8400-EXIT.                                                       30950099
309600                                                                  30960099
309700******************************************************************30970099
309800* 8500-WRITE-LAST-PAGE  - WRITE THE LAST PAGE OF THE REPORT      *30980099
309900* DISPLAYING ALL THE INFORMATION FROM THE SUPPLIED CONTROL CARD. *30990099
310000******************************************************************31000099
310100 8500-WRITE-LAST-PAGE.                                            31010099
310200                                                                  31020099
310300     IF CC-DETAIL-REPORT                                          31030099
310400         WRITE DI-DEFECT-ITM-DETAIL-LINE                          31040099
310500             FROM CD-CC-DISPLAY-LINE1                             31050099
310600             AFTER ADVANCING 4 LINES                              31060099
310700     END-IF.                                                      31070099
310800                                                                  31080099
310900     IF CC-SUMMARY-REPORT                                         31090099
311000         WRITE DI-DEFECT-ITM-SUM-LINE                             31100099
311100             FROM CD-CC-DISPLAY-LINE1                             31110099
311200             AFTER ADVANCING 4 LINES                              31120099
311300     END-IF.                                                      31130099
311400                                                                  31140099
311500     IF CC-TOTAL-REPORT                                           31150099
311600         WRITE DI-DEFECT-ITM-SUM-LINE                             31160099
311700             FROM CD-CC-DISPLAY-LINE1                             31170099
311800             AFTER ADVANCING 4 LINES                              31180099
311900     END-IF.                                                      31190099
312000                                                                  31200099
312100***************************************************************** 31210099
312200**    DISPLAY CONTENTS OF OPERATING UNIT CONTROL CARD          ** 31220099
312300**    OPERATING UNIT CONTROL CARD IS CHANGED TO RTV LOCATION.  ** 31230099
312400***************************************************************** 31240099
312500     MOVE '                       RTV LOCATION'                   31250099
312600                                 TO CD-CONTROL-FIELD-DESC.        31260099
312700     MOVE CC-OPER-UNT-ID         TO CD-CONTROL-FIELD-VALUE.       31270099
312800                                                                  31280099
312900     IF CC-DETAIL-REPORT                                          31290099
313000         WRITE DI-DEFECT-ITM-DETAIL-LINE                          31300099
313100             FROM CD-CC-DISPLAY-LINE                              31310099
313200             AFTER ADVANCING 2 LINES                              31320099
313300     END-IF.                                                      31330099
313400                                                                  31340099
313500     IF CC-SUMMARY-REPORT                                         31350099
313600         WRITE DI-DEFECT-ITM-SUM-LINE                             31360099
313700             FROM CD-CC-DISPLAY-LINE                              31370099
313800             AFTER ADVANCING 2 LINES                              31380099
313900     END-IF.                                                      31390099
314000                                                                  31400099
314100     IF CC-TOTAL-REPORT                                           31410099
314200         WRITE DI-DEFECT-ITM-SUM-LINE                             31420099
314300             FROM CD-CC-DISPLAY-LINE                              31430099
314400             AFTER ADVANCING 2 LINES                              31440099
314500     END-IF.                                                      31450099
314600                                                                  31460099
314700                                                                  31470099
314800***************************************************************** 31480099
314900**    DISPLAY CONTENTS OF LISTING TYPE CODE CONTROL CARD       ** 31490099
315000***************************************************************** 31500099
315100                                                                  31510099
315200     MOVE '           LISTING TYPE/STATUS CODE'                   31520099
315300                                 TO CD-CONTROL-FIELD-DESC.        31530099
315400     EVALUATE TRUE                                                31540099
315500         WHEN CC-LIST-TYPE-MARKOUT                                31550099
315600             MOVE 'MARKOUT LISTINGS    '                          31560099
315700                                 TO CD-CONTROL-FIELD-VALUE        31570099
315800         WHEN CC-LIST-TYPE-RTV                                    31580099
315900             MOVE 'RETURN-TO-VENDOR LISTINGS          '           31590099
316000                                 TO CD-CONTROL-FIELD-VALUE        31600099
316100         WHEN CC-LIST-TYPE-D-AND-D                                31610099
316200             MOVE 'DEBIT AND DISPOSE LISTINGS         '           31620099
316300                                 TO CD-CONTROL-FIELD-VALUE        31630099
316400         WHEN CC-LIST-TYPE-ALL                                    31640099
316500             MOVE 'ALL LISTINGS (MARKOUT / RTV / D&D) '           31650099
316600                                 TO CD-CONTROL-FIELD-VALUE        31660099
316700         WHEN OTHER                                               31670099
316800             MOVE 'NOT A VALID TYPE CODE  '                       31680099
316900                                 TO CD-CONTROL-FIELD-VALUE        31690099
317000     END-EVALUATE.                                                31700099
317100                                                                  31710099
317200     IF CC-DETAIL-REPORT                                          31720099
317300         WRITE DI-DEFECT-ITM-DETAIL-LINE                          31730099
317400             FROM CD-CC-DISPLAY-LINE                              31740099
317500             AFTER ADVANCING 2 LINES                              31750099
317600     END-IF.                                                      31760099
317700                                                                  31770099
317800     IF CC-SUMMARY-REPORT                                         31780099
317900         WRITE DI-DEFECT-ITM-SUM-LINE                             31790099
318000             FROM CD-CC-DISPLAY-LINE                              31800099
318100             AFTER ADVANCING 2 LINES                              31810099
318200     END-IF.                                                      31820099
318300                                                                  31830099
318400     IF CC-TOTAL-REPORT                                           31840099
318500         WRITE DI-DEFECT-ITM-SUM-LINE                             31850099
318600             FROM CD-CC-DISPLAY-LINE                              31860099
318700             AFTER ADVANCING 2 LINES                              31870099
318800     END-IF.                                                      31880099
318900                                                                  31890099
319000     MOVE '                                   '                   31900099
319100                                 TO CD-CONTROL-FIELD-DESC.        31910099
319200     EVALUATE TRUE                                                31920099
319300         WHEN CC-LIST-STATUS-NEW                                  31930099
319400             MOVE 'WITH NEW STATUS     '                          31940099
319500                                 TO CD-CONTROL-FIELD-VALUE        31950099
319600         WHEN CC-LIST-STATUS-OPEN                                 31960099
319700             MOVE 'WITH OPEN STATUS    '                          31970099
319800                                 TO CD-CONTROL-FIELD-VALUE        31980099
319900         WHEN CC-LIST-STATUS-CLOSED                               31990099
320000             MOVE 'WITH CLOSED STATUS  '                          32000099
320100                                 TO CD-CONTROL-FIELD-VALUE        32010099
320200         WHEN CC-LIST-STATUS-SHIPPED                              32020099
320300             MOVE 'WITH SHIPPED STATUS '                          32030099
320400                                 TO CD-CONTROL-FIELD-VALUE        32040099
320500         WHEN CC-LIST-STATUS-APPROVED                             32050099
320600             MOVE 'WITH APPROVED STATUS'                          32060099
320700                                 TO CD-CONTROL-FIELD-VALUE        32070099
320800         WHEN CC-LIST-STATUS-PENDING                              32080099
320900             MOVE 'WITH PENDING STATUS'                           32090099
321000                                 TO CD-CONTROL-FIELD-VALUE        32100099
321100         WHEN CC-LIST-STATUS-DISPOSED                             32110099
321200             MOVE 'WITH DISPOSED STATUS'                          32120099
321300                                 TO CD-CONTROL-FIELD-VALUE        32130099
321400         WHEN CC-LIST-STATUS-ALL                                  32140099
321500             MOVE 'WITH ALL POSSIBLE STATUS CODES    '            32150099
321600                                 TO CD-CONTROL-FIELD-VALUE        32160099
321700         WHEN OTHER                                               32170099
321800             MOVE 'NOT A VALID STATUS CODE'                       32180099
321900                                 TO CD-CONTROL-FIELD-VALUE        32190099
322000     END-EVALUATE.                                                32200099
322100                                                                  32210099
322200     IF CC-DETAIL-REPORT                                          32220099
322300         WRITE DI-DEFECT-ITM-DETAIL-LINE                          32230099
322400             FROM CD-CC-DISPLAY-LINE                              32240099
322500             AFTER ADVANCING 1 LINES                              32250099
322600     END-IF.                                                      32260099
322700                                                                  32270099
322800     IF CC-SUMMARY-REPORT                                         32280099
322900         WRITE DI-DEFECT-ITM-SUM-LINE                             32290099
323000             FROM CD-CC-DISPLAY-LINE                              32300099
323100             AFTER ADVANCING 1 LINES                              32310099
323200     END-IF.                                                      32320099
323300                                                                  32330099
323400     IF CC-TOTAL-REPORT                                           32340099
323500         WRITE DI-DEFECT-ITM-SUM-LINE                             32350099
323600             FROM CD-CC-DISPLAY-LINE                              32360099
323700             AFTER ADVANCING 1 LINES                              32370099
323800     END-IF.                                                      32380099
323900                                                                  32390099
324000***************************************************************** 32400099
324100**    DISPLAY CONTENTS OF SPECIFIC STORAGE LOCATION CNTL CARD **  32410099
324200***************************************************************** 32420099
324300                                                                  32430099
324400     MOVE '          SPECIFIC STORAGE LOCATION'                   32440099
324500                                 TO CD-CONTROL-FIELD-DESC.        32450099
324600     IF CC-ALL-STORAGE-LOC-ID                                     32460099
324700         MOVE 'ALL STORAGE LOCATIONS'                             32470099
324800                                 TO CD-CONTROL-FIELD-VALUE        32480099
324900     ELSE                                                         32490099
325000         MOVE CC-STORAGE-LOC-ID  TO CD-CONTROL-FIELD-VALUE        32500099
325100     END-IF.                                                      32510099
325200                                                                  32520099
325300     IF CC-DETAIL-REPORT                                          32530099
325400         WRITE DI-DEFECT-ITM-DETAIL-LINE                          32540099
325500             FROM CD-CC-DISPLAY-LINE                              32550099
325600             AFTER ADVANCING 1 LINES                              32560099
325700     END-IF.                                                      32570099
325800                                                                  32580099
325900     IF CC-SUMMARY-REPORT                                         32590099
326000         WRITE DI-DEFECT-ITM-SUM-LINE                             32600099
326100             FROM CD-CC-DISPLAY-LINE                              32610099
326200             AFTER ADVANCING 1 LINES                              32620099
326300     END-IF.                                                      32630099
326400                                                                  32640099
326500     IF CC-TOTAL-REPORT                                           32650099
326600         WRITE DI-DEFECT-ITM-SUM-LINE                             32660099
326700             FROM CD-CC-DISPLAY-LINE                              32670099
326800             AFTER ADVANCING 1 LINES                              32680099
326900     END-IF.                                                      32690099
327000                                                                  32700099
327100                                                                  32710099
327200***************************************************************** 32720099
327300**    DISPLAY CONTENTS OF SPECIFIC BUYER NUMBER CONTROL CARD   ** 32730099
327400***************************************************************** 32740099
327500                                                                  32750099
327600     MOVE '              SPECIFIC BUYER NUMBER'                   32760099
327700                                 TO CD-CONTROL-FIELD-DESC.        32770099
327800     IF CC-ALL-BUYERS                                             32780099
327900         MOVE 'ALL BUYERS'       TO CD-CONTROL-FIELD-VALUE        32790099
328000     ELSE                                                         32800099
328100         MOVE CC-BUYER-NBR       TO CD-CONTROL-FIELD-VALUE        32810099
328200     END-IF.                                                      32820099
328300                                                                  32830099
328400     IF CC-DETAIL-REPORT                                          32840099
328500         WRITE DI-DEFECT-ITM-DETAIL-LINE                          32850099
328600             FROM CD-CC-DISPLAY-LINE                              32860099
328700             AFTER ADVANCING 1 LINES                              32870099
328800     END-IF.                                                      32880099
328900                                                                  32890099
329000     IF CC-SUMMARY-REPORT                                         32900099
329100         WRITE DI-DEFECT-ITM-SUM-LINE                             32910099
329200             FROM CD-CC-DISPLAY-LINE                              32920099
329300             AFTER ADVANCING 1 LINES                              32930099
329400     END-IF.                                                      32940099
329500                                                                  32950099
329600     IF CC-TOTAL-REPORT                                           32960099
329700         WRITE DI-DEFECT-ITM-SUM-LINE                             32970099
329800             FROM CD-CC-DISPLAY-LINE                              32980099
329900             AFTER ADVANCING 1 LINES                              32990099
330000     END-IF.                                                      33000099
330100                                                                  33010099
330200***************************************************************** 33020099
330300**    DISPLAY CONTENTS OF SPECIFIC DEPARTMENT NUMBER CNTL CARD ** 33030099
330400***************************************************************** 33040099
330500                                                                  33050099
330600     MOVE '         SPECIFIC DEPARTMENT NUMBER'                   33060099
330700                                 TO CD-CONTROL-FIELD-DESC.        33070099
330800     IF CC-ALL-DEPTS                                              33080099
330900         MOVE 'ALL DEPARTMENTS'  TO CD-CONTROL-FIELD-VALUE        33090099
331000     ELSE                                                         33100099
331100         MOVE CC-DEPT-NBR        TO CD-CONTROL-FIELD-VALUE        33110099
331200     END-IF.                                                      33120099
331300                                                                  33130099
331400     IF CC-DETAIL-REPORT                                          33140099
331500         WRITE DI-DEFECT-ITM-DETAIL-LINE                          33150099
331600             FROM CD-CC-DISPLAY-LINE                              33160099
331700             AFTER ADVANCING 1 LINES                              33170099
331800     END-IF.                                                      33180099
331900                                                                  33190099
332000     IF CC-SUMMARY-REPORT                                         33200099
332100         WRITE DI-DEFECT-ITM-SUM-LINE                             33210099
332200             FROM CD-CC-DISPLAY-LINE                              33220099
332300             AFTER ADVANCING 1 LINES                              33230099
332400     END-IF.                                                      33240099
332500                                                                  33250099
332600     IF CC-TOTAL-REPORT                                           33260099
332700         WRITE DI-DEFECT-ITM-SUM-LINE                             33270099
332800             FROM CD-CC-DISPLAY-LINE                              33280099
332900             AFTER ADVANCING 1 LINES                              33290099
333000     END-IF.                                                      33300099
333100                                                                  33310099
333200                                                                  33320099
333300***************************************************************** 33330099
333400**    DISPLAY CONTENTS OF SPECIFIC VENDOR NUMBER CONTROL CARD  ** 33340099
333500***************************************************************** 33350099
333600                                                                  33360099
333700     MOVE '             SPECIFIC VENDOR NUMBER'                   33370099
333800                                 TO CD-CONTROL-FIELD-DESC.        33380099
333900     IF CC-ALL-VENDORS                                            33390099
334000         MOVE 'ALL VENDORS    '                                   33400099
334100                                 TO CD-CONTROL-FIELD-VALUE        33410099
334200     ELSE                                                         33420099
334300         MOVE CC-VNDUN-NBR       TO CD-CONTROL-FIELD-VALUE        33430099
334400     END-IF.                                                      33440099
334500                                                                  33450099
334600     IF CC-DETAIL-REPORT                                          33460099
334700         WRITE DI-DEFECT-ITM-DETAIL-LINE                          33470099
334800             FROM CD-CC-DISPLAY-LINE                              33480099
334900             AFTER ADVANCING 1 LINES                              33490099
335000     END-IF.                                                      33500099
335100                                                                  33510099
335200     IF CC-SUMMARY-REPORT                                         33520099
335300         WRITE DI-DEFECT-ITM-SUM-LINE                             33530099
335400             FROM CD-CC-DISPLAY-LINE                              33540099
335500             AFTER ADVANCING 1 LINES                              33550099
335600     END-IF.                                                      33560099
335700                                                                  33570099
335800     IF CC-TOTAL-REPORT                                           33580099
335900         WRITE DI-DEFECT-ITM-SUM-LINE                             33590099
336000             FROM CD-CC-DISPLAY-LINE                              33600099
336100             AFTER ADVANCING 1 LINES                              33610099
336200     END-IF.                                                      33620099
336300                                                                  33630099
336400                                                                  33640099
336500***************************************************************** 33650099
336600**    DISPLAY CONTENTS OF THE REPORT TYPE INDICATOR            ** 33660099
336700***************************************************************** 33670099
336800                                                                  33680099
336900     MOVE '              REPORT TYPE REQUESTED'                   33690099
337000                                 TO CD-CONTROL-FIELD-DESC.        33700099
337100     EVALUATE TRUE                                                33710099
337200     WHEN CC-BOTH-REPORTS                                         33720099
337300         MOVE 'BOTH THE SUMMARY & DETAIL REPORTS WERE REQUESTED  '33730099
337400                                 TO CD-CONTROL-FIELD-VALUE        33740099
337500     WHEN CC-SUMMARY-REPORT                                       33750099
337600         MOVE 'ONLY THE SUMMARY REPORT WAS REQUESTED             '33760099
337700                                 TO CD-CONTROL-FIELD-VALUE        33770099
337800     WHEN CC-DETAIL-REPORT                                        33780099
337900         MOVE 'ONLY THE DETAIL REPORT WAS REQUESTED              '33790099
338000                                 TO CD-CONTROL-FIELD-VALUE        33800099
338100     WHEN CC-TOTAL-REPORT                                         33810099
338200         MOVE 'ONLY THE TOTAL REPORT WAS REQUESTED               '33820099
338300                                 TO CD-CONTROL-FIELD-VALUE        33830099
338400     END-EVALUATE.                                                33840099
338500                                                                  33850099
338600     IF CC-DETAIL-REPORT                                          33860099
338700         WRITE DI-DEFECT-ITM-DETAIL-LINE                          33870099
338800             FROM CD-CC-DISPLAY-LINE                              33880099
338900             AFTER ADVANCING 1 LINES                              33890099
339000     END-IF.                                                      33900099
339100                                                                  33910099
339200     IF CC-SUMMARY-REPORT                                         33920099
339300         WRITE DI-DEFECT-ITM-SUM-LINE                             33930099
339400             FROM CD-CC-DISPLAY-LINE                              33940099
339500             AFTER ADVANCING 1 LINES                              33950099
339600     END-IF.                                                      33960099
339700                                                                  33970099
339800     IF CC-TOTAL-REPORT                                           33980099
339900         WRITE DI-DEFECT-ITM-SUM-LINE                             33990099
340000             FROM CD-CC-DISPLAY-LINE                              34000099
340100             AFTER ADVANCING 1 LINES                              34010099
340200     END-IF.                                                      34020099
340300                                                                  34030099
340400                                                                  34040099
340500******************************************************************34050099
340600* 8900-EMPTY-DEFECT-RPT - IF THERE WAS NO DATA THAT SATISFIED THE 34060099
340700* SELECTION CRITERIA, DISPLAY THE CONTROL CARD VALUES IN A MORE   34070099
340800* READABLE FORMAT.                                                34080099
340900******************************************************************34090099
341000 8900-EMPTY-DEFECT-RPT.                                           34100099
341100                                                                  34110099
341200     DISPLAY '**'                                                 34120099
341300     DISPLAY '** NO INFORMATION WAS FOUND TO MATCH THE '          34130099
341400             'SELECTION     **'.                                  34140099
341500     DISPLAY '** CRITERIA.  THE CONTROL CARD CONTAINED '          34150099
341600             'THE           **'.                                  34160099
341700     DISPLAY '** FOLLOWING INFORMATION:                '          34170099
341800             '              **'.                                  34180099
341900                                                                  34190099
342000     DISPLAY '**       RTV LOCATION: ' CC-OPER-UNT-ID             34200099
342100             '                            **'.                    34210099
342200                                                                  34220099
342300     EVALUATE TRUE                                                34230099
342400         WHEN CC-LIST-TYPE-MARKOUT                                34240099
342500             DISPLAY '**     LIST TYPE CODE: '                    34250099
342600                     'ALL MARKOUT LISTINGS           **'          34260099
342700         WHEN CC-LIST-TYPE-RTV                                    34270099
342800             DISPLAY '**     LIST TYPE CODE: '                    34280099
342900                     'ALL RETURN-TO-VENDOR LISTINGS   **'         34290099
343000         WHEN CC-LIST-TYPE-D-AND-D                                34300099
343100             DISPLAY '**     LIST TYPE CODE: '                    34310099
343200                     'ALL DEBIT AND DISPOSE LISTINGS  **'         34320099
343300         WHEN CC-LIST-TYPE-ALL                                    34330099
343400             DISPLAY '**     LIST TYPE CODE: '                    34340099
343500                     'ALL LIST TYPES                  **'         34350099
343600         WHEN OTHER                                               34360099
343700             DISPLAY '**     LIST TYPE CODE: '                    34370099
343800                     'ERROR IN LIST TYPE CODE         **'         34380099
343900     END-EVALUATE.                                                34390099
344000                                                                  34400099
344100     EVALUATE TRUE                                                34410099
344200         WHEN CC-LIST-STATUS-NEW                                  34420099
344300             DISPLAY '**   LIST STATUS CODE: '                    34430099
344400                     'ALL NEW LISTINGS                **'         34440099
344500         WHEN CC-LIST-STATUS-OPEN                                 34450099
344600             DISPLAY '**   LIST STATUS CODE: '                    34460099
344700                     'ALL OPEN LISTINGS               **'         34470099
344800         WHEN CC-LIST-STATUS-CLOSED                               34480099
344900             DISPLAY '**   LIST STATUS CODE: '                    34490099
345000                     'ALL CLOSED LISTINGS             **'         34500099
345100         WHEN CC-LIST-STATUS-SHIPPED                              34510099
345200             DISPLAY '**   LIST STATUS CODE: '                    34520099
345300                     'ALL SHIPPED LISTINGS            **'         34530099
345400         WHEN CC-LIST-STATUS-APPROVED                             34540099
345500             DISPLAY '**   LIST STATUS CODE: '                    34550099
345600                     'ALL APPROVED LISTINGS           **'         34560099
345700         WHEN CC-LIST-STATUS-PENDING                              34570099
345800             DISPLAY '**   LIST STATUS CODE: '                    34580099
345900                     'ALL PENDING LISTINGS            **'         34590099
346000         WHEN CC-LIST-STATUS-DISPOSED                             34600099
346100             DISPLAY '**   LIST STATUS CODE: '                    34610099
346200                     'ALL DISPOSED LISTINGS           **'         34620099
346300         WHEN CC-LIST-STATUS-ALL                                  34630099
346400             DISPLAY '**   LIST STATUS CODE: '                    34640099
346500                     'ALL STATUS CODES                **'         34650099
346600         WHEN OTHER                                               34660099
346700             DISPLAY '**   LIST STATUS CODE: '                    34670099
346800                     'ALL OPEN AND CLOSED LISTINGS    **'         34680099
346900     END-EVALUATE.                                                34690099
347000                                                                  34700099
347100     IF CC-ALL-STORAGE-LOC-ID                                     34710099
347200         DISPLAY     '**   STORAGE LOCATION: '                    34720099
347300                     'ALL STORAGE LOCATIONS           **'         34730099
347400     ELSE                                                         34740099
347500         DISPLAY     '**   STORAGE LOCATION: '                    34750099
347600                     CC-STORAGE-LOC-ID                            34760099
347700                     '                   **'                      34770099
347800     END-IF.                                                      34780099
347900                                                                  34790099
348000     IF CC-ALL-BUYERS                                             34800099
348100         DISPLAY     '**       BUYER NUMBER: '                    34810099
348200                     'ALL BUYERS                      **'         34820099
348300     ELSE                                                         34830099
348400         DISPLAY     '**       BUYER NUMBER: '                    34840099
348500                     CC-BUYER-NBR                                 34850099
348600                     '                             **'            34860099
348700     END-IF.                                                      34870099
348800                                                                  34880099
348900     IF CC-ALL-DEPTS                                              34890099
349000         DISPLAY '**  DEPARTMENT NUMBER: '                        34900099
349100                 'ALL DEPARTMENTS                 **'             34910099
349200     ELSE                                                         34920099
349300         DISPLAY '**  DEPARTMENT NUMBER: '                        34930099
349400                 CC-DEPT-NBR                                      34940099
349500                 '                             **'                34950099
349600     END-IF.                                                      34960099
349700                                                                  34970099
349800     IF CC-ALL-VENDORS                                            34980099
349900         DISPLAY '**      VENDOR NUMBER: '                        34990099
350000                 'ALL VENDORS                     **'             35000099
350100     ELSE                                                         35010099
350200         DISPLAY '**      VENDOR NUMBER: '                        35020099
350300                 CC-VNDUN-NBR                                     35030099
350400                 '                       **'                      35040099
350500     END-IF.                                                      35050099
350600                                                                  35060099
350700     EVALUATE TRUE                                                35070099
350800     WHEN CC-BOTH-REPORTS                                         35080099
350900         DISPLAY '**        REPORT TYPE: '                        35090099
351000                 'BOTH DETAIL AND SUMMARY REPORT  **'             35100099
351100     WHEN CC-DETAIL-REPORT                                        35110099
351200         DISPLAY '**        REPORT TYPE: '                        35120099
351300                 'DETAIL REPORT                   **'             35130099
351400     WHEN CC-SUMMARY-REPORT                                       35140099
351500         DISPLAY '**        REPORT TYPE: '                        35150099
351600                 'SUMMARY REPORT                  **'             35160099
351700     WHEN CC-TOTAL-REPORT                                         35170099
351800         DISPLAY '**        REPORT TYPE: '                        35180099
351900                 'ONLY TOTAL REPORT               **'             35190099
352000     END-EVALUATE.                                                35200099
352100                                                                  35210099
352200     IF CC-DETAIL-REPORT                                          35220099
352300         PERFORM 8300-WRITE-DETAIL-PAGE-HEAD                      35230099
352400         WRITE DI-DEFECT-ITM-DETAIL-LINE                          35240099
352500             FROM ER-EMPTY-REPORT-LINE                            35250099
352600             AFTER ADVANCING 3 LINES                              35260099
352700     END-IF.                                                      35270099
352800                                                                  35280099
352900     IF CC-SUMMARY-REPORT                                         35290099
353000         PERFORM 8300-WRITE-SUM-PAGE-HEAD                         35300099
353100         WRITE DI-DEFECT-ITM-SUM-LINE                             35310099
353200             FROM ER-EMPTY-REPORT-LINE                            35320099
353300             AFTER ADVANCING 3 LINES                              35330099
353400     END-IF.                                                      35340099
353500                                                                  35350099
353600     IF CC-TOTAL-REPORT                                           35360099
353700         PERFORM 8300-WRITE-SUM-PAGE-HEAD                         35370099
353800         WRITE DI-DEFECT-ITM-SUM-LINE                             35380099
353900             FROM ER-EMPTY-REPORT-LINE                            35390099
354000             AFTER ADVANCING 3 LINES                              35400099
354100     END-IF.                                                      35410099
354200                                                                  35420099
354300*8900-EXIT.                                                       35430099
354400                                                                  35440099
354500******************************************************************35450099
354600* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  35460099
354700* CURSOR AND THE REPORT FILE.                                     35470099
354800******************************************************************35480099
354900 9000-EOJ-ROUTINE.                                                35490099
355000                                                                  35500099
355100     IF PS-NO-DATA                                                35510099
355200         CONTINUE                                                 35520099
355300     ELSE                                                         35530099
355400         PERFORM 5500-GRAND-TOTAL                                 35540099
355500     END-IF.                                                      35550099
355600                                                                  35560099
355700     PERFORM 8500-WRITE-LAST-PAGE.                                35570099
355800                                                                  35580099
355900     IF CC-DETAIL-REPORT                                          35590099
356000         WRITE DI-DEFECT-ITM-DETAIL-LINE                          35600099
356100             FROM END-OF-REPORT-LINE                              35610099
356200             AFTER ADVANCING 1 LINES                              35620099
356300     END-IF.                                                      35630099
356400                                                                  35640099
356500     IF CC-SUMMARY-REPORT                                         35650099
356600         WRITE DI-DEFECT-ITM-SUM-LINE                             35660099
356700             FROM END-OF-REPORT-LINE                              35670099
356800             AFTER ADVANCING 1 LINES                              35680099
356900     END-IF.                                                      35690099
357000                                                                  35700099
357100     IF CC-TOTAL-REPORT                                           35710099
357200         WRITE DI-DEFECT-ITM-SUM-LINE                             35720099
357300             FROM END-OF-REPORT-LINE                              35730099
357400             AFTER ADVANCING 1 LINES                              35740099
357500     END-IF.                                                      35750099
357600                                                                  35760099
357700     CLOSE DI-DEFECT-ITM-DETAIL-RPT                               35770099
357800           DI-DEFECT-ITM-SUM-RPT.                                 35780099
357900                                                                  35790099
358000*9000-EXIT.                                                       35800099
358100******************************************************************35810099
358200* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *35820099
358300* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *35830099
358400* WILL ABEND THE PROGRAM                                         *35840099
358500******************************************************************35850099
358600 9100-FIELD-OVERFLOW-ERROR.                                       35860099
358700     DISPLAY '** ABEND     **'.                                   35870099
358800     DISPLAY '** PROGRAM   ** = RVKRP002'.                        35880099
358900     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          35890099
359000     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   35900099
359100     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   35910099
359200     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            35920099
359300     DISPLAY PV-FIELD-NAME.                                       35930099
359400                                                                  35940099
359500     MOVE +4004 TO ABEND-CODE.                                    35950099
359600     CALL 'ILBOABN0' USING ABEND-CODE.                            35960099
359700                                                                  35970099
359800******************************************************************35980099
359900* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    35990099
360000* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               36000099
360100******************************************************************36010099
360200 9999-SQL-ABEND.                                                  36020099
360300     DISPLAY '** ABEND     **'.                                   36030099
360400     DISPLAY '** PROGRAM   ** = RVKRP002'.                        36040099
360500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              36050099
360600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     36060099
360700                                                                  36070099
360800******************************************************************36080099
360900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *36090099
361000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *36100099
361100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *36110099
361200* FORMAT.                                                        *36120099
361300******************************************************************36130099
361400     COPY DPPD004.                                                36140099
361500                                                                  36150099
361600     MOVE +4013 TO ABEND-CODE.                                    36160099
361700     CALL 'ILBOABN0' USING ABEND-CODE.                            36170099
361800*9999-EXIT.                                                       36180099
