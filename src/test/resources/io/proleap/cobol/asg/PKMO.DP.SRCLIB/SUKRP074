000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300 PROGRAM-ID.             SUKRP074.                                00030002
000400 AUTHOR.                 DENISE HAHN.                             00040002
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050002
000600 DATE-WRITTEN.           SEPTEMBER, 2016.                         00060002
000700 DATE-COMPILED.                                                   00070002
000800***************************************************************** 00080002
000900*                                                               * 00090002
001000*  SHIPPED P2L CARTONS THAT WERE CLOSED AFTER DIVERTED          * 00100002
001100*                                                               * 00110002
001200*  INPUT FILE IS CREATED BY SUKUT180 - SURD117 - LRECL 550      * 00120005
001210*  OUTPUT FILE                       - SURD135 - LRECL 150      * 00121005
001300*                                                               * 00130002
001400***************************************************************** 00140002
001500 ENVIRONMENT DIVISION.                                            00150002
001600 CONFIGURATION SECTION.                                           00160002
001700                                                                  00170002
001800 SOURCE-COMPUTER.        IBM-3090.                                00180002
001900 OBJECT-COMPUTER.        IBM-3090.                                00190002
002000                                                                  00200002
002100***************************************************************** 00210002
002200 INPUT-OUTPUT SECTION.                                            00220002
002300                                                                  00230002
002400 FILE-CONTROL.                                                    00240002
002500                                                                  00250002
002600     SELECT INPUT-FILE                                            00260002
002700         ASSIGN TO INP01.                                         00270002
002800                                                                  00280002
002900     SELECT CONTROL-FILE                                          00290002
003000         ASSIGN TO INP02.                                         00300002
003100                                                                  00310002
003200     SELECT REPORT-FILE                                           00320002
003300         ASSIGN TO RPT01.                                         00330002
003400                                                                  00340002
003410     SELECT OUTPUT-FILE                                           00341002
003420         ASSIGN TO OUT01.                                         00342002
003430                                                                  00343002
003440***************************************************************** 00344002
003450 DATA DIVISION.                                                   00345002
003460***************************************************************** 00346002
003470 FILE SECTION.                                                    00347002
003480                                                                  00348002
003490 FD  INPUT-FILE                                                   00349002
003500     RECORDING MODE IS F                                          00350002
003600     LABEL RECORDS ARE STANDARD                                   00360002
003700     BLOCK CONTAINS 0 RECORDS.                                    00370002
003800 01  INPUT-RECORD                    PIC  X(550).                 00380002
003900                                                                  00390002
004000 FD  CONTROL-FILE                                                 00400002
004100     RECORDING MODE IS F                                          00410002
004200     LABEL RECORDS ARE STANDARD                                   00420002
004300     BLOCK CONTAINS 0 RECORDS.                                    00430002
004400 01  CONTROL-RECORD                  PIC  X(80).                  00440002
004500                                                                  00450002
004600 FD  REPORT-FILE                                                  00460002
004700     RECORDING MODE IS F                                          00470002
004800     BLOCK CONTAINS 0  RECORDS.                                   00480002
004900 01  REPORT-RECORD                   PIC X(132).                  00490005
005000                                                                  00500002
005010 FD  OUTPUT-FILE                                                  00501002
005020     RECORDING MODE IS F                                          00502002
005030     BLOCK CONTAINS 0  RECORDS.                                   00503002
005040 01  OUTPUT-RECORD                   PIC X(100).                  00504011
005050                                                                  00505002
005060***************************************************************** 00506002
005070 WORKING-STORAGE SECTION.                                         00507002
005080                                                                  00508002
005090 01  PROGRAM-SWITCHES.                                            00509002
005100     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00510002
005200         88  PS-END-OF-INPUT                   VALUE 'Y'.         00520002
005300         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00530002
005310     05  PS-SUMMARY-TABLE-SW         PIC X(01) VALUE 'N'.         00531023
005320         88  SUMMARY-TABLE-EOF                 VALUE 'Y'.         00532023
005330                                                                  00533023
005400                                                                  00540002
005500 01  PC-PROGRAM-CONSTANTS.                                        00550002
005510     05  PC-TABLE-MAX                 PIC S9(05)    VALUE +150.   00551023
005520     05  PC-ACTUAL-TABLE-ENTRIES      PIC S9(05)    VALUE ZEROES. 00552023
005600     05  PC-SUKRP074                 PIC X(08) VALUE              00560002
005700                                               'SUKRP074'.        00570002
005800     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00580002
005900     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00590002
006000                                               COMP-3.            00600002
006100     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00610002
006200                                    '9999-09-09-09.09.09.999999'. 00620002
006300     05  PC-SLASH                    PIC X(01) VALUE '/'.         00630002
006400     05  PC-DASH                     PIC X(01) VALUE '-'.         00640002
006500                                                                  00650002
006510                                                                  00651023
006520  01  SPT-SUMMARY-PAGE-TABLE.                                     00652023
006530      05  FILLER  OCCURS 150 TIMES                                00653023
006540                  INDEXED BY SPT-INDEX.                           00654023
006550          10  SPT-DC-NBR                 PIC 9(04) VALUE ZEROES.  00655023
006560          10  SPT-DC-NAME                PIC X(20) VALUE SPACES.  00656023
006570          10  SPT-DC-TOTAL-TRIPS         PIC 9(11) VALUE ZEROES.  00657023
006580          10  SPT-DC-P2L-CARTONS         PIC 9(11) VALUE ZEROES.  00658023
006590          10  SPT-DC-CLOSE-AFTER-DIVERT  PIC 9(11) VALUE ZEROES.  00659023
006591          10  SPT-DC-CLOSE-DIVERT-PCNT   PIC S999V99 VALUE +0.    00659124
006592                                                                  00659223
006600 01  SD-DATE-TIME.                                                00660002
006700     05  SD-SYSTEM-DATE.                                          00670002
006800         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00680002
006900         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00690002
007000         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00700002
007100     05  SD-SYSTEM-TIME.                                          00710002
007200         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00720002
007300         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00730002
007400         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00740002
007500         10  FILLER                  PIC 9(02) VALUE ZERO.        00750002
007600                                                                  00760002
007700 01  PV-PROGRAM-VARIABLES.                                        00770002
007710     05  PV-RCVR-COUNT                PIC S9(09)  COMP.           00771008
007711     05  PV-SML-UNT-QTY               PIC S9(09)  COMP.           00771108
007712     05  PV-TRIP-P2L-CRTNS            PIC S9(09)  COMP.           00771208
007713     05  PV-P2L-CLOSED-AFT            PIC  9(09).                 00771308
007714     05  PV-CLOSED-DIVERT-WORK        PIC S999V9999.              00771410
007715     05  PV-CLOSED-DIVERT-PCNT        PIC  999V99-.               00771510
007716     05  PV-DISP-SML                  PIC  9(18).                 00771609
007717     05  PV-DISP-SQL                  PIC  -999.                  00771709
007718     05  PV-DISP-TRIP                 PIC  9(09).                 00771809
007719     05  PV-STORE-NAME                PIC  X(40).                 00771910
007720                                                                  00772007
007721     05  PV-DC-TOTAL-TRIPS            PIC  9(09) VALUE ZEROES.    00772122
007722     05  PV-DC-P2L-CARTONS            PIC  9(11) VALUE ZEROES.    00772222
007723     05  PV-DC-CLOSE-AFTER-DIVERT     PIC  9(11) VALUE ZEROES.    00772322
007730                                                                  00773018
007731     05  PV-CORP-TOTAL-TRIPS          PIC  9(11) VALUE ZEROES.    00773125
007732     05  PV-CORP-P2L-CARTONS          PIC  9(13) VALUE ZEROES.    00773225
007733     05  PV-CORP-CLOSE-AFTER-DIVERT   PIC  9(13) VALUE ZEROES.    00773325
007734                                                                  00773425
007740     05  PV-DIFF-WORK                 PIC  9(09) VALUE ZEROES.    00774018
007750     05  PV-ZERO-HOUR                 PIC  Z(02) VALUE ZEROES.    00775045
007790                                                                  00779018
007791     05  PV-EDITED-DIFF.                                          00779118
007792         10  PV-EDIT-DIFF-DAYS        PIC  X(02).                 00779218
007793         10  PV-EDIT-DIFF-FILLER-1    PIC  X(01).                 00779318
007794         10  PV-EDIT-DIFF-HOUR        PIC  X(02).                 00779420
007795         10  PV-EDIT-DIFF-FILLER-2    PIC  X(01).                 00779518
007796         10  PV-EDIT-DIFF-MIN         PIC  X(02).                 00779618
007797                                                                  00779718
007798     05  PV-WORK-DAYS                 PIC  9(02).                 00779844
007799     05  PV-WORK-DAYS-R REDEFINES PV-WORK-DAYS.                   00779938
007801         10  PV-REDEF-DAYS            PIC  Z(02).                 00780143
007802     05  PV-WORK-HOURS                PIC  9(02).                 00780243
007803     05  PV-WORK-HOURS-R REDEFINES PV-WORK-HOURS.                 00780338
007805         10  PV-REDEF-HOURS           PIC  X(02).                 00780537
007806     05  PV-WORK-MIN                  PIC  9(02).                 00780643
007807     05  PV-WORK-MIN-R REDEFINES PV-WORK-MIN.                     00780738
007809         10  PV-REDEF-MIN             PIC X(02).                  00780938
007810                                                                  00781037
007811     05  PV-REMAINDER                 PIC 9(08).                  00781142
007814                                                                  00781438
007820     05  PV-READ-COUNT                PIC S9(7) COMP-3            00782002
007900                                                VALUE ZERO.       00790002
008000     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00800002
008100                                                VALUE ZERO.       00810002
008200     05  PV-NULL-IND                 PIC S9(04) VALUE +0          00820002
008300                                               COMP SYNC.         00830002
008400     05  PV-FORMAT-DATE.                                          00840002
008500         10 PV-FORMAT-DATE-MM         PIC  9(02).                 00850002
008600         10 FILLER                    PIC  X(01) VALUE '/'.       00860002
008700         10 PV-FORMAT-DATE-DD         PIC  9(02).                 00870002
008800         10 FILLER                    PIC  X(01) VALUE '/'.       00880002
008900         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 00890002
009000                                                                  00900002
009100     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00910002
009200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00920002
009300                                               COMP-3.            00930002
009400     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00940002
009500                                               COMP-3.            00950002
009800     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00980002
010000                                                                  01000002
010100     05  PV-PREV-TRIP-ID             PIC S9(09) COMP.             01010002
010110     05  PV-PREV-OPER                PIC S9(04) COMP.             01011002
010120     05  PV-PREV-DEST                PIC S9(04) COMP.             01012002
010121     05  PV-PREV-SML                 PIC S9(18) COMP-3            01012116
010122                                                VALUE ZEROES.     01012216
010130                                                                  01013002
010140     05  PV-TODAYS-DATE.                                          01014002
010150         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01015002
010160         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01016002
010170         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01017002
010180     05  PV-TODAYS-DATE-YYYY.                                     01018002
010190         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01019002
010200         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01020002
010300                                                                  01030002
010400     05  PV-TODAYS-TIME.                                          01040002
010500         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01050002
010600         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01060002
010700         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01070002
010800         10  FILLER                  PIC 9(02) VALUE ZERO.        01080002
010900                                                                  01090002
011000*                                                                 01100004
011100     05  PV-P2L-CRTN-RCVR-COUNT      PIC  S9(09)  COMP.           01110004
011110     05  PV-P2L-CRTN-UNIT-COUNT      PIC  S9(09)  COMP.           01111004
011111*                                                                 01111104
011120     05  PV-P2L-CRTNS-ON-TRIP        PIC  S9(09)  COMP.           01112004
011200     05  PV-P2L-CLOSED-AFTER-DIVERT  PIC  S9(09)  COMP.           01120004
011300     05  PV-P2L-AVG-CLOSED-AFTER     PIC  S9(16)9V99.             01130004
011740                                                                  01174002
011750 01  PV-ABEND-FIELDS.                                             01175002
011751     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01175108
011752     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01175208
011760     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01176002
011770                                               COMP SYNC.         01177002
011780     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP074'.  01178002
011790     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01179002
011800     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01180002
011900     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01190002
012000     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01200002
012100     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01210002
012200     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01220002
012300     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01230002
012400     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      01240002
012500     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      01250002
012600                                                                  01260002
012610     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACES.      01261024
012620     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACES.      01262024
012630                                                                  01263024
012700     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     01270002
012800     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    01280002
012900     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     01290002
013000                                                                  01300002
013100     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             01310002
013200     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01320002
013300     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  01330002
013400     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     01340002
013500                                                                  01350002
013600 01  PV-SAVE-FIELDS.                                              01360002
013700     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP             01370002
013800                                                 VALUE +0.        01380002
013900 01  DK-DB-KEYS.                                                  01390002
014000     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              01400002
014100                                                                  01410002
014200 01  REPORT-DATES.                                                01420002
014300     05  REPORT-FROM-DATE            PIC X(10).                   01430002
014400     05  REPORT-TO-DATE              PIC X(10).                   01440002
014500******************************************************************01450002
014501*    DATE CONTROL CARD                                            01450102
014502******************************************************************01450202
014503     COPY SURD032.                                                01450302
014504                                                                  01450402
014505******************************************************************01450502
014506* RECORD LAYOUT FOR THE INPUT FILE.                               01450602
014507******************************************************************01450702
014508     COPY SURD117.                                                01450804
014509                                                                  01450902
014510******************************************************************01451002
014520* RECORD LAYOUT FOR THE OUTPUT TILE                               01452002
014530******************************************************************01453002
014540     COPY SURD135.                                                01454004
014550                                                                  01455002
014560******************************************************************01456002
014570*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01457004
014580******************************************************************01458002
014590     COPY DPWS132O.                                               01459004
014600                                                                  01460002
014700 01  WS-BATCH-PROC-DATE.                                          01470002
014800     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01480002
014900     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01490002
015000     05  FILLER                      PIC X(01) VALUE SPACES.      01500002
015100     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01510002
015200     05  FILLER                      PIC X(01) VALUE SPACES.      01520002
015300     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01530002
015400*                                                                 01540002
015500 01  HEADING-LINES.                                               01550002
015600     05  HEADING-LINE1.                                           01560002
015700         10  FILLER                  PIC X(40) VALUE SPACES.      01570004
015800         10  FILLER                  PIC X(32) VALUE              01580004
015900         'SHIPPED PACK-TO-LIGHT CARTONS - '.                      01590004
015910         10  FILLER                  PIC X(21) VALUE              01591004
015920         'CLOSED AFTER DIVERTED'.                                 01592004
016000         10  FILLER                  PIC X(39) VALUE SPACES.      01600004
016100                                                                  01610002
016200     05  HEADING-LINE1A.                                          01620002
016300         10  FILLER                  PIC X(49) VALUE SPACES.      01630004
016400         10  FILLER                  PIC X(12) VALUE              01640002
016500         'FISCAL WEEK '.                                          01650002
016600         10  HD1A-FROM-DATE          PIC X(10) VALUE SPACES.      01660002
016700         10  FILLER                  PIC X(03) VALUE ' - '.       01670002
016800         10  HD1A-TO-DATE            PIC X(10) VALUE SPACES.      01680002
016900         10  FILLER                  PIC X(48) VALUE SPACES.      01690004
017000                                                                  01700002
017100     05  HEADING-LINE2.                                           01710002
017200         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      01720002
017300         10  FILLER                  PIC X(01) VALUE SPACES.      01730002
017400         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      01740002
017500         10  FILLER                  PIC X(87) VALUE SPACES.      01750002
017520                                                                  01752005
017530     05  HEADING-LINE3.                                           01753002
017550         10  FILLER            PIC X(10) VALUE ' DC  STORE'.      01755005
017560         10  FILLER            PIC X(23) VALUE SPACES.            01756005
017570         10  FILLER            PIC X(05) VALUE 'OTBND'.           01757005
017580         10  FILLER            PIC X(26) VALUE SPACES.            01758005
017590         10  FILLER            PIC X(09) VALUE 'P2L **** '.       01759005
017600         10  FILLER            PIC X(15) VALUE 'P2L CLOSE **** '. 01760014
017700         10  FILLER            PIC X(07) VALUE '*****  '.         01770005
017800         10  FILLER            PIC X(13) VALUE 'DIVERT *****'.    01780005
017900         10  FILLER            PIC X(06) VALUE '  TIME'.          01790014
018000         10  FILLER            PIC X(06) VALUE SPACES.            01800005
018100         10  FILLER            PIC X(05) VALUE 'RCVR'.            01810005
018200         10  FILLER            PIC X(02) VALUE SPACES.            01820031
018300         10  FILLER            PIC X(04) VALUE 'UNIT'.            01830015
018400         10  FILLER            PIC X(02) VALUE SPACES.            01840002
018840                                                                  01884002
018850     05  HEADING-LINE4.                                           01885002
018860         10  FILLER            PIC X(10) VALUE ' NBR  NBR '.      01886005
018870         10  FILLER            PIC X(24) VALUE SPACES.            01887005
018890         10  FILLER            PIC X(04) VALUE 'TRIP'.            01889005
018900         10  FILLER            PIC X(03) VALUE SPACES.            01890005
018910         10  FILLER            PIC X(03) VALUE 'SRC'.             01891005
018911         10  FILLER            PIC X(03) VALUE SPACES.            01891105
018912         10  FILLER            PIC X(10) VALUE 'SML NUMBER'.      01891207
018913         10  FILLER            PIC X(07) VALUE SPACES.            01891305
018914         10  FILLER            PIC X(11) VALUE 'MOD    DATE'.     01891405
018915         10  FILLER            PIC X(12) VALUE '      TIME  '.    01891505
018916         10  FILLER            PIC X(14) VALUE '    DATE      '.  01891605
018917         10  FILLER            PIC X(13) VALUE 'TIME     DIFF'.   01891705
018919         10  FILLER            PIC X(06) VALUE SPACES.            01891905
018920         10  FILLER            PIC X(12) VALUE 'CNT    CNT  '.    01892005
018936                                                                  01893602
018937     05  HEADING-LINE5.                                           01893730
018938         10  FILLER            PIC X(10) VALUE ' DC     DC'.      01893830
018939         10  FILLER            PIC X(30) VALUE SPACES.            01893930
018940         10  FILLER            PIC X(05) VALUE 'TOTAL'.           01894030
018950         10  FILLER            PIC X(09) VALUE SPACES.            01895030
018960         10  FILLER            PIC X(03) VALUE 'P2L'.             01896030
018970         10  FILLER            PIC X(10) VALUE SPACES.            01897030
018980         10  FILLER            PIC X(07) VALUE 'CLOSED'.          01898030
018990         10  FILLER            PIC X(59) VALUE SPACES.            01899030
019141                                                                  01914130
019142     05  HEADING-LINE6.                                           01914230
019143         10  FILLER            PIC X(11) VALUE ' NBR   NAME'.     01914330
019144         10  FILLER            PIC X(29) VALUE SPACES.            01914430
019145         10  FILLER            PIC X(05) VALUE 'TRIPS'.           01914530
019146         10  FILLER            PIC X(07) VALUE SPACES.            01914630
019147         10  FILLER            PIC X(07) VALUE 'CARTONS'.         01914730
019148         10  FILLER            PIC X(09) VALUE SPACES.            01914830
019149         10  FILLER            PIC X(05) VALUE 'AFTER'.           01914930
019150         10  FILLER            PIC X(05) VALUE SPACES.            01915030
019151         10  FILLER            PIC X(04) VALUE 'PCNT'.            01915130
019152         10  FILLER            PIC X(50) VALUE SPACES.            01915230
019157                                                                  01915730
019158                                                                  01915802
019159 01  DETAIL-LINES.                                                01915902
019160     05  DETAIL-LINE1.                                            01916002
019170         10  DL1-DC-NBR               PIC  Z(04) VALUE ZEROES.    01917002
019180         10  FILLER                   PIC  X(01) VALUE SPACES.    01918002
019190         10  DL1-STORE                PIC  Z(04) VALUE ZEROES.    01919002
019191         10  FILLER                   PIC  X(01) VALUE SPACES.    01919105
019192         10  DL1-STORE-NAME           PIC  X(20) VALUE SPACES.    01919205
019200         10  FILLER                   PIC  X(01) VALUE SPACES.    01920002
019300         10  DL1-TRIP-ID              PIC  Z(09) VALUE ZEROES.    01930002
019400         10  FILLER                   PIC  X(01) VALUE SPACES.    01940002
019500         10  DL1-SOURCE               PIC  X(03) VALUE SPACES.    01950007
019600         10  FILLER                   PIC  X(01)  VALUE SPACES.   01960002
019610         10  DL1-SML                  PIC  X(18) VALUE SPACES.    01961013
019620         10  FILLER                   PIC  X(01)  VALUE SPACES.   01962012
019630         10  DL1-MOD                  PIC  Z(03) VALUE SPACES.    01963014
019640         10  FILLER                   PIC  X(01)  VALUE SPACES.   01964014
019700*                                                                 01970005
019800         10  DL1-P2L-CLOSE-DATE       PIC  X(10)  VALUE SPACES.   01980005
019900         10  FILLER                   PIC  X(01)  VALUE SPACES.   01990005
020100         10  DL1-P2L-CLOSE-TIME       PIC  X(08)  VALUE SPACES.   02010005
020200         10  FILLER                   PIC  X(01)  VALUE SPACES.   02020005
020300*                                                                 02030005
020310         10  DL1-P2L-DIVERT-DATE      PIC  X(10)  VALUE SPACES.   02031005
020320         10  FILLER                   PIC  X(01)  VALUE SPACES.   02032005
020330         10  DL1-P2L-DIVERT-TIME      PIC  X(08)  VALUE SPACES.   02033005
020340         10  FILLER                   PIC  X(01)  VALUE SPACES.   02034005
020350*                                                                 02035005
020400         10  DL1-P2L-TIME-DIFF        PIC  X(09)  VALUE SPACES.   02040005
020500         10  FILLER                   PIC  X(01)  VALUE SPACES.   02050007
020600*                                                                 02060005
020700         10  DL1-RCVR-CNT             PIC  Z(5)9  VALUE ZERO.     02070005
020800         10  FILLER                   PIC  X(01)  VALUE SPACES.   02080005
020810         10  DL1-UNIT-CNT             PIC  Z(5)9  VALUE ZERO.     02081005
020820         10  FILLER                   PIC  X(01)  VALUE SPACES.   02082005
025267                                                                  02526702
025268*** TRIP TOTAL LINE                                               02526805
025271                                                                  02527102
025272     05  TOTAL-LINE1.                                             02527205
025274         10  TL1-DC-NBR               PIC  Z(04)   VALUE ZEROES.  02527405
025275         10  FILLER                   PIC  X(01)   VALUE SPACES.  02527505
025276         10  TL1-STORE                PIC  Z(04)   VALUE ZEROES.  02527605
025277         10  FILLER                   PIC  X(01)   VALUE SPACES.  02527705
025278         10  FILLER                   PIC  X(20)   VALUE          02527805
025279                                      ' TOTAL FOR TRIP     '.     02527905
025280         10  FILLER                   PIC  X(01)   VALUE SPACES.  02528005
025282         10  TL1-TRIP-ID              PIC  Z(09)   VALUE ZEROES.  02528205
025283         10  FILLER                   PIC  X(01)   VALUE SPACES.  02528305
025284         10  FILLER                   PIC  X(19)   VALUE          02528405
025285                                      ' P2L CRTNS ON TRIP:'.      02528505
025286         10  TL1-TOTAL-P2L-CRTNS      PIC  ZZZ,ZZ9 VALUE SPACES.  02528605
025287         10  FILLER                   PIC  X(03)   VALUE SPACES.  02528705
025288         10  FILLER                   PIC  X(22)   VALUE          02528805
025289                                      'CLOSED AFTER DIVERTED:'.   02528905
025290         10  TL1-TOTAL-CLOSED-AFT     PIC  ZZZ,ZZ9 VALUE SPACES.  02529005
025291         10  FILLER                   PIC  X(02)   VALUE SPACES.  02529105
025292         10  FILLER                   PIC  X(15)   VALUE          02529205
025293                                      '% CLOSED AFTER '.          02529305
025294         10  TL1-PCNT-CLOSED-AFT      PIC  ZZZ.99  VALUE ZEROES.  02529405
025295         10  FILLER                   PIC  X(10)   VALUE SPACES.  02529505
025296*                                                                 02529605
025297*** DC TOTAL LINE                                                 02529722
025298                                                                  02529822
025299     05  TOTAL-LINE2.                                             02529922
025300         10  TL2-DC-NBR            PIC  Z(04) VALUE ZEROES.       02530025
025310         10  FILLER                PIC  X(01) VALUE SPACES.       02531025
025320         10  TL2-DC-NAME           PIC  X(25) VALUE SPACES.       02532025
025342         10  FILLER                PIC  X(07) VALUE ' TRIPS:'.    02534226
025343         10  TL2-TOTAL-TRIPS       PIC ZZZ,ZZZ,ZZ9 VALUE ZEROES.  02534325
025345         10  FILLER                PIC  X(19) VALUE               02534525
025346                                      ' P2L CRTNS FOR DC: '.      02534622
025347         10  TL2-TOTAL-P2L-CRTNS   PIC  ZZZ,ZZ9 VALUE ZEROES.     02534725
025348         10  FILLER                PIC  X(03)   VALUE SPACES.     02534825
025349         10  FILLER                PIC  X(22)   VALUE             02534925
025350                                      'CLOSED AFTER DIVERTED:'.   02535022
025351         10  TL2-TOTAL-CLOSED-AFT  PIC  ZZZ,ZZ9 VALUE ZEROES.     02535125
025352         10  FILLER                PIC  X(02)   VALUE SPACES.     02535225
025353         10  FILLER                PIC  X(15)   VALUE             02535325
025354                                      '% CLOSED AFTER '.          02535422
025355         10  TL2-PCNT-CLOSED-AFT   PIC  ZZZ.99  VALUE ZEROES.     02535525
025356         10  FILLER                PIC  X(10)   VALUE SPACES.     02535625
025357*                                                                 02535722
025358*                                                                 02535830
025359*** CORPORATE TOTAL LINES                                         02535930
025360                                                                  02536030
025361     05  TOTAL-LINE3.                                             02536130
025362         10  TL3-DC-NBR            PIC  Z(04) VALUE ZEROES.       02536230
025363         10  FILLER                PIC  X(01) VALUE SPACES.       02536330
025364         10  TL3-DC-NAME           PIC  X(25) VALUE SPACES.       02536430
025365         10  FILLER                PIC  X(03) VALUE SPACES.       02536530
025366         10  TL3-TOTAL-TRIPS       PIC ZZZ,ZZZ,ZZ9 VALUE ZEROES.  02536630
025367         10  FILLER                PIC  X(03) VALUE SPACES.       02536730
025369         10  TL3-TOTAL-P2L-CRTNS   PIC  ZZZ,ZZZ,ZZ9 VALUE ZEROES. 02536930
025370         10  FILLER                PIC  X(03)   VALUE SPACES.     02537030
025373         10  TL3-TOTAL-CLOSED-AFT  PIC  ZZZ,ZZZ,ZZ9 VALUE ZEROES. 02537330
025374         10  FILLER                PIC  X(03)   VALUE SPACES.     02537430
025377         10  TL3-PCNT-CLOSED-AFT   PIC  ZZZ.99- VALUE ZEROES.     02537730
025378         10  FILLER                PIC  X(49)   VALUE SPACES.     02537830
025379*                                                                 02537930
025380                                                                  02538002
025381 01  MISCELLANEOUS-LINES.                                         02538102
025382     05  BLANK-LINE.                                              02538202
025383         10  FILLER                  PIC X(150) VALUE SPACES.     02538302
025384                                                                  02538402
025385     05  END-OF-REPORT-LINE.                                      02538502
025386         10  FILLER                  PIC X(44) VALUE SPACES.      02538602
025387         10  FILLER                  PIC X(45) VALUE              02538702
025388             '*******   E N D   O F   R E P O R T   *******'.     02538802
025390         10  FILLER                  PIC X(43) VALUE SPACES.      02539002
025400         10  FILLER                  PIC X(18) VALUE SPACES.      02540002
025500                                                                  02550002
025600     05  NO-DATA-TO-REPORT-LINE.                                  02560002
025700         10  FILLER                  PIC X(40) VALUE SPACES.      02570002
025800         10  FILLER                  PIC  X(52)    VALUE          02580002
025900         '*******  N O   D A T A   T O   R E P O R T   *******'.  02590002
026000         10  FILLER                  PIC  X(40)    VALUE SPACES.  02600002
026100         10  FILLER                  PIC X(18) VALUE SPACES.      02610002
026200                                                                  02620002
026300                                                                  02630002
026400******************************************************************02640002
026500*  USED FOR DB2 ERROR MESSAGE BUILDING                            02650002
026600******************************************************************02660002
026700     COPY DPWS004.                                                02670002
026800                                                                  02680002
026900******************************************************************02690002
027000*   DB2 SQL COMMUNICATION AREA                                    02700002
027100******************************************************************02710002
027200     EXEC SQL                                                     02720002
027300          INCLUDE SQLCA                                           02730002
027400     END-EXEC.                                                    02740002
027500                                                                  02750002
027600*---------------------------------------------------------------* 02760002
027700*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        02770002
027800*  XLT_LOC                                                        02780002
027900*---------------------------------------------------------------* 02790002
028000     EXEC SQL                                                     02800002
028100          INCLUDE XLT00010                                        02810002
028200     END-EXEC.                                                    02820002
028300                                                                  02830002
028310*---------------------------------------------------------------* 02831007
028330*  SUT_OTBND_CART                                                 02833007
028340*---------------------------------------------------------------* 02834007
028350     EXEC SQL                                                     02835007
028360          INCLUDE SUT00024                                        02836007
028370     END-EXEC.                                                    02837007
028380                                                                  02838007
028390*---------------------------------------------------------------* 02839007
028392*  SUT_OTBND_UPC                                                  02839207
028393*---------------------------------------------------------------* 02839307
028394     EXEC SQL                                                     02839407
028395          INCLUDE SUT00028                                        02839507
028396     END-EXEC.                                                    02839607
028397                                                                  02839707
028398*---------------------------------------------------------------* 02839817
028399*  SUT_OTBND_PKD_UPC                                              02839917
028400*---------------------------------------------------------------* 02840017
028401     EXEC SQL                                                     02840117
028402          INCLUDE SUT00025                                        02840217
028403     END-EXEC.                                                    02840317
028404                                                                  02840417
028410******************************************************************02841002
028500 PROCEDURE DIVISION.                                              02850002
028600     DISPLAY '**** START OF SUKRP074 ****'.                       02860002
028700                                                                  02870002
028800*OPEN FILES.                                                      02880002
028900     OPEN INPUT  INPUT-FILE                                       02890002
029000                 CONTROL-FILE                                     02900002
029100          OUTPUT REPORT-FILE                                      02910002
029200                 OUTPUT-FILE.                                     02920002
029300                                                                  02930002
029400     PERFORM 1000-INITIALIZATION.                                 02940002
029500                                                                  02950002
029600     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         02960002
029700                                                                  02970002
029800     PERFORM 7000-READ-EXTRACT-FILE.                              02980002
029900                                                                  02990002
030000     MOVE SU117-TRIP-ID         TO  PV-PREV-TRIP-ID.              03000006
030100     MOVE SU117-OPER-UNT-ID     TO  PV-PREV-OPER.                 03010006
030200     MOVE SU117-STORE-DEST      TO  PV-PREV-DEST.                 03020006
030300                                                                  03030002
030400     IF PS-END-OF-INPUT                                           03040002
030500        ADD +1                  TO PV-PAGE-COUNT                  03050002
030600        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             03060006
030700        WRITE REPORT-RECORD                                       03070002
030800          FROM DP132O-STANDRD-HEADER-132-COLS                     03080006
030900            AFTER ADVANCING PAGE                                  03090002
031000        WRITE REPORT-RECORD                                       03100002
031100          FROM HEADING-LINE1                                      03110002
031200            AFTER ADVANCING 1 LINES                               03120002
031210        WRITE REPORT-RECORD                                       03121002
031220          FROM HEADING-LINE1A                                     03122002
031230            AFTER ADVANCING 1 LINES                               03123002
031240        WRITE REPORT-RECORD                                       03124002
031250          FROM HEADING-LINE2                                      03125002
031260            AFTER ADVANCING 1 LINE                                03126002
031270        WRITE REPORT-RECORD                                       03127002
031280          FROM NO-DATA-TO-REPORT-LINE                             03128002
031290            AFTER ADVANCING 2 LINES                               03129002
031300     ELSE                                                         03130002
031400         MOVE SU117-OPER-UNT-ID  TO PV-SAVE-OPER-UNT-ID           03140006
031500         PERFORM 8500-GET-LOCATION-NAME                           03150002
031510         PERFORM 8600-GET-STORE-NAME                              03151009
031600         PERFORM 1500-PRINT-HEADINGS                              03160002
031700         PERFORM 2000-PROCESS-INPUT                               03170002
031800           UNTIL PS-END-OF-INPUT                                  03180002
031900         PERFORM 3030-CALC-TRIP-TOTALS                            03190007
032000         PERFORM 5020-PRINT-TRLR-TOTALS                           03200007
032010         PERFORM 5030-PRINT-DC-TOTALS                             03201022
032020         PERFORM 4000-CREATE-TABLE-ENTRY                          03202023
032100         PERFORM 8020-WRITE-OUTPUT-FILE                           03210007
032110         PERFORM 5040-PRINT-CORP-TOTALS                           03211023
032200     END-IF.                                                      03220002
032300                                                                  03230002
032400*FINISH REPORT.                                                   03240002
032500                                                                  03250002
032600     WRITE REPORT-RECORD                                          03260002
032700       FROM END-OF-REPORT-LINE                                    03270002
032800         AFTER ADVANCING 3 LINES.                                 03280002
032900                                                                  03290002
033000*CLOSE FILES.                                                     03300002
033100     CLOSE INPUT-FILE                                             03310002
033200           CONTROL-FILE                                           03320002
033300           REPORT-FILE                                            03330002
033400           OUTPUT-FILE.                                           03340002
033500                                                                  03350002
033600     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 03360002
033700     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           03370002
033800                                                                  03380002
033900     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               03390002
034000     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        03400002
034100                                                                  03410002
034200     GOBACK.                                                      03420002
034300                                                                  03430002
034400******************************************************************03440002
034500*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *03450002
034600******************************************************************03460002
034700 1000-INITIALIZATION.                                             03470002
034800     ACCEPT SD-SYSTEM-DATE                                        03480002
034900       FROM DATE.                                                 03490002
035000                                                                  03500002
035100     ACCEPT SD-SYSTEM-TIME                                        03510002
035200       FROM TIME.                                                 03520002
035300                                                                  03530002
035400     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 03540006
035500     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   03550006
035600     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  03560006
035700     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  03570006
035800     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                03580006
035900                                                                  03590002
036000     MOVE PC-SUKRP074             TO DP132O-PROGRAM-NAME.         03600006
036100     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        03610006
036200     MOVE +0                      TO PV-PAGE-COUNT.               03620002
036300                                                                  03630002
036400     PERFORM 7010-READ-CONTROL-REC.                               03640002
036410     MOVE SU032-FROM-DATE    TO  REPORT-FROM-DATE.                03641002
036411     MOVE SU032-TO-DATE      TO  REPORT-TO-DATE.                  03641102
036412                                                                  03641202
036413     SET SPT-INDEX TO 1.                                          03641323
036414                                                                  03641423
036415                                                                  03641523
036416******************************************************************03641602
036417**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03641702
036418**  PAGES (AS NEEDED).                                            03641802
036419******************************************************************03641902
036420 1500-PRINT-HEADINGS.                                             03642002
036421     ADD +1                  TO PV-PAGE-COUNT.                    03642102
036422     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               03642206
036423                                                                  03642302
036430     MOVE REPORT-FROM-DATE   TO  HD1A-FROM-DATE.                  03643002
036440     MOVE REPORT-TO-DATE     TO  HD1A-TO-DATE.                    03644002
036450                                                                  03645002
036460     WRITE REPORT-RECORD                                          03646002
036470       FROM DP132O-STANDRD-HEADER-132-COLS                        03647007
036480         AFTER ADVANCING PAGE.                                    03648002
036490                                                                  03649002
036500     WRITE REPORT-RECORD                                          03650002
036600       FROM HEADING-LINE1                                         03660002
036700         AFTER ADVANCING 1 LINES.                                 03670002
036800                                                                  03680002
036900     WRITE REPORT-RECORD                                          03690002
037000       FROM HEADING-LINE1A                                        03700002
037100         AFTER ADVANCING 1 LINES.                                 03710002
037200                                                                  03720002
037300     WRITE REPORT-RECORD                                          03730002
037400       FROM HEADING-LINE2                                         03740002
037500         AFTER ADVANCING 1 LINE.                                  03750002
037600                                                                  03760002
037700     WRITE REPORT-RECORD                                          03770002
037800       FROM HEADING-LINE3                                         03780002
037900         AFTER ADVANCING 2 LINES.                                 03790002
038000                                                                  03800002
038100     WRITE REPORT-RECORD                                          03810002
038200       FROM HEADING-LINE4                                         03820002
038300         AFTER ADVANCING 1 LINES.                                 03830002
038400                                                                  03840002
039700     WRITE REPORT-RECORD                                          03970002
039800       FROM BLANK-LINE                                            03980002
039900         AFTER ADVANCING 1 LINE.                                  03990002
040000                                                                  04000002
040100     MOVE +08                TO PV-LINE-COUNT.                    04010002
040120                                                                  04012002
040121                                                                  04012107
040130******************************************************************04013002
040140**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             04014002
040150******************************************************************04015002
040160 2000-PROCESS-INPUT.                                              04016002
040170     IF  SU117-TRIP-ID = PV-PREV-TRIP-ID                          04017006
040180         CONTINUE                                                 04018002
040190     ELSE                                                         04019002
040200         PERFORM 3030-CALC-TRIP-TOTALS                            04020006
040300         PERFORM 5020-PRINT-TRLR-TOTALS                           04030002
040400         PERFORM 8020-WRITE-OUTPUT-FILE                           04040002
040410         MOVE ZEROES  TO  PV-TRIP-P2L-CRTNS                       04041006
040430                          PV-P2L-CLOSED-AFT                       04043006
040450                          PV-CLOSED-DIVERT-PCNT                   04045006
040500         MOVE SU117-TRIP-ID    TO  PV-PREV-TRIP-ID                04050006
040600         MOVE SU117-STORE-DEST TO  PV-PREV-DEST                   04060006
040610         PERFORM 8600-GET-STORE-NAME                              04061009
040700     END-IF.                                                      04070002
040800                                                                  04080002
040900     IF  SU117-OPER-UNT-ID = PV-PREV-OPER                         04090006
041000         CONTINUE                                                 04100002
041100     ELSE                                                         04110002
041110         PERFORM 5030-PRINT-DC-TOTALS                             04111022
041120         PERFORM 4000-CREATE-TABLE-ENTRY                          04112023
041200         MOVE SU117-OPER-UNT-ID    TO PV-PREV-OPER                04120006
041300         MOVE SU117-OPER-UNT-ID    TO PV-SAVE-OPER-UNT-ID         04130006
041400         PERFORM 8500-GET-LOCATION-NAME                           04140002
041410         PERFORM 1500-PRINT-HEADINGS                              04141002
041420     END-IF.                                                      04142002
041430                                                                  04143002
041431     IF  SU117-SML-NBR  =  PV-PREV-SML                            04143115
041432         CONTINUE                                                 04143215
041433     ELSE                                                         04143315
041440         PERFORM 3000-CALC-RCVRS-IN-SML                           04144015
041441         PERFORM 3010-CALC-UNITS-IN-SML                           04144115
041442         PERFORM 3015-GET-MOD-NBR                                 04144217
041443                                                                  04144317
041490         PERFORM 5000-WRITE-SML-INFO                              04149015
041501                                                                  04150102
041502         ADD  1              TO  PV-P2L-CLOSED-AFT                04150215
041503         MOVE SU117-SML-NBR  TO  PV-PREV-SML                      04150315
041504     END-IF.                                                      04150415
041505                                                                  04150515
041507                                                                  04150706
041508     PERFORM 7000-READ-EXTRACT-FILE.                              04150802
041509                                                                  04150902
041510                                                                  04151002
041511****************************************************************  04151106
041512* CALCULATE THE NUMBER OF RECEIVERS IN THE P2L SML             *  04151206
041513****************************************************************  04151306
041514 3000-CALC-RCVRS-IN-SML.                                          04151406
041515                                                                  04151506
041516     MOVE  SU117-SML-NBR  TO  SUT00028-SHIPT-UNT-ID.              04151606
041517                                                                  04151706
041518     EXEC SQL                                                     04151806
041519         SELECT  COUNT(*)                                         04151906
041520           INTO :PV-RCVR-COUNT                                    04152006
041521           FROM                                                   04152106
041522               (SELECT DISTINCT                                   04152206
041523                       TRN_NBR                                    04152306
041524                     , RCVR_SEQ_NBR                               04152406
041525                  FROM SUT_OTBND_UPC                              04152506
041526                 WHERE  SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID     04152606
041527               )  AS T1                                           04152706
041530     END-EXEC.                                                    04153006
041531                                                                  04153106
041532     EVALUATE TRUE                                                04153206
041533         WHEN SQLCODE = +0                                        04153306
041534              CONTINUE                                            04153406
041536         WHEN OTHER                                               04153606
041540             MOVE SUT00028-SHIPT-UNT-ID   TO  PV-DISP-SML         04154006
041541             MOVE SQLCODE                 TO  PV-DISP-SQL         04154106
041542             DISPLAY 'SUKRP074: 3000-'                            04154208
041543                     ' SQL:'  PV-DISP-SQL                         04154308
041544                     ' SML:'  PV-DISP-SML                         04154408
041545                                                                  04154506
041546             MOVE '3000-CALC-RCVRS-IN-SML'                        04154606
041547                           TO PV-ABEND-PARAGRAPH                  04154706
041548             MOVE 'COUNT RCVRS'       TO PV-DB2-FUNCTION          04154806
041549             MOVE 'SUT_OTBND_UPC  '   TO PV-DB2-TABLE-NAME        04154906
041550             PERFORM 9900-DB2-ABEND                               04155006
041551     END-EVALUATE.                                                04155106
041553                                                                  04155306
041554                                                                  04155406
041555****************************************************************  04155506
041556* CALCULATE THE NUMBER OF UNITS IN THE P2L SML                 *  04155606
041557****************************************************************  04155706
041558 3010-CALC-UNITS-IN-SML.                                          04155806
041559                                                                  04155906
041560     MOVE  SU117-SML-NBR  TO  SUT00028-SHIPT-UNT-ID.              04156006
041561                                                                  04156106
041562     EXEC SQL                                                     04156206
041563         SELECT  SUM(SHPD_UNT_QTY)                                04156306
041564           INTO :PV-SML-UNT-QTY                                   04156406
041569           FROM SUT_OTBND_UPC                                     04156906
041570          WHERE  SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID            04157006
041572     END-EXEC.                                                    04157206
041573                                                                  04157306
041574     EVALUATE TRUE                                                04157406
041575         WHEN SQLCODE = +0                                        04157506
041576              CONTINUE                                            04157606
041577         WHEN SQLCODE = -305                                      04157733
041578              MOVE ZEROES  TO  PV-SML-UNT-QTY                     04157833
041579         WHEN OTHER                                               04157906
041580             MOVE SUT00028-SHIPT-UNT-ID   TO  PV-DISP-SML         04158006
041581             MOVE SQLCODE                 TO  PV-DISP-SQL         04158106
041582             DISPLAY 'SUKRP074: 3010-'                            04158208
041583                     ' SQL:'  PV-DISP-SQL                         04158308
041584                     ' SML:'  PV-DISP-SML                         04158408
041585                                                                  04158506
041586             MOVE '3010-CALC-UNITS-IN-SML'                        04158606
041587                           TO PV-ABEND-PARAGRAPH                  04158706
041588             MOVE 'COUNT RCVRS'       TO PV-DB2-FUNCTION          04158806
041589             MOVE 'SUT_OTBND_UPC  '   TO PV-DB2-TABLE-NAME        04158906
041590             PERFORM 9900-DB2-ABEND                               04159006
041591     END-EVALUATE.                                                04159106
041592                                                                  04159206
041593                                                                  04159306
041594****************************************************************  04159417
041595* GET THE MOD NUMBER                                              04159517
041596****************************************************************  04159617
041597 3015-GET-MOD-NBR.                                                04159717
041598                                                                  04159817
041599     MOVE  SU117-SML-NBR  TO  SUT00028-SHIPT-UNT-ID.              04159917
041600                                                                  04160017
041601     EXEC SQL                                                     04160117
041602         SELECT  DISTINCT                                         04160217
041603                 B.MODU_NBR                                       04160317
041604           INTO :SUT00025-MODU-NBR                                04160417
041605           FROM SUT_OTBND_UPC A                                   04160517
041606              , SUT_OTBND_PKD_UPC B                               04160618
041607          WHERE  A.SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID          04160719
041608            AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                  04160817
041609            AND  A.TRN_NBR      = B.TRN_NBR                       04160917
041610            AND  A.RCVR_SEQ_NBR = B.RCVR_SEQ_NBR                  04161017
041611            AND  A.TRN_LNE_NBR  = B.TRN_LNE_NBR                   04161117
041612            AND  A.TRN_TYP_CDE  = B.TRN_TYP_CDE                   04161218
041613            AND  A.UPC_NBR      = B.UPC_NBR                       04161317
041614     END-EXEC.                                                    04161417
041615                                                                  04161517
041616     EVALUATE TRUE                                                04161617
041617         WHEN SQLCODE = +0                                        04161717
041618         WHEN SQLCODE = -811                                      04161817
041619              CONTINUE                                            04161917
041620         WHEN SQLCODE = -305                                      04162034
041621         WHEN SQLCODE = +100                                      04162134
041622              MOVE 0  TO  SUT00025-MODU-NBR                       04162234
041623         WHEN OTHER                                               04162334
041624             MOVE SUT00028-SHIPT-UNT-ID   TO  PV-DISP-SML         04162434
041625             MOVE SQLCODE                 TO  PV-DISP-SQL         04162534
041626             DISPLAY 'SUKRP074: 3015-'                            04162634
041627                     ' SQL:'  PV-DISP-SQL                         04162734
041628                     ' SML:'  PV-DISP-SML                         04162834
041629                                                                  04162934
041630             MOVE '3015-GET-MOD-NBR      '                        04163034
041631                           TO PV-ABEND-PARAGRAPH                  04163134
041632             MOVE 'COUNT RCVRS'       TO PV-DB2-FUNCTION          04163234
041633             MOVE 'SUT_OTBND_UPC  '   TO PV-DB2-TABLE-NAME        04163334
041634             PERFORM 9900-DB2-ABEND                               04163434
041635     END-EVALUATE.                                                04163534
041640                                                                  04164017
041700                                                                  04170017
045433****************************************************************  04543306
045434* CALCULATE TRIP TOTALS                                           04543406
045435****************************************************************  04543506
045436 3030-CALC-TRIP-TOTALS.                                           04543606
045437                                                                  04543706
045438     PERFORM 3040-COUNT-P2L-ON-TRIP.                              04543806
045439                                                                  04543906
045440     IF  PV-P2L-CLOSED-AFT  >  ZERO AND                           04544032
045441         PV-TRIP-P2L-CRTNS  >  ZERO                               04544132
045442         DIVIDE  PV-P2L-CLOSED-AFT                                04544232
045443             BY  PV-TRIP-P2L-CRTNS                                04544332
045444         GIVING  PV-CLOSED-DIVERT-WORK                            04544432
045445         MULTIPLY PV-CLOSED-DIVERT-WORK                           04544532
045446               BY 100                                             04544632
045447           GIVING PV-CLOSED-DIVERT-PCNT                           04544732
045448                  ROUNDED                                         04544832
045449     ELSE                                                         04544932
045450         MOVE ZEROES  TO  PV-CLOSED-DIVERT-WORK                   04545032
045451                          PV-CLOSED-DIVERT-PCNT                   04545132
045452     END-IF.                                                      04545232
045453                                                                  04545332
045454                                                                  04545432
045455****************************************************************  04545532
045456* CALCULATE P2L CARTONS ON TRIP                                   04545632
045457****************************************************************  04545732
045458 3040-COUNT-P2L-ON-TRIP.                                          04545832
045459                                                                  04545932
045460     MOVE  PV-PREV-TRIP-ID  TO  SUT00024-OTBND-TRIP-ID.           04546032
045461                                                                  04546132
045462     EXEC SQL                                                     04546232
045463         SELECT  COUNT(*)                                         04546332
045464           INTO :PV-TRIP-P2L-CRTNS                                04546432
045465           FROM SUT_OTBND_CART                                    04546532
045466          WHERE  CART_SRC_CDE IN ('JWL','P2L')                    04546632
045470            AND  OTBND_TRIP_ID = :SUT00024-OTBND-TRIP-ID          04547006
045507     END-EXEC.                                                    04550706
045508                                                                  04550806
045509     EVALUATE TRUE                                                04550906
045510         WHEN SQLCODE = +0                                        04551006
045511              CONTINUE                                            04551106
045512         WHEN OTHER                                               04551206
045513             MOVE SUT00024-OTBND-TRIP-ID  TO  PV-DISP-TRIP        04551309
045514             MOVE SQLCODE                 TO  PV-DISP-SQL         04551406
045515             DISPLAY 'SUKRP074: 3040-'                            04551508
045516                     ' SQL:'  PV-DISP-SQL                         04551608
045517                     ' TRIP:'  PV-DISP-TRIP                       04551708
045518                                                                  04551806
045519             MOVE '3040-COUNT-P2L-ON-TRIP'                        04551906
045520                           TO PV-ABEND-PARAGRAPH                  04552006
045521             MOVE 'P2L CRTNS ON TRIP' TO PV-DB2-FUNCTION          04552106
045522             MOVE 'SUT_OTBND_CART '   TO PV-DB2-TABLE-NAME        04552206
045523             PERFORM 9900-DB2-ABEND                               04552306
045524     END-EVALUATE.                                                04552406
045525                                                                  04552506
045526                                                                  04552623
045527****************************************************************  04552723
045528* CREATE INTERNAL TABLE WITH DC TOTALS                            04552823
045529****************************************************************  04552923
045530 4000-CREATE-TABLE-ENTRY.                                         04553023
045531                                                                  04553123
045532     IF  SPT-INDEX GREATER THAN PC-TABLE-MAX                      04553223
045533         MOVE '4000-CREATE-TABLE-ENTRY '  TO  PV-ABEND-PARAGRAPH  04553323
045534         SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX               04553423
045535         MOVE 'SUMMARY TABLE EXCEEDS MAXIMUM TABLE ENTRIES OF 150'04553523
045536                         TO PV-ERROR-MESSAGE-1                    04553623
045537         MOVE 'MAXIMUM TABLE SIZE NEEDS TO BE INCREASED'          04553723
045538                         TO PV-ERROR-MESSAGE-2                    04553823
045539         PERFORM 9998-ABEND                                       04553923
045540     END-IF.                                                      04554023
045541                                                                  04554123
045542     MOVE PV-PREV-OPER           TO  SPT-DC-NBR(SPT-INDEX).       04554223
045543     MOVE XLT00010-LOC-NM        TO  SPT-DC-NAME(SPT-INDEX).      04554323
045544     MOVE PV-DC-TOTAL-TRIPS                                       04554424
045545                       TO  SPT-DC-TOTAL-TRIPS(SPT-INDEX).         04554523
045546     MOVE PV-DC-P2L-CARTONS                                       04554623
045547                       TO  SPT-DC-P2L-CARTONS(SPT-INDEX).         04554723
045548     MOVE PV-DC-CLOSE-AFTER-DIVERT                                04554823
045550                       TO  SPT-DC-CLOSE-AFTER-DIVERT(SPT-INDEX).  04555023
045551     MOVE PV-CLOSED-DIVERT-PCNT                                   04555123
045552                       TO  SPT-DC-CLOSE-DIVERT-PCNT(SPT-INDEX).   04555223
045553                                                                  04555323
045554     SET SPT-INDEX UP BY +1.                                      04555423
045555                                                                  04555523
045556     MOVE ZEROES                   TO PV-DC-TOTAL-TRIPS           04555623
045557                                      PV-DC-P2L-CARTONS           04555723
045558                                      PV-DC-CLOSE-AFTER-DIVERT.   04555823
045559                                                                  04555923
045560                                                                  04556023
045561****************************************************************  04556123
045562* MOVE THE DETAILS TO REPORT LINE.                             *  04556223
045563****************************************************************  04556323
045564 5000-WRITE-SML-INFO.                                             04556423
045565                                                                  04556523
045566     MOVE SU117-OPER-UNT-ID         TO DL1-DC-NBR.                04556623
045567     MOVE SU117-STORE-DEST          TO DL1-STORE.                 04556723
045568     MOVE PV-STORE-NAME             TO DL1-STORE-NAME.            04556823
045569     MOVE SU117-TRIP-ID             TO DL1-TRIP-ID.               04556923
045570     MOVE SUT00025-MODU-NBR         TO DL1-MOD.                   04557023
045571     MOVE SU117-SML-SRC-CDE         TO DL1-SOURCE.                04557123
045572     MOVE SU117-SML-NBR             TO DL1-SML.                   04557223
045573                                                                  04557323
045574     MOVE SU117-SML-P2L-CLOSE-DTE   TO  DL1-P2L-CLOSE-DATE.       04557423
045575     MOVE SU117-SML-P2L-CLOSE-TM    TO  DL1-P2L-CLOSE-TIME.       04557523
045576*                                                                 04557623
045577     MOVE SU117-SML-ON-OTBND-DTE    TO  DL1-P2L-DIVERT-DATE.      04557723
045578     MOVE SU117-SML-ON-OTBND-TM     TO  DL1-P2L-DIVERT-TIME.      04557823
045579*                                                                 04557923
045580     MOVE SU117-P2L-CLOSE-TO-OTBND-MIN                            04558023
045581                                    TO  PV-DIFF-WORK.             04558123
045582                                                                  04558237
045583     MOVE ZEROES  TO  PV-WORK-DAYS                                04558337
045584                      PV-WORK-HOURS                               04558437
045585                      PV-WORK-MIN.                                04558542
045586                                                                  04558637
045587     IF  PV-DIFF-WORK  > 1440                                     04558737
045588         DIVIDE  PV-DIFF-WORK                                     04558837
045589             BY  1440                                             04558937
045590         GIVING  PV-WORK-DAYS                                     04559037
045591         REMAINDER PV-REMAINDER                                   04559142
045592     ELSE                                                         04559237
045593         MOVE PV-DIFF-WORK  TO  PV-REMAINDER                      04559342
045594     END-IF.                                                      04559437
045595                                                                  04559537
045596     IF  PV-REMAINDER   >  60                                     04559642
045597         DIVIDE  PV-REMAINDER                                     04559742
045598             BY  60                                               04559837
045599         GIVING  PV-WORK-HOURS                                    04559937
045600         REMAINDER PV-REMAINDER                                   04560042
045603     END-IF.                                                      04560337
045605                                                                  04560537
045606     MOVE PV-REMAINDER         TO  PV-WORK-MIN.                   04560642
045607                                                                  04560737
045608     IF  PV-WORK-DAYS   > 0                                       04560837
045610         MOVE  PV-REDEF-DAYS   TO   PV-EDIT-DIFF-DAYS             04561037
045611         MOVE  ':'             TO   PV-EDIT-DIFF-FILLER-1         04561138
045612     ELSE                                                         04561240
045613         MOVE SPACES           TO   PV-EDIT-DIFF-DAYS             04561337
045614                                    PV-EDIT-DIFF-FILLER-1         04561439
045615     END-IF.                                                      04561537
045616                                                                  04561637
045617     IF  PV-WORK-HOURS   > 0                                      04561737
045618         IF  PV-WORK-DAYS  >  0                                   04561845
045619             MOVE  PV-REDEF-HOURS  TO   PV-EDIT-DIFF-HOUR         04561945
045620         ELSE                                                     04562045
045621             MOVE  PV-REDEF-HOURS  TO   PV-ZERO-HOUR              04562145
045622             MOVE  PV-ZERO-HOUR    TO   PV-EDIT-DIFF-HOUR         04562245
045623         END-IF                                                   04562345
045624         MOVE  ':'             TO   PV-EDIT-DIFF-FILLER-2         04562445
045625     ELSE                                                         04562545
045626         IF  PV-WORK-DAYS   > 0                                   04562645
045627             MOVE  '00'        TO   PV-EDIT-DIFF-HOUR             04562745
045628         ELSE                                                     04562845
045629             MOVE  ' 0'        TO   PV-EDIT-DIFF-HOUR             04562945
045630         END-IF                                                   04563045
045631         MOVE  ':'             TO   PV-EDIT-DIFF-FILLER-2         04563145
045632     END-IF.                                                      04563245
045633                                                                  04563345
045634     MOVE PV-REDEF-MIN         TO   PV-EDIT-DIFF-MIN.             04563445
045640                                                                  04564045
045656     MOVE PV-EDITED-DIFF            TO  DL1-P2L-TIME-DIFF.        04565623
045657*                                                                 04565723
045658     MOVE PV-RCVR-COUNT             TO  DL1-RCVR-CNT.             04565823
045659     MOVE PV-SML-UNT-QTY            TO  DL1-UNIT-CNT.             04565923
045660                                                                  04566023
045661                                                                  04566123
045662     WRITE REPORT-RECORD                                          04566223
045663      FROM DETAIL-LINE1                                           04566323
045664     AFTER ADVANCING 1 LINES.                                     04566423
045665                                                                  04566523
045666     ADD  1                  TO PV-LINE-COUNT.                    04566623
045667     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04566723
045668         PERFORM 1500-PRINT-HEADINGS                              04566823
045669     END-IF.                                                      04566923
045670                                                                  04567023
045671                                                                  04567123
045672****************************************************************  04567223
045673* PRINT TRAILER TOTALS                                            04567323
045674****************************************************************  04567423
045675 5020-PRINT-TRLR-TOTALS.                                          04567523
045676                                                                  04567623
045677     IF  PV-P2L-CLOSED-AFT > 0 AND                                04567735
045678         PV-TRIP-P2L-CRTNS > 0                                    04567835
045679         DIVIDE  PV-P2L-CLOSED-AFT                                04567935
045680             BY  PV-TRIP-P2L-CRTNS                                04568035
045681         GIVING  PV-CLOSED-DIVERT-WORK                            04568135
045682         MULTIPLY PV-CLOSED-DIVERT-WORK                           04568235
045683               BY 100                                             04568335
045684           GIVING PV-CLOSED-DIVERT-PCNT                           04568435
045685                  ROUNDED                                         04568535
045686     ELSE                                                         04568635
045687         MOVE  ZEROES  TO  PV-CLOSED-DIVERT-WORK                  04568735
045688                           PV-CLOSED-DIVERT-PCNT                  04568835
045689     END-IF.                                                      04568936
045690                                                                  04569023
045691     MOVE PV-PREV-OPER           TO TL1-DC-NBR                    04569123
045692                                    SU135-OPER-UNT-ID.            04569223
045693     MOVE PV-PREV-DEST           TO TL1-STORE                     04569323
045694                                    SU135-STORE-DEST.             04569423
045695     MOVE PV-PREV-TRIP-ID        TO TL1-TRIP-ID                   04569523
045696                                    SU135-TRIP-ID.                04569623
045697     MOVE PV-TRIP-P2L-CRTNS      TO TL1-TOTAL-P2L-CRTNS           04569723
045698                                    SU135-P2L-CARTON-COUNT.       04569823
045699     MOVE PV-P2L-CLOSED-AFT      TO TL1-TOTAL-CLOSED-AFT          04569923
045700                                    SU135-P2L-CLOSED-AFTER-DIVERT.04570023
045701     MOVE PV-CLOSED-DIVERT-PCNT  TO TL1-PCNT-CLOSED-AFT.          04570123
045702                                                                  04570223
045703     ADD  1                      TO PV-DC-TOTAL-TRIPS.            04570323
045704     ADD  PV-TRIP-P2L-CRTNS      TO PV-DC-P2L-CARTONS.            04570423
045705     ADD  PV-P2L-CLOSED-AFT      TO PV-DC-CLOSE-AFTER-DIVERT.     04570523
045706                                                                  04570623
045707     WRITE REPORT-RECORD                                          04570723
045708       FROM TOTAL-LINE1                                           04570823
045709         AFTER ADVANCING 2 LINES.                                 04570923
045710                                                                  04571023
045711     ADD  1                  TO PV-LINE-COUNT.                    04571123
045712     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04571223
045713         PERFORM 1500-PRINT-HEADINGS                              04571323
045714     ELSE                                                         04571423
045715         MOVE  SPACES TO REPORT-RECORD                            04571523
045716         WRITE REPORT-RECORD                                      04571623
045717             AFTER ADVANCING 1 LINES                              04571723
045718         ADD  1              TO PV-LINE-COUNT                     04571823
045719         IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                    04571923
045720             PERFORM 1500-PRINT-HEADINGS                          04572023
045721         END-IF                                                   04572123
045722     END-IF.                                                      04572223
045723                                                                  04572323
045724                                                                  04572423
045725 5030-PRINT-DC-TOTALS.                                            04572523
045726                                                                  04572623
045727     IF  PV-DC-CLOSE-AFTER-DIVERT > 0  AND                        04572735
045728         PV-DC-P2L-CARTONS  > 0                                   04572835
045729         DIVIDE  PV-DC-CLOSE-AFTER-DIVERT                         04572935
045730             BY  PV-DC-P2L-CARTONS                                04573035
045731         GIVING  PV-CLOSED-DIVERT-WORK                            04573135
045732         MULTIPLY PV-CLOSED-DIVERT-WORK                           04573235
045733               BY 100                                             04573335
045734           GIVING PV-CLOSED-DIVERT-PCNT                           04573435
045735                  ROUNDED                                         04573535
045736     ELSE                                                         04573635
045737         MOVE ZEROES  TO  PV-CLOSED-DIVERT-WORK                   04573735
045738                          PV-CLOSED-DIVERT-PCNT                   04573835
045739     END-IF.                                                      04573935
045740                                                                  04574023
045741     MOVE PV-PREV-OPER             TO TL2-DC-NBR.                 04574123
045742     MOVE XLT00010-LOC-NM          TO TL2-DC-NAME.                04574229
045743     MOVE PV-DC-TOTAL-TRIPS        TO TL2-TOTAL-TRIPS.            04574329
045744     MOVE PV-DC-P2L-CARTONS        TO TL2-TOTAL-P2L-CRTNS.        04574429
045745     MOVE PV-DC-CLOSE-AFTER-DIVERT TO TL2-TOTAL-CLOSED-AFT.       04574529
045746     MOVE PV-CLOSED-DIVERT-PCNT    TO TL2-PCNT-CLOSED-AFT.        04574629
045747                                                                  04574729
045748     ADD PV-DC-TOTAL-TRIPS         TO  PV-CORP-TOTAL-TRIPS.       04574829
045749     ADD PV-DC-P2L-CARTONS         TO  PV-CORP-P2L-CARTONS.       04574929
045750     ADD PV-DC-CLOSE-AFTER-DIVERT  TO  PV-CORP-CLOSE-AFTER-DIVERT.04575029
045751                                                                  04575129
045752     WRITE REPORT-RECORD                                          04575229
045753       FROM TOTAL-LINE2                                           04575329
045754         AFTER ADVANCING 2 LINES.                                 04575429
045755                                                                  04575522
045756                                                                  04575622
045757****************************************************************  04575723
045758* PRINTS CORPORATE TOTAL                                       *  04575823
045759****************************************************************  04575923
045760 5040-PRINT-CORP-TOTALS.                                          04576023
045761                                                                  04576123
045762     MOVE 9999                  TO  HD2-OPER-UNT-ID.              04576223
045763     MOVE 'CORPORATE TOTALS'    TO  HD2-DC-NAME.                  04576323
045764                                                                  04576423
045765     ADD +1                  TO PV-PAGE-COUNT.                    04576530
045766     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               04576630
045767                                                                  04576730
045768     MOVE REPORT-FROM-DATE   TO  HD1A-FROM-DATE.                  04576830
045769     MOVE REPORT-TO-DATE     TO  HD1A-TO-DATE.                    04576930
045770                                                                  04577030
045771     WRITE REPORT-RECORD                                          04577130
045772       FROM DP132O-STANDRD-HEADER-132-COLS                        04577230
045773         AFTER ADVANCING PAGE.                                    04577330
045774                                                                  04577430
045775     WRITE REPORT-RECORD                                          04577530
045776       FROM HEADING-LINE1                                         04577630
045777         AFTER ADVANCING 1 LINES.                                 04577730
045778                                                                  04577830
045779     WRITE REPORT-RECORD                                          04577930
045780       FROM HEADING-LINE1A                                        04578030
045781         AFTER ADVANCING 1 LINES.                                 04578130
045782                                                                  04578230
045783     WRITE REPORT-RECORD                                          04578330
045784       FROM HEADING-LINE2                                         04578430
045785         AFTER ADVANCING 1 LINE.                                  04578530
045786                                                                  04578630
045787     WRITE REPORT-RECORD                                          04578730
045788       FROM HEADING-LINE5                                         04578830
045789         AFTER ADVANCING 2 LINES.                                 04578930
045790                                                                  04579030
045791     WRITE REPORT-RECORD                                          04579130
045792       FROM HEADING-LINE6                                         04579230
045793         AFTER ADVANCING 1 LINES.                                 04579330
045794                                                                  04579430
045795     WRITE REPORT-RECORD                                          04579530
045796       FROM BLANK-LINE                                            04579630
045797         AFTER ADVANCING 1 LINE.                                  04579730
045798                                                                  04579830
045799     MOVE +08                TO PV-LINE-COUNT.                    04579930
045800                                                                  04580030
045801     SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX                   04580123
045802                                                                  04580223
045803*    THIS IS A WIDGET TO FIX THE INDEX SO THAT IT POINTS TO       04580323
045804*    THE LAST VALID LINE IN THE REPORT.                           04580423
045805     SUBTRACT 1 FROM PC-ACTUAL-TABLE-ENTRIES                      04580523
045806                                                                  04580623
045807     PERFORM 5200-SUMMARY-DETAIL                                  04580723
045808             VARYING SPT-INDEX FROM 1 BY 1                        04580823
045809             UNTIL SUMMARY-TABLE-EOF.                             04580928
045810                                                                  04581028
045811     IF  PV-CORP-CLOSE-AFTER-DIVERT  >  0  AND                    04581135
045812         PV-CORP-P2L-CARTONS                                      04581235
045813         DIVIDE  PV-CORP-CLOSE-AFTER-DIVERT                       04581335
045814             BY  PV-CORP-P2L-CARTONS                              04581435
045815         GIVING  PV-CLOSED-DIVERT-WORK                            04581535
045816         MULTIPLY PV-CLOSED-DIVERT-WORK                           04581635
045817               BY 100                                             04581735
045818           GIVING PV-CLOSED-DIVERT-PCNT                           04581835
045819                  ROUNDED                                         04581935
045820     ELSE                                                         04582035
045821         MOVE  ZEROES  TO  PV-CLOSED-DIVERT-WORK                  04582135
045822                           PV-CLOSED-DIVERT-PCNT                  04582235
045823     END-IF.                                                      04582335
045824                                                                  04582426
045825     MOVE ZEROES                       TO  TL3-DC-NBR.            04582530
045826     MOVE 'CORPORATE TOTAL'            TO  TL3-DC-NAME.           04582630
045827     MOVE PV-CORP-TOTAL-TRIPS          TO  TL3-TOTAL-TRIPS.       04582730
045828     MOVE PV-CORP-P2L-CARTONS          TO  TL3-TOTAL-P2L-CRTNS.   04582830
045829     MOVE PV-CORP-CLOSE-AFTER-DIVERT   TO  TL3-TOTAL-CLOSED-AFT.  04582930
045830     MOVE PV-CLOSED-DIVERT-PCNT        TO  TL3-PCNT-CLOSED-AFT.   04583030
045831                                                                  04583123
045832     WRITE REPORT-RECORD                                          04583223
045833       FROM TOTAL-LINE3                                           04583331
045834         AFTER ADVANCING 2 LINES.                                 04583423
045835                                                                  04583523
045836                                                                  04583623
045837 5200-SUMMARY-DETAIL.                                             04583723
045838                                                                  04583823
045839     MOVE SPT-DC-NBR(SPT-INDEX)        TO  TL3-DC-NBR.            04583930
045840     MOVE SPT-DC-NAME(SPT-INDEX)       TO  TL3-DC-NAME.           04584030
045841     MOVE SPT-DC-TOTAL-TRIPS(SPT-INDEX)                           04584123
045842                                       TO  TL3-TOTAL-TRIPS.       04584230
045843     MOVE SPT-DC-P2L-CARTONS(SPT-INDEX)                           04584323
045844                                       TO  TL3-TOTAL-P2L-CRTNS.   04584430
045845     MOVE SPT-DC-CLOSE-AFTER-DIVERT(SPT-INDEX)                    04584523
045846                                       TO  TL3-TOTAL-CLOSED-AFT.  04584630
045847     MOVE SPT-DC-CLOSE-DIVERT-PCNT(SPT-INDEX)                     04584723
045848                                       TO  TL3-PCNT-CLOSED-AFT.   04584830
045849                                                                  04584923
045850     WRITE REPORT-RECORD                                          04585023
045851       FROM TOTAL-LINE3                                           04585131
045852         AFTER ADVANCING 2 LINES.                                 04585223
045853                                                                  04585323
045854     IF SPT-INDEX  =  PC-ACTUAL-TABLE-ENTRIES                     04585428
045855        SET SUMMARY-TABLE-EOF TO TRUE.                            04585528
045856                                                                  04585628
045857                                                                  04585723
045858****************************************************************  04585823
045859* PRINTS A BLANK LINE                                          *  04585923
045860****************************************************************  04586023
045861 6000-PRINT-BLANK-LINE.                                           04586123
045862                                                                  04586223
045863        WRITE REPORT-RECORD                                       04586323
045864          FROM BLANK-LINE                                         04586423
045865            AFTER ADVANCING 1 LINE                                04586523
045866                                                                  04586623
045867     ADD +1 TO PV-LINE-COUNT.                                     04586723
045868                                                                  04586823
045869******************************************************************04586923
045870*  READ A RECORD FROM THE MANIFESTED NOT LOADED FILE             *04587023
045871******************************************************************04587123
045872 7000-READ-EXTRACT-FILE.                                          04587223
045873     READ INPUT-FILE                                              04587323
045874          INTO SU117-EXTRACT-RECORD                               04587423
045875         AT END                                                   04587502
045880             SET PS-END-OF-INPUT TO TRUE                          04588002
045900         NOT AT END                                               04590002
046000             ADD +1 TO PV-READ-COUNT                              04600002
046100     END-READ.                                                    04610002
046200                                                                  04620002
046300*-----------------------------------------------------------------04630002
046400*  READ DATE CONTROL RECORD                                       04640002
046500*-----------------------------------------------------------------04650002
046600 7010-READ-CONTROL-REC.                                           04660002
046700                                                                  04670002
046800     MOVE SPACES  TO  SU032-DATE-CONTROL-REC.                     04680002
046900                                                                  04690002
047000     READ CONTROL-FILE     INTO                                   04700002
047001           SU032-DATE-CONTROL-REC                                 04700102
047002     AT END                                                       04700202
047003         DISPLAY 'PROGRAM:  SUKRP074'                             04700302
047004         DISPLAY 'NO DATE CONTROL CARD'                           04700402
047005         DISPLAY SPACES                                           04700502
047006     NOT AT END                                                   04700602
047007         DISPLAY 'PROGRAM:  SUKRP074'                             04700702
047008         DISPLAY 'DATE CONTROL CARD:'                             04700802
047009                 SU032-DATE-CONTROL-REC                           04700902
047010         DISPLAY SPACES                                           04701002
047011     END-READ.                                                    04701102
047012                                                                  04701202
047263******************************************************************04726302
047264*  WRITE TRAILER TOTAL RECORD                                    *04726402
047265******************************************************************04726502
047266 8020-WRITE-OUTPUT-FILE.                                          04726602
047463                                                                  04746302
047464     WRITE OUTPUT-RECORD                                          04746402
047465          FROM SU135-EXTRACT-RECORD                               04746506
047466     END-WRITE.                                                   04746602
047467     ADD +1 TO PV-WRITE-COUNT.                                    04746702
047468                                                                  04746802
047469******************************************************************04746902
047470 8500-GET-LOCATION-NAME.                                          04747002
047471******************************************************************04747102
047472                                                                  04747202
047473     MOVE PV-SAVE-OPER-UNT-ID  TO  XLT00010-LOC-NBR               04747302
047474                                   PV-DISPLAY-OPER.               04747402
047475                                                                  04747502
047476     EXEC SQL                                                     04747602
047477         SELECT   LOC_NM                                          04747702
047478           INTO  :XLT00010-LOC-NM                                 04747802
047479           FROM   XLT_LOC                                         04747902
047480          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   04748002
047490     END-EXEC.                                                    04749002
047500                                                                  04750002
047600     EVALUATE TRUE                                                04760002
047700         WHEN SQLCODE = +0                                        04770002
047800              MOVE PV-SAVE-OPER-UNT-ID TO HD2-OPER-UNT-ID         04780002
047900              MOVE XLT00010-LOC-NM     TO HD2-DC-NAME             04790002
048000         WHEN OTHER                                               04800002
048100              CONTINUE                                            04810002
048200     END-EVALUATE.                                                04820002
048300                                                                  04830002
048301                                                                  04830109
048310 8600-GET-STORE-NAME.                                             04831009
048320     MOVE SU117-STORE-DEST     TO  XLT00010-LOC-NBR               04832009
048340                                                                  04834009
048350     EXEC SQL                                                     04835009
048360         SELECT   LOC_NM                                          04836009
048370           INTO  :PV-STORE-NAME                                   04837009
048380           FROM   XLT_LOC                                         04838009
048390          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   04839009
048391     END-EXEC.                                                    04839109
048392                                                                  04839209
048393     EVALUATE TRUE                                                04839309
048394         WHEN SQLCODE = +0                                        04839409
048395              CONTINUE                                            04839509
048397         WHEN OTHER                                               04839709
048398              CONTINUE                                            04839809
048399     END-EVALUATE.                                                04839909
048400                                                                  04840009
048401                                                                  04840109
048410******************************************************************04841002
048500*  ABEND ROUTINE                                                 *04850002
048600******************************************************************04860002
048700 9900-DB2-ABEND.                                                  04870002
048800                                                                  04880002
048900     MOVE SQLCODE TO PV-SQLCODE.                                  04890002
049000     DISPLAY '*** DB2 ERROR '.                                    04900002
049100     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       04910002
049200     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 04920002
049300     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               04930002
049400     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               04940002
049500     DISPLAY '*** FUNCTION  = ' PV-DB2-FUNCTION.                  04950008
049700     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                04970008
049900                                                                  04990002
050000     COPY DPPD004.                                                05000002
050100                                                                  05010002
050200     MOVE +4013 TO PV-ABEND-CODE.                                 05020002
050300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05030002
050400                                                                  05040002
050410 9998-ABEND.                                                      05041024
050420                                                                  05042024
050430     DISPLAY '***************'.                                   05043024
050440     DISPLAY '** ABEND     **'.                                   05044024
050450     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               05045024
050460     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             05046024
050470     DISPLAY '***************'.                                   05047024
050480                                                                  05048024
050490     MOVE +4008                  TO PV-ABEND-CODE.                05049024
050491     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05049124
050492                                                                  05049224
050500 9999-ABEND.                                                      05050002
050600                                                                  05060002
050700     DISPLAY '***************'.                                   05070002
050800     DISPLAY '** ABEND     **'.                                   05080002
050900     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               05090002
051000     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             05100002
051100     DISPLAY '***************'.                                   05110002
051200                                                                  05120002
051300     MOVE +4008                  TO PV-ABEND-CODE.                05130002
051400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05140002
051500                                                                  05150002
051600******************************************************************05160002
051700*                 E N D   O F   P R O G R A M                    *05170002
051800******************************************************************05180002
