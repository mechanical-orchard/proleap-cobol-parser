000100 IDENTIFICATION DIVISION.                                         00010021
000200 PROGRAM-ID.    APKUT001.                                         00020021
000300 AUTHOR.        JILL JUEL.                                        00030021
000400 DATE-WRITTEN.  APRIL 2000.                                       00040021
000500 DATE-COMPILED.                                                   00050021
000600***************************************************************** 00060021
000700*         TRANS INTERNATIONAL FREIGHT FTP PROGRAM               * 00070021
000800***************************************************************** 00080021
000900*    COBOL II                                                   * 00090021
001000***************************************************************** 00100021
001100*                                                               * 00110021
001200*    THE PURPOSE OF THIS PROGRAM IS TO CREATE A FILE TO BE      * 00120021
001300*    FTP'D TO THE LAN FOR THE TRANSPORTATION DEPARTMENT.        * 00130021
001400*                                                               * 00140021
001500*    INPUT:  TRANS INTERNATIONAL FILE      LRECL 273   APRD023  * 00150036
001600*    OUTPUT: TRANS INTERNATIONAL FTP FILE  LRECL 340   APRD025  * 00160036
001700***************************************************************** 00170021
001800* CHANGE RECORD:                                                * 00180021
001900*                                                               * 00190021
002000* 10/23/2000                                                    * 00200021
002100*      ADDED CODE TO CHECK FOR COMMAS IN CHARACTER FIELDS AND   * 00210021
002200*      REPLACE THEM WITH SPACES. THE PROGRAM IS CREATING A      * 00220021
002300*      COMMA DELIMITED FIELD, THE EXTRA COMMAS ARE CAUSING THE  * 00230021
002400*      DATA TO BE PLACED IN THE WRONG FIELDS.                   * 00240021
002500* MADE BY: JILL JUEL                             WR#20704       * 00250021
002600*                                                               * 00260021
002700* 05/01/2001                                                    * 00270021
002800*      ADDED 16 BYTES TO INPUT FILE (FREIGHT-FILE) RECORD       * 00280021
002900*      LENGTH.  THIS WILL ALLOW FOR RECEIPT OF ADDITIONAL       * 00290021
003000*      INFO ON THE WEEKLY FILE TRANSMITTED FROM TRANS INTL.     * 00300021
003100*      ADDED SHIP DATE AND DELIVERY DATE FIELDS TO THE MOVES    * 00310021
003200*      FOR THE FTP FILE.                                        * 00320021
003300* MADE BY: KEVIN CATLIN                          WR# 22119      * 00330021
003400*                                                               * 00340021
003500* DATE  03/27/2003                                              * 00350032
003600*     CHANGE MADE: EXPAND THE LRECL ON INPUT FILE TO 263 AND    * 00360027
003700*     THE OUTPUT FILE TO 333.  ADD THE NEW COMMA FIELDS TO THE  * 00370027
003800*     LIST OF FIELDS HAVING A LITERAL COMMA MOVED TO THEM IN    * 00380022
003900*     PARA B100.  ADDED LOGIC TO MOVE THE CARRIER AUTH NUMBER   * 00390022
004000*     AND RECV-UNT-QTY FROM INPUT TO OUTPUT FILE IN PARA B200.  * 00400027
004100*     FROM INPUT TO OUTPUT FILE IN PARA B200.                   * 00410027
004200*     MADE BY: KEVIN CATLIN            WR/IR #: WR24278         * 00420022
004300*                                                               * 00430022
004400* DATE  03/31/2004                                              * 00440033
004500*     CHANGE MADE: EXPANDED THE LRECL ON THE OUTPUT FILE TO 334.* 00450033
004600*     AND THE LRECL ON THE INPUT FILE TO 264.                   * 00460034
004700*     MADE BY: MIKE BESKE              WR/IR #: WR25805         * 00470033
004800*                                                               * 00480033
004810* DATE  01/11/2011                                              * 00481040
004820*     CHANGE MADE: IMPORT REPLENISHMENT PROJECT.  INCREASED     * 00482037
004821*     THE INPUT FILE LENGTH FOR THE FREIGHT-FILE FROM 264 TO    * 00482137
004822*     273 AS WELL AS OUTPUT FILE LENGTH FOR FREIGHT-FTP-FILE    * 00482237
004823*     FROM 334 TO 340.  CHANGES WERE ALSO MADE IN THE FOLLOWING * 00482337
004824*     PARAGRAPHS TO INCORPORATE THE NEW TRIP ID FIELD; B100-    * 00482438
004825*     AND B200-.                                                * 00482537
004830*                                                               * 00483036
004840*     MADE BY: ROLF NOHE               WR/IR #: WR38804         * 00484037
004850*                                                               * 00485036
004900***************************************************************** 00490021
005000 ENVIRONMENT DIVISION.                                            00500021
005100                                                                  00510021
005200 INPUT-OUTPUT SECTION.                                            00520021
005300 FILE-CONTROL.                                                    00530021
005400                                                                  00540021
005500     SELECT FREIGHT-FILE         ASSIGN TO UT-S-INP01.            00550021
005600     SELECT FREIGHT-FTP-FILE     ASSIGN TO UT-S-OUT01.            00560021
005700 EJECT                                                            00570021
005800 DATA DIVISION.                                                   00580021
005900                                                                  00590021
006000 FILE SECTION.                                                    00600021
006100                                                                  00610021
006200 FD  FREIGHT-FILE                                                 00620021
006300     LABEL RECORDS ARE OMITTED                                    00630021
006400     RECORDING MODE IS F                                          00640021
006500     RECORD CONTAINS 273 CHARACTERS                               00650036
006600     BLOCK CONTAINS 0 RECORDS.                                    00660021
006700 01  FREIGHT-RECORD                 PIC X(273).                   00670036
006800                                                                  00680021
006900 FD  FREIGHT-FTP-FILE                                             00690021
007000     LABEL RECORDS ARE STANDARD                                   00700021
007100     RECORDING MODE IS F                                          00710021
007200     BLOCK CONTAINS 0 RECORDS.                                    00720021
007300 01  FREIGHT-FTP-RECORD.                                          00730021
007400     05  FILLER                     PIC  X(340).                  00740036
007500 EJECT                                                            00750021
007600                                                                  00760021
007700 WORKING-STORAGE SECTION.                                         00770021
007800                                                                  00780021
007900 01  PROGRAM-COUNTERS.                                            00790021
008000     05  FREIGHT-RECORDS-IN         PIC S9(09) COMP-3 VALUE +0.   00800021
008100     05  FREIGHT-RECORDS-OUT        PIC S9(09) COMP-3 VALUE +0.   00810021
008200     05  FREIGHT-TOTAL-RECORD       PIC S9(09) COMP-3 VALUE +0.   00820021
008300     05  PRT-FREIGHT-RECORDS-IN     PIC  Z(09) VALUE ZERO.        00830021
008400     05  PRT-FREIGHT-RECORDS-OUT    PIC  Z(09) VALUE ZERO.        00840021
008500     05  PRT-FREIGHT-TOTAL-RECORD   PIC  Z(09) VALUE ZERO.        00850021
008600                                                                  00860021
008700 01  PROGRAM-SWITCHES.                                            00870021
008800     05  PS-FREIGHT-EOF-SW          PIC X  VALUE 'N'.             00880021
008900         88  PROCESSING-FREIGHT            VALUE 'N'.             00890021
009000         88  FREIGHT-EOF                   VALUE 'Y'.             00900021
009100                                                                  00910021
009200 01  PROGRAM-CONSTANTS.                                           00920021
009300     05  PC-PROGRAM-NAME            PIC X(08) VALUE 'APKUT001'.   00930021
009400                                                                  00940026
009500*--------------------------------------------------------------*  00950021
009600*  RECORD LAYOUT FOR TRANS INTERNATION FREIGHT FILE            *  00960021
009700*--------------------------------------------------------------*  00970021
009800     COPY APRD023.                                                00980021
009900 EJECT                                                            00990021
010000                                                                  01000021
010100*--------------------------------------------------------------*  01010021
010200*  RECORD LAYOUT FOR TRANS INTERNATION FTP FREIGHT FILE        *  01020021
010300*--------------------------------------------------------------*  01030021
010400     COPY APRD025.                                                01040021
010500 EJECT                                                            01050021
010600                                                                  01060021
010700************************                                          01070021
010800 PROCEDURE DIVISION.                                              01080021
010900************************                                          01090021
011000 A100-MAINLINE-ROUTINE.                                           01100021
011100                                                                  01110026
011200     PERFORM B100-INITIALIZATION.                                 01120021
011300                                                                  01130021
011400     PERFORM B200-CREATE-FTP-FILE                                 01140021
011500         UNTIL  FREIGHT-EOF.                                      01150021
011600                                                                  01160021
011700     PERFORM B300-TERMINATION.                                    01170021
011800     GOBACK.                                                      01180021
011900                                                                  01190021
012000                                                                  01200026
012100*--------------------------------------------------------------*  01210021
012200*    INITIALIZATION PROCESSING                                 *  01220021
012300*--------------------------------------------------------------*  01230021
012400 B100-INITIALIZATION.                                             01240021
012500                                                                  01250021
012600     DISPLAY '*------------ PROGRAM:  APKUT001 ------------*'     01260021
012700     DISPLAY '  RUN DATE = ' FUNCTION CURRENT-DATE(1:8)           01270021
012800             '  RUN TIME = ' FUNCTION CURRENT-DATE(9:6)           01280021
012900                                                                  01290021
013000     OPEN INPUT FREIGHT-FILE                                      01300021
013100         OUTPUT FREIGHT-FTP-FILE.                                 01310021
013200                                                                  01320021
013300     INITIALIZE AP025-FTP-FREIGHT-RECORD.                         01330021
013400                                                                  01340021
013500     MOVE ',' TO AP025-COMMA-1  AP025-COMMA-2  AP025-COMMA-3      01350021
013600                 AP025-COMMA-4  AP025-COMMA-5  AP025-COMMA-6      01360021
013700                 AP025-COMMA-7  AP025-COMMA-8  AP025-COMMA-9      01370021
013800                 AP025-COMMA-10 AP025-COMMA-11 AP025-COMMA-12     01380021
013900                 AP025-COMMA-13 AP025-COMMA-14 AP025-COMMA-15     01390021
014000                 AP025-COMMA-16 AP025-COMMA-17 AP025-COMMA-18     01400021
014100                 AP025-COMMA-19 AP025-COMMA-20 AP025-COMMA-21     01410021
014200                 AP025-COMMA-22 AP025-COMMA-23 AP025-COMMA-24     01420021
014300                 AP025-COMMA-25 AP025-COMMA-26 AP025-COMMA-27     01430021
014400                 AP025-COMMA-28 AP025-COMMA-29 AP025-COMMA-30     01440021
014500                 AP025-COMMA-31 AP025-COMMA-32 AP025-COMMA-33     01450022
014600                 AP025-COMMA-34 AP025-COMMA-35 AP025-COMMA-36.    01460036
014700                                                                  01470021
014800     PERFORM R100-READ-FREIGHT-FILE.                              01480021
014900 EJECT                                                            01490021
015000                                                                  01500021
015100*--------------------------------------------------------------*  01510021
015200*  THIS ROUTINE WILL CREATE THE FTP FREIGHT FILE.              *  01520021
015300*--------------------------------------------------------------*  01530021
015400 B200-CREATE-FTP-FILE.                                            01540021
015500                                                                  01550021
015600     IF AP023-TOTAL-INDICATOR = '***************'                 01560021
015700         ADD 1 TO FREIGHT-TOTAL-RECORD                            01570021
015800     ELSE                                                         01580021
015900         MOVE AP023-FR-PRODBILL       TO AP025-FR-PRODBILL        01590021
016000         INSPECT AP025-FR-PRODBILL    REPLACING ALL ',' BY ' '    01600021
016100         MOVE AP023-FR-PRO-DATE       TO AP025-FR-PRO-DATE        01610021
016200         INSPECT AP025-FR-PRO-DATE    REPLACING ALL ',' BY ' '    01620021
016300         MOVE AP023-FR-CARRIER-NAME   TO AP025-FR-CARRIER-NAME    01630021
016400         INSPECT AP025-FR-CARRIER-NAME REPLACING ALL ',' BY ' '   01640021
016500         MOVE AP023-FR-SCAC-CODE      TO AP025-FR-SCAC-CODE       01650021
016600         INSPECT AP025-FR-SCAC-CODE   REPLACING ALL ',' BY ' '    01660021
016700         MOVE AP023-FR-BOL-NO         TO AP025-FR-BOL-NO          01670021
016800         INSPECT AP025-FR-BOL-NO      REPLACING ALL ',' BY ' '    01680021
016900         MOVE AP023-FR-CORR-AMT       TO AP025-FR-CORR-AMT        01690021
017000         MOVE AP023-FR-AMT-PAID       TO AP025-FR-AMT-PAID        01700021
017100         MOVE AP023-FR-VEND-NAME      TO AP025-FR-VEND-NAME       01710021
017200         INSPECT AP025-FR-VEND-NAME   REPLACING ALL ',' BY ' '    01720021
017300         MOVE AP023-FR-ORIG-ZIP       TO AP025-FR-ORIG-ZIP        01730021
017400         INSPECT AP025-FR-ORIG-ZIP    REPLACING ALL ',' BY ' '    01740021
017500         MOVE AP023-FR-ORIG           TO AP025-FR-ORIG            01750021
017600         INSPECT AP025-FR-ORIG        REPLACING ALL ',' BY ' '    01760021
017700         MOVE AP023-FR-DEST-ZIP       TO AP025-FR-DEST-ZIP        01770021
017800         INSPECT AP025-FR-DEST-ZIP    REPLACING ALL ',' BY ' '    01780021
017900         MOVE AP023-FR-DEST           TO AP025-FR-DEST            01790021
018000         INSPECT AP025-FR-DEST        REPLACING ALL ',' BY ' '    01800021
018100         MOVE AP023-FR-PIECES         TO AP025-FR-PIECES          01810021
018200         MOVE AP023-FR-WEIGHT         TO AP025-FR-WEIGHT          01820021
018300         MOVE AP023-FR-RECVD-DATE     TO AP025-FR-RECVD-DATE      01830021
018400         INSPECT AP025-FR-RECVD-DATE  REPLACING ALL ',' BY ' '    01840021
018500         MOVE AP023-FR-DEPT           TO AP025-FR-DEPT            01850021
018600         INSPECT AP025-FR-DEPT        REPLACING ALL ',' BY ' '    01860021
018700         MOVE AP023-FR-CLASSNO        TO AP025-FR-CLASSNO         01870021
018800         INSPECT AP025-FR-CLASSNO     REPLACING ALL ',' BY ' '    01880021
018900         MOVE AP023-FR-KEYREC         TO AP025-FR-KEYREC          01890021
019000         INSPECT AP025-FR-KEYREC      REPLACING ALL ',' BY ' '    01900022
019100         MOVE AP023-FR-PO-NBR         TO AP025-FR-PO-NBR          01910021
019200         INSPECT AP025-FR-PO-NBR      REPLACING ALL ',' BY ' '    01920021
019300         MOVE AP023-FR-P-C-T          TO AP025-FR-P-C-T           01930021
019400         INSPECT AP025-FR-P-C-T       REPLACING ALL ',' BY ' '    01940021
019500         MOVE AP023-REC-SEQ-NBR       TO AP025-REC-SEQ-NBR        01950021
019600         MOVE AP023-FR-STORE-NBR      TO AP025-FR-STORE-NBR       01960021
019700         INSPECT AP025-FR-STORE-NBR   REPLACING ALL ',' BY ' '    01970021
019800         MOVE AP023-FR-ENTRY-DATE     TO AP025-FR-ENTRY-DATE      01980021
019900         INSPECT AP025-FR-ENTRY-DATE  REPLACING ALL ',' BY ' '    01990021
020000         MOVE AP023-FR-CHECK-NBR      TO AP025-FR-CHECK-NBR       02000021
020100         INSPECT AP025-FR-CHECK-NBR   REPLACING ALL ',' BY ' '    02010021
020200         MOVE AP023-FR-BANK-NBR       TO AP025-FR-BANK-NBR        02020021
020300         INSPECT AP025-FR-BANK-NBR    REPLACING ALL ',' BY ' '    02030021
020400         MOVE AP023-FR-CHECK-DATE     TO AP025-FR-CHECK-DATE      02040021
020500         INSPECT AP025-FR-CHECK-DATE  REPLACING ALL ',' BY ' '    02050021
020600         MOVE AP023-FR-ENTRY-CODE     TO AP025-FR-ENTRY-CODE      02060021
020700         INSPECT AP025-FR-ENTRY-CODE  REPLACING ALL ',' BY ' '    02070021
020800         MOVE AP023-FR-AUDITOR        TO AP025-FR-AUDITOR         02080021
020900         INSPECT AP025-FR-AUDITOR     REPLACING ALL ',' BY ' '    02090021
021000         MOVE AP023-FR-TRANS-MODE     TO AP025-FR-TRANS-MODE      02100021
021100         INSPECT AP025-FR-TRANS-MODE  REPLACING ALL ',' BY ' '    02110021
021200         MOVE AP023-FR-BATCH-NO       TO AP025-FR-BATCH-NO        02120021
021300         INSPECT AP025-FR-BATCH-NO    REPLACING ALL ',' BY ' '    02130021
021400         MOVE AP023-FR-OPER1          TO AP025-FR-OPER1           02140021
021500         INSPECT AP025-FR-OPER1       REPLACING ALL ',' BY ' '    02150021
021600         MOVE AP023-FR-OPER2          TO AP025-FR-OPER2           02160021
021700         INSPECT AP025-FR-OPER2       REPLACING ALL ',' BY ' '    02170021
021800         MOVE AP023-FR-SHIP-DATE      TO AP025-FR-SHIP-DATE       02180021
021900         INSPECT AP025-FR-SHIP-DATE   REPLACING ALL ',' BY ' '    02190021
022000         MOVE AP023-FR-DELIV-DATE     TO AP025-FR-DELIV-DATE      02200021
022100         INSPECT AP025-FR-DELIV-DATE  REPLACING ALL ',' BY ' '    02210021
022200         MOVE AP023-CARRIER-AUTH-NBR  TO AP025-CARRIER-AUTH-NBR   02220022
022300         INSPECT AP025-CARRIER-AUTH-NBR  REPLACING ALL ',' BY ' ' 02230022
022400         MOVE AP023-RECV-UNT-QTY      TO AP025-RECV-UNT-QTY       02240028
022410         MOVE AP023-FR-TRIP-ID        TO AP025-FR-TRIP-ID         02241036
022420         INSPECT AP025-FR-TRIP-ID     REPLACING ALL ',' BY ' '    02242036
022500         PERFORM W100-WRITE-FREIGHT-RECORD                        02250021
022600     END-IF.                                                      02260021
022700                                                                  02270021
022800     PERFORM R100-READ-FREIGHT-FILE.                              02280021
022900 EJECT                                                            02290021
023000                                                                  02300021
023100*---------------------------------------------------------------* 02310021
023200*  END OF PROGRAM PROCESSING:                                   * 02320021
023300*---------------------------------------------------------------* 02330021
023400 B300-TERMINATION.                                                02340021
023500                                                                  02350021
023600     MOVE FREIGHT-RECORDS-IN   TO PRT-FREIGHT-RECORDS-IN.         02360021
023700     MOVE FREIGHT-RECORDS-OUT  TO PRT-FREIGHT-RECORDS-OUT.        02370021
023800     MOVE FREIGHT-TOTAL-RECORD TO PRT-FREIGHT-TOTAL-RECORD.       02380021
023900     DISPLAY '************************************************'.  02390021
024000     DISPLAY '****              APKUT001                  ****'.  02400021
024100     DISPLAY '************************************************'.  02410021
024200     DISPLAY 'FREIGHT RECORDS IN   = ' PRT-FREIGHT-RECORDS-IN.    02420021
024300     DISPLAY 'FREIGHT RECORDS OUT  = ' PRT-FREIGHT-RECORDS-OUT.   02430021
024400     DISPLAY 'FREIGHT TOTAL RECORD = ' PRT-FREIGHT-TOTAL-RECORD.  02440021
024500     DISPLAY '************************************************'.  02450021
024600     DISPLAY '************************************************'.  02460021
024700                                                                  02470021
024800     CLOSE FREIGHT-FILE                                           02480021
024900           FREIGHT-FTP-FILE.                                      02490021
025000 EJECT                                                            02500021
025100                                                                  02510021
025200                                                                  02520021
025300*--------------------------------------------------------------*  02530021
025400*  READS THE TRANS INTERNATIONAL FILE                          *  02540021
025500*--------------------------------------------------------------*  02550021
025600 R100-READ-FREIGHT-FILE.                                          02560021
025700                                                                  02570026
025800     READ FREIGHT-FILE INTO AP023-FREIGHT-RECORD                  02580021
025900        AT END                                                    02590021
026000            SET FREIGHT-EOF TO TRUE                               02600021
026100        NOT AT END                                                02610021
026200            ADD 1 TO FREIGHT-RECORDS-IN                           02620021
026300     END-READ.                                                    02630021
026400 EJECT                                                            02640021
026500                                                                  02650021
026600*--------------------------------------------------------------*  02660021
026700*  WRITES THE REPORT HEADERS                                   *  02670021
026800*--------------------------------------------------------------*  02680021
026900 W100-WRITE-FREIGHT-RECORD.                                       02690021
027000                                                                  02700021
027100     ADD 1 TO FREIGHT-RECORDS-OUT.                                02710021
027200                                                                  02720026
027300     WRITE FREIGHT-FTP-RECORD FROM AP025-FTP-FREIGHT-RECORD.      02730021
027400                                                                  02740021
027500 EJECT                                                            02750021
027600                                                                  02760021
