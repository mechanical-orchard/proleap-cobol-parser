000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKUP007.                                         00050000
000600 AUTHOR.        MIKE FRIESS.                                      00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN   NOVEMBER, 2000.                                   00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM CREATES THE 'CMN' TRANSMISSION FILE FROM CONTAINER00120000
001300*  TABLES. IT EXTRACTS A FILE TO A WORK TABLE TO BE TRANSMITTED   00130000
001400*  AS IMPORT DC SPLIT INFORMATION TO THE DECONSOLIDATOR. TWO ERROR00140000
001500*  REPORTS AND A DETAIL REPORT ARE ALSO WRITTEN TO A WORK TABLE.  00150000
001600******************************************************************00160000
001700* MM/DD/YYYY WHO & WHAT                                           00170000
001800* ---------- -----------------------------------------------------00180000
001900* 03/10/2010 FRANK WALA                                           00190000
002000*    REPLACE HARD-CODED EFC NUMBER 870 WITH XLT_LOC TABLE TO CHECK00200000
002100*    THE E_BUS_IND IN PARA 2410.                                  00210000
002200*    PARA 2440 WAS FLAGGED AS DEAD CODE - COMMENTED IT OUT.       00220000
002300*                                                                 00230000
002400******************************************************************00240000
002410* 08/05/2011 MIKE FRIESS                                          00250000
002411*    CRQ 7853                                                     00260001
002420*    ALLOW EC PO TYPES - SEE 'DECLARE CMN_DRIVER_CUR'.            00270000
002450*                                                                 00280000
002460******************************************************************00290000
002500 ENVIRONMENT DIVISION.                                            00300000
002600******************************************************************00310000
002700                                                                  00320000
002800 CONFIGURATION SECTION.                                           00330000
002900                                                                  00340000
003000 SOURCE-COMPUTER.        IBM-3090.                                00350000
003100 OBJECT-COMPUTER.        IBM-3090.                                00360000
003200                                                                  00370000
003300 INPUT-OUTPUT SECTION.                                            00380000
003400                                                                  00390000
003500 FILE-CONTROL.                                                    00400000
003600                                                                  00410000
003700******************************************************************00420000
003800 DATA DIVISION.                                                   00430000
003900******************************************************************00440000
004000                                                                  00450000
004100 FILE SECTION.                                                    00460000
004200                                                                  00470000
004300******************************************************************00480000
004400 WORKING-STORAGE SECTION.                                         00490000
004500******************************************************************00500000
004600*                                                                 00510000
004700*                                                                 00520000
004800******************************************************************00530000
004900*  DB2 FORMATTED MESSAGE AREA                                     00540000
005000******************************************************************00550000
005100     COPY DPWS004.                                                00560000
005200*                                                                 00570000
005300******************************************************************00580000
005400*  COMMUNICATIONS AREA FOR DB2                                    00590000
005500******************************************************************00600000
005600     EXEC SQL                                                     00610000
005700          INCLUDE SQLCA                                           00620000
005800     END-EXEC.                                                    00630000
005900*                                                                 00640000
006000******************************************************************00650000
006100*  DB2 TABLE DECLARATION - IMPORTS CONTAINER UPC                  00660000
006200******************************************************************00670000
006300     EXEC SQL                                                     00680000
006400          INCLUDE TIMCNUP                                         00690000
006500     END-EXEC.                                                    00700000
006600*                                                                 00710000
006700******************************************************************00720000
006800*  DB2 TABLE DECLARATION - IMPORTS CONTAINER                      00730000
006900******************************************************************00740000
007000     EXEC SQL                                                     00750000
007100          INCLUDE TIMCNTK                                         00760000
007200     END-EXEC.                                                    00770000
007300*                                                                 00780000
007400******************************************************************00790000
007500*  DB2 TABLE DECLARATION - UPC SKU TABLE                          00800000
007600******************************************************************00810000
007700     EXEC SQL                                                     00820000
007800          INCLUDE TUPCSKU                                         00830000
007900     END-EXEC.                                                    00840000
008000*                                                                 00850000
008100******************************************************************00860000
008200*  DB2 TABLE DECLARATION - UPC TABLE                              00870000
008300******************************************************************00880000
008400     EXEC SQL                                                     00890000
008500          INCLUDE TUPC                                            00900000
008600     END-EXEC.                                                    00910000
008700*                                                                 00920000
008800******************************************************************00930000
008900*  DB2 TABLE DECLARATION - SHIPMENT TABLE (TSHIPMT)               00940000
009000******************************************************************00950000
009100     EXEC SQL                                                     00960000
009200          INCLUDE TSHIPMT                                         00970000
009300     END-EXEC.                                                    00980000
009400*                                                                 00990000
009500******************************************************************01000000
009600*  DB2 TABLE DECLARATION - SHIPMENT TO PURCHASE ORDER ASSOCIATION 01010000
009700*      TABLE (TSHPTPO)                                            01020000
009800******************************************************************01030000
009900     EXEC SQL                                                     01040000
010000          INCLUDE TSHPTPO                                         01050000
010100     END-EXEC.                                                    01060000
010200*                                                                 01070000
010201**** PRB0040279 MJF 03/20/2013 START                              01080016
010202****    ADD TABLES TSHIPST AND TSHSTYP TO SELECT SO THAT DELETED  01090009
010203****    SHIPMENTS ARE BYPASSED.                                   01100009
010210******************************************************************01110009
010220*  DB2 TABLE DECLARATION - SHIPMENT STATUS                        01120009
010230*      TABLE (TSHIPST)                                            01130009
010240******************************************************************01140009
010250     EXEC SQL                                                     01150009
010260          INCLUDE TSHIPST                                         01160009
010270     END-EXEC.                                                    01170009
010280*                                                                 01180009
010290******************************************************************01190009
010291*  DB2 TABLE DECLARATION - SHIPMENT STATUS TYPE                   01200009
010292*      TABLE (TSHSTYP)                                            01210009
010293******************************************************************01220009
010294     EXEC SQL                                                     01230009
010295          INCLUDE TSHSTYP                                         01240009
010296     END-EXEC.                                                    01250009
010297*                                                                 01260009
010298**** PRB0040279 MJF 03/20/2013 END                                01270016
010300******************************************************************01280000
010400*  DB2 TABLE DECLARATION - PURCHASE ORDER PLANNED SHIPMENT        01290000
010500*      TABLE  (TPLNSHP)                                           01300000
010600******************************************************************01310000
010700     EXEC SQL                                                     01320000
010800          INCLUDE TPLNSHP                                         01330000
010900     END-EXEC.                                                    01340000
011000*                                                                 01350000
011100******************************************************************01360000
011200*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)01370000
011300******************************************************************01380000
011400     EXEC SQL                                                     01390000
011500          INCLUDE TPURCHS                                         01400000
011600     END-EXEC.                                                    01410000
011700*                                                                 01420000
011800******************************************************************01430000
011900*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE ITEM TABLE     01440000
012000*      (TPURITM)                                                  01450000
012100******************************************************************01460000
012200     EXEC SQL                                                     01470000
012300          INCLUDE TPURITM                                         01480000
012400     END-EXEC.                                                    01490000
012500*                                                                 01500000
012600*************************************************************     01510000
012700*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01520000
012800*************************************************************     01530000
012900     EXEC SQL                                                     01540000
013000          INCLUDE XLT00003                                        01550000
013100     END-EXEC.                                                    01560000
013200*                                                                 01570000
013300*************************************************************     01580000
013400*  DB2 TABLE DECLARATION - PURCHASE ITEM REPLICA TABLE            01590000
013500*************************************************************     01600000
013600     EXEC SQL                                                     01610000
013700          INCLUDE XLT00004                                        01620000
013800     END-EXEC.                                                    01630000
013900******************************************************************01640000
014000*  DB2 TABLE DECLARATION - IMPORT CONTAINER SPLITS RELEASE TABLE  01650000
014100******************************************************************01660000
014200     EXEC SQL                                                     01670000
014300          INCLUDE TIMCNRL                                         01680000
014400     END-EXEC.                                                    01690000
014500*                                                                 01700000
014600******************************************************************01710000
014700*  DB2 TABLE DECLARATION - IMPORT CONTAINER SPLITS RELEASE AUDIT  01720000
014800******************************************************************01730000
014900     EXEC SQL                                                     01740000
015000          INCLUDE TAUCNRL                                         01750000
015100     END-EXEC.                                                    01760000
015200*                                                                 01770000
015300******************************************************************01780000
015400*  DB2 TABLE DECLARATION - PURCHASE ORDER ALLOCATION PLAN TABLE   01790000
015500*      (TALLPLN)                                                  01800000
015600******************************************************************01810000
015700     EXEC SQL                                                     01820000
015800          INCLUDE TALLPLN                                         01830000
015900     END-EXEC.                                                    01840000
016000*                                                                 01850000
139868******************************************************************01860099
139868*  DB2 TABLE DECLARATION - PURCHASE ORDER STORE ALLOCATION TABLE  01870099
139868*      (TMESTDS)                                                  01880099
139868******************************************************************01890099
139868     EXEC SQL                                                     01900099
139868          INCLUDE TMESTDS                                         01910099
139868     END-EXEC.                                                    01920099
139868*                                                                 01930099
016100******************************************************************01940000
016200*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME TABLE         01950000
016300*      (TENTNME)                                                  01960000
016400******************************************************************01970000
016500     EXEC SQL                                                     01980000
016600          INCLUDE TENTNME                                         01990000
016700     END-EXEC.                                                    02000000
016800*                                                                 02010000
016900******************************************************************02020000
017000*  DB2 TABLE DECLARATION - PURCHASE ORDER INSTRUCTION CODES TABLE 02030000
017100*      (TINSTCD)                                                  02040000
017200******************************************************************02050000
017300     EXEC SQL                                                     02060000
017400          INCLUDE TINSTCD                                         02070000
017500     END-EXEC.                                                    02080000
017600*                                                                 02090000
017700******************************************************************02100000
017800*  DB2 TABLE DECLARATION - PURCHASE INSTRUCTION TABLE (TPOINST)   02110000
017900******************************************************************02120000
018000     EXEC SQL                                                     02130000
018100          INCLUDE TPOINST                                         02140000
018200     END-EXEC.                                                    02150000
018300                                                                  02160000
018400******************************************************************02170000
018500*  DB2 TABLE DECLARATION - SKU TABLE (TSKXREF)                    02180000
018600******************************************************************02190000
018700     EXEC SQL                                                     02200000
018800          INCLUDE TSKXREF                                         02210000
018900     END-EXEC.                                                    02220000
019000******************************************************************02230000
019100*  DB2 TABLE DECLARATION - PO PREPACK TABLE       (TPOPRPK)       02240000
019200******************************************************************02250000
019300     EXEC SQL                                                     02260000
019400          INCLUDE TPOPRPK                                         02270000
019500     END-EXEC.                                                    02280000
019600******************************************************************02290000
019700*  DB2 TABLE DECLARATION - PO TABLE             (TOUTTR2)         02300000
019800******************************************************************02310000
019900     EXEC SQL                                                     02320000
020000          INCLUDE TOUTTR2                                         02330000
020100     END-EXEC.                                                    02340000
020200******************************************************************02350000
020300*  DB2 TABLE DECLARATION - ERROR RPT TABLE       (TOUTTR3)        02360000
020400******************************************************************02370000
020500     EXEC SQL                                                     02380000
020600          INCLUDE TOUTTR3                                         02390000
020700     END-EXEC.                                                    02400000
020800******************************************************************02410000
020900*  DB2 TABLE DECLARATION - DETAIL RPT TABLE      (TOUTTR4)        02420000
021000******************************************************************02430000
021100     EXEC SQL                                                     02440000
021200          INCLUDE TOUTTR4                                         02450000
021300     END-EXEC.                                                    02460000
021400******************************************************************02470000
021500*  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 02480000
021600*  THIS TABLE IS USED TO STORE WORKING STOREAGE INFORMATION FOR   02490000
021700*  CHECKPOINT RESTARTS.                                           02500000
021800******************************************************************02510000
021900     EXEC SQL                                                     02520000
022000         INCLUDE TCKRSTIN                                         02530000
022100     END-EXEC.                                                    02540000
022200*                                                                 02550000
022300******************************************************************02560000
022400*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02570000
022500*  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    02580000
022600******************************************************************02590000
022700     EXEC SQL                                                     02600000
022800         INCLUDE TCKRSTCN                                         02610000
022900     END-EXEC.                                                    02620000
023000*                                                                 02630000
023100******************************************************************02640000
023200*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02650000
023300*  PO TABLE.                                                      02660000
023400******************************************************************02670000
023500     EXEC SQL                                                     02680000
023600         INCLUDE TIMCNPO                                          02690000
023700     END-EXEC.                                                    02700000
023800*                                                                 02710000
023900******************************************************************02720000
024000*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - CONTAINER 02730000
024100*  PO AUDIT TABLE.                                                02740000
024200******************************************************************02750000
024300     EXEC SQL                                                     02760000
024400         INCLUDE TAUCNPO                                          02770000
024500     END-EXEC.                                                    02780000
024600*                                                                 02790000
024700******************************************************************02800000
024800*  DB2 TABLE DECLARATION - TRANSPORTATION PO TRACKING - PORT OF   02810000
024900*  ENTRY CODE TABLE.                                              02820000
025000******************************************************************02830000
025100     EXEC SQL                                                     02840000
025200         INCLUDE TIMPOE                                           02850000
025300     END-EXEC.                                                    02860000
025400*                                                                 02870000
025500******************************************************************02880000
025600*  DB2 TABLE DECLARATION - IT-UPC PHYSICAL LOCATION STATUS        02890000
025700******************************************************************02900000
025800     EXEC SQL                                                     02910000
025900         INCLUDE TUPCPLS                                          02920000
026000     END-EXEC.                                                    02930000
026100*                                                                 02940000
026200******************************************************************02950000
026300*  DB2 TABLE DECLARATION - TR IMPORTS CONTAINER CARTON SEAL       02960000
026400******************************************************************02970000
026500     EXEC SQL                                                     02980000
026600         INCLUDE TRT00006                                         02990000
026700     END-EXEC.                                                    03000000
026800*                                                                 03010000
026900******************************************************************03020000
027000*  DB2 TABLE DECLARATION - TR IMPORTS CONTAINER CARTON LABEL      03030000
027100******************************************************************03040000
027200     EXEC SQL                                                     03050000
027300         INCLUDE TRT00008                                         03060000
027400     END-EXEC.                                                    03070000
027500*                                                                 03080000
027600******************************************************************03090000
027700*  DB2 TABLE DECLARATION - WEB ITEM TABLE FOR E-COMMERCE          03100000
027800******************************************************************03110000
027900     EXEC SQL                                                     03120000
028000         INCLUDE TWEBITM                                          03130000
028100     END-EXEC.                                                    03140000
028200*                                                                 03150000
028210*FJW 03/10/10 BEGIN                                               03160000
028220******************************************************************03170000
028230*  DB2 TABLE DECLARATION - EFC2 LOC TABLE FOR E-COMMERCE          03180000
028240******************************************************************03190000
028250     EXEC SQL                                                     03200000
028260         INCLUDE XLT00010                                         03210000
028270     END-EXEC.                                                    03220000
028280*FJW 03/10/10 END                                                 03230000
028290*                                                                 03240000
028291*---------------------------------------------------------------* 03250006
028292*    PARM TABLE                                                   03260006
028293*---------------------------------------------------------------* 03270006
028295* PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM              03280016
028296     EXEC SQL                                                     03290006
028297          INCLUDE TKRPRPM                                         03300006
028298     END-EXEC.                                                    03310006
028299                                                                  03320006
155029******************************************************************03330099
155029* DB2 TABLE DECLARATION - WST_INTGRTN_TYP TABLE                   03340099
155029******************************************************************03350099
155029     EXEC SQL                                                     03360099
155029          INCLUDE WST00008                                        03370099
155029     END-EXEC.                                                    03380099
155029*                                                                 03390099
155029******************************************************************03400099
155029* DB2 TABLE DECLARATION - WST_ATTR_DEFN TABLE                     03410099
155029******************************************************************03420099
155029     EXEC SQL                                                     03430099
155029          INCLUDE WST00009                                        03440099
155029     END-EXEC.                                                    03450099
155029*                                                                 03460099
155029******************************************************************03470099
155029* DB2 TABLE DECLARATION - WST_ATTR_ELEM TABLE                     03480099
155029******************************************************************03490099
155029     EXEC SQL                                                     03500099
155029          INCLUDE WST00010                                        03510099
155029     END-EXEC.                                                    03520099
155029*                                                                 03530099
028300******************************************************************03540000
028400*    IMPORT TRIP RECORD LAYOUT                                    03550000
028500******************************************************************03560000
028600     COPY TRRD004.                                                03570000
028700 EJECT                                                            03580000
028800                                                                  03590000
028900******************************************************************03600000
029000*    ERROR REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION        03610000
029100*    TRANSMISSION AND RETRANSMISSION.                             03620000
029200******************************************************************03630000
029300     COPY TRRD006.                                                03640000
029400 EJECT                                                            03650000
029500                                                                  03660000
029600******************************************************************03670000
029700*    DETAIL REPORT EXTRACT TABLE FOR IMPORT DECONSOLIDATION       03680000
029800*    TRANSMISSION AND RETRANSMISSION.                             03690000
029900******************************************************************03700000
030000     COPY TRRD020.                                                03710000
030100 EJECT                                                            03720000
030200                                                                  03730000
030300 01  ABEND-CODE                      PIC S9(04)    VALUE +0       03740000
030400                                                   COMP SYNC.     03750000
030500*                                                                 03760000
030600 01  PA-PROGRAM-ACCUMULATORS.                                     03770000
030700     05  PA-TOTALS.                                               03780000
030800         10 PA-TOTAL-CURR-SPLIT-QTY   PIC  S9(13)  VALUE +0       03790000
030900                                                     COMP-3.      03800000
031000         10 PA-TOTAL-OUTPUT-REC-COUNT PIC  S9(13)  VALUE +0       03810000
031100                                                     COMP-3.      03820000
031200         10 PA-TOTAL-OTPK-ORD-QTY     PIC  S9(13)  VALUE +0       03830000
031300                                                     COMP-3.      03840000
031400         10 PA-TOTAL-INPK-ORD-QTY     PIC  S9(13)  VALUE +0       03850000
031500                                                     COMP-3.      03860000
031600         10 PA-TTL-PCK-UNITS-SENT                                 03870000
031700                                      PIC  S9(13)  VALUE +0       03880000
031800                                                     COMP-3.      03890000
031900         10 PA-TTL-PCK-CARTS-SENT                                 03900000
032000                                      PIC  S9(13)  VALUE +0       03910000
032100                                                     COMP-3.      03920000
032200         10 PA-TTL-ORDERED-PACK-QTY     PIC  S9(13)  VALUE +0     03930000
032300                                                     COMP-3.      03940000
032400                                                                  03950000
032500         10 PA-TTL-ORDERED-PACK-QTY-DC    PIC  S9(9) COMP.        03960000
032600                                                                  03970000
032700         10 PA-TTL-PCK-SPLIT-QTY-DC-PCT   PIC  9V99999            03980000
032800                                             VALUE ZERO.          03990000
032900                                                                  04000000
033000         10 PA-TOTAL-PACK-SPLIT-QTY-PCT PIC S9(13) VALUE +0       04010000
033100                                                     COMP-3.      04020000
033200         10 PA-TOTAL-PACK-SPLIT-QTY-CARTON PIC S9(13) VALUE +0    04030000
033300                                                      COMP-3.     04040000
033400         10 PA-TOTAL-PACK-SPLIT-CARTON  PIC S9(13) VALUE +0       04050000
033500                                                     COMP-3.      04060000
033600     05  PA-ERROR-COUNT               PIC  S9(13)    VALUE +0     04070000
033700                                                     COMP-3.      04080000
033800                                                                  04090000
033900 01  PS-PROGRAM-SWITCHES.                                         04100000
034000     05  PS-EOC-DRIVER-CURSOR-SW       PIC  X(01)    VALUE 'N'.   04110000
034100         88  PS-EOC-DRIVER-CURSOR                    VALUE 'Y'.   04120000
034200         88  PS-NOT-EOC-DRIVER-CURSOR                VALUE 'N'.   04130000
034300     05  PS-ALL-MULTI-PACKS-SW         PIC  X(01)    VALUE 'N'.   04140000
034400         88  PS-ALL-MULTI-PACKS                      VALUE 'Y'.   04150000
034500         88  PS-ALL-MULTI-PACKS-NO                   VALUE 'N'.   04160000
034600     05  PS-THIS-PO-HAD-MULTI-SW       PIC  X(01)    VALUE 'N'.   04170000
034700         88  PS-THIS-PO-HAD-MULTI                    VALUE 'Y'.   04180000
034800         88  PS-THIS-PO-HAD-MULTI-NO                 VALUE 'N'.   04190000
034900     05  PS-EOC-MULTI-PACK-CUR-SW      PIC  X(01)    VALUE 'N'.   04200000
035000         88  PS-EOC-MULTI-PACK-CUR                   VALUE 'Y'.   04210000
035100         88  PS-EOC-MULTI-PACK-CUR-NO                VALUE 'N'.   04220000
035200     05  PS-EOC-CONT-CURSOR-SW         PIC  X(01)    VALUE 'N'.   04230000
035300         88  PS-EOC-CONT-CURSOR                      VALUE 'Y'.   04240000
035400         88  PS-EOC-CONT-CURSOR-NO                   VALUE 'N'.   04250000
035500     05  PS-EOC-PO-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04260000
035600         88  PS-EOC-PO-CURSOR                        VALUE 'Y'.   04270000
035700         88  PS-EOC-PO-CURSOR-NO                     VALUE 'N'.   04280000
035800     05  PS-EOC-INSTR-CURSOR-SW        PIC  X(01)    VALUE 'N'.   04290000
035900         88  PS-EOC-INSTR-CURSOR                     VALUE 'Y'.   04300000
036000         88  PS-EOC-INSTR-CURSOR-NO                  VALUE 'N'.   04310000
036100     05  PS-EOC-BULK-UPC-CUR-SW        PIC  X(01)    VALUE 'N'.   04320000
036200         88  PS-EOC-BULK-UPC-CUR                     VALUE 'Y'.   04330000
036300         88  PS-EOC-BULK-UPC-CUR-NO                  VALUE 'N'.   04340000
036400     05  PS-EOC-PREPACK-DC-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04350000
036500         88  PS-EOC-PREPACK-DC-CURSOR                VALUE 'Y'.   04360000
036600         88  PS-EOC-PREPACK-DC-CURSOR-NO             VALUE 'N'.   04370000
036700     05  PS-EOC-PREPACK-CM-CURSOR-SW   PIC  X(01)    VALUE 'N'.   04380000
036800         88  PS-EOC-PREPACK-CM-CURSOR                VALUE 'Y'.   04390000
036900         88  PS-EOC-PREPACK-CM-CURSOR-NO             VALUE 'N'.   04400000
037000     05  PS-EOC-DC-CURSOR-SW           PIC  X(01)    VALUE 'N'.   04410000
037100         88  PS-EOC-DC-CURSOR                        VALUE 'Y'.   04420000
037200         88  PS-EOC-DC-CURSOR-NO                     VALUE 'N'.   04430000
037300     05  PS-EOC-LINE-CNTR-CURSOR-SW PIC     X(01)    VALUE 'N'.   04440000
037400         88  PS-EOC-LINE-CNTR-CURSOR                 VALUE 'Y'.   04450000
037500         88  PS-EOC-LINE-CNTR-CURSOR-NO              VALUE 'N'.   04460000
037600     05  PS-EOC-POE-CURSOR-SW          PIC  X(01)    VALUE 'N'.   04470000
037700         88  PS-EOC-POE-CURSOR                       VALUE 'Y'.   04480000
037800         88  PS-EOC-POE-CURSOR-NO                    VALUE 'N'.   04490000
037900     05  PS-POE-CITY-FOUND-SW          PIC  X(01)    VALUE 'N'.   04500000
038000         88 PS-POE-CITY-FOUND                        VALUE 'Y'.   04510000
038100         88 PS-POE-CITY-FOUND-NO                     VALUE 'N'.   04520000
038200     05  PS-POE-ON-TIMPOE-SW           PIC  X(01)    VALUE 'N'.   04530000
038300         88 PS-POE-ON-TIMPOE                         VALUE 'Y'.   04540000
038400         88 PS-POE-ON-TIMPOE-NO                      VALUE 'N'.   04550000
038500     05  PS-EOC-PACK-CURSOR-SW PIC X(01)             VALUE 'N'.   04560000
038600         88  PS-EOC-PACK-CURSOR                      VALUE 'Y'.   04570000
038700         88  PS-EOC-PACK-CURSOR-NO                   VALUE 'N'.   04580000
038800     05  PS-EOC-POPRPK-FOR-PO-CUR-SW PIC X(01)       VALUE 'N'.   04590000
038900         88  PS-EOC-POPRPK-FOR-PO-CUR                VALUE 'Y'.   04600000
039000         88  PS-EOC-POPRPK-FOR-PO-CUR-NO             VALUE 'N'.   04610000
039100     05  PS-EOC-PURITM-TUPC-CUR-SW    PIC X(01)      VALUE 'N'.   04620000
039200         88  PS-EOC-PURITM-TUPC-CUR                  VALUE 'Y'.   04630000
039300         88  PS-EOC-PURITM-TUPC-CUR-NO               VALUE 'N'.   04640000
039400     05  PS-EOC-PREPACK-CURSOR-SW       PIC X(01)    VALUE 'N'.   04650000
039500         88  PS-EOC-PREPACK-CURSOR                   VALUE 'Y'.   04660000
039600         88  PS-EOC-PREPACK-CURSOR-NO                VALUE 'N'.   04670000
039700     05  PS-EOC-PDC-UNITS-CURSOR-SW     PIC X(01)    VALUE 'N'.   04680000
039800         88  PS-EOC-PDC-UNITS-CURSOR                 VALUE 'Y'.   04690000
039900         88  PS-EOC-PDC-UNITS-CURSOR-NO              VALUE 'N'.   04700000
040000     05  PS-EOC-PREPACK-UPC-CURSOR-SW   PIC X(01)    VALUE 'N'.   04710000
040100         88  PS-EOC-PREPACK-UPC-CURSOR               VALUE 'Y'.   04720000
040200         88  PS-EOC-PREPACK-UPC-CURSOR-NO            VALUE 'N'.   04730000
040300     05  PS-EOC-CART-LABEL-CURSOR-SW    PIC X(01)    VALUE 'N'.   04740000
040400         88  PS-EOC-CART-LABEL-CURSOR                VALUE 'Y'.   04750000
040500         88  PS-EOC-CART-LABEL-CURSOR-NO             VALUE 'N'.   04760000
040600     05  PS-UPCS-ON-TIMCNUP-SW         PIC  X(01)    VALUE 'N'.   04770000
040700         88  PS-UPCS-ON-TIMCNUP                      VALUE 'Y'.   04780000
040800         88  PS-UPCS-ON-TIMCNUP-NO                   VALUE 'N'.   04790000
040900     05  PS-UPCS-ON-PREPACK-SW         PIC  X(01)    VALUE 'N'.   04800000
041000         88  PS-UPCS-ON-PREPACK                      VALUE 'Y'.   04810000
041100         88  PS-UPCS-ON-PREPACK-NO                   VALUE 'N'.   04820000
041200     05  PS-PREPACKS-FOR-PO-SW         PIC  X(01)    VALUE 'N'.   04830000
041300         88  PS-PREPACKS-FOR-PO                      VALUE 'Y'.   04840000
041400         88  PS-PREPACKS-FOR-PO-NO                   VALUE 'N'.   04850000
041500     05  PS-DC-SPLIT-INFO-PRESENT-SW   PIC  X(01)    VALUE 'N'.   04860000
041600         88  PS-DC-SPLIT-INFO-PRESENT                VALUE 'Y'.   04870000
041700         88  PS-DC-SPLIT-INFO-PRESENT-NO             VALUE 'N'.   04880000
041800     05  PS-CONT-INFO-PRESENT-SW       PIC  X(01)    VALUE 'N'.   04890000
041900         88  PS-CONT-INFO-PRESENT                    VALUE 'Y'.   04900000
042000         88  PS-CONT-INFO-PRESENT-NO                 VALUE 'N'.   04910000
042100     05  PS-PO-CUR-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   04920000
042200         88  PS-PO-CUR-INFO-PRESENT                  VALUE 'Y'.   04930000
042300         88  PS-PO-CUR-INFO-PRESENT-NO               VALUE 'N'.   04940000
042400     05  PS-CURR-SPLIT-QTY-PRESENT-SW  PIC  X(01)    VALUE 'N'.   04950000
042500         88  PS-CURR-SPLIT-QTY-PRESENT               VALUE 'Y'.   04960000
042600         88  PS-CURR-SPLIT-QTY-PRESENT-NO            VALUE 'N'.   04970000
042700     05  PS-PO-SEL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   04980000
042800         88  PS-PO-SEL-INFO-PRESENT                  VALUE 'Y'.   04990000
042900         88  PS-PO-SEL-INFO-PRESENT-NO               VALUE 'N'.   05000000
043000     05  PS-IMCNRL-INFO-PRESENT-SW     PIC  X(01)    VALUE 'N'.   05010000
043100         88  PS-IMCNRL-INFO-PRESENT                  VALUE 'Y'.   05020000
043200         88  PS-IMCNRL-INFO-PRESENT-NO               VALUE 'N'.   05030000
043300     05  PS-PO-PASSES-XMIT-TEST-SW    PIC   X(01)    VALUE 'N'.   05040000
043400         88  PS-PO-PASSES-XMIT-TEST                  VALUE 'Y'.   05050000
043500         88  PS-PO-PASSES-XMIT-TEST-NO               VALUE 'N'.   05060000
043600     05  PS-SHPTPO-TBL-EMPTY-SW        PIC  X(01)    VALUE 'N'.   05070000
043700         88 PS-SHPTPO-TBL-EMPTY                      VALUE 'Y'.   05080000
043800         88 PS-SHPTPO-TBL-EMPTY-NO                   VALUE 'N'.   05090000
043900     05  PS-BLANK-SPLT-XMIT-FOUND-SW   PIC  X(01)    VALUE 'N'.   05100000
044000         88 PS-BLANK-SPLT-XMIT-FOUND                 VALUE 'Y'.   05110000
044100         88 PS-BLANK-SPLT-XMIT-FOUND-NO              VALUE 'N'.   05120000
044200     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   05130000
044300         88  PS-NORMAL-RUN                           VALUE '0'.   05140000
044400         88  PS-RESTART-RUN                          VALUE '9'.   05150000
044500     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.   05160000
044600         88  PS-COMMITS-TAKEN                        VALUE 'Y'.   05170000
044700         88  PS-COMMITS-TAKEN-NO                     VALUE 'N'.   05180000
044800     05  PS-PROBLEM-DO-NOT-SEND-SW     PIC  X(01)    VALUE 'N'.   05190000
044900         88  PS-PROBLEM-DO-NOT-SEND                  VALUE 'Y'.   05200000
045000         88  PS-PROBLEM-DO-NOT-SEND-NO               VALUE 'N'.   05210000
045100     05  PS-ZERO-OUTR-PACK-QTY-SW      PIC  X(01)    VALUE 'N'.   05220000
045200         88  PS-ZERO-OUTR-PACK-QTY                   VALUE 'Y'.   05230000
045300         88  PS-ZERO-OUTR-PACK-QTY-NO                VALUE 'N'.   05240000
045400     05  PS-SELECT-PACK-SUM-OK-SW      PIC  X(01)    VALUE 'N'.   05250000
045500         88  PS-SELECT-PACK-SUM-OK                   VALUE 'Y'.   05260000
045600         88  PS-SELECT-PACK-SUM-OK-NO                VALUE 'N'.   05270000
045700***  05  PS-ORDERED-EQUALS-SHIPPED-SW  PIC  X(01)    VALUE 'N'.   05280000
045800***      88  PS-ORDERED-EQUALS-SHIPPED               VALUE 'Y'.   05290000
045900***      88  PS-ORDERED-EQUALS-SHIPPED-NO            VALUE 'N'.   05300000
046000     05  PS-FIRST-DC-SW                PIC  X(01)    VALUE 'N'.   05310000
046100         88  PS-FIRST-DC                             VALUE 'Y'.   05320000
046200         88  PS-FIRST-DC-NO                          VALUE 'N'.   05330000
046300     05  PS-COUNT-DCS-OK-SW            PIC  X(01)    VALUE 'N'.   05340000
046400         88  PS-COUNT-DCS-OK                         VALUE 'Y'.   05350000
046500         88  PS-COUNT-DCS-OK-NO                      VALUE 'N'.   05360000
046600     05  PS-UPC-PASSESED-EDITS-SW      PIC  X(01)    VALUE 'N'.   05370000
046700         88  PS-UPC-PASSESED-EDITS                   VALUE 'Y'.   05380000
046800         88  PS-UPC-PASSESED-EDITS-NO                VALUE 'N'.   05390000
046900     05  PS-THERE-ARE-E-COM-DCS-SW     PIC  X(01)    VALUE 'N'.   05400000
047000         88  PS-THERE-ARE-E-COM-DCS                  VALUE 'Y'.   05410000
047100         88  PS-THERE-ARE-E-COM-DCS-NO               VALUE 'N'.   05420000
047200     05  PS-THIS-IS-E-COM-UPC-SW       PIC  X(01)    VALUE 'N'.   05430000
047300         88  PS-THIS-IS-E-COM-UPC                    VALUE 'Y'.   05440000
047400         88  PS-THIS-IS-E-COM-UPC-NO                 VALUE 'N'.   05450000
047500     05  PS-EOC-E-COM-PACK-UPC-CUR-SW  PIC  X(01)    VALUE 'N'.   05460000
047600         88  PS-EOC-E-COM-PACK-UPC-CUR               VALUE 'Y'.   05470000
047700         88  PS-EOC-E-COM-PACK-UPC-CUR-NO            VALUE 'N'.   05480000
047800     05  PS-PASSED-E-COM-CHECK-SW      PIC  X(01)    VALUE 'N'.   05490000
047900         88  PS-PASSED-E-COM-CHECK                   VALUE 'Y'.   05500000
048000         88  PS-PASSED-E-COM-CHECK-NO                VALUE 'N'.   05510000
048100                                                                  05520000
048200     05  PS-POE-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05530000
048300         88  PS-POE-WRITTEN                          VALUE 'Y'.   05540000
048400         88  PS-POE-WRITTEN-NO                       VALUE 'N'.   05550000
048500     05  PS-VES-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05560000
048600         88  PS-VES-WRITTEN                          VALUE 'Y'.   05570000
048700         88  PS-VES-WRITTEN-NO                       VALUE 'N'.   05580000
048800     05  PS-ETA-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05590000
048900         88  PS-ETA-WRITTEN                          VALUE 'Y'.   05600000
049000         88  PS-ETA-WRITTEN-NO                       VALUE 'N'.   05610000
049100     05  PS-CMN-WRITTEN-SW             PIC  X(01)    VALUE 'N'.   05620000
049200         88  PS-CMN-WRITTEN                          VALUE 'Y'.   05630000
049300         88  PS-CMN-WRITTEN-NO                       VALUE 'N'.   05640000
049400                                                                  05650000
049500     05  PS-SPLITS-ENTERED-SW          PIC  X(01)    VALUE 'N'.   05660000
049600         88  PS-SPLITS-ENTERED                       VALUE 'Y'.   05670000
049700         88  PS-SPLITS-ENTERED-NO                    VALUE 'N'.   05680000
049800                                                                  05690000
049900     05  PS-EOT-EXTRACT-SW             PIC  X(01)    VALUE 'N'.   05700000
050000         88  PS-EOT-EXTRACT                          VALUE 'Y'.   05710000
050100         88  PS-EOT-EXTRACT-NO                       VALUE 'N'.   05720000
050200                                                                  05730000
050300     05  PS-EOC-SEAL-CURSOR-SW         PIC  X(01)    VALUE 'N'.   05740000
050400         88  PS-EOC-SEAL-CURSOR                      VALUE 'Y'.   05750000
050500         88  PS-EOC-SEAL-CURSOR-NO                   VALUE 'N'.   05760000
050600                                                                  05770000
050700     05 PS-NEED-SEALS-SW               PIC  X(01)    VALUE 'N'.   05780000
050800         88  PS-NEED-SEALS                           VALUE 'Y'.   05790000
050900         88  PS-NEED-SEALS-NO                        VALUE 'N'.   05800000
139868     05  PS-FIRST-STORE-SW             PIC  X(01)    VALUE 'N'.   05810099
139868         88  PS-FIRST-STORE                          VALUE 'Y'.   05820099
139868         88  PS-FIRST-STORE-NO                       VALUE 'N'.   05830099
139868     05  PS-EOC-STORE-CURSOR-SW        PIC  X(01)    VALUE 'N'.   05840099
139868         88  PS-EOC-STORE-CURSOR                     VALUE 'Y'.   05850099
139868         88  PS-EOC-STORE-CURSOR-NO                  VALUE 'N'.   05860099
139868     05  PS-OUTLET-STORE-SW            PIC  X(01)    VALUE 'N'.   05870099
139868         88  PS-OUTLET-STORE                         VALUE 'Y'.   05880099
139868         88  PS-OUTLET-STORE-NO                      VALUE 'N'.   05890099
155029     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   05900099
155029         88  PS-NEW-UPC-YES                          VALUE 'Y'.   05910099
155029         88  PS-NEW-UPC-NO                           VALUE 'N'.   05920099
155029     05  PS-FIRST-UPC-SW               PIC  X(01)    VALUE 'N'.   05930099
155029         88  PS-FIRST-UPC-YES                        VALUE 'Y'.   05940099
155029         88  PS-FIRST-UPC-NO                         VALUE 'N'.   05950099
155029     05  PS-BYPASS-CRTN-WRITE-SW       PIC  X(01)    VALUE 'N'.   05960099
155029         88  PS-BYPASS-CRTN-WRITE                    VALUE 'Y'.   05970099
155029         88  PS-BYPASS-CRTN-WRITE-NO                 VALUE 'N'.   05980099
051000                                                                  05990000
051100 01  PC-PROGRAM-CONSTANTS.                                        06000000
051200     05  PC-SYSTEM-CD                PIC  X(02)    VALUE 'RV'.    06010000
051300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          06020000
051400         'TRKUP007'.                                              06030000
051500     05  PC-CURRENT-JOB-NAME         PIC  X(06)    VALUE 'TRK030'.06040000
051600     05  PC-EN                       PIC X(02)     VALUE 'EN'.    06050000
051700     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     06060000
051800     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     06070000
051900     05  PC-A                        PIC X(01)     VALUE 'A'.     06080000
052000     05  PC-B                        PIC X(01)     VALUE 'B'.     06090000
052100     05  PC-C                        PIC X(01)     VALUE 'C'.     06100000
052200     05  PC-I                        PIC X(01)     VALUE 'I'.     06110000
052300     05  PC-M                        PIC X(01)     VALUE 'M'.     06120000
052400     05  PC-O                        PIC X(01)     VALUE 'O'.     06130000
052500     05  PC-S                        PIC X(01)     VALUE 'S'.     06140000
052600     05  PC-T                        PIC X(01)     VALUE 'T'.     06150000
052700     05  PC-U                        PIC X(01)     VALUE 'U'.     06160000
052800     05  PC-Y                        PIC X(01)     VALUE 'Y'.     06170000
052900     05  PC-MULTI                    PIC X(05)     VALUE 'MULTI'. 06180000
053000     05  PC-SPACE-MULTI              PIC X(06)    VALUE ' MULTI'. 06190000
053100     05  PC-NO-SIZE                  PIC X(07)     VALUE          06200000
053200                                                   'NO SIZE'.     06210000
053300     05  PC-NULL-DTE                PIC X(10) VALUE '9999-09-09'. 06220000
053400     05  PC-LOW-VALUE                PIC X(01)     VALUE          06230000
053500                                                   LOW-VALUE.     06240000
053600     05  PC-EXTRACT-TBL-LIMIT       PIC S9(08)  VALUE +50000.     06250000
053700                                                                  06260091
053800*                                                                 06270000
053900 01  PV-PROGRAM-VARIABLES.                                        06280000
054000     05  PV-HOLD-PORT-OF-ENTRY-CTY   PIC X(30)     VALUE SPACE.   06290000
054100     05  PV-HOLD-MOM-DEST-POE        PIC X(4)      VALUE 'XXXX'.  06300000
054200     05  PV-HOLD-MOM-POE-DELY-TMST   PIC X(10)     VALUE SPACE.   06310000
054300     05  PV-HOLD-MOM-IMPRT-VEH-NM    PIC X(25)     VALUE SPACE.   06320000
      *CHG0210079                                                       06321099
054400*    05  PV-QUOTIENT-ORDER-PERCENT   PIC S9V999    COMP-3         06330099
054400     05  PV-QUOTIENT-ORDER-PERCENT   PIC S9V99999  COMP-3         06330199
054500                                                   VALUE ZERO.    06340000
      *CHG0210079                                                       06341099
155029     05  PV-DEPT-NBR                 PIC S9(4)V    VALUE ZEROES   06350099
155029                                                   COMP-3.        06360099
155029     05  PV-FAST-E-BUS-IND           PIC X(01)     VALUE SPACES.  06370099
155029     05  PV-FAST-RDC-IND             PIC X(01)     VALUE SPACES.  06380099
155029     05  PV-FAST-EFC-IND             PIC X(01)     VALUE SPACES.  06390099
155029     05  PV-HOLD-OUT-RECORD.                                      06400099
155029         10  FILLER                  PIC X(03)     VALUE SPACES.  06410099
155029         10  PV-HOLD-DIST-CNTR       PIC X(04)     VALUE SPACES.  06420099
155029         10  FILLER                  PIC X(243)    VALUE SPACES.  06430099
054600     05  PV-DC-CART-CT               PIC 9(12)V9   VALUE ZERO.    06440000
054700     05  PV-MULTI-HOLD-PO-NBR        PIC S9(09)    COMP-3         06450000
054800                                                   VALUE ZERO.    06460000
054900     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP-3         06470000
055000                                                   VALUE ZERO.    06480000
055100     05  PV-HOLD-PLAN-NBR            PIC S9(04)    COMP-3         06490000
055200                                                   VALUE ZERO.    06500000
055300     05  PV-HOLD-PO-PREPK-ID         PIC  9(08)    VALUE ZEROES.  06510000
055400     05  PV-HOLD-PO-PREPK-PO         PIC  9(08)    VALUE ZERO.    06520000
055500     05  PV-DEST-NBR                 PIC  9(04)    VALUE ZEROES.  06530000
055600     05  PV-CURRENT-TIME             PIC  X(26)    VALUE SPACES.  06540000
055700     05  PV-REMAINDER                PIC S9(3)V99  VALUE +0       06550000
055800                                                     COMP SYNC.   06560000
055900     05  PV-REMAINDER-UNPACKED       PIC 9(3)V99   VALUE ZERO.    06570000
056000     05  PV-TMST                     PIC X(26)     VALUE SPACES.  06580000
056100     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  06590000
056200     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACE.   06600000
056300     05  PV-HOLD-TR020-PO-NBR        PIC 9(09)     VALUE ZERO.    06610000
056400     05  PV-HOLD-TR020-PROCESS-DATE  PIC X(08)     VALUE SPACE.   06620000
056500     05  PV-HOLD-TR020-CONTNR-ID     PIC X(12)     VALUE SPACE.   06630000
056600     05  PV-HOLD-CONTNR-ID           PIC X(12)     VALUE SPACE.   06640000
056700     05  PV-TR006-DEPT-NBR           PIC  9(04).                  06650000
056800     05  PV-TR006-DEPT-NBR-X REDEFINES                            06660000
056900         PV-TR006-DEPT-NBR.                                       06670000
057000         10  FILLER                  PIC  X(01).                  06680000
057100         10  PV-TR006-DEPT-NBR-3     PIC  X(03).                  06690000
057200     05  PV-ETA-BEGIN-TMST           PIC X(26)     VALUE SPACE.   06700000
057300     05  PV-ETA-END-TMST             PIC X(26)     VALUE SPACE.   06710000
057400     05  PV-ETA-BEGIN-DTE            PIC X(10)     VALUE SPACE.   06720000
057500     05  PV-ETA-END-DTE              PIC X(10)     VALUE SPACE.   06730000
057600     05  PV-MULTI-UPC-ROWS           PIC S9(04)    VALUE +0       06740000
057700                                                     COMP SYNC.   06750000
057800     05  PV-DB2-COUNT                PIC S9(04)    VALUE +0       06760000
057900                                                     COMP SYNC.   06770000
058000     05  PV-EDIT-DEST                PIC ZZZ9.                    06780000
058100     05  PV-EDIT-PREPK-ID            PIC ZZZ9.                    06790000
139868     05  PV-HOLD-PCK-UNIT-QTY        PIC  9(12)    VALUE ZERO.    06800099
139868     05  PV-HOLD-PCK-CART-CT         PIC  9(12)    VALUE ZERO.    06810099
139868     05  PV-HOLD-PCK-UNIT-PER-CTN    PIC  9(12)    VALUE ZERO.    06820099
058200                                                                  06830000
058300     05  PV-E-COM-WORK-FIELDS.                                    06840000
058400         10  PV-NBR-OF-E-COM-ROWS      PIC S9(04)  VALUE +0       06850000
058500                                                     COMP SYNC.   06860000
058600         10  PV-NBR-OF-E-COM-DCS       PIC S9(04)  VALUE +0       06870000
058700                                                     COMP SYNC.   06880000
058800         10  PV-TTL-BAD-PACK-UPCS       PIC S9(04)  VALUE +0      06890000
058900                                                    COMP SYNC.    06900000
059000         10  PV-TTL-E-COM-PACK-UPCS     PIC S9(04)  VALUE +0      06910000
059100                                                    COMP SYNC.    06920000
059200         10  PV-TTL-PACK-UPCS           PIC S9(04)  VALUE +0      06930000
059300                                                    COMP SYNC.    06940000
059400                                                                  06950000
059500     05  PV-LABEL-WORK-FIELDS.                                    06960000
059600         10  PV-NBR-CART-LBLS-UPC      PIC S9(09)    COMP-3       06970000
059700                                                   VALUE ZERO.    06980000
059800         10  PV-TTL-CART-LBLS-ALL-DCS  PIC S9(09)    COMP-3       06990000
059900                                                   VALUE ZERO.    07000000
060000         10  PV-NBR-CART-LBLS-THIS-DC  PIC S9(09)    COMP-3       07010000
060100                                                   VALUE ZERO.    07020000
060200         10  PV-CARTON-ROWS-FETCHED    PIC S9(09)    COMP-3       07030000
060300                                                   VALUE ZERO.    07040000
060400                                                                  07050000
060500     05  PV-ADJUST-ROUNDED-DC-WRK-FLDS.                           07060000
060600         10  PV-TTL-ALL-DCS-PCT         PIC S9(03) VALUE +0.      07070000
060700         10  PV-TTL-ALL-DCS-UNITS       PIC S9(15) VALUE +0.      07080000
060800         10  PV-TTL-ALL-DCS-CARTS       PIC S9(15) VALUE +0.      07090000
060900         10  PV-TOTAL-NBR-OF-DCS        PIC S9(04) VALUE +0       07100000
061000                                                     COMP SYNC.   07110000
061100         10  PV-DCS-TO-SKIP             PIC S9(05) VALUE +0.      07120000
061200                                                                  07130000
061300     05  PV-CART-PER-PO-WORK-FIELDS.                              07140000
061400         10  PV-SUM-INCNUP-CART-CNT     PIC S9(13) VALUE +0       07150000
061500                                                     COMP-3.      07160000
061600         10  PV-CART-PER-PREPACK        PIC S9(13) VALUE +0       07170000
061700                                                     COMP-3.      07180000
061800         10  PV-CART-PER-ITEM           PIC S9(13) VALUE +0       07190000
061900                                                     COMP-3.      07200000
062000                                                                  07210000
062100                                                                  07220000
062200 01  PV-CKPT-RESTART-INFO.                                        07230000
062300     05  PV-RESTART-TOT-OUT-REC-COUNT    PIC  S9(13)  VALUE +0    07240000
062400                                                     COMP-3.      07250000
062500     05  PV-RESTART-ERROR-COUNT          PIC S9(13)  VALUE +0     07260000
062600                                                     COMP SYNC.   07270000
062700 01  PV-EXTRACT-TABLE.                                            07280000
062800     05  PV-TBL-EXT-ROW                                           07290000
062900              OCCURS 50000 TIMES                                  07300000
063000                  INDEXED BY EXT-INDEX.                           07310000
063100         10  PV-TBL-EXT-TYPE       PIC X(03).                     07320000
063200         10  FILLER                PIC X(247).                    07330000
063300*                                                                 07340000
063400*                                                                 07350000
063500*  CURSOR DECLARATION FOR CONTAINER MAIN CURSOR                   07360000
063600*                                                                 07370000
063700*                                                                 07380000
063800     EXEC SQL                                                     07390000
063900          DECLARE CMN_DRIVER_CUR CURSOR WITH HOLD FOR             07400036
064000           SELECT DISTINCT                                        07410000
064100                 TK.MOM_POE_DELY_TMST                             07420000
064200                ,TK.MOM_IMPRT_VEH_NM                              07430000
064300                ,TK.MOM_TRIP_TYP_CDE                              07440000
064400                ,TK.MOM_DEST_POE_CDE                              07450000
064500                ,TK.CONTNR_ID                                     07460000
064600                ,TK.CONTNR_SEQ_NBR                                07470000
064700                ,TK.MOM_IMPRT_TRIP_ID                             07480000
064800                ,TK.MOM_CARR_SCAC_ID                              07490000
064900                ,TK.SIZE_CDE                                      07500000
065000             FROM                                                 07510000
065100                 TIMCNPO   PO                                     07520000
065200                ,TIMCNTK   TK                                     07530000
065300                ,TPURCHS   PU                                     07540000
065400                ,TPLNSHP   PL                                     07550000
065500             WHERE                                                07560000
      *CHG0131716 - START                                               07570023
065600*                 ((PU.PO_TYP_CDE        = 'LD'                   07580022
181356**                ((PU.PO_TYP_CDE        IN ('LD','EC')           07590099
181356                  ((PU.PO_TYP_CDE        IN ('LD','EC','LE')      07600099
      *CHG0131716 - END                                                 07610023
065700                    AND PL.DONT_SHIP_BEF_DTE BETWEEN              07620000
065800                        :PV-ETA-BEGIN-DTE AND                     07630000
065900                        :PV-ETA-END-DTE)                          07640000
066000                  OR                                              07650000
      *CHG0131716 - START                                               07660023
066100*                  (PU.PO_TYP_CDE       IN ('EC','IM','IE','IF')  07670022
                         (PU.PO_TYP_CDE       IN ('IM','IE','IF')       07680022
      *CHG0131716 - END                                                 07690023
066200                    AND TK.MOM_POE_DELY_TMST BETWEEN              07700000
066300                        :PV-ETA-BEGIN-TMST AND                    07710000
066400                        :PV-ETA-END-TMST))                        07720000
066500               AND  PO.CONTNR_ID         = TK.CONTNR_ID           07730000
INCFIX               AND  PO.CONTNR_ID NOT IN('FSCU8358181')            07731099
INCFIX*** BUD        AND  PO.CONTNR_ID NOT IN('CAXU9970895')            07732099
INCFIX*** BUD        AND  PO.CONTNR_ID NOT IN('OOLU7610091')            07733099
INCFIX*** BUD        AND  PO.CONTNR_ID NOT IN('TRKU4448061')            07734099
066600               AND  PO.CONTNR_SEQ_NBR    = TK.CONTNR_SEQ_NBR      07740000
066700               AND  PO.SPLT_XMIT_CDE     = ' '                    07750000
066800               AND  PO.PO_NBR            = PU.PO_NBR              07760000
066900               AND  PU.VER_STATUS_CDE    = 'A'                    07770000
067000               AND  PO.PO_NBR            = PL.PO_NBR              07780000
067100               AND  PL.VER_STATUS_CDE    = 'A'                    07790000
067200             ORDER BY                                             07800000
067300                 TK.MOM_DEST_POE_CDE                              07810000
067400                ,TK.MOM_POE_DELY_TMST                             07820000
067500                ,TK.MOM_IMPRT_VEH_NM                              07830000
067600                ,TK.CONTNR_ID                                     07840000
067700                ,TK.CONTNR_SEQ_NBR                                07850000
067800     END-EXEC.                                                    07860000
067900*                                                                 07870000
068000*                                                                 07880000
068100*  CURSOR DECLARATION FOR POE CITY                                07890000
068200*                                                                 07900000
068300*                                                                 07910000
068400*  NOTE: 1. WE DON'T CHECK PO_ASGMT_ALWD_IND BECAUSE CONSOLIDATOR 07920000
068500*           HAS CONTROL OF POE SENT.                              07930000
068600*        2. WE ASSUME OCEAN TRIP TYPE.                            07940000
068700*                                                                 07950000
068800     EXEC SQL                                                     07960000
068900          DECLARE POE_CUR CURSOR FOR                              07970000
069000           SELECT DISTINCT                                        07980000
069100                  P.POE_STD_EDI_CDE                               07990000
069200                 ,P.POE_CTY_NM                                    08000000
069300             FROM                                                 08010000
069400                TIMPOE    P                                       08020000
069500             WHERE P.POE_CDE = :IMPOE-POE-CDE                     08030000
069600               AND P.STAT_CDE = 'A'                               08040000
069700        ORDER BY  P.POE_STD_EDI_CDE                               08050000
069800     END-EXEC.                                                    08060000
069900*                                                                 08070000
070000*                                                                 08080000
070100*  CURSOR DECLARATION TO OBTAIN PURCHASE ORDERS FOR EACH CONTAINER08090000
070200*                                                                 08100000
070300*                                                                 08110000
070400     EXEC SQL                                                     08120000
070500          DECLARE PO_CUR CURSOR FOR                               08130000
070600           SELECT                                                 08140000
070700                  CNPO.PO_NBR                                     08150000
070800                , CNPO.EXTL_REF_NBR                               08160000
070900                , CNPO.SPLT_XMIT_CDE                              08170000
071000                , CNPO.PO_UNT_QTY                                 08180000
071100                , CNPO.PO_CBMT_QTY                                08190000
071200                , CNPO.PO_WT_KGRM_QTY                             08200000
071300             FROM                                                 08210000
071400                  TIMCNPO   CNPO                                  08220000
071500             WHERE  CNPO.CONTNR_ID        = :IMCNTK-CONTNR-ID     08230000
071600               AND  CNPO.CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR08240000
071700               AND  CNPO.SPLT_XMIT_CDE    = ' '                   08250000
071800     END-EXEC.                                                    08260000
071900*                                                                 08270000
072000*                                                                 08280000
072100*                                                                 08290000
072200*  CURSOR DECLARATION TO OBTAIN SPECIAL INSTRUCTIONS FOR PURCHASE 08300000
072300*  ORDERS                                                         08310000
072400*                                                                 08320000
072500*                                                                 08330000
072600     EXEC SQL                                                     08340000
072700          DECLARE INSTR_CUR CURSOR FOR                            08350000
072800           SELECT                                                 08360000
072900                  CD.INSTR_DESC                                   08370000
073000                , CD.INSTR_NBR                                    08380000
073100                , PI.RECIP_CDE                                    08390000
073200             FROM                                                 08400000
073300                  TPOINST   PI                                    08410000
073400                , TINSTCD   CD                                    08420000
073500             WHERE PI.PO_NBR   =  :IMCNPO-PO-NBR                  08430000
P40877*              AND (PI.RECIP_CDE = 'DC'                           08440018
P40877*               OR  PI.RECIP_CDE = 'DE')                          08450018
P40877               AND PI.RECIP_CDE = 'DE'                            08460018
073800               AND PI.INSTR_NBR  =  CD.INSTR_NBR                  08470000
073900         ORDER BY PI.RECIP_CDE DESC                               08480000
074000                , CD.INSTR_NBR                                    08490000
074100     END-EXEC.                                                    08500000
074200*                                                                 08510000
074300*                                                                 08520000
074400*  CURSOR DECLARATION TO OBTAIN BULK UPCS FOR PURCHASE ORDER.     08530000
074500*                                                                 08540000
074600*                                                                 08550000
074700     EXEC SQL                                                     08560000
074800          DECLARE BULK_UPC_CUR CURSOR FOR                         08570000
074900           SELECT DISTINCT                                        08580000
075000                  CNUP.UPC_NBR                                    08590000
075100                , CNUP.UPC_UNT_QTY                                08600000
075200                , CNUP.UPC_CART_CNT                               08610000
075300                , CNUP.SKU_NBR                                    08620000
075400                , CNUP.ASN_PKGNG_CDE                              08630000
075500                , CNUP.UPC_CBMT_QTY                               08640000
075600                , CNUP.UPC_WT_KGRM_QTY                            08650000
075700                , PUR.ITM_NBR                                     08660000
075800                , XS.NRF_CLOR_CDE                                 08670000
075900                , XS.CSTM_CLOR_DESC                               08680000
076000                , XS.SIZE_DESC                                    08690000
076100                , XS.SKU_DESC                                     08700000
076200                , XVS.VS_NBR                                      08710000
076300                , SKX.DEPT                                        08720000
076400                , SKX.CLASS                                       08730000
076500                , SKX.SUBCLASS                                    08740000
076600                , SKX.SKU                                         08750000
076610                , PUR.OUTR_PK_QTY                                 08760002
076700             FROM TIMCNUP      CNUP                               08770002
076800                 ,TPURCHS      PO                                 08780002
076900                 ,TPURITM      PUR                                08790002
077000                 ,TUPCSKU      SKU                                08800002
077100                 ,TSKXREF      SKX                                08810002
077200                 ,XLT_SKU      XS                                 08820002
077300                 ,XLT_VND_STYL XVS                                08830002
077400             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        08840002
077500               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   08850002
077600               AND CNUP.PO_NBR         = :IMCNPO-PO-NBR           08860002
077700               AND CNUP.UPC_NBR        =  SKU.UPC_NBR             08870002
077800               AND SKU.ITEM_NBR        =  PUR.ITM_NBR             08880002
077900               AND PUR.ITM_NBR         =  XS.ITM_NBR              08890002
078000               AND XS.STYL_ID          =  XVS.STYL_ID             08900002
078100               AND PUR.VER_STATUS_CDE  = 'A'                      08910002
078200               AND PUR.STATUS_CDE      IN ('AC', 'AP')            08920002
078300               AND PUR.PO_NBR          =  CNUP.PO_NBR             08930002
078400               AND PO.PO_NBR           =  PUR.PO_NBR              08940002
078500               AND PUR.ITM_NBR         =  SKX.ITM_NBR             08950002
078600             ORDER BY CNUP.UPC_NBR                                08960002
078700     END-EXEC.                                                    08970002
078800*                                                                 08980002
078900*                                                                 08990002
079000*  CURSOR DECLARATION TO OBTAIN ALL DISTRIBUTION CENTER SPLITS FOR09000002
079100*  BULK UPCS ON PURCHASE ORDER.                                   09010002
079200*                                                                 09020002
079300*                                                                 09030002
079400     EXEC SQL                                                     09040002
079500          DECLARE DC_CUR CURSOR FOR                               09050002
079600           SELECT                                                 09060002
079700                  AL.DEST_NBR                                     09070002
155029                , XL.E_BUS_IND                                    09080099
079800                , SUM (AL.CURR_SPLIT_QTY) AS SUMSPLIT             09090002
079900             FROM                                                 09100002
080000                  TIMCNUP   CNUP                                  09110002
080100                 ,TUPCSKU   SKU                                   09120002
080200                 ,TPURITM   PUR                                   09130002
080300                 ,TALLPLN   AL                                    09140002
155029                 ,XLT_LOC   XL                                    09150099
080400             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        09160002
080500               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   09170002
080600               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          09180002
080700               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            09190002
155029               AND CNUP.UPC_NBR        =  SKU.UPC_NBR             09200099
080800               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           09210002
080900               AND PUR.VER_STATUS_CDE  = 'A'                      09220002
081000               AND PUR.STATUS_CDE      IN ('AC', 'AP')            09230002
081100               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          09240002
155029               AND AL.DEST_NBR         =  XL.LOC_NBR              09250099
081200               AND AL.PO_NBR           =  PUR.PO_NBR              09260002
081300               AND AL.CURR_SPLIT_QTY   >  0                       09270002
089500            GROUP BY AL.DEST_NBR                                  09280099
155029                    ,XL.E_BUS_IND                                 09290099
155029            ORDER BY XL.E_BUS_IND                                 09300099
089600                    ,SUMSPLIT                                     09310099
089700                    ,AL.DEST_NBR                                  09320099
081700     END-EXEC.                                                    09330002
081800*                                                                 09340002
081900*                                                                 09350002
082000*  CURSOR DECLARATION TO OBTAIN CONTAINER QUANTITIES AT THE PACK  09360002
082100*  LEVEL.                                                         09370002
082200*                                                                 09380002
082300*                                                                 09390002
082400***                                                               09400002
082500     EXEC SQL                                                     09410002
082600          DECLARE PREPACK_CUR CURSOR FOR                          09420002
082700           SELECT DISTINCT                                        09430002
082800                  POP.PO_PREPK_ID                                 09440002
082900                 ,POP.PREPK_UPC_NBR                               09450002
083000                 ,POP.PK_SKU_NBR                                  09460002
083100                 ,POP.INPK_UNT_QTY                                09470002
083200                 ,POP.OTPK_UNT_QTY                                09480002
083200                 ,POP.PREPK_TYP_CDE                               09490019
083300                 ,CNUP.UPC_UNT_QTY                                09500002
083400                 ,CNUP.UPC_CART_CNT                               09510002
083500                 ,CNUP.SKU_NBR                                    09520002
083600                 ,CNUP.ASN_PKGNG_CDE                              09530002
083700                 ,CNUP.UPC_CBMT_QTY                               09540002
083800                 ,CNUP.UPC_WT_KGRM_QTY                            09550002
083900             FROM TIMCNUP   CNUP                                  09560002
084000                 ,TPOPRPK   POP                                   09570002
084100                 ,TPURITM   PUR                                   09580002
084200             WHERE POP.PO_NBR          = :IMCNPO-PO-NBR           09590002
084300               AND PUR.PO_NBR          =  POP.PO_NBR              09600002
084400               AND PUR.PO_PREPK_ID     =  POP.PO_PREPK_ID         09610002
084500               AND PUR.VER_STATUS_CDE  = 'A'                      09620002
084600               AND PUR.STATUS_CDE      IN ('AC', 'AP')            09630002
084700               AND CNUP.PO_NBR         =  POP.PO_NBR              09640002
084800               AND CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        09650002
084900               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   09660002
085000               AND CNUP.UPC_NBR        =  POP.PREPK_UPC_NBR       09670002
085100               AND EXISTS                                         09680002
085200                  (SELECT *                                       09690002
085300                     FROM TPURITM      A                          09700002
085400                         ,TUPCSKU      B                          09710002
085500                         ,TUPC         C                          09720002
085600                         ,TPOPRPK      D                          09730002
085700                         ,TSKXREF      E                          09740002
085800                         ,XLT_VND_STYL XVS                        09750002
085900                         ,XLT_SKU      XS                         09760002
086000                     WHERE A.PO_NBR       = :IMCNPO-PO-NBR        09770002
086100                       AND A.ITM_NBR      =  XS.ITM_NBR           09780002
086200                       AND XS.STYL_ID     =  XVS.STYL_ID          09790002
086300                       AND A.VER_STATUS_CDE = 'A'                 09800002
086400                       AND A.STATUS_CDE  IN ('AC', 'AP')          09810002
086500                       AND A.PO_PREPK_ID  = POP.PO_PREPK_ID       09820002
086600                       AND B.ITEM_NBR     = A.ITM_NBR             09830002
086700                       AND B.UPC_NBR      = C.UPC_NBR             09840002
086800                       AND C.UPC_TYP_CDE  = 'I'                   09850002
086900                       AND C.EFF_END_DTE IS NULL                  09860002
087000                       AND D.PO_PREPK_ID  = A.PO_PREPK_ID         09870002
087100                       AND D.PO_NBR       = A.PO_NBR              09880002
087200                       AND A.ITM_NBR      = E.ITM_NBR             09890002
087300                   )                                              09900002
087400             ORDER BY POP.PO_PREPK_ID                             09910002
087500     END-EXEC.                                                    09920002
087600                                                                  09930002
087700*                                                                 09940002
087800*                                                                 09950002
087900*  CURSOR DECLARATION TO OBTAIN THE ORDERED QUANTITIES AT THE     09960002
088000*  PACK/DC LEVELS                                                 09970002
088100*                                                                 09980002
088200*                                                                 09990002
088300     EXEC SQL                                                     10000002
088400          DECLARE PREPACK_DC_CUR CURSOR FOR                       10010002
088500           SELECT                                                 10020002
088600                  TALL.DEST_NBR                                   10030002
155029                 ,XLT.E_BUS_IND                                   10040099
088700                 ,SUM (TALL.CURR_SPLIT_QTY) AS SUMSPLIT           10050002
088800             FROM                                                 10060002
088900                  TALLPLN   TALL                                  10070002
089000                 ,TPURITM   PUR                                   10080002
155029                 ,XLT_LOC   XLT                                   10090099
089100             WHERE PUR.PO_NBR          = :IMCNPO-PO-NBR           10100002
089200               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      10110002
155029               AND TALL.DEST_NBR       =  XLT.LOC_NBR             10120099
089300               AND PUR.VER_STATUS_CDE  = 'A'                      10130002
089400               AND PUR.STATUS_CDE      IN ('AC', 'AP')            10140002
089500               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          10150002
089600               AND TALL.PO_NBR         =  PUR.PO_NBR              10160002
089700               AND TALL.CURR_SPLIT_QTY >  0                       10170002
089800          GROUP BY TALL.DEST_NBR                                  10180002
155029                  ,XLT.E_BUS_IND                                  10190099
155029          ORDER BY XLT.E_BUS_IND                                  10200099
089900                  ,SUMSPLIT                                       10210099
090000                  ,TALL.DEST_NBR                                  10220002
090100     END-EXEC.                                                    10230002
090200*                                                                 10240002
090300*                                                                 10250002
090400*  CURSOR DECLRATION TO OBTAIN PREPACK UPC LEVEL DATA             10260002
090500*                                                                 10270002
090600*                                                                 10280002
090700     EXEC SQL                                                     10290002
090800          DECLARE PACK_UPC_CUR CURSOR FOR                         10300002
090900           SELECT                                                 10310002
091000                  B.UPC_NBR                                       10320002
091100                , XVS.VS_NBR                                      10330002
091200                , XS.CSTM_CLOR_DESC                               10340002
091300                , XS.SIZE_DESC                                    10350002
091400                , XS.NRF_CLOR_CDE                                 10360002
091500                , XS.SKU_DESC                                     10370002
091600                , A.UNT_QTY                                       10380002
091700                , A.PREPK_RATO_QTY                                10390002
091800                , D.OTPK_UNT_QTY                                  10400002
091900                , D.INPK_UNT_QTY                                  10410002
091900                , D.PREPK_TYP_CDE                                 10420019
092000                , E.DEPT                                          10430002
092100                , E.CLASS                                         10440002
092200                , E.SUBCLASS                                      10450002
092300                , E.SKU                                           10460002
092400             FROM                                                 10470002
092500                  TPURITM      A                                  10480002
092600                 ,TUPCSKU      B                                  10490002
092700                 ,TUPC         C                                  10500002
092800                 ,TPOPRPK      D                                  10510002
092900                 ,TSKXREF      E                                  10520002
093000                 ,XLT_VND_STYL XVS                                10530002
093100                 ,XLT_SKU      XS                                 10540002
093200             WHERE A.PO_NBR       = :IMCNPO-PO-NBR                10550002
093300               AND A.ITM_NBR      =  XS.ITM_NBR                   10560002
093400               AND XS.STYL_ID     =  XVS.STYL_ID                  10570002
093500               AND A.VER_STATUS_CDE = 'A'                         10580002
093600               AND A.STATUS_CDE  IN ('AC', 'AP')                  10590002
093700               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           10600002
093800               AND B.ITEM_NBR     = A.ITM_NBR                     10610002
093900               AND B.UPC_NBR      = C.UPC_NBR                     10620002
094000               AND C.UPC_TYP_CDE  = 'I'                           10630002
094100               AND C.EFF_END_DTE IS NULL                          10640002
094200               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 10650002
094300               AND D.PO_NBR       = A.PO_NBR                      10660002
094400               AND A.ITM_NBR      = E.ITM_NBR                     10670002
094500             ORDER BY B.UPC_NBR                                   10680002
094600     END-EXEC.                                                    10690002
094700*                                                                 10700002
094800*                                                                 10710002
094900*  CURSOR DECLRATION TO OBTAIN E-COMMERCE PREPACK UPC LEVEL DATA  10720002
095000*                                                                 10730002
095100*                                                                 10740002
095200     EXEC SQL                                                     10750002
095300          DECLARE E_COM_PACK_UPC_CUR CURSOR FOR                   10760002
095400           SELECT                                                 10770002
095500                  B.UPC_NBR                                       10780002
095600                 ,A.PO_LNE_NBR                                    10790002
095700             FROM                                                 10800002
095800                  TPURITM  A                                      10810002
095900                 ,TUPCSKU  B                                      10820002
096000                 ,TUPC     C                                      10830002
096100                 ,TPOPRPK  D                                      10840002
096200             WHERE A.PO_NBR       = :IMCNPO-PO-NBR                10850002
096300               AND A.VER_STATUS_CDE = 'A'                         10860002
096400               AND A.STATUS_CDE  IN ('AC', 'AP')                  10870002
096500               AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID           10880002
096600               AND B.ITEM_NBR     = A.ITM_NBR                     10890002
096700               AND B.UPC_NBR      = C.UPC_NBR                     10900002
096800               AND C.UPC_TYP_CDE  = 'I'                           10910002
096900               AND C.EFF_END_DTE IS NULL                          10920002
097000               AND D.PO_PREPK_ID  = A.PO_PREPK_ID                 10930002
097100               AND D.PO_NBR       = A.PO_NBR                      10940002
097200             ORDER BY B.UPC_NBR                                   10950002
097300     END-EXEC.                                                    10960002
097400*                                                                 10970002
097500*                                                                 10980002
097600* CARTON CURSOR                                                   10990002
097700*                                                                 11000002
097800*                                                                 11010002
097900     EXEC SQL                                                     11020002
098000          DECLARE CART_LABEL_CURSOR CURSOR FOR                    11030002
098100           SELECT SSCC_ID                                         11040002
098200                 ,UNT_QTY                                         11050002
098300             FROM TRT_IMPRT_CART                                  11060002
098400             WHERE CONTNR_ID      = :IMCNTK-CONTNR-ID             11070002
098500               AND CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR        11080002
098600               AND PO_NBR         = :IMCNPO-PO-NBR                11090002
098700               AND UPC_NBR        = :IMCNUP-UPC-NBR               11100002
098800          ORDER BY SSCC_ID                                        11110002
098900     END-EXEC.                                                    11120002
099000                                                                  11130002
099100*                                                                 11140002
099200*                                                                 11150002
099300* CONTAINER SEAL CURSOR                                           11160002
099400*                                                                 11170002
099500*                                                                 11180002
099600     EXEC SQL                                                     11190002
099700          DECLARE SEAL_CURSOR CURSOR FOR                          11200002
099800           SELECT SEAL_NBR                                        11210002
099900             FROM TRT_IMPRT_SEAL                                  11220002
100000             WHERE CONTNR_ID      = :TRT00006-CONTNR-ID           11230002
100100               AND CONTNR_SEQ_NBR = :TRT00006-CONTNR-SEQ-NBR      11240002
100200          ORDER BY SEAL_NBR                                       11250002
100300     END-EXEC.                                                    11260002
100400                                                                  11270002
139868*                                                                 11280099
139868*                                                                 11290099
139868*  CURSOR DECLARATION TO OBTAIN THE STORE DISTRIBUTION QUANTITIES 11300099
139868*  FOR BULK UPC'S ON THE PURCHASE ORDER FOR OUTLET STORES         11310099
139868*                                                                 11320099
139868*                                                                 11330099
139868     EXEC SQL                                                     11340099
139868          DECLARE DC_OUT_CUR CURSOR FOR                           11350099
139868           SELECT                                                 11360099
139868                  ES.STR_NBR                                      11370099
139868                , SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             11380099
139868             FROM                                                 11390099
139868                  TIMCNUP   CNUP                                  11400099
139868                 ,TUPCSKU   SKU                                   11410099
139868                 ,TPURITM   PUR                                   11420099
139868                 ,TMESTDS   ES                                    11430099
155029                 ,TALLPLN   PL                                    11440099
139868             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        11450099
139868               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   11460099
155029               AND ES.PLAN_NBR         = :ALLPLN-PLAN-NBR         11470099
155029               AND PL.PLAN_NBR         =  ES.PLAN_NBR             11480099
139868               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          11490099
139868               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            11500099
139868               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           11510099
139868               AND PUR.PO_NBR          =  CNUP.PO_NBR             11520099
155029               AND ES.PO_NBR           =  PL.PO_NBR               11530099
139868               AND PUR.VER_STATUS_CDE  = 'A'                      11540099
139868               AND PUR.STATUS_CDE      IN ('AC', 'AP')            11550099
139868               AND ES.PO_LNE_NBR       =  PUR.PO_LNE_NBR          11560099
139868               AND ES.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         11570099
155029               AND ES.PO_LNE_NBR       =  PL.PO_LNE_NBR           11580099
139868               AND ES.PO_NBR           =  PUR.PO_NBR              11590099
139868               AND ES.STR_DISTRO_QTY   >  0                       11600099
139868            GROUP BY ES.STR_NBR                                   11610099
139868            ORDER BY SUMSPLIT                                     11620099
139868                    ,ES.STR_NBR                                   11630099
139868         WITH UR                                                  11640099
139868     END-EXEC.                                                    11650099
139868*                                                                 11660099
139868*                                                                 11670099
139868*  CURSOR DECLARATION TO OBTAIN THE STORE DISTRIBUTION QUANTITIES 11680099
139868*  AT THE STORE LEVEL FOR OUTLET STORES                           11690099
139868*                                                                 11700099
139868*                                                                 11710099
139868     EXEC SQL                                                     11720099
139868          DECLARE PRPACK_DC_OUT_CUR CURSOR FOR                    11730099
139868           SELECT DISTINCT                                        11740099
139868                  ES.STR_NBR                                      11750099
139868                 ,SUM (ES.STR_DISTRO_QTY) AS SUMSPLIT             11760099
139868             FROM                                                 11770099
139868                  TMESTDS   ES                                    11780099
139868                 ,TPURITM   PUR                                   11790099
139868             WHERE PUR.PO_NBR          = :IMCNPO-PO-NBR           11800099
139868               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      11810099
155029               AND ES.PLAN_NBR         = :ALLPLN-PLAN-NBR         11820099
139868               AND PUR.VER_STATUS_CDE  = 'A'                      11830099
139868               AND PUR.STATUS_CDE      IN ('AC', 'AP')            11840099
139868               AND ES.PO_LNE_NBR       =  PUR.PO_LNE_NBR          11850099
139868               AND ES.PO_NBR           =  PUR.PO_NBR              11860099
139868               AND ES.STR_DISTRO_QTY   >  0                       11870099
139868          GROUP BY ES.STR_NBR                                     11880099
139868          ORDER BY SUMSPLIT                                       11890099
139868                  ,ES.STR_NBR                                     11900099
139868         WITH UR                                                  11910099
139868     END-EXEC.                                                    11920099
139868                                                                  11930099
100500******************************************************************11940002
100600 LINKAGE SECTION.                                                 11950002
100700******************************************************************11960002
100800                                                                  11970002
100900******************************************************************11980002
101000 PROCEDURE DIVISION.                                              11990002
101100******************************************************************12000002
101200                                                                  12010002
101300******************************************************************12020002
101400 0000-PROGRAM-MAINLINE.                                           12030002
101500                                                                  12040002
101800     PERFORM 1000-INITIALIZE.                                     12050002
101900                                                                  12060002
102000     PERFORM 2000-CREATE-EXTRACT-FILES                            12070002
102100         UNTIL PS-EOC-DRIVER-CURSOR                               12080002
102200                                                                  12090002
102300     PERFORM 9000-EOJ-ROUTINE.                                    12100002
102400     STOP RUN.                                                    12110002
102500                                                                  12120002
102600******************************************************************12130002
102700*  FIRST OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO  12140002
102800*  REPORT FILES.                                                  12150002
102900******************************************************************12160002
103000 1000-INITIALIZE.                                                 12170002
103100                                                                  12180002
103200     PERFORM 1100-RETREVE-CURRENT-TIMESTAMP.                      12190002
103300                                                                  12200002
103400     INITIALIZE PA-TOTAL-OUTPUT-REC-COUNT.                        12210002
103500     INITIALIZE PV-HOLD-TR020-PO-NBR                              12220002
103600                PV-HOLD-TR020-CONTNR-ID                           12230002
103700                PV-HOLD-TR020-PROCESS-DATE.                       12240002
103800     INITIALIZE TR006-RECORD.                                     12250002
103900                                                                  12260002
104000     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    12270002
104100                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   12280002
104200                                                                  12290002
104300     PERFORM 6500-GET-CHECKPOINT-CNTL.                            12300002
104400     MOVE PV-CKPT-STAT-CODE       TO                              12310002
104500         PS-RUN-TYPE-SW.                                          12320002
104600                                                                  12330002
104700     IF PS-RESTART-RUN                                            12340002
104800         PERFORM 6550-CHECKPOINT-RESTART                          12350002
104900     END-IF.                                                      12360002
105000                                                                  12370002
105100     MOVE SPACES   TO PV-EXTRACT-TABLE.                           12380002
105200     SET EXT-INDEX TO +1.                                         12390002
105300                                                                  12400002
105400     INITIALIZE TR004-REC-TYPE-POE                                12410002
105500                TR004-REC-TYPE-ETA                                12420002
105600                TR004-REC-TYPE-VES                                12430002
105700                TR004-REC-TYPE-CONTAINER                          12440002
105800                TR004-REC-TYPE-PO                                 12450002
105900                TR004-REC-TYPE-INS                                12460002
106000                TR004-REC-TYPE-UPC                                12470002
106100                TR004-REC-TYPE-DC                                 12480002
106200                TR004-REC-TYPE-DC-CARTON                          12490002
106300                TR004-REC-TYPE-PCK                                12500002
106400                TR004-REC-TYPE-PDC                                12510002
106500                TR004-REC-TYPE-PACK-CARTON                        12520002
106600                TR004-REC-TYPE-CONTAINER-SEAL                     12530002
106700                TR020-REC-TYPE-PO                                 12540002
106800                TR020-REC-TYPE-CONTNR                             12550002
106900                TR020-REC-TYPE-INS                                12560002
107000                TR020-REC-TYPE-UPC                                12570002
107100                TR020-REC-TYPE-DC                                 12580002
107200                TR020-REC-TYPE-DC-CARTON                          12590002
107300                TR020-REC-TYPE-PCK                                12600002
107400                TR020-REC-TYPE-PDC                                12610002
107500                TR020-REC-TYPE-PACK-CART                          12620002
107600                TR020-REC-TYPE-CONTAINER-SEAL.                    12630002
107700                                                                  12640002
107800     MOVE PV-CURRENT-TIME (6:2)   TO TR006-PROCESS-MM.            12650002
107900     MOVE PV-CURRENT-TIME (9:2)   TO TR006-PROCESS-DD.            12660002
108000     MOVE PV-CURRENT-TIME (1:4)   TO TR006-PROCESS-YYYY.          12670002
108100     MOVE TR006-PROCESS-DATE      TO PV-HOLD-TR020-PROCESS-DATE.  12680002
108200                                                                  12690002
108202* PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM              12700016
108210     MOVE 90          TO KRPRPM-LOC-ID.                           12710007
108230     MOVE 'IMP'       TO KRPRPM-INTFC-SYS-CDE.                    12720007
108240     MOVE 'AC'        TO KRPRPM-FUNC-PRC-STAT-CDE.                12730007
108241                                                                  12740009
108242     MOVE 'CNDYBK'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12750009
108250     PERFORM 1110-SELECT-PARMS.                                   12760013
108251     PERFORM 1200-RETRIEVE-BEGIN-ETA-TMST.                        12770015
108255                                                                  12780099
108260     DISPLAY '**********    TRKUP007      **********'             12790015
108500     DISPLAY 'PV-ETA-BEGIN-TMST = '  PV-ETA-BEGIN-TMST.           12800002
108600     DISPLAY 'PV-ETA-BEGIN-DTE  = '  PV-ETA-BEGIN-DTE.            12810002
108601                                                                  12820009
108610     MOVE 'CNDYFW'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12830007
108620     PERFORM 1110-SELECT-PARMS.                                   12840013
108700     PERFORM 1300-RETRIEVE-END-ETA-TMST.                          12850002
108701                                                                  12860099
108800     DISPLAY 'PV-ETA-END-TMST   = ' PV-ETA-END-TMST.              12870002
108901                                                                  12880009
108902     MOVE 'CNDYFL'    TO KRPRPM-SYS-PRC-FUNC-CDE.                 12890009
108903     PERFORM 1110-SELECT-PARMS.                                   12900014
108910     PERFORM 1310-RETRIEVE-END-LANDED_DATE.                       12910008
108920                                                                  12920099
108930     DISPLAY 'PV-ETA-END-DTE    = ' PV-ETA-END-DTE.               12930099
109000     DISPLAY '**************************************'             12940002
109020* PRB0040274 MJF - END                                            12950016
108200                                                                  12960066
109200     PERFORM 7000-OPEN-DRIVER-CURSOR.                             12970002
109300                                                                  12980002
109400     PERFORM 7020-FETCH-DRIVER-CUR.                               12990002
109500                                                                  13000002
109600     IF PS-EOC-DRIVER-CURSOR                                      13010002
109700         CONTINUE                                                 13020002
109800     ELSE                                                         13030002
109900         PERFORM 4600-SET-CHECKPOINT-TIME                         13040002
110000     END-IF.                                                      13050002
110100                                                                  13060002
110200                                                                  13070002
110300                                                                  13080002
110400******************************************************************13090002
110500 1100-RETREVE-CURRENT-TIMESTAMP.                                  13100002
110600                                                                  13110002
110700     EXEC SQL                                                     13120002
110800         SET  :PV-CURRENT-TIME =                                  13130002
110900                 CURRENT TIMESTAMP                                13140002
111000     END-EXEC.                                                    13150002
111100                                                                  13160002
111200     EVALUATE TRUE                                                13170002
111300         WHEN SQLWARN0 NOT EQUAL SPACE                            13180002
111400         WHEN SQLCODE NOT EQUAL ZERO                              13190002
111500             DISPLAY '** ABEND **'                                13200002
111600             DISPLAY '** PROGRAM = TRKUP007 **'                   13210002
111700             DISPLAY '** PARAGRAPH = 1100-RETREVE-CURRENT-TIME**' 13220002
111800             DISPLAY '** UNSUCCESSFUL SELECT OF TIME**'           13230002
111900             PERFORM 9100-SQL-ABEND                               13240002
112000     END-EVALUATE.                                                13250002
112100                                                                  13260002
112200 EJECT                                                            13270002
112210******************************************************************13280013
112220** SELECT PARM - NUMBER OF DAYS TO BE USED IN DATE RANGE CALC   **13290013
112231** PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM             13300016
112240******************************************************************13310013
112250 1110-SELECT-PARMS.                                               13320013
112260                                                                  13330013
112270        EXEC SQL                                                  13340013
112280            SELECT FUNC_QTY                                       13350013
112290              INTO :KRPRPM-FUNC-QTY                               13360013
112291              FROM  TKRPRPM                                       13370013
112292             WHERE  LOC_ID            = :KRPRPM-LOC-ID            13380013
112293               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  13390013
112294               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     13400013
112295               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 13410013
112296             WITH UR                                              13420013
112297        END-EXEC.                                                 13430013
112298                                                                  13440013
112299        EVALUATE TRUE                                             13450013
112300            WHEN SQLCODE = +0                                     13460013
112301                CONTINUE                                          13470013
112302                                                                  13480013
112303            WHEN SQLWARN0 NOT = SPACES                            13490013
112304            WHEN SQLCODE < +0                                     13500013
112305            WHEN SQLCODE > +0                                     13510013
112306             DISPLAY '** ABEND **'                                13520013
112307             DISPLAY '** PROGRAM = TRKUP007 **'                   13530013
112308             DISPLAY '** PARAGRAPH = 1110-SELECT-PARMS **'        13540091
112309             DISPLAY '** KRPRPM-LOC-ID = '                        13550091
112310                           KRPRPM-LOC-ID                          13560091
112311             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE = '              13570091
112312                           KRPRPM-SYS-PRC-FUNC-CDE                13580091
112313             DISPLAY '** KRPRPM-INTFC-SYS-CDE = '                 13590091
112314                           KRPRPM-INTFC-SYS-CDE                   13600091
112315             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             13610091
112316                           KRPRPM-FUNC-PRC-STAT-CDE               13620091
112317             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           13630091
112318             PERFORM 9100-SQL-ABEND                               13640091
112319        END-EVALUATE.                                             13650013
112320                                                                  13660013
112321      EJECT                                                       13670013
139868******************************************************************13680099
139868** SELECT PARM - CHECK IF THIS IS AN OUTLET STORE               **13690099
139868******************************************************************13700099
139868 1120-SELECT-OUTLET-PARM.                                         13710099
139868                                                                  13720099
139868     MOVE 'TRCNSP'             TO KRPRPM-SYS-PRC-FUNC-CDE.        13730099
139868     MOVE 'KHL'                TO KRPRPM-INTFC-SYS-CDE.           13740099
139868     MOVE 'AC'                 TO KRPRPM-FUNC-PRC-STAT-CDE.       13750099
139868     MOVE 'Y'                  TO KRPRPM-FUNC-TXT.                13760099
139868                                                                  13770099
139868        EXEC SQL                                                  13780099
139868            SELECT LOC_ID                                         13790099
139868              INTO :KRPRPM-LOC-ID                                 13800099
139868              FROM  TKRPRPM                                       13810099
139868             WHERE  LOC_ID            = :KRPRPM-LOC-ID            13820099
139868               AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE  13830099
139868               AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE     13840099
139868               AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE 13850099
139868               AND  FUNC_TXT          = :KRPRPM-FUNC-TXT          13860099
139868             WITH UR                                              13870099
139868        END-EXEC.                                                 13880099
139868                                                                  13890099
139868        EVALUATE TRUE                                             13900099
139868            WHEN SQLCODE = +0                                     13910099
139868                SET PS-OUTLET-STORE     TO TRUE                   13920099
139868                                                                  13930099
139868            WHEN SQLCODE = +100                                   13940099
139868                SET PS-OUTLET-STORE-NO  TO TRUE                   13950099
139868                                                                  13960099
139868            WHEN SQLWARN0 NOT = SPACES                            13970099
139868            WHEN SQLCODE < +0                                     13980099
139868            WHEN SQLCODE > +0                                     13990099
139868             DISPLAY '** ABEND **'                                14000099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   14010099
139868             DISPLAY '** PARAGRAPH = 1120-SELECT-OUTLET-PARM **'  14020099
139868             DISPLAY '** KRPRPM-LOC-ID            = '             14030099
139868                                          KRPRPM-LOC-ID           14040099
139868             DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE  = '             14050099
139868                                          KRPRPM-SYS-PRC-FUNC-CDE 14060099
139868             DISPLAY '** KRPRPM-INTFC-SYS-CDE     = '             14070099
139868                                          KRPRPM-INTFC-SYS-CDE    14080099
139868             DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '             14090099
139868                                          KRPRPM-FUNC-PRC-STAT-CDE14100099
139868             DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'           14110099
139868             PERFORM 9100-SQL-ABEND                               14120099
139868        END-EVALUATE.                                             14130099
139868                                                                  14140099
112330******************************************************************14150002
112400 1200-RETRIEVE-BEGIN-ETA-TMST.                                    14160002
112401                                                                  14170007
112420* PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM              14180016
112500                                                                  14190002
112610     EXEC SQL                                                     14200011
112700         SELECT                                                   14210002
112740              CURRENT_TIMESTAMP - (:KRPRPM-FUNC-QTY) DAYS         14220011
112741             ,CURRENT_DATE - (:KRPRPM-FUNC-QTY) DAYS              14230011
113000          INTO :PV-ETA-BEGIN-TMST,                                14240002
113100               :PV-ETA-BEGIN-DTE                                  14250002
113200          FROM TCKRSTCNTL                                         14260002
113300         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   14270002
113400           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               14280002
113500     END-EXEC.                                                    14290002
113600                                                                  14300002
113700     EVALUATE TRUE                                                14310002
113800         WHEN SQLWARN0 NOT EQUAL SPACE                            14320002
113900         WHEN SQLCODE NOT EQUAL ZERO                              14330002
114000            DISPLAY '** ABEND **'                                 14340002
114100            DISPLAY '** PROGRAM = TRKUP007 **'                    14350002
114200            DISPLAY '** PARAGRAPH = 1200-RETRIEVE-BEGIN-ETA-TMST' 14360002
114300            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED TIME**' 14370002
114310            DISPLAY '** KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY       14380012
114400            PERFORM 9100-SQL-ABEND                                14390002
114500     END-EVALUATE.                                                14400002
114600                                                                  14410002
114720******************************************************************14420002
114800 1300-RETRIEVE-END-ETA-TMST.                                      14430002
114900                                                                  14440002
114911* PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM              14450016
114920                                                                  14460007
114930     EXEC SQL                                                     14470007
114940         SELECT                                                   14480007
114960          CURRENT_TIMESTAMP + (:KRPRPM-FUNC-QTY) DAYS             14490011
115400          INTO :PV-ETA-END-TMST                                   14500008
115600          FROM TCKRSTCNTL                                         14510002
115700         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   14520002
115800           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               14530002
115900     END-EXEC.                                                    14540002
116000                                                                  14550002
116100     EVALUATE TRUE                                                14560002
116200         WHEN SQLWARN0 NOT EQUAL SPACE                            14570002
116300         WHEN SQLCODE NOT EQUAL ZERO                              14580002
116400            DISPLAY '** ABEND **'                                 14590002
116500            DISPLAY '** PROGRAM = TRKUP007 **'                    14600002
116600            DISPLAY '** PARAGRAPH = 1300-RETRIEVE-END-ETA-TMST'   14610002
116700            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED TIME**' 14620002
116800            DISPLAY 'KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY          14630008
117000            PERFORM 9100-SQL-ABEND                                14640002
117100     END-EVALUATE.                                                14650002
117200                                                                  14660002
117210******************************************************************14670008
117220 1310-RETRIEVE-END-LANDED_DATE.                                   14680008
117230                                                                  14690008
117241* PRB0040274 MJF 03/20/2013 REPLACE HARDCODE W/ PARM              14700016
117250                                                                  14710008
117260     EXEC SQL                                                     14720008
117270         SELECT                                                   14730008
117291          CURRENT_DATE + (:KRPRPM-FUNC-QTY) DAYS                  14740011
117297          INTO :PV-ETA-END-DTE                                    14750008
117298          FROM TCKRSTCNTL                                         14760008
117299         WHERE JOB_NAME  = :PC-CURRENT-JOB-NAME                   14770008
117300           AND PLAN_NAME = :PC-CURRENT-PROGRAM-NAME               14780008
117301     END-EXEC.                                                    14790008
117302                                                                  14800008
117303     EVALUATE TRUE                                                14810008
117304         WHEN SQLWARN0 NOT EQUAL SPACE                            14820008
117305         WHEN SQLCODE NOT EQUAL ZERO                              14830008
117306            DISPLAY '** ABEND **'                                 14840008
117307            DISPLAY '** PROGRAM = TRKUP007 **'                    14850008
117308            DISPLAY '** PARAGRAPH = 1310-RETRIEVE-END-LANDED_DATE'14860008
117309            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED DATE**' 14870009
117310            DISPLAY 'KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY          14880008
117312            PERFORM 9100-SQL-ABEND                                14890008
117313     END-EVALUATE.                                                14900008
117314                                                                  14910008
117320 EJECT                                                            14920008
117400******************************************************************14930002
117500* PROCESS:  THIS PARAGRAPH WILL SET UP AND WRITE EXTRACT RECORDS  14940002
117600******************************************************************14950002
117700 2000-CREATE-EXTRACT-FILES.                                       14960002
117800                                                                  14970002
117900     IF IMCNTK-CONTNR-ID = PV-HOLD-CONTNR-ID                      14980002
118000       CONTINUE                                                   14990002
118100     ELSE                                                         15000002
118200        IF PS-NEED-SEALS                                          15010002
118300           PERFORM 8752-OPEN-SEAL-CURSOR                          15020002
118400           SET PS-EOC-SEAL-CURSOR-NO TO TRUE                      15030002
118500           PERFORM 2900-SEAL-CURSOR-FOR-XMIT                      15040002
118600             UNTIL PS-EOC-SEAL-CURSOR                             15050002
118700           PERFORM 8754-CLOSE-SEAL-CURSOR                         15060002
118800           SET PS-NEED-SEALS-NO TO TRUE                           15070002
118900        END-IF                                                    15080002
119000     END-IF.                                                      15090002
119100                                                                  15100002
119200     IF  IMCNTK-MOM-DEST-POE-CDE = PV-HOLD-MOM-DEST-POE           15110002
119300        CONTINUE                                                  15120002
119400     ELSE                                                         15130002
119500        MOVE IMCNTK-MOM-DEST-POE-CDE                              15140002
119600                              TO PV-HOLD-MOM-DEST-POE             15150002
119700        PERFORM 7100-GET-POE-CITY                                 15160002
119800        IF PS-POE-CITY-FOUND                                      15170002
119900          MOVE IMPOE-POE-CTY-NM TO TR004-PORT-OF-ENTRY-CTY        15180002
120000        ELSE                                                      15190002
120100          MOVE 'POE CITY NOT FOUND'                               15200002
120200                                TO TR004-PORT-OF-ENTRY-CTY        15210002
120300        END-IF                                                    15220002
120400*       ********************************************************  15230002
120500*       * EVEN THOUGH THE MOM-DEST-POE-CODES ARE DIFFERENT THE *  15240002
120600*       * PROCESS CAN TURN UP THE SAME POE CITY NAME.          *  15250002
120700*       ********************************************************  15260002
120800        IF TR004-PORT-OF-ENTRY-CTY = PV-HOLD-PORT-OF-ENTRY-CTY    15270002
120900          CONTINUE                                                15280002
121000        ELSE                                                      15290002
121100          SET TR004-PROCESS-POE-TRANSMISSION TO TRUE              15300002
121200          MOVE TR004-PORT-OF-ENTRY-CTY                            15310002
121300                                  TO PV-HOLD-PORT-OF-ENTRY-CTY    15320002
121400          SET PS-POE-WRITTEN-NO TO TRUE                           15330002
121500          SET PS-ETA-WRITTEN-NO TO TRUE                           15340002
121600          SET PS-VES-WRITTEN-NO TO TRUE                           15350002
121700          SET PS-CMN-WRITTEN-NO TO TRUE                           15360002
121800        END-IF                                                    15370002
121900     END-IF.                                                      15380002
122000                                                                  15390002
122100     IF IMCNTK-MOM-POE-DELY-TMST (1:10)                           15400002
122200                              = PV-HOLD-MOM-POE-DELY-TMST         15410002
122300         CONTINUE                                                 15420002
122400     ELSE                                                         15430002
122500         INITIALIZE TR004-REC-TYPE-ETA                            15440002
122600         SET TR004-PROCESS-ETA-TRANSMISSION TO TRUE               15450002
122700                                                                  15460002
122800         MOVE IMCNTK-MOM-POE-DELY-TMST (1:4) TO                   15470002
122900             TR004-VESSEL-ETA-DATE (1:4)                          15480002
123000         MOVE IMCNTK-MOM-POE-DELY-TMST (6:2) TO                   15490002
123100             TR004-VESSEL-ETA-DATE (5:2)                          15500002
123200         MOVE IMCNTK-MOM-POE-DELY-TMST (9:2) TO                   15510002
123300             TR004-VESSEL-ETA-DATE (7:2)                          15520002
123400         MOVE TR004-VESSEL-ETA-DATE     TO                        15530002
123500             TR020-VESSEL-ETA-DATE-CONTNR                         15540002
123600         MOVE IMCNTK-MOM-POE-DELY-TMST (1:10) TO                  15550002
123700             PV-HOLD-MOM-POE-DELY-TMST                            15560002
123800         SET PS-ETA-WRITTEN-NO TO TRUE                            15570002
123900         SET PS-VES-WRITTEN-NO TO TRUE                            15580002
124000         SET PS-CMN-WRITTEN-NO TO TRUE                            15590002
124100     END-IF.                                                      15600002
124200                                                                  15610002
124300     IF IMCNTK-MOM-IMPRT-VEH-NM  =  PV-HOLD-MOM-IMPRT-VEH-NM      15620002
124400         CONTINUE                                                 15630002
124500     ELSE                                                         15640002
124600         INITIALIZE TR004-REC-TYPE-VES                            15650002
124700         SET TR004-PROCESS-VES-TRANSMISSION TO TRUE               15660002
124800         MOVE IMCNTK-MOM-IMPRT-VEH-NM TO TR004-VESSEL-NAME        15670002
124900                                  TR020-VESSEL-NAME-CONTNR        15680002
125000         MOVE IMCNTK-MOM-TRIP-TYP-CDE TO TR004-TRIP-TYP-CDE       15690002
125100                                  TR020-TRIP-TYP-CDE-CONTNR       15700002
125200         MOVE IMCNTK-MOM-IMPRT-VEH-NM TO PV-HOLD-MOM-IMPRT-VEH-NM 15710002
125300         MOVE IMCNTK-MOM-IMPRT-TRIP-ID                            15720002
125400                                 TO TR004-VOYAGE-ID-NBR           15730002
125500                                    TR020-VOYAGE-ID-NBR-CONTNR    15740002
125600         MOVE IMCNTK-MOM-CARR-SCAC-ID                             15750002
125700                                 TO TR004-CARR-SCAC-ID            15760002
125800                                    TR020-CARR-SCAC-ID-CONTNR     15770002
125900         SET PS-VES-WRITTEN-NO TO TRUE                            15780002
126000         SET PS-CMN-WRITTEN-NO TO TRUE                            15790002
126100     END-IF.                                                      15800002
126200                                                                  15810002
126300     INITIALIZE TR004-REC-TYPE-CONTAINER.                         15820002
126400     MOVE IMCNTK-CONTNR-ID    TO TR004-CONTNR-ID                  15830002
126500                                 PV-HOLD-TR020-CONTNR-ID.         15840002
126600     MOVE PV-HOLD-MOM-DEST-POE     TO TR004-POE-CDE.              15850002
126700     MOVE IMCNTK-SIZE-CDE      TO TR004-CONTNR-SIZE-CDE           15860002
126800                               TR020-CONTNR-SIZE-CDE-CONTNR.      15870002
126900     SET PS-CMN-WRITTEN-NO TO TRUE.                               15880002
127000                                                                  15890002
127100     PERFORM 7600-OPEN-PO-CURSOR.                                 15900002
127200     SET PS-EOC-PO-CURSOR-NO      TO TRUE.                        15910002
127300     PERFORM 2200-PROCESS-PO UNTIL                                15920002
127400                               PS-EOC-PO-CURSOR.                  15930002
127500                                                                  15940002
127600     PERFORM 4400-CHECKPOINT-CHECK.                               15950002
127700                                                                  15960002
127800     INITIALIZE TR006-RECORD.                                     15970002
127900     PERFORM 7020-FETCH-DRIVER-CUR.                               15980002
128000                                                                  15990002
128100                                                                  16000002
128200******************************************************************16010002
128300* PROCESS ALL PURCHASE ORDERS FOR THIS CONTAINER.                *16020002
128400******************************************************************16030002
128500 2200-PROCESS-PO.                                                 16040002
128600                                                                  16050002
128700     SET PS-PO-PASSES-XMIT-TEST-NO   TO TRUE.                     16060002
128800     PERFORM 7800-FETCH-VALIDATE-PO-CURSOR                        16070002
128900          UNTIL PS-PO-PASSES-XMIT-TEST                            16080002
129000             OR PS-EOC-PO-CURSOR.                                 16090002
129100                                                                  16100002
129200     IF PS-EOC-PO-CURSOR                                          16110002
129300         PERFORM 7700-CLOSE-PO-CURSOR                             16120002
129400     ELSE                                                         16130002
129500         INITIALIZE TR004-REC-TYPE-PO                             16140002
129600                    PV-HOLD-PO-NBR                                16150002
129700         MOVE IMCNTK-CONTNR-ID  TO TR004-CONTNR-ID                16160002
129800         MOVE IMCNPO-PO-NBR     TO TR020-PO-NBR-CONTNR            16170002
129900                                   TR004-PO-NBR                   16180002
130000                                   PV-HOLD-TR020-PO-NBR           16190002
130100                                                                  16200002
130200         PERFORM 2260-SELECT-PLNSHP-DATES                         16210002
130300         SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE                  16220002
130400         PERFORM 2250-SELECT-TPURCHS-INFO                         16230002
155029         PERFORM 6600-FAST-PARM-CHECK                             16240099
130500                                                                  16250002
130600         IF PS-PO-SEL-INFO-PRESENT                                16260002
130700           IF PURCHS-STATUS-CDE = 'AC' OR 'AP' OR 'CA' OR 'CM'    16270002
130800             CONTINUE                                             16280002
130900           ELSE                                                   16290002
131000             SET PS-PO-SEL-INFO-PRESENT-NO    TO TRUE             16300002
131100             SET TR006-ERROR-TYPE-ERROR       TO TRUE             16310002
131200             INITIALIZE TR006-ERROR-MSG                           16320002
131300             STRING 'CMN-PO INVALID STATUS-NOT SNT-',             16330002
131400                 PURCHS-STATUS-CDE                                16340002
131500                 DELIMITED BY SIZE                                16350002
131600                 INTO TR006-ERROR-MSG                             16360002
131700             PERFORM 8830-WRITE-ERROR-LINE                        16370002
131800           END-IF                                                 16380002
131900         END-IF                                                   16390002
132000                                                                  16400002
132100         IF PS-PO-SEL-INFO-PRESENT                                16410002
132200           IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-B             16420002
132300                              OR PC-C OR PC-S OR SPACES           16430002
132400             CONTINUE                                             16440002
132500           ELSE                                                   16450002
132600               SET PS-PO-SEL-INFO-PRESENT-NO   TO TRUE            16460002
132700               SET TR006-ERROR-TYPE-ERROR      TO TRUE            16470002
132800               INITIALIZE TR006-UPC-NBR                           16480002
132900                          TR006-ERROR-MSG                         16490002
133000               STRING  'CMN-PO-INVALID PKG CD-NOT SENT-',         16500002
133100                       PURCHS-PKGNG-CDE                           16510002
133200                   DELIMITED BY SIZE                              16520002
133300                   INTO TR006-ERROR-MSG                           16530002
133400               PERFORM 8830-WRITE-ERROR-LINE                      16540002
133500         END-IF                                                   16550002
133600                                                                  16560002
133700         IF PS-PO-SEL-INFO-PRESENT                                16570002
133800           SET PS-IMCNRL-INFO-PRESENT-NO  TO TRUE                 16580002
133900           PERFORM 4020-SELECT-IMCNRL-FOR-AUDIT                   16590002
134000                                                                  16600002
134100             IF PS-IMCNRL-INFO-PRESENT                            16610002
134200               SET PS-PROBLEM-DO-NOT-SEND-NO TO TRUE              16620002
134300               SET PS-SPLITS-ENTERED            TO TRUE           16630002
134400*              **********************************                 16640002
134500               PERFORM 2210-CREATE-PO                             16650002
134600*              **********************************                 16660002
134700               PERFORM 4000-SELECT-IMCNPO-FOR-AUDIT               16670002
134800                                                                  16680002
134900               EVALUATE TRUE                                      16690002
135000                                                                  16700002
135100                 WHEN PS-PROBLEM-DO-NOT-SEND                      16710002
135200                                                                  16720002
135300                    CONTINUE                                      16730002
135400                                                                  16740002
135500                 WHEN OTHER                                       16750002
135600                                                                  16760002
135700                    IF PS-SPLITS-ENTERED-NO                       16770002
135800                      MOVE PC-S TO IMCNRL-DCONSLR-RLSE-CDE        16780002
135900                                   IMCNPO-SPLT-XMIT-CDE           16790002
136000                    ELSE                                          16800002
136100                      MOVE PC-Y TO IMCNRL-DCONSLR-RLSE-CDE        16810002
136200                                   IMCNPO-SPLT-XMIT-CDE           16820002
136300                    END-IF                                        16830099
136400                    PERFORM 2270-UPDATE-TIMCNPO                   16840099
136500                    PERFORM 2280-UPDATE-TIMCNRL                   16850099
136600                    PERFORM 3000-WRITE-OUT-GOOD-PO-RECS           16860099
136700                                                                  16870002
136800               END-EVALUATE                                       16880002
136900                                                                  16890002
137000               MOVE SPACES   TO PV-EXTRACT-TABLE                  16900002
137100               SET EXT-INDEX TO +1                                16910002
137200             END-IF                                               16920002
137300                                                                  16930002
137400         END-IF                                                   16940002
137500                                                                  16950002
137600     END-IF.                                                      16960002
137700*                                                                 16970002
137800*                                                                 16980002
137900******************************************************************16990002
138000* CREATE PURCHASE ORDER RECORDS FOR EXTRACT (TOUTTR2).           *17000002
138100******************************************************************17010002
138200 2210-CREATE-PO.                                                  17020002
138300                                                                  17030002
138400     MOVE IMCNPO-PO-UNT-QTY       TO TR004-PO-UNIT-QTY            17040002
138500                                     TR020-UNIT-QTY-CONTNR.       17050002
138600     MOVE PURCHS-PO-TYP-CDE       TO TR004-PO-TYP-CDE             17060002
138700                                     TR020-PO-TYP-CDE-PO.         17070002
138800     MOVE IMCNPO-EXTL-REF-NBR     TO TR004-EXTL-REF-NBR           17080002
138900                                     TR020-EXTL-REF-CONTNR.       17090002
139000     PERFORM 2220-SELECT-SUM-UPC-CART.                            17100002
139100     MOVE PV-SUM-INCNUP-CART-CNT   TO TR004-CART-PER-PO           17110002
139200                                      TR020-EXP-CART-CT-CONTNR.   17120002
139300     PERFORM 2215-SELECT-ENTITY-NAME-DESCR.                       17130002
139400                                                                  17140002
139500     PERFORM 2217-SELECT-AD-DATE.                                 17150002
139600                                                                  17160002
139700     MOVE PURCHS-OTB-PER-NBR      TO TR004-OPEN-TO-BUY-PERIOD.    17170002
139800                                                                  17180002
139900     MOVE PURCHS-PKGNG-CDE        TO TR004-PKGNG-CDE              17190021
140000                                     TR006-PKGNG-CDE.             17200002
140100                                                                  17210002
140200                                                                  17220002
140300     PERFORM 5400-WRITE-PUR-ORDER-PO-RECORD.                      17230002
140400                                                                  17240002
140500     PERFORM 2300-PROCESS-INSTRUCTION-LINES.                      17250002
140600                                                                  17260002
140700     IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           17270002
140800         PERFORM 8735-OPEN-PACK-CURSOR                            17280002
140900         SET  PS-PREPACKS-FOR-PO-NO       TO TRUE                 17290002
141000         PERFORM 2350-PROCESS-PACKS-IDS                           17300002
141100                UNTIL PS-EOC-PACK-CURSOR                          17310002
141200         SET PS-EOC-PACK-CURSOR-NO TO TRUE                        17320002
141300     ELSE                                                         17330002
141400         PERFORM 8200-OPEN-BULK-UPC-CUR                           17340002
141500         SET PS-UPCS-ON-TIMCNUP-NO        TO TRUE                 17350002
141600         PERFORM 2400-PROCESS-UPC-FOR-BULK UNTIL                  17360002
141700                 PS-EOC-BULK-UPC-CUR                              17370002
141800         SET PS-EOC-BULK-UPC-CUR-NO       TO TRUE                 17380002
141900     END-IF.                                                      17390002
142000                                                                  17400002
142100******************************************************************17410002
142200 2215-SELECT-ENTITY-NAME-DESCR.                                   17420002
142300*                                                                 17430002
142400     EXEC SQL                                                     17440002
142500           SELECT DISTINCT                                        17450002
142600                  EN.ENT_NAME_DESC                                17460002
142700             INTO                                                 17470002
142800                  :ENTNME-ENT-NAME-DESC                           17480002
142900             FROM                                                 17490002
143000                  TPURCHS   PO                                    17500002
143100                , TENTNME   EN                                    17510002
143200             WHERE PO.PO_NBR     =  :IMCNPO-PO-NBR                17520002
143300               AND PO.ENT_ID     =  EN.ENT_ID                     17530002
143400               AND PO.VER_STATUS_CDE = 'A'                        17540002
143500               AND EN.TYPE_CDE = '01'                             17550002
143600     END-EXEC                                                     17560002
143700                                                                  17570002
143800     EVALUATE TRUE                                                17580002
143900         WHEN SQLCODE = ZERO                                      17590002
144000             MOVE ENTNME-ENT-NAME-DESC  TO                        17600002
144100                 TR004-VENDOR-NAME                                17610002
144200                                                                  17620002
144300         WHEN SQLCODE = +100                                      17630002
144400             CONTINUE                                             17640002
144500         WHEN SQLWARN0 NOT EQUAL SPACE                            17650002
144600         WHEN SQLCODE NOT EQUAL ZERO                              17660002
144700             DISPLAY '** ABEND **'                                17670002
144800             DISPLAY '** PROGRAM = TRKUP007 **'                   17680002
144900             DISPLAY '** PARAGRAPH = 2215-PROCESS-PO**'           17690002
145000             PERFORM 9100-SQL-ABEND                               17700002
145100     END-EVALUATE.                                                17710002
145200******************************************************************17720002
145300*  GET THE EARLIEST ADVERTISING DATE                              17730002
145400******************************************************************17740002
145500 2217-SELECT-AD-DATE.                                             17750002
145600*                                                                 17760002
145700     EXEC SQL                                                     17770002
145800         SELECT  MIN(AD_EVNT_DTE)                                 17780002
145900           INTO  :PURITM-AD-EVNT-DTE                              17790002
146000           FROM  TPURITM                                          17800002
146100          WHERE  PO_NBR         = :IMCNPO-PO-NBR                  17810002
146200            AND  AD_EVNT_DTE   <> '0001-01-01'                    17820002
146300            AND  VER_STATUS_CDE = 'A'                             17830002
146400            AND  STATUS_CDE    IN ('AC', 'AP')                    17840002
146500     END-EXEC                                                     17850002
146600                                                                  17860002
146700     EVALUATE TRUE                                                17870002
146800         WHEN SQLCODE = +0                                        17880002
146900              MOVE PURITM-AD-EVNT-DTE (1:4)                       17890002
147000                                   TO TR004-AD-DATE (1:4)         17900002
147100              MOVE PURITM-AD-EVNT-DTE (6:2)                       17910002
147200                                   TO TR004-AD-DATE (5:2)         17920002
147300              MOVE PURITM-AD-EVNT-DTE (9:2)                       17930002
147400                                   TO TR004-AD-DATE (7:2)         17940002
147500                                                                  17950002
147600         WHEN SQLCODE =  100                                      17960002
147700         WHEN SQLCODE = -305                                      17970002
147800              MOVE SPACES     TO TR004-AD-DATE                    17980002
147900                                                                  17990002
148000         WHEN SQLWARN0 NOT = SPACE                                18000002
148100         WHEN SQLCODE  NOT = +0                                   18010002
148200             DISPLAY '** ABEND **'                                18020002
148300             DISPLAY '** PROGRAM = TRKUP007 **'                   18030002
148400             DISPLAY '** PARAGRAPH = 2217-SELECT-AD-DATE'         18040002
148500             PERFORM 9100-SQL-ABEND                               18050002
148600     END-EVALUATE.                                                18060002
148700                                                                  18070002
148800******************************************************************18080002
148900* THIS USED ONLY TO GET TR004-CART-PER-PO                        *18090002
149000******************************************************************18100002
149100 2220-SELECT-SUM-UPC-CART.                                        18110002
149200                                                                  18120002
149300     MOVE ZERO            TO PV-SUM-INCNUP-CART-CNT.              18130002
149400     EXEC SQL                                                     18140002
149500           SELECT                                                 18150002
149600                 SUM (A.UPC_CART_CNT)                             18160002
149700             INTO                                                 18170002
149800                :PV-SUM-INCNUP-CART-CNT                           18180002
149900             FROM                                                 18190002
150000                  TIMCNUP  A                                      18200002
150100             WHERE A.PO_NBR         = :IMCNPO-PO-NBR              18210002
150200               AND A.CONTNR_ID      = :IMCNTK-CONTNR-ID           18220002
150300               AND A.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR      18230002
150400     END-EXEC.                                                    18240002
150500                                                                  18250002
150600     EVALUATE TRUE                                                18260002
150700         WHEN SQLCODE = ZERO                                      18270002
150800             CONTINUE                                             18280002
150900         WHEN SQLCODE = +100                                      18290002
151000         WHEN SQLCODE = -305                                      18300002
151100             MOVE ZEROES     TO PV-SUM-INCNUP-CART-CNT            18310002
151200                                                                  18320002
151300         WHEN SQLWARN0 NOT EQUAL SPACE                            18330002
151400         WHEN SQLCODE NOT EQUAL ZERO                              18340002
151500             DISPLAY '** ABEND **'                                18350002
151600             DISPLAY '** PROGRAM = TRKUP007 **'                   18360002
151700             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          18370002
151800             DISPLAY '** PARA = 2220-SELECT-SUM-UPC-CART **'      18380002
151900             PERFORM 9100-SQL-ABEND                               18390002
152000     END-EVALUATE.                                                18400002
152100                                                                  18410002
152200 EJECT                                                            18420002
152300******************************************************************18430002
152400 2250-SELECT-TPURCHS-INFO.                                        18440002
152500*                                                                 18450002
152600     EXEC SQL                                                     18460002
152700           SELECT DISTINCT                                        18470002
152800                  PO.STATUS_CDE                                   18480002
152900                , PO.PO_NBR                                       18490002
153000                , PO.OTB_PER_NBR                                  18500002
153100                , PO.NEW_STR_PO_IND                               18510002
153200                , PO.PKGNG_CDE                                    18520002
153300                , PO.DEPT_NBR                                     18530002
153400                , PO_TYP_CDE                                      18540002
153500             INTO                                                 18550002
153600                  :PURCHS-STATUS-CDE                              18560002
153700                , :PURCHS-PO-NBR                                  18570002
153800                , :PURCHS-OTB-PER-NBR                             18580002
153900                , :PURCHS-NEW-STR-PO-IND                          18590002
154000                , :PURCHS-PKGNG-CDE                               18600002
154100                , :PURCHS-DEPT-NBR                                18610002
154200                , :PURCHS-PO-TYP-CDE                              18620002
154300             FROM                                                 18630002
154400                  TPURCHS   PO                                    18640002
154500             WHERE PO.PO_NBR     =  :IMCNPO-PO-NBR                18650002
154600               AND PO.VER_STATUS_CDE = 'A'                        18660002
154700     END-EXEC                                                     18670002
154800                                                                  18680002
154900     EVALUATE TRUE                                                18690002
155000         WHEN SQLCODE = ZERO                                      18700002
155100             SET PS-PO-SEL-INFO-PRESENT TO TRUE                   18710002
155200             INITIALIZE TR006-DEPT-NBR                            18720002
155300                        PV-TR006-DEPT-NBR                         18730002
155400             MOVE PURCHS-DEPT-NBR   TO PV-TR006-DEPT-NBR-3        18740002
155500             MOVE PV-TR006-DEPT-NBR TO TR006-DEPT-NBR             18750002
155600                                                                  18760002
155700         WHEN SQLCODE = +100                                      18770002
155800             INITIALIZE TR006-DEPT-NBR                            18780002
155900                        TR006-ERROR-MSG                           18790002
156000             SET TR006-ERROR-TYPE-ERROR       TO TRUE             18800002
156100             STRING 'CMN-PO MISSING-NOT SENT'                     18810002
156200                 DELIMITED BY SIZE                                18820002
156300                 INTO TR006-ERROR-MSG                             18830002
156400             PERFORM 8830-WRITE-ERROR-LINE                        18840002
156500                                                                  18850002
156600         WHEN SQLWARN0 NOT EQUAL SPACE                            18860002
156700         WHEN SQLCODE NOT EQUAL ZERO                              18870002
156800             DISPLAY '** ABEND **'                                18880002
156900             DISPLAY '** PROGRAM = TRKUP007 **'                   18890002
157000             DISPLAY '** PARAGRAPH = 2250-SELECT-TPURCHS-INFO***' 18900002
157100             DISPLAY 'IMCNPO-PO-NBR = ' IMCNPO-PO-NBR             18910002
157200             PERFORM 9100-SQL-ABEND                               18920002
157300     END-EVALUATE.                                                18930002
157400                                                                  18940002
157500******************************************************************18950002
157600 2260-SELECT-PLNSHP-DATES.                                        18960002
157700*                                                                 18970002
157800     EXEC SQL                                                     18980002
157900           SELECT DISTINCT                                        18990002
158000                  PL.DONT_SHIP_BEF_DTE                            19000002
158100                , PL.CAN_IFNOT_SHIP_DTE                           19010002
158200                , PL.EXT_CAN_DTE                                  19020002
158300             INTO                                                 19030002
158400                  :PLNSHP-DONT-SHIP-BEF-DTE                       19040002
158500                , :PLNSHP-CAN-IFNOT-SHIP-DTE                      19050002
158600                , :PLNSHP-EXT-CAN-DTE                             19060002
158700             FROM                                                 19070002
158800                  TPLNSHP   PL                                    19080002
158900             WHERE PL.PO_NBR     =  :IMCNPO-PO-NBR                19090002
159000               AND PL.VER_STATUS_CDE = 'A'                        19100002
159100     END-EXEC                                                     19110002
159200                                                                  19120002
159300     EVALUATE TRUE                                                19130002
159400         WHEN SQLCODE = ZERO                                      19140002
159500             MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO               19150002
159600                 TR004-DO-NOT-SHIP-BEF-DTE (1:4)                  19160002
159700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               19170002
159800                 TR004-DO-NOT-SHIP-BEF-DTE (5:2)                  19180002
159900             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               19190002
160000                 TR004-DO-NOT-SHIP-BEF-DTE (7:2)                  19200002
160100                                                                  19210002
160200             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               19220002
160300             MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2) TO               19230002
160400                 TR006-DONT-SHIP-BEFORE-DATE (5:2)                19240002
160500             MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO               19250002
160600                 TR006-DONT-SHIP-BEFORE-DATE (1:2)                19260002
160700             MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO               19270002
160800                 TR006-DONT-SHIP-BEFORE-DATE (3:2)                19280002
160900                                                                  19290002
161000             IF PLNSHP-EXT-CAN-DTE = '0001-01-01'                 19300002
161100                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(1:4) TO           19310002
161200                     TR004-CANCEL-DATE (1:4)                      19320002
161300                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(6:2) TO           19330002
161400                     TR004-CANCEL-DATE (5:2)                      19340002
161500                 MOVE PLNSHP-CAN-IFNOT-SHIP-DTE(9:2) TO           19350002
161600                     TR004-CANCEL-DATE (7:2)                      19360002
161700              ELSE                                                19370002
161800                 MOVE PLNSHP-EXT-CAN-DTE(1:4) TO                  19380002
161900                     TR004-CANCEL-DATE (1:4)                      19390002
162000                 MOVE PLNSHP-EXT-CAN-DTE(6:2) TO                  19400002
162100                     TR004-CANCEL-DATE (5:2)                      19410002
162200                 MOVE PLNSHP-EXT-CAN-DTE(9:2) TO                  19420002
162300                     TR004-CANCEL-DATE (7:2)                      19430002
162400              END-IF                                              19440002
162500                                                                  19450002
162600         WHEN SQLCODE = +100                                      19460002
162700             INITIALIZE TR006-DONT-SHIP-BEFORE-DATE               19470002
162800                        TR004-CANCEL-DATE                         19480002
162900                        TR004-DO-NOT-SHIP-BEF-DTE                 19490002
163000                                                                  19500002
163100                                                                  19510002
163200         WHEN SQLWARN0 NOT EQUAL SPACE                            19520002
163300         WHEN SQLCODE NOT EQUAL ZERO                              19530002
163400             DISPLAY '** ABEND **'                                19540002
163500             DISPLAY '** PROGRAM = TRKUP007 **'                   19550002
163600             DISPLAY '** PARAGRAPH = 2260-SELECT-PLNSHP-DATES**'  19560002
163700             PERFORM 9100-SQL-ABEND                               19570002
163800     END-EVALUATE.                                                19580002
163900                                                                  19590002
164000******************************************************************19600002
164100 2270-UPDATE-TIMCNPO.                                             19610099
164200                                                                  19620002
164300         EXEC SQL                                                 19630002
164400             UPDATE TIMCNPO                                       19640002
164500                SET SPLT_XMIT_CDE    = :IMCNPO-SPLT-XMIT-CDE      19650002
164600                 ,  LAST_UPD_TMST    = (CURRENT TIMESTAMP)        19660002
164700                 ,  LAST_UPD_BY_USR_ID                            19670002
164800                                     = :PC-CURRENT-PROGRAM-NAME   19680002
164900              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          19690002
165000                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     19700002
165100                AND PO_NBR           = :IMCNPO-PO-NBR             19710002
165200         END-EXEC                                                 19720002
165300                                                                  19730002
165400     EVALUATE TRUE                                                19740002
165500         WHEN SQLCODE = ZERO                                      19750002
165600             PERFORM 4010-CREATE-IMCNPO-AUDIT-TRAIL               19760002
165700                                                                  19770002
165800         WHEN SQLCODE = +100                                      19780002
165900             CONTINUE                                             19790002
166000                                                                  19800002
166100         WHEN SQLWARN0 NOT EQUAL SPACE                            19810002
166200         WHEN SQLCODE NOT EQUAL ZERO                              19820002
166300             DISPLAY '** ABEND **'                                19830002
166400             DISPLAY '** PROGRAM = TRKUP007 **'                   19840002
166500             DISPLAY '** PARAGRAPH = 2270-UPDATE-TIMCNPO**'       19850002
166600             PERFORM 9100-SQL-ABEND                               19860002
166700     END-EVALUATE.                                                19870002
166800                                                                  19880002
166900******************************************************************19890002
167000 2280-UPDATE-TIMCNRL.                                             19900002
167100                                                                  19910002
167200         EXEC SQL                                                 19920002
167300             UPDATE TIMCNRL                                       19930002
167400                SET                                               19940002
167500                   DCONSLR_RLSE_CDE = :IMCNRL-DCONSLR-RLSE-CDE    19950002
167600                 , DCONSLR_ACTL_DTE = CURRENT DATE                19960002
167700                 , DCONSLR_ACTL_TM  = CURRENT TIME                19970002
167800                 , LAST_UPD_TMST    = (CURRENT TIMESTAMP)         19980002
167900                 , LAST_UPD_BY_UID  = :PC-CURRENT-PROGRAM-NAME    19990002
168000              WHERE CONTNR_ID       = :IMCNTK-CONTNR-ID           20000002
168100                AND CONTNR_SEQ_NBR  = :IMCNTK-CONTNR-SEQ-NBR      20010002
168200                AND PO_NBR          = :IMCNPO-PO-NBR              20020002
168300         END-EXEC                                                 20030002
168400                                                                  20040002
168500     EVALUATE TRUE                                                20050002
168600         WHEN SQLCODE = ZERO                                      20060002
168700             PERFORM 4030-CREATE-IMCNRL-AUDIT-TRAIL               20070002
168800                                                                  20080002
168900                                                                  20090002
169000         WHEN SQLWARN0 NOT EQUAL SPACE                            20100002
169100         WHEN SQLCODE NOT EQUAL ZERO                              20110002
169200          SET TR006-ERROR-TYPE-ERROR      TO TRUE                 20120002
169300          INITIALIZE TR006-ERROR-MSG                              20130002
169400          STRING 'CMN-CNRL TBL ERR-CALL IS-FIX'                   20140002
169500              DELIMITED BY SIZE                                   20150002
169600              INTO TR006-ERROR-MSG                                20160002
169700          PERFORM 8830-WRITE-ERROR-LINE                           20170002
169800          SET PS-PROBLEM-DO-NOT-SEND      TO TRUE                 20180002
169900          DISPLAY '** PROGRAM = TRKUP007 **'                      20190002
170000          DISPLAY '** PARAGRAPH = 2280-UPDATE-TIMCNRL**'          20200002
170100          DISPLAY '** IMCNTK-CONTNR-ID      ' IMCNTK-CONTNR-ID    20210002
170200          DISPLAY '** IMCNPO-PO-NBR         ' IMCNPO-PO-NBR       20220002
170300     END-EVALUATE.                                                20230002
170400                                                                  20240002
170500******************************************************************20250002
170600 2300-PROCESS-INSTRUCTION-LINES.                                  20260002
170700                                                                  20270002
170800     PERFORM 7900-OPEN-INSTR-CURSOR.                              20280002
170900                                                                  20290002
171000     PERFORM 8100-FETCH-INSTR-CURSOR.                             20300002
171100                                                                  20310002
171200     IF PS-EOC-INSTR-CURSOR                                       20320002
171300         PERFORM 8000-CLOSE-INSTR-CURSOR                          20330002
171400     ELSE                                                         20340002
171500         PERFORM 2310-FINISH-INSTRUCTION-LINES                    20350002
171600         PERFORM 8000-CLOSE-INSTR-CURSOR                          20360002
171700     END-IF.                                                      20370002
171800                                                                  20380002
171900     SET PS-EOC-INSTR-CURSOR-NO TO TRUE.                          20390002
172000                                                                  20400002
172100******************************************************************20410002
172200 2310-FINISH-INSTRUCTION-LINES.                                   20420002
172300                                                                  20430002
172400     INITIALIZE TR004-REC-TYPE-INS.                               20440002
172500     MOVE INSTCD-INSTR-DESC TO TR004-SPEC-INSTR.                  20450002
172600     PERFORM 5500-WRITE-PUR-ORDER-INS-REC.                        20460002
172700                                                                  20470002
172800******************************************************************20480002
172900 2350-PROCESS-PACKS-IDS.                                          20490002
173000                                                                  20500002
173100     PERFORM 8745-FETCH-PACK-CURSOR.                              20510002
173200                                                                  20520002
173300     IF PS-EOC-PACK-CURSOR                                        20530002
173400       PERFORM 8740-CLOSE-PACK-CURSOR                             20540002
173500       INITIALIZE TR006-PACK-ID                                   20550002
173600       MOVE ZERO TO PV-HOLD-PO-PREPK-ID                           20560002
173700     ELSE                                                         20570002
173800       MOVE POPRPK-PO-PREPK-ID  TO TR006-PACK-ID                  20580002
173900                                                                  20590002
174000       PERFORM 8470-OPEN-E-COM-PACK-UPC-CUR                       20600002
174100       SET PS-EOC-E-COM-PACK-UPC-CUR-NO TO TRUE                   20610002
174200       SET PS-PASSED-E-COM-CHECK-NO     TO TRUE                   20620002
174300       PERFORM 2352-CHECK-PACK-FOR-E-COM                          20630002
174400            UNTIL PS-EOC-E-COM-PACK-UPC-CUR                       20640002
174500       PERFORM 8474-CLOSE-E-COM-PACK-UPC-CUR                      20650002
174600                                                                  20660002
174700       IF PS-PASSED-E-COM-CHECK                                   20670002
174800                                                                  20680002
174900         MOVE POPRPK-PO-PREPK-ID     TO TR004-PACK-ID             20690002
175000         MOVE IMCNUP-UPC-UNT-QTY     TO TR004-PACK-UNIT-QTY       20700002
139868                                        PV-HOLD-PCK-UNIT-QTY      20710099
175100         MOVE IMCNUP-UPC-CART-CNT    TO TR004-PACK-CART-CT        20720002
139868                                        PV-HOLD-PCK-CART-CT       20730099
175200         MOVE IMCNUP-UPC-CBMT-QTY    TO TR004-PACK-CBMT-QTY       20740002
175300         MOVE IMCNUP-UPC-WT-KGRM-QTY TO TR004-PACK-WT-KGRM-QTY    20750002
175400                                                                  20760002
175500         IF IMCNUP-ASN-PKGNG-CDE   NOT =    'AS'                  20770002
175600             INITIALIZE TR006-ERROR-MSG                           20780002
175700             SET TR006-ERROR-TYPE-ERROR       TO TRUE             20790002
175800             STRING 'CMN-PCK HAS BULK ASN PKG CDE-FIX'            20800002
175900                 DELIMITED BY SIZE                                20810002
176000                 INTO TR006-ERROR-MSG                             20820002
176100             MOVE IMCNUP-SKU-NBR   TO TR006-SKU                   20830002
176200             MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR               20840002
176300             PERFORM 8830-WRITE-ERROR-LINE                        20850002
176400             SET PS-PROBLEM-DO-NOT-SEND TO TRUE                   20860002
176500         END-IF                                                   20870002
176600                                                                  20880002
176700** BUD * IF PURCHS-PKGNG-CDE = PC-M                               20890019
176700         IF POPRPK-PREPK-TYP-CDE = PC-M                           20900019
176800           MOVE POPRPK-INPK-UNT-QTY  TO TR004-PACK-UNITS-PER-CTN  20910002
139868                                        PV-HOLD-PCK-UNIT-PER-CTN  20920099
176900         ELSE                                                     20930002
177000           MOVE POPRPK-OTPK-UNT-QTY  TO TR004-PACK-UNITS-PER-CTN  20940002
139868                                        PV-HOLD-PCK-UNIT-PER-CTN  20950099
177100         END-IF                                                   20960002
177200                                                                  20970002
177300** BUD * IF PURCHS-PKGNG-CDE = PC-M                               20980019
176700         IF POPRPK-PREPK-TYP-CDE = PC-M                           20990019
177400            MOVE 1    TO TR004-PACKS-PER-CART                     21000002
177500         ELSE                                                     21010002
177600            IF POPRPK-INPK-UNT-QTY = ZERO                         21020002
177700              MOVE ZERO TO TR004-PACKS-PER-CART                   21030002
177800              PERFORM 2354-INPK-ZERO-ERROR-PACK                   21040002
177900            ELSE                                                  21050002
178000              COMPUTE TR004-PACKS-PER-CART =                      21060002
178100                   (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY)    21070002
178200            END-IF                                                21080002
178300         END-IF                                                   21090002
178400                                                                  21100002
178500*        **********************************************           21110002
178600*        *             SEPARATE SELECTS               *           21120002
178700*        **********************************************           21130002
178800*        * THE NEXT 4 PERFORMS ARE SELECT DISTINCTS   *           21140002
178900*        * ON THE SAME TABLE WITH SAME WHERE CLAUSES. *           21150002
179000*        * THEY MUST BE KEPT SEPARATE SO THAT WE KNOW *           21160002
179100*        * WHETHER WE HAVE MULTI ROWS (-811) DUE TO   *           21170002
179200*        * STYLE, COLOR OR SIZE.  UNITS MUST BE DONE  *           21180002
179300*        * SEPARATELY BECAUSE -811 ISN'T CHECKED.     *           21190002
179400*        **********************************************           21200002
179500         PERFORM 2360-SELECT-VENDOR-STYLE-PCK                     21210002
179600         PERFORM 2361-SELECT-COLOR-PCK                            21220002
179700         PERFORM 2362-SELECT-SIZE-PCK                             21230002
179800         PERFORM 2363-SELECT-DESC-PCK                             21240002
179900*        *********** END SEPARATE SELECTS *************           21250002
180000         MOVE POPRPK-PREPK-UPC-NBR                                21260002
180100                                  TO TR004-PACK-UPC-NBR           21270002
180200                                                                  21280002
180300         MOVE POPRPK-PK-SKU-NBR  TO TR004-PACK-SKU                21290002
180400                                                                  21300002
180500         IF POPRPK-PK-SKU-NBR = IMCNUP-SKU-NBR                    21310002
180600          AND POPRPK-PK-SKU-NBR   NOT =   ZERO                    21320002
180700           CONTINUE                                               21330002
180800         ELSE                                                     21340002
180900           INITIALIZE TR006-ERROR-MSG                             21350002
181000           IF POPRPK-PK-SKU-NBR = ZERO                            21360002
181100             STRING 'CMN-NO PCK SKU FOR PACK PO-FIX'              21370002
181200                 DELIMITED BY SIZE                                21380002
181300                 INTO TR006-ERROR-MSG                             21390002
181400*** BG     ELSE                                                   21400002
181500*** BG       STRING 'CMN-PACK SKU NOT = CONT SKU-FIX'             21410002
181600*** BG           DELIMITED BY SIZE                                21420002
181700*** BG           INTO TR006-ERROR-MSG                             21430002
181800*** BG     END-IF                                                 21440002
181900           SET TR006-ERROR-TYPE-ERROR       TO TRUE               21450002
182000           SET PS-PROBLEM-DO-NOT-SEND       TO TRUE               21460002
182100           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     21470002
182200           MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR                 21480002
182300           PERFORM 8830-WRITE-ERROR-LINE                          21490002
182400           END-IF                                                 21500002
182500         END-IF                                                   21510002
182600                                                                  21520002
182700         MOVE POPRPK-PREPK-UPC-NBR TO IMCNUP-UPC-NBR              21530002
182800                                                                  21540002
182900         PERFORM 2430-GET-CARTON-LABEL-DATA                       21550002
183000         IF IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC            21560002
183100           MOVE ZERO TO TR004-PCK-NO-LBL-CART-CT                  21570002
183200         ELSE                                                     21580002
183300           COMPUTE TR004-PCK-NO-LBL-CART-CT =                     21590002
183400             (IMCNUP-UPC-CART-CNT - PV-NBR-CART-LBLS-UPC)         21600002
183500         END-IF                                                   21610002
183600                                                                  21620002
183700         PERFORM 5755-WRITE-PUR-ORDER-PCK-REC                     21630002
183800                                                                  21640002
183900***      SET PS-ORDERED-EQUALS-SHIPPED-NO TO TRUE                 21650002
184000         SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE                 21660002
184100         PERFORM 2370-SELECT-PACK-SUM                             21670002
184200                                                                  21680002
184300         IF PS-SELECT-PACK-SUM-OK                                 21690002
184400           SET PS-COUNT-DCS-OK-NO         TO TRUE                 21700002
184500           PERFORM 2384-COUNT-DCS-FOR-PACK                        21710002
184600           IF PS-COUNT-DCS-OK                                     21720062
184700             IF PV-NBR-CART-LBLS-UPC > ZERO                       21730002
184800               PERFORM 8758-OPEN-CART-LABEL-CURSOR                21740002
184900               SET PS-EOC-CART-LABEL-CURSOR-NO TO TRUE            21750002
185000             END-IF                                               21760002
185100             SET PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             21770002
185200             SET PS-FIRST-DC                  TO TRUE             21780052
139868             SET PS-OUTLET-STORE-NO           TO TRUE             21790099
185300             PERFORM 8420-OPEN-PACK-DC-CURSOR                     21800002
185400             PERFORM 2372-PROCESS-PREPACK-DC UNTIL                21810002
185500                     PS-EOC-PREPACK-DC-CURSOR                     21820002
185600             SET PS-EOC-PREPACK-DC-CURSOR-NO  TO TRUE             21830002
185700             IF PV-NBR-CART-LBLS-UPC > ZERO                       21840002
185800               PERFORM 8760-CLOSE-CART-LABEL-CURSOR               21850002
185900             END-IF                                               21860002
186000           END-IF                                                 21870002
186100         END-IF                                                   21880002
186200                                                                  21890002
186300         PERFORM 8450-OPEN-PACK-UPC-CURSOR                        21900002
186400         SET PS-UPCS-ON-PREPACK-NO        TO TRUE                 21910002
186500         PERFORM 2480-PROCESS-PREPACK-UPC UNTIL                   21920002
186600                  PS-EOC-PREPACK-UPC-CURSOR                       21930002
186700         SET PS-EOC-PREPACK-UPC-CURSOR-NO TO TRUE                 21940002
186800                                                                  21950002
186900       END-IF                                                     21960002
187000                                                                  21970002
187100     END-IF.                                                      21980002
187200                                                                  21990002
187300******************************************************************22000002
187400* GO THRU ALL UPCS ON PACK - IF THERE ARE ANY SPLITS FOR E-COM-  *22010002
187500* MERCE FULFILLMENT CENTER, ALL OF THE UPCS ON THE PACK MUST BE  *22020002
187600* E-COM TYPE OR THE SPLITS WILL NOT BE SENT.                     *22030002
187700******************************************************************22040002
187800 2352-CHECK-PACK-FOR-E-COM.                                       22050002
187900                                                                  22060002
188000     PERFORM 8472-FETCH-E-COM-PACK-UPC-CUR.                       22070002
188100                                                                  22080002
188200     IF PS-EOC-E-COM-PACK-UPC-CUR                                 22090002
188300                                                                  22100002
188400        EVALUATE TRUE                                             22110002
188500                                                                  22120002
188600           WHEN PV-TTL-E-COM-PACK-UPCS = ZERO                     22130002
188700             AND PV-TTL-BAD-PACK-UPCS = ZERO                      22140002
188800           WHEN PV-TTL-E-COM-PACK-UPCS  = PV-TTL-PACK-UPCS        22150002
188900                                                                  22160002
189000             SET PS-PASSED-E-COM-CHECK TO TRUE                    22170002
189100                                                                  22180002
189200           WHEN OTHER                                             22190002
189300                                                                  22200002
189400             INITIALIZE TR006-ERROR-MSG                           22210002
189500             SET TR006-ERROR-TYPE-ERROR       TO TRUE             22220002
189600             STRING 'CMN-PCK HAS ECOM DC-NOT ECOM SKU'            22230002
189700                 DELIMITED BY SIZE                                22240002
189800                 INTO TR006-ERROR-MSG                             22250002
189900             MOVE IMCNUP-SKU-NBR   TO TR006-SKU                   22260002
190000             PERFORM 8830-WRITE-ERROR-LINE                        22270002
190100             SET PS-PROBLEM-DO-NOT-SEND TO TRUE                   22280002
190200                                                                  22290002
190300        END-EVALUATE                                              22300002
190400                                                                  22310002
190500        INITIALIZE  PV-TTL-E-COM-PACK-UPCS                        22320002
190600        INITIALIZE  PV-TTL-PACK-UPCS                              22330002
190700        INITIALIZE  PV-TTL-BAD-PACK-UPCS                          22340002
190800                                                                  22350002
190900     ELSE                                                         22360002
191000                                                                  22370002
191100       ADD +1   TO PV-TTL-PACK-UPCS                               22380002
191200       SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                     22390002
191300       PERFORM 2410-SELECT-E-COM-DCS                              22400002
191400                                                                  22410002
191500       IF PS-THERE-ARE-E-COM-DCS                                  22420002
191600          SET PS-THIS-IS-E-COM-UPC-NO  TO TRUE                    22430002
191700          PERFORM 2415-SELECT-UPC-FROM-TWEBITM                    22440002
191800             IF PS-THIS-IS-E-COM-UPC                              22450002
191900               ADD +1   TO PV-TTL-E-COM-PACK-UPCS                 22460002
192000             ELSE                                                 22470002
192100               ADD +1   TO PV-TTL-BAD-PACK-UPCS                   22480002
192200             END-IF                                               22490002
192300       END-IF                                                     22500002
192400                                                                  22510002
192500     END-IF.                                                      22520002
192600                                                                  22530002
192700******************************************************************22540002
192800*  ONLY PRINT THE MESSAGE ONCE PER PO/PACK ID COMBO.              22550002
192900******************************************************************22560002
193000 2354-INPK-ZERO-ERROR-PACK.                                       22570002
193100                                                                  22580002
193200     IF PV-HOLD-PO-PREPK-PO = TR006-PO-NBR                        22590002
193300       AND PV-HOLD-PO-PREPK-ID = TR006-PACK-ID                    22600002
193400         CONTINUE                                                 22610002
193500     ELSE                                                         22620002
193600         SET TR006-ERROR-TYPE-ERROR   TO TRUE                     22630002
193700         INITIALIZE TR006-ERROR-MSG                               22640002
193800         STRING 'CMN-POPRPK-INPK-UNT-QTY FLD IS 0'                22650002
193900             DELIMITED BY SIZE                                    22660002
194000             INTO TR006-ERROR-MSG                                 22670002
194100         MOVE IMCNUP-SKU-NBR   TO TR006-SKU                       22680002
194200         PERFORM 8830-WRITE-ERROR-LINE                            22690002
194300         MOVE TR006-PO-NBR     TO  PV-HOLD-PO-PREPK-PO            22700002
194400         MOVE TR006-PACK-ID    TO  PV-HOLD-PO-PREPK-ID            22710002
194500     END-IF.                                                      22720002
194600                                                                  22730002
194700******************************************************************22740002
194800* SELECT THE VENDOR STYLE NAME FROM TPURITM.                     *22750002
194900******************************************************************22760002
195000 2360-SELECT-VENDOR-STYLE-PCK.                                    22770002
195100                                                                  22780002
195200     EXEC SQL                                                     22790002
195300         SELECT DISTINCT                                          22800002
195400                XVS.VS_NBR                                        22810002
195500           INTO :XLT00004-VS-NBR                                  22820002
195600           FROM TPURITM       A                                   22830002
195700                ,XLT_VND_STYL XVS                                 22840002
195800                ,XLT_SKU      XS                                  22850002
195900          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 22860002
196000            AND A.ITM_NBR        =  XS.ITM_NBR                    22870002
196100            AND XS.STYL_ID       =  XVS.STYL_ID                   22880002
196200            AND A.VER_STATUS_CDE = :PC-A                          22890002
196300            AND A.STATUS_CDE    IN ('AC', 'AP')                   22900002
196400            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            22910002
196500     END-EXEC                                                     22920002
196600                                                                  22930002
196700     EVALUATE TRUE                                                22940002
196800         WHEN SQLCODE = ZERO                                      22950002
196900             MOVE XLT00004-VS-NBR       TO                        22960002
197000                   TR004-PACK-VEND-STYL-NAME                      22970002
197100                                                                  22980002
197200         WHEN SQLCODE = +100                                      22990002
197300             MOVE SPACES TO TR004-PACK-VEND-STYL-NAME             23000002
197400                                                                  23010002
197500         WHEN SQLCODE = -811                                      23020002
197600             MOVE PC-MULTI TO TR004-PACK-VEND-STYL-NAME           23030002
197700                                                                  23040002
197800         WHEN SQLWARN0 NOT EQUAL SPACE                            23050002
197900         WHEN SQLCODE NOT EQUAL ZERO                              23060002
198000             DISPLAY '**************************************'     23070002
198100             DISPLAY '** ABEND                            **'     23080002
198200             DISPLAY '** PROGRAM = TRKUP007               **'     23090002
198300             DISPLAY '** PARAGRAPH = 2360-SELECT-VENDOR-  **'     23100002
198400             DISPLAY '**                  STYLE-PCK       **'     23110002
198500             DISPLAY '** SELECT TPURITM                   **'     23120002
198600             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              23130002
198700             DISPLAY '**************************************'     23140002
198800             PERFORM 9100-SQL-ABEND                               23150002
198900     END-EVALUATE.                                                23160002
199000                                                                  23170002
199100******************************************************************23180002
199200* SELECT THE COLOR CODE AND DESCRIPTION FROM TPURITM.            *23190002
199300******************************************************************23200002
199400 2361-SELECT-COLOR-PCK.                                           23210002
199500                                                                  23220002
199600     EXEC SQL                                                     23230002
199700         SELECT DISTINCT                                          23240002
199800                XS.NRF_CLOR_CDE                                   23250002
199900              , XS.CSTM_CLOR_DESC                                 23260002
200000           INTO :XLT00003-NRF-CLOR-CDE                            23270002
200100              , :XLT00003-CSTM-CLOR-DESC                          23280002
200200           FROM TPURITM  A                                        23290002
200300               ,XLT_SKU  XS                                       23300002
200400          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                23310002
200500            AND A.ITM_NBR        =  XS.ITM_NBR                    23320002
200600            AND A.VER_STATUS_CDE = :PC-A                          23330002
200700            AND A.STATUS_CDE    IN ('AC', 'AP')                   23340002
200800            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            23350002
200900     END-EXEC                                                     23360002
201000                                                                  23370002
201100     EVALUATE TRUE                                                23380002
201200         WHEN SQLCODE = ZERO                                      23390002
201300             MOVE XLT00003-NRF-CLOR-CDE   TO TR004-PACK-COLOR-CDE 23400002
201400             MOVE XLT00003-CSTM-CLOR-DESC TO TR004-PACK-COLOR-DESC23410002
201500                                                                  23420002
201600         WHEN SQLCODE = +100                                      23430002
201700             MOVE SPACES TO TR004-PACK-COLOR-CDE                  23440002
201800                            TR004-PACK-COLOR-DESC                 23450002
201900                                                                  23460002
202000         WHEN SQLCODE = -811                                      23470002
202100             MOVE PC-MULTI TO TR004-PACK-COLOR-CDE                23480002
202200                              TR004-PACK-COLOR-DESC               23490002
202300                                                                  23500002
202400         WHEN SQLWARN0 NOT EQUAL SPACE                            23510002
202500         WHEN SQLCODE NOT EQUAL ZERO                              23520002
202600             DISPLAY '**************************************'     23530002
202700             DISPLAY '** ABEND                            **'     23540002
202800             DISPLAY '** PROGRAM = TRKUP007               **'     23550002
202900             DISPLAY '** PARAGRAPH = 2361-SELECT-COLOR-PCK**'     23560002
203000             DISPLAY '** SELECT TPURITM                   **'     23570002
203100             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              23580002
203200             DISPLAY '**************************************'     23590002
203300             PERFORM 9100-SQL-ABEND                               23600002
203400     END-EVALUATE.                                                23610002
203500                                                                  23620002
203600******************************************************************23630002
203700* SELECT THE SIZE DESCRIPTION FROM TPURITM.                      *23640002
203800******************************************************************23650002
203900 2362-SELECT-SIZE-PCK.                                            23660002
204000                                                                  23670002
204100     EXEC SQL                                                     23680002
204200         SELECT DISTINCT                                          23690002
204300                XS.SIZE_DESC                                      23700002
204400           INTO :XLT00003-SIZE-DESC                               23710002
204500           FROM TPURITM  A                                        23720002
204600               ,XLT_SKU  XS                                       23730002
204700          WHERE A.PO_NBR         =  :PURCHS-PO-NBR                23740002
204800            AND A.ITM_NBR        =  XS.ITM_NBR                    23750002
204900            AND A.VER_STATUS_CDE = :PC-A                          23760002
205000            AND A.STATUS_CDE    IN ('AC', 'AP')                   23770002
205100            AND A.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID            23780002
205200     END-EXEC                                                     23790002
205300                                                                  23800002
205400     EVALUATE TRUE                                                23810002
205500         WHEN SQLCODE = ZERO                                      23820002
205600             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         23830002
205700                 MOVE PC-NO-SIZE         TO TR004-PACK-SIZE-DESC  23840002
205800             ELSE                                                 23850002
205900                 MOVE XLT00003-SIZE-DESC TO TR004-PACK-SIZE-DESC  23860002
206000             END-IF                                               23870002
206100                                                                  23880002
206200         WHEN SQLCODE = +100                                      23890002
206300             MOVE SPACES  TO TR004-PACK-SIZE-DESC                 23900002
206400                                                                  23910002
206500         WHEN SQLCODE = -811                                      23920002
206600             IF XLT00003-SIZE-DESC = PC-NO-SIZE OR SPACES         23930002
206700                 MOVE PC-NO-SIZE TO TR004-PACK-SIZE-DESC          23940002
206800             ELSE                                                 23950002
206900                 MOVE PC-MULTI TO TR004-PACK-SIZE-DESC            23960002
207000             END-IF                                               23970002
207100                                                                  23980002
207200         WHEN SQLWARN0 NOT EQUAL SPACE                            23990002
207300         WHEN SQLCODE NOT EQUAL ZERO                              24000002
207400             DISPLAY '**************************************'     24010002
207500             DISPLAY '** ABEND                            **'     24020002
207600             DISPLAY '** PROGRAM = TRKUP007               **'     24030002
207700             DISPLAY '** PARAGRAPH = 2362-SELECT-SIZE-PCK **'     24040002
207800             DISPLAY '** SELECT TPURITM                   **'     24050002
207900             DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR              24060002
208000             DISPLAY '**************************************'     24070002
208100             PERFORM 9100-SQL-ABEND                               24080002
208200     END-EVALUATE.                                                24090002
208300                                                                  24100002
208400******************************************************************24110002
208500* SELECT THE PREPACK DESCRIPTION FROM TPOPRPK.                   *24120002
208600******************************************************************24130002
208700 2363-SELECT-DESC-PCK.                                            24140002
208800                                                                  24150002
208900     EXEC SQL                                                     24160002
209000         SELECT A.PREPK_DESC                                      24170002
209100           INTO :POPRPK-PREPK-DESC                                24180002
209200           FROM TPOPRPK  A                                        24190002
209300          WHERE A.PO_NBR    =  :IMCNPO-PO-NBR                     24200002
209400            AND A.PO_PREPK_ID  = :POPRPK-PO-PREPK-ID              24210002
209500     END-EXEC                                                     24220002
209600                                                                  24230002
209700     EVALUATE TRUE                                                24240002
209800         WHEN SQLCODE = ZERO                                      24250002
209900             MOVE POPRPK-PREPK-DESC TO TR004-PACK-DESC            24260002
210000                                                                  24270002
210100         WHEN SQLCODE = +100                                      24280002
210200             MOVE SPACES TO TR004-PACK-DESC                       24290002
210300                                                                  24300002
210400         WHEN SQLWARN0 NOT EQUAL SPACE                            24310002
210500         WHEN SQLCODE NOT EQUAL ZERO                              24320002
210600             DISPLAY '**************************************'     24330002
210700             DISPLAY '** ABEND                            **'     24340002
210800             DISPLAY '** PROGRAM = TRKUP007               **'     24350002
210900             DISPLAY '** PARAGRAPH = 2363-SELECT-UNIT-    **'     24360002
211000             DISPLAY '**                  QTY-PCK         **'     24370002
211100             DISPLAY '** SELECT TPOPRPK                   **'     24380002
211200             DISPLAY '** PO NUMBER  = ' PURCHS-PO-NBR             24390002
211300             DISPLAY '** PREPACK ID = ' POPRPK-PO-PREPK-ID        24400002
211400             DISPLAY '**************************************'     24410002
211500             PERFORM 9100-SQL-ABEND                               24420002
211600     END-EVALUATE.                                                24430002
211700                                                                  24440002
211800 EJECT                                                            24450002
211900******************************************************************24460002
212000* GET THE TOTAL ORDERED QTY FOR THIS PACK.                       *24470002
212100******************************************************************24480002
212200 2370-SELECT-PACK-SUM.                                            24490002
212300                                                                  24500002
212400     EXEC SQL                                                     24510002
212500           SELECT                                                 24520002
212600             SUM  (TALL.CURR_SPLIT_QTY)                           24530002
212700            INTO  :PA-TTL-ORDERED-PACK-QTY                        24540002
212800            FROM                                                  24550002
212900                  TALLPLN   TALL                                  24560002
213000                 ,TPURITM   PUR                                   24570002
213100            WHERE  PUR.PO_NBR          = :IMCNPO-PO-NBR           24580002
213200               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      24590002
213300               AND PUR.VER_STATUS_CDE  = 'A'                      24600002
213400               AND PUR.STATUS_CDE     IN ('AC', 'AP')             24610002
213500               AND TALL.PO_NBR         =  PUR.PO_NBR              24620002
213600               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          24630002
213700               AND TALL.CURR_SPLIT_QTY >  0                       24640002
213800     END-EXEC.                                                    24650002
213900                                                                  24660002
214000     EVALUATE TRUE                                                24670002
214100         WHEN SQLCODE = ZERO AND PA-TTL-ORDERED-PACK-QTY     > 0  24680002
214200           SET PS-SELECT-PACK-SUM-OK     TO TRUE                  24690002
214300***        ***************************************************    24700002
214400***        * WE DECIDED TO JUST GO WITH SHIPPED CARTONS AND       24710002
214500***        * BASE UNITS ON MULTIPLES OF CARTONS. BUT IN CASE      24720002
214600***        * WE CHANGE OUR MINDS .......                          24730002
214700***        ***************************************************    24740002
214800***        IF PA-TTL-PCK-UNITS-SENT = PA-TTL-ORDERED-PACK-QTY     24750002
214900***          SET PS-ORDERED-EQUALS-SHIPPED   TO TRUE              24760002
215000***        END-IF                                                 24770002
215100                                                                  24780002
215200         WHEN SQLCODE = ZERO AND PA-TTL-ORDERED-PACK-QTY     = 0  24790002
215300         WHEN SQLCODE = +100                                      24800002
215400         WHEN SQLCODE = -305                                      24810002
215500           SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE               24820002
215600           SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE               24830002
215700           INITIALIZE TR006-ERROR-MSG                             24840002
215800                      TR006-UPC-NBR                               24850002
215900           STRING 'CMN-PACK MISSING SPLT-FIX'                     24860002
216000               DELIMITED BY SIZE                                  24870002
216100               INTO TR006-ERROR-MSG                               24880002
216200           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     24890002
216300           PERFORM 8830-WRITE-ERROR-LINE                          24900002
216400           SET PS-SPLITS-ENTERED-NO      TO TRUE                  24910002
216500                                                                  24920002
216600         WHEN SQLWARN0 NOT EQUAL SPACE                            24930002
216700         WHEN SQLCODE NOT EQUAL ZERO                              24940002
216800             DISPLAY '** ABEND **'                                24950002
216900             DISPLAY '** PROGRAM = TRKUP007 **'                   24960002
217000             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          24970002
217100             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      24980002
217200             DISPLAY '** PREPACK ID    = ' POPRPK-PO-PREPK-ID     24990002
217300             DISPLAY '** PARA = 2370-SELECT-PACK-SUM **'          25000002
217400             PERFORM 9100-SQL-ABEND                               25010002
217500     END-EVALUATE.                                                25020002
217600                                                                  25030002
217700******************************************************************25040002
217800* PROCESS PREPACK DC INFORMATION.                                *25050002
217900******************************************************************25060002
218000 2372-PROCESS-PREPACK-DC.                                         25070002
218100                                                                  25080095
218200     PERFORM 8430-FETCH-PACK-DC-CURSOR.                           25090002
218200                                                                  25100031
218300     IF PS-EOC-PREPACK-DC-CURSOR                                  25110002
139868        PERFORM 2373-PROCESS-PREPACK-CONT                         25120099
139868     ELSE                                                         25130099
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     25140099
139868        PERFORM 1120-SELECT-OUTLET-PARM                           25150099
139868        IF PS-OUTLET-STORE                                        25160099
139868           SET PS-FIRST-STORE  TO TRUE                            25170099
139868           PERFORM 8890-OUTLET-STORE-PREPACK                      25180099
139868        ELSE                                                      25190099
155029           EVALUATE TRUE                                          25200099
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       25210099
155029               AND  PV-FAST-E-BUS-IND = 'N')                      25220099
155029                 IF PS-FIRST-UPC-YES                              25230099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 25240099
155029                    SET PS-FIRST-STORE    TO TRUE                 25250099
155029                 END-IF                                           25260099
155029                 SET PS-OUTLET-STORE   TO TRUE                    25270099
155029                 PERFORM 8890-OUTLET-STORE-PREPACK                25280099
155029                                                                  25290099
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       25300099
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      25310099
155029                 IF PS-FIRST-UPC-YES                              25320099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 25330099
155029                    SET PS-FIRST-STORE    TO TRUE                 25340099
155029                 END-IF                                           25350099
155029                 SET PS-OUTLET-STORE   TO TRUE                    25360099
155029                 PERFORM 8890-OUTLET-STORE-PREPACK                25370099
155029                                                                  25380099
155029              WHEN OTHER                                          25390099
139868                 PERFORM 2373-PROCESS-PREPACK-CONT                25400099
155029           END-EVALUATE                                           25410099
139868        END-IF                                                    25420099
139868     END-IF.                                                      25430099
139868                                                                  25440099
139868******************************************************************25450099
139868 2373-PROCESS-PREPACK-CONT.                                       25460099
139868                                                                  25470099
218300     IF PS-EOC-PREPACK-DC-CURSOR                                  25480047
218400         PERFORM 8425-CLOSE-PACK-DC-CURSOR                        25490047
218500         IF PS-DC-SPLIT-INFO-PRESENT                              25500047
139868            IF PS-OUTLET-STORE                                    25510099
139868               CONTINUE                                           25520099
139868            ELSE                                                  25530099
218600               PERFORM 2380-ADJUST-ROUNDED-PDC-DIST               25540057
218700               PERFORM 5760-WRITE-PUR-ORDER-PDC-REC               25550068
218800               IF PV-NBR-CART-LBLS-UPC > 0                        25560057
218900                  PERFORM 2394-CREATE-PCT-CARTON-LABELS           25570057
219000               END-IF                                             25580057
139868            END-IF                                                25590099
219100         END-IF                                                   25600047
219200     ELSE                                                         25610047
219300         IF PS-FIRST-DC                                           25620047
219400           SET PS-FIRST-DC-NO     TO TRUE                         25630047
219500*          ***************************************************    25640047
219600*          * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO       25650047
219700*          * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.        25660047
219800*          ***************************************************    25670047
219900           COMPUTE PV-DCS-TO-SKIP =                               25680047
220000             (IMCNUP-UPC-CART-CNT - PV-TOTAL-NBR-OF-DCS)          25690047
220100              * (-1)                                              25700047
220200                                                                  25710047
220300             INITIALIZE PV-TTL-ALL-DCS-PCT                        25720047
220400                      PV-TTL-ALL-DCS-UNITS                        25730047
220500                      PV-TTL-ALL-DCS-CARTS                        25740047
220600         ELSE                                                     25750047
220700*            *******************************************          25760047
220800*            * IF NOT EOC OR FIRST DC, WRITE THE DTL   *          25770047
220900*            * EXTRACT & REPORT RECS FROM THE PRIOR DC *          25780047
221000*            *******************************************          25790047
221100             PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                 25800047
221200             IF PV-NBR-CART-LBLS-UPC > 0                          25810047
221300               PERFORM 2394-CREATE-PCT-CARTON-LABELS              25820047
221400             END-IF                                               25830047
221500             IF PV-DCS-TO-SKIP  > ZERO                            25840047
221600               SUBTRACT 1 FROM PV-DCS-TO-SKIP                     25850047
221700             END-IF                                               25860047
221800         END-IF                                                   25870047
221900         INITIALIZE TR004-REC-TYPE-PDC                            25880047
222000         MOVE ALLPLN-DEST-NBR TO TR004-PDC-DIST-CNTR              25890047
222100         PERFORM 2374-ORDER-PERCENT-PDC                           25900047
222200         PERFORM 2376-CART-AND-UNIT-CNT-PDC                       25910047
222300     END-IF.                                                      25920047
222400                                                                  25930047
222500******************************************************************25940002
222600* CALCULATE ORDER PERCENT FOR THIS DC.                           *25950002
222700******************************************************************25960002
222800 2374-ORDER-PERCENT-PDC.                                          25970002
222900                                                                  25980002
223000     IF PS-SELECT-PACK-SUM-OK                                     25990002
223100       AND PA-TTL-ORDERED-PACK-QTY     NOT =  ZERO                26000002
223200         DIVIDE PA-TTL-ORDERED-PACK-QTY                           26010002
223300           INTO PA-TTL-ORDERED-PACK-QTY-DC                        26020002
223400              GIVING PA-TTL-PCK-SPLIT-QTY-DC-PCT ROUNDED          26030002
223500         MULTIPLY PA-TTL-PCK-SPLIT-QTY-DC-PCT                     26040002
223600               BY  100 GIVING TR004-PDC-PERCNT ROUNDED            26050002
223700     ELSE                                                         26060002
223800       MOVE ZERO    TO TR004-PDC-PERCNT                           26070002
223900               PA-TTL-PCK-SPLIT-QTY-DC-PCT                        26080002
224000     END-IF.                                                      26090002
224100                                                                  26100002
224200     IF TR004-PDC-PERCNT = ZERO                                   26110002
224300        MOVE +1 TO TR004-PDC-PERCNT                               26120002
224400     END-IF.                                                      26130002
224500                                                                  26140002
224600     ADD  TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT.          26150002
224700                                                                  26160002
224800******************************************************************26170002
224900* CALCULATE THE PDC CARTON COUNT AND UNITS FOR THIS DC           *26180002
225000******************************************************************26190002
225100 2376-CART-AND-UNIT-CNT-PDC.                                      26200002
225200                                                                  26210002
225300     COMPUTE TR004-PDC-CART-CT ROUNDED =                          26220002
225400        (IMCNUP-UPC-CART-CNT  *                                   26230002
225500                              PA-TTL-PCK-SPLIT-QTY-DC-PCT).       26240002
225600                                                                  26250002
225700     IF PV-DCS-TO-SKIP  > ZERO                                    26260002
225800       MOVE ZERO    TO TR004-PDC-CART-CT                          26270002
225900     ELSE                                                         26280002
226000       COMPUTE PV-DC-CART-CT ROUNDED =                            26290002
226100         (IMCNUP-UPC-CART-CNT * PA-TTL-PCK-SPLIT-QTY-DC-PCT)      26300002
226200       ADD .5 TO PV-DC-CART-CT                                    26310002
226300       IF PV-DC-CART-CT < 1                                       26320002
226400          MOVE 1                   TO TR004-PDC-CART-CT           26330002
226500       ELSE                                                       26340002
226600          MOVE PV-DC-CART-CT       TO TR004-PDC-CART-CT           26350002
226700       END-IF                                                     26360002
226800     END-IF.                                                      26370002
226900                                                                  26380002
227000     ADD  TR004-PDC-CART-CT       TO PV-TTL-ALL-DCS-CARTS.        26390002
227100                                                                  26400002
227200     IF TR004-PDC-CART-CT = ZERO                                  26410002
227300        IF PURCHS-NEW-STR-PO-IND = PC-Y                           26420002
227400          PERFORM 2600-ZERO-CARTONS-ERROR                         26430002
227500        END-IF                                                    26440002
227600     END-IF.                                                      26450002
227700                                                                  26460002
227800***  ***************************************************          26470002
227900***  * WE DECIDED TO JUST GO WITH SHIPPED CARTONS AND             26480002
228000***  * BASE UNITS ON MULTIPLES OF CARTONS. BUT IN CASE            26490002
228100***  * WE CHANGE OUR MINDS .......                                26500002
228200***  ***************************************************          26510002
228300***  IF PS-ORDERED-EQUALS-SHIPPED                                 26520002
228400***    MOVE PA-TTL-ORDERED-PACK-QTY-DC TO TR004-PDC-UNIT-QTY      26530002
228500***  ELSE                                                         26540002
228600     COMPUTE TR004-PDC-UNIT-QTY ROUNDED =                         26550002
228700          (IMCNUP-UPC-UNT-QTY * PA-TTL-PCK-SPLIT-QTY-DC-PCT).     26560002
228800     ADD  TR004-PDC-UNIT-QTY      TO PV-TTL-ALL-DCS-UNITS.        26570002
228900                                                                  26580002
229000     PERFORM 2390-COMPUTE-HOW-MANY-LBLS-PDC.                      26590002
229100     PERFORM 2392-COMPUTE-PDC-NO-LABELS.                          26600002
229200                                                                  26610002
229300******************************************************************26620002
229400 2380-ADJUST-ROUNDED-PDC-DIST.                                    26630002
229500                                                                  26640002
229600     IF PV-TTL-ALL-DCS-PCT = 100                                  26650002
229700       CONTINUE                                                   26660002
229800     ELSE                                                         26670002
229900       COMPUTE TR004-PDC-PERCNT =                                 26680002
230000            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         26690002
230100     END-IF.                                                      26700002
230200                                                                  26710002
230300*    ********************************************************     26720002
230400*    *  ADJUST CARTONS BASED ON ACTUAL                      *     26730002
230500*    *  SHIPPED QUANTITIES.                                 *     26740002
230600*    ********************************************************     26750002
230700     IF PV-TTL-ALL-DCS-CARTS = IMCNUP-UPC-CART-CNT                26760002
230800       CONTINUE                                                   26770002
230900     ELSE                                                         26780002
231000       COMPUTE TR004-PDC-CART-CT =                                26790002
231100          TR004-PDC-CART-CT +                                     26800002
231200             (IMCNUP-UPC-CART-CNT - PV-TTL-ALL-DCS-CARTS)         26810002
231300*      ******************************************************     26820002
231400*      * IF CARTONS WERE ADJUSTED, ADJUST HOW MANY LABELS   *     26830002
231500*      * AND UNLBELED CARTS FOR THIS DC.                    *     26840002
231600*      ******************************************************     26850002
231700       SUBTRACT PV-NBR-CART-LBLS-THIS-DC                          26860002
231800                     FROM PV-TTL-CART-LBLS-ALL-DCS                26870002
231900       PERFORM 2390-COMPUTE-HOW-MANY-LBLS-PDC                     26880002
232000       PERFORM 2392-COMPUTE-PDC-NO-LABELS                         26890002
232100     END-IF.                                                      26900002
232200                                                                  26910002
232300*    ********************************************************     26920002
232400*    *  ADJUST UNITS BASED ON ACTUAL                        *     26930002
232500*    *  SHIPPED QUANTITIES.                                 *     26940002
232600*    ********************************************************     26950002
232700     IF PV-TTL-ALL-DCS-UNITS = IMCNUP-UPC-UNT-QTY                 26960002
232800       CONTINUE                                                   26970002
232900     ELSE                                                         26980002
233000       COMPUTE TR004-PDC-UNIT-QTY =                               26990002
233100          TR004-PDC-UNIT-QTY +                                    27000002
233200             (IMCNUP-UPC-UNT-QTY - PV-TTL-ALL-DCS-UNITS)          27010002
233300     END-IF.                                                      27020002
233400                                                                  27030002
233500*    ********************************************************     27040002
233600*    *  ADJUST LABELS FOR THIS PACK DC                      *     27050002
233700*    ********************************************************     27060002
233800     IF PV-NBR-CART-LBLS-UPC = PV-TTL-CART-LBLS-ALL-DCS           27070002
233900       CONTINUE                                                   27080002
234000     ELSE                                                         27090002
234100        IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC             27100002
234200          CONTINUE                                                27110002
234300        ELSE                                                      27120002
234400          COMPUTE PV-NBR-CART-LBLS-THIS-DC =                      27130002
234500            PV-NBR-CART-LBLS-THIS-DC +                            27140002
234600             (PV-NBR-CART-LBLS-UPC - PV-TTL-CART-LBLS-ALL-DCS)    27150002
234700        END-IF                                                    27160002
234800        PERFORM 2392-COMPUTE-PDC-NO-LABELS                        27170002
234900     END-IF.                                                      27180002
235000                                                                  27190002
139868******************************************************************27200099
139868 2382-ADJUST-ROUNDED-OUT-DIST.                                    27210099
139868                                                                  27220099
139868     IF PV-TTL-ALL-DCS-PCT = 100                                  27230099
139868       CONTINUE                                                   27240099
139868     ELSE                                                         27250099
139868       COMPUTE TR004-PDC-PERCNT =                                 27260099
139868            TR004-PDC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)         27270099
139868     END-IF.                                                      27280099
139868                                                                  27290099
235100******************************************************************27300002
235200* COUNT THE DCS FOR THIS PACK.                                   *27310002
235300******************************************************************27320002
235400 2384-COUNT-DCS-FOR-PACK.                                         27330002
235500                                                                  27340002
235600     EXEC SQL                                                     27350002
235700           SELECT                                                 27360002
235800                  COUNT(DISTINCT TALL.DEST_NBR)                   27370002
235900             INTO                                                 27380002
236000                  :PV-TOTAL-NBR-OF-DCS                            27390002
236100             FROM                                                 27400002
236200                  TALLPLN   TALL                                  27410002
236300                 ,TPURITM   PUR                                   27420002
236400            WHERE  PUR.PO_NBR          = :IMCNPO-PO-NBR           27430002
236500               AND PUR.PO_PREPK_ID     = :POPRPK-PO-PREPK-ID      27440002
236600               AND PUR.VER_STATUS_CDE  = 'A'                      27450002
236700               AND PUR.STATUS_CDE     IN ('AC', 'AP')             27460002
236800               AND TALL.PO_NBR         =  PUR.PO_NBR              27470002
236900               AND TALL.PO_LNE_NBR     =  PUR.PO_LNE_NBR          27480002
237000               AND TALL.CURR_SPLIT_QTY >  0                       27490002
237100     END-EXEC.                                                    27500002
237200                                                                  27510002
237300     EVALUATE TRUE                                                27520002
237400         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS  > 0         27530002
237500           SET PS-COUNT-DCS-OK           TO TRUE                  27540002
237600                                                                  27550002
237700         WHEN SQLCODE = ZERO                                      27560002
237800         WHEN SQLCODE = +100                                      27570002
237900         WHEN SQLCODE = -305                                      27580002
238000           SET PS-SELECT-PACK-SUM-OK-NO     TO TRUE               27590002
238100           SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE               27600002
238200           INITIALIZE TR006-ERROR-MSG                             27610002
238300                      TR006-UPC-NBR                               27620002
238400           STRING 'CMN-PACK MISSING SPLT-FIX'                     27630002
238500               DELIMITED BY SIZE                                  27640002
238600               INTO TR006-ERROR-MSG                               27650002
238700           MOVE IMCNUP-SKU-NBR   TO TR006-SKU                     27660002
238800           PERFORM 8830-WRITE-ERROR-LINE                          27670002
238900           SET PS-SPLITS-ENTERED-NO      TO TRUE                  27680002
239000                                                                  27690002
239100         WHEN OTHER                                               27700002
239200             DISPLAY '** ABEND **'                                27710002
239300             DISPLAY '** PROGRAM = TRKUP007 **'                   27720002
239400             DISPLAY '** PO NUMBER     = ' IMCNPO-PO-NBR          27730002
239500             DISPLAY '** PO LINE NBR   = ' PURITM-PO-LNE-NBR      27740002
239600             DISPLAY '** PREPACK ID    = ' POPRPK-PO-PREPK-ID     27750002
239700             DISPLAY '** PARA = 2384-COUNT-DCS-FOR-PACK'          27760002
239800             PERFORM 9100-SQL-ABEND                               27770002
239900     END-EVALUATE.                                                27780002
240000                                                                  27790002
240100******************************************************************27800061
240200                                                                  27810002
240300 2390-COMPUTE-HOW-MANY-LBLS-PDC.                                  27820002
240400                                                                  27830002
240500      IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC               27840002
240600        MOVE TR004-PDC-CART-CT TO PV-NBR-CART-LBLS-THIS-DC        27850002
240700      ELSE                                                        27860002
240800         COMPUTE PV-NBR-CART-LBLS-THIS-DC ROUNDED =               27870002
240900          (PV-NBR-CART-LBLS-UPC * PA-TTL-PCK-SPLIT-QTY-DC-PCT)    27880002
241000      END-IF.                                                     27890002
241100                                                                  27900002
241200      ADD PV-NBR-CART-LBLS-THIS-DC                                27910002
241300                               TO PV-TTL-CART-LBLS-ALL-DCS.       27920002
241400                                                                  27930002
241500******************************************************************27940002
241600                                                                  27950002
241700 2392-COMPUTE-PDC-NO-LABELS.                                      27960002
241800                                                                  27970002
241900      IF PV-NBR-CART-LBLS-THIS-DC > TR004-PDC-CART-CT             27980002
242000        MOVE ZERO TO TR004-PDC-NO-LBL-CART-CT                     27990002
242100      ELSE                                                        28000002
242200        COMPUTE TR004-PDC-NO-LBL-CART-CT =                        28010002
242300          (TR004-PDC-CART-CT - PV-NBR-CART-LBLS-THIS-DC)          28020002
242400      END-IF.                                                     28030002
242500                                                                  28040002
242600******************************************************************28050002
242700                                                                  28060002
242800 2394-CREATE-PCT-CARTON-LABELS.                                   28070002
242900                                                                  28080002
243000      MOVE ZERO TO PV-CARTON-ROWS-FETCHED.                        28090002
243100                                                                  28100002
243200      PERFORM UNTIL PV-CARTON-ROWS-FETCHED =                      28110002
243300                              PV-NBR-CART-LBLS-THIS-DC            28120002
243400                 OR PS-EOC-CART-LABEL-CURSOR                      28130002
243500         PERFORM 8756-FETCH-CART-LABEL-CURSOR                     28140002
243600         EVALUATE TRUE                                            28150002
243700           WHEN PS-EOC-CART-LABEL-CURSOR                          28160002
243800              CONTINUE                                            28170002
243900           WHEN OTHER                                             28180002
244000               ADD +1 TO PV-CARTON-ROWS-FETCHED                   28190002
244100               INITIALIZE TR004-REC-TYPE-PACK-CARTON              28200002
244200               MOVE TRT00008-SSCC-ID (1:20)                       28210002
244300                               TO TR004-PCT-SSCC-ID (1:20)        28220002
244400               MOVE TRT00008-UNT-QTY                              28230002
244500                               TO TR004-PCT-CARTON-UNIT-QTY       28240002
244600               PERFORM 5720-WRITE-PCT-RECORD                      28250002
244700           END-EVALUATE                                           28260002
244800      END-PERFORM.                                                28270002
244900                                                                  28280002
245100******************************************************************28290002
245200 2400-PROCESS-UPC-FOR-BULK.                                       28300002
245300                                                                  28310002
245400     PERFORM 8400-FETCH-BULK-UPC-CUR.                             28320002
245500                                                                  28330002
245600     IF PS-EOC-BULK-UPC-CUR                                       28340002
245700         PERFORM 8300-CLOSE-BULK-UPC-CUR                          28350002
245800     ELSE                                                         28360002
245900       SET PS-UPC-PASSESED-EDITS      TO TRUE                     28370002
246000       PERFORM 2405-BULK-UPC-EDITS                                28380002
246100                                                                  28390002
246200       IF PS-UPC-PASSESED-EDITS                                   28400002
246300                                                                  28410002
246400           INITIALIZE TR004-REC-TYPE-UPC                          28420002
246500           MOVE IMCNUP-UPC-UNT-QTY      TO TR004-UPC-UNIT-QTY     28430002
139868                                           PV-HOLD-PCK-UNIT-QTY   28440099
246600           MOVE IMCNUP-UPC-CBMT-QTY     TO TR004-UPC-CBMT-QTY     28450002
246700           MOVE IMCNUP-UPC-WT-KGRM-QTY  TO TR004-UPC-WT-KGRM-QTY  28460002
246800           MOVE IMCNUP-UPC-NBR          TO TR004-UPC-NBR          28470002
246900           MOVE XLT00004-VS-NBR         TO TR004-VEND-STYL-NAME   28480002
247000           MOVE XLT00003-NRF-CLOR-CDE   TO TR004-UPC-COLOR-CDE    28490002
247100           MOVE XLT00003-CSTM-CLOR-DESC TO TR004-UPC-COLOR-DESC   28500002
247200           MOVE XLT00003-SIZE-DESC      TO TR004-UPC-SIZE-DESC    28510002
247300           MOVE XLT00003-SKU-DESC       TO TR004-SKU-DESC         28520002
247400           MOVE SKXREF-DEPT             TO TR004-DEPT-NBR         28530002
247500           MOVE SKXREF-CLASS            TO TR004-CLASS            28540002
247600           MOVE SKXREF-SUBCLASS         TO TR004-SUB-CLASS        28550002
247700           MOVE SKXREF-SKU              TO TR004-SKU-SEQ-NBR      28560002
247800***        ****************************************               28570002
247900***        * REMOVE THIS MESSAGE 9/9/03 UNTIL ALL *               28580002
248000***        * CONSOL START SENDING SKUS.           *               28590002
248100***        ****************************************               28600002
248200***        IF SKXREF-SKU = IMCNUP-SKU-NBR                         28610002
248300***          CONTINUE                                             28620002
248400***        ELSE                                                   28630002
248500***            SET TR006-ERROR-TYPE-ERROR       TO TRUE           28640002
248600***            INITIALIZE TR006-ERROR-MSG                         28650002
248700***            STRING 'CMN-BULK SKU NOT FOUND'                    28660002
248800***                DELIMITED BY SIZE                              28670002
248900***                INTO TR006-ERROR-MSG                           28680002
249000***            MOVE IMCNUP-SKU-NBR   TO TR006-SKU                 28690002
249100***            PERFORM 8830-WRITE-ERROR-LINE                      28700002
249200***        END-IF                                                 28710002
249300                                                                  28720002
249400           IF  IMCNUP-UPC-UNT-QTY   = ZERO                        28730002
249500            OR IMCNUP-UPC-CART-CNT = ZERO                         28740002
249600              MOVE PURITM-OUTR-PK-QTY  TO TR004-OUTR-PK-QTY       28750002
139868                                          PV-HOLD-PCK-CART-CT     28760099
249700           ELSE                                                   28770002
249800              DIVIDE IMCNUP-UPC-CART-CNT                          28780002
249900                  INTO IMCNUP-UPC-UNT-QTY                         28790002
250000                   GIVING TR004-OUTR-PK-QTY ROUNDED               28800002
139868              MOVE TR004-OUTR-PK-QTY   TO PV-HOLD-PCK-CART-CT     28810099
250100           END-IF                                                 28820002
250200                                                                  28830002
250300           MOVE ZERO                   TO TR004-PACK-RATIO-QTY    28840002
250400                                                                  28850002
250500           PERFORM 2430-GET-CARTON-LABEL-DATA                     28860002
250600           IF IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC          28870002
250700             MOVE ZERO TO TR004-UPC-NO-LBL-CART-CT                28880002
250800           ELSE                                                   28890002
250900             COMPUTE TR004-UPC-NO-LBL-CART-CT =                   28900002
251000               (IMCNUP-UPC-CART-CNT - PV-NBR-CART-LBLS-UPC)       28910002
251100           END-IF                                                 28920002
251200                                                                  28930002
251300           PERFORM 5600-WRITE-PUR-ORDER-UPC-REC                   28940002
251400                                                                  28950002
251500           SET PS-CURR-SPLIT-QTY-PRESENT-NO   TO TRUE             28960002
251600***        SET PS-ORDERED-EQUALS-SHIPPED-NO   TO TRUE             28970002
251700           PERFORM 2520-SUM-DC-SPLIT-QTY                          28980002
251800           IF PS-CURR-SPLIT-QTY-PRESENT                           28990002
251900             SET PS-COUNT-DCS-OK-NO           TO TRUE             29000002
252000             PERFORM 2525-COUNT-DCS-FOR-THIS-UPC                  29010002
252100           END-IF                                                 29020002
252200                                                                  29030002
252300           IF PS-CURR-SPLIT-QTY-PRESENT                           29040002
252400            AND PS-COUNT-DCS-OK                                   29050002
252500              SET PS-FIRST-DC                 TO TRUE             29060002
139868              SET PS-OUTLET-STORE-NO          TO TRUE             29070099
252600              SET PS-DC-SPLIT-INFO-PRESENT-NO TO TRUE             29080002
252700              IF PV-NBR-CART-LBLS-UPC > ZERO                      29090002
252800                PERFORM 8758-OPEN-CART-LABEL-CURSOR               29100002
252900                SET PS-EOC-CART-LABEL-CURSOR-NO TO TRUE           29110002
253000              END-IF                                              29120002
253100              PERFORM 8500-OPEN-DC-CURSOR                         29130002
253200              PERFORM 2500-PROCESS-DC-CURSOR                      29140002
253300                UNTIL PS-EOC-DC-CURSOR                            29150002
253400              SET PS-EOC-DC-CURSOR-NO TO TRUE                     29160002
253500              IF PV-NBR-CART-LBLS-UPC > ZERO                      29170002
253600                PERFORM 8760-CLOSE-CART-LABEL-CURSOR              29180002
253700              END-IF                                              29190002
253800           END-IF                                                 29200002
253900                                                                  29210002
254000       END-IF                                                     29220002
254100                                                                  29230002
254200     END-IF.                                                      29240002
254300                                                                  29250002
254400******************************************************************29260002
254500 2405-BULK-UPC-EDITS.                                             29270002
254600                                                                  29280002
254700       SET PS-ZERO-OUTR-PACK-QTY-NO   TO TRUE.                    29290002
254800**GB 3/24 PERFORM 2420-SELECT-VEND-OUTR-PACK-QTY.                 29300002
254810       IF PURITM-OUTR-PK-QTY = ZERO                               29310002
254820           INITIALIZE TR006-ERROR-MSG                             29320002
254830           MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                  29330002
254840           SET TR006-ERROR-TYPE-ERROR       TO TRUE               29340002
254850           STRING 'CMN-ZERO OTR PK QTY-FIX'                       29350002
254860               DELIMITED BY SIZE                                  29360002
254870               INTO TR006-ERROR-MSG                               29370002
254880           PERFORM 8830-WRITE-ERROR-LINE                          29380002
254890           SET PS-PROBLEM-DO-NOT-SEND TO TRUE                     29390002
254891           SET PS-ZERO-OUTR-PACK-QTY     TO TRUE                  29400002
254892       END-IF                                                     29410002
254900                                                                  29420002
255000       EVALUATE TRUE                                              29430002
255100                                                                  29440002
255200         WHEN PS-ZERO-OUTR-PACK-QTY                               29450002
255300             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                29460002
255400                                                                  29470002
255500         WHEN IMCNUP-ASN-PKGNG-CDE   NOT =    'EA'                29480002
255600               INITIALIZE TR006-ERROR-MSG                         29490002
255700               SET TR006-ERROR-TYPE-ERROR       TO TRUE           29500002
255800               MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR             29510002
255900               MOVE IMCNUP-SKU-NBR   TO TR006-SKU                 29520002
256000               STRING 'CMN-BULK HAS PCK ASN PKG CDE-FIX'          29530002
256100                   DELIMITED BY SIZE                              29540002
256200                   INTO TR006-ERROR-MSG                           29550002
256300               PERFORM 8830-WRITE-ERROR-LINE                      29560002
256400               SET PS-PROBLEM-DO-NOT-SEND TO TRUE                 29570002
256500               SET PS-UPC-PASSESED-EDITS-NO  TO TRUE              29580002
256600                                                                  29590002
256700         WHEN IMCNUP-UPC-CART-CNT = ZERO                          29600002
256800            AND IMCNUP-UPC-UNT-QTY < PURITM-OUTR-PK-QTY           29610002
256900             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                29620002
257000             MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                29630002
257100             MOVE IMCNUP-SKU-NBR  TO TR006-SKU                    29640002
257200             SET TR006-ERROR-TYPE-ERROR       TO TRUE             29650002
257300             INITIALIZE TR006-ERROR-MSG                           29660002
257400             STRING 'CMN-BULK UNITS<OUTR PACK QTY-FIX'            29670002
257500                 DELIMITED BY SIZE                                29680002
257600                 INTO TR006-ERROR-MSG                             29690002
257700             PERFORM 8830-WRITE-ERROR-LINE                        29700002
257800             SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            29710002
257900                                                                  29720002
258000                                                                  29730002
258100         WHEN IMCNUP-UPC-UNT-QTY > ZERO                           29740002
258200          AND IMCNUP-UPC-UNT-QTY < IMCNUP-UPC-CART-CNT            29750002
258300             SET PS-UPC-PASSESED-EDITS-NO  TO TRUE                29760002
258400             MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                29770002
258500             MOVE IMCNUP-SKU-NBR  TO TR006-SKU                    29780002
258600             SET TR006-ERROR-TYPE-ERROR       TO TRUE             29790002
258700             INITIALIZE TR006-ERROR-MSG                           29800002
258800             STRING 'CMN-BLK UNTS LESS THAN CRTNS-FIX'            29810002
258900                 DELIMITED BY SIZE                                29820002
259000                 INTO TR006-ERROR-MSG                             29830002
259100             PERFORM 8830-WRITE-ERROR-LINE                        29840002
259200             SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            29850002
259300                                                                  29860002
259400         WHEN OTHER                                               29870002
259500           SET PS-THERE-ARE-E-COM-DCS-NO  TO TRUE                 29880002
259600           PERFORM 2410-SELECT-E-COM-DCS                          29890002
259700                                                                  29900002
259800           IF PS-THERE-ARE-E-COM-DCS                              29910002
259900             SET PS-THIS-IS-E-COM-UPC-NO   TO TRUE                29920002
260000             PERFORM 2415-SELECT-UPC-FROM-TWEBITM                 29930002
260100                                                                  29940002
260200             IF PS-THIS-IS-E-COM-UPC                              29950002
260300               CONTINUE                                           29960002
260400             ELSE                                                 29970002
260500                 INITIALIZE TR006-ERROR-MSG                       29980002
260600                 MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR            29990002
260700                 MOVE IMCNUP-SKU-NBR  TO TR006-SKU                30000002
260800                 SET TR006-ERROR-TYPE-ERROR       TO TRUE         30010002
260900                 STRING 'CMN-HAS E-COM DC-NOT E-COM SKU'          30020002
261000                     DELIMITED BY SIZE                            30030002
261100                     INTO TR006-ERROR-MSG                         30040002
261200                 PERFORM 8830-WRITE-ERROR-LINE                    30050002
261300                 SET PS-PROBLEM-DO-NOT-SEND TO TRUE               30060002
261400                 SET PS-UPC-PASSESED-EDITS-NO  TO TRUE            30070002
261500             END-IF                                               30080002
261600           END-IF                                                 30090002
261700                                                                  30100002
261800       END-EVALUATE.                                              30110002
261900                                                                  30120002
262000******************************************************************30130002
262100 2410-SELECT-E-COM-DCS.                                           30140002
262200*                                                                 30150002
262300     INITIALIZE PV-NBR-OF-E-COM-DCS.                              30160002
262400*                                                                 30170002
262500     EXEC SQL                                                     30180002
262600           SELECT                                                 30190002
262700                   COUNT(*)                                       30200002
262800             INTO                                                 30210002
262900                  :PV-NBR-OF-E-COM-DCS                            30220002
263000             FROM                                                 30230002
263100                  TUPCSKU   SKU                                   30240002
263200                 ,TPURITM   PUR                                   30250002
263300                 ,TALLPLN   AL                                    30260002
263400*FJW 03/10/10 BEGIN                                               30270002
263410                 ,XLT_LOC   LOC                                   30280002
263420*FJW 03/10/10 END                                                 30290002
263430             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           30300002
263440               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             30310002
263450               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            30320002
263460               AND PUR.PO_LNE_NBR     = :PURITM-PO-LNE-NBR        30330002
263470               AND PUR.VER_STATUS_CDE = 'A'                       30340002
263480               AND PUR.STATUS_CDE     IN ('AC', 'AP')             30350002
263490               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           30360002
263500               AND AL.PO_NBR          =  PUR.PO_NBR               30370002
263600               AND AL.CURR_SPLIT_QTY  >  0                        30380002
263700*FJW 03/10/10 BEGIN                                               30390002
263800*              AND AL.DEST_NBR        =  870                      30400002
263900               AND AL.DEST_NBR        =  LOC.LOC_NBR              30410002
264000               AND LOC.LOC_TYP_CDE    = 'DC'                      30420002
264100               AND LOC.E_BUS_IND      = 'Y'                       30430002
264200*FJW 03/10/10 END                                                 30440002
264300     END-EXEC                                                     30450002
264400                                                                  30460002
264500     EVALUATE TRUE                                                30470002
264600         WHEN SQLCODE = ZERO                                      30480002
264700         WHEN SQLCODE = -811                                      30490002
264800            IF PV-NBR-OF-E-COM-DCS > 0                            30500002
264900              SET PS-THERE-ARE-E-COM-DCS  TO TRUE                 30510002
265000            END-IF                                                30520002
265100                                                                  30530002
265200         WHEN SQLCODE = +100                                      30540002
265300              CONTINUE                                            30550002
265400                                                                  30560002
265500         WHEN SQLWARN0 NOT EQUAL SPACE                            30570002
265600         WHEN SQLCODE NOT EQUAL ZERO                              30580002
265700             DISPLAY '** ABEND **'                                30590002
265800             DISPLAY '** PROGRAM = TRKUP007 **'                   30600002
265900             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          30610002
266000             DISPLAY '** IMCNUP-UPC-NBR = '                       30620002
266100                 IMCNUP-UPC-NBR                                   30630002
266200             DISPLAY '** PARAGRAPH = 2410-SELECT-E-COM-DCS'       30640002
266300             PERFORM 9100-SQL-ABEND                               30650002
266400     END-EVALUATE.                                                30660002
266500                                                                  30670002
266600******************************************************************30680002
266700 2415-SELECT-UPC-FROM-TWEBITM.                                    30690002
266800*                                                                 30700002
266900     INITIALIZE PV-NBR-OF-E-COM-ROWS.                             30710002
267000*                                                                 30720002
267100     EXEC SQL                                                     30730002
267200           SELECT COUNT (*)                                       30740002
267300           INTO   :PV-NBR-OF-E-COM-ROWS                           30750002
267400           FROM TUPCPLS A                                         30760002
267500              , TWEBITM B                                         30770002
267600              , TUPCSKU   SKU                                     30780002
267700              , TPURITM   PUR                                     30790002
267800             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           30800002
267900               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             30810002
268000               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            30820002
268100               AND PUR.VER_STATUS_CDE = 'A'                       30830002
268200               AND PUR.STATUS_CDE    IN ('AC', 'AP')              30840002
268300               AND A.ITM_NBR          =  PUR.ITM_NBR              30850002
268400               AND A.OPERCO_NBR    = '03'                         30860002
268500               AND A.STR_NBR       = 0                            30870002
268600               AND ((A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      30880002
268700                       A.EFF_END_TMST IS NULL) OR                 30890002
268800                      (A.EFF_BEG_TMST <= CURRENT TIMESTAMP AND    30900002
268900                       A.EFF_END_TMST  > CURRENT TIMESTAMP))      30910002
269000               AND A.UPC_ID        = B.INTR_UPC_ID                30920002
269100               AND (B.EFF_BEG_TMST <= CURRENT TIMESTAMP AND       30930002
269200                         B.EFF_END_TMST IS NULL)                  30940002
269300     END-EXEC                                                     30950002
269400                                                                  30960002
269500     EVALUATE TRUE                                                30970002
269600         WHEN SQLCODE = ZERO                                      30980002
269700         WHEN SQLCODE = -811                                      30990002
269800            IF PV-NBR-OF-E-COM-ROWS > 0                           31000002
269900              SET PS-THIS-IS-E-COM-UPC    TO TRUE                 31010002
270000            END-IF                                                31020002
270100                                                                  31030002
270200         WHEN SQLCODE = +100                                      31040002
270300              CONTINUE                                            31050002
270400                                                                  31060002
270500         WHEN SQLWARN0 NOT EQUAL SPACE                            31070002
270600         WHEN SQLCODE NOT EQUAL ZERO                              31080002
270700             DISPLAY '** ABEND **'                                31090002
270800             DISPLAY '** PROGRAM = TRKUP007 **'                   31100002
270900             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          31110002
271000             DISPLAY '** IMCNUP-UPC-NBR = '                       31120002
271100                 IMCNUP-UPC-NBR                                   31130002
271200             DISPLAY '** PARAGRAPH = 2415-SELECT-UPC-FROM-TWEBITM'31140002
271300             PERFORM 9100-SQL-ABEND                               31150002
271400     END-EVALUATE.                                                31160002
271500                                                                  31170002
271600******************************************************************31180002
271700*2420-SELECT-VEND-OUTR-PACK-QTY.                                  31190002
271800*                                                                 31200002
271900*    EXEC SQL                                                     31210002
272000*          SELECT                                                 31220002
272100*                 UPC.OUTR_PK_QTY                                 31230002
272200*            INTO                                                 31240002
272300*                 :UPC-OUTR-PK-QTY                                31250002
272400*            FROM                                                 31260002
272500*                 TSKXREF  SKX                                    31270002
272600*                ,TUPC     UPC                                    31280002
272700*          WHERE  SKX.ITM_NBR      =  :PURITM-ITM-NBR             31290002
272800*            AND  SKX.INTR_UPC_ID  =  UPC.INTR_UPC_ID             31300002
272900*            AND  UPC.UPC_TYP_CDE  = 'I'                          31310002
273000*    END-EXEC                                                     31320002
273100*                                                                 31330002
273200*    EVALUATE TRUE                                                31340002
273300*        WHEN SQLCODE = ZERO                                      31350002
273400*            IF UPC-OUTR-PK-QTY = ZERO                            31360002
273500*                INITIALIZE TR006-ERROR-MSG                       31370002
273600*                MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR            31380002
273700*                SET TR006-ERROR-TYPE-ERROR       TO TRUE         31390002
273800*                STRING 'CMN-ZERO OTR PK QTY-FIX'                 31400002
273900*                    DELIMITED BY SIZE                            31410002
274000*                    INTO TR006-ERROR-MSG                         31420002
274100*                PERFORM 8830-WRITE-ERROR-LINE                    31430002
274200*                SET PS-PROBLEM-DO-NOT-SEND TO TRUE               31440002
274300*                SET PS-ZERO-OUTR-PACK-QTY     TO TRUE            31450002
274400*            END-IF                                               31460002
274500*                                                                 31470002
274600*        WHEN SQLCODE = +100                                      31480002
274700*            MOVE 0 TO UPC-OUTR-PK-QTY                            31490002
274800*            MOVE IMCNUP-UPC-NBR  TO TR006-UPC-NBR                31500002
274900*            SET TR006-ERROR-TYPE-ERROR       TO TRUE             31510002
275000*            INITIALIZE TR006-ERROR-MSG                           31520002
275100*            STRING 'CMN-SKU OUTR PK QTY NT FOUND-FIX'            31530002
275200*                DELIMITED BY SIZE                                31540002
275300*                INTO TR006-ERROR-MSG                             31550002
275400*            PERFORM 8830-WRITE-ERROR-LINE                        31560002
275500*            SET PS-PROBLEM-DO-NOT-SEND        TO TRUE            31570002
275600*            SET PS-ZERO-OUTR-PACK-QTY         TO TRUE            31580002
275700*                                                                 31590002
275800*        WHEN SQLWARN0 NOT EQUAL SPACE                            31600002
275900*        WHEN SQLCODE NOT EQUAL ZERO                              31610002
276000*            DISPLAY '** ABEND **'                                31620002
276100*            DISPLAY '** PROGRAM = TRKUP007 **'                   31630002
276200*            DISPLAY '** PARAGRAPH = 2420-SEL-VEND-OUTR-PACK-QTY*'31640002
276300*            DISPLAY '** PURITM-ITM-NBR = ' PURITM-ITM-NBR        31650002
276400*            DISPLAY '** PURCHS-PO-NBR = ' PURCHS-PO-NBR          31660002
276500*            DISPLAY '** PURITM-PO-LNE-NBR = '                    31670002
276600*                 PURITM-PO-LNE-NBR                               31680002
276700*            PERFORM 9100-SQL-ABEND                               31690002
276800*    END-EVALUATE.                                                31700002
276900*                                                                 31710002
277000******************************************************************31720002
277100* CARTON LABEL MAIN PROCESS                                      *31730002
277200******************************************************************31740002
277300                                                                  31750002
277400 2430-GET-CARTON-LABEL-DATA.                                      31760002
277500                                                                  31770002
277600     INITIALIZE PV-LABEL-WORK-FIELDS.                             31780002
277700     PERFORM 2445-SELECT-CART-LBL-CNT.                            31790002
277800                                                                  31800002
277900     EVALUATE TRUE                                                31810002
278000                                                                  31820002
278100       WHEN PV-NBR-CART-LBLS-UPC = ZERO                           31830002
278200           CONTINUE                                               31840002
278300       WHEN IMCNUP-UPC-CART-CNT   NOT =   PV-NBR-CART-LBLS-UPC    31850002
278400           PERFORM 2435-CARTON-LABEL-EDITS                        31860002
278500                                                                  31870002
278600     END-EVALUATE.                                                31880002
278700                                                                  31890002
278800******************************************************************31900002
278900* CARTON LABEL EDITS FOR BULK OR PACKS                           *31910002
279000******************************************************************31920002
279100                                                                  31930002
279200 2435-CARTON-LABEL-EDITS.                                         31940002
279300                                                                  31950002
279400     MOVE IMCNPO-PO-NBR          TO TR006-PO-NBR.                 31960002
279500     MOVE IMCNUP-UPC-NBR         TO TR006-UPC-NBR.                31970002
279600     MOVE IMCNUP-SKU-NBR         TO TR006-SKU.                    31980002
279700     SET TR006-ERROR-TYPE-ERROR  TO TRUE.                         31990002
279800     INITIALIZE TR006-ERROR-MSG.                                  32000002
279900                                                                  32010002
280000     EVALUATE TRUE                                                32020002
280100                                                                  32030002
280200*     *** PACKS ***                                               32040002
280300      WHEN PURCHS-PKGNG-CDE = PC-M OR PC-I                        32050002
280400       MOVE POPRPK-PO-PREPK-ID     TO TR006-PACK-ID               32060002
280500       EVALUATE TRUE                                              32070002
280600          WHEN IMCNUP-UPC-CART-CNT > PV-NBR-CART-LBLS-UPC         32080002
280700              STRING 'CMN-PCK UPC CTN CT>TOTL SSCC IDS'           32090002
280800                    DELIMITED BY SIZE                             32100002
280900              INTO TR006-ERROR-MSG                                32110002
281000          WHEN IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC         32120002
281100              STRING 'CMN-PCK UPC CTN CT<TOTL SSCC IDS'           32130002
281200                    DELIMITED BY SIZE                             32140002
281300              INTO TR006-ERROR-MSG                                32150002
281400       END-EVALUATE                                               32160002
281500                                                                  32170002
281600*     *** BULK ***                                                32180002
281700      WHEN OTHER                                                  32190002
281800       EVALUATE TRUE                                              32200002
281900        WHEN IMCNUP-UPC-CART-CNT > PV-NBR-CART-LBLS-UPC           32210002
282000            STRING 'CMN-BLK UPC CTN CT>TOTL SSCC IDS'             32220002
282100                  DELIMITED BY SIZE                               32230002
282200            INTO TR006-ERROR-MSG                                  32240002
282300        WHEN IMCNUP-UPC-CART-CNT < PV-NBR-CART-LBLS-UPC           32250002
282400            STRING 'CMN-BLK UPC CTN CT<TOTL SSCC IDS'             32260002
282500                  DELIMITED BY SIZE                               32270002
282600            INTO TR006-ERROR-MSG                                  32280002
282700       END-EVALUATE                                               32290002
282800                                                                  32300002
282900     END-EVALUATE.                                                32310002
283000                                                                  32320002
283100     PERFORM 8830-WRITE-ERROR-LINE.                               32330002
283200                                                                  32340002
283300******************************************************************32350002
283400*FJW 03/10/10 BEGIN                                               32360002
283500*    THE FOLLOWING IS DEAD CODE AND WAS CAUSING A COMPILE WARNING 32370002
283600*2440-NO-CART-LABELS-MSG.                                         32380002
283700*                                                                 32390002
283800*    MOVE IMCNPO-PO-NBR          TO TR006-PO-NBR.                 32400002
283900*    MOVE IMCNUP-UPC-NBR         TO TR006-UPC-NBR.                32410002
284000*    MOVE IMCNUP-SKU-NBR         TO TR006-SKU.                    32420002
284100*    SET TR006-ERROR-TYPE-ERROR  TO TRUE.                         32430002
284200*    INITIALIZE TR006-ERROR-MSG.                                  32440002
284300*    IF PURCHS-PKGNG-CDE = PC-M OR PC-I                           32450002
284400*      MOVE POPRPK-PO-PREPK-ID     TO TR006-PACK-ID               32460002
284500*      STRING 'CMN-FCTRY LBLS BUT NO CRTNS SNT'                   32470002
284600*         DELIMITED BY SIZE                                       32480002
284700*          INTO TR006-ERROR-MSG                                   32490002
284800*    ELSE                                                         32500002
284900*      STRING 'CMN-FCTRY LBLS BUT NO CRTNS SNT'                   32510002
285000*         DELIMITED BY SIZE                                       32520002
285100*          INTO TR006-ERROR-MSG                                   32530002
285200*    END-IF.                                                      32540002
285300*                                                                 32550002
285400*    PERFORM 8830-WRITE-ERROR-LINE.                               32560002
285500*FJW 03/10/10 END                                                 32570002
285600*                                                                 32580002
285700******************************************************************32590002
285800                                                                  32600002
285900 2445-SELECT-CART-LBL-CNT.                                        32610002
286000                                                                  32620002
286100     EXEC SQL                                                     32630002
286200           SELECT COUNT (*)                                       32640002
286300             INTO :PV-NBR-CART-LBLS-UPC                           32650002
286400             FROM TRT_IMPRT_CART                                  32660002
286500            WHERE CONTNR_ID      = :IMCNTK-CONTNR-ID              32670002
286600              AND CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR         32680002
286700              AND PO_NBR         = :IMCNPO-PO-NBR                 32690002
286800              AND UPC_NBR        = :IMCNUP-UPC-NBR                32700002
286900     END-EXEC                                                     32710002
287000                                                                  32720002
287100     EVALUATE TRUE                                                32730002
287200         WHEN SQLCODE = ZERO                                      32740002
287300             CONTINUE                                             32750002
287400                                                                  32760002
287500         WHEN SQLCODE = +100                                      32770002
287600             MOVE 0 TO PV-NBR-CART-LBLS-UPC                       32780002
287700                                                                  32790002
287800         WHEN SQLWARN0 NOT EQUAL SPACE                            32800002
287900         WHEN SQLCODE NOT EQUAL ZERO                              32810002
288000             DISPLAY '** ABEND **'                                32820002
288100             DISPLAY '** PROGRAM = TRKUP007 **'                   32830002
288200             DISPLAY '** PARAGRAPH = 2445-SELECT-CART-LBL-CNT'    32840002
288300             DISPLAY '** IMCNTK-CONTNR-ID      ' IMCNTK-CONTNR-ID 32850002
288400             DISPLAY '** IMCNPO-PO-NBR         '    IMCNPO-PO-NBR 32860002
288500             DISPLAY '** IMCNUP-UPC-NBR        '   IMCNUP-UPC-NBR 32870002
288600             PERFORM 9100-SQL-ABEND                               32880002
288700     END-EVALUATE.                                                32890002
288800                                                                  32900002
288900******************************************************************32910002
289000 2480-PROCESS-PREPACK-UPC.                                        32920002
289100                                                                  32930002
289200     PERFORM 8460-FETCH-PACK-UPC-CURSOR.                          32940002
289300                                                                  32950002
289400     IF PS-EOC-PREPACK-UPC-CURSOR                                 32960002
289500       PERFORM 8455-CLOSE-PACK-UPC-CURSOR                         32970002
289600     ELSE                                                         32980002
289700       INITIALIZE TR004-REC-TYPE-UPC                              32990002
289800       MOVE TUPCSKU-UPC-NBR         TO TR004-UPC-NBR              33000002
289900       MOVE XLT00004-VS-NBR         TO TR004-VEND-STYL-NAME       33010002
290000       MOVE XLT00003-NRF-CLOR-CDE   TO TR004-UPC-COLOR-CDE        33020002
290100       MOVE XLT00003-CSTM-CLOR-DESC TO TR004-UPC-COLOR-DESC       33030002
290200       MOVE XLT00003-SIZE-DESC      TO TR004-UPC-SIZE-DESC        33040002
290300       MOVE XLT00003-SKU-DESC       TO TR004-SKU-DESC             33050002
290400       MOVE SKXREF-DEPT             TO TR004-DEPT-NBR             33060002
290500       MOVE SKXREF-CLASS            TO TR004-CLASS                33070002
290600       MOVE SKXREF-SUBCLASS         TO TR004-SUB-CLASS            33080002
290700       MOVE SKXREF-SKU              TO TR004-SKU-SEQ-NBR          33090002
290800       MOVE 1                       TO TR004-OUTR-PK-QTY          33100002
290900                                                                  33110002
291000*      ***************************************************        33120002
291100*      * PURITM UNIT QUANTITY IS FOR THE PO/LINE WHICH   *        33130002
291200*      * WE ARE UNABLE TO BREAK DOWN BY CONTAINER. UPC   *        33140002
291300*      * UNITS WILL THEREFORE APPEAR TO BE HIGH IF THE   *        33150002
291400*      * PO IS ON MULTIPLE CONTAINERS.                   *        33160002
291500*      *                                                 *        33170002
291600*      * TO AVOID CONFUSION WE DON'T THE CALC PACK'S     *        33180002
291700*      * COMPONANT QTYS BECAUSE:                         *        33190002
291800*      * 1. ROUNDING IS IMPOSSIBLE TO RECONCILE FOR UPCS *        33200002
291900*      *    THAT ARE SUPPOSE TO BE IN A RATIO WITHIN A   *        33210002
292000*      *    PACK.                                        *        33220002
292100*      * 2. IF SENT AS A BULK THE COMPONENT UPC QTYS     *        33230002
292200*      *    COULD BE DIFFERENT THEN THE ORDERED QTYS.    *        33240002
292300*      ***************************************************        33250002
292400       MOVE PURITM-UNT-QTY         TO TR004-UPC-UNIT-QTY          33260002
292500*      ***************************************************        33270002
292600                                                                  33280002
292700**BUD *IF PURCHS-PKGNG-CDE = PC-M                                 33290019
292700       IF POPRPK-PREPK-TYP-CDE = PC-M                             33300019
292800          MOVE PURITM-PREPK-RATO-QTY  TO TR004-PACK-RATIO-QTY     33310002
292900       ELSE                                                       33320002
293000          IF POPRPK-INPK-UNT-QTY = ZERO                           33330002
293100            MOVE ZERO TO TR004-PACK-RATIO-QTY                     33340002
293200            PERFORM 2482-INPK-ZERO-ERROR                          33350002
293300          ELSE                                                    33360002
293400            COMPUTE  TR004-PACK-RATIO-QTY =                       33370002
293500                 (POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY) *    33380002
293600                    PURITM-PREPK-RATO-QTY                         33390002
293700          END-IF                                                  33400002
293800       END-IF                                                     33410002
293900                                                                  33420002
294000       PERFORM 5600-WRITE-PUR-ORDER-UPC-REC                       33430002
294100                                                                  33440002
294200     END-IF.                                                      33450002
294300                                                                  33460002
294400******************************************************************33470002
294500*  ONLY PRINT THE MESSAGE ONCE PER PO/PACK ID COMBO.              33480002
294600******************************************************************33490002
294700 2482-INPK-ZERO-ERROR.                                            33500002
294800                                                                  33510002
294900     IF PV-HOLD-PO-PREPK-PO = TR006-PO-NBR                        33520002
295000       AND PV-HOLD-PO-PREPK-ID = TR006-PACK-ID                    33530002
295100         CONTINUE                                                 33540002
295200     ELSE                                                         33550002
295300         SET TR006-ERROR-TYPE-ERROR   TO TRUE                     33560002
295400         INITIALIZE TR006-ERROR-MSG                               33570002
295500         STRING 'CMN-POPRPK-INPK-UNT-QY FLD 0-DTL'                33580002
295600             DELIMITED BY SIZE                                    33590002
295700             INTO TR006-ERROR-MSG                                 33600002
295800         MOVE IMCNUP-SKU-NBR   TO TR006-SKU                       33610002
295900         PERFORM 8830-WRITE-ERROR-LINE                            33620002
296000         MOVE TR006-PO-NBR     TO  PV-HOLD-PO-PREPK-PO            33630002
296100         MOVE TR006-PACK-ID    TO  PV-HOLD-PO-PREPK-ID            33640002
296200     END-IF.                                                      33650002
296300                                                                  33660002
296400******************************************************************33670002
296500 2500-PROCESS-DC-CURSOR.                                          33680099
296600                                                                  33690095
296700     PERFORM 8700-FETCH-DC-CURSOR.                                33700002
296800                                                                  33710002
139868     IF PS-EOC-DC-CURSOR                                          33720099
139868        PERFORM 2510-PROCESS-DC-CONTINUE                          33730099
139868     ELSE                                                         33740099
139868        MOVE ALLPLN-DEST-NBR TO KRPRPM-LOC-ID                     33750099
139868        PERFORM 1120-SELECT-OUTLET-PARM                           33760099
139868        IF PS-OUTLET-STORE                                        33770099
139868           SET PS-FIRST-STORE    TO TRUE                          33780099
155029           PERFORM 2522-SUM-STORE-SPLIT-QTY                       33790099
139868           PERFORM 8900-OUTLET-STORE-DC                           33800099
337500        ELSE                                                      33810099
155029           EVALUATE TRUE                                          33820099
155029              WHEN (PV-FAST-RDC-IND   = 'Y'                       33830099
155029               AND  PV-FAST-E-BUS-IND = 'N')                      33840099
155029                 IF PS-FIRST-UPC-YES                              33850099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 33860099
155029                    SET PS-FIRST-STORE    TO TRUE                 33870099
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              33880099
155029                 END-IF                                           33890099
155029                 SET PS-OUTLET-STORE   TO TRUE                    33900099
155029                 PERFORM 8900-OUTLET-STORE-DC                     33910099
155029                                                                  33920099
155029              WHEN (PV-FAST-EFC-IND   = 'Y'                       33930099
155029               AND  PV-FAST-E-BUS-IND = 'Y')                      33940099
155029                 IF PS-FIRST-UPC-YES                              33950099
155029                    SET PS-FIRST-UPC-NO   TO TRUE                 33960099
155029                    SET PS-FIRST-STORE    TO TRUE                 33970099
155029                    PERFORM 2522-SUM-STORE-SPLIT-QTY              33980099
155029                 END-IF                                           33990099
155029                 SET PS-OUTLET-STORE   TO TRUE                    34000099
155029                 PERFORM 8900-OUTLET-STORE-DC                     34010099
155029                                                                  34020099
155029              WHEN OTHER                                          34030099
339700                 PERFORM 2510-PROCESS-DC-CONTINUE                 34040099
339800                                                                  34050099
155029           END-EVALUATE                                           34060099
340000        END-IF                                                    34070099
340100     END-IF.                                                      34080099
139868                                                                  34090099
139868******************************************************************34100099
139868 2510-PROCESS-DC-CONTINUE.                                        34110099
139868                                                                  34120099
296900     IF PS-EOC-DC-CURSOR                                          34130002
297000        PERFORM 8600-CLOSE-DC-CURSOR                              34140002
297100        IF PS-DC-SPLIT-INFO-PRESENT                               34150002
139868           IF PS-OUTLET-STORE                                     34160099
139868              CONTINUE                                            34170099
139868           ELSE                                                   34180099
297200              PERFORM 2540-ADJUST-ROUNDED-DC-DIST                 34190099
297300              PERFORM 5700-WRITE-DC-RECORD                        34200057
297400              IF PV-NBR-CART-LBLS-UPC > 0                         34210057
297500                PERFORM 2720-CREATE-DC-CARTON-LABELS              34220057
297600              END-IF                                              34230057
139868           END-IF                                                 34240099
297700        END-IF                                                    34250002
297800     ELSE                                                         34260002
297900        IF PS-FIRST-DC                                            34270002
298000          SET PS-FIRST-DC-NO     TO TRUE                          34280002
298100*         ***************************************************     34290002
298200*         * IF THERE ARE MORE DCS THAN CARTONS, WE NEED TO        34300002
298300*         * KNOW HOW MANY DCS TO SKIP SENDING CARTONS TO.         34310002
298400*         ***************************************************     34320002
298500          COMPUTE PV-DCS-TO-SKIP =                                34330002
298600           (IMCNUP-UPC-CART-CNT - PV-TOTAL-NBR-OF-DCS) * (-1)     34340002
298700                                                                  34350002
298800          INITIALIZE PV-TTL-ALL-DCS-PCT                           34360002
298900                     PV-TTL-ALL-DCS-UNITS                         34370002
299000                     PV-TTL-ALL-DCS-CARTS                         34380002
299100        ELSE                                                      34390002
299200*           *******************************************           34400002
299300*           * IF NOT EOC OR FIRST DC, WRITE THE DTL   *           34410002
299400*           * EXTRACT & REPORT RECS FROM THE PRIOR DC *           34420002
299500*           *******************************************           34430002
299600            PERFORM 5700-WRITE-DC-RECORD                          34440099
299700            IF PV-NBR-CART-LBLS-UPC > 0                           34450002
155029            AND PS-BYPASS-CRTN-WRITE-NO                           34460099
299800              PERFORM 2720-CREATE-DC-CARTON-LABELS                34470002
299900            END-IF                                                34480002
300000        END-IF                                                    34490099
155029        IF PV-FAST-E-BUS-IND = 'Y'                                34500099
155029           PERFORM 2520-SUM-DC-SPLIT-QTY                          34510099
155029        END-IF                                                    34520099
300100        INITIALIZE TR004-REC-TYPE-DC                              34530002
300200        MOVE ALLPLN-DEST-NBR     TO TR004-DIST-CNTR               34540002
300300        PERFORM 2530-DC-COMPUTATIONS                              34550002
300400        IF PV-DCS-TO-SKIP  > ZERO                                 34560002
300500          SUBTRACT 1 FROM PV-DCS-TO-SKIP                          34570002
300600        END-IF                                                    34580002
300700     END-IF.                                                      34590002
300800                                                                  34600002
300900******************************************************************34610002
301000 2520-SUM-DC-SPLIT-QTY.                                           34620002
301100*                                                                 34630002
301200     EXEC SQL                                                     34640002
301300           SELECT                                                 34650002
301400                  SUM (AL.CURR_SPLIT_QTY)                         34660002
301500             INTO                                                 34670002
301600                  :PA-TOTAL-CURR-SPLIT-QTY                        34680002
301700             FROM                                                 34690002
301800                  TIMCNUP   CNUP                                  34700002
301900                 ,TUPCSKU   SKU                                   34710002
302000                 ,TPURITM   PUR                                   34720002
302100                 ,TALLPLN   AL                                    34730002
302200             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        34740002
302300               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   34750002
302400               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          34760002
155029               AND CNUP.UPC_NBR        =  SKU.UPC_NBR             34770099
302500               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            34780002
302600               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           34790002
302700               AND PUR.VER_STATUS_CDE  = 'A'                      34800002
302800               AND PUR.STATUS_CDE     IN ('AC', 'AP')             34810002
302900               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          34820002
303000               AND AL.PO_NBR           =  PUR.PO_NBR              34830002
303100               AND AL.CURR_SPLIT_QTY  >  0                        34840002
303200     END-EXEC                                                     34850002
303300                                                                  34860002
303400     EVALUATE TRUE                                                34870002
303500         WHEN SQLCODE = ZERO                                      34880002
303600         WHEN SQLCODE = -305                                      34890002
303700                                                                  34900002
303800             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    34910002
303900              OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC              34920002
304000                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        34930002
304100                 PERFORM 8710-MISSING-SPLIT-ERROR                 34940002
304200             ELSE                                                 34950002
304300                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            34960002
304400             END-IF                                               34970002
304500                                                                  34980002
304600         WHEN SQLCODE = +100                                      34990002
304700             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            35000002
304800             PERFORM 8710-MISSING-SPLIT-ERROR                     35010002
304900                                                                  35020002
305000         WHEN SQLWARN0 NOT EQUAL SPACE                            35030002
305100         WHEN SQLCODE NOT EQUAL ZERO                              35040002
305200             DISPLAY '** ABEND **'                                35050002
305300             DISPLAY '** PROGRAM = TRKUP007 **'                   35060002
305400             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          35070002
305500             DISPLAY '** IMCNUP-UPC-NBR = '                       35080002
305600                 IMCNUP-UPC-NBR                                   35090002
305700             DISPLAY '** PARAGRAPH = 2520-SUM-DC-SPLIT-QTY**'     35100002
305800             PERFORM 9100-SQL-ABEND                               35110002
305900     END-EVALUATE.                                                35120002
306000                                                                  35130002
139868******************************************************************35140099
139868*  RETRIEVE THE TOTAL QUANTITY FOR THE OUTLET STORE               35150099
139868******************************************************************35160099
139868 2522-SUM-STORE-SPLIT-QTY.                                        35170099
139868                                                                  35180099
139868     EXEC SQL                                                     35190099
139868           SELECT SUM (ES.STR_DISTRO_QTY)                         35200099
139868             INTO :PA-TOTAL-CURR-SPLIT-QTY                        35210099
139868             FROM TIMCNUP   CNUP                                  35220099
139868                 ,TUPCSKU   SKU                                   35230099
139868                 ,TPURITM   PUR                                   35240099
139868                 ,TALLPLN   AL                                    35250099
139868                 ,TMESTDS   ES                                    35260099
139868             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        35270099
139868               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   35280099
139868               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          35290099
139868               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            35300099
139868               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           35310099
139868               AND PUR.VER_STATUS_CDE  = 'A'                      35320099
139868               AND PUR.STATUS_CDE     IN ('AC', 'AP')             35330099
139868               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          35340099
139868               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           35350099
139868               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         35360099
139868               AND AL.PO_NBR           =  PUR.PO_NBR              35370099
139868               AND AL.PO_NBR           =  CNUP.PO_NBR             35380099
139868               AND AL.PLAN_NBR         =  ES.PLAN_NBR             35390099
139868               AND PUR.PO_NBR          =  ES.PO_NBR               35400099
139868               AND ES.STR_DISTRO_QTY  >  0                        35410099
139868     END-EXEC                                                     35420099
139868                                                                  35430099
139868     EVALUATE TRUE                                                35440099
139868         WHEN SQLCODE = ZERO                                      35450099
139868         WHEN SQLCODE = -305                                      35460099
139868                                                                  35470099
139868             IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                    35480099
139868             OR PA-TOTAL-CURR-SPLIT-QTY NOT NUMERIC               35490099
139868                 MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT        35500099
139868                 PERFORM 8710-MISSING-SPLIT-ERROR                 35510099
139868             ELSE                                                 35520099
139868                 SET PS-CURR-SPLIT-QTY-PRESENT TO TRUE            35530099
139868             END-IF                                               35540099
139868                                                                  35550099
139868         WHEN SQLCODE = +100                                      35560099
139868             MOVE ZEROES  TO PV-QUOTIENT-ORDER-PERCENT            35570099
139868             PERFORM 8710-MISSING-SPLIT-ERROR                     35580099
139868                                                                  35590099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            35600099
139868         WHEN SQLCODE NOT EQUAL ZERO                              35610099
139868             DISPLAY '** ABEND **'                                35620099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   35630099
139868             DISPLAY '** IMCNTK-CONTNR-ID = ' IMCNTK-CONTNR-ID    35640099
139868             DISPLAY '** IMCNTK-CONTNR-SEQ-NBR = '                35650099
139868                                            IMCNTK-CONTNR-SEQ-NBR 35660099
139868             DISPLAY '** IMCNPO-PO-NBR    = ' IMCNPO-PO-NBR       35670099
139868             DISPLAY '** IMCNUP-UPC-NBR   = ' IMCNUP-UPC-NBR      35680099
139868             DISPLAY '** PARAGRAPH = 2522-SUM-STORE-SPLIT-QTY**'  35690099
139868             PERFORM 9100-SQL-ABEND                               35700099
139868     END-EVALUATE.                                                35710099
139868                                                                  35720099
306100******************************************************************35730002
306200 2525-COUNT-DCS-FOR-THIS-UPC.                                     35740002
306300*                                                                 35750002
306400     EXEC SQL                                                     35760002
306500           SELECT                                                 35770002
306600                   COUNT(DISTINCT AL.DEST_NBR)                    35780002
306700             INTO                                                 35790002
306800                  :PV-TOTAL-NBR-OF-DCS                            35800002
306900             FROM                                                 35810002
307000                  TUPCSKU   SKU                                   35820002
307100                 ,TPURITM   PUR                                   35830002
307200                 ,TALLPLN   AL                                    35840002
307300             WHERE SKU.UPC_NBR        = :IMCNUP-UPC-NBR           35850002
307400               AND PUR.ITM_NBR        =  SKU.ITEM_NBR             35860002
307500               AND PUR.PO_NBR         = :IMCNPO-PO-NBR            35870002
307600               AND PUR.VER_STATUS_CDE = 'A'                       35880002
307700               AND PUR.STATUS_CDE     IN ('AC', 'AP')             35890002
307800               AND AL.PO_LNE_NBR      =  PUR.PO_LNE_NBR           35900002
307900               AND AL.PO_NBR          =  PUR.PO_NBR               35910002
308000               AND AL.CURR_SPLIT_QTY  >  0                        35920002
308100     END-EXEC                                                     35930002
308200                                                                  35940002
308300     EVALUATE TRUE                                                35950002
308400         WHEN SQLCODE = ZERO AND PV-TOTAL-NBR-OF-DCS = ZERO       35960002
308500         WHEN SQLCODE = +100                                      35970002
308600             PERFORM 8710-MISSING-SPLIT-ERROR                     35980002
308700                                                                  35990002
308800         WHEN SQLCODE = ZERO                                      36000002
308900             SET PS-COUNT-DCS-OK         TO TRUE                  36010002
309000                                                                  36020002
309100         WHEN SQLWARN0 NOT EQUAL SPACE                            36030002
309200         WHEN SQLCODE NOT EQUAL ZERO                              36040002
309300             DISPLAY '** ABEND **'                                36050002
309400             DISPLAY '** PROGRAM = TRKUP007 **'                   36060002
309500             DISPLAY '** IMCNPO-PO-NBR = ' IMCNPO-PO-NBR          36070002
309600             DISPLAY '** IMCNUP-UPC-NBR = '                       36080002
309700                 IMCNUP-UPC-NBR                                   36090002
309800             DISPLAY '** PARAGRAPH = 2525-COUNT-DCS-FOR-THIS-UPC' 36100002
309900             PERFORM 9100-SQL-ABEND                               36110002
310000     END-EVALUATE.                                                36120002
310100                                                                  36130002
310200******************************************************************36140065
310300 2530-DC-COMPUTATIONS.                                            36150002
310400                                                                  36160002
310500     IF PA-TOTAL-CURR-SPLIT-QTY = ZERO                            36170027
310600       CONTINUE                                                   36180002
310700     ELSE                                                         36190002
310800       DIVIDE PA-TOTAL-CURR-SPLIT-QTY    INTO                     36200049
310900         ALLPLN-CURR-SPLIT-QTY         GIVING                     36210049
311000         PV-QUOTIENT-ORDER-PERCENT                                36220049
311100     END-IF.                                                      36230027
311200                                                                  36240002
311300     MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                        36250002
311400          100 GIVING TR004-DC-PERCNT ROUNDED.                     36260002
311500     IF TR004-DC-PERCNT = ZERO                                    36270002
311600        MOVE +1 TO TR004-DC-PERCNT                                36280002
311700     END-IF.                                                      36290002
311800                                                                  36300002
311900     PERFORM 2532-CALC-CART-COUNT.                                36310002
312000     MOVE PV-DC-CART-CT TO TR004-DC-CART-CT.                      36320002
312100                                                                  36330002
312200                                                                  36340002
312300***  IF PS-ORDERED-EQUALS-SHIPPED                                 36350002
312400***    MOVE ALLPLN-CURR-SPLIT-QTY  TO TR004-DC-UNIT-QTY           36360002
312500***  ELSE                                                         36370002
312600     COMPUTE TR004-DC-UNIT-QTY  =                                 36380002
312700            (TR004-DC-CART-CT * TR004-OUTR-PK-QTY).               36390002
312800                                                                  36400002
312900     PERFORM 2700-COMPUTE-HOW-MANY-LBLS-DC.                       36410002
313000     PERFORM 2710-COMPUTE-DC-NO-LABELS.                           36420002
313100                                                                  36430002
313200     ADD  TR004-DC-PERCNT      TO PV-TTL-ALL-DCS-PCT.             36440002
313300     ADD  TR004-DC-UNIT-QTY    TO PV-TTL-ALL-DCS-UNITS.           36450002
313400     ADD  TR004-DC-CART-CT     TO PV-TTL-ALL-DCS-CARTS.           36460002
313500                                                                  36470002
313600******************************************************************36480002
313700 2532-CALC-CART-COUNT.                                            36490002
313800                                                                  36500002
313900     EVALUATE TRUE                                                36510002
314000                                                                  36520002
314100        WHEN PV-DCS-TO-SKIP  > ZERO                               36530002
314200          MOVE ZERO    TO PV-DC-CART-CT                           36540002
314300                                                                  36550002
314400        WHEN IMCNUP-UPC-CART-CNT > 0                              36560002
314500          COMPUTE PV-DC-CART-CT ROUNDED =                         36570002
314600            (IMCNUP-UPC-CART-CNT * PV-QUOTIENT-ORDER-PERCENT)     36580002
314700          ADD .5 TO PV-DC-CART-CT                                 36590002
314800                                                                  36600002
314900        WHEN TR004-OUTR-PK-QTY = 0                                36610002
315000          SET TR006-ERROR-TYPE-ERROR   TO TRUE                    36620002
315100          INITIALIZE TR006-ERROR-MSG                              36630002
315200          STRING 'CMN-ZRO OTR PK QTY-CAL IS-NT SNT'               36640002
315300              DELIMITED BY SIZE                                   36650002
315400              INTO TR006-ERROR-MSG                                36660002
315500          PERFORM 8830-WRITE-ERROR-LINE                           36670002
315600          MOVE ZERO TO PV-DC-CART-CT                              36680002
315700          SET PS-PROBLEM-DO-NOT-SEND TO TRUE                      36690002
315800                                                                  36700002
315900        WHEN OTHER                                                36710002
316000          COMPUTE PV-DC-CART-CT ROUNDED =                         36720002
316100          (IMCNUP-UPC-UNT-QTY / TR004-OUTR-PK-QTY)                36730002
316200                     * PV-QUOTIENT-ORDER-PERCENT                  36740002
316300          ADD .5 TO PV-DC-CART-CT                                 36750002
316400                                                                  36760002
316500     END-EVALUATE.                                                36770002
316600                                                                  36780002
316700     IF PV-DC-CART-CT = ZERO                                      36790002
316800        IF PURCHS-NEW-STR-PO-IND = PC-Y                           36800002
316900          PERFORM 2610-ZERO-CARTS-ERROR-BULK                      36810002
317000        END-IF                                                    36820002
317100     ELSE                                                         36830002
317200*       **** NOT ZERO BUT LESS THAN 1  (FOR EXAMPLE .2)           36840002
317300        IF PV-DC-CART-CT < 1                                      36850002
317400          MOVE 1     TO PV-DC-CART-CT                             36860002
317500        END-IF                                                    36870002
317600     END-IF.                                                      36880002
317700                                                                  36890002
317800******************************************************************36900002
317900 2540-ADJUST-ROUNDED-DC-DIST.                                     36910002
318000                                                                  36920099
318100     IF PV-TTL-ALL-DCS-PCT = 100                                  36930099
318200       CONTINUE                                                   36940099
318300     ELSE                                                         36950002
318400       COMPUTE TR004-DC-PERCNT =                                  36960002
318500            TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)          36970002
318600     END-IF.                                                      36980002
318700                                                                  36990002
318800     IF PV-TTL-ALL-DCS-CARTS = IMCNUP-UPC-CART-CNT                37000002
318900       CONTINUE                                                   37010002
319000     ELSE                                                         37020002
319100       COMPUTE TR004-DC-CART-CT =                                 37030002
319200          TR004-DC-CART-CT +                                      37040002
319300             (IMCNUP-UPC-CART-CNT - PV-TTL-ALL-DCS-CARTS)         37050002
319400*      ********************************************************   37060002
319500*      * A1 - IF YOU ADJUST CARTONS, BETTER ADJUST THE NUMBER *   37070002
319600*      *      OF UNLBELED AS WELL.                            *   37080002
319700*      ********************************************************   37090002
319800       SUBTRACT PV-NBR-CART-LBLS-THIS-DC                          37100002
319900                     FROM PV-TTL-CART-LBLS-ALL-DCS                37110002
320000       PERFORM 2700-COMPUTE-HOW-MANY-LBLS-DC                      37120002
320100       PERFORM 2710-COMPUTE-DC-NO-LABELS                          37130002
320200*      ********************************************************   37140002
320300*      * A2 - IF YOU ADJUST CARTONS, ADJUST UNITS WHICH WERE  *   37150002
320400*      *      BASED ON CARTONS.                               *   37160002
320500*      ********************************************************   37170002
320600       SUBTRACT TR004-DC-UNIT-QTY  FROM PV-TTL-ALL-DCS-UNITS      37180002
320700       COMPUTE TR004-DC-UNIT-QTY  =                               37190002
320800              (TR004-DC-CART-CT * TR004-OUTR-PK-QTY)              37200002
320900       ADD  TR004-DC-UNIT-QTY    TO PV-TTL-ALL-DCS-UNITS          37210002
321000     END-IF.                                                      37220002
321100                                                                  37230002
321200*    ********************************************************     37240002
321300*    *  B - IN A1 ABOVE, UNITS MAY HAVE BEEN ADJUSTED BASED *     37250002
321400*    *      ON CARTONS.  NOW ADJUST UNITS BASED ON ACTUAL   *     37260002
321500*    *      SHIPPED QUANTITIES.                             *     37270002
321600*    ********************************************************     37280002
321700     IF PV-TTL-ALL-DCS-UNITS = IMCNUP-UPC-UNT-QTY                 37290002
321800       CONTINUE                                                   37300002
321900     ELSE                                                         37310002
322000       COMPUTE TR004-DC-UNIT-QTY =                                37320002
322100          TR004-DC-UNIT-QTY +                                     37330002
322200             (IMCNUP-UPC-UNT-QTY - PV-TTL-ALL-DCS-UNITS)          37340002
322300     END-IF.                                                      37350002
322400                                                                  37360002
322500*    ********************************************************     37370002
322600*    *  ADJUST LABELS FOR THIS DC                                 37380002
322700*    *  (YOU DON'T NEED TO ADJUST IF NUMBER OF LABELS = CARTS     37390002
322800*    *   BECAUSE THE SPLITS FOR EACH WILL BE IDENTICAL AND        37400002
322900*    *   LABELS WERE ADJUSTED WHEN CARTONS WERE.)                 37410002
323000*    ********************************************************     37420002
323100     IF PV-NBR-CART-LBLS-UPC = PV-TTL-CART-LBLS-ALL-DCS           37430002
323200       CONTINUE                                                   37440002
323300     ELSE                                                         37450002
323400       IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC              37460002
323500          CONTINUE                                                37470002
323600       ELSE                                                       37480002
323700         COMPUTE PV-NBR-CART-LBLS-THIS-DC =                       37490002
323800            PV-NBR-CART-LBLS-THIS-DC +                            37500002
323900             (PV-NBR-CART-LBLS-UPC - PV-TTL-CART-LBLS-ALL-DCS)    37510002
324000         PERFORM 2710-COMPUTE-DC-NO-LABELS                        37520002
324100       END-IF                                                     37530002
324200     END-IF.                                                      37540002
324300                                                                  37550002
139868******************************************************************37560099
139868 2550-ADJUST-ROUNDED-OUT-DIST.                                    37570099
139868                                                                  37580099
155029     IF  PS-EOC-STORE-CURSOR                                      37590099
155029     AND PS-OUTLET-STORE-NO                                       37600099
155029        DIVIDE PA-TOTAL-CURR-SPLIT-QTY                            37610099
155029          INTO MESTDS-STR-DISTRO-QTY                              37620099
155029            GIVING PV-QUOTIENT-ORDER-PERCENT                      37630099
155029        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     37640099
155029            100 GIVING TR004-DC-PERCNT ROUNDED                    37650099
155029                                                                  37660099
155029        IF TR004-DC-PERCNT = ZERO                                 37670099
155029           MOVE +1 TO TR004-DC-PERCNT                             37680099
155029        END-IF                                                    37690099
155029                                                                  37700099
155029     ELSE                                                         37710099
139868        IF PV-TTL-ALL-DCS-PCT = 100                               37720099
139868          CONTINUE                                                37730099
139868        ELSE                                                      37740099
139868          COMPUTE TR004-DC-PERCNT =                               37750099
139868               TR004-DC-PERCNT + (100 - PV-TTL-ALL-DCS-PCT)       37760099
139868        END-IF                                                    37770099
155029     END-IF.                                                      37780099
139868                                                                  37790099
324400******************************************************************37800002
324500 2600-ZERO-CARTONS-ERROR.                                         37810002
324600                                                                  37820002
324700     SET TR006-ERROR-TYPE-ERROR       TO TRUE.                    37830002
324800     INITIALIZE TR006-ERROR-MSG.                                  37840002
324900     MOVE ALLPLN-DEST-NBR             TO PV-EDIT-DEST.            37850087
325000     STRING 'CMN-PCK-DC-',                                        37860002
325100            PV-EDIT-DEST                                          37870002
325200            '-0 CRTS-NW STR PO'                                   37880002
325300         DELIMITED BY SIZE                                        37890002
325400         INTO TR006-ERROR-MSG.                                    37900002
325500     MOVE IMCNUP-SKU-NBR   TO TR006-SKU                           37910002
325600     PERFORM 8830-WRITE-ERROR-LINE.                               37920002
325700                                                                  37930002
325800******************************************************************37940002
325900 2610-ZERO-CARTS-ERROR-BULK.                                      37950002
326000                                                                  37960002
326100     SET TR006-ERROR-TYPE-ERROR       TO TRUE.                    37970002
326200     INITIALIZE TR006-ERROR-MSG.                                  37980002
326300     MOVE ALLPLN-DEST-NBR             TO PV-EDIT-DEST.            37990088
326400     STRING 'CMN-BLK-DC-',                                        38000002
326500            PV-EDIT-DEST                                          38010002
326600            '-0 CRTS-NW STR PO'                                   38020002
326700         DELIMITED BY SIZE                                        38030002
326800         INTO TR006-ERROR-MSG.                                    38040002
326900     PERFORM 8830-WRITE-ERROR-LINE.                               38050002
327000                                                                  38060002
327100*************************************************************     38070002
327200 2700-COMPUTE-HOW-MANY-LBLS-DC.                                   38080002
327300                                                                  38090002
327400       IF IMCNUP-UPC-CART-CNT = PV-NBR-CART-LBLS-UPC              38100002
327500         MOVE TR004-DC-CART-CT TO PV-NBR-CART-LBLS-THIS-DC        38110002
327600       ELSE                                                       38120002
327700         COMPUTE PV-NBR-CART-LBLS-THIS-DC ROUNDED =               38130002
327800          (PV-NBR-CART-LBLS-UPC * PV-QUOTIENT-ORDER-PERCENT)      38140002
327900       END-IF.                                                    38150002
328000                                                                  38160002
328100       ADD  PV-NBR-CART-LBLS-THIS-DC                              38170002
328200                               TO PV-TTL-CART-LBLS-ALL-DCS.       38180002
328300                                                                  38190002
328400*************************************************************     38200002
328500 2710-COMPUTE-DC-NO-LABELS.                                       38210002
328600                                                                  38220002
328700       IF PV-NBR-CART-LBLS-THIS-DC > TR004-DC-CART-CT             38230002
328800          MOVE ZERO TO TR004-DC-NO-LBL-CART-CT                    38240002
328900       ELSE                                                       38250002
329000          COMPUTE TR004-DC-NO-LBL-CART-CT =                       38260002
329100            (TR004-DC-CART-CT - PV-NBR-CART-LBLS-THIS-DC)         38270002
329200       END-IF.                                                    38280002
329300                                                                  38290002
329400*************************************************************     38300002
329500 2720-CREATE-DC-CARTON-LABELS.                                    38310002
329600                                                                  38320002
329700       MOVE ZERO TO PV-CARTON-ROWS-FETCHED.                       38330002
329800                                                                  38340002
329900       PERFORM UNTIL PV-CARTON-ROWS-FETCHED =                     38350002
330000                               PV-NBR-CART-LBLS-THIS-DC           38360002
330100               OR PS-EOC-CART-LABEL-CURSOR                        38370002
330200          PERFORM 8756-FETCH-CART-LABEL-CURSOR                    38380002
330300          EVALUATE TRUE                                           38390002
330400            WHEN PS-EOC-CART-LABEL-CURSOR                         38400002
330500               CONTINUE                                           38410002
330600            WHEN OTHER                                            38420002
330700                ADD +1 TO PV-CARTON-ROWS-FETCHED                  38430002
330800                INITIALIZE TR004-REC-TYPE-DC-CARTON               38440002
330900                MOVE TRT00008-SSCC-ID (1:20)                      38450002
331000                                TO TR004-DCT-SSCC-ID (1:20)       38460002
331100                MOVE TRT00008-UNT-QTY                             38470002
331200                                TO TR004-DCT-CARTON-UNIT-QTY      38480002
331300                PERFORM 5710-WRITE-DCT-RECORD                     38490002
331400            END-EVALUATE                                          38500002
331500       END-PERFORM.                                               38510002
331600                                                                  38520002
331700******************************************************************38530002
331800 2900-SEAL-CURSOR-FOR-XMIT.                                       38540002
331900                                                                  38550002
332000      PERFORM 8750-FETCH-SEAL-CURSOR.                             38560002
332100                                                                  38570002
332200      IF PS-EOC-SEAL-CURSOR                                       38580002
332300        CONTINUE                                                  38590002
332400      ELSE                                                        38600002
332500        PERFORM 5770-WRITE-CONTAINER-SEAL-REC                     38610002
332600      END-IF.                                                     38620002
332700                                                                  38630002
332800******************************************************************38640002
332900 2910-SEAL-CURSOR-FOR-REPORT.                                     38650002
333000                                                                  38660002
333100      PERFORM 8750-FETCH-SEAL-CURSOR.                             38670002
333200                                                                  38680002
333300      IF PS-EOC-SEAL-CURSOR                                       38690002
333400        CONTINUE                                                  38700002
333500      ELSE                                                        38710002
333600        PERFORM 8872-WRITE-DTL-RPT-SEAL-RECORD                    38720002
333700      END-IF.                                                     38730002
333800                                                                  38740002
334000******************************************************************38750002
334100* IF A PO IS OK FOR TRANSMISSION - WRITE UNWRITTEN UPPER LEVEL    38760002
334200* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL38770002
334300* PROGRAM TABLE.                                                  38780002
334400******************************************************************38790002
334500                                                                  38800002
334600 3000-WRITE-OUT-GOOD-PO-RECS.                                     38810002
334700                                                                  38820002
334800     IF PS-POE-WRITTEN-NO                                         38830002
334900       PERFORM 5100-WRITE-POE-RECORD                              38840002
335000       SET PS-POE-WRITTEN TO TRUE                                 38850002
335100     END-IF.                                                      38860002
335200                                                                  38870002
335300     IF PS-ETA-WRITTEN-NO                                         38880002
335400       PERFORM 5000-WRITE-ETA-RECORD                              38890002
335500       SET PS-ETA-WRITTEN TO TRUE                                 38900002
335600     END-IF.                                                      38910002
335700                                                                  38920002
335800     IF PS-VES-WRITTEN-NO                                         38930002
335900       PERFORM 5200-WRITE-VES-RECORD                              38940002
336000       SET PS-VES-WRITTEN TO TRUE                                 38950002
336100     END-IF.                                                      38960002
336200                                                                  38970002
336300     IF PS-CMN-WRITTEN-NO                                         38980002
336400       PERFORM 5300-WRITE-CMN-RECORD                              38990002
336500       SET PS-CMN-WRITTEN TO TRUE                                 39000002
336600       SET PS-NEED-SEALS  TO TRUE                                 39010002
336700       MOVE IMCNTK-CONTNR-ID      TO TRT00006-CONTNR-ID           39020002
336800       MOVE IMCNTK-CONTNR-SEQ-NBR TO TRT00006-CONTNR-SEQ-NBR      39030002
336900     END-IF.                                                      39040002
337000                                                                  39050002
337100     SET EXT-INDEX TO +1.                                         39060002
337200     SET PS-EOT-EXTRACT-NO  TO TRUE.                              39070002
337300     PERFORM 3100-UNLOAD-EXT-TABLE                                39080002
337400         UNTIL  PS-EOT-EXTRACT                                    39090002
337500             OR EXT-INDEX > PC-EXTRACT-TBL-LIMIT.                 39100002
337600                                                                  39110002
337700******************************************************************39120002
337800* IF A PO IS OK FOR RETRANSMISSION - WRITE UNWRITTEN UPPER LEVEL  39130002
337900* RECORDS PLUS PO, PCK, UPC, PDC AND DC RECORDS STORED ON INTERNAL39140002
338000* PROGRAM TABLE.                                                  39150002
338100******************************************************************39160002
338200                                                                  39170002
338300 3100-UNLOAD-EXT-TABLE.                                           39180002
338400                                                                  39190002
338500     EVALUATE TRUE                                                39200002
338600                                                                  39210002
338700         WHEN PV-TBL-EXT-ROW (EXT-INDEX) = SPACES                 39220002
338800                                                                  39230002
338900            SET PS-EOT-EXTRACT TO TRUE                            39240002
339000                                                                  39250002
339100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PO '                 39260002
339200                                                                  39270002
339300            PERFORM 3110-PO-EXTRACT-AND-DETAIL                    39280002
339400            SET EXT-INDEX UP BY +1                                39290002
339500                                                                  39300002
339600         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'INS'                 39310002
339700                                                                  39320002
339800            PERFORM 3120-INS-EXTRACT-AND-DETAIL                   39330002
339900            SET EXT-INDEX UP BY +1                                39340002
340000                                                                  39350002
340100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCK'                 39360002
340200                                                                  39370002
340300            PERFORM 3130-PCK-EXTRACT-AND-DETAIL                   39380002
340400            SET EXT-INDEX UP BY +1                                39390002
340500                                                                  39400002
340600         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'UPC'                 39410002
340700                                                                  39420002
340800            PERFORM 3140-UPC-EXTRACT-AND-DETAIL                   39430002
340900            SET EXT-INDEX UP BY +1                                39440002
341000                                                                  39450002
341100         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PDC'                 39460002
341200                                                                  39470002
341300*           ***********************************                   39480002
341400*           * ONLY CREATE EXTRACT & DETAIL DC *                   39490002
341500*           * RECS IF SPLITS ENTERED.         *                   39500002
341600*           ***********************************                   39510002
341700            IF PS-SPLITS-ENTERED                                  39520002
341800               PERFORM 3150-PDC-EXTRACT-AND-DETAIL                39530002
341900            END-IF                                                39540002
342000            SET EXT-INDEX UP BY +1                                39550002
342100                                                                  39560002
342200         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DC '                 39570002
342300                                                                  39580002
342400*           ***********************************                   39590002
342500*           * ONLY CREATE EXTRACT & DETAIL DC *                   39600002
342600*           * RECS IF SPLITS ENTERED.         *                   39610002
342700*           ***********************************                   39620002
342800            IF PS-SPLITS-ENTERED                                  39630002
342900               PERFORM 3160-DC-EXTRACT-AND-DETAIL                 39640002
343000            END-IF                                                39650002
343100            SET EXT-INDEX UP BY +1                                39660002
343200                                                                  39670002
343300         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'PCT'                 39680002
343400                                                                  39690002
343500*           ***********************************                   39700002
343600*           * ONLY CREATE PACK CARTON         *                   39710002
343700*           * RECS IF SPLITS ENTERED.         *                   39720002
343800*           ***********************************                   39730002
343900            IF PS-SPLITS-ENTERED                                  39740002
344000               PERFORM 3170-PCT-EXTRACT-AND-DETAIL                39750002
344100            END-IF                                                39760002
344200            SET EXT-INDEX UP BY +1                                39770002
344300                                                                  39780002
344400         WHEN PV-TBL-EXT-TYPE (EXT-INDEX) = 'DCT'                 39790002
344500                                                                  39800002
344600*           ***********************************                   39810002
344700*           * ONLY CREATE DC (BULK) CARTON    *                   39820002
344800*           * RECS IF SPLITS ENTERED.         *                   39830002
344900*           ***********************************                   39840002
345000            IF PS-SPLITS-ENTERED                                  39850002
345100               PERFORM 3180-DCT-EXTRACT-AND-DETAIL                39860002
345200            END-IF                                                39870002
345300            SET EXT-INDEX UP BY +1                                39880002
345400                                                                  39890002
345500         WHEN OTHER                                               39900002
345600                                                                  39910002
345700            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    39920002
345800            DISPLAY  '&& TABLE ERROR                       &&'    39930002
345900            DISPLAY  '&& FOUND REC TYPE  - '                      39940002
346000                               PV-TBL-EXT-TYPE (EXT-INDEX)        39950002
346100            DISPLAY                          '             &&'    39960002
346200            DISPLAY  '&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&'    39970002
346300                                                                  39980002
346400            SET EXT-INDEX UP BY +1                                39990002
346500                                                                  40000002
346600     END-EVALUATE.                                                40010002
346700                                                                  40020002
346800******************************************************************40030002
346900* PO  DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *40040002
347000******************************************************************40050002
347100                                                                  40060002
347200 3110-PO-EXTRACT-AND-DETAIL.                                      40070002
347300                                                                  40080002
347400     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PO         40090002
347500                                        OUTTR2-TRGL-EDI-PO-ODR.   40100002
347600     PERFORM 6000-INSERT-EXTRACT-REC.                             40110002
347700*    ***************************************************          40120002
347800*    * A CMN RECORD IS WRITTEN TO THE REPORT DETAIL    *          40130002
347900*    * FILE FOR EACH PO BECAUSE REPORTING IS BY PO,    *          40140002
348000*    * NOT CONTAINER.  THE SAME IS TRUE FOR SEAL RECS. *          40150002
348100*    ***************************************************          40160002
348200     PERFORM 8856-WRITE-DTL-RPT-CMN-RECORD.                       40170002
348300     PERFORM 8850-WRITE-DTL-RPT-PO-RECORD.                        40180002
348400     PERFORM 8752-OPEN-SEAL-CURSOR                                40190002
348500     SET PS-EOC-SEAL-CURSOR-NO TO TRUE.                           40200002
348600     PERFORM 2910-SEAL-CURSOR-FOR-REPORT                          40210002
348700       UNTIL PS-EOC-SEAL-CURSOR.                                  40220002
348800     PERFORM 8754-CLOSE-SEAL-CURSOR.                              40230002
348900                                                                  40240002
349000******************************************************************40250002
349100* INS DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *40260002
349200******************************************************************40270002
349300                                                                  40280002
349400 3120-INS-EXTRACT-AND-DETAIL.                                     40290002
349500                                                                  40300002
349600     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-INS        40310002
349700                                        OUTTR2-TRGL-EDI-PO-ODR.   40320002
349800     PERFORM 6000-INSERT-EXTRACT-REC.                             40330002
349900     PERFORM 8852-WRITE-DTL-RPT-INS-RECORD.                       40340002
350000                                                                  40350002
350100******************************************************************40360002
350200* PCK DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *40370002
350300******************************************************************40380002
350400                                                                  40390002
350500 3130-PCK-EXTRACT-AND-DETAIL.                                     40400002
350600                                                                  40410002
350700     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PCK        40420002
350800                                        OUTTR2-TRGL-EDI-PO-ODR.   40430002
350900     PERFORM 6000-INSERT-EXTRACT-REC.                             40440002
351000     PERFORM 8847-WRITE-DTL-RPT-PCK-RECORD.                       40450002
351100                                                                  40460002
351200******************************************************************40470002
351300* UPC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *40480002
351400******************************************************************40490002
351500                                                                  40500002
351600 3140-UPC-EXTRACT-AND-DETAIL.                                     40510002
351700                                                                  40520002
351800     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-UPC        40530002
351900                                        OUTTR2-TRGL-EDI-PO-ODR.   40540002
352000     PERFORM 6000-INSERT-EXTRACT-REC.                             40550002
352100     PERFORM 8854-WRITE-DTL-RPT-UPC-RECORD.                       40560002
352200                                                                  40570002
352300******************************************************************40580002
352400* PDC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT  *40590002
352500******************************************************************40600002
352600                                                                  40610002
352700 3150-PDC-EXTRACT-AND-DETAIL.                                     40620002
352800                                                                  40630002
352900     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PDC        40640002
353000                                        OUTTR2-TRGL-EDI-PO-ODR.   40650002
353100     PERFORM 6000-INSERT-EXTRACT-REC.                             40660002
353200     PERFORM 8848-WRITE-DTL-RPT-PDC-RECORD.                       40670002
353300                                                                  40680002
353400******************************************************************40690002
353500* DC DATA FROM INTERNAL TABLE - WRITE TO EXTRACT * DETAIL REPT   *40700002
353600******************************************************************40710002
353700                                                                  40720002
353800 3160-DC-EXTRACT-AND-DETAIL.                                      40730002
353900                                                                  40740002
354000     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC         40750002
354100                                        OUTTR2-TRGL-EDI-PO-ODR.   40760002
354200     PERFORM 6000-INSERT-EXTRACT-REC.                             40770002
354300     PERFORM 8870-WRITE-DTL-RPT-DC-RECORD.                        40780002
354400                                                                  40790002
354500******************************************************************40800002
354600* PACK CARTON DATA FROM TABLE - WRITE TO EXTRACT * DETAIL REPT   *40810002
354700******************************************************************40820002
354800                                                                  40830002
354900 3170-PCT-EXTRACT-AND-DETAIL.                                     40840002
355000                                                                  40850002
355100     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-PACK-CARTON40860002
355200                                        OUTTR2-TRGL-EDI-PO-ODR.   40870002
355300     PERFORM 6000-INSERT-EXTRACT-REC.                             40880002
355400     PERFORM 8874-WRITE-DTL-RPT-PCT-REC.                          40890002
355500                                                                  40900002
355600******************************************************************40910002
355700* PACK CARTON DATA FROM TABLE - WRITE TO EXTRACT * DETAIL REPT   *40920002
355800******************************************************************40930002
355900                                                                  40940002
356000 3180-DCT-EXTRACT-AND-DETAIL.                                     40950002
356100                                                                  40960002
356200     MOVE PV-TBL-EXT-ROW (EXT-INDEX) TO TR004-REC-TYPE-DC-CARTON  40970002
356300                                        OUTTR2-TRGL-EDI-PO-ODR.   40980002
356400     PERFORM 6000-INSERT-EXTRACT-REC.                             40990002
356500     PERFORM 8876-WRITE-DTL-RPT-DCT-REC.                          41000002
356600                                                                  41010002
356700******************************************************************41020002
356800* SELECT IMCNPO ROW INTO AUDIT HOST VARIABLES.                   *41030002
356900******************************************************************41040002
357000 4000-SELECT-IMCNPO-FOR-AUDIT.                                    41050002
357100                                                                  41060002
357200         EXEC SQL                                                 41070002
357300             SELECT CONTNR_ID                                     41080002
357400                   ,CONTNR_SEQ_NBR                                41090002
357500                   ,PO_NBR                                        41100002
357600                   ,CSTM_ENTR_ID                                  41110002
357700                   ,MSTR_BOL_NBR                                  41120002
357800                   ,HSE_BOL_NBR                                   41130002
357900                   ,LTR_OF_CR_NBR                                 41140002
358000                   ,PO_RCVD_DELY_TMST                             41150002
358100                   ,PO_C_O_PROD_CDE                               41160002
358200                   ,PO_CART_CNT                                   41170002
358300                   ,PO_CBMT_QTY                                   41180002
358400                   ,PO_WT_KGRM_QTY                                41190002
358500                   ,PO_UNT_QTY                                    41200002
358600                   ,LAST_UPD_BY_USR_ID                            41210002
358700                   ,LAST_UPD_TMST                                 41220002
358800                   ,EXTL_REF_NBR                                  41230002
358900                   ,BKR_FRGT_RLSE_CDE                             41240002
359000                   ,DO_RCVD_CDE                                   41250002
359100                   ,CONTNR_PU_CDE                                 41260002
359200                   ,ACTL_POE_DELY_CDE                             41270002
359300                   ,DVN_CDE                                       41280002
359400                   ,DCONSLR_RET_CDE                               41290002
359500                   ,SPLT_XMIT_CDE                                 41300002
359600                   ,DOC_RCVD_ORGN_TMST                            41310002
359700               INTO :AUCNPO-CONTNR-ID                             41320002
359800                   ,:AUCNPO-CONTNR-SEQ-NBR                        41330002
359900                   ,:AUCNPO-PO-NBR                                41340002
360000                   ,:AUCNPO-CSTM-ENTR-ID                          41350002
360100                   ,:AUCNPO-MSTR-BOL-NBR                          41360002
360200                   ,:AUCNPO-HSE-BOL-NBR                           41370002
360300                   ,:AUCNPO-LTR-OF-CR-NBR                         41380002
360400                   ,:AUCNPO-PO-RCVD-DELY-TMST                     41390002
360500                   ,:AUCNPO-PO-C-O-PROD-CDE                       41400002
360600                   ,:AUCNPO-PO-CART-CNT                           41410002
360700                   ,:AUCNPO-PO-CBMT-QTY                           41420002
360800                   ,:AUCNPO-PO-WT-KGRM-QTY                        41430002
360900                   ,:AUCNPO-PO-UNT-QTY                            41440002
361000                   ,:AUCNPO-LAST-UPD-BY-USR-ID                    41450002
361100                   ,:AUCNPO-LAST-UPD-TMST                         41460002
361200                   ,:AUCNPO-EXTL-REF-NBR                          41470002
361300                   ,:AUCNPO-BKR-FRGT-RLSE-CDE                     41480002
361400                   ,:AUCNPO-DO-RCVD-CDE                           41490002
361500                   ,:AUCNPO-CONTNR-PU-CDE                         41500002
361600                   ,:AUCNPO-ACTL-POE-DELY-CDE                     41510002
361700                   ,:AUCNPO-DVN-CDE                               41520002
361800                   ,:AUCNPO-DCONSLR-RET-CDE                       41530002
361900                   ,:AUCNPO-SPLT-XMIT-CDE                         41540002
362000                   ,:AUCNPO-DOC-RCVD-ORGN-TMST                    41550002
362100               FROM TIMCNPO                                       41560002
362200              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          41570002
362300                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     41580002
362400                AND PO_NBR           = :IMCNPO-PO-NBR             41590002
362500         END-EXEC                                                 41600002
362600                                                                  41610002
362700         EVALUATE TRUE                                            41620002
362800         WHEN SQLCODE = ZERO                                      41630002
362900              CONTINUE                                            41640002
363000                                                                  41650002
363100         WHEN SQLCODE = +100                                      41660002
363200         WHEN SQLWARN0 NOT EQUAL SPACE                            41670002
363300         WHEN SQLCODE NOT EQUAL ZERO                              41680002
363400             DISPLAY '** ABEND **'                                41690002
363500             DISPLAY '** PROGRAM = TRKUP007 **'                   41700002
363600             DISPLAY                                              41710002
363700                '** PARAGRAPH = 4000-SELECT-IMCNPO-FOR-AUDIT **'  41720002
363800             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           41730002
363900             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              41740002
364000             PERFORM 9100-SQL-ABEND                               41750002
364100         END-EVALUATE.                                            41760002
364200                                                                  41770002
364300******************************************************************41780002
364400* INSERT A COPY OF THE IMCNPO ROW TO THE AUDIT TRAIL TABLE       *41790002
364500* AFTER UPDATING THE TIMCNPO TABLE.                              *41800002
364600******************************************************************41810002
364700 4010-CREATE-IMCNPO-AUDIT-TRAIL.                                  41820002
364800                                                                  41830002
364900         EXEC SQL                                                 41840002
365000             INSERT INTO TAUCNPO                                  41850002
365100                   (CONTNR_ID                                     41860002
365200                   ,CONTNR_SEQ_NBR                                41870002
365300                   ,PO_NBR                                        41880002
365400                   ,CSTM_ENTR_ID                                  41890002
365500                   ,MSTR_BOL_NBR                                  41900002
365600                   ,HSE_BOL_NBR                                   41910002
365700                   ,LTR_OF_CR_NBR                                 41920002
365800                   ,PO_RCVD_DELY_TMST                             41930002
365900                   ,PO_C_O_PROD_CDE                               41940002
366000                   ,PO_CART_CNT                                   41950002
366100                   ,PO_CBMT_QTY                                   41960002
366200                   ,PO_WT_KGRM_QTY                                41970002
366300                   ,PO_UNT_QTY                                    41980002
366400                   ,LAST_UPD_BY_USR_ID                            41990002
366500                   ,LAST_UPD_TMST                                 42000002
366600                   ,EXTL_REF_NBR                                  42010002
366700                   ,BKR_FRGT_RLSE_CDE                             42020002
366800                   ,DO_RCVD_CDE                                   42030002
366900                   ,CONTNR_PU_CDE                                 42040002
367000                   ,ACTL_POE_DELY_CDE                             42050002
367100                   ,DVN_CDE                                       42060002
367200                   ,DCONSLR_RET_CDE                               42070002
367300                   ,SPLT_XMIT_CDE                                 42080002
367400                   ,DOC_RCVD_ORGN_TMST                            42090002
367500                   ,AUD_FUNC_CDE                                  42100002
367600                   ,AUD_TMST)                                     42110002
367700            VALUES (:AUCNPO-CONTNR-ID                             42120002
367800                   ,:AUCNPO-CONTNR-SEQ-NBR                        42130002
367900                   ,:AUCNPO-PO-NBR                                42140002
368000                   ,:AUCNPO-CSTM-ENTR-ID                          42150002
368100                   ,:AUCNPO-MSTR-BOL-NBR                          42160002
368200                   ,:AUCNPO-HSE-BOL-NBR                           42170002
368300                   ,:AUCNPO-LTR-OF-CR-NBR                         42180002
368400                   ,:AUCNPO-PO-RCVD-DELY-TMST                     42190002
368500                   ,:AUCNPO-PO-C-O-PROD-CDE                       42200002
368600                   ,:AUCNPO-PO-CART-CNT                           42210002
368700                   ,:AUCNPO-PO-CBMT-QTY                           42220002
368800                   ,:AUCNPO-PO-WT-KGRM-QTY                        42230002
368900                   ,:AUCNPO-PO-UNT-QTY                            42240002
369000                   ,:AUCNPO-LAST-UPD-BY-USR-ID                    42250002
369100                   ,:AUCNPO-LAST-UPD-TMST                         42260002
369200                   ,:AUCNPO-EXTL-REF-NBR                          42270002
369300                   ,:AUCNPO-BKR-FRGT-RLSE-CDE                     42280002
369400                   ,:AUCNPO-DO-RCVD-CDE                           42290002
369500                   ,:AUCNPO-CONTNR-PU-CDE                         42300002
369600                   ,:AUCNPO-ACTL-POE-DELY-CDE                     42310002
369700                   ,:AUCNPO-DVN-CDE                               42320002
369800                   ,:AUCNPO-DCONSLR-RET-CDE                       42330002
369900                   ,:AUCNPO-SPLT-XMIT-CDE                         42340002
370000                   ,:AUCNPO-DOC-RCVD-ORGN-TMST                    42350002
370100                   ,:PC-U                                         42360002
370200                   ,:PV-CURRENT-TIME)                             42370002
370300         END-EXEC                                                 42380002
370400                                                                  42390002
370500         EVALUATE TRUE                                            42400002
370600                                                                  42410002
370700         WHEN SQLCODE = ZERO                                      42420002
370800              CONTINUE                                            42430002
370900                                                                  42440002
371000         WHEN SQLWARN0 NOT EQUAL SPACE                            42450002
371100         WHEN SQLCODE NOT EQUAL ZERO                              42460002
371200             DISPLAY '** ABEND **'                                42470002
371300             DISPLAY '** PROGRAM = TRKUP007 **'                   42480002
371400             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           42490002
371500             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              42500002
371600                  '** PARAGRAPH = 4010-CREATE-IMCNPO-AUDIT-TRAIL' 42510002
371700             PERFORM 9100-SQL-ABEND                               42520002
371800         END-EVALUATE.                                            42530002
371900******************************************************************42540002
372000* SELECT IMCNRL ROW INTO AUDIT HOST VARIABLES.                   *42550002
372100******************************************************************42560002
372200 4020-SELECT-IMCNRL-FOR-AUDIT.                                    42570002
372300                                                                  42580002
372400         EXEC SQL                                                 42590002
372500             SELECT  CONTNR_ID                                    42600002
372600                    ,CONTNR_SEQ_NBR                               42610002
372700                    ,PO_NBR                                       42620002
372800                    ,DCONSLR_RLSE_CDE                             42630002
372900                    ,DCONSLR_REQR_DTE                             42640002
373000                    ,DCONSLR_ACTL_DTE                             42650002
373100                    ,DCONSLR_ACTL_TM                              42660002
373200                    ,CRE_TMST                                     42670002
373300                    ,CRE_BY_UID                                   42680002
373400                    ,LAST_UPD_TMST                                42690002
373500                    ,LAST_UPD_BY_UID                              42700002
373600                    ,DCONSLR_ENT_ID                               42710002
373700               INTO :AUCNRL-CONTNR-ID                             42720002
373800                   ,:AUCNRL-CONTNR-SEQ-NBR                        42730002
373900                   ,:AUCNRL-PO-NBR                                42740002
374000                   ,:AUCNRL-DCONSLR-RLSE-CDE                      42750002
374100                   ,:AUCNRL-DCONSLR-REQR-DTE                      42760002
374200                   ,:AUCNRL-DCONSLR-ACTL-DTE                      42770002
374300                   ,:AUCNRL-DCONSLR-ACTL-TM                       42780002
374400                   ,:AUCNRL-CRE-TMST                              42790002
374500                   ,:AUCNRL-CRE-BY-UID                            42800002
374600                   ,:AUCNRL-LAST-UPD-TMST                         42810002
374700                   ,:AUCNRL-LAST-UPD-BY-UID                       42820002
374800                   ,:AUCNRL-DCONSLR-ENT-ID                        42830002
374900               FROM TIMCNRL                                       42840002
375000              WHERE CONTNR_ID        = :IMCNTK-CONTNR-ID          42850002
375100                AND CONTNR_SEQ_NBR   = :IMCNTK-CONTNR-SEQ-NBR     42860002
375200                AND PO_NBR           = :IMCNPO-PO-NBR             42870002
375300         END-EXEC                                                 42880002
375400                                                                  42890002
375500         EVALUATE TRUE                                            42900002
375600         WHEN SQLCODE = ZERO                                      42910002
375700             SET PS-IMCNRL-INFO-PRESENT      TO TRUE              42920002
375800                                                                  42930002
375900         WHEN SQLCODE = +100                                      42940002
376000             INITIALIZE TR006-DEPT-NBR                            42950002
376100                        TR006-ERROR-MSG                           42960002
376200             SET TR006-ERROR-TYPE-ERROR       TO TRUE             42970002
376300             STRING 'CMN-DCNSLR/PO INFO MISNG-NOT SNT'            42980002
376400                 DELIMITED BY SIZE                                42990002
376500                 INTO TR006-ERROR-MSG                             43000002
376600             PERFORM 8830-WRITE-ERROR-LINE                        43010002
376700                                                                  43020002
376800         WHEN SQLWARN0 NOT EQUAL SPACE                            43030002
376900         WHEN SQLCODE NOT EQUAL ZERO                              43040002
377000             DISPLAY '** ABEND **'                                43050002
377100             DISPLAY '** PROGRAM = TRKUP007 **'                   43060002
377200             DISPLAY                                              43070002
377300                '** PARAGRAPH = 4020-SELECT-IMCNRL-FOR-AUDIT **'  43080002
377400             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           43090002
377500             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              43100002
377600             PERFORM 9100-SQL-ABEND                               43110002
377700         END-EVALUATE.                                            43120002
377800                                                                  43130002
377900******************************************************************43140002
378000* INSERT A COPY OF THE IMCNRL ROW TO THE AUDIT TRAIL TABLE       *43150002
378100* AFTER UPDATING THE TIMCNRL TABLE.                              *43160002
378200******************************************************************43170002
378300 4030-CREATE-IMCNRL-AUDIT-TRAIL.                                  43180002
378400                                                                  43190002
378500         EXEC SQL                                                 43200002
378600             INSERT INTO TAUCNRL                                  43210002
378700                   (CONTNR_ID                                     43220002
378800                   ,CONTNR_SEQ_NBR                                43230002
378900                   ,PO_NBR                                        43240002
379000                   ,DCONSLR_RLSE_CDE                              43250002
379100                   ,DCONSLR_REQR_DTE                              43260002
379200                   ,DCONSLR_ACTL_DTE                              43270002
379300                   ,DCONSLR_ACTL_TM                               43280002
379400                   ,CRE_TMST                                      43290002
379500                   ,CRE_BY_UID                                    43300002
379600                   ,LAST_UPD_TMST                                 43310002
379700                   ,LAST_UPD_BY_UID                               43320002
379800                   ,AUD_FUNC_CDE                                  43330002
379900                   ,AUD_TMST                                      43340002
380000                   ,DCONSLR_ENT_ID)                               43350002
380100            VALUES (:AUCNRL-CONTNR-ID                             43360002
380200                   ,:AUCNRL-CONTNR-SEQ-NBR                        43370002
380300                   ,:AUCNRL-PO-NBR                                43380002
380400                   ,:AUCNRL-DCONSLR-RLSE-CDE                      43390002
380500                   ,:AUCNRL-DCONSLR-REQR-DTE                      43400002
380600                   ,:AUCNRL-DCONSLR-ACTL-DTE                      43410002
380700                   ,:AUCNRL-DCONSLR-ACTL-TM                       43420002
380800                   ,:AUCNRL-CRE-TMST                              43430002
380900                   ,:AUCNRL-CRE-BY-UID                            43440002
381000                   ,:AUCNRL-LAST-UPD-TMST                         43450002
381100                   ,:AUCNRL-LAST-UPD-BY-UID                       43460002
381200                   ,:PC-U                                         43470002
381300                   ,:PV-CURRENT-TIME                              43480002
381400                   ,:AUCNRL-DCONSLR-ENT-ID)                       43490002
381500         END-EXEC                                                 43500002
381600                                                                  43510002
381700         EVALUATE TRUE                                            43520002
381800                                                                  43530002
381900         WHEN SQLCODE = ZERO                                      43540002
382000              CONTINUE                                            43550002
382100                                                                  43560002
382200         WHEN SQLWARN0 NOT EQUAL SPACE                            43570002
382300         WHEN SQLCODE NOT EQUAL ZERO                              43580002
382400             DISPLAY '** ABEND **'                                43590002
382500             DISPLAY '** PROGRAM = TRKUP007 **'                   43600002
382600             DISPLAY 'CONTAINER ID = ' IMCNTK-CONTNR-ID           43610002
382700             DISPLAY 'PO NUMBER    = ' IMCNPO-PO-NBR              43620002
382800                  '** PARAGRAPH = 4030-CREATE-IMCNRL-AUDIT-TRAIL' 43630002
382900             PERFORM 9100-SQL-ABEND                               43640002
383000         END-EVALUATE.                                            43650002
383100*----------------------------------------------------------------*43660002
383200*    CHECK TO SEE IF A CHECKPOINT SHOULD BE TAKEN.               *43670002
383300*----------------------------------------------------------------*43680002
383400 4400-CHECKPOINT-CHECK.                                           43690002
383500                                                                  43700002
383600     EXEC SQL                                                     43710002
383700       SET :PV-TMST = CURRENT TIMESTAMP                           43720002
383800     END-EXEC.                                                    43730002
383900                                                                  43740002
384000     EVALUATE TRUE                                                43750002
384100         WHEN SQLWARN0 NOT EQUAL SPACE                            43760002
384200         WHEN SQLCODE NOT EQUAL ZERO                              43770002
384300             DISPLAY '** ABEND **'                                43780002
384400             DISPLAY '** PROGRAM = TRKUP007 **'                   43790002
384500             DISPLAY '** PARAGRAPH = 4400-CHEKPOINT-CHECK**'      43800002
384600             DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'          43810002
384700             PERFORM 9100-SQL-ABEND                               43820002
384800     END-EVALUATE.                                                43830002
384900                                                                  43840002
385000     IF PV-TMST > PV-HOLD-TMST                                    43850002
385100        IF PS-COMMITS-TAKEN                                       43860002
385200            CONTINUE                                              43870002
385300        ELSE                                                      43880002
385400            MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE          43890002
385500            PERFORM 6570-UPDATE-TCKRSTCNTL                        43900002
385600            SET PS-COMMITS-TAKEN   TO TRUE                        43910002
385700        END-IF                                                    43920002
385800        PERFORM 6580-UPDATE-TCKRSTINF                             43930002
385900        PERFORM 4500-COMMIT                                       43940002
386000        DISPLAY 'COMMIT TAKEN AT '                                43950002
386100        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)43960002
386200         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)43970002
386300        PERFORM 4600-SET-CHECKPOINT-TIME                          43980002
386400     END-IF.                                                      43990002
386500                                                                  44000002
386600 EJECT                                                            44010002
386700******************************************************************44020002
386800* EXECUTES AN SQL COMMIT AFTER ALL TABLES FOR TRIP ARE UPDATED.   44030002
386900******************************************************************44040002
387000 4500-COMMIT.                                                     44050002
387100                                                                  44060002
387200     EXEC SQL                                                     44070002
387300         COMMIT                                                   44080002
387400     END-EXEC.                                                    44090002
387500                                                                  44100002
387600     EVALUATE TRUE                                                44110002
387700         WHEN SQLWARN0 NOT EQUAL SPACE                            44120002
387800         WHEN SQLCODE NOT EQUAL ZERO                              44130002
387900       DISPLAY '***********CHECKPOINT*************'               44140002
388000          DISPLAY 'IMCNPO-PO-NBR = ' IMCNPO-PO-NBR                44150002
388100          DISPLAY 'CONTAINER ID  = ' IMCNTK-CONTNR-ID             44160002
388200          DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                  44170002
388300              PA-TOTAL-OUTPUT-REC-COUNT                           44180002
388400          DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT              44190002
388500          DISPLAY '**********************************'            44200002
388600                                                                  44210002
388700             DISPLAY '** ABEND **'                                44220002
388800             DISPLAY '** PROGRAM = TRKUP007 **'                   44230002
388900             DISPLAY '** PARAGRAPH = 4500-COMMIT**'               44240002
389000             DISPLAY '**UNSUCCESSFUL COMMIT**'                    44250002
389100             PERFORM 9100-SQL-ABEND                               44260002
389200     END-EVALUATE.                                                44270002
389300 EJECT                                                            44280002
389400******************************************************************44290002
389500* SET THE TIME FOR THE NEXT CHECKPOINT.                           44300002
389600******************************************************************44310002
389700 4600-SET-CHECKPOINT-TIME.                                        44320002
389800                                                                  44330002
389900      EXEC SQL                                                    44340002
390000          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    44350002
390100          INTO :PV-HOLD-TMST                                      44360002
390200          FROM TCKRSTCNTL                                         44370002
390300          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              44380002
390400      END-EXEC.                                                   44390002
390500                                                                  44400002
390600     EVALUATE TRUE                                                44410002
390700         WHEN SQLWARN0 NOT EQUAL SPACE                            44420002
390800         WHEN SQLCODE NOT EQUAL ZERO                              44430002
390900             DISPLAY '** ABEND **'                                44440002
391000             DISPLAY '** PROGRAM = TRKUP007 **'                   44450002
391100             DISPLAY '** PARAGRAPH = 4600-SET-CHECKPOINT-TIME**'  44460002
391200             DISPLAY '**UNSUCESSFUL SET OF CHECKPOINT INTERVAL**' 44470002
391300             PERFORM 9100-SQL-ABEND                               44480002
391400     END-EVALUATE.                                                44490002
391500 EJECT                                                            44500002
391600******************************************************************44510002
391700* WRITE ESTIMATE TIME OF ARRIVAL RECORD TYPE FOR VESSEL EXTRACT  *44520002
391800* FILE                                                           *44530002
391900******************************************************************44540002
392000                                                                  44550002
392100 5000-WRITE-ETA-RECORD.                                           44560002
392200                                                                  44570002
392300     MOVE 'ETA' TO TR004-REC-TYPE-CDE-ETA.                        44580002
392400     MOVE TR004-REC-TYPE-ETA      TO                              44590002
392500         OUTTR2-TRGL-EDI-PO-ODR.                                  44600002
392600                                                                  44610002
392700     PERFORM 6000-INSERT-EXTRACT-REC.                             44620002
392800                                                                  44630002
392900******************************************************************44640002
393000* WRITE PORT OF ENTRY RECORD TYPE FOR EXTRACT FILE.              *44650002
393100******************************************************************44660002
393200                                                                  44670002
393300 5100-WRITE-POE-RECORD.                                           44680002
393400                                                                  44690002
393500     MOVE 'POE'   TO TR004-REC-TYPE-CDE-POE.                      44700002
393600     MOVE TR004-REC-TYPE-POE      TO                              44710002
393700         OUTTR2-TRGL-EDI-PO-ODR.                                  44720002
393800                                                                  44730002
393900     PERFORM 6000-INSERT-EXTRACT-REC.                             44740002
394000                                                                  44750002
394100******************************************************************44760002
394200* WRITE VESSEL RECORD TYPE FOR EXTRACT FILE.                     *44770002
394300******************************************************************44780002
394400                                                                  44790002
394500 5200-WRITE-VES-RECORD.                                           44800002
394600                                                                  44810002
394700     MOVE 'VES'     TO TR004-REC-TYPE-CDE-VES.                    44820002
394800     MOVE TR004-REC-TYPE-VES      TO                              44830002
394900         OUTTR2-TRGL-EDI-PO-ODR.                                  44840002
395000                                                                  44850002
395100     PERFORM 6000-INSERT-EXTRACT-REC.                             44860002
395200                                                                  44870002
395300******************************************************************44880002
395400* WRITE CONTAINER RECORD TYPE FOR EXTRACT FILE.                  *44890002
395500******************************************************************44900002
395600                                                                  44910002
395700 5300-WRITE-CMN-RECORD.                                           44920002
395800                                                                  44930002
395900     SET TR004-REC-TYPE-CDE-CMN        TO TRUE.                   44940002
396000     MOVE TR004-REC-TYPE-CONTAINER  TO                            44950002
396100                                       OUTTR2-TRGL-EDI-PO-ODR.    44960002
396200                                                                  44970002
396300     PERFORM 6000-INSERT-EXTRACT-REC.                             44980002
396400                                                                  44990002
396500******************************************************************45000002
396600* WRITE PO RECORD TYPE FOR EXTRACT FILE.                         *45010002
396700******************************************************************45020002
396800                                                                  45030002
396900 5400-WRITE-PUR-ORDER-PO-RECORD.                                  45040002
397000                                                                  45050002
397100     MOVE 'PO '                 TO TR004-REC-TYPE-CDE-PO.         45060002
397200     MOVE TR004-REC-TYPE-PO     TO PV-TBL-EXT-ROW (EXT-INDEX).    45070002
397300     PERFORM 5900-CHECK-OVERFLOW.                                 45080002
397400                                                                  45090002
397500******************************************************************45100002
397600* WRITE INSTRUCTION RECORD TYPE FOR EXTRACT FILE.                *45110002
397700******************************************************************45120002
397800                                                                  45130002
397900 5500-WRITE-PUR-ORDER-INS-REC.                                    45140002
398000                                                                  45150002
398100     MOVE 'INS'     TO TR004-REC-TYPE-CDE-INS.                    45160002
398200     MOVE TR004-REC-TYPE-INS    TO PV-TBL-EXT-ROW (EXT-INDEX).    45170002
398300     PERFORM 5900-CHECK-OVERFLOW.                                 45180002
398400                                                                  45190002
398500******************************************************************45200002
398600* WRITE PURCHASE ORDER UPC RECORD TYPE FOR EXTRACT FILE.         *45210002
398700******************************************************************45220002
398800                                                                  45230002
398900 5600-WRITE-PUR-ORDER-UPC-REC.                                    45240002
399000                                                                  45250002
399100     MOVE 'UPC'    TO TR004-REC-TYPE-CDE-UPC.                     45260002
399200     MOVE TR004-REC-TYPE-UPC    TO PV-TBL-EXT-ROW (EXT-INDEX).    45270002
399300     PERFORM 5900-CHECK-OVERFLOW.                                 45280002
399400                                                                  45290002
399500******************************************************************45300002
399600* WRITE DISTRIBUTION CENTER RECORD TYPE FOR EXTRACT FILE.        *45310002
399700******************************************************************45320002
399800                                                                  45330002
399900 5700-WRITE-DC-RECORD.                                            45340002
400000                                                                  45350002
155029     SET PS-BYPASS-CRTN-WRITE-NO   TO TRUE.                       45360099
155029                                                                  45370099
155029     IF TR004-DIST-CNTR = PV-HOLD-DIST-CNTR                       45380099
155029        SET PS-BYPASS-CRTN-WRITE   TO TRUE                        45390099
155029     ELSE                                                         45400099
400100        MOVE 'DC '                 TO TR004-REC-TYPE-CDE-DC       45410099
155029        MOVE TR004-REC-TYPE-DC     TO PV-HOLD-OUT-RECORD          45420099
400200        MOVE TR004-REC-TYPE-DC     TO PV-TBL-EXT-ROW (EXT-INDEX)  45430099
400300        PERFORM 5900-CHECK-OVERFLOW                               45440099
155029     END-IF.                                                      45450099
400400                                                                  45460002
400500******************************************************************45470002
400600* WRITE BULK DC LABEL TYPE TO EXTRACT FILE.                      *45480002
400700******************************************************************45490002
400800                                                                  45500002
400900 5710-WRITE-DCT-RECORD.                                           45510002
401000                                                                  45520002
401100     MOVE 'DCT'    TO TR004-REC-TYPE-CDE-DC-CARTON.               45530002
401200     MOVE TR004-REC-TYPE-DC-CARTON TO PV-TBL-EXT-ROW (EXT-INDEX). 45540002
401300     PERFORM 5900-CHECK-OVERFLOW.                                 45550002
401400                                                                  45560002
401500******************************************************************45570002
401600* WRITE PACK DC LABEL TYPE TO EXTRACT FILE.                      *45580002
401700******************************************************************45590002
401800                                                                  45600002
401900 5720-WRITE-PCT-RECORD.                                           45610002
402000                                                                  45620002
402100     MOVE 'PCT'    TO TR004-REC-TYPE-CDE-PCT                      45630002
402200     MOVE TR004-REC-TYPE-PACK-CARTON                              45640002
402300                               TO PV-TBL-EXT-ROW (EXT-INDEX).     45650002
402400     PERFORM 5900-CHECK-OVERFLOW.                                 45660002
402500                                                                  45670002
402600******************************************************************45680002
402700* WRITE PACK RECORD TYPE (PCK) FOR EXTRACT FILE.                 *45690002
402800******************************************************************45700002
402900                                                                  45710002
403000 5755-WRITE-PUR-ORDER-PCK-REC.                                    45720002
403100                                                                  45730002
403200     MOVE 'PCK'    TO TR004-REC-TYPE-CDE-PCK.                     45740002
403300     MOVE TR004-REC-TYPE-PCK    TO PV-TBL-EXT-ROW (EXT-INDEX).    45750002
403400     PERFORM 5900-CHECK-OVERFLOW.                                 45760002
403500                                                                  45770002
403600******************************************************************45780002
403700* WRITE PACK DC (PDC) RECORD TYPE FOR EXTRACT FILE.              *45790002
403800******************************************************************45800002
403900                                                                  45810002
404000 5760-WRITE-PUR-ORDER-PDC-REC.                                    45820002
404100                                                                  45830002
155029     IF TR004-PDC-DIST-CNTR = PV-HOLD-DIST-CNTR                   45840099
155029        CONTINUE                                                  45850099
155029     ELSE                                                         45860099
404200        MOVE 'PDC'               TO TR004-REC-TYPE-CDE-PDC        45870099
155029        MOVE TR004-REC-TYPE-PDC  TO PV-HOLD-OUT-RECORD            45880099
404300        MOVE TR004-REC-TYPE-PDC  TO PV-TBL-EXT-ROW (EXT-INDEX)    45890099
404400        PERFORM 5900-CHECK-OVERFLOW                               45900099
155029     END-IF.                                                      45910099
404500                                                                  45920002
404600******************************************************************45930002
404700* WRITE CONTAINER SEAL TO EXTARCT FILE.                           45940091
404800******************************************************************45950002
404900                                                                  45960002
405000 5770-WRITE-CONTAINER-SEAL-REC.                                   45970002
405100                                                                  45980002
405200     INITIALIZE TR004-REC-TYPE-CONTAINER-SEAL                     45990002
405300     MOVE TRT00006-SEAL-NBR     TO TR004-SEA-CONTNR-SEAL-NBR.     46000002
405400     MOVE 'SEA'                 TO TR004-REC-TYPE-CDE-CONTNR-SEAL 46010002
405500     MOVE TR004-REC-TYPE-CONTAINER-SEAL                           46020002
405600                                TO OUTTR2-TRGL-EDI-PO-ODR.        46030002
405700                                                                  46040002
405800     PERFORM 6000-INSERT-EXTRACT-REC.                             46050002
405900                                                                  46060002
406000******************************************************************46070002
406100* WRITE TRAILER RECORD FOR EXTRACT FILE.                         *46080002
406200******************************************************************46090002
406300 5800-WRITE-PUR-ORDER-CTT-REC.                                    46100002
406400                                                                  46110002
406500     MOVE 'CTT'    TO TR004-REC-TYPE-CDE-CTT.                     46120002
406600     MOVE TR004-REC-TYPE-CTT      TO                              46130002
406700         OUTTR2-TRGL-EDI-PO-ODR.                                  46140002
406800                                                                  46150002
406900     PERFORM 6000-INSERT-EXTRACT-REC.                             46160002
407000                                                                  46170002
407100******************************************************************46180002
407200* CHECK IF INTERNAL TABLE FILLED UP.                             *46190002
407300******************************************************************46200002
407400                                                                  46210002
407500 5900-CHECK-OVERFLOW.                                             46220002
407600                                                                  46230002
407700     SET EXT-INDEX UP BY +1.                                      46240002
407800                                                                  46250002
407900     IF EXT-INDEX > PC-EXTRACT-TBL-LIMIT                          46260002
408000       DISPLAY  '***********************************************' 46270002
408100       DISPLAY  '** THIS IS NON-SQL ABEND                     **' 46280002
408200       DISPLAY  '** PROGRAM = TRKUP007                        **' 46290002
408300       DISPLAY  '** PARAGRAPGH  - 5900-CHECK-OVERFLOW         **' 46300002
408400       DISPLAY  '**                                           **' 46310002
408500       DISPLAY  '** INTERNAL TABLE IS FULL.                   **' 46320002
408600       DISPLAY  '**                                           **' 46330002
408700       DISPLAY  '**    INCREASE NUMBER OF OCCURS IN TABLE -   **' 46340002
408800       DISPLAY  '**                                           **' 46350002
408900       DISPLAY  '**              PV-EXTRACT-TABLE             **' 46360002
409000       DISPLAY  '**                                           **' 46370002
409100       DISPLAY  '**    AND CHANGE THE VALUE IN WS FIELD -     **' 46380002
409200       DISPLAY  '**                                           **' 46390002
409300       DISPLAY  '**              PC-EXTRACT-TBL-LIMIT         **' 46400002
409400       DISPLAY  '**                                           **' 46410002
409500       DISPLAY  '** CONTAINER ID = ' IMCNTK-CONTNR-ID             46420002
409600       DISPLAY  '** CNTR SEQ NBR = ' IMCNTK-CONTNR-SEQ-NBR        46430002
409700       DISPLAY  '** PO NUMBER    = ' IMCNPO-PO-NBR                46440002
409800       DISPLAY  '**                                           **' 46450002
409900       DISPLAY  '***********************************************' 46460002
410000       PERFORM 9100-SQL-ABEND                                     46470002
410100     END-IF.                                                      46480002
410200                                                                  46490002
410300******************************************************************46500002
410400* 6000-INSERT-EXTRACT-REC.                                      * 46510002
410500******************************************************************46520002
410600 6000-INSERT-EXTRACT-REC.                                         46530002
410700                                                                  46540002
410800     EXEC SQL                                                     46550002
410900         INSERT INTO TOUTTR2                                      46560002
411000             (TRGL_EDI_PO_ODR)                                    46570002
411100            VALUES  (:OUTTR2-TRGL-EDI-PO-ODR)                     46580002
411200     END-EXEC                                                     46590002
411300                                                                  46600002
411400     EVALUATE TRUE                                                46610002
411500         WHEN SQLWARN0 NOT EQUAL SPACE                            46620002
411600         WHEN SQLCODE NOT EQUAL ZERO                              46630002
411700             DISPLAY '** ABEND **'                                46640002
411800             DISPLAY '** PROGRAM = TRKUP007 **'                   46650002
411900             DISPLAY '** PARAGRAPH = 6000-INSERT-EXTRACT-REC**'   46660002
412000             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR2**'         46670002
412100             PERFORM 9100-SQL-ABEND                               46680002
412200     END-EVALUATE.                                                46690002
412300                                                                  46700002
412400     ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT.                         46710002
412500                                                                  46720002
412600 EJECT                                                            46730002
412700******************************************************************46740002
412800*    SELECT CHECKPOINT RESTART CONTROL INFO.                     *46750002
412900******************************************************************46760002
413000 6500-GET-CHECKPOINT-CNTL.                                        46770002
413100                                                                  46780002
413200     EXEC SQL                                                     46790002
413300      SELECT CKPT_STAT_CODE                                       46800002
413400       INTO :PV-CKPT-STAT-CODE                                    46810002
413500       FROM TCKRSTCNTL                                            46820002
413600       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 46830002
413700     END-EXEC.                                                    46840002
413800                                                                  46850002
413900                                                                  46860002
414000     EVALUATE TRUE                                                46870002
414100         WHEN SQLWARN0 NOT EQUAL SPACE                            46880002
414200         WHEN SQLCODE NOT EQUAL ZERO                              46890002
414300             DISPLAY '** ABEND **'                                46900002
414400             DISPLAY '** PROGRAM = TRKUP007 **'                   46910002
414500             DISPLAY '** PARAGRAPH = 6500-GET-CHECKPOINT-CNTL**'  46920002
414600             DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART*'   46930002
414700             PERFORM 9100-SQL-ABEND                               46940002
414800     END-EVALUATE.                                                46950002
414900                                                                  46960002
415000 EJECT                                                            46970002
415100******************************************************************46980002
415200 6550-CHECKPOINT-RESTART.                                         46990002
415300                                                                  47000002
415400     PERFORM 6560-GET-CHECKPOINT-INFO.                            47010002
415500     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO PV-CKPT-RESTART-INFO.  47020002
415600                                                                  47030002
415700     DISPLAY '** TRKUP007 CHECKPOINT RESTART **'.                 47040002
415800     DISPLAY '** TOTAL OUTPUT RECORD COUNT AT RESTART = '         47050002
415900              PV-RESTART-TOT-OUT-REC-COUNT.                       47060002
416000     DISPLAY '***********************************************'    47070002
416100                                                                  47080002
416200     MOVE PV-RESTART-TOT-OUT-REC-COUNT    TO                      47090002
416300         PA-TOTAL-OUTPUT-REC-COUNT.                               47100002
416400                                                                  47110002
416500     MOVE PV-RESTART-ERROR-COUNT          TO                      47120002
416600         PA-ERROR-COUNT.                                          47130002
416700                                                                  47140002
416800                                                                  47150002
416900******************************************************************47160002
417000*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.      *47170002
417100******************************************************************47180002
417200 6560-GET-CHECKPOINT-INFO.                                        47190002
417300                                                                  47200002
417400     EXEC SQL                                                     47210002
417500      SELECT WORK_STRG_DESC                                       47220002
417600       INTO :TCKRSTINF-WORK-STRG-DESC                             47230002
417700       FROM TCKRSTINF                                             47240002
417800      WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                  47250002
417900     END-EXEC.                                                    47260002
418000                                                                  47270002
418100     EVALUATE TRUE                                                47280002
418200         WHEN SQLWARN0 NOT EQUAL SPACE                            47290002
418300         WHEN SQLCODE NOT EQUAL ZERO                              47300002
418400             DISPLAY '** ABEND **'                                47310002
418500             DISPLAY '** PROGRAM = TRKUP007 **'                   47320002
418600             DISPLAY '** PARAGRAPH = 6560-GET-CHECKPOINT-INFO**'  47330002
418700             DISPLAY '** GETTING RESTART WORKING STORAGE INFO**'  47340002
418800             PERFORM 9100-SQL-ABEND                               47350002
418900     END-EVALUATE.                                                47360002
419000                                                                  47370002
419100 EJECT                                                            47380002
419200******************************************************************47390002
419300*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *47400002
419400*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *47410002
419500******************************************************************47420002
419600 6570-UPDATE-TCKRSTCNTL.                                          47430002
419700                                                                  47440002
419800     EXEC SQL                                                     47450002
419900       UPDATE TCKRSTCNTL                                          47460002
420000       SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                  47470002
420100       WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME            47480002
420200     END-EXEC.                                                    47490002
420300                                                                  47500002
420400     EVALUATE TRUE                                                47510002
420500         WHEN SQLWARN0 NOT EQUAL SPACE                            47520002
420600         WHEN SQLCODE NOT EQUAL ZERO                              47530002
420700             DISPLAY '** ABEND **'                                47540002
420800             DISPLAY '** PROGRAM = TRKUP007 **'                   47550002
420900             DISPLAY '** PARAGRAPH = 6570-UPDATE-TCKRSTCNTL**'    47560002
421000             DISPLAY '** GETTING RESTART INFORMATION AFTER ABEND*'47570002
421100             PERFORM 9100-SQL-ABEND                               47580002
421200     END-EVALUATE.                                                47590002
421300                                                                  47600002
421400 EJECT                                                            47610002
421500******************************************************************47620002
421600*    UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS     *47630002
421700*    INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND*47640002
421800******************************************************************47650002
421900 6580-UPDATE-TCKRSTINF.                                           47660002
422000                                                                  47670002
422100     MOVE PA-TOTAL-OUTPUT-REC-COUNT       TO                      47680002
422200         PV-RESTART-TOT-OUT-REC-COUNT.                            47690002
422300     MOVE PA-ERROR-COUNT                  TO                      47700002
422400         PV-RESTART-ERROR-COUNT.                                  47710002
422500     MOVE PV-CKPT-RESTART-INFO            TO                      47720002
422600         TCKRSTINF-WORK-STRG-DESC-TEXT.                           47730002
422700     MOVE 4022                            TO                      47740002
422800         TCKRSTINF-WORK-STRG-DESC-LEN.                            47750002
422900                                                                  47760002
423000     EXEC SQL                                                     47770002
423100        UPDATE TCKRSTINF                                          47780002
423200         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         47790002
423300         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          47800002
423400     END-EXEC.                                                    47810002
423500                                                                  47820002
423600     EVALUATE TRUE                                                47830002
423700         WHEN SQLWARN0 NOT EQUAL SPACE                            47840002
423800         WHEN SQLCODE NOT EQUAL ZERO                              47850002
423900             DISPLAY '** ABEND **'                                47860002
424000             DISPLAY '** PROGRAM = TRKUP007 **'                   47870002
424100             DISPLAY '** PARAGRAPH = 6580-UPDATE-TCKRSTINF**'     47880002
424200             DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF**'         47890002
424300             PERFORM 9100-SQL-ABEND                               47900002
424400     END-EVALUATE.                                                47910002
424500                                                                  47920002
155029******************************************************************47930099
155029*  FOR FAST FASHION CHECK TO SEE IF THIS DEPARTMENT NUMBER IS    *47940099
155029*  ONE OF THE FAST FASHION DEPARTMENT NUMBERS                    *47950099
155029******************************************************************47960099
155029 6600-FAST-PARM-CHECK.                                            47970099
155029                                                                  47980099
155029     MOVE PURCHS-DEPT-NBR  TO PV-DEPT-NBR.                        47990099
155029     MOVE SPACES           TO PV-FAST-RDC-IND                     48000099
155029                              PV-FAST-EFC-IND.                    48010099
155029                                                                  48020099
155029     EXEC SQL                                                     48030099
155029         SELECT  D.ATTR_ELEM_TXT AS RDC_IND                       48040099
155029                ,E.ATTR_ELEM_TXT AS EFC_IND                       48050099
155029           INTO :PV-FAST-RDC-IND                                  48060099
155029               ,:PV-FAST-EFC-IND                                  48070099
155029           FROM WST_INTGRTN_TYP A                                 48080099
155029               ,WST_ATTR_DEFN   B                                 48090099
155029               ,WST_ATTR_ELEM   C                                 48100099
155029               ,WST_ATTR_ELEM   D                                 48110099
155029               ,WST_ATTR_ELEM   E                                 48120099
155029               ,WST_ATTR_ELEM   F                                 48130099
155029               ,WST_ATTR_ELEM   G                                 48140099
155029          WHERE A.INTGRTN_TYP_CDE   = 'FASTFSHDPT'                48150099
155029            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           48160099
155029            AND B.ATTR_DEFN_SEQ_NBR = 1                           48170099
155029            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           48180099
155029            AND C.ATTR_DEFN_SEQ_NBR = 1                           48190099
155029            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           48200099
155029            AND D.ATTR_DEFN_SEQ_NBR = 2                           48210099
155029            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           48220099
155029            AND E.ATTR_DEFN_SEQ_NBR = 3                           48230099
155029            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           48240099
155029            AND F.ATTR_DEFN_SEQ_NBR = 4                           48250099
155029            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           48260099
155029            AND G.ATTR_DEFN_SEQ_NBR = 5                           48270099
155029            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         48280099
155029            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         48290099
155029            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         48300099
155029            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         48310099
155029            AND C.ATTR_ELEM_NBR     = :PV-DEPT-NBR                48320099
155029            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           48330099
155029            AND G.ATTR_ELEM_TMST = '9999-12-31-23.59.59.999999'   48340099
155029          WITH UR                                                 48350099
155029     END-EXEC.                                                    48360099
155029                                                                  48370099
155029     EVALUATE TRUE                                                48380099
155029          WHEN SQLCODE = +0                                       48390099
155029               CONTINUE                                           48400099
155029                                                                  48410099
155029          WHEN SQLCODE = +100                                     48420099
155029               MOVE 'N'          TO PV-FAST-RDC-IND               48430099
155029                                    PV-FAST-EFC-IND               48440099
155029                                                                  48450099
155029          WHEN OTHER                                              48460099
155029            DISPLAY '** ABEND **'                                 48470099
155029            DISPLAY '** PROGRAM = TRKUP007 **'                    48480099
155029            DISPLAY '** PARAGRAPH = 6600-FAST-PARM-CHECK **'      48490099
155029            DISPLAY '** IMCNPO-PO-NBR   = ' IMCNPO-PO-NBR         48500099
155029            DISPLAY '** PURCHS-DEPT-NBR = ' PURCHS-DEPT-NBR       48510099
155029            DISPLAY '** UNSUCCESSFUL SELECT OF FAST PARM**'       48520099
155029            PERFORM 9100-SQL-ABEND                                48530099
155029     END-EVALUATE.                                                48540099
155029                                                                  48550099
155029 EJECT                                                            48560099
424700******************************************************************48570002
424800* OPEN DRIVER (TRIP) CURSOR FOR CON TRANSMISSIONS.                48580002
424900******************************************************************48590002
425000 7000-OPEN-DRIVER-CURSOR.                                         48600002
425100                                                                  48610002
425200     EXEC SQL                                                     48620002
425300          OPEN CMN_DRIVER_CUR                                     48630002
425400     END-EXEC.                                                    48640002
425500                                                                  48650002
425600     EVALUATE TRUE                                                48660002
425700         WHEN SQLWARN0 NOT EQUAL SPACE                            48670002
425800         WHEN SQLCODE NOT EQUAL ZERO                              48680002
425900             DISPLAY '** ABEND **'                                48690002
426000             DISPLAY '** PROGRAM = TRKUP007 **'                   48700002
426100             DISPLAY                                              48710002
426200                '** PARAGRAPH = 7000-OPEN-DRIVER-CURSOR **'       48720002
426300             PERFORM 9100-SQL-ABEND                               48730002
426400     END-EVALUATE.                                                48740002
426500                                                                  48750002
426600*                                                                 48760002
426700******************************************************************48770002
426800* CLOSE CURSOR FOR COM TRANSMISSIONS.                            *48780002
426900******************************************************************48790002
427000 7010-CLOSE-DRIVER-CURSOR.                                        48800002
427100                                                                  48810002
427200                                                                  48820002
427300     EXEC SQL                                                     48830002
427400         CLOSE CMN_DRIVER_CUR                                     48840002
427500     END-EXEC.                                                    48850002
427600                                                                  48860002
427700     EVALUATE TRUE                                                48870002
427800         WHEN SQLWARN0 NOT EQUAL SPACE                            48880002
427900         WHEN SQLCODE NOT EQUAL ZERO                              48890002
428000             DISPLAY '** ABEND **'                                48900002
428100             DISPLAY '** PROGRAM = TRKUP007 **'                   48910002
428200             DISPLAY                                              48920002
428300               '** PARAGRAPH = 7010-CLOSE-DRIVER-CURSOR**'        48930002
428400             PERFORM 9100-SQL-ABEND                               48940002
428500     END-EVALUATE.                                                48950002
428600                                                                  48960002
428700******************************************************************48970002
428800* FETCH CURSOR FOR CMN TRANSMISSIONS                             *48980002
428900******************************************************************48990002
429000 7020-FETCH-DRIVER-CUR.                                           49000002
429100                                                                  49010002
429200     EXEC SQL                                                     49020002
429300          FETCH CMN_DRIVER_CUR                                    49030002
429400          INTO                                                    49040002
429500                 :IMCNTK-MOM-POE-DELY-TMST                        49050002
429600               , :IMCNTK-MOM-IMPRT-VEH-NM                         49060002
429700               , :IMCNTK-MOM-TRIP-TYP-CDE                         49070002
429800               , :IMCNTK-MOM-DEST-POE-CDE                         49080002
429900               , :IMCNTK-CONTNR-ID                                49090002
430000               , :IMCNTK-CONTNR-SEQ-NBR                           49100002
430100               , :IMCNTK-MOM-IMPRT-TRIP-ID                        49110002
430200               , :IMCNTK-MOM-CARR-SCAC-ID                         49120002
430300               , :IMCNTK-SIZE-CDE                                 49130002
430400     END-EXEC.                                                    49140002
430500                                                                  49150002
430600     EVALUATE TRUE                                                49160002
430700         WHEN SQLCODE = ZERO                                      49170002
430800            CONTINUE                                              49180002
430900                                                                  49190002
431000         WHEN SQLCODE = +100                                      49200002
431100              SET PS-EOC-DRIVER-CURSOR                            49210002
431200                               TO  TRUE                           49220002
431300                                                                  49230002
431400         WHEN SQLWARN0 NOT EQUAL SPACE                            49240002
431500         WHEN SQLCODE NOT EQUAL ZERO                              49250002
431600             DISPLAY '** ABEND **'                                49260002
431700             DISPLAY '** PROGRAM = TRKUP007 **'                   49270002
431800             DISPLAY                                              49280002
431900                 '** PARAGRAPH = 7020-FETCH-DRIVER-CUR**'         49290002
432000             PERFORM 9100-SQL-ABEND                               49300002
432100     END-EVALUATE.                                                49310002
432200                                                                  49320002
432300 EJECT                                                            49330002
432400******************************************************************49340002
432500* TAKE MOM_DEST_POE CONVERT TO TIMPOE FOR CURSOR TO POE CITY.    *49350002
432600******************************************************************49360002
432700 7100-GET-POE-CITY.                                               49370002
432800                                                                  49380002
432900     SET PS-POE-CITY-FOUND-NO   TO TRUE.                          49390002
433000     SET PS-POE-ON-TIMPOE-NO    TO TRUE.                          49400002
433100     PERFORM 7105-SELECT-POE-CD                                   49410002
433200       IF PS-POE-ON-TIMPOE                                        49420002
433300         SET PS-EOC-POE-CURSOR-NO  TO TRUE                        49430002
433400         PERFORM 7110-OPEN-POE-CURSOR                             49440002
433500         PERFORM 7120-FETCH-POE-CURSOR                            49450002
433600         IF PS-EOC-POE-CURSOR                                     49460002
433700            CONTINUE                                              49470002
433800         ELSE                                                     49480002
433900            SET PS-POE-CITY-FOUND   TO TRUE                       49490002
434000         END-IF                                                   49500002
434100         PERFORM 7115-CLOSE-POE-CURSOR                            49510002
434200       END-IF.                                                    49520002
434300                                                                  49530002
434400******************************************************************49540002
434500* SELECT POE ROW USING TIMCNTK.MOM_DEST_POE_CDE                  *49550002
434600******************************************************************49560002
434700 7105-SELECT-POE-CD.                                              49570002
434800                                                                  49580002
434900     EXEC SQL                                                     49590002
435000           SELECT DISTINCT                                        49600002
435100               P.POE_CDE                                          49610002
435200             INTO                                                 49620002
435300              :IMPOE-POE-CDE                                      49630002
435400             FROM                                                 49640002
435500               TIMPOE  P                                          49650002
435600             WHERE P.POE_STD_EDI_CDE = :IMCNTK-MOM-DEST-POE-CDE   49660002
435700               AND P.STAT_CDE = 'A'                               49670002
435800     END-EXEC.                                                    49680002
435900                                                                  49690002
436000                                                                  49700002
436100     EVALUATE TRUE                                                49710002
436200                                                                  49720002
436300         WHEN SQLCODE = ZERO                                      49730002
436400         WHEN SQLCODE = -811                                      49740002
436500            SET PS-POE-ON-TIMPOE   TO TRUE                        49750002
436600                                                                  49760002
436700         WHEN SQLCODE = +100                                      49770002
436800            CONTINUE                                              49780002
436900                                                                  49790002
437000         WHEN SQLWARN0 NOT EQUAL SPACE                            49800002
437100         WHEN SQLCODE NOT EQUAL ZERO                              49810002
437200             DISPLAY '** ABEND **'                                49820002
437300             DISPLAY '** PROGRAM = TRKUP007 **'                   49830002
437400             DISPLAY                                              49840002
437500                 '** PARAGRAPH = 7105-SELECT-POE-CD **'           49850002
437600             PERFORM 9100-SQL-ABEND                               49860002
437700     END-EVALUATE.                                                49870002
437800******************************************************************49880002
437900* OPEN CURSOR TO OBTAIN POE CITY FROM TIMPOE.                    *49890002
438000******************************************************************49900002
438100 7110-OPEN-POE-CURSOR.                                            49910002
438200                                                                  49920002
438300     EXEC SQL                                                     49930002
438400          OPEN POE_CUR                                            49940002
438500     END-EXEC.                                                    49950002
438600                                                                  49960002
438700     EVALUATE TRUE                                                49970002
438800         WHEN SQLWARN0 NOT EQUAL SPACE                            49980002
438900         WHEN SQLCODE NOT EQUAL ZERO                              49990002
439000             DISPLAY '** ABEND **'                                50000002
439100             DISPLAY '** PROGRAM = TRKUP007 **'                   50010002
439200             DISPLAY                                              50020002
439300                '** PARAGRAPH = 7110-OPEN-POE-CURSOR **'          50030002
439400             PERFORM 9100-SQL-ABEND                               50040002
439500     END-EVALUATE.                                                50050002
439600*                                                                 50060002
439700 EJECT                                                            50070002
439800******************************************************************50080002
439900* CLOSE CURSOR FOR TIMPOE.                                       *50090002
440000******************************************************************50100002
440100 7115-CLOSE-POE-CURSOR.                                           50110002
440200                                                                  50120002
440300                                                                  50130002
440400     EXEC SQL                                                     50140002
440500         CLOSE POE_CUR                                            50150002
440600     END-EXEC.                                                    50160002
440700                                                                  50170002
440800     EVALUATE TRUE                                                50180002
440900         WHEN SQLWARN0 NOT EQUAL SPACE                            50190002
441000         WHEN SQLCODE NOT EQUAL ZERO                              50200002
441100             DISPLAY '** ABEND **'                                50210002
441200             DISPLAY '** PROGRAM = TRKUP007 **'                   50220002
441300             DISPLAY                                              50230002
441400               '** PARAGRAPH = 7115-CLOSE-POE-CURSOR**'           50240002
441500             PERFORM 9100-SQL-ABEND                               50250002
441600     END-EVALUATE.                                                50260002
441700                                                                  50270002
441800*                                                                 50280002
441900******************************************************************50290002
442000* FETCH CURSOR FOR POE CITY FROM TIMPOE.                         *50300002
442100******************************************************************50310002
442200 7120-FETCH-POE-CURSOR.                                           50320002
442300                                                                  50330002
442400     EXEC SQL                                                     50340002
442500          FETCH POE_CUR                                           50350002
442600          INTO                                                    50360002
442700                 :IMPOE-POE-STD-EDI-CDE                           50370002
442800                ,:IMPOE-POE-CTY-NM                                50380002
442900     END-EXEC.                                                    50390002
443000                                                                  50400002
443100     EVALUATE TRUE                                                50410002
443200         WHEN SQLCODE = ZERO                                      50420002
443300                 CONTINUE                                         50430002
443400                                                                  50440002
443500         WHEN SQLCODE = +100                                      50450002
443600              SET PS-EOC-POE-CURSOR                               50460002
443700                               TO  TRUE                           50470002
443800                                                                  50480002
443900         WHEN SQLWARN0 NOT EQUAL SPACE                            50490002
444000         WHEN SQLCODE NOT EQUAL ZERO                              50500002
444100             DISPLAY '** ABEND **'                                50510002
444200             DISPLAY '** PROGRAM = TRKUP007 **'                   50520002
444300             DISPLAY                                              50530002
444400                 '** PARAGRAPH = 7120-FETCH-POE-CURSOR**'         50540002
444500             PERFORM 9100-SQL-ABEND                               50550002
444600     END-EVALUATE.                                                50560002
444700                                                                  50570002
444800******************************************************************50580002
444900 7600-OPEN-PO-CURSOR.                                             50590002
445000                                                                  50600002
445100     EXEC SQL                                                     50610002
445200          OPEN PO_CUR                                             50620002
445300     END-EXEC.                                                    50630002
445400                                                                  50640002
445500     EVALUATE TRUE                                                50650002
445600         WHEN SQLWARN0 NOT EQUAL SPACE                            50660002
445700         WHEN SQLCODE NOT EQUAL ZERO                              50670002
445800             DISPLAY '** ABEND **'                                50680002
445900             DISPLAY '** PROGRAM = TRKUP007 **'                   50690002
446000             DISPLAY '** PARAGRAPH = 7600-OPEN-PO-CURSOR **'      50700002
446100             PERFORM 9100-SQL-ABEND                               50710002
446200     END-EVALUATE.                                                50720002
446300                                                                  50730002
446400*                                                                 50740002
446500******************************************************************50750002
446600 7700-CLOSE-PO-CURSOR.                                            50760002
446700                                                                  50770002
446800     EXEC SQL                                                     50780002
446900         CLOSE PO_CUR                                             50790002
447000     END-EXEC.                                                    50800002
447100                                                                  50810002
447200     EVALUATE TRUE                                                50820002
447300         WHEN SQLWARN0 NOT EQUAL SPACE                            50830002
447400         WHEN SQLCODE NOT EQUAL ZERO                              50840002
447500             DISPLAY '** ABEND **'                                50850002
447600             DISPLAY '** PROGRAM = TRKUP007 **'                   50860002
447700             DISPLAY '** PARAGRAPH = 7700-CLOSE-PO-CURSOR**'      50870002
447800             PERFORM 9100-SQL-ABEND                               50880002
447900     END-EVALUATE.                                                50890002
448000                                                                  50900002
448100*                                                                 50910002
448200******************************************************************50920002
448300 7800-FETCH-VALIDATE-PO-CURSOR.                                   50930002
448400                                                                  50940002
448500     PERFORM 7810-FETCH-PO-CURSOR                                 50950002
448600     IF PS-EOC-PO-CURSOR                                          50960002
448700       CONTINUE                                                   50970002
448800     ELSE                                                         50980002
448900         PERFORM 7815-SELECT-SPLT-XMIT-FOR-PO                     50990002
449000         IF PS-PO-PASSES-XMIT-TEST                                51000002
449100           PERFORM 7822-CHECK-UNCONFIRMED-PACKS                   51010002
449200           IF PS-PO-PASSES-XMIT-TEST                              51020002
449300             PERFORM 7825-SELECT-UNTIED-LINES                     51030002
449400           END-IF                                                 51040002
449500         END-IF                                                   51050002
449600     END-IF.                                                      51060002
449700                                                                  51070002
449800******************************************************************51080002
449900 7810-FETCH-PO-CURSOR.                                            51090002
450000                                                                  51100002
450100     EXEC SQL                                                     51110002
450200          FETCH PO_CUR                                            51120002
450300          INTO                                                    51130002
450400                  :IMCNPO-PO-NBR                                  51140002
450500                , :IMCNPO-EXTL-REF-NBR                            51150002
450600                , :IMCNPO-SPLT-XMIT-CDE                           51160002
450700                , :IMCNPO-PO-UNT-QTY                              51170002
450800                , :IMCNPO-PO-CBMT-QTY                             51180002
450900                , :IMCNPO-PO-WT-KGRM-QTY                          51190002
451000     END-EXEC.                                                    51200002
451100                                                                  51210002
451200     EVALUATE TRUE                                                51220002
451300         WHEN SQLCODE = ZERO                                      51230002
451400              SET PS-PO-CUR-INFO-PRESENT    TO TRUE               51240002
451500              MOVE IMCNPO-PO-NBR    TO TR006-PO-NBR               51250002
451600                                                                  51260002
451700         WHEN SQLCODE = +100                                      51270002
451800              SET PS-EOC-PO-CURSOR          TO TRUE               51280002
451900              IF PS-PO-CUR-INFO-PRESENT                           51290002
452000                  SET PS-PO-CUR-INFO-PRESENT-NO TO TRUE           51300002
452100              ELSE                                                51310002
452200                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         51320002
452300                  INITIALIZE TR006-ERROR-MSG                      51330002
452400                  STRING 'CMN-PO TBL ERROR-CALL IS-NOT SNT'       51340002
452500                      DELIMITED BY SIZE                           51350002
452600                      INTO TR006-ERROR-MSG                        51360002
452700                  PERFORM 8830-WRITE-ERROR-LINE                   51370002
452800              END-IF                                              51380002
452900                                                                  51390002
453000         WHEN SQLWARN0 NOT EQUAL SPACE                            51400002
453100         WHEN SQLCODE NOT EQUAL ZERO                              51410002
453200             DISPLAY '** ABEND **'                                51420002
453300             DISPLAY '** PROGRAM = TRKUP007 **'                   51430002
453400             DISPLAY                                              51440002
453500              '** PARAGRAPH = 7800-FETCH-VALIDATE-PO-CURSOR**'    51450002
453600             PERFORM 9100-SQL-ABEND                               51460002
453700     END-EVALUATE.                                                51470002
453800                                                                  51480002
453900******************************************************************51490002
454000* CHECK IF THIS PARTICULAR PO HAS A ROW ON SHPTPO OR IF SPLIT-   *51500002
454100* XMIT IS BLANK.                                                 *51510002
454101******************************************************************51520004
454110**** PRB0040279 MJF 03/20/2013 START                              51530016
454111****    ADD TABLES TSHIPST AND TSHSTYP TO SELECT SO THAT DELETED  51540004
454112****    SHIPMENTS ARE BYPASSED.                                   51550004
454120**** PRB0040279 MJF 03/20/2013 END                                51560016
454200******************************************************************51570002
454300 7815-SELECT-SPLT-XMIT-FOR-PO.                                    51580002
454400                                                                  51590002
454500     EXEC SQL                                                     51600002
454600          SELECT SHPO.SPLT_XMIT_IND                               51610002
454700          INTO  :SHPTPO-SPLT-XMIT-IND                             51620002
454800          FROM   TSHPTPO  SHPO                                    51630002
454820                ,TSHIPST  S                                       51640003
454830                ,TSHSTYP  Y                                       51650005
454900          WHERE  SHPO.PO_NBR         = :IMCNPO-PO-NBR             51660002
455000            AND  SHPO.SPLT_XMIT_IND  IN('S','Y')                  51670002
455001            AND  S.SHIPT_ID = SHPO.SHIPT_ID                       51680005
455010            AND  Y.SHIPT_STATUS_CDE = S.SHIPT_STATUS_CDE          51690003
455020            AND  Y.PRTY_CDE < '95'                                51700003
455030            AND  Y.PRTY_CDE =                                     51710003
455040                   (SELECT MAX(TY.PRTY_CDE)                       51720003
455050                      FROM TSHIPST  ST                            51730003
455060                          ,TSHSTYP  TY                            51740003
455070                     WHERE ST.SHIPT_ID = S.SHIPT_ID               51750003
455080                       AND ST.SHIPT_STATUS_CDE =                  51760003
455090                           TY.SHIPT_STATUS_CDE)                   51770003
455100     END-EXEC.                                                    51780002
455200                                                                  51790002
455300     EVALUATE TRUE                                                51800002
455400                                                                  51810002
455500         WHEN SQLCODE = ZERO                                      51820002
455600         WHEN SQLCODE = -811                                      51830002
455700           DISPLAY '== FOUND S OR Y ON SHPTPO FOR CONT/PO '       51840002
455800                   IMCNTK-CONTNR-ID '/'                           51850002
455900                   IMCNPO-PO-NBR ' =='                            51860002
456000                                                                  51870002
456100         WHEN SQLCODE = +100                                      51880002
456200           SET PS-PO-PASSES-XMIT-TEST  TO TRUE                    51890002
456300                                                                  51900002
456400         WHEN SQLWARN0 NOT EQUAL SPACE                            51910002
456500         WHEN SQLCODE NOT EQUAL ZERO                              51920002
456600             DISPLAY '** ABEND **'                                51930002
456700             DISPLAY '** PROGRAM = TRKUP007 **'                   51940002
456800             DISPLAY                                              51950002
456900              '** PARAGRAPH = 7815-SELECT-SPLT-XMIT-FOR-PO - **'  51960002
457000             DISPLAY                                              51970002
457100              '**     IMCNPO.PO_NBR = ' IMCNPO-PO-NBR             51980002
457200             PERFORM 9100-SQL-ABEND                               51990002
457300     END-EVALUATE.                                                52000002
457400                                                                  52010002
457500******************************************************************52020002
457600 7822-CHECK-UNCONFIRMED-PACKS.                                    52030002
457700                                                                  52040002
457800     INITIALIZE  PV-DB2-COUNT.                                    52050002
457900                                                                  52060002
458000     EXEC SQL                                                     52070002
458100         SELECT COUNT (*)                                         52080002
458200           INTO :PV-DB2-COUNT                                     52090002
458300           FROM TPURITM  A                                        52100002
458400               ,TPURCHS  B                                        52110002
458500          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 52120002
458600            AND A.VER_STATUS_CDE = :PC-A                          52130002
458700            AND A.STATUS_CDE     = 'RV'                           52140002
458800            AND B.PO_NBR         =  A.PO_NBR                      52150002
458900            AND B.VER_STATUS_CDE = :PC-A                          52160002
459000            AND B.PKGNG_CDE      IN ('M','I')                     52170002
459100     END-EXEC                                                     52180002
459200                                                                  52190002
459300     EVALUATE TRUE                                                52200002
459400         WHEN SQLCODE = ZERO                                      52210002
459500         WHEN SQLCODE = -811                                      52220002
459600           IF PV-DB2-COUNT = ZERO                                 52230002
459700             CONTINUE                                             52240002
459800           ELSE                                                   52250002
459900             SET PS-PO-PASSES-XMIT-TEST-NO  TO TRUE               52260002
460000             SET TR006-ERROR-TYPE-ERROR     TO TRUE               52270002
460100             IF SKXREF-DEPT NUMERIC                               52280002
460200               IF SKXREF-DEPT > ZEROES                            52290002
460300                 MOVE SKXREF-DEPT       TO TR006-DEPT-NBR         52300002
460400               END-IF                                             52310002
460500             END-IF                                               52320002
460600             MOVE PURCHS-PKGNG-CDE      TO TR006-PKGNG-CDE        52330002
460700             INITIALIZE TR006-UPC-NBR                             52340002
460800                        TR006-ERROR-MSG                           52350002
460900             STRING 'CMN-UNCONFIRMED PACKS'                       52360002
461000                 DELIMITED BY SIZE                                52370002
461100                 INTO TR006-ERROR-MSG                             52380002
461200             PERFORM 8830-WRITE-ERROR-LINE                        52390002
461300           END-IF                                                 52400002
461400                                                                  52410002
461500         WHEN SQLCODE = +100                                      52420002
461600             CONTINUE                                             52430002
461700                                                                  52440002
461800         WHEN SQLWARN0 NOT EQUAL SPACE                            52450002
461900         WHEN SQLCODE NOT EQUAL ZERO                              52460002
462000             DISPLAY '**************************************'     52470002
462100             DISPLAY '** ABEND                            **'     52480002
462200             DISPLAY '** PROGRAM = TRKUP007               **'     52490002
462300             DISPLAY '** PARAGRAPH = 7822-CHECK-UNCONFIRMED-PACKS'52500002
462400             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              52510002
462500             DISPLAY '**************************************'     52520002
462600             PERFORM 9100-SQL-ABEND                               52530002
462700     END-EVALUATE.                                                52540002
462800                                                                  52550002
462900******************************************************************52560002
463000 7825-SELECT-UNTIED-LINES.                                        52570002
463100                                                                  52580002
463200     EXEC SQL                                                     52590002
463300         SELECT A.PO_NBR                                          52600002
463400               ,B.PKGNG_CDE                                       52610002
463500           INTO :PURITM-PO-NBR                                    52620002
463600               ,:PURCHS-PKGNG-CDE                                 52630002
463700           FROM TPURITM  A                                        52640002
463800               ,TPURCHS  B                                        52650002
463900          WHERE A.PO_NBR         = :IMCNPO-PO-NBR                 52660002
464000            AND A.VER_STATUS_CDE = :PC-A                          52670002
464100            AND A.STATUS_CDE     IN ('AC', 'AP')                  52680002
464200            AND A.PO_PREPK_ID    =  0                             52690002
464300            AND B.PO_NBR         =  A.PO_NBR                      52700002
464400            AND B.VER_STATUS_CDE = :PC-A                          52710002
464500            AND B.PKGNG_CDE      IN ('M','I')                     52720002
464600     END-EXEC                                                     52730002
464700                                                                  52740002
464800     EVALUATE TRUE                                                52750002
464900         WHEN SQLCODE = ZERO                                      52760002
465000         WHEN SQLCODE = -811                                      52770002
465100             SET TR006-ERROR-TYPE-ERROR TO TRUE                   52780002
465200             IF SKXREF-DEPT NUMERIC                               52790002
465300               IF SKXREF-DEPT > ZEROES                            52800002
465400                 MOVE SKXREF-DEPT       TO TR006-DEPT-NBR         52810002
465500               END-IF                                             52820002
465600             END-IF                                               52830002
465700             MOVE PURCHS-PKGNG-CDE      TO TR006-PKGNG-CDE        52840002
465800             INITIALIZE TR006-UPC-NBR                             52850002
465900                        TR006-ERROR-MSG                           52860002
466000             STRING 'CMN-PK DTL UPC NT TIED TO PCK-FX'            52870002
466100                 DELIMITED BY SIZE                                52880002
466200                 INTO TR006-ERROR-MSG                             52890002
466300             PERFORM 8830-WRITE-ERROR-LINE                        52900002
466400                                                                  52910002
466500         WHEN SQLCODE = +100                                      52920002
466600             CONTINUE                                             52930002
466700                                                                  52940002
466800         WHEN SQLWARN0 NOT EQUAL SPACE                            52950002
466900         WHEN SQLCODE NOT EQUAL ZERO                              52960002
467000             DISPLAY '**************************************'     52970002
467100             DISPLAY '** ABEND                            **'     52980002
467200             DISPLAY '** PROGRAM = TRKUP007               **'     52990002
467300             DISPLAY '** PARAGRAPH = 7825-SELECT-UNTIED-LINES'    53000002
467400             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              53010002
467500             DISPLAY '**************************************'     53020002
467600             PERFORM 9100-SQL-ABEND                               53030002
467700     END-EVALUATE.                                                53040002
467800                                                                  53050002
155029******************************************************************53060099
155029 7830-RETRIEVE-PLAN-NBR.                                          53070099
155029                                                                  53080099
155029     EXEC SQL                                                     53090099
155029           SELECT DISTINCT AL.PLAN_NBR                            53100099
155029             INTO :ALLPLN-PLAN-NBR                                53110099
155029             FROM TIMCNUP   CNUP                                  53120099
155029                 ,TUPCSKU   SKU                                   53130099
155029                 ,TPURITM   PUR                                   53140099
155029                 ,TALLPLN   AL                                    53150099
155029                 ,TMESTDS   ES                                    53160099
155029             WHERE CNUP.CONTNR_ID      = :IMCNTK-CONTNR-ID        53170099
155029               AND CNUP.CONTNR_SEQ_NBR = :IMCNTK-CONTNR-SEQ-NBR   53180099
155029               AND SKU.UPC_NBR         = :IMCNUP-UPC-NBR          53190099
155029               AND AL.DEST_NBR         = :ALLPLN-DEST-NBR         53200099
155029               AND PUR.ITM_NBR         =  SKU.ITEM_NBR            53210099
155029               AND PUR.PO_NBR          = :IMCNPO-PO-NBR           53220099
155029               AND PUR.VER_STATUS_CDE  = 'A'                      53230099
155029               AND PUR.STATUS_CDE     IN ('AC', 'AP')             53240099
155029               AND AL.PO_LNE_NBR       =  PUR.PO_LNE_NBR          53250099
155029               AND AL.PO_LNE_NBR       =  ES.PO_LNE_NBR           53260099
155029               AND AL.PO_LNE_NBR       =  CNUP.PO_LNE_NBR         53270099
155029               AND AL.PO_NBR           =  PUR.PO_NBR              53280099
155029               AND AL.PO_NBR           =  CNUP.PO_NBR             53290099
155029               AND AL.PLAN_NBR         =  ES.PLAN_NBR             53300099
155029               AND PUR.PO_NBR          =  ES.PO_NBR               53310099
155029               AND ES.STR_DISTRO_QTY  >  0                        53320099
155029     END-EXEC.                                                    53330099
155029                                                                  53340099
155029     EVALUATE TRUE                                                53350099
155029         WHEN SQLCODE = ZERO                                      53360099
155029             CONTINUE                                             53370099
155029                                                                  53380099
155029         WHEN SQLCODE = +100                                      53390099
155029             SET PS-EOC-STORE-CURSOR                              53400099
155029                 PS-EOC-PREPACK-DC-CURSOR                         53410099
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             53420099
155029             PERFORM 8425-CLOSE-PACK-DC-CURSOR                    53430099
155029             INITIALIZE TR006-UPC-NBR                             53440099
155029                        TR006-ERROR-MSG                           53450099
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             53460099
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              53470099
155029                     DELIMITED BY SIZE                            53480099
155029                     INTO TR006-ERROR-MSG                         53490099
155029             MOVE IMCNUP-SKU-NBR   TO  TR006-SKU                  53500099
155029             PERFORM 8830-WRITE-ERROR-LINE                        53510099
155029             SET PS-SPLITS-ENTERED-NO      TO TRUE                53520099
155029                                                                  53530099
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            53540099
155029         WHEN SQLCODE NOT EQUAL ZERO                              53550099
155029             DISPLAY '**************************************'     53560099
155029             DISPLAY '** ABEND                            **'     53570099
155029             DISPLAY '** PROGRAM = TRKUP007               **'     53580099
155029             DISPLAY '** PARAGRAPH = 7830-RETRIEVE-PLAN-NBR'      53590099
155029             DISPLAY '** CONTAINER = ' IMCNTK-CONTNR-ID           53600099
155029             DISPLAY '** CONT SEQ# = ' IMCNTK-CONTNR-SEQ-NBR      53610099
155029             DISPLAY '** UPC NBR   = ' IMCNUP-UPC-NBR             53620099
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            53630099
155029             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              53640099
155029             DISPLAY '**************************************'     53650099
155029             PERFORM 9100-SQL-ABEND                               53660099
155029     END-EVALUATE.                                                53670099
155029                                                                  53680099
155029 EJECT                                                            53690099
155029******************************************************************53700099
155029 7835-RETRIEVE-PLAN-NBR.                                          53710099
155029                                                                  53720099
155029     EXEC SQL                                                     53730099
155029         SELECT DISTINCT(PLAN_NBR)                                53740099
155029           INTO :ALLPLN-PLAN-NBR                                  53750099
155029           FROM TALLPLN                                           53760099
155029          WHERE PO_NBR         = :IMCNPO-PO-NBR                   53770099
155029            AND PO_LNE_NBR     = :PURITM-PO-LNE-NBR               53780099
155029            AND DEST_NBR       = :ALLPLN-DEST-NBR                 53790099
155029            AND CURR_SPLIT_QTY >  0                               53800099
155029     END-EXEC.                                                    53810099
155029                                                                  53820099
155029     EVALUATE TRUE                                                53830099
155029         WHEN SQLCODE = ZERO                                      53840099
155029             CONTINUE                                             53850099
155029                                                                  53860099
155029         WHEN SQLCODE = +100                                      53870099
155029             SET PS-EOC-STORE-CURSOR                              53880099
155029                 PS-EOC-PREPACK-DC-CURSOR                         53890099
155029                 PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE             53900099
155029             PERFORM 8425-CLOSE-PACK-DC-CURSOR                    53910099
155029             INITIALIZE TR006-UPC-NBR                             53920099
155029                        TR006-ERROR-MSG                           53930099
155029             SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE             53940099
155029             STRING 'CMN-PACK MISSING SPLT-FIX/FAST'              53950099
155029                     DELIMITED BY SIZE                            53960099
155029                     INTO TR006-ERROR-MSG                         53970099
155029             MOVE IMCNUP-SKU-NBR   TO  TR006-SKU                  53980099
155029             PERFORM 8830-WRITE-ERROR-LINE                        53990099
155029             SET PS-SPLITS-ENTERED-NO      TO TRUE                54000099
155029                                                                  54010099
155029         WHEN SQLWARN0 NOT EQUAL SPACE                            54020099
155029         WHEN SQLCODE NOT EQUAL ZERO                              54030099
155029             DISPLAY '**************************************'     54040099
155029             DISPLAY '** ABEND                            **'     54050099
155029             DISPLAY '** PROGRAM = TRKUP007               **'     54060099
155029             DISPLAY '** PARAGRAPH = 7835-RETRIEVE-PLAN-NBR'      54070099
155029             DISPLAY '** CONTAINER = ' IMCNTK-CONTNR-ID           54080099
155029             DISPLAY '** STORE NBR = ' ALLPLN-DEST-NBR            54090099
155029             DISPLAY '** PO NUMBER = ' IMCNPO-PO-NBR              54100099
155029             DISPLAY '** LINE NBR  = ' PURITM-PO-LNE-NBR          54110099
155029             DISPLAY '**************************************'     54120099
155029             PERFORM 9100-SQL-ABEND                               54130099
155029     END-EVALUATE.                                                54140099
155029                                                                  54150099
155029 EJECT                                                            54160099
468000******************************************************************54170002
468100 7900-OPEN-INSTR-CURSOR.                                          54180002
468200                                                                  54190002
468300     EXEC SQL                                                     54200002
468400          OPEN INSTR_CUR                                          54210002
468500     END-EXEC.                                                    54220002
468600                                                                  54230002
468700     EVALUATE TRUE                                                54240002
468800         WHEN SQLWARN0 NOT EQUAL SPACE                            54250002
468900         WHEN SQLCODE NOT EQUAL ZERO                              54260002
469000             DISPLAY '** ABEND **'                                54270002
469100             DISPLAY '** PROGRAM = TRKUP007 **'                   54280002
469200             DISPLAY '** PARAGRAPH = 7900-OPEN-INSTR-CURSOR **'   54290002
469300             PERFORM 9100-SQL-ABEND                               54300002
469400     END-EVALUATE.                                                54310002
469500                                                                  54320002
469600*                                                                 54330002
469700******************************************************************54340002
469800 8000-CLOSE-INSTR-CURSOR.                                         54350002
469900                                                                  54360002
470000                                                                  54370002
470100     EXEC SQL                                                     54380002
470200         CLOSE INSTR_CUR                                          54390002
470300     END-EXEC.                                                    54400002
470400                                                                  54410002
470500     EVALUATE TRUE                                                54420002
470600         WHEN SQLWARN0 NOT EQUAL SPACE                            54430002
470700         WHEN SQLCODE NOT EQUAL ZERO                              54440002
470800             DISPLAY '** ABEND **'                                54450002
470900             DISPLAY '** PROGRAM = TRKUP007 **'                   54460002
471000             DISPLAY '** PARAGRAPH = 8000-CLOSE-INSTR-CURSOR**'   54470002
471100             PERFORM 9100-SQL-ABEND                               54480002
471200     END-EVALUATE.                                                54490002
471300                                                                  54500002
471400*                                                                 54510002
471500******************************************************************54520002
471600 8100-FETCH-INSTR-CURSOR.                                         54530002
471700                                                                  54540002
471800     EXEC SQL                                                     54550002
471900          FETCH INSTR_CUR                                         54560002
472000          INTO                                                    54570002
472100                  :INSTCD-INSTR-DESC                              54580002
472200                , :INSTCD-INSTR-NBR                               54590002
472300                , :POINST-RECIP-CDE                               54600002
472400     END-EXEC.                                                    54610002
472500                                                                  54620002
472600     EVALUATE TRUE                                                54630002
472700         WHEN SQLCODE = ZERO                                      54640002
472800             CONTINUE                                             54650002
472900                                                                  54660002
473000         WHEN SQLCODE = +100                                      54670002
473100              SET PS-EOC-INSTR-CURSOR                             54680002
473200                                   TO  TRUE                       54690002
473300                                                                  54700002
473400         WHEN SQLWARN0 NOT EQUAL SPACE                            54710002
473500         WHEN SQLCODE NOT EQUAL ZERO                              54720002
473600             DISPLAY '** ABEND **'                                54730002
473700             DISPLAY '** PROGRAM = TRKUP007 **'                   54740002
473800             DISPLAY '** PARAGRAPH = 8100-FETCH-INSTR-CURSOR**'   54750002
473900             PERFORM 9100-SQL-ABEND                               54760002
474000     END-EVALUATE.                                                54770002
474100                                                                  54780002
474200 EJECT                                                            54790002
474300******************************************************************54800002
474400 8200-OPEN-BULK-UPC-CUR.                                          54810002
474500                                                                  54820002
474600     EXEC SQL                                                     54830002
474700          OPEN BULK_UPC_CUR                                       54840002
474800     END-EXEC.                                                    54850002
474900                                                                  54860002
475000     EVALUATE TRUE                                                54870002
475100         WHEN SQLWARN0 NOT EQUAL SPACE                            54880002
475200         WHEN SQLCODE NOT EQUAL ZERO                              54890002
475300             DISPLAY '** ABEND **'                                54900002
475400             DISPLAY '** PROGRAM = TRKUP007 **'                   54910002
475500             DISPLAY '** PARAGRAPH = 8200-OPEN-BULK-UPC-CUR **'   54920002
475600             PERFORM 9100-SQL-ABEND                               54930002
475700     END-EVALUATE.                                                54940002
475800                                                                  54950002
475900*                                                                 54960002
476000******************************************************************54970002
476100 8300-CLOSE-BULK-UPC-CUR.                                         54980002
476200                                                                  54990002
476300                                                                  55000002
476400     EXEC SQL                                                     55010002
476500         CLOSE BULK_UPC_CUR                                       55020002
476600     END-EXEC.                                                    55030002
476700                                                                  55040002
476800     EVALUATE TRUE                                                55050002
476900         WHEN SQLWARN0 NOT EQUAL SPACE                            55060002
477000         WHEN SQLCODE NOT EQUAL ZERO                              55070002
477100             DISPLAY '** ABEND **'                                55080002
477200             DISPLAY '** PROGRAM = TRKUP007 **'                   55090002
477300             DISPLAY '** PARAGRAPH = 8300-CLOSE-BULK-UPC-CUR**'   55100002
477400             PERFORM 9100-SQL-ABEND                               55110002
477500     END-EVALUATE.                                                55120002
477600                                                                  55130002
477700*                                                                 55140002
477800******************************************************************55150002
477900 8400-FETCH-BULK-UPC-CUR.                                         55160002
478000                                                                  55170002
478100     EXEC SQL                                                     55180002
478200          FETCH BULK_UPC_CUR                                      55190002
478300          INTO    :IMCNUP-UPC-NBR                                 55200002
478400                , :IMCNUP-UPC-UNT-QTY                             55210002
478500                , :IMCNUP-UPC-CART-CNT                            55220002
478600                , :IMCNUP-SKU-NBR                                 55230002
478700                , :IMCNUP-ASN-PKGNG-CDE                           55240002
478800                , :IMCNUP-UPC-CBMT-QTY                            55250002
478900                , :IMCNUP-UPC-WT-KGRM-QTY                         55260002
479000                , :PURITM-ITM-NBR                                 55270002
479100                , :XLT00003-NRF-CLOR-CDE                          55280002
479200                , :XLT00003-CSTM-CLOR-DESC                        55290002
479300                , :XLT00003-SIZE-DESC                             55300002
479400                , :XLT00003-SKU-DESC                              55310002
479500                , :XLT00004-VS-NBR                                55320002
479600                , :SKXREF-DEPT                                    55330002
479700                , :SKXREF-CLASS                                   55340002
479800                , :SKXREF-SUBCLASS                                55350002
479900                , :SKXREF-SKU                                     55360002
479910                , :PURITM-OUTR-PK-QTY                             55370002
480000     END-EXEC.                                                    55380002
480100                                                                  55390002
480200     EVALUATE TRUE                                                55400002
480300         WHEN SQLCODE = ZERO                                      55410002
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        55420099
155029             SET PS-NEW-UPC-YES      TO TRUE                      55430099
480400             SET PS-UPCS-ON-TIMCNUP  TO TRUE                      55440099
480500             IF SKXREF-DEPT NUMERIC                               55450002
480600              IF SKXREF-DEPT > ZEROES                             55460002
480700                 MOVE SKXREF-DEPT    TO TR006-DEPT-NBR            55470099
480800              END-IF                                              55480002
480900             END-IF                                               55490002
481000                                                                  55500002
481100         WHEN SQLCODE = +100                                      55510002
481200              IF PS-UPCS-ON-TIMCNUP                               55520002
481300                  CONTINUE                                        55530002
481400              ELSE                                                55540002
481500                  SET TR006-ERROR-TYPE-ERROR   TO TRUE            55550002
481600                  INITIALIZE TR006-UPC-NBR                        55560002
481700                             TR006-ERROR-MSG                      55570002
481800                  STRING 'CMN-NO UPCS FOR BULK PO-FIX'            55580002
481900                      DELIMITED BY SIZE                           55590002
482000                      INTO TR006-ERROR-MSG                        55600002
482100                  PERFORM 8830-WRITE-ERROR-LINE                   55610002
482200                  SET PS-PROBLEM-DO-NOT-SEND TO TRUE              55620002
482300              END-IF                                              55630002
482400                                                                  55640002
482500              SET PS-EOC-BULK-UPC-CUR TO TRUE                     55650002
482600                                                                  55660002
482700         WHEN SQLWARN0 NOT EQUAL SPACE                            55670002
482800         WHEN SQLCODE NOT EQUAL ZERO                              55680002
482900             DISPLAY '** ABEND **'                                55690002
483000             DISPLAY '** PROGRAM = TRKUP007 **'                   55700002
483100             DISPLAY '** PARAGRAPH = 8400-FETCH-BULK-UPC-CUR**'   55710002
483200             PERFORM 9100-SQL-ABEND                               55720002
483300     END-EVALUATE.                                                55730002
483400                                                                  55740002
483500 EJECT                                                            55750002
483600******************************************************************55760002
483700 8420-OPEN-PACK-DC-CURSOR.                                        55770002
483800                                                                  55780002
483900     EXEC SQL                                                     55790002
484000          OPEN PREPACK_DC_CUR                                     55800002
484100     END-EXEC.                                                    55810002
484200                                                                  55820002
484300     EVALUATE TRUE                                                55830002
484400         WHEN SQLWARN0 NOT EQUAL SPACE                            55840002
484500         WHEN SQLCODE NOT EQUAL ZERO                              55850002
484600             DISPLAY '** ABEND **'                                55860002
484700             DISPLAY '** PROGRAM = TRKUP007 **'                   55870002
484800             DISPLAY '** PARAGRAPH = 8420-OPEN-PACK-DC-CURSOR***' 55880002
484900             PERFORM 9100-SQL-ABEND                               55890002
485000     END-EVALUATE.                                                55900002
485100                                                                  55910002
485200******************************************************************55920002
485300 8425-CLOSE-PACK-DC-CURSOR.                                       55930002
485400                                                                  55940002
485500     EXEC SQL                                                     55950002
485600         CLOSE PREPACK_DC_CUR                                     55960002
485700     END-EXEC.                                                    55970002
                                                                        55971099
485800                                                                  55980002
485900     EVALUATE TRUE                                                55990002
486000         WHEN SQLWARN0 NOT EQUAL SPACE                            56000002
486100         WHEN SQLCODE NOT EQUAL ZERO                              56010002
486200             DISPLAY '** ABEND **'                                56020002
486300             DISPLAY '** PROGRAM = TRKUP007 **'                   56030002
486400             DISPLAY '** PARAGRAPH = 8425-CLOSE-PACK-DC-CURSOR***'56040002
288200             DISPLAY '#######################################'    56051099
288300             DISPLAY '** IMCNTK-CONTNR-ID      ' IMCNTK-CONTNR-ID 56052099
288400             DISPLAY '** IMCNPO-PO-NBR         ' IMCNPO-PO-NBR    56053099
288500             DISPLAY '** IMCNUP-UPC-NBR        ' IMCNUP-UPC-NBR   56054099
486500             PERFORM 9100-SQL-ABEND                               56055099
486600     END-EVALUATE.                                                56060002
486700                                                                  56070002
486800******************************************************************56080002
486900 8430-FETCH-PACK-DC-CURSOR.                                       56090002
487000                                                                  56100002
487100     EXEC SQL                                                     56110002
487200          FETCH PREPACK_DC_CUR                                    56120099
487300          INTO                                                    56130002
487400               :ALLPLN-DEST-NBR                                   56140002
155029             , :PV-FAST-E-BUS-IND                                 56150099
487500             , :PA-TTL-ORDERED-PACK-QTY-DC                        56160002
487600     END-EXEC.                                                    56170002
487700                                                                  56180002
487800     EVALUATE TRUE                                                56190002
487900         WHEN SQLCODE = ZERO                                      56200002
488000             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 56210002
155029             IF PS-NEW-UPC-YES                                    56220099
155029                SET PS-NEW-UPC-NO      TO TRUE                    56230099
155029                SET PS-FIRST-UPC-YES   TO TRUE                    56240099
155029             END-IF                                               56250099
488100                                                                  56260002
488200         WHEN SQLCODE = +100                                      56270002
488300              SET PS-EOC-PREPACK-DC-CURSOR TO TRUE                56280002
488400              IF PS-DC-SPLIT-INFO-PRESENT                         56290002
488500                 CONTINUE                                         56300002
488600              ELSE                                                56310002
488700                 INITIALIZE TR006-UPC-NBR                         56320002
488800                            TR006-ERROR-MSG                       56330002
488900                 SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE         56340002
489000                 STRING 'CMN-PACK MISSING SPLT-FIX'               56350002
489100                     DELIMITED BY SIZE                            56360002
489200                     INTO TR006-ERROR-MSG                         56370002
489300                 MOVE IMCNUP-SKU-NBR   TO  TR006-SKU              56380002
489400                 PERFORM 8830-WRITE-ERROR-LINE                    56390002
489500                 SET PS-SPLITS-ENTERED-NO      TO TRUE            56400002
489600              END-IF                                              56410002
489700                                                                  56420002
489800         WHEN SQLWARN0 NOT EQUAL SPACE                            56430002
489900         WHEN SQLCODE NOT EQUAL ZERO                              56440002
490000             DISPLAY '** ABEND **'                                56450002
490100             DISPLAY '** PROGRAM = TRKUP007 **'                   56460002
490200             DISPLAY '** PARAGRAPH = 8430-FETCH-PACK-DC-CURSOR**' 56470002
490300             PERFORM 9100-SQL-ABEND                               56480002
490400     END-EVALUATE.                                                56490002
490500                                                                  56500002
490600 EJECT                                                            56510002
490700******************************************************************56520002
490800 8450-OPEN-PACK-UPC-CURSOR.                                       56530002
490900                                                                  56540002
491000     EXEC SQL                                                     56550002
491100          OPEN PACK_UPC_CUR                                       56560002
491200     END-EXEC.                                                    56570002
491300                                                                  56580002
491400     EVALUATE TRUE                                                56590002
491500         WHEN SQLWARN0 NOT EQUAL SPACE                            56600002
491600         WHEN SQLCODE NOT EQUAL ZERO                              56610002
491700             DISPLAY '** ABEND **'                                56620002
491800             DISPLAY '** PROGRAM = TRKUP007 **'                   56630002
491900             DISPLAY '** PARAGRAPH = 8450-OPEN-PACK-UPC-CURSOR*'  56640002
492000             PERFORM 9100-SQL-ABEND                               56650002
492100     END-EVALUATE.                                                56660002
492200                                                                  56670002
492300******************************************************************56680002
492400 8455-CLOSE-PACK-UPC-CURSOR.                                      56690002
492500                                                                  56700002
492600     EXEC SQL                                                     56710002
492700         CLOSE PACK_UPC_CUR                                       56720002
492800     END-EXEC.                                                    56730002
492900                                                                  56740002
493000     EVALUATE TRUE                                                56750002
493100         WHEN SQLWARN0 NOT EQUAL SPACE                            56760002
493200         WHEN SQLCODE NOT EQUAL ZERO                              56770002
493300             DISPLAY '** ABEND **'                                56780002
493400             DISPLAY '** PROGRAM = TRKUP007 **'                   56790002
493500             DISPLAY '** PARAGRAPH = 8455-CLOSE-PACK-UPC-CURSOR*' 56800002
493600             PERFORM 9100-SQL-ABEND                               56810002
493700     END-EVALUATE.                                                56820002
493800                                                                  56830002
493900******************************************************************56840002
494000 8460-FETCH-PACK-UPC-CURSOR.                                      56850002
494100                                                                  56860002
494200     EXEC SQL                                                     56870002
494300          FETCH PACK_UPC_CUR                                      56880002
494400          INTO                                                    56890002
494500               :TUPCSKU-UPC-NBR                                   56900002
494600             , :XLT00004-VS-NBR                                   56910002
494700             , :XLT00003-CSTM-CLOR-DESC                           56920002
494800             , :XLT00003-SIZE-DESC                                56930002
494900             , :XLT00003-NRF-CLOR-CDE                             56940002
495000             , :XLT00003-SKU-DESC                                 56950002
495100             , :PURITM-UNT-QTY                                    56960002
495200             , :PURITM-PREPK-RATO-QTY                             56970002
495300             , :POPRPK-OTPK-UNT-QTY                               56980002
495400             , :POPRPK-INPK-UNT-QTY                               56990002
495400             , :POPRPK-PREPK-TYP-CDE                              57000019
495500             , :SKXREF-DEPT                                       57010002
495600             , :SKXREF-CLASS                                      57020002
495700             , :SKXREF-SUBCLASS                                   57030002
495800             , :SKXREF-SKU                                        57040002
495900     END-EXEC.                                                    57050002
496000                                                                  57060002
496100     EVALUATE TRUE                                                57070002
496200         WHEN SQLCODE = ZERO                                      57080002
496300             SET PS-UPCS-ON-PREPACK TO TRUE                       57090002
496400             IF SKXREF-DEPT NUMERIC                               57100002
496500               IF SKXREF-DEPT > ZEROES                            57110002
496600                 MOVE SKXREF-DEPT       TO TR006-DEPT-NBR         57120002
496700               END-IF                                             57130002
496800             END-IF                                               57140002
496900                                                                  57150002
497000         WHEN SQLCODE = +100                                      57160002
497100              IF PS-UPCS-ON-PREPACK                               57170002
497200                  CONTINUE                                        57180002
497300              ELSE                                                57190002
497400                  INITIALIZE TR006-UPC-NBR                        57200002
497500                             TR006-ERROR-MSG                      57210002
497600                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         57220002
497700                  STRING 'CMN-NO DTL SKUS FOR PACK PO-FIX'        57230002
497800                      DELIMITED BY SIZE                           57240002
497900                      INTO TR006-ERROR-MSG                        57250002
498000                  MOVE IMCNUP-SKU-NBR   TO TR006-SKU              57260002
498100                  MOVE IMCNUP-UPC-NBR   TO TR006-UPC-NBR          57270002
498200                  PERFORM 8830-WRITE-ERROR-LINE                   57280002
498300                  SET PS-PROBLEM-DO-NOT-SEND      TO TRUE         57290002
498400              END-IF                                              57300002
498500                                                                  57310002
498600              SET PS-EOC-PREPACK-UPC-CURSOR TO TRUE               57320002
498700                                                                  57330002
498800         WHEN SQLWARN0 NOT EQUAL SPACE                            57340002
498900         WHEN SQLCODE NOT EQUAL ZERO                              57350002
499000             DISPLAY '** ABEND **'                                57360002
499100             DISPLAY '** PROGRAM = TRKUP007 **'                   57370002
499200             DISPLAY '** PARAGRAPH = 8460-FETCH-PACK-UPC-CURSOR'  57380002
499300             PERFORM 9100-SQL-ABEND                               57390002
499400     END-EVALUATE.                                                57400002
499500                                                                  57410002
499600 EJECT                                                            57420002
499700******************************************************************57430002
499800 8470-OPEN-E-COM-PACK-UPC-CUR.                                    57440002
499900                                                                  57450002
500000     EXEC SQL                                                     57460002
500100         OPEN E_COM_PACK_UPC_CUR                                  57470002
500200     END-EXEC.                                                    57480002
500300                                                                  57490002
500400     EVALUATE TRUE                                                57500002
500500         WHEN SQLWARN0 NOT EQUAL SPACE                            57510002
500600         WHEN SQLCODE NOT EQUAL ZERO                              57520002
500700            DISPLAY '** ABEND **'                                 57530002
500800            DISPLAY '** PROGRAM = TRKUP007 **'                    57540002
500900            DISPLAY '** PARAGRAPH = 8470-OPEN-E-COM-PACK-UPC-CUR' 57550002
501000            PERFORM 9100-SQL-ABEND                                57560002
501100     END-EVALUATE.                                                57570002
501200                                                                  57580002
501300******************************************************************57590002
501400 8472-FETCH-E-COM-PACK-UPC-CUR.                                   57600002
501500                                                                  57610002
501600     EXEC SQL                                                     57620002
501700          FETCH E_COM_PACK_UPC_CUR                                57630002
501800          INTO                                                    57640002
501900               :IMCNUP-UPC-NBR                                    57650002
502000              ,:PURITM-PO-LNE-NBR                                 57660002
502100     END-EXEC.                                                    57670002
502200                                                                  57680002
502300     EVALUATE TRUE                                                57690002
502400         WHEN SQLCODE = ZERO                                      57700002
502500             CONTINUE                                             57710002
502600                                                                  57720002
502700         WHEN SQLCODE = +100                                      57730002
502800              SET PS-EOC-E-COM-PACK-UPC-CUR  TO TRUE              57740002
502900                                                                  57750002
503000         WHEN SQLWARN0 NOT EQUAL SPACE                            57760002
503100         WHEN SQLCODE NOT EQUAL ZERO                              57770002
503200            DISPLAY '** ABEND **'                                 57780002
503300            DISPLAY '** PROGRAM = TRKUP007 **'                    57790002
503400            DISPLAY '** PARAGRAPH = 8472-FETCH-E-COM-PACK-UPC-CUR'57800002
503500            PERFORM 9100-SQL-ABEND                                57810002
503600     END-EVALUATE.                                                57820002
503700                                                                  57830002
503800******************************************************************57840002
503900 8474-CLOSE-E-COM-PACK-UPC-CUR.                                   57850002
504000                                                                  57860002
504100     EXEC SQL                                                     57870002
504200         CLOSE E_COM_PACK_UPC_CUR                                 57880002
504300     END-EXEC.                                                    57890002
504400                                                                  57900002
504500     EVALUATE TRUE                                                57910002
504600         WHEN SQLWARN0 NOT EQUAL SPACE                            57920002
504700         WHEN SQLCODE NOT EQUAL ZERO                              57930002
504800          DISPLAY '** ABEND **'                                   57940002
504900          DISPLAY '** PROGRAM = TRKUP007 **'                      57950002
505000          DISPLAY '** PARAGRAPH = 8470-CLOSE-E-COM-PACK-UPC-CUR'  57960002
505100            PERFORM 9100-SQL-ABEND                                57970002
505200     END-EVALUATE.                                                57980002
505300                                                                  57990002
505400 EJECT                                                            58000002
505500******************************************************************58010002
505600 8500-OPEN-DC-CURSOR.                                             58020002
505700                                                                  58030002
505800     EXEC SQL                                                     58040002
505900          OPEN DC_CUR                                             58050002
506000     END-EXEC.                                                    58060002
506100                                                                  58070002
506200     EVALUATE TRUE                                                58080002
506300         WHEN SQLWARN0 NOT EQUAL SPACE                            58090002
506400         WHEN SQLCODE NOT EQUAL ZERO                              58100002
506500             DISPLAY '** ABEND **'                                58110002
506600             DISPLAY '** PROGRAM = TRKUP007 **'                   58120002
506700             DISPLAY '** PARAGRAPH = 8500-OPEN-DC-CURSOR **'      58130002
506800             PERFORM 9100-SQL-ABEND                               58140002
506900     END-EVALUATE.                                                58150002
507000                                                                  58160002
507100******************************************************************58170002
507200 8600-CLOSE-DC-CURSOR.                                            58180002
507300                                                                  58190002
507400                                                                  58200002
507500     EXEC SQL                                                     58210002
507600         CLOSE DC_CUR                                             58220002
507700     END-EXEC.                                                    58230002
507800                                                                  58240002
507900     EVALUATE TRUE                                                58250002
508000         WHEN SQLWARN0 NOT EQUAL SPACE                            58260002
508100         WHEN SQLCODE NOT EQUAL ZERO                              58270002
508200             DISPLAY '** ABEND **'                                58280002
508300             DISPLAY '** PROGRAM = TRKUP007 **'                   58290002
508400             DISPLAY '** PARAGRAPH = 8600-CLOSE-DC-CURSOR**'      58300002
508500             PERFORM 9100-SQL-ABEND                               58310002
508600     END-EVALUATE.                                                58320002
508700                                                                  58330002
508800******************************************************************58340002
508900 8700-FETCH-DC-CURSOR.                                            58350002
509000                                                                  58360002
509100     EXEC SQL                                                     58370002
509200          FETCH DC_CUR                                            58380002
509300            INTO  :ALLPLN-DEST-NBR                                58390099
155029                , :PV-FAST-E-BUS-IND                              58400099
509500                , :ALLPLN-CURR-SPLIT-QTY                          58410002
509600     END-EXEC.                                                    58420002
509700                                                                  58430002
509800     EVALUATE TRUE                                                58440002
509900         WHEN SQLCODE = ZERO                                      58450002
155029             IF PS-NEW-UPC-YES                                    58460099
155029                SET PS-NEW-UPC-NO      TO TRUE                    58470099
155029                SET PS-FIRST-UPC-YES   TO TRUE                    58480099
155029             END-IF                                               58490099
510000             SET PS-DC-SPLIT-INFO-PRESENT TO TRUE                 58500002
510100                                                                  58510002
510200         WHEN SQLCODE = +100                                      58520002
510300              IF PS-DC-SPLIT-INFO-PRESENT                         58530002
510400                  CONTINUE                                        58540002
510500              ELSE                                                58550002
510600                  PERFORM 8710-MISSING-SPLIT-ERROR                58560002
510700              END-IF                                              58570002
510800                                                                  58580002
510900              SET PS-EOC-DC-CURSOR TO TRUE                        58590002
511000                                                                  58600002
511100         WHEN SQLWARN0 NOT EQUAL SPACE                            58610002
511200         WHEN SQLCODE NOT EQUAL ZERO                              58620002
511300             DISPLAY '** ABEND **'                                58630002
511400             DISPLAY '** PROGRAM = TRKUP007 **'                   58640002
511500             DISPLAY '** PARAGRAPH = 8700-FETCH-DC-CURSOR**'      58650002
511600             PERFORM 9100-SQL-ABEND                               58660002
511700     END-EVALUATE.                                                58670002
511800                                                                  58680002
511900******************************************************************58690002
512000 8710-MISSING-SPLIT-ERROR.                                        58700002
512100                                                                  58710002
512200     SET PS-SPLITS-ENTERED-NO  TO TRUE.                           58720002
512300     IF IMCNPO-PO-NBR = PV-HOLD-PO-NBR                            58730002
512400         CONTINUE                                                 58740002
512500     ELSE                                                         58750002
512600         MOVE IMCNPO-PO-NBR TO PV-HOLD-PO-NBR                     58760002
512700         SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE                 58770002
512800         INITIALIZE TR006-ERROR-MSG                               58780002
512900                    TR006-UPC-NBR                                 58790002
513000         STRING 'CMN-PO MISSING SPLIT-FIX'                        58800002
513100                      DELIMITED BY SIZE                           58810002
513200                      INTO TR006-ERROR-MSG                        58820002
513300         PERFORM 8830-WRITE-ERROR-LINE                            58830002
513400     END-IF.                                                      58840002
513500                                                                  58850002
513600 EJECT                                                            58860002
513700******************************************************************58870002
513800 8735-OPEN-PACK-CURSOR.                                           58880002
513900                                                                  58890002
514000     EXEC SQL                                                     58900002
514100          OPEN PREPACK_CUR                                        58910002
514200     END-EXEC.                                                    58920002
514300                                                                  58930002
514400     EVALUATE TRUE                                                58940002
514500         WHEN SQLWARN0 NOT EQUAL SPACE                            58950002
514600         WHEN SQLCODE NOT EQUAL ZERO                              58960002
514700            DISPLAY '** ABEND **'                                 58970002
514800            DISPLAY '** PROGRAM = TRKUP007 **'                    58980002
514900            DISPLAY '** PARAGRAPH = 8735-OPEN-PACK-CURSOR'        58990002
515000            PERFORM 9100-SQL-ABEND                                59000002
515100     END-EVALUATE.                                                59010002
515200                                                                  59020002
515300******************************************************************59030002
515400 8740-CLOSE-PACK-CURSOR.                                          59040002
515500                                                                  59050002
515600     EXEC SQL                                                     59060002
515700         CLOSE PREPACK_CUR                                        59070002
515800     END-EXEC.                                                    59080002
515900                                                                  59090002
516000     EVALUATE TRUE                                                59100002
516100         WHEN SQLWARN0 NOT EQUAL SPACE                            59110002
516200         WHEN SQLCODE NOT EQUAL ZERO                              59120002
516300           DISPLAY '** ABEND **'                                  59130002
516400           DISPLAY '** PROGRAM = TRKUP007 **'                     59140002
516500           DISPLAY '** PARAGRAPH =8740-CLOSE-PACK-CURSOR'         59150002
516600           PERFORM 9100-SQL-ABEND                                 59160002
516700     END-EVALUATE.                                                59170002
516800                                                                  59180002
516900******************************************************************59190002
517000 8745-FETCH-PACK-CURSOR.                                          59200002
517100                                                                  59210002
517200     EXEC SQL                                                     59220002
517300          FETCH PREPACK_CUR                                       59230002
517400          INTO                                                    59240002
517500               :POPRPK-PO-PREPK-ID                                59250002
517600             , :POPRPK-PREPK-UPC-NBR                              59260002
517700             , :POPRPK-PK-SKU-NBR                                 59270002
517800             , :POPRPK-INPK-UNT-QTY                               59280002
517900             , :POPRPK-OTPK-UNT-QTY                               59290002
517900             , :POPRPK-PREPK-TYP-CDE                              59300019
518000             , :IMCNUP-UPC-UNT-QTY                                59310002
518100             , :IMCNUP-UPC-CART-CNT                               59320002
518200             , :IMCNUP-SKU-NBR                                    59330002
518300             , :IMCNUP-ASN-PKGNG-CDE                              59340002
518400             , :IMCNUP-UPC-CBMT-QTY                               59350002
518500             , :IMCNUP-UPC-WT-KGRM-QTY                            59360002
518600     END-EXEC.                                                    59370002
518700                                                                  59380002
518800     EVALUATE TRUE                                                59390002
518900         WHEN SQLCODE = ZERO                                      59400002
519000             SET  PS-PREPACKS-FOR-PO TO TRUE                      59410099
155029             SET PS-NEW-UPC-YES      TO TRUE                      59420099
155029             MOVE SPACES             TO PV-HOLD-OUT-RECORD        59430099
519100                                                                  59440002
519200         WHEN SQLCODE = +100                                      59450002
519300             SET PS-EOC-PACK-CURSOR TO TRUE                       59460002
519400             IF  PS-PREPACKS-FOR-PO                               59470002
519500                CONTINUE                                          59480002
519600             ELSE                                                 59490002
519700                  INITIALIZE TR006-UPC-NBR                        59500002
519800                             TR006-ERROR-MSG                      59510002
519900                  SET TR006-ERROR-TYPE-ERROR      TO TRUE         59520002
520000                  STRING  'CMN-NO PACK UPCS FOR PACK PO-FIX'      59530002
520100                      DELIMITED BY SIZE                           59540002
520200                      INTO TR006-ERROR-MSG                        59550002
520300                  PERFORM 8830-WRITE-ERROR-LINE                   59560002
520400                  SET PS-PROBLEM-DO-NOT-SEND TO TRUE              59570002
520500             END-IF                                               59580002
520600                                                                  59590002
520700         WHEN SQLWARN0 NOT EQUAL SPACE                            59600002
520800         WHEN SQLCODE NOT EQUAL ZERO                              59610002
520900          DISPLAY '** ABEND **'                                   59620002
521000          DISPLAY '** PROGRAM = TRKUP007 **'                      59630002
521100          DISPLAY '** PARAGRAPH = 8745-FETCH-PACK-CURSOR'         59640002
521200          PERFORM 9100-SQL-ABEND                                  59650002
521300     END-EVALUATE.                                                59660002
521400                                                                  59670002
521500******************************************************************59680002
521600 8750-FETCH-SEAL-CURSOR.                                          59690002
521700                                                                  59700002
521800     EXEC SQL                                                     59710002
521900          FETCH SEAL_CURSOR                                       59720002
522000          INTO :TRT00006-SEAL-NBR                                 59730002
522100     END-EXEC.                                                    59740002
522200                                                                  59750002
522300     EVALUATE TRUE                                                59760002
522400         WHEN SQLCODE = ZERO                                      59770002
522500             CONTINUE                                             59780002
522600                                                                  59790002
522700         WHEN SQLCODE = +100                                      59800002
522800             SET PS-EOC-SEAL-CURSOR TO TRUE                       59810002
522900                                                                  59820002
523000         WHEN SQLWARN0 NOT EQUAL SPACE                            59830002
523100         WHEN SQLCODE NOT EQUAL ZERO                              59840002
523200          DISPLAY '** ABEND **'                                   59850002
523300          DISPLAY '** PROGRAM = TRKUP007 **'                      59860002
523400          DISPLAY '** PARAGRAPH = 8750-FETCH-SEAL-CURSOR'         59870002
523500          PERFORM 9100-SQL-ABEND                                  59880002
523600     END-EVALUATE.                                                59890002
523700                                                                  59900002
523800******************************************************************59910002
523900 8752-OPEN-SEAL-CURSOR.                                           59920002
524000                                                                  59930002
524100     EXEC SQL                                                     59940002
524200          OPEN SEAL_CURSOR                                        59950002
524300     END-EXEC.                                                    59960002
524400                                                                  59970002
524500     EVALUATE TRUE                                                59980002
524600         WHEN SQLWARN0 NOT EQUAL SPACE                            59990002
524700         WHEN SQLCODE NOT EQUAL ZERO                              60000002
524800            DISPLAY '** ABEND **'                                 60010002
524900            DISPLAY '** PROGRAM = TRKUP007 **'                    60020002
525000            DISPLAY '** PARAGRAPH = 8752-OPEN-SEAL-CURSOR'        60030002
525100            PERFORM 9100-SQL-ABEND                                60040002
525200     END-EVALUATE.                                                60050002
525300                                                                  60060002
525400******************************************************************60070002
525500 8754-CLOSE-SEAL-CURSOR.                                          60080002
525600                                                                  60090002
525700     EXEC SQL                                                     60100002
525800         CLOSE SEAL_CURSOR                                        60110002
525900     END-EXEC.                                                    60120002
526000                                                                  60130002
526100     EVALUATE TRUE                                                60140002
526200         WHEN SQLWARN0 NOT EQUAL SPACE                            60150002
526300         WHEN SQLCODE NOT EQUAL ZERO                              60160002
526400           DISPLAY '** ABEND **'                                  60170002
526500           DISPLAY '** PROGRAM = TRKUP007 **'                     60180002
526600           DISPLAY '** PARAGRAPH =8754-CLOSE-SEAL-CURSOR'         60190002
526700           PERFORM 9100-SQL-ABEND                                 60200002
526800     END-EVALUATE.                                                60210002
526900                                                                  60220002
527000******************************************************************60230002
527100 8756-FETCH-CART-LABEL-CURSOR.                                    60240002
527200                                                                  60250002
527300     EXEC SQL                                                     60260002
527400          FETCH CART_LABEL_CURSOR                                 60270002
527500          INTO :TRT00008-SSCC-ID                                  60280002
527600              ,:TRT00008-UNT-QTY                                  60290002
527700     END-EXEC.                                                    60300002
527800                                                                  60310002
527900     EVALUATE TRUE                                                60320002
528000         WHEN SQLCODE = ZERO                                      60330002
528100             CONTINUE                                             60340002
528200                                                                  60350002
528300         WHEN SQLCODE = +100                                      60360002
528400             SET PS-EOC-CART-LABEL-CURSOR  TO TRUE                60370002
528500                                                                  60380002
528600         WHEN SQLWARN0 NOT EQUAL SPACE                            60390002
528700         WHEN SQLCODE NOT EQUAL ZERO                              60400002
528800          DISPLAY '** ABEND **'                                   60410002
528900          DISPLAY '** PROGRAM = TRKUP007 **'                      60420002
529000          DISPLAY '** PARAGRAPH = 8756-FETCH-CART-LABEL-CURSOR'   60430002
529100          PERFORM 9100-SQL-ABEND                                  60440002
529200     END-EVALUATE.                                                60450002
529300                                                                  60460002
529400******************************************************************60470002
529500 8758-OPEN-CART-LABEL-CURSOR.                                     60480002
529600                                                                  60490002
529700     EXEC SQL                                                     60500002
529800          OPEN CART_LABEL_CURSOR                                  60510002
529900     END-EXEC.                                                    60520002
530000                                                                  60530002
530100     EVALUATE TRUE                                                60540002
530200         WHEN SQLWARN0 NOT EQUAL SPACE                            60550002
530300         WHEN SQLCODE NOT EQUAL ZERO                              60560002
530400            DISPLAY '** ABEND **'                                 60570002
530500            DISPLAY '** PROGRAM = TRKUP007 **'                    60580002
530600            DISPLAY '** PARAGRAPH = 8758-OPEN-CART-LABEL-CURSOR'  60590002
530700            PERFORM 9100-SQL-ABEND                                60600002
530800     END-EVALUATE.                                                60610002
530900                                                                  60620002
531000******************************************************************60630002
531100 8760-CLOSE-CART-LABEL-CURSOR.                                    60640002
531200                                                                  60650002
531300     EXEC SQL                                                     60660002
531400         CLOSE CART_LABEL_CURSOR                                  60670002
531500     END-EXEC.                                                    60680002
531600                                                                  60690002
531700     EVALUATE TRUE                                                60700002
531800         WHEN SQLWARN0 NOT EQUAL SPACE                            60710002
531900         WHEN SQLCODE NOT EQUAL ZERO                              60720002
532000           DISPLAY '** ABEND **'                                  60730002
532100           DISPLAY '** PROGRAM = TRKUP007 **'                     60740002
532200           DISPLAY '** PARAGRAPH = 8760-CLOSE-CART-LABEL-CURSOR'  60750002
532300           PERFORM 9100-SQL-ABEND                                 60760002
532400     END-EVALUATE.                                                60770002
532500                                                                  60780002
532600******************************************************************60790002
532700 8830-WRITE-ERROR-LINE.                                           60800002
532800                                                                  60810002
532900     SET  TR006-XMIT-RPT              TO TRUE.                    60820002
533000     MOVE IMCNTK-MOM-IMPRT-VEH-NM     TO TR006-VESSEL-NAME.       60830002
533100     MOVE IMCNTK-CONTNR-ID            TO TR006-CONTAINER-NUMBER.  60840002
533200     MOVE PV-CURRENT-TIME (6:2)       TO TR006-PROCESS-MM.        60850002
533300     MOVE PV-CURRENT-TIME (9:2)       TO TR006-PROCESS-DD.        60860002
533400     MOVE PV-CURRENT-TIME (1:4)       TO TR006-PROCESS-YYYY.      60870002
533500     MOVE PC-CURRENT-PROGRAM-NAME     TO TR006-PGM-NAME.          60880002
533600     MOVE IMCNTK-MOM-POE-DELY-TMST (1:4)                          60890002
533700                                TO TR006-ETA-DATE (1:4)           60900002
533800     MOVE IMCNTK-MOM-POE-DELY-TMST (6:2)                          60910002
533900                                TO TR006-ETA-DATE (5:2)           60920002
534000     MOVE IMCNTK-MOM-POE-DELY-TMST (9:2)                          60930002
534100                                TO TR006-ETA-DATE (7:2)           60940002
534200                                                                  60950002
534300     MOVE TR006-RECORD          TO OUTTR3-TRGL-ERR-RPT-ODR.       60960002
534400     ADD +1                     TO PA-ERROR-COUNT.                60970002
534500                                                                  60980002
534600     PERFORM 8840-INSERT-ERROR.                                   60990002
534700                                                                  61000002
534800                                                                  61010002
534900******************************************************************61020002
535000 8840-INSERT-ERROR.                                               61030002
535100                                                                  61040002
535200     EXEC SQL                                                     61050002
535300         INSERT INTO TOUTTR3                                      61060002
535400             (TRGL_ERR_RPT_ODR)                                   61070002
535500            VALUES  (:OUTTR3-TRGL-ERR-RPT-ODR)                    61080002
535600     END-EXEC                                                     61090002
535700                                                                  61100002
535800     EVALUATE TRUE                                                61110002
535900         WHEN SQLWARN0 NOT EQUAL SPACE                            61120002
536000         WHEN SQLCODE NOT EQUAL ZERO                              61130002
536100             DISPLAY '** ABEND **'                                61140002
536200             DISPLAY '** PROGRAM = TRKUP007 **'                   61150002
536300             DISPLAY '** PARAGRAPH = 8840-INSERT-ERROR**'         61160002
536400             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR3**'         61170002
536500             PERFORM 9100-SQL-ABEND                               61180002
536600     END-EVALUATE.                                                61190002
536700                                                                  61200002
536800 EJECT                                                            61210002
536900******************************************************************61220002
537000* WRITE PACK (PCK) RECORD TYPE FOR DETAIL REPORT RECORD.         *61230002
537100******************************************************************61240002
537200 8847-WRITE-DTL-RPT-PCK-RECORD.                                   61250002
537300                                                                  61260002
537400     MOVE '40PCK'                     TO TR020-REC-TYPE-CDE-PCK.  61270002
537500     SET  TR020-XMIT-RPT-PCK          TO TRUE.                    61280002
537600     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCK.        61290002
537700     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCK.  61300002
537800     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PCK.     61310002
537900     MOVE TR004-PACK-ID               TO TR020-PACK-ID-PCK.       61320002
538000     MOVE TR004-PACK-UNITS-PER-CTN    TO TR020-UNITS-PER-CTN-PCK. 61330002
538100     MOVE TR004-PACK-CART-CT          TO TR020-CART-CT-PCK.       61340002
538200     MOVE TR004-PACK-CBMT-QTY         TO TR020-CBMT-QTY-PCK.      61350002
538300     MOVE TR004-PACK-WT-KGRM-QTY      TO TR020-WT-KGRM-QTY-PCK.   61360002
538400     MOVE TR004-PACK-UNIT-QTY         TO TR020-UNIT-QTY-PCK.      61370002
538500     MOVE TR004-PACK-DESC             TO TR020-DESC-PCK.          61380002
538600     MOVE TR004-PACKS-PER-CART       TO TR020-PACKS-PER-CART-PCK. 61390002
538700     MOVE TR004-PACK-UPC-NBR          TO TR020-UPC-NBR-PCK        61400002
538800     MOVE IMCNUP-ASN-PKGNG-CDE        TO TR020-ASN-PKGNG-CDE-PCK. 61410002
538900     MOVE TR004-PACK-SKU              TO TR020-SKU-PCK.           61420002
539000     MOVE TR004-PCK-NO-LBL-CART-CT    TO TR020-NO-LBL-CART-CT-PCK.61430002
539100                                                                  61440002
539200     MOVE TR020-REC-TYPE-PCK      TO DCLTOUTTR4.                  61450002
539300                                                                  61460002
539400     PERFORM 8880-INSERT-DETAIL.                                  61470002
539500                                                                  61480002
539600******************************************************************61490002
539700* WRITE PACK DC (PDC) RECORD TYPE FOR DETAIL REPORT RECORD.      *61500002
539800******************************************************************61510002
539900 8848-WRITE-DTL-RPT-PDC-RECORD.                                   61520002
540000                                                                  61530002
540100     SET TR020-XMIT-RPT-PDC           TO TRUE.                    61540002
540200     MOVE '50PDC'                     TO TR020-REC-TYPE-CDE-PDC.  61550002
540300     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PDC.        61560002
540400     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PDC.  61570002
540500     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PDC.     61580002
540600     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-PDC.       61590002
540700     MOVE TR004-PDC-DIST-CNTR         TO TR020-DIST-CNTR-PDC.     61600002
540800     MOVE TR004-PDC-UNIT-QTY          TO TR020-UNIT-QTY-PDC.      61610002
540900     MOVE TR004-PDC-PERCNT            TO TR020-PERCNT-PDC.        61620002
541000     MOVE TR004-PDC-CART-CT           TO TR020-CART-CT-PDC.       61630002
541100     MOVE TR004-PDC-NO-LBL-CART-CT                                61640002
541200                               TO TR020-NO-LBL-CART-CT-PDC.       61650002
541300                                                                  61660002
541400     MOVE TR020-REC-TYPE-PDC       TO DCLTOUTTR4.                 61670002
541500                                                                  61680002
541600     PERFORM 8880-INSERT-DETAIL.                                  61690002
541700                                                                  61700002
541800******************************************************************61710002
541900* WRITE PURCHASE ORDER RECORD TYPE FOR DETAIL REPORT RECORD.     *61720002
542000******************************************************************61730002
542100 8850-WRITE-DTL-RPT-PO-RECORD.                                    61740002
542200                                                                  61750002
542300     MOVE '10PO '                     TO TR020-REC-TYPE-CDE-PO.   61760002
542400     SET  TR020-XMIT-RPT-PO           TO TRUE.                    61770002
542500     MOVE TR004-PO-NBR                TO TR020-PO-NBR-PO.         61780002
542600     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PO.   61790002
542700     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PO.      61800002
542800     MOVE TR004-VENDOR-NAME           TO TR020-VENDOR-NAME-PO.    61810002
542900     MOVE TR006-DONT-SHIP-BEFORE-DATE                             61820002
543000                               TO TR020-DO-NOT-SHIP-BEF-DTE-PO.   61830002
543100     MOVE TR004-CANCEL-DATE           TO TR020-CANCEL-DATE-PO.    61840002
543200     MOVE TR004-OPEN-TO-BUY-PERIOD                                61850002
543300                               TO TR020-OPEN-TO-BUY-PERIOD-PO.    61860002
543400     MOVE TR004-PKGNG-CDE             TO TR020-PKGNG-CDE-PO.      61870002
543500     MOVE TR004-AD-DATE               TO TR020-AD-DATE-PO.        61880002
543600     MOVE PC-CURRENT-PROGRAM-NAME     TO TR020-PGM-NAME.          61890002
543700                                                                  61900002
543800     MOVE TR020-REC-TYPE-PO        TO DCLTOUTTR4.                 61910002
543900     PERFORM 8880-INSERT-DETAIL.                                  61920002
544000                                                                  61930002
544100******************************************************************61940002
544200* WRITE INSTURCTIONS RECORD TYPE FOR DETAIL REPORT RECORD.       *61950002
544300******************************************************************61960002
544400 8852-WRITE-DTL-RPT-INS-RECORD.                                   61970002
544500                                                                  61980002
544600     MOVE '20INS'                     TO TR020-REC-TYPE-CDE-INS.  61990002
544700     SET TR020-XMIT-RPT-INS           TO TRUE.                    62000002
544800     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-INS.        62010002
544900     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-INS.  62020002
545000     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-INS.     62030002
545100     MOVE TR004-SPEC-INSTR            TO TR020-SPEC-INSTR-INS.    62040002
545200                                                                  62050002
545300     MOVE TR020-REC-TYPE-INS-1     TO OUTTR4-TRGL-DTL-RPT-1-ODR.  62060002
545400     MOVE TR020-REC-TYPE-INS-2     TO OUTTR4-TRGL-DTL-RPT-2-ODR.  62070002
545500                                                                  62080002
545600     PERFORM 8880-INSERT-DETAIL.                                  62090002
545700                                                                  62100002
545800******************************************************************62110002
545900* WRITE PURCHASE ORDER LINE RECORD TYPE FOR DETAIL REPORT RECORD.*62120002
546000******************************************************************62130002
546100 8854-WRITE-DTL-RPT-UPC-RECORD.                                   62140002
546200                                                                  62150002
546300     MOVE '60UPC'                     TO TR020-REC-TYPE-CDE-UPC.  62160002
546400     SET TR020-XMIT-RPT-UPC           TO TRUE.                    62170002
546500     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-UPC.        62180002
546600     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-UPC.  62190002
546700     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-UPC.     62200002
546800     MOVE TR020-PACK-ID-PCK           TO TR020-PACK-ID-UPC.       62210002
546900     MOVE TR004-VEND-STYL-NAME       TO TR020-VEND-STYL-NAME-UPC. 62220002
547000     MOVE TR004-UPC-COLOR-CDE         TO TR020-COLOR-CDE-UPC.     62230002
547100     MOVE TR004-UPC-SIZE-DESC         TO TR020-SIZE-DESC-UPC.     62240002
547200     MOVE TR004-UPC-NBR               TO TR020-UPC-NBR-UPC.       62250002
547300     MOVE TR004-UPC-COLOR-DESC        TO TR020-COLOR-DESC-UPC.    62260002
547400     MOVE TR004-SKU-DESC              TO TR020-SKU-DESC-UPC.      62270002
547500     MOVE TR004-DEPT-NBR              TO TR020-DEPT-NBR-UPC.      62280002
547600     MOVE TR004-CLASS                 TO TR020-CLASS-UPC.         62290002
547700     MOVE TR004-SUB-CLASS             TO TR020-SUB-CLASS-UPC.     62300002
547800     MOVE TR004-SKU-SEQ-NBR           TO TR020-SKU-UPC.           62310002
547900     MOVE TR004-OUTR-PK-QTY           TO TR020-OUTR-PK-QTY-UPC.   62320002
548000     MOVE TR004-PACK-RATIO-QTY        TO TR020-PACK-RATIO-QTY-UPC.62330002
548100     MOVE TR004-UPC-UNIT-QTY          TO TR020-UNIT-QTY-UPC.      62340002
548200     MOVE TR004-UPC-CBMT-QTY          TO TR020-CBMT-QTY-UPC.      62350002
548300     MOVE TR004-UPC-WT-KGRM-QTY       TO TR020-WT-KGRM-QTY-UPC.   62360002
548400     MOVE IMCNUP-ASN-PKGNG-CDE        TO TR020-ASN-PKGNG-CDE-UPC. 62370002
548500     MOVE TR004-UPC-NO-LBL-CART-CT    TO TR020-NO-LBL-CART-CT-UPC.62380002
548600                                                                  62390002
548700     MOVE TR020-REC-TYPE-UPC       TO DCLTOUTTR4.                 62400002
548800                                                                  62410002
548900     PERFORM 8880-INSERT-DETAIL.                                  62420002
549000                                                                  62430002
549100******************************************************************62440002
549200* WRITE CONTAINER/VESSEL RECORD TYPE FOR DETAIL REPORT RECORD.   *62450002
549300******************************************************************62460002
549400 8856-WRITE-DTL-RPT-CMN-RECORD.                                   62470002
549500                                                                  62480002
549600     SET TR020-REC-TYPE-CDE-CMN-CONTNR    TO TRUE.                62490002
549700     SET TR020-XMIT-RPT-CONTNR            TO TRUE.                62500002
549800     MOVE PV-HOLD-TR020-PROCESS-DATE                              62510002
549900                                   TO TR020-PROCESS-DATE-CONTNR.  62520002
550000     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-CONTNR.  62530002
550100     MOVE PV-HOLD-MOM-DEST-POE        TO TR020-POE-CDE-CONTNR.    62540002
550200     MOVE TR020-REC-TYPE-CONTNR       TO DCLTOUTTR4.              62550002
550300                                                                  62560002
550400     PERFORM 8880-INSERT-DETAIL.                                  62570002
550500                                                                  62580002
550600******************************************************************62590002
550700 8870-WRITE-DTL-RPT-DC-RECORD.                                    62600002
550800                                                                  62610002
550900     MOVE '70DC '                  TO TR020-REC-TYPE-CDE-DC.      62620002
551000     SET  TR020-XMIT-RPT-DC        TO TRUE.                       62630002
551100     MOVE PV-HOLD-TR020-PROCESS-DATE                              62640002
551200                                   TO TR020-PROCESS-DATE-DC.      62650002
551300     MOVE TR020-PO-NBR-UPC         TO TR020-PO-NBR-DC.            62660002
551400     MOVE TR020-CONTNR-ID-UPC      TO TR020-CONTNR-ID-DC.         62670002
551500     MOVE TR020-PACK-ID-UPC        TO TR020-PACK-ID-DC.           62680002
551600     MOVE TR020-VEND-STYL-NAME-UPC TO TR020-VEND-STYL-NAME-DC.    62690002
551700     MOVE TR020-COLOR-CDE-UPC      TO TR020-COLOR-CDE-DC.         62700002
551800     MOVE TR020-SIZE-DESC-UPC      TO TR020-SIZE-DESC-DC.         62710002
551900     MOVE TR004-DIST-CNTR          TO TR020-DIST-CNTR-DC.         62720002
552000****   FOR FUTURE USE ***                                         62730002
552100**** MOVE TR020-UPC-NBR-UPC        TO TR020-UPC-NBR-DC.           62740002
552200     MOVE TR004-DC-UNIT-QTY        TO TR020-UNIT-QTY-DC.          62750002
552300     MOVE TR004-DC-PERCNT          TO TR020-PERCNT-DC.            62760002
552400     MOVE TR004-DC-CART-CT         TO TR020-CART-CT-DC.           62770002
552500     MOVE TR004-DC-NO-LBL-CART-CT                                 62780002
552600                               TO TR020-NO-LBL-CART-CT-DC.        62790002
552700                                                                  62800002
552800                                                                  62810002
552900     MOVE TR020-REC-TYPE-DC        TO DCLTOUTTR4.                 62820002
553000                                                                  62830002
553100     PERFORM 8880-INSERT-DETAIL.                                  62840002
553200                                                                  62850002
553300******************************************************************62860002
553400 8872-WRITE-DTL-RPT-SEAL-RECORD.                                  62870002
553500                                                                  62880002
553600     MOVE '80SEA'          TO TR020-REC-TYPE-CDE-CONTNR-SEAL.     62890002
553700     SET  TR020-XMIT-RPT-SEAL      TO TRUE.                       62900002
553800     MOVE TRT00006-SEAL-NBR        TO TR020-CONTNR-SEAL.          62910002
553900     MOVE PV-HOLD-TR020-PROCESS-DATE                              62920002
554000                                 TO TR020-PROCESS-DATE-SEAL.      62930002
554100     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-SEAL.    62940002
554200     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-SEAL.       62950002
554300     MOVE 99999999               TO TR020-PACK-ID-SEAL.           62960002
554400     MOVE HIGH-VALUES            TO TR020-VEND-STYL-NAME-SEAL     62970002
554500                                    TR020-COLOR-CDE-SEAL          62980002
554600                                    TR020-SIZE-DESC-SEAL.         62990002
554700     MOVE TR020-REC-TYPE-CONTAINER-SEAL                           63000002
554800                           TO DCLTOUTTR4.                         63010002
554900     PERFORM 8880-INSERT-DETAIL.                                  63020002
555000                                                                  63030002
555100******************************************************************63040002
555200 8874-WRITE-DTL-RPT-PCT-REC.                                      63050002
555300                                                                  63060002
555400     MOVE '50PDC'             TO TR020-REC-TYPE-CDE-PCT.          63070002
555500     MOVE 1                   TO TR020-SEC-REC-TYP-PCT.           63080002
555600     SET  TR020-XMIT-RPT-PCT  TO TRUE.                            63090002
555700     MOVE TR004-PCT-SSCC-ID         TO TR020-SSCC-ID-PCT.         63100002
555800     MOVE TR004-PCT-CARTON-UNIT-QTY TO TR020-UNT-QTY-PCT.         63110002
555900     MOVE PV-HOLD-TR020-PO-NBR        TO TR020-PO-NBR-PCT.        63120002
556000     MOVE PV-HOLD-TR020-PROCESS-DATE  TO TR020-PROCESS-DATE-PCT.  63130002
556100     MOVE PV-HOLD-TR020-CONTNR-ID     TO TR020-CONTNR-ID-PCT.     63140002
556200     MOVE TR020-PACK-ID-PDC           TO TR020-PACK-ID-PCT.       63150002
556300     MOVE TR020-DIST-CNTR-PDC         TO TR020-DIST-CNTR-PCT.     63160002
556400     MOVE TR020-REC-TYPE-PACK-CART                                63170002
556500                           TO DCLTOUTTR4.                         63180002
556600     PERFORM 8880-INSERT-DETAIL.                                  63190002
556700                                                                  63200002
556800******************************************************************63210002
556900 8876-WRITE-DTL-RPT-DCT-REC.                                      63220002
557000                                                                  63230002
557100     MOVE '70DC '             TO TR020-REC-TYPE-CDE-DCT.          63240002
557200     MOVE 1                   TO TR020-SEC-REC-TYP-DCT.           63250002
557300     SET  TR020-XMIT-RPT-DCT  TO TRUE.                            63260002
557400     MOVE TR020-PROCESS-DATE-DC     TO TR020-PROCESS-DATE-DCT.    63270002
557500     MOVE TR020-PO-NBR-DC           TO TR020-PO-NBR-DCT.          63280002
557600     MOVE TR020-CONTNR-ID-DC        TO TR020-CONTNR-ID-DCT.       63290002
557700     MOVE TR020-PACK-ID-DC          TO TR020-PACK-ID-DCT.         63300002
557800     MOVE TR020-VEND-STYL-NAME-DC   TO TR020-VEND-STYL-NAME-DCT.  63310002
557900     MOVE TR020-COLOR-CDE-DC        TO TR020-COLOR-CDE-DCT.       63320002
558000     MOVE TR020-SIZE-DESC-DC        TO TR020-SIZE-DESC-DCT.       63330002
558100     MOVE TR020-DIST-CNTR-DC        TO TR020-DIST-CNTR-DCT.       63340002
558200     MOVE TR004-DCT-SSCC-ID         TO TR020-SSCC-ID-DCT.         63350002
558300     MOVE TR004-DCT-CARTON-UNIT-QTY TO TR020-UNT-QTY-DCT.         63360002
558400     MOVE TR020-REC-TYPE-DC-CARTON                                63370002
558500                           TO DCLTOUTTR4.                         63380002
558600     PERFORM 8880-INSERT-DETAIL.                                  63390002
558700                                                                  63400002
558800******************************************************************63410002
558900 8880-INSERT-DETAIL.                                              63420002
559000                                                                  63430002
559100     EXEC SQL                                                     63440002
559200         INSERT INTO TOUTTR4                                      63450002
559300             (TRGL_DTL_RPT_1_ODR                                  63460002
559400             ,TRGL_DTL_RPT_2_ODR)                                 63470002
559500            VALUES  (:OUTTR4-TRGL-DTL-RPT-1-ODR                   63480002
559600                    ,:OUTTR4-TRGL-DTL-RPT-2-ODR)                  63490002
559700     END-EXEC                                                     63500002
559800                                                                  63510002
559900     EVALUATE TRUE                                                63520002
560000         WHEN SQLWARN0 NOT EQUAL SPACE                            63530002
560100         WHEN SQLCODE NOT EQUAL ZERO                              63540002
560200             DISPLAY '** ABEND **'                                63550002
560300             DISPLAY '** PROGRAM = TRKUP007 **'                   63560002
560400             DISPLAY '** PARAGRAPH = 8880-INSERT-ERROR**'         63570002
560500             DISPLAY '**UNSUCCESSFUL INSERT TO TOUTTR4**'         63580002
560600             PERFORM 9100-SQL-ABEND                               63590002
560700     END-EVALUATE.                                                63600002
560800                                                                  63610002
560900     MOVE SPACES  TO OUTTR4-TRGL-DTL-RPT-1-ODR                    63620002
561000                     OUTTR4-TRGL-DTL-RPT-2-ODR.                   63630002
561100                                                                  63640002
561200 EJECT                                                            63650002
139868******************************************************************63660099
139868 8890-OUTLET-STORE-PREPACK.                                       63670099
139868                                                                  63680099
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     63690099
155029     PERFORM 7835-RETRIEVE-PLAN-NBR.                              63700099
155029                                                                  63710099
139868     PERFORM 8906-OPEN-PRPACK-DC-STR-CSR.                         63720099
139868                                                                  63730099
139868     PERFORM 8920-PROCESS-STORE-PRPK-CSR                          63740099
139868       UNTIL PS-EOC-STORE-CURSOR.                                 63750099
139868                                                                  63760099
139868     PERFORM 8911-CLOSE-PRPACK-DC-STR-CSR.                        63770099
139868                                                                  63780099
139868******************************************************************63790099
139868 8900-OUTLET-STORE-DC.                                            63800099
139868                                                                  63810099
139868     SET PS-EOC-STORE-CURSOR-NO      TO TRUE.                     63820099
155029     PERFORM 7830-RETRIEVE-PLAN-NBR.                              63830099
155029                                                                  63840099
139868     PERFORM 8905-OPEN-DC-STORE-CSR.                              63850099
139868                                                                  63860099
139868     PERFORM 8950-PROCESS-STORE-DC-CURSOR                         63870099
139868       UNTIL PS-EOC-STORE-CURSOR.                                 63880099
139868                                                                  63890099
139868     PERFORM 8910-CLOSE-DC-STORE-CSR.                             63900099
139868                                                                  63910099
139868******************************************************************63920099
139868 8905-OPEN-DC-STORE-CSR.                                          63930099
139868                                                                  63940099
139868     EXEC SQL                                                     63950099
139868          OPEN DC_OUT_CUR                                         63960099
139868     END-EXEC.                                                    63970099
139868                                                                  63980099
139868     EVALUATE TRUE                                                63990099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64000099
139868         WHEN SQLCODE NOT EQUAL ZERO                              64010099
139868             DISPLAY '** ABEND **'                                64020099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   64030099
139868             DISPLAY '** PARAGRAPH = 8905-OPEN-DC-STORE-CSR **'   64040099
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         64050099
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    64060099
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           64070099
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            64080099
155029             DISPLAY 'PLAN-NBR       = ' ALLPLN-PLAN-NBR          64090099
139868             PERFORM 9100-SQL-ABEND                               64100099
139868     END-EVALUATE.                                                64110099
139868                                                                  64120099
139868******************************************************************64130099
139868 8906-OPEN-PRPACK-DC-STR-CSR.                                     64140099
139868                                                                  64150099
139868     EXEC SQL                                                     64160099
139868          OPEN PRPACK_DC_OUT_CUR                                  64170099
139868     END-EXEC.                                                    64180099
139868                                                                  64190099
139868     EVALUATE TRUE                                                64200099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64210099
139868         WHEN SQLCODE NOT EQUAL ZERO                              64220099
139868             DISPLAY '** ABEND **'                                64230099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   64240099
139868             DISPLAY '** PARAGRAPH = '                            64250099
139868                     '8906-OPEN-PRPACK-DC-STR-CSR **'             64260099
139868             DISPLAY '** PO-NBR      = ' IMCNPO-PO-NBR            64270099
139868             DISPLAY '** PO-PREPK-ID = ' POPRPK-PO-PREPK-ID       64280099
639300             DISPLAY '** PLAN-NBR    = ' ALLPLN-PLAN-NBR          64290099
139868             PERFORM 9100-SQL-ABEND                               64300099
139868     END-EVALUATE.                                                64310099
139868                                                                  64320099
139868******************************************************************64330099
139868 8910-CLOSE-DC-STORE-CSR.                                         64340099
139868                                                                  64350099
139868     EXEC SQL                                                     64360099
139868         CLOSE DC_OUT_CUR                                         64370099
139868     END-EXEC.                                                    64380099
139868                                                                  64390099
139868     EVALUATE TRUE                                                64400099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64410099
139868         WHEN SQLCODE NOT EQUAL ZERO                              64420099
139868             DISPLAY '** ABEND **'                                64430099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   64440099
139868             DISPLAY '** PARAGRAPH = 8910-CLOSE-DC-STORE-CSR**'   64450099
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         64460099
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    64470099
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           64480099
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            64490099
155029             DISPLAY 'PLAN-NBR       = ' ALLPLN-PLAN-NBR          64500099
139868             PERFORM 9100-SQL-ABEND                               64510099
139868     END-EVALUATE.                                                64520099
139868                                                                  64530099
139868******************************************************************64540099
139868 8911-CLOSE-PRPACK-DC-STR-CSR.                                    64550099
139868                                                                  64560099
139868     EXEC SQL                                                     64570099
139868         CLOSE PRPACK_DC_OUT_CUR                                  64580099
139868     END-EXEC.                                                    64590099
139868                                                                  64600099
139868     EVALUATE TRUE                                                64610099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            64620099
139868         WHEN SQLCODE NOT EQUAL ZERO                              64630099
139868             DISPLAY '** ABEND **'                                64640099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   64650099
139868             DISPLAY '** PARAGRAPH = 8911-CLOSE-PRPACK-DC-STR-CSR'64660099
139868             PERFORM 9100-SQL-ABEND                               64670099
139868     END-EVALUATE.                                                64680099
139868                                                                  64690099
139868******************************************************************64700099
139868 8915-FETCH-DC-STORE-CSR.                                         64710099
139868                                                                  64720099
139868     EXEC SQL                                                     64730099
139868          FETCH DC_OUT_CUR                                        64740099
139868           INTO :MESTDS-STR-NBR                                   64750099
139868               ,:MESTDS-STR-DISTRO-QTY                            64760099
139868     END-EXEC.                                                    64770099
139868                                                                  64780099
139868     EVALUATE TRUE                                                64790099
139868         WHEN SQLCODE = ZERO                                      64800099
139868             CONTINUE                                             64810099
139868                                                                  64820099
139868         WHEN SQLCODE = +100                                      64830099
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    64840099
139868             IF PS-FIRST-STORE                                    64850099
139868                SET PS-EOC-DC-CURSOR                              64860099
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          64870099
139868                PERFORM 8600-CLOSE-DC-CURSOR                      64880099
139868                INITIALIZE TR006-UPC-NBR                          64890099
139868                           TR006-ERROR-MSG                        64900099
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          64910099
139868                STRING 'CMN-BULK MISSING SPLT-FIX/OUTLET'         64920099
139868                    DELIMITED BY SIZE                             64930099
139868                     INTO TR006-ERROR-MSG                         64940099
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               64950099
139868                PERFORM 8830-WRITE-ERROR-LINE                     64960099
139868                SET PS-SPLITS-ENTERED-NO      TO TRUE             64970099
139868             END-IF                                               64980099
139868                                                                  64990099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65000099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65010099
139868             DISPLAY '** ABEND **'                                65020099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   65030099
139868             DISPLAY '** PARAGRAPH = 8915-FETCH-DC-STORE-CSR**'   65040099
139868             DISPLAY 'CONTNR-ID      = ' IMCNTK-CONTNR-ID         65050099
139868             DISPLAY 'CONTNR-SEQ-NBR = ' IMCNTK-CONTNR-SEQ-NBR    65060099
139868             DISPLAY 'UPC-NBR        = ' IMCNUP-UPC-NBR           65070099
139868             DISPLAY 'PO-NBR         = ' IMCNPO-PO-NBR            65080099
647400             DISPLAY 'PLAN-NBR       = ' ALLPLN-PLAN-NBR          65090099
139868             PERFORM 9100-SQL-ABEND                               65100099
139868     END-EVALUATE.                                                65110099
139868                                                                  65120099
139868******************************************************************65130099
139868 8916-FETCH-PRPACK-DC-STR-CSR.                                    65140099
139868                                                                  65150099
139868     EXEC SQL                                                     65160099
139868          FETCH PRPACK_DC_OUT_CUR                                 65170099
139868           INTO :MESTDS-STR-NBR                                   65180099
139868               ,:MESTDS-STR-DISTRO-QTY                            65190099
139868     END-EXEC.                                                    65200099
139868                                                                  65210099
139868     EVALUATE TRUE                                                65220099
139868         WHEN SQLCODE = ZERO                                      65230099
139868             CONTINUE                                             65240099
139868                                                                  65250099
139868         WHEN SQLCODE = +100                                      65260099
139868             SET PS-EOC-STORE-CURSOR   TO TRUE                    65270099
139868             IF PS-FIRST-STORE                                    65280099
139868                SET PS-EOC-PREPACK-DC-CURSOR                      65290099
139868                    PS-DC-SPLIT-INFO-PRESENT-NO  TO TRUE          65300099
139868                PERFORM 8425-CLOSE-PACK-DC-CURSOR                 65310099
139868                INITIALIZE TR006-UPC-NBR                          65320099
139868                           TR006-ERROR-MSG                        65330099
139868                SET TR006-ERROR-TYPE-MISS-SPLT   TO TRUE          65340099
139868                STRING 'CMN-PACK MISSING SPLT-FIX/OUTLET'         65350099
139868                    DELIMITED BY SIZE                             65360099
139868                     INTO TR006-ERROR-MSG                         65370099
139868                MOVE IMCNUP-SKU-NBR   TO  TR006-SKU               65380099
139868                PERFORM 8830-WRITE-ERROR-LINE                     65390099
139868                SET PS-SPLITS-ENTERED-NO      TO TRUE             65400099
139868             END-IF                                               65410099
139868                                                                  65420099
139868         WHEN SQLWARN0 NOT EQUAL SPACE                            65430099
139868         WHEN SQLCODE NOT EQUAL ZERO                              65440099
139868             DISPLAY '** ABEND **'                                65450099
139868             DISPLAY '** PROGRAM = TRKUP007 **'                   65460099
139868             DISPLAY '** PARAGRAPH = 8916-FETCH-PRPACK-DC-STR-CSR'65470099
139868             DISPLAY '** PO-NBR      = ' IMCNPO-PO-NBR            65480099
155029             DISPLAY '** PLAN-NBR    = ' ALLPLN-PLAN-NBR          65490099
139868             DISPLAY '** PO-PREPK-ID = ' POPRPK-PO-PREPK-ID       65500099
139868             PERFORM 9100-SQL-ABEND                               65510099
139868     END-EVALUATE.                                                65520099
139868                                                                  65530099
139868******************************************************************65540099
139868 8920-PROCESS-STORE-PRPK-CSR.                                     65550099
139868                                                                  65560099
139868     PERFORM 8916-FETCH-PRPACK-DC-STR-CSR.                        65570099
139868                                                                  65580099
139868     IF PS-EOC-STORE-CURSOR                                       65590099
139868        IF PS-DC-SPLIT-INFO-PRESENT                               65600099
155029           SET PS-OUTLET-STORE-NO TO TRUE                         65610099
139868           PERFORM 2382-ADJUST-ROUNDED-OUT-DIST                   65620099
139868           PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                   65630099
139868           IF PV-NBR-CART-LBLS-UPC > 0                            65640099
139868**          PRINT THE REMAINDER OF THE CARTON LABELS              65650099
155029***GB         MOVE 10               TO PV-NBR-CART-LBLS-THIS-DC   65660099
139868              PERFORM 2394-CREATE-PCT-CARTON-LABELS               65670099
139868           END-IF                                                 65680099
139868        END-IF                                                    65690099
139868     ELSE                                                         65700099
139868        IF PS-FIRST-STORE                                         65710099
139868           SET PS-FIRST-STORE-NO      TO TRUE                     65720099
155029           SET PS-FIRST-DC-NO         TO TRUE                     65730099
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          65740099
139868                      PV-TTL-ALL-DCS-UNITS                        65750099
139868                      PV-TTL-ALL-DCS-CARTS                        65760099
139868                                                                  65770099
139868        ELSE                                                      65780099
139868*         **********************************************          65790099
139868*         * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *          65800099
139868*         * EXTRACT & REPORT RECS FROM THE PRIOR STORE *          65810099
139868*         **********************************************          65820099
139868           PERFORM 5760-WRITE-PUR-ORDER-PDC-REC                   65830099
139868           IF PV-NBR-CART-LBLS-UPC > 0                            65840099
139868              PERFORM 2394-CREATE-PCT-CARTON-LABELS               65850099
139868           END-IF                                                 65860099
139868        END-IF                                                    65870099
139868                                                                  65880099
139868        INITIALIZE TR004-REC-TYPE-PDC                             65890099
139868        MOVE MESTDS-STR-NBR         TO TR004-PDC-DIST-CNTR        65900099
139868        MOVE MESTDS-STR-DISTRO-QTY  TO TR004-PDC-UNIT-QTY         65910099
139868                                                                  65920099
155029        IF PV-FAST-E-BUS-IND = 'Y'                                65930099
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         65940099
155029             INTO MESTDS-STR-DISTRO-QTY                           65950099
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   65960099
155029        ELSE                                                      65970099
140332           DIVIDE PV-HOLD-PCK-UNIT-QTY                            65980099
140332             INTO MESTDS-STR-DISTRO-QTY                           65990099
140332               GIVING PV-QUOTIENT-ORDER-PERCENT                   66000099
155029        END-IF                                                    66010099
140332        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     66020099
140332            100 GIVING TR004-PDC-PERCNT ROUNDED                   66030099
139868                                                                  66040099
139868        IF TR004-PDC-PERCNT = ZERO                                66050099
139868           MOVE +1 TO TR004-PDC-PERCNT                            66060099
139868        END-IF                                                    66070099
139868        ADD TR004-PDC-PERCNT        TO PV-TTL-ALL-DCS-PCT         66080099
139868                                                                  66090099
139868        DIVIDE PV-HOLD-PCK-UNIT-PER-CTN                           66100099
139868          INTO MESTDS-STR-DISTRO-QTY                              66110099
139868             GIVING TR004-PDC-CART-CT ROUNDED                     66120099
139868                                                                  66130099
155029        ADD  TR004-PDC-UNIT-QTY   TO PV-TTL-ALL-DCS-UNITS         66140099
155029        ADD  TR004-PDC-CART-CT    TO PV-TTL-ALL-DCS-CARTS         66150099
139868        MOVE TR004-PDC-CART-CT    TO PV-NBR-CART-LBLS-THIS-DC     66160099
139868                                                                  66170099
139868     END-IF.                                                      66180099
139868                                                                  66190099
139868******************************************************************66200099
139868 8950-PROCESS-STORE-DC-CURSOR.                                    66210099
139868                                                                  66220099
139868     PERFORM 8915-FETCH-DC-STORE-CSR.                             66230099
139868                                                                  66240099
139868     IF PS-EOC-STORE-CURSOR                                       66250099
139868        IF PS-DC-SPLIT-INFO-PRESENT                               66260099
155029           SET PS-OUTLET-STORE-NO TO TRUE                         66270099
139868           PERFORM 2550-ADJUST-ROUNDED-OUT-DIST                   66280099
139868           PERFORM 5700-WRITE-DC-RECORD                           66290099
139868           IF PV-NBR-CART-LBLS-UPC > 0                            66300099
139868**          PRINT THE REMAINDER OF THE CARTON LABELS              66310099
155029***GB        MOVE 10                  TO PV-NBR-CART-LBLS-THIS-DC 66320099
139868             PERFORM 2720-CREATE-DC-CARTON-LABELS                 66330099
139868           END-IF                                                 66340099
139868        END-IF                                                    66350099
139868     ELSE                                                         66360099
139868        IF PS-FIRST-STORE                                         66370099
139868           SET PS-FIRST-STORE-NO      TO TRUE                     66380099
155029           SET PS-FIRST-DC-NO         TO TRUE                     66390099
139868           INITIALIZE PV-TTL-ALL-DCS-PCT                          66400099
139868                      PV-TTL-ALL-DCS-UNITS                        66410099
139868                      PV-TTL-ALL-DCS-CARTS                        66420099
139868                                                                  66430099
139868        ELSE                                                      66440099
139868*         **********************************************          66450099
139868*         * IF NOT EOC OR FIRST STORE, WRITE THE DTL   *          66460099
139868*         * EXTRACT & REPORT RECS FROM THE PRIOR STORE *          66470099
139868*         **********************************************          66480099
139868           PERFORM 5700-WRITE-DC-RECORD                           66490099
139868           IF PV-NBR-CART-LBLS-UPC > 0                            66500099
155029           AND PS-BYPASS-CRTN-WRITE-NO                            66510099
139868              PERFORM 2720-CREATE-DC-CARTON-LABELS                66520099
139868           END-IF                                                 66530099
139868        END-IF                                                    66540099
139868        INITIALIZE TR004-REC-TYPE-DC                              66550099
139868        MOVE MESTDS-STR-NBR         TO TR004-DIST-CNTR            66560099
139868        MOVE MESTDS-STR-DISTRO-QTY  TO TR004-DC-UNIT-QTY          66570099
139868                                                                  66580099
155029        IF PV-FAST-E-BUS-IND = 'Y'                                66590099
155029           DIVIDE PA-TOTAL-CURR-SPLIT-QTY                         66600099
155029             INTO MESTDS-STR-DISTRO-QTY                           66610099
155029               GIVING PV-QUOTIENT-ORDER-PERCENT                   66620099
155029        ELSE                                                      66630099
139868           DIVIDE PV-HOLD-PCK-UNIT-QTY                            66640099
139868             INTO MESTDS-STR-DISTRO-QTY                           66650099
139868               GIVING PV-QUOTIENT-ORDER-PERCENT                   66660099
155029        END-IF                                                    66670099
155029                                                                  66680099
139868        MULTIPLY PV-QUOTIENT-ORDER-PERCENT BY                     66690099
139868            100 GIVING TR004-DC-PERCNT ROUNDED                    66700099
139868                                                                  66710099
139868        IF TR004-DC-PERCNT = ZERO                                 66720099
139868           MOVE +1 TO TR004-DC-PERCNT                             66730099
139868        END-IF                                                    66740099
139868        ADD TR004-DC-PERCNT   TO PV-TTL-ALL-DCS-PCT               66750099
139868                                                                  66760099
139868        DIVIDE PV-HOLD-PCK-CART-CT                                66770099
139868          INTO MESTDS-STR-DISTRO-QTY                              66780099
139868             GIVING TR004-DC-CART-CT ROUNDED                      66790099
139868                                                                  66800099
139868        MOVE TR004-DC-CART-CT    TO PV-NBR-CART-LBLS-THIS-DC      66810099
155029        ADD  TR004-DC-UNIT-QTY   TO PV-TTL-ALL-DCS-UNITS          66820099
155029        ADD  TR004-DC-CART-CT    TO PV-TTL-ALL-DCS-CARTS          66830099
139868                                                                  66840099
139868     END-IF.                                                      66850099
139868                                                                  66860099
561300******************************************************************66870002
561400* END OF JOB ROUTINE.                                             66880002
561500******************************************************************66890002
561600 9000-EOJ-ROUTINE.                                                66900002
561700                                                                  66910002
561800     IF PS-NEED-SEALS                                             66920002
561900        PERFORM 8752-OPEN-SEAL-CURSOR                             66930002
562000        SET PS-EOC-SEAL-CURSOR-NO TO TRUE                         66940002
562100        PERFORM 2900-SEAL-CURSOR-FOR-XMIT                         66950002
562200          UNTIL PS-EOC-SEAL-CURSOR                                66960002
562300        PERFORM 8754-CLOSE-SEAL-CURSOR                            66970002
562400     END-IF.                                                      66980002
562500                                                                  66990002
562600     IF PA-TOTAL-OUTPUT-REC-COUNT = ZERO                          67000002
562700         CONTINUE                                                 67010002
562800     ELSE                                                         67020002
562900         INITIALIZE TR004-REC-TYPE-CTT                            67030002
563000         MOVE PA-TOTAL-OUTPUT-REC-COUNT TO                        67040002
563100             TR004-HASH-TOTALS                                    67050002
563200         PERFORM 5800-WRITE-PUR-ORDER-CTT-REC                     67060002
563300         ADD +1 TO PA-TOTAL-OUTPUT-REC-COUNT                      67070002
563400     END-IF.                                                      67080002
563500                                                                  67090002
563600     DISPLAY 'PA-TOTAL-OUTPUT-REC-COUNT = '                       67100002
563700         PA-TOTAL-OUTPUT-REC-COUNT.                               67110002
563800     DISPLAY 'PA-ERROR-COUNT = ' PA-ERROR-COUNT.                  67120002
563900                                                                  67130002
564000     PERFORM 7010-CLOSE-DRIVER-CURSOR.                            67140002
564100                                                                  67150002
564200     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              67160002
564300     PERFORM 6570-UPDATE-TCKRSTCNTL.                              67170002
564400                                                                  67180002
564500******************************************************************67190002
564600* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      67200002
564700* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 67210002
564800******************************************************************67220002
564900 9100-SQL-ABEND.                                                  67230002
565000******************************************************************67240002
565100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    67250002
565200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         67260002
565300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     67270002
565400* FORMAT.                                                         67280002
565500******************************************************************67290002
565600     COPY DPPD004.                                                67300002
565700                                                                  67310002
565800     MOVE +4013 TO ABEND-CODE.                                    67320002
565900     CALL 'ILBOABN0' USING ABEND-CODE.                            67330002
