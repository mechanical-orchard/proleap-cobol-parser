000100*-----------------------*                                         00010019
000200 IDENTIFICATION DIVISION.                                         00020019
000300*-----------------------*                                         00030019
000400 PROGRAM-ID.    RCKCS229.                                         00040019
000500 AUTHOR.        JOHN GREFFER (STRATAGEM).                         00050019
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060019
000700 DATE-WRITTEN.  03-19-93.                                         00070019
000800 DATE-COMPILED.                                                   00080019
000900*----------------------------------------------------------------*00090019
001000*    E229 - RECEIVING CRITERIA SPECIFICATION                     *00100019
001100*                                                                *00110019
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120019
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130019
001400*    DETAIL SCREEN.  WHEN ENTERED, THE RECEIVER SEQUENCE AND PO  *00140019
001500*    NUMBER ARE EDITTED TO BE VALID NUMERIC.  ALL OTHER EDITS    *00150019
001600*    ARE DONE IN THE DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE  *00160019
001700*    FUNCTION IS USED.                                           *00170019
001800*----------------------------------------------------------------*00180019
001810* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00181027
001820* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00182028
001830* MAKING THE CALL DYNAMIC VS STATIC.                              00183028
001840*---------------------------------------------------------------* 00184028
001900                                                                  00190019
002000 ENVIRONMENT DIVISION.                                            00200019
002100                                                                  00210019
002200 DATA DIVISION.                                                   00220019
002300                                                                  00230019
002400/                                                                 00240019
002500 WORKING-STORAGE SECTION.                                         00250019
002700 01  DK-DB2-KEYS.                                                 00270021
002800*    05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00280019
002900*    05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00290019
002910     05  DK-PO-NBR                 PIC S9(09) COMP VALUE +0.      00291021
003000                                                                  00300019
003100 01  PC-PROGRAM-CONSTANTS.                                        00310019
003200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RC229A  '. 00320019
003300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RCKM229 '. 00330019
003400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RCKCS229'. 00340019
003500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00350019
003600                                               COMP-3.            00360019
003700     05  PC-TSYMSG-NUMBERS.                                       00370019
003800         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00380019
003900         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00390019
004000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00400019
004100         10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      00410019
004200         10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      00420019
004300         10  PC-TSYMSG-00308       PIC  9(05)  VALUE  00308.      00430019
004400         10  PC-TSYMSG-00316       PIC  9(05)  VALUE  00316.      00440019
004500                                                                  00450019
004600 01  PS-PROGRAM-SWITCHES.                                         00460019
004700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00470019
004800         88  PS-ERROR                          VALUE  'Y'.        00480019
004900         88  PS-NO-ERROR                       VALUE  'N'.        00490019
005000                                                                  00500019
005100 01  PV-PROGRAM-VARIABLES.                                        00510019
005200     05  PV-RETRY-COUNTER            PIC S9(04)  VALUE +0         00520019
005300                                                 COMP SYNC.       00530019
005400     05  PV-DB2-COUNT                PIC S9(09) COMP-3.           00540019
005500     05  PV-DB2-DATE                 PIC  X(10).                  00550019
005600                                                                  00560019
005700*----------------------------------------------------------------*00570019
005800*    MAP LAYOUT                                                  *00580019
005900*----------------------------------------------------------------*00590019
006000                                                                  00600019
006100     COPY RCKM229.                                                00610019
006200                                                                  00620019
006300/                                                                 00630019
006400*----------------------------------------------------------------*00640019
006500*    COPYBOOK FOR LOGISTICS DOMAIN LOCATION MODULE (XLKUT071)    *00650019
006600*----------------------------------------------------------------*00660019
006700     COPY XLWS071.                                                00670019
006800                                                                  00680019
006900/                                                                 00690019
007000*----------------------------------------------------------------*00700019
007100*    ATTRIBUTE SETTINGS COPYBOOK.                                *00710019
007200*----------------------------------------------------------------*00720019
007300     COPY DPWS015.                                                00730019
007400                                                                  00740019
007500/                                                                 00750019
007600*----------------------------------------------------------------*00760019
007700*    FUNCTION KEYS COPYBOOK                                      *00770019
007800*----------------------------------------------------------------*00780019
007900     COPY DPWS016.                                                00790019
008000                                                                  00800019
008100/                                                                 00810019
008200******************************************************************00820019
008300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00830019
008400** SUB-ROUTINE (DPKUT100).                                      **00840019
008500******************************************************************00850019
008600     COPY DPWS010I.                                               00860019
008700                                                                  00870019
008800/                                                                 00880019
008900******************************************************************00890019
009000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **00900028
009100** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **00910019
009200******************************************************************00920019
009300     COPY DPWS030.                                                00930019
009310     COPY DPWS930.                                                00931028
009400                                                                  00940019
009500/                                                                 00950019
009600***************************************************************** 00960019
009700*    STANDARD COMMAREA.                                           00970019
009800***************************************************************** 00980019
009900     COPY DPWS020.                                                00990019
010000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01000019
010100                                                                  01010019
010200***************************************************************** 01020019
010300*    INTER-APPLICATION COMMAREA.                                  01030019
010400***************************************************************** 01040019
010500                                                                  01050019
010600         10  INTER-APPL-COMM-AREA PIC X(200).                     01060019
010700     COPY RCWS012.                                                01070019
010800***************************************************************** 01080019
010900*    SPECIFIC COMMMAREA FOR RCKCS229.                             01090019
011000***************************************************************** 01100019
011100         10  ASC-SPECIFIC-COMMAREA.                               01110019
011200             15  ASC-OPER-UNT-ID             PIC X(04).           01120019
011300             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      01130019
011400                                             PIC 9(04).           01140019
011500             15  ASC-FCLTY-NME               PIC X(25).           01150019
011600             15  ASC-FCLTY-ID                PIC X(04).           01160019
011700             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            01170019
011800                                             PIC 9(04).           01180019
011900* CHG0094517 CHANGED PO-NBR LENGTH FROM 7 TO 8                    01190019
012000             15  ASC-PO-NBR                  PIC  X(08).          01200019
012100             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                01210019
012200                                             PIC  9(08).          01220019
012300             15  ASC-REC-SEQ-NBR             PIC  X(04).          01230019
012400             15  ASC-REC-SEQ-NBR-N REDEFINES ASC-REC-SEQ-NBR      01240019
012500                                             PIC  9(04).          01250019
012510             15  ASC-SEASET-YR               PIC  X(04).          01251020
012520             15  ASC-SEASET-SHRT-NM          PIC  X(05).          01252020
012530             15  ASC-SEASET-NM               PIC  X(25).          01253020
012540             15  ASC-SEASET-DISP             PIC  X(15).          01254020
012700/                                                                 01270019
012800*----------------------------------------------------------------*01280019
012900*    ABEND PROCESSING COPYBOOK.                                  *01290019
013000*----------------------------------------------------------------*01300019
013100                                                                  01310019
013200     COPY DPWS013.                                                01320019
013300                                                                  01330019
013400/                                                                 01340019
013410*----------------------------------------------------------------*01341022
013420*    TPURCHS - PURCHASE ORDER                                    *01342022
013430*----------------------------------------------------------------*01343022
013431     EXEC SQL                                                     01343122
013440          INCLUDE TPURCHS                                         01344023
013441     END-EXEC.                                                    01344122
013450                                                                  01345022
013460*----------------------------------------------------------------*01346022
013470*    TSEASET - SEASONAL SET                                      *01347022
013480*----------------------------------------------------------------*01348022
013481     EXEC SQL                                                     01348122
013490          INCLUDE TSEASET                                         01349023
013491     END-EXEC.                                                    01349122
013492                                                                  01349222
013500*                                                                 01350019
013600*  COMMUNICATION AREAS FOR DB2                                    01360019
013700*                                                                 01370019
013800     EXEC SQL                                                     01380019
013900         INCLUDE SQLCA                                            01390019
014000     END-EXEC.                                                    01400019
014100                                                                  01410019
014200/                                                                 01420019
014300 LINKAGE SECTION.                                                 01430019
014400                                                                  01440019
014500 01  DFHCOMMAREA.                                                 01450019
014600     05  FILLER                         OCCURS  1 TO 4072 TIMES   01460019
014700                                        DEPENDING ON EIBCALEN.    01470019
014800         10  FILLER                     PIC X.                    01480019
014900                                                                  01490019
015000                                                                  01500019
015100 PROCEDURE DIVISION.                                              01510019
015200***************************************************************** 01520019
015300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01530019
015400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01540019
015500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01550019
015600**                                                             ** 01560019
015700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01570019
015800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01580019
015900***************************************************************** 01590019
016000 0000-MAIN-MODULE.                                                01600019
016100     INITIALIZE DP030-CICS-API-FIELDS.                            01610019
016200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01620019
016300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01630019
016400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01640019
016500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01650019
016600     MOVE LENGTH OF RC229AI        TO DP030-MAP-LENGTH (1).       01660019
016700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01670019
016800     PERFORM 0001-CALL-CICS-ARCH-API.                             01680019
016900*                                                                 01690019
017000     PERFORM 1000-CONTROL-PROCESSING                              01700019
017100*                                                                 01710019
017200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01720019
017300     PERFORM 0001-CALL-CICS-ARCH-API.                             01730019
017400                                                                  01740019
017500 0001-CALL-CICS-ARCH-API.                                         01750019
017610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01761028
017700                                    DFHCOMMAREA                   01770028
017800                                    DP030-CICS-API-FIELDS         01780028
017900                                    DP020-STANDARD-COMMAREA       01790028
018000                                    RC229AI.                      01800028
018100*                                                                 01810019
018200     IF  DP030-RC-CALL-SUCCESSFUL                                 01820019
018300         CONTINUE                                                 01830019
018400     ELSE                                                         01840019
018500         SET DP013-NO-ROLLBACK                                    01850019
018600             DP013-XCTL-DISPLAY-RESTART                           01860019
018700             DP013-CICS-ABEND      TO TRUE                        01870019
018800         MOVE 'BEFORE 0000-MAIN-MODULE'                           01880019
018900                                   TO DP013-PARAGRAPH             01890019
018920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O01892028
018930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01893028
019200         MOVE DP030-RETURN-CODE                                   01920019
019300                                   TO DP013-MESSAGE-TEXT (3)      01930019
019400         PERFORM DP013-0000-PROCESS-ABEND                         01940019
019500     END-IF.                                                      01950019
019600 EJECT                                                            01960019
019700*----------------------------------------------------------------*01970019
019800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *01980019
019900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *01990019
020000*----------------------------------------------------------------*02000019
020100                                                                  02010019
020200 1000-CONTROL-PROCESSING.                                         02020019
020300                                                                  02030019
020400     EVALUATE TRUE                                                02040019
020500         WHEN DP020-NEXT-ACT-INITIAL                              02050019
020600* PV-DB2-DATE NOT USED, INCLUDED TO KEEP PROGRAM DB2              02060019
020700             EXEC SQL                                             02070019
020800                 SET :PV-DB2-DATE = CURRENT DATE                  02080019
020900             END-EXEC                                             02090019
021000             INITIALIZE ASC-SPECIFIC-COMMAREA                     02100019
021100             MOVE ZEROES         TO ASC-PO-NBR-N                  02110019
021200                                    ASC-REC-SEQ-NBR-N             02120019
021300             IF  DP020-LOCATION-TYPE = 'DC'                       02130019
021400                 MOVE DP020-LOCATION-NBR TO ASC-OPER-UNT-ID-N     02140019
021500                 MOVE DP020-FCLTY-ID TO ASC-FCLTY-ID-N            02150019
021600             ELSE                                                 02160019
021700                 MOVE SPACES      TO ASC-OPER-UNT-ID              02170019
021800                                     ASC-FCLTY-ID                 02180019
021900             END-IF                                               02190019
022000             PERFORM 4000-BUILD-INITIAL-PANEL                     02200019
022100                                                                  02210019
022200         WHEN DP020-NEXT-ACT-READ-MAP                             02220019
022300             PERFORM 2000-FKEY-PROCESSING                         02230019
022400                                                                  02240019
022500         WHEN DP020-NEXT-ACT-RETURN                               02250019
022600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02260019
022700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02270019
022800                                                                  02280019
022900         WHEN OTHER                                               02290019
023000             SET DP013-LOGIC-ABEND                                02300019
023100                 DP013-NO-ROLLBACK TO TRUE                        02310019
023200             MOVE '1000-CONTROL-PROCESSING'                       02320019
023300                                   TO  DP013-PARAGRAPH            02330019
023400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02340019
023500                                   TO  DP013-MESSAGE-TEXT(1)      02350019
023600             MOVE DP020-NEXT-APPL-ACTIVITY                        02360019
023700                                   TO DP013-MESSAGE-TEXT(2)       02370019
023800             PERFORM DP013-0000-PROCESS-ABEND                     02380019
023900     END-EVALUATE.                                                02390019
024000                                                                  02400019
024100*----------------------------------------------------------------*02410019
024200* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02420019
024300* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02430019
024400* EDITS.                                                         *02440019
024500*----------------------------------------------------------------*02450019
024600                                                                  02460019
024700 2000-FKEY-PROCESSING.                                            02470019
024800                                                                  02480019
024900     EVALUATE TRUE                                                02490019
025000                                                                  02500019
025100         WHEN DP020-SRC-AID = DP016-CLEAR                         02510019
025200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02520019
025300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02530019
025400                                                                  02540019
025500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02550019
025600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02560019
025700             PERFORM 4000-BUILD-INITIAL-PANEL                     02570019
025800             PERFORM 3200-RESET-ATTRIBUTES                        02580019
025900                                                                  02590019
026000         WHEN OTHER                                               02600019
026100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02610019
026200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02620019
026300             IF  PS-NO-ERROR                                      02630019
026400                 SET DP030-CONTINUE-GO TO TRUE                    02640019
026500                 PERFORM 2100-CHECK-FUNCTION-KEY                  02650019
026600             ELSE                                                 02660019
026700                 SET DP030-OVERRIDE-GO TO TRUE                    02670019
026800             END-IF                                               02680019
026900     END-EVALUATE.                                                02690019
027000                                                                  02700019
027100/                                                                 02710019
027200******************************************************************02720019
027300** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02730019
027400** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **02740019
027500** FROM THE CICS ARCHITECTURE API.                              **02750019
027600******************************************************************02760019
027700 2100-CHECK-FUNCTION-KEY.                                         02770019
027800     EVALUATE TRUE                                                02780019
027900         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 02790019
028000             PERFORM 2110-PREPARE-INTER-APPL-COMM                 02800019
028100                                                                  02810019
028200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              02820019
028300             PERFORM 2115-PREPARE-INTER-PREPAK-COMM               02830019
028400                                                                  02840019
028500         WHEN DP020-SRC-AID = DP016-ENTER                         02850019
028510             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02851025
028700                                                                  02870019
028800         WHEN OTHER                                               02880019
028900             SET DP013-NO-ROLLBACK                                02890019
029000                 DP013-XCTL-DISPLAY-RESTART                       02900019
029100                 DP013-CICS-ABEND  TO TRUE                        02910019
029200             MOVE '2100-CHECK-FUNCTION-KEY'                       02920019
029300                                   TO DP013-PARAGRAPH             02930019
029400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02940019
029500                                   TO DP013-MESSAGE-TEXT (1)      02950019
029600             PERFORM DP013-0000-PROCESS-ABEND                     02960019
029700     END-EVALUATE.                                                02970019
029800******************************************************************02980019
029900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **02990019
030000** INTER-APPLICATION COMMAREA.                                  **03000019
030100******************************************************************03010019
030200 2110-PREPARE-INTER-APPL-COMM.                                    03020019
030300     INITIALIZE RC012-INTER-APPL-COMMAREA.                        03030019
030400                                                                  03040019
030500     IF   ASC-OPER-UNT-ID > SPACES                                03050019
030600          MOVE ASC-OPER-UNT-ID     TO RC012-OPER-UNT-ID           03060019
030700     ELSE                                                         03070019
030800          MOVE ZEROES              TO RC012-OPER-UNT-ID           03080019
030900     END-IF.                                                      03090019
031000     IF   ASC-FCLTY-ID > SPACES                                   03100019
031100          MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID              03110019
031200     ELSE                                                         03120019
031300          MOVE ZEROES              TO RC012-FCLTY-ID              03130019
031400     END-IF.                                                      03140019
031500                                                                  03150019
031600     MOVE ASC-PO-NBR-N             TO RC012-PO-NBR.               03160019
031700     MOVE ASC-REC-SEQ-NBR-N        TO RC012-REC-SEQ-NBR.          03170019
031800                                                                  03180019
031900/                                                                 03190019
032000******************************************************************03200019
032100** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03210019
032200** INTER-APPLICATION PREPACK COMMAREA.                          **03220019
032300******************************************************************03230019
032400 2115-PREPARE-INTER-PREPAK-COMM.                                  03240019
032500     INITIALIZE RC012-INTER-APPL-COMMAREA.                        03250019
032600                                                                  03260019
032700     IF   ASC-OPER-UNT-ID > SPACES                                03270019
032800          MOVE ASC-OPER-UNT-ID     TO RC012-OPER-UNT-ID           03280019
032900     ELSE                                                         03290019
033000          MOVE ZEROES              TO RC012-OPER-UNT-ID           03300019
033100     END-IF.                                                      03310019
033200     IF   ASC-FCLTY-ID > SPACES                                   03320019
033300          MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID              03330019
033400     ELSE                                                         03340019
033500          MOVE ZEROES              TO RC012-FCLTY-ID              03350019
033600     END-IF.                                                      03360019
033700                                                                  03370019
033800     MOVE ASC-PO-NBR-N             TO RC012-PO-NBR.               03380019
033900     MOVE ASC-REC-SEQ-NBR-N        TO RC012-REC-SEQ-NBR.          03390019
034000/                                                                 03400019
034100*----------------------------------------------------------------*03410019
034200* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03420019
034300* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03430019
034400* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03440019
034500*----------------------------------------------------------------*03450019
034600                                                                  03460019
034700 2200-MOVE-SCREEN-TO-COMMAREA.                                    03470019
034800                                                                  03480019
034900     IF  AOPERL > ZERO                                            03490019
035000         MOVE AOPERI               TO ASC-OPER-UNT-ID             03500019
035100     ELSE                                                         03510019
035200         IF  AOPERF = DP015-ERASE-EOF                             03520019
035300             MOVE SPACES           TO ASC-OPER-UNT-ID             03530019
035400         END-IF                                                   03540019
035500     END-IF.                                                      03550019
035600                                                                  03560019
035700     IF  AFCLTYL > ZERO                                           03570019
035800         MOVE AFCLTYI              TO ASC-FCLTY-ID                03580019
035900     ELSE                                                         03590019
036000         IF  AFCLTYF = DP015-ERASE-EOF                            03600019
036100             MOVE SPACES           TO ASC-FCLTY-ID                03610019
036200         END-IF                                                   03620019
036300     END-IF.                                                      03630019
036400                                                                  03640019
036500     IF  APONBRL > ZERO                                           03650019
036600         MOVE APONBRI              TO ASC-PO-NBR                  03660019
036700     ELSE                                                         03670019
036800         IF  APONBRF = DP015-ERASE-EOF                            03680019
036900             MOVE ZEROES           TO ASC-PO-NBR-N                03690019
037000         END-IF                                                   03700019
037100     END-IF.                                                      03710019
037200                                                                  03720019
037300     IF  ASEQNBRL > ZERO                                          03730019
037400         MOVE ASEQNBRI             TO ASC-REC-SEQ-NBR             03740019
037500     ELSE                                                         03750019
037600         IF  ASEQNBRF = DP015-ERASE-EOF                           03760019
037700             MOVE ZEROES           TO ASC-REC-SEQ-NBR-N           03770019
037800         END-IF                                                   03780019
037900     END-IF.                                                      03790019
038000                                                                  03800019
038100*----------------------------------------------------------------*03810019
038200* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03820019
038300* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03830019
038400* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03840019
038500* IN THE DESTINATION PROGRAM, NOT HERE.                          *03850019
038600*----------------------------------------------------------------*03860019
038700                                                                  03870019
038800 3000-EDIT-DATA-IN-COMMAREA.                                      03880019
038900                                                                  03890019
039000     PERFORM 3200-RESET-ATTRIBUTES.                               03900019
039100                                                                  03910019
039200     IF  ASC-OPER-UNT-ID > (SPACES OR ZEROES)                     03920019
039300         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         03930019
039400         MOVE LENGTH OF ASC-OPER-UNT-ID                           03940019
039500                                 TO DP010I-MAXIMUM-DIGITS         03950019
039600         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       03960019
039700         SET DP010I-NEGATIVE-NOT-ALLOWED                          03970019
039800                                 TO TRUE                          03980019
039900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         03990028
039910              USING DP010I-NUMERIC-EDIT-AREA                      03991028
040000         IF  DP010I-ERROR-DETECTED                                04000019
040100             SET PS-ERROR                                         04010019
040200                 DP020-MSG-FATAL TO TRUE                          04020019
040300             MOVE PC-TSYMSG-00008                                 04030019
040400                                 TO DP020-MSG-NUMBER              04040019
040500             MOVE DP015-UNP-ALP-BRT-OFF                           04050019
040600                                 TO AOPERA                        04060019
040700             MOVE DP015-RED      TO AOPERC                        04070019
040800             MOVE DP015-REVERSE  TO AOPERH                        04080019
040900             MOVE -1             TO AOPERL                        04090019
041000             SET DP030-SET-CURSOR-APPL-1                          04100019
041100                                 TO TRUE                          04110019
041200         ELSE                                                     04120019
041300             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       04130019
041400             MOVE ASC-OPER-UNT-ID      TO AOPERO                  04140019
041500             PERFORM 3020-CHECK-OPER-UNT-GET-NAME                 04150019
041600             IF  PS-ERROR                                         04160019
041700                 SET DP020-MSG-FATAL     TO TRUE                  04170019
041800                 MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER      04180019
041900                 MOVE DP015-UNP-ALP-BRT-OFF                       04190019
042000                                         TO AOPERA                04200019
042100                 MOVE DP015-RED          TO AOPERC                04210019
042200                 MOVE DP015-REVERSE      TO AOPERH                04220019
042300                 MOVE -1                 TO AOPERL                04230019
042400                 SET DP030-SET-CURSOR-APPL-1                      04240019
042500                                         TO TRUE                  04250019
042600             END-IF                                               04260019
042700         END-IF                                                   04270019
042800     END-IF.                                                      04280019
042900                                                                  04290019
043000     IF  ASC-FCLTY-ID > (SPACES OR ZEROES)                        04300019
043100         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         04310019
043200         MOVE LENGTH OF ASC-FCLTY-ID                              04320019
043300                                 TO DP010I-MAXIMUM-DIGITS         04330019
043400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       04340019
043500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04350019
043600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04360028
043610              USING DP010I-NUMERIC-EDIT-AREA                      04361028
043700         IF  DP010I-ERROR-DETECTED                                04370019
043800             SET PS-ERROR                                         04380019
043900                 DP020-MSG-FATAL  TO TRUE                         04390019
044000             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             04400019
044100             MOVE DP015-UNP-ALP-BRT-OFF                           04410019
044200                                  TO AFCLTYA                      04420019
044300             MOVE DP015-RED       TO AFCLTYC                      04430019
044400             MOVE DP015-REVERSE   TO AFCLTYH                      04440019
044500             MOVE -1              TO AFCLTYL                      04450019
044600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04460019
044700         ELSE                                                     04470019
044800             MOVE DP010I-NUMERIC-FIELD TO ASC-FCLTY-ID-N          04480019
044900         END-IF                                                   04490019
045000         IF ASC-FCLTY-ID-N = 1                                    04500019
045100             MOVE XL071-LOC-NM TO ASC-FCLTY-NME                   04510019
045200                                  AFDESCO                         04520019
045300*VML         MOVE ASC-FCLTY-ID-N TO DK-FCLTY-ID                   04530019
045400             MOVE ASC-FCLTY-ID   TO AFCLTYO                       04540019
045500         ELSE                                                     04550019
045600             SET PS-ERROR                                         04560019
045700                 DP020-MSG-FATAL         TO TRUE                  04570019
045800             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      04580019
045900             MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA               04590019
046000             MOVE DP015-RED              TO AFCLTYC               04600019
046100             MOVE DP015-REVERSE          TO AFCLTYH               04610019
046200             MOVE -1                     TO AFCLTYL               04620019
046300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04630019
046400         END-IF                                                   04640019
046500     END-IF.                                                      04650019
046600                                                                  04660019
046700     IF  ASC-REC-SEQ-NBR > SPACES                                 04670019
046800         MOVE ASC-REC-SEQ-NBR      TO DP010I-UNEDITED-FIELD       04680019
046900         MOVE LENGTH OF ASC-REC-SEQ-NBR                           04690019
047000                                   TO DP010I-MAXIMUM-DIGITS       04700019
047100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04710019
047200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04720019
047300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04730028
047310              USING DP010I-NUMERIC-EDIT-AREA                      04731028
047400         IF  DP010I-ERROR-DETECTED                                04740019
047500             SET PS-ERROR                                         04750019
047600                 DP020-MSG-FATAL   TO TRUE                        04760019
047700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04770019
047800             MOVE DP015-UNP-ALP-BRT-OFF                           04780019
047900                                   TO ASEQNBRA                    04790019
048000             MOVE DP015-RED        TO ASEQNBRC                    04800019
048100             MOVE DP015-REVERSE    TO ASEQNBRH                    04810019
048200             MOVE -1               TO ASEQNBRL                    04820019
048300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04830019
048400         ELSE                                                     04840019
048500             MOVE DP010I-NUMERIC-FIELD                            04850019
048600                                   TO ASC-REC-SEQ-NBR-N           04860019
048700             MOVE ASC-REC-SEQ-NBR  TO ASEQNBRO                    04870019
048800         END-IF                                                   04880019
048900     END-IF.                                                      04890019
049000                                                                  04900019
049100     IF  ASC-PO-NBR > SPACE                                       04910019
049200         MOVE -1                   TO APONBRL                     04920019
049300         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       04930019
049400         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       04940019
049500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04950019
049600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04960019
049700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04970028
049710              USING DP010I-NUMERIC-EDIT-AREA                      04971028
049800         IF  DP010I-ERROR-DETECTED                                04980019
049900             SET PS-ERROR                                         04990019
050000                 DP020-MSG-FATAL   TO TRUE                        05000019
050100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05010019
050200             MOVE DP015-UNP-ALP-BRT-OFF                           05020019
050300                                   TO APONBRA                     05030019
050400             MOVE DP015-RED        TO APONBRC                     05040019
050500             MOVE DP015-REVERSE    TO APONBRH                     05050019
050600             MOVE -1               TO APONBRL                     05060019
050700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05070019
050800         ELSE                                                     05080019
050900             MOVE DP010I-NUMERIC-FIELD                            05090019
051000                                   TO ASC-PO-NBR-N                05100019
051100             MOVE ASC-PO-NBR       TO APONBRO                     05110019
051200         END-IF                                                   05120019
051300     END-IF.                                                      05130019
051400                                                                  05140019
051500     IF  PS-NO-ERROR                                              05150019
051600     AND ASC-PO-NBR-N      = (SPACES OR ZEROES)                   05160019
051700     AND ASC-REC-SEQ-NBR-N = (SPACES OR ZEROES)                   05170019
051800         SET PS-ERROR                                             05180019
051900             DP020-MSG-FATAL   TO TRUE                            05190019
052000         MOVE PC-TSYMSG-00308  TO DP020-MSG-NUMBER                05200019
052100         MOVE DP015-UNP-ALP-BRT-OFF                               05210019
052200                               TO APONBRA                         05220019
052300                                  ASEQNBRA                        05230019
052400         MOVE DP015-RED        TO APONBRC                         05240019
052500                                  ASEQNBRC                        05250019
052600         MOVE DP015-REVERSE    TO APONBRH                         05260019
052700                                  ASEQNBRH                        05270019
052800         MOVE -1               TO APONBRL                         05280019
052900         SET DP030-SET-CURSOR-APPL-1                              05290019
053000                               TO TRUE                            05300019
053100     END-IF.                                                      05310019
053200                                                                  05320019
053300     IF  PS-NO-ERROR                                              05330019
053400     AND ASC-PO-NBR = (SPACES OR ZEROES)                          05340019
053500         SET PS-ERROR                                             05350019
053600             DP020-MSG-FATAL   TO TRUE                            05360019
053700         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                05370019
053800         MOVE DP015-UNP-ALP-BRT-OFF                               05380019
053900                               TO APONBRA                         05390019
054000         MOVE DP015-RED        TO APONBRC                         05400019
054100         MOVE DP015-REVERSE    TO APONBRH                         05410019
054200         MOVE -1               TO APONBRL                         05420019
054300         SET DP030-SET-CURSOR-APPL-1                              05430019
054400                               TO TRUE                            05440019
054500     END-IF.                                                      05450019
054600                                                                  05460019
054601* DMH - BEGIN - PO SEASET CHECK - 5-8-2020                        05460121
054603     IF  PS-NO-ERROR   AND                                        05460320
054604         ASC-PO-NBR > SPACE                                       05460420
054610         PERFORM 3100-PO-HAS-SEASET                               05461021
054681     END-IF.                                                      05468121
054682* DMH - BEGIN - PO SEASET CHECK - 5-8-2020                        05468221
054690                                                                  05469020
054700                                                                  05470021
054800*----------------------------------------------------------------*05480019
054900*  CALL XLKUT071 TO VERIFY OPER UNIT ID IS VALID.  IF IT IS,     *05490019
055000*  BRING BACK TO LOCATION NAME.                                  *05500019
055100*----------------------------------------------------------------*05510019
055200                                                                  05520019
055300 3020-CHECK-OPER-UNT-GET-NAME.                                    05530019
055400                                                                  05540019
055500     INITIALIZE XL071-COMMAREA-REC.                               05550019
055600                                                                  05560019
055700     MOVE ASC-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER.             05570019
055800                                                                  05580019
055900     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    05590019
056000                                      XL071-COMMAREA              05600019
056100                                      XL071-COMMAREA-REC.         05610019
056200                                                                  05620019
056300     EVALUATE TRUE                                                05630019
056400         WHEN XL071-NO-ERRORS                                     05640019
056500             MOVE XL071-LOC-NM TO ASC-FCLTY-NME                   05650019
056600         WHEN XL071-LOC-NOT-FOUND                                 05660019
056700             SET PS-ERROR TO TRUE                                 05670019
056800             MOVE SPACES  TO ASC-FCLTY-NME                        05680019
056900         WHEN XL071-SQLCODE-N = -904                              05690019
057000         WHEN XL071-SQLCODE-N = -913                              05700019
057100             MOVE SPACES  TO ASC-FCLTY-NME                        05710019
057200         WHEN XL071-BAD-DB2-RETURN                                05720019
057300             MOVE '3020-CHECK-OPER-UNT-GET-NAME'                  05730019
057400                                     TO DP013-PARAGRAPH           05740019
057500             MOVE 'SELECT OPER UNIT' TO DP013-MESSAGE-TEXT (1)    05750019
057600             MOVE 'OPER UNIT     '   TO DP013-MESSAGE-TEXT (2)    05760019
057700             MOVE ASC-OPER-UNT-ID    TO DP013-MESSAGE-TEXT (3)    05770019
057800             MOVE XL071-SQLCA        TO DP013-SQLCA               05780019
057900             MOVE 'XLT-LOC'          TO DP013-DB2-TABLE-NAME (1)  05790019
058000             SET DP013-DB2-ABEND                                  05800019
058100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               05810019
058200             PERFORM DP013-0000-PROCESS-ABEND                     05820019
058300     END-EVALUATE.                                                05830019
058400                                                                  05840019
058500/                                                                 05850019
058501******************************************************************05850121
058502** CHECK IF THE PO ENTERED IS CODED FOR A SEASONAL SET          **05850221
058503** DMH = 05-08-2020                                            ** 05850321
058504******************************************************************05850421
058510 3100-PO-HAS-SEASET.                                              05851021
058511     MOVE  ASC-PO-NBR-N    TO  DK-PO-NBR.                         05851121
058512     MOVE  SPACES          TO  ASC-SEASET-YR                      05851221
058513                               ASC-SEASET-SHRT-NM                 05851321
058514                               ASC-SEASET-NM                      05851421
058515                               ASC-SEASET-DISP.                   05851521
058516                                                                  05851621
058517     EXEC SQL                                                     05851721
058518        SELECT  SEASET_YR                                         05851821
058519             ,  SEASET_SHRT_NM                                    05851921
058520          INTO :PURCHS-SEASET-YR                                  05852021
058521             , :PURCHS-SEASET-SHRT-NM                             05852121
058522          FROM  TPURCHS                                           05852221
058523      WHERE PO_NBR         = :DK-PO-NBR                           05852321
058524        AND VER_STATUS_CDE = 'A'                                  05852421
058530      WITH UR                                                     05853021
058531     END-EXEC                                                     05853121
058532                                                                  05853221
058533     EVALUATE TRUE                                                05853321
058534         WHEN SQLCODE = +0                                        05853421
058535              IF  PURCHS-SEASET-YR       > SPACES  AND            05853521
058536                  PURCHS-SEASET-SHRT-NM  > SPACES                 05853621
058537                  MOVE PURCHS-SEASET-YR                           05853721
058538                                         TO ASC-SEASET-YR         05853821
058539                  MOVE PURCHS-SEASET-SHRT-NM                      05853921
058540                                         TO ASC-SEASET-SHRT-NM    05854021
058541                  PERFORM 3110-GET-SEASET-INFO                    05854121
058542              ELSE                                                05854221
058543                  MOVE  SPACES           TO ASC-SEASET-YR         05854321
058544                                            ASC-SEASET-SHRT-NM    05854421
058545                                            ASC-SEASET-NM         05854521
058546                                            ASC-SEASET-DISP       05854621
058547              END-IF                                              05854721
058548                                                                  05854821
058549         WHEN SQLCODE = +100                                      05854921
058550              MOVE SPACES                TO ASC-SEASET-YR         05855021
058551                                            ASC-SEASET-SHRT-NM    05855121
058552                                            ASC-SEASET-NM         05855221
058553                                            ASC-SEASET-DISP       05855321
058556         WHEN SQLCODE = -904                                      05855621
058557         WHEN SQLCODE = -913                                      05855721
058558             CONTINUE                                             05855821
058559                                                                  05855921
058560         WHEN SQLWARN0 NOT = SPACE                                05856021
058561         WHEN SQLCODE < +0                                        05856121
058562         WHEN SQLCODE > +0                                        05856221
058563             MOVE '3100-PO-HAS-SEASET'                            05856321
058564                             TO DP013-PARAGRAPH                   05856421
058565             MOVE 'CHECK IF PO HAS SEASONAL SET'                  05856521
058566                             TO DP013-MESSAGE-TEXT (1)            05856621
058567             MOVE SQLCA      TO DP013-SQLCA                       05856721
058568             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)          05856821
058570             SET DP013-DB2-ABEND                                  05857021
058571                             TO TRUE                              05857121
058572             SET DP013-XCTL-DISPLAY-RESTART                       05857221
058573                             TO TRUE                              05857321
058574             PERFORM DP013-0000-PROCESS-ABEND                     05857421
058575     END-EVALUATE.                                                05857521
058576                                                                  05857621
058580                                                                  05858021
058581******************************************************************05858121
058582** GET SEASONAL SET INFO FOR PO                                 **05858221
058583** DMH = 05-08-2020                                            ** 05858321
058584******************************************************************05858421
058590 3110-GET-SEASET-INFO.                                            05859021
058591     MOVE  ASC-SEASET-YR       TO SEASET-SEASET-YR.               05859121
058592     MOVE  ASC-SEASET-SHRT-NM  TO SEASET-SEASET-SHRT-NM.          05859221
058595     MOVE  SPACES              TO ASC-SEASET-NM                   05859524
058596                                  ASC-SEASET-DISP.                05859624
058597                                                                  05859721
058598     EXEC SQL                                                     05859821
058599          SELECT  SEASET_NM                                       05859921
058601            INTO :SEASET-SEASET-NM                                05860121
058603            FROM  TSEASET                                         05860321
058604           WHERE SEASET_YR      = :SEASET-SEASET-YR               05860421
058605             AND SEASET_SHRT_NM = :SEASET-SEASET-SHRT-NM          05860521
058606            WITH UR                                               05860621
058607     END-EXEC.                                                    05860721
058608                                                                  05860821
058609     EVALUATE TRUE                                                05860921
058610         WHEN SQLCODE = +0                                        05861021
058611              MOVE SEASET-SEASET-NM  TO  ASC-SEASET-NM            05861121
058612              STRING 'SET: '  ASC-SEASET-YR                       05861221
058613                     '-'      ASC-SEASET-SHRT-NM                  05861321
058614                                            DELIMITED BY SIZE     05861421
058615                                       INTO ASC-SEASET-DISP       05861521
058624                                                                  05862421
058625         WHEN SQLCODE = +100                                      05862521
058626              MOVE SPACES                TO ASC-SEASET-NM         05862621
058627                                            ASC-SEASET-DISP       05862721
058628              STRING 'SET: '  ASC-SEASET-YR                       05862821
058629                     '-'      ASC-SEASET-SHRT-NM                  05862921
058630                                            DELIMITED BY SIZE     05863021
058631                                       INTO ASC-SEASET-DISP       05863121
058632                                                                  05863221
058633         WHEN SQLCODE = -904                                      05863321
058634         WHEN SQLCODE = -913                                      05863421
058635             CONTINUE                                             05863521
058636                                                                  05863621
058637         WHEN SQLWARN0 NOT = SPACE                                05863721
058638         WHEN SQLCODE < +0                                        05863821
058639         WHEN SQLCODE > +0                                        05863921
058640             MOVE '3110-GET-SEASET-INFO'                          05864021
058641                             TO DP013-PARAGRAPH                   05864121
058642             MOVE 'GET SEASONAL SET INFORMATION'                  05864221
058643                             TO DP013-MESSAGE-TEXT (1)            05864321
058644             MOVE SQLCA      TO DP013-SQLCA                       05864421
058645             MOVE 'TSEASET'  TO DP013-DB2-TABLE-NAME (1)          05864521
058646             SET DP013-DB2-ABEND                                  05864621
058647                             TO TRUE                              05864721
058648             SET DP013-XCTL-DISPLAY-RESTART                       05864821
058649                             TO TRUE                              05864921
058650             PERFORM DP013-0000-PROCESS-ABEND                     05865021
058651     END-EVALUATE.                                                05865121
058652                                                                  05865221
058653                                                                  05865321
058660******************************************************************05866021
058700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **05870019
058800** MAP.                                                         **05880019
058900******************************************************************05890019
059000                                                                  05900019
059100 3200-RESET-ATTRIBUTES.                                           05910019
059200                                                                  05920019
059300     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      05930019
059400                                      AFCLTYA                     05940019
059500                                      ASEQNBRA                    05950019
059600                                      APONBRA.                    05960019
059700     MOVE DP015-GREEN              TO AOPERC                      05970019
059800                                      ASEQNBRC                    05980019
059900                                      AFCLTYC                     05990019
060000                                      APONBRC.                    06000019
060100     MOVE DP015-UNDERLINE          TO AOPERH                      06010019
060200                                      AFCLTYH                     06020019
060300                                      ASEQNBRH                    06030019
060400                                      APONBRH.                    06040019
060500                                                                  06050019
060600/                                                                 06060019
060700*----------------------------------------------------------------*06070019
060800*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *06080019
060900*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *06090019
061000*  IT HERE.                                                      *06100019
061100*----------------------------------------------------------------*06110019
061200 4000-BUILD-INITIAL-PANEL.                                        06120019
061300                                                                  06130019
061400     PERFORM 3020-CHECK-OPER-UNT-GET-NAME.                        06140019
061500                                                                  06150019
061600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        06160019
061700     MOVE -1                       TO APONBRL.                    06170019
061800                                                                  06180019
061900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        06190019
062000                                                                  06200019
062100/                                                                 06210019
062200*----------------------------------------------------------------*06220019
062300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *06230019
062400*----------------------------------------------------------------*06240019
062500 4400-MOVE-COMMAREA-TO-SCREEN.                                    06250019
062600                                                                  06260019
062700     IF   ASC-OPER-UNT-ID > SPACES                                06270019
062800          MOVE ASC-OPER-UNT-ID     TO AOPERO                      06280019
062900     ELSE                                                         06290019
063000          MOVE ZEROES              TO AOPERO                      06300019
063100     END-IF.                                                      06310019
063200                                                                  06320019
063300     IF   ASC-FCLTY-ID > SPACES                                   06330019
063400          MOVE ASC-FCLTY-ID        TO AFCLTYO                     06340019
063500     ELSE                                                         06350019
063600          MOVE ZEROES              TO AFCLTYO                     06360019
063700     END-IF.                                                      06370019
063800                                                                  06380019
063900     IF   ASC-OPER-UNT-ID > SPACES                                06390019
064000     AND  ASC-FCLTY-ID    > SPACES                                06400019
064100          MOVE ASC-FCLTY-NME       TO AFDESCO                     06410019
064200     END-IF.                                                      06420019
064300                                                                  06430019
064400     MOVE ASC-PO-NBR-N             TO APONBRO.                    06440019
064500     MOVE ASC-REC-SEQ-NBR-N        TO ASEQNBRO.                   06450019
064501                                                                  06450121
064502     MOVE ASC-SEASET-DISP          TO ASETCDO.                    06450221
064520     MOVE ASC-SEASET-NM            TO ASETNMO.                    06452026
064600                                                                  06460019
064700/                                                                 06470019
064800*----------------------------------------------------------------*06480019
064900*    ABEND PROCESSOR MODULE                                      *06490019
065000*----------------------------------------------------------------*06500019
065100                                                                  06510019
065200     COPY DPPD013.                                                06520019
