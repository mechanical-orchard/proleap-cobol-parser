      *****************************************************************         
      *  WORKING STORAGE FOR MAINFRAME FAXING USING COMMERCEPATH.               
      *----------------------------------------------------------------         
      *  DO THE FOLLOWING FOR EACH FAX PRODUCED:                                
      *  1. FILL THE "SEND TO/FROM" FIELDS                                      
      *  2. SET ANY OVERRIDES                                                   
      *  3. PERFORM DP028-0000-FAX-START                                        
      *  4. WRITE FAX TEXT TO FAX-FILE                                          
      *     IF NEEDED, FILL DP028-COORD1 AND DP028-COORD2 AND THEN              
      *         PERFORM DP028-1000-BOX                                          
      *              OR DP028-1010-RELATIVE-BOX                                 
      *              OR DP028-1100-LINE                                         
      *              OR DP028-1110-RELATIVE-LINE                                
      *  5. PERFORM DP028-9000-FAX-END                                          
      *                                                                         
      *-----------------------------------------------------------------        
      *                                                                         
      *  IF USING AFP FORMS, INCLUDE FAXOUT OUTPUT CARD IN YOUR JCL:            
      *      //FAXOUT   OUTPUT FORMDEF=???,PAGEDEF=???                          
      *                                                                         
      *  YOUR PROGRAM SHOULD INCLUDE:                                           
      *                                                                         
      *      COPYBOOKS FAXWS, FAXPROC, DPWS023 AND DPPD023.                     
      *                                                                         
      *      SELECT FAX-FILE                                                    
      *          ASSIGN TO FAX.                                                 
      *                                                                         
      *      FD  FAX-FILE.                                                      
      *      01  FAX-LINE     PIC X(###).                                       
      *                                                                         
      *-----------------------------------------------------------------        
      *  ONLY THE FIRST OCCUR OF FV-SEND-TO-INFO WILL GET A COVER PAGE.         
      *  IF YOU WANT EACH COPY OF A FAX TO GET A COVER PAGE, YOU WILL           
      *  HAVE TO RE-CREATE THE FAX FOR EACH DESTINATION AND INCLUDE             
      *  ONLY THAT SEND INFORMATION IN THE FIRST OCCURANCE.                     
      *****************************************************************         
       01  DP028-FAXING-VARIABLES.                                              
           05  DP028-SEND-TO-INFO.                                              
               10  FILLER  OCCURS 10 TIMES                                      
                          INDEXED BY DP028-IDX.                                 
                   15  DP028-TO-FAX-NUMBER         PIC X(24).                   
                   15  DP028-ALT-FAX-NUMBER        PIC X(24).                   
                   15  DP028-TO-PERSON             PIC X(45).                   
                   15  DP028-TO-COMPANY            PIC X(45).                   
           05  DP028-SEND-FROM-INFO.                                            
               10  DP028-FROM-VOICE-NUMBER         PIC X(24).                   
               10  DP028-FROM-FAX-NUMBER           PIC X(24).                   
               10  DP028-FROM-PERSON               PIC X(45).                   
               10  DP028-FROM-COMPANY              PIC X(45).                   
           05  DP028-OVERRIDES.                                                 
               10  DP028-SENDING-PROGRAM           PIC X(08).                   
               10  DP028-SUCCESS-FAX-NUMBER        PIC X(24).                   
               10  DP028-ERROR-FAX-NUMBER          PIC X(24).                   
               10  DP028-AFP-FORM-ON-FAX           PIC X(01) VALUE 'Y'.         
                   88  DP028-FAX-WITH-AFP-FORM               VALUE 'Y'.         
                   88  DP028-FAX-WITHOUT-AFP-FORM            VALUE 'N'.         
               10  DP028-COVER-PAGE             PIC X(03) VALUE SPACES.         
                   88  DP028-NO-COVER-PAGE                VALUE SPACES.         
               10  DP028-CT-TABLES.                                             
                   15  DP028-COVERTEXT-TABLE OCCURS 10 TIMES.                   
                       20  DP028-COVERTEXT OCCURS  10 TIMES                     
                                                PIC X(80) VALUE SPACES.         
               10  DP028-BANNER-LINE-SW         PIC X(01) VALUE 'Y'.            
                   88  DP028-BANNER-LINE                  VALUE 'Y'.            
                   88  DP028-NO-BANNER-LINE               VALUE 'N'.            
               10  DP028-FONT                   PIC X(14) VALUE SPACE.          
                   88  DP028-DEFAULT-FONT                 VALUE SPACE.          
               10  DP028-ORIENTATION            PIC X(01) VALUE SPACE.          
                   88  DP028-DEFAULT-ORIENTATION          VALUE SPACE.          
                   88  DP028-PORTRAIT                     VALUE 'P'.            
                   88  DP028-LANDSCAPE                    VALUE 'L'.            
               10  DP028-QUALITY                PIC X(01) VALUE SPACE.          
                   88  DP028-DEFAULT-QUALITY              VALUE SPACE.          
                   88  DP028-STANDARD-QUALITY             VALUE 'S'.            
                   88  DP028-FINE-QUALITY                 VALUE 'F'.            
               10  DP028-UNITS                  PIC X(01) VALUE SPACE.          
                   88  DP028-DEFAULT-UNITS                VALUE SPACE.          
                   88  DP028-INCHES                       VALUE 'I'.            
                   88  DP028-CENTIMETERS                  VALUE 'C'.            
                   88  DP028-POINTS                       VALUE 'P'.            
                   88  DP028-PIXELS                       VALUE 'X'.            
               10  DP028-TOP-MARGIN             PIC 99.99 VALUE ZERO.           
               10  DP028-BOTTOM-MARGIN          PIC 99.99 VALUE ZERO.           
               10  DP028-LEFT-MARGIN            PIC 99.99 VALUE ZERO.           
               10  DP028-LINE-WIDTH             PIC 9(02) VALUE ZERO.           
                   88  DP028-DEFAULT-WIDTH                VALUE 0.              
                   88  DP028-NORMAL-WIDTH                 VALUE 1.              
                   88  DP028-BOLD-WIDTH                   VALUE 3.              
               10  DP028-COORD1.                                                
                   15  DP028-COORD1-X       PIC S9(5)V9(4) VALUE ZERO.          
                   15  DP028-COORD1-Y       PIC S9(5)V9(4) VALUE ZERO.          
               10  DP028-COORD2.                                                
                   15  DP028-COORD2-X       PIC S9(5)V9(4) VALUE ZERO.          
                   15  DP028-COORD2-Y       PIC S9(5)V9(4) VALUE ZERO.          
               10  DP028-MODE                   PIC X(01)  VALUE 'P'.           
                   88  DP028-PROD-MODE                     VALUE 'P'.           
                   88  DP028-TEST-MODE                     VALUE 'T'.           
                   88  DP028-TEST-ONE-FILE                 VALUE 'O'.           
           05  DP028-INTERNAL-WORK-FIELDS.                                      
               10  DP028-ABEND-CODE             PIC S9(4)  VALUE +666           
                                                           COMP SYNC.           
               10  DP028-TEST-ONE-OPEN-SW       PIC X(01)  VALUE 'N'.           
                   88  DP028-TEST-ONE-FILE-OPEN            VALUE 'Y'.           
               10  DP028-FCL-TBL                PIC 9(01).                      
               10  DP028-TBL                    PIC 9(02).                      
               10  DP028-LINE                   PIC 9(02).                      
               10  DP028-FAX-SIZE               PIC 9(04).                      
               10  DP028-FAX-CPI-PORT           PIC 9(02).                      
               10  DP028-FAX-CPI-LAND           PIC 9(02).                      
               10  DP028-FAX-PNT-PORT           PIC 9(02).                      
               10  DP028-FAX-PNT-LAND           PIC 9(02).                      
               10  DP028-PREV-UNITS             PIC X(01).                      
               10  DP028-PREV-WIDTH             PIC 9(02) VALUE ZERO.           
               10  DP028-COORD1-X-FMT           PIC -99999.9999.                
               10  DP028-COORD1-Y-FMT           PIC -99999.9999.                
               10  DP028-COORD2-X-FMT           PIC -99999.9999.                
               10  DP028-COORD2-Y-FMT           PIC -99999.9999.                
               10  DP028-START                  PIC 9(02)  VALUE ZERO.          
               10  DP028-LEN                    PIC 9(02)  VALUE ZERO.          
               10  DP028-PHONE                  PIC X(24)  VALUE SPACE.         
