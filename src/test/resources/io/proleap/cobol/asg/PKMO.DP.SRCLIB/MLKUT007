000010 IDENTIFICATION DIVISION.                                                 
000020                                                                          
000030 PROGRAM-ID.    MLKUT007.                                                 
000040 AUTHOR.        TESS BESTE.                                               
000050 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000060 DATE-WRITTEN.  04-24-94.                                                 
000070 DATE-COMPILED.                                                           
000080                                                                          
000090******************************************************************        
000100*           MLKUT007 - ACCUM PRICE CHANGES                                
000110*                                                                         
000120* THIS PROGRAM ACCUMULATES THE AMOUNTS FROM A FILE OF PRICE CHANGE        
000130* TRANSACTIONS IN THE MLRD009I FORMAT. THE TOTAL AMOUNT OF                
000140* MARKDOWNS AND MARKUPS IS DISPLAYED.                                     
000150******************************************************************        
000160                                                                 *        
000170                                                                          
000180 ENVIRONMENT DIVISION.                                                    
000190                                                                          
000200 CONFIGURATION SECTION.                                                   
000210                                                                          
000220 SOURCE-COMPUTER.    IBM-3090.                                            
000230 OBJECT-COMPUTER.    IBM-3090.                                            
000240                                                                          
000250                                                                          
000260 INPUT-OUTPUT SECTION.                                                    
000270                                                                          
000280 FILE-CONTROL.                                                            
000290     SELECT INPUT-FILE                                                    
000300         ASSIGN TO INP01.                                                 
000310                                                                          
000320                                                                          
000330                                                                          
000340 DATA DIVISION.                                                           
000350                                                                          
000360 FILE SECTION.                                                            
000370                                                                          
000380 FD  INPUT-FILE                                                           
000390     LABEL RECORDS ARE STANDARD                                           
000400     BLOCK CONTAINS 0 RECORDS                                             
000410     RECORDING  MODE IS F.                                                
000420 01  INPUT-RECORD                PIC X(100).                              
000430                                                                          
000440 WORKING-STORAGE SECTION.                                                 
000450                                                                          
000460******************************************************************        
000470* INPUT RECORD LAYOUT                                                     
000480******************************************************************        
000490                                                                          
000500      COPY MLRD009I.                                                      
000510                                                                          
000520 01  PS-PROGRAM-SWITCHES.                                                 
000530     05  PS-END-OF-INPUT-FILE-SW      PIC X         VALUE 'N'.            
000540         88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.            
000550         88  PS-NOT-END-OF-INPUT-FILE               VALUE 'N'.            
000560                                                                          
000570 01  PV-PROGRAM-VARIABLES.                                                
000580     05  PV-RECORD-COUNT              PIC S9(13)    VALUE +0              
000590                                                    COMP-3.               
000600     05  PV-RETAIL-AMT                PIC S9(13)V99 VALUE +0              
000610                                                    COMP-3.               
000620     05  PV-ACCUM-AMT1                PIC S9(13)V99 VALUE +0              
000630                                                    COMP-3.               
000640     05  PV-ACCUM-AMT2                PIC S9(13)V99 VALUE +0              
000650                                                    COMP-3.               
000660     05  PV-ACCUM-AMT3                PIC S9(13)V99 VALUE +0              
000670                                                    COMP-3.               
000680     05  PV-ACCUM-AMT4                PIC S9(13)V99 VALUE +0              
000690                                                    COMP-3.               
000700     05  PV-ACCUM-AMT5                PIC S9(13)V99 VALUE +0              
000710                                                    COMP-3.               
000720     05  PV-ACCUM-AMT6                PIC S9(13)V99 VALUE +0              
000730                                                    COMP-3.               
000740     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZZ,ZZZ-.               
000750     05  PV-DISPLAY-AMT               PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000760 EJECT                                                                    
000770 PROCEDURE DIVISION.                                                      
000780                                                                          
000790                                                                          
000800 A100-PROGRAM-MAINLINE.                                                   
000810                                                                          
000820     OPEN INPUT INPUT-FILE.                                               
000830     READ INPUT-FILE INTO ML009I-MARKDOWN-RECORDS                         
000840         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                         
000850                                                                          
000860     PERFORM UNTIL PS-END-OF-INPUT-FILE                                   
000870         ADD +1 TO PV-RECORD-COUNT                                        
000880         IF ML009I-DEPT-NUMBER-40 = 055                                   
000890           IF ML009I-MARKDOWN-CODE = '40'                                 
000900               COMPUTE PV-RETAIL-AMT                                      
000910                     = (ML009I-OLD-PRICE-40                               
000920                     -  ML009I-NEW-PRICE-40)                              
000930                     *  ML009I-QUANTITY-40                                
000940           ELSE                                                           
000950               MOVE ZERO TO PV-RETAIL-AMT                                 
000960*              COMPUTE PV-RETAIL-AMT                                      
000970*                    = (ML009I-NEW-PRICE-40                               
000980*                    -  ML009I-OLD-PRICE-40)                              
000990*                    *  ML009I-QUANTITY-40                                
001000           END-IF                                                         
001010           EVALUATE TRUE                                                  
001020               WHEN ML009I-CATEGORY-40 = '1'                              
001030                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT1                     
001040               WHEN ML009I-CATEGORY-40 = '2'                              
001050                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT2                     
001060               WHEN ML009I-CATEGORY-40 = '3'                              
001070                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT3                     
001080               WHEN ML009I-CATEGORY-40 = '4'                              
001090                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT4                     
001100               WHEN ML009I-CATEGORY-40 = '5'                              
001110                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT5                     
001120               WHEN OTHER                                                 
001130                   ADD PV-RETAIL-AMT TO PV-ACCUM-AMT6                     
001140           END-EVALUATE                                                   
001150         END-IF                                                           
001160         READ INPUT-FILE INTO ML009I-MARKDOWN-RECORDS                     
001170             AT END SET PS-END-OF-INPUT-FILE TO TRUE                      
001180         END-READ                                                         
001190     END-PERFORM.                                                         
001200                                                                          
001210     MOVE PV-RECORD-COUNT TO PV-DISPLAY-COUNT.                            
001220     DISPLAY '# RECORDS   : ' PV-DISPLAY-COUNT.                           
001230     MOVE PV-ACCUM-AMT1  TO PV-DISPLAY-AMT.                               
001240     DISPLAY 'TOTAL AMOUNT 1: ' PV-DISPLAY-AMT.                           
001250     MOVE PV-ACCUM-AMT2  TO PV-DISPLAY-AMT.                               
001260     DISPLAY 'TOTAL AMOUNT 2: ' PV-DISPLAY-AMT.                           
001270     MOVE PV-ACCUM-AMT3  TO PV-DISPLAY-AMT.                               
001280     DISPLAY 'TOTAL AMOUNT 3: ' PV-DISPLAY-AMT.                           
001290     MOVE PV-ACCUM-AMT4  TO PV-DISPLAY-AMT.                               
001300     DISPLAY 'TOTAL AMOUNT 4: ' PV-DISPLAY-AMT.                           
001310     MOVE PV-ACCUM-AMT5  TO PV-DISPLAY-AMT.                               
001320     DISPLAY 'TOTAL AMOUNT 5: ' PV-DISPLAY-AMT.                           
001330     MOVE PV-ACCUM-AMT6  TO PV-DISPLAY-AMT.                               
001340     DISPLAY 'TOTAL AMOUNT 6: ' PV-DISPLAY-AMT.                           
001350     CLOSE INPUT-FILE.                                                    
001360                                                                          
001370     STOP RUN.                                                            
