000100 IDENTIFICATION DIVISION.                                         00010029
000200 PROGRAM-ID.    RCKCS218.                                         00020029
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030029
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040029
000500 DATE-WRITTEN.  02-26-94                                          00050029
000600 DATE-COMPILED.                                                   00060029
000700******************************************************************00070029
000800*    E218 - STORE DISTRIBUTION LIST                               00080029
000900*                                                                 00090029
001000*    DISPLAYS ALL STORE DISTRIBUTION FOR A RECEIVER.              00100029
001100*                                                                 00110029
001200*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN     00120029
001300*        ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE00130029
001400*        LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE    00140029
001500*        UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE 00150029
001600*        IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.  00160029
001700*                                                                 00170029
001800*    DC-154: DISABLE THE F22 KEY AND PROTECT THE SEL BYTES IF:    00180029
001900*               THIS PROGRAM ENTERED VIA VERIFY AND               00190029
002000*                    RECEIVER STATUS NOT EQUAL 'VE' OR            00200029
002100*                    ANY OF THE POST DATES NOT EQUAL DEFAULT      00210029
002200*            OR THIS PROGRAM ENTERED VIA WORK ORDER AND           00220029
002300*                    THE RECEIVER OR RECEIPT ITEM STATUS = 'VE'   00230029
002400*            BY M. FURLICK 6/23/94.                               00240029
002500*                                                                 00250029
002600*    DC-XXX: SET PURITM AND PURCHS BACK TO 'IP' IF:               00260029
002700*               THE CURRENT STATUS IS 'CM' AND                    00270029
002800*                   RECDIS AP-VERIFY-COUNT HAS BEEN ADJUSTED      00280029
002900*                   AND IS NOW LESS THAN PURITM UNIT QUANTITY.    00290029
003000*            BY M. FURLICK 7/02/94.                               00300029
003100*                                                                 00310029
003200******************************************************************00320029
003210*---------------------------------------------------------------* 00321066
003220* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00322067
003230* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00323067
003240* MAKING THE CALL DYNAMIC VS STATIC.                              00324067
003250*---------------------------------------------------------------* 00325067
003300 ENVIRONMENT DIVISION.                                            00330029
003400 DATA DIVISION.                                                   00340029
003500 WORKING-STORAGE SECTION.                                         00350029
003600                                                                  00360029
003700 01  PC-PROGRAM-CONSTANTS.                                        00370029
003800     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC218A  '. 00380029
003900     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM218 '. 00390029
004000     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS218'. 00400029
004100     05  PC-AUDIT-RTN                 PIC X(8)  VALUE 'RCKCS290'. 00410029
004200     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE  +300       00420029
004300                                                COMP SYNC.        00430029
004400     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00440029
004500     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00450029
004600     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +10         00460029
004700                                                COMP SYNC.        00470029
004800     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00480029
004900                                                COMP SYNC.        00490029
005000     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00500029
005100                                                COMP SYNC.        00510029
005200     05  PC-01                        PIC X(02) VALUE '01'.       00520029
005300     05  PC-CM                        PIC X(02) VALUE 'CM'.       00530029
005400     05  PC-RV                        PIC X(02) VALUE 'RV'.       00540029
005500     05  PC-VE                        PIC X(02) VALUE 'VE'.       00550029
005600     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00560029
005700     05  PC-I                         PIC X(01) VALUE 'I'.        00570029
005800     05  PC-A                         PIC X(01) VALUE 'A'.        00580029
005900     05  PC-N                         PIC X(01) VALUE 'N'.        00590029
006000     05  PC-DASH                      PIC X(01) VALUE '-'.        00600029
006100     05  PC-000                       PIC X(03) VALUE '000'.      00610067
006200     05  PC-999                       PIC X(03) VALUE '999'.      00620067
006300     05  PC-INTER-APPL-CODES.                                     00630067
006400         10  PC-INTER-APPL-WO         PIC X(01) VALUE '1'.        00640067
006500         10  PC-INTER-APPL-VERIFY     PIC X(01) VALUE '2'.        00650067
006600         10  PC-INTER-APPL-ITM-LST    PIC X(01) VALUE '3'.        00660067
006700         10  PC-INTER-APPL-ITM-ADD-LST PIC X(01) VALUE '4'.       00670067
006800         10  PC-INTER-APPL-ITM-ADD    PIC X(01) VALUE '5'.        00680067
006900         10  PC-INTER-APPL-DISTRO     PIC X(01) VALUE '6'.        00690067
007000                                                                  00700067
007100     05  PC-TSYMSG-NUMBERS.                                       00710067
007200         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00720067
007300*            INVALID VALUE                                        00730067
007400         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00740067
007500*            MUST BE NUMERIC                                      00750067
007600         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00760067
007700*            NO END OF RANGE HAS BEEN SPECIFIED                   00770067
007800         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00780067
007900*            END OF RANGE PRECEDES START OF RANGE                 00790067
008000         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00800067
008100*            NO START OF RANGE HAS BEEN SPECIFIED                 00810067
008200         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00820067
008300*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00830067
008400         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00840067
008500*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00850067
008600         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00860067
008700*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00870067
008800         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00880067
008900*            UPDATE(S) SUCCESSFUL                                 00890067
009000         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00900067
009100*            TOP OF LIST                                          00910067
009200         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00920067
009300*            BOTTOM OF LIST                                       00930067
009400         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00940067
009500*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00950067
009600         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00960067
009700*            MORE ITEMS TO DISPLAY                                00970067
009800         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      00980067
009900*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 00990067
010000*            CALL HELP DESK                                       01000067
010100         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      01010067
010200*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         01020067
010300         10  PC-TSYMSG-00866          PIC 9(5)  VALUE 00866.      01030067
010400*            RCVR LNE QTY AND DISTR LNE QTY MUST MATCH            01040067
010500         10  PC-TSYMSG-01858          PIC 9(5)  VALUE 01858.      01050067
010600*            UNABLE TO UPDATE STORE DISTROS, CASEPACK SPLIT HAS   01060067
010700*            BEEN PERFORMED                                       01070067
010800         10  PC-TSYMSG-02184            PIC  9(05)  VALUE 02184.  01080067
010900*        INVALID FUNCTION FOR PACK TYPE "M" OR "I".               01090067
011000         10  PC-TSYMSG-02194            PIC  9(05)  VALUE 02194.  01100067
011100*        INVALID USE OF SCREEN WITH "M" OR "I" PACKAGING CODES.   01110067
011200                                                                  01120067
011300         10  PC-TSYMSG-02747            PIC  9(05)  VALUE 02747.  01130067
011400* UNABLE TO UPDATE STORE DISTROS, SMOOTHING HAS BEEN PERFORMED    01140067
011500         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01150067
011600         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01160067
011700* JAK 05/2007 - ADD PROGRAM CONSTANTS                             01170054
011800     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.01180054
011900* JAK 05/2007 - END                                               01190054
012000                                                                  01200029
012100 01  PS-PROGRAM-SWITCHES.                                         01210029
012200     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01220029
012300         88  PS-NO-ERROR                        VALUE 'N'.        01230029
012400         88  PS-ERROR                           VALUE 'Y'.        01240029
012500     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01250029
012600         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01260029
012700         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01270029
012800     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01280029
012900         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01290029
013000         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01300029
013100     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01310029
013200         88  PS-CALL-API-NO                     VALUE 'N'.        01320029
013300         88  PS-CALL-API-YES                    VALUE 'Y'.        01330029
013400     05  PS-RECITM-DATA-SW            PIC  X    VALUE 'Y'.        01340046
013500         88  PS-YES-RECITM-DATA                 VALUE 'Y'.        01350046
013600         88  PS-NO-RECITM-DATA                  VALUE 'N'.        01360046
013700* JAK 05/2007 - ADD SWITCHES                                      01370054
013800     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        01380054
013900         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        01390054
014000         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        01400054
014100     05  PS-DISTRO-TRBL-SW            PIC X(01) VALUE 'N'.        01410054
014200         88  PS-DISTRO-TRBL-YES                 VALUE 'Y'.        01420054
014300         88  PS-DISTRO-TRBL-NO                  VALUE 'N'.        01430054
014400* JAK 05/2007 - END                                               01440054
014500                                                                  01450029
014600 01  DK-DB2-KEYS.                                                 01460029
014700     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01470029
014800     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    01480029
014900     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01490029
015000     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    01500029
015100                                                                  01510029
015200 01  PV-PROGRAM-VARIABLES.                                        01520029
015300     05  PV-SUB                       PIC S9(4) VALUE ZERO        01530029
015400                                                COMP SYNC.        01540029
015500     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01550029
015600                                                COMP SYNC.        01560029
015700     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01570029
015800                                                COMP-3.           01580029
015900     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01590029
016000                                                COMP-3.           01600029
016100     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01610029
016200                                                COMP-3.           01620029
016300     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01630029
016400                                                COMP-3.           01640029
016500     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01650029
016600                                                COMP-3.           01660029
016700     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01670029
016800                                                COMP-3.           01680029
016900     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01690029
017000                                                COMP-3.           01700029
017100     05  PV-SMOOTH-COUNT              PIC S9(9) VALUE ZERO        01710029
017200                                                COMP-3.           01720029
017300     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01730029
017400                                                COMP SYNC.        01740029
017500     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01750029
017600                                                COMP SYNC.        01760029
017700     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01770029
017800                                                COMP SYNC.        01780029
017900     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01790029
018000                                                COMP SYNC.        01800029
018100     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01810029
018200                                                COMP SYNC.        01820029
018300     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01830029
018400                                                COMP SYNC.        01840029
018500     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01850029
018600                                                COMP SYNC.        01860029
018700     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01870029
018800                                                COMP SYNC.        01880029
018900     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01890029
019000                                                COMP SYNC.        01900029
019100     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01910029
019200                                                COMP SYNC.        01920029
019300     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01930029
019400                                                COMP SYNC.        01940029
019500     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01950029
019600                                                COMP SYNC.        01960029
019700     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01970029
019800                                                COMP SYNC.        01980029
019900     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01990029
020000                                                COMP SYNC.        02000029
020100     05  PV-DISTR-LNE-QTY             PIC S9(9) VALUE ZERO        02010029
020200                                                COMP SYNC.        02020029
020300     05  PV-SKU-NBR.                                              02030029
020400         10  PV-SN-DEPT-NBR           PIC  X(03).                 02040031
020500         10  FILLER                   PIC  X(01)  VALUE SPACE.    02050031
020600         10  PV-SN-CL-NBR             PIC  X(02).                 02060031
020700         10  FILLER                   PIC  X(01)  VALUE SPACE.    02070031
020800         10  PV-SN-SEQ-NBR            PIC  X(08).                 02080031
020900                                                                  02090029
021000     05  PV-TEMP-SEQ-NBR              PIC  9(08).                 02100031
021100     05  PV-UNPACK-OPER-UNT-ID        PIC  9(04).                 02110051
021200     05  DK-SKU-SEQ                   PIC  X(03).                 02120029
021300     05  DK-ITM-NBR                   PIC  S9(15)V COMP-3.        02130029
021400     05  PV-AD-DATE-MM-DD-CCYY.                                   02140029
021500         10  PV-AD-DATE-MM            PIC X(02) VALUE SPACES.     02150029
021600         10  FILLER                   PIC X(01) VALUE '-'.        02160029
021700         10  PV-AD-DATE-DD            PIC X(02) VALUE SPACES.     02170029
021800         10  FILLER                   PIC X(01) VALUE '-'.        02180029
021900         10  PV-AD-DATE-CCYY          PIC X(04) VALUE SPACES.     02190029
022000     05  PV-DB2-DATE-FORMAT           PIC X(10).                  02200029
022100     05  PV-DB2-DATE-FORMAT-REDE.                                 02210029
022200         10  PV-DB2-CCYY.                                         02220029
022300             15  PV-DB2-CC            PIC X(02) VALUE SPACES.     02230029
022400             15  PV-DB2-YY            PIC X(02) VALUE SPACES.     02240029
022500         10  FILLER                   PIC X(01) VALUE '-'.        02250029
022600         10  PV-DB2-MM                PIC X(02) VALUE SPACES.     02260029
022700         10  FILLER                   PIC X(01) VALUE '-'.        02270029
022800         10  PV-DB2-DD                PIC X(02) VALUE SPACES.     02280029
022900     05  PV-SCREEN-DATE-FORMAT.                                   02290029
023000         10  PV-SCREEN-DATE-MM        PIC X(02) VALUE SPACES.     02300029
023100         10  PV-SCREEN-DATE-DD        PIC X(02) VALUE SPACES.     02310029
023200         10  PV-SCREEN-DATE-YY        PIC X(02) VALUE SPACES.     02320029
023300     05  PV-CHECK-FOR-DEFAULT-DATE    PIC X(10) VALUE SPACES.     02330029
023400         88  PV-DEFAULT-DATE                    VALUES            02340029
023500                                                '0001-01-01',     02350029
023600                                                '9999-09-09'.     02360029
023700     05  PV-DB2-CURRENT-TMST          PIC X(26).                  02370029
023800* JAK 05/2007 - ADD PROGRAM VARIABLES                             02380054
023900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02390054
024000                                                     COMP SYNC.   02400054
024100     05  PV-SQL-CNT                     PIC S9(04)   VALUE +0     02410054
024200                                                    COMP.         02420054
024300* JAK 05/2007 - END                                               02430054
024400                                                                  02440029
024500 01  MSG-QUEUE-ITEM.                                              02450029
024600     05  FILLER                       PIC X(11)  VALUE            02460029
024700         'QUEUE NAME '.                                           02470029
024800     05  MSG-QUEUE-NAME               PIC X(08).                  02480029
024900     05  FILLER                       PIC X(14)  VALUE            02490029
025000         '  ITEM NUMBER '.                                        02500029
025100     05  MSG-SEL-ITEM                 PIC 9(04).                  02510029
025200                                                                  02520029
025300 01  MSG1-PO-REC.                                                 02530029
025400     05  FILLER                       PIC X(07)  VALUE            02540029
025500         'PO NBR '.                                               02550029
025600     05  MSG1-PO-NBR                  PIC 9(09).                  02560029
025700     05  FILLER                       PIC X(11)  VALUE            02570029
025800         '  REC SEQ  '.                                           02580029
025900     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  02590029
026000     05  FILLER                       PIC X(12)  VALUE            02600029
026100         '  OPER UNIT '.                                          02610029
026200     05  MSG1-OPER-UNT-ID             PIC X(04).                  02620029
026300     05  FILLER                       PIC X(11)  VALUE            02630029
026400         '  FACILITY '.                                           02640029
026500     05  MSG1-FACILITY-ID             PIC X(04).                  02650029
026600                                                                  02660029
026700                                                                  02670029
026800 01  LQW-LIST-QUEUE-WORK-AREA.                                    02680029
026900     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02690029
027000     05  LQW-ITEM-ENTRIES             OCCURS 10 TIMES             02700029
027100                                      INDEXED BY LQW-IDX.         02710029
027200         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02720029
027300         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02730029
027400         10  LQW-SELECTED-SW          PIC X(01).                  02740029
027500             88  LQW-SELECT                      VALUE 'S'.       02750029
027600             88  LQW-DESELECT                    VALUE ' '.       02760029
027700         10  LQW-STR-QTY-PREV         PIC 9(05).                  02770029
027800         10  LQW-STR-QTY              PIC 9(05).                  02780029
027900         10  LQW-STR-NBR              PIC 9(04).                  02790029
028000         10  LQW-EXPTED-ITM-QTY       PIC 9(05).                  02800029
028100         10  LQW-OTR                  PIC 9(06).                  02810029
028200         10  LQW-OTR-N                PIC S9(9)                   02820029
028300                                         COMP-3.                  02830029
028400         10  LQW-UNT-QTY              PIC 9(06).                  02840029
028500         10  LQW-VERFD-QTY            PIC 9(05).                  02850029
028600         10  LQW-STATUS               PIC X(02).                  02860029
028700         10  LQW-STATUS2              PIC X(02).                  02870029
028800         10  LQW-LAST-QTY-REC         PIC 9(06).                  02880029
028900         10  LQW-LAST-DTE-REC         PIC X(06).                  02890029
029000         10  LQW-PRIOR-QTY-REC        PIC 9(06).                  02900029
029100         10  LQW-PRIOR-DTE-REC        PIC X(06).                  02910029
029200         10  LQW-MORE                 PIC X(01).                  02920029
029300                                                                  02930029
029400******************************************************************02940029
029500*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02950029
029600******************************************************************02960029
029700     COPY RCWS013.                                                02970038
029800                                                                  02980029
029900*---------------------------------------------------------------* 02990039
030000*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 03000039
030100*---------------------------------------------------------------* 03010039
030200     COPY RCWS074.                                                03020039
030300                                                                  03030039
030400***************************************************************** 03040039
030500*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 03050039
030600*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 03060039
030700***************************************************************** 03070039
030800     COPY RCWS040.                                                03080039
030900                                                                  03090039
031000******************************************************************03100029
031100*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                  03110029
031200******************************************************************03120029
031300     COPY RCWS031.                                                03130029
031400                                                                  03140029
031500******************************************************************03150029
031600*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        03160029
031700******************************************************************03170029
031800     COPY PCWS016.                                                03180038
031900                                                                  03190029
032000* JAK 05/2007 - ADD COPYBOOK FOR SHIPPING CONTROL MODULE          03200054
032100***************************************************************** 03210054
032200*  RECORD LAYOUT 'SHIPPING CONTROL MODULE' - WSKCS305             03220054
032300***************************************************************** 03230054
032400     COPY WSWS001.                                                03240054
032500                                                                  03250054
032600******************************************************************03260029
032700*    BMS MAP                                                      03270029
032800******************************************************************03280029
032900     COPY RCKM218.                                                03290029
033000                                                                  03300029
033100 01  MR-OCCURS-LAYOUT                 REDEFINES RC218AO.          03310029
033200*    05  FILLER                       PIC X(389).                 03320030
033300** CHG0094517  CHANGED FILLER FROM 394 TO 395                     03330065
033400     05  FILLER                       PIC X(395).                 03340063
033500                                                                  03350029
033600     05  MR-SCROLL-AREA               OCCURS 10 TIMES.            03360029
033700         10  MR-SELECTL               PIC S9(4) COMP.             03370029
033800         10  MR-SELECTA               PIC X.                      03380029
033900         10  MR-SELECTC               PIC X.                      03390029
034000         10  MR-SELECTH               PIC X.                      03400029
034100         10  MR-SELECTI               PIC X.                      03410029
034200                                                                  03420029
034300         10  MR-STR-QTY-L             PIC S9(4) COMP.             03430029
034400         10  MR-STR-QTY-A             PIC X.                      03440029
034500         10  MR-STR-QTY-C             PIC X.                      03450029
034600         10  MR-STR-QTY-H             PIC X.                      03460029
034700         10  MR-STR-QTY.                                          03470029
034800             15  MR-STR-QTY-EDITED    PIC ZZZZ9.                  03480029
034900                                                                  03490029
035000         10  MR-STR-NBR-L             PIC S9(4) COMP.             03500029
035100         10  MR-STR-NBR-A             PIC X.                      03510029
035200         10  MR-STR-NBR-C             PIC X.                      03520029
035300         10  MR-STR-NBR-H             PIC X.                      03530029
035400         10  MR-STR-NBR               PIC X(04).                  03540029
035500                                                                  03550029
035600         10  MR-EXPTED-ITM-QTY-L      PIC S9(4) COMP.             03560029
035700         10  MR-EXPTED-ITM-QTY-A      PIC X.                      03570029
035800         10  MR-EXPTED-ITM-QTY-C      PIC X.                      03580029
035900         10  MR-EXPTED-ITM-QTY-H      PIC X.                      03590029
036000         10  MR-EXPTED-ITM-QTY.                                   03600029
036100             15  MR-EXPTED-ITM-QTY-EDITED                         03610029
036200                                      PIC ZZZZ9.                  03620029
036300                                                                  03630029
036400         10  MR-OTR-L                 PIC S9(4) COMP.             03640029
036500         10  MR-OTR-A                 PIC X.                      03650029
036600         10  MR-OTR-C                 PIC X.                      03660029
036700         10  MR-OTR-H                 PIC X.                      03670029
036800         10  MR-OTR                   PIC X(6).                   03680029
036900                                                                  03690029
037000         10  MR-ORDER-QTY-L           PIC S9(4) COMP.             03700029
037100         10  MR-ORDER-QTY-A           PIC X.                      03710029
037200         10  MR-ORDER-QTY-C           PIC X.                      03720029
037300         10  MR-ORDER-QTY-H           PIC X.                      03730029
037400         10  MR-ORDER-QTY             PIC X(6).                   03740029
037500                                                                  03750029
037600         10  MR-VERFD-QTY-L           PIC S9(4) COMP.             03760029
037700         10  MR-VERFD-QTY-A           PIC X.                      03770029
037800         10  MR-VERFD-QTY-C           PIC X.                      03780029
037900         10  MR-VERFD-QTY-H           PIC X.                      03790029
038000         10  MR-VERFD-QTY.                                        03800029
038100             15  MR-VERFD-QTY-EDITED  PIC ZZZZ9.                  03810029
038200                                                                  03820029
038300         10  FILLER                   PIC X(6).                   03830029
038400                                                                  03840029
038500         10  MR-STATUS-L              PIC S9(4) COMP.             03850029
038600         10  MR-STATUS-A              PIC X.                      03860029
038700         10  MR-STATUS-C              PIC X.                      03870029
038800         10  MR-STATUS-H              PIC X.                      03880029
038900         10  MR-STATUS                PIC X(02).                  03890029
039000                                                                  03900029
039100         10  MR-LAST-QTY-REC-L        PIC S9(4) COMP.             03910029
039200         10  MR-LAST-QTY-REC-A        PIC X.                      03920029
039300         10  MR-LAST-QTY-REC-C        PIC X.                      03930029
039400         10  MR-LAST-QTY-REC-H        PIC X.                      03940029
039500         10  MR-LAST-QTY-REC.                                     03950029
039600             15  MR-LAST-QTY-REC-EDITED                           03960029
039700                                      PIC ZZZZZ9.                 03970029
039800                                                                  03980029
039900         10  MR-LAST-DTE-REC-L        PIC S9(4) COMP.             03990029
040000         10  MR-LAST-DTE-REC-A        PIC X.                      04000029
040100         10  MR-LAST-DTE-REC-C        PIC X.                      04010029
040200         10  MR-LAST-DTE-REC-H        PIC X.                      04020029
040300         10  MR-LAST-DTE-REC          PIC X(06).                  04030029
040400                                                                  04040029
040500         10  MR-STATUS2-L             PIC S9(4) COMP.             04050029
040600         10  MR-STATUS2-A             PIC X.                      04060029
040700         10  MR-STATUS2-C             PIC X.                      04070029
040800         10  MR-STATUS2-H             PIC X.                      04080029
040900         10  MR-STATUS2               PIC X(02).                  04090029
041000                                                                  04100029
041100         10  MR-PRIOR-QTY-REC-L       PIC S9(4) COMP.             04110029
041200         10  MR-PRIOR-QTY-REC-A       PIC X.                      04120029
041300         10  MR-PRIOR-QTY-REC-C       PIC X.                      04130029
041400         10  MR-PRIOR-QTY-REC-H       PIC X.                      04140029
041500         10  MR-PRIOR-QTY-REC.                                    04150029
041600             15  MR-PRIOR-QTY-REC-EDITED                          04160029
041700                                      PIC ZZZZZ9.                 04170029
041800                                                                  04180029
041900         10  MR-PRIOR-DTE-REC-L       PIC S9(4) COMP.             04190029
042000         10  MR-PRIOR-DTE-REC-A       PIC X.                      04200029
042100         10  MR-PRIOR-DTE-REC-C       PIC X.                      04210029
042200         10  MR-PRIOR-DTE-REC-H       PIC X.                      04220029
042300         10  MR-PRIOR-DTE-REC         PIC X(06).                  04230029
042400                                                                  04240029
042500         10  MR-MORE-L                PIC S9(4) COMP.             04250029
042600         10  MR-MORE-A                PIC X.                      04260029
042700         10  MR-MORE-C                PIC X.                      04270029
042800         10  MR-MORE-H                PIC X.                      04280029
042900         10  MR-MORE                  PIC X(01).                  04290029
043000     05 FILLER                        PIC X(12).                  04300029
043100                                                                  04310029
043200/                                                                 04320029
043300*----------------------------------------------------------------*04330029
043400**  SECURITY SUBROUTINE PARAMETERS                                04340029
043500*----------------------------------------------------------------*04350029
043600     COPY DPWS008.                                                04360038
043700******************************************************************04370029
043800*    BMS ATTRIBUTES                                               04380029
043900******************************************************************04390029
044000     COPY DPWS015.                                                04400038
044100                                                                  04410029
044200******************************************************************04420029
044300*    FUNCTION KEYS                                                04430029
044400******************************************************************04440029
044500     COPY DPWS016.                                                04450038
044600                                                                  04460029
044700******************************************************************04470029
044800*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   04480029
044900******************************************************************04490029
045000     COPY DPWS010I.                                               04500038
045100                                                                  04510029
045200*----------------------------------------------------------------*04520052
045300*  COPYBOOK FOR LOGISTICS DOMAIN LOCATION ACCESS MODULE (XLKUT071)04530052
045400*----------------------------------------------------------------*04540052
045500     COPY XLWS071.                                                04550052
045600                                                                  04560052
045700******************************************************************04570029
045800*    PARAMETER LIST FOR CICS API                                  04580029
045900******************************************************************04590029
046000     COPY DPWS030.                                                04600038
046010     COPY DPWS930.                                                04601067
046100                                                                  04610029
046200******************************************************************04620029
046300*    GLOBAL COMMUNICATION AREA                                    04630029
046400******************************************************************04640029
046500     COPY DPWS020.                                                04650038
046600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04660029
046700                                                                  04670029
046800******************************************************************04680029
046900*    INTER-APPLICATION COMMUNICATION AREA                         04690029
047000*    RCWS015 = INPUT FROM PACK SLIP LINE SUMMARY PROGRAM          04700029
047100******************************************************************04710029
047200         10  INTER-APPL-COMM-AREA       PIC X(200).               04720029
047300     COPY RCWS015.                                                04730038
047400     COPY PCWS000.                                                04740038
047500                                                                  04750029
047600******************************************************************04760029
047700*    APPLICATION SPECIFIC COMMUNICATION AREA                      04770029
047800******************************************************************04780029
047900         10  ASC-SPECIFIC-COMMAREA.                               04790029
048000             15  ASC-LIST-HEADER-INFO.                            04800029
048100                 20  ASC-KEY-RECEIVER.                            04810029
048200                     25  ASC-KEY-PO-NBR.                          04820029
048300** CHG0094517  CHANGED PO-NBR FROM 7 TO 8                         04830065
048400                         30  ASC-KEY-PO-NBR-N   PIC 9(08).        04840063
048500                     25  ASC-KEY-REC-DASH       PIC X(01).        04850029
048600                     25  ASC-KEY-REC-SEQ-NBR.                     04860029
048700                         30  ASC-KEY-REC-SEQ-NBR-N                04870029
048800                                                PIC 9(04).        04880029
048900                 20  ASC-KEY-PKSL-LNE-NBR       PIC 9(04).        04890029
049000                 20  ASC-KEY-PKGNG-CDE          PIC X(01).        04900029
049100                     88  ASC-PREPACK                 VALUE 'M'    04910029
049200                                                           'I'.   04920029
049300                 20  ASC-KEY-AD-EVNT-DTE        PIC X(10).        04930029
049400                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        04940029
049500                 20  ASC-KEY-REC-LNE-QTY        PIC 9(06).        04950029
049600                 20  ASC-KEY-INNR-PACK-QTY      PIC 9(03).        04960029
049700                 20  ASC-KEY-CASE-PACK-QTY      PIC 9(03).        04970029
049800                 20  ASC-KEY-DISTR-LNE-QTY      PIC 9(06).        04980029
049900                 20  ASC-KEY-TOTAL-OTR          PIC Z(05)9.       04990029
050000                 20  ASC-KEY-TOTAL-OTR-X REDEFINES                05000029
050100                     ASC-KEY-TOTAL-OTR          PIC X(06).        05010029
050200                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   05020029
050300                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   05030029
050400                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   05040029
050500                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        05050029
050600                 20  ASC-KEY-PKSL-NBR           PIC X(10).        05060029
050700             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               05070029
050800                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       05080029
050900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05090029
051000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05100029
051100                                                                  05110029
051200                 20  ASC-ITEM-ARRAY.                              05120029
051300                     25  ASC-ITEM-ENTRIES  OCCURS 10 TIMES.       05130029
051400                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    05140029
051500                                                     COMP-3.      05150029
051600                         30  ASC-TEMP-SELECTED-SW    PIC X.       05160029
051700                             88  ASC-VALID-SELECT    VALUE ' '    05170029
051800                                                           'S'    05180029
051900                                                           'B'    05190029
052000                                                           'E'.   05200029
052100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05210029
052200                             88  ASC-TEMP-SELECT     VALUE 'S'.   05220029
052300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05230029
052400                             88  ASC-TEMP-END        VALUE 'E'.   05240029
052500                         30  ASC-SELECTED-SW         PIC  X.      05250029
052600                             88  ASC-NO-SELECT       VALUE ' '.   05260029
052700                             88  ASC-SELECT          VALUE 'S'.   05270029
052800                             88  ASC-BEGIN           VALUE 'B'.   05280029
052900                             88  ASC-END             VALUE 'E'.   05290029
053000                         30  ASC-STR-QTY-PREV        PIC 9(05).   05300029
053100                         30  ASC-STR-QTY             PIC X(05).   05310029
053200                         30  ASC-STR-QTY-N REDEFINES ASC-STR-QTY  05320029
053300                                                 PIC 9(05).       05330029
053400                         30  ASC-STR-NBR             PIC X(04).   05340029
053500                         30  ASC-STR-NBR-N REDEFINES ASC-STR-NBR  05350029
053600                                                     PIC 9(04).   05360029
053700                         30  ASC-EXPTED-ITM-QTY.                  05370029
053800                             35  ASC-EXPTED-ITM-QTY-N             05380029
053900                                                     PIC 9(05).   05390029
054000                         30  ASC-OTR                 PIC X(6).    05400029
054100                         30  ASC-OTR-N               PIC S9(9)    05410029
054200                                                         COMP-3.  05420029
054300                         30  ASC-UNT-QTY             PIC X(6).    05430029
054400                         30  ASC-VERFD-QTY.                       05440029
054500                             35  ASC-VERFD-QTY-N     PIC 9(05).   05450029
054600                         30  ASC-STATUS              PIC X(02).   05460029
054700                         30  ASC-STATUS-2            PIC X(02).   05470029
054800                         30  ASC-LAST-QTY-REC.                    05480029
054900                             35  ASC-LAST-QTY-REC-N  PIC 9(06).   05490029
055000                         30  ASC-LAST-DTE-REC        PIC X(06).   05500029
055100                         30  ASC-PRIOR-QTY-REC.                   05510029
055200                             35  ASC-PRIOR-QTY-REC-N PIC 9(06).   05520029
055300                         30  ASC-PRIOR-DTE-REC       PIC X(06).   05530029
055400                         30  ASC-MORE                PIC X(01).   05540029
055500                                                                  05550029
055600             15  ASC-BLK-SUB                         PIC S9(4)    05560029
055700                                                     COMP SYNC.   05570029
055800             15  ASC-ITEM-SUB                        PIC S9(4)    05580029
055900                                                     COMP SYNC.   05590029
056000             15  ASC-SEL-SUB                         PIC S9(4)    05600029
056100                                                     COMP.        05610029
056200             15  ASC-SEL-ITEM                        PIC S9(4)    05620029
056300                                                     COMP.        05630029
056400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    05640029
056500                                                     COMP-3.      05650029
056600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    05660029
056700                                                     COMP-3.      05670029
056800             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    05680029
056900                                                     COMP-3.      05690029
057000             15  ASC-ITEMS-DISPLAYED                 PIC S999     05700029
057100                                                     COMP-3.      05710029
057200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    05720029
057300                                                     COMP-3.      05730029
057400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    05740029
057500                                                     COMP-3.      05750029
057600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    05760029
057700                                                     COMP SYNC.   05770029
057800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    05780029
057900                                                     COMP-3.      05790029
058000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    05800029
058100                                                     COMP-3.      05810029
058200             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       05820029
058300                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05830029
058400                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05840029
058500             15  ASC-UPDATE-SW                       PIC X.       05850029
058600                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   05860029
058700                 88  ASC-CANT-UPDATE                 VALUE 'N'.   05870029
058800             15  ASC-LIST-QUEUE-NAME.                             05880029
058900                 20  ASC-LIST-TERM-ID                PIC X(4).    05890029
059000                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    05900029
059100                                                     COMP-3.      05910029
059200                 20  ASC-LIST-SEQ                    PIC 9.       05920029
059300             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    05930029
059400             15  ASC-SEL-QUEUE-NAME-OUT.                          05940029
059500                 20  ASC-SEL-TERM-ID                 PIC X(4).    05950029
059600                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    05960029
059700                                                     COMP-3.      05970029
059800                 20  ASC-SEL-SEQ                     PIC 9.       05980029
059900             15  ASC-START-ITEM-REQUEST.                          05990029
060000                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    06000029
060100             15  ASC-RECDIS-SW                       PIC X.       06010029
060200                 88  ASC-MORE-RECDIS                 VALUE 'Y'.   06020029
060300                 88  ASC-NO-MORE-RECDIS              VALUE 'N'.   06030029
060400             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    06040029
060500                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   06050029
060600             15  ASC-SKU-NBR                         PIC X(15).   06060029
060700             15  ASC-VEND-STYL-NAME                  PIC X(20).   06070029
060800             15  ASC-PURCHS-STATUS-CDE               PIC X(02).   06080029
060900             15  ASC-PURITM-STATUS-CDE               PIC X(02).   06090029
061000             15  ASC-PURITM-UNT-QTY                  PIC S9(9)    06100029
061100                                                         COMP.    06110029
061200             15  ASC-HOLD-INTER-APPL                 PIC X(200).  06120029
061300             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   06130029
061400                 88  ASC-INTER-APPL-WO-LIST          VALUE '1'.   06140029
061500                 88  ASC-INTER-APPL-VERIFY           VALUE '2'.   06150029
061600                 88  ASC-INTER-APPL-ITM-LST          VALUE '3'.   06160029
061700                 88  ASC-INTER-APPL-ITM-ADD-LST      VALUE '4'.   06170029
061800                 88  ASC-INTER-APPL-ITM-ADD          VALUE '5'.   06180029
061900                 88  ASC-INTER-APPL-DISTRO           VALUE '6'.   06190029
062000             15 ASC-TRBL-FOUND-SW                    PIC  X.      06200029
062100                 88 ASC-TRBL-EXISTS             VALUE 'Y'.        06210029
062200                 88 ASC-NO-TRBL-EXISTS          VALUE 'N'.        06220029
062300             15  ASC-AUTO-VE-SW                      PIC X.       06230039
062400                 88  ASC-AUTO-VE-YES            VALUE 'Y'.        06240039
062500                 88  ASC-AUTO-VE-NO             VALUE 'N'.        06250039
062600/                                                                 06260029
062700******************************************************************06270029
062800*    ABEND PROCESSING                                             06280029
062900******************************************************************06290029
063000     COPY DPWS013.                                                06300038
063100/                                                                 06310029
063200*----------------------------------------------------------------*06320030
063300*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               06330036
063400*----------------------------------------------------------------*06340030
063500     COPY XLWS001.                                                06350029
063600*----------------------------------------------------------------*06360030
063700******************************************************************06370029
063800*    DB2 SQL COMMUNICATION AREA                                   06380029
063900******************************************************************06390029
064000     EXEC SQL                                                     06400029
064100          INCLUDE SQLCA                                           06410029
064200     END-EXEC.                                                    06420029
064300/                                                                 06430029
064400******************************************************************06440029
064500*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          06450029
064600******************************************************************06460029
064700     EXEC SQL                                                     06470029
064800          INCLUDE TPURCHS                                         06480029
064900     END-EXEC.                                                    06490029
065000/                                                                 06500029
065100******************************************************************06510029
065200*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     06520029
065300******************************************************************06530029
065400     EXEC SQL                                                     06540029
065500          INCLUDE TPURITM                                         06550029
065600     END-EXEC.                                                    06560029
065700/                                                                 06570029
065800******************************************************************06580029
065900*    DB2 DCLGEN FOR RECEIVER TABLE                                06590029
066000******************************************************************06600029
066100     EXEC SQL                                                     06610029
066200          INCLUDE TRECEIV                                         06620029
066300     END-EXEC.                                                    06630029
066400/                                                                 06640029
066500******************************************************************06650029
066600*    DB2 DCLGEN FOR RECEIVER ITEM TABLE                           06660029
066700******************************************************************06670029
066800     EXEC SQL                                                     06680029
066900          INCLUDE TRECITM                                         06690029
067000     END-EXEC.                                                    06700029
067100/                                                                 06710029
067200******************************************************************06720029
067300*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   06730029
067400******************************************************************06740029
067500     EXEC SQL                                                     06750029
067600          INCLUDE TRECDIS                                         06760029
067700     END-EXEC.                                                    06770029
067800/                                                                 06780029
067900******************************************************************06790029
068000*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  06800029
068100******************************************************************06810029
068200     EXEC SQL                                                     06820029
068300          INCLUDE TENTNME                                         06830029
068400     END-EXEC.                                                    06840029
068500/                                                                 06850029
068600*----------------------------------------------------------------*06860029
068700*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06870029
068800*----------------------------------------------------------------*06880029
068900     EXEC SQL                                                     06890029
069000          INCLUDE TTRBNTF                                         06900029
069100     END-EXEC.                                                    06910029
069200/                                                                 06920029
069300* JAK 05/2007 - ADD TABLES FOR WMS CODE                           06930054
069400***************************************************************** 06940054
069500*    DB2 DCLGEN FOR PARM TABLE                                    06950054
069600***************************************************************** 06960054
069700     EXEC SQL                                                     06970054
069800          INCLUDE TKRPRPM                                         06980054
069900     END-EXEC.                                                    06990054
070000                                                                  07000054
070100***************************************************************** 07010054
070200*    DB2 DCLGEN FOR SHIPMENT TABLE                                07020054
070300***************************************************************** 07030054
070400     EXEC SQL                                                     07040054
070500          INCLUDE TSHIPMT                                         07050054
070600     END-EXEC.                                                    07060054
070700                                                                  07070054
070800***************************************************************** 07080054
070900*    DB2 DCLGEN FOR SHIPMENT PO TABLE                             07090054
071000***************************************************************** 07100054
071100     EXEC SQL                                                     07110054
071200          INCLUDE TSHPTPO                                         07120054
071300     END-EXEC.                                                    07130054
071400                                                                  07140054
071500* JAK 05/2007 - END                                               07150054
071600*----------------------------------------------------------------*07160029
071700*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      07170029
071800*----------------------------------------------------------------*07180029
071900     EXEC SQL                                                     07190029
072000          INCLUDE TTRBRSN                                         07200029
072100     END-EXEC.                                                    07210029
072200/                                                                 07220029
072300     EXEC SQL                                                     07230029
072400          INCLUDE TDISTHD                                         07240029
072500     END-EXEC.                                                    07250029
072600/                                                                 07260029
072700*  CARTON TABLES                                                  07270029
072800     EXEC SQL                                                     07280029
072900          INCLUDE SUT00028                                        07290034
073000     END-EXEC.                                                    07300029
073100     EXEC SQL                                                     07310029
073200          INCLUDE SUT00024                                        07320034
073300     END-EXEC.                                                    07330029
073400/                                                                 07340029
073500******************************************************************07350029
073600*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 07360029
073700******************************************************************07370029
073800     EXEC SQL                                                     07380029
073900          DECLARE RECDIS-CURSOR CURSOR FOR                        07390029
074000           SELECT EXPTED_ITM_QTY,                                 07400029
074100                  VERIFY_ITM_QTY,                                 07410029
074200                  AP_VERIFY_ITM_QTY,                              07420029
074300                  STR_NBR                                         07430029
074400             FROM TRECDIS                                         07440029
074500            WHERE ORD_NBR        = :DK-PO-NBR                     07450029
074600              AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR               07460029
074700              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                07470029
074800              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           07480029
074900              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              07490029
075100         ORDER BY STR_NBR                                         07510029
075200     END-EXEC.                                                    07520029
075300                                                                  07530029
075400******************************************************************07540029
075500*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PRIOR RCVR DISTRO     07550029
075600******************************************************************07560029
075700     EXEC SQL                                                     07570029
075800          DECLARE PRIOR-RCVR-CURSOR CURSOR FOR                    07580029
075900           SELECT DATE(A.REC_TMST)                                07590029
076000                , A.STATUS_CDE                                    07600029
076100                , B.EXPTED_ITM_QTY                                07610029
076200                , B.VERIFY_ITM_QTY                                07620029
076300                , B.AP_VERIFY_ITM_QTY                             07630029
076400                , C.STATUS_CDE                                    07640029
076500                , A.REC_SEQ_NBR                                   07650039
076600             FROM TRECEIV A                                       07660029
076700                , TRECDIS B                                       07670029
076800                , TRECITM C                                       07680029
076900            WHERE A.ORD_NBR        = :DK-PO-NBR                   07690029
077000              AND A.ORD_NBR        = B.ORD_NBR                    07700029
077100              AND A.ORD_NBR        = C.ORD_NBR                    07710029
077200                                                                  07720029
077300              AND B.ORD_LNE_NBR    = :DK-PKSL-LNE-NBR             07730029
077400              AND B.ORD_LNE_NBR    = C.ORD_LNE_NBR                07740029
077500                                                                  07750029
077600              AND A.REC_SEQ_NBR   ^= :DK-REC-SEQ-NBR              07760029
077700              AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR                07770029
077800              AND A.REC_SEQ_NBR    = C.REC_SEQ_NBR                07780029
077900                                                                  07790029
078000              AND A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID         07800029
078100              AND A.OPER_UNT_ID    = B.OPER_UNT_ID                07810029
078200                                                                  07820029
078300              AND A.FCLTY_ID       = :ASC-KEY-FCLTY-ID            07830029
078400              AND A.FCLTY_ID       = B.FCLTY_ID                   07840029
078500                                                                  07850029
078600              AND B.STR_NBR        = :DK-STR-NBR                  07860029
078700                                                                  07870029
078800              AND A.VER_STATUS_CDE = :PC-ACTIVE                   07880029
079000              AND C.VER_STATUS_CDE = :PC-ACTIVE                   07900029
079100                                                                  07910029
079200         ORDER BY A.STATUS_CDE, 1 DESC                            07920029
079300     END-EXEC.                                                    07930029
079400/                                                                 07940029
079500     COPY DPWS276.                                                07950038
079600/                                                                 07960029
079700 LINKAGE SECTION.                                                 07970029
079800                                                                  07980029
079900 01  DFHCOMMAREA.                                                 07990029
080000     05  FILLER                       OCCURS 1 TO 4072 TIMES      08000029
080100                                      DEPENDING ON EIBCALEN.      08010029
080200         10  FILLER                   PIC X.                      08020029
080300                                                                  08030029
080400                                                                  08040029
080500 PROCEDURE DIVISION.                                              08050029
080600                                                                  08060029
080700 0000-MAIN-MODULE.                                                08070029
080800                                                                  08080029
080900     INITIALIZE DP030-CICS-API-FIELDS.                            08090029
081000                                                                  08100029
081100     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         08110029
081200     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            08120029
081300     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           08130029
081400     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         08140029
081500     MOVE LENGTH OF RC218AI      TO DP030-MAP-LENGTH (1).         08150029
081600     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       08160029
081700     SET DP030-OVERRIDE-APPL-ERROR                                08170029
081800                                 TO TRUE.                         08180029
081900                                                                  08190029
082000     PERFORM 0001-CALL-CICS-ARCH-API.                             08200029
082100                                                                  08210029
082200     PERFORM 1000-CONTROL-PROCESSING.                             08220029
082300                                                                  08230029
082400     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       08240029
082500                                                                  08250029
082600     PERFORM 0001-CALL-CICS-ARCH-API.                             08260029
082700                                                                  08270029
082800 0001-CALL-CICS-ARCH-API.                                         08280029
082900                                                                  08290029
083010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08301067
083100                                    DFHCOMMAREA                   08310067
083200                                    DP030-CICS-API-FIELDS         08320067
083300                                    DP020-STANDARD-COMMAREA       08330067
083400                                    RC218AI.                      08340067
083500                                                                  08350029
083600     IF DP030-RC-CALL-SUCCESSFUL OR                               08360029
083700        DP030-RC-APPL-ERROR                                       08370029
083800         CONTINUE                                                 08380029
083900     ELSE                                                         08390029
084000         SET DP013-CICS-ABEND                                     08400029
084100             DP013-NO-ROLLBACK                                    08410029
084200             DP013-XCTL-DISPLAY-RESTART                           08420029
084300                                 TO TRUE                          08430029
084400         MOVE '0001-CALL-CICS-ARCH-API'                           08440029
084500                                 TO DP013-PARAGRAPH               08450029
084510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O08451067
084520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08452067
084800         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        08480029
084900                                                                  08490029
085000         PERFORM DP013-0000-PROCESS-ABEND.                        08500029
085100                                                                  08510029
085200 1000-CONTROL-PROCESSING.                                         08520029
085300                                                                  08530029
085400     EVALUATE TRUE                                                08540029
085500                                                                  08550029
085600         WHEN DP030-RC-APPL-ERROR                                 08560029
085700              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08570029
085800                                 TO PV-TOP-ITEM                   08580029
085900              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      08590029
086000                                                                  08600029
086100              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                08610029
086200                                                                  08620029
086300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  08630029
086400                                                                  08640029
086500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08650029
086600                                                                  08660029
086700                                                                  08670029
086800         WHEN DP020-NEXT-ACT-INITIAL                              08680029
086900              INITIALIZE ASC-SPECIFIC-COMMAREA                    08690029
087000              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              08700029
087100                                    ASC-SEL-TERM-ID               08710029
087200              MOVE DP020-SRC-TASK-NUMBER                          08720029
087300                                 TO ASC-LIST-TASK-NUMBER          08730029
087400                                    ASC-SEL-TASK-NUMBER           08740029
087500              MOVE PC-LIST-QUEUE-SEQ                              08750029
087600                                 TO ASC-LIST-SEQ                  08760029
087700              MOVE PC-SEL-QUEUE-SEQ                               08770029
087800                                 TO ASC-SEL-SEQ                   08780029
087900              SET PS-NO-ERROR    TO TRUE                          08790029
088000                                                                  08800029
088100              PERFORM 1100-PROCESS-INTER-APPL-COMM                08810029
088200                                                                  08820029
088300              IF PS-NO-ERROR                                      08830029
088400                  MOVE INTER-APPL-COMM-AREA                       08840029
088500                                 TO ASC-HOLD-INTER-APPL           08850029
088600                  PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT 08860029
088700                  PERFORM 3200-RESET-ATTRIBUTES                   08870029
088800              END-IF                                              08880029
088900                                                                  08890029
089000                                                                  08900029
089100         WHEN DP020-NEXT-ACT-READ-MAP                             08910029
089200              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08920029
089300                                 TO PV-TOP-ITEM                   08930029
089400                                                                  08940029
089500              PERFORM 2000-PROCESS-PANEL                          08950029
089600                                                                  08960029
089700                                                                  08970029
089800         WHEN DP020-NEXT-ACT-RETURN                               08980029
089900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       08990029
090000                                 TO PV-TOP-ITEM                   09000029
090100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09010029
090200              MOVE ASC-HOLD-INTER-APPL                            09020029
090300                                 TO INTER-APPL-COMM-AREA          09030029
090400*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     09040029
090500*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        09050029
090600*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      09060029
090700                                                                  09070029
090800              PERFORM 2050-DELETE-LIST-QUEUE                      09080029
090900              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     09090029
091000              PERFORM 3200-RESET-ATTRIBUTES                       09100029
091100                                                                  09110029
091200         WHEN OTHER                                               09120029
091300              SET DP013-LOGIC-ABEND                               09130029
091400                  DP013-NO-ROLLBACK                               09140029
091500                                 TO TRUE                          09150029
091600              MOVE '1000-CONTROL-PROCESSING'                      09160029
091700                                 TO DP013-PARAGRAPH               09170029
091800              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   09180029
091900                                 TO DP013-MESSAGE-TEXT(1)         09190029
092000                                                                  09200029
092100              PERFORM DP013-0000-PROCESS-ABEND                    09210029
092200                                                                  09220029
092300     END-EVALUATE.                                                09230029
092400                                                                  09240029
092500 1100-PROCESS-INTER-APPL-COMM.                                    09250029
092600                                                                  09260029
092700     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       09270029
092800     MOVE DP020-INT-APPL-FORMAT-IND                               09280029
092900                                 TO ASC-INTER-APPL-CODE-IND.      09290029
093000                                                                  09300029
093100     EVALUATE DP020-INT-APPL-FORMAT-IND                           09310029
093200         WHEN PC-INTER-APPL-WO                                    09320029
093300         WHEN PC-INTER-APPL-ITM-LST                               09330029
093400         WHEN PC-INTER-APPL-ITM-ADD-LST                           09340029
093500             IF PC000-NUMBER-OF-SELECTED-ITEMS = ZERO             09350029
093600                 SET ASC-NO-TSQ-UPDATE                            09360029
093700                                 TO TRUE                          09370029
093800                 SET DP020-MSG-FATAL                              09380029
093900                     DP020-NEXT-ACT-APPL-ERROR                    09390029
094000                     PS-ERROR    TO TRUE                          09400029
094100                 MOVE PC-TSYMSG-00057                             09410029
094200                                 TO DP020-MSG-NUMBER              09420029
094300             ELSE                                                 09430029
094400                 MOVE PC000-PO-NBR-N                              09440029
094500                                 TO ASC-KEY-PO-NBR-N              09450029
094600                 MOVE PC000-REC-SEQ-NBR-N                         09460029
094700                                 TO ASC-KEY-REC-SEQ-NBR-N         09470029
094800                 MOVE PC000-OPERATING-UNIT-ID                     09480029
094900                                 TO ASC-KEY-OPER-UNT-ID           09490029
095000                 MOVE PC000-FACILITY-ID                           09500029
095100                                 TO ASC-KEY-FCLTY-ID              09510029
095200                                                                  09520029
095300                 SET ASC-USE-SELECTION-QUEUE                      09530029
095400                                 TO TRUE                          09540029
095500                                                                  09550029
095600                 MOVE PC000-NUMBER-OF-SELECTED-ITEMS              09560029
095700                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  09570029
095800                 MOVE PC000-NUMBER-OF-TS-ITEMS                    09580029
095900                                 TO ASC-NUMBER-OF-TS-ITEMS        09590029
096000                 MOVE PC000-SEL-QUEUE-NAME                        09600029
096100                                 TO ASC-SEL-QUEUE-NAME-IN         09610029
096200                 MOVE PC016-MAX-ITEMS                             09620029
096300                                 TO ASC-SEL-SUB                   09630029
096400                 MOVE ZERO       TO ASC-SEL-ITEM                  09640029
096500                 PERFORM 2400-GET-NEXT-WO-RECORD                  09650029
096600             END-IF                                               09660029
096700                                                                  09670029
096800         WHEN PC-INTER-APPL-ITM-ADD                               09680029
096900             IF PC000-SEL-QUEUE-NAME = 'RETURN  '                 09690029
097000                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            09700029
097100             ELSE                                                 09710029
097200                 MOVE PC000-PO-NBR-N                              09720029
097300                                 TO ASC-KEY-PO-NBR-N              09730029
097400                 MOVE PC000-REC-SEQ-NBR-N                         09740029
097500                                 TO ASC-KEY-REC-SEQ-NBR-N         09750029
097600                 MOVE PC000-OPERATING-UNIT-ID                     09760029
097700                                 TO ASC-KEY-OPER-UNT-ID           09770029
097800                 MOVE PC000-FACILITY-ID                           09780029
097900                                 TO ASC-KEY-FCLTY-ID              09790029
098000                 MOVE PC000-LINE-NBR-N                            09800029
098100                                 TO ASC-KEY-PKSL-LNE-NBR          09810029
098200             END-IF                                               09820029
098300                                                                  09830029
098400         WHEN PC-INTER-APPL-DISTRO                                09840029
098500             MOVE PC000-PO-NBR-N                                  09850029
098600                             TO ASC-KEY-PO-NBR-N                  09860029
098700             MOVE PC000-REC-SEQ-NBR-N                             09870029
098800                             TO ASC-KEY-REC-SEQ-NBR-N             09880029
098900             MOVE PC000-OPERATING-UNIT-ID                         09890029
099000                             TO ASC-KEY-OPER-UNT-ID               09900029
099100             MOVE PC000-FACILITY-ID                               09910029
099200                             TO ASC-KEY-FCLTY-ID                  09920029
099300             MOVE PC000-LINE-NBR-N                                09930029
099400                             TO ASC-KEY-PKSL-LNE-NBR              09940029
099500         WHEN OTHER                                               09950029
099600             IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO             09960029
099700                 SET ASC-NO-TSQ-UPDATE                            09970029
099800                                 TO TRUE                          09980029
099900                 SET DP020-MSG-FATAL                              09990029
100000                     DP020-NEXT-ACT-APPL-ERROR                    10000029
100100                     PS-ERROR    TO TRUE                          10010029
100200                 MOVE PC-TSYMSG-00057                             10020029
100300                                 TO DP020-MSG-NUMBER              10030029
100400             ELSE                                                 10040029
100500                 MOVE RC015-PO-NBR                                10050029
100600                                 TO ASC-KEY-PO-NBR-N              10060029
100700                                    DK-PO-NBR                     10070029
100800                 MOVE RC015-SEQ-NBR                               10080029
100900                                 TO ASC-KEY-SEQ-NBR               10090029
101000                 MOVE RC015-REC-SEQ-NBR                           10100029
101100                                 TO ASC-KEY-REC-SEQ-NBR-N         10110029
101200                                    DK-REC-SEQ-NBR                10120029
101300                 MOVE RC015-OPER-UNT-ID                           10130029
101400                                 TO ASC-KEY-OPER-UNT-ID           10140029
101500                 MOVE RC015-FCLTY-ID                              10150029
101600                                 TO ASC-KEY-FCLTY-ID              10160029
101700                 MOVE RC015-PKSL-NBR                              10170029
101800                                 TO ASC-KEY-PKSL-NBR              10180029
101900                 MOVE RC015-PKSL-LNE-NBR                          10190029
102000                                 TO ASC-KEY-PKSL-LNE-NBR          10200029
102100                                    DK-PKSL-LNE-NBR               10210029
102200                                                                  10220029
102300                 SET ASC-USE-SELECTION-QUEUE                      10230029
102400                                 TO TRUE                          10240029
102500                                                                  10250029
102600                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              10260029
102700                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  10270029
102800                 MOVE RC015-NUMBER-OF-TS-ITEMS                    10280029
102900                                 TO ASC-NUMBER-OF-TS-ITEMS        10290029
103000                 MOVE RC015-SEL-QUEUE-NAME                        10300029
103100                                 TO ASC-SEL-QUEUE-NAME-IN         10310029
103200                 MOVE RC013-MAX-ITEMS                             10320029
103300                                 TO ASC-SEL-SUB                   10330029
103400                 MOVE ZERO       TO ASC-SEL-ITEM                  10340029
103500                 PERFORM 2300-GET-NEXT-RECORD                     10350029
103600             END-IF                                               10360029
103700     END-EVALUATE.                                                10370029
103800/                                                                 10380029
103900 2000-PROCESS-PANEL.                                              10390029
104000                                                                  10400029
104100     SET PS-NEXT-SCREEN TO TRUE.                                  10410029
104200     EVALUATE TRUE                                                10420029
104300                                                                  10430029
104400         WHEN DP020-SRC-AID = DP016-CLEAR                         10440029
104500              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10450029
104600                                                                  10460029
104700              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10470029
104800                                                                  10480029
104900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10490029
105000                                                                  10500029
105100                                                                  10510029
105200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10520029
105300                                                                  10530029
105400              PERFORM 2050-DELETE-LIST-QUEUE                      10540029
105500                                                                  10550029
105600              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     10560029
105700                                                                  10570029
105800              PERFORM 3200-RESET-ATTRIBUTES                       10580029
105900                                                                  10590029
106000         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   10600029
106100                                                                  10610029
106200              PERFORM 2140-DESELECT-ALL-ITEMS                     10620029
106300                                                                  10630029
106400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10640029
106500                                                                  10650029
106600         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 10660029
106700                                                                  10670029
106800              PERFORM 2150-SELECT-ALL-ITEMS                       10680029
106900                                                                  10690029
107000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10700029
107100                                                                  10710029
107200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10720029
107300             IF ASC-USE-SELECTION-QUEUE                           10730029
107400                 PERFORM 6200-DEL-LIST-QUEUE                      10740029
107500                 IF ASC-INTER-APPL-WO-LIST OR                     10750029
107600                    ASC-INTER-APPL-ITM-LST OR                     10760029
107700                    ASC-INTER-APPL-ITM-ADD-LST                    10770029
107800                     PERFORM 2400-GET-NEXT-WO-RECORD              10780029
107900                 ELSE                                             10790029
108000                     PERFORM 2300-GET-NEXT-RECORD                 10800029
108100                 END-IF                                           10810029
108200                 PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT  10820029
108300                 PERFORM 3200-RESET-ATTRIBUTES                    10830029
108400             ELSE                                                 10840029
108500*                --- BOTTOM OF LIST ---                           10850029
108600                 MOVE PC-TSYMSG-00070                             10860029
108700                                 TO DP020-MSG-NUMBER              10870029
108800                 SET DP020-MSG-INFORMATIONAL                      10880029
108900                                 TO TRUE                          10890029
109000             END-IF                                               10900029
109100                                                                  10910029
109200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10920029
109300             IF ASC-USE-SELECTION-QUEUE                           10930029
109400                 PERFORM 6200-DEL-LIST-QUEUE                      10940029
109500                 IF ASC-INTER-APPL-WO-LIST OR                     10950029
109600                    ASC-INTER-APPL-ITM-LST OR                     10960029
109700                    ASC-INTER-APPL-ITM-ADD-LST                    10970029
109800                     PERFORM 2410-GET-PREV-WO-RECORD              10980029
109900                 ELSE                                             10990029
110000                     PERFORM 2310-GET-PREV-RECORD                 11000029
110100                 END-IF                                           11010029
110200                 PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT  11020029
110300                 PERFORM 3200-RESET-ATTRIBUTES                    11030029
110400             ELSE                                                 11040029
110500*                --- TOP OF LIST ---                              11050029
110600                 MOVE PC-TSYMSG-00069                             11060029
110700                                 TO DP020-MSG-NUMBER              11070029
110800                 SET DP020-MSG-INFORMATIONAL                      11080029
110900                                 TO TRUE                          11090029
111000             END-IF                                               11100029
111100                                                                  11110029
111200                                                                  11120029
111300         WHEN OTHER                                               11130029
111400                                                                  11140029
111500              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11150029
111600                                                                  11160029
111700              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11170029
111800                                                                  11180029
111900              IF PS-NO-ERROR                                      11190029
112000                  SET DP030-CONTINUE-GO                           11200029
112100                                 TO TRUE                          11210029
112200                                                                  11220029
112300                  PERFORM 2100-CHECK-FUNCTION-KEY                 11230029
112400                                                                  11240029
112500              ELSE                                                11250029
112600                  SET DP030-OVERRIDE-GO                           11260029
112700                                 TO TRUE                          11270029
112800              END-IF                                              11280029
112900                                                                  11290029
113000     END-EVALUATE.                                                11300029
113100                                                                  11310029
113200 2050-DELETE-LIST-QUEUE.                                          11320029
113300                                                                  11330029
113400     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             11340029
113500                          RESP  (PV-CICS-RESP)                    11350029
113600                          END-EXEC.                               11360029
113700                                                                  11370029
113800     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      11380029
113900        (PV-CICS-RESP = DFHRESP (QIDERR))                         11390029
114000         CONTINUE                                                 11400029
114100     ELSE                                                         11410029
114200         SET DP013-CICS-ABEND                                     11420029
114300             DP013-NO-ROLLBACK   TO TRUE                          11430029
114400         MOVE '2050-DELETE-LIST-QUEUE'                            11440029
114500                                 TO DP013-PARAGRAPH               11450029
114600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 11460029
114700                                 TO DP013-MESSAGE-TEXT (1)        11470029
114800                                                                  11480029
114900         PERFORM DP013-0000-PROCESS-ABEND                         11490029
115000     END-IF.                                                      11500029
115100                                                                  11510029
115200     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    11520029
115300                                                                  11530029
115400 2100-CHECK-FUNCTION-KEY.                                         11540029
115500                                                                  11550029
115600     SET PS-NEXT-SCREEN TO TRUE.                                  11560029
115700     EVALUATE TRUE                                                11570029
115800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11580029
115900              IF (ASC-CANT-UPDATE                                 11590029
116000               AND DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)         11600029
116100                AND NOT ASC-PREPACK)                              11610029
116200                  MOVE PC-TSYMSG-00734                            11620029
116300                                 TO  DP020-MSG-NUMBER             11630029
116400                  SET PS-ERROR                                    11640029
116500                      DP030-OVERRIDE-GO                           11650029
116600                      DP020-MSG-FATAL                             11660029
116700                                 TO TRUE                          11670029
116800              ELSE                                                11680029
116900                 IF (ASC-CANT-UPDATE                              11690029
117000                    AND DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)    11700029
117100                     AND ASC-PREPACK)                             11710029
117200                      MOVE PC-TSYMSG-02184                        11720029
117300                                 TO  DP020-MSG-NUMBER             11730029
117400                      SET PS-ERROR                                11740029
117500                          DP030-OVERRIDE-GO                       11750029
117600                          DP020-MSG-FATAL                         11760029
117700                                 TO TRUE                          11770029
117800                 ELSE                                             11780029
117900                      MOVE ASC-NUMBER-OF-SELECTED-ITEMS           11790029
118000                                 TO RC015-NUMBER-OF-SELECTED-ITEMS11800029
118100                      MOVE ASC-KEY-PO-NBR-N                       11810029
118200                                 TO RC015-PO-NBR                  11820029
118300                      MOVE ASC-KEY-REC-SEQ-NBR-N                  11830029
118400                                 TO RC015-REC-SEQ-NBR             11840029
118500                      MOVE ASC-KEY-OPER-UNT-ID                    11850029
118600                                 TO RC015-OPER-UNT-ID             11860029
118700                      MOVE ASC-KEY-FCLTY-ID                       11870029
118800                                 TO RC015-FCLTY-ID                11880029
118900                      MOVE ASC-KEY-PKSL-LNE-NBR                   11890029
119000                                 TO RC015-PKSL-LNE-NBR            11900029
119100                      MOVE ASC-KEY-PKSL-NBR                       11910029
119200                                 TO RC015-PKSL-NBR                11920029
119300                      PERFORM 5000-PREPARE-SEL-QUEUE              11930029
119400                      IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO      11940029
119500                          SET ASC-NO-TSQ-UPDATE                   11950029
119600                                     TO TRUE                      11960029
119700                      END-IF                                      11970029
119800                 END-IF                                           11980029
119900              END-IF                                              11990029
120000                                                                  12000029
120100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12010029
120200              IF ASC-INTER-APPL-VERIFY                            12020029
120300                  CONTINUE                                        12030029
120400              ELSE                                                12040029
120500                  PERFORM 3350-EDIT-DISTR-LNE-QTY                 12050029
120600              END-IF                                              12060029
120700          IF PS-NO-ERROR                                          12070029
120800                                                                  12080029
120900              PERFORM 5310-CHECK-FOR-SMOOTHING                    12090029
121000                 VARYING PV-ITEM  FROM 1 BY 1                     12100029
121100                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      12110029
121200                                                                  12120029
121300              IF ASC-CAN-UPDATE                                   12130029
121400                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          12140029
121500                      SET ASC-NO-TSQ-UPDATE                       12150029
121600                                 TO TRUE                          12160029
121700                      SET DP030-OVERRIDE-GO                       12170029
121800                          DP020-MSG-WARNING                       12180029
121900                                 TO TRUE                          12190029
122000                      MOVE PC-TSYMSG-00057                        12200029
122100                                 TO DP020-MSG-NUMBER              12210029
122200                  ELSE                                            12220029
122300                      IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO      12230029
122400                          IF ASC-INTER-APPL-WO-LIST OR            12240029
122500                             ASC-INTER-APPL-ITM-LST OR            12250029
122600                             ASC-INTER-APPL-ITM-ADD-LST           12260029
122700                             INITIALIZE PC000-INTER-APPL-COMMAREA 12270029
122800                             MOVE ASC-NUMBER-OF-SELECTED-ITEMS    12280029
122900                                 TO PC000-NUMBER-OF-SELECTED-ITEMS12290029
123000                             MOVE ASC-KEY-PO-NBR-N                12300029
123100                                 TO PC000-PO-NBR-N                12310029
123200                             PERFORM 5000-PREPARE-SEL-QUEUE       12320029
123300                                                                  12330029
123400                             SET ASC-NO-TSQ-UPDATE                12340029
123500                                 TO TRUE                          12350029
123600                          ELSE                                    12360029
123700                             INITIALIZE RC015-INTER-APPL-COMMAREA 12370029
123800                             MOVE ASC-NUMBER-OF-SELECTED-ITEMS    12380029
123900                                 TO RC015-NUMBER-OF-SELECTED-ITEMS12390029
124000                             MOVE ASC-KEY-PO-NBR-N                12400029
124100                                 TO RC015-PO-NBR                  12410029
124200                             PERFORM 5000-PREPARE-SEL-QUEUE       12420029
124300                                                                  12430029
124400                             SET ASC-NO-TSQ-UPDATE                12440029
124500                                 TO TRUE                          12450029
124600                          END-IF                                  12460029
124700                      END-IF                                      12470029
124800                  END-IF                                          12480029
124900              END-IF                                              12490029
125000          END-IF                                                  12500029
125100                                                                  12510029
125200         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 12520029
125300             MOVE +1             TO PV-TOP-ITEM                   12530029
125400                                                                  12540029
125500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12550029
125600                                                                  12560029
125700             PERFORM 3200-RESET-ATTRIBUTES                        12570029
125800                                                                  12580029
125900                                                                  12590029
126000         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  12600029
126100                                                                  12610029
126200             PERFORM 2110-BROWSE-BACKWARD                         12620029
126300                                                                  12630029
126400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12640029
126500                                                                  12650029
126600             PERFORM 3200-RESET-ATTRIBUTES                        12660029
126700                                                                  12670029
126800                                                                  12680029
126900         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  12690029
127000                                                                  12700029
127100             PERFORM 2120-BROWSE-FORWARD                          12710029
127200                                                                  12720029
127300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12730029
127400                                                                  12740029
127500             PERFORM 3200-RESET-ATTRIBUTES                        12750029
127600                                                                  12760029
127700                                                                  12770029
127800         WHEN DP020-SRC-AID = DP016-ENTER                         12780029
127900                                                                  12790029
128000             PERFORM 2180-CHECK-FOR-JUMP-BROWSE                   12800029
128100                                                                  12810029
128200             IF PS-NO-ERROR                                       12820029
128300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12830029
128400             END-IF                                               12840029
128500                                                                  12850029
128600         WHEN OTHER                                               12860029
128700             SET DP013-CICS-ABEND                                 12870029
128800                 DP013-NO-ROLLBACK                                12880029
128900                 DP013-XCTL-DISPLAY-RESTART                       12890029
129000                                 TO TRUE                          12900029
129100             MOVE '2100-CHECK-FUNCTION-KEY'                       12910029
129200                                 TO DP013-PARAGRAPH               12920029
129300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12930029
129400                                 TO DP013-MESSAGE-TEXT (1)        12940029
129500                                                                  12950029
129600             PERFORM DP013-0000-PROCESS-ABEND                     12960029
129700     END-EVALUATE.                                                12970029
129800                                                                  12980029
129900 2110-BROWSE-BACKWARD.                                            12990029
130000                                                                  13000029
130100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13010029
130200         GIVING PV-TOP-ITEM.                                      13020029
130300                                                                  13030029
130400     IF PV-TOP-ITEM NOT > +1                                      13040029
130500         MOVE +1                 TO PV-TOP-ITEM                   13050029
130600         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              13060029
130700         SET DP020-MSG-INFORMATIONAL                              13070029
130800                                 TO TRUE.                         13080029
130900                                                                  13090029
131000 2120-BROWSE-FORWARD.                                             13100029
131100                                                                  13110029
131200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13120029
131300         GIVING PV-TOP-ITEM.                                      13130029
131400                                                                  13140029
131500     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    13150029
131600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13160029
131700                                 TO PV-TOP-ITEM                   13170029
131800         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              13180029
131900         SET DP020-MSG-INFORMATIONAL                              13190029
132000                                 TO TRUE                          13200029
132100     ELSE                                                         13210029
132200         COMPUTE PV-BOTTOM-ITEM =                                 13220029
132300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13230029
132400         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             13240029
132500             MOVE PC-TSYMSG-00070                                 13250029
132600                                 TO DP020-MSG-NUMBER              13260029
132700             SET DP020-MSG-INFORMATIONAL                          13270029
132800                                 TO TRUE.                         13280029
132900                                                                  13290029
133000 2180-CHECK-FOR-JUMP-BROWSE.                                      13300029
133100                                                                  13310029
133200     SET PS-NO-ERROR             TO TRUE.                         13320029
133300                                                                  13330029
133400     IF ASC-START-ITEM-REQUEST = SPACE                            13340029
133500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13350029
133600                                 TO PV-TOP-ITEM                   13360029
133700     ELSE                                                         13370029
133800         MOVE ASC-START-ITEM-REQUEST                              13380029
133900                                 TO DP010I-UNEDITED-FIELD         13390029
134000         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         13400029
134100         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       13410029
134200         SET DP010I-NEGATIVE-NOT-ALLOWED                          13420029
134300                                 TO TRUE                          13430029
134400                                                                  13440029
134510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13451066
134520              USING DP010I-NUMERIC-EDIT-AREA                      13452066
134600                                                                  13460029
134700         IF NOT DP010I-ERROR-DETECTED                             13470029
134800             MOVE DP010I-NUMERIC-FIELD                            13480029
134900                                 TO ASC-START-ITEM-REQUEST-N      13490029
135000             IF ASC-START-ITEM-REQUEST-N > ZERO                   13500029
135100                IF ASC-START-ITEM-REQUEST-N >                     13510029
135200                                          ASC-NUMBER-OF-ITEMS-READ13520029
135300                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        13530029
135400                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ13540029
135500                                          - PC-ITEMS-PER-PANEL + 113550029
135600                    IF PV-TOP-ITEM < +1                           13560029
135700                        MOVE +1  TO PV-TOP-ITEM                   13570029
135800                        MOVE PC-TSYMSG-00070                      13580029
135900                                 TO DP020-MSG-NUMBER              13590029
136000                        SET DP020-MSG-INFORMATIONAL               13600029
136100                                 TO TRUE                          13610029
136200                    END-IF                                        13620029
136300                ELSE                                              13630029
136400                    MOVE ASC-START-ITEM-REQUEST-N                 13640029
136500                                 TO PV-TOP-ITEM                   13650029
136600                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        13660029
136700                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        13670029
136800                                            PC-ITEMS-PER-PANEL - 113680029
136900                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  13690029
137000                         MOVE PC-TSYMSG-00070                     13700029
137100                                 TO DP020-MSG-NUMBER              13710029
137200                         SET DP020-MSG-INFORMATIONAL              13720029
137300                                 TO TRUE                          13730029
137400                    END-IF                                        13740029
137500                END-IF                                            13750029
137600             ELSE                                                 13760029
137700                 MOVE PC-TSYMSG-00101                             13770029
137800                                 TO DP020-MSG-NUMBER              13780029
137900                 SET DP030-SET-CURSOR-APPL-1                      13790029
138000                                 TO TRUE                          13800029
138100                 MOVE -1         TO ASTRTITL                      13810029
138200                 MOVE DP015-UNP-NUM-BRT-MDT                       13820029
138300                                 TO ASTRTITA                      13830029
138400                 MOVE DP015-RED  TO ASTRTITC                      13840029
138500                 MOVE DP015-REVERSE                               13850029
138600                                 TO ASTRTITH                      13860029
138700                 SET PS-ERROR                                     13870029
138800                     DP020-MSG-FATAL                              13880029
138900                                 TO TRUE                          13890029
139000             END-IF                                               13900029
139100         ELSE                                                     13910029
139200             MOVE PC-TSYMSG-00008                                 13920029
139300                                 TO DP020-MSG-NUMBER              13930029
139400             SET DP030-SET-CURSOR-APPL-1                          13940029
139500                                 TO TRUE                          13950029
139600             MOVE -1             TO ASTRTITL                      13960029
139700             MOVE DP015-UNP-NUM-BRT-MDT                           13970029
139800                                 TO ASTRTITA                      13980029
139900             MOVE DP015-RED      TO ASTRTITC                      13990029
140000             MOVE DP015-REVERSE  TO ASTRTITH                      14000029
140100             SET PS-ERROR                                         14010029
140200                 DP020-MSG-FATAL TO TRUE                          14020029
140300         END-IF                                                   14030029
140400     END-IF.                                                      14040029
140500                                                                  14050029
140600 2140-DESELECT-ALL-ITEMS.                                         14060029
140700                                                                  14070029
140800     MOVE +1                     TO ASC-BLK-SUB.                  14080029
140900                                                                  14090029
141000     PERFORM 2141-CLEAR-SELECTED-INDS                             14100029
141100             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    14110029
141200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14120029
141300                                                                  14130029
141400     ADD +1                      TO ASC-BLK-SUB.                  14140029
141500                                                                  14150029
141600     PERFORM 2141-CLEAR-SELECTED-INDS                             14160029
141700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    14170029
141800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14180029
141900                                                                  14190029
142000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              14200029
142100                                 TO PV-LIST-ITEM-NUMBER.          14210029
142200                                                                  14220029
142300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14230029
142400             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).14240029
142500                                                                  14250029
142600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14260029
142700              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)14270029
142800         MOVE +1                 TO ASC-BLK-SUB                   14280029
142900                                                                  14290029
143000         PERFORM 5100-WRITE-TEMP-STORAGE                          14300029
143100                                                                  14310029
143200         MOVE +1                 TO PV-BLOCK-NUMBER               14320029
143300                                                                  14330029
143400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14340029
143500                                       PV-FIRST-BLOCK-IN-ARRAY - 114350029
143600                                                                  14360029
143700         PERFORM                                                  14370029
143800           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         14380029
143900                                                                  14390029
144000                 PERFORM 4410-READ-TEMP-STORAGE                   14400029
144100                                                                  14410029
144200                 PERFORM 2141-CLEAR-SELECTED-INDS                 14420029
144300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14430029
144400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14440029
144500                                                                  14450029
144600                 PERFORM 5100-WRITE-TEMP-STORAGE                  14460029
144700                                                                  14470029
144800                 ADD +1          TO PV-BLOCK-NUMBER               14480029
144900                                                                  14490029
145000         END-PERFORM                                              14500029
145100                                                                  14510029
145200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14520029
145300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY14530029
145400                                                                  14540029
145500         PERFORM                                                  14550029
145600           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         14560029
145700                                         ASC-HIGHEST-BLOCK-WRITTEN14570029
145800                                                                  14580029
145900                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      14590029
146000                                 TO PV-BLOCK-NUMBER               14600029
146100                                                                  14610029
146200                 PERFORM 4410-READ-TEMP-STORAGE                   14620029
146300                                                                  14630029
146400                 PERFORM 2141-CLEAR-SELECTED-INDS                 14640029
146500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14650029
146600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14660029
146700                                                                  14670029
146800                 PERFORM 5100-WRITE-TEMP-STORAGE                  14680029
146900                                                                  14690029
147000                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        14700029
147100                                                                  14710029
147200         END-PERFORM                                              14720029
147300                                                                  14730029
147400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14740029
147500                                 TO PV-BLOCK-NUMBER               14750029
147600                                                                  14760029
147700         PERFORM 4410-READ-TEMP-STORAGE                           14770029
147800                                                                  14780029
147900     END-IF.                                                      14790029
148000                                                                  14800029
148100     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  14810029
148200                                    ASC-START-OF-SELECTED-RANGE   14820029
148300                                    ASC-END-OF-SELECTED-RANGE.    14830029
148400                                                                  14840029
148500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14850029
148600                                                                  14860029
148700 2141-CLEAR-SELECTED-INDS.                                        14870029
148800                                                                  14880029
148900     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO14890029
149000        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           14900029
149100            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          14910029
149200                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     14920029
149300                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  14930029
149400                                 TO TRUE.                         14940029
149500                                                                  14950029
149600 2150-SELECT-ALL-ITEMS.                                           14960029
149700                                                                  14970029
149800     MOVE +1                     TO ASC-BLK-SUB.                  14980029
149900                                                                  14990029
150000     PERFORM 2151-SET-SELECTED-INDS                               15000029
150100             VARYING ASC-ITEM-SUB FROM 1 BY 1                     15010029
150200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15020029
150300                                                                  15030029
150400     ADD +1                      TO ASC-BLK-SUB.                  15040029
150500                                                                  15050029
150600     PERFORM 2151-SET-SELECTED-INDS                               15060029
150700             VARYING ASC-ITEM-SUB FROM 1 BY 1                     15070029
150800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15080029
150900                                                                  15090029
151000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              15100029
151100                                 TO PV-LIST-ITEM-NUMBER.          15110029
151200                                                                  15120029
151300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15130029
151400             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).15140029
151500                                                                  15150029
151600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15160029
151700              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)15170029
151800         MOVE +1                 TO ASC-BLK-SUB                   15180029
151900                                                                  15190029
152000         PERFORM 5100-WRITE-TEMP-STORAGE                          15200029
152100                                                                  15210029
152200         MOVE +1                 TO PV-BLOCK-NUMBER               15220029
152300                                                                  15230029
152400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15240029
152500                                       PV-FIRST-BLOCK-IN-ARRAY - 115250029
152600                                                                  15260029
152700         PERFORM                                                  15270029
152800           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         15280029
152900                                                                  15290029
153000                 PERFORM 4410-READ-TEMP-STORAGE                   15300029
153100                                                                  15310029
153200                 PERFORM 2151-SET-SELECTED-INDS                   15320029
153300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        15330029
153400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL15340029
153500                                                                  15350029
153600                 PERFORM 5100-WRITE-TEMP-STORAGE                  15360029
153700                                                                  15370029
153800                 ADD +1          TO PV-BLOCK-NUMBER               15380029
153900                                                                  15390029
154000         END-PERFORM                                              15400029
154100                                                                  15410029
154200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15420029
154300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY15430029
154400                                                                  15440029
154500         PERFORM                                                  15450029
154600           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         15460029
154700                                         ASC-HIGHEST-BLOCK-WRITTEN15470029
154800                                                                  15480029
154900                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      15490029
155000                                 TO PV-BLOCK-NUMBER               15500029
155100                                                                  15510029
155200                 PERFORM 4410-READ-TEMP-STORAGE                   15520029
155300                                                                  15530029
155400                 PERFORM 2151-SET-SELECTED-INDS                   15540029
155500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        15550029
155600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL15560029
155700                                                                  15570029
155800                 PERFORM 5100-WRITE-TEMP-STORAGE                  15580029
155900                                                                  15590029
156000                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        15600029
156100                                                                  15610029
156200         END-PERFORM                                              15620029
156300                                                                  15630029
156400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15640029
156500                                 TO PV-BLOCK-NUMBER               15650029
156600                                                                  15660029
156700         PERFORM 4410-READ-TEMP-STORAGE                           15670029
156800     END-IF.                                                      15680029
156900                                                                  15690029
157000     MOVE ASC-NUMBER-OF-ITEMS-READ                                15700029
157100                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 15710029
157200                                                                  15720029
157300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15730029
157400                                                                  15740029
157500 2151-SET-SELECTED-INDS.                                          15750029
157600                                                                  15760029
157700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO15770029
157800        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              15780029
157900            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             15790029
158000                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15800029
158100                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  15810029
158200                                 TO TRUE                          15820029
158300        END-IF                                                    15830029
158400     END-IF.                                                      15840029
158500                                                                  15850029
158600 2200-MOVE-SCREEN-TO-COMMAREA.                                    15860029
158700                                                                  15870029
158800     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               15880029
158900     MOVE +1                     TO PV-SUB.                       15890029
159000                                                                  15900029
159100     PERFORM 3100-SET-SUBSCRIPTS.                                 15910029
159200                                                                  15920029
159300     IF ASTRTITL > ZERO                                           15930029
159400         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        15940029
159500     ELSE                                                         15950029
159600         IF ASTRTITF = DP015-ERASE-EOF                            15960029
159700             INITIALIZE ASC-START-ITEM-REQUEST                    15970029
159800         END-IF                                                   15980029
159900     END-IF.                                                      15990029
160000                                                                  16000029
160100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16010029
160200             VARYING PV-SUB  FROM 1 BY 1                          16020029
160300             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                16030029
160400                                                                  16040029
160500 2210-MOVE-LINES-TO-COMMAREA.                                     16050029
160600                                                                  16060029
160700     IF MR-SELECTL (PV-SUB) > ZERO                                16070029
160800         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  16080029
160900                                 TO TRUE                          16090029
161000         MOVE MR-SELECTI (PV-SUB)                                 16100029
161100                                 TO ASC-TEMP-SELECTED-SW          16110029
161200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16120029
161300     ELSE                                                         16130029
161400         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 16140029
161500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16150029
161600                                 TO TRUE                          16160029
161700             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          16170029
161800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16180029
161900         END-IF                                                   16190029
162000     END-IF.                                                      16200029
162100                                                                  16210029
162200     IF MR-STR-QTY-L (PV-SUB) > ZERO                              16220029
162300         MOVE MR-STR-QTY (PV-SUB)                                 16230029
162400                                 TO ASC-STR-QTY                   16240029
162500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16250029
162600     ELSE                                                         16260029
162700         IF MR-STR-QTY-A (PV-SUB) = DP015-ERASE-EOF               16270029
162800             MOVE SPACES         TO ASC-STR-QTY                   16280029
162900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16290029
163000         END-IF                                                   16300029
163100     END-IF.                                                      16310029
163200                                                                  16320029
163300     ADD +1                      TO ASC-ITEM-SUB.                 16330029
163400                                                                  16340029
163500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16350029
163600         ADD  +1                 TO ASC-BLK-SUB                   16360029
163700         MOVE +1                 TO ASC-ITEM-SUB                  16370029
163800     END-IF.                                                      16380029
163900                                                                  16390029
164000******************************************************************16400029
164100* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *16410029
164200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16420029
164300******************************************************************16430029
164400 2300-GET-NEXT-RECORD.                                            16440029
164500                                                                  16450029
164600     ADD +1                      TO ASC-SEL-SUB.                  16460029
164700                                                                  16470029
164800     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             16480029
164900         ADD +1                  TO ASC-SEL-ITEM                  16490029
165000         MOVE +1                 TO ASC-SEL-SUB                   16500029
165100     END-IF.                                                      16510029
165200                                                                  16520029
165300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 16530029
165400         PERFORM 9100-READ-SEL-QUEUE                              16540029
165500         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       16550029
165600             MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                16560029
165700                                 TO ASC-KEY-PKSL-LNE-NBR          16570029
165800             SET RC013-INQ (ASC-SEL-SUB)                          16580029
165900                                 TO TRUE                          16590029
166000             PERFORM 9200-REWRITE-LIST-QUEUE                      16600029
166100         ELSE                                                     16610029
166200             SUBTRACT +1 FROM ASC-SEL-SUB                         16620029
166300*            --- BOTTOM OF LIST ---                               16630029
166400             MOVE PC-TSYMSG-00070                                 16640029
166500                                 TO DP020-MSG-NUMBER              16650029
166600             SET DP020-MSG-INFORMATIONAL                          16660029
166700                                 TO TRUE                          16670029
166800         END-IF                                                   16680029
166900     ELSE                                                         16690029
167000         SUBTRACT +1 FROM ASC-SEL-ITEM                            16700029
167100         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   16710029
167200         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              16720029
167300         SET DP020-MSG-INFORMATIONAL                              16730029
167400                                 TO TRUE                          16740029
167500     END-IF.                                                      16750029
167600                                                                  16760029
167700/                                                                 16770029
167800******************************************************************16780029
167900* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *16790029
168000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16800029
168100******************************************************************16810029
168200 2310-GET-PREV-RECORD.                                            16820029
168300                                                                  16830029
168400     SUBTRACT +1 FROM ASC-SEL-SUB.                                16840029
168500                                                                  16850029
168600     IF ASC-SEL-SUB < +1                                          16860029
168700         SUBTRACT +1 FROM ASC-SEL-ITEM                            16870029
168800         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   16880029
168900     END-IF.                                                      16890029
169000                                                                  16900029
169100     IF ASC-SEL-ITEM > ZERO                                       16910029
169200         PERFORM 9100-READ-SEL-QUEUE                              16920029
169300         MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                    16930029
169400                                 TO ASC-KEY-PKSL-LNE-NBR          16940029
169500     ELSE                                                         16950029
169600         MOVE +1                 TO ASC-SEL-ITEM                  16960029
169700                                    ASC-SEL-SUB                   16970029
169800*        --- TOP OF LIST ---                                      16980029
169900         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              16990029
170000         SET DP020-MSG-INFORMATIONAL                              17000029
170100                                 TO TRUE                          17010029
170200     END-IF.                                                      17020029
170300                                                                  17030029
170400******************************************************************17040029
170500* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE WO           *17050029
170600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17060029
170700******************************************************************17070029
170800 2400-GET-NEXT-WO-RECORD.                                         17080029
170900                                                                  17090029
171000     ADD +1                      TO ASC-SEL-SUB.                  17100029
171100                                                                  17110029
171200     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             17120029
171300         ADD +1                  TO ASC-SEL-ITEM                  17130029
171400         MOVE +1                 TO ASC-SEL-SUB                   17140029
171500     END-IF.                                                      17150029
171600                                                                  17160029
171700     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 17170029
171800         PERFORM 9300-READ-WO-SEL-QUEUE                           17180029
171900         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       17190029
172000             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  17200029
172100                                 TO ASC-KEY-PKSL-LNE-NBR          17210029
172200             SET PC016-INQ (ASC-SEL-SUB)                          17220029
172300                                 TO TRUE                          17230029
172400             PERFORM 9400-REWRITE-WO-LIST-QUEUE                   17240029
172500         ELSE                                                     17250029
172600             SUBTRACT +1 FROM ASC-SEL-SUB                         17260029
172700*            --- BOTTOM OF LIST ---                               17270029
172800             MOVE PC-TSYMSG-00070                                 17280029
172900                                 TO DP020-MSG-NUMBER              17290029
173000             SET DP020-MSG-INFORMATIONAL                          17300029
173100                                 TO TRUE                          17310029
173200         END-IF                                                   17320029
173300     ELSE                                                         17330029
173400         SUBTRACT +1 FROM ASC-SEL-ITEM                            17340029
173500         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   17350029
173600         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              17360029
173700         SET DP020-MSG-INFORMATIONAL                              17370029
173800                                 TO TRUE                          17380029
173900     END-IF.                                                      17390029
174000                                                                  17400029
174100/                                                                 17410029
174200******************************************************************17420029
174300* GET THE KEYS OF THE PREVIOUS SELECTED WORK ORDER OBJECT FROM   *17430029
174400* THE INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                   *17440029
174500******************************************************************17450029
174600 2410-GET-PREV-WO-RECORD.                                         17460029
174700                                                                  17470029
174800     SUBTRACT +1 FROM ASC-SEL-SUB.                                17480029
174900                                                                  17490029
175000     IF ASC-SEL-SUB < +1                                          17500029
175100         SUBTRACT +1 FROM ASC-SEL-ITEM                            17510029
175200         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   17520029
175300     END-IF.                                                      17530029
175400                                                                  17540029
175500     IF ASC-SEL-ITEM > ZERO                                       17550029
175600         PERFORM 9300-READ-WO-SEL-QUEUE                           17560029
175700         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      17570029
175800                                 TO ASC-KEY-PKSL-LNE-NBR          17580029
175900     ELSE                                                         17590029
176000         MOVE +1                 TO ASC-SEL-ITEM                  17600029
176100                                    ASC-SEL-SUB                   17610029
176200*        --- TOP OF LIST ---                                      17620029
176300         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              17630029
176400         SET DP020-MSG-INFORMATIONAL                              17640029
176500                                 TO TRUE                          17650029
176600     END-IF.                                                      17660029
176700                                                                  17670029
176800 3000-EDIT-DATA-IN-COMMAREA.                                      17680029
176900                                                                  17690029
177000     SET PS-NO-ERROR             TO TRUE.                         17700029
177100                                                                  17710029
177200     PERFORM 3200-RESET-ATTRIBUTES.                               17720029
177300                                                                  17730029
177400     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       17740029
177500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17750029
177600                                          ASC-ITEMS-DISPLAYED - 1.17760029
177700     PERFORM 3100-SET-SUBSCRIPTS.                                 17770029
177800                                                                  17780029
177900     PERFORM 3300-EDIT-SELECTIONS                                 17790029
178000             VARYING PV-SUB  FROM PV-SUB BY -1                    17800029
178100             UNTIL   PV-SUB < +1.                                 17810029
178200                                                                  17820029
178300     IF PS-NO-ERROR                                               17830029
178400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17840029
178500     END-IF.                                                      17850029
178600                                                                  17860029
178700     IF PS-NO-ERROR AND                                           17870029
178800        ASC-START-OF-SELECTED-RANGE > ZERO AND                    17880029
178900        ASC-END-OF-SELECTED-RANGE > ZERO                          17890029
179000                                                                  17900029
179100         PERFORM 3500-MARK-RANGE-AS-SELECTED                      17910029
179200     END-IF.                                                      17920029
179300                                                                  17930029
179400                                                                  17940029
179500 3100-SET-SUBSCRIPTS.                                             17950029
179600                                                                  17960029
179700     COMPUTE ASC-ITEM-SUB =                                       17970029
179800                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.17980029
179900                                                                  17990029
180000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18000029
180100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18010029
180200         MOVE PC-MAX-BLOCKS-IN-ARRAY                              18020029
180300                                 TO ASC-BLK-SUB                   18030029
180400     ELSE                                                         18040029
180500         MOVE +1                 TO ASC-BLK-SUB                   18050029
180600     END-IF.                                                      18060029
180700                                                                  18070029
180800 3200-RESET-ATTRIBUTES.                                           18080029
180900                                                                  18090029
181000     IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY          18100029
181100         MOVE DP015-ASK-DRK-OFF  TO AHDR0A                        18110029
181200                                    AHDR1A                        18120029
181300                                    AHDR2A                        18130029
181400                                    AHDR3A                        18140029
181500                                    ABAR1A                        18150029
181600                                    ABAR2A                        18160029
181700                                    ABAR3A                        18170029
181800                                    ABAR4A                        18180029
181900                                    ABAR5A                        18190029
182000                                    ABAR6A                        18200029
182100                                    ABAR7A                        18210029
182200                                    ABAR8A                        18220029
182300                                    ABAR9A                        18230029
182400                                    ABAR10A                       18240029
182500             PERFORM VARYING PV-SUB  FROM 1 BY 1                  18250029
182600                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             18260029
182700                 MOVE DP015-ASK-DRK-OFF TO                        18270029
182800                     MR-STATUS-A        (PV-SUB)                  18280029
182900                     MR-LAST-QTY-REC-A  (PV-SUB)                  18290029
183000                     MR-LAST-DTE-REC-A  (PV-SUB)                  18300029
183100                     MR-STATUS2-A       (PV-SUB)                  18310029
183200                     MR-PRIOR-QTY-REC-A (PV-SUB)                  18320029
183300                     MR-PRIOR-DTE-REC-A (PV-SUB)                  18330029
183400                     MR-MORE-A          (PV-SUB)                  18340029
183500             END-PERFORM                                          18350029
183600     END-IF                                                       18360029
183700                                                                  18370029
183800     MOVE DP015-HL-OFF           TO ADQTYH.                       18380029
183900     MOVE DP015-BLUE             TO ADQTYC.                       18390029
184000                                                                  18400029
184100     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     18410029
184200     MOVE DP015-GREEN            TO ASTRTITC.                     18420029
184300     MOVE DP015-UNDERLINE        TO ASTRTITH.                     18430029
184400                                                                  18440029
184500     IF ASC-TRBL-EXISTS                                           18450029
184600         MOVE DP015-YELLOW       TO ARCVRC                        18460029
184700     END-IF.                                                      18470029
184800                                                                  18480029
184900     IF  ASC-CANT-UPDATE OR                                       18490029
185000         ASC-PURITM-STATUS-CDE = PC-RV                            18500029
185100         PERFORM VARYING PV-SUB  FROM 1 BY 1                      18510029
185200                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              18520029
185300                 MOVE DP015-ASK-NOR-OFF                           18530029
185400                                 TO MR-SELECTA   (PV-SUB)         18540029
185500                                    MR-STR-QTY-A (PV-SUB)         18550029
185600                 MOVE DP015-BLUE                                  18560029
185700                                 TO MR-SELECTC   (PV-SUB)         18570029
185800                                    MR-STR-QTY-C (PV-SUB)         18580029
185900                 MOVE DP015-HL-OFF                                18590029
186000                                 TO MR-SELECTH   (PV-SUB)         18600029
186100                                    MR-STR-QTY-H (PV-SUB)         18610029
186200         END-PERFORM                                              18620029
186300     ELSE                                                         18630029
186400             PERFORM VARYING PV-SUB  FROM 1 BY 1                  18640029
186500                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             18650029
186600                 MOVE DP015-UNP-ALP-NOR-OFF                       18660029
186700                                 TO MR-SELECTA   (PV-SUB)         18670029
186800                 MOVE DP015-UNP-NUM-NOR-OFF                       18680029
186900                                 TO MR-STR-QTY-A (PV-SUB)         18690029
187000                 MOVE DP015-GREEN                                 18700029
187100                                 TO MR-SELECTC   (PV-SUB)         18710029
187200                                    MR-STR-QTY-C (PV-SUB)         18720029
187300                 MOVE DP015-UNDERLINE                             18730029
187400                                 TO MR-SELECTH   (PV-SUB)         18740029
187500                                    MR-STR-QTY-H (PV-SUB)         18750029
187600             END-PERFORM                                          18760029
187700     END-IF.                                                      18770029
187800                                                                  18780029
187900 3300-EDIT-SELECTIONS.                                            18790029
188000                                                                  18800029
188100     EVALUATE TRUE                                                18810029
188200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   18820029
188300                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18830029
188400              CONTINUE                                            18840029
188500                                                                  18850029
188600         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        18860029
188700              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18870029
188800                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  18880029
188900                  MOVE ASC-TEMP-SELECTED-SW                       18890029
189000                                        (ASC-BLK-SUB ASC-ITEM-SUB)18900029
189100                                 TO ASC-SELECTED-SW               18910029
189200                                        (ASC-BLK-SUB ASC-ITEM-SUB)18920029
189300              END-IF                                              18930029
189400                                                                  18940029
189500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   18950029
189600                                                             SPACE18960029
189700              EVALUATE TRUE                                       18970029
189800                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     18980029
189900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18990029
190000                     MOVE SPACE  TO ASC-SELECTED-SW               19000029
190100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19010029
190200                                                                  19020029
190300                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     19030029
190400                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   19040029
190500                       MOVE SPACE                                 19050029
190600                                 TO ASC-SELECTED-SW               19060029
190700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19070029
190800                                                                  19080029
190900                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     19090029
191000                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     19100029
191100                       MOVE SPACE                                 19110029
191200                                 TO ASC-SELECTED-SW               19120029
191300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19130029
191400             END-EVALUATE                                         19140029
191500                                                                  19150029
191600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19160029
191700              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           19170029
191800                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   19180029
191900              END-IF                                              19190029
192000                                                                  19200029
192100              PERFORM 3310-EDIT-RANGE                             19210029
192200                                                                  19220029
192300         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            19230029
192400              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19240029
192500                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   19250029
192600              END-IF                                              19260029
192700                                                                  19270029
192800              PERFORM 3310-EDIT-RANGE                             19280029
192900                                                                  19290029
193000         WHEN OTHER                                               19300029
193100              MOVE PC-TSYMSG-00005                                19310029
193200                                 TO DP020-MSG-NUMBER              19320029
193300              SET PS-ERROR                                        19330029
193400                  DP020-MSG-FATAL                                 19340029
193500                  DP030-SET-CURSOR-APPL-1                         19350029
193600                                 TO TRUE                          19360029
193700              MOVE -1            TO MR-SELECTL (PV-SUB)           19370029
193800              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           19380029
193900              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           19390029
194000              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19400029
194100                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19410029
194200                  MOVE SPACE     TO ASC-SELECTED-SW               19420029
194300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19430029
194400              END-IF                                              19440029
194500     END-EVALUATE.                                                19450029
194600                                                                  19460029
194700     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     19470029
194800         IF ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       19480029
194900             MOVE ASC-STR-QTY      (ASC-BLK-SUB ASC-ITEM-SUB)     19490029
195000                                 TO DP010I-UNEDITED-FIELD         19500029
195100             MOVE LENGTH OF ASC-STR-QTY                           19510029
195200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19520029
195300                                 TO DP010I-MAXIMUM-DIGITS         19530029
195400             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       19540029
195500             SET DP010I-NEGATIVE-NOT-ALLOWED                      19550029
195600                                 TO TRUE                          19560029
195710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     19571066
195720                  USING DP010I-NUMERIC-EDIT-AREA                  19572066
195800                                                                  19580029
195900             IF  DP010I-ERROR-DETECTED                            19590029
196000                 SET PS-ERROR                                     19600029
196100                     DP020-MSG-FATAL                              19610029
196200                     DP030-SET-CURSOR-APPL-1                      19620029
196300                                 TO TRUE                          19630029
196400                 MOVE PC-TSYMSG-00005                             19640029
196500                                 TO DP020-MSG-NUMBER              19650029
196600                 MOVE DP015-UNP-NUM-BRT-OFF                       19660029
196700                                 TO MR-STR-QTY-A (PV-SUB)         19670029
196800                 MOVE -1         TO MR-STR-QTY-L (PV-SUB)         19680029
196900                 MOVE DP015-RED  TO MR-STR-QTY-C (PV-SUB)         19690029
197000                 MOVE DP015-REVERSE                               19700029
197100                                 TO MR-STR-QTY-H (PV-SUB)         19710029
197200                 SET DP030-SET-CURSOR-APPL-1                      19720029
197300                                 TO TRUE                          19730029
197400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19740029
197500             ELSE                                                 19750029
197600                 SUBTRACT ASC-STR-QTY-PREV                        19760029
197700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    19770029
197800                         FROM ASC-KEY-DISTR-LNE-QTY               19780029
197900                 MOVE DP010I-NUMERIC-FIELD                        19790029
198000                                 TO ASC-STR-QTY-N                 19800029
198100                                    (ASC-BLK-SUB ASC-ITEM-SUB)    19810029
198200                 ADD ASC-STR-QTY-N                                19820029
198300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    19830029
198400                         TO ASC-KEY-DISTR-LNE-QTY                 19840029
198500                 MOVE ASC-KEY-DISTR-LNE-QTY TO ADQTYO             19850029
198600                 MOVE ASC-STR-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    19860029
198700                          TO MR-STR-QTY-EDITED (PV-SUB)           19870029
198800                 MOVE ASC-STR-QTY-N                               19880029
198900                                (ASC-BLK-SUB ASC-ITEM-SUB)        19890029
199000                         TO ASC-STR-QTY-PREV                      19900029
199100                                (ASC-BLK-SUB ASC-ITEM-SUB)        19910029
199200                 SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)          19920029
199300                                 TO TRUE                          19930029
199400             END-IF                                               19940029
199500         ELSE                                                     19950029
199600* A SELECTED STORE QTY WILL DEFAULT TO THE PRORATE QTY.           19960029
199700             SUBTRACT ASC-STR-QTY-PREV                            19970029
199800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    19980029
199900                         FROM ASC-KEY-DISTR-LNE-QTY               19990029
200000             ADD ASC-EXPTED-ITM-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)   20000029
200100                                 TO ASC-KEY-DISTR-LNE-QTY         20010029
200200             MOVE ASC-EXPTED-ITM-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)  20020029
200300                                 TO ASC-STR-QTY-N                 20030029
200400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    20040029
200500                                    MR-STR-QTY-EDITED (PV-SUB)    20050029
200600                                    ASC-STR-QTY-PREV              20060029
200700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    20070029
200800         END-IF                                                   20080029
200900     ELSE                                                         20090029
201000         SUBTRACT ASC-STR-QTY-PREV  (ASC-BLK-SUB ASC-ITEM-SUB)    20100029
201100                         FROM ASC-KEY-DISTR-LNE-QTY               20110029
201200         ADD ASC-EXPTED-ITM-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)       20120029
201300                                 TO ASC-KEY-DISTR-LNE-QTY         20130029
201400         MOVE ASC-EXPTED-ITM-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)      20140029
201500                                 TO ASC-STR-QTY-N                 20150029
201600                                    (ASC-BLK-SUB ASC-ITEM-SUB)    20160029
201700*                                   MR-STR-QTY-EDITED (PV-SUB)    20170029
201800                                    ASC-STR-QTY-PREV              20180029
201900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    20190029
202000     IF  ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20200029
202100         MOVE SPACE              TO MR-STR-QTY (PV-SUB)           20210029
202200     END-IF                                                       20220029
202300     END-IF.                                                      20230029
202400                                                                  20240029
202500     SUBTRACT +1 FROM PV-ITEM-IN-USE                              20250029
202600                      ASC-ITEM-SUB.                               20260029
202700                                                                  20270029
202800     IF ASC-ITEM-SUB < 1                                          20280029
202900         SUBTRACT +1 FROM ASC-BLK-SUB                             20290029
203000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20300029
203100     END-IF.                                                      20310029
203200                                                                  20320029
203300 3310-EDIT-RANGE.                                                 20330029
203400                                                                  20340029
203500     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 20350029
203600        IF ASC-START-OF-SELECTED-RANGE = ZERO                     20360029
203700            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  20370029
203800                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  20380029
203900            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   20390029
204000        ELSE                                                      20400029
204100            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20410029
204200                CONTINUE                                          20420029
204300            ELSE                                                  20430029
204400                MOVE PC-TSYMSG-00054                              20440029
204500                                 TO DP020-MSG-NUMBER              20450029
204600                SET DP020-MSG-FATAL                               20460029
204700                    PS-ERROR                                      20470029
204800                    DP030-SET-CURSOR-APPL-1                       20480029
204900                                 TO TRUE                          20490029
205000                MOVE -1          TO MR-SELECTL (PV-SUB)           20500029
205100                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           20510029
205200                MOVE DP015-UNDERLINE                              20520029
205300                                 TO MR-SELECTH (PV-SUB)           20530029
205400            END-IF                                                20540029
205500        END-IF                                                    20550029
205600     ELSE                                                         20560029
205700         IF ASC-END-OF-SELECTED-RANGE = ZERO                      20570029
205800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20580029
205900                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20590029
206000             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     20600029
206100         ELSE                                                     20610029
206200             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        20620029
206300                 CONTINUE                                         20630029
206400             ELSE                                                 20640029
206500                MOVE PC-TSYMSG-00055                              20650029
206600                                 TO DP020-MSG-NUMBER              20660029
206700                SET DP020-MSG-FATAL                               20670029
206800                    PS-ERROR                                      20680029
206900                    DP030-SET-CURSOR-APPL-1                       20690029
207000                                 TO TRUE                          20700029
207100                MOVE -1          TO MR-SELECTL (PV-SUB)           20710029
207200             END-IF                                               20720029
207300         END-IF                                                   20730029
207400     END-IF.                                                      20740029
207500                                                                  20750029
207600 3350-EDIT-DISTR-LNE-QTY.                                         20760029
207700     IF ASC-KEY-DISTR-LNE-QTY NOT = ASC-KEY-REC-LNE-QTY           20770029
207800         SET PS-ERROR                                             20780029
207900             DP020-MSG-FATAL                                      20790029
208000             DP030-SET-CURSOR-APPL-1                              20800029
208100                           TO TRUE                                20810029
208200         MOVE PC-TSYMSG-00866                                     20820029
208300                        TO DP020-MSG-NUMBER                       20830029
208400         MOVE -1        TO MR-SELECTL (1)                         20840029
208500         MOVE DP015-RED TO ADQTYC                                 20850029
208600         MOVE DP015-REVERSE                                       20860029
208700                        TO ADQTYH                                 20870029
208800         SET DP030-SET-CURSOR-APPL-1                              20880029
208900                            TO TRUE                               20890054
209000*JAK 05/2007 - ADD CODE FOR WMOS INTERFACE                        20900054
209100     ELSE                                                         20910054
209200         PERFORM 5610-SELECT-TRECEIV                              20920056
209300         PERFORM 5600-CHECK-ASNDWN                                20930056
209400         IF PS-ASNS-TO-WMS-YES                                    20940054
209500            AND PS-NO-ERROR                                       20950054
209600             PERFORM 5620-CHECK-TRECDIS                           20960054
209700             IF PS-DISTRO-TRBL-NO                                 20970054
209800                 PERFORM 5630-GET-TRIP-ID                         20980054
209900                 IF PS-NO-ERROR                                   20990054
210000                     PERFORM 5640-CALL-WMS-MODULE                 21000054
210100                 END-IF                                           21010054
210200             END-IF                                               21020054
210300         END-IF                                                   21030054
210400*JAK 05/2007 - END                                                21040054
210500                                                                  21050054
210600     END-IF.                                                      21060054
210700                                                                  21070029
210800 3400-CHECK-RANGE-SEQUENCE.                                       21080029
210900                                                                  21090029
211000     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    21100029
211100        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    21110029
211200        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   21120029
211300         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              21130029
211400         SET PS-ERROR                                             21140029
211500             DP020-MSG-FATAL     TO TRUE                          21150029
211600                                                                  21160029
211700         PERFORM 3410-POSITION-AT-ERROR                           21170029
211800     END-IF.                                                      21180029
211900                                                                  21190029
212000 3410-POSITION-AT-ERROR.                                          21200029
212100                                                                  21210029
212200     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         21220029
212300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               21230029
212400                                                  PV-TOP-ITEM + 1.21240029
212500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       21250029
212600         CONTINUE                                                 21260029
212700     ELSE                                                         21270029
212800         MOVE -1                 TO MR-SELECTL (PV-SUB)           21280029
212900         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           21290029
213000         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           21300029
213100     END-IF.                                                      21310029
213200                                                                  21320029
213300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.21330029
213400     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       21340029
213500         CONTINUE                                                 21350029
213600     ELSE                                                         21360029
213700         MOVE -1                 TO MR-SELECTL (PV-SUB)           21370029
213800         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           21380029
213900         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           21390029
214000     END-IF.                                                      21400029
214100                                                                  21410029
214200 3500-MARK-RANGE-AS-SELECTED.                                     21420029
214300                                                                  21430029
214400     MOVE +1                     TO ASC-BLK-SUB.                  21440029
214500                                                                  21450029
214600     PERFORM 3510-MARK-SELECTED-INDS                              21460029
214700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    21470029
214800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           21480029
214900                                                                  21490029
215000     ADD +1                      TO ASC-BLK-SUB.                  21500029
215100                                                                  21510029
215200     PERFORM 3510-MARK-SELECTED-INDS                              21520029
215300             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    21530029
215400             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           21540029
215500                                                                  21550029
215600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              21560029
215700                                 TO PV-LIST-ITEM-NUMBER.          21570029
215800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        21580029
215900                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).21590029
216000     MOVE ASC-START-OF-SELECTED-RANGE                             21600029
216100                                 TO PV-START-OF-SELECTED-RANGE.   21610029
216200     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        21620029
216300             ((PV-START-OF-SELECTED-RANGE - 1) /                  21630029
216400                                              PC-ITEMS-PER-PANEL).21640029
216500     MOVE ASC-END-OF-SELECTED-RANGE                               21650029
216600                                 TO PV-END-OF-SELECTED-RANGE.     21660029
216700     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         21670029
216800             ((PV-END-OF-SELECTED-RANGE - 1) /                    21680029
216900                                              PC-ITEMS-PER-PANEL).21690029
217000     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.21700029
217100                                                                  21710029
217200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21720029
217300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21730029
217400         MOVE +1                 TO ASC-BLK-SUB                   21740029
217500                                                                  21750029
217600         PERFORM 5100-WRITE-TEMP-STORAGE                          21760029
217700                                                                  21770029
217800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21780029
217900                                       PV-FIRST-BLOCK-IN-ARRAY - 121790029
218000                                                                  21800029
218100         PERFORM                                                  21810029
218200           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 21820029
218300                 MOVE PV-FIRST-BLOCK-IN-RANGE                     21830029
218400                                 TO PV-BLOCK-NUMBER               21840029
218500                                                                  21850029
218600                 PERFORM 4410-READ-TEMP-STORAGE                   21860029
218700                                                                  21870029
218800                 PERFORM 3510-MARK-SELECTED-INDS                  21880029
218900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        21890029
219000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL21900029
219100                                                                  21910029
219200                 PERFORM 5100-WRITE-TEMP-STORAGE                  21920029
219300                                                                  21930029
219400                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       21940029
219500         END-PERFORM                                              21950029
219600                                                                  21960029
219700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21970029
219800                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY21980029
219900         PERFORM                                                  21990029
220000           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  22000029
220100                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      22010029
220200                                 TO PV-BLOCK-NUMBER               22020029
220300                                                                  22030029
220400                 PERFORM 4410-READ-TEMP-STORAGE                   22040029
220500                                                                  22050029
220600                 PERFORM 3510-MARK-SELECTED-INDS                  22060029
220700                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        22070029
220800                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL22080029
220900                                                                  22090029
221000                 PERFORM 5100-WRITE-TEMP-STORAGE                  22100029
221100                                                                  22110029
221200                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        22120029
221300         END-PERFORM                                              22130029
221400                                                                  22140029
221500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22150029
221600                                 TO PV-BLOCK-NUMBER               22160029
221700                                                                  22170029
221800         PERFORM 4410-READ-TEMP-STORAGE                           22180029
221900                                                                  22190029
222000     END-IF.                                                      22200029
222100                                                                  22210029
222200     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   22220029
222300                                    ASC-END-OF-SELECTED-RANGE.    22230029
222400                                                                  22240029
222500 3510-MARK-SELECTED-INDS.                                         22250029
222600                                                                  22260029
222700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     22270029
222800                                       ASC-START-OF-SELECTED-RANGE22280029
222900        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  22290029
223000                                         ASC-END-OF-SELECTED-RANGE22300029
223100           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           22310029
223200               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          22320029
223300                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               22330029
223400                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     22340029
223500                                 TO TRUE                          22350029
223600               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  22360029
223700           END-IF                                                 22370029
223800        END-IF                                                    22380029
223900     END-IF.                                                      22390029
224000     EJECT                                                        22400029
224100 4000-BUILD-INITIAL-PANEL.                                        22410029
224200                                                                  22420029
224300     INITIALIZE ASC-BLOCK-ENTRIES (1)                             22430029
224400                ASC-BLOCK-ENTRIES (2).                            22440029
224500                                                                  22450029
224600     MOVE +1                     TO ASC-BLK-SUB.                  22460029
224700     SET ASC-MORE-RECDIS         TO TRUE.                         22470029
224800                                                                  22480029
224900     MOVE ZERO                   TO ASC-ITEM-SUB                  22490029
225000                                    ASC-NUMBER-OF-ITEMS-READ      22500029
225100                                    ASC-NUMBER-OF-SELECTED-ITEMS  22510029
225200                                    ASC-HIGHEST-BLOCK-WRITTEN     22520029
225300                                    ASC-START-OF-SELECTED-RANGE   22530029
225400                                    ASC-END-OF-SELECTED-RANGE     22540029
225500                                    ASC-ITEM-AT-TOP-OF-PANEL.     22550029
225600                                                                  22560029
225700     PERFORM 4010-FORMAT-KEYS.                                    22570029
225800                                                                  22580029
225900     PERFORM 4011-LOOK-FOR-TROUBLE.                               22590029
226000                                                                  22600029
226100     PERFORM 4020-GET-VENDOR-NAME.                                22610029
226200     INITIALIZE XL001-ITEM-COMMAREA                               22620030
226300                PV-TEMP-SEQ-NBR                                   22630032
226400                PV-SN-SEQ-NBR.                                    22640034
226500     PERFORM 4100-SELECT-PURITM-DATA.                             22650029
226600                                                                  22660029
226700     IF (DK-SKU-SEQ = PC-000)                                     22670029
226800         MOVE '00000000' TO PV-SN-SEQ-NBR.                        22680029
226900                                                                  22690029
227000     IF (DK-SKU-SEQ = PC-999)                                     22700029
227100         MOVE '99999999' TO PV-SN-SEQ-NBR.                        22710029
227200                                                                  22720029
227300     IF    PS-CALL-API-YES          AND                           22730029
227400         ((DK-SKU-SEQ NOT = PC-000) AND                           22740029
227500          (DK-SKU-SEQ NOT = PC-999))                              22750029
227600                                                                  22760029
227700        PERFORM 4105-CALL-CICS-API-ARCH.                          22770029
227800                                                                  22780029
227900     MOVE PURCHS-DEPT-NBR        TO  PV-SN-DEPT-NBR.              22790029
228000     MOVE PV-SKU-NBR             TO  ASC-SKU-NBR.                 22800029
228100     MOVE PURITM-VEND-STYL-NAME  TO  ASC-VEND-STYL-NAME           22810029
228200                                                                  22820029
228300*  LINKS TO DPKCS276.  RETURNS WITH ALL STORES AND THEIR OTR.     22830029
228400     PERFORM 4200-CALC-OPEN-TO-REC                                22840029
228500                                                                  22850029
228600     PERFORM 4095-CHECK-AUTOVRFD.                                 22860039
228700                                                                  22870039
228800     PERFORM 4110-SELECT-RECITM-DATA.                             22880049
228900                                                                  22890049
229000*    IF ASC-AUTO-VE-NO                                            22900049
229100*        PERFORM 4110-SELECT-RECITM-DATA                          22910049
229200*    ELSE                                                         22920049
229300***  NEEDED TO GET THE RECITM-INNR-PACK-QTY AND                   22930044
229400***                    RECITM-CASE-PACK-QTY                       22940044
229500*        PERFORM 4110-SELECT-RECITM-DATA                          22950049
229600*        IF  PS-NO-RECITM-DATA                                    22960049
229700*            CONTINUE                                             22970049
229800*        ELSE                                                     22980049
229900*            PERFORM 4115-SELECT-RECITM-DATA                      22990049
230000*        END-IF                                                   23000049
230100*    END-IF.                                                      23010049
230200                                                                  23020044
230300     PERFORM 4030-OPEN-CURSOR.                                    23030029
230400     PERFORM 4040-GET-REC-DISTRO.                                 23040029
230500     PERFORM 4050-CLOSE-CURSOR.                                   23050029
230600                                                                  23060029
230700     MOVE PV-DISTR-LNE-QTY       TO ASC-KEY-DISTR-LNE-QTY.        23070029
230800                                                                  23080029
230900     IF DP276-NO-DISTRO                                           23090029
231000         MOVE ALL '*'            TO ASC-KEY-TOTAL-OTR-X           23100029
231100     ELSE                                                         23110029
231200         MOVE DP276-TOTAL-OTR    TO ASC-KEY-TOTAL-OTR             23120029
231300     END-IF.                                                      23130029
231400                                                                  23140029
231500     PERFORM 4060-GET-LOCATION-DESC.                              23150051
231600     PERFORM 4070-GET-TRECEIV.                                    23160029
231700     SET ASC-CAN-UPDATE           TO TRUE                         23170029
231800     IF  ASC-INTER-APPL-VERIFY                                    23180029
231900         IF (RECEIV-ML-POST-TMST LESS PV-DB2-CURRENT-TMST         23190029
232000         OR  RECEIV-FS-POST-TMST LESS PV-DB2-CURRENT-TMST)        23200029
232100         OR                                                       23210029
232200            (RECEIV-STATUS-CDE NOT EQUAL PC-VE AND                23220029
232300             RECEIV-STATUS-CDE NOT EQUAL PC-CM)                   23230029
232400* DMH 6/16/03 - BEGIN                                             23240037
232500         OR                                                       23250037
232600            (RECEIV-PKGNG-CDE  = 'M')                             23260037
232700         OR                                                       23270037
232800            (RECEIV-PKGNG-CDE  = 'I')                             23280037
232900* DMH 6/16/03 - END                                               23290037
233000                   SET ASC-CANT-UPDATE  TO  TRUE                  23300029
233100         END-IF                                                   23310029
233200     ELSE                                                         23320029
233300         IF (RECEIV-STATUS-CDE EQUAL PC-VE                        23330029
233400         OR  RECITM-STATUS-CDE EQUAL PC-VE)                       23340029
233500* DMH 6/16/03 - BEGIN                                             23350037
233600         OR                                                       23360037
233700            (RECEIV-PKGNG-CDE  = 'M')                             23370037
233800         OR                                                       23380037
233900            (RECEIV-PKGNG-CDE  = 'I')                             23390037
234000* DMH 6/16/03 - END                                               23400037
234100             SET ASC-CANT-UPDATE  TO  TRUE                        23410029
234200             IF ASC-NO-TRBL-EXISTS                                23420029
234300                 IF RECEIV-PACK-BY-ST-IND = 'Y'                   23430029
234400                     PERFORM 4080-CHECK-RACF                      23440029
234500                     IF DP008-ACCESS-DENIED                       23450029
234600                         SET ASC-CANT-UPDATE  TO  TRUE            23460029
234700                     END-IF                                       23470029
234800                 ELSE                                             23480029
234900                     SET ASC-CANT-UPDATE  TO  TRUE                23490029
235000                 END-IF                                           23500029
235100             END-IF                                               23510029
235200         END-IF                                                   23520029
235300         IF ((RECEIV-PKGNG-CDE = 'M' OR RECEIV-PKGNG-CDE = 'I')   23530029
235400          AND ASC-INTER-APPL-CODE-IND = SPACE)                    23540029
235500             SET  ASC-CANT-UPDATE  TO TRUE                        23550029
235600             MOVE RECEIV-PKGNG-CDE TO ASC-KEY-PKGNG-CDE           23560029
235700             MOVE PC-TSYMSG-02184  TO DP020-MSG-NUMBER            23570029
235800             SET DP020-MSG-WARNING TO TRUE                        23580029
235900         END-IF                                                   23590029
236000         IF ((RECEIV-PKGNG-CDE = 'M' OR RECEIV-PKGNG-CDE = 'I')   23600029
236100          AND ASC-INTER-APPL-CODE-IND NOT = SPACE)                23610029
236200             MOVE PC-TSYMSG-02194  TO DP020-MSG-NUMBER            23620029
236300             SET DP020-MSG-WARNING TO TRUE                        23630029
236400         END-IF                                                   23640029
236500     END-IF.                                                      23650029
236600                                                                  23660029
236700     PERFORM 4090-CHECK-FOR-SPLIT                                 23670029
236800     IF PV-DB2-COUNT > ZERO                                       23680029
236900         SET ASC-CANT-UPDATE          TO TRUE                     23690029
237000         MOVE PC-TSYMSG-01858    TO DP020-MSG-NUMBER              23700029
237100         SET DP020-MSG-WARNING   TO TRUE                          23710029
237200     END-IF                                                       23720029
237300                                                                  23730029
237400     MOVE +1                     TO PV-TOP-ITEM.                  23740029
237500                                                                  23750029
237600         MOVE -1                 TO MR-SELECTL (1)                23760029
237700         SET DP030-SET-CURSOR-APPL-1                              23770029
237800                                 TO TRUE                          23780029
237900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    23790029
238000 4000-EXIT.                                                       23800029
238100     EXIT.                                                        23810029
238200                                                                  23820029
238300 4010-FORMAT-KEYS.                                                23830029
238400                                                                  23840029
238500     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    23850029
238600     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              23860029
238700     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               23870029
238800                                                                  23880029
238900 4011-LOOK-FOR-TROUBLE.                                           23890029
239000                                                                  23900029
239100     EXEC SQL                                                     23910029
239200         SELECT B.TRBL_SHT_DESC                                   23920029
239300         INTO :TRBRSN-TRBL-SHT-DESC                               23930029
239400         FROM  TTRBNTF A                                          23940029
239500              ,TTRBRSN B                                          23950029
239600         WHERE A.PO_NBR               = :DK-PO-NBR                23960029
239700               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           23970029
239800               AND A.PO_LNE_NBR       = :DK-PKSL-LNE-NBR          23980029
239900               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               23990029
240000               AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE                24000029
240100               AND B.PO_UPD_IND   = :PC-A                         24010029
240200     END-EXEC                                                     24020029
240300                                                                  24030029
240400     EVALUATE TRUE                                                24040029
240500         WHEN SQLCODE = ZERO                                      24050029
240600             SET ASC-TRBL-EXISTS           TO TRUE                24060029
240700         WHEN SQLCODE = -811                                      24070029
240800         WHEN SQLCODE = +100                                      24080029
240900             SET ASC-NO-TRBL-EXISTS        TO TRUE                24090029
241000         WHEN SQLCODE = -904                                      24100029
241100         WHEN SQLCODE = -911                                      24110029
241200         WHEN SQLCODE = -913                                      24120029
241300             PERFORM 9900-SOFT-ABORT                              24130029
241400         WHEN SQLWARN0 NOT = SPACE                                24140029
241500         WHEN SQLCODE < ZERO                                      24150029
241600         WHEN SQLCODE > ZERO                                      24160029
241700             MOVE '4011-LOOK-FOR-TROUBLE'                         24170029
241800                             TO DP013-PARAGRAPH                   24180029
241900             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     24190029
242000                             TO DP013-MESSAGE-TEXT (1)            24200029
242100             MOVE SQLCA          TO DP013-SQLCA                   24210029
242200             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      24220029
242300             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      24230029
242400             SET DP013-DB2-ABEND                                  24240029
242500                 DP013-XCTL-DISPLAY-RESTART                       24250029
242600                             TO TRUE                              24260029
242700              PERFORM DP013-0000-PROCESS-ABEND                    24270029
242800     END-EVALUATE.                                                24280029
242900                                                                  24290029
243000/                                                                 24300029
243100 4020-GET-VENDOR-NAME.                                            24310029
243200                                                                  24320029
243300     EXEC SQL                                                     24330029
243400          SELECT B.ENT_NAME_DESC                                  24340029
243500               , A.DEPT_NBR                                       24350029
243600               , A.STATUS_CDE                                     24360029
243700            INTO :ENTNME-ENT-NAME-DESC                            24370029
243800               , :PURCHS-DEPT-NBR                                 24380029
243900               , :ASC-PURCHS-STATUS-CDE                           24390029
244000            FROM TPURCHS A,                                       24400029
244100                 TENTNME B                                        24410029
244200           WHERE A.VER_STATUS_CDE = :PC-ACTIVE                    24420029
244300             AND A.PO_NBR             = :DK-PO-NBR                24430029
244400             AND A.ENT_ID             = B.ENT_ID                  24440029
244500             AND B.TYPE_CDE           = :PC-01                    24450029
244600     END-EXEC                                                     24460029
244700                                                                  24470029
244800     EVALUATE TRUE                                                24480029
244900         WHEN SQLCODE = ZERO                                      24490029
245000             MOVE ENTNME-ENT-NAME-DESC                            24500029
245100                                 TO ASC-KEY-VENDOR-NAME           24510029
245200         WHEN SQLCODE = +100                                      24520029
245300             MOVE 'VENDOR NOT FOUND'                              24530029
245400                                 TO ASC-KEY-VENDOR-NAME           24540029
245500         WHEN SQLCODE = -904                                      24550029
245600         WHEN SQLCODE = -911                                      24560029
245700         WHEN SQLCODE = -913                                      24570029
245800             PERFORM 9900-SOFT-ABORT                              24580029
245900         WHEN SQLWARN0 NOT = SPACES                               24590029
246000         WHEN SQLCODE      NOT = ZERO                             24600029
246100             MOVE '4020-GET-VENDOR-NAME'                          24610029
246200                             TO DP013-PARAGRAPH                   24620029
246300             MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'            24630029
246400                             TO DP013-MESSAGE-TEXT (1)            24640029
246500             MOVE SQLCA         TO DP013-SQLCA                    24650029
246600             MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)           24660029
246700             SET DP013-DB2-ABEND                                  24670029
246800                  DP013-XCTL-DISPLAY-RESTART                      24680029
246900                             TO TRUE                              24690029
247000             PERFORM DP013-0000-PROCESS-ABEND                     24700029
247100     END-EVALUATE.                                                24710029
247200                                                                  24720029
247300 4030-OPEN-CURSOR.                                                24730029
247400                                                                  24740029
247500     EXEC SQL                                                     24750029
247600          OPEN RECDIS-CURSOR                                      24760029
247700     END-EXEC                                                     24770029
247800                                                                  24780029
247900     EVALUATE TRUE                                                24790029
248000         WHEN SQLCODE = ZERO                                      24800029
248100              CONTINUE                                            24810029
248200         WHEN SQLCODE = -904                                      24820029
248300         WHEN SQLCODE = -911                                      24830029
248400         WHEN SQLCODE = -913                                      24840029
248500             PERFORM 9900-SOFT-ABORT                              24850029
248600         WHEN SQLWARN0 NOT = SPACES                               24860029
248700         WHEN SQLCODE      NOT = ZERO                             24870029
248800              MOVE '4030-OPEN-CURSOR'                             24880029
248900                             TO DP013-PARAGRAPH                   24890029
249000              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              24900029
249100                             TO DP013-MESSAGE-TEXT (1)            24910029
249200              MOVE SQLCA         TO DP013-SQLCA                   24920029
249300              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          24930029
249400              SET DP013-XCTL-DISPLAY-RESTART                      24940029
249500                  DP013-DB2-ABEND                                 24950029
249600                             TO TRUE                              24960029
249700                                                                  24970029
249800              PERFORM DP013-0000-PROCESS-ABEND                    24980029
249900     END-EVALUATE.                                                24990029
250000                                                                  25000029
250100 4040-GET-REC-DISTRO.                                             25010029
250200                                                                  25020029
250300     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   25030029
250400         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    25040029
250500               ASC-NO-MORE-RECDIS                                 25050029
250600                                                                  25060029
250700         PERFORM 4042-FETCH-RECDIS                                25070029
250800                                                                  25080029
250900         IF ASC-MORE-RECDIS                                       25090029
251000             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 25100029
251100                 ADD +1          TO ASC-ITEM-SUB                  25110029
251200             ELSE                                                 25120029
251300                 ADD +1          TO ASC-BLK-SUB                   25130029
251400                 MOVE +1         TO ASC-ITEM-SUB                  25140029
251500                                                                  25150029
251600                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          25160029
251700                     MOVE +1     TO ASC-BLK-SUB                   25170029
251800                     SET ASC-BLOCK-MODIFIED (1)                   25180029
251900                                 TO TRUE                          25190029
252000                                                                  25200029
252100                     PERFORM 5100-WRITE-TEMP-STORAGE              25210029
252200                                                                  25220029
252300                     MOVE ASC-BLOCK-ENTRIES                       25230029
252400                                          (PC-MAX-BLOCKS-IN-ARRAY)25240029
252500                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)25250029
252600                     ADD +1      TO ASC-BLK-SUB                   25260029
252700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   25270029
252800                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     25280029
252900                                 TO TRUE                          25290029
253000                 END-IF                                           25300029
253100             END-IF                                               25310029
253200             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      25320029
253300             MOVE ASC-NUMBER-OF-ITEMS-READ                        25330029
253400                                 TO ASC-LIST-ITEM-NUMBER          25340029
253500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25350029
253600             MOVE RECDIS-STR-NBR TO ASC-STR-NBR-N                 25360029
253700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25370029
253800                                   DK-STR-NBR                     25380029
253900             IF ASC-AUTO-VE-YES                                   25390039
254000                 INITIALIZE RC074-FIELDS                          25400039
254100                 MOVE ASC-KEY-REC-SEQ-NBR-N                       25410041
254200                                       TO RC074-RCVR-SEQ-NBR      25420041
254300                 MOVE RECDIS-STR-NBR   TO RC074-STR-NBR           25430044
254400                 PERFORM 4055-CALL-RCKUT128                       25440039
254500                 MOVE RC074-EXPTED-ITM-QTY                        25450039
254600                                 TO ASC-EXPTED-ITM-QTY-N          25460039
254700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25470039
254800                                    ASC-STR-QTY-PREV              25480039
254900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25490039
255000                                                                  25500039
255100                 MOVE RC074-VERIFY-ITM-QTY                        25510039
255200                                 TO ASC-VERFD-QTY-N               25520039
255300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25530039
255400             ELSE                                                 25540039
255500                 MOVE RECDIS-EXPTED-ITM-QTY                       25550039
255600                                 TO ASC-EXPTED-ITM-QTY-N          25560029
255700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25570029
255800                                    ASC-STR-QTY-PREV              25580029
255900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25590029
256000                                                                  25600029
256100                 MOVE RECDIS-AP-VERIFY-ITM-QTY                    25610039
256200                                 TO ASC-VERFD-QTY-N               25620029
256300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25630029
256400             END-IF                                               25640039
256500*  SEARCH DP276-OTR-TABLE TO FIND OTR FOR EACH STORE              25650029
256600             MOVE DK-STR-NBR     TO DP276-SEARCH-NBR              25660029
256700             PERFORM 4210-SEARCH-OTR                              25670029
256800                                                                  25680029
256900             MOVE DP276-OTR-OUT-X TO ASC-OTR                      25690029
257000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25700029
257100             MOVE DP276-OTR-OUT   TO ASC-OTR-N                    25710029
257200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25720029
257300             MOVE DP276-ORDER-QTY-X TO ASC-UNT-QTY                25730029
257400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25740029
257500                                                                  25750029
257600             IF ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0    25760042
257700                 COMPUTE PV-DISTR-LNE-QTY = PV-DISTR-LNE-QTY +    25770042
257800                   ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)     25780042
257900             ELSE                                                 25790029
258000                 COMPUTE PV-DISTR-LNE-QTY = PV-DISTR-LNE-QTY +    25800042
258100                   ASC-EXPTED-ITM-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)25810042
258200             END-IF                                               25820029
258300                                                                  25830029
258400             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY  25840029
258500                 CONTINUE                                         25850029
258600             ELSE                                                 25860029
258700                 PERFORM 4120-OPEN-PRIOR-RCVR-CURSOR              25870029
258800                 PERFORM 4130-PROCESS-PRIOR-RCVR-DISTRO           25880029
258900                 PERFORM 4135-ARE-THERE-ANY-MORE                  25890029
259000                 PERFORM 4150-CLOSE-PRIOR-RCVR-CURSOR             25900029
259100             END-IF                                               25910029
259200                                                                  25920029
259300         END-IF                                                   25930029
259400     END-PERFORM.                                                 25940029
259500                                                                  25950029
259600     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           25960029
259700         MOVE +1                 TO ASC-BLK-SUB                   25970029
259800                                                                  25980029
259900         PERFORM 5100-WRITE-TEMP-STORAGE                          25990029
260000                                                                  26000029
260100         ADD +1                  TO ASC-BLK-SUB                   26010029
260200                                                                  26020029
260300         PERFORM 5100-WRITE-TEMP-STORAGE                          26030029
260400                                                                  26040029
260500         MOVE +1                 TO ASC-BLK-SUB                   26050029
260600                                    PV-BLOCK-NUMBER               26060029
260700                                                                  26070029
260800         PERFORM 4410-READ-TEMP-STORAGE                           26080029
260900                                                                  26090029
261000         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         26100029
261100             MOVE +2             TO ASC-BLK-SUB                   26110029
261200                                    PV-BLOCK-NUMBER               26120029
261300                                                                  26130029
261400             PERFORM 4410-READ-TEMP-STORAGE                       26140029
261500         END-IF                                                   26150029
261600     END-IF.                                                      26160029
261700                                                                  26170029
261800 4042-FETCH-RECDIS.                                               26180029
261900                                                                  26190029
262000     EXEC SQL                                                     26200029
262100          FETCH  RECDIS-CURSOR                                    26210029
262200           INTO :RECDIS-EXPTED-ITM-QTY,                           26220029
262300                :RECDIS-VERIFY-ITM-QTY,                           26230029
262400                :RECDIS-AP-VERIFY-ITM-QTY,                        26240029
262500                :RECDIS-STR-NBR                                   26250029
262600     END-EXEC.                                                    26260029
262700                                                                  26270029
262800     EVALUATE TRUE                                                26280029
262900         WHEN SQLCODE = ZERO                                      26290029
263000         WHEN SQLCODE = +100                                      26300029
263100              CONTINUE                                            26310029
263200         WHEN SQLCODE = -904                                      26320029
263300         WHEN SQLCODE = -911                                      26330029
263400         WHEN SQLCODE = -913                                      26340029
263500             PERFORM 9900-SOFT-ABORT                              26350029
263600         WHEN SQLWARN0 NOT = SPACES                               26360029
263700         WHEN SQLCODE  NOT = ZERO                                 26370029
263800              MOVE '4042-FETCH-RECDIS'                            26380029
263900                                 TO DP013-PARAGRAPH               26390029
264000              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          26400029
264100                                 TO DP013-MESSAGE-TEXT (1)        26410029
264200              MOVE SQLCA         TO DP013-SQLCA                   26420029
264300              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      26430029
264400              SET DP013-DB2-ABEND                                 26440029
264500                  DP013-XCTL-DISPLAY-RESTART                      26450029
264600                                 TO TRUE                          26460029
264700                                                                  26470029
264800              PERFORM DP013-0000-PROCESS-ABEND                    26480029
264900     END-EVALUATE.                                                26490029
265000                                                                  26500029
265100     IF SQLCODE = +100                                            26510029
265200         SET ASC-NO-MORE-RECDIS  TO TRUE                          26520029
265300     END-IF.                                                      26530029
265400                                                                  26540029
265500 4050-CLOSE-CURSOR.                                               26550029
265600                                                                  26560029
265700     EXEC SQL                                                     26570029
265800          CLOSE RECDIS-CURSOR                                     26580029
265900     END-EXEC.                                                    26590029
266000                                                                  26600029
266100     EVALUATE TRUE                                                26610029
266200         WHEN SQLCODE = ZERO                                      26620029
266300              CONTINUE                                            26630029
266400         WHEN SQLCODE = -904                                      26640029
266500         WHEN SQLCODE = -911                                      26650029
266600         WHEN SQLCODE = -913                                      26660029
266700             PERFORM 9900-SOFT-ABORT                              26670029
266800         WHEN SQLWARN0 NOT = SPACES                               26680029
266900         WHEN SQLCODE  NOT = ZERO                                 26690029
267000              MOVE '4050-CLOSE-CURSOR'                            26700029
267100                                 TO DP013-PARAGRAPH               26710029
267200              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             26720029
267300                                 TO DP013-MESSAGE-TEXT (1)        26730029
267400              MOVE SQLCA         TO DP013-SQLCA                   26740029
267500              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      26750029
267600              SET DP013-DB2-ABEND                                 26760029
267700                  DP013-XCTL-DISPLAY-RESTART                      26770029
267800                                 TO TRUE                          26780029
267900                                                                  26790029
268000              PERFORM DP013-0000-PROCESS-ABEND                    26800029
268100     END-EVALUATE.                                                26810029
268200                                                                  26820029
268300 4055-CALL-RCKUT128.                                              26830039
268400     MOVE ASC-KEY-OPER-UNT-ID  TO RC074-OPER-UNT-ID.              26840039
268500     MOVE ASC-KEY-FCLTY-ID     TO RC074-FCLTY-ID.                 26850039
268600     MOVE ASC-KEY-PO-NBR-N     TO RC074-PO-NBR.                   26860039
268700     MOVE ASC-KEY-PKSL-LNE-NBR TO RC074-LINE-NBR.                 26870039
268800     SET RC074-UNIT-QTY-YES    TO TRUE.                           26880039
268900                                                                  26890039
269000     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 26900039
269100                                         RC074-COMMAREA           26910039
269200                                         RC074-FIELDS.            26920039
269300                                                                  26930039
269400     EVALUATE TRUE                                                26940039
269500         WHEN RC074-SUCCESSFUL                                    26950039
269600             CONTINUE                                             26960039
269700         WHEN OTHER                                               26970039
269800             MOVE '4055-CALL-RCKUT128'                            26980039
269900                                 TO DP013-PARAGRAPH               26990039
270000             STRING                                               27000039
270100                  'UNSUCCESSFUL CALL TO RCKUT128 '                27010039
270200                  'SUCCESS-IND = '                                27020039
270300                  RC074-SUCCESS-IND                               27030039
270400                               DELIMITED BY SIZE                  27040039
270500                               INTO DP013-MESSAGE-TEXT (1)        27050039
270600             MOVE RC074-CRA-RET-MSG                               27060039
270700                                 TO DP013-MESSAGE-TEXT (2)        27070039
270800             MOVE RC074-SQLCA    TO DP013-SQLCA                   27080039
270900             SET DP013-DB2-ABEND                                  27090039
271000                 DP013-XCTL-DISPLAY-RESTART                       27100039
271100                                 TO TRUE                          27110039
271200             PERFORM DP013-0000-PROCESS-ABEND                     27120039
271300     END-EVALUATE.                                                27130039
271400                                                                  27140039
271500******************************************************************27150029
271600*  GET THE LOCATION DESCRIPTION FROM THE XLT_LOC  TABLE          *27160051
271700******************************************************************27170029
271800                                                                  27180029
271900 4060-GET-LOCATION-DESC.                                          27190051
272000                                                                  27200029
272100     INITIALIZE XL071-COMMAREA-REC.                               27210051
272200                                                                  27220051
272300     MOVE ASC-KEY-OPER-UNT-ID   TO PV-UNPACK-OPER-UNT-ID.         27230051
272400     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         27240051
272500                                                                  27250051
272600     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    27260051
272700                                      XL071-COMMAREA              27270051
272800                                      XL071-COMMAREA-REC.         27280051
272900                                                                  27290051
273000     EVALUATE TRUE                                                27300051
273100         WHEN XL071-NO-ERRORS                                     27310051
273200             MOVE XL071-LOC-NM TO ASC-KEY-FCLTY-DESC              27320051
273300         WHEN XL071-LOC-NOT-FOUND                                 27330051
273400             MOVE SPACES         TO ASC-KEY-FCLTY-DESC            27340051
273500         WHEN XL071-SQLCODE-N = -904                              27350053
273600         WHEN XL071-SQLCODE-N = -911                              27360053
273700         WHEN XL071-SQLCODE-N = -913                              27370053
273800             PERFORM 9900-SOFT-ABORT                              27380051
273900         WHEN XL071-BAD-DB2-RETURN                                27390051
274000             MOVE '4060-GET-LOCATION-DESC' TO DP013-PARAGRAPH     27400051
274100             MOVE 'CALL XLKUT071' TO DP013-MESSAGE-TEXT (1)       27410051
274200             STRING 'LOCATION NBR: '    DELIMITED BY SIZE         27420051
274300                  XL071-LOCATION-NUMBER DELIMITED BY SIZE         27430051
274400                           INTO DP013-MESSAGE-TEXT(2)             27440051
274500             MOVE XL071-SQLCA         TO DP013-SQLCA              27450051
274600             MOVE XL071-SQLCODE-N     TO SQLCODE                  27460053
274700             MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1) 27470051
274800             SET DP013-DB2-ABEND      TO TRUE                     27480051
274900             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               27490051
275000             PERFORM DP013-0000-PROCESS-ABEND                     27500051
275100     END-EVALUATE.                                                27510051
275200                                                                  27520029
275300/                                                                 27530029
275400 4070-GET-TRECEIV.                                                27540029
275500                                                                  27550029
275600     EXEC SQL                                                     27560029
275700          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            27570029
275800     END-EXEC.                                                    27580029
275900                                                                  27590029
276000     EXEC SQL                                                     27600029
276100          SELECT                                                  27610029
276200                  A.PACK_BY_ST_IND                                27620029
276300                , A.ML_POST_TMST                                  27630029
276400                , A.FS_POST_TMST                                  27640029
276500                , A.STATUS_CDE                                    27650029
276600                , B.STATUS_CDE                                    27660029
276700                , A.PKGNG_CDE                                     27670029
276800            INTO                                                  27680029
276900                  :RECEIV-PACK-BY-ST-IND                          27690029
277000                , :RECEIV-ML-POST-TMST                            27700029
277100                , :RECEIV-FS-POST-TMST                            27710029
277200                , :RECEIV-STATUS-CDE                              27720029
277300                , :RECITM-STATUS-CDE                              27730029
277400                , :RECEIV-PKGNG-CDE                               27740029
277500            FROM                                                  27750029
277600                  TRECEIV A                                       27760029
277700                , TRECITM B                                       27770029
277800            WHERE                                                 27780029
277900                  A.ORD_NBR          = :DK-PO-NBR                 27790029
278000              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            27800029
278100              AND A.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       27810029
278200              AND A.FCLTY_ID         = :ASC-KEY-FCLTY-ID          27820029
278300              AND A.VER_STATUS_CDE   = :PC-ACTIVE                 27830029
278400              AND                                                 27840029
278500                  B.ORD_NBR          = :DK-PO-NBR                 27850029
278600              AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            27860029
278700              AND B.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       27870029
278800              AND B.FCLTY_ID         = :ASC-KEY-FCLTY-ID          27880029
278900              AND B.VER_STATUS_CDE   = :PC-ACTIVE                 27890029
279000              AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR           27900029
279100     END-EXEC.                                                    27910029
279200                                                                  27920029
279300     EVALUATE TRUE                                                27930029
279400         WHEN SQLCODE = ZERO                                      27940029
279500         WHEN SQLCODE = +100                                      27950029
279600              CONTINUE                                            27960029
279700         WHEN SQLCODE = -904                                      27970029
279800         WHEN SQLCODE = -911                                      27980029
279900         WHEN SQLCODE = -913                                      27990029
280000             PERFORM 9900-SOFT-ABORT                              28000029
280100         WHEN SQLWARN0 NOT = SPACES                               28010029
280200         WHEN SQLCODE  NOT = ZERO                                 28020029
280300             MOVE '4070-GET-TRECEIV'                              28030029
280400                                 TO DP013-PARAGRAPH               28040029
280500             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                28050029
280600                                 TO DP013-MESSAGE-TEXT (1)        28060029
280700             MOVE SQLCA         TO DP013-SQLCA                    28070029
280800             MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)       28080029
280900             MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)       28090029
281000             SET DP013-DB2-ABEND                                  28100029
281100                 DP013-XCTL-DISPLAY-RESTART                       28110029
281200                                 TO TRUE                          28120029
281300                                                                  28130029
281400             PERFORM DP013-0000-PROCESS-ABEND                     28140029
281500     END-EVALUATE.                                                28150029
281600                                                                  28160029
281700 4080-CHECK-RACF.                                                 28170029
281800                                                                  28180029
281900     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         28190029
282000     MOVE 'RCAPRLOC'              TO DP008-FUNCTION-NAME          28200029
282100     SET DP008-ACCESS-TYPE-USE    TO TRUE                         28210029
282200                                                                  28220029
282300     EXEC CICS                                                    28230029
282400         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 28240029
282500              COMMAREA (DP008-SECURITY-COMMAREA)                  28250029
282600              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             28260029
282700     END-EXEC                                                     28270029
282800                                                                  28280029
282900     IF DP008-CALL-SUCCESSFUL                                     28290029
283000         CONTINUE                                                 28300029
283100     ELSE                                                         28310029
283200         MOVE '4080-CHECK-RACF-ACCESS'                            28320029
283300                                     TO DP013-PARAGRAPH           28330029
283400         MOVE 'UNABLE TO ACCESS CICS'                             28340029
283500                                     TO DP013-MESSAGE-TEXT (1)    28350029
283600         MOVE SQLCA                  TO DP013-SQLCA               28360029
283700         SET DP013-DB2-ABEND                                      28370029
283800             DP013-XCTL-DISPLAY-RESTART                           28380029
283900                                     TO TRUE                      28390029
284000         PERFORM DP013-0000-PROCESS-ABEND                         28400029
284100     END-IF.                                                      28410029
284200 4090-CHECK-FOR-SPLIT.                                            28420029
284300                                                                  28430029
284400     MOVE ZERO                        TO PV-DB2-COUNT             28440029
284500     EXEC SQL                                                     28450029
284600         SELECT COUNT (*)                                         28460029
284700             INTO   :PV-DB2-COUNT                                 28470029
284800             FROM  TDISTHD                                        28480029
284900         WHERE ORD_NBR          =  :DK-PO-NBR                     28490029
285000         AND   ORD_LNE_NBR      =  :DK-PKSL-LNE-NBR               28500029
285100         AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR                28510029
285200         AND   TOT_CART_CNT     >  0                              28520029
285300         AND   CRE_USR_ID  NOT IN ('HOTCMPLT','TRLRUNLD')         28530050
285400     END-EXEC.                                                    28540029
285500                                                                  28550029
285600     EVALUATE TRUE                                                28560029
285700         WHEN SQLCODE = ZERO                                      28570029
285800         WHEN SQLCODE = +100                                      28580029
285900         WHEN SQLCODE = -305                                      28590029
286000             CONTINUE                                             28600029
286100         WHEN SQLCODE = -904                                      28610029
286200         WHEN SQLCODE = -911                                      28620029
286300         WHEN SQLCODE = -913                                      28630029
286400             PERFORM 9900-SOFT-ABORT                              28640029
286500         WHEN SQLWARN0 NOT = SPACES                               28650029
286600         WHEN SQLCODE  NOT = ZERO                                 28660029
286700             MOVE '4090-CHECK-FOR-SPLIT'                          28670029
286800                               TO DP013-PARAGRAPH                 28680029
286900             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                28690029
287000                               TO DP013-MESSAGE-TEXT (1)          28700029
287100             MOVE SQLCA     TO DP013-SQLCA                        28710029
287200             MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)           28720029
287300             SET DP013-DB2-ABEND                                  28730029
287400                 DP013-XCTL-DISPLAY-RESTART                       28740029
287500                                 TO TRUE                          28750029
287600             PERFORM DP013-0000-PROCESS-ABEND                     28760029
287700     END-EVALUATE.                                                28770029
287800                                                                  28780029
287900*----------------------------------------------------------------*28790039
288000*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          28800039
288100*----------------------------------------------------------------*28810039
288200 4095-CHECK-AUTOVRFD.                                             28820039
288300                                                                  28830039
288400     INITIALIZE RC040-FIELDS.                                     28840039
288500     MOVE DP020-LOCATION      TO RC040-SIGNON-LOCATION.           28850039
288600     MOVE ASC-KEY-PO-NBR-N    TO RC040-PO-NBR.                    28860039
288700     MOVE ASC-KEY-REC-SEQ-NBR-N                                   28870041
288800                              TO RC040-PO-RCVR.                   28880039
288900     MOVE DP020-USERID        TO RC040-USER-ID.                   28890039
289000     MOVE 'RCKCS218'          TO RC040-CALLING-PROGRAM.           28900039
289100                                                                  28910039
289200     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  28920039
289300                                        RC040-COMMAREA            28930039
289400                                        RC040-FIELDS.             28940039
289500                                                                  28950039
289600     EVALUATE TRUE                                                28960039
289700         WHEN RC040-SUCCESSFUL                                    28970039
289800                 MOVE RC040-AUTO-VE-SW TO ASC-AUTO-VE-SW          28980039
289900         WHEN RC040-DATABASE-BUSY OR                              28990039
290000              RC040-INVALID-SQL                                   29000039
290100                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       29010039
290200                  SET DP020-MSG-WARNING TO TRUE                   29020039
290300                  SET DP030-OVERRIDE-GO TO TRUE                   29030039
290400         WHEN RC040-NOT-SUCCESSFUL                                29040039
290500                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       29050039
290600                  SET DP020-MSG-WARNING TO TRUE                   29060039
290700                  SET DP030-OVERRIDE-GO TO TRUE                   29070039
290800         WHEN OTHER                                               29080039
290900             MOVE '4095-CHECK-AUTOVRFD ' TO DP013-PARAGRAPH       29090039
291000             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              29100039
291100                                         TO DP013-MESSAGE-TEXT (1)29110039
291200             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)29120039
291300             MOVE RC040-SQLCA            TO DP013-SQLCA           29130039
291400             SET DP013-DB2-ABEND                                  29140039
291500                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              29150039
291600             PERFORM DP013-0000-PROCESS-ABEND                     29160039
291700     END-EVALUATE.                                                29170039
291800                                                                  29180039
291900******************************************************************29190029
292000*    GET THE AD EVENT DATE TO DISPLAY IN THE HEADER AREA          29200029
292100******************************************************************29210029
292200                                                                  29220029
292300 4100-SELECT-PURITM-DATA.                                         29230029
292400                                                                  29240029
292500     EXEC SQL                                                     29250029
292600           SELECT AD_EVNT_DTE                                     29260029
292700                , PO_LNE_NBR                                      29270029
292800                , SKU_SEQ_NBR                                     29280029
292900                , VEND_STYL_NAME                                  29290029
293000                , STATUS_CDE                                      29300029
293100                , UNT_QTY                                         29310029
293200                , ITM_NBR                                         29320029
293300             INTO :PURITM-AD-EVNT-DTE                             29330029
293400                , :PURITM-PO-LNE-NBR                              29340029
293500                , :PURITM-SKU-SEQ-NBR                             29350029
293600                , :PURITM-VEND-STYL-NAME                          29360029
293700                , :ASC-PURITM-STATUS-CDE                          29370029
293800                , :ASC-PURITM-UNT-QTY                             29380029
293900                , :PURITM-ITM-NBR                                 29390029
294000             FROM TPURITM                                         29400029
294100            WHERE PO_NBR             = :DK-PO-NBR                 29410029
294200              AND APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR               29420029
294300              AND VER_STATUS_CDE = :PC-ACTIVE                     29430029
294400     END-EXEC                                                     29440029
294500******************************************************************29450029
294600     MOVE SPACES TO DK-SKU-SEQ                                    29460029
294700     MOVE ZEROES TO DK-ITM-NBR                                    29470029
294800                                                                  29480029
294900     EVALUATE TRUE                                                29490029
295000         WHEN SQLCODE = ZERO                                      29500029
295100             SET PS-CALL-API-YES     TO TRUE                      29510029
295200             MOVE PURITM-SKU-SEQ-NBR TO DK-SKU-SEQ                29520029
295300             MOVE PURITM-ITM-NBR     TO DK-ITM-NBR                29530029
295400             MOVE PURITM-AD-EVNT-DTE                              29540029
295500                             TO PV-DB2-DATE-FORMAT                29550029
295600                                PV-CHECK-FOR-DEFAULT-DATE         29560029
295700             IF PV-DEFAULT-DATE                                   29570029
295800                 MOVE SPACES TO ASC-KEY-AD-EVNT-DTE               29580029
295900             ELSE                                                 29590029
296000                 MOVE PV-DB2-CCYY                                 29600029
296100                             TO PV-AD-DATE-CCYY                   29610029
296200                 MOVE PV-DB2-MM                                   29620029
296300                             TO PV-AD-DATE-MM                     29630029
296400                 MOVE PV-DB2-DD                                   29640029
296500                             TO PV-AD-DATE-DD                     29650029
296600                 MOVE PV-AD-DATE-MM-DD-CCYY                       29660029
296700                             TO ASC-KEY-AD-EVNT-DTE               29670029
296800             END-IF                                               29680029
296900         WHEN SQLCODE = +100                                      29690029
297000              CONTINUE                                            29700029
297100     WHEN SQLCODE = -904                                          29710029
297200     WHEN SQLCODE = -911                                          29720029
297300     WHEN SQLCODE = -913                                          29730029
297400          PERFORM 9900-SOFT-ABORT                                 29740029
297500     WHEN SQLWARN0 NOT = SPACES                                   29750029
297600     WHEN SQLCODE      NOT = ZERO                                 29760029
297700          MOVE '4100-SELECT-PURITM-DATA'                          29770029
297800                         TO DP013-PARAGRAPH                       29780029
297900          MOVE 'UNSUCCESSFUL SELECT OF PURITM'                    29790029
298000                         TO DP013-MESSAGE-TEXT (1)                29800029
298100          MOVE SQLCA         TO DP013-SQLCA                       29810029
298200          MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)              29820029
298300          SET DP013-DB2-ABEND                                     29830029
298400              DP013-XCTL-DISPLAY-RESTART                          29840029
298500                         TO TRUE                                  29850029
298600                                                                  29860029
298700          PERFORM DP013-0000-PROCESS-ABEND                        29870029
298800     END-EVALUATE.                                                29880029
298900                                                                  29890029
299000 4105-CALL-CICS-API-ARCH.                                         29900029
299100                                                                  29910029
299200        MOVE DK-ITM-NBR           TO XL001-KEY-ITM-NBR.           29920029
299300                                                                  29930029
299400        SET  XL001-BY-ITEM                                        29940029
299500             XL001-SELECT-VND-STYL                                29950047
299600             XL001-SELECT-SKU     TO TRUE.                        29960047
299700                                                                  29970029
299800        CALL XL001-VSM-PGM USING  DFHEIBLK                        29980029
299900                                  XL001-COMMAREA                  29990029
300000                                  XL001-ITEM-COMMAREA.            30000029
300100        EVALUATE TRUE                                             30010029
300200                                                                  30020029
300300         WHEN XL001-SUCCESSFUL                                    30030029
300400           MOVE XL001-SKU-NBR     TO  PV-TEMP-SEQ-NBR             30040029
300500           MOVE XL001-SUB-CL-NBR-2CH                              30050047
300600                                  TO  PV-SN-CL-NBR                30060047
300700           MOVE PV-TEMP-SEQ-NBR   TO  PV-SN-SEQ-NBR               30070029
300800                                                                  30080029
300900         WHEN XL001-SKU-SQLCODE = +100                            30090029
301000           CONTINUE                                               30100029
301100                                                                  30110029
301200         WHEN XL001-SKU-SQLCODE = -904                            30120029
301300         WHEN XL001-SKU-SQLCODE = -911                            30130029
301400         WHEN XL001-SKU-SQLCODE = -913                            30140029
301500           PERFORM 9900-SOFT-ABORT                                30150029
301600                                                                  30160029
301700         WHEN XL001-INVALID-ACCESS                                30170029
301800           MOVE '4105-CALL-CICS-API-ARCH'                         30180029
301900                                TO DP013-PARAGRAPH                30190029
302000           MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'              30200029
302100                                TO DP013-MESSAGE-TEXT (1)         30210029
302200           MOVE SQLCA           TO DP013-SQLCA                    30220029
302300           MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)       30230029
302400           SET DP013-DB2-ABEND  TO TRUE                           30240029
302500           PERFORM DP013-0000-PROCESS-ABEND                       30250029
302600                                                                  30260034
302700         WHEN OTHER                                               30270029
302800           MOVE '4105-CALL-CICS-API-ARCH'                         30280029
302900                                TO DP013-PARAGRAPH                30290029
303000           MOVE 'UNSUCCESSFUL SELECT OF ITEM NBR'                 30300029
303100                                TO DP013-MESSAGE-TEXT (1)         30310029
303200           MOVE XL001-SKU-SQLCODE                                 30320034
303300                                TO SQLCODE                        30330034
303400           MOVE SQLCA           TO DP013-SQLCA                    30340029
303500           MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)       30350029
303600           SET DP013-DB2-ABEND  TO TRUE                           30360029
303700           PERFORM DP013-0000-PROCESS-ABEND                       30370029
303800        END-EVALUATE.                                             30380029
303900                                                                  30390029
304000******************************************************************30400029
304100*    SELECT RECEIVER ITEM DATA TO DISPLAY IN THE HEADER AREA      30410029
304200******************************************************************30420029
304300                                                                  30430029
304400 4110-SELECT-RECITM-DATA.                                         30440029
304500                                                                  30450029
304600     INITIALIZE DCLTRECITM.                                       30460029
304700                                                                  30470029
304800     EXEC SQL                                                     30480029
304900           SELECT INNR_PACK_QTY,                                  30490029
305000                  CASE_PACK_QTY,                                  30500029
305100                  PKSL_ITM_QTY,                                   30510029
305200                  DTL_CK_ITM_QTY,                                 30520029
305300                  CRE_TMST                                        30530029
305400             INTO :RECITM-INNR-PACK-QTY,                          30540029
305500                  :RECITM-CASE-PACK-QTY,                          30550029
305600                  :RECITM-PKSL-ITM-QTY,                           30560029
305700                  :RECITM-DTL-CK-ITM-QTY,                         30570029
305800                  :RECITM-CRE-TMST                                30580029
305900             FROM TRECITM                                         30590029
306000            WHERE ORD_NBR            = :DK-PO-NBR                 30600029
306100              AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR           30610029
306200              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            30620029
306300              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       30630029
306400              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          30640029
306500              AND VER_STATUS_CDE = :PC-ACTIVE                     30650029
306600     END-EXEC                                                     30660029
306700                                                                  30670029
306800     EVALUATE TRUE                                                30680029
306900         WHEN SQLCODE = ZERO                                      30690029
307000              SET  PS-YES-RECITM-DATA  TO  TRUE                   30700046
307100         WHEN SQLCODE = +100                                      30710029
307200              SET  PS-NO-RECITM-DATA  TO  TRUE                    30720046
307300         WHEN SQLCODE = -904                                      30730029
307400         WHEN SQLCODE = -911                                      30740029
307500         WHEN SQLCODE = -913                                      30750029
307600              PERFORM 9900-SOFT-ABORT                             30760029
307700         WHEN SQLWARN0 NOT = SPACES                               30770029
307800         WHEN SQLCODE      NOT = ZERO                             30780029
307900              MOVE '4110-SELECT-RECITM-DATA'                      30790029
308000                             TO DP013-PARAGRAPH                   30800029
308100              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    30810029
308200                             TO DP013-MESSAGE-TEXT (1)            30820029
308300              MOVE SQLCA         TO DP013-SQLCA                   30830029
308400              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          30840029
308500              SET DP013-DB2-ABEND                                 30850029
308600                  DP013-XCTL-DISPLAY-RESTART                      30860029
308700                             TO TRUE                              30870029
308800                                                                  30880029
308900              PERFORM DP013-0000-PROCESS-ABEND                    30890029
309000     END-EVALUATE                                                 30900029
309100                                                                  30910029
309200     MOVE RECITM-INNR-PACK-QTY   TO ASC-KEY-INNR-PACK-QTY.        30920029
309300     MOVE RECITM-CASE-PACK-QTY   TO ASC-KEY-CASE-PACK-QTY.        30930029
309400                                                                  30940029
309500     IF RECITM-DTL-CK-ITM-QTY > 0                                 30950029
309600         MOVE RECITM-DTL-CK-ITM-QTY                               30960029
309700                                 TO ASC-KEY-REC-LNE-QTY           30970029
309800     ELSE                                                         30980029
309900         MOVE RECITM-PKSL-ITM-QTY                                 30990029
310000                                 TO ASC-KEY-REC-LNE-QTY           31000029
310100     END-IF.                                                      31010029
310200                                                                  31020029
310300*4115-SELECT-RECITM-DATA.                                         31030049
310400*    INITIALIZE RC074-FIELDS.                                     31040049
310500*    MOVE ASC-KEY-REC-SEQ-NBR-N    TO RC074-RCVR-SEQ-NBR.         31050049
310600*    PERFORM 4055-CALL-RCKUT128.                                  31060049
310700*    MOVE RC074-EXPTED-ITM-QTY   TO ASC-KEY-REC-LNE-QTY.          31070049
310800                                                                  31080044
310900 4120-OPEN-PRIOR-RCVR-CURSOR.                                     31090029
311000                                                                  31100029
311100     EXEC SQL                                                     31110029
311200          OPEN PRIOR-RCVR-CURSOR                                  31120029
311300     END-EXEC                                                     31130029
311400                                                                  31140029
311500     EVALUATE TRUE                                                31150029
311600         WHEN SQLCODE = ZERO                                      31160029
311700              CONTINUE                                            31170029
311800         WHEN SQLCODE = -904                                      31180029
311900         WHEN SQLCODE = -911                                      31190029
312000         WHEN SQLCODE = -913                                      31200029
312100              PERFORM 9900-SOFT-ABORT                             31210029
312200         WHEN SQLWARN0 NOT = SPACES                               31220029
312300         WHEN SQLCODE      NOT = ZERO                             31230029
312400              MOVE '4120-OPEN-PRIOR-RCVR-CURSOR'                  31240029
312500                             TO DP013-PARAGRAPH                   31250029
312600              MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR OPEN'          31260029
312700                             TO DP013-MESSAGE-TEXT (1)            31270029
312800              MOVE SQLCA         TO DP013-SQLCA                   31280029
312900              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          31290029
313000              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (2)          31300029
313100              SET DP013-XCTL-DISPLAY-RESTART                      31310029
313200                  DP013-DB2-ABEND                                 31320029
313300                             TO TRUE                              31330029
313400                                                                  31340029
313500              PERFORM DP013-0000-PROCESS-ABEND                    31350029
313600     END-EVALUATE.                                                31360029
313700                                                                  31370029
313800 4130-PROCESS-PRIOR-RCVR-DISTRO.                                  31380029
313900                                                                  31390029
314000     PERFORM 4140-FETCH-PRIOR-RCVR.                               31400029
314100                                                                  31410029
314200     IF SQLCODE = +0                                              31420029
314300         MOVE RECEIV-STATUS-CDE  TO ASC-STATUS                    31430039
314400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31440039
314500         IF ASC-AUTO-VE-YES                                       31450039
314600             INITIALIZE RC074-FIELDS                              31460039
314700             MOVE RECEIV-REC-SEQ-NBR TO RC074-RCVR-SEQ-NBR        31470039
314800             MOVE RECDIS-STR-NBR     TO RC074-STR-NBR             31480044
314900             PERFORM 4055-CALL-RCKUT128                           31490039
315000                                                                  31500039
315100             IF RECITM-STATUS-CDE = PC-VE                         31510039
315200                 MOVE RC074-VERIFY-ITM-QTY                        31520039
315300                                 TO ASC-LAST-QTY-REC-N            31530029
315400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31540029
315500             ELSE                                                 31550039
315600                 MOVE RC074-TOTAL-ACTL-ITM-QTY                    31560039
315700                                 TO ASC-LAST-QTY-REC-N            31570029
315800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31580029
315900             END-IF                                               31590039
316000         ELSE                                                     31600039
316100             IF RECITM-STATUS-CDE = PC-VE                         31610039
316200                 MOVE RECDIS-AP-VERIFY-ITM-QTY                    31620039
316300                                 TO ASC-LAST-QTY-REC-N            31630039
316400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31640039
316500             ELSE                                                 31650039
316600                 MOVE RECDIS-VERIFY-ITM-QTY                       31660039
316700                                 TO ASC-LAST-QTY-REC-N            31670039
316800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31680039
316900             END-IF                                               31690039
317000         END-IF                                                   31700039
317100         IF PV-DB2-DATE-FORMAT = '9999-09-09'                     31710029
317200              MOVE 'ENRTE '      TO ASC-LAST-DTE-REC              31720029
317300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31730029
317400         ELSE                                                     31740029
317500             MOVE PV-DB2-DATE-FORMAT                              31750029
317600                                 TO PV-DB2-DATE-FORMAT-REDE       31760029
317700             MOVE PV-DB2-MM      TO PV-SCREEN-DATE-MM             31770029
317800             MOVE PV-DB2-DD      TO PV-SCREEN-DATE-DD             31780029
317900             MOVE PV-DB2-YY      TO PV-SCREEN-DATE-YY             31790029
318000             MOVE PV-SCREEN-DATE-FORMAT                           31800029
318100                                 TO ASC-LAST-DTE-REC              31810029
318200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31820029
318300         END-IF                                                   31830029
318400         PERFORM 4140-FETCH-PRIOR-RCVR                            31840029
318500         IF SQLCODE = +0                                          31850029
318600             MOVE RECEIV-STATUS-CDE  TO ASC-STATUS-2              31860029
318700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31870029
318800             IF ASC-AUTO-VE-YES                                   31880043
318900                 INITIALIZE RC074-FIELDS                          31890043
319000                 MOVE RECEIV-REC-SEQ-NBR TO RC074-RCVR-SEQ-NBR    31900043
319100                 MOVE RECDIS-STR-NBR     TO RC074-STR-NBR         31910044
319200                 PERFORM 4055-CALL-RCKUT128                       31920043
319300                                                                  31930043
319400                 IF RECITM-STATUS-CDE = PC-VE                     31940043
319500                     MOVE RC074-VERIFY-ITM-QTY                    31950043
319600                                 TO ASC-PRIOR-QTY-REC-N           31960043
319700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31970043
319800                 ELSE                                             31980043
319900                     MOVE RC074-TOTAL-ACTL-ITM-QTY                31990043
320000                                 TO ASC-PRIOR-QTY-REC-N           32000043
320100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32010043
320200                 END-IF                                           32020043
320300             ELSE                                                 32030043
320400                 IF RECITM-STATUS-CDE = PC-VE                     32040043
320500                     MOVE RECDIS-AP-VERIFY-ITM-QTY                32050043
320600                                 TO ASC-PRIOR-QTY-REC-N           32060029
320700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32070029
320800                 ELSE                                             32080043
320900                     MOVE RECDIS-VERIFY-ITM-QTY                   32090043
321000                                 TO ASC-PRIOR-QTY-REC-N           32100029
321100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32110029
321200                 END-IF                                           32120043
321300             END-IF                                               32130043
321400             IF PV-DB2-DATE-FORMAT = '9999-09-09'                 32140029
321500                  MOVE 'ENRTE '      TO ASC-PRIOR-DTE-REC         32150029
321600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32160029
321700             ELSE                                                 32170029
321800                 MOVE PV-DB2-DATE-FORMAT                          32180029
321900                                     TO PV-DB2-DATE-FORMAT-REDE   32190029
322000                 MOVE PV-DB2-MM      TO PV-SCREEN-DATE-MM         32200029
322100                 MOVE PV-DB2-DD      TO PV-SCREEN-DATE-DD         32210029
322200                 MOVE PV-DB2-YY      TO PV-SCREEN-DATE-YY         32220029
322300                 MOVE PV-SCREEN-DATE-FORMAT                       32230029
322400                                     TO ASC-PRIOR-DTE-REC         32240029
322500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32250029
322600             END-IF                                               32260029
322700         END-IF                                                   32270029
322800     END-IF.                                                      32280029
322900                                                                  32290029
323000 4135-ARE-THERE-ANY-MORE.                                         32300029
323100     IF SQLCODE = ZERO                                            32310029
323200*  THIS IS THE RETURN CODE FROM THE SECOND FETCH                  32320029
323300         PERFORM 4140-FETCH-PRIOR-RCVR                            32330029
323400         IF SQLCODE = ZERO                                        32340029
323500             MOVE 'Y'               TO ASC-MORE                   32350029
323600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32360029
323700         END-IF                                                   32370029
323800     END-IF.                                                      32380029
323900                                                                  32390029
324000 4140-FETCH-PRIOR-RCVR.                                           32400029
324100                                                                  32410029
324200     EXEC SQL                                                     32420029
324300          FETCH  PRIOR-RCVR-CURSOR                                32430029
324400           INTO :PV-DB2-DATE-FORMAT,                              32440029
324500                :RECEIV-STATUS-CDE,                               32450029
324600                :RECDIS-EXPTED-ITM-QTY,                           32460029
324700                :RECDIS-VERIFY-ITM-QTY,                           32470029
324800                :RECDIS-AP-VERIFY-ITM-QTY,                        32480029
324900                :RECITM-STATUS-CDE,                               32490040
325000                :RECEIV-REC-SEQ-NBR                               32500039
325100     END-EXEC.                                                    32510029
325200                                                                  32520029
325300     EVALUATE TRUE                                                32530029
325400         WHEN SQLCODE = ZERO                                      32540029
325500         WHEN SQLCODE = +100                                      32550029
325600              CONTINUE                                            32560029
325700         WHEN SQLCODE = -904                                      32570029
325800         WHEN SQLCODE = -911                                      32580029
325900         WHEN SQLCODE = -913                                      32590029
326000              PERFORM 9900-SOFT-ABORT                             32600029
326100         WHEN SQLWARN0 NOT = SPACES                               32610029
326200         WHEN SQLCODE  NOT = ZERO                                 32620029
326300              MOVE '4140-FETCH-PRIOR-RCVR'                        32630029
326400                                 TO DP013-PARAGRAPH               32640029
326500              MOVE 'UNSUCCESSFUL FETCH OF PRIOR RCVR CURSOR'      32650029
326600                                 TO DP013-MESSAGE-TEXT (1)        32660029
326700              MOVE SQLCA         TO DP013-SQLCA                   32670029
326800              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      32680029
326900              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (2)      32690029
327000              SET DP013-DB2-ABEND                                 32700029
327100                  DP013-XCTL-DISPLAY-RESTART                      32710029
327200                                 TO TRUE                          32720029
327300                                                                  32730029
327400              PERFORM DP013-0000-PROCESS-ABEND                    32740029
327500     END-EVALUATE.                                                32750029
327600                                                                  32760029
327700 4150-CLOSE-PRIOR-RCVR-CURSOR.                                    32770029
327800                                                                  32780029
327900     EXEC SQL                                                     32790029
328000          CLOSE PRIOR-RCVR-CURSOR                                 32800029
328100     END-EXEC.                                                    32810029
328200                                                                  32820029
328300     EVALUATE TRUE                                                32830029
328400         WHEN SQLCODE = ZERO                                      32840029
328500              CONTINUE                                            32850029
328600         WHEN SQLCODE = -904                                      32860029
328700         WHEN SQLCODE = -911                                      32870029
328800         WHEN SQLCODE = -913                                      32880029
328900              PERFORM 9900-SOFT-ABORT                             32890029
329000         WHEN SQLWARN0 NOT = SPACES                               32900029
329100         WHEN SQLCODE  NOT = ZERO                                 32910029
329200              MOVE '4150-CLOSE-PRIOR-RCVR-CURSOR'                 32920029
329300                                 TO DP013-PARAGRAPH               32930029
329400              MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR CLOSE'         32940029
329500                                 TO DP013-MESSAGE-TEXT (1)        32950029
329600              MOVE SQLCA         TO DP013-SQLCA                   32960029
329700              MOVE 'TRECEIV '    TO DP013-DB2-TABLE-NAME (1)      32970029
329800              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (2)      32980029
329900              SET DP013-DB2-ABEND                                 32990029
330000                  DP013-XCTL-DISPLAY-RESTART                      33000029
330100                                 TO TRUE                          33010029
330200                                                                  33020029
330300              PERFORM DP013-0000-PROCESS-ABEND                    33030029
330400     END-EVALUATE.                                                33040029
330500                                                                  33050029
330600******************************************************************33060029
330700*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       33070029
330800******************************************************************33080029
330900                                                                  33090029
331000 4200-CALC-OPEN-TO-REC.                                           33100029
331100                                                                  33110029
331200     SET DP276-STORE-LEVEL-OTR                                    33120029
331300         DP276-RECEIVER-OTR      TO TRUE                          33130029
331400                                                                  33140029
331500     INITIALIZE DP276-KEYS                                        33150029
331600     MOVE DK-PO-NBR              TO DP276-PO-NBR                  33160029
331700     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              33170029
331800     MOVE DK-REC-SEQ-NBR         TO DP276-REC-SEQ-NBR             33180029
331900     MOVE ASC-KEY-OPER-UNT-ID    TO DP276-OPER-UNT-ID             33190029
332000     MOVE ASC-KEY-FCLTY-ID       TO DP276-FCLTY-ID                33200029
332100                                                                  33210029
332200     COPY DPPD276.                                                33220038
332300/                                                                 33230029
332400 4400-MOVE-COMMAREA-TO-SCREEN.                                    33240029
332500                                                                  33250029
332600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         33260029
332700           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         33270029
332800           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            33280029
332900             MOVE +1             TO ASC-BLK-SUB                   33290029
333000                                                                  33300029
333100             PERFORM 5100-WRITE-TEMP-STORAGE                      33310029
333200                                                                  33320029
333300             ADD +1              TO ASC-BLK-SUB                   33330029
333400                                                                  33340029
333500             PERFORM 5100-WRITE-TEMP-STORAGE                      33350029
333600                                                                  33360029
333700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             33370029
333800                 GIVING PV-BLOCK-NUMBER                           33380029
333900                 REMAINDER PV-REMAINDER                           33390029
334000             IF PV-REMAINDER > ZERO                               33400029
334100                 ADD +1          TO PV-BLOCK-NUMBER               33410029
334200             END-IF                                               33420029
334300             MOVE +1             TO ASC-BLK-SUB                   33430029
334400                                                                  33440029
334500             PERFORM 4410-READ-TEMP-STORAGE                       33450029
334600                                                                  33460029
334700             ADD +1              TO ASC-BLK-SUB                   33470029
334800                                    PV-BLOCK-NUMBER               33480029
334900                                                                  33490029
335000             PERFORM 4410-READ-TEMP-STORAGE                       33500029
335100                                                                  33510029
335200     END-IF.                                                      33520029
335300                                                                  33530029
335400     MOVE +1                     TO ASC-BLK-SUB.                  33540029
335500     COMPUTE ASC-ITEM-SUB =                                       33550029
335600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              33560029
335700                       + PC-ITEMS-PER-PANEL).                     33570029
335800                                                                  33580029
335900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         33590029
336000         ADD +1                  TO ASC-BLK-SUB                   33600029
336100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33610029
336200     END-IF.                                                      33620029
336300                                                                  33630029
336400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           33640029
336500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                33650029
336600                                                                  33660029
336700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        33670029
336800                                                                  33680029
336900     PERFORM 4420-FORMAT-LIST-LINES                               33690029
337000         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            33700029
337100         UNTIL   PV-SUB < +1.                                     33710029
337200                                                                  33720029
337300     COMPUTE ASC-ITEMS-DISPLAYED =                                33730029
337400                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).33740029
337500     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      33750029
337600                                    ASTRTITO.                     33760029
337700     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                33770029
337800                                 TO AENDITO.                      33780029
337900     MOVE ASC-NUMBER-OF-ITEMS-READ                                33790029
338000                                 TO ATOTITO.                      33800029
338100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33810029
338200                                 TO ASELITO.                      33820029
338300                                                                  33830029
338400     MOVE PC-DASH                TO ASC-KEY-REC-DASH.             33840029
338500     MOVE ASC-KEY-RECEIVER       TO ARCVRO.                       33850029
338600     MOVE ASC-KEY-PKSL-LNE-NBR   TO ALINEO.                       33860029
338700     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       33870029
338800     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      33880029
338900     MOVE ASC-KEY-FCLTY-DESC     TO AFDESCO.                      33890029
339000     MOVE ASC-KEY-AD-EVNT-DTE    TO AADDTEO.                      33900029
339100     MOVE ASC-KEY-REC-LNE-QTY    TO ARQTYO.                       33910029
339200     MOVE ASC-KEY-INNR-PACK-QTY  TO AINNRO.                       33920029
339300     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       33930029
339400     MOVE ASC-KEY-TOTAL-OTR-X    TO ATOTRO.                       33940029
339500     MOVE ASC-KEY-DISTR-LNE-QTY  TO ADQTYO.                       33950029
339600     MOVE ASC-KEY-CASE-PACK-QTY  TO AOUTRO.                       33960029
339700     MOVE ASC-SKU-NBR            TO ASKUNBRO.                     33970029
339800     MOVE ASC-VEND-STYL-NAME     TO AVNSTYLO.                     33980029
339900                                                                  33990029
340000     IF DP020-MSG-NUMBER-X = SPACE                                34000029
340100        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    34010029
340200            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              34020029
340300            SET DP020-MSG-INFORMATIONAL                           34030029
340400                                 TO TRUE                          34040029
340500        END-IF                                                    34050029
340600     END-IF.                                                      34060029
340700                                                                  34070029
340800 4410-READ-TEMP-STORAGE.                                          34080029
340900                                                                  34090029
341000     EXEC CICS READQ TS                                           34100029
341100               QUEUE (ASC-LIST-QUEUE-NAME)                        34110029
341200               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            34120029
341300               ITEM  (PV-BLOCK-NUMBER)                            34130029
341400               RESP  (PV-CICS-RESP)                               34140029
341500     END-EXEC.                                                    34150029
341600                                                                  34160029
341700     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     34170029
341800         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      34180029
341900         CONTINUE                                                 34190029
342000     ELSE                                                         34200029
342100         SET DP013-CICS-ABEND                                     34210029
342200             DP013-NO-ROLLBACK   TO TRUE                          34220029
342300         MOVE '4410-READ-TEMP-STORAGE'                            34230029
342400                                 TO DP013-PARAGRAPH               34240029
342500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   34250029
342600                                 TO DP013-MESSAGE-TEXT (1)        34260029
342700                                                                  34270029
342800         PERFORM DP013-0000-PROCESS-ABEND                         34280029
342900     END-IF.                                                      34290029
343000                                                                  34300029
343100     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     34310029
343200                                 TO TRUE.                         34320029
343300                                                                  34330029
343400     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          34340029
343500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               34350029
343600     END-IF.                                                      34360029
343700                                                                  34370029
343800 4420-FORMAT-LIST-LINES.                                          34380029
343900                                                                  34390029
344000     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       34400029
344100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                34410029
344200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     34420029
344300                                    MR-STR-QTY-A     (PV-SUB)     34430029
344400         MOVE DP015-BLUE         TO MR-STR-NBR-C     (PV-SUB)     34440029
344500         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     34450029
344600                                    MR-STR-QTY       (PV-SUB)     34460029
344700                                    MR-STR-NBR       (PV-SUB)     34470029
344800                                    MR-EXPTED-ITM-QTY(PV-SUB)     34480029
344900                                    MR-OTR           (PV-SUB)     34490029
345000                                    MR-ORDER-QTY     (PV-SUB)     34500029
345100                                    MR-VERFD-QTY     (PV-SUB)     34510029
345200                                    MR-STATUS        (PV-SUB)     34520029
345300                                    MR-STATUS2       (PV-SUB)     34530029
345400                                    MR-LAST-QTY-REC  (PV-SUB)     34540029
345500                                    MR-LAST-DTE-REC  (PV-SUB)     34550029
345600                                    MR-PRIOR-QTY-REC (PV-SUB)     34560029
345700                                    MR-PRIOR-DTE-REC (PV-SUB)     34570029
345800                                    MR-MORE          (PV-SUB)     34580029
345900     ELSE                                                         34590029
346000         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     34600029
346100                                                             SPACE34610029
346200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 34620029
346300                                 TO MR-SELECTI (PV-SUB)           34630029
346400         ELSE                                                     34640029
346500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      34650029
346600                                 TO MR-SELECTI (PV-SUB)           34660029
346700         END-IF                                                   34670029
346800                                                                  34680029
346900         IF DP030-SET-CURSOR-TRAILER                              34690029
347000            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  34700029
347100                                                             SPACE34710029
347200               OR PV-SUB = 1                                      34720029
347300                SET DP030-SET-CURSOR-APPL-1                       34730029
347400                                 TO TRUE                          34740029
347500                MOVE -1          TO MR-SELECTL (PV-SUB)           34750029
347600            END-IF                                                34760029
347700         END-IF                                                   34770029
347800                                                                  34780029
347900         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            34790029
348000             IF (ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)           34800029
348100                   = SPACES)                                      34810029
348200             OR (MR-SELECTI (PV-SUB) = SPACES)                    34820029
348300                 MOVE SPACES TO MR-STR-QTY         (PV-SUB)       34830029
348400             ELSE                                                 34840029
348500                 MOVE ASC-STR-QTY-N  (ASC-BLK-SUB ASC-ITEM-SUB)   34850029
348600                                 TO MR-STR-QTY-EDITED  (PV-SUB)   34860029
348700             END-IF                                               34870029
348800             IF ASC-EXPTED-ITM-QTY-N                              34880029
348900                                 (ASC-BLK-SUB ASC-ITEM-SUB) >     34890029
349000                ASC-OTR-N (ASC-BLK-SUB ASC-ITEM-SUB)              34900029
349100                 MOVE DP015-YELLOW   TO MR-STR-NBR-C (PV-SUB)     34910029
349200             ELSE                                                 34920029
349300                 MOVE DP015-BLUE     TO MR-STR-NBR-C (PV-SUB)     34930029
349400             END-IF                                               34940029
349500             MOVE ASC-STR-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   34950029
349600                                 TO MR-STR-NBR         (PV-SUB)   34960029
349700             MOVE ASC-EXPTED-ITM-QTY-N                            34970029
349800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   34980029
349900                                 TO MR-EXPTED-ITM-QTY-EDITED      34990029
350000                                                       (PV-SUB)   35000029
350100             MOVE ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB)              35010029
350200                                 TO MR-OTR (PV-SUB)               35020029
350300             MOVE ASC-UNT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          35030029
350400                                 TO MR-ORDER-QTY (PV-SUB)         35040029
350500                                                                  35050029
350600             MOVE ASC-VERFD-QTY-N    (ASC-BLK-SUB ASC-ITEM-SUB)   35060029
350700                                 TO MR-VERFD-QTY-EDITED(PV-SUB)   35070029
350800             MOVE ASC-STATUS         (ASC-BLK-SUB ASC-ITEM-SUB)   35080029
350900                                 TO MR-STATUS          (PV-SUB)   35090029
351000             MOVE ASC-STATUS-2       (ASC-BLK-SUB ASC-ITEM-SUB)   35100029
351100                                 TO MR-STATUS2         (PV-SUB)   35110029
351200             MOVE ASC-MORE           (ASC-BLK-SUB ASC-ITEM-SUB)   35120029
351300                                 TO MR-MORE            (PV-SUB)   35130029
351400             MOVE ASC-LAST-QTY-REC-N (ASC-BLK-SUB ASC-ITEM-SUB)   35140029
351500                                 TO MR-LAST-QTY-REC-EDITED        35150029
351600                                                       (PV-SUB)   35160029
351700             MOVE ASC-LAST-DTE-REC   (ASC-BLK-SUB ASC-ITEM-SUB)   35170029
351800                                 TO MR-LAST-DTE-REC    (PV-SUB)   35180029
351900             MOVE ASC-PRIOR-QTY-REC-N(ASC-BLK-SUB ASC-ITEM-SUB)   35190029
352000                                 TO MR-PRIOR-QTY-REC-EDITED       35200029
352100                                                       (PV-SUB)   35210029
352200             MOVE ASC-PRIOR-DTE-REC  (ASC-BLK-SUB ASC-ITEM-SUB)   35220029
352300                                 TO MR-PRIOR-DTE-REC   (PV-SUB)   35230029
352400         END-IF                                                   35240029
352500     END-IF.                                                      35250029
352600                                                                  35260029
352700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               35270029
352800                                                                  35280029
352900     IF ASC-ITEM-SUB < +1                                         35290029
353000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35300029
353100         MOVE +1                 TO ASC-BLK-SUB.                  35310029
353200                                                                  35320029
353300 4430-CHECK-FOR-BEGIN-AND-END.                                    35330029
353400                                                                  35340029
353500     IF ASC-START-OF-SELECTED-RANGE > ZERO                        35350029
353600        IF ASC-END-OF-SELECTED-RANGE = ZERO                       35360029
353700            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              35370029
353800            SET DP020-MSG-WARNING                                 35380029
353900                                 TO TRUE                          35390029
354000                                                                  35400029
354100            PERFORM 4431-POSITION-AT-WARNING                      35410029
354200                                                                  35420029
354300         END-IF                                                   35430029
354400     ELSE                                                         35440029
354500         IF ASC-END-OF-SELECTED-RANGE > ZERO                      35450029
354600             MOVE PC-TSYMSG-00053                                 35460029
354700                                 TO DP020-MSG-NUMBER              35470029
354800             SET DP020-MSG-WARNING                                35480029
354900                                 TO TRUE                          35490029
355000                                                                  35500029
355100             PERFORM 4431-POSITION-AT-WARNING                     35510029
355200                                                                  35520029
355300         END-IF                                                   35530029
355400     END-IF.                                                      35540029
355500                                                                  35550029
355600 4431-POSITION-AT-WARNING.                                        35560029
355700                                                                  35570029
355800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               35580029
355900                                                  PV-TOP-ITEM + 1.35590029
356000     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35600029
356100         CONTINUE                                                 35610029
356200     ELSE                                                         35620029
356300         SET DP030-SET-CURSOR-APPL-1                              35630029
356400                                 TO TRUE                          35640029
356500         MOVE -1                 TO MR-SELECTL (PV-SUB)           35650029
356600         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           35660029
356700         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           35670029
356800     END-IF.                                                      35680029
356900                                                                  35690029
357000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.35700029
357100                                                                  35710029
357200     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35720029
357300         CONTINUE                                                 35730029
357400     ELSE                                                         35740029
357500         SET DP030-SET-CURSOR-APPL-1                              35750029
357600                                 TO TRUE                          35760029
357700         MOVE -1                 TO MR-SELECTL (PV-SUB)           35770029
357800         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           35780029
357900         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           35790029
358000     END-IF.                                                      35800029
358100                                                                  35810029
358200 5000-PREPARE-SEL-QUEUE.                                          35820029
358300                                                                  35830029
358400     MOVE +1                     TO ASC-BLK-SUB.                  35840029
358500                                                                  35850029
358600     PERFORM 5100-WRITE-TEMP-STORAGE.                             35860029
358700                                                                  35870029
358800     ADD +1                      TO ASC-BLK-SUB.                  35880029
358900                                                                  35890029
359000     PERFORM 5100-WRITE-TEMP-STORAGE.                             35900029
359100                                                                  35910029
359200     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         35920029
359300                                                                  35930029
359400     PERFORM 6010-DELETE-SEL-QUEUE.                               35940029
359500                                                                  35950029
359600     SET ASC-UPDATE-TSQ          TO TRUE.                         35960029
359700     SET RC013-IDX               TO 1.                            35970029
359800     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     35980029
359900     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        35990029
360000                                                                  36000029
360100     EVALUATE TRUE                                                36010029
360200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              36020029
360300             MOVE ASC-KEY-PO-NBR-N                                36030029
360400                                 TO DK-PO-NBR                     36040029
360500             MOVE ASC-KEY-PKSL-LNE-NBR                            36050029
360600                                 TO DK-PKSL-LNE-NBR               36060029
360700             MOVE ASC-KEY-REC-SEQ-NBR-N                           36070029
360800                                 TO DK-REC-SEQ-NBR                36080029
360900             PERFORM 5300-SEARCH-FOR-SELECTION                    36090029
361000                 VARYING PV-ITEM  FROM 1 BY 1                     36100029
361100                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      36110029
361200             IF ASC-CAN-UPDATE                                    36120029
361300                 MOVE PC-TSYMSG-00059                             36130029
361400                                 TO DP020-MSG-NUMBER              36140029
361500                 SET DP020-MSG-INFORMATIONAL                      36150029
361600                                 TO TRUE                          36160029
361700                 IF ASC-INTER-APPL-ITM-ADD OR                     36170029
361800                    ASC-INTER-APPL-DISTRO                         36180029
361900                     CONTINUE                                     36190029
362000                 ELSE                                             36200029
362100                     PERFORM 9000-UPDATE-SELECTION-QUEUE          36210029
362200                 END-IF                                           36220029
362300                                                                  36230029
362400                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 36240029
362500                            ASC-BLOCK-ENTRIES (2)                 36250029
362600                 MOVE +1             TO ASC-BLK-SUB               36260029
362700                                        PV-TOP-ITEM               36270029
362800                                                                  36280029
362900                 MOVE ZERO           TO ASC-ITEM-SUB              36290029
363000                                    ASC-NUMBER-OF-SELECTED-ITEMS  36300029
363100                                    ASC-START-OF-SELECTED-RANGE   36310029
363200                                    ASC-END-OF-SELECTED-RANGE     36320029
363300                                    ASC-ITEM-AT-TOP-OF-PANEL      36330029
363400                                                                  36340029
363500                 PERFORM 4410-READ-TEMP-STORAGE                   36350029
363600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             36360029
363700                 PERFORM 3200-RESET-ATTRIBUTES                    36370029
363800             END-IF                                               36380029
363900                                                                  36390029
364000         WHEN OTHER                                               36400029
364100             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   36410029
364200                 VARYING PV-ITEM  FROM 1 BY 1                     36420029
364300                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      36430029
364400                                                                  36440029
364500     END-EVALUATE.                                                36450029
364600                                                                  36460029
364700     IF RC013-IDX > 1                                             36470029
364800         PERFORM 5205-WRITE-SEL-QUEUE                             36480029
364900         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      36490029
365000     END-IF.                                                      36500029
365100                                                                  36510029
365200 5100-WRITE-TEMP-STORAGE.                                         36520029
365300                                                                  36530029
365400     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    36540029
365500                                 TO PV-LIST-ITEM-NUMBER.          36550029
365600     COMPUTE PV-BLOCK-NUMBER = 1 +                                36560029
365700                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).36570029
365800                                                                  36580029
365900     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           36590029
366000        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       36600029
366100                                                                  36610029
366200            PERFORM 5105-REWRITE-ASC-LISTQ                        36620029
366300                                                                  36630029
366400        END-IF                                                    36640029
366500     ELSE                                                         36650029
366600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       36660029
366700                                     ASC-HIGHEST-BLOCK-WRITTEN + 136670029
366800         PERFORM 5110-WRITE-ASC-LISTQ                             36680029
366900                                                                  36690029
367000         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     36700029
367100     END-IF.                                                      36710029
367200                                                                  36720029
367300     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     36730029
367400                                 TO TRUE.                         36740029
367500                                                                  36750029
367600 5105-REWRITE-ASC-LISTQ.                                          36760029
367700                                                                  36770029
367800     EXEC CICS WRITEQ TS                                          36780029
367900               QUEUE   (ASC-LIST-QUEUE-NAME)                      36790029
368000               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           36800029
368100               ITEM    (PV-BLOCK-NUMBER)                          36810029
368200               REWRITE                                            36820029
368300               RESP    (PV-CICS-RESP)                             36830029
368400     END-EXEC.                                                    36840029
368500                                                                  36850029
368600     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       36860029
368700         SET DP013-CICS-ABEND                                     36870029
368800             DP013-NO-ROLLBACK   TO TRUE                          36880029
368900         MOVE '5105-REWRITE-ASC-LISTQ'                            36890029
369000                                 TO DP013-PARAGRAPH               36900029
369100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'36910029
369200                                 TO DP013-MESSAGE-TEXT (1)        36920029
369300         PERFORM DP013-0000-PROCESS-ABEND                         36930029
369400     END-IF.                                                      36940029
369500                                                                  36950029
369600 5110-WRITE-ASC-LISTQ.                                            36960029
369700                                                                  36970029
369800     EXEC CICS WRITEQ TS                                          36980029
369900               QUEUE (ASC-LIST-QUEUE-NAME)                        36990029
370000               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            37000029
370100               ITEM  (PV-BLOCK-NUMBER)                            37010029
370200               RESP  (PV-CICS-RESP)                               37020029
370300     END-EXEC.                                                    37030029
370400                                                                  37040029
370500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37050029
370600         SET DP013-CICS-ABEND                                     37060029
370700             DP013-NO-ROLLBACK   TO TRUE                          37070029
370800         MOVE '5110-WRITE-ASC-LISTQ'                              37080029
370900                                 TO DP013-PARAGRAPH               37090029
371000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  37100029
371100                                 TO DP013-MESSAGE-TEXT (1)        37110029
371200         PERFORM DP013-0000-PROCESS-ABEND                         37120029
371300     END-IF.                                                      37130029
371400                                                                  37140029
371500 5200-FILL-SEL-QUEUE-RECORD.                                      37150029
371600                                                                  37160029
371700     PERFORM 6112-READ-LIST-QUEUE.                                37170029
371800                                                                  37180029
371900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           37190029
372000         PERFORM                                                  37200029
372100         VARYING LQW-IDX  FROM 1 BY 1                             37210029
372200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  37220029
372300                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            37230029
372400                 MOVE SPACE      TO RC013-ACTION-SW  (RC013-IDX)  37240029
372500                 SET RC013-IDX UP BY 1                            37250029
372600                 IF RC013-IDX > RC013-MAX-ITEMS                   37260029
372700                                                                  37270029
372800                     PERFORM 5205-WRITE-SEL-QUEUE                 37280029
372900                                                                  37290029
373000                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      37300029
373100                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         37310029
373200                     SET RC013-IDX                                37320029
373300                                 TO 1                             37330029
373400                 END-IF                                           37340029
373500         END-PERFORM                                              37350029
373600     END-IF.                                                      37360029
373700                                                                  37370029
373800 5205-WRITE-SEL-QUEUE.                                            37380029
373900                                                                  37390029
374000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37400029
374100                                 TO RC013-SELECTED-ITEMS.         37410029
374200                                                                  37420029
374300     EXEC CICS WRITEQ TS                                          37430029
374400               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     37440029
374500               FROM  (RC013-DC-SELECT-RECORD)                     37450029
374600               ITEM  (PV-SEL-QUEUE-ITEM)                          37460029
374700               RESP  (PV-CICS-RESP)                               37470029
374800     END-EXEC.                                                    37480029
374900                                                                  37490029
375000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       37500029
375100         SET DP013-CICS-ABEND                                     37510029
375200             DP013-NO-ROLLBACK   TO TRUE                          37520029
375300         MOVE '5205-WRITE-SEL-QUEUE'                              37530029
375400                                 TO DP013-PARAGRAPH               37540029
375500         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   37550029
375600                                 TO DP013-MESSAGE-TEXT (1)        37560029
375700         PERFORM DP013-0000-PROCESS-ABEND                         37570029
375800     END-IF.                                                      37580029
375900                                                                  37590029
376000 5300-SEARCH-FOR-SELECTION.                                       37600029
376100                                                                  37610029
376200     PERFORM 6112-READ-LIST-QUEUE.                                37620029
376300                                                                  37630029
376400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           37640029
376500         PERFORM                                                  37650029
376600         VARYING LQW-IDX  FROM 1 BY 1                             37660029
376700         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  37670029
376800                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            37680029
376900                                                                  37690029
377000             IF LQW-SELECT (LQW-IDX)                              37700029
377100                     MOVE LQW-STR-NBR (LQW-IDX)                   37710029
377200                                 TO RECDIS-STR-NBR                37720029
377300                                                                  37730029
377400                     PERFORM 5400-LINK-AUDIT-MODULE               37740029
377500                     MOVE LQW-STR-QTY (LQW-IDX)                   37750029
377600                                 TO RECDIS-EXPTED-ITM-QTY         37760029
377700                                    RECDIS-VERIFY-ITM-QTY         37770029
377800                                    LQW-EXPTED-ITM-QTY (LQW-IDX)  37780029
377900                     PERFORM 5500-UPDATE-RECDIS                   37790029
378000                     ADD +1          TO RC015-NUMBER-OF-TS-ITEMS  37800029
378100                     SET LQW-DESELECT (LQW-IDX)                   37810029
378200                                     TO TRUE                      37820029
378300                     MOVE LQW-SELECTED-SW (LQW-IDX)               37830029
378400                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)37840029
378500                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 37850029
378600             END-IF                                               37860029
378700         END-PERFORM                                              37870029
378800     END-IF.                                                      37880029
378900                                                                  37890029
379000     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 37900029
379100     PERFORM 6111-WRITE-LIST-QUEUE.                               37910029
379200                                                                  37920029
379300 5310-CHECK-FOR-SMOOTHING.                                        37930029
379400*    MOVE ZERO                        TO PV-SMOOTH-COUNT          37940029
379500     MOVE ASC-KEY-PO-NBR-N            TO DK-PO-NBR                37950029
379600     MOVE ASC-KEY-REC-SEQ-NBR-N       TO DK-REC-SEQ-NBR           37960029
379700     PERFORM 6112-READ-LIST-QUEUE.                                37970029
379800                                                                  37980029
379900     IF PV-CICS-RESP = DFHRESP (NORMAL)                           37990029
380000         PERFORM                                                  38000029
380100         VARYING LQW-IDX  FROM 1 BY 1                             38010029
380200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  38020029
380300                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            38030029
380400                                                                  38040029
380500             MOVE LQW-STR-NBR (LQW-IDX)       TO DK-STR-NBR       38050014
380600             PERFORM 7385-COUNT-SMOOTHED-CTNS                     38060029
380700             IF PV-DB2-COUNT > ZERO                               38070029
380800*                ADD PV-DB2-COUNT  TO PV-SMOOTH-COUNT             38080029
380900                 SET ASC-CANT-UPDATE          TO TRUE             38090029
381000                 MOVE PC-TSYMSG-02747    TO DP020-MSG-NUMBER      38100029
381100                 SET DP020-MSG-WARNING   TO TRUE                  38110029
381200                 SET LQW-DESELECT(LQW-IDX) TO TRUE                38120012
381300             END-IF                                               38130029
381400                                                                  38140029
381500         END-PERFORM                                              38150029
381600     END-IF.                                                      38160029
381700                                                                  38170029
381800     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 38180029
381900     PERFORM 6111-WRITE-LIST-QUEUE.                               38190029
382000/                                                                 38200029
382100 7385-COUNT-SMOOTHED-CTNS.                                        38210029
382200                                                                  38220029
382300     EXEC SQL                                                     38230029
382400         SELECT COUNT(DISTINCT(UPC.SHIPT_UNT_ID))                 38240029
382500         INTO :PV-DB2-COUNT                                       38250029
382600         FROM SUT_OTBND_UPC UPC                                   38260034
382700            , SUT_OTBND_CART UNT                                  38270034
382800         WHERE UPC.TRN_NBR              = :DK-PO-NBR              38280029
382900          AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         38290029
383000          AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID       38300029
383100          AND  UNT.DEST_LOC_NBR         =  :DK-STR-NBR            38310034
383200          AND  UNT.CART_SRC_CDE         =  'SMO'                  38320034
383300          AND  UNT.ACTV_IND             =  'Y'                    38330034
383400     END-EXEC.                                                    38340000
383500                                                                  38350000
383600     EVALUATE TRUE                                                38360012
383700         WHEN SQLCODE = ZERO                                      38370012
383800         WHEN SQLCODE = +100                                      38380012
383900             CONTINUE                                             38390012
384000         WHEN SQLCODE = -904                                      38400012
384100         WHEN SQLCODE = -913                                      38410012
384200         WHEN SQLCODE = -911                                      38420012
384300             PERFORM 9900-SOFT-ABORT                              38430012
384400         WHEN SQLWARN0 NOT = SPACES                               38440012
384500         WHEN SQLCODE < ZERO                                      38450012
384600         WHEN SQLCODE > ZERO                                      38460012
384700             MOVE '7385-COUNT-SMOOTHED-CTNS'                      38470029
384800                               TO DP013-PARAGRAPH                 38480012
384900             MOVE 'COUNT SMOOTHED CARTONS FOR PO/RCVR/STR'        38490012
385000                               TO DP013-MESSAGE-TEXT (1)          38500012
385100             MOVE SQLCA        TO DP013-SQLCA                     38510012
385200             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        38520034
385300             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        38530034
385400             SET DP013-DB2-ABEND                                  38540012
385500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38550012
385600             PERFORM DP013-0000-PROCESS-ABEND                     38560012
385700     END-EVALUATE.                                                38570012
385800                                                                  38580012
385900*----------------------------------------------------------------*38590029
386000*    LINK TO AUDIT MODULE * RCKCS290                             *38600029
386100*----------------------------------------------------------------*38610029
386200                                                                  38620029
386300 5400-LINK-AUDIT-MODULE.                                          38630029
386400                                                                  38640029
386500     EXEC SQL                                                     38650029
386600          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            38660029
386700     END-EXEC.                                                    38670029
386800                                                                  38680029
386900     MOVE 'D'                     TO RC031-TABLE-TO-AUDIT.        38690029
387000     MOVE 'B'                     TO RC031-AUD-TYP-CDE.           38700029
387100     MOVE 'U'                     TO RC031-AUD-FUNC-CDE.          38710029
387200     MOVE ASC-KEY-OPER-UNT-ID     TO RC031-OPER-UNT-ID.           38720029
387300     MOVE ASC-KEY-FCLTY-ID        TO RC031-FCLTY-ID.              38730029
387400     MOVE DK-PO-NBR               TO RC031-PO-NBR.                38740029
387500     MOVE DK-REC-SEQ-NBR          TO RC031-REC-SEQ-NBR.           38750029
387600     MOVE DK-PKSL-LNE-NBR         TO RC031-PO-LNE-NBR.            38760029
387700     MOVE RECDIS-STR-NBR          TO RC031-STR-NBR.               38770029
387800     MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID.            38780029
387900     MOVE DP020-USERID            TO RC031-UPD-UID.               38790029
388000     MOVE PV-DB2-CURRENT-TMST     TO RC031-UPD-TMST.              38800029
388100                                                                  38810029
388200     EXEC CICS                                                    38820029
388300          LINK PROGRAM  (PC-AUDIT-RTN)                            38830029
388400          COMMAREA (RC031-FIELDS)                                 38840029
388500          LENGTH   (PC-AUDIT-RTN-LENGTH)                          38850029
388600     END-EXEC.                                                    38860029
388700                                                                  38870029
388800     EVALUATE TRUE                                                38880029
388900         WHEN RC031-CALL-SUCCESSFUL                               38890029
389000             CONTINUE                                             38900029
389100         WHEN OTHER                                               38910029
389200             MOVE '5400-LINK-AUDIT-MODULE'                        38920029
389300                                 TO DP013-PARAGRAPH               38930029
389400             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                38940029
389500                                 TO DP013-MESSAGE-TEXT (1)        38950029
389600             MOVE RC031-RETURN-DESC                               38960029
389700                                 TO DP013-MESSAGE-TEXT (2)        38970029
389800             MOVE RC031-SQLCA    TO DP013-SQLCA                   38980029
389900             SET DP013-DB2-ABEND                                  38990029
390000                 DP013-XCTL-DISPLAY-RESTART                       39000029
390100                                 TO TRUE                          39010029
390200             PERFORM DP013-0000-PROCESS-ABEND                     39020029
390300     END-EVALUATE.                                                39030029
390400                                                                  39040029
390500/                                                                 39050029
390600 5500-UPDATE-RECDIS.                                              39060029
390700                                                                  39070029
390800     EXEC SQL                                                     39080029
390900       UPDATE TRECDIS                                             39090029
391000          SET EXPTED_ITM_QTY     = :RECDIS-EXPTED-ITM-QTY         39100029
391100            , VERIFY_ITM_QTY     = :RECDIS-VERIFY-ITM-QTY         39110029
391200        WHERE ORD_NBR            = :DK-PO-NBR                     39120029
391300          AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR               39130029
391400          AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR                39140029
391500          AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID           39150029
391600          AND FCLTY_ID           = :ASC-KEY-FCLTY-ID              39160029
391700          AND STR_NBR            = :RECDIS-STR-NBR                39170029
391800          AND STR_FCLTY_ID       = 1                              39180029
392000     END-EXEC                                                     39200029
392100                                                                  39210029
392200     EVALUATE TRUE                                                39220029
392300         WHEN SQLCODE = ZERO                                      39230029
392400         WHEN SQLCODE = +100                                      39240029
392500              CONTINUE                                            39250029
392610         WHEN SQLCODE = -904                                      39261029
392700         WHEN SQLCODE = -911                                      39270029
392800         WHEN SQLCODE = -913                                      39280029
392900              PERFORM 9900-SOFT-ABORT                             39290029
393000         WHEN SQLWARN0 NOT = SPACES                               39300029
393100         WHEN SQLCODE      NOT = ZERO                             39310029
393200              MOVE '5500-UPDATE-RECDIS'                           39320029
393300                             TO DP013-PARAGRAPH                   39330029
393400              MOVE 'UNSUCCESSFUL UPDATE OF TRECDIS'               39340029
393500                             TO DP013-MESSAGE-TEXT (1)            39350029
393600              MOVE SQLCA         TO DP013-SQLCA                   39360029
393700              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          39370029
393800              SET DP013-DB2-ABEND                                 39380029
393900                  DP013-XCTL-DISPLAY-RESTART                      39390029
394000                             TO TRUE                              39400029
394100              PERFORM DP013-0000-PROCESS-ABEND                    39410029
394200     END-EVALUATE.                                                39420029
394300/                                                                 39430029
394400* JAK 05/2007 - ADD CODE TO CALL SHIPMENT CONTROL MODULE          39440054
394500******************************************************************39450054
394600*  THIS PARAGRAPH CHECKS TO SEE IF THE DC IS DOWNLOADING TO WMS   39460056
394700******************************************************************39470054
394800 5600-CHECK-ASNDWN.                                               39480054
394900                                                                  39490054
395000     MOVE RECEIV-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.               39500061
395100                                                                  39510054
395200     EXEC SQL                                                     39520054
395300          SELECT   FUNC_TXT                                       39530054
395400            INTO  :KRPRPM-FUNC-TXT                                39540054
395500            FROM                                                  39550054
395600                  TKRPRPM                                         39560054
395700            WHERE                                                 39570054
395800                  LOC_ID            = :KRPRPM-LOC-ID              39580054
395900              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    39590054
396000              AND FUNC_PRC_STAT_CDE = 'AC'                        39600054
396100              AND INTFC_SYS_CDE     = 'KHL'                       39610054
396200              AND FUNC_TXT          = 'Y'                         39620054
396300              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            39630054
396400     END-EXEC.                                                    39640054
396500                                                                  39650054
396600     EVALUATE TRUE                                                39660054
396700         WHEN SQLCODE = ZERO                                      39670054
396800              SET PS-ASNS-TO-WMS-YES    TO TRUE                   39680054
396900         WHEN SQLCODE = +100                                      39690054
397000              SET PS-ASNS-TO-WMS-NO     TO TRUE                   39700054
397100         WHEN SQLCODE = -904                                      39710054
397200         WHEN SQLCODE = -911                                      39720054
397300         WHEN SQLCODE = -913                                      39730054
397400             PERFORM 9900-SOFT-ABORT                              39740054
397500         WHEN SQLWARN0 NOT = SPACES                               39750054
397600         WHEN SQLCODE  NOT = ZERO                                 39760054
397700             SET PS-ERROR             TO TRUE                     39770054
397800             MOVE '5600-CHECK-ASNDWN' TO DP013-PARAGRAPH          39780054
397900             MOVE 'UNSUCCESSFUL CHECK OF TKRPRPM'                 39790054
398000                            TO DP013-MESSAGE-TEXT (1)             39800054
398100             MOVE SQLCA     TO DP013-SQLCA                        39810054
398200             MOVE 'TKRPRPM' TO DP013-DB2-TABLE-NAME (1)           39820054
398300             SET DP013-DB2-ABEND                                  39830054
398400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39840054
398500             PERFORM DP013-0000-PROCESS-ABEND                     39850054
398600     END-EVALUATE.                                                39860055
398700                                                                  39870054
398800****************************************************************  39880056
398900*  THIS PARAGRAPH GETS THE CURRENT OPER ID FOR THE PO/RCVR        39890056
399000****************************************************************  39900056
399100 5610-SELECT-TRECEIV.                                             39910056
399200                                                                  39920056
399300     MOVE ASC-KEY-PO-NBR-N       TO RECEIV-ORD-NBR.               39930056
399400     MOVE ASC-KEY-REC-SEQ-NBR-N  TO RECEIV-REC-SEQ-NBR.           39940056
399500                                                                  39950056
399600     EXEC SQL                                                     39960056
399700          SELECT   CURR_OPER_UNT_ID                               39970061
399800            INTO  :RECEIV-CURR-OPER-UNT-ID                        39980061
399900            FROM                                                  39990056
400000                  TRECEIV                                         40000056
400100            WHERE                                                 40010056
400200                  ORD_NBR           = :RECEIV-ORD-NBR             40020056
400300              AND REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         40030056
400400              AND VER_STATUS_CDE    = 'A'                         40040056
400500     END-EXEC.                                                    40050056
400600                                                                  40060056
400700     EVALUATE TRUE                                                40070056
400800         WHEN SQLCODE = ZERO                                      40080056
400900         WHEN SQLCODE = -811                                      40090058
401000              CONTINUE                                            40100058
401100         WHEN SQLCODE = +100                                      40110058
401200              MOVE ZERO             TO RECEIV-CURR-OPER-UNT-ID    40120061
401300         WHEN SQLWARN0 NOT = SPACES                               40130058
401400         WHEN SQLCODE  NOT = ZERO                                 40140058
401500             MOVE '5610-SELECT-TRECEIV'                           40150058
401600                                  TO DP013-PARAGRAPH              40160058
401700             MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'                40170058
401800                                  TO DP013-MESSAGE-TEXT (1)       40180058
401900             MOVE SQLCA      TO DP013-SQLCA                       40190058
402000             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          40200058
402100             SET DP013-DB2-ABEND                                  40210058
402200                 DP013-XCTL-DISPLAY-RESTART                       40220058
402300                                  TO TRUE                         40230058
402400             PERFORM DP013-0000-PROCESS-ABEND                     40240058
402500     END-EVALUATE.                                                40250058
402600                                                                  40260058
402700******************************************************************40270058
402800*  THIS PARAGRAPH CHECKS TO SEE IF THE TRECDIS ROWS EXIST.        40280058
402900******************************************************************40290058
403000 5620-CHECK-TRECDIS.                                              40300058
403100                                                                  40310058
403200     MOVE 0                     TO PV-SQL-CNT.                    40320058
403300     MOVE ASC-KEY-PO-NBR-N      TO RECDIS-ORD-NBR.                40330058
403400     MOVE ASC-KEY-PKSL-LNE-NBR  TO RECDIS-ORD-LNE-NBR.            40340058
403500     MOVE ASC-KEY-REC-SEQ-NBR-N TO RECDIS-REC-SEQ-NBR.            40350058
403600     MOVE ASC-KEY-OPER-UNT-ID   TO RECDIS-OPER-UNT-ID.            40360058
403700     MOVE ASC-KEY-FCLTY-ID      TO RECDIS-FCLTY-ID.               40370058
403800                                                                  40380058
403900     EXEC SQL                                                     40390058
404000         SELECT COUNT(*)                                          40400058
404100           INTO :PV-SQL-CNT                                       40410058
404200           FROM TRECDIS                                           40420058
404300          WHERE ORD_NBR        = :RECDIS-ORD-NBR                  40430058
404400            AND ORD_LNE_NBR    = :RECDIS-ORD-LNE-NBR              40440058
404500            AND REC_SEQ_NBR    = :RECDIS-REC-SEQ-NBR              40450058
404600            AND OPER_UNT_ID    = :RECDIS-OPER-UNT-ID              40460058
404700            AND FCLTY_ID       = :RECDIS-FCLTY-ID                 40470058
404900     END-EXEC.                                                    40490058
405000                                                                  40500058
405100     EVALUATE TRUE                                                40510058
405200         WHEN SQLCODE = ZERO                                      40520058
405300             IF PV-SQL-CNT = 0                                    40530058
405400                 SET PS-DISTRO-TRBL-YES TO TRUE                   40540058
405500             ELSE                                                 40550058
405600                 SET PS-DISTRO-TRBL-NO  TO TRUE                   40560058
405700             END-IF                                               40570058
405710                                                                  40571069
405810         WHEN SQLCODE = +100                                      40581058
405900                 SET PS-DISTRO-TRBL-YES TO TRUE                   40590058
406000                                                                  40600058
406100         WHEN SQLCODE = -904                                      40610058
406200         WHEN SQLCODE = -911                                      40620058
406300         WHEN SQLCODE = -913                                      40630058
406400             PERFORM 9900-SOFT-ABORT                              40640058
406500         WHEN SQLWARN0 NOT = SPACES                               40650058
406600         WHEN SQLCODE  NOT = ZERO                                 40660058
406700             SET PS-ERROR             TO TRUE                     40670058
406800             MOVE '5620-CHECK-TRECDIS' TO DP013-PARAGRAPH         40680058
406900             MOVE 'UNSUCCESSFUL CHECK OF TRECDIS'                 40690058
407000                            TO DP013-MESSAGE-TEXT (1)             40700058
407100             MOVE SQLCA     TO DP013-SQLCA                        40710058
407200             MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)           40720058
407300             SET DP013-DB2-ABEND                                  40730058
407400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40740058
407500             PERFORM DP013-0000-PROCESS-ABEND                     40750058
407600     END-EVALUATE.                                                40760058
407700                                                                  40770058
407800******************************************************************40780058
407900*  THIS PARAGRAPH GETS THE TRIP-ID FROM THE PO/RCVR.              40790058
408000******************************************************************40800058
408100 5630-GET-TRIP-ID.                                                40810058
408200                                                                  40820058
408300     MOVE ASC-KEY-PO-NBR-N      TO SHPTPO-PO-NBR.                 40830058
408400     MOVE ASC-KEY-REC-SEQ-NBR-N TO SHPTPO-REC-SEQ-NBR.            40840058
408500                                                                  40850058
408600     EXEC SQL                                                     40860058
408700         SELECT A.TRIP_ID                                         40870058
408800           INTO :SHIPMT-TRIP-ID                                   40880058
408900           FROM TSHIPMT   A                                       40890058
409000              , TSHPTPO   B                                       40900058
409100          WHERE B.PO_NBR         = :SHPTPO-PO-NBR                 40910058
409200            AND B.REC_SEQ_NBR    = :SHPTPO-REC-SEQ-NBR            40920058
409300            AND A.SHIPT_ID       = B.SHIPT_ID                     40930058
409400            AND B.PRIM_SHIPT_IND = 'Y'                            40940062
409500     END-EXEC.                                                    40950062
409600                                                                  40960062
409700     EVALUATE TRUE                                                40970062
409800         WHEN SQLCODE = ZERO                                      40980062
409900             CONTINUE                                             40990062
410000         WHEN SQLCODE = -904                                      41000062
410100         WHEN SQLCODE = -911                                      41010062
410200         WHEN SQLCODE = -913                                      41020062
410300             PERFORM 9900-SOFT-ABORT                              41030062
410400         WHEN SQLWARN0 NOT = SPACES                               41040062
410500         WHEN SQLCODE  NOT = ZERO                                 41050062
410600             SET PS-ERROR             TO TRUE                     41060062
410700             MOVE '5630-GET-TRIP-ID' TO DP013-PARAGRAPH           41070062
410800             MOVE 'UNSUCCESSFUL SELECT OF TRIP-ID'                41080062
410900                            TO DP013-MESSAGE-TEXT (1)             41090062
411000             MOVE SQLCA     TO DP013-SQLCA                        41100062
411100             MOVE 'TSHIPMT' TO DP013-DB2-TABLE-NAME (1)           41110062
411200             MOVE 'TSHPTPO' TO DP013-DB2-TABLE-NAME (2)           41120062
411300             SET DP013-DB2-ABEND                                  41130062
411400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41140062
411500             PERFORM DP013-0000-PROCESS-ABEND                     41150062
411600     END-EVALUATE.                                                41160062
411700                                                                  41170062
411800*----------------------------------------------------------------*41180062
411900* LINK TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     41190062
412000*  COPYBOOK WSWS001.                                              41200062
412100*----------------------------------------------------------------*41210062
412200 5640-CALL-WMS-MODULE.                                            41220062
412300                                                                  41230062
412400     SET WS001-INSERT               TO TRUE.                      41240062
412500     MOVE SHIPMT-TRIP-ID            TO WS001-TRIP-ID.             41250062
412600     MOVE ASC-KEY-OPER-UNT-ID       TO WS001-OPER-UNT-ID.         41260062
412700     MOVE DP020-USERID              TO WS001-USER-ID.             41270062
412800     MOVE ASC-KEY-PO-NBR-N          TO WS001-PO-NBR.              41280062
412900     MOVE ASC-KEY-PKSL-LNE-NBR      TO WS001-PO-LNE-NBR.          41290062
413000     MOVE ASC-KEY-REC-SEQ-NBR-N     TO WS001-RCVR-NBR.            41300062
413100     MOVE ASC-KEY-PKSL-NBR          TO WS001-PREPK-ID.            41310062
413200     MOVE ZEROS                     TO WS001-SKU-NBR.             41320062
413300     MOVE ZEROS                     TO WS001-KOHLS-SHIPT-ID.      41330062
413400     MOVE 'RC'                      TO WS001-SHIPMENT-SOURCE.     41340062
413500     MOVE SPACES                    TO WS001-DTL-ASN-LEVEL-IND.   41350062
413600     MOVE DP020-SRC-TASK-NUMBER     TO WS001-SRC-TASK-NUMBER.     41360062
413700     MOVE PC-CURRENT-PROGRAM-NAME   TO WS001-CALLING-PROGRAM-NAME.41370062
413800                                                                  41380062
413900     MOVE LENGTH OF WS001-FIELDS    TO PV-COMMAREA-LENGTH.        41390062
414000                                                                  41400062
414100     EXEC CICS                                                    41410062
414200         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       41420062
414300              COMMAREA (WS001-FIELDS)                             41430062
414400              LENGTH   (PV-COMMAREA-LENGTH)                       41440062
414500     END-EXEC.                                                    41450062
414600                                                                  41460062
414700     EVALUATE TRUE                                                41470062
414800         WHEN WS001-SUCCESSFUL                                    41480062
414900              CONTINUE                                            41490062
415000                                                                  41500062
415100         WHEN OTHER                                               41510062
415200             SET PS-ERROR             TO TRUE                     41520062
415300             SET DP013-CICS-ABEND                                 41530062
415400                 DP013-NO-ROLLBACK TO TRUE                        41540062
415500             MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH     41550062
415600             MOVE 'UNSUCCESSFUL CALL TO SHIPPING CONTROL MODULE'  41560062
415700                  TO DP013-MESSAGE-TEXT (1)                       41570062
415800             PERFORM DP013-0000-PROCESS-ABEND                     41580062
415900                                                                  41590062
416000     END-EVALUATE.                                                41600062
416100                                                                  41610062
416200* JAK 05/2007 - END                                               41620062
416300                                                                  41630062
416400 6000-REFRESH-PANEL-FROM-TEMP.                                    41640062
416500                                                                  41650062
416600     IF ASC-UPDATE-TSQ                                            41660029
416700         SET ASC-NO-TSQ-UPDATE   TO TRUE                          41670029
416800         MOVE ZERO               TO PV-SAVE-ITEM                  41680029
416900                                    PV-SEL-QUEUE-ITEM             41690029
417000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        41700029
417100                                 TO PV-HOLD-SELECTED-ITEMS        41710029
417200         PERFORM 6100-UPDATE-TSQ                                  41720029
417300           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS41730029
417400                                                                  41740029
417500         PERFORM 6010-DELETE-SEL-QUEUE                            41750029
417600                                                                  41760029
417700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         41770029
417800                    ASC-BLOCK-ENTRIES (2)                         41780029
417900                                                                  41790029
418000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 41800029
418100                GIVING    PV-BLOCK-NUMBER                         41810029
418200                REMAINDER PV-REMAINDER                            41820029
418300                                                                  41830029
418400         IF PV-REMAINDER > ZERO                                   41840029
418500             ADD +1              TO PV-BLOCK-NUMBER               41850029
418600         END-IF                                                   41860029
418700                                                                  41870029
418800         MOVE +1                 TO ASC-BLK-SUB                   41880029
418900                                                                  41890029
419000         PERFORM 4410-READ-TEMP-STORAGE                           41900029
419100                                                                  41910029
419200         ADD +1                  TO ASC-BLK-SUB                   41920029
419300                            PV-BLOCK-NUMBER                       41930029
419400         PERFORM 4410-READ-TEMP-STORAGE                           41940029
419500                                                                  41950029
419600     END-IF.                                                      41960029
419700                                                                  41970029
419800 6010-DELETE-SEL-QUEUE.                                           41980029
419900                                                                  41990029
420000     EXEC CICS DELETEQ TS                                         42000029
420100               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42010029
420200               RESP  (PV-CICS-RESP)                               42020029
420300     END-EXEC.                                                    42030029
420400                                                                  42040029
420500     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     42050029
420600         (PV-CICS-RESP = DFHRESP (QIDERR)))                       42060029
420700         CONTINUE                                                 42070029
420800     ELSE                                                         42080029
420900         SET DP013-CICS-ABEND                                     42090029
421000             DP013-NO-ROLLBACK   TO TRUE                          42100029
421100         MOVE '6010-DELETE-SEL-QUEUE'                             42110029
421200                                 TO DP013-PARAGRAPH               42120029
421300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  42130029
421400                                 TO DP013-MESSAGE-TEXT (1)        42140029
421500         PERFORM DP013-0000-PROCESS-ABEND                         42150029
421600     END-IF.                                                      42160029
421700                                                                  42170029
421800 6100-UPDATE-TSQ.                                                 42180029
421900                                                                  42190029
422000     ADD 1                       TO PV-SEL-QUEUE-ITEM.            42200029
422100                                                                  42210029
422200     PERFORM 6105-READ-SEL-QUEUE.                                 42220029
422300                                                                  42230029
422400     PERFORM                                                      42240029
422500     VARYING RC013-IDX  FROM 1 BY 1                               42250029
422600     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       42260029
422700             RC013-IDX > RC013-MAX-ITEMS                          42270029
422800                                                                  42280029
422900         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   42290029
423000            PERFORM 6110-PROCESS-ITEMS                            42300029
423100            SET PS-WRITE-LIST-QUEUE                               42310029
423200                                 TO TRUE                          42320029
423300         END-IF                                                   42330029
423400                                                                  42340029
423500         ADD +1                  TO PV-ITEMS-PROCESSED            42350029
423600     END-PERFORM.                                                 42360029
423700                                                                  42370029
423800     IF PS-WRITE-LIST-QUEUE                                       42380029
423900         PERFORM 6111-WRITE-LIST-QUEUE                            42390029
424000     END-IF.                                                      42400029
424100                                                                  42410029
424200                                                                  42420029
424300 6105-READ-SEL-QUEUE.                                             42430029
424400                                                                  42440029
424500     EXEC CICS READQ TS                                           42450029
424600               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42460029
424700               INTO  (RC013-DC-SELECT-RECORD)                     42470029
424800               ITEM  (PV-SEL-QUEUE-ITEM)                          42480029
424900               RESP  (PV-CICS-RESP)                               42490029
425000     END-EXEC.                                                    42500029
425100                                                                  42510029
425200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       42520029
425300         SET DP013-CICS-ABEND                                     42530029
425400             DP013-NO-ROLLBACK   TO TRUE                          42540029
425500         MOVE '6105-READ-SEL-QUEUE'                               42550029
425600                                 TO DP013-PARAGRAPH               42560029
425700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    42570029
425800                                 TO DP013-MESSAGE-TEXT (1)        42580029
425900         PERFORM DP013-0000-PROCESS-ABEND                         42590029
426000     END-IF.                                                      42600029
426100                                                                  42610029
426200 6110-PROCESS-ITEMS.                                              42620029
426300                                                                  42630029
426400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          42640029
426500                                            / PC-ITEMS-PER-PANEL).42650029
426600                                                                  42660029
426700     IF PV-ITEM NOT = PV-SAVE-ITEM                                42670029
426800        IF PV-SAVE-ITEM NOT = ZERO                                42680029
426900                                                                  42690029
427000            PERFORM 6111-WRITE-LIST-QUEUE                         42700029
427100                                                                  42710029
427200        END-IF                                                    42720029
427300        MOVE PV-ITEM             TO PV-SAVE-ITEM                  42730029
427400                                                                  42740029
427500        PERFORM 6112-READ-LIST-QUEUE                              42750029
427600                                                                  42760029
427700     END-IF.                                                      42770029
427800                                                                  42780029
427900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   42790029
428000                                    LQW-LIST-ITEM-NUMBER (1)) + 1.42800029
428100     SET LQW-DESELECT (PV-SUB)   TO TRUE                          42810029
428200     MOVE LQW-SELECTED-SW (PV-SUB)                                42820029
428300                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).42830029
428400                                                                  42840029
428500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                42850029
428600                                                                  42860029
428700 6111-WRITE-LIST-QUEUE.                                           42870029
428800                                                                  42880029
428900     EXEC CICS WRITEQ TS                                          42890029
429000               QUEUE (ASC-LIST-QUEUE-NAME)                        42900029
429100               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   42910029
429200               ITEM  (PV-SAVE-ITEM)                               42920029
429300               REWRITE                                            42930029
429400               RESP  (PV-CICS-RESP)                               42940029
429500     END-EXEC.                                                    42950029
429600                                                                  42960029
429700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       42970029
429800         SET DP013-CICS-ABEND                                     42980029
429900             DP013-NO-ROLLBACK   TO TRUE                          42990029
430000         MOVE '6111-WRITE-LIST-QUEUE'                             43000029
430100                                 TO DP013-PARAGRAPH               43010029
430200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'43020029
430300                                 TO DP013-MESSAGE-TEXT(1)         43030029
430400         PERFORM DP013-0000-PROCESS-ABEND                         43040029
430500     END-IF.                                                      43050029
430600                                                                  43060029
430700 6112-READ-LIST-QUEUE.                                            43070029
430800                                                                  43080029
430900     EXEC CICS READQ TS                                           43090029
431000               QUEUE (ASC-LIST-QUEUE-NAME)                        43100029
431100               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   43110029
431200               ITEM  (PV-ITEM)                                    43120029
431300               RESP  (PV-CICS-RESP)                               43130029
431400     END-EXEC.                                                    43140029
431500                                                                  43150029
431600     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43160029
431700         SET DP013-CICS-ABEND                                     43170029
431800             DP013-NO-ROLLBACK   TO TRUE                          43180029
431900         MOVE '6112-READ-LIST-QUEUE'                              43190029
432000                                 TO DP013-PARAGRAPH               43200029
432100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   43210029
432200                                 TO DP013-MESSAGE-TEXT(1)         43220029
432300         PERFORM DP013-0000-PROCESS-ABEND                         43230029
432400     END-IF.                                                      43240029
432500                                                                  43250029
432600******************************************************************43260029
432700* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *43270029
432800******************************************************************43280029
432900 6200-DEL-LIST-QUEUE.                                             43290029
433000                                                                  43300029
433100     EXEC CICS                                                    43310029
433200         DELETEQ TS                                               43320029
433300             QUEUE (ASC-LIST-QUEUE-NAME)                          43330029
433400             RESP  (PV-CICS-RESP)                                 43340029
433500     END-EXEC.                                                    43350029
433600                                                                  43360029
433700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      43370029
433800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         43380029
433900         CONTINUE                                                 43390029
434000     ELSE                                                         43400029
434100        SET DP013-CICS-ABEND     TO TRUE                          43410029
434200        SET DP013-NO-ROLLBACK    TO TRUE                          43420029
434300        MOVE '6200-DEL-LIST-QUEUE'                                43430029
434400                                 TO DP013-PARAGRAPH               43440029
434500        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               43450029
434600                                 TO DP013-MESSAGE-TEXT (1)        43460029
434700        PERFORM DP013-0000-PROCESS-ABEND                          43470029
434800     END-IF.                                                      43480029
434900/                                                                 43490029
435000******************************************************************43500029
435100* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *43510029
435200* OBJECT WAS UPDATED.                                            *43520029
435300******************************************************************43530029
435400 9000-UPDATE-SELECTION-QUEUE.                                     43540029
435500                                                                  43550029
435600     IF ASC-INTER-APPL-WO-LIST OR                                 43560029
435700        ASC-INTER-APPL-ITM-LST OR                                 43570029
435800        ASC-INTER-APPL-ITM-ADD-LST                                43580029
435900         PERFORM 9300-READ-WO-SEL-QUEUE                           43590029
436000     ELSE                                                         43600029
436100         PERFORM 9100-READ-SEL-QUEUE                              43610029
436200     END-IF.                                                      43620029
436300                                                                  43630029
436400     IF ASC-INTER-APPL-WO-LIST OR                                 43640029
436500        ASC-INTER-APPL-ITM-LST OR                                 43650029
436600        ASC-INTER-APPL-ITM-ADD-LST                                43660029
436700         SET PC016-UPD (ASC-SEL-SUB) TO TRUE                      43670029
436800         PERFORM 9400-REWRITE-WO-LIST-QUEUE                       43680029
436900     ELSE                                                         43690029
437000         SET RC013-UPD (ASC-SEL-SUB) TO TRUE                      43700029
437100         PERFORM 9200-REWRITE-LIST-QUEUE                          43710029
437200     END-IF.                                                      43720029
437300                                                                  43730029
437400/                                                                 43740029
437500******************************************************************43750029
437600* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *43760029
437700******************************************************************43770029
437800 9100-READ-SEL-QUEUE.                                             43780029
437900                                                                  43790029
438000     EXEC CICS                                                    43800029
438100         READQ TS                                                 43810029
438200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        43820029
438300             INTO  (RC013-DC-SELECT-RECORD)                       43830029
438400             ITEM  (ASC-SEL-ITEM)                                 43840029
438500             RESP  (PV-CICS-RESP)                                 43850029
438600     END-EXEC.                                                    43860029
438700                                                                  43870029
438800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        43880029
438900         CONTINUE                                                 43890029
439000     ELSE                                                         43900029
439100         SET DP013-LOGIC-ABEND                                    43910029
439200             DP013-NO-ROLLBACK   TO TRUE                          43920029
439300         MOVE '9100-READ-SEL-QUEUE'                               43930029
439400                                 TO DP013-PARAGRAPH               43940029
439500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    43950029
439600                                 TO DP013-MESSAGE-TEXT (1)        43960029
439700         PERFORM DP013-0000-PROCESS-ABEND                         43970029
439800     END-IF.                                                      43980029
439900                                                                  43990029
440000/                                                                 44000029
440100******************************************************************44010029
440200* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *44020029
440300******************************************************************44030029
440400 9200-REWRITE-LIST-QUEUE.                                         44040029
440500     EXEC CICS                                                    44050029
440600          WRITEQ TS                                               44060029
440700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     44070029
440800              FROM    (RC013-DC-SELECT-RECORD)                    44080029
440900              ITEM    (ASC-SEL-ITEM)                              44090029
441000              RESP    (PV-CICS-RESP)                              44100029
441100              REWRITE                                             44110029
441200     END-EXEC.                                                    44120029
441300                                                                  44130029
441400     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    44140029
441500         SET DP013-CICS-ABEND                                     44150029
441600             DP013-NO-ROLLBACK   TO TRUE                          44160029
441700         MOVE '9200-REWRITE-LIST-QUEUE'                           44170029
441800                                 TO DP013-PARAGRAPH               44180029
441900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   44190029
442000                                 TO DP013-MESSAGE-TEXT (1)        44200029
442100         PERFORM DP013-0000-PROCESS-ABEND                         44210029
442200     END-IF.                                                      44220029
442300/                                                                 44230029
442400******************************************************************44240029
442500* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *44250029
442600* TEMP STORAGE QUEUE.                                            *44260029
442700******************************************************************44270029
442800 9300-READ-WO-SEL-QUEUE.                                          44280029
442900                                                                  44290029
443000     EXEC CICS                                                    44300029
443100         READQ TS                                                 44310029
443200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        44320029
443300             INTO  (PC016-TS-SEL-REC)                             44330029
443400             ITEM  (ASC-SEL-ITEM)                                 44340029
443500             RESP  (PV-CICS-RESP)                                 44350029
443600     END-EXEC.                                                    44360029
443700                                                                  44370029
443800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        44380029
443900         CONTINUE                                                 44390029
444000     ELSE                                                         44400029
444100         SET DP013-LOGIC-ABEND                                    44410029
444200             DP013-NO-ROLLBACK   TO TRUE                          44420029
444300         MOVE '9300-READ-WO-SEL-QUEUE'                            44430029
444400                                 TO DP013-PARAGRAPH               44440029
444500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    44450029
444600                                 TO DP013-MESSAGE-TEXT (1)        44460029
444700         MOVE ASC-SEL-QUEUE-NAME-IN TO MSG-QUEUE-NAME             44470029
444800         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  44480029
444900         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        44490029
445000         MOVE PC000-PO-NBR-N     TO MSG1-PO-NBR                   44500029
445100         MOVE PC000-REC-SEQ-NBR-N                                 44510029
445200                                 TO MSG1-REC-SEQ-NBR-N            44520029
445300         MOVE PC000-OPERATING-UNIT-ID                             44530029
445400                                 TO MSG1-OPER-UNT-ID              44540029
445500         MOVE PC000-FACILITY-ID  TO MSG1-FACILITY-ID              44550029
445600         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        44560029
445700         PERFORM DP013-0000-PROCESS-ABEND                         44570029
445800     END-IF.                                                      44580029
445900                                                                  44590029
446000/                                                                 44600029
446100******************************************************************44610029
446200* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *44620029
446300* TEMP STORAGE QUEUE.                                            *44630029
446400******************************************************************44640029
446500 9400-REWRITE-WO-LIST-QUEUE.                                      44650029
446600     EXEC CICS                                                    44660029
446700          WRITEQ TS                                               44670029
446800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     44680029
446900              FROM    (PC016-TS-SEL-REC)                          44690029
447000              ITEM    (ASC-SEL-ITEM)                              44700029
447100              RESP    (PV-CICS-RESP)                              44710029
447200              REWRITE                                             44720029
447300     END-EXEC.                                                    44730029
447400                                                                  44740029
447500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    44750029
447600         SET DP013-CICS-ABEND                                     44760029
447700             DP013-NO-ROLLBACK   TO TRUE                          44770029
447800         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        44780029
447900                                 TO DP013-PARAGRAPH               44790029
448000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   44800029
448100                                 TO DP013-MESSAGE-TEXT (1)        44810029
448200         PERFORM DP013-0000-PROCESS-ABEND                         44820029
448300     END-IF.                                                      44830029
448400/                                                                 44840029
448500******************************************************************44850029
448600*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *44860029
448700*    AND THE ERROR SWITCHES.                                     *44870029
448800******************************************************************44880029
448900 9900-SOFT-ABORT.                                                 44890029
449000     SET PS-ERROR         TO TRUE.                                44900029
449100     SET DP020-MSG-FATAL  TO TRUE.                                44910029
449200     MOVE 'THROUGH SOFT-ABORT PARA'                               44920029
449300                      TO DP013-MESSAGE-TEXT (1)                   44930029
449400     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    44940029
449500     IF PS-NO-NEXT-SCREEN                                         44950029
449600        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     44960029
449700     END-IF.                                                      44970029
449800     PERFORM 9901-BACKUP.                                         44980029
449900     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          44990029
450000     PERFORM 0001-CALL-CICS-ARCH-API.                             45000029
450100                                                                  45010029
450200 9901-BACKUP.                                                     45020029
450300     EXEC CICS SYNCPOINT                                          45030029
450400          ROLLBACK                                                45040029
450500     END-EXEC.                                                    45050029
450600                                                                  45060029
450700*9999-SOFT-ABORT.                                                 45070029
450800*    SET PS-ERROR                                                 45080029
450900*        DP013-LINK-RETURN                                        45090029
451000*        DP013-ROLLBACK                                           45100029
451100*        DP020-NEXT-ACT-APPL-ERROR                                45110029
451200*        DP020-MSG-FATAL         TO TRUE.                         45120029
451300**                                                                45130029
451400*    MOVE PC-TSYMSG-00551        TO DP020-MSG-NUMBER.             45140029
451500*    PERFORM DP013-0000-PROCESS-ABEND.                            45150029
451600/                                                                 45160029
451700******************************************************************45170029
451800*    ABEND PROCESSING                                             45180029
451900******************************************************************45190029
452000     COPY DPPD013.                                                45200038
