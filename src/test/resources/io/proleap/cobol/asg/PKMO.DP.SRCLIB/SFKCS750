       IDENTIFICATION DIVISION.                                         00010002
       PROGRAM-ID.       SFKCS750.                                      00020023
       AUTHOR.           KOHLS DEPARTMENT STORES.                       00030002
       INSTALLATION.     KOHLS DEPARTMENT STORES.                       00040002
       DATE-WRITTEN      06/28/2004.                                    00050002
       DATE-COMPILED.                                                   00060002
      ******************************************************************00070002
      **T750 - FREIGHT PROCESSING - SCANNING A UPC                      00080017
      **THIS PROGRAM RECEIVES A REQUEST FROM AN RF DEVICE CONTAINING:   00090002
      **   - STORE                                                      00100002
      **   - UPC                                                        00110002
      ******************************************************************00120002
      **DATE: 06/28/2004 CHANGED BY: JULIE TEWES INITIAL PROGRAM WRITE  00130002
      ******************************************************************00140002
      **DATE: 08/26/2004 CHANGED BY: JULIE TEWES CHANGE ERROR MESSAGES  00150050
      ******************************************************************00160050
      **DATE: 09/16/2004 CHANGED BY: DAVE WELLER RETURN ITEM COLOR      00161051
      ******************************************************************00162051
061107**DATE: 06/11/2007 CHANGED BY: DAVE WELLER WR31875                00163051
      ******************************************************************00164051
TEMP  ******************************************************************00165054
TEMP  **DATE:02/27/20013 ADDED THE TEMPORARY IF CONDITION IN COPYBOOK   00166054
TEMP  **SFPD001 TO PULL THE PLANOGRAM INFORMATION FOR STORE 781.        00166154
TEMP  * NO CHANGE IN THIS PROGRAM BUT MOVING TO PRODUCTION ALONG WITH   00167054
TEMP  * COPYBOOK TO REFRESH THE PRODCUTION LOAD MODULE.                 00167154
TEMP  *                  CHANGED BY:SARVESWARAN N.S.K. CRQ000000041229  00168054
TEMP  ******************************************************************00169054
      **DATE:02/14/2023  CHANGE VARIABLE USED TO CALL UPC CHECK DIGIT   00169156
      **                 COMMENTED OUT ALL REFERENCES TO POG CALLS      00169257
      **                 JEAN KURK                   CHG0281369         00169357
      ******************************************************************00169655
       ENVIRONMENT DIVISION.                                            00170002
       DATA DIVISION.                                                   00180002
       WORKING-STORAGE SECTION.                                         00190002
      ******************************************************************00200002
      **PROGRAM SWITCHES                                                00210021
      ******************************************************************00220002
      *01  PS-PROGRAM-SWITCHES.                                         00230059
      *    05  PS-END-OF-POG-CSR-SW        PIC X(01)   VALUE 'N'.       00240059
      *        88  PS-END-OF-POG-CSR                   VALUE 'Y'.       00250059
      *        88  PS-NOT-END-OF-POG-CSR               VALUE 'N'.       00260059
      ******************************************************************00270021
      **PROGRAM COUNTERS                                                00280021
      ******************************************************************00290021
       01  PC-PROGRAM-COUNTERS.                                         00300021
           05  PC-FETCH-COUNTER            PIC 9(08)   VALUE ZEROS.     00310021
      ******************************************************************00320031
      **PROGRAM INDICES                                                 00330031
      ******************************************************************00340031
       01  PI-PROGRAM-INDICES.                                          00350031
           05  PI-FIXTURE-INDEX            PIC 9(03)   VALUE ZEROS.     00360031
      ******************************************************************00370021
      **PROGRAM VARIABLES                                               00380021
      ******************************************************************00390021
       01  PV-PROGRAM-VARIABLES.                                        00400002
           05  PV-COMMAREA-LENGTH          PIC S9(04)  VALUE +0         00410002
                                                       COMP SYNC.       00420002
      ******************************************************************00430002
      **DATE VARIABLES                                                  00440002
      ******************************************************************00450002
       01  DV-DATE-VARIABLES.                                           00460002
           05  DV-ACCEPT-DATE.                                          00470002
               10  DV-ACCEPT-YY            PIC 9(02)  VALUE ZEROS.      00480002
               10  DV-ACCEPT-MM            PIC 9(02)  VALUE ZEROS.      00490002
               10  DV-ACCEPT-DD            PIC 9(02)  VALUE ZEROS.      00500002
           05  DV-FORMAT-DATE.                                          00510002
               10  DV-FORMAT-MM            PIC 9(02)  VALUE ZEROS.      00520002
               10  FILLER                  PIC X(01)  VALUE '/'.        00530002
               10  DV-FORMAT-DD            PIC 9(02)  VALUE ZEROS.      00540002
               10  FILLER                  PIC X(01)  VALUE '/'.        00550002
               10  DV-FORMAT-YY            PIC 9(02)  VALUE ZEROS.      00560002
           05  DV-ACCEPT-DATE-FMT.                                      00570002
               10  FILLER                  PIC 9(02)  VALUE 20.         00580002
               10  DV-ACCEPT-FMT-YY        PIC 9(02)  VALUE ZEROS.      00590002
               10  FILLER                  PIC X(01)  VALUE '-'.        00600002
               10  DV-ACCEPT-FMT-MM        PIC 9(02)  VALUE ZEROS.      00610002
               10  FILLER                  PIC X(01)  VALUE '-'.        00620002
               10  DV-ACCEPT-FMT-DD        PIC 9(02)  VALUE ZEROS.      00630002
      ******************************************************************00640002
      **PROGRAM CONSTANTS                                               00650002
      ******************************************************************00660002
       01  PC-PROGRAM-CONSTANTS.                                        00670002
           05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'SFKCS750'. 00680023
           05  PC-ERROR-CODE               PIC X(01)  VALUE 'E'.        00700002
      **CICS RETURN MESSAGES                                            00710002
           05  PC-TSYMSG-NUMBERS.                                       00720002
      **INVALID UPC                                                     00730002
               10  PC-TSYMSG-00100         PIC 9(05)  VALUE  00100.     00740002
      **DATA IS UNAVAILABLE; PLEASE CONTACT THE IS HELP DESK            00750002
               10  PC-TSYMSG-01063         PIC 9(05)  VALUE  01063.     00760002
               10  PC-TSYMSG-01064         PIC 9(05)  VALUE  01064.     00770002
           05  PC-DUMMY-UPC-MSG            PIC X(70)                    00780002
               VALUE 'DUMMY UPC.'.                                      00790041
           05  PC-INVALID-STORE-TEXT       PIC X(70)                    00800002
               VALUE 'INVALID STORE NUMBER.'.                           00810002
           05  PC-NO-POG-INFO-FOUND-MSG    PIC X(70)                    00820004
               VALUE 'NO PLANOGRAM INFORMATION FOUND FOR ITEM.'.        00830011
      ******************************************************************00840002
      **TABLE INCLUSIONS                                                00850002
      ******************************************************************00860002
      **SFT_EAS_TG_MDSE TABLE                                           00870019
           EXEC SQL                                                     00880002
                INCLUDE SFT00000                                        00890019
           END-EXEC.                                                    00900002
      **XST_LOC DOMAIN TABLE                                            00910019
           EXEC SQL                                                     00920019
                INCLUDE XST00001                                        00930019
           END-EXEC.                                                    00940019
      **XST_UPC DOMAIN TABLE                                            00950003
           EXEC SQL                                                     00960003
                INCLUDE XST00012                                        00970007
           END-EXEC.                                                    00980003
      **XST_SKU_LOC DOMAIN TABLE                                        00990018
           EXEC SQL                                                     01000018
                INCLUDE XST00008                                        01010018
           END-EXEC.                                                    01020018
      **XST_SKU DOMAIN TABLE                                            01030003
           EXEC SQL                                                     01040003
                INCLUDE XST00010                                        01050007
           END-EXEC.                                                    01060003
      **XST_VND_STYL DOMAIN TABLE                                       01070003
           EXEC SQL                                                     01080003
                INCLUDE XST00013                                        01090007
           END-EXEC.                                                    01100003
      **XST_SUB_CL DOMAIN TABLE                                         01110003
           EXEC SQL                                                     01120003
                INCLUDE XST00014                                        01130007
           END-EXEC.                                                    01140003
      **XST_DEPT DOMAIN TABLE                                           01150003
           EXEC SQL                                                     01160003
                INCLUDE XST00015                                        01170007
           END-EXEC.                                                    01180003
      **XST_BUS_GP DOMAIN TABLE                                         01190003
           EXEC SQL                                                     01200003
                INCLUDE XST00016                                        01210007
           END-EXEC.                                                    01220003
      **XST_BUS_AREA DOMAIN TABLE                                       01230003
           EXEC SQL                                                     01240003
                INCLUDE XST00024                                        01250007
           END-EXEC.                                                    01260003
      **XST_POG DOMAIN TABLE                                            01270005
0223RM*    EXEC SQL                                                     01280057
0223RM*         INCLUDE XST00058                                        01290057
0223RM*    END-EXEC.                                                    01300057
      **XST_POG_LOC_ASSN DOMAIN TABLE                                   01310005
0223RM*    EXEC SQL                                                     01320057
0223RM*         INCLUDE XST00062                                        01330057
0223RM*    END-EXEC.                                                    01340057
      **XST_POG_FIXT_LOC DOMAIN TABLE                                   01350005
0223RM*    EXEC SQL                                                     01360057
0223RM*         INCLUDE XST00059                                        01370057
0223RM*    END-EXEC.                                                    01380057
      **XST_POG_POSN DOMAIN TABLE                                       01390005
0223RM*    EXEC SQL                                                     01400057
0223RM*         INCLUDE XST00060                                        01410057
0223RM*    END-EXEC.                                                    01420057
      **XST_POG_SKU_ASSN DOMAIN TABLE                                   01430005
0223RM*    EXEC SQL                                                     01440057
0223RM*         INCLUDE XST00061                                        01450057
0223RM*    END-EXEC.                                                    01460057
      **COMMUNICATIONS AREA FOR DB2                                     01470005
           EXEC SQL                                                     01480002
                INCLUDE SQLCA                                           01490002
           END-EXEC.                                                    01500002
      ******************************************************************01510002
      **COPYBOOKS                                                       01520002
      ******************************************************************01530002
      **RECORD LAYOUT BEING TRANSMITTED FROM THE CLIENT                 01540002
           COPY SFRD006.                                                01550002
      **RECORD LAYOUT BEING TRASMITTED TO THE CLIENT                    01560002
           COPY SFRD007.                                                01570002
      **WORKING STORAGE TO USE WITH SFPD001                             01580032
0223RM*    COPY SFWS001.                                                01590058
      **COPY BOOK FOR THE CALENDAR ROUTINE                              01600002
           COPY DPWS500.                                                01610002
      **UPC PARAMETER LIST FOR CALLING THE UPC CHECK DIGIT ROUTINE.     01620033
           COPY DPWS040I.                                               01630033
      **RF CICS COPYBOOK - USED IN CONJUCTION WITH RFPD001              01640002
           COPY RFWS007.                                                01650002
      **LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                 01660002
           COPY DPWS013.                                                01670002
                                                                        01680002
       PROCEDURE DIVISION.                                              01690002
      ******************************************************************01700002
       0000-PROGRAM-MAINLINE.                                           01710002
                                                                        01720002
           PERFORM 1000-INITIALIZATION.                                 01730002
           PERFORM 2000-PROCESS-REQUEST.                                01740002
           PERFORM 9000-CALL-CICS.                                      01750002
           GOBACK.                                                      01760002
                                                                        01770002
       EJECT.                                                           01780002
      ******************************************************************01790002
      **INTIALIZATION ROUTINE                                           01800002
      ******************************************************************01810002
       1000-INITIALIZATION.                                             01820002
                                                                        01830002
           MOVE '1000-INITIALIZATION'   TO DP013-PARAGRAPH.             01840002
                                                                        01850002
           INITIALIZE SFRD006-FROM-CLIENT-RECORD.                       01860002
           INITIALIZE SFRD007-TO-CLIENT-RECORD.                         01870002
           INITIALIZE PC-PROGRAM-COUNTERS.                              01880021
           INITIALIZE PI-PROGRAM-INDICES.                               01890031
      *    SET PS-NOT-END-OF-POG-CSR    TO TRUE.                        01900059
                                                                        01910002
           PERFORM 1100-RETRIEVE-TEXT.                                  01920002
                                                                        01930002
           ACCEPT DV-ACCEPT-DATE FROM DATE.                             01940002
           MOVE DV-ACCEPT-YY            TO DV-ACCEPT-FMT-YY.            01950002
           MOVE DV-ACCEPT-MM            TO DV-ACCEPT-FMT-MM.            01960002
           MOVE DV-ACCEPT-DD            TO DV-ACCEPT-FMT-DD.            01970002
                                                                        01980002
      ***VALIDATES IF STORE IS A NEW STORE AND SHOULD BE IN THIS APP    01990002
           PERFORM 1200-STORE-CHECK.                                    02000028
                                                                        02010033
           PERFORM 1300-DUMMY-UPC-CHECK.                                02020033
                                                                        02030002
       EJECT.                                                           02040002
      ******************************************************************02050002
      **RETRIEVE DATA FROM CLIENT                                       02060002
      ******************************************************************02070002
       1100-RETRIEVE-TEXT.                                              02080002
                                                                        02090002
           MOVE '1100-RETRIEVE-TEXT'    TO DP013-PARAGRAPH.             02100002
                                                                        02110002
           PERFORM RFPD001-0500-RETRIEVE-TEXT.                          02120002
           MOVE RFWS007-FROM-CLIENT-RECORD                              02130002
                                        TO SFRD006-FROM-CLIENT-RECORD.  02140002
                                                                        02150002
           IF  RFWS007-NOT-SUCCESSFUL-RET                               02160002
               MOVE DP011-MSG-LEVEL     TO SFRD007-ERR-TYP-IND          02170002
               MOVE DP011-MSG-TEXT      TO SFRD007-ERR-MSG              02180002
               PERFORM 9000-FMT-ERR-MSG-TO-PTC                          02190002
               PERFORM 9000-CALL-CICS                                   02200002
           END-IF.                                                      02210002
                                                                        02220002
       EJECT.                                                           02230002
      ******************************************************************02240028
      **VALIDATE STORE CAN ACCESS POG INFORMATION                       02250028
      ******************************************************************02260028
       1200-STORE-CHECK.                                                02270028
                                                                        02280028
           MOVE '1200-STORE-CHECK'           TO DP013-PARAGRAPH.        02290028
                                                                        02300028
           MOVE SFRD006-LOC-NBR              TO XST00001-LOC-NBR.       02310029
           PERFORM SFPD001-1000-STORE-LOOKUP.                           02320028
                                                                        02330028
           EVALUATE TRUE                                                02340028
              WHEN SQLCODE = ZERO                                       02350028
                   CONTINUE                                             02360028
0223RM*       WHEN SQLCODE = +100                                       02370057
0223RM*            MOVE 'PLANOGRAM INFORMATION ONLY AVAILABLE FOR NEW ST02380057
0223RM*                 'ORES AT THIS TIME.' TO SFRD007-ERR-MSG         02390057
0223RM*            MOVE PC-ERROR-CODE        TO SFRD007-ERR-TYP-IND     02400057
0223RM*            PERFORM 9000-CALL-CICS                               02410057
              WHEN OTHER                                                02420028
                   MOVE 'STORE LOOKUP MODULE'                           02430028
                                             TO DP013-MESSAGE-TEXT (1)  02440028
                   MOVE XST00001-LOC-NBR     TO DP013-MESSAGE-TEXT (2)  02450028
                   MOVE SQLCA                TO DP013-SQLCA             02460028
                   MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)02470028
                   SET DP013-DB2-ABEND                                  02480028
                       DP013-NO-ROLLBACK     TO TRUE                    02490028
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      02500028
                   SET  DP011-MSG-FATAL      TO TRUE                    02510028
                   IF  SQLCODE = -911  OR  SQLCODE = -913               02520028
                       MOVE PC-TSYMSG-01063  TO DP011-MSG-NUMBER        02530028
                   ELSE                                                 02540028
                       MOVE PC-TSYMSG-01064  TO DP011-MSG-NUMBER        02550028
                   END-IF                                               02560028
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      02570028
                   PERFORM 9000-CALL-CICS                               02580028
           END-EVALUATE.                                                02590028
                                                                        02600028
       EJECT.                                                           02610028
      ******************************************************************02620033
      **CHECK IF INCOMING UPC IS A DUMMY UPC                            02630033
      ******************************************************************02640033
       1300-DUMMY-UPC-CHECK.                                            02650033
                                                                        02660033
           MOVE '1100-DUMMY-UPC-CHECK'       TO DP013-PARAGRAPH.        02670033
                                                                        02680033
           MOVE SFRD006-UPC-NBR              TO DP040I-UPC-CODE.        02690033
           SET DP040I-EXTRACT-SKU-FROM-UPC   TO TRUE.                   02700033
                                                                        02710033
           CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          02720055
                USING DP040I-UPC-CHECK-DIGIT-PARMS.                     02730033
                                                                        02740033
           EVALUATE TRUE                                                02750033
              WHEN NOT DP040I-UPC-NOT-DUMMY-UPC                         02760033
                   MOVE PC-ERROR-CODE         TO SFRD007-ERR-TYP-IND    02770045
                   MOVE PC-DUMMY-UPC-MSG      TO SFRD007-ERR-MSG        02780033
                   PERFORM 9000-CALL-CICS                               02790033
              WHEN OTHER                                                02800033
                   CONTINUE                                             02810033
           END-EVALUATE.                                                02820033
                                                                        02830033
       EJECT.                                                           02840033
      ******************************************************************02850002
      **MAIN PROCESSOR OF PROGRAM                                       02860002
      ******************************************************************02870002
       2000-PROCESS-REQUEST.                                            02880002
                                                                        02890002
           MOVE '2000-PROCESS-REQUEST' TO DP013-PARAGRAPH.              02900002
                                                                        02910002
           PERFORM 2100-ITEM-DATA-LOOKUP.                               02920003
                                                                        02930003
0223RM*    PERFORM 2200-POG-DATA-LOOKUP.                                02940057
                                                                        02950003
           PERFORM 2300-EAS-TAG-LOOKUP.                                 02960020
                                                                        02970019
       EJECT.                                                           02980002
      ***************************************************************** 02990002
      **RETRIEVE ITEM DATA                                              03000003
      ***************************************************************** 03010002
       2100-ITEM-DATA-LOOKUP.                                           03020009
                                                                        03030002
           MOVE '2100-ITEM-LOOKUP-DATA' TO DP013-PARAGRAPH.             03040003
                                                                        03050002
      ***ITEM INFORMATION LOOKUP - SEP FROM POG BECAUSE ONLY 40% OF     03060003
      ***     ITEMS AREA POG'D AS OF 06/24/2004.                        03070003
           MOVE SFRD006-UPC-NBR        TO XST00012-UPC-NBR.             03080003
                                                                        03090035
           EXEC SQL                                                     03100035
                SELECT C.DEPT_NBR                                       03110035
                      ,C.MAJ_CL_NBR                                     03120035
                      ,C.SUB_CL_NBR                                     03130035
                      ,C.VS_NBR                                         03140035
                      ,C.LBL_NM                                         03150035
                      ,B.SKU_DESC                                       03160035
                      ,G.BUS_AREA_ID                                    03170035
                      ,G.BUS_AREA_DESC                                  03180035
                      ,F.BUS_GP_NBR                                     03190035
                      ,F.BUS_GP_DESC                                    03200035
                      ,A.INTR_UPC_ID                                    03210035
                      ,C.STKR_NBR                                       03220035
                      ,B.NRF_CLOR_DESC                                  03221049
                      ,H.UNT_RTL_AMT                                    03230035
                INTO  :XST00013-DEPT-NBR                                03240035
                     ,:XST00013-MAJ-CL-NBR                              03250035
                     ,:XST00013-SUB-CL-NBR                              03260035
                     ,:XST00013-VS-NBR                                  03270035
                     ,:XST00013-LBL-NM                                  03280035
                     ,:XST00010-SKU-DESC                                03290035
                     ,:XST00024-BUS-AREA-ID                             03300035
                     ,:XST00024-BUS-AREA-DESC                           03310035
                     ,:XST00016-BUS-GP-NBR                              03320035
                     ,:XST00016-BUS-GP-DESC                             03330035
                     ,:XST00012-INTR-UPC-ID                             03340035
                     ,:XST00013-STKR-NBR                                03350035
                     ,:XST00010-NRF-CLOR-DESC                           03351048
                     ,:XST00008-UNT-RTL-AMT                             03360035
                FROM   XST_UPC      A                                   03370035
                      ,XST_SKU      B                                   03380035
                      ,XST_VND_STYL C                                   03390035
                      ,XST_SUB_CL   D                                   03400035
                      ,XST_DEPT     E                                   03410035
                      ,XST_BUS_GP   F                                   03420035
                      ,XST_BUS_AREA G                                   03430035
                      ,XST_SKU_LOC  H                                   03440035
                WHERE A.INTR_UPC_ID = B.INTR_UPC_ID                     03450035
                  AND B.INTR_UPC_ID = H.INTR_UPC_ID                     03460035
                  AND B.STYL_ID     = C.STYL_ID                         03470035
                  AND C.DEPT_NBR    = D.DEPT_NBR                        03480035
                  AND C.MAJ_CL_NBR  = D.MAJ_CL_NBR                      03490035
                  AND C.SUB_CL_NBR  = D.SUB_CL_NBR                      03500035
                  AND D.DEPT_NBR    = E.DEPT_NBR                        03510035
                  AND E.BUS_GP_NBR  = F.BUS_GP_NBR                      03520035
                  AND F.BUS_AREA_ID = G.BUS_AREA_ID                     03530035
                  AND A.UPC_NBR     = :XST00012-UPC-NBR                 03540035
                  AND H.LOC_NBR     = 0                                 03550036
                  AND A.LAST_ACTN_CDE IN ('A','U')                      03560035
                  AND H.END_TMST IS NULL                                03570035
           END-EXEC.                                                    03580035
                                                                        03590035
           EVALUATE TRUE                                                03600035
              WHEN SQLCODE = ZERO                                       03610035
                   MOVE XST00013-DEPT-NBR     TO SFRD007-DEPT-NBR       03620035
                   MOVE XST00013-MAJ-CL-NBR   TO SFRD007-MAJ-CL-NBR     03630035
                   MOVE XST00013-SUB-CL-NBR   TO SFRD007-SUB-CL-NBR     03640035
                   MOVE XST00013-VS-NBR       TO SFRD007-STYLE-ID       03650035
                   MOVE XST00013-LBL-NM       TO SFRD007-LABEL-NAME     03660035
                   MOVE XST00010-SKU-DESC     TO SFRD007-SKU-DESC       03670035
                   MOVE XST00024-BUS-AREA-ID  TO SFRD007-BUS-AREA-NBR   03680035
                   MOVE XST00024-BUS-AREA-DESC                          03690035
                                              TO SFRD007-BUS-AREA-DESC  03700035
                   MOVE XST00016-BUS-GP-NBR   TO SFRD007-BUS-GP-NBR     03710035
                   MOVE XST00016-BUS-GP-DESC  TO SFRD007-BUS-GP-DESC    03720035
                   MOVE XST00010-NRF-CLOR-DESC                          03721048
                                              TO SFRD007-NRF-CLOR-DESC  03722048
                   IF  XST00013-STKR-NBR NOT EQUAL ZEROS                03730035
                       MOVE XST00013-STKR-NBR TO SFRD007-BOX-NBR        03740035
                   END-IF                                               03750035
              WHEN SQLCODE = +100                                       03760035
                   SET DP011-MSG-FATAL        TO TRUE                   03770035
                   MOVE PC-TSYMSG-00100       TO DP011-MSG-NUMBER       03780035
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      03790035
                   PERFORM 9000-CALL-CICS                               03800035
              WHEN OTHER                                                03810035
                   MOVE 'ITEM DETAIL LOOKUP'                            03820035
                                              TO DP013-MESSAGE-TEXT (1) 03830035
                   MOVE XST00012-UPC-NBR      TO DP013-MESSAGE-TEXT (2) 03840035
                   MOVE XST00001-LOC-NBR      TO DP013-MESSAGE-TEXT (3) 03850035
                   MOVE SQLCA                 TO DP013-SQLCA            03860035
                   MOVE 'XST_UPC'             TO DP013-DB2-TABLE-NAME(1)03870035
                   MOVE 'XST_SKU'             TO DP013-DB2-TABLE-NAME(2)03880035
                   MOVE 'XST_VND_STYL'        TO DP013-DB2-TABLE-NAME(3)03890035
                   MOVE 'XST_SUB_CL ETC...'   TO DP013-DB2-TABLE-NAME(4)03900035
                   SET DP013-DB2-ABEND                                  03910035
                       DP013-NO-ROLLBACK      TO TRUE                   03920035
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      03930035
                   SET  DP011-MSG-FATAL       TO TRUE                   03940035
                   IF  SQLCODE = -911  OR  SQLCODE = -913               03950035
                       MOVE PC-TSYMSG-01063   TO DP011-MSG-NUMBER       03960035
                   ELSE                                                 03970035
                       MOVE PC-TSYMSG-01064   TO DP011-MSG-NUMBER       03980035
                   END-IF                                               03990035
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      04000035
                   PERFORM 9000-CALL-CICS                               04010035
           END-EVALUATE.                                                04020035
                                                                        04030003
                                                                        04040014
       EJECT.                                                           04050003
      ***************************************************************** 04060003
      **RETRIEVE POG DATA - CURSOR USED BECAUSE ITEM CAN BE ON MULTIPLE 04070025
      **         FIXTURES                                               04080025
      ***************************************************************** 04090025
0223RM*2200-POG-DATA-LOOKUP.                                            04100057
0223RM*                                                                 04110057
0223RM*    MOVE '2200-POG-LOOKUP-DATA' TO DP013-PARAGRAPH.              04120057
0223RM*                                                                 04130057
0223RM*    PERFORM SFPD001-3000-OPEN-POG-CSR.                           04140057
0223RM*    PERFORM 2250-FETCH-POG-CSR                                   04150057
0223RM*            UNTIL PS-END-OF-POG-CSR.                             04160057
0223RM*    PERFORM SFPD001-3200-CLOSE-POG-CSR.                          04170057
0223RM*                                                                 04180057
0223RM*EJECT.                                                           04190057
0223RM***************************************************************** 04200057
0223RM**FETCH POG CSR                                                   04210057
0223RM***************************************************************** 04220057
0223RM*2250-FETCH-POG-CSR.                                              04230057
0223RM*                                                                 04240057
0223RM*    MOVE '2250-FETCH-POG-CSR'          TO DP013-PARAGRAPH.       04250057
0223RM*                                                                 04260057
0223RM*    PERFORM SFPD001-3100-FETCH-POG-CSR                           04270057
0223RM*                                                                 04280057
0223RM*    EVALUATE TRUE                                                04290057
0223RM*       WHEN SQLCODE = ZERO                                       04300057
0223RM*            ADD +1                     TO PC-FETCH-COUNTER       04310057
0223RM*            ADD +1                     TO PI-FIXTURE-INDEX       04320057
0223RM*            MOVE XST00060-FLR-PAD-CDE  TO SFRD007-FIXTURE-AREA   04330057
0223RM*                                         (PI-FIXTURE-INDEX)      04340057
0223RM*            MOVE '-' TO                   SFRD007-DASH1          04341057
0223RM*                                         (PI-FIXTURE-INDEX)      04342057
0223RM*            MOVE XST00060-FIXT-LOC-NBR TO SFRD007-FIXTURE-ID     04350057
0223RM*                                         (PI-FIXTURE-INDEX)      04360057
061107*            MOVE XST00060-POG-POSN-NBR TO SFRD007-FIXTURE-POSN   04370051
0223RM*            MOVE '-' TO                   SFRD007-DASH2          04370157
0223RM*                                         (PI-FIXTURE-INDEX)      04370257
0223RM*            MOVE XST00060-FIXT-OBJ-ID  TO SFRD007-FIXT-OBJ-ID    04371057
0223RM*                                         (PI-FIXTURE-INDEX)      04380057
0223RM*       WHEN SQLCODE = +100                                       04390057
0223RM*            IF  PC-FETCH-COUNTER = 0                             04400057
0223RM*                MOVE PC-NO-POG-INFO-FOUND-MSG                    04410057
0223RM*                                       TO SFRD007-ERR-MSG        04420057
0223RM*                SET PS-END-OF-POG-CSR  TO TRUE                   04430057
0223RM*            ELSE                                                 04440057
0223RM*                SET PS-END-OF-POG-CSR  TO TRUE                   04450057
0223RM*            END-IF                                               04460057
0223RM*       WHEN OTHER                                                04470057
0223RM*            MOVE 'POG LOOKUP'          TO DP013-MESSAGE-TEXT (1) 04480057
0223RM*            MOVE XST00012-INTR-UPC-ID  TO DP013-MESSAGE-TEXT (2) 04490057
0223RM*            MOVE XST00001-LOC-NBR      TO DP013-MESSAGE-TEXT (3) 04500057
0223RM*            MOVE SQLCA                 TO DP013-SQLCA            04510057
0223RM*            MOVE 'XST_POG_LOC_ASSN'    TO DP013-DB2-TABLE-NAME(1)04520057
0223RM*            MOVE 'XST_POG'             TO DP013-DB2-TABLE-NAME(2)04530057
0223RM*            MOVE 'XST_POG_FIXT_LOC'    TO DP013-DB2-TABLE-NAME(3)04540057
0223RM*            MOVE 'XST_POG_POSN ETC...' TO DP013-DB2-TABLE-NAME(4)04550057
0223RM*            SET DP013-DB2-ABEND                                  04560057
0223RM*                DP013-NO-ROLLBACK      TO TRUE                   04570057
0223RM*            PERFORM 9999-WRITE-CICS-LOG-MSG                      04580057
0223RM*            SET  DP011-MSG-FATAL       TO TRUE                   04590057
0223RM*            IF  SQLCODE = -911  OR  SQLCODE = -913               04600057
0223RM*                MOVE PC-TSYMSG-01063   TO DP011-MSG-NUMBER       04610057
0223RM*            ELSE                                                 04620057
0223RM*                MOVE PC-TSYMSG-01064   TO DP011-MSG-NUMBER       04630057
0223RM*            END-IF                                               04640057
0223RM*            PERFORM 9000-FMT-ERR-MSG-TO-PTC                      04650057
0223RM*            PERFORM 9000-CALL-CICS                               04660057
0223RM*    END-EVALUATE.                                                04670057
                                                                        04680005
       EJECT.                                                           04690003
      ***************************************************************** 04700020
      **INDICATE IF EAS TAG IS NEEDED ON PRODUCT                        04710025
      ***************************************************************** 04720020
       2300-EAS-TAG-LOOKUP.                                             04730020
                                                                        04740020
           MOVE '2300-EAS-TAG-LOOKUP'         TO DP013-PARAGRAPH.       04750020
                                                                        04760020
           PERFORM SFPD001-2000-EAS-DATA-LOOKUP.                        04770035
                                                                        04780020
           EVALUATE TRUE                                                04790020
              WHEN SQLCODE = ZERO                                       04800020
      ***EAS TAG REQUIRED ON PRODUCT                                    04810025
                   SET SFRD007-EAS-TAG-MSG-YES                          04820020
                                              TO TRUE                   04830020
              WHEN SQLCODE = +100                                       04840020
      ***EAS TAG REQUIRED NOT REQUIRED ON PRODUCT                       04850025
                   SET SFRD007-EAS-TAG-MSG-SPACES                       04860040
                                              TO TRUE                   04870040
              WHEN OTHER                                                04880020
                   MOVE 'EAS TAG DATA LOOKUP' TO DP013-MESSAGE-TEXT (1) 04890020
                   MOVE XST00013-DEPT-NBR     TO DP013-MESSAGE-TEXT (2) 04900020
                   MOVE XST00013-MAJ-CL-NBR   TO DP013-MESSAGE-TEXT (3) 04910020
                   MOVE XST00013-SUB-CL-NBR   TO DP013-MESSAGE-TEXT (4) 04920020
                   MOVE SQLCA                 TO DP013-SQLCA            04930020
                   MOVE 'SFT_EAS_TG_MDSE'     TO DP013-DB2-TABLE-NAME(1)04940020
                   SET DP013-DB2-ABEND                                  04950020
                       DP013-NO-ROLLBACK      TO TRUE                   04960020
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      04970020
                   SET  DP011-MSG-FATAL       TO TRUE                   04980020
                   IF  SQLCODE = -911  OR  SQLCODE = -913               04990020
                       MOVE PC-TSYMSG-01063   TO DP011-MSG-NUMBER       05000020
                   ELSE                                                 05010020
                       MOVE PC-TSYMSG-01064   TO DP011-MSG-NUMBER       05020020
                   END-IF                                               05030020
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      05040020
                   PERFORM 9000-CALL-CICS                               05050020
           END-EVALUATE.                                                05060020
                                                                        05070020
       EJECT.                                                           05080020
      ***************************************************************** 05090020
      **PREP AND CICS CALLS                                             05100003
      ***************************************************************** 05110003
       9000-CALL-CICS.                                                  05120003
                                                                        05130003
           MOVE '9000-CALL-CICS'      TO DP013-PARAGRAPH.               05140003
                                                                        05150003
           PERFORM 9100-RFPD001-PREP.                                   05160002
           PERFORM RFPD001-1000-RETURN-DATA.                            05170002
                                                                        05180002
       EJECT.                                                           05190002
      ******************************************************************05200002
      **FORMAT MESSAGE TO WRITE TO CICS LOG                             05210002
      ******************************************************************05220002
       9000-FMT-ERR-MSG-TO-PTC.                                         05230002
                                                                        05240002
           PERFORM DP011-0000-FORMAT-MSG-LINES.                         05250002
           MOVE DP011-MSG-LEVEL   TO SFRD007-ERR-TYP-IND.               05260002
           MOVE DP011-MSG-TEXT    TO SFRD007-ERR-MSG.                   05270002
                                                                        05280002
       EJECT.                                                           05290002
      ****************************************************************  05300002
      **PREPARATION FOR RFPD001 PROCEDURE DIVISION                      05310002
      ****************************************************************  05320002
       9100-RFPD001-PREP.                                               05330002
                                                                        05340002
           MOVE '9100-RFPD001-PREP'      TO DP013-PARAGRAPH.            05350002
                                                                        05360002
      **USED TO DETERMINE THE SENDING PATH                              05370002
           MOVE SFRD006-MQ-INDICATOR     TO RFWS007-MQ-INDICATOR.       05380002
           MOVE LENGTH OF SFRD007-TO-CLIENT-RECORD                      05390002
                                         TO RFWS007-DATA-LENGTH         05400002
                                            SFRD007-TOT-REC-LENGTH.     05410002
      **USED FOR POCKET PCS TO UNIQUELY IDENTIFY THE MESSAGE            05420002
           MOVE SFRD006-MSGID            TO MQMD-CORRELID.              05430002
      **USED FOR OLD DEVICES TO UNIQUELY IDENTIFY THE MESSAGE           05440002
           MOVE SFRD006-MATCHING-NBR     TO SFRD007-MATCHING-NBR.       05450002
           MOVE SFRD007-TO-CLIENT-RECORD                                05460002
                                         TO RFWS007-TO-CLIENT-RECORD.   05470002
           MOVE SFRD006-REPLYTOQ         TO MQOD-OBJECTNAME.            05480002
           MOVE SFRD006-REPLYTOQMGR      TO MQOD-OBJECTQMGRNAME.        05490002
           MOVE SFRD007-TO-CLIENT-RECORD                                05500002
                                         TO RFWS007-MSGBUFFER.          05510002
                                                                        05520002
       EJECT.                                                           05530002
      ******************************************************************05540002
      **KOHLS DATE ROUTINE                                              05550002
      ******************************************************************05560002
       9999-DATE-ROUTINE.                                               05570002
                                                                        05580002
           CALL DP500-KOHLS-CALENDAR-ROUTINE                            05590002
                USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05600002
                                                                        05610002
           EVALUATE TRUE                                                05620002
              WHEN DPG54-NO-ERROR                                       05630002
                   CONTINUE                                             05640002
              WHEN OTHER                                                05650002
                   MOVE 'DATE ROUTINE'       TO DP013-MESSAGE-TEXT (1)  05660002
                   MOVE DPG52-LK-DATE-INPUT  TO DP013-MESSAGE-TEXT (2)  05670002
                   MOVE DPG53-LK-CMPR-DATE-INPUT                        05680002
                                             TO DP013-MESSAGE-TEXT (3)  05690002
                   MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (4)  05700002
                   SET DP013-OTHER-ABEND                                05710002
                       DP013-NO-ROLLBACK     TO TRUE                    05720002
                   PERFORM RFPD001-9998-LOG-CICS-MSG                    05730002
                   MOVE PC-TSYMSG-01063      TO DP011-MSG-NUMBER        05740002
                   PERFORM DP011-0000-FORMAT-MSG-LINES                  05750002
                   PERFORM 9000-CALL-CICS                               05760002
           END-EVALUATE.                                                05770002
                                                                        05780002
       EJECT.                                                           05790002
      ****************************************************************  05800002
      **CICS MESSAGE LOG ROUTINE                                        05810002
      ****************************************************************  05820002
       9999-WRITE-CICS-LOG-MSG.                                         05830002
                                                                        05840002
           MOVE PC-CURRENT-PROGRAM-NAME  TO  DP013-PROGRAM.             05850002
           MOVE DFHEIBLK                 TO  DP013-DFHEIBLK.            05860002
                                                                        05870002
           INITIALIZE DP013-SRC-TASK-NUMBER                             05880002
                      DP013-STACK.                                      05890002
                                                                        05900002
           SET DP013-LINK-RETURN         TO  TRUE.                      05910002
                                                                        05920002
           EXEC CICS                                                    05930002
               LINK                                                     05940002
                   PROGRAM   (DP013-NAME)                               05950002
                   COMMAREA  (DP013-PARAMETERS)                         05960002
                   LENGTH    (DP013-LENGTH)                             05970002
           END-EXEC.                                                    05980002
                                                                        05990002
       EJECT.                                                           06000002
      ******************************************************************06010002
      **SF STORE/ITEM/POG/EAS DATA LOOKUP COPYBOOK                      06020035
      ******************************************************************06030002
           COPY SFPD001.                                                06040061
      ******************************************************************06050002
      **RF CICS CALL COPYBOOK                                           06060002
      ******************************************************************06070002
           COPY RFPD001.                                                06080002
