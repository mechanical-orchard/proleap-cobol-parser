000100*                                                                 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*                                                                 00030000
000400 PROGRAM-ID.             SUKRP001.                                00040000
000500 AUTHOR.                 V.SUDHAN.                                00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            JULY, 2011.                              00070000
000800 DATE-COMPILED.                                                   00080000
000900*                                                                 00090000
001000******************************************************************00100000
001100*  THIS PROGRAM WILL PRINT THE MONTHLY MIXED PACKED TO LIGHT TOTE*00110000
001200*  REPORT.                                                       *00120000
001300******************************************************************00130000
001400*                                                                 00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600*                                                                 00160000
001700 CONFIGURATION SECTION.                                           00170000
001800*                                                                 00180000
001900 SOURCE-COMPUTER.        IBM-3090.                                00190000
002000 OBJECT-COMPUTER.        IBM-3090.                                00200000
002100*                                                                 00210000
002200 INPUT-OUTPUT SECTION.                                            00220000
002300*                                                                 00230000
002400 FILE-CONTROL.                                                    00240000
002500*                                                                 00250000
002600     SELECT SU-P2L-MIX-EXTRACT-FILE                               00260000
002700         ASSIGN TO INP01.                                         00270000
002800*                                                                 00280000
002810     SELECT CONTROL-FILE                                          00281000
002820         ASSIGN TO INP02.                                         00282000
002830*                                                                 00283000
002840     SELECT SU-P2L-MIX-REPORT-FILE                                00284000
002850         ASSIGN TO RPT01.                                         00285000
002860*                                                                 00286000
002870 DATA DIVISION.                                                   00287000
002880*                                                                 00288000
002890 FILE SECTION.                                                    00289000
002900*                                                                 00290000
003000 FD  SU-P2L-MIX-EXTRACT-FILE                                      00300000
003100     RECORDING MODE IS F                                          00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     BLOCK CONTAINS 0 RECORDS.                                    00330000
003400*                                                                 00340000
003500 01  SU-P2L-MIX-EXTRACT-RECORD       PIC  X(050).                 00350000
003600*                                                                 00360000
003700 FD  CONTROL-FILE                                                 00370000
003800     RECORDING MODE IS F                                          00380000
003900     LABEL RECORDS ARE STANDARD                                   00390000
004000     BLOCK CONTAINS 0 RECORDS.                                    00400000
004100*                                                                 00410000
004200 01  CONTROL-RECORD                  PIC  X(080).                 00420000
004210*                                                                 00421000
004220 FD  SU-P2L-MIX-REPORT-FILE                                       00422000
004230     RECORDING MODE IS F                                          00423000
004240     LABEL RECORDS ARE STANDARD                                   00424000
004250     BLOCK CONTAINS 0 RECORDS.                                    00425000
004260*                                                                 00426000
004270 01  SU-P2L-MIX-REPORT-LINE          PIC  X(132).                 00427000
004280*                                                                 00428000
004290 WORKING-STORAGE SECTION.                                         00429000
004300*                                                                 00430000
004400***************************************************************** 00440000
004500*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.              * 00450000
004600***************************************************************** 00460000
004700*                                                                 00470000
004800     COPY DPWS132O.                                               00480000
004900*                                                                 00490000
005000***************************************************************** 00500000
005100*  RECORD LAYOUT FOR THE MIXED PACK TO LIGHT EXTRACT FILE.      * 00510000
005200***************************************************************** 00520000
005300*                                                                 00530000
005400     COPY SUWS058.                                                00540000
005500*                                                                 00550000
005600***************************************************************** 00560000
005700*  RECORD LAYOUT FOR THE DATE CONTROL RECORD.                   * 00570000
005800***************************************************************** 00580000
005900*                                                                 00590000
006000     COPY SURD032.                                                00600000
006100*                                                                 00610000
006200***************************************************************** 00620000
006300*  COPYBOOK MEMBER OF PRINTER LINE COMMANDS TO BE USED WITH     * 00630000
006400*  PRINTEK PRINTERS                                             * 00640000
006500***************************************************************** 00650000
006600*                                                                 00660000
006700     COPY DSWS004.                                                00670000
006800*                                                                 00680000
006900******************************************************************00690000
007000*     PAGE HEADINGS        PAGE HEADINGS         PAGE HEADING    *00700000
007100******************************************************************00710000
007200*                                                                 00720000
007300 01  PH2-PAGE-HEADING-1.                                          00730000
007400     05  FILLER                      PIC  X(46)  VALUE SPACE.     00740000
007500     05  PH2-HEAD-PERIOD-1           PIC  X(08)  VALUE SPACE.     00750000
007510     05  FILLER                      PIC  X(33)  VALUE            00751000
007520         '- MIXED ZONE PACK TO LIGHT REPORT'.                     00752000
007530     05  FILLER                      PIC  X(45)  VALUE SPACE.     00753000
007540*                                                                 00754000
007550 01  PH2-PAGE-HEADING-2.                                          00755000
007560     05  FILLER                      PIC  X(52)    VALUE SPACES.  00756000
007570     05  FILLER                      PIC  X(05)    VALUE 'FROM '. 00757000
007580     05  PH2-FROM-DTE-2              PIC  X(10)    VALUE SPACES.  00758000
007590     05  FILLER                      PIC  X(04)    VALUE ' TO '.  00759000
007600     05  PH2-TO-DTE-2                PIC  X(10)    VALUE SPACES.  00760000
007700     05  FILLER                      PIC  X(51)    VALUE SPACES.  00770000
007800*                                                                 00780000
007900 01  PH2-PAGE-HEADING-2A.                                         00790000
008000     05  FILLER                      PIC  X(45)  VALUE            00800000
008100     ' -LOC ------------------------ CARTON COUNTS '.             00810001
008200     05  FILLER                      PIC  X(25)  VALUE            00820000
008300     '-------------------------'.                                 00830000
008400     05  FILLER                      PIC  X(53)  VALUE            00840000
008500     ' -------- TOTALS ------- -------- PERCENTAGES -------'.     00850000
008510     05  FILLER                      PIC  X(09)  VALUE SPACE.     00851000
008511*                                                                 00851100
008512 01  PH2-PAGE-HEADING-3.                                          00851200
008513     05  FILLER                      PIC  X(21)  VALUE SPACE.     00851300
008514     05  FILLER                      PIC  X(49)  VALUE            00851400
008515     '                                          GREATER'.         00851500
008516     05  FILLER                      PIC  X(62)  VALUE SPACE.     00851600
008517*                                                                 00851700
008518 01  PH2-PAGE-HEADING-4.                                          00851800
008519     05  FILLER                      PIC  X(63)  VALUE SPACE.     00851900
008520     05  FILLER                      PIC  X(07)  VALUE            00852000
008530     'THAN OR'.                                                   00853000
008540     05  FILLER                      PIC  X(62)  VALUE SPACE.     00854000
008550*                                                                 00855000
008560 01  PH2-PAGE-HEADING-5.                                          00856000
008570     05  FILLER                      PIC  X(62)  VALUE SPACE.     00857000
008580     05  FILLER                      PIC  X(09)  VALUE            00858000
008590     'EQUAL TO '.                                                 00859000
008600     05 FILLER                      PIC   X(52)  VALUE            00860000
008700     '           TOTAL           %1        %2        % > 2'.      00870000
008800     05  FILLER                      PIC  X(09)  VALUE SPACE.     00880000
008900*                                                                 00890000
009000 01  PH2-PAGE-HEADING-6.                                          00900000
009100     05  FILLER                      PIC  X(57)  VALUE            00910000
009200     '  LOC       1 ZONE      2 ZONES      3 ZONES      4 ZONES'. 00920001
009300     05  FILLER                      PIC  X(14)  VALUE            00930000
009400     '      5 ZONES '.                                            00940000
009500     05  FILLER                      PIC  X(52)  VALUE            00950000
009600     '         CARTONS          ZONE      ZONE       ZONES'.      00960000
009700     05  FILLER                      PIC  X(09)  VALUE SPACE.     00970000
009800*                                                                 00980000
009900******************************************************************00990000
010000*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *01000000
010100******************************************************************01010000
010200*                                                                 01020000
010300 01  P2L-MIX-RPT-DETAIL-LINE.                                     01030000
010400     05  FILLER                      PIC  X(01)  VALUE SPACES.    01040000
010500     05  P2L-DC-NBR                  PIC  9(04).                  01050000
010600     05  P2L-DC-NBR-X    REDEFINES P2L-DC-NBR                     01060000
010700                                     PIC  ZZ9.                    01070000
010800     05  FILLER                      PIC  X(04)  VALUE SPACES.    01080000
010900     05  P2L-1-ZONE                  PIC  Z,ZZZ,ZZ9.              01090000
011000     05  FILLER                      PIC  X(04)  VALUE SPACES.    01100000
011100     05  P2L-2-ZONE                  PIC  Z,ZZZ,ZZ9.              01110000
011200     05  FILLER                      PIC  X(04)  VALUE SPACES.    01120000
011300     05  P2L-3-ZONE                  PIC  Z,ZZZ,ZZ9.              01130000
011400     05  FILLER                      PIC  X(04)  VALUE SPACES.    01140000
011500     05  P2L-4-ZONE                  PIC  Z,ZZZ,ZZ9.              01150000
011600     05  FILLER                      PIC  X(04)  VALUE SPACES.    01160000
011700     05  P2L-GTE5-ZONE               PIC  Z,ZZZ,ZZ9.              01170000
011800     05  FILLER                      PIC  X(08)  VALUE SPACES.    01180000
011900     05  P2L-TOT-CRTNS               PIC  Z,ZZZ,ZZ9.              01190000
012000     05  FILLER                      PIC  X(08)  VALUE SPACES.    01200000
012100     05  P2L-PER-1ZONE               PIC  ZZ9.99.                 01210000
012200     05  FILLER                      PIC  X(04)  VALUE SPACES.    01220000
012300     05  P2L-PER-2ZONE               PIC  ZZ9.99.                 01230000
012400     05  FILLER                      PIC  X(06)  VALUE SPACES.    01240000
012500     05  P2L-PER-GT-2ZONE            PIC  ZZ9.99.                 01250000
012600     05  FILLER                      PIC  X(09)  VALUE SPACE.     01260000
012700*                                                                 01270000
012800 01  P2L-MIX-RPT-TOTAL-LINE.                                      01280000
012900     05  FILLER                      PIC  X(05)  VALUE 'TOTAL'.   01290000
013000     05  FILLER                      PIC  X(04)  VALUE SPACES.    01300000
013100     05  P2L-1-ZONE-TOT              PIC  Z,ZZZ,ZZ9.              01310000
013200     05  FILLER                      PIC  X(04)  VALUE SPACES.    01320000
013300     05  P2L-2-ZONE-TOT              PIC  Z,ZZZ,ZZ9.              01330000
013400     05  FILLER                      PIC  X(04)  VALUE SPACES.    01340000
013410     05  P2L-3-ZONE-TOT              PIC  Z,ZZZ,ZZ9.              01341000
013420     05  FILLER                      PIC  X(04)  VALUE SPACES.    01342000
013430     05  P2L-4-ZONE-TOT              PIC  Z,ZZZ,ZZ9.              01343000
013440     05  FILLER                      PIC  X(04)  VALUE SPACES.    01344000
013450     05  P2L-GTE5-ZONE-TOT           PIC  Z,ZZZ,ZZ9.              01345000
013460     05  FILLER                      PIC  X(08)  VALUE SPACES.    01346000
013470     05  P2L-TOT-CRTNS-TOT           PIC  Z,ZZZ,ZZ9.              01347000
013480     05  FILLER                      PIC  X(08)  VALUE SPACES.    01348000
013490     05  P2L-PER-1ZONE-TOT           PIC  ZZ9.99.                 01349000
013491     05  FILLER                      PIC  X(04)  VALUE SPACES.    01349100
013492     05  P2L-PER-2ZONE-TOT           PIC  ZZ9.99.                 01349200
013493     05  FILLER                      PIC  X(06)  VALUE SPACES.    01349300
013494     05  P2L-PER-GT-2ZONE-TOT        PIC  ZZ9.99.                 01349400
013495     05  FILLER                      PIC  X(09)  VALUE SPACES.    01349500
013496*                                                                 01349600
013497 01  BLANK-LINE.                                                  01349700
013498     05  FILLER                      PIC  X(132) VALUE SPACE.     01349800
013499*                                                                 01349900
013500 01  END-OF-REPORT-LINE.                                          01350000
013600     05  FILLER                      PIC  X(54)  VALUE SPACE.     01360000
013700     05  FILLER                      PIC  X(25)  VALUE            01370000
013800         '***** END OF REPORT *****'.                             01380000
013900     05  FILLER                      PIC  X(53)  VALUE SPACE.     01390000
014000*                                                                 01400000
014100 01  NO-DATA-LINE.                                                01410000
014200     05  FILLER                      PIC  X(49)  VALUE SPACE.     01420000
014300     05  FILLER                      PIC  X(35)  VALUE            01430000
014400         '********* NO DATA TO REPORT *******'.                   01440000
014500     05  FILLER                      PIC  X(48)  VALUE SPACE.     01450000
014600*                                                                 01460000
014700 01  PC-CONSTANTS.                                                01470000
014800     05  PC-20                       PIC 9(02)   VALUE 20.        01480000
014900     05  PC-21                       PIC 9(02)   VALUE 21.        01490000
015000     05  PC-MAX-REPORT-LINES         PIC S9(04)  VALUE +59        01500000
015100                                                     COMP SYNC.   01510000
015200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            01520000
015300         'SUKRP001'.                                              01530000
015400*                                                                 01540000
015500 01  PS-PROGRAM-SWITCHES.                                         01550000
015600     05  PS-EOF-P2L-MIX-EXTRACT-IND  PIC  X(01)  VALUE 'N'.       01560000
015700         88  PS-EOF-P2L-MIX-EXTRACT              VALUE 'Y'.       01570000
015800         88  PS-NOT-EOF-P2L-MIX-EXTRACT          VALUE 'N'.       01580000
015900*                                                                 01590000
016000 01  PV-PROGRAM-VARIABLES.                                        01600000
016100     05  PV-YEAR-NUM                 PIC  9(2)    VALUE  ZEROES.  01610000
016200     05  PV-MONTH-NUM                PIC  9(2)    VALUE  ZEROES.  01620000
016300     05  PV-ZONE-1                   PIC  9(9)    VALUE  ZEROES.  01630000
016400     05  PV-ZONE-2                   PIC  9(9)    VALUE  ZEROES.  01640000
016401     05  PV-ZONE-3                   PIC  9(9)    VALUE  ZEROES.  01640100
016402     05  PV-ZONE-4                   PIC  9(9)    VALUE  ZEROES.  01640200
016403     05  PV-ZONE-GTE5                PIC  9(9)    VALUE  ZEROES.  01640300
016404     05  PV-ZONE-GT2                 PIC  9(9)    VALUE  ZEROES.  01640400
016405     05  PV-ZONE-TOT-CRTNS           PIC  9(9)    VALUE  ZEROES.  01640500
016406     05  PV-ZONE-1-TOT               PIC  9(9)    VALUE  ZEROES.  01640600
016407     05  PV-ZONE-2-TOT               PIC  9(9)    VALUE  ZEROES.  01640700
016408     05  PV-ZONE-3-TOT               PIC  9(9)    VALUE  ZEROES.  01640800
016409     05  PV-ZONE-4-TOT               PIC  9(9)    VALUE  ZEROES.  01640900
016410     05  PV-ZONE-GTE5-TOT            PIC  9(9)    VALUE  ZEROES.  01641000
016420     05  PV-ZONE-GT2-TOT             PIC  9(9)    VALUE  ZEROES.  01642000
016430     05  PV-ZONE-TOT-CRTNS-TOT       PIC  9(9)    VALUE  ZEROES.  01643000
016440     05  PV-PER-GT-2ZONE             PIC 9(3)V9(4) VALUE  ZEROES. 01644000
016450     05  PV-PER-1ZONE                PIC 9(3)V9(4) VALUE  ZEROES. 01645000
016460     05  PV-PER-2ZONE                PIC 9(3)V9(4) VALUE  ZEROES. 01646000
016470     05  PV-PER-GT-2ZONE-TOT         PIC 9(3)V9(4) VALUE  ZEROES. 01647000
016480     05  PV-PER-1ZONE-TOT            PIC 9(3)V9(4) VALUE  ZEROES. 01648000
016490     05  PV-PER-2ZONE-TOT            PIC 9(3)V9(4) VALUE  ZEROES. 01649000
016500     05  PV-PER-GREATER-2ZONE        PIC 9(3).9(4) VALUE  ZEROES. 01650000
016600     05  PV-PER-ONE-ZONE             PIC 9(3).9(4) VALUE  ZEROES. 01660000
016700     05  PV-PER-TWO-ZONE             PIC 9(3).9(4) VALUE  ZEROES. 01670000
016800     05  PV-PER-GREATER-2ZONE-TOT    PIC 9(3).9(4) VALUE  ZEROES. 01680000
016900     05  PV-PER-ONE-ZONE-TOT         PIC 9(3).9(4) VALUE  ZEROES. 01690000
017000     05  PV-PER-TWO-ZONE-TOT         PIC 9(3).9(4) VALUE  ZEROES. 01700000
017100     05  PV-PREV-LOC-NBR             PIC  9(4)    VALUE  ZEROES.  01710000
017110     05  PV-PREV-COUNT-NBR           PIC  9(6)    VALUE  ZEROES.  01711000
017120     05  PV-P2L-MIX-RPT-LAYOUT       PIC  X(200).                 01712000
017130     05  PV-P2L-EXT-REC-CNT          PIC  9(09)  VALUE 0.         01713000
017140     05  PV-P2L-RPT-REC-WRITTEN      PIC  9(09)  VALUE 0.         01714000
017150     05  PV-DATE.                                                 01715000
017160         10 PV-DATE-CC               PIC  X(02).                  01716000
017170         10 PV-DATE-YY               PIC  X(02).                  01717000
017180         10 FILLER                   PIC  X(01) VALUE '-'.        01718000
017190         10 PV-DATE-MM               PIC  X(02).                  01719000
017200         10 FILLER                   PIC  X(01) VALUE '-'.        01720000
017300         10 PV-DATE-DD               PIC  X(02).                  01730000
017400     05  PV-DATE-DISPLAY.                                         01740000
017500         10 PV-DATE-DISPLAY-MM       PIC  X(02).                  01750000
017600         10 FILLER                   PIC  X(01) VALUE '-'.        01760000
017700         10 PV-DATE-DISPLAY-DD       PIC  X(02).                  01770000
017710         10 FILLER                   PIC  X(01) VALUE '-'.        01771000
017720         10 PV-DATE-DISPLAY-CC       PIC  X(02).                  01772000
017730         10 PV-DATE-DISPLAY-YY       PIC  X(02).                  01773000
017740     05  PV-DETAIL-PAGE-COUNT        PIC 9(04) VALUE 0 COMP SYNC. 01774000
017750     05  PV-DETAIL-LINE-COUNT        PIC 9(09) VALUE 0 COMP SYNC. 01775000
017760     05  PV-LINE-COUNT               PIC 9(04) VALUE 0 COMP SYNC. 01776000
017770     05  PV-SUB                      PIC 9(04) VALUE 0 COMP SYNC. 01777000
017780     05  PV-CURR-DATE.                                            01778000
017790         15  PV-CURR-YY              PIC  X(02).                  01779000
017800         15  PV-CURR-MM              PIC  X(02).                  01780000
017900         15  PV-CURR-DD              PIC  X(02).                  01790000
018000     05  PV-CURR-TIME.                                            01800000
018100         15  PV-CURR-HH              PIC  X(02).                  01810000
018200         15  PV-CURR-MIN             PIC  X(02).                  01820000
018300         15  PV-CURR-SS              PIC  X(02).                  01830000
018400*                                                                 01840000
018500 PROCEDURE DIVISION.                                              01850000
018600*                                                                 01860000
018700******************************************************************01870000
018800*  THIS PARAGRAPH CONTROLS THE MAIN PROCESSING OF THE PROGRAM.   *01880000
018900******************************************************************01890000
019000*                                                                 01900000
019100 0000-PROGRAM-MAINLINE.                                           01910000
019200*                                                                 01920000
019300     PERFORM 1000-INITIALIZE.                                     01930000
019400*                                                                 01940000
019500     PERFORM 2000-CREATE-REPORT                                   01950000
019600         UNTIL PS-EOF-P2L-MIX-EXTRACT.                            01960000
019700*                                                                 01970000
019800     PERFORM 3000-EOJ-ROUTINE.                                    01980000
019900*                                                                 01990000
020000     STOP RUN.                                                    02000000
020100*                                                                 02010000
020200******************************************************************02020000
020300*  THIS PARAGRAPH                                                *02030000
020400*  1. OPEN ALL INPUT/OUTPUT FILES                                *02040000
020500*  2. GET ALL HEADER INFORMATION AND PRINTS                      *02050000
020600*  3. IF THE INPUT FILE IS EMPTY, THEN PRINTS THE NO DATA MSG    *02060000
020700******************************************************************02070000
020800*                                                                 02080000
020900 1000-INITIALIZE.                                                 02090000
021000*                                                                 02100000
021100     DISPLAY '** PROGRAM SUKRP001 EXECUTION STARTED **'.          02110000
021200     OPEN INPUT  SU-P2L-MIX-EXTRACT-FILE                          02120000
021300                 CONTROL-FILE                                     02130000
021400          OUTPUT SU-P2L-MIX-REPORT-FILE.                          02140000
021500*                                                                 02150000
021600     PERFORM 1100-SET-UP-HEADER.                                  02160000
021700     PERFORM 8200-PRINT-PAGE-HEADING.                             02170000
021800*                                                                 02180000
021900     SET PS-NOT-EOF-P2L-MIX-EXTRACT     TO TRUE.                  02190000
022000     PERFORM 8000-READ-EXTRACT-FILE.                              02200000
022100                                                                  02210000
022200     MOVE ZEROES TO PV-PER-GT-2ZONE-TOT                           02220000
022300                    PV-PER-2ZONE-TOT.                             02230000
022400*                                                                 02240000
022500*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT.    02250000
022600     IF PS-EOF-P2L-MIX-EXTRACT                                    02260000
022700        DISPLAY '**                                         **'   02270000
022800        DISPLAY '*******  NO DATA TO REPORT IN SUKRP001 ******'   02280000
022900        DISPLAY '**                                         **'   02290000
023000        MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT        02300000
023100        PERFORM 8100-WRITE-P2L-MIX-RPT                            02310000
023200                                                                  02320000
023300        MOVE NO-DATA-LINE         TO PV-P2L-MIX-RPT-LAYOUT        02330000
023400        PERFORM 8100-WRITE-P2L-MIX-RPT                            02340000
023500                                                                  02350000
023600        MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT        02360000
023700        PERFORM 8100-WRITE-P2L-MIX-RPT                            02370000
023800                                                                  02380000
023900        MOVE END-OF-REPORT-LINE   TO PV-P2L-MIX-RPT-LAYOUT        02390000
024000        PERFORM 8100-WRITE-P2L-MIX-RPT                            02400000
024100     ELSE                                                         02410000
024200        MOVE SU058-LOC-NBR        TO PV-PREV-LOC-NBR              02420000
024300        MOVE SU058-CRTN-COUNT     TO PV-PREV-COUNT-NBR            02430000
024400        MOVE ZEROES               TO PV-ZONE-1                    02440000
024500                                     PV-ZONE-2                    02450000
024600                                     PV-ZONE-3                    02460000
024700                                     PV-ZONE-4                    02470000
024800                                     PV-ZONE-GTE5                 02480000
024900                                     PV-ZONE-GT2                  02490000
025000                                     PV-ZONE-TOT-CRTNS            02500000
025100                                     PV-ZONE-1-TOT                02510000
025200                                     PV-ZONE-2-TOT                02520000
025300                                     PV-ZONE-3-TOT                02530000
025400                                     PV-ZONE-4-TOT                02540000
025500                                     PV-ZONE-GTE5-TOT             02550000
025600                                     PV-ZONE-GT2-TOT              02560000
025700                                     PV-ZONE-TOT-CRTNS-TOT        02570000
025800                                     PV-PER-GREATER-2ZONE         02580000
025900                                     PV-PER-ONE-ZONE              02590000
025910                                     PV-PER-TWO-ZONE              02591000
025911                                     PV-PER-GREATER-2ZONE-TOT     02591100
025912                                     PV-PER-ONE-ZONE-TOT          02591200
025913                                     PV-PER-TWO-ZONE-TOT          02591300
025914                                     PV-PER-1ZONE                 02591400
025915                                     PV-PER-2ZONE                 02591500
025916                                     PV-PER-GT-2ZONE              02591600
025917     END-IF.                                                      02591700
025918*                                                                 02591800
025919******************************************************************02591900
025920*  THIS PARAGRAPH MOVES ALL INFORMATION TO THE HEADER FIELDS AND *02592000
025930*  PRINTS THE P2L MIX REPORT HEADERS.                            *02593000
025940******************************************************************02594000
025950*                                                                 02595000
025960 1100-SET-UP-HEADER.                                              02596000
025970*                                                                 02597000
025980     MOVE PC-CURRENT-PROGRAM-NAME                                 02598000
025990                               TO DP132O-PROGRAM-NAME.            02599000
026000*                                                                 02600000
026100     ACCEPT PV-CURR-DATE       FROM DATE.                         02610000
026200     MOVE PV-CURR-YY           TO DP132O-RUN-YEAR                 02620000
026300                                  PV-DATE-YY                      02630000
026400     MOVE PV-CURR-MM           TO DP132O-RUN-MONTH                02640000
026500                                  PV-DATE-MM                      02650000
026600                                  PV-MONTH-NUM                    02660000
026700     MOVE PV-CURR-DD           TO DP132O-RUN-DAY                  02670000
026800                                  PV-DATE-DD                      02680000
026900*                                                                 02690000
027000     ACCEPT PV-CURR-TIME       FROM TIME.                         02700000
027100     MOVE PV-CURR-HH           TO DP132O-RUN-HOUR.                02710000
027200     MOVE PV-CURR-MIN          TO DP132O-RUN-MINUTE.              02720000
027300*                                                                 02730000
027400     PERFORM 7000-READ-CONTROL-REC.                               02740000
027500*                                                                 02750000
027600     MOVE SU032-FROM-DATE      TO PV-DATE.                        02760000
027700     MOVE PV-DATE-MM           TO PV-DATE-DISPLAY-MM              02770000
027800     MOVE PV-DATE-DD           TO PV-DATE-DISPLAY-DD              02780000
027900     MOVE PV-DATE-CC           TO PV-DATE-DISPLAY-CC              02790000
028000     MOVE PV-DATE-YY           TO PV-DATE-DISPLAY-YY              02800000
028100     MOVE PV-DATE-DISPLAY      TO PH2-FROM-DTE-2.                 02810000
028200     MOVE SU032-TO-DATE        TO PV-DATE.                        02820000
028300     MOVE PV-DATE-MM           TO PV-DATE-DISPLAY-MM              02830000
028301     MOVE PV-DATE-DD           TO PV-DATE-DISPLAY-DD              02830100
028302     MOVE PV-DATE-CC           TO PV-DATE-DISPLAY-CC              02830200
028303     MOVE PV-DATE-YY           TO PV-DATE-DISPLAY-YY              02830300
028304     MOVE PV-DATE-DISPLAY      TO PH2-TO-DTE-2.                   02830400
028305*                                                                 02830500
028306     IF  SU032-RPT-TYPE = 'M'                                     02830600
028307         MOVE 'MONTHLY '       TO PH2-HEAD-PERIOD-1               02830700
028308     ELSE                                                         02830800
028309         IF  SU032-RPT-TYPE = 'W'                                 02830900
028310             MOVE ' WEEKLY '   TO PH2-HEAD-PERIOD-1               02831000
028311         END-IF                                                   02831100
028312     END-IF.                                                      02831200
028313*                                                                 02831300
028314*                                                                 02831400
028315******************************************************************02831500
028316* THIS PARAGRAPH COLLECTS THE DETAIL HEADER INFORMATION AND PRINT*02831600
028317* IT IN THE DETAIL LAYOUT.                                       *02831700
028318******************************************************************02831800
028319*                                                                 02831900
028320 2000-CREATE-REPORT.                                              02832000
028330*                                                                 02833000
028340       PERFORM 2100-BUILD-RPT-REC VARYING PV-SUB FROM 1 BY 1      02834000
028350          UNTIL SU058-LOC-NBR NOT EQUAL PV-PREV-LOC-NBR           02835000
028360             OR PS-EOF-P2L-MIX-EXTRACT                            02836000
028370          COMPUTE PV-ZONE-TOT-CRTNS =                             02837000
028380          (PV-ZONE-1  +                                           02838000
028390           PV-ZONE-2  +                                           02839000
028400           PV-ZONE-3  +                                           02840000
028500           PV-ZONE-4  +                                           02850000
028600           PV-ZONE-GTE5 )                                         02860000
028700          COMPUTE PV-ZONE-GT2  =                                  02870000
028800          (PV-ZONE-3  +                                           02880000
028900           PV-ZONE-4  +                                           02890000
029000           PV-ZONE-GTE5 )                                         02900000
029100           COMPUTE PV-PER-GT-2ZONE ROUNDED =                      02910000
029200                (PV-ZONE-GT2 / PV-ZONE-TOT-CRTNS) * 100.00        02920000
029300           MOVE  PV-PER-GT-2ZONE        TO PV-PER-GREATER-2ZONE   02930000
029400                                                                  02940000
029500           ADD   PV-ZONE-GT2            TO PV-ZONE-GT2-TOT        02950000
029600                                                                  02960000
029700           COMPUTE PV-PER-1ZONE ROUNDED =                         02970000
029800                (PV-ZONE-1 / PV-ZONE-TOT-CRTNS) * 100.00          02980000
029900           MOVE  PV-PER-1ZONE        TO PV-PER-ONE-ZONE           02990000
030000           COMPUTE PV-PER-2ZONE ROUNDED =                         03000000
030100                (PV-ZONE-2 / PV-ZONE-TOT-CRTNS) * 100.00          03010000
030200           MOVE  PV-PER-2ZONE        TO PV-PER-TWO-ZONE           03020000
030300          PERFORM 8300-PRINT-DEATIL-LINE                          03030000
030400          MOVE SU058-LOC-NBR     TO  PV-PREV-LOC-NBR              03040000
030500          MOVE SU058-CRTN-COUNT TO   PV-PREV-COUNT-NBR.           03050000
030600 2100-BUILD-RPT-REC.                                              03060000
030700          EVALUATE  TRUE                                          03070000
030800             WHEN SU058-ZONE-COUNT = 1                            03080000
030900                 MOVE SU058-CRTN-COUNT TO PV-ZONE-1               03090000
031000             WHEN SU058-ZONE-COUNT = 2                            03100000
031100                 MOVE SU058-CRTN-COUNT TO PV-ZONE-2               03110000
031200             WHEN SU058-ZONE-COUNT = 3                            03120000
031300                 MOVE SU058-CRTN-COUNT TO PV-ZONE-3               03130000
031400             WHEN SU058-ZONE-COUNT = 4                            03140000
031500                 MOVE SU058-CRTN-COUNT TO PV-ZONE-4               03150000
031600             WHEN SU058-ZONE-COUNT > 4                            03160000
031700                 ADD  SU058-CRTN-COUNT TO PV-ZONE-GTE5            03170000
031800          END-EVALUATE                                            03180000
031900          PERFORM 8000-READ-EXTRACT-FILE.                         03190000
032000*                                                                 03200000
032100******************************************************************03210000
032200* THIS PARAGRAPH PRINTS THE GRAN TOTAL, DISPALYS THE RECORDS READ*03220000
032300* & WRITTEN, CLOSES THE FILES.                                   *03230000
032400******************************************************************03240000
032500*                                                                 03250000
032600 3000-EOJ-ROUTINE.                                                03260000
032700*                                                                 03270000
032800     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT           03280000
032900     PERFORM 8100-WRITE-P2L-MIX-RPT                               03290000
033000                                                                  03300000
033100     IF PV-P2L-EXT-REC-CNT > 1                                    03310000
033200       COMPUTE PV-PER-GT-2ZONE-TOT ROUNDED =                      03320000
033300          (PV-ZONE-GT2-TOT / PV-ZONE-TOT-CRTNS-TOT) * 100.00      03330000
033400       MOVE  PV-PER-GT-2ZONE-TOT TO PV-PER-GREATER-2ZONE-TOT      03340000
033500       COMPUTE PV-PER-1ZONE-TOT ROUNDED    =                      03350000
033600          (PV-ZONE-1-TOT / PV-ZONE-TOT-CRTNS-TOT) * 100.00        03360000
033700       MOVE  PV-PER-1ZONE-TOT    TO PV-PER-ONE-ZONE-TOT           03370000
033800       COMPUTE PV-PER-2ZONE-TOT ROUNDED    =                      03380000
033900          (PV-ZONE-2-TOT / PV-ZONE-TOT-CRTNS-TOT) * 100.00        03390000
034000       MOVE  PV-PER-2ZONE-TOT    TO PV-PER-TWO-ZONE-TOT           03400000
034100                                                                  03410000
034200       MOVE PV-PER-GREATER-2ZONE-TOT TO P2L-PER-GT-2ZONE-TOT      03420000
034300       MOVE PV-PER-ONE-ZONE-TOT      TO P2L-PER-1ZONE-TOT         03430000
034400       MOVE PV-PER-TWO-ZONE-TOT      TO P2L-PER-2ZONE-TOT         03440000
034500                                                                  03450000
034600       MOVE P2L-MIX-RPT-TOTAL-LINE TO PV-P2L-MIX-RPT-LAYOUT       03460000
034700       PERFORM 8100-WRITE-P2L-MIX-RPT                             03470000
034800     END-IF                                                       03480000
034900                                                                  03490000
035000     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT           03500000
035100     PERFORM 8100-WRITE-P2L-MIX-RPT                               03510000
035200                                                                  03520000
035300     MOVE END-OF-REPORT-LINE   TO PV-P2L-MIX-RPT-LAYOUT           03530000
035400     PERFORM 8100-WRITE-P2L-MIX-RPT                               03540000
035500                                                                  03550000
035600     DISPLAY '                                                   '03560000
035700     DISPLAY '** SUKRP001-TOTAL P2L MIX EXTRACT RECORDS READ   : '03570000
035800             PV-P2L-EXT-REC-CNT.                                  03580000
035900     DISPLAY '                                                   '03590000
036000     DISPLAY '** SUKRP001-TOTAL P2L MIX DETAIL RECORDS WRITTEN : '03600000
036100             PV-DETAIL-LINE-COUNT.                                03610000
036200     DISPLAY '                                                   '03620000
036210     DISPLAY '** SUKRP001-TOTAL P2L MIX REPORT RECORDS WRITTEN : '03621000
036220             PV-P2L-RPT-REC-WRITTEN.                              03622000
036230     DISPLAY '                                                   '03623000
036240     DISPLAY '** PROGRAM SUKRP001 EXECUTION ENDED   **'.          03624000
036250*                                                                 03625000
036260     CLOSE  SU-P2L-MIX-EXTRACT-FILE                               03626000
036270            SU-P2L-MIX-REPORT-FILE                                03627000
036280            CONTROL-FILE.                                         03628000
036290*                                                                 03629000
036300******************************************************************03630000
036400* THIS PARAGRAPH READS THE CONTROL FILE INTO THE SURD032 FORMAT  *03640000
036500******************************************************************03650000
036600*                                                                 03660000
036700 7000-READ-CONTROL-REC.                                           03670000
036800                                                                  03680000
036900     READ CONTROL-FILE INTO                                       03690000
037000           SU032-DATE-CONTROL-REC                                 03700000
037100     AT END                                                       03710000
037200         CONTINUE                                                 03720000
037300     NOT AT END                                                   03730000
037400         DISPLAY 'DATE CONTROL CARD:'                             03740000
037500         DISPLAY SU032-DATE-CONTROL-REC                           03750000
037600         DISPLAY SPACES                                           03760000
037700     END-READ.                                                    03770000
037800                                                                  03780000
037900                                                                  03790000
038000******************************************************************03800000
038010* THIS PARAGRAPH READS THE INPUT IN SUWS058 LAYOUT               *03801000
038020******************************************************************03802000
038030*                                                                 03803000
038040 8000-READ-EXTRACT-FILE.                                          03804000
038050*                                                                 03805000
038060     READ SU-P2L-MIX-EXTRACT-FILE  INTO SU058-REC-DTL             03806000
038070         AT END                                                   03807000
038080            SET PS-EOF-P2L-MIX-EXTRACT TO TRUE                    03808000
038090         NOT AT END                                               03809000
038100            ADD +1 TO PV-P2L-EXT-REC-CNT                          03810000
038200     END-READ.                                                    03820000
038300*                                                                 03830000
038400******************************************************************03840000
038500* THIS PARAGRAPH WRITES THE P2L MIX REPORT IN REPORT LAYOUT.     *03850000
038600******************************************************************03860000
038700*                                                                 03870000
038800 8100-WRITE-P2L-MIX-RPT.                                          03880000
038900*                                                                 03890000
039000       WRITE SU-P2L-MIX-REPORT-LINE                               03900000
039100        FROM PV-P2L-MIX-RPT-LAYOUT                                03910000
039200         ADD +1 TO PV-P2L-RPT-REC-WRITTEN                         03920000
039300                   PV-LINE-COUNT.                                 03930000
039400*                                                                 03940000
039500******************************************************************03950000
039600*  THIS PARAGRAPH CREATES THE PAGE HEADING FOR THE P2L MIX REPORT*03960000
039700*  WHEN EVER 60 LINES PER PAGE IS PRINTED.                       *03970000
039800******************************************************************03980000
039900*                                                                 03990000
040000 8200-PRINT-PAGE-HEADING.                                         04000000
040100*                                                                 04010000
040200     MOVE ZEROES               TO PV-LINE-COUNT.                  04020000
040300     ADD 1                     TO PV-DETAIL-PAGE-COUNT.           04030000
040400     MOVE 1                    TO DP132O-REPORT-NUMBER.           04040000
040500     MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER.             04050000
040600*                                                                 04060000
040700     MOVE DP132O-STANDRD-HEADER-132-COLS                          04070000
040800                               TO PV-P2L-MIX-RPT-LAYOUT.          04080000
040900     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04090000
041000*                                                                 04100000
041100     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT.          04110000
041200     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04120000
041300*                                                                 04130000
041400     MOVE PH2-PAGE-HEADING-1   TO PV-P2L-MIX-RPT-LAYOUT.          04140000
041500     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04150000
041600*                                                                 04160000
041700     MOVE PH2-PAGE-HEADING-2   TO PV-P2L-MIX-RPT-LAYOUT.          04170000
041800     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04180000
041900*                                                                 04190000
042000     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT.          04200000
042100     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04210000
042200*                                                                 04220000
042300     MOVE PH2-PAGE-HEADING-2A  TO PV-P2L-MIX-RPT-LAYOUT.          04230000
042400     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04240000
042500*                                                                 04250000
042600     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT.          04260000
042700     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04270000
042800*                                                                 04280000
042900     MOVE PH2-PAGE-HEADING-3   TO PV-P2L-MIX-RPT-LAYOUT.          04290000
042910     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04291000
042920*                                                                 04292000
042930     MOVE PH2-PAGE-HEADING-4   TO PV-P2L-MIX-RPT-LAYOUT.          04293000
042940     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04294000
042950*                                                                 04295000
042960     MOVE PH2-PAGE-HEADING-5   TO PV-P2L-MIX-RPT-LAYOUT.          04296000
042970     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04297000
042980*                                                                 04298000
042990     MOVE PH2-PAGE-HEADING-6   TO PV-P2L-MIX-RPT-LAYOUT.          04299000
043000     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04300000
043100*                                                                 04310000
043200     MOVE BLANK-LINE           TO PV-P2L-MIX-RPT-LAYOUT.          04320000
043300     PERFORM 8100-WRITE-P2L-MIX-RPT.                              04330000
043400*                                                                 04340000
043500******************************************************************04350000
043600*  THIS PARAGRAPH CREATES THE DETAIL LINE FOR THE P2L MIX REPORT *04360000
043700*  WHEN EVER DC SEQUENCE CHANGES.                                *04370000
043800******************************************************************04380000
043900*                                                                 04390000
044000 8300-PRINT-DEATIL-LINE.                                          04400000
044100*                                                                 04410000
044200*    IF THE NUMBER OF LINES PRINTED REACHES THE MAXIMUM NUMBER OF 04420000
044300*    LINES CAN PRINTED PER PAGE THEN GOTO THE NEXT PAGE           04430000
044400*                                                                 04440000
044500      IF PV-LINE-COUNT > PC-MAX-REPORT-LINES                      04450000
044600         PERFORM 8200-PRINT-PAGE-HEADING                          04460000
044700      END-IF                                                      04470000
044800*                                                                 04480000
044900      MOVE PV-PREV-LOC-NBR       TO P2L-DC-NBR                    04490000
045000      MOVE PV-ZONE-1             TO P2L-1-ZONE                    04500000
045100      ADD  PV-ZONE-1             TO PV-ZONE-1-TOT                 04510000
045200      MOVE PV-ZONE-1-TOT         TO P2L-1-ZONE-TOT                04520000
045300      MOVE PV-ZONE-2             TO P2L-2-ZONE                    04530000
045400      ADD  PV-ZONE-2             TO PV-ZONE-2-TOT                 04540000
045500      MOVE PV-ZONE-2-TOT         TO P2L-2-ZONE-TOT                04550000
045600      MOVE PV-ZONE-3             TO P2L-3-ZONE                    04560000
045700      ADD  PV-ZONE-3             TO PV-ZONE-3-TOT                 04570000
045800      MOVE PV-ZONE-3-TOT         TO P2L-3-ZONE-TOT                04580000
045900      MOVE PV-ZONE-4             TO P2L-4-ZONE                    04590000
046000      ADD  PV-ZONE-4             TO PV-ZONE-4-TOT                 04600000
046100      MOVE PV-ZONE-4-TOT         TO P2L-4-ZONE-TOT                04610000
046200      MOVE PV-ZONE-GTE5          TO P2L-GTE5-ZONE                 04620000
046300      ADD  PV-ZONE-GTE5          TO PV-ZONE-GTE5-TOT              04630000
046400      MOVE PV-ZONE-GTE5-TOT      TO P2L-GTE5-ZONE-TOT             04640000
046500      MOVE PV-ZONE-TOT-CRTNS     TO P2L-TOT-CRTNS                 04650000
046600      ADD  PV-ZONE-TOT-CRTNS     TO PV-ZONE-TOT-CRTNS-TOT         04660000
046610      MOVE PV-ZONE-TOT-CRTNS-TOT TO P2L-TOT-CRTNS-TOT             04661000
046620      MOVE PV-PER-GREATER-2ZONE  TO P2L-PER-GT-2ZONE              04662000
046630      MOVE PV-PER-ONE-ZONE       TO P2L-PER-1ZONE                 04663000
046640      MOVE PV-PER-TWO-ZONE       TO P2L-PER-2ZONE                 04664000
046650      MOVE P2L-MIX-RPT-DETAIL-LINE                                04665000
046660                                 TO PV-P2L-MIX-RPT-LAYOUT         04666000
046670      PERFORM 8100-WRITE-P2L-MIX-RPT                              04667000
046680      ADD +1 TO PV-DETAIL-LINE-COUNT                              04668000
046690      INITIALIZE  P2L-MIX-RPT-DETAIL-LINE                         04669000
046700      MOVE ZEROES                TO PV-ZONE-1                     04670000
046800                                    PV-ZONE-2                     04680000
046900                                    PV-ZONE-3                     04690000
047000                                    PV-ZONE-4                     04700000
047100                                    PV-ZONE-GTE5                  04710000
047200                                    PV-ZONE-TOT-CRTNS             04720000
047300                                    PV-ZONE-GT2                   04730000
047400                                    PV-PER-GREATER-2ZONE          04740000
047500                                    PV-PER-ONE-ZONE               04750000
047600                                    PV-PER-TWO-ZONE               04760000
047700                                    PV-PER-1ZONE                  04770000
047800                                    PV-PER-2ZONE                  04780000
047900                                    PV-PER-GT-2ZONE.              04790000
048000*                                                                 04800000
