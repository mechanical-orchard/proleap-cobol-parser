000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             DPKIS002.                                00050007
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MAY 12, 1999.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM IS AN ISPF DIALOG TO EXERCISE CANNED QUERIES     *00120052
001300*  AGAINST THE CROSS-REFERENCE DB2 TABLES.  A BROWSABLE FILE     *00130052
001400*  WILL BE CREATED WITH FORMATTED QUERY RESULTS THAT IS ALSO     *00140000
001500*  PRINTABLE ON REQUEST.  TWO ISPF PANELS ARE DIRECTLY USED:     *00150046
001600*       CMNEKX0 - INPUT - CROSS REFERENCE QUERY REQUEST          *00160000
001700*       CMNEKX1 - OUTPUT - BROWSE CROSS REFERENCE QUERY RESULTS  *00170053
001900*  REQUESTS WILL BE PROCESSED UNTIL AN END IS REQUESTED FROM     *00190000
002000*  THE CROSS REFERENCE QUERY REQUEST PANEL.  REQUESTS WILL BE    *00200050
002010*  EDITED BY THE APPLICATION, AS APPROPRIATE, PRIOR TO QUERYING  *00201050
002011*  THE CROSS REFERENCE SYSTEM TABLES.  IF THE REQUEST PASSES     *00201150
002012*  LOCAL EDITS, THE HOST VARIABLES FOR THE QUERY WILL BE         *00201250
002013*  FORMATTED, RESULT FILE HEADER INFORMATION WRITTEN TO A        *00201350
002014*  RESULTS FILE, AND RESULTS DETAIL LINES FORMATTED AND WRITTEN  *00201450
002015*  TO THE RESULTS FILE FOR EACH RESULTS ROW.  IF THERE IS NO     *00201550
002016*  QUALIFYING DETAIL, THE CROSS REFERENCE QUERY REQUEST PANEL    *00201650
002017*  WILL BE REDISPLAYING WITH A RELATED INFORMATIONAL MESSAGE.    *00201750
002018*  IF THERE IS QUALIFYING DETAIL, CONTROL WILL BE PASSED TO      *00201850
002019*  ALLOW AN ISPF BROWSE OF THE RESULTS FILE.  THE BROWSE PANEL   *00201950
002020*  WILL REMAIN DISPLAYED UNTIL AN END IS REQUESTED FROM THE      *00202050
002021*  PANEL.  WHEN AN END (PF3) IS REQUESTED, CONTROL IS PASSED TO  *00202150
002100*  THE COMMON PRINT REQUEST PANEL, TO ALLOW THE BROWSED FILE TO  *00210050
002101*  BE PRINTED.  AFTER RESPONDING TO THE PRINT REQUEST, CONTROL   *00210150
002110*  IS RETURNED TO THE CROSS REFERENCE QUERY REQUEST PANEL.  THE  *00211050
002120*  PREVIOUS REQUEST WILL REMAIN IN THE REQUEST FIELDS.           *00212050
002400*                                                                *00240000
002401*  ALL CROSS-REFERENCE REQUESTS ASSUME WILDCARDING ON BOTH SIDES *00240153
002402*  OF THE HOST VARIABLES THAT ARE BUILT AS A PART OF THE QUERY   *00240253
002410*  REQUEST.                                                      *00241053
002420*                                                                *00242053
002430*  THE CURRENT QUERIES SUPPORTED ARE:                            *00243053
002440*      DATASET NAME WHERE USED (PROC-STEP-PROGRAM)               *00244053
002450*      PROGRAM WHERE USED (PROC-STEP)                            *00245053
002451*      COPYBOOK WHERE USED (PROGRAM)                             *00245153
002452*      COPYBOOKS USED BY PROGRAM (PROGRAM-COPYBOOK)              *00245253
002460*                                                                *00246053
002500*  THIS PROGRAM IS INVOKED VIA CLIST CMNEKX0, FROM THE E.K.X.    *00250000
002600*  (EXTENSIONS - KOHLS ONLINE DOCUMENTATION - CROSS REFERENCE    *00260000
002700*  LISTING) PANEL (CMNE300), OR UNDER THE ISPF CUSTOMIZATION     *00270001
002800*  OPTION "XREF" (WHICH ISSUES A CMD %CMNEKX0).                  *00280001
002900******************************************************************00290000
003000                                                                  00300000
003100******************************************************************00310000
003200 ENVIRONMENT DIVISION.                                            00320000
003300******************************************************************00330000
003400                                                                  00340000
003500 CONFIGURATION SECTION.                                           00350000
003600 SOURCE-COMPUTER.        IBM-3090.                                00360000
003700 OBJECT-COMPUTER.        IBM-3090.                                00370000
003800                                                                  00380002
003900 INPUT-OUTPUT SECTION.                                            00390002
004000                                                                  00400002
004100 FILE-CONTROL.                                                    00410002
004200                                                                  00420002
004300     SELECT XREF-RESULTS-FILE                                     00430005
004400         ASSIGN TO XREFDATA.                                      00440003
004800                                                                  00480000
004900******************************************************************00490000
005000 DATA DIVISION.                                                   00500000
005100******************************************************************00510000
005200                                                                  00520002
005300 FILE SECTION.                                                    00530002
005400                                                                  00540002
005500 FD  XREF-RESULTS-FILE                                            00550005
005600     RECORDING MODE IS F                                          00560002
005700     LABEL RECORDS ARE STANDARD                                   00570002
005800     BLOCK CONTAINS 0 RECORDS                                     00580002
005900     RECORD CONTAINS 80 CHARACTERS                                00590002
006000     DATA RECORD IS XR-XREF-RESULTS-RECORD.                       00600005
006100                                                                  00610002
006200 01  XR-XREF-RESULTS-RECORD      PIC X(80).                       00620005
007200                                                                  00720002
007300 WORKING-STORAGE SECTION.                                         00730002
007400                                                                  00740000
007500*                                                                 00750000
007600*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              00760002
007700*                                                                 00770000
007800     COPY DPWS023.                                                00780002
007801                                                                  00780142
007802*                                                                 00780242
007803*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                00780342
007804*                                                                 00780442
007810     COPY DPWS300.                                                00781042
007900                                                                  00790000
008000 01  PS-PROGRAM-SWITCHES.                                         00800000
008100     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          00810005
008200         88  PS-EDIT-ERROR                    VALUE 'Y'.          00820004
008300         88  PS-NO-EDIT-ERRORS                VALUE 'N'.          00830004
008400     05  PS-XREF-RESULTS-FILE-ALLOC-IND                           00840005
008500                                 PIC X(1)     VALUE 'N'.          00850005
008600         88  PS-XREF-RESULTS-ALLOCATED        VALUE 'Y'.          00860005
008700         88  PS-XREF-RESULTS-NOT-ALLOCATED    VALUE 'N'.          00870005
009200                                                                  00920000
009300 01  PC-PROGRAM-CONSTANTS.                                        00930000
009400     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'DPKIS002'.   00940005
009500     05  PC-CNTL-DSN-QUALIFIER   PIC X(5)     VALUE '.CNTL'.      00950014
009600     05  PC-XREF-DSN-QUALIFIER   PIC X(5)     VALUE '.XREF'.      00960014
009700     05  PC-DSN-QUALIFIER-SEP    PIC X(1)     VALUE '.'.          00970016
009800     05  PC-MAXIMUM-RETRY-COUNT  PIC S9(4)    VALUE +2            00980014
009900                                              COMP SYNC.          00990014
010600     05  PC-XREF-RESULTS-DDNAME  PIC X(8)     VALUE 'XREFDATA'.   01060014
010700     05  PC-XREF-RESULTS-RECORD-COUNT                             01070014
010800                                 PIC 9(7)     VALUE 10000.        01080039
011400     05  PC-WILDCARD-REPEAT      PIC X(2)     VALUE '%%'.         01140031
011401     05  PC-TYPE-CODE.                                            01140138
011410         10  PC-TC-DB2-DCLGEN    PIC X(1)     VALUE 'D'.          01141038
011420         10  PC-TC-ORACLE-DCLGEN PIC X(1)     VALUE 'O'.          01142038
011440         10  PC-TC-UNKNOWN-SQL   PIC X(1)     VALUE 'U'.          01144038
011460         10  PC-TC-BMS-MAPDSECT  PIC X(1)     VALUE 'M'.          01146038
011480         10  PC-TC-SQL-SYSTEM-COPY                                01148038
011490                                 PIC X(1)     VALUE 'S'.          01149038
011491         10  PC-TC-CICS-SYSTEM-COPY                               01149138
011492                                 PIC X(1)     VALUE 'C'.          01149238
011493         10  PC-TC-NORMAL-COPY   PIC X(1)     VALUE SPACES.       01149338
011495     05  PC-STNDRD-CODE.                                          01149538
011496         10  PC-SC-COBOL         PIC X(1)     VALUE 'C'.          01149638
011497         10  PC-SC-ASSEMBLER     PIC X(1)     VALUE 'A'.          01149738
011498         10  PC-SC-DYL-280       PIC X(1)     VALUE 'D'.          01149838
011500     05  PC-SUCCESSFUL-SQLCODE   PIC S9(9)    VALUE ZEROS         01150010
011600                                              COMP SYNC.          01160010
011700     05  PC-END-OF-CURSOR-SQLCODE                                 01170010
011800                                 PIC S9(9)    VALUE +100          01180010
011900                                              COMP SYNC.          01190010
012000     05  PC-ROW-NOT-FOUND-SQLCODE                                 01200010
012100                                 PIC S9(9)    VALUE +100          01210010
012200                                              COMP SYNC.          01220010
012300     05  PC-RESOURCE-NOT-AVAIL-SQLCODE                            01230010
012400                                 PIC S9(9)    VALUE -904          01240010
012500                                              COMP SYNC.          01250010
012600     05  PC-DEADLOCK-W-ROLLBCK-SQLCODE                            01260010
012700                                 PIC S9(9)    VALUE -911          01270010
012800                                              COMP SYNC.          01280010
012900     05  PC-DEADLOCK-WO-ROLLBCK-SQLCODE                           01290010
013000                                 PIC S9(9)    VALUE -913          01300010
013100                                              COMP SYNC.          01310031
013200                                                                  01320000
013300 01  PV-PROGRAM-VARIABLES.                                        01330000
013400     05  PV-RETRY-COUNT          PIC S9(4)    VALUE ZEROS         01340010
013500                                              COMP SYNC.          01350010
013600     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         01360013
013700                                              COMP SYNC.          01370013
013800     05  PV-START-LOCATION       PIC S9(4)    VALUE ZEROS         01380013
013900                                              COMP SYNC.          01390013
014000     05  PV-RESULTS-DETAIL-RCDS-WRITTEN                           01400014
014100                                 PIC S9(9)    VALUE ZEROS         01410014
014200                                              COMP-3.             01420014
014300     05  PV-REPORT-NUMBER        PIC 9(1)     VALUE ZEROS.        01430051
014301         88  PV-DSN-WHERE-USED                VALUE 1.            01430151
014302         88  PV-PROGRAM-WHERE-USED            VALUE 2.            01430251
014303         88  PV-COPYBOOK-WHERE-USED           VALUE 3.            01430351
014304         88  PV-COPYBOOKS-USED-BY-PROGRAM     VALUE 4.            01430451
014320     05  PV-XREF-RESULTS-DSN     PIC X(44)    VALUE SPACES.       01432051
014400     05  PV-XREF-RESULTS-DSN-WO-USERID                            01440005
014500                                 PIC X(44)    VALUE SPACES.       01450005
014600     05  PV-XREF-RESULTS-VOLUME  PIC X(6)     VALUE SPACES.       01460029
014700     05  PV-XREF-RESULTS-PASSWORD                                 01470029
014800                                 PIC X(8)     VALUE SPACES.       01480029
014900     05  PV-WILDCARDED-FILE-NAME PIC X(44)    VALUE SPACES.       01490011
015000         88  PV-WFN-MASK                      VALUE ALL '%'.      01500031
015100     05  PV-WILDCARDED-PGM-NAME  PIC X(8)     VALUE SPACES.       01510011
015200         88  PV-WPN-MASK                      VALUE ALL '%'.      01520031
015210     05  PV-WILDCARDED-COPY-NAME PIC X(8)     VALUE SPACES.       01521036
015220         88  PV-WCN-MASK                      VALUE ALL '%'.      01522036
015300     05  PV-LEFT-JUST-WORK-AREA  PIC X(44)    VALUE SPACES.       01530012
015310     05  PV-HEADING-LINE-COUNT   PIC 9(2)     VALUE ZERO.         01531046
015400     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             01540016
015500         10  FILLER              PIC X(13)    VALUE               01550017
015600             'DYNALC ERROR '.                                     01560016
015700         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        01570017
015800         10  FILLER              PIC X(2)     VALUE '; '.         01580019
015900         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       01590017
016000         10  FILLER              PIC X(5)     VALUE ' DD; '.      01600019
016100         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       01610017
016200     05  PV-DB2-ERROR-MESSAGE.                                    01620016
016300         10  FILLER              PIC X(10)    VALUE 'DB2 ERROR '. 01630017
016400         10  PV-DE-SQLCODE       PIC 999-     VALUE ZEROS.        01640017
016500         10  FILLER              PIC X(14)    VALUE               01650017
016600             ' LAST ACTION: '.                                    01660016
016700         10  PV-DE-LAST-DB2-ACTION                                01670017
016800                                 PIC X(41)    VALUE SPACES.       01680016
016900             88  PV-OPEN-DSN-CURSOR           VALUE               01690016
017000                 'OPEN THE DSN CURSOR (TP1PROC/TP1PROST) '.       01700016
017100             88  PV-FETCH-DSN-ROW             VALUE               01710016
017200                 'FETCH A ROW FROM THE DSN CURSOR        '.       01720016
017300             88  PV-CLOSE-DSN-CURSOR          VALUE               01730016
017400                 'CLOSE THE DSN CURSOR (TP1PROC/TP1PROST)'.       01740016
017500             88  PV-OPEN-PGM-CURSOR           VALUE               01750016
017600                 'OPEN THE PGM CURSOR (TP1PROST/TP1PGM)  '.       01760016
017700             88  PV-FETCH-PGM-ROW             VALUE               01770016
017800                 'FETCH A ROW FROM THE PGM CURSOR        '.       01780016
017900             88  PV-CLOSE-PGM-CURSOR          VALUE               01790016
018000                 'CLOSE THE PGM CURSOR (TP1PROST/TP1PGM) '.       01800016
018010             88  PV-OPEN-COPY-CURSOR          VALUE               01801036
018020                 'OPEN THE COPY CURSOR (TP1PGMCP/TP1PGM) '.       01802036
018030             88  PV-FETCH-COPY-ROW            VALUE               01803036
018040                 'FETCH A ROW FROM THE COPY CURSOR       '.       01804036
018050             88  PV-CLOSE-COPY-CURSOR         VALUE               01805036
018060                 'CLOSE THE COPY CURSOR (TP1PGMCP/TP1PGM)'.       01806036
018070             88  PV-OPEN-PGM-COPY-CURSOR      VALUE               01807036
018080                 'OPEN THE PGM COPY CURSOR (TP1PGMCP)    '.       01808036
018090             88  PV-FETCH-PGM-COPY-ROW        VALUE               01809036
018091                 'FETCH A ROW FROM THE PGM COPY CURSOR   '.       01809136
018092             88  PV-CLOSE-PGM-COPY-CURSOR     VALUE               01809236
018093                 'CLOSE THE PGM COPY CURSOR (TP1PGMCP)   '.       01809336
018100                                                                  01810022
018200 01  CK-CURRENT-KEY-AREA.                                         01820022
018300     05  CK-CURRENT-FILE-NAME    PIC X(44)    VALUE SPACES.       01830022
018400     05  CK-CURRENT-PGM-NAME     PIC X(8)     VALUE SPACES.       01840012
018410     05  CK-CURRENT-COPY-NAME    PIC X(8)     VALUE SPACES.       01841036
018500                                                                  01850002
018600 01  HL1DR-HEADING-LINE-1.                                        01860012
018700     05  FILLER                  PIC X(23)    VALUE SPACES.       01870012
018800     05  FILLER                  PIC X(35)    VALUE               01880012
018900        'DSN WHERE USED CROSS REFERENCE LIST'.                    01890012
019000     05  FILLER                  PIC X(22)    VALUE SPACES.       01900012
019100                                                                  01910013
019200 01  HL2DR-HEADING-LINE-2.                                        01920013
019300     05  FILLER                  PIC X(17)    VALUE               01930013
019400        'DSN SEARCH FOR:'.                                        01940013
019500     05  HL2DR-WILDCARDED-FILE-NAME                               01950013
019600                                 PIC X(44)    VALUE SPACES.       01960013
019700     05  FILLER                  PIC X(19)    VALUE SPACES.       01970013
019800                                                                  01980013
019900 01  HL3DR-HEADING-LINE-3.                                        01990013
020000     05  FILLER                  PIC X(15)    VALUE SPACES.       02000013
020100     05  FILLER                  PIC X(13)    VALUE               02010013
020200         'DATA SET NAME'.                                         02020013
020300     05  FILLER                  PIC X(16)    VALUE SPACES.       02030013
020400     05  FILLER                  PIC X(4)     VALUE SPACES.       02040013
020500     05  FILLER                  PIC X(8)     VALUE 'PROC'.       02050013
020600     05  FILLER                  PIC X(4)     VALUE SPACES.       02060013
020700     05  FILLER                  PIC X(8)     VALUE 'STEP'.       02070013
020800     05  FILLER                  PIC X(4)     VALUE SPACES.       02080013
020900     05  FILLER                  PIC X(8)     VALUE 'PROGRAM'.    02090013
021000                                                                  02100013
021100 01  HL4DR-HEADING-LINE-4.                                        02110013
021200     05  FILLER                  PIC X(44)    VALUE ALL '-'.      02120013
021300     05  FILLER                  PIC X(4)     VALUE SPACES.       02130013
021400     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02140013
021500     05  FILLER                  PIC X(4)     VALUE SPACES.       02150013
021600     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02160013
021700     05  FILLER                  PIC X(4)     VALUE SPACES.       02170013
021800     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02180013
021900                                                                  02190013
022000 01  DLDR-DETAIL-LINE.                                            02200013
022100     05  DLDR-FILE-NAME          PIC X(44)    VALUE SPACES.       02210014
022200     05  FILLER                  PIC X(4)     VALUE SPACES.       02220013
022300     05  DLDR-PROC-NAME          PIC X(8)     VALUE SPACES.       02230013
022400     05  FILLER                  PIC X(4)     VALUE SPACES.       02240013
022500     05  DLDR-PROC-STEP-NAME     PIC X(8)     VALUE SPACES.       02250013
022600     05  FILLER                  PIC X(4)     VALUE SPACES.       02260013
022700     05  DLDR-PGM-NAME           PIC X(8)     VALUE SPACES.       02270013
022800                                                                  02280013
022900 01  HL1PR-HEADING-LINE-1.                                        02290013
023000     05  FILLER                  PIC X(23)    VALUE SPACES.       02300013
023100     05  FILLER                  PIC X(34)    VALUE               02310013
023200        'PROGRAM WHERE USED CROSS REFERENCE'.                     02320013
023300     05  FILLER                  PIC X(23)    VALUE SPACES.       02330013
023400                                                                  02340013
023500 01  HL2PR-HEADING-LINE-2.                                        02350013
023600     05  FILLER                  PIC X(21)    VALUE               02360013
023700        'PROGRAM SEARCH FOR:'.                                    02370013
023800     05  HL2PR-WILDCARDED-PGM-NAME                                02380014
023900                                 PIC X(8)     VALUE SPACES.       02390013
024000     05  FILLER                  PIC X(51)    VALUE SPACES.       02400013
024100                                                                  02410013
024200 01  HL3PR-HEADING-LINE-3.                                        02420013
024300     05  FILLER                  PIC X(8)     VALUE 'PROGRAM'.    02430013
024400     05  FILLER                  PIC X(2)     VALUE SPACES.       02440013
024500     05  FILLER                  PIC X(8)     VALUE 'PROC'.       02450013
024600     05  FILLER                  PIC X(2)     VALUE SPACES.       02460013
024700     05  FILLER                  PIC X(8)     VALUE 'STEP'.       02470013
024800     05  FILLER                  PIC X(15)    VALUE SPACES.       02480013
024900     05  FILLER                  PIC X(19)    VALUE               02490013
025000         'PROGRAM DESCRIPTION'.                                   02500013
025100     05  FILLER                  PIC X(16)    VALUE SPACES.       02510013
025200                                                                  02520013
025300 01  HL4PR-HEADING-LINE-4.                                        02530013
025400     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02540013
025500     05  FILLER                  PIC X(2)     VALUE SPACES.       02550013
025600     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02560013
025700     05  FILLER                  PIC X(2)     VALUE SPACES.       02570013
025800     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02580013
025900     05  FILLER                  PIC X(2)     VALUE SPACES.       02590013
026000     05  FILLER                  PIC X(50)    VALUE ALL '-'.      02600013
026100                                                                  02610013
026200 01  DLPR-DETAIL-LINE.                                            02620013
026300     05  DLPR-PGM-NAME           PIC X(8)     VALUE SPACES.       02630013
026400     05  FILLER                  PIC X(2)     VALUE SPACES.       02640013
026500     05  DLPR-PROC-NAME          PIC X(8)     VALUE SPACES.       02650013
026600     05  FILLER                  PIC X(2)     VALUE SPACES.       02660013
026700     05  DLPR-PROC-STEP-NAME     PIC X(8)     VALUE SPACES.       02670013
026800     05  FILLER                  PIC X(2)     VALUE SPACES.       02680013
026900     05  DLPR-PGM-DESC           PIC X(50)    VALUE SPACES.       02690013
026910                                                                  02691036
026920 01  HL1CR-HEADING-LINE-1.                                        02692036
026930     05  FILLER                  PIC X(23)    VALUE SPACES.       02693036
026940     05  FILLER                  PIC X(35)    VALUE               02694036
026950        'COPYBOOK WHERE USED CROSS REFERENCE'.                    02695036
026960     05  FILLER                  PIC X(22)    VALUE SPACES.       02696036
026970                                                                  02697036
026980 01  HL2CR-HEADING-LINE-2.                                        02698036
026990     05  FILLER                  PIC X(22)    VALUE               02699036
026991        'COPYBOOK SEARCH FOR:'.                                   02699136
026992     05  HL2CR-WILDCARDED-COPY-NAME                               02699236
026993                                 PIC X(8)     VALUE SPACES.       02699336
026994     05  FILLER                  PIC X(50)    VALUE SPACES.       02699436
026995                                                                  02699536
026996 01  HL3CR-HEADING-LINE-3.                                        02699636
026997     05  FILLER                  PIC X(8)     VALUE 'COPYBOOK'.   02699736
026998     05  FILLER                  PIC X(7)     VALUE SPACES.       02699836
026999     05  FILLER                  PIC X(8)     VALUE 'PROGRAM'.    02699936
027000     05  FILLER                  PIC X(7)     VALUE SPACES.       02700036
027003     05  FILLER                  PIC X(50)    VALUE               02700336
027004         'PROGRAM DESCRIPTION'.                                   02700436
027006                                                                  02700636
027007 01  HL4CR-HEADING-LINE-4.                                        02700736
027008     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02700836
027009     05  FILLER                  PIC X(7)     VALUE SPACES.       02700936
027010     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02701036
027011     05  FILLER                  PIC X(7)     VALUE SPACES.       02701136
027014     05  FILLER                  PIC X(50)    VALUE ALL '-'.      02701436
027015                                                                  02701536
027016 01  DLCR-DETAIL-LINE.                                            02701636
027017     05  DLCR-COPY-NAME          PIC X(8)     VALUE SPACES.       02701736
027018     05  FILLER                  PIC X(7)     VALUE SPACES.       02701836
027019     05  DLCR-PGM-NAME           PIC X(8)     VALUE SPACES.       02701936
027020     05  FILLER                  PIC X(7)     VALUE SPACES.       02702036
027023     05  DLCR-PGM-DESC           PIC X(50)    VALUE SPACES.       02702336
027024                                                                  02702436
027025 01  HL1PC-HEADING-LINE-1.                                        02702536
027026     05  FILLER                  PIC X(28)    VALUE SPACES.       02702636
027027     05  FILLER                  PIC X(25)    VALUE               02702736
027028        'COPYBOOKS USED BY PROGRAM'.                              02702836
027029     05  FILLER                  PIC X(27)    VALUE SPACES.       02702936
027030                                                                  02703036
027031 01  HL2PC-HEADING-LINE-2.                                        02703136
027032     05  FILLER                  PIC X(21)    VALUE               02703236
027033        'PROGRAM SEARCH FOR:'.                                    02703336
027034     05  HL2PC-WILDCARDED-PGM-NAME                                02703436
027035                                 PIC X(8)     VALUE SPACES.       02703536
027036     05  FILLER                  PIC X(51)    VALUE SPACES.       02703636
027037                                                                  02703736
027038 01  HL3PC-HEADING-LINE-3.                                        02703836
027039     05  FILLER                  PIC X(8)     VALUE 'PROGRAM'.    02703936
027040     05  FILLER                  PIC X(13)    VALUE SPACES.       02704036
027041     05  FILLER                  PIC X(8)     VALUE 'COPYBOOK'.   02704136
027042     05  FILLER                  PIC X(18)    VALUE SPACES.       02704236
027043     05  FILLER                  PIC X(4)     VALUE 'TYPE'.       02704336
027044     05  FILLER                  PIC X(19)    VALUE SPACES.       02704436
027045     05  FILLER                  PIC X(10)    VALUE 'LANGUAGE'.   02704536
027048                                                                  02704836
027049 01  HL4PC-HEADING-LINE-4.                                        02704936
027050     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02705036
027051     05  FILLER                  PIC X(13)    VALUE SPACES.       02705136
027052     05  FILLER                  PIC X(8)     VALUE ALL '-'.      02705236
027053     05  FILLER                  PIC X(13)    VALUE SPACES.       02705336
027054     05  FILLER                  PIC X(15)    VALUE ALL '-'.      02705436
027055     05  FILLER                  PIC X(13)    VALUE SPACES.       02705536
027056     05  FILLER                  PIC X(10)    VALUE ALL '-'.      02705636
027057                                                                  02705736
027058 01  DLPC-DETAIL-LINE.                                            02705836
027059     05  DLPC-PGM-NAME           PIC X(8)     VALUE SPACES.       02705936
027060     05  FILLER                  PIC X(13)    VALUE SPACES.       02706036
027061     05  DLPC-COPY-NAME          PIC X(8)     VALUE SPACES.       02706136
027062     05  FILLER                  PIC X(13)    VALUE SPACES.       02706236
027063     05  DLPC-TYPE-DESC          PIC X(15)    VALUE SPACES.       02706336
027064         88  DLPC-TD-DB2-DCLGEN               VALUE 'DB2 DCLGEN'. 02706438
027065         88  DLPC-TD-ORACLE-DCLGEN            VALUE               02706538
027066             'ORACLE DCLGEN'.                                     02706638
027067         88  DLPC-TD-UNKNOWN-SQL              VALUE               02706738
027068             'UNKNOWN SQL REF'.                                   02706838
027069         88  DLPC-TD-BMS-MAPDSECT             VALUE               02706938
027070             'BMS MAP DSECT'.                                     02707038
027071         88  DLPC-TD-SQL-SYSTEM-COPY          VALUE               02707138
027072             'SQL SYSTEM CPY'.                                    02707238
027073         88  DLPC-TD-CICS-SYSTEM-COPY         VALUE               02707338
027074             'CICS SYSTEM CPY'.                                   02707438
027075         88  DLPC-TD-NORMAL-COPYBOOK          VALUE SPACES.       02707538
027076         88  DLPC-TD-UNKNOWN-TYPE             VALUE               02707638
027077             'UNKNOWN TYPE??'.                                    02707738
027078     05  FILLER                  PIC X(13)    VALUE SPACES.       02707838
027079     05  DLPC-LANGUAGE-DESC      PIC X(10)    VALUE SPACES.       02707938
027080         88  DLPC-LD-COBOL                    VALUE 'COBOL'.      02708038
027081         88  DLPC-LD-ASSEMBLER                VALUE 'ASSEMBLER'.  02708138
027082         88  DLPC-LD-DYL-280                  VALUE 'DYL-280'.    02708238
027083         88  DLPC-LD-UNKNOWN-LANGUAGE         VALUE 'UNK LANG??'. 02708338
027090                                                                  02709038
027100***************************************************************   02710002
027200*  ISPF CONSTANTS                                                 02720002
027300***************************************************************   02730002
027400 01  IC-ISPF-CONSTANTS.                                           02740002
027500     05  IC-ISPF-SERVICE-LINK    PIC X(8)     VALUE 'ISPLINK'.    02750006
027600     05  IC-MISC-SERVICE-CONTROL PIC X(8)     VALUE 'CONTROL'.    02760006
027700     05  IC-DISPLAY-SERVICE-DISPLAY                               02770006
027800                                 PIC X(8)     VALUE 'DISPLAY'.    02780006
027900     05  IC-DISPLAY-SERVICE-ADDPOP                                02790006
028000                                 PIC X(8)     VALUE 'ADDPOP'.     02800006
028100     05  IC-DISPLAY-SERVICE-REMPOP                                02810006
028200                                 PIC X(8)     VALUE 'REMPOP'.     02820006
028300     05  IC-PDF-SERVICE-BROWSE   PIC X(8)     VALUE 'BROWSE'.     02830006
028400     05  IC-REFRESH-STATEMENT    PIC X(8)     VALUE 'REFRESH'.    02840006
028500*                                                                 02850004
028600*  DEFINE VARIABLES TO ISPF THROUGH THE FUNCTION POOL             02860004
028700*                                                                 02870004
028800     05  IC-VARIABLE-SERVICE-VDEFINE                              02880006
028900                                 PIC X(8)     VALUE 'VDEFINE'.    02890004
029000*                                                                 02900004
029100*  RETRIEVE VARIABLES FROM THE SHARED POOL OR PROFILE POOL        02910004
029200*                                                                 02920004
029300     05  IC-VARIABLE-SERVICE-VGET                                 02930006
029400                                 PIC X(8)     VALUE 'VGET'.       02940006
029500*                                                                 02950004
029600*  UPDATE VARIABLES IN THE SHARED POOL OR PROFILE POOL            02960004
029700*                                                                 02970004
029800     05  IC-VARIABLE-SERVICE-VPUT                                 02980006
029900                                 PIC X(8)     VALUE 'VPUT'.       02990006
030000*                                                                 03000004
030100     05  IC-FIELD-FORMAT-CHAR    PIC X(8)     VALUE 'CHAR'.       03010004
030200     05  IC-SHARED-VARIABLE-POOL PIC X(8)     VALUE 'SHARED'.     03020004
030500                                                                  03050000
030600 01  IV-ISPF-VARIABLES.                                           03060000
030700***************************************************************   03070000
030800*  CURSOR POSITIONING IS ACTIVATED ON THE DISPLAY OF THE PANEL.   03080000
030900*  THE FIELD NAME (SEE RELATED ISPF CONSTANTS) IS USED BY ISPF    03090000
031000*  TO SPECIFY CURSOR POSITIONING.                                 03100000
031100***************************************************************   03110000
031200     05  IV-CURSOR-POSITION      PIC X(8)     VALUE SPACE.        03120004
031300     05  IV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         03130004
031400                                              COMP SYNC.          03140004
031500     05  IV-ERROR-MESSAGE-FORMAT PIC X(8)     VALUE SPACES.       03150004
031600         88  IV-EM-DYNAMIC-SHORT-LONG-MSG     VALUE 'CMN000  '.   03160004
031700                                                                  03170000
031800***************************************************************   03180000
031900*  NAMED CONSTANTS FOR ALL PANELS AND DIALOG VARIABLES.           03190000
032000***************************************************************   03200000
032100 01  IN-ISPF-NAMED-DIALOG-VARIABLES.                              03210000
032200***************************************************************   03220000
032300*  PANEL NAMES                                                    03230000
032400***************************************************************   03240000
032500     05  IN-PANEL-CMNEKX0        PIC X(8)     VALUE 'CMNEKX0'.    03250004
032600     05  IN-PANEL-CMNEKX1        PIC X(8)     VALUE 'CMNEKX1'.    03260004
032800***************************************************************   03280000
032900*  DIALOG VARIABLE NAMES COMMON TO ALL PANELS                     03290000
033000*  - ZCMD IS A SYSTEM VARIABLE                                    03300000
033100***************************************************************   03310000
033200     05  IN-FIELD-COMMAND-LINE   PIC X(8)     VALUE 'ZCMD'.       03320004
033300     05  IN-FIELD-SHORT-MESSAGE  PIC X(8)     VALUE 'SMSG'.       03330004
033400     05  IN-FIELD-LONG-MESSAGE   PIC X(8)     VALUE 'LMSG'.       03340004
033500***************************************************************   03350004
033600*  SHARED POOL VARIABLES                                          03360004
033700***************************************************************   03370004
033800     05  IN-FIELD-ISPF-TEMP-FILE-DSN                              03380004
033900                                 PIC X(8)     VALUE 'ZTEMPF'.     03390004
034500***************************************************************   03450000
034600*  CMNEKX0 PANEL DIALOG VARIABLE NAMES                            03460002
034700***************************************************************   03470000
034800     05  IN-FIELD-CMNEKXOP       PIC X(8)     VALUE 'CMNEKXOP'.   03480036
034810     05  IN-FIELD-CMNEKXDS       PIC X(8)     VALUE 'CMNEKXDS'.   03481036
034900     05  IN-FIELD-CMNEKXPG       PIC X(8)     VALUE 'CMNEKXPG'.   03490036
034910     05  IN-FIELD-CMNEKXCP       PIC X(8)     VALUE 'CMNEKXCP'.   03491036
035500                                                                  03550000
035600 01  ID-ISPF-DIALOG-VARIABLES.                                    03560000
035700     05  ID-SHORT-MESSAGE        PIC X(24)    VALUE SPACES.       03570004
035800     05  ID-LONG-MESSAGE         PIC X(72)    VALUE SPACES.       03580004
035900     05  ID-ISPF-TEMP-FILE-DSN   PIC X(44)    VALUE SPACES.       03590004
036000     05  ID-CMNEKX0-VARIABLES.                                    03600002
036100         10  ID-CMNEKX0-CMNEKXOP PIC X(1)     VALUE SPACES.       03610036
036101             88  ID-CMNEKX0-CMNEKXOP-VALID    VALUE '1', '2',     03610136
036102                                                    '3', '4'.     03610236
036103             88  ID-CMNEKX0-CMNEKXOP-DSN-USED VALUE '1'.          03610336
036104             88  ID-CMNEKX0-CMNEKXOP-PGM-USED VALUE '2'.          03610436
036105             88  ID-CMNEKX0-CMNEKXOP-CPY-USED VALUE '3'.          03610536
036106             88  ID-CMNEKX0-CMNEKXOP-PGM-COPY VALUE '4'.          03610636
036110         10  ID-CMNEKX0-CMNEKXDS PIC X(44)    VALUE SPACES.       03611036
036200         10  ID-CMNEKX0-CMNEKXPG PIC X(8)     VALUE SPACES.       03620036
036210         10  ID-CMNEKX0-CMNEKXCP PIC X(8)     VALUE SPACES.       03621036
036700                                                                  03670002
036800*                                                                 03680002
036900*  SQL AND COBOL DECLARATIONS FOR THE CROSS REFERENCE SYSTEM      03690002
037000*  PROC STEP TO FILE ASSOCIATION TABLE (TP1PROC)                  03700002
037100*                                                                 03710002
037200                                                                  03720002
037300     EXEC SQL                                                     03730002
037400         INCLUDE TP1PROC                                          03740002
037500     END-EXEC.                                                    03750002
037600                                                                  03760002
037700*                                                                 03770002
037800*  SQL AND COBOL DECLARATIONS FOR THE CROSS REFERENCE SYSTEM      03780002
037900*  PROC STEP TO PROGRAM ASSOCIATION TABLE (TP1PROST)              03790002
038000*                                                                 03800002
038100                                                                  03810002
038200     EXEC SQL                                                     03820002
038300         INCLUDE TP1PROST                                         03830002
038400     END-EXEC.                                                    03840002
038500                                                                  03850002
038600*                                                                 03860002
038700*  SQL AND COBOL DECLARATIONS FOR THE CROSS REFERENCE SYSTEM      03870002
038800*  PROGRAM TABLE (TP1PGM)                                         03880002
038900*                                                                 03890002
039000                                                                  03900002
039100     EXEC SQL                                                     03910002
039200         INCLUDE TP1PGM                                           03920002
039300     END-EXEC.                                                    03930002
039400                                                                  03940002
039500*                                                                 03950002
039600*  SQL AND COBOL DECLARATIONS FOR THE CROSS REFERENCE SYSTEM      03960002
039700*  PROGRAM-COPYBOOK ASSOCIATION TABLE (TP1PGMCP)                  03970002
039800*                                                                 03980002
039900                                                                  03990002
040000     EXEC SQL                                                     04000002
040100         INCLUDE TP1PGMCP                                         04010002
040200     END-EXEC.                                                    04020002
040210                                                                  04021036
040220*                                                                 04022036
040230*  SQL AND COBOL DECLARATIONS FOR THE CROSS REFERENCE SYSTEM      04023036
040240*  COPYBOOK TABLE (TP1COPY)                                       04024036
040250*                                                                 04025036
040260                                                                  04026036
040270     EXEC SQL                                                     04027036
040280         INCLUDE TP1COPY                                          04028036
040290     END-EXEC.                                                    04029036
040300                                                                  04030002
040400*                                                                 04040002
040500*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                04050002
040600*                                                                 04060002
040700                                                                  04070002
040800     EXEC SQL                                                     04080002
040900         INCLUDE SQLCA                                            04090002
041000     END-EXEC.                                                    04100002
041100                                                                  04110002
041200*                                                                 04120002
041300*  CURSOR USED TO RETRIEVE ALL PROC STEP ROWS CONTAINING A        04130002
041400*  REFERENCE TO THE WILDCARDED FILE NAME SPECIFIED.               04140011
041500*                                                                 04150002
041600                                                                  04160002
041700     EXEC SQL                                                     04170002
041800         DECLARE DSN_CURSOR CURSOR FOR                            04180002
041900             SELECT PR.PROC_NAME,                                 04190002
042000                    PR.PROC_STEP_NAME,                            04200002
042100                    PR.FILE_NAME,                                 04210002
042200                    PS.PGM_NAME                                   04220002
042300                 FROM TP1PROC PR,                                 04230002
042400                      TP1PROST PS                                 04240002
042500                 WHERE ((PR.FILE_NAME LIKE                        04250002
042600                               :PV-WILDCARDED-FILE-NAME)       AND04260011
042700                       (PR.PROC_NAME = PS.PROC_NAME)           AND04270002
042800                       (PR.PROC_STEP_NAME = PS.PROC_STEP_NAME))   04280002
042900                 ORDER BY PR.FILE_NAME,                           04290002
043000                          PR.PROC_NAME,                           04300002
043100                          PR.PROC_STEP_NAME                       04310002
043200     END-EXEC.                                                    04320002
043300                                                                  04330002
043400*                                                                 04340002
043500*  CURSOR USED TO RETRIEVE ALL PROC STEP ROWS CONTAINING A        04350002
043600*  REFERENCE TO THE WILDCARDED PROGRAM NAME SPECIFIED.            04360011
043700*                                                                 04370002
043800                                                                  04380002
043900     EXEC SQL                                                     04390002
044000         DECLARE PGM_CURSOR CURSOR FOR                            04400002
044100             SELECT PS.PROC_NAME,                                 04410002
044200                    PS.PROC_STEP_NAME,                            04420002
044300                    PS.PGM_NAME,                                  04430014
044400                    PG.PGM_DESC                                   04440002
044500                 FROM TP1PROST PS,                                04450002
044600                      TP1PGM PG                                   04460002
044700                 WHERE ((PS.PGM_NAME LIKE                         04470002
044800                               :PV-WILDCARDED-PGM-NAME)        AND04480011
044900                       (PS.PGM_NAME = PG.PGM_NAME))               04490002
045000                 ORDER BY PS.PGM_NAME,                            04500002
045100                          PS.PROC_NAME,                           04510002
045200                          PS.PROC_STEP_NAME                       04520002
045300     END-EXEC.                                                    04530002
045310                                                                  04531036
045320*                                                                 04532036
045330*  CURSOR USED TO RETRIEVE ALL PROGRAM/COPYBOOK ROWS CONTAINING A 04533036
045340*  REFERENCE TO THE WILDCARDED COPYBOOK NAME SPECIFIED.  THIS     04534055
045341*  INCLUDES A LEFT JOIN TO GET ALL COPY REFERENCES, EVEN IF THE   04534155
045342*  PROGRAM IS NOT ACTIVELY USED, AND THEREFORE NOT ON THE PROGRAM 04534255
045350*  TABLE.                                                         04535055
045351*                                                                 04535155
045360                                                                  04536036
045370     EXEC SQL                                                     04537036
045380         DECLARE COPY_CURSOR CURSOR FOR                           04538036
045390             SELECT PC.COPY_NAME,                                 04539036
045391                    PC.PGM_NAME,                                  04539136
045393                    COALESCE(PG.PGM_DESC, ' ** NOT REFERENCED **')04539355
045394                 FROM TP1PGMCP PC LEFT JOIN                       04539455
045395                      TP1PGM PG                                   04539536
045396                 ON (PC.PGM_NAME = PG.PGM_NAME)                   04539655
045397                 WHERE (PC.COPY_NAME LIKE                         04539755
045398                               :PV-WILDCARDED-COPY-NAME)          04539855
045400                 ORDER BY PC.COPY_NAME,                           04540036
045401                          PC.PGM_NAME                             04540136
045402     END-EXEC.                                                    04540236
045403                                                                  04540336
045404*                                                                 04540436
045405*  CURSOR USED TO RETRIEVE ALL PROGRAM/COPYBOOK ROWS CONTAINING A 04540536
045406*  REFERENCE TO THE WILDCARDED PROGRAM NAME SPECIFIED.            04540636
045407*                                                                 04540736
045408                                                                  04540836
045409     EXEC SQL                                                     04540936
045410         DECLARE PGM_COPY_CURSOR CURSOR FOR                       04541036
045411             SELECT PC.PGM_NAME,                                  04541136
045412                    PC.COPY_NAME,                                 04541236
045413                    CP.TYPE_CODE,                                 04541336
045414                    CP.STNDRD_CODE                                04541436
045415                 FROM TP1PGMCP PC,                                04541536
045416                      TP1COPY CP                                  04541636
045417                 WHERE ((PC.PGM_NAME LIKE                         04541736
045418                               :PV-WILDCARDED-PGM-NAME)        AND04541836
045419                       (PC.COPY_NAME = CP.COPY_NAME))             04541936
045420                 ORDER BY PC.PGM_NAME,                            04542036
045421                          PC.COPY_NAME                            04542136
045423     END-EXEC.                                                    04542336
045430                                                                  04543036
045500******************************************************************04550000
045600 PROCEDURE DIVISION.                                              04560000
045700******************************************************************04570000
045800                                                                  04580000
045900 0000-MAINLINE.                                                   04590000
046000                                                                  04600000
046100*                                                                 04610000
046200*  REFRESH ENTIRE SCREEN ON NEXT DISPLAY.  ALL SCREEN VARIABLES   04620000
046300*  SPECIFIED IN THE PANEL BODY WILL BE RETRIEVED PRIOR TO THE     04630000
046400*  REDISPLAY.                                                     04640000
046500*                                                                 04650000
046600     CALL IC-ISPF-SERVICE-LINK USING IC-MISC-SERVICE-CONTROL      04660006
046700                                     IC-DISPLAY-SERVICE-DISPLAY   04670014
046800                                     IC-REFRESH-STATEMENT.        04680006
046900                                                                  04690000
047000     PERFORM 1000-INITIALIZE.                                     04700006
047100                                                                  04710006
047200     MOVE IN-FIELD-CMNEKXOP TO IV-CURSOR-POSITION.                04720036
047300     PERFORM 9000-DISPLAY-REQUEST-PANEL.                          04730006
047400                                                                  04740000
047500     PERFORM 2000-PROCESS-XREF-REQUEST                            04750002
047600         UNTIL RETURN-CODE NOT = ZERO.                            04760000
047700                                                                  04770002
047800     IF PS-XREF-RESULTS-ALLOCATED                                 04780005
047900         PERFORM 9600-DELETE-RESULTS-FILE                         04790005
048000     END-IF.                                                      04800005
048300                                                                  04830000
048400     GOBACK.                                                      04840000
048500                                                                  04850000
048600******************************************************************04860000
048700*  INITIALIZE FOR PROGRAM PROCESSING.  DEFINE VARIABLES TO ISPF  *04870053
048710*  THROUGH THE FUNCTION POOL FOR ALL SCREEN I/O NEEDS, AND       *04871053
048800*  SHARED OR PROFILE POOL RETRIEVAL (IF NOT DIRECTLY REFERENCED  *04880053
048901*  IN SCREEN I/O).  RETRIEVE THE CURRENT VALUES FOR ALL REQUIRED *04890153
048902*  SHARED OR PROFILE POOL VARIABLES.  DETERMINE THE DSN TO BE    *04890253
048910*  USED FOR CROSS REFERENCE QUERY RESULTS.                       *04891053
049100******************************************************************04910000
049200                                                                  04920000
049300 1000-INITIALIZE.                                                 04930005
049301                                                                  04930153
049310*                                                                 04931053
049320*  DEFINE NON-DISPLAYED DIALOG VARIABLES TO ISPF THROUGH THE      04932053
049330*  FUNCTION POOL                                                  04933053
049340*                                                                 04934053
049341                                                                  04934153
049350     MOVE LENGTH OF ID-ISPF-TEMP-FILE-DSN TO IV-FIELD-LENGTH.     04935053
049360     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04936053
049370                                     IN-FIELD-ISPF-TEMP-FILE-DSN  04937053
049380                                     ID-ISPF-TEMP-FILE-DSN        04938053
049390                                     IC-FIELD-FORMAT-CHAR         04939053
049391                                     IV-FIELD-LENGTH.             04939153
049392                                                                  04939253
049400*                                                                 04940005
049500*  DEFINE DIALOG VARIABLES COMMON TO ALL PANELS TO ISPF THROUGH   04950053
049510*  THE FUNCTION POOL                                              04951053
049600*                                                                 04960005
049610                                                                  04961053
049700     MOVE LENGTH OF ID-SHORT-MESSAGE TO IV-FIELD-LENGTH.          04970000
049800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  04980006
049900                                     IN-FIELD-SHORT-MESSAGE       04990000
050000                                     ID-SHORT-MESSAGE             05000000
050100                                     IC-FIELD-FORMAT-CHAR         05010000
050200                                     IV-FIELD-LENGTH.             05020000
050300                                                                  05030000
050400     MOVE LENGTH OF ID-LONG-MESSAGE TO IV-FIELD-LENGTH.           05040000
050500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05050006
050600                                     IN-FIELD-LONG-MESSAGE        05060000
050700                                     ID-LONG-MESSAGE              05070000
050800                                     IC-FIELD-FORMAT-CHAR         05080000
050900                                     IV-FIELD-LENGTH.             05090000
051900                                                                  05190000
052000*                                                                 05200005
052100*  DEFINE DIALOG VARIABLES FOR LOCAL PANEL USAGE TO ISPF THROUGH  05210053
052110*  THE FUNCTION POOL                                              05211053
052200*                                                                 05220005
052300                                                                  05230005
052400     PERFORM 1100-DEFINE-CMNEKX0-VARIABLES.                       05240002
052600                                                                  05260009
052700     INITIALIZE ID-CMNEKX0-VARIABLES.                             05270041
052900                                                                  05290009
053000     PERFORM 1300-RETRIEVE-POOL-VARIABLES.                        05300005
053100                                                                  05310005
053200*                                                                 05320005
053300*  DETERMINE THE DSN TO BE USED FOR CROSS REFERENCE QUERY         05330005
053400*  RESULTS.  THE DSN SHOULD TAKE ALL ISPF TEMP FILE DSN           05340005
053500*  QUALIFIERS UP TO THE CONTROL QUALIFIER, AND ADD CROSS          05350005
053600*  REFERENCE QUALIFIER.  CREATE A VERSION OF THE DSN WITHOUT      05360005
053700*  THE USER ID QUALIFER FOR USE BY THE ISPF BROWSE FUNCTION.      05370005
053800*                                                                 05380005
053900                                                                  05390005
054000     INITIALIZE PV-TALLY                                          05400005
054100                PV-XREF-RESULTS-DSN                               05410005
054200                PV-XREF-RESULTS-DSN-WO-USERID.                    05420014
054300     INSPECT ID-ISPF-TEMP-FILE-DSN                                05430005
054400         TALLYING PV-TALLY                                        05440005
054500         FOR CHARACTERS BEFORE INITIAL PC-CNTL-DSN-QUALIFIER.     05450015
054600     MOVE ID-ISPF-TEMP-FILE-DSN (1:PV-TALLY) TO                   05460005
054700               PV-XREF-RESULTS-DSN.                               05470005
054800     ADD +1 TO PV-TALLY.                                          05480005
054900     MOVE PC-XREF-DSN-QUALIFIER TO                                05490005
055000               PV-XREF-RESULTS-DSN                                05500005
055100                       (PV-TALLY:LENGTH OF PC-XREF-DSN-QUALIFIER).05510015
055200*                                                                 05520005
055300     INITIALIZE PV-TALLY.                                         05530025
055400     INSPECT PV-XREF-RESULTS-DSN                                  05540005
055500         TALLYING PV-TALLY                                        05550005
055600         FOR CHARACTERS BEFORE INITIAL PC-DSN-QUALIFIER-SEP.      05560015
055700     ADD +2 TO PV-TALLY.                                          05570005
055800     MOVE PV-XREF-RESULTS-DSN (PV-TALLY:                          05580005
055900                  (LENGTH OF PV-XREF-RESULTS-DSN - PV-TALLY + 1)) 05590028
056000               TO PV-XREF-RESULTS-DSN-WO-USERID.                  05600005
056100*1000-EXIT.                                                       05610002
056200                                                                  05620000
056300******************************************************************05630000
056400*  DEFINE THE CMNEKX0 DIALOG VARIABLES TO ISPF THROUGH THE       *05640053
056500*  FUNCTION POOL.  CMNEKX0 IS THE CROSS REFERENCE QUERY REQUEST  *05650053
056510*  SPECIFICATION PANEL.                                          *05651053
056600******************************************************************05660000
056700                                                                  05670000
056800 1100-DEFINE-CMNEKX0-VARIABLES.                                   05680002
056900*--------------------------------------------                     05690000
057000* QUERY OPTION                                                    05700036
057100*--------------------------------------------                     05710000
057200     MOVE LENGTH OF ID-CMNEKX0-CMNEKXOP TO IV-FIELD-LENGTH.       05720036
057300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05730006
057400                                     IN-FIELD-CMNEKXOP            05740036
057500                                     ID-CMNEKX0-CMNEKXOP          05750036
057600                                     IC-FIELD-FORMAT-CHAR         05760000
057700                                     IV-FIELD-LENGTH.             05770000
057800                                                                  05780002
057810*--------------------------------------------                     05781036
057820* WILDCARDED DATASET NAME REQUEST VARIABLE                        05782036
057830*--------------------------------------------                     05783036
057840     MOVE LENGTH OF ID-CMNEKX0-CMNEKXDS TO IV-FIELD-LENGTH.       05784036
057850     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05785036
057860                                     IN-FIELD-CMNEKXDS            05786036
057870                                     ID-CMNEKX0-CMNEKXDS          05787036
057880                                     IC-FIELD-FORMAT-CHAR         05788036
057890                                     IV-FIELD-LENGTH.             05789036
057891                                                                  05789136
057900*--------------------------------------------                     05790002
058000* WILDCARDED PROGRAM NAME REQUEST VARIABLE                        05800036
058100*--------------------------------------------                     05810002
058200     MOVE LENGTH OF ID-CMNEKX0-CMNEKXPG TO IV-FIELD-LENGTH.       05820036
058300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05830006
058400                                     IN-FIELD-CMNEKXPG            05840036
058500                                     ID-CMNEKX0-CMNEKXPG          05850036
058600                                     IC-FIELD-FORMAT-CHAR         05860002
058700                                     IV-FIELD-LENGTH.             05870002
058710                                                                  05871036
058720*--------------------------------------------                     05872036
058730* WILDCARDED COPYBOOK NAME REQUEST VARIABLE                       05873036
058740*--------------------------------------------                     05874036
058750     MOVE LENGTH OF ID-CMNEKX0-CMNEKXCP TO IV-FIELD-LENGTH.       05875036
058760     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05876036
058770                                     IN-FIELD-CMNEKXCP            05877036
058780                                     ID-CMNEKX0-CMNEKXCP          05878036
058790                                     IC-FIELD-FORMAT-CHAR         05879036
058791                                     IV-FIELD-LENGTH.             05879136
058800*1100-EXIT.                                                       05880002
058900                                                                  05890000
061700******************************************************************06170000
061800*  RETRIEVE VALUES FROM THE SHARED VARIABLE POOL OR APPLICATION  *06180004
061900*  PROFILE VARIABLE POOL AND PLACE THEM IN THE FUNCTION VARIABLE *06190004
062000*  POOL.                                                         *06200004
062100******************************************************************06210000
062200                                                                  06220000
062300 1300-RETRIEVE-POOL-VARIABLES.                                    06230004
062400     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VGET     06240006
062500                                     IN-FIELD-ISPF-TEMP-FILE-DSN  06250004
062600                                     IC-SHARED-VARIABLE-POOL.     06260004
063100*1300-EXIT.                                                       06310004
064400                                                                  06440004
064500******************************************************************06450004
064600*  PROCESS A CROSS REFERENCE QUERY REQUEST ENTERED ON THE        *06460004
064700*  CMNEKX0 PANEL.  EDIT THE FIELDS TO MAKE CERTAIN THAT A VALID  *06470004
064800*  AND COMPLETE CROSS REFERENCE REQUEST HAS BEEN MADE.  IF       *06480004
064900*  NO ERRORS ARE DETECTED BY THE LOCAL EDITS, FORMAT AND         *06490053
065000*  EXECUTE THE QUERY, AND ALLOW A BROWSE OF THE RESULTS.  AFTER  *06500053
065600*  TERMINATING THE BROWSE PROCESS, CONTROL IS RETURNED TO THE    *06560053
065700*  CROSS REFERENCE QUERY REQUEST PANEL.  THE REQUEST FIELDS FOR  *06570053
065710*  THE PREVIOUS REQUEST WILL REMAIN FILLED, AND ANY ERROR        *06571053
065720*  MESSAGES THAT MAY HAVE BEEN GENERATED DURING THE BROWSE       *06572053
065730*  PROCESS WILL BE PRESENTED ON THE REDISPLAY OF THIS PANEL.     *06573053
065800******************************************************************06580004
065900                                                                  06590004
066000 2000-PROCESS-XREF-REQUEST.                                       06600004
066100     SET PS-NO-EDIT-ERRORS TO TRUE.                               06610000
066200                                                                  06620000
066210*                                                                 06621036
066220*  EDIT THE QUERY OPTION                                          06622036
066230*                                                                 06623036
066240                                                                  06624036
066300     IF (NOT ID-CMNEKX0-CMNEKXOP-VALID)                           06630036
066500         IF PS-NO-EDIT-ERRORS                                     06650000
066510             IF ID-CMNEKX0-CMNEKXOP = SPACES                      06651036
066511                 MOVE 'NO REQUEST WAS MADE' TO                    06651136
066512                           ID-SHORT-MESSAGE                       06651236
066520             ELSE                                                 06652036
066600                 MOVE 'INVALID OPTION SPECIFIED' TO               06660036
066700                           ID-SHORT-MESSAGE                       06670036
067100             END-IF                                               06710036
067101             MOVE 'SPECIFY A QUERY OPTION FROM THE LIST BELOW' TO 06710136
067102                       ID-LONG-MESSAGE                            06710236
067110             SET PS-EDIT-ERROR TO TRUE                            06711036
067120             MOVE IN-FIELD-CMNEKXOP TO                            06712036
067130                       IV-CURSOR-POSITION                         06713036
067140         END-IF                                                   06714036
067200     END-IF.                                                      06720000
067201                                                                  06720136
067202*                                                                 06720236
067203*  EDIT THE REQUEST FIELDS FOR A DATASET - WHERE USED REQUEST     06720336
067204*                                                                 06720436
067205                                                                  06720536
067211     IF ID-CMNEKX0-CMNEKXOP-DSN-USED                              06721136
067220         IF ID-CMNEKX0-CMNEKXDS = SPACES                          06722036
067240             IF PS-NO-EDIT-ERRORS                                 06724036
067250                 MOVE 'QUERY FIELD MISSING' TO                    06725036
067260                           ID-SHORT-MESSAGE                       06726036
067261                 MOVE 'A DATASET NAME MUST BE SPECIFIED FOR THIS Q06726137
067262-                          'UERY REQUEST' TO ID-LONG-MESSAGE      06726237
067270                 SET PS-EDIT-ERROR TO TRUE                        06727036
067280                 MOVE IN-FIELD-CMNEKXDS TO                        06728036
067290                           IV-CURSOR-POSITION                     06729036
067291             END-IF                                               06729136
067292         ELSE                                                     06729236
067293             IF ((ID-CMNEKX0-CMNEKXPG NOT = SPACES)               06729336
067294                     OR (ID-CMNEKX0-CMNEKXCP NOT = SPACES))       06729436
067295                 IF PS-NO-EDIT-ERRORS                             06729536
067296                     MOVE 'EXTRANEOUS INPUT' TO                   06729636
067297                               ID-SHORT-MESSAGE                   06729736
067298                     MOVE 'ONLY A DATASET NAME CAN BE SPECIFIED FO06729837
067299-                              'R THIS QUERY REQUEST' TO          06729937
067300                               ID-LONG-MESSAGE                    06730037
067303                     SET PS-EDIT-ERROR TO TRUE                    06730336
067304                     IF (ID-CMNEKX0-CMNEKXPG NOT = SPACES)        06730436
067305                         MOVE IN-FIELD-CMNEKXPG TO                06730536
067306                                   IV-CURSOR-POSITION             06730636
067307                     ELSE                                         06730736
067308                         MOVE IN-FIELD-CMNEKXCP TO                06730836
067309                                   IV-CURSOR-POSITION             06730936
067310                     END-IF                                       06731036
067311                 END-IF                                           06731136
067312             END-IF                                               06731236
067313         END-IF                                                   06731336
067320     END-IF.                                                      06732036
067330                                                                  06733036
067340*                                                                 06734036
067350*  EDIT THE REQUEST FIELDS FOR A PROGRAM - WHERE USED REQUEST     06735036
067360*                                                                 06736036
067370                                                                  06737036
067380     IF ID-CMNEKX0-CMNEKXOP-PGM-USED                              06738036
067390         IF ID-CMNEKX0-CMNEKXPG = SPACES                          06739036
067400             IF PS-NO-EDIT-ERRORS                                 06740036
067500                 MOVE 'QUERY FIELD MISSING' TO                    06750036
067600                           ID-SHORT-MESSAGE                       06760036
067700                 MOVE 'A PROGRAM NAME MUST BE SPECIFIED FOR THIS Q06770037
067800-                          'UERY REQUEST' TO ID-LONG-MESSAGE      06780037
068000                 SET PS-EDIT-ERROR TO TRUE                        06800036
068100                 MOVE IN-FIELD-CMNEKXPG TO                        06810036
068200                           IV-CURSOR-POSITION                     06820036
068300             END-IF                                               06830036
068310         ELSE                                                     06831036
068320             IF ((ID-CMNEKX0-CMNEKXDS NOT = SPACES)               06832036
068330                     OR (ID-CMNEKX0-CMNEKXCP NOT = SPACES))       06833036
068340                 IF PS-NO-EDIT-ERRORS                             06834036
068350                     MOVE 'EXTRANEOUS INPUT' TO                   06835036
068360                               ID-SHORT-MESSAGE                   06836036
068370                     MOVE 'ONLY A PROGRAM NAME CAN BE SPECIFIED FO06837037
068380-                              'R THIS QUERY REQUEST' TO          06838037
068390                               ID-LONG-MESSAGE                    06839037
068391                     SET PS-EDIT-ERROR TO TRUE                    06839136
068392                     IF (ID-CMNEKX0-CMNEKXDS NOT = SPACES)        06839236
068393                         MOVE IN-FIELD-CMNEKXDS TO                06839336
068394                                   IV-CURSOR-POSITION             06839436
068395                     ELSE                                         06839536
068396                         MOVE IN-FIELD-CMNEKXCP TO                06839636
068397                                   IV-CURSOR-POSITION             06839736
068398                     END-IF                                       06839836
068399                 END-IF                                           06839936
068400             END-IF                                               06840036
068401         END-IF                                                   06840136
068402     END-IF.                                                      06840236
068403                                                                  06840336
068404*                                                                 06840436
068405*  EDIT THE REQUEST FIELDS FOR A COPYBOOK - WHERE USED REQUEST    06840536
068406*                                                                 06840636
068407                                                                  06840736
068408     IF ID-CMNEKX0-CMNEKXOP-CPY-USED                              06840836
068409         IF ID-CMNEKX0-CMNEKXCP = SPACES                          06840936
068410             IF PS-NO-EDIT-ERRORS                                 06841036
068411                 MOVE 'QUERY FIELD MISSING' TO                    06841136
068412                           ID-SHORT-MESSAGE                       06841236
068413                 MOVE 'A COPYBOOK NAME MUST BE SPECIFIED FOR THIS 06841337
068414-                          'QUERY REQUEST' TO ID-LONG-MESSAGE     06841437
068416                 SET PS-EDIT-ERROR TO TRUE                        06841636
068417                 MOVE IN-FIELD-CMNEKXCP TO                        06841736
068418                           IV-CURSOR-POSITION                     06841836
068419             END-IF                                               06841936
068420         ELSE                                                     06842036
068421             IF ((ID-CMNEKX0-CMNEKXDS NOT = SPACES)               06842136
068422                     OR (ID-CMNEKX0-CMNEKXPG NOT = SPACES))       06842236
068423                 IF PS-NO-EDIT-ERRORS                             06842336
068424                     MOVE 'EXTRANEOUS INPUT' TO                   06842436
068425                               ID-SHORT-MESSAGE                   06842536
068426                     MOVE 'ONLY A COPYBOOK NAME CAN BE SPECIFIED F06842637
068427-                              'OR THIS QUERY REQUEST' TO         06842737
068428                               ID-LONG-MESSAGE                    06842837
068429                     SET PS-EDIT-ERROR TO TRUE                    06842936
068430                     IF (ID-CMNEKX0-CMNEKXDS NOT = SPACES)        06843036
068431                         MOVE IN-FIELD-CMNEKXDS TO                06843136
068432                                   IV-CURSOR-POSITION             06843236
068433                     ELSE                                         06843336
068434                         MOVE IN-FIELD-CMNEKXPG TO                06843436
068435                                   IV-CURSOR-POSITION             06843536
068436                     END-IF                                       06843636
068437                 END-IF                                           06843736
068438             END-IF                                               06843836
068439         END-IF                                                   06843936
068440     END-IF.                                                      06844036
068441                                                                  06844136
068442*                                                                 06844236
068443*  EDIT THE REQUEST FIELDS FOR A PROGRAM - COPYBOOKS USED REQUEST 06844336
068444*                                                                 06844436
068445                                                                  06844536
068446     IF ID-CMNEKX0-CMNEKXOP-PGM-COPY                              06844640
068447         IF ID-CMNEKX0-CMNEKXPG = SPACES                          06844736
068448             IF PS-NO-EDIT-ERRORS                                 06844836
068449                 MOVE 'QUERY FIELD MISSING' TO                    06844936
068450                           ID-SHORT-MESSAGE                       06845036
068451                 MOVE 'A PROGRAM NAME MUST BE SPECIFIED FOR THIS Q06845137
068452-                          'UERY REQUEST' TO ID-LONG-MESSAGE      06845237
068454                 SET PS-EDIT-ERROR TO TRUE                        06845436
068455                 MOVE IN-FIELD-CMNEKXPG TO                        06845536
068456                           IV-CURSOR-POSITION                     06845636
068457             END-IF                                               06845736
068458         ELSE                                                     06845836
068459             IF ((ID-CMNEKX0-CMNEKXDS NOT = SPACES)               06845936
068460                     OR (ID-CMNEKX0-CMNEKXCP NOT = SPACES))       06846036
068461                 IF PS-NO-EDIT-ERRORS                             06846136
068462                     MOVE 'EXTRANEOUS INPUT' TO                   06846236
068463                               ID-SHORT-MESSAGE                   06846336
068464                     MOVE 'ONLY A PROGRAM NAME CAN BE SPECIFIED FO06846437
068465-                              'R THIS QUERY REQUEST' TO          06846537
068466                               ID-LONG-MESSAGE                    06846637
068467                     SET PS-EDIT-ERROR TO TRUE                    06846736
068468                     IF (ID-CMNEKX0-CMNEKXDS NOT = SPACES)        06846836
068469                         MOVE IN-FIELD-CMNEKXDS TO                06846936
068470                                   IV-CURSOR-POSITION             06847036
068471                     ELSE                                         06847136
068472                         MOVE IN-FIELD-CMNEKXCP TO                06847236
068473                                   IV-CURSOR-POSITION             06847336
068474                     END-IF                                       06847436
068475                 END-IF                                           06847536
068476             END-IF                                               06847636
068477         END-IF                                                   06847736
068478     END-IF.                                                      06847836
068480                                                                  06848036
068500     IF PS-NO-EDIT-ERRORS                                         06850000
068600         INITIALIZE ID-SHORT-MESSAGE                              06860002
068700                    ID-LONG-MESSAGE                               06870002
068800*                                                                 06880034
068900*  ENSURE THAT THE RESULTS FILE HAS ALREADY BEEN SUCCESSFULLY     06890034
069000*  ALLOCATED.                                                     06900034
069100*                                                                 06910034
069200         IF PS-XREF-RESULTS-NOT-ALLOCATED                         06920006
069300             PERFORM 9500-ALLOCATE-RESULTS-FILE                   06930006
069400         END-IF                                                   06940006
069500         IF PS-XREF-RESULTS-ALLOCATED                             06950006
069600             PERFORM 3000-BROWSE-XREF-RESULTS                     06960009
069700         END-IF                                                   06970006
069800     END-IF.                                                      06980000
069900                                                                  06990000
070000     PERFORM 9000-DISPLAY-REQUEST-PANEL.                          07000000
070100*2000-EXIT.                                                       07010002
070200                                                                  07020000
070300******************************************************************07030000
070400*  CREATE A FORMATTED FILE WITH THE CROSS REFERENCE QUERY        *07040034
070500*  RESULTS FOR SUBSEQUENT BROWSING.  IF ANY ERRORS WERE DETECTED *07050053
070600*  WHILE TRYING TO ACQUIRE THE RESULTS, OR IF NO MATCHES WERE    *07060034
070700*  FOUND FOR THE REQUEST SPECIFIED, RETURN A MESSAGE TO THE      *07070034
070800*  CROSS REFERENCE QUERY REQUEST PANEL.  IF RESULTS ARE FOUND,   *07080053
070830*  CONTROL IS PASSED TO AN ISPF BROWSE PANEL TO BROWSE THE FILE. *07083053
070840*  THE BROWSE PANEL WILL REMAIN DISPLAYED UNTIL AN END IS        *07084053
070850*  REQUESTED FROM THE PANEL.  WHEN AN END IS REQUESTED,          *07085053
070860*  PARAMETERS ARE BUILT FOR THE COMMON PRINT REQUEST PANEL, AND  *07086053
070870*  THE COMMON PRINT REQUEST PANEL PROGRAM IS CALLED.  THIS WILL  *07087053
070880*  ALLOW THE BROWSED FILE TO BE PRINTED.  AFTER RESPONDING TO    *07088053
070890*  THE PRINT REQUEST, CONTROL IS RETURNED TO THE CROSS REFERENCE *07089053
070891*  QUERY REQUEST PANEL.  THE REQUEST FIELDS FOR THE PREVIOUS     *07089153
070892*  REQUEST WILL REMAIN FILLED, AND ANY ERROR MESSAGES THAT MAY   *07089253
070893*  HAVE BEEN GENERATED DURING THE PROCESS OF ATTEMPTING TO       *07089353
070894*  BROWSE OR PRINT THE RESULTS WILL BE PRESENTED ON THE          *07089453
070895*  REDISPLAY OF THIS PANEL.                                      *07089553
072100******************************************************************07210000
072200                                                                  07220000
072300 3000-BROWSE-XREF-RESULTS.                                        07230009
072400     INITIALIZE PV-RESULTS-DETAIL-RCDS-WRITTEN                    07240011
072500                PV-DE-LAST-DB2-ACTION.                            07250016
072600                                                                  07260011
072610*                                                                 07261053
072620*  PREPARE A FORMATTED FILE WITH THE RESULTS FROM THE SPECIFIC    07262053
072621*  QUERY REQUESTED.                                               07262153
072630*                                                                 07263053
072640                                                                  07264053
072700     OPEN OUTPUT XREF-RESULTS-FILE.                               07270009
072800                                                                  07280009
072900     EVALUATE TRUE                                                07290009
073000         WHEN ID-CMNEKX0-CMNEKXOP-DSN-USED                        07300036
073100             PERFORM 3100-FORMAT-DSN-RESULTS                      07310011
073200         WHEN ID-CMNEKX0-CMNEKXOP-PGM-USED                        07320036
073300             PERFORM 3200-FORMAT-PGM-RESULTS                      07330011
073310         WHEN ID-CMNEKX0-CMNEKXOP-CPY-USED                        07331036
073320             PERFORM 3300-FORMAT-CPY-RESULTS                      07332036
073330         WHEN ID-CMNEKX0-CMNEKXOP-PGM-COPY                        07333036
073340             PERFORM 3400-FORMAT-PGM-COPY-RESULTS                 07334037
073400     END-EVALUATE.                                                07340009
073500                                                                  07350009
073600     CLOSE XREF-RESULTS-FILE.                                     07360009
073700                                                                  07370009
073800     EVALUATE TRUE                                                07380011
073900         WHEN PV-DE-LAST-DB2-ACTION NOT = SPACES                  07390016
074000             MOVE SQLCODE TO PV-DE-SQLCODE                        07400016
074100             MOVE PV-DB2-ERROR-MESSAGE TO ID-LONG-MESSAGE         07410016
074200         WHEN PV-RESULTS-DETAIL-RCDS-WRITTEN = ZERO               07420011
074300             MOVE 'NO MATCHES FOUND' TO ID-SHORT-MESSAGE          07430017
074400             MOVE 'THERE WERE NO MATCHES FOR YOUR XREF REQUEST'   07440027
074500                       TO ID-LONG-MESSAGE                         07450027
074600         WHEN OTHER                                               07460011
074700             PERFORM 9100-DISPLAY-RESULTS-PANEL                   07470011
074701*                                                                 07470146
074702*  CALL THE COMMON PRINT REQUEST PANEL PROGRAM TO ALLOW THE OPTION07470253
074703*  OF PRINTING THE FILE THAT WAS JUST BROWSED.                    07470353
074704*                                                                 07470446
074710             INITIALIZE DP300-ISPF-PRINT-PARMS                    07471041
074711             MOVE PC-CURRENT-PROGRAM-NAME TO                      07471151
074712                       DP300-CALLING-PROGRAM-NAME                 07471251
074720             MOVE PV-REPORT-NUMBER TO DP300-CALLING-REPORT-NUMBER 07472051
074730             MOVE PV-XREF-RESULTS-DSN TO DP300-FILE-DSNAME        07473046
074731             SET DP300-FR-FIXED-BLOCK TO TRUE                     07473146
074732             MOVE LENGTH OF XR-XREF-RESULTS-RECORD TO             07473246
074734                       DP300-FILE-LRECL                           07473446
074735             SET DP300-PT-PRINT-TITLE-LINE                        07473546
074736                 DP300-RH-REPEAT-HEADINGS TO TRUE                 07473646
074737             MOVE PV-HEADING-LINE-COUNT TO                        07473746
074740                       DP300-HEADING-LINE-COUNT                   07474046
074750             CALL DP300-ISPF-PRINT-REQ-PROGRAM                    07475048
074760                       USING DP300-ISPF-PRINT-PARMS               07476041
074770             MOVE DP300-ERROR-MESSAGE TO ID-LONG-MESSAGE          07477043
074771             IF DP300-RI-PRINT-REQUESTED                          07477149
074772                 MOVE DP300-ERROR-MESSAGE TO ID-SHORT-MESSAGE     07477249
074780             END-IF                                               07478049
075600             EVALUATE TRUE                                        07560030
075700                 WHEN ID-CMNEKX0-CMNEKXDS NOT = SPACES            07570036
075800                     MOVE IN-FIELD-CMNEKXDS TO IV-CURSOR-POSITION 07580036
075900                 WHEN ID-CMNEKX0-CMNEKXPG NOT = SPACES            07590036
076000                     MOVE IN-FIELD-CMNEKXPG TO IV-CURSOR-POSITION 07600036
076010                 WHEN ID-CMNEKX0-CMNEKXCP NOT = SPACES            07601053
076020                     MOVE IN-FIELD-CMNEKXCP TO IV-CURSOR-POSITION 07602053
076100             END-EVALUATE                                         07610030
076200     END-EVALUATE.                                                07620011
076300*3000-EXIT.                                                       07630009
076400                                                                  07640009
076500******************************************************************07650009
076600*  FORMAT THE RESULTS FILE FOR A DATASET NAME WHERE USED         *07660034
076700*  REQUEST.  BUILD A HOST VARIABLE FOR THE LIKE CLAUSE           *07670034
076800*  SATISFYING THE REQUEST.  WRITE OUT THE FORMATTED RESULTS      *07680034
076900*  HEADER LINES.  OPEN THE DATASET NAME WHERE USED CURSOR.       *07690034
077000*  FORMAT AND WRITE RESULTS RECORDS FOR EACH DATASET ROW         *07700034
077100*  FETCHED.  CLOSE THE DATASET NAME WHERE USED CURSOR.           *07710034
077200******************************************************************07720009
077300                                                                  07730009
077400 3100-FORMAT-DSN-RESULTS.                                         07740011
077410     SET PV-DSN-WHERE-USED TO TRUE.                               07741051
077450                                                                  07745051
077460*                                                                 07746053
077461*  BUILD THE HOST VARIABLE FOR THE DATASET NAME, WITH WILDCARD    07746153
077462*  CHARACTERS ON BOTH SIDES OF THE SPECIFICATION, IF SPACE ALLOWS.07746253
077463*  WILDCARDING WILL OCCUR ON THE RIGHT ONLY, IF SPACE ONLY PERMITS07746353
077464*  ONE WILDCARD CHARACTER.                                        07746453
077465*                                                                 07746553
077470                                                                  07747053
077500     INITIALIZE PV-LEFT-JUST-WORK-AREA                            07750031
077600                PV-TALLY.                                         07760012
077700     INSPECT ID-CMNEKX0-CMNEKXDS                                  07770036
077800         TALLYING PV-TALLY FOR LEADING SPACES.                    07780014
077900     MOVE ID-CMNEKX0-CMNEKXDS ((PV-TALLY + 1):                    07790036
078000                   (LENGTH OF ID-CMNEKX0-CMNEKXDS - PV-TALLY)) TO 07800036
078100               PV-LEFT-JUST-WORK-AREA                             07810012
078200     INITIALIZE PV-TALLY.                                         07820025
078300     INSPECT PV-LEFT-JUST-WORK-AREA                               07830012
078400         TALLYING PV-TALLY FOR CHARACTERS BEFORE INITIAL SPACES.  07840015
078500     SET PV-WFN-MASK TO TRUE.                                     07850031
078600     MOVE +1 TO PV-START-LOCATION.                                07860012
078700     IF PV-TALLY < ((LENGTH OF ID-CMNEKX0-CMNEKXDS) - 1)          07870036
078800         ADD +1 TO PV-START-LOCATION                              07880012
078900     END-IF.                                                      07890014
079000     MOVE PV-LEFT-JUST-WORK-AREA (1:PV-TALLY) TO                  07900012
079100               PV-WILDCARDED-FILE-NAME                            07910014
079200                                     (PV-START-LOCATION:PV-TALLY) 07920014
079210                                                                  07921054
079220*                                                                 07922054
079230*  WRITE HEADING INFORMATION OUT TO THE RESULTS FILE              07923054
079240*                                                                 07924054
079300                                                                  07930012
079310     INITIALIZE PV-HEADING-LINE-COUNT.                            07931046
079400     MOVE HL1DR-HEADING-LINE-1 TO XR-XREF-RESULTS-RECORD.         07940012
079500     PERFORM 8000-WRITE-RESULTS-RECORD.                           07950012
079501     ADD +1 TO PV-HEADING-LINE-COUNT.                             07950146
079600     INITIALIZE XR-XREF-RESULTS-RECORD.                           07960012
079700     PERFORM 8000-WRITE-RESULTS-RECORD.                           07970012
079710     ADD +1 TO PV-HEADING-LINE-COUNT.                             07971046
079800     INITIALIZE HL2DR-WILDCARDED-FILE-NAME                        07980031
079900                PV-TALLY.                                         07990031
080000     INSPECT PV-WILDCARDED-FILE-NAME                              08000031
080100         TALLYING PV-TALLY                                        08010031
080200         FOR CHARACTERS BEFORE INITIAL PC-WILDCARD-REPEAT.        08020031
080300     IF PV-TALLY < (LENGTH OF PV-WILDCARDED-FILE-NAME)            08030031
080400         ADD +1 TO PV-TALLY                                       08040031
080500     END-IF.                                                      08050031
080600     MOVE PV-WILDCARDED-FILE-NAME (1:PV-TALLY) TO                 08060031
080700               HL2DR-WILDCARDED-FILE-NAME (1:PV-TALLY).           08070031
080800     MOVE HL2DR-HEADING-LINE-2 TO XR-XREF-RESULTS-RECORD.         08080012
080900     PERFORM 8000-WRITE-RESULTS-RECORD.                           08090012
080910     ADD +1 TO PV-HEADING-LINE-COUNT.                             08091046
081000     INITIALIZE XR-XREF-RESULTS-RECORD.                           08100013
081100     PERFORM 8000-WRITE-RESULTS-RECORD.                           08110013
081110     ADD +1 TO PV-HEADING-LINE-COUNT.                             08111046
081200     MOVE HL3DR-HEADING-LINE-3 TO XR-XREF-RESULTS-RECORD.         08120012
081300     PERFORM 8000-WRITE-RESULTS-RECORD.                           08130012
081310     ADD +1 TO PV-HEADING-LINE-COUNT.                             08131046
081400     MOVE HL4DR-HEADING-LINE-4 TO XR-XREF-RESULTS-RECORD.         08140012
081500     PERFORM 8000-WRITE-RESULTS-RECORD.                           08150012
081510     ADD +1 TO PV-HEADING-LINE-COUNT.                             08151046
081520                                                                  08152054
081530*                                                                 08153054
081540*  EXECUTE THE CROSS REFERENCE QUERY - OPEN THE CURSOR            08154054
081550*                                                                 08155054
081600                                                                  08160012
081700     INITIALIZE PV-RETRY-COUNT.                                   08170012
081800     PERFORM                                                      08180012
081900             WITH TEST AFTER                                      08190012
082000             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             08200012
082100                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 08210012
082200         EXEC SQL                                                 08220012
082300             OPEN DSN_CURSOR                                      08230012
082400         END-EXEC                                                 08240012
082500                                                                  08250012
082600         EVALUATE TRUE                                            08260012
082700             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         08270012
082800             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         08280012
082900             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        08290012
083000                 ADD +1 TO PV-RETRY-COUNT                         08300012
083100             WHEN SQLWARN0 NOT = SPACES                           08310012
083200             WHEN SQLCODE < ZERO                                  08320012
083300             WHEN SQLCODE > ZERO                                  08330012
083400                 SET PV-OPEN-DSN-CURSOR TO TRUE                   08340012
083500         END-EVALUATE                                             08350012
083600     END-PERFORM.                                                 08360012
083700                                                                  08370012
083800     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   08380012
083900         SET PV-OPEN-DSN-CURSOR TO TRUE                           08390012
084000     END-IF.                                                      08400012
084010                                                                  08401054
084020*                                                                 08402054
084030*  FORMAT AND WRITE A CROSS REFERENCE QUERY RESULTS RECORD        08403054
084031*  FOR EACH ROW RETURNED                                          08403154
084040*                                                                 08404054
084100                                                                  08410012
084200     IF PV-DE-LAST-DB2-ACTION = SPACES                            08420016
084300         PERFORM 7100-FETCH-DSN-ROW                               08430012
084400         INITIALIZE CK-CURRENT-FILE-NAME                          08440012
084500     END-IF.                                                      08450012
084600                                                                  08460012
084700     PERFORM                                                      08470012
084800             UNTIL ((SQLCODE = PC-END-OF-CURSOR-SQLCODE)          08480012
084900                     OR (PV-DE-LAST-DB2-ACTION NOT = SPACES))     08490016
085000         ADD +1 TO PV-RESULTS-DETAIL-RCDS-WRITTEN                 08500012
085100         INITIALIZE DLDR-DETAIL-LINE                              08510012
085200         IF TP1PROC-FILE-NAME NOT = CK-CURRENT-FILE-NAME          08520012
085300             MOVE TP1PROC-FILE-NAME TO CK-CURRENT-FILE-NAME       08530012
085400                                       DLDR-FILE-NAME             08540012
085500         END-IF                                                   08550012
085600         MOVE TP1PROC-PROC-NAME TO DLDR-PROC-NAME                 08560012
085700         MOVE TP1PROC-PROC-STEP-NAME TO DLDR-PROC-STEP-NAME       08570012
085800         MOVE TP1PROST-PGM-NAME TO DLDR-PGM-NAME                  08580012
085900         MOVE DLDR-DETAIL-LINE TO XR-XREF-RESULTS-RECORD          08590030
086000         PERFORM 8000-WRITE-RESULTS-RECORD                        08600012
086100         PERFORM 7100-FETCH-DSN-ROW                               08610012
086200     END-PERFORM.                                                 08620012
086300                                                                  08630012
086400     IF PV-DE-LAST-DB2-ACTION = SPACES                            08640016
086500         EXEC SQL                                                 08650012
086600             CLOSE DSN_CURSOR                                     08660012
086700         END-EXEC                                                 08670012
086800                                                                  08680012
086900         IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                   08690012
087000             SET PV-CLOSE-DSN-CURSOR TO TRUE                      08700012
087100         END-IF                                                   08710012
087200     END-IF.                                                      08720012
087300*3100-EXIT.                                                       08730012
087400                                                                  08740011
087500******************************************************************08750002
087600*  FORMAT THE RESULTS FILE FOR A PROGRAM WHERE USED REQUEST.     *08760034
087700*  BUILD A HOST VARIABLE FOR THE LIKE CLAUSE SATISFYING THE      *08770034
087800*  REQUEST.  WRITE OUT THE FORMATTED RESULTS HEADER LINES.  OPEN *08780034
087900*  THE PROGRAM WHERE USED CURSOR.  FORMAT AND WRITE RESULTS      *08790034
088000*  RECORDS FOR EACH PROGRAM ROW FETCHED.  CLOSE THE PROGRAM      *08800034
088100*  WHERE USED CURSOR.                                            *08810034
088200******************************************************************08820002
088300                                                                  08830002
088400 3200-FORMAT-PGM-RESULTS.                                         08840011
088410     SET PV-PROGRAM-WHERE-USED TO TRUE.                           08841051
088420                                                                  08842053
088430*                                                                 08843053
088431*  BUILD THE HOST VARIABLE FOR THE PROGRAM NAME, WITH WILDCARD    08843153
088432*  CHARACTERS ON BOTH SIDES OF THE SPECIFICATION, IF SPACE ALLOWS.08843253
088433*  WILDCARDING WILL OCCUR ON THE RIGHT ONLY, IF SPACE ONLY PERMITS08843353
088434*  ONE WILDCARD CHARACTER.                                        08843453
088435*                                                                 08843553
088440                                                                  08844051
088500     INITIALIZE PV-LEFT-JUST-WORK-AREA                            08850031
088600                PV-TALLY.                                         08860012
088700     INSPECT ID-CMNEKX0-CMNEKXPG                                  08870036
088800         TALLYING PV-TALLY FOR LEADING SPACES.                    08880014
088900     MOVE ID-CMNEKX0-CMNEKXPG ((PV-TALLY + 1):                    08890036
089000                   (LENGTH OF ID-CMNEKX0-CMNEKXPG - PV-TALLY)) TO 08900036
089100               PV-LEFT-JUST-WORK-AREA                             08910012
089200     INITIALIZE PV-TALLY.                                         08920025
089300     INSPECT PV-LEFT-JUST-WORK-AREA                               08930012
089400         TALLYING PV-TALLY FOR CHARACTERS BEFORE INITIAL SPACES.  08940015
089500     SET PV-WPN-MASK TO TRUE.                                     08950031
089600     MOVE +1 TO PV-START-LOCATION.                                08960012
089700     IF PV-TALLY < ((LENGTH OF ID-CMNEKX0-CMNEKXPG) - 1)          08970036
089800         ADD +1 TO PV-START-LOCATION                              08980012
089900     END-IF.                                                      08990014
090000     MOVE PV-LEFT-JUST-WORK-AREA (1:PV-TALLY) TO                  09000012
090100               PV-WILDCARDED-PGM-NAME                             09010014
090200                                    (PV-START-LOCATION:PV-TALLY)  09020014
090210                                                                  09021054
090220*                                                                 09022054
090230*  WRITE HEADING INFORMATION OUT TO THE RESULTS FILE              09023054
090240*                                                                 09024054
090300                                                                  09030012
090310     INITIALIZE PV-HEADING-LINE-COUNT.                            09031046
090400     MOVE HL1PR-HEADING-LINE-1 TO XR-XREF-RESULTS-RECORD.         09040012
090500     PERFORM 8000-WRITE-RESULTS-RECORD.                           09050012
090510     ADD +1 TO PV-HEADING-LINE-COUNT.                             09051046
090600     INITIALIZE XR-XREF-RESULTS-RECORD.                           09060012
090700     PERFORM 8000-WRITE-RESULTS-RECORD.                           09070012
090710     ADD +1 TO PV-HEADING-LINE-COUNT.                             09071046
090800     INITIALIZE HL2PR-WILDCARDED-PGM-NAME                         09080031
090900                PV-TALLY.                                         09090031
091000     INSPECT PV-WILDCARDED-PGM-NAME                               09100031
091100         TALLYING PV-TALLY                                        09110031
091200         FOR CHARACTERS BEFORE INITIAL PC-WILDCARD-REPEAT.        09120031
091300     IF PV-TALLY < (LENGTH OF PV-WILDCARDED-PGM-NAME)             09130031
091400         ADD +1 TO PV-TALLY                                       09140031
091500     END-IF.                                                      09150031
091600     MOVE PV-WILDCARDED-PGM-NAME (1:PV-TALLY) TO                  09160031
091700               HL2PR-WILDCARDED-PGM-NAME (1:PV-TALLY).            09170031
091800     MOVE HL2PR-HEADING-LINE-2 TO XR-XREF-RESULTS-RECORD.         09180013
091900     PERFORM 8000-WRITE-RESULTS-RECORD.                           09190013
091910     ADD +1 TO PV-HEADING-LINE-COUNT.                             09191046
092000     INITIALIZE XR-XREF-RESULTS-RECORD.                           09200013
092100     PERFORM 8000-WRITE-RESULTS-RECORD.                           09210013
092110     ADD +1 TO PV-HEADING-LINE-COUNT.                             09211046
092200     MOVE HL3PR-HEADING-LINE-3 TO XR-XREF-RESULTS-RECORD.         09220012
092300     PERFORM 8000-WRITE-RESULTS-RECORD.                           09230012
092310     ADD +1 TO PV-HEADING-LINE-COUNT.                             09231046
092400     MOVE HL4PR-HEADING-LINE-4 TO XR-XREF-RESULTS-RECORD.         09240012
092500     PERFORM 8000-WRITE-RESULTS-RECORD.                           09250012
092510     ADD +1 TO PV-HEADING-LINE-COUNT.                             09251046
092520                                                                  09252054
092530*                                                                 09253054
092540*  EXECUTE THE CROSS REFERENCE QUERY - OPEN THE CURSOR            09254054
092550*                                                                 09255054
092600                                                                  09260012
092700     INITIALIZE PV-RETRY-COUNT.                                   09270012
092800     PERFORM                                                      09280012
092900             WITH TEST AFTER                                      09290012
093000             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             09300012
093100                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 09310012
093200         EXEC SQL                                                 09320012
093300             OPEN PGM_CURSOR                                      09330012
093400         END-EXEC                                                 09340012
093500                                                                  09350012
093600         EVALUATE TRUE                                            09360012
093700             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         09370012
093800             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         09380012
093900             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        09390012
094000                 ADD +1 TO PV-RETRY-COUNT                         09400012
094100             WHEN SQLWARN0 NOT = SPACES                           09410012
094200             WHEN SQLCODE < ZERO                                  09420012
094300             WHEN SQLCODE > ZERO                                  09430012
094400                 SET PV-OPEN-PGM-CURSOR TO TRUE                   09440012
094500         END-EVALUATE                                             09450012
094600     END-PERFORM.                                                 09460012
094700                                                                  09470012
094800     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   09480012
094900         SET PV-OPEN-PGM-CURSOR TO TRUE                           09490012
095000     END-IF.                                                      09500012
095010                                                                  09501054
095020*                                                                 09502054
095030*  FORMAT AND WRITE A CROSS REFERENCE QUERY RESULTS RECORD        09503054
095040*  FOR EACH ROW RETURNED                                          09504054
095050*                                                                 09505054
095100                                                                  09510012
095200     IF PV-DE-LAST-DB2-ACTION = SPACES                            09520016
095300         PERFORM 7200-FETCH-PGM-ROW                               09530012
095400         INITIALIZE CK-CURRENT-PGM-NAME                           09540013
095500     END-IF.                                                      09550012
095600                                                                  09560012
095700     PERFORM                                                      09570012
095800             UNTIL ((SQLCODE = PC-END-OF-CURSOR-SQLCODE)          09580012
095900                     OR (PV-DE-LAST-DB2-ACTION NOT = SPACES))     09590016
096000         ADD +1 TO PV-RESULTS-DETAIL-RCDS-WRITTEN                 09600012
096100         INITIALIZE DLPR-DETAIL-LINE                              09610032
096200         IF TP1PROST-PGM-NAME NOT = CK-CURRENT-PGM-NAME           09620013
096300             MOVE TP1PROST-PGM-NAME TO CK-CURRENT-PGM-NAME        09630013
096400                                       DLPR-PGM-NAME              09640013
096500         END-IF                                                   09650012
096600         MOVE TP1PROST-PROC-NAME TO DLPR-PROC-NAME                09660013
096700         MOVE TP1PROST-PROC-STEP-NAME TO DLPR-PROC-STEP-NAME      09670013
096800         MOVE TP1PGM-PGM-DESC TO DLPR-PGM-DESC                    09680013
096900         MOVE DLPR-DETAIL-LINE TO XR-XREF-RESULTS-RECORD          09690030
097000         PERFORM 8000-WRITE-RESULTS-RECORD                        09700012
097100         PERFORM 7200-FETCH-PGM-ROW                               09710012
097200     END-PERFORM.                                                 09720012
097300                                                                  09730012
097400     IF PV-DE-LAST-DB2-ACTION = SPACES                            09740016
097500         EXEC SQL                                                 09750012
097600             CLOSE PGM_CURSOR                                     09760012
097700         END-EXEC                                                 09770012
097800                                                                  09780012
097900         IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                   09790012
098000             SET PV-CLOSE-PGM-CURSOR TO TRUE                      09800012
098100         END-IF                                                   09810012
098200     END-IF.                                                      09820012
098300*3200-EXIT.                                                       09830009
098310                                                                  09831036
098320******************************************************************09832036
098330*  FORMAT THE RESULTS FILE FOR A COPYBOOK WHERE USED REQUEST.    *09833036
098340*  BUILD A HOST VARIABLE FOR THE LIKE CLAUSE SATISFYING THE      *09834036
098350*  REQUEST.  WRITE OUT THE FORMATTED RESULTS HEADER LINES.  OPEN *09835036
098360*  THE COPYBOOK WHERE USED CURSOR.  FORMAT AND WRITE RESULTS     *09836036
098370*  RECORDS FOR EACH COPYBOOK ROW FETCHED.  CLOSE THE COPYBOOK    *09837036
098380*  WHERE USED CURSOR.                                            *09838036
098390******************************************************************09839036
098391                                                                  09839136
098392 3300-FORMAT-CPY-RESULTS.                                         09839236
098393     SET PV-COPYBOOK-WHERE-USED TO TRUE.                          09839351
098395                                                                  09839551
098397*                                                                 09839753
098398*  BUILD THE HOST VARIABLE FOR THE COPYBOOK NAME, WITH WILDCARD   09839853
098399*  CHARACTERS ON BOTH SIDES OF THE SPECIFICATION, IF SPACE ALLOWS.09839953
098400*  WILDCARDING WILL OCCUR ON THE RIGHT ONLY, IF SPACE ONLY PERMITS09840053
098401*  ONE WILDCARD CHARACTER.                                        09840153
098402*                                                                 09840253
098403                                                                  09840353
098404     INITIALIZE PV-LEFT-JUST-WORK-AREA                            09840436
098405                PV-TALLY.                                         09840536
098406     INSPECT ID-CMNEKX0-CMNEKXCP                                  09840636
098407         TALLYING PV-TALLY FOR LEADING SPACES.                    09840736
098408     MOVE ID-CMNEKX0-CMNEKXCP ((PV-TALLY + 1):                    09840836
098409                   (LENGTH OF ID-CMNEKX0-CMNEKXCP - PV-TALLY)) TO 09840936
098410               PV-LEFT-JUST-WORK-AREA                             09841036
098411     INITIALIZE PV-TALLY.                                         09841136
098412     INSPECT PV-LEFT-JUST-WORK-AREA                               09841236
098413         TALLYING PV-TALLY FOR CHARACTERS BEFORE INITIAL SPACES.  09841336
098414     SET PV-WCN-MASK TO TRUE.                                     09841436
098415     MOVE +1 TO PV-START-LOCATION.                                09841536
098416     IF PV-TALLY < ((LENGTH OF ID-CMNEKX0-CMNEKXCP) - 1)          09841636
098417         ADD +1 TO PV-START-LOCATION                              09841736
098418     END-IF.                                                      09841836
098419     MOVE PV-LEFT-JUST-WORK-AREA (1:PV-TALLY) TO                  09841936
098420               PV-WILDCARDED-COPY-NAME                            09842036
098421                                    (PV-START-LOCATION:PV-TALLY)  09842136
098422                                                                  09842254
098423*                                                                 09842354
098424*  WRITE HEADING INFORMATION OUT TO THE RESULTS FILE              09842454
098425*                                                                 09842554
098426                                                                  09842636
098427     INITIALIZE PV-HEADING-LINE-COUNT.                            09842746
098428     MOVE HL1CR-HEADING-LINE-1 TO XR-XREF-RESULTS-RECORD.         09842836
098429     PERFORM 8000-WRITE-RESULTS-RECORD.                           09842936
098430     ADD +1 TO PV-HEADING-LINE-COUNT.                             09843046
098431     INITIALIZE XR-XREF-RESULTS-RECORD.                           09843136
098432     PERFORM 8000-WRITE-RESULTS-RECORD.                           09843236
098433     ADD +1 TO PV-HEADING-LINE-COUNT.                             09843346
098434     INITIALIZE HL2CR-WILDCARDED-COPY-NAME                        09843436
098435                PV-TALLY.                                         09843536
098436     INSPECT PV-WILDCARDED-COPY-NAME                              09843636
098437         TALLYING PV-TALLY                                        09843736
098438         FOR CHARACTERS BEFORE INITIAL PC-WILDCARD-REPEAT.        09843836
098439     IF PV-TALLY < (LENGTH OF PV-WILDCARDED-COPY-NAME)            09843936
098440         ADD +1 TO PV-TALLY                                       09844036
098441     END-IF.                                                      09844136
098442     MOVE PV-WILDCARDED-COPY-NAME (1:PV-TALLY) TO                 09844236
098443               HL2CR-WILDCARDED-COPY-NAME (1:PV-TALLY).           09844336
098444     MOVE HL2CR-HEADING-LINE-2 TO XR-XREF-RESULTS-RECORD.         09844436
098445     PERFORM 8000-WRITE-RESULTS-RECORD.                           09844536
098446     ADD +1 TO PV-HEADING-LINE-COUNT.                             09844646
098447     INITIALIZE XR-XREF-RESULTS-RECORD.                           09844736
098448     PERFORM 8000-WRITE-RESULTS-RECORD.                           09844836
098449     ADD +1 TO PV-HEADING-LINE-COUNT.                             09844946
098450     MOVE HL3CR-HEADING-LINE-3 TO XR-XREF-RESULTS-RECORD.         09845036
098451     PERFORM 8000-WRITE-RESULTS-RECORD.                           09845136
098452     ADD +1 TO PV-HEADING-LINE-COUNT.                             09845246
098453     MOVE HL4CR-HEADING-LINE-4 TO XR-XREF-RESULTS-RECORD.         09845336
098454     PERFORM 8000-WRITE-RESULTS-RECORD.                           09845436
098455     ADD +1 TO PV-HEADING-LINE-COUNT.                             09845546
098456                                                                  09845654
098457*                                                                 09845754
098458*  EXECUTE THE CROSS REFERENCE QUERY - OPEN THE CURSOR            09845854
098459*                                                                 09845954
098460                                                                  09846036
098461     INITIALIZE PV-RETRY-COUNT.                                   09846136
098462     PERFORM                                                      09846236
098463             WITH TEST AFTER                                      09846336
098464             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             09846436
098465                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 09846536
098466         EXEC SQL                                                 09846636
098467             OPEN COPY_CURSOR                                     09846736
098468         END-EXEC                                                 09846836
098469                                                                  09846936
098470         EVALUATE TRUE                                            09847036
098471             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         09847136
098472             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         09847236
098473             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        09847336
098474                 ADD +1 TO PV-RETRY-COUNT                         09847436
098475             WHEN SQLWARN0 NOT = SPACES                           09847536
098476             WHEN SQLCODE < ZERO                                  09847636
098477             WHEN SQLCODE > ZERO                                  09847736
098478                 SET PV-OPEN-COPY-CURSOR TO TRUE                  09847836
098479         END-EVALUATE                                             09847936
098480     END-PERFORM.                                                 09848036
098481                                                                  09848136
098482     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   09848236
098483         SET PV-OPEN-COPY-CURSOR TO TRUE                          09848336
098484     END-IF.                                                      09848436
098485                                                                  09848554
098486*                                                                 09848654
098487*  FORMAT AND WRITE A CROSS REFERENCE QUERY RESULTS RECORD        09848754
098488*  FOR EACH ROW RETURNED                                          09848854
098489*                                                                 09848954
098490                                                                  09849036
098491     IF PV-DE-LAST-DB2-ACTION = SPACES                            09849136
098492         PERFORM 7300-FETCH-COPY-ROW                              09849236
098493         INITIALIZE CK-CURRENT-COPY-NAME                          09849336
098494     END-IF.                                                      09849436
098495                                                                  09849536
098496     PERFORM                                                      09849636
098497             UNTIL ((SQLCODE = PC-END-OF-CURSOR-SQLCODE)          09849736
098498                     OR (PV-DE-LAST-DB2-ACTION NOT = SPACES))     09849836
098499         ADD +1 TO PV-RESULTS-DETAIL-RCDS-WRITTEN                 09849936
098500         INITIALIZE DLCR-DETAIL-LINE                              09850036
098501         IF TP1PGMCP-COPY-NAME NOT = CK-CURRENT-COPY-NAME         09850136
098502             MOVE TP1PGMCP-COPY-NAME TO CK-CURRENT-COPY-NAME      09850236
098503                                        DLCR-COPY-NAME            09850336
098504         END-IF                                                   09850436
098505         MOVE TP1PGMCP-PGM-NAME TO DLCR-PGM-NAME                  09850536
098506         MOVE TP1PGM-PGM-DESC TO DLCR-PGM-DESC                    09850636
098507         MOVE DLCR-DETAIL-LINE TO XR-XREF-RESULTS-RECORD          09850736
098508         PERFORM 8000-WRITE-RESULTS-RECORD                        09850836
098509         PERFORM 7300-FETCH-COPY-ROW                              09850936
098510     END-PERFORM.                                                 09851036
098511                                                                  09851136
098512     IF PV-DE-LAST-DB2-ACTION = SPACES                            09851236
098513         EXEC SQL                                                 09851336
098514             CLOSE COPY_CURSOR                                    09851436
098515         END-EXEC                                                 09851536
098516                                                                  09851636
098517         IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                   09851736
098518             SET PV-CLOSE-COPY-CURSOR TO TRUE                     09851836
098519         END-IF                                                   09851936
098520     END-IF.                                                      09852036
098521*3300-EXIT.                                                       09852136
098522                                                                  09852236
098523******************************************************************09852336
098524*  FORMAT THE RESULTS FILE FOR A PROGRAM/COPYBOOKS USED REQUEST. *09852436
098525*  BUILD A HOST VARIABLE FOR THE LIKE CLAUSE SATISFYING THE      *09852536
098526*  REQUEST.  WRITE OUT THE FORMATTED RESULTS HEADER LINES.  OPEN *09852636
098527*  THE PROGRAM/COPYBOOKS USED CURSOR.  FORMAT AND WRITE RESULTS  *09852736
098528*  RECORDS FOR EACH COPYBOOK ROW FETCHED.  CLOSE THE PROGRAM/    *09852836
098529*  COPYBOOKS USED CURSOR.                                        *09852936
098530******************************************************************09853036
098531                                                                  09853136
098532 3400-FORMAT-PGM-COPY-RESULTS.                                    09853236
098533     SET PV-COPYBOOKS-USED-BY-PROGRAM TO TRUE.                    09853351
098534                                                                  09853453
098535*                                                                 09853553
098536*  BUILD THE HOST VARIABLE FOR THE PROGRAM NAME, WITH WILDCARD    09853653
098537*  CHARACTERS ON BOTH SIDES OF THE SPECIFICATION, IF SPACE ALLOWS.09853753
098538*  WILDCARDING WILL OCCUR ON THE RIGHT ONLY, IF SPACE ONLY PERMITS09853853
098539*  ONE WILDCARD CHARACTER.                                        09853953
098540*                                                                 09854053
098541                                                                  09854151
098542     INITIALIZE PV-LEFT-JUST-WORK-AREA                            09854236
098543                PV-TALLY.                                         09854336
098544     INSPECT ID-CMNEKX0-CMNEKXPG                                  09854436
098545         TALLYING PV-TALLY FOR LEADING SPACES.                    09854536
098546     MOVE ID-CMNEKX0-CMNEKXPG ((PV-TALLY + 1):                    09854636
098547                   (LENGTH OF ID-CMNEKX0-CMNEKXPG - PV-TALLY)) TO 09854736
098548               PV-LEFT-JUST-WORK-AREA                             09854836
098549     INITIALIZE PV-TALLY.                                         09854936
098550     INSPECT PV-LEFT-JUST-WORK-AREA                               09855036
098551         TALLYING PV-TALLY FOR CHARACTERS BEFORE INITIAL SPACES.  09855136
098552     SET PV-WPN-MASK TO TRUE.                                     09855236
098553     MOVE +1 TO PV-START-LOCATION.                                09855336
098554     IF PV-TALLY < ((LENGTH OF ID-CMNEKX0-CMNEKXPG) - 1)          09855436
098555         ADD +1 TO PV-START-LOCATION                              09855536
098556     END-IF.                                                      09855636
098557     MOVE PV-LEFT-JUST-WORK-AREA (1:PV-TALLY) TO                  09855736
098558               PV-WILDCARDED-PGM-NAME                             09855836
098559                                    (PV-START-LOCATION:PV-TALLY)  09855936
098560                                                                  09856054
098561*                                                                 09856154
098562*  WRITE HEADING INFORMATION OUT TO THE RESULTS FILE              09856254
098563*                                                                 09856354
098564                                                                  09856436
098565     INITIALIZE PV-HEADING-LINE-COUNT.                            09856546
098566     MOVE HL1PC-HEADING-LINE-1 TO XR-XREF-RESULTS-RECORD.         09856636
098567     PERFORM 8000-WRITE-RESULTS-RECORD.                           09856736
098568     ADD +1 TO PV-HEADING-LINE-COUNT.                             09856846
098569     INITIALIZE XR-XREF-RESULTS-RECORD.                           09856936
098570     PERFORM 8000-WRITE-RESULTS-RECORD.                           09857036
098571     ADD +1 TO PV-HEADING-LINE-COUNT.                             09857146
098572     INITIALIZE HL2PC-WILDCARDED-PGM-NAME                         09857236
098573                PV-TALLY.                                         09857336
098574     INSPECT PV-WILDCARDED-PGM-NAME                               09857436
098575         TALLYING PV-TALLY                                        09857536
098576         FOR CHARACTERS BEFORE INITIAL PC-WILDCARD-REPEAT.        09857636
098577     IF PV-TALLY < (LENGTH OF PV-WILDCARDED-PGM-NAME)             09857736
098578         ADD +1 TO PV-TALLY                                       09857836
098579     END-IF.                                                      09857936
098580     MOVE PV-WILDCARDED-PGM-NAME (1:PV-TALLY) TO                  09858036
098581               HL2PC-WILDCARDED-PGM-NAME (1:PV-TALLY).            09858136
098582     MOVE HL2PC-HEADING-LINE-2 TO XR-XREF-RESULTS-RECORD.         09858236
098583     PERFORM 8000-WRITE-RESULTS-RECORD.                           09858336
098584     ADD +1 TO PV-HEADING-LINE-COUNT.                             09858446
098585     INITIALIZE XR-XREF-RESULTS-RECORD.                           09858536
098586     PERFORM 8000-WRITE-RESULTS-RECORD.                           09858636
098587     ADD +1 TO PV-HEADING-LINE-COUNT.                             09858746
098588     MOVE HL3PC-HEADING-LINE-3 TO XR-XREF-RESULTS-RECORD.         09858836
098589     PERFORM 8000-WRITE-RESULTS-RECORD.                           09858936
098590     ADD +1 TO PV-HEADING-LINE-COUNT.                             09859046
098591     MOVE HL4PC-HEADING-LINE-4 TO XR-XREF-RESULTS-RECORD.         09859136
098592     PERFORM 8000-WRITE-RESULTS-RECORD.                           09859236
098593     ADD +1 TO PV-HEADING-LINE-COUNT.                             09859346
098594                                                                  09859454
098595*                                                                 09859554
098596*  EXECUTE THE CROSS REFERENCE QUERY - OPEN THE CURSOR            09859654
098597*                                                                 09859754
098598                                                                  09859836
098599     INITIALIZE PV-RETRY-COUNT.                                   09859936
098600     PERFORM                                                      09860036
098601             WITH TEST AFTER                                      09860136
098602             UNTIL ((SQLCODE = PC-SUCCESSFUL-SQLCODE)             09860236
098603                    OR (PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT)) 09860336
098604         EXEC SQL                                                 09860436
098605             OPEN PGM_COPY_CURSOR                                 09860536
098606         END-EXEC                                                 09860636
098607                                                                  09860736
098608         EVALUATE TRUE                                            09860836
098609             WHEN SQLCODE = PC-RESOURCE-NOT-AVAIL-SQLCODE         09860936
098610             WHEN SQLCODE = PC-DEADLOCK-W-ROLLBCK-SQLCODE         09861036
098611             WHEN SQLCODE = PC-DEADLOCK-WO-ROLLBCK-SQLCODE        09861136
098612                 ADD +1 TO PV-RETRY-COUNT                         09861236
098613             WHEN SQLWARN0 NOT = SPACES                           09861336
098614             WHEN SQLCODE < ZERO                                  09861436
098615             WHEN SQLCODE > ZERO                                  09861536
098616                 SET PV-OPEN-PGM-COPY-CURSOR TO TRUE              09861636
098617         END-EVALUATE                                             09861736
098618     END-PERFORM.                                                 09861836
098619                                                                  09861936
098620     IF PV-RETRY-COUNT > PC-MAXIMUM-RETRY-COUNT                   09862036
098621         SET PV-OPEN-PGM-COPY-CURSOR TO TRUE                      09862136
098622     END-IF.                                                      09862236
098623                                                                  09862354
098624*                                                                 09862454
098625*  FORMAT AND WRITE A CROSS REFERENCE QUERY RESULTS RECORD        09862554
098626*  FOR EACH ROW RETURNED                                          09862654
098627*                                                                 09862754
098628                                                                  09862836
098629     IF PV-DE-LAST-DB2-ACTION = SPACES                            09862936
098630         PERFORM 7400-FETCH-PGM-COPY-ROW                          09863036
098631         INITIALIZE CK-CURRENT-PGM-NAME                           09863136
098632     END-IF.                                                      09863236
098633                                                                  09863336
098634     PERFORM                                                      09863436
098635             UNTIL ((SQLCODE = PC-END-OF-CURSOR-SQLCODE)          09863536
098636                     OR (PV-DE-LAST-DB2-ACTION NOT = SPACES))     09863636
098637         ADD +1 TO PV-RESULTS-DETAIL-RCDS-WRITTEN                 09863736
098638         INITIALIZE DLPC-DETAIL-LINE                              09863836
098639         IF TP1PGMCP-PGM-NAME NOT = CK-CURRENT-PGM-NAME           09863936
098640             MOVE TP1PGMCP-PGM-NAME TO CK-CURRENT-PGM-NAME        09864036
098641                                       DLPC-PGM-NAME              09864136
098642         END-IF                                                   09864236
098643         MOVE TP1PGMCP-COPY-NAME TO DLPC-COPY-NAME                09864336
098644         EVALUATE TP1COPY-TYPE-CODE                               09864436
098645             WHEN PC-TC-DB2-DCLGEN                                09864538
098646                 SET DLPC-TD-DB2-DCLGEN TO TRUE                   09864638
098647             WHEN PC-TC-ORACLE-DCLGEN                             09864738
098648                 SET DLPC-TD-ORACLE-DCLGEN TO TRUE                09864838
098649             WHEN PC-TC-UNKNOWN-SQL                               09864938
098650                 SET DLPC-TD-UNKNOWN-SQL TO TRUE                  09865038
098651             WHEN PC-TC-BMS-MAPDSECT                              09865138
098652                 SET DLPC-TD-BMS-MAPDSECT TO TRUE                 09865238
098653             WHEN PC-TC-SQL-SYSTEM-COPY                           09865338
098654                 SET DLPC-TD-SQL-SYSTEM-COPY TO TRUE              09865438
098655             WHEN PC-TC-CICS-SYSTEM-COPY                          09865538
098656                 SET DLPC-TD-CICS-SYSTEM-COPY TO TRUE             09865638
098657             WHEN PC-TC-NORMAL-COPY                               09865738
098658                 CONTINUE                                         09865838
098659             WHEN OTHER                                           09865938
098660                 SET DLPC-TD-UNKNOWN-TYPE TO TRUE                 09866038
098661         END-EVALUATE                                             09866138
098662         EVALUATE TP1COPY-STNDRD-CODE                             09866238
098663             WHEN PC-SC-COBOL                                     09866338
098664                 SET DLPC-LD-COBOL TO TRUE                        09866438
098665             WHEN PC-SC-ASSEMBLER                                 09866538
098666                 SET DLPC-LD-ASSEMBLER TO TRUE                    09866638
098667             WHEN PC-SC-DYL-280                                   09866738
098668                 SET DLPC-LD-DYL-280 TO TRUE                      09866838
098669             WHEN OTHER                                           09866938
098670                 SET DLPC-LD-UNKNOWN-LANGUAGE TO TRUE             09867038
098671         END-EVALUATE                                             09867138
098672         MOVE DLPC-DETAIL-LINE TO XR-XREF-RESULTS-RECORD          09867238
098673         PERFORM 8000-WRITE-RESULTS-RECORD                        09867338
098674         PERFORM 7400-FETCH-PGM-COPY-ROW                          09867438
098675     END-PERFORM.                                                 09867538
098676                                                                  09867638
098677     IF PV-DE-LAST-DB2-ACTION = SPACES                            09867738
098678         EXEC SQL                                                 09867838
098679             CLOSE PGM_COPY_CURSOR                                09867938
098680         END-EXEC                                                 09868038
098681                                                                  09868138
098682         IF SQLCODE NOT = PC-SUCCESSFUL-SQLCODE                   09868238
098683             SET PV-CLOSE-PGM-COPY-CURSOR TO TRUE                 09868338
098684         END-IF                                                   09868438
098685     END-IF.                                                      09868538
098690*3400-EXIT.                                                       09869038
102300                                                                  10230010
102400******************************************************************10240010
102500*  FETCH A ROW FROM THE DATASET NAME WHERE USED CURSOR.          *10250034
102600******************************************************************10260010
102700                                                                  10270010
102800 7100-FETCH-DSN-ROW.                                              10280011
102900     EXEC SQL                                                     10290010
103000         FETCH DSN_CURSOR                                         10300010
103100             INTO :TP1PROC-PROC-NAME,                             10310010
103200                  :TP1PROC-PROC-STEP-NAME,                        10320010
103300                  :TP1PROC-FILE-NAME,                             10330010
103400                  :TP1PROST-PGM-NAME                              10340010
103500     END-EXEC.                                                    10350010
103600                                                                  10360010
103700     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        10370010
103800             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                10380010
103900             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        10390010
104000             OR (SQLWARN0 NOT = SPACES))                          10400010
104100         SET PV-FETCH-DSN-ROW TO TRUE                             10410011
104200     END-IF.                                                      10420011
104300*7100-EXIT.                                                       10430010
104400                                                                  10440011
104500******************************************************************10450011
104600*  FETCH A ROW FROM THE PROGRAM WHERE USED CURSOR.               *10460034
104700******************************************************************10470011
104800                                                                  10480011
104900 7200-FETCH-PGM-ROW.                                              10490014
105000     EXEC SQL                                                     10500011
105100         FETCH PGM_CURSOR                                         10510011
105200             INTO :TP1PROST-PROC-NAME,                            10520011
105300                  :TP1PROST-PROC-STEP-NAME,                       10530011
105400                  :TP1PROST-PGM-NAME,                             10540011
105500                  :TP1PGM-PGM-DESC                                10550011
105600     END-EXEC.                                                    10560011
105700                                                                  10570011
105800     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        10580011
105900             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                10590011
106000             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        10600011
106100             OR (SQLWARN0 NOT = SPACES))                          10610011
106200         SET PV-FETCH-PGM-ROW TO TRUE                             10620036
106300     END-IF.                                                      10630011
106400*7200-EXIT.                                                       10640011
106410                                                                  10641036
106420******************************************************************10642036
106430*  FETCH A ROW FROM THE COPYBOOK WHERE USED CURSOR.              *10643036
106440******************************************************************10644036
106450                                                                  10645036
106460 7300-FETCH-COPY-ROW.                                             10646036
106470     EXEC SQL                                                     10647036
106480         FETCH COPY_CURSOR                                        10648036
106490             INTO :TP1PGMCP-COPY-NAME,                            10649036
106491                  :TP1PGMCP-PGM-NAME,                             10649136
106493                  :TP1PGM-PGM-DESC                                10649336
106494     END-EXEC.                                                    10649436
106495                                                                  10649536
106496     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        10649636
106497             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                10649736
106498             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        10649836
106499             OR (SQLWARN0 NOT = SPACES))                          10649936
106500         SET PV-FETCH-COPY-ROW TO TRUE                            10650036
106501     END-IF.                                                      10650136
106502*7300-EXIT.                                                       10650236
106503                                                                  10650336
106504******************************************************************10650436
106505*  FETCH A ROW FROM THE PROGRAM/COPYBOOKS USED CURSOR.           *10650536
106506******************************************************************10650636
106507                                                                  10650736
106508 7400-FETCH-PGM-COPY-ROW.                                         10650837
106509     EXEC SQL                                                     10650936
106510         FETCH PGM_COPY_CURSOR                                    10651036
106511             INTO :TP1PGMCP-PGM-NAME,                             10651136
106512                  :TP1PGMCP-COPY-NAME,                            10651236
106513                  :TP1COPY-TYPE-CODE,                             10651336
106514                  :TP1COPY-STNDRD-CODE                            10651436
106515     END-EXEC.                                                    10651536
106516                                                                  10651636
106517     IF ((SQLCODE < PC-SUCCESSFUL-SQLCODE)                        10651736
106518             OR ((SQLCODE > PC-SUCCESSFUL-SQLCODE)                10651836
106519             AND (SQLCODE NOT = PC-END-OF-CURSOR-SQLCODE))        10651936
106520             OR (SQLWARN0 NOT = SPACES))                          10652036
106521         SET PV-FETCH-PGM-COPY-ROW TO TRUE                        10652136
106522     END-IF.                                                      10652236
106523*7400-EXIT.                                                       10652336
106530                                                                  10653036
106600******************************************************************10660008
106700*  WRITE A CROSS REFERENCE RESULTS RECORD.                       *10670034
106800******************************************************************10680008
106900                                                                  10690008
107000 8000-WRITE-RESULTS-RECORD.                                       10700009
107100     WRITE XR-XREF-RESULTS-RECORD.                                10710009
107200*8000-EXIT.                                                       10720008
108100                                                                  10810008
108200******************************************************************10820008
108300*  DISPLAY THE CROSS REFERENCE QUERY REQUEST PANEL.              *10830034
108400******************************************************************10840008
108500                                                                  10850008
108600 9000-DISPLAY-REQUEST-PANEL.                                      10860008
108700     IF IV-CURSOR-POSITION = SPACES                               10870000
108800         MOVE IN-FIELD-CMNEKXOP TO IV-CURSOR-POSITION             10880036
108900     END-IF.                                                      10890000
109000                                                                  10900000
109100     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-DISPLAY   10910014
109200                                     IN-PANEL-CMNEKX0             10920002
109300                                     IV-ERROR-MESSAGE-FORMAT      10930000
109400                                     IV-CURSOR-POSITION.          10940000
109500                                                                  10950000
109600     INITIALIZE ID-SHORT-MESSAGE                                  10960000
109700                ID-LONG-MESSAGE                                   10970000
109800                IV-CURSOR-POSITION.                               10980000
109900                                                                  10990000
110000     SET IV-EM-DYNAMIC-SHORT-LONG-MSG TO TRUE.                    11000000
110100*9000-EXIT.                                                       11010002
110200                                                                  11020000
110300******************************************************************11030000
110400*  DISPLAY THE CROSS REFERENCE QUERY RESULTS PANEL -- BROWSE     *11040005
110500*  THE TEMPORARY DATASET THAT CONTAINS THE QUERY RESULTS.        *11050005
110600******************************************************************11060000
110700                                                                  11070000
110800 9100-DISPLAY-RESULTS-PANEL.                                      11080000
110900     MOVE IN-FIELD-COMMAND-LINE TO IV-CURSOR-POSITION.            11090000
111000                                                                  11100000
111100     CALL IC-ISPF-SERVICE-LINK USING IC-PDF-SERVICE-BROWSE        11110029
111200                                     PV-XREF-RESULTS-DSN-WO-USERID11120029
111300                                     PV-XREF-RESULTS-VOLUME       11130029
111400                                     PV-XREF-RESULTS-PASSWORD     11140029
111500                                     IN-PANEL-CMNEKX1.            11150029
111600*9100-EXIT.                                                       11160002
114500                                                                  11450009
114600******************************************************************11460008
114700*  ALLOCATE THE FORMATTED QUERY RESULTS FILE USING THE DYNALC    *11470053
114800*  SUBROUTINE.  ATTEMPT TO DELETE ANY EQUIVALENT DSN THAT IS     *11480034
114900*  ALREADY CATALOGED.                                            *11490034
115000******************************************************************11500008
115100                                                                  11510008
115200 9500-ALLOCATE-RESULTS-FILE.                                      11520008
115300     PERFORM 9600-DELETE-RESULTS-FILE.                            11530005
115400                                                                  11540005
115500     IF ((DP023-LASTRC = ZERO)                                    11550019
115600             OR (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST))   11560019
115700         INITIALIZE DP023-DYNALC-PARMS                            11570014
115800         MOVE PC-XREF-RESULTS-DDNAME TO DP023-DDNAME              11580005
115900         MOVE PV-XREF-RESULTS-DSN TO DP023-DSNAME                 11590005
116000         SET DP023-DISP-NEW TO TRUE                               11600014
116100         SET DP023-FREE-CLOSE-NO TO TRUE                          11610014
116200         SET DP023-RECFM-FIXED-BLOCK TO TRUE                      11620014
116300         MOVE LENGTH OF XR-XREF-RESULTS-RECORD TO DP023-RECSZ     11630014
116400         MOVE PC-XREF-RESULTS-RECORD-COUNT TO DP023-RECOUNT       11640005
116500                                                                  11650018
116600         SET DP023-DISABLE-DISPLAY-ABEND TO TRUE                  11660018
116700                                                                  11670005
116800         PERFORM DP023-0000-DYNALC                                11680005
116900         IF DP023-LASTRC = ZERO                                   11690018
117000             SET PS-XREF-RESULTS-ALLOCATED TO TRUE                11700005
117100         ELSE                                                     11710005
117200             SET PS-XREF-RESULTS-NOT-ALLOCATED TO TRUE            11720005
117300             MOVE DP023-DDNAME TO PV-DR-DDNAME                    11730016
117400             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       11740016
117500             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      11750016
117600             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO ID-LONG-MESSAGE  11760016
117700         END-IF                                                   11770005
117800     ELSE                                                         11780005
117900         SET PS-XREF-RESULTS-NOT-ALLOCATED TO TRUE                11790005
118000         MOVE DP023-DDNAME TO PV-DR-DDNAME                        11800016
118100         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           11810016
118200         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          11820016
118300         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO ID-LONG-MESSAGE      11830016
118400     END-IF.                                                      11840005
118500*9500-EXIT.                                                       11850002
118600                                                                  11860002
118700******************************************************************11870002
118800*  DELETE THE FORMATTED QUERY RESULTS FILE USING THE DYNALC      *11880053
118900*  SUBROUTINE.                                                   *11890034
119000******************************************************************11900002
119100                                                                  11910002
119200 9600-DELETE-RESULTS-FILE.                                        11920005
119300     INITIALIZE DP023-DYNALC-PARMS.                               11930014
119400     MOVE PC-XREF-RESULTS-DDNAME TO DP023-DDNAME                  11940014
119500     MOVE PV-XREF-RESULTS-DSN TO DP023-DSNAME                     11950014
119600     SET DP023-DISP-DELETE TO TRUE                                11960014
119700     SET DP023-FREE-CLOSE-NO TO TRUE                              11970014
119800     SET DP023-RECFM-FIXED-BLOCK TO TRUE                          11980014
119900     MOVE LENGTH OF XR-XREF-RESULTS-RECORD TO DP023-RECSZ         11990014
120000     INITIALIZE DP023-RECOUNT.                                    12000014
120100                                                                  12010018
120200     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     12020018
120300                                                                  12030005
120400     PERFORM DP023-0000-DYNALC.                                   12040005
120500*9600-EXIT.                                                       12050002
123500                                                                  12350002
123600*                                                                 12360002
123700*  DYNAMIC ALLOCATION ROUTINE                                     12370002
123800*                                                                 12380002
123900     COPY DPPD023.                                                12390002
