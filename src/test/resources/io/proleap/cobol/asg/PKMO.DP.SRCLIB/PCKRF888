000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKRF888.                                00040000
000500 AUTHOR.                 DEANNA BRANTNER.                         00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            APRIL, 2001.                             00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL GATHER ALL OF THE DATA NECESSARY TO REPRINT   00100000
001100* A LABEL USING AN RF APPLICATION.  THIS MODULE WILL BE CALLED    00110000
001200* BY THE FOLLOWING PROGRAMS:  PCKRF881, PCKRF882,                 00120000
001300*                                                                 00130000
001400* 10/2001 - DEANNA BRANTNER - AN AZI6/ASRA IS OCCURRING IN PRODUC-00140000
001500*           TION AND ABENDAID IS POINTING TO PARAGRAPH 5250-      00150000
001600*           CANNOT DIVIDE BY ZERO. DOES NOT ABEND IN TEST.        00160000
001700* 06/20/13- CHERI PARMLEY   - INCLUDE CALL TO SUKUT149 FOR RFID   00170079
001800*           DETERMINATION FOR SML AND P2L WITHIN THE CHECK-IN     00180000
001900*           PROCESS.                                              00190000
002000*           PR5148B - CLP - 06/20/2013 START/END                  00200000
002100*                                         CRQ# 0055296            00210000
002200* 07/23/13- SHOBHIT BAIJAL  - INCLUDED CHECK FOR WHETHER DC USES  00220000
002300*           RFID CARTON LABELS OR NOT.                            00230000
002400*           SB 07/23/13 PR5148B START/END                         00240000
002500* 12/14/13- CHERI PARMLEY -                                       00250073
002600*           WHEN SU093-VNDR-DPT-RFID-TAGS-YES AND                 00260073
002700*                SU093-DC-DEPT-TAGS-YES                           00270073
002800*                DO NOT PRINT RFID ON LABELS                      00280073
002900*                                         CRQ# 0068598            00290075
003000* 07/12/17  JIM ARENDT              CHG0176459                    00300078
003100*           ADDED CODE TO PROGRAM FOR THE "RFID TAG YOUR STORE/   00310078
003200*           SHORT-TERM SOLUTION" PROJECT.                         00320078
003300******************************************************************00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500 DATA DIVISION.                                                   00350000
003600******************************************************************00360000
003700 WORKING-STORAGE SECTION.                                         00370000
003800                                                                  00380000
003900 01  DK-DB2-KEYS.                                                 00390082
004000     05  DK-CARTON-ID             PIC S9(18)V COMP-3.             00400000
004100     05  DK-BARCODE-NBR           PIC X(22).                      00410000
004200     05  DK-BRCDE-NBR REDEFINES DK-BARCODE-NBR.                   00420000
004300         10 DK-ZEROES             PIC  9(02).                     00430000
004400         10 DK-BARCODE            PIC  9(18).                     00440000
004500         10 DK-SPACES             PIC  X(02).                     00450000
004600     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00460000
004700     05  DK-SHIPT-UNT-ID-2        PIC S9(18)V COMP-3.             00470000
004800     05  DK-ORD-NBR               PIC  S9(9) COMP.                00480000
004900     05  DK-PO-NBR                PIC  S9(9) COMP.                00490000
005000     05  DK-PO-RCVR               PIC  S9(9) COMP.                00500000
005100     05  DK-LNE-NBR               PIC  S9(9) COMP.                00510000
005200     05  DK-PREPK-ID              PIC  S9(4) COMP.                00520000
005300     05  DK-OPER-UNT-ID.                                          00530000
005400         10 FILLER                PIC X(01).                      00540000
005500         10 DK-OPER-UNT-ID-3      PIC X(03).                      00550000
005600     05  DK-DC-ORIGIN.                                            00560000
005700         10  FILLER               PIC X(01).                      00570000
005800         10  DK-DC-ORIGIN-3       PIC X(03).                      00580000
005900     05  DK-DEPT-CL-SKU-NBR.                                      00590000
006000         10  DK-DEPT-NBR          PIC 9(03).                      00600000
006100         10  DK-CL-NBR            PIC 9(02).                      00610000
006200         10  DK-SKU-NBR           PIC 9(03).                      00620000
006300     05  DK-PO-NBR-Z              PIC Z(08).                      00630000
006400     05  DK-RCVR-NBR              PIC X(03).                      00640000
006500     05  DK-WORK-PRC-FUNC-CDE.                                    00650000
006600         10  FILLER                   PIC X(03) VALUE 'LBL'.      00660000
006700         10  DK-WORK-LABEL-NBR        PIC 9(03) VALUE ZERO.       00670000
006800     05  DK-SYS-PRC-FUNC-CDE REDEFINES DK-WORK-PRC-FUNC-CDE       00680000
006900                                      PIC X(06).                  00690000
007000                                                                  00700000
007100*-----------------------------------------------------------------00710000
007200*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               00720000
007300*-----------------------------------------------------------------00730000
007400     COPY XLWS001.                                                00740000
007500                                                                  00750000
007600*-----------------------------------------------------------------00760000
007700*  COPYBOOK FOR LOCATION MODULE                                   00770000
007800*-----------------------------------------------------------------00780000
007900     COPY XLWS071.                                                00790000
008000                                                                  00800000
008100*----------------------------------------------------------------*00810000
008200* COPYBOOK USED TO GET BUYER NAME                                 00820000
008300*----------------------------------------------------------------*00830000
008400     COPY DPWS003.                                                00840000
008500                                                                  00850000
008600*----------------------------------------------------------------*00860000
008700*  CHECK DIGIT WORK AREA                                          00870000
008800*----------------------------------------------------------------*00880000
008900     COPY PCWS037.                                                00890000
009000                                                                  00900000
009100*----------------------------------------------------------------*00910000
009200* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00920000
009300*----------------------------------------------------------------*00930000
009400     COPY PCWS039.                                                00940000
009500                                                                  00950000
009600*----------------------------------------------------------------*00960000
009700*  COMMUNICATION AREA FOR SEASONAL SET MODULE (PCKUT025)         *00970000
009800*----------------------------------------------------------------*00980000
009900     COPY PCWS240.                                                00990000
010000                                                                  01000000
010100* PR5148B - CLP - 06/20/2013 START                                01010000
010200*---------------------------------------------------------------* 01020000
010300*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   01030000
010400*---------------------------------------------------------------* 01040000
010500     COPY SUWS093.                                                01050000
010600* PR5148B - CLP - 06/20/2013 END                                  01060000
010700                                                                  01070000
010800*----------------------------------------------------------------*01080000
010900*  PROGRAM CONSTANTS                                             *01090000
011000*----------------------------------------------------------------*01100000
011100 01  PC-PROGRAM-CONSTANTS.                                        01110000
011200     05  PC-OP-CO-NBR             PIC  X(02)  VALUE '03'.         01120000
011300     05  PC-OPER-UNT-ID           PIC S9(04)  VALUE +0 COMP.      01130000
011400     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE 'PCKRF888'.   01140000
011500     05  PC-LOCATION-MODULE       PIC  X(08)  VALUE 'XLKUT071'.   01150000
011600     05  PC-CALLED-FROM-PG        PIC  X(08)  VALUE SPACES.       01160000
011700     05  PC-MAX-RETRIES           PIC S9(04)  VALUE +3 COMP.      01170000
011800     05  PC-A                     PIC  X(01)  VALUE 'A'.          01180000
011900     05  PC-C                     PIC  X(01)  VALUE 'C'.          01190000
012000     05  PC-D                     PIC  X(01)  VALUE 'D'.          01200000
012100     05  PC-E                     PIC  X(01)  VALUE 'E'.          01210000
012200     05  PC-G                     PIC  X(01)  VALUE 'G'.          01220000
012300     05  PC-I                     PIC  X(01)  VALUE 'I'.          01230000
012400     05  PC-K                     PIC  X(01)  VALUE 'K'.          01240000
012500     05  PC-L                     PIC  X(01)  VALUE 'L'.          01250000
012600     05  PC-M                     PIC  X(01)  VALUE 'M'.          01260000
012700     05  PC-N                     PIC  X(01)  VALUE 'N'.          01270000
012800     05  PC-P                     PIC  X(01)  VALUE 'P'.          01280000
012900     05  PC-Q                     PIC  X(01)  VALUE 'Q'.          01290000
013000     05  PC-R                     PIC  X(01)  VALUE 'R'.          01300000
013100     05  PC-S                     PIC  X(01)  VALUE 'S'.          01310000
013200     05  PC-U                     PIC  X(01)  VALUE 'U'.          01320000
013300     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          01330000
013400     05  PC-PCKCS717              PIC  X(08)  VALUE 'PCKCS717'.   01340000
013500     05  PC-CSSL                  PIC  X(04)  VALUE 'CSSL'.       01350000
013600     05  PC-CS                    PIC  X(02)  VALUE 'CS'.         01360000
013700     05  PC-DS                    PIC  X(02)  VALUE 'DS'.         01370000
013800     05  PC-01                    PIC  X(02)  VALUE '01'.         01380000
013900     05  PC-0001                  PIC  X(04)  VALUE '0001'.       01390000
014000     05  PC-02                    PIC  X(02)  VALUE '02'.         01400000
014100     05  PC-03                    PIC  X(02)  VALUE '03'.         01410000
014200     05  PC-HDR                   PIC  X(03)  VALUE 'HDR'.        01420000
014300     05  PC-CRT                   PIC  X(03)  VALUE 'CRT'.        01430000
014400     05  PC-DPT                   PIC  X(03)  VALUE 'DPT'.        01440000
014500     05  PC-ASN                   PIC  X(03)  VALUE 'ASN'.        01450000
014600     05  PC-CKN                   PIC  X(03)  VALUE 'CKN'.        01460000
014610     05  PC-3WD                   PIC  X(03)  VALUE '3WD'.        01461080
014700     05  PC-SPACE                 PIC  X(01)  VALUE ' '.          01470000
014800     05  PC-1                     PIC S9(04)  VALUE +1     COMP.  01480000
014900     05  PC-ERROR                 PIC X(35)   VALUE               01490000
015000                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 01500000
015100     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.01510000
015200                                                                  01520000
015300*----------------------------------------------------------------*01530000
015400*  PROGRAM SWITCHES                                              *01540000
015500*----------------------------------------------------------------*01550000
015600 01  PS-PROGRAM-SWITCHES.                                         01560000
015700     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01570000
015800         88  PS-VALID-INPUT                          VALUE 'Y'.   01580000
015900         88  PS-INVALID-INPUT                        VALUE 'N'.   01590000
016000     05  PS-NEW-STORE-SW                 PIC  X(01)  VALUE 'N'.   01600000
016100         88  PS-NEW-STORE-YES                        VALUE 'Y'.   01610000
016200     05  PS-CARTON-ON-XREF-SW            PIC  X(01)  VALUE ' '.   01620000
016300         88  PS-CARTON-ON-XREF                       VALUE 'Y'.   01630000
016400         88  PS-CARTON-NOT-ON-XREF                   VALUE 'N'.   01640000
016500     05  PS-FIRST-PASS-SW                PIC  X(01)  VALUE 'Y'.   01650000
016600         88  PS-FIRST-PASS                           VALUE 'Y'.   01660000
016700         88  PS-NOT-FIRST-PASS                       VALUE 'N'.   01670000
016800     05  PS-SHOW-DEBUG-SW             PIC X(01) VALUE 'N'.        01680000
016900         88  PS-DONT-SHOW-DEBUG-INFO            VALUE 'N'.        01690000
017000         88  PS-SHOW-DEBUG-INFO                 VALUE 'Y'.        01700000
017100     05  PS-DUMP-TO-LOG-SW               PIC  X(01)  VALUE 'N'.   01710000
017200         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   01720000
017300         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   01730000
017400     05  PS-EOF-STRZNE-CSR-SW            PIC  X(01)  VALUE  'N'.  01740000
017500         88  PS-EOF-STRZNE-CSR                       VALUE  'Y'.  01750000
017600         88  PS-MORE-STRZNE-CSR                      VALUE  'N'.  01760000
017700     05  PS-FOUND-ON-TLBVRDA-SW          PIC  X(01)  VALUE  'N'.  01770000
017800         88  PS-FOUND-ON-TLBVRDA                     VALUE  'Y'.  01780000
017900         88  PS-NOT-FOUND-TLBVRDA                    VALUE  'N'.  01790000
018000     05  PS-ZERO-RCVR-SEQ-SW             PIC  X(01)  VALUE  'Y'.  01800000
018100         88  PS-ZERO-RCVR-SEQ-YES                    VALUE  'Y'.  01810000
018200         88  PS-ZERO-RCVR-SEQ-NO                     VALUE  'N'.  01820000
018300                                                                  01830080
018400     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   01840000
018500         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   01850000
018600         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   01860000
018700                                                                  01870080
018800                                                                  01880000
018900*----------------------------------------------------------------*01890000
019000*  PROGRAM VARIABLES                                             *01900000
019100*----------------------------------------------------------------*01910000
019200 01  PV-PROGRAM-VARIABLES.                                        01920000
019300     05  PV-LINE-SHPD-UNITS              PIC S9(9)V COMP-3.       01930000
019400     05  PV-COMMAREA-LENGTH              PIC S9(4) COMP           01940000
019500                                                    VALUE ZERO.   01950000
019600     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01960000
019700     05  PV-RECEIVER-NBR-X               PIC X(11).               01970000
019800     05  PV-CURRENT-DB2-DATE             PIC X(10)  VALUE SPACES. 01980000
019900     05  PV-CURRENT-DB2-DATE-R REDEFINES PV-CURRENT-DB2-DATE.     01990000
020000         10 PV-CURRENT-CC                PIC  9(02).              02000000
020100         10 PV-CURRENT-YY                PIC  9(02).              02010000
020200         10 FILLER                       PIC  X(01).              02020000
020300         10 PV-CURRENT-MM                PIC  9(02).              02030000
020400         10 FILLER                       PIC  X(01).              02040000
020500         10 PV-CURRENT-DD                PIC  9(02).              02050000
020600     05  PV-CURRENT-DB2-TIME             PIC X(08)  VALUE SPACES. 02060000
020700     05  PV-CURRENT-DB2-TIME-R REDEFINES PV-CURRENT-DB2-TIME.     02070000
020800         10 PV-CURRENT-HR                PIC  9(02).              02080000
020900         10 FILLER                       PIC  X(01).              02090000
021000         10 PV-CURRENT-MN                PIC  9(02).              02100000
021100         10 FILLER                       PIC  X(03).              02110000
021200                                                                  02120000
021300     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.02130000
021400     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      02140000
021500                                                 COMP.            02150000
021600     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         02160000
021700                                                 COMP SYNC.       02170000
021800     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    02180000
021900     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           02190000
022000         10 PV-DPKUT038-YY               PIC  X(02).              02200000
022100         10 PV-DPKUT038-MM               PIC  X(02).              02210000
022200         10 PV-DPKUT038-DD               PIC  X(02).              02220000
022300     05  PV-DPKUT038-MJR-CL.                                      02230000
022400         10 FILLER                       PIC  X(01) VALUE SPACE.  02240000
022500         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  02250000
022600                                                                  02260000
022700     05  PV-DEPT-CL-SKU.                                          02270000
022800         10  FILLER                   PIC X(01)      VALUE '('.   02280000
022900         10  PV-DEPT                  PIC 9(03)      VALUE ZEROES.02290000
023000         10  FILLER                   PIC X(01)      VALUE '-'.   02300000
023100         10  PV-CLASS                 PIC 9(02)      VALUE ZEROES.02310000
023200         10  FILLER                   PIC X(01)      VALUE ')'.   02320000
023300         10  PV-SKU                   PIC 9(03)      VALUE ZEROES.02330000
023400     05  PV-LBL-PRT-DATE.                                         02340000
023500         10  PV-LBL-PRT-MM            PIC 9(02)      VALUE ZEROES.02350000
023600         10  FILLER                   PIC X(01)      VALUE '-'.   02360000
023700         10  PV-LBL-PRT-DD            PIC 9(02)      VALUE ZEROES.02370000
023800         10  FILLER                   PIC X(01)      VALUE '-'.   02380000
023900         10  PV-LBL-PRT-YY            PIC 9(02)      VALUE ZEROES.02390000
024000     05  PV-LBL-PRT-TIME.                                         02400000
024100         10  PV-LBL-PRT-HR            PIC 9(02)      VALUE ZEROES.02410000
024200         10  FILLER                   PIC X(01)      VALUE ':'.   02420000
024300         10  PV-LBL-PRT-MN            PIC 9(02)      VALUE ZEROES.02430000
024400     05  PV-NO-OF-LBLS-COMP           PIC S9(04)     VALUE +0     02440000
024500                                                     COMP.        02450000
024600     05  PV-RETRY-COUNTER             PIC S9(04)     VALUE +0     02460000
024700                                                     COMP SYNC.   02470000
024800     05  PV-RETRY-CNT                 PIC S9(04)     VALUE +0     02480000
024900                                                     COMP SYNC.   02490000
025000     05  PV-RETRY-CNT-9               PIC 9(04)      VALUE ZERO.  02500000
025100     05  PV-DONE-PROCESSING-SW   PIC X(01)    VALUE 'N'.          02510000
025200         88  PV-DONE-PROCESSING               VALUE 'Y'.          02520000
025300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.02530000
025400     05  PV-SQL-CODE                     PIC  9(09)- VALUE ZERO.  02540000
025500     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  02550000
025600     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  02560000
025700     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  02570000
025800     05  PV-TCPLENG                      PIC  9(08)  VALUE ZERO.  02580000
025900     05  PV-FLAG                         PIC  9(08)  VALUE ZERO.  02590000
026000     05  PV-SML-BC-DIVERT-CDE.                                    02600000
026100         10  PV-SML-BC-DIVERT-PFX        PIC X(01) VALUE  SPACES. 02610000
026200         10  PV-SML-BC-STR-NBR-4         PIC X(04) VALUE  SPACES. 02620000
026300                                                                  02630000
026400     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  02640000
026500                                                     COMP SYNC.   02650000
026600     05  PV-DATE-PRINT-MM-DD-YY.                                  02660000
026700         10  PV-DATE-PRINT-MM2   PIC X(02)    VALUE SPACES.       02670000
026800         10  FILLER              PIC X(01)    VALUE '-'.          02680000
026900         10  PV-DATE-PRINT-DD2   PIC X(02)    VALUE SPACES.       02690000
027000         10  FILLER              PIC X(01)    VALUE '-'.          02700000
027100         10  PV-DATE-PRINT-YY2   PIC X(02)    VALUE SPACES.       02710000
027200                                                                  02720000
027300     05  PV-STR-NBR               PIC S9(04) COMP.                02730000
027400     05  PV-4-DGT-STR-NBR         PIC  9(04) VALUE ZEROES.        02740000
027500     05  PV-PO-LNE-NBR.                                           02750000
027600         10  FILLER              PIC X(01)    VALUE SPACES.       02760000
027700         10  PV-3-DGT-PO-LNE-NBR PIC X(03)    VALUE SPACES.       02770000
027800     05  PV-RCVR-SEQ-NBR.                                         02780000
027900         10  FILLER              PIC X(01)    VALUE SPACES.       02790000
028000         10  PV-2-DGT-RCVR-SEQ-NBR                                02800000
028100                                 PIC X(02)    VALUE SPACES.       02810000
028200     05  PV-SHIPPED-QTY          PIC S9(9)    VALUE ZEROES        02820000
028300                                                    COMP.         02830000
028400     05  PV-PREPK-UNT-QTY        PIC S9(9)    VALUE ZEROES        02840000
028500                                                    COMP.         02850000
028600                                                                  02860000
028700 01  WS-USERID                    PIC X(09).                      02870000
028800 01  PV-DEBUG-DISPLAY-STUFF.                                      02880000
028900     05  PV-DISP-NBR                  PIC 9(05) VALUE ZERO.       02890000
029000     05  PV-DISP-TASK                 PIC 9(04) VALUE ZERO.       02900000
029100     05  PV-DISP-PACKS                PIC 9(05) VALUE ZERO.       02910000
029200     05  PV-DISP-ODD-UNITS            PIC 9(05) VALUE ZERO.       02920000
029300     05  PV-DISP-RETCODE              PIC -9(07) VALUE ZERO.      02930000
029400     05  PV-DISP-OPER-UNT-ID          PIC 9(04) VALUE ZERO.       02940000
029500     05  PV-DISP-LOC                  PIC 9(04) VALUE ZERO.       02950000
029600     05  PV-DISP-PO                   PIC 9(08) VALUE ZERO.       02960000
029700     05  PV-DISP-LINE                 PIC 9(04) VALUE ZERO.       02970000
029800     05  PV-DISP-REC-SEQ-NBR          PIC 9(04) VALUE ZERO.       02980000
029900     05  PV-DISP-PREPK-ID             PIC 9(04) VALUE ZERO.       02990000
030000     05  PV-DISP-UPC                  PIC 9(15) VALUE ZERO.       03000000
030100     05  PV-DISP-SHPUNT               PIC 9(18) VALUE ZERO.       03010000
030200     05  PV-DISP-MSG-NBR              PIC 9(03) VALUE ZERO.       03020000
030300     05  PV-DISP-SYSTEM-TMST          PIC X(26) VALUE SPACES.     03030000
030400     05  PV-DISP-TABLE-1              PIC X(08) VALUE SPACES.     03040000
030500     05  PV-DISP-TABLE-2              PIC X(08) VALUE SPACES.     03050000
030600     05  PV-DISP-TABLE-3              PIC X(08) VALUE SPACES.     03060000
030700     05  PV-PREV-SEQUENCE             PIC S9(05) COMP-3           03070000
030800                                                     VALUE ZERO.  03080000
030900     05  PV-NEXT-SEQUENCE             PIC S9(05) COMP-3           03090000
031000                                                     VALUE ZERO.  03100000
031100     05  PV-XFER-NBR                  PIC S9(11) VALUE ZERO.      03110000
031200     05  PV-XFER-NBR-X REDEFINES PV-XFER-NBR.                     03120000
031300         10  PV-XFER-STR-NBR          PIC 9(05).                  03130000
031400         10  PV-XFER-SEQ-NBR          PIC 9(06).                  03140000
031500     05  PV-FAST-NBR.                                             03150000
031600         10  PV-FAST-STORE            PIC 9(05) VALUE ZERO.       03160000
031700         10  FILLER                   PIC X(01) VALUE '-'.        03170000
031800         10  PV-FAST-SEQ              PIC 9(06) VALUE ZERO.       03180000
031900         10  FILLER                   PIC X(01) VALUE '-'.        03190000
032000         10  PV-FAST-CHK-DIGIT        PIC 9(01) VALUE ZERO.       03200000
032100     05  PV-CART-UPC-MULT-CNT         PIC S9(09) COMP.            03210000
032110     05  PV-ENT-NAME                  PIC X(250).                 03211082
032120     05  PV-ENT-NAME-R REDEFINES PV-ENT-NAME.                     03212082
032130         10  PV-ENT-NAME-1-25         PIC X(25).                  03213082
032140         10  FILLER                   PIC X(225).                 03214082
032200                                                                  03220000
032300 01  PT-MSG-TABLE.                                                03230000
032400     05  PT-MSG-LINES OCCURS 200 TIMES                            03240000
032500                              INDEXED BY PT-MSG-IDX.              03250000
032600         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       03260000
032700         10  PT-MSG-LINE                 PIC X(69).               03270000
032800                                                                  03280000
032900* DSNTIAR OUTPUT LINES                                            03290000
033000     COPY DPWS004.                                                03300000
033100                                                                  03310000
033200******************************************************************03320000
033300*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 03330000
033400******************************************************************03340000
033500     COPY DPWS010I.                                               03350000
033600                                                                  03360000
033700                                                                  03370000
033800*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER L      03380000
033900     COPY DPWS015.                                                03390000
034000                                                                  03400000
034100*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      03410000
034200     COPY DFHAID.                                                 03420000
034300*----------------------------------------------------------------*03430000
034400*    ABEND PROCESSING COPYBOOK.                                  *03440000
034500*----------------------------------------------------------------*03450000
034600     COPY DPWS013.                                                03460000
034700                                                                  03470000
034800******************************************************************03480000
034900*  DB2 TABLE FOR                                                  03490000
035000******************************************************************03500000
035100     EXEC SQL                                                     03510000
035200          INCLUDE TMDSEAR                                         03520000
035300     END-EXEC.                                                    03530000
035400                                                                  03540000
035500******************************************************************03550000
035600*  DB2 TABLE FOR                                                  03560000
035700******************************************************************03570000
035800     EXEC SQL                                                     03580000
035900          INCLUDE TMDSEDP                                         03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200******************************************************************03620000
036300*  DB2 TABLE FOR SEASONAL SETS                                    03630000
036400******************************************************************03640000
036500     EXEC SQL                                                     03650000
036600          INCLUDE TSEASET                                         03660000
036700     END-EXEC.                                                    03670000
036800                                                                  03680000
036900******************************************************************03690000
037000*  DB2 TABLE FOR CONTROL                                          03700000
037100******************************************************************03710000
037200     EXEC SQL                                                     03720000
037300          INCLUDE TCOCNTL                                         03730000
037400     END-EXEC.                                                    03740000
037500                                                                  03750000
037600******************************************************************03760000
037700*  DB2 TABLE FOR SHIPMENT UNIT/UPC ASSOCIATION                    03770000
037800******************************************************************03780000
037900     EXEC SQL                                                     03790000
038000          INCLUDE SUT00028                                        03800000
038100     END-EXEC.                                                    03810000
038200                                                                  03820000
038300******************************************************************03830000
038400*  DB2 TABLE FOR OUTBOUND CARTON TABLE                            03840000
038500******************************************************************03850000
038600     EXEC SQL                                                     03860000
038700          INCLUDE SUT00024                                        03870000
038800     END-EXEC.                                                    03880000
038900                                                                  03890000
039000******************************************************************03900000
039100*  DB2 TABLE FOR PURCHASE ORDER TABLE                             03910000
039200******************************************************************03920000
039300     EXEC SQL                                                     03930000
039400          INCLUDE TPURCHS                                         03940000
039500     END-EXEC.                                                    03950000
039600                                                                  03960000
039700******************************************************************03970000
039800*  DB2 TABLE FOR VENDOR DEPARTMENT                                03980000
039900******************************************************************03990000
040000     EXEC SQL                                                     04000000
040100          INCLUDE TVNDDPT                                         04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040400******************************************************************04040000
040500*  DB2 TABLE FOR RECEIPT ITEM                                     04050000
040600******************************************************************04060000
040700     EXEC SQL                                                     04070000
040800          INCLUDE TRECITM                                         04080000
040900     END-EXEC.                                                    04090000
041000                                                                  04100000
041100                                                                  04110000
041200******************************************************************04120000
041300*  DB2 TABLE FOR PURCHASE ITEM                                    04130000
041400******************************************************************04140000
041500     EXEC SQL                                                     04150000
041600          INCLUDE TPURITM                                         04160000
041700     END-EXEC.                                                    04170000
041800                                                                  04180000
041900******************************************************************04190000
042000*  DB2 TABLE FOR RECEIVER                                         04200000
042100******************************************************************04210000
042200     EXEC SQL                                                     04220000
042300          INCLUDE TRECEIV                                         04230000
042400     END-EXEC.                                                    04240000
042500                                                                  04250000
042600******************************************************************04260000
042700*  DB2 TABLE FOR VIRTUAL LABEL DATA                               04270000
042800******************************************************************04280000
042900     EXEC SQL                                                     04290000
043000          INCLUDE TLBVRDA                                         04300000
043100     END-EXEC.                                                    04310000
043200                                                                  04320000
043300******************************************************************04330000
043400*  DB2 TABLE FOR DISTRIBUTION TRANSACTION HEADER                  04340000
043500******************************************************************04350000
043600     EXEC SQL                                                     04360000
043700          INCLUDE TDISTHD                                         04370000
043800     END-EXEC.                                                    04380000
043900                                                                  04390000
044000******************************************************************04400000
044100*  DB2 TABLE FOR DISTRIBUTION TRANSACTION DETAIL                  04410000
044200******************************************************************04420000
044300     EXEC SQL                                                     04430000
044400          INCLUDE TDISTDT                                         04440000
044500     END-EXEC.                                                    04450000
044600                                                                  04460000
044700******************************************************************04470000
044800*  DB2 TABLE FOR STORE ZONE                                       04480000
044900******************************************************************04490000
045000     EXEC SQL                                                     04500000
045100          INCLUDE TSTRZN                                          04510000
045200     END-EXEC.                                                    04520000
045300                                                                  04530000
045400******************************************************************04540000
045500*  DB2 TABLE FOR SUT_OTBND_VND                                    04550000
045600******************************************************************04560000
045700     EXEC SQL                                                     04570000
045800          INCLUDE SUT00026                                        04580000
045900     END-EXEC.                                                    04590000
046000                                                                  04600000
046100******************************************************************04610000
046200*  DB2 TABLE FOR TPKSLIP                                          04620000
046300******************************************************************04630000
046400     EXEC SQL                                                     04640000
046500          INCLUDE TPKSLIP                                         04650000
046600     END-EXEC.                                                    04660000
046700                                                                  04670000
046800******************************************************************04680000
046900*  DB2 TABLE FOR TSHUUPC - INBOUND UPC                            04690000
047000******************************************************************04700000
047100     EXEC SQL                                                     04710000
047200          INCLUDE TSHUUPC                                         04720000
047300     END-EXEC.                                                    04730000
047400                                                                  04740000
047500******************************************************************04750000
047600*  DB2 TABLE FOR TINPKSU                                          04760000
047700******************************************************************04770000
047800     EXEC SQL                                                     04780000
047900          INCLUDE TINPKSU                                         04790000
048000     END-EXEC.                                                    04800000
048100                                                                  04810000
048200                                                                  04820080
048300******************************************************************04830000
048400*  DB2 TABLE FOR TSHUNLO                                          04840000
048500******************************************************************04850000
048600     EXEC SQL                                                     04860000
048700          INCLUDE TSHUNLO                                         04870000
048800     END-EXEC.                                                    04880000
048900                                                                  04890080
049000                                                                  04900000
049010******************************************************************04901082
049020*  DB2 TABLE FOR TENTNME                                          04902082
049030******************************************************************04903082
049040     EXEC SQL                                                     04904082
049050          INCLUDE TENTNME                                         04905082
049060     END-EXEC.                                                    04906082
049070                                                                  04907082
049080                                                                  04908082
049100*----------------------------------------------------------------*04910000
049200*  COMMUNICATIONS AREA FOR DB2                                   *04920000
049300*----------------------------------------------------------------*04930000
049400     EXEC SQL                                                     04940000
049500         INCLUDE SQLCA                                            04950000
049600     END-EXEC.                                                    04960000
049700                                                                  04970000
049800******************************************************************04980000
049900*  STORE ZONE CURSOR                                              04990000
050000******************************************************************05000000
050100     EXEC SQL                                                     05010000
050200         DECLARE  STRZNE_CURSOR CURSOR FOR                        05020000
050300          SELECT  STR_ZN_ID                                       05030000
050400            FROM  TSTRZN                                          05040000
050500        ORDER BY  STR_ZN_ID                                       05050000
050600     END-EXEC.                                                    05060000
050700                                                                  05070000
050800******************************************************************05080000
050900 LINKAGE SECTION.                                                 05090000
051000******************************************************************05100000
051100 01  DFHCOMMAREA                         PIC  X(400).             05110000
051200                                                                  05120000
051300******************************************************************05130000
051400 PROCEDURE DIVISION.                                              05140000
051500******************************************************************05150000
051600 0000-PROGRAM-MAINLINE.                                           05160000
051700     INITIALIZE PC039-COMMAREA-REC.                               05170000
051800     MOVE DFHCOMMAREA           TO PC039-COMMAREA-REC.            05180000
051900     MOVE PC039-CALLED-PGM-NME  TO  PC-CALLED-FROM-PG.            05190000
052000                                                                  05200000
052100     MOVE PC039-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             05210000
052200     MOVE PC039-KOHLS-BARCODE     TO DK-BARCODE-NBR.              05220000
052300                                                                  05230000
052400     EVALUATE TRUE                                                05240000
052500         WHEN PC039-SRC-CSEPK-SPLT                                05250000
052600             SET PC039-CSEPK-SML TO TRUE                          05260000
052700             PERFORM 8000-GET-LOCATION-INFO                       05270000
052800             PERFORM 1000-GET-CART-UPC-INFO                       05280000
052900             PERFORM 3000-GET-MORE-INFO                           05290000
053000             PERFORM 6000-GET-DEPT-NAME                           05300000
053100             PERFORM 6300-GET-SEASONAL-SET                        05310000
053200             PERFORM 6400-GET-STORE-ZONE                          05320000
053300         WHEN PC039-SRC-ASN                                       05330000
053400         WHEN PC039-SRC-CHECK-IN                                  05340000
053500             PERFORM 2000-GET-LBVRDA-INFO                         05350000
053600             IF PS-FOUND-ON-TLBVRDA                               05360000
053700                 PERFORM 3000-GET-MORE-INFO                       05370000
053800             ELSE                                                 05380000
053900                 IF  PC039-LBL-FORMAT = PC-P                      05390000
054000                     MOVE PC-D TO PC039-LBL-FORMAT                05400000
054100                 ELSE                                             05410000
054200                 IF  PC039-LBL-FORMAT = PC-C                      05420000
054300                     MOVE PC-C TO PC039-LBL-FORMAT                05430000
054400                 ELSE                                             05440000
054500                     MOVE PC-S TO PC039-LBL-FORMAT                05450000
054600                 END-IF                                           05460000
054700                 END-IF                                           05470000
054800                 SET PC039-4-BY-4-LBL           TO TRUE           05480000
054900                 IF  PC039-DEST-LBL  OR  PC039-PCK-2-LIT          05490000
055000                     PERFORM 1010-GET-CART-UPC-INFO-INBND         05500000
055100                 ELSE                                             05510000
055200                     PERFORM 1000-GET-CART-UPC-INFO               05520000
055300                 END-IF                                           05530000
055400                 IF PS-ZERO-RCVR-SEQ-YES AND                      05540000
055500                    PS-FOUND-ON-TLBVRDA                           05550000
055600                    PERFORM 2500-GET-VND-CART-INFO                05560000
055700                 END-IF                                           05570000
055800                 PERFORM 3000-GET-MORE-INFO                       05580000
055900                 PERFORM 6000-GET-DEPT-NAME                       05590000
056000                 PERFORM 6300-GET-SEASONAL-SET                    05600000
056100                 PERFORM 6400-GET-STORE-ZONE                      05610000
056200                 PERFORM 8000-GET-LOCATION-INFO                   05620000
056300                 PERFORM 8500-GET-OUTER-PACK                      05630000
056400             END-IF                                               05640000
056500                                                                  05650080
056600             PERFORM 5900-CALL-RFID-DETERMINATION                 05660000
056700             IF PS-RFID-ON-LABEL-YES                              05670000
056800                SET PC039-RFID-YES TO TRUE                        05680000
056900                                                                  05690080
057000                IF SU093-DC-USE-RFID-CART-LBL-YES                 05700000
057100                   PERFORM 5950-CHECK-RFD-CRTN-LBL-PRINT          05710000
057200                END-IF                                            05720000
057300                                                                  05730080
057400                EVALUATE TRUE                                     05740078
057500                    WHEN SU093-PRINT-RFID-EAS                     05750078
057600                       SET PC039-PRINT-RFID-EAS TO TRUE           05760078
057700                    WHEN SU093-PRINT-RFID                         05770078
057800                       SET PC039-PRINT-RFID     TO TRUE           05780078
057900                    WHEN SU093-PRINT-EAS                          05790078
058000                       SET PC039-PRINT-EAS      TO TRUE           05800078
058100                END-EVALUATE                                      05810078
058200             ELSE                                                 05820000
058300                SET PC039-RFID-NO  TO TRUE                        05830000
058400             END-IF                                               05840000
058500                                                                  05850080
058600         WHEN PC039-SRC-P2L                                       05860000
058700         WHEN PC039-SRC-JWL                                       05870000
058800             SET PC039-PCK-2-LIT   TO TRUE                        05880000
058900             SET PC039-4-BY-4-LBL  TO TRUE                        05890000
059000             PERFORM 4000-GET-ZONE-INFO                           05900000
059100             MOVE PC039-SU-BC-DIVERT-CD  TO  PV-SML-BC-DIVERT-CDE 05910000
059200             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     05920000
059300                                             PC039-STR-NBR        05930000
059400             PERFORM 8000-GET-LOCATION-INFO                       05940000
059500         WHEN PC039-SRC-RDM                                       05950000
059600         WHEN PC039-SRC-RECEIVING                                 05960000
059700         WHEN PC039-SRC-MANUAL                                    05970000
059800             SET PC039-GENERIC-SML TO TRUE                        05980000
059900             SET PC039-4-BY-4-LBL  TO TRUE                        05990000
060000             PERFORM 4000-GET-ZONE-INFO                           06000000
060100             MOVE PC039-SU-BC-DIVERT-CD  TO  PV-SML-BC-DIVERT-CDE 06010000
060200             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06020000
060300                                             PC039-STR-NBR        06030000
060400             PERFORM 8000-GET-LOCATION-INFO                       06040000
060500         WHEN PC039-SRC-SMOOTHING                                 06050000
060600             SET PC039-SMOOTHING  TO TRUE                         06060000
060700             SET PC039-4-BY-4-LBL  TO TRUE                        06070000
060800             PERFORM 1000-GET-CART-UPC-INFO                       06080000
060900             PERFORM 3000-GET-MORE-INFO                           06090000
061000             PERFORM 6000-GET-DEPT-NAME                           06100000
061100             PERFORM 6250-CHECK-FOR-MULT                          06110000
061200             IF PV-CART-UPC-MULT-CNT > 1                          06120000
061300                 MOVE ZEROES                   TO PC039-LNE-NBR   06130000
061400                 MOVE '@@@@@@@@@@@'            TO PC039-SKU       06140000
061500                 MOVE '***MULTIPLE LINES ***'  TO PC039-STYLE     06150000
061600             END-IF                                               06160000
061700         WHEN PC039-SRC-FAST-TRANSFR                              06170000
061800             SET PC039-GENERIC-SML TO TRUE                        06180000
061900             SET PC039-4-BY-4-LBL  TO TRUE                        06190000
062000             MOVE PC039-SU-BC-DIVERT-CD  TO  PV-SML-BC-DIVERT-CDE 06200000
062100             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06210000
062200                                             PC039-STR-NBR        06220000
062300             PERFORM 8000-GET-LOCATION-INFO                       06230000
062400             PERFORM 7000-GET-XFER-NBR                            06240000
062410         WHEN PC039-SRC-3WD                                       06241081
062420             SET PC039-GENERIC-SML TO TRUE                        06242081
062430             SET PC039-4-BY-4-LBL  TO TRUE                        06243081
062440             PERFORM 4000-GET-ZONE-INFO                           06244081
062450             MOVE PC039-SU-BC-DIVERT-CD  TO  PV-SML-BC-DIVERT-CDE 06245081
062460             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06246081
062470                                             PC039-STR-NBR        06247081
062471             PERFORM 5400-GET-ENT-NAME                            06247182
062472             MOVE '*3 PRTY WHSE DISTRO*' TO PC039-RF-ZNE-LINE-1   06247281
062473             MOVE PV-ENT-NAME-1-25       TO PC039-RF-ZNE-LINE-2   06247382
062474             MOVE SPACES                 TO PC039-RF-ZNE-LINE-3   06247482
062480             PERFORM 8000-GET-LOCATION-INFO                       06248081
062500         WHEN PC039-SRC-MSTR-CNTR                                 06250000
062600             SET PC039-GENERIC-SML       TO TRUE                  06260000
062700             SET PC039-4-BY-4-LBL        TO TRUE                  06270000
062800             MOVE '* MASTER CONTAINER *' TO PC039-RF-ZNE-LINE-1   06280000
062900             MOVE SPACES                 TO PC039-RF-ZNE-LINE-2   06290000
063000                                            PC039-RF-ZNE-LINE-3   06300000
063100             MOVE PC039-SU-BC-DIVERT-CD  TO PV-SML-BC-DIVERT-CDE  06310000
063200             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06320000
063300                                             PC039-STR-NBR        06330000
063400             PERFORM 8000-GET-LOCATION-INFO                       06340000
063500         WHEN PC039-SRC-CRTN-BULD                                 06350000
063600             SET PC039-CRTN-BUILD        TO TRUE                  06360000
063700             SET PC039-4-BY-4-LBL        TO TRUE                  06370000
063800             MOVE SPACES                 TO PC039-RF-ZNE-LINE-1   06380000
063900                                            PC039-RF-ZNE-LINE-2   06390000
064000                                            PC039-RF-ZNE-LINE-3   06400000
064100             MOVE PC039-SU-BC-DIVERT-CD  TO PV-SML-BC-DIVERT-CDE  06410000
064200             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06420000
064300                                             PC039-STR-NBR        06430000
064400             PERFORM 8000-GET-LOCATION-INFO                       06440000
064500         WHEN OTHER                                               06450000
064600             SET PC039-GENERIC-SML       TO TRUE                  06460000
064700             SET PC039-4-BY-4-LBL        TO TRUE                  06470000
064800             MOVE SPACES                 TO PC039-RF-ZNE-LINE-1   06480000
064900                                            PC039-RF-ZNE-LINE-2   06490000
065000                                            PC039-RF-ZNE-LINE-3   06500000
065100             MOVE PC039-SU-BC-DIVERT-CD  TO PV-SML-BC-DIVERT-CDE  06510000
065200             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     06520000
065300                                             PC039-STR-NBR        06530000
065400             PERFORM 8000-GET-LOCATION-INFO                       06540000
065500     END-EVALUATE                                                 06550000
065600                                                                  06560000
065700     IF PV-DONE-PROCESSING                                        06570000
065800         SET PC039-SUCCESSFUL TO TRUE                             06580000
065900         MOVE PC039-CALLED-PGM-NME  TO  PC-CALLED-FROM-PG         06590000
066000         PERFORM 9998-RETURN                                      06600000
066100     END-IF.                                                      06610000
066200                                                                  06620000
066300     SET PC039-SUCCESSFUL TO TRUE.                                06630000
066400     MOVE PC-CALLED-FROM-PG  TO  PC039-CALLED-PGM-NME.            06640000
066500     PERFORM 9998-RETURN.                                         06650000
066600                                                                  06660000
066700*-----------------------------------------------------------------06670000
066800 1000-GET-CART-UPC-INFO.                                          06680000
066900*-----------------------------------------------------------------06690000
067000     EXEC SQL                                                     06700000
067100          SELECT  A.TRN_NBR                                       06710000
067200                 ,A.TRN_LNE_NBR                                   06720000
067300                 ,A.SHPD_UNT_QTY                                  06730000
067400                 ,A.UPC_NBR                                       06740000
067500                 ,A.RCVR_SEQ_NBR                                  06750000
067600                 ,B.CART_TYP_CDE                                  06760000
067700            INTO :SUT00028-TRN-NBR                                06770000
067800                ,:SUT00028-TRN-LNE-NBR                            06780000
067900                ,:SUT00028-SHPD-UNT-QTY                           06790000
068000                ,:SUT00028-UPC-NBR                                06800000
068100                ,:SUT00028-RCVR-SEQ-NBR                           06810000
068200                ,:SUT00024-CART-TYP-CDE                           06820000
068300            FROM  SUT_OTBND_UPC A                                 06830000
068400               ,  SUT_OTBND_CART B                                06840000
068500           WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              06850000
068600             AND  A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               06860000
068700     END-EXEC.                                                    06870000
068800                                                                  06880000
068900     EVALUATE TRUE                                                06890000
069000         WHEN SQLCODE = ZERO                                      06900000
069100             MOVE SUT00028-TRN-NBR    TO  PC039-PO-NBR            06910000
069200             MOVE SUT00028-TRN-LNE-NBR TO PC039-LNE-NBR           06920000
069300             MOVE SUT00028-RCVR-SEQ-NBR TO PC039-PO-RCVR          06930000
069400             MOVE SUT00024-CART-TYP-CDE  TO PC039-CASE-TYPE       06940000
069500             IF SUT00028-RCVR-SEQ-NBR = 0                         06950000
069600                SET PS-ZERO-RCVR-SEQ-YES TO TRUE                  06960000
069700                PERFORM 2500-GET-VND-CART-INFO                    06970000
069800             ELSE                                                 06980000
069900                SET PS-ZERO-RCVR-SEQ-NO  TO TRUE                  06990000
070000             END-IF                                               07000000
070100             PERFORM 5000-GET-PREPACK-INFO                        07010000
070200         WHEN SQLCODE = -811                                      07020000
070300             MOVE SUT00028-TRN-NBR    TO  PC039-PO-NBR            07030000
070400             MOVE SUT00028-TRN-LNE-NBR TO PC039-LNE-NBR           07040000
070500             MOVE SUT00028-RCVR-SEQ-NBR TO PC039-PO-RCVR          07050000
070600             MOVE SUT00024-CART-TYP-CDE  TO PC039-CASE-TYPE       07060000
070700             IF SUT00028-RCVR-SEQ-NBR = 0                         07070000
070800                SET PS-ZERO-RCVR-SEQ-YES TO TRUE                  07080000
070900                PERFORM 2500-GET-VND-CART-INFO                    07090000
071000             ELSE                                                 07100000
071100                SET PS-ZERO-RCVR-SEQ-NO  TO TRUE                  07110000
071200             END-IF                                               07120000
071300             PERFORM 5000-GET-PREPACK-INFO                        07130000
071400         WHEN SQLCODE = +100                                      07140000
071500             CONTINUE                                             07150000
071600         WHEN OTHER                                               07160000
071700             SET PV-DONE-PROCESSING                               07170000
071800                 PC039-ERROR                 TO TRUE              07180000
071900             MOVE SQLCODE                    TO PV-SQL-CODE       07190000
072000             STRING ' PCKRF888 - '          DELIMITED BY SIZE     07200000
072100                  '1000-GET-CART-UPC-INFO'  DELIMITED BY SIZE     07210000
072200                    ' SQL ERROR = '         DELIMITED BY SIZE     07220000
072300                    PV-SQL-CODE             DELIMITED BY SIZE     07230000
072400                                       INTO PV-CICS-MSG-AREA      07240000
072500             SET PS-DUMP-TO-LOG       TO TRUE                     07250000
072600             PERFORM 9990-WRITE-CICS                              07260000
072700     END-EVALUATE.                                                07270000
072800                                                                  07280000
072900*-----------------------------------------------------------------07290000
073000 1010-GET-CART-UPC-INFO-INBND.                                    07300000
073100*-----------------------------------------------------------------07310000
073200     EXEC SQL                                                     07320000
073300          SELECT  A.TRN_NBR                                       07330000
073400                 ,A.TRN_LNE_NBR                                   07340000
073500                 ,A.SHPD_QTY                                      07350000
073600                 ,A.UPC_NBR                                       07360000
073700                 ,C.REC_SEQ_NBR                                   07370000
073800            INTO :SHUUPC-TRN-NBR                                  07380000
073900                ,:SHUUPC-TRN-LNE-NBR                              07390000
074000                ,:SHUUPC-SHPD-QTY                                 07400000
074100                ,:SHUUPC-UPC-NBR                                  07410000
074200                ,:PKSLIP-REC-SEQ-NBR                              07420000
074300            FROM  TSHUUPC A                                       07430000
074400               ,  TINPKSU B                                       07440000
074500               ,  TPKSLIP C                                       07450000
074600           WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID              07460000
074700             AND  A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               07470000
074800             AND  B.PO_NBR        =  C.PO_NBR                     07480000
074900             AND  B.SEQ_NBR       =  C.SEQ_NBR                    07490000
075000             AND  C.VER_STAT_CDE  =  'A'                          07500000
075100     END-EXEC.                                                    07510000
075200                                                                  07520000
075300     EVALUATE TRUE                                                07530000
075400         WHEN SQLCODE = ZERO                                      07540000
075500             MOVE SHUUPC-TRN-NBR       TO PC039-PO-NBR            07550000
075600             MOVE SHUUPC-TRN-LNE-NBR   TO PC039-LNE-NBR           07560000
075700             MOVE PKSLIP-REC-SEQ-NBR   TO PC039-PO-RCVR           07570000
075800             SET  PC039-FCSE           TO TRUE                    07580000
075900             PERFORM 5000-GET-PREPACK-INFO                        07590000
076000         WHEN SQLCODE = +100                                      07600000
076100             CONTINUE                                             07610000
076200         WHEN OTHER                                               07620000
076300             SET PV-DONE-PROCESSING                               07630000
076400                 PC039-ERROR                 TO TRUE              07640000
076500             MOVE SQLCODE                    TO PV-SQL-CODE       07650000
076600             STRING ' PCKRF888 - '          DELIMITED BY SIZE     07660000
076700                  '1000-GET-CART-UPC-INFO'  DELIMITED BY SIZE     07670000
076800                    ' SQL ERROR = '         DELIMITED BY SIZE     07680000
076900                    PV-SQL-CODE             DELIMITED BY SIZE     07690000
077000                                       INTO PV-CICS-MSG-AREA      07700000
077100             SET PS-DUMP-TO-LOG       TO TRUE                     07710000
077200             PERFORM 9990-WRITE-CICS                              07720000
077300     END-EVALUATE.                                                07730000
077400                                                                  07740000
077500*-----------------------------------------------------------------07750000
077600 2000-GET-LBVRDA-INFO.                                            07760000
077700*-----------------------------------------------------------------07770000
077800     MOVE PC039-STR-NBR     TO  PV-4-DGT-STR-NBR.                 07780000
077900     MOVE PV-4-DGT-STR-NBR  TO  PV-STR-NBR.                       07790000
078000     EXEC SQL                                                     07800000
078100          SELECT  PO_NBR                                          07810000
078200                 ,RCVR_SEQ_NBR                                    07820000
078300                 ,PREPK_ID                                        07830000
078400                 ,PO_LNE_NBR                                      07840000
078500                 ,PREPK_PRCG_LNE_NBR                              07850000
078600                 ,PREPK_ID                                        07860000
078700                 ,OTPK_UNT_QTY                                    07870000
078800                 ,INPK_UNT_QTY                                    07880000
078900                 ,DEPT_DESC                                       07890000
079000                 ,MAJ_CL_DESC                                     07900000
079100                 ,SEASET_NM                                       07910000
079200                 ,FIXT_ID                                         07920000
079300                 ,STR_ZN_ID                                       07930000
079400                 ,DEST_OPER_UNT_ID                                07940000
079500                 ,PREPK_RATO_QTY                                  07950000
079600                 ,PREPK_UNT_QTY                                   07960000
079700                 ,INPK_CNVYB_IND                                  07970000
079800            INTO :LBVRDA-PO-NBR                                   07980000
079900                ,:LBVRDA-RCVR-SEQ-NBR                             07990000
080000                ,:LBVRDA-PREPK-ID                                 08000000
080100                ,:LBVRDA-PO-LNE-NBR                               08010000
080200                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       08020000
080300                ,:LBVRDA-PREPK-ID                                 08030000
080400                ,:LBVRDA-OTPK-UNT-QTY                             08040000
080500                ,:LBVRDA-INPK-UNT-QTY                             08050000
080600                ,:LBVRDA-DEPT-DESC                                08060000
080700                ,:LBVRDA-MAJ-CL-DESC                              08070000
080800                ,:LBVRDA-SEASET-NM                                08080000
080900                ,:LBVRDA-FIXT-ID                                  08090000
081000                ,:LBVRDA-STR-ZN-ID                                08100000
081100                ,:LBVRDA-DEST-OPER-UNT-ID                         08110000
081200                ,:LBVRDA-PREPK-RATO-QTY                           08120000
081300                ,:LBVRDA-PREPK-UNT-QTY                            08130000
081400                ,:LBVRDA-INPK-CNVYB-IND                           08140000
081500            FROM  TLBVRDA                                         08150000
081600           WHERE  BRCDE_NBR         =  :DK-BARCODE-NBR            08160000
081700             AND  DEST_OPER_UNT_ID  =  :PV-STR-NBR                08170000
081800     END-EXEC.                                                    08180000
081900                                                                  08190000
082000     EVALUATE TRUE                                                08200000
082100         WHEN SQLCODE = ZERO                                      08210000
082200             IF PC039-LBL-FORMAT = PC-P                           08220000
082300                 MOVE PC-D TO PC039-LBL-FORMAT                    08230000
082400             ELSE                                                 08240000
082500             IF PC039-LBL-FORMAT = PC-C                           08250000
082600                 MOVE PC-C TO PC039-LBL-FORMAT                    08260000
082700             ELSE                                                 08270000
082800                 MOVE PC-S TO PC039-LBL-FORMAT                    08280000
082900             END-IF                                               08290000
083000             END-IF                                               08300000
083100             SET PC039-4-BY-4-LBL           TO TRUE               08310000
083200             MOVE LBVRDA-PO-NBR             TO PC039-PO-NBR       08320000
083300                                               DK-PO-NBR          08330000
083400             MOVE LBVRDA-RCVR-SEQ-NBR       TO PC039-PO-RCVR      08340000
083500                                               DK-PO-RCVR         08350000
083600             PERFORM 2010-GET-OTPK-FROM-UPC                       08360000
083700             MOVE LBVRDA-PREPK-ID           TO PC039-PREPK-ID     08370000
083800                                               DK-PREPK-ID        08380000
083900             IF LBVRDA-PREPK-ID > ZEROES                          08390000
084000                 MOVE LBVRDA-PREPK-PRCG-LNE-NBR TO PC039-LNE-NBR  08400000
084100                 SET PC039-PREPK            TO  TRUE              08410000
084200                 MOVE LBVRDA-PREPK-RATO-QTY  TO PC039-PREPK-RATIO 08420000
084300                 MOVE LBVRDA-PREPK-UNT-QTY  TO PC039-PREPK-UNT-QTY08430000
084400                 IF  LBVRDA-INPK-CNVYB-IND   = PC-Y               08440000
084500                     PERFORM 2030-GET-PREPK-INPK-QTY              08450000
084600                 END-IF                                           08460000
084700                 PERFORM 2050-GET-PREPACK-INFO                    08470000
084800                 IF RECITM-PREPK-RATO-QTY > ZEROES                08480000
084900                     COMPUTE  PC039-PACKS-IN-CRTN  =              08490000
085000                     PC039-PREPK-UNT-QTY / RECITM-PREPK-RATO-QTY  08500000
085100                 END-IF                                           08510000
085200             ELSE                                                 08520000
085300                 MOVE LBVRDA-PO-LNE-NBR     TO PC039-LNE-NBR      08530000
085400                 MOVE ZEROES                TO PC039-PREPK-RATIO  08540000
085500                                               PC039-PREPK-UNT-QTY08550000
085600                                               PC039-PACKS-IN-CRTN08560000
085700             END-IF                                               08570000
085800             MOVE LBVRDA-OTPK-UNT-QTY       TO PC039-OTPK-UNITS   08580000
085900             MOVE LBVRDA-INPK-UNT-QTY       TO PC039-INPK-UNITS   08590000
086000             MOVE LBVRDA-DEPT-DESC          TO PC039-DEPT-NAME    08600000
086100             MOVE LBVRDA-MAJ-CL-DESC        TO PC039-MAJOR-CLASS  08610000
086200             MOVE LBVRDA-SEASET-NM          TO PC039-SEASONAL-SET 08620000
086300             MOVE LBVRDA-FIXT-ID            TO PC039-FIXTURE      08630000
086400             MOVE LBVRDA-STR-ZN-ID          TO PC039-ZONE         08640000
086500             IF LBVRDA-INPK-CNVYB-IND   = PC-Y                    08650000
086600                 SET PC039-INPK   TO TRUE                         08660000
086700             ELSE                                                 08670000
086800                 SET PC039-FCSE   TO TRUE                         08680000
086900             END-IF                                               08690000
087000             SET PS-FOUND-ON-TLBVRDA TO TRUE                      08700000
087100         WHEN SQLCODE = +100                                      08710000
087200             SET PS-NOT-FOUND-TLBVRDA TO TRUE                     08720000
087300         WHEN OTHER                                               08730000
087400             SET PV-DONE-PROCESSING                               08740000
087500                 PC039-ERROR                 TO TRUE              08750000
087600             MOVE SQLCODE                    TO PV-SQL-CODE       08760000
087700             STRING ' PCKRF888 - '          DELIMITED BY SIZE     08770000
087800                 '2000-GET-LBVRDA-INFO'     DELIMITED BY SIZE     08780000
087900                    ' SQL ERROR = '         DELIMITED BY SIZE     08790000
088000                    PV-SQL-CODE             DELIMITED BY SIZE     08800000
088100                                       INTO PV-CICS-MSG-AREA      08810000
088200             SET PS-DUMP-TO-LOG       TO TRUE                     08820000
088300             PERFORM 9990-WRITE-CICS                              08830000
088400     END-EVALUATE.                                                08840000
088500                                                                  08850000
088600*-----------------------------------------------------------------08860000
088700*  GET THE OUTERPACK QYT FOR THE CARTON FROM THE UPC TABLE       -08870000
088800*-----------------------------------------------------------------08880000
088900 2010-GET-OTPK-FROM-UPC.                                          08890000
089000                                                                  08900000
089100     IF  PC039-ON-TSHPUNT                                         08910000
089200         MOVE  PC039-CARTON-ID-ENTERED                            08920000
089300           TO  DK-SHIPT-UNT-ID-2                                  08930000
089400     ELSE                                                         08940000
089500         MOVE  PC039-SHIPT-UNT-ID                                 08950000
089600           TO  DK-SHIPT-UNT-ID-2                                  08960000
089700     END-IF.                                                      08970000
089800                                                                  08980000
089900     EXEC SQL                                                     08990000
090000         SELECT SUM(SHPD_UNT_QTY)                                 09000000
090100          INTO :PV-LINE-SHPD-UNITS                                09010000
090200          FROM SUT_OTBND_UPC                                      09020000
090300         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID-2             09030000
090400     END-EXEC                                                     09040000
090500                                                                  09050000
090600     EVALUATE TRUE                                                09060000
090700         WHEN SQLCODE = +0                                        09070000
090800             MOVE PV-LINE-SHPD-UNITS TO  PC039-OTPK-UNITS         09080000
090900                                         PC039-PREPK-UNT-QTY      09090000
091000                                         LBVRDA-OTPK-UNT-QTY      09100000
091100         WHEN SQLCODE NOT EQUAL +0                                09110000
091200             MOVE ZEROES             TO  PC039-OTPK-UNITS         09120000
091300                                         PC039-PREPK-UNT-QTY      09130000
091400                                         LBVRDA-OTPK-UNT-QTY      09140000
091500     END-EVALUATE.                                                09150000
091600                                                                  09160000
091700                                                                  09170000
091800*-----------------------------------------------------------------09180000
091900 2025-GET-PREPK-OTPK-QTY.                                         09190000
092000*-----------------------------------------------------------------09200000
092100                                                                  09210000
092200     EXEC SQL                                                     09220000
092300          SELECT  SUM(B.FCSE_SPLT_UNT_QTY)                        09230000
092400                 ,SUM(B.INPK_SPLT_UNT_QTY)                        09240000
092500            INTO :DISTDT-FCSE-SPLT-UNT-QTY                        09250000
092600                ,:DISTDT-INPK-SPLT-UNT-QTY                        09260000
092700            FROM  TDISTHD A                                       09270000
092800                 ,TDISTDT B                                       09280000
092900                 ,TRECITM C                                       09290000
093000           WHERE  A.ORD_NBR            =  :DK-PO-NBR              09300000
093100             AND  A.RCVR_SEQ_NBR       =  :DK-PO-RCVR             09310000
093200             AND  A.ORD_NBR            =  B.ORD_NBR               09320000
093300             AND  A.ORD_LNE_NBR        =  B.ORD_LNE_NBR           09330000
093400             AND  A.RCVR_SEQ_NBR       =  B.RCVR_SEQ_NBR          09340000
093500             AND  B.STR_NBR            =  :PV-STR-NBR             09350000
093600             AND  A.ORD_NBR            =  C.ORD_NBR               09360000
093700             AND  A.ORD_LNE_NBR        =  C.ORD_LNE_NBR           09370000
093800             AND  A.RCVR_SEQ_NBR       =  C.REC_SEQ_NBR           09380000
093900             AND  A.ORD_LNE_NBR  IN                               09390000
094000                  (SELECT D.ORD_LNE_NBR                           09400000
094100                     FROM TRECITM D                               09410000
094200                    WHERE D.ORD_NBR     = :DK-PO-NBR              09420000
094300                      AND D.REC_SEQ_NBR = :DK-PO-RCVR             09430000
094400                      AND D.PREPK_ID    = :DK-PREPK-ID)           09440000
094500     END-EXEC.                                                    09450000
094600                                                                  09460000
094700     EVALUATE TRUE                                                09470000
094800         WHEN SQLCODE = ZERO                                      09480000
094900             MOVE DISTDT-FCSE-SPLT-UNT-QTY TO PC039-PREPK-UNT-QTY 09490000
095000                                              PC039-OTPK-UNITS    09500000
095100         WHEN SQLCODE = +100                                      09510000
095200         WHEN SQLCODE = -305                                      09520000
095300             CONTINUE                                             09530000
095400         WHEN OTHER                                               09540000
095500             SET PV-DONE-PROCESSING                               09550000
095600                 PC039-ERROR                 TO TRUE              09560000
095700             MOVE SQLCODE                    TO PV-SQL-CODE       09570000
095800             STRING ' PCKRF888 - '          DELIMITED BY SIZE     09580000
095900                  '2025-GET-PREPK-OTPK-QTY' DELIMITED BY SIZE     09590000
096000                    ' SQL ERROR = '         DELIMITED BY SIZE     09600000
096100                    PV-SQL-CODE             DELIMITED BY SIZE     09610000
096200                                       INTO PV-CICS-MSG-AREA      09620000
096300             SET PS-DUMP-TO-LOG       TO TRUE                     09630000
096400             PERFORM 9990-WRITE-CICS                              09640000
096500     END-EVALUATE.                                                09650000
096600                                                                  09660000
096700                                                                  09670000
096800*-----------------------------------------------------------------09680000
096900 2030-GET-PREPK-INPK-QTY.                                         09690000
097000*-----------------------------------------------------------------09700000
097100                                                                  09710000
097200     EXEC SQL                                                     09720000
097300          SELECT  SUM(PREPK_RATO_QTY)                             09730000
097400            INTO :RECITM-PREPK-RATO-QTY                           09740000
097500            FROM  TRECITM                                         09750000
097600           WHERE  ORD_NBR      =  :DK-PO-NBR                      09760000
097700             AND  REC_SEQ_NBR  =  :DK-PO-RCVR                     09770000
097800             AND  PREPK_ID     =  :DK-PREPK-ID                    09780000
097900     END-EXEC.                                                    09790000
098000                                                                  09800000
098100     EVALUATE TRUE                                                09810000
098200         WHEN SQLCODE = ZERO                                      09820000
098300             MOVE RECITM-PREPK-RATO-QTY    TO PC039-PREPK-UNT-QTY 09830000
098400                                              PC039-OTPK-UNITS    09840000
098500         WHEN SQLCODE = +100                                      09850000
098600         WHEN SQLCODE = -305                                      09860000
098700             CONTINUE                                             09870000
098800         WHEN OTHER                                               09880000
098900             SET PV-DONE-PROCESSING                               09890000
099000                 PC039-ERROR                 TO TRUE              09900000
099100             MOVE SQLCODE                    TO PV-SQL-CODE       09910000
099200             STRING ' PCKRF888 - '          DELIMITED BY SIZE     09920000
099300                  '2030-GET-PREPK-INPK-QTY' DELIMITED BY SIZE     09930000
099400                    ' SQL ERROR = '         DELIMITED BY SIZE     09940000
099500                    PV-SQL-CODE             DELIMITED BY SIZE     09950000
099600                                       INTO PV-CICS-MSG-AREA      09960000
099700             SET PS-DUMP-TO-LOG       TO TRUE                     09970000
099800             PERFORM 9990-WRITE-CICS                              09980000
099900     END-EVALUATE.                                                09990000
100000                                                                  10000000
100100                                                                  10010000
100200*-----------------------------------------------------------------10020000
100300 2050-GET-PREPACK-INFO.                                           10030000
100400*-----------------------------------------------------------------10040000
100500     MOVE PC039-PO-NBR      TO DK-PO-NBR.                         10050000
100600     MOVE PC039-PO-RCVR     TO DK-PO-RCVR.                        10060000
100700     MOVE PC039-PREPK-ID    TO DK-PREPK-ID.                       10070000
100800                                                                  10080000
100900     EXEC SQL                                                     10090000
101000          SELECT  SUM(PREPK_RATO_QTY)                             10100000
101100            INTO :RECITM-PREPK-RATO-QTY                           10110000
101200            FROM  TRECITM C                                       10120000
101300           WHERE  C.ORD_NBR            =  :DK-PO-NBR              10130000
101400             AND  C.REC_SEQ_NBR        =  :DK-PO-RCVR             10140000
101500             AND  C.ORD_LNE_NBR  IN                               10150000
101600                  (SELECT D.ORD_LNE_NBR                           10160000
101700                     FROM TRECITM D                               10170000
101800                    WHERE D.ORD_NBR     = :DK-PO-NBR              10180000
101900                      AND D.REC_SEQ_NBR = :DK-PO-RCVR             10190000
102000                      AND D.PREPK_ID    = :DK-PREPK-ID)           10200000
102100     END-EXEC.                                                    10210000
102200                                                                  10220000
102300     EVALUATE TRUE                                                10230000
102400         WHEN SQLCODE = ZERO                                      10240000
102500             CONTINUE                                             10250000
102600         WHEN SQLCODE = +100                                      10260000
102700             CONTINUE                                             10270000
102800         WHEN OTHER                                               10280000
102900             SET PV-DONE-PROCESSING                               10290000
103000                 PC039-ERROR                 TO TRUE              10300000
103100             MOVE SQLCODE                    TO PV-SQL-CODE       10310000
103200             STRING ' PCKRF888 - '          DELIMITED BY SIZE     10320000
103300                  '2050-GET-PREPACK-INFO'   DELIMITED BY SIZE     10330000
103400                    ' SQL ERROR = '         DELIMITED BY SIZE     10340000
103500                    PV-SQL-CODE             DELIMITED BY SIZE     10350000
103600                                       INTO PV-CICS-MSG-AREA      10360000
103700             SET PS-DUMP-TO-LOG       TO TRUE                     10370000
103800             PERFORM 9990-WRITE-CICS                              10380000
103900     END-EVALUATE.                                                10390000
104000                                                                  10400000
104100*-----------------------------------------------------------------10410000
104200 2500-GET-VND-CART-INFO.                                          10420000
104300*-----------------------------------------------------------------10430000
104400     EXEC SQL                                                     10440000
104500          SELECT  A.PO_NBR                                        10450000
104600                 ,B.REC_SEQ_NBR                                   10460000
104700                 ,C.TRN_LNE_NBR                                   10470000
104800            INTO :SUT00026-PO-NBR                                 10480000
104900                ,:PKSLIP-REC-SEQ-NBR                              10490000
105000                ,:SUT00028-TRN-LNE-NBR                            10500000
105100            FROM  SUT_OTBND_VND A                                 10510000
105200                 ,TPKSLIP B                                       10520000
105300                 ,SUT_OTBND_UPC C                                 10530000
105400           WHERE  A.SHIPT_UNT_ID      =  :DK-SHIPT-UNT-ID         10540000
105500             AND  A.PO_NBR            =  B.PO_NBR                 10550000
105600             AND  A.PKSL_SEQ_NBR      =  B.SEQ_NBR                10560000
105700             AND  B.VER_STAT_CDE      =  :PC-A                    10570000
105800             AND  A.SHIPT_UNT_ID      =  C.SHIPT_UNT_ID           10580000
105900     END-EXEC.                                                    10590000
106000                                                                  10600000
106100     EVALUATE TRUE                                                10610000
106200         WHEN SQLCODE = ZERO                                      10620000
106300             SET PC039-4-BY-4-LBL           TO TRUE               10630000
106400             MOVE SUT00026-PO-NBR           TO PC039-PO-NBR       10640000
106500             MOVE PKSLIP-REC-SEQ-NBR        TO PC039-PO-RCVR      10650000
106600             MOVE SUT00028-TRN-LNE-NBR      TO PC039-LNE-NBR      10660000
106700         WHEN SQLCODE = -811                                      10670000
106800             SET PC039-4-BY-4-LBL           TO TRUE               10680000
106900             MOVE SUT00026-PO-NBR           TO PC039-PO-NBR       10690000
107000             MOVE PKSLIP-REC-SEQ-NBR        TO PC039-PO-RCVR      10700000
107100             MOVE SUT00028-TRN-LNE-NBR      TO PC039-LNE-NBR      10710000
107200         WHEN SQLCODE = +100                                      10720000
107300             CONTINUE                                             10730000
107400     END-EVALUATE.                                                10740000
107500                                                                  10750000
107600*-----------------------------------------------------------------10760000
107700 3000-GET-MORE-INFO.                                              10770000
107800*-----------------------------------------------------------------10780000
107900     MOVE PC039-PO-NBR  TO DK-PO-NBR.                             10790000
108000     MOVE PC039-PO-RCVR TO DK-PO-RCVR.                            10800000
108100     MOVE PC039-LNE-NBR TO DK-LNE-NBR.                            10810000
108200                                                                  10820000
108300     EXEC SQL                                                     10830000
108400          SELECT  A.DEPT_NBR                                      10840000
108500                 ,C.INNR_PACK_QTY                                 10850000
108600                 ,D.CL_NBR                                        10860000
108700                 ,D.SKU_SEQ_NBR                                   10870000
108800                 ,D.VEND_STYL_NAME                                10880000
108900                 ,D.ITM_NBR                                       10890000
109000                 ,DATE(E.REC_TMST)                                10900000
109100            INTO :PURCHS-DEPT-NBR                                 10910000
109200                ,:RECITM-INNR-PACK-QTY                            10920000
109300                ,:PURITM-CL-NBR                                   10930000
109400                ,:PURITM-SKU-SEQ-NBR                              10940000
109500                ,:PURITM-VEND-STYL-NAME                           10950000
109600                ,:PURITM-ITM-NBR                                  10960000
109700                ,:PC039-TRIP-ARRIVE-DATE                          10970000
109800            FROM  TPURCHS A                                       10980000
109900                 ,TVNDDPT B                                       10990000
110000                 ,TRECITM C                                       11000000
110100                 ,TPURITM D                                       11010000
110200                 ,TRECEIV E                                       11020000
110300           WHERE  A.PO_NBR            =  :DK-PO-NBR               11030000
110400             AND  A.VER_NBR           =  E.PO_VER_NBR             11040000
110500             AND  A.ENT_ID            =  B.ENT_ID                 11050000
110600             AND  A.DEPT_NBR          =  B.DEPT_NBR               11060000
110700             AND  A.PO_NBR            =  C.ORD_NBR                11070000
110800             AND  C.REC_SEQ_NBR       =  E.REC_SEQ_NBR            11080000
110900             AND  C.ORD_LNE_NBR       =  :DK-LNE-NBR              11090000
111000             AND  C.ORD_NBR           =  D.PO_NBR                 11100000
111100             AND  C.ORD_LNE_NBR       =  D.APP_PO_LNE_NBR         11110000
111200             AND  C.PO_VER_NBR        =  D.VER_NBR                11120000
111300             AND  E.ORD_NBR           =  A.PO_NBR                 11130000
111400             AND  E.REC_SEQ_NBR       =  :DK-PO-RCVR              11140000
111500     END-EXEC.                                                    11150000
111600                                                                  11160000
111700     EVALUATE TRUE                                                11170000
111800         WHEN SQLCODE = ZERO                                      11180000
111900             MOVE PURITM-VEND-STYL-NAME   TO PC039-STYLE          11190000
112000             MOVE PURCHS-DEPT-NBR         TO PC039-DEPT           11200000
112100             MOVE PURITM-CL-NBR           TO PC039-CLASS          11210000
112200                                                                  11220000
112300             IF  PC039-TRIP-ARRIVE-CCYY  =  9999                  11230000
112400                 MOVE 99  TO  PC039-TRIP-ARRIVE-MM                11240000
112500                 MOVE 99  TO  PC039-TRIP-ARRIVE-DD                11250000
112600             END-IF                                               11260000
112700                                                                  11270000
112800             PERFORM 3500-CALL-XLKUT001                           11280000
112900             EVALUATE TRUE                                        11290000
113000                 WHEN XL001-SKU-SQLCODE = ZERO                    11300000
113100                      MOVE XL001-SKU-NBR       TO PC039-SKU       11310000
113200                 WHEN XL001-SKU-SQLCODE = +100                    11320000
113300                     MOVE ZEROES              TO PC039-SKU        11330000
113400                 WHEN OTHER                                       11340000
113500                     PERFORM 9990-WRITE-CICS                      11350000
113600                     MOVE '3500-CALL-XLKUT001'                    11360000
113700                                      TO DP013-PARAGRAPH          11370000
113800                     MOVE 'PCKRF888 - GET SKU NUMBER'             11380000
113900                                      TO DP013-MESSAGE-TEXT(1)    11390000
114000                     MOVE SQLCA       TO DP013-SQLCA              11400000
114100                     MOVE 'XLKUT001'  TO DP013-DB2-TABLE-NAME(1)  11410000
114200                     SET DP013-DB2-ABEND      TO TRUE             11420000
114300             END-EVALUATE                                         11430000
114400                                                                  11440000
114500         WHEN SQLCODE = -811                                      11450000
114600             MOVE PURITM-VEND-STYL-NAME   TO PC039-STYLE          11460000
114700             MOVE PURCHS-DEPT-NBR         TO PC039-DEPT           11470000
114800             MOVE PURITM-CL-NBR           TO PC039-CLASS          11480000
114900                                                                  11490000
115000             MOVE '@@@@@@@@@@@'       TO PC039-SKU                11500000
115100             MOVE '***MULTIPLE LINES ***'                         11510000
115200                                               TO PC039-STYLE     11520000
115300         WHEN OTHER                                               11530000
115400             MOVE SPACES                  TO PC039-STYLE          11540000
115500                                             PC039-DEPT           11550000
115600                                             PC039-CLASS          11560000
115700                                             PC039-SKU            11570000
115800     END-EVALUATE.                                                11580000
115900                                                                  11590000
116000******************************************************************11600000
116100*CALL LOGISTICS DOMAIN ITEM ACCESS MODULE XLKUT001                11610000
116200*GET SKU NUMBER                                                   11620000
116300 3500-CALL-XLKUT001.                                              11630000
116400******************************************************************11640000
116500     INITIALIZE XL001-ITEM-COMMAREA.                              11650000
116600                                                                  11660000
116700     SET  XL001-BY-ITEM                                           11670000
116800          XL001-SELECT-SKU     TO TRUE.                           11680000
116900                                                                  11690000
117000     MOVE PURITM-ITM-NBR       TO XL001-KEY-ITM-NBR.              11700000
117100                                                                  11710000
117200     CALL XL001-VSM-PGM USING DFHEIBLK                            11720000
117300                              XL001-COMMAREA                      11730000
117400                              XL001-ITEM-COMMAREA.                11740000
117500                                                                  11750000
117600     EVALUATE TRUE                                                11760000
117700       WHEN XL001-SUCCESSFUL                                      11770000
117800       WHEN XL001-SKU-NOT-FOUND                                   11780000
117900       WHEN XL001-SKU-CONTENTION                                  11790000
118000         CONTINUE                                                 11800000
118100       WHEN XL001-SQL-ERROR                                       11810000
118200       WHEN XL001-INVALID-ACCESS                                  11820000
118300         MOVE '3500-CALL-XLKUT001'                                11830000
118400                              TO DP013-PARAGRAPH                  11840000
118500         MOVE 'PCKRF888 - DB2 ERROR IN PROGRAM: '                 11850000
118600                              TO DP013-MESSAGE-TEXT (1)           11860000
118700         MOVE 'XLKUT001'      TO DP013-MESSAGE-TEXT (2)           11870000
118800         SET DP013-CICS-ABEND                                     11880000
118900             DP013-ROLLBACK   TO TRUE                             11890000
119000             SET PS-DUMP-TO-LOG       TO TRUE                     11900000
119100             PERFORM 9990-WRITE-CICS                              11910000
119200       WHEN OTHER                                                 11920000
119300         MOVE '3500-CALL-XLKUT001'                                11930000
119400                              TO DP013-PARAGRAPH                  11940000
119500         MOVE 'PCKRF888 - DB2 ERROR IN PROGRAM: '                 11950000
119600                              TO DP013-MESSAGE-TEXT (1)           11960000
119700         MOVE 'XLKUT001'      TO DP013-MESSAGE-TEXT (2)           11970000
119800         SET DP013-CICS-ABEND                                     11980000
119900             DP013-ROLLBACK   TO TRUE                             11990000
120000             SET PS-DUMP-TO-LOG       TO TRUE                     12000000
120100             PERFORM 9990-WRITE-CICS                              12010000
120200      END-EVALUATE.                                               12020000
120300                                                                  12030000
120400                                                                  12040000
120500*-----------------------------------------------------------------12050000
120600 4000-GET-ZONE-INFO.                                              12060000
120700*-----------------------------------------------------------------12070000
120800     SET PS-MORE-STRZNE-CSR  TO TRUE.                             12080000
120900     MOVE SPACES TO PC039-RF-ZNE-LINE-1                           12090000
121000                    PC039-RF-ZNE-LINE-2                           12100000
121100                    PC039-RF-ZNE-LINE-3.                          12110000
121200                                                                  12120000
121300     PERFORM 4100-OPEN-STRZNE-CURSOR.                             12130000
121400     PERFORM 4200-FETCH-STRZNE-CURSOR.                            12140000
121500                                                                  12150000
121600     IF PS-EOF-STRZNE-CSR                                         12160000
121700        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12170000
121800     ELSE                                                         12180000
121900        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEA                 12190000
122000     END-IF.                                                      12200000
122100     IF PS-EOF-STRZNE-CSR                                         12210000
122200        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12220000
122300     ELSE                                                         12230000
122400        PERFORM 4200-FETCH-STRZNE-CURSOR                          12240000
122500        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEB                 12250000
122600     END-IF.                                                      12260000
122700     IF PS-EOF-STRZNE-CSR                                         12270000
122800        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12280000
122900     ELSE                                                         12290000
123000        PERFORM 4200-FETCH-STRZNE-CURSOR                          12300000
123100        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEC                 12310000
123200     END-IF.                                                      12320000
123300     IF PS-EOF-STRZNE-CSR                                         12330000
123400        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12340000
123500     ELSE                                                         12350000
123600        PERFORM 4200-FETCH-STRZNE-CURSOR                          12360000
123700        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONED                 12370000
123800     END-IF.                                                      12380000
123900     IF PS-EOF-STRZNE-CSR                                         12390000
124000        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12400000
124100     ELSE                                                         12410000
124200        PERFORM 4200-FETCH-STRZNE-CURSOR                          12420000
124300        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEE                 12430000
124400     END-IF.                                                      12440000
124500     IF PS-EOF-STRZNE-CSR                                         12450000
124600        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12460000
124700     ELSE                                                         12470000
124800        PERFORM 4200-FETCH-STRZNE-CURSOR                          12480000
124900        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEF                 12490000
125000     END-IF.                                                      12500000
125100     IF PS-EOF-STRZNE-CSR                                         12510000
125200        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12520000
125300     ELSE                                                         12530000
125400        PERFORM 4200-FETCH-STRZNE-CURSOR                          12540000
125500        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEG                 12550000
125600     END-IF.                                                      12560000
125700     IF PS-EOF-STRZNE-CSR                                         12570000
125800        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12580000
125900     ELSE                                                         12590000
126000        PERFORM 4200-FETCH-STRZNE-CURSOR                          12600000
126100        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEH                 12610000
126200     END-IF.                                                      12620000
126300     IF PS-EOF-STRZNE-CSR                                         12630000
126400        PERFORM 4300-CLOSE-STRZNE-CURSOR                          12640000
126500     ELSE                                                         12650000
126600        PERFORM 4200-FETCH-STRZNE-CURSOR                          12660000
126700        MOVE STRZN-STR-ZN-ID    TO PC039-RF-ZONEI                 12670000
126800     END-IF.                                                      12680000
126900                                                                  12690000
127000     PERFORM 4300-CLOSE-STRZNE-CURSOR.                            12700000
127100                                                                  12710000
127200*-----------------------------------------------------------------12720000
127300 4100-OPEN-STRZNE-CURSOR.                                         12730000
127400*-----------------------------------------------------------------12740000
127500     EXEC SQL                                                     12750000
127600         OPEN STRZNE_CURSOR                                       12760000
127700     END-EXEC.                                                    12770000
127800                                                                  12780000
127900     EVALUATE TRUE                                                12790000
128000         WHEN SQLCODE = ZERO                                      12800000
128100             CONTINUE                                             12810000
128200         WHEN SQLWARN0 NOT = SPACES                               12820000
128300         WHEN SQLCODE < ZERO                                      12830000
128400         WHEN SQLCODE > ZERO                                      12840000
128500             MOVE SPACES TO PC039-RF-ZNE-LINE-1                   12850000
128600             MOVE SPACES TO PC039-RF-ZNE-LINE-2                   12860000
128700             MOVE SPACES TO PC039-RF-ZNE-LINE-3                   12870000
128800     END-EVALUATE.                                                12880000
128900                                                                  12890000
129000*-----------------------------------------------------------------12900000
129100 4200-FETCH-STRZNE-CURSOR.                                        12910000
129200*-----------------------------------------------------------------12920000
129300     EXEC SQL                                                     12930000
129400         FETCH STRZNE_CURSOR                                      12940000
129500          INTO :STRZN-STR-ZN-ID                                   12950000
129600     END-EXEC.                                                    12960000
129700                                                                  12970000
129800     EVALUATE TRUE                                                12980000
129900         WHEN SQLCODE = ZERO                                      12990000
130000             CONTINUE                                             13000000
130100         WHEN SQLCODE = +100                                      13010000
130200             SET PS-EOF-STRZNE-CSR TO TRUE                        13020000
130300         WHEN SQLWARN0 NOT = SPACES                               13030000
130400         WHEN SQLCODE < ZERO                                      13040000
130500         WHEN SQLCODE > ZERO                                      13050000
130600             SET PS-EOF-STRZNE-CSR TO TRUE                        13060000
130700     END-EVALUATE.                                                13070000
130800                                                                  13080000
130900*----------------------------------------------------------------*13090000
131000*   CLOSE THE STORE ZONE CURSOR.                                 *13100000
131100*----------------------------------------------------------------*13110000
131200 4300-CLOSE-STRZNE-CURSOR.                                        13120000
131300                                                                  13130000
131400     EXEC SQL                                                     13140000
131500        CLOSE STRZNE_CURSOR                                       13150000
131600     END-EXEC.                                                    13160000
131700                                                                  13170000
131800     EVALUATE TRUE                                                13180000
131900         WHEN SQLCODE = ZERO                                      13190000
132000         WHEN SQLWARN0 NOT = SPACES                               13200000
132100         WHEN SQLCODE < ZERO                                      13210000
132200         WHEN SQLCODE > ZERO                                      13220000
132300             CONTINUE                                             13230000
132400     END-EVALUATE.                                                13240000
132500                                                                  13250000
132600*-----------------------------------------------------------------13260000
132700 5000-GET-PREPACK-INFO.                                           13270000
132800*-----------------------------------------------------------------13280000
132900     MOVE PC039-PO-NBR  TO DK-PO-NBR.                             13290000
133000     MOVE PC039-PO-RCVR TO DK-PO-RCVR.                            13300000
133100                                                                  13310000
133200     EXEC SQL                                                     13320000
133300          SELECT  PKGNG_CDE                                       13330000
133400            INTO :RECEIV-PKGNG-CDE                                13340000
133500            FROM  TRECEIV                                         13350000
133600           WHERE  ORD_NBR     =  :DK-PO-NBR                       13360000
133700             AND  REC_SEQ_NBR =  :DK-PO-RCVR                      13370000
133800     END-EXEC.                                                    13380000
133900                                                                  13390000
134000     EVALUATE TRUE                                                13400000
134100         WHEN SQLCODE = ZERO                                      13410000
134200             IF RECEIV-PKGNG-CDE = PC-M OR PC-I                   13420000
134300                 SET PC039-PREPK     TO  TRUE                     13430000
134400                 PERFORM 5100-GET-PREPACK-ID                      13440000
134500                 PERFORM 5200-GET-PREPACK-INFO                    13450000
134600             ELSE                                                 13460000
134700                 SET PC039-NON-PREPK TO TRUE                      13470000
134800                 MOVE ZEROES         TO PC039-PREPK-UNT-QTY       13480000
134900                                        PC039-PACKS-IN-CRTN       13490000
135000                                        PC039-PREPK-ID            13500000
135100                 PERFORM 5300-GET-NON-PREPACK                     13510000
135200                 PERFORM 2010-GET-OTPK-FROM-UPC                   13520000
135300             END-IF                                               13530000
135400         WHEN SQLCODE = +100                                      13540000
135500             SET PC039-NON-PREPK TO TRUE                          13550000
135600             MOVE ZEROES         TO PC039-PREPK-UNT-QTY           13560000
135700                                    PC039-PACKS-IN-CRTN           13570000
135800                                    PC039-PREPK-ID                13580000
135900             PERFORM 5300-GET-NON-PREPACK                         13590000
136000             PERFORM 2010-GET-OTPK-FROM-UPC                       13600000
136100         WHEN OTHER                                               13610000
136200             SET PV-DONE-PROCESSING                               13620000
136300                 PC039-ERROR                 TO TRUE              13630000
136400             MOVE SQLCODE                    TO PV-SQL-CODE       13640000
136500             STRING ' PCKRF888 - '          DELIMITED BY SIZE     13650000
136600                  '5000-GET-PREPACK-INFO'   DELIMITED BY SIZE     13660000
136700                    ' SQL ERROR = '         DELIMITED BY SIZE     13670000
136800                    PV-SQL-CODE             DELIMITED BY SIZE     13680000
136900                                       INTO PV-CICS-MSG-AREA      13690000
137000             SET PS-DUMP-TO-LOG       TO TRUE                     13700000
137100             PERFORM 9990-WRITE-CICS                              13710000
137200     END-EVALUATE.                                                13720000
137300                                                                  13730000
137400*-----------------------------------------------------------------13740000
137500 5100-GET-PREPACK-ID.                                             13750000
137600*-----------------------------------------------------------------13760000
137700     MOVE PC039-PO-NBR  TO DK-PO-NBR.                             13770000
137800     MOVE PC039-LNE-NBR TO DK-LNE-NBR.                            13780000
137900                                                                  13790000
138000     EXEC SQL                                                     13800000
138100          SELECT  A.PO_PREPK_ID                                   13810000
138200            INTO :PURITM-PO-PREPK-ID                              13820000
138300            FROM  TPURITM A                                       13830000
138400               ,  TRECITM B                                       13840000
138500           WHERE  B.ORD_NBR        = :DK-PO-NBR                   13850000
138600             AND  B.ORD_LNE_NBR    = :DK-LNE-NBR                  13860000
138700             AND  B.REC_SEQ_NBR    = :DK-PO-RCVR                  13870000
138800             AND  A.PO_NBR         = B.ORD_NBR                    13880000
138900             AND  A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                13890000
139000             AND  A.VER_NBR        = B.PO_VER_NBR                 13900000
139100     END-EXEC.                                                    13910000
139200                                                                  13920000
139300     EVALUATE TRUE                                                13930000
139400         WHEN SQLCODE = ZERO                                      13940000
139500         WHEN SQLCODE = -811                                      13950000
139600             MOVE PURITM-PO-PREPK-ID  TO  PC039-PREPK-ID          13960000
139700         WHEN SQLCODE = +100                                      13970000
139800             MOVE ZEROES              TO  PC039-PREPK-ID          13980000
139900         WHEN OTHER                                               13990000
140000             SET PV-DONE-PROCESSING                               14000000
140100                 PC039-ERROR                 TO TRUE              14010000
140200             MOVE SQLCODE                    TO PV-SQL-CODE       14020000
140300             STRING ' PCKRF888 - '          DELIMITED BY SIZE     14030000
140400                  '5100-GET-PREPACK-ID'     DELIMITED BY SIZE     14040000
140500                    ' SQL ERROR = '         DELIMITED BY SIZE     14050000
140600                    PV-SQL-CODE             DELIMITED BY SIZE     14060000
140700                                       INTO PV-CICS-MSG-AREA      14070000
140800             SET PS-DUMP-TO-LOG       TO TRUE                     14080000
140900             PERFORM 9990-WRITE-CICS                              14090000
141000     END-EVALUATE.                                                14100000
141100                                                                  14110000
141200*-----------------------------------------------------------------14120000
141300 5200-GET-PREPACK-INFO.                                           14130000
141400*-----------------------------------------------------------------14140000
141500     MOVE PC039-PO-NBR      TO DK-PO-NBR.                         14150000
141600     MOVE PC039-PO-RCVR     TO DK-PO-RCVR.                        14160000
141700     MOVE PC039-PREPK-ID    TO DK-PREPK-ID.                       14170000
141800     MOVE PC039-STR-NBR     TO PV-4-DGT-STR-NBR.                  14180000
141900     MOVE PV-4-DGT-STR-NBR  TO PV-STR-NBR.                        14190000
142000                                                                  14200000
142100     EXEC SQL                                                     14210000
142200          SELECT  A.OTPK_UNT_QTY                                  14220000
142300                 ,A.INPK_UNT_QTY                                  14230000
142400                 ,A.INPK_CNVYB_IND                                14240000
142500                 ,A.ORD_LNE_NBR                                   14250000
142600                 ,A.FCSE_LBL_TYP_CDE                              14260000
142700                 ,B.PREPK_RATO_QTY                                14270000
142800            INTO :DISTHD-OTPK-UNT-QTY                             14280000
142900                ,:DISTHD-INPK-UNT-QTY                             14290000
143000                ,:DISTHD-INPK-CNVYB-IND                           14300000
143100                ,:DISTHD-ORD-LNE-NBR                              14310000
143200                ,:DISTHD-FCSE-LBL-TYP-CDE                         14320000
143300                ,:RECITM-PREPK-RATO-QTY                           14330000
143400            FROM  TDISTHD A                                       14340000
143500                 ,TRECITM B                                       14350000
143600           WHERE  A.ORD_NBR            =  :DK-PO-NBR              14360000
143700             AND  A.RCVR_SEQ_NBR       =  :DK-PO-RCVR             14370000
143800             AND  A.PREPK_LNE_PRC_CDE  =  :PC-D                   14380000
143900             AND  A.ORD_NBR            =  B.ORD_NBR               14390000
144000             AND  A.ORD_LNE_NBR        =  B.ORD_LNE_NBR           14400000
144100             AND  A.RCVR_SEQ_NBR       =  B.REC_SEQ_NBR           14410000
144200             AND  A.ORD_LNE_NBR  IN                               14420000
144300                  (SELECT D.ORD_LNE_NBR                           14430000
144400                     FROM TRECITM D                               14440000
144500                    WHERE D.ORD_NBR     = :DK-PO-NBR              14450000
144600                      AND D.REC_SEQ_NBR = :DK-PO-RCVR             14460000
144700                      AND D.PREPK_ID    = :DK-PREPK-ID)           14470000
144800     END-EXEC.                                                    14480000
144900                                                                  14490000
145000     EVALUATE TRUE                                                14500000
145100         WHEN SQLCODE = ZERO                                      14510000
145200         WHEN SQLCODE = -811                                      14520000
145300             MOVE DISTHD-ORD-LNE-NBR       TO PC039-LNE-NBR       14530000
145400             MOVE DISTHD-OTPK-UNT-QTY      TO PC039-OTPK-UNITS    14540000
145500             MOVE DISTHD-INPK-UNT-QTY      TO PC039-INPK-UNITS    14550000
145600             MOVE DISTHD-FCSE-LBL-TYP-CDE  TO PC039-LBL-TYPE      14560000
145700             MOVE RECITM-PREPK-RATO-QTY    TO PC039-PREPK-RATIO   14570000
145800             PERFORM 8000-GET-LOCATION-INFO                       14580000
145900             PERFORM 5225-GET-PREPK-OTPK-QTY                      14590000
146000             PERFORM 5250-GET-PREPK-UNT-QTY                       14600000
146100             PERFORM 2010-GET-OTPK-FROM-UPC                       14610000
146200             IF PV-PREPK-UNT-QTY > ZEROES                         14620000
146300                                                                  14630080
146400                 IF PC039-INPK                                    14640000
146500                     MOVE DISTHD-INPK-UNT-QTY  TO PC039-INPK-UNITS14650000
146600                 END-IF                                           14660000
146700                 COMPUTE PC039-PACKS-IN-CRTN =                    14670000
146800                 PC039-PREPK-UNT-QTY / PC039-PREPK-RATIO          14680000
146900             END-IF                                               14690000
147000                         MOVE PC-S  TO   PC039-LBL-TYPE           14700000
147100             IF DISTHD-FCSE-LBL-TYP-CDE = PC-R OR PC-S OR 'D'     14710000
147200                 MOVE PC-P  TO   PC039-LBL-FORMAT                 14720000
147300                 MOVE PC-S  TO   PC039-LBL-TYPE                   14730000
147400             ELSE                                                 14740000
147500                 IF DISTHD-FCSE-LBL-TYP-CDE = PC-U                14750000
147600                     MOVE PC-S  TO   PC039-LBL-FORMAT             14760000
147700                     MOVE PC-S  TO   PC039-LBL-TYPE               14770000
147800                 ELSE                                             14780000
147900                     IF DISTHD-FCSE-LBL-TYP-CDE = PC-P            14790000
148000                         MOVE PC-P  TO   PC039-LBL-FORMAT         14800000
148100                         MOVE PC-P  TO   PC039-LBL-TYPE           14810000
148200                     ELSE                                         14820000
148300                         MOVE PC-G  TO   PC039-LBL-FORMAT         14830000
148400                         MOVE PC-S  TO   PC039-LBL-TYPE           14840000
148500                     END-IF                                       14850000
148600                 END-IF                                           14860000
148700             END-IF                                               14870000
149300             IF XL071-LOC-TYP-CDE  =  PC-CS                       14930000
149400                 SET PC039-CENTRAL-STK  TO  TRUE                  14940000
149500             ELSE                                                 14950000
149600                 SET PC039-CSEPK-SML    TO  TRUE                  14960000
149700             END-IF                                               14970000
149800         WHEN SQLCODE = +100                                      14980000
149900             MOVE PC039-SU-BC-DIVERT-CD   TO  PV-SML-BC-DIVERT-CDE14990000
150000             MOVE PV-SML-BC-STR-NBR-4    TO  PV-4-DGT-STR-NBR     15000000
150100                                             PC039-STR-NBR        15010000
150200             PERFORM 8000-GET-LOCATION-INFO                       15020000
150300             MOVE PC-S                    TO  PC039-LBL-TYPE      15030000
150400         WHEN OTHER                                               15040000
150500             SET PV-DONE-PROCESSING                               15050000
150600                 PC039-ERROR                 TO TRUE              15060000
150700             MOVE SQLCODE                    TO PV-SQL-CODE       15070000
150800             STRING ' PCKRF888 - '          DELIMITED BY SIZE     15080000
150900                  '5200-GET-PREPACK-INFO'   DELIMITED BY SIZE     15090000
151000                    ' SQL ERROR = '         DELIMITED BY SIZE     15100000
151100                    PV-SQL-CODE             DELIMITED BY SIZE     15110000
151200                                       INTO PV-CICS-MSG-AREA      15120000
151300             SET PS-DUMP-TO-LOG       TO TRUE                     15130000
151400             PERFORM 9990-WRITE-CICS                              15140000
151500     END-EVALUATE.                                                15150000
151600                                                                  15160000
151700*-----------------------------------------------------------------15170000
151800 5225-GET-PREPK-OTPK-QTY.                                         15180000
151900*-----------------------------------------------------------------15190000
152000                                                                  15200000
152100     EXEC SQL                                                     15210000
152200          SELECT  SUM(A.OTPK_UNT_QTY)                             15220000
152300               ,  SUM(A.INPK_UNT_QTY)                             15230000
152400            INTO :DISTHD-OTPK-UNT-QTY                             15240000
152500               , :DISTHD-INPK-UNT-QTY                             15250000
152600            FROM  TDISTHD A                                       15260000
152700                 ,TDISTDT B                                       15270000
152800                 ,TRECITM C                                       15280000
152900           WHERE  A.ORD_NBR            =  :DK-PO-NBR              15290000
153000             AND  A.RCVR_SEQ_NBR       =  :DK-PO-RCVR             15300000
153100             AND  A.ORD_NBR            =  B.ORD_NBR               15310000
153200             AND  A.ORD_LNE_NBR        =  B.ORD_LNE_NBR           15320000
153300             AND  A.RCVR_SEQ_NBR       =  B.RCVR_SEQ_NBR          15330000
153400             AND  B.STR_NBR            =  :PV-STR-NBR             15340000
153500             AND  A.ORD_NBR            =  C.ORD_NBR               15350000
153600             AND  A.ORD_LNE_NBR        =  C.ORD_LNE_NBR           15360000
153700             AND  A.RCVR_SEQ_NBR       =  C.REC_SEQ_NBR           15370000
153800             AND  A.ORD_LNE_NBR  IN                               15380000
153900                  (SELECT D.ORD_LNE_NBR                           15390000
154000                     FROM TRECITM D                               15400000
154100                    WHERE D.ORD_NBR     = :DK-PO-NBR              15410000
154200                      AND D.REC_SEQ_NBR = :DK-PO-RCVR             15420000
154300                      AND D.PREPK_ID    = :DK-PREPK-ID)           15430000
154400     END-EXEC.                                                    15440000
154500                                                                  15450000
154600     EVALUATE TRUE                                                15460000
154700         WHEN SQLCODE = ZERO                                      15470000
154800             MOVE DISTHD-OTPK-UNT-QTY      TO PC039-PREPK-UNT-QTY 15480000
154900         WHEN SQLCODE = +100                                      15490000
155000             MOVE ZEROES                  TO  PC039-PREPK-UNT-QTY 15500000
155100         WHEN OTHER                                               15510000
155200             SET PV-DONE-PROCESSING                               15520000
155300                 PC039-ERROR                 TO TRUE              15530000
155400             MOVE SQLCODE                    TO PV-SQL-CODE       15540000
155500             STRING ' PCKRF888 - '          DELIMITED BY SIZE     15550000
155600                  '5225-GET-PREPK-OTPK-QTY' DELIMITED BY SIZE     15560000
155700                    ' SQL ERROR = '         DELIMITED BY SIZE     15570000
155800                    PV-SQL-CODE             DELIMITED BY SIZE     15580000
155900                                       INTO PV-CICS-MSG-AREA      15590000
156000             SET PS-DUMP-TO-LOG       TO TRUE                     15600000
156100             PERFORM 9990-WRITE-CICS                              15610000
156200     END-EVALUATE.                                                15620000
156300                                                                  15630000
156400*-----------------------------------------------------------------15640000
156500 5250-GET-PREPK-UNT-QTY.                                          15650000
156600*-----------------------------------------------------------------15660000
156700                                                                  15670000
156800     MOVE PC039-CURR-OPER-UNT  TO PC-OPER-UNT-ID.                 15680000
156900     EXEC SQL                                                     15690000
157000          SELECT  SUM(PREPK_RATO_QTY)                             15700000
157100            INTO :PV-PREPK-UNT-QTY                                15710000
157200            FROM  TRECITM                                         15720000
157300           WHERE  ORD_NBR            =  :DK-PO-NBR                15730000
157400             AND  REC_SEQ_NBR        =  :DK-PO-RCVR               15740000
157500             AND  PREPK_ID           =  :DK-PREPK-ID              15750000
157600     END-EXEC.                                                    15760000
157700                                                                  15770000
157800     EVALUATE TRUE                                                15780000
157900         WHEN SQLCODE = ZERO                                      15790000
158000             MOVE PV-PREPK-UNT-QTY         TO PC039-PREPK-RATIO   15800000
158100         WHEN SQLCODE = +100                                      15810000
158200             MOVE ZEROES                  TO  PC039-PREPK-RATIO   15820000
158300         WHEN OTHER                                               15830000
158400             SET PV-DONE-PROCESSING                               15840000
158500                 PC039-ERROR                 TO TRUE              15850000
158600             MOVE SQLCODE                    TO PV-SQL-CODE       15860000
158700             STRING ' PCKRF888 - '          DELIMITED BY SIZE     15870000
158800                  '5250-GET-PREPK-UNT-QTY'  DELIMITED BY SIZE     15880000
158900                    ' SQL ERROR = '         DELIMITED BY SIZE     15890000
159000                    PV-SQL-CODE             DELIMITED BY SIZE     15900000
159100                                       INTO PV-CICS-MSG-AREA      15910000
159200             SET PS-DUMP-TO-LOG       TO TRUE                     15920000
159300             PERFORM 9990-WRITE-CICS                              15930000
159400     END-EVALUATE.                                                15940000
159500                                                                  15950000
159600*-----------------------------------------------------------------15960000
159700 5300-GET-NON-PREPACK.                                            15970000
159800*-----------------------------------------------------------------15980000
159900     MOVE PC039-PO-NBR     TO DK-PO-NBR.                          15990000
160000     MOVE PC039-PO-RCVR    TO DK-PO-RCVR.                         16000000
160100     MOVE PC039-LNE-NBR    TO DK-LNE-NBR.                         16010000
160200     MOVE PC039-STR-NBR    TO PV-4-DGT-STR-NBR.                   16020000
160300     MOVE PV-4-DGT-STR-NBR TO PV-STR-NBR.                         16030000
160400                                                                  16040000
160500     EXEC SQL                                                     16050000
160600          SELECT  OTPK_UNT_QTY                                    16060000
160700                 ,INPK_UNT_QTY                                    16070000
160800                 ,INPK_CNVYB_IND                                  16080000
160900                 ,FCSE_LBL_TYP_CDE                                16090000
161000            INTO :DISTHD-OTPK-UNT-QTY                             16100000
161100                ,:DISTHD-INPK-UNT-QTY                             16110000
161200                ,:DISTHD-INPK-CNVYB-IND                           16120000
161300                ,:DISTHD-FCSE-LBL-TYP-CDE                         16130000
161400            FROM  TDISTHD                                         16140000
161500           WHERE  ORD_NBR       =  :DK-PO-NBR                     16150000
161600             AND  RCVR_SEQ_NBR  =  :DK-PO-RCVR                    16160000
161700             AND  ORD_LNE_NBR   =  :DK-LNE-NBR                    16170000
161800     END-EXEC.                                                    16180000
161900                                                                  16190000
162000     EVALUATE TRUE                                                16200000
162100         WHEN SQLCODE = ZERO                                      16210000
162200             MOVE DISTHD-OTPK-UNT-QTY      TO PC039-OTPK-UNITS    16220000
162300             MOVE DISTHD-INPK-UNT-QTY      TO PC039-INPK-UNITS    16230000
162400             MOVE DISTHD-FCSE-LBL-TYP-CDE  TO PC039-LBL-TYPE      16240000
162500             MOVE ZEROES                   TO PC039-PREPK-RATIO   16250000
162600                                              PC039-PREPK-UNT-QTY 16260000
162700             IF  PC039-CASE-TYPE  >  SPACES                       16270000
162800                 CONTINUE                                         16280000
162900             ELSE                                                 16290000
163000                 IF DISTHD-INPK-CNVYB-IND = PC-Y                  16300000
163100                     SET PC039-INPK      TO  TRUE                 16310000
163200                 ELSE                                             16320000
163300                     SET PC039-FCSE      TO  TRUE                 16330000
163400                 END-IF                                           16340000
163500             END-IF                                               16350000
163600                                                                  16360000
163700             IF XL071-LOC-TYP-CDE = PC-CS                         16370000
163800                 SET PC039-CENTRAL-STK TO  TRUE                   16380000
163900                 MOVE PC-S  TO   PC039-LBL-TYPE                   16390000
164000             ELSE                                                 16400000
164100               IF  XL071-LOC-TYP-CDE = PC-DS  AND                 16410000
164200                   XL071-E-BUS-IND = PC-Y                         16420000
164300                       SET PC039-E-COMMERCE TO  TRUE              16430000
164400                       MOVE PC-S  TO   PC039-LBL-TYPE             16440000
164500               ELSE                                               16450000
164600                 IF DISTHD-FCSE-LBL-TYP-CDE = PC-R OR PC-S OR 'D' 16460000
164700                     MOVE PC-P  TO   PC039-LBL-FORMAT             16470000
164800                     MOVE PC-S  TO   PC039-LBL-TYPE               16480000
164900                 ELSE                                             16490000
165000                   IF DISTHD-FCSE-LBL-TYP-CDE = PC-U              16500000
165100                      MOVE PC-S  TO   PC039-LBL-FORMAT            16510000
165200                      MOVE PC-S  TO   PC039-LBL-TYPE              16520000
165300                   ELSE                                           16530000
165400                     IF  DISTHD-FCSE-LBL-TYP-CDE = PC-P           16540000
165500                         MOVE PC-P  TO   PC039-LBL-FORMAT         16550000
165600                         MOVE PC-P  TO   PC039-LBL-TYPE           16560000
165700                     ELSE                                         16570000
165800                         MOVE PC-G  TO   PC039-LBL-FORMAT         16580000
165900                         MOVE PC-S  TO   PC039-LBL-TYPE           16590000
166000                     END-IF                                       16600000
166100                   END-IF                                         16610000
166200                 END-IF                                           16620000
166300               END-IF                                             16630000
166400             END-IF                                               16640000
166500                                                                  16650000
166600         WHEN SQLCODE = +100                                      16660000
166700             MOVE ZEROES                  TO  PC039-OTPK-UNITS    16670000
166800                                              PC039-INPK-UNITS    16680000
166900                                              PC039-PREPK-RATIO   16690000
167000                                              PC039-PREPK-UNT-QTY 16700000
167400             PERFORM 8000-GET-LOCATION-INFO                       16740000
167500             MOVE PC-S                    TO  PC039-LBL-TYPE      16750000
167600         WHEN OTHER                                               16760000
167700             SET PV-DONE-PROCESSING                               16770000
167800                 PC039-ERROR                 TO TRUE              16780000
167900             MOVE SQLCODE                    TO PV-SQL-CODE       16790000
168000             STRING ' PCKRF888 - '          DELIMITED BY SIZE     16800000
168100                  '5300-GET-NON-PREPACK'    DELIMITED BY SIZE     16810000
168200                    ' SQL ERROR = '         DELIMITED BY SIZE     16820000
168300                    PV-SQL-CODE             DELIMITED BY SIZE     16830000
168400                                       INTO PV-CICS-MSG-AREA      16840000
168500             SET PS-DUMP-TO-LOG       TO TRUE                     16850000
168600             PERFORM 9990-WRITE-CICS                              16860000
168700     END-EVALUATE.                                                16870000
168800                                                                  16880000
169000                                                                  16900000
169001*-----------------------------------------------------------------16900182
169002* GET THE VENDOR NAME TO PRINT ON GENERIC SML FOR 3WD CARTONS    -16900282
169003*-----------------------------------------------------------------16900382
169004 5400-GET-ENT-NAME.                                               16900482
169005     MOVE PC039-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             16900582
169011                                                                  16901182
169012     EXEC SQL                                                     16901282
169013          SELECT  DISTINCT(C.ENT_NAME_DESC)                       16901382
169016            INTO :PV-ENT-NAME                                     16901682
169020            FROM  SUT_OTBND_UPC A                                 16902082
169021               ,  TPURCHS B                                       16902182
169022               ,  TENTNME C                                       16902282
169023           WHERE  A.SHIPT_UNT_ID    =  :DK-SHIPT-UNT-ID           16902382
169024             AND  A.TRN_NBR         =  B.PO_NBR                   16902482
169025             AND  B.VER_STATUS_CDE  = 'A'                         16902582
169026             AND  B.ENT_ID          =  C.ENT_ID                   16902682
169027             AND  C.TYPE_CDE        = '01'                        16902782
169028           FETCH FIRST 1 ROW ONLY                                 16902884
169029            WITH UR                                               16902982
169030     END-EXEC.                                                    16903082
169031                                                                  16903182
169032     EVALUATE TRUE                                                16903282
169033         WHEN SQLCODE = ZERO                                      16903382
169034         WHEN SQLCODE = -811                                      16903482
169035              CONTINUE                                            16903582
169077                                                                  16907782
169078         WHEN SQLCODE = +100                                      16907882
169079         WHEN SQLCODE = -305                                      16907982
169080             MOVE SPACES                  TO  PV-ENT-NAME         16908082
169081                                                                  16908182
169085         WHEN OTHER                                               16908582
169086             SET PV-DONE-PROCESSING                               16908682
169087                 PC039-ERROR                 TO TRUE              16908782
169088             MOVE SQLCODE                    TO PV-SQL-CODE       16908882
169089             MOVE DK-SHIPT-UNT-ID            TO PV-DISP-SHPUNT    16908982
169090             STRING ' PCKRF888 - '                                16909082
169091                  '5400-GET-ENT-NAME   '                          16909182
169092                    ' SQL ERROR = '                               16909282
169093                    PV-SQL-CODE '  '                              16909382
169094                    PV-DISP-SHPUNT          DELIMITED BY SIZE     16909482
169095                                       INTO PV-CICS-MSG-AREA      16909582
169096             SET PS-DUMP-TO-LOG       TO TRUE                     16909682
169097             PERFORM 9990-WRITE-CICS                              16909782
169098     END-EVALUATE.                                                16909882
169099                                                                  16909982
169100                                                                  16910082
169101*-----------------------------------------------------------------16910182
169110* CALL SUKUT149 TO DETERMINE IF CARTON IS RFID                    16911082
169200* CHECKIN P2L AND SML                                             16920000
169300*-----------------------------------------------------------------16930000
169400 5900-CALL-RFID-DETERMINATION.                                    16940000
169500*-----------------------------------------------------------------16950000
169600                                                                  16960000
169700     INITIALIZE SU093-ITEM-COMMAREA.                              16970000
169800     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   16980000
169900     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   16990000
170000     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   17000000
170100     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   17010000
170200     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   17020000
170300     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   17030000
170400     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   17040000
170500     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   17050000
170600                                                                  17060000
170700     SET  SU093-CHECK-IN                 TO TRUE.                 17070000
170800                                                                  17080000
171000     IF PC039-LBL-FORMAT = PC-D                                   17100000
171100         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               17110000
171200         SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE               17120000
171300         SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE               17130000
171400         SET SU093-CHECK-BY-DC              TO TRUE               17140000
171500         MOVE PC039-CURR-OPER-UNT        TO SU093-KEY-OPER-UNT-ID 17150000
171600         MOVE PC039-CARTON-ID-ENTERED    TO SU093-KEY-CARTON-ID   17160000
171700     ELSE                                                         17170000
171800         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               17180000
171900         SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE               17190000
172000         SET SU093-RFID-STR-CHK-NEEDED-YES  TO TRUE               17200000
172100         SET SU093-CHECK-BY-DC              TO TRUE               17210000
172200         MOVE PC039-CURR-OPER-UNT         TO SU093-KEY-OPER-UNT-ID17220000
172300         MOVE PC039-CARTON-ID-ENTERED     TO SU093-KEY-CARTON-ID  17230000
172400         MOVE PC039-STR-NBR               TO SU093-KEY-DEST-LOC   17240000
172500     END-IF.                                                      17250000
172600                                                                  17260000
172700     CALL SU093-RFID-PGM       USING DFHEIBLK                     17270000
172800                                     SU093-COMMAREA               17280000
172900                                     SU093-ITEM-COMMAREA.         17290000
173000                                                                  17300000
173100     EVALUATE TRUE                                                17310000
173200       WHEN SU093-SUCCESSFUL                                      17320000
173300           IF SU093-RFID-IND = 'Y'                                17330000
173400               PERFORM 5910-SET-RFID-ON-LABEL                     17340000
173500           END-IF                                                 17350000
173600       WHEN OTHER                                                 17360000
173700           CONTINUE                                               17370000
173800     END-EVALUATE.                                                17380000
173900                                                                  17390000
174000*-----------------------------------------------------------------17400000
174100* MORE TESTS TO FURTHER DETERMINE IF RFID SHOULD PRINT ON LABEL   17410000
174200*-----------------------------------------------------------------17420000
174300 5910-SET-RFID-ON-LABEL.                                          17430000
174400*-----------------------------------------------------------------17440000
174500* **************************************************************  17450000
174600* ONCE COMING BACK FROM ROUTINE AND YOU KNOW ITS RFID YOU      *  17460000
174700* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF   *  17470000
174800* RFID IS PRINTED ON THE LABEL                                 *  17480000
174900* **************************************************************  17490000
175000                                                                  17500000
175100     SET PS-RFID-ON-LABEL-NO TO TRUE.                             17510000
175200                                                                  17520000
175300     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            17530000
175400*       MEANS NO RFID ON LABELS                                   17540000
175500        SET PS-RFID-ON-LABEL-NO TO TRUE                           17550000
175600     ELSE                                                         17560000
175700        IF SU093-VNDR-DPT-RFID-TAGS-YES AND                       17570000
175800            SU093-DC-DEPT-TAGS-NO                                 17580000
175900*           MEANS NO RFID ON LABELS                               17590000
176000            SET PS-RFID-ON-LABEL-NO  TO TRUE                      17600000
176100        ELSE                                                      17610000
176200            IF SU093-VNDR-DPT-RFID-TAGS-NO AND                    17620000
176300              SU093-DC-DEPT-TAGS-YES                              17630000
176400*             MEANS YES TO RFID ON LABELS                         17640000
176500              SET PS-RFID-ON-LABEL-YES TO TRUE                    17650000
176600            ELSE                                                  17660000
176700              IF SU093-VNDR-DPT-RFID-TAGS-NO AND                  17670000
176800                 SU093-DC-DEPT-TAGS-NO                            17680000
176900*                MEANS NO RFID ON LABELS                          17690000
177000                 SET PS-RFID-ON-LABEL-NO TO TRUE                  17700000
177100              ELSE                                                17710000
177200                  IF SU093-VNDR-DPT-RFID-TAGS-YES AND             17720000
177300                     SU093-DC-DEPT-TAGS-YES                       17730000
177400*                    CHANGED TO NO WITH AUDIT CHANGES INSTALL     17740080
177500*                    MEANS NO TO RFID ON LABELS                   17750074
177600                     SET PS-RFID-ON-LABEL-NO TO TRUE              17760074
177700                  END-IF                                          17770000
177800              END-IF                                              17780000
177900            END-IF                                                17790000
178000        END-IF                                                    17800000
178100     END-IF.                                                      17810000
178200*                                                                 17820080
178400*     WHEN RFID IS SET TO NO SHOULD NOT DISPLAY RFID ON THE SCREEN17840078
178500     IF PS-RFID-ON-LABEL-NO                                       17850078
178600        IF SU093-PRINT-EAS OR SU093-PRINT-RFID-EAS                17860078
178700           SET PS-RFID-ON-LABEL-YES TO TRUE                       17870078
178800        END-IF                                                    17880078
178900     END-IF.                                                      17890078
179000                                                                  17900078
179100****************************************************************  17910078
179200*                                                                 17920080
179300 5950-CHECK-RFD-CRTN-LBL-PRINT.                                   17930000
179400                                                                  17940000
179500     MOVE PC039-CARTON-ID-ENTERED TO SHUNLO-SHIPT-UNT-ID          17950000
179600                                                                  17960000
179700     EXEC SQL                                                     17970000
179800          SELECT  A.SCN_LOC_ID                                    17980000
179900          INTO   :SHUNLO-SCN-LOC-ID                               17990000
180000          FROM    TSHUNLO A                                       18000000
180100          WHERE   A.SHIPT_UNT_ID = :SHUNLO-SHIPT-UNT-ID           18010000
180200            AND   A.SCN_LOC_ID   LIKE ('RFD%')                    18020000
180300            AND   A.ACTV_CDE     = 'I'                            18030000
180400            AND   A.CRE_TMST     =                                18040000
180500                   (SELECT MAX(B.CRE_TMST)                        18050000
180600                      FROM TSHUNLO B                              18060000
180700                     WHERE B.SHIPT_UNT_ID = :SHUNLO-SHIPT-UNT-ID  18070000
180800                       AND B.ACTV_CDE     = 'I'                   18080000
180900                       AND B.SCN_LOC_ID   LIKE ('RFD%'))          18090000
181000     END-EXEC.                                                    18100000
181100                                                                  18110000
181200     EVALUATE TRUE                                                18120000
181300        WHEN SQLCODE = +0                                         18130000
181400             IF SHUNLO-SCN-LOC-ID = 'RFDC'                        18140000
181500                SET PC039-RF-CRTN-LBL TO TRUE                     18150000
181600             END-IF                                               18160000
181700        WHEN SQLCODE = +100                                       18170000
181800             CONTINUE                                             18180000
181900        WHEN OTHER                                                18190000
182000             SET PV-DONE-PROCESSING                               18200000
182100                 PC039-ERROR             TO TRUE                  18210000
182200             MOVE SQLCODE                TO PV-SQL-CODE           18220000
182300             STRING ' PCKRF888 - '            DELIMITED BY SIZE   18230000
182400             '5950-CHECK-RFD-CRTN-LBL-PRINT'  DELIMITED BY SIZE   18240000
182500                    ' SQL ERROR = '           DELIMITED BY SIZE   18250000
182600                    PV-SQL-CODE               DELIMITED BY SIZE   18260000
182700                                         INTO PV-CICS-MSG-AREA    18270000
182800             SET PS-DUMP-TO-LOG          TO TRUE                  18280000
182900             PERFORM 9990-WRITE-CICS                              18290000
183000     END-EVALUATE.                                                18300000
183100                                                                  18310000
183300                                                                  18330000
183400*----------------------------------------------------------------*18340000
183500* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         18350000
183600*----------------------------------------------------------------*18360000
183700 6000-GET-DEPT-NAME.                                              18370000
183800                                                                  18380000
183900     PERFORM 6100-GET-CURRENT-DATE.                               18390000
184000     SET DP003-MCL-LOOKUP              TO TRUE.                   18400000
184100     SET DP003-DPT-LOOKUP              TO TRUE.                   18410000
184200                                                                  18420000
184300     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      18430000
184400     MOVE '03'                         TO DP003-OP-CO-NMBR.       18440000
184500     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         18450000
184600     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         18460000
184700     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          18470000
184800     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      18480000
184900                                          DP003-EFF-DATE.         18490000
185000     MOVE PC039-DEPT                   TO DP003-DPT-INPUT.        18500000
185100     MOVE PC039-CLASS                  TO PV-DPKUT038-MJR-CL.     18510000
185200     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   18520000
185300     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        18530000
185400                                                                  18540000
185500     EXEC CICS                                                    18550000
185600         LINK PROGRAM  (PV-DPKUT038)                              18560000
185700              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              18570000
185800              LENGTH   (PV-DPKUT038-CA-LENGTH)                    18580000
185900              RESP     (PV-DPKUT038-CICS-RESP)                    18590000
186000     END-EXEC.                                                    18600000
186100                                                                  18610000
186200     EVALUATE TRUE                                                18620000
186300         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            18630000
186400              MOVE DP003-DPT-DESCRIPTION TO PC039-DEPT-NAME       18640000
186500              MOVE DP003-MCL-DESCRIPTION TO PC039-MAJOR-CLASS     18650000
186600         WHEN OTHER                                               18660000
186700              MOVE SPACES                TO PC039-DEPT-NAME       18670000
186800              MOVE SPACES                TO PC039-MAJOR-CLASS     18680000
186900     END-EVALUATE.                                                18690000
187000                                                                  18700000
187100     IF  PC039-DEPT-NAME NOT >  SPACES                            18710000
187200         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO PC039-DEPT-NAME      18720000
187300     END-IF.                                                      18730000
187400                                                                  18740000
187500     IF  PC039-MAJOR-CLASS NOT  >  SPACES                         18750000
187600         MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@' TO PC039-MAJOR-CLASS    18760000
187700     END-IF.                                                      18770000
187800                                                                  18780000
187900*-----------------------------------------------------------------18790000
188000*  GET CURRENT DATE TO PRINT ON LABEL                             18800000
188100*-----------------------------------------------------------------18810000
188200 6100-GET-CURRENT-DATE.                                           18820000
188300                                                                  18830000
188400     EXEC SQL                                                     18840000
188500         SELECT  CURRENT DATE                                     18850000
188600                ,CURRENT TIME                                     18860000
188700           INTO  :PV-CURRENT-DB2-DATE                             18870000
188800                ,:PV-CURRENT-DB2-TIME                             18880000
188900           FROM  TCOCNTL                                          18890000
189000          WHERE  OPER_UNT_ID = 90                                 18900000
189100     END-EXEC.                                                    18910000
189200                                                                  18920000
189300     EVALUATE TRUE                                                18930000
189400         WHEN SQLCODE = ZERO                                      18940000
189500              MOVE  PV-CURRENT-MM  TO  PV-LBL-PRT-MM              18950000
189600              MOVE  PV-CURRENT-DD  TO  PV-LBL-PRT-DD              18960000
189700              MOVE  PV-CURRENT-YY  TO  PV-LBL-PRT-YY              18970000
189800              MOVE  PV-CURRENT-HR  TO  PV-LBL-PRT-HR              18980000
189900              MOVE  PV-CURRENT-MN  TO  PV-LBL-PRT-MN              18990000
190000                                                                  19000000
190100         WHEN OTHER                                               19010000
190200              MOVE  ZEROES         TO  PV-LBL-PRT-MM              19020000
190300                                       PV-LBL-PRT-DD              19030000
190400                                       PV-LBL-PRT-YY              19040000
190500                                       PV-LBL-PRT-HR              19050000
190600                                       PV-LBL-PRT-MN              19060000
190700      END-EVALUATE.                                               19070000
190800                                                                  19080000
190900*-----------------------------------------------------------------19090000
191000 6250-CHECK-FOR-MULT.                                             19100000
191100     MOVE PC039-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             19110000
191200     MOVE PC039-PO-NBR            TO DK-PO-NBR.                   19120000
191300     MOVE PC039-PO-RCVR           TO DK-PO-RCVR.                  19130000
191400     INITIALIZE PV-CART-UPC-MULT-CNT.                             19140000
191500                                                                  19150000
191600     EXEC SQL                                                     19160000
191700         SELECT   COUNT(DISTINCT(TRN_LNE_NBR))                    19170000
191800          INTO    :PV-CART-UPC-MULT-CNT                           19180000
191900          FROM    SUT_OTBND_UPC                                   19190000
192000          WHERE   SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             19200000
192100            AND   TRN_NBR          = :DK-PO-NBR                   19210000
192200            AND   RCVR_SEQ_NBR     = :DK-PO-RCVR                  19220000
192300     END-EXEC                                                     19230000
192400                                                                  19240000
192500         EVALUATE TRUE                                            19250000
192600             WHEN SQLCODE = +0                                    19260000
192700                  CONTINUE                                        19270000
192800             WHEN SQLCODE < +0                                    19280000
192900             WHEN SQLCODE > +0                                    19290000
193000                  MOVE ZEROES   TO PV-CART-UPC-MULT-CNT           19300000
193100         END-EVALUATE.                                            19310000
193200                                                                  19320000
193300*-----------------------------------------------------------------19330000
193400*  GET SEASONAL SET INFO                                          19340000
193500*-----------------------------------------------------------------19350000
193600 6300-GET-SEASONAL-SET.                                           19360000
193700                                                                  19370000
193800     INITIALIZE PC240-ITEM-COMMAREA                               19380000
193900     MOVE PC039-STR-NBR                 TO PV-4-DGT-STR-NBR.      19390000
194000     MOVE PV-4-DGT-STR-NBR              TO PC240-KEY-DEST-LOC     19400000
194100     MOVE PC039-PO-NBR                  TO PC240-KEY-PO           19410000
194200     MOVE PC039-SHIPT-UNT-ID            TO PC240-KEY-CARTON-ID    19420000
194300     SET  PC240-CARTON-STATUS           TO TRUE                   19430000
194400                                                                  19440000
194500                                                                  19450000
194600     CALL PC240-VSM-PGM USING DFHEIBLK                            19460000
194700                              PC240-COMMAREA                      19470000
194800                              PC240-ITEM-COMMAREA                 19480000
194900                                                                  19490000
195000     EVALUATE TRUE                                                19500000
195100         WHEN PC240-SUCCESSFUL                                    19510000
195200                                                                  19520000
195300             MOVE PC240-SEASET-NM      TO PC039-SEASONAL-SET      19530000
195400             MOVE PC240-FIXT-ID        TO PC039-FIXTURE           19540000
195500                                                                  19550000
195600         WHEN PC240-ITEM-NOT-FOUND                                19560000
195700             MOVE SPACES               TO PC039-SEASONAL-SET      19570000
195800                                          PC039-FIXTURE           19580000
195900         WHEN PC240-SQL-ERROR                                     19590000
196000         WHEN PC240-INVALID-ACCESS                                19600000
196100             SET PV-DONE-PROCESSING                               19610000
196200                 PC039-ERROR                 TO TRUE              19620000
196300             MOVE PC240-ERROR-NBR            TO PV-SQL-CODE       19630000
196400             STRING ' PCKRF888 - '          DELIMITED BY SIZE     19640000
196500                 '6300-GET-SEASONAL-SET'    DELIMITED BY SIZE     19650000
196600                    ' SQL ERROR = '         DELIMITED BY SIZE     19660000
196700                    PV-SQL-CODE             DELIMITED BY SIZE     19670000
196800                                       INTO PV-CICS-MSG-AREA      19680000
196900             SET PS-DUMP-TO-LOG       TO TRUE                     19690000
197000             PERFORM 9990-WRITE-CICS                              19700000
197100         WHEN OTHER                                               19710000
197200             SET PV-DONE-PROCESSING                               19720000
197300                 PC039-ERROR                 TO TRUE              19730000
197400             MOVE PC240-ERROR-NBR            TO PV-SQL-CODE       19740000
197500             STRING ' PCKRF888 - '          DELIMITED BY SIZE     19750000
197600                 '6300-GET-SEASONAL-SET'    DELIMITED BY SIZE     19760000
197700                    ' SQL ERROR = '         DELIMITED BY SIZE     19770000
197800                    PV-SQL-CODE             DELIMITED BY SIZE     19780000
197900                                       INTO PV-CICS-MSG-AREA      19790000
198000             SET PS-DUMP-TO-LOG       TO TRUE                     19800000
198100             PERFORM 9990-WRITE-CICS                              19810000
198200                                                                  19820000
198300     END-EVALUATE.                                                19830000
198400                                                                  19840000
198500                                                                  19850000
198600*-----------------------------------------------------------------19860000
198700*  GET STORE ZONE INFO                                            19870000
198800*-----------------------------------------------------------------19880000
198900 6400-GET-STORE-ZONE.                                             19890000
199000     MOVE PC039-PO-NBR  TO DK-PO-NBR.                             19900000
199100                                                                  19910000
199200     EXEC SQL                                                     19920000
199300         SELECT  C.STR_ZN_ID                                      19930000
199400           INTO :MDSEDP-STR-ZN-ID                                 19940000
199500           FROM  TPURCHS A                                        19950000
199600                ,TMDSEAR B                                        19960000
199700                ,TMDSEDP C                                        19970000
199800                ,TRECEIV D                                        19980000
199900          WHERE  A.PO_NBR          =  :DK-PO-NBR                  19990000
200000            AND  D.ORD_NBR         =  A.PO_NBR                    20000000
200100            AND  A.VER_NBR         =  D.PO_VER_NBR                20010000
200200            AND  A.DEPT_NBR        =  B.DEPT_NBR                  20020000
200300            AND  B.MDSELV_CDE      =  :PC-DPT                     20030000
200400            AND  B.OPERCO_NBR      =  :PC-03                      20040000
200500            AND (B.STRT_DTE       <=  CURRENT DATE                20050000
200600            AND  B.END_DTE        >   CURRENT DATE)               20060000
200700            AND  B.MDSEAR_DKEY     =  C.MDSEAR_DKEY               20070000
200800            AND  D.REC_SEQ_NBR     =  :DK-PO-RCVR                 20080000
200900     END-EXEC.                                                    20090000
201000                                                                  20100000
201100     EVALUATE TRUE                                                20110000
201200         WHEN SQLCODE = ZERO                                      20120000
201300              MOVE MDSEDP-STR-ZN-ID  TO PC039-ZONE                20130000
201400         WHEN OTHER                                               20140000
201500              MOVE SPACES            TO PC039-ZONE                20150000
201600      END-EVALUATE.                                               20160000
201700                                                                  20170000
201800*-----------------------------------------------------------------20180000
201900*  GET TRANSFER NUMBER INFO.                                      20190000
202000*-----------------------------------------------------------------20200000
202100 7000-GET-XFER-NBR.                                               20210000
202200     MOVE SPACES TO PC039-RF-ZNE-LINE-1                           20220000
202300                    PC039-RF-ZNE-LINE-2                           20230000
202400                    PC039-RF-ZNE-LINE-3.                          20240000
202500     MOVE '* FAST TRANSFER *'  TO PC039-RF-ZNE-LINE-1             20250000
202600     EXEC SQL                                                     20260000
202700         SELECT  DISTINCT(TRN_NBR)                                20270000
202800           INTO :SUT00028-TRN-NBR                                 20280000
202900           FROM  SUT_OTBND_UPC                                    20290000
203000          WHERE  SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID             20300000
203100     END-EXEC.                                                    20310000
203200                                                                  20320000
203300     EVALUATE TRUE                                                20330000
203400         WHEN SQLCODE = ZERO                                      20340000
203500              MOVE SUT00028-TRN-NBR TO PV-XFER-NBR                20350000
203600              PERFORM 7100-GET-CHECK-DIGIT                        20360000
203700         WHEN SQLCODE = -811                                      20370000
203800              MOVE '   MULTIPLE'  TO PC039-RF-ZNE-LINE-2          20380000
203900         WHEN SQLCODE = +100                                      20390000
204000              MOVE '   UNKNOWN '  TO PC039-RF-ZNE-LINE-2          20400000
204100         WHEN OTHER                                               20410000
204200              MOVE SPACES            TO PC039-ZONE                20420000
204300      END-EVALUATE.                                               20430000
204400                                                                  20440000
204500*-----------------------------------------------------------------20450000
204600*  GET CHECK DIGIT NUMBER                                         20460000
204700*-----------------------------------------------------------------20470000
204800 7100-GET-CHECK-DIGIT.                                            20480000
204900     MOVE PV-XFER-STR-NBR             TO PC037-XFER-FROM-STORE-NBR20490000
205000                                         PV-FAST-STORE            20500000
205100     MOVE PV-XFER-SEQ-NBR             TO PC037-XFER-SEQ-NBR       20510000
205200                                         PV-FAST-SEQ              20520000
205300     PERFORM P0300-GET-CHK-DIGIT                                  20530000
205400                                                                  20540000
205500     MOVE PC037-FAST-CHECK-DIGIT      TO PV-FAST-CHK-DIGIT        20550000
205600     IF PV-XFER-STR-NBR  = ZERO                                   20560000
205700                AND PV-XFER-SEQ-NBR = ZERO                        20570000
205800         MOVE '    UNKNOWN'           TO PC039-RF-ZNE-LINE-2      20580000
205900     ELSE                                                         20590000
206000         MOVE PV-FAST-NBR             TO PC039-RF-ZNE-LINE-2      20600000
206100     END-IF.                                                      20610000
206200                                                                  20620000
206300*-----------------------------------------------------------------20630000
206400*  GET LOCATION INFORMATION                                       20640000
206500*-                                                                20650080
206510* THE XLT_LOC TABLE WAS REMOVED BUT REPLACED WITH THE LOCATION    20651080
206520* HIERARCY DOMAIN TABLE XL00010                                   20652080
206530*-----------------------------------------------------------------20653080
206600 8000-GET-LOCATION-INFO.                                          20660000
207000                                                                  20700000
207100     INITIALIZE XL071-COMMAREA-REC.                               20710000
207200     MOVE PV-4-DGT-STR-NBR  TO XL071-LOCATION-NUMBER.             20720000
207300                                                                  20730000
207400     CALL PC-LOCATION-MODULE  USING                               20740000
207500                                    DFHEIBLK                      20750000
207600                                    XL071-COMMAREA                20760000
207700                                    XL071-COMMAREA-REC.           20770000
207800                                                                  20780000
207900     EVALUATE TRUE                                                20790000
208000         WHEN XL071-NO-ERRORS                                     20800000
208100              MOVE XL071-LOC-10-ABBR-NM TO PC039-STR-NAME         20810000
208200         WHEN OTHER                                               20820000
208300              MOVE SPACES               TO PC039-STR-NAME         20830000
208400      END-EVALUATE.                                               20840000
208500                                                                  20850000
208600*----------------------------------------------------------------*20860000
208700*  GET OUTER PACK                                                *20870000
208800*----------------------------------------------------------------*20880000
208900 8500-GET-OUTER-PACK.                                             20890000
209000                                                                  20900000
209100     EXEC SQL                                                     20910000
209200          SELECT  SUM(SHPD_UNT_QTY)                               20920000
209300            INTO :PV-SHIPPED-QTY                                  20930000
209400            FROM  SUT_OTBND_UPC                                   20940000
209500           WHERE  SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                20950000
209600     END-EXEC                                                     20960000
209700                                                                  20970000
209800     EVALUATE TRUE                                                20980000
209900         WHEN SQLCODE = ZERO                                      20990000
210000              MOVE PV-SHIPPED-QTY  TO  PC039-OTPK-UNITS           21000000
210100         WHEN OTHER                                               21010000
210200              MOVE ZEROES          TO  PC039-OTPK-UNITS           21020000
210300     END-EVALUATE.                                                21030000
210400                                                                  21040000
210500*-----------------------------------------------------------------21050000
210600* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  21060000
210700* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       21070000
210800* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 21080000
210900* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     21090000
211000* WRAPPED AROUND.                                                 21100000
211100*-----------------------------------------------------------------21110000
211200 9990-WRITE-CICS.                                                 21120000
211300*-----------------------------------------------------------------21130000
211400     MOVE ZEROES TO PT-MSG-SEQ (PT-MSG-IDX).                      21140000
211500     EVALUATE TRUE                                                21150000
211600     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          21160000
211700         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 21170000
211800         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         21180000
211900         SET PT-MSG-IDX UP BY 1                                   21190000
212000     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          21200000
212100         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 21210000
212200         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         21220000
212300         SET PT-MSG-IDX               TO 1                        21230000
212400     END-EVALUATE.                                                21240000
212500                                                                  21250000
212600     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              21260000
212700     MOVE PV-NEXT-SEQUENCE  TO PT-MSG-SEQ (PT-MSG-IDX).           21270000
212800                                                                  21280000
212900*---------------------------------------------------------------- 21290000
213000*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    21300000
213100*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    21310000
213200*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              21320000
213300*---------------------------------------------------------------- 21330000
213400     IF PS-SHOW-DEBUG-INFO                                        21340000
213500         PERFORM 9991-WRITEQ                                      21350000
213600     END-IF                                                       21360000
213700     MOVE SPACES                      TO PV-CICS-MSG-AREA.        21370000
213800                                                                  21380000
213900*-----------------------------------------------------------------21390000
214000 9991-WRITEQ.                                                     21400000
214100*-----------------------------------------------------------------21410000
214200     EXEC CICS                                                    21420000
214300         WRITEQ TD                                                21430000
214400         QUEUE(PC-CSSL)                                           21440000
214500         FROM(PV-CICS-MSG-AREA)                                   21450000
214600         RESP(PV-CICS-RESPONSE)                                   21460000
214700     END-EXEC.                                                    21470000
214800                                                                  21480000
214900*-----------------------------------------------------------------21490000
215000*  RETURN TO CALLING PROGRAM                                      21500000
215100*-----------------------------------------------------------------21510000
215200 9998-RETURN.                                                     21520000
215300     STRING   ' 9998-RETURN'                                      21530000
215400     DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                      21540000
215500     PERFORM 9990-WRITE-CICS                                      21550000
215600                                                                  21560000
215700*-RELEASE EXCLUSIVE USE OF THE LOG QUEUE                          21570000
215800     IF PS-SHOW-DEBUG-INFO                                        21580000
215900         EXEC CICS DEQ                                            21590000
216000             RESOURCE(PC-CSSL)                                    21600000
216100         END-EXEC                                                 21610000
216200     END-IF                                                       21620000
216300                                                                  21630000
216400     IF PS-DUMP-TO-LOG                                            21640000
216500         PERFORM 9999-FINAL-DUMP                                  21650000
216600     END-IF                                                       21660000
216700                                                                  21670000
216800     IF PV-DONE-PROCESSING                                        21680000
216900         EXEC CICS SYNCPOINT ROLLBACK                             21690000
217000             END-EXEC                                             21700000
217100     ELSE                                                         21710000
217200         EXEC CICS SYNCPOINT                                      21720000
217300             END-EXEC                                             21730000
217400     END-IF.                                                      21740000
217500                                                                  21750000
217600     MOVE PC039-COMMAREA-REC            TO DFHCOMMAREA.           21760000
217700                                                                  21770000
217800     EXEC CICS                                                    21780000
217900          RETURN                                                  21790000
218000     END-EXEC.                                                    21800000
218100                                                                  21810000
218200                                                                  21820000
218300*    GOBACK.                                                      21830000
218400                                                                  21840000
218500*-----------------------------------------------------------------21850000
218600*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    21860000
218700*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        21870000
218800*  OVERFLOW, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED      21880000
218900*  OCCRENCES ARE NOT DISPLAYED.                                   21890000
219000*-----------------------------------------------------------------21900000
219100 9999-FINAL-DUMP.                                                 21910000
219200*-----------------------------------------------------------------21920000
219300     STRING ' 9999-FINAL-DUMP'                                    21930000
219400         DELIMITED BY SIZE                                        21940000
219500         INTO PV-CICS-MSG-AREA                                    21950000
219600     PERFORM 9990-WRITE-CICS                                      21960000
219700                                                                  21970000
219800         EXEC CICS ENQ                                            21980000
219900             RESOURCE(PC-CSSL)                                    21990000
220000         END-EXEC                                                 22000000
220100                                                                  22010000
220200         PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL             22020000
220300                         PT-MSG-IDX > PC-MSG-TABLE-SIZE           22030000
220400                    OR   PT-MSG-SEQ (PT-MSG-IDX) < 0              22040000
220500             IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                    22050000
220600                 MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-DISP-MSG-NBR  22060000
220700                 STRING ' ' PV-DISP-TASK ' '                      22070000
220800                      PV-DISP-MSG-NBR ' '                         22080000
220900                      PT-MSG-LINE (PT-MSG-IDX)                    22090000
221000                      DELIMITED BY SIZE INTO PV-CICS-MSG-AREA     22100000
221100                 PERFORM 9991-WRITEQ                              22110000
221200             END-IF                                               22120000
221300             SET PT-MSG-IDX  TO 200                               22130000
221400         END-PERFORM                                              22140000
221500                                                                  22150000
221600         SET PT-MSG-IDX               TO 1                        22160000
221700         SET PS-DONT-DUMP-TO-LOG      TO TRUE                     22170000
221800                                                                  22180000
221900         EXEC CICS DEQ                                            22190000
222000             RESOURCE(PC-CSSL)                                    22200000
222100         END-EXEC.                                                22210000
222200                                                                  22220000
222300*-----------------------------------------------------------------22230000
222400     COPY PCPD037.                                                22240000
222500                                                                  22250000
