000100 IDENTIFICATION DIVISION.                                         00010003
000200 PROGRAM-ID.    PXKUT009.                                         00020003
000300 AUTHOR.        KOHLS DEPARTMENT STORES.                          00030003
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040003
000500 DATE-WRITTEN.  12/25/2004.                                       00050003
000600 DATE-COMPILED.                                                   00060003
000700******************************************************************00070003
000800**THIS PROGRAM CREATES THE FILE IN THE COPYBOOK REQUIRED FOR      00080006
000900**LATER PROCESSING.                                               00090006
001000**     - PXRD004 - FILE EXTRACTED AND SORTED                      00100006
001100**     - PXRD005 - OUTPUT FILE FOR LATER PROCESSING               00110006
001200******************************************************************00120003
001300**DATE:12/25/2004 MADE BY:JULIE TEWES INITIAL PROGRAM WRITE       00130003
001400******************************************************************00140003
001500**DATE:05/12/2005 MADE BY:JULIE TEWES ADDED 2 COLUMNS             00150003
001600******************************************************************00160003
001700**DATE:09/13/2005 MADE BY:JULIE TEWES PRICE OPTIMIZATION          00170003
001800******************************************************************00180003
001900**DATE:01/11/2006 MADE BY:JULIE TEWES GROUP B CHANGES             00190003
002000******************************************************************00200003
002100**DATE: 05/19/2006 CHANGED BY: DAVID WELLER                       00210003
002200**      ADD 116 PRICE OPTIMIZATION STORES TO RFWS010 AS GROUP C   00220003
002300******************************************************************00230003
002400**DATE: 07/18/2006 CHANGED BY: DAVID WELLER                       00240003
002500**      ADD 186 PRICE OPTIMIZATION STORES TO RFWS010 GROUP C      00250003
002600******************************************************************00260003
002700**DATE: 01/17/2007 CHANGED BY: DAVID WELLER                       00270003
002800**      REMOVE RFWS010                                            00280003
002900******************************************************************00290003
003000 ENVIRONMENT DIVISION.                                            00300003
003100 CONFIGURATION SECTION.                                           00310003
003200 SOURCE-COMPUTER.    IBM-3090.                                    00320003
003300 OBJECT-COMPUTER.    IBM-3090.                                    00330003
003400 INPUT-OUTPUT SECTION.                                            00340003
003500 FILE-CONTROL.                                                    00350003
003600                                                                  00360003
003700     SELECT PRICE-CHANGE-FILE                                     00370003
003800            ASSIGN TO INP01.                                      00380004
003900     SELECT OUTPUT-FILE                                           00390003
004000            ASSIGN TO OUT01.                                      00400003
004100                                                                  00410003
004200 DATA DIVISION.                                                   00420003
004300 FILE SECTION.                                                    00430003
004400                                                                  00440003
004500 FD  PRICE-CHANGE-FILE                                            00450003
004600     RECORDING MODE IS F                                          00460003
004700     LABEL RECORDS OMITTED                                        00470003
004800     BLOCK CONTAINS 0 RECORDS                                     00480003
004900     DATA RECORD IS PRICE-CHANGE-RECORD.                          00490003
005000 01  PRICE-CHANGE-RECORD                 PIC X(193).              00500003
005100                                                                  00510003
005200 FD  OUTPUT-FILE                                                  00520003
005300     RECORDING MODE IS F                                          00530003
005400     LABEL RECORDS OMITTED                                        00540003
005500     BLOCK CONTAINS 0 RECORDS                                     00550003
005600     DATA RECORD IS OUTPUT-RECORD.                                00560003
005700 01  OUTPUT-RECORD                       PIC X(200).              00570003
005800                                                                  00580003
005900 WORKING-STORAGE SECTION.                                         00590003
006000******************************************************************00600003
006100**PROGRAM SWITCHES                                                00610003
006200******************************************************************00620003
006300 01  PS-SWITCH-AREAS.                                             00630003
006400     05  PS-END-OF-PX-FILE-SW            PIC X(01)  VALUE 'N'.    00640003
006500         88  PS-END-OF-PX-FILE                      VALUE 'Y'.    00650003
006600         88  PS-NOT-END-OF-PX-FILE                  VALUE 'N'.    00660003
006700******************************************************************00670003
006800**DATE TIME FIELDS                                                00680003
006900******************************************************************00690003
007000 01 DF-DATE-TIME-FIELDS.                                          00700003
007100    05 DF-ACCEPT-DATE                    PIC X(06) VALUE SPACES.  00710003
007200    05 DF-ACCEPT-TIME                    PIC X(08) VALUE SPACES.  00720003
007300******************************************************************00730003
007400**PROGRAM COUNTERS                                                00740003
007500******************************************************************00750003
007600 01  PC-PROGRAM-COUNTERS.                                         00760003
007700     05  PC-PRICE-CHANGE-RECORDS-READ    PIC 9(09) VALUE ZEROS.   00770003
007800     05  PC-OUTPUT-RECORDS-WRITTEN       PIC 9(09) VALUE ZEROS.   00780003
007900****************************************************************  00790003
008000**ABEND INFORMATION                                               00800003
008100****************************************************************  00810003
008200 01  AC-ABEND-FIELDS.                                             00820003
008300     05  AC-ABEND-CODE                   PIC S9(04) VALUE ZERO    00830003
008400                                                     COMP SYNC.   00840003
008500         88  AC-TABLE-ERROR                        VALUE +4004.   00850003
008600         88  AC-DB2-ERROR                          VALUE +4013.   00860003
008700 01  PV-MISC-ABEND-FIELDS.                                        00870003
008800     05  PV-PARAGRAPH-NAME               PIC X(30) VALUE SPACE.   00880003
008900     05  PV-OPERATION-MSG-1              PIC X(40) VALUE SPACE.   00890003
009000     05  PV-OPERATION-MSG-2              PIC X(40) VALUE SPACE.   00900003
009100     05  PV-DB2-OPERATION                PIC X(30) VALUE SPACE.   00910003
009200******************************************************************00920003
009300**COPYBOOKS                                                       00930003
009400******************************************************************00940003
009500****PRICE CHANGE RECORD LAYOUT                                    00950003
009600     COPY PXRD004.                                                00960003
009700****OUTPUT RECORD LAYOUT                                          00970003
009800     COPY PXRD005.                                                00980003
009900                                                                  00990003
010000 PROCEDURE DIVISION.                                              01000003
010100******************************************************************01010003
010200 000-MAINLINE-PROCESSING.                                         01020003
010300                                                                  01030003
010400     PERFORM 1000-INITIALIZATION.                                 01040003
010500     PERFORM 2000-PROCESS-RECORDS                                 01050003
010600             UNTIL PS-END-OF-PX-FILE.                             01060003
010700     PERFORM 9999-WRAPUP.                                         01070003
010800     GOBACK.                                                      01080003
010900                                                                  01090003
011000******************************************************************01100003
011100**INITIALIZATION ROUTINE                                          01110003
011200******************************************************************01120003
011300 1000-INITIALIZATION.                                             01130003
011400                                                                  01140003
011500     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01150003
011600                                                                  01160003
011700     OPEN INPUT  PRICE-CHANGE-FILE                                01170003
011800          OUTPUT OUTPUT-FILE.                                     01180003
011900                                                                  01190003
012000     ACCEPT DF-ACCEPT-TIME FROM TIME.                             01200003
012100     ACCEPT DF-ACCEPT-DATE FROM DATE.                             01210003
012200                                                                  01220003
012300     PERFORM 9999-READ-PRICE-CHANGE-RECORD.                       01230003
012400                                                                  01240003
012500******************************************************************01250003
012600**PROCESS INPUT RECORD TO CHECK ROWS                              01260003
012700******************************************************************01270003
012800 2000-PROCESS-RECORDS.                                            01280003
012900                                                                  01290003
013000     MOVE '2000-PROCESS-RECORDS'    TO PV-PARAGRAPH-NAME.         01300003
013100                                                                  01310003
013200     PERFORM 2100-MOVE-DATA.                                      01320003
013300     PERFORM 9999-READ-PRICE-CHANGE-RECORD.                       01330003
013400                                                                  01340003
013500******************************************************************01350003
013600**MOVE DATA TO OUTPUT RECORD                                      01360003
013700******************************************************************01370003
013800 2100-MOVE-DATA.                                                  01380003
013900                                                                  01390003
014000     MOVE '2100-MOVE-DATA'       TO PV-PARAGRAPH-NAME.            01400003
014100                                                                  01410003
014200     MOVE PXRD004-PRCHG-ID       TO PXRD005-PRCHG-ID.             01420003
014300     MOVE PXRD004-EFF-DATE       TO PXRD005-EFF-DATE.             01430003
014400     MOVE PXRD004-STR-NBR        TO PXRD005-STR-NBR.              01440003
014500     MOVE PXRD004-LOC-NM         TO PXRD005-LOC-NM.               01450003
014600     MOVE PXRD004-BUS-AREA-ID    TO PXRD005-BUS-AREA-ID.          01460003
014700     MOVE PXRD004-BUS-AREA-DESC  TO PXRD005-BUS-AREA-DESC.        01470003
014800     MOVE PXRD004-DEPT-NBR       TO PXRD005-DEPT-NBR.             01480003
014900     MOVE PXRD004-VS-NBR         TO PXRD005-VS-NBR.               01490003
015000     MOVE PXRD004-LBL-NM         TO PXRD005-LBL-NM.               01500003
015100     MOVE PXRD004-VS-DESC        TO PXRD005-VS-DESC.              01510003
015200     MOVE PXRD004-STKR-NBR       TO PXRD005-STKR-NBR.             01520003
015300     MOVE PXRD004-SUB-CL-NBR     TO PXRD005-SUB-CL-NBR.           01530003
015400     MOVE PXRD004-STR-EXPTED-QTY TO PXRD005-STR-EXPTED-QTY.       01540003
015500     MOVE PXRD004-IN-TRNST-QTY   TO PXRD005-IN-TRNST-QTY.         01550003
015600     MOVE PXRD004-UNT-RTL-AMT    TO PXRD005-UNT-RTL-AMT.          01560003
015700     MOVE PXRD004-LAST-UPD-TMST  TO PXRD005-LAST-UPD-TMST.        01570003
015800     MOVE PXRD004-LAST-NCLR-RTL-AMT                               01580003
015900                                 TO PXRD005-LAST-NCLR-RTL-AMT.    01590003
016000                                                                  01600003
016100     SET PXRD005-FULL-STYLE-MKDWN-YES TO TRUE.                    01610003
016200                                                                  01620003
016300     PERFORM 9999-WRITE-OUTPUT-RECORD.                            01630003
016400                                                                  01640003
016500******************************************************************01650003
016600**READ PRICE CHANGE RECORD                                        01660003
016700******************************************************************01670003
016800 9999-READ-PRICE-CHANGE-RECORD.                                   01680003
016900                                                                  01690003
017000     READ PRICE-CHANGE-FILE INTO PXRD004-YELLOW-TICKET-UNLOAD     01700003
017100          AT END                                                  01710003
017200          SET PS-END-OF-PX-FILE    TO TRUE                        01720003
017300     END-READ.                                                    01730003
017400                                                                  01740003
017500     IF  PS-NOT-END-OF-PX-FILE                                    01750003
017600         ADD +1                    TO PC-PRICE-CHANGE-RECORDS-READ01760003
017700     END-IF.                                                      01770003
017800                                                                  01780003
017900****************************************************************  01790003
018000**WRITE REPORT RECORD                                             01800003
018100****************************************************************  01810003
018200 9999-WRITE-OUTPUT-RECORD.                                        01820003
018300                                                                  01830003
018400     WRITE OUTPUT-RECORD FROM PXRD005-YELLOW-TICKET-UNLOAD.       01840003
018500                                                                  01850003
018600     ADD +1              TO PC-OUTPUT-RECORDS-WRITTEN.            01860003
018700                                                                  01870003
018800******************************************************************01880003
018900**CLOSE INPUT FILES.                                              01890003
019000******************************************************************01900003
019100 9999-WRAPUP.                                                     01910003
019200                                                                  01920003
019300     CLOSE PRICE-CHANGE-FILE                                      01930003
019400           OUTPUT-FILE.                                           01940003
019500                                                                  01950003
019600     PERFORM 9999-DISPLAY-STATISTICS.                             01960003
019700                                                                  01970003
019800******************************************************************01980003
019900**DISPLAY PROGRAM STATS                                           01990003
020000******************************************************************02000003
020100 9999-DISPLAY-STATISTICS.                                         02010003
020200                                                                  02020003
020300     DISPLAY '*************************************************'. 02030003
020400     DISPLAY '* PROGRAM...........: PXKUT009'.                    02040003
020500     DISPLAY '* DATE..............: ' DF-ACCEPT-DATE.             02050003
020600     DISPLAY '* TIME..............: ' DF-ACCEPT-TIME.             02060003
020700     DISPLAY '* REPORTS RECORDS WRITTEN...: '                     02070003
020800                                        PC-OUTPUT-RECORDS-WRITTEN.02080003
020900     DISPLAY '* PRICE CHANGE RECORDS READ.:'                      02090003
021000                                 PC-PRICE-CHANGE-RECORDS-READ.    02100003
021100     DISPLAY '*************************************************'. 02110003
021200                                                                  02120003
