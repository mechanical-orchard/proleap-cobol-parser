000100*------------------------*                                        00020001
000200 IDENTIFICATION DIVISION.                                         00030001
000300*------------------------*                                        00040001
000400 PROGRAM-ID.     SEKUT021.                                        00050001
000500 AUTHOR.         BARB SCHULTZ.                                    00060001
000600 DATE-WRITTEN.   01/31/12.                                        00070001
000700*---------------------------------------------------------------* 00080001
000800*                UPS PROGRAM                                    * 00090001
000900*---------------------------------------------------------------* 00100001
001300*    PROGRAM OVERVIEW:                                          * 00110001
001400*    THIS PROGRAM READS IN THE FIXED FORMATTED UPS FILE AND     * 00120001
001500*    CREATE THE UPS FILE THAT WILL BE FTP'D TO UPS.             * 00130001
001900*---------------------------------------------------------------* 00140001
002000*                                                               * 00150001
002100* INPUT:                                                        * 00160001
002200*   1. UPS EMPLOYEE LIST FILE - SERD009                         * 00170001
002200*   2. SPECIAL ACCESS FILE                                      * 00180001
006200*   3. EXTRA EMPLOY ACCESS FILE                                 * 00190001
006200*   4. LOCATION DEPLOY FILE                                     * 00200001
002600*                                                               * 00210001
002700* OUTPUT:                                                       * 00220001
002800*                                                               * 00230001
002900*   1. UPS FILE - SERD010                                       * 00240001
003300*                                                               * 00250001
003400*---------------------------------------------------------------* 00260001
003500* CHANGE LOG:                                                   * 00270001
003600*   DATE  01/31/2012                                            * 00280001
003700*       CHANGE MADE: INITIAL VERSION.                           * 00290001
003800*       MADE BY: BARB SCHULTZ            WR/IR #: 3559          * 00300001
003600*   DATE  05/15/2020                                            * 00301001
003700*       CHANGE MADE: RENAME FROM GLKUT096 TO SEKUT021           * 00302001
003800*       MADE BY: JEAN KURK                                      * 00303001
003900*                                                               * 00310001
004000*---------------------------------------------------------------* 00320001
004100                                                                  00330001
004200*---------------------*                                           00340001
004300 ENVIRONMENT DIVISION.                                            00350001
004400*---------------------*                                           00360001
004500 CONFIGURATION SECTION.                                           00370001
004600 SOURCE-COMPUTER.    IBM-3090.                                    00380001
004700 OBJECT-COMPUTER.    IBM-3090.                                    00390001
004800                                                                  00400001
004900 INPUT-OUTPUT SECTION.                                            00410001
005000 FILE-CONTROL.                                                    00420001
005100                                                                  00430001
005200     SELECT ITIM-INPUT-FILE        ASSIGN TO INP01.               00440001
006200     SELECT SPECIAL-ACCESS-FILE    ASSIGN TO INP02.               00450001
006200     SELECT EXTRA-EMPLOY-ACCESS-FILE ASSIGN TO INP03.             00460001
006200     SELECT LOCATION-DEPLOY-FILE   ASSIGN TO INP04.               00470001
005300     SELECT UPS-OUTPUT-FILE        ASSIGN TO OUT01.               00480001
005600                                                                  00490001
005700*--------------*                                                  00500001
005800 DATA DIVISION.                                                   00510001
005900*--------------*                                                  00520001
006000 FILE SECTION.                                                    00530001
006100                                                                  00540001
006200 FD  ITIM-INPUT-FILE                                              00550001
006300     RECORDING MODE IS F                                          00560001
006400     LABEL RECORDS ARE OMITTED                                    00570001
006500     BLOCK CONTAINS 0 RECORDS.                                    00580001
006700 01  ITIM-INPUT-REC            PIC  X(960).                       00590001
006800                                                                  00600001
006200 FD  SPECIAL-ACCESS-FILE                                          00610001
006300     RECORDING MODE IS F                                          00620001
006400     LABEL RECORDS ARE OMITTED                                    00630001
006500     BLOCK CONTAINS 0 RECORDS.                                    00640001
006700 01  SPECIAL-ACCESS-REC        PIC  X(60).                        00650001
006800                                                                  00660001
006200 FD  EXTRA-EMPLOY-ACCESS-FILE                                     00670001
006300     RECORDING MODE IS F                                          00680001
006400     LABEL RECORDS ARE OMITTED                                    00690001
006500     BLOCK CONTAINS 0 RECORDS.                                    00700001
006700 01  EXTRA-EMPLOY-ACCESS-REC   PIC  X(60).                        00710001
006800                                                                  00720001
006200 FD  LOCATION-DEPLOY-FILE                                         00730001
006300     RECORDING MODE IS F                                          00740001
006400     LABEL RECORDS ARE OMITTED                                    00750001
006500     BLOCK CONTAINS 0 RECORDS.                                    00760001
006700 01  LOCATION-DEPLOY-REC       PIC  X(40).                        00770001
306800                                                                  00780001
006900 FD  UPS-OUTPUT-FILE                                              00790001
007000     RECORDING MODE IS F                                          00800001
007100     LABEL RECORDS ARE OMITTED                                    00810001
007200     BLOCK CONTAINS 0 RECORDS.                                    00820001
007400 01  UPS-OUTPUT-REC            PIC  X(885).                       00830001
007500                                                                  00840001
009000 EJECT                                                            00850001
009100                                                                  00860001
009200 WORKING-STORAGE SECTION.                                         00870001
009300                                                                  00880001
002200 01  CC-SPEC-ACC-FILE.                                            00890001
009600     05  CC-SPEC-FNAME             PIC X(20)   VALUE SPACES.      00900001
009600     05  CC-SPEC-LNAME             PIC X(20)   VALUE SPACES.      00910001
009900     05  CC-SPEC-USERID            PIC X(07)   VALUE SPACES.      00920001
009900     05  CC-SPEC-LOC               PIC X(04)   VALUE SPACES.      00930001
009900     05  FILLER                    PIC X(09)   VALUE SPACES.      00940001
010100                                                                  00950001
002200 01  CC-EXT-EMP-ACC-FILE.                                         00960001
009600     05  CC-EXT-FNAME              PIC X(20)   VALUE SPACES.      00970001
009600     05  CC-EXT-LNAME              PIC X(20)   VALUE SPACES.      00980001
009900     05  CC-EXT-USERID             PIC X(07)   VALUE SPACES.      00990001
009900     05  CC-EXT-LOC                PIC X(04)   VALUE SPACES.      01000001
009900     05  FILLER                    PIC X(09)   VALUE SPACES.      01010001
010100                                                                  01020001
002200 01  CC-LOC-DEPLOY-FILE.                                          01030001
009600     05  CC-LOC-NBR                PIC X(04)   VALUE SPACES.      01040001
009900     05  FILLER                    PIC X(36)   VALUE SPACES.      01050001
010100                                                                  01060001
010200 01  PROGRAM-CONSTANTS.                                           01070001
010300     05  PC-PROGRAM-NAME           PIC X(08)   VALUE 'SEKUT021'.  01080001
010400                                                                  01090001
010900 01  PS-PROGRAM-SWITCHES.                                         01100001
011000     05  PS-INPUT-EOF-SWT          PIC X(01)   VALUE 'N'.         01110001
011100         88  PS-INPUT-EOF                      VALUE 'Y'.         01120001
011000     05  PS-SPEC-INP               PIC X(01)   VALUE 'N'.         01130001
011100         88  PS-SPEC-INP-EOF                   VALUE 'Y'.         01140001
011000     05  PS-EXT-INP                PIC X(01)   VALUE 'N'.         01150001
011100         88  PS-EXT-INP-EOF                    VALUE 'Y'.         01160001
011000     05  PS-LOC-INP                PIC X(01)   VALUE 'N'.         01170001
011100         88  PS-LOC-INP-EOF                    VALUE 'Y'.         01180001
011000     05  PS-VALID-AUTH             PIC X(01)   VALUE 'N'.         01190001
011100         88  PS-VALID-AUTHORITY                VALUE 'Y'.         01200001
011100         88  PS-NOT-VALID-AUTHORITY            VALUE 'N'.         01210001
011000     05  PS-SPECIAL-AUTHORITY      PIC X(01)   VALUE 'N'.         01220001
011100         88  PS-SPECIAL-AUTH                   VALUE 'Y'.         01230001
011100         88  PS-NO-SPECIAL-AUTH                VALUE 'N'.         01240001
010400     05  PS-USERID                 PIC X(01)   VALUE 'N'.         01250001
011100         88  PS-FOUND-USERID                   VALUE 'Y'.         01260001
011100         88  PS-NOT-FOUND-USERID               VALUE 'N'.         01270001
010400     05  PS-LOC-SW                 PIC X(01)   VALUE 'N'.         01280001
011100         88  PS-FOUND-LOC                      VALUE 'Y'.         01290001
011100         88  PS-NOT-FOUND-LOC                  VALUE 'N'.         01300001
021900 01  PROGRAM-VARIABLES.                                           01310001
023300     05  PV-WS-CTR                PIC  9(04)   VALUE ZEROS.       01320001
023300     05  PV-TOTAL-NO-FIELDS       PIC  9(04)   VALUE ZEROS.       01330001
063500     05  PV-WRT-COUNT             PIC  9(09)   VALUE ZEROES.      01340001
063500     05  PV-TOTAL-NO-FIELDS-1     PIC  9(05)   VALUE ZEROES.      01350001
010400     05  PV-HOLD-END-LOC          PIC  X(02)   VALUE SPACES.      01360001
010400     05  PV-HOLD-END-ACC          PIC  X(02)   VALUE SPACES.      01370001
010400                                                                  01380001
010400 01  WS-EXTRA-ACCESS.                                             01390001
010400     05  WS-EXT-ACC OCCURS 1000 TIMES INDEXED BY PV-EXT-IND.      01400001
010400         10  WS-EA-LNAME          PIC X(20)       VALUE SPACES.   01410001
010400         10  WS-EA-FNAME          PIC X(20)       VALUE SPACES.   01420001
010400         10  WS-EA-USERID         PIC X(07)       VALUE SPACES.   01430001
010400         10  WS-EA-LOC            PIC X(04)       VALUE SPACES.   01440001
010400                                                                  01450001
010400 01  WS-LOC-ACCESS.                                               01460001
010400     05  WS-LOC-ACC OCCURS 2000 TIMES INDEXED BY PV-LOC-IND.      01470001
010400         10  WS-LOC-NBR           PIC X(04)       VALUE SPACES.   01480001
010400                                                                  01490001
010400 01  WS-SPECIAL-ACCESS.                                           01500001
010400     05  WS-SPEC-ACC OCCURS 1000 TIMES INDEXED BY PV-SPEC-IND.    01510001
010400         10  WS-SP-FNAME          PIC X(20)       VALUE SPACES.   01520001
010400         10  WS-SP-LNAME          PIC X(20)       VALUE SPACES.   01530001
010400         10  WS-SP-USERID         PIC X(07)       VALUE SPACES.   01540001
010400         10  WS-SP-LOC            PIC X(04)       VALUE SPACES.   01550001
010400                                                                  01560001
039600*----------------------------------------------------------------*01570001
039700*    ABEND DATA AREAS                                             01580001
039800*----------------------------------------------------------------*01590001
039900 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      01600001
040000                                   COMP         SYNC.             01610001
040100                                                                  01620001
040200     88  AC-ANY-ERROR                           VALUE  +4001      01630001
040300                                                THRU   +4019.     01640001
040400     88  AC-BAD-WRITE                           VALUE  +4001.     01650001
040500     88  AC-BAD-READ                            VALUE  +4002.     01660001
040600     88  AC-CONTROL-CARD-ERROR                  VALUE  +4003.     01670001
040700     88  AC-OPEN-ERROR                          VALUE  +4005.     01680001
040800     88  AC-CLOSE-ERROR                         VALUE  +4006.     01690001
040900     88  AC-BAD-DATA                            VALUE  +4008.     01700001
041000     88  AC-DB2-ERROR                           VALUE  +4013.     01710001
041100     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     01720001
041200     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     01730001
041300     88  AC-DATE-ERROR                          VALUE  +4019.     01740001
041500                                                                  01750001
041600 01  ABEND-AREAS.                                                 01760001
041700     05  AA-ABEND-LIT              PIC  X(40)   VALUE             01770001
041800             '*****       ABEND'.                                 01780001
041900     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             01790001
042000             '*****   PROGRAM: SEKUT021'.                         01800001
042100     05  AA-PARAGRAPH-LIT.                                        01810001
042200         10  FILLER                PIC  X(17)   VALUE             01820001
042300             '***** PARAGRAPH: '.                                 01830001
042400         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     01840001
042500     05  AA-MESSAGE-LINE-1.                                       01850001
042600         10  FILLER                PIC  X(06)   VALUE '*****'.    01860001
042700         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     01870001
042800     05  AA-MESSAGE-LINE-2.                                       01880001
042900         10  FILLER                PIC  X(06)   VALUE '*****'.    01890001
043000         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     01900001
043100     05  AA-DB2-ERROR-LIT          PIC  X(40)   VALUE             01910001
043200             '*****    DB2 ERROR'.                                01920001
043300     05  AA-DB2-OPERATION-LIT.                                    01930001
043400         10  FILLER                PIC  X(17)   VALUE             01940001
043500             '***** OPERATION: '.                                 01950001
043600         10  AA-DB2-OPERATION.                                    01960001
043700             15  AA-DB2-OP-1       PIC  X(25)   VALUE SPACES.     01970001
043800             15  AA-DB2-OP-2       PIC  X(25)   VALUE SPACES.     01980001
043900     05  AA-DB2-TABLE-1            PIC  X(08)   VALUE SPACES.     01990001
044000     05  AA-DB2-TABLE-2            PIC  X(08)   VALUE SPACES.     02000001
044100     05  AA-DB2-TABLE-3            PIC  X(08)   VALUE SPACES.     02010001
010800                                                                  02020001
010800******************************************************************02030001
010800* ITIM OUTPUT FILE                                               *02040001
010800******************************************************************02050001
010800     COPY SERD009.                                                02060001
026100                                                                  02070001
010800******************************************************************02080001
010800*  UPS OUTPUT FILE                                               *02090001
010800******************************************************************02100001
010800     COPY SERD010.                                                02110001
026100                                                                  02120001
045100***************************************************************** 02130001
045200 PROCEDURE DIVISION.                                              02140001
045300***************************************************************** 02150001
045400 0000-PROGRAM-MAINLINE.                                           02160001
045500                                                                  02170001
045600     PERFORM 1000-INITIALIZE.                                     02180001
045700                                                                  02190001
045800     PERFORM 2000-PROCESS-INPUT                                   02200001
045900         UNTIL PS-INPUT-EOF.                                      02210001
046100                                                                  02220001
046000     PERFORM 4000-END-OF-PROGRAM.                                 02230001
046100                                                                  02240001
046200     GOBACK.                                                      02250001
046400                                                                  02260001
046500*----------------------------------------------------------------*02270001
046600*    INITIALIZATION PROCESSING                                   *02280001
046700*    - OPEN FILE.                                                *02290001
046900*----------------------------------------------------------------*02300001
047000 1000-INITIALIZE.                                                 02310001
047100                                                                  02320001
047200     DISPLAY '***-----  SEKUT021  (PROCESSING MSGS)  -----***'.   02330001
047300     DISPLAY ' '.                                                 02340001
047400                                                                  02350001
047500     OPEN INPUT ITIM-INPUT-FILE                                   02360001
047500                SPECIAL-ACCESS-FILE                               02370001
047500                EXTRA-EMPLOY-ACCESS-FILE                          02380001
006700                LOCATION-DEPLOY-FILE                              02390001
047600          OUTPUT UPS-OUTPUT-FILE.                                 02400001
047900                                                                  02410001
050300     PERFORM 2500-READ-INPUT.                                     02420001
047900                                                                  02430001
050300     PERFORM 2600-READ-SPEC-INPUT                                 02440001
050300         VARYING PV-SPEC-IND FROM 1 BY 1                          02450001
050300         UNTIL PV-SPEC-IND > 1000 OR                              02460001
050300               PS-SPEC-INP-EOF.                                   02470001
047900                                                                  02480001
050300     PERFORM 2700-READ-EXT-INPUT                                  02490001
050300         VARYING PV-EXT-IND FROM 1 BY 1                           02500001
050300         UNTIL PV-EXT-IND > 1000 OR                               02510001
050300               PS-EXT-INP-EOF.                                    02520001
050400                                                                  02530001
050300     PERFORM 2800-READ-LOC-INPUT                                  02540001
050300         VARYING PV-LOC-IND FROM 1 BY 1                           02550001
050300         UNTIL PV-LOC-IND > 2000 OR                               02560001
050300               PS-LOC-INP-EOF.                                    02570001
050400                                                                  02580001
053600*----------------------------------------------------------------*02590001
053700*    PROCESS INPUT                                               *02600001
053700*    CHECK IF PERSON ON THE ITIM FILE IS IN THE TABLE OF         '02610001
053700*       LOCATIONS OR SPECIAL LOCATIONS                           *02620001
053800*----------------------------------------------------------------*02630001
045800 2000-PROCESS-INPUT.                                              02640001
010400     MOVE 'N' TO PS-VALID-AUTH.                                   02650001
010400     MOVE 'N' TO PS-LOC-SW.                                       02660001
010400     SET PV-LOC-IND TO +1.                                        02670001
010400     SEARCH WS-LOC-ACC                                            02680001
010400       AT END                                                     02690001
010400         MOVE '99' TO PV-HOLD-END-LOC                             02700001
010400       WHEN WS-LOC-NBR (PV-LOC-IND) = SE009-KH-LOC-NUM            02710001
010400           SET PS-VALID-AUTHORITY TO TRUE                         02720001
010400           SET PS-FOUND-LOC TO TRUE                               02730001
010400     END-SEARCH.                                                  02740001
010400     SET PS-NOT-FOUND-LOC TO TRUE.                                02750001
010400                                                                  02760001
010400     SET PS-NOT-FOUND-USERID TO TRUE.                             02770001
010400     SET PV-EXT-IND TO +1.                                        02780001
010400     IF SE009-TK-NUMBER NOT EQUAL SPACES                          02790001
010400       IF PS-NOT-VALID-AUTHORITY                                  02800001
010400         SEARCH WS-EXT-ACC                                        02810001
010400         AT END                                                   02820001
010400           MOVE '99' TO PV-HOLD-END-ACC                           02830001
010400         WHEN WS-EA-USERID (PV-EXT-IND) = SE009-TK-NUMBER         02840001
010400           SET PS-VALID-AUTHORITY TO TRUE                         02850001
010400           SET PS-FOUND-USERID TO TRUE                            02860001
010400         END-SEARCH                                               02870001
010400       END-IF                                                     02880001
010400     END-IF.                                                      02890001
010400     SET PS-NOT-FOUND-USERID TO TRUE.                             02900001
010400                                                                  02910001
054000     IF PS-VALID-AUTHORITY                                        02920001
050400        IF SE009-TK-NUMBER = SPACES                               02930001
050400           MOVE SE009-KHEMPL-ID   TO SE010-USERID                 02940001
001600                                     SE010-PASSWORD               02950001
054000           PERFORM 2100-MOVE-FIELDS                               02960001
054000           PERFORM 2900-WRITE-OUTPUT-RECORD                       02970001
050400        ELSE                                                      02980001
050400           IF SE009-TK-NUMBER(1:2) = 'TK' OR                      02990001
050400              SE009-TK-NUMBER(1:2) = 'tk'                         03000001
050400              MOVE SE009-TK-NUMBER   TO SE010-USERID              03010001
001600                                        SE010-PASSWORD            03020001
054000              PERFORM 2100-MOVE-FIELDS                            03030001
054000              PERFORM 2900-WRITE-OUTPUT-RECORD                    03040001
050400           END-IF                                                 03050001
050400        END-IF                                                    03060001
054000     END-IF.                                                      03070001
054000                                                                  03080001
054000     INITIALIZE SE010-UPS-DETAIL.                                 03090001
054000     INITIALIZE SE009-ITIM-DETAIL.                                03100001
054000     MOVE 'N' TO PS-VALID-AUTH.                                   03110001
010400     MOVE 'N' TO PS-SPECIAL-AUTHORITY.                            03120001
010400     SET PS-NOT-FOUND-LOC TO TRUE.                                03130001
010400     SET PV-LOC-IND TO +1.                                        03140001
054000                                                                  03150001
050300     PERFORM 2500-READ-INPUT.                                     03160001
054000                                                                  03170001
054000****************************************************************  03180001
045800*  MOVE THE FIELDS FROM THE ITIM FILE TO THE UPS FILE             03190001
054000****************************************************************  03200001
054000 2100-MOVE-FIELDS.                                                03210001
001600     MOVE SE009-FIRST-NAME     TO SE010-FNAME.                    03220001
001600     MOVE SE009-GADS-LAST-NAME TO SE010-LNAME.                    03230001
001600     MOVE SE009-LOC-ADDR       TO SE010-ADDR1.                    03240001
001600     MOVE SPACES               TO SE010-ADDR2                     03250001
001600                                  SE010-ADDR3.                    03260001
001600     MOVE SE009-LOC-CITY       TO SE010-CITY.                     03270001
001600     MOVE SE009-LOC-STATE      TO SE010-STATE.                    03280001
001600     MOVE SE009-LOC-ZIP        TO SE010-POSTAL-CODE.              03290001
001600     MOVE 'US'                 TO SE010-COUNTRY-CODE.             03300001
054000     MOVE SE009-EMAIL          TO SE010-EMAIL.                    03310001
001600     MOVE SE009-WORK-PHONE     TO SE010-PHONE.                    03320001
001600                                                                  03330001
001600     MOVE '1'                  TO SE010-IDLEVEL.                  03340001
001600     MOVE 'N' TO PS-SPECIAL-AUTHORITY.                            03350001
060000     PERFORM 2400-SEARCH-SPEC-ACCESS.                             03360001
001600     IF PS-SPECIAL-AUTH                                           03370001
001600         MOVE '50'             TO SE010-IDLEVEL                   03380001
001500         MOVE 'all'            TO SE010-CAMPUS                    03390001
001600         MOVE 'all'            TO SE010-DEFAULT-CAMPUS            03400001
001600     ELSE                                                         03410001
001600         MOVE '1'              TO SE010-IDLEVEL                   03420001
001500         MOVE 'Mailroom'       TO SE010-CAMPUS                    03430001
001600         MOVE 'Mailroom'       TO SE010-DEFAULT-CAMPUS            03440001
001600     END-IF.                                                      03450001
001600                                                                  03460001
001600     MOVE SPACES               TO SE010-GL-ACCOUNT                03470001
001600                                  SE010-DEPARTMENT                03480001
001600                                  SE010-CUSTOM-3                  03490001
001600                                  SE010-CUSTOM-4                  03500001
001600                                  SE010-CUSTOM-5                  03510001
001600                                  SE010-CUSTOM-6                  03520001
001600                                  SE010-CUSTOM-7                  03530001
001600                                  SE010-CUSTOM-8                  03540001
001600                                  SE010-CUSTOM-9                  03550001
001600                                  SE010-CUSTOM-10.                03560001
060000                                                                  03570001
060000****************************************************************  03580001
060000*     READ THE INPUT FILE                                         03590001
060000****************************************************************  03600001
060000 2400-SEARCH-SPEC-ACCESS.                                         03610001
060000                                                                  03620001
001600     MOVE 'N' TO PS-SPECIAL-AUTHORITY.                            03630001
010400     SET PV-SPEC-IND TO +1.                                       03640001
010400     IF SE009-TK-NUMBER NOT EQUAL SPACES                          03650001
010400       SEARCH WS-SPEC-ACC VARYING PV-SPEC-IND                     03660001
010400         AT END                                                   03670001
010400            MOVE '99' TO PV-HOLD-END-LOC                          03680001
010400       WHEN SE009-TK-NUMBER = WS-SP-USERID (PV-SPEC-IND)          03690001
010400         SET PS-SPECIAL-AUTH TO TRUE                              03700001
010400       END-SEARCH                                                 03710001
010400     END-IF.                                                      03720001
010400     SET PS-NOT-VALID-AUTHORITY TO TRUE.                          03730001
010400                                                                  03740001
060000****************************************************************  03750001
060000*     READ THE INPUT FILE                                         03760001
060000****************************************************************  03770001
060000 2500-READ-INPUT.                                                 03780001
060000     READ ITIM-INPUT-FILE INTO SE009-ITIM-DETAIL                  03790001
060000         AT END                                                   03800001
060000             SET PS-INPUT-EOF TO TRUE.                            03810001
060000                                                                  03820001
060000****************************************************************  03830001
060000*     READ THE INPUT FILE                                         03840001
060000****************************************************************  03850001
060000 2600-READ-SPEC-INPUT.                                            03860001
060000     READ SPECIAL-ACCESS-FILE INTO CC-SPEC-ACC-FILE               03870001
060000         AT END                                                   03880001
060000             SET PS-SPEC-INP-EOF TO TRUE.                         03890001
060000                                                                  03900001
060000     IF PS-SPEC-INP-EOF                                           03910001
060000        NEXT SENTENCE                                             03920001
060000     ELSE                                                         03930001
009600        MOVE CC-SPEC-FNAME    TO WS-SP-FNAME(PV-SPEC-IND)         03940001
009600        MOVE CC-SPEC-LNAME    TO WS-SP-LNAME(PV-SPEC-IND)         03950001
009900        MOVE CC-SPEC-USERID   TO WS-SP-USERID(PV-SPEC-IND)        03960001
009900        MOVE CC-SPEC-LOC      TO WS-SP-LOC(PV-SPEC-IND)           03970001
060000     END-IF.                                                      03980001
060000                                                                  03990001
060000****************************************************************  04000001
060000*     READ THE INPUT FILE                                         04010001
060000****************************************************************  04020001
060000 2700-READ-EXT-INPUT.                                             04030001
060000     READ EXTRA-EMPLOY-ACCESS-FILE INTO CC-EXT-EMP-ACC-FILE       04040001
060000         AT END                                                   04050001
060000             SET PS-EXT-INP-EOF TO TRUE.                          04060001
010400                                                                  04070001
010400     IF PS-EXT-INP-EOF                                            04080001
010400        NEXT SENTENCE                                             04090001
010400     ELSE                                                         04100001
009600        MOVE CC-EXT-FNAME    TO WS-EA-FNAME(PV-EXT-IND)           04110001
009600        MOVE CC-EXT-LNAME    TO WS-EA-LNAME(PV-EXT-IND)           04120001
009900        MOVE CC-EXT-USERID   TO WS-EA-USERID(PV-EXT-IND)          04130001
009900        MOVE CC-EXT-LOC      TO WS-EA-LOC(PV-EXT-IND)             04140001
010400     END-IF.                                                      04150001
010400                                                                  04160001
060000****************************************************************  04170001
060000*     READ THE INPUT FILE                                         04180001
060000****************************************************************  04190001
060000 2800-READ-LOC-INPUT.                                             04200001
060000     READ LOCATION-DEPLOY-FILE INTO CC-LOC-DEPLOY-FILE            04210001
060000         AT END                                                   04220001
060000             SET PS-LOC-INP-EOF TO TRUE.                          04230001
060000                                                                  04240001
060000     IF PS-LOC-INP-EOF                                            04250001
060000        NEXT SENTENCE                                             04260001
060000     ELSE                                                         04270001
009900        MOVE CC-LOC-NBR      TO WS-LOC-NBR(PV-LOC-IND)            04280001
060000     END-IF.                                                      04290001
060000                                                                  04300001
062000******************************************************************04310001
062100*    WRITE DETAIL OUTPUT RECORD                                  *04320001
062200******************************************************************04330001
062300 2900-WRITE-OUTPUT-RECORD.                                        04340001
062400                                                                  04350001
062500     WRITE UPS-OUTPUT-REC FROM SE010-UPS-DETAIL.                  04360001
063200                                                                  04370001
063500     ADD 1 TO PV-WRT-COUNT.                                       04380001
063200                                                                  04390001
063200****************************************************************  04400001
052000*    END OF PROGRAM                                              *04410001
052100*    - CLOSE THE FILES                                           *04420001
063200****************************************************************  04430001
052300 4000-END-OF-PROGRAM.                                             04440001
052400                                                                  04450001
052500     DISPLAY '****-----------------------------------------****'. 04460001
052600     DISPLAY '**----     END OF SEKUT021 PROCESSING!     ----**'. 04470001
052700     DISPLAY '****-----------------------------------------****'. 04480001
052800     DISPLAY ' '.                                                 04490001
052900                                                                  04500001
047500     CLOSE ITIM-INPUT-FILE                                        04510001
047500           SPECIAL-ACCESS-FILE                                    04520001
047500           EXTRA-EMPLOY-ACCESS-FILE                               04530001
006700           LOCATION-DEPLOY-FILE                                   04540001
047600           UPS-OUTPUT-FILE.                                       04550001
