000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             XMKUP001.                                00050000
000600 AUTHOR.                 T BAGWELL.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            08-07-02.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*                 VENDOR TABLE MAINTENANCE                      * 00120000
001300*                                                               * 00130000
001400*  THIS PROGRAM WILL MAINTAIN THE MERCHANDISING DOMAIN VENDOR   * 00140000
001500*  DB2 TABLE . THIS TABLE WILL CONTAIN ALL OF THE EXTRACT FILE  * 00150000
001600*  FIELDS EXCEPT PRIMARY TYPE CODE.                             * 00160000
001700*                                                               * 00170000
001800***************************************************************** 00180000
001900*  CHANGE MADE:                                                 * 00190000
      * 08/02/2005 - P. KEBER         -  WR NO. 28563                 * 00191010
      *    - ADDED LOGIC TO MAINTAIN NEW PRTNR_TYP_CDE COLUMN AND     * 00192010
002000*      ALSO ADDED A NEW PROCESS DATE CONTROL CARD TO DETERMINE  * 00200010
002000*      WHICH UPDATES TO PROCESS.                                * 00210010
001800***************************************************************** 00220013
C71170*  CHANGE MADE:                                                 * 00230013
C71170* 06/22/2017 - COGNIZANT        -  CHG0171170                   * 00240013
C71170*    - MODIFIED THE USE OF THE DATE CONTROL CARD SO THAT        * 00247014
C71170*      THIS PROGRAM PROCESSES ALL INSERTS AND UPDATES           * 00248014
C71170*      OF VENDOR DATA ON AND AFTER THE CONTROL CARD DATE.       * 00249014
C71170*      THIS WAS DONE TO FIX AN ISSUE WHERE ALL ADDS AND         * 00249114
C71170*      CHANGES AFTER 6 PM WERE GETTING MISSED.                  * 00249214
C71170*      IN ADDITION TO CHANGING THE CODE, THE JOB WILL NEED TO   * 00249314
C71170*      HAVE THE CONTROL CARD DATE SET TO THE PREVIOUS DAY AS    * 00249414
C71170*      OPPOSED TO THE CURRENT DAY.                              * 00249514
C71170*      CHANGES ARE IDENTIFIED USING -------    C71170           * 00249614
C71170*                                                               * 00249714
C71170***************************************************************** 00250013
002600 ENVIRONMENT DIVISION.                                            00260000
002700***************************************************************** 00270000
002800                                                                  00280000
002900 CONFIGURATION SECTION.                                           00290000
003000                                                                  00300000
003100 SOURCE-COMPUTER.        IBM-3090.                                00310000
003200 OBJECT-COMPUTER.        IBM-3090.                                00320000
003300                                                                  00330000
003400 INPUT-OUTPUT SECTION.                                            00340000
003500                                                                  00350000
003600 FILE-CONTROL.                                                    00360000
003700*                                                                 00370000
003800     SELECT VENDOR-FILE           ASSIGN   TO  INP01.             00380000
003800     SELECT CONTROL-CARD-FILE     ASSIGN   TO  INP02.             00391010
003900*                                                                 00392010
004000***************************************************************** 00400000
004100 DATA DIVISION.                                                   00410000
004200***************************************************************** 00420000
004300*                                                                 00430000
004400 FILE SECTION.                                                    00440000
004500*                                                                 00450000
004600 FD  VENDOR-FILE                                                  00460000
004700     LABEL RECORDS ARE STANDARD                                   00470000
004800     BLOCK CONTAINS 0 RECORDS                                     00480000
004900     RECORDING MODE IS F                                          00490000
005000     RECORD CONTAINS 150 CHARACTERS                               00500000
005100     DATA RECORD IS VENDOR-REC.                                   00510000
005200 01  VENDOR-REC                      PIC  X(150).                 00520000
005300*                                                                 00530000
004600 FD  CONTROL-CARD-FILE                                            00531010
004700     LABEL RECORDS ARE STANDARD                                   00532010
004800     BLOCK CONTAINS 0 RECORDS                                     00533010
004900     RECORDING MODE IS F.                                         00534010
005200 01  CONTROL-CARD-REC                PIC  X(80).                  00537010
005300*                                                                 00538010
005400 WORKING-STORAGE SECTION.                                         00540000
005500*                                                                 00550000
005600 01  FILLER.                                                      00560000
005700     05  FILLER                      PIC  X(36)    VALUE          00570000
005800         ' ***** WORKING STORAGE PGM=XMKUP001 '.                  00580000
005900     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00590000
006000     05  FILLER                      PIC  X(10)    VALUE          00600000
006100         ' LOCATION='.                                            00610000
006200     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00620000
006300     05  FILLER                      PIC  X(06)    VALUE          00630000
006400         ' *****'.                                                00640000
006500 EJECT                                                            00650000
006600 01  PROGRAM-SWITCHES.                                            00660000
006700     05  PS-EOF-VEND-FILE            PIC  X(01)    VALUE 'N'.     00670000
006800         88  EOF-VEND-FILE                         VALUE 'Y'.     00680000
007100*                                                                 00690000
007300 01  PC-CONSTANTS.                                                00700000
007400     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00710000
007500                                                   COMP SYNC.     00720000
007600     05  PC-NOT-REF-INTEGRAL         PIC S9(04)    VALUE -530     00730000
007700                                                   COMP SYNC.     00740000
007800     05  PC-N                        PIC  X(01)    VALUE 'N'.     00750000
007900     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00760000
008000     05  PC-XMKUP001                 PIC  X(08)    VALUE          00770000
008100                                                   'XMKUP001'.    00780000
008600 EJECT                                                            00790000
008700*                                                                 00800000
008800 01  PV-ACCUMULATOR-FIELDS.                                       00810000
008810                                                                  00820000
008900     05  PV-SYSTEM-INPUT-CNT         PIC S9(03)    VALUE ZERO     00830000
009000                                                   COMP-3.        00840000
009100     05  PV-PARM-INPUT-CNT           PIC S9(03)    VALUE ZERO     00850000
009200                                                   COMP-3.        00860000
009300     05  PV-INSERT-CNT               PIC S9(05)    VALUE ZERO     00870000
009400                                                   COMP-3.        00880000
009500     05  PV-UPDATE-CNT               PIC S9(05)    VALUE ZERO     00890000
009600                                                   COMP-3.        00900000
009700     05  PV-COMMIT-CNT               PIC S9(05)    VALUE ZERO     00910000
009800                                                   COMP-3.        00920000
009900     05  PV-COMMIT-CHECK-CNT         PIC S9(05)    VALUE ZERO     00930000
010000                                                   COMP-3.        00940000
010100 EJECT                                                            00950000
010200*                                                                 00960000
010300 01  PV-MISC-FIELDS.                                              00970000
010400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00980000
010500                                                   COMP SYNC.     00990000
010600     05  PV-RBA                      PIC S9(09)    VALUE ZERO     01000000
010700                                                   COMP SYNC.     01010000
010800     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01020000
011300     05  PV-HOLD-UPD-TMST.                                        01070000
011400         10 PV-HOLD-UPD-TMST-DATE    PIC  X(10)    VALUE SPACES.  01080000
011500         10 PV-HOLD-UPD-TMST-TIME    PIC  X(16)    VALUE SPACES.  01090000
011300     05  PV-HOLD-CRE-TMST.                                        01091000
011400         10 PV-HOLD-CRE-TMST-DATE    PIC  X(10)    VALUE SPACES.  01092000
011500         10 PV-HOLD-CRE-TMST-TIME    PIC  X(16)    VALUE SPACES.  01093000
011700 EJECT                                                            01100000
011800                                                                  01110000
011900     COPY VNRD100.                                                01120000
012000                                                                  01130000
      ****************************************************************  01131010
      * RECORD LAYOUT FOR CONTROL CARD FILE.                            01132010
      * DATE WILL BE ESP CONTROLLED - JOB RUN DATE                      01133010
      ****************************************************************  01134010
       01  CC-CONTROL-CARD.                                             01135010
           05  CC-CONTROL-DATE              PIC X(10)    VALUE SPACES.  01136010
           05  FILLER                       PIC X(12)    VALUE          01137010
                 ' UPDATE ALL:'.                                        01137111
           05  CC-UPDATE-ALL-IND            PIC X(01)    VALUE SPACE.   01137210
      *          Y = UPDATE ALL RECORDS                                 01137310
      *          N = DON'T UPDATE ALL RECORDS                           01137410
           05  FILLER                       PIC X(57)    VALUE SPACES.  01137510
012000                                                                  01138010
012100 EJECT                                                            01140000
012200                                                                  01150000
012300* DB2 TABLE LAYOUTS                                               01160000
012400     EXEC SQL                                                     01170000
012500         INCLUDE XMT00000                                         01180000
012600     END-EXEC.                                                    01190000
012700 EJECT                                                            01200000
012800                                                                  01210000
012900* DB2 COMMUNICATION AREA                                          01220000
013000*                                                                 01230000
013100     EXEC SQL                                                     01240000
013200         INCLUDE SQLCA                                            01250000
013300     END-EXEC.                                                    01260000
013400 EJECT                                                            01270000
013500* DB2 COMMUNICATION AREA2                                         01280000
013600*                                                                 01290000
013700     COPY SQLCA2.                                                 01300000
013800 EJECT                                                            01310000
013900*                                                                 01320000
014000 LINKAGE SECTION.                                                 01330000
014100***************************************************************** 01340000
014200*PROCEDURE DIVISION.                                              01350000
014300***************************************************************** 01360000
014400 PROCEDURE DIVISION.                                              01370000
014500*                                                                 01380000
014600 A000-MAINLINE-PROCESSING.                                        01390000
014700*                                                                 01400000
014800     PERFORM A100-INITIALIZATION.                                 01410000
014900*                                                                 01420000
015000     PERFORM B000-PROCESS-VEND-REC                                01430000
015100             UNTIL EOF-VEND-FILE.                                 01440000
015200                                                                  01450000
015300     IF PV-COMMIT-CHECK-CNT > 0                                   01460000
015400         PERFORM Z910-COMMIT                                      01470000
015500     END-IF.                                                      01480000
015600                                                                  01490000
015700     DISPLAY '*******************************************'.       01500000
015700     DISPLAY '            '.                                      01500100
015700     DISPLAY 'UPDATE CNT: ' PV-UPDATE-CNT.                        01501000
015800     DISPLAY 'INSERT CNT: ' PV-INSERT-CNT.                        01510000
015900     DISPLAY 'COMMIT CNT: ' PV-COMMIT-CNT.                        01520000
015700     DISPLAY '            '.                                      01520100
015700     DISPLAY '*******************************************'.       01521000
016000*                                                                 01530000
016100     PERFORM Y100-END-ROUTINE.                                    01540000
016200*                                                                 01550000
016300     GOBACK.                                                      01560000
016400*                                                                 01570000
016500 EJECT                                                            01580000
016600******************************************************************01590000
016700** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 01600000
016800** READ THE FIRST RECORD.                                         01610000
016900******************************************************************01620000
017000 A100-INITIALIZATION.                                             01630000
017100*                                                                 01640000
017200     OPEN  INPUT VENDOR-FILE                                      01650010
                       CONTROL-CARD-FILE.                               01651010
017300*                                                                 01660000
018500     PERFORM R100-READ-CONTROL-CARD.                              01780010
017300*                                                                 01781010
018500     PERFORM R000-READ-VEND-FILE.                                 01782010
018600*                                                                 01790000
018700     IF EOF-VEND-FILE                                             01800000
018800        CLOSE  VENDOR-FILE                                        01810000
018900        GOBACK.                                                   01820000
019000*                                                                 01830000
020700 EJECT                                                            01840000
020800******************************************************************01850000
020900*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *01860000
021000*  VEND RECORD.                                                  *01870000
021100******************************************************************01880000
021200 B000-PROCESS-VEND-REC.                                           01890000
021300*                                                                 01900000
021400     MOVE VN100-LAST-UPD-TMST TO PV-HOLD-UPD-TMST.                01910000
021400     MOVE VN100-CRE-TMST      TO PV-HOLD-CRE-TMST.                01911000
                                                                        01921000
C71170     IF PV-HOLD-UPD-TMST-DATE >= CC-CONTROL-DATE                  01930013
C71170       OR PV-HOLD-CRE-TMST-DATE >= CC-CONTROL-DATE                01931013
             OR CC-UPDATE-ALL-IND = 'Y'                                 01932010
021700        PERFORM F000-FORMAT-UPDATE-XMT-VND.                       01940000
                                                                        01941000
021800     PERFORM Z900-COMMIT-TEST.                                    01950000
021900     PERFORM R000-READ-VEND-FILE.                                 01960000
022000*                                                                 01970000
022100 EJECT                                                            01980000
022200*                                                                *01990000
022300******************************************************************02000000
022400*   FORMAT FIELDS AND UPDATE INFO ON THE MERCHANDISE VENDOR      *02010000
022500*   DOMAIN TABLE WITH DATA FROM THE VEND RECORD.                 *02020000
022600******************************************************************02030000
022700 F000-FORMAT-UPDATE-XMT-VND.                                      02040000
022800*                                                                 02050000
022900*    DISPLAY 'F000-FORMAT-UPDATE-XMT-VND'.                        02060000
023000*                                                                 02070000
023100* @@@                                                             02080000
023200     MOVE VN100-VND-NBR        TO  XMT00000-VND-NBR.              02090000
023300     MOVE VN100-PRIMARY-NAME   TO  XMT00000-PRIM-VND-NM.          02100000
023400     MOVE VN100-STATUS-CDE     TO  XMT00000-STAT-CDE.             02110000
023500     MOVE VN100-CRE-TMST       TO  XMT00000-VND-CRE-TMST.         02120000
023600     MOVE VN100-LAST-UPD-TMST  TO  XMT00000-VND-LAST-UPD-TMST.    02130000
023500     MOVE VN100-PRTNR-TYP-CDE  TO  XMT00000-PRTNR-TYP-CDE.        02131010
023700*                                                                *02140000
023800     PERFORM S100-UPDATE-XMT00000.                                02150000
023900*                                                                *02160000
024000*                                                                 02170000
024100******************************************************************02180000
024200*  THIS PARAGRAPH READS THE VEND FILE FOR PROCESSING             *02190000
024300******************************************************************02200000
024400 R000-READ-VEND-FILE.                                             02210000
024500*                                                                 02220000
024600     READ VENDOR-FILE   INTO  VN100-VENDOR-EXTRACT-RECD           02230000
024700         AT END                                                   02240000
024800            MOVE PC-Y TO PS-EOF-VEND-FILE.                        02250000
024900*                                                                 02260000
      ******************************************************************02261010
      *  READ DATE CONTROL FILE.                                       *02262010
      ******************************************************************02263010
       R100-READ-CONTROL-CARD.                                          02264010
                                                                        02266010
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  02267010
               AT END                                                   02268010
                   DISPLAY '*** NO DATE CONTROL CARD ***'               02269210
                   MOVE +4001 TO PV-ABEND-CODE                          02269310
                   PERFORM Z998-ABEND                                   02269410
               NOT AT END                                               02269510
                   DISPLAY ' CONTROL CARD: ' CC-CONTROL-CARD            02269610
                   IF CC-CONTROL-DATE = SPACES                          02269710
                       DISPLAY '*** INVALID CONTROL CARD DATE ***'      02269810
                       MOVE +4002 TO PV-ABEND-CODE                      02269910
                       PERFORM Z998-ABEND                               02270010
                   END-IF                                               02270110
                   IF NOT (CC-UPDATE-ALL-IND = 'Y' OR 'N')              02270210
                       DISPLAY '*** INVALID UPDATE ALL INDICATOR ***'   02270410
                       MOVE +4003 TO PV-ABEND-CODE                      02270510
                       PERFORM Z998-ABEND                               02270610
                   END-IF                                               02270710
           END-READ.                                                    02270811
                                                                        02270910
025000*                                                                 02271000
025100******************************************************************02280000
025200* THIS PARAGRAPH PERFORMS THE UPDATE OF THE ITEM/STORE TABLE     *02290000
025300******************************************************************02300000
025400 S100-UPDATE-XMT00000.                                            02310000
025500*                                                                 02320000
025600*    DISPLAY 'S100-UPDATE-XMT00000'.                              02330000
025700*                                                                 02340000
025800     MOVE 'S100'                   TO PGM-LOCATION.               02350000
025900     MOVE 'S100-UPDATE-XMT00000'   TO PV-ABEND-PARAGRAPH.         02360000
026000*                                                                 02370000
026100     EXEC SQL                                                     02380000
026200         UPDATE XMT_VND                                           02390000
026300            SET  PRIM_VND_NM      = :XMT00000-PRIM-VND-NM         02400000
026400                ,VND_NBR          = :XMT00000-VND-NBR             02410000
026500                ,STAT_CDE         = :XMT00000-STAT-CDE            02420000
026600                ,VND_CRE_TMST     = :XMT00000-VND-CRE-TMST        02430000
026700                ,VND_LAST_UPD_TMST = :XMT00000-VND-LAST-UPD-TMST  02440000
026600                ,PRTNR_TYP_CDE    = :XMT00000-PRTNR-TYP-CDE       02441010
026800          WHERE   ENT_ID       =  :VN100-ENT-ID                   02450000
026900     END-EXEC.                                                    02460000
027000*                                                                 02470000
027100     EVALUATE TRUE                                                02480000
027200       WHEN SQLCODE         = ZERO                                02490000
027300         ADD 1 TO PV-UPDATE-CNT                                   02500000
027400         ADD 1 TO PV-COMMIT-CHECK-CNT                             02510000
027500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    02520000
027600         MOVE VN100-ENT-ID TO XMT00000-ENT-ID                     02530000
027700         PERFORM S1000-INSERT-XMT                                 02540000
027800       WHEN OTHER                                                 02550000
027900         DISPLAY PV-ABEND-PARAGRAPH                               02560000
028000         PERFORM Z999-SQL-ERROR                                   02570000
028100     END-EVALUATE.                                                02580000
028200*                                                                 02590000
028300 EJECT                                                            02600000
028400*                                                                 02610000
028500*                                                                 02620000
028600******************************************************************02630000
028700* THIS PARAGRAPH INSERTS TO THE XMT VND TABLE AFTER A NOT        *02640000
028800* FOUND CONDITION WAS OBTAINED ON THE UPDATE.                    *02650000
028900******************************************************************02660000
029000 S1000-INSERT-XMT.                                                02670000
029100*                                                                 02680000
029200     MOVE 'S1000'                  TO PGM-LOCATION.               02690000
029300     MOVE 'S1000-INSERT-XMT '                                     02700000
029400                                   TO PV-ABEND-PARAGRAPH.         02710000
029500     EXEC SQL                                                     02720000
029600         INSERT INTO XMT_VND                                      02730000
029700                ( ENT_ID,                                         02740000
029800                  PRIM_VND_NM,                                    02750000
029900                  VND_NBR,                                        02760000
030000                  STAT_CDE,                                       02770000
030100                  VND_CRE_TMST,                                   02780000
030200                  VND_LAST_UPD_TMST,                              02790010
                        PRTNR_TYP_CDE                                   02791010
030300                )                                                 02800000
030400         VALUES (:XMT00000-ENT-ID,                                02810000
030500                 :XMT00000-PRIM-VND-NM,                           02820000
030600                 :XMT00000-VND-NBR,                               02830000
030700                 :XMT00000-STAT-CDE,                              02840000
030800                 :XMT00000-VND-CRE-TMST,                          02850000
030900                 :XMT00000-VND-LAST-UPD-TMST,                     02860010
030700                 :XMT00000-PRTNR-TYP-CDE                          02861010
031000                )                                                 02870000
031100     END-EXEC.                                                    02880000
031200*                                                                 02890000
031300     EVALUATE TRUE                                                02900000
031400       WHEN SQLCODE         = ZERO                                02910000
031500         ADD 1 TO PV-INSERT-CNT                                   02920000
031600         ADD 1 TO PV-COMMIT-CHECK-CNT                             02930000
031700       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    02940000
031800         CONTINUE                                                 02950000
031900       WHEN SQLCODE         = PC-NOT-REF-INTEGRAL                 02960000
032000         CONTINUE                                                 02970000
032100       WHEN OTHER                                                 02980000
032200         DISPLAY 'ENT ID:    ' VN100-ENT-ID                       02990000
032300         DISPLAY PV-ABEND-PARAGRAPH                               03000000
032400         PERFORM Z999-SQL-ERROR                                   03010000
032500     END-EVALUATE.                                                03020000
032600 EJECT                                                            03030000
032700******************************************************************03040000
032800*   CLOSES FILES AND DISPLAYS MESSAGES.                          *03050000
032900******************************************************************03060000
033000 Y100-END-ROUTINE.                                                03070000
033100*                                                                 03080000
033200     CLOSE  VENDOR-FILE                                           03090010
                  CONTROL-CARD-FILE.                                    03091010
033300*                                                                 03100000
033400 EJECT                                                            03110000
033500******************************************************************03120000
033600*     DB2 COMMIT TEST                                            *03130000
033700*                                                                *03140000
033800******************************************************************03150000
033900                                                                  03160000
034000 Z900-COMMIT-TEST.                                                03170000
034100*-----------------                                                03180000
034200                                                                  03190000
034300     IF PV-COMMIT-CHECK-CNT > 500                                 03200000
034400         PERFORM Z910-COMMIT                                      03210000
034500         ADD 1 TO PV-COMMIT-CNT                                   03220000
034600         MOVE ZEROS TO PV-COMMIT-CHECK-CNT                        03230000
034700     END-IF.                                                      03240000
034800                                                                  03250000
034900 EJECT                                                            03260000
035000******************************************************************03270000
035100*     DB2 COMMIT PROCESSING                                      *03280000
035200*                                                                *03290000
035300******************************************************************03300000
035400                                                                  03310000
035500 Z910-COMMIT.                                                     03320000
035600*------------                                                     03330000
035700                                                                  03340000
035800*  TAKE COMMIT                                                    03350000
035900                                                                  03360000
036000     EXEC SQL                                                     03370000
036100         COMMIT                                                   03380000
036200     END-EXEC.                                                    03390000
036300                                                                  03400000
036400     IF SQLCODE = +0                                              03410000
036500         CONTINUE                                                 03420000
036600     ELSE                                                         03430000
036700         DISPLAY 'PARAGRAPH Z910, BAD COMMIT'                     03440000
036800         DISPLAY ' '                                              03450000
036900         PERFORM Z999-SQL-ERROR.                                  03460000
038700*                                                                 03470000
038900*---------------                                                  03471010
038800 Z998-ABEND.                                                      03480010
038900*---------------                                                  03480110
038700*                                                                 03481010
039400     DISPLAY '** PROGRAM ABEND  ** = XMKUP001'.                   03481110
040000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03483010
038700*                                                                 03484010
038900*---------------                                                  03490000
038800 Z999-SQL-ERROR.                                                  03491010
038900*---------------                                                  03492010
039000                                                                  03500000
039100     MOVE SQLCODE    TO SQLCODE2.                                 03510000
039200     MOVE SQLERRD(3) TO SQLERRD3.                                 03520000
039300     DISPLAY '** ABEND **       ** = SQLERROR'.                   03530000
039400     DISPLAY '** PROGRAM        ** = XMKUP001'.                   03540000
039500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  03550000
039600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  03560000
039700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   03570000
039800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  03580000
039900     MOVE +4013 TO PV-ABEND-CODE.                                 03590000
040000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03600000
040100*                                                                 03610000
040200******************************************************************03620000
040300******************************************************************03630000
