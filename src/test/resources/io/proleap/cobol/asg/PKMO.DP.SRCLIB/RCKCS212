000100*-----------------------*                                         00010014
000200 IDENTIFICATION DIVISION.                                         00020015
000300*-----------------------*                                         00030015
000400 PROGRAM-ID.    RCKCS212.                                         00040015
000500 AUTHOR.        ANNE RECKNAGEL.                                   00050015
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060015
000700 DATE-WRITTEN.  01-25-94.                                         00070015
000800 DATE-COMPILED.                                                   00080015
000900*----------------------------------------------------------------*00090015
001000*    E212 - PACK SLIP CRITERIA SPECIFICATION                     *00100015
001100*                                                                *00110015
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00120015
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130015
001400*    DETAIL SCREEN.  THE OPERATING UNIT ID, FACILITY ID, AND     *00140015
001500*    PURCHASE ORDER NUMBER ARE REQUIRED.                         *00150015
001600*----------------------------------------------------------------*00160015
001610* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00161015
001620* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162015
001630* MAKING THE CALL DYNAMIC VS STATIC.                              00163015
001640*---------------------------------------------------------------* 00164015
001650                                                                  00165015
001660                                                                  00166015
001670                                                                  00167015
001680 ENVIRONMENT DIVISION.                                            00168015
001690                                                                  00169015
001700                                                                  00170015
001800                                                                  00180015
001900 DATA DIVISION.                                                   00190015
002000                                                                  00200015
002100                                                                  00210015
002200 WORKING-STORAGE SECTION.                                         00220015
002300                                                                  00230015
002400 01  DK-DB2-KEYS.                                                 00240015
002500     05  DK-PO-NBR                 PIC S9(09)  VALUE +0           00250015
002600                                               COMP.              00260015
002700                                                                  00270015
002800 01  PC-PROGRAM-CONSTANTS.                                        00280015
002900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RC212A  '. 00290015
003000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RCKM212 '. 00300015
003100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RCKCS212'. 00310015
003200     05  PC-TSYMSG-NUMBERS.                                       00320015
003300         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00330015
003400*            INVALID VALUE                                        00340015
003500         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00350015
003600*            REQUIRED ENTRY                                       00360015
003700         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00370015
003800*            MUST BE NUMERIC                                      00380015
003900         10  PC-TSYMSG-00083       PIC  9(05)  VALUE  00083.      00390015
004000*            PURCHASE ORDER DOES NOT EXIST                        00400015
004100         10  PC-TSYMSG-00737       PIC  9(05)  VALUE  00737.      00410015
004200*            REC SEQ NUMBER IS REQUIRED                           00420015
004300     05  PC-ACTIVE                 PIC  X(01)  VALUE  'A'.        00430015
004400     05  PC-X                      PIC  X(01)  VALUE  'X'.        00440015
004500     05  PC-AC                     PIC  X(02)  VALUE  'AC'.       00450015
004600     05  PC-CM                     PIC  X(02)  VALUE  'CM'.       00460015
004700     05  PC-IN                     PIC  X(02)  VALUE  'IN'.       00470015
004800     05  PC-IP                     PIC  X(02)  VALUE  'IP'.       00480015
004900     05  PC-VE                     PIC  X(02)  VALUE  'VE'.       00490015
005000     05  PC-MAX-RETRIES            PIC S9(03)  VALUE  +3          00500015
005100                                               COMP-3.            00510015
005200     05  PC-1                      PIC S9(04)  VALUE  +1          00520015
005300                                               COMP.              00530015
005400                                                                  00540015
005500 01  PS-PROGRAM-SWITCHES.                                         00550015
005600     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00560015
005700         88  PS-ERROR                          VALUE  'Y'.        00570015
005800         88  PS-NO-ERROR                       VALUE  'N'.        00580015
005900                                                                  00590015
006000 01  PS-PROGRAM-VARIABLES.                                        00600015
006100     05  PV-RETRY-COUNTER          PIC S9(04)  VALUE +0           00610015
006200                                               COMP SYNC.         00620015
006300     05  PV-OPER-UNT-ID.                                          00630015
006400         10  PV-LOCATION           PIC X(04)   VALUE ZEROES.      00640015
006500     05  PV-OPER-UNT-ID-N  REDEFINES  PV-OPER-UNT-ID              00650015
006600                                   PIC 9(04).                     00660015
006700                                                                  00670015
006800*----------------------------------------------------------------*00680015
006900*    COPYBOOK FOR LOGISTICS DOMAIN LOCATION MODULE (XLKUT071)    *00690015
007000*----------------------------------------------------------------*00700015
007100                                                                  00710015
007200     COPY XLWS071.                                                00720015
007300                                                                  00730015
007400*----------------------------------------------------------------*00740015
007500*    MAP LAYOUT                                                  *00750015
007600*----------------------------------------------------------------*00760015
007700                                                                  00770015
007800     COPY RCKM212.                                                00780015
007900     EJECT                                                        00790015
008000*----------------------------------------------------------------*00800015
008100*    ATTRIBUTE SETTINGS COPYBOOK.                                *00810015
008200*----------------------------------------------------------------*00820015
008300                                                                  00830015
008400     COPY DPWS015.                                                00840015
008500                                                                  00850015
008600*----------------------------------------------------------------*00860015
008700*    FUNCTION KEYS COPYBOOK                                      *00870015
008800*----------------------------------------------------------------*00880015
008900                                                                  00890015
009000     COPY DPWS016.                                                00900015
009100 EJECT                                                            00910015
009200******************************************************************00920015
009300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00930015
009400** SUB-ROUTINE (DPKUT100).                                      **00940015
009500******************************************************************00950015
009600     COPY DPWS010I.                                               00960015
009700 EJECT                                                            00970015
009800******************************************************************00980015
009900** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **00990015
010000** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01000015
010100******************************************************************01010015
010200     COPY DPWS030.                                                01020015
010210     COPY DPWS930.                                                01021015
010300 EJECT                                                            01030015
010400***************************************************************** 01040015
010500*    STANDARD COMMAREA.                                           01050015
010600***************************************************************** 01060015
010700                                                                  01070015
010800     COPY DPWS020.                                                01080015
010900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01090015
011000                                                                  01100015
011100***************************************************************** 01110015
011200*    INTER-APPLICATION COMMAREA.                                  01120015
011300***************************************************************** 01130015
011400                                                                  01140015
011500         10  INTER-APPL-COMM-AREA PIC X(200).                     01150015
011600     COPY RCWS012.                                                01160015
011700     COPY RCWS800.                                                01170015
011800                                                                  01180015
011900***************************************************************** 01190015
012000*    SPECIFIC COMMMAREA FOR RCKCS212.                             01200015
012100***************************************************************** 01210015
012200         10  ASC-SPECIFIC-COMMAREA.                               01220015
012300             15  ASC-OPER-UNT-ID.                                 01230015
012400                 20  ASC-OPER-UNT-ID-N       PIC  9(04).          01240015
012500             15  ASC-OPER-UNT-ID-DESC        PIC  X(30).          01250015
012600             15  ASC-FCLTY-ID.                                    01260015
012700                 20  ASC-FCLTY-ID-N          PIC  9(04).          01270015
012800             15  ASC-FCLTY-NME               PIC  X(30).          01280015
012900* CHG0094517  EXPANDED ASC-PO-NBR FROM 7 TO 8                     01290015
013000             15  ASC-PO-NBR.                                      01300015
013100                 20  ASC-PO-NBR-N            PIC  9(08).          01310015
013200             15  ASC-PKSL-STAT-CDES.                              01320015
013300                 20  ASC-AC-STAT             PIC  X(02).          01330015
013400                 20  ASC-IN-STAT             PIC  X(02).          01340015
013500                 20  ASC-IP-STAT             PIC  X(02).          01350015
013600                 20  ASC-CM-STAT             PIC  X(02).          01360015
013700                 20  ASC-VE-STAT             PIC  X(02).          01370015
013800             15  ASC-REC-SEQ-NBR.                                 01380015
013900                 20  ASC-REC-SEQ-NBR-N       PIC  9(04).          01390015
014000             15  ASC-PKSL-NBR                PIC  X(10).          01400015
014100             15  ASC-BOL-NBR                 PIC  X(16).          01410015
014200             15  ASC-PRO-NBR                 PIC  X(16).          01420015
014300* CHG0094517  REDUCED FILLER FROM 2734 TO 2733                    01430015
014400         10  FILLER                          PIC  X(2733).        01440015
014500     EJECT                                                        01450015
014600*----------------------------------------------------------------*01460015
014700*    ABEND PROCESSING COPYBOOK.                                  *01470015
014800*----------------------------------------------------------------*01480015
014900                                                                  01490015
015000     COPY DPWS013.                                                01500015
015100                                                                  01510015
015200*----------------------------------------------------------------*01520015
015300*    DB2 AREA FOR THE PURCHASE ORDER TABLE                       *01530015
015400*----------------------------------------------------------------*01540015
015500                                                                  01550015
015600     EXEC SQL                                                     01560015
015700         INCLUDE TPURCHS                                          01570015
015800     END-EXEC.                                                    01580015
015900                                                                  01590015
016000*----------------------------------------------------------------*01600015
016100*    DB2 AREA FOR COMMUNICATIONS                                 *01610015
016200*----------------------------------------------------------------*01620015
016300                                                                  01630015
016400     EXEC SQL                                                     01640015
016500         INCLUDE SQLCA                                            01650015
016600     END-EXEC.                                                    01660015
016700                                                                  01670015
016800                                                                  01680015
016900 EJECT                                                            01690015
017000 LINKAGE SECTION.                                                 01700015
017100                                                                  01710015
017200 01  DFHCOMMAREA.                                                 01720015
017300     05  FILLER                         OCCURS  1 TO 4072 TIMES   01730015
017400                                        DEPENDING ON EIBCALEN.    01740015
017500         10  FILLER                     PIC X.                    01750015
017600                                                                  01760015
017700                                                                  01770015
017800 PROCEDURE DIVISION.                                              01780015
017900***************************************************************** 01790015
018000** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01800015
018100** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01810015
018200** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01820015
018300**                                                             ** 01830015
018400** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01840015
018500** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01850015
018600***************************************************************** 01860015
018700 0000-MAIN-MODULE.                                                01870015
018800                                                                  01880015
018900     INITIALIZE DP030-CICS-API-FIELDS.                            01890015
019000                                                                  01900015
019100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01910015
019200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01920015
019300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01930015
019400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01940015
019500     MOVE LENGTH OF RC212AI        TO DP030-MAP-LENGTH (1).       01950015
019600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01960015
019700     PERFORM 0001-CALL-CICS-ARCH-API.                             01970015
019800                                                                  01980015
019900     PERFORM 1000-CONTROL-PROCESSING                              01990015
020000                                                                  02000015
020100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02010015
020200     PERFORM 0001-CALL-CICS-ARCH-API.                             02020015
020300                                                                  02030015
020400 0001-CALL-CICS-ARCH-API.                                         02040015
020500                                                                  02050015
020610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02061015
020700                                    DFHCOMMAREA                   02070015
020800                                    DP030-CICS-API-FIELDS         02080015
020900                                    DP020-STANDARD-COMMAREA       02090015
021000                                    RC212AI.                      02100015
021100                                                                  02110015
021200     IF  DP030-RC-CALL-SUCCESSFUL                                 02120015
021300         CONTINUE                                                 02130015
021400     ELSE                                                         02140015
021500         SET DP013-NO-ROLLBACK                                    02150015
021600             DP013-XCTL-DISPLAY-RESTART                           02160015
021700             DP013-CICS-ABEND      TO TRUE                        02170015
021800         MOVE 'BEFORE 0000-MAIN-MODULE'                           02180015
021900                                   TO DP013-PARAGRAPH             02190015
021910         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O02191015
021920-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02192015
022200         MOVE DP030-RETURN-CODE                                   02220015
022300                                   TO DP013-MESSAGE-TEXT (3)      02230015
022400         PERFORM DP013-0000-PROCESS-ABEND                         02240015
022500     END-IF.                                                      02250015
022600 EJECT                                                            02260015
022700*----------------------------------------------------------------*02270015
022800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02280015
022900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02290015
023000*----------------------------------------------------------------*02300015
023100                                                                  02310015
023200 1000-CONTROL-PROCESSING.                                         02320015
023300                                                                  02330015
023400     EVALUATE TRUE                                                02340015
023500         WHEN DP020-NEXT-ACT-INITIAL                              02350015
023600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02360015
023700             PERFORM 4000-BUILD-INITIAL-PANEL                     02370015
023800                                                                  02380015
023900         WHEN DP020-NEXT-ACT-READ-MAP                             02390015
024000             PERFORM 2000-FKEY-PROCESSING                         02400015
024100                                                                  02410015
024200         WHEN DP020-NEXT-ACT-RETURN                               02420015
024300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02430015
024400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02440015
024500                                                                  02450015
024600         WHEN OTHER                                               02460015
024700             SET DP013-LOGIC-ABEND                                02470015
024800                 DP013-NO-ROLLBACK TO TRUE                        02480015
024900             MOVE '1000-CONTROL-PROCESSING'                       02490015
025000                                   TO  DP013-PARAGRAPH            02500015
025100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02510015
025200                                   TO  DP013-MESSAGE-TEXT(1)      02520015
025300             MOVE DP020-NEXT-APPL-ACTIVITY                        02530015
025400                                   TO DP013-MESSAGE-TEXT(2)       02540015
025500             PERFORM DP013-0000-PROCESS-ABEND                     02550015
025600     END-EVALUATE.                                                02560015
025700                                                                  02570015
025800*----------------------------------------------------------------*02580015
025900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02590015
026000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02600015
026100* EDITS.                                                         *02610015
026200*----------------------------------------------------------------*02620015
026300                                                                  02630015
026400 2000-FKEY-PROCESSING.                                            02640015
026500                                                                  02650015
026600     EVALUATE TRUE                                                02660015
026700                                                                  02670015
026800         WHEN DP020-SRC-AID = DP016-CLEAR                         02680015
026900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02690015
027000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02700015
027100                                                                  02710015
027200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02720015
027300             INITIALIZE ASC-SPECIFIC-COMMAREA                     02730015
027400             PERFORM 4000-BUILD-INITIAL-PANEL                     02740015
027500             PERFORM 3200-RESET-ATTRIBUTES                        02750015
027600                                                                  02760015
027700         WHEN OTHER                                               02770015
027800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02780015
027900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02790015
028000             IF  PS-NO-ERROR                                      02800015
028100                 SET DP030-CONTINUE-GO                            02810015
028200                                   TO TRUE                        02820015
028300                 PERFORM 2100-CHECK-FUNCTION-KEY                  02830015
028400             ELSE                                                 02840015
028500                 SET DP030-OVERRIDE-GO                            02850015
028600                                   TO TRUE                        02860015
028700             END-IF                                               02870015
028800     END-EVALUATE.                                                02880015
028900******************************************************************02890015
029000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02900015
029100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **02910015
029200** FROM THE CICS ARCHITECTURE API.                              **02920015
029300******************************************************************02930015
029400 2100-CHECK-FUNCTION-KEY.                                         02940015
029500                                                                  02950015
029600     EVALUATE TRUE                                                02960015
030200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03020003
030300             INITIALIZE RC800-INTER-APPL-COMMAREA                 03030003
030400             IF ASC-REC-SEQ-NBR-N NOT > 0                         03040003
030500                MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER         03050003
030600                SET PS-ERROR                                      03060003
030700                    DP030-OVERRIDE-GO                             03070005
030800                    DP020-MSG-FATAL   TO TRUE                     03080003
030900                MOVE DP015-UNP-NUM-BRT-OFF                        03090003
031000                                      TO ARECSEQA                 03100003
031100                MOVE DP015-RED        TO ARECSEQC                 03110003
031200                MOVE DP015-REVERSE    TO ARECSEQH                 03120003
031300                MOVE -1               TO ARECSEQL                 03130003
031400                SET DP030-SET-CURSOR-APPL-1                       03140003
031500                                      TO TRUE                     03150003
031600             ELSE                                                 03160003
031700                MOVE ASC-PO-NBR-N     TO RC800-REC-NBR-N          03170003
031800                MOVE ASC-REC-SEQ-NBR-N                            03180003
031900                                      TO RC800-REC-SEQ-NBR-N      03190003
032000                MOVE ASC-OPER-UNT-ID-N                            03200003
032100                                      TO RC800-OPER-UNIT-ID       03210003
032200                MOVE ASC-FCLTY-ID-N   TO RC800-FACILITY-ID        03220003
032300             END-IF                                               03230003
032400                                                                  03240003
032500         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 03250003
032600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03260003
032700                                                                  03270003
032800         WHEN DP020-SRC-AID = DP016-ENTER                         03280003
032900             CONTINUE                                             03290003
033000                                                                  03300003
033100         WHEN OTHER                                               03310003
033200             SET DP013-NO-ROLLBACK                                03320003
033300                 DP013-XCTL-DISPLAY-RESTART                       03330003
033400                 DP013-CICS-ABEND  TO TRUE                        03340003
033500             MOVE '2100-CHECK-FUNCTION-KEY'                       03350003
033600                                   TO DP013-PARAGRAPH             03360003
033700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03370003
033800                                   TO DP013-MESSAGE-TEXT (1)      03380003
033900             PERFORM DP013-0000-PROCESS-ABEND                     03390003
034000     END-EVALUATE.                                                03400003
034100                                                                  03410003
034200******************************************************************03420003
034300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03430003
034400** INTER-APPLICATION COMMAREA.                                  **03440003
034500******************************************************************03450003
034600 2110-PREPARE-INTER-APPL-COMM.                                    03460003
034700                                                                  03470003
034800     INITIALIZE RC012-INTER-APPL-COMMAREA.                        03480003
034900                                                                  03490003
035000     MOVE ASC-OPER-UNT-ID-N        TO RC012-OPER-UNT-ID.          03500003
035100     MOVE ASC-FCLTY-ID-N           TO RC012-FCLTY-ID.             03510003
035200     MOVE ASC-PO-NBR-N             TO RC012-PO-NBR.               03520003
035300     MOVE ASC-PKSL-STAT-CDES       TO RC012-PKSL-STAT-CDES.       03530003
035400     MOVE ASC-REC-SEQ-NBR-N        TO RC012-REC-SEQ-NBR.          03540003
035500     MOVE ASC-PKSL-NBR             TO RC012-PKSL-NBR.             03550003
035600     MOVE ASC-BOL-NBR              TO RC012-BOL-NBR.              03560003
035700     MOVE ASC-PRO-NBR              TO RC012-PRO-NBR.              03570003
035800 EJECT                                                            03580003
035900*----------------------------------------------------------------*03590003
036000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03600003
036100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03610003
036200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03620003
036300*----------------------------------------------------------------*03630003
036400                                                                  03640003
036500 2200-MOVE-SCREEN-TO-COMMAREA.                                    03650003
036600                                                                  03660003
036700     IF  AOPERL > ZERO                                            03670003
036800         MOVE AOPERI               TO ASC-OPER-UNT-ID             03680003
036900     ELSE                                                         03690003
037000         IF  AOPERF = DP015-ERASE-EOF                             03700003
037100             MOVE ZEROS            TO ASC-OPER-UNT-ID             03710003
037200         END-IF                                                   03720003
037300     END-IF.                                                      03730003
037400                                                                  03740003
037500     IF  AFCLTYL > ZERO                                           03750003
037600         MOVE AFCLTYI              TO ASC-FCLTY-ID                03760003
037700     ELSE                                                         03770003
037800         IF  AFCLTYF = DP015-ERASE-EOF                            03780003
037900             MOVE ZEROS            TO ASC-FCLTY-ID                03790003
038000         END-IF                                                   03800003
038100     END-IF.                                                      03810003
038200                                                                  03820003
038300     IF  APOL > ZERO                                              03830003
038400         MOVE APOI                 TO ASC-PO-NBR                  03840003
038500     ELSE                                                         03850003
038600         IF  APOF = DP015-ERASE-EOF                               03860003
038700             MOVE ZEROS            TO ASC-PO-NBR                  03870003
038800         END-IF                                                   03880003
038900     END-IF.                                                      03890003
039000                                                                  03900003
039100     IF  AACL > ZERO                                              03910003
039200         IF AACI > SPACES                                         03920003
039300             MOVE PC-AC            TO ASC-AC-STAT                 03930003
039400         ELSE                                                     03940003
039500             MOVE SPACES           TO ASC-AC-STAT                 03950003
039600         END-IF                                                   03960003
039700     ELSE                                                         03970003
039800         IF  AACF = DP015-ERASE-EOF                               03980003
039900             MOVE SPACES           TO ASC-AC-STAT                 03990003
040000         END-IF                                                   04000003
040100     END-IF.                                                      04010003
040200                                                                  04020003
040300     IF  AINL > ZERO                                              04030003
040400         IF AINI > SPACES                                         04040003
040500             MOVE PC-IN            TO ASC-IN-STAT                 04050003
040600         ELSE                                                     04060003
040700             MOVE SPACES           TO ASC-IN-STAT                 04070003
040800         END-IF                                                   04080003
040900     ELSE                                                         04090003
041000         IF  AINF = DP015-ERASE-EOF                               04100003
041100             MOVE SPACES           TO ASC-IN-STAT                 04110003
041200         END-IF                                                   04120003
041300     END-IF.                                                      04130003
041400                                                                  04140003
041500     IF  AIPL > ZERO                                              04150003
041600         IF AIPI > SPACES                                         04160003
041700             MOVE PC-IP            TO ASC-IP-STAT                 04170003
041800         ELSE                                                     04180003
041900             MOVE SPACES           TO ASC-IP-STAT                 04190003
042000         END-IF                                                   04200003
042100     ELSE                                                         04210003
042200         IF  AIPF = DP015-ERASE-EOF                               04220003
042300             MOVE SPACES           TO ASC-IP-STAT                 04230003
042400         END-IF                                                   04240003
042500     END-IF.                                                      04250003
042600                                                                  04260003
042700     IF  ACML > ZERO                                              04270003
042800         IF ACMI > SPACES                                         04280003
042900             MOVE PC-CM            TO ASC-CM-STAT                 04290003
043000         ELSE                                                     04300003
043100             MOVE SPACES           TO ASC-CM-STAT                 04310003
043200         END-IF                                                   04320003
043300     ELSE                                                         04330003
043400         IF  ACMF = DP015-ERASE-EOF                               04340003
043500             MOVE SPACES           TO ASC-CM-STAT                 04350003
043600         END-IF                                                   04360003
043700     END-IF.                                                      04370003
043800                                                                  04380003
043900     IF  AVEL > ZERO                                              04390003
044000         IF AVEI > SPACES                                         04400003
044100             MOVE PC-VE            TO ASC-VE-STAT                 04410003
044200         ELSE                                                     04420003
044300             MOVE SPACES           TO ASC-VE-STAT                 04430003
044400         END-IF                                                   04440003
044500     ELSE                                                         04450003
044600         IF  AVEF = DP015-ERASE-EOF                               04460003
044700             MOVE SPACES           TO ASC-VE-STAT                 04470003
044800         END-IF                                                   04480003
044900     END-IF.                                                      04490003
045000                                                                  04500003
045100     IF  ARECSEQL > ZERO                                          04510003
045200         MOVE ARECSEQI             TO ASC-REC-SEQ-NBR             04520003
045300     ELSE                                                         04530003
045400         IF  ARECSEQF = DP015-ERASE-EOF                           04540003
045500             MOVE SPACES           TO ASC-REC-SEQ-NBR             04550003
045600         END-IF                                                   04560003
045700     END-IF.                                                      04570003
045800                                                                  04580003
045900     IF  APKSLIPL > ZERO                                          04590003
046000         MOVE APKSLIPI             TO ASC-PKSL-NBR                04600003
046100     ELSE                                                         04610003
046200         IF  APKSLIPF = DP015-ERASE-EOF                           04620003
046300             MOVE SPACE            TO ASC-PKSL-NBR                04630003
046400         END-IF                                                   04640003
046500     END-IF.                                                      04650003
046600                                                                  04660003
046700     IF  ABOLL > ZERO                                             04670003
046800         MOVE ABOLI                TO ASC-BOL-NBR                 04680003
046900     ELSE                                                         04690003
047000         IF  ABOLF = DP015-ERASE-EOF                              04700003
047100             MOVE SPACE            TO ASC-BOL-NBR                 04710003
047200         END-IF                                                   04720003
047300     END-IF.                                                      04730003
047400                                                                  04740003
047500     IF  AFBL > ZERO                                              04750003
047600         MOVE AFBI                 TO ASC-PRO-NBR                 04760003
047700     ELSE                                                         04770003
047800         IF  AFBF = DP015-ERASE-EOF                               04780003
047900             MOVE SPACE            TO ASC-PRO-NBR                 04790003
048000         END-IF                                                   04800003
048100     END-IF.                                                      04810003
048200                                                                  04820003
048300*----------------------------------------------------------------*04830003
048400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04840003
048500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04850003
048600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04860003
048700* IN THE DESTINATION PROGRAM, NOT HERE.                          *04870003
048800*----------------------------------------------------------------*04880003
048900                                                                  04890003
049000 3000-EDIT-DATA-IN-COMMAREA.                                      04900003
049100                                                                  04910003
049200     PERFORM 3200-RESET-ATTRIBUTES.                               04920003
049300                                                                  04930003
049400     IF  ASC-REC-SEQ-NBR > SPACES                                 04940003
049500         MOVE ASC-REC-SEQ-NBR      TO DP010I-UNEDITED-FIELD       04950003
049600         MOVE LENGTH OF ASC-REC-SEQ-NBR                           04960003
049700                                   TO DP010I-MAXIMUM-DIGITS       04970003
049800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04980003
049900         SET DP010I-NEGATIVE-NOT-ALLOWED                          04990003
050000                                   TO TRUE                        05000003
050110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05011014
050120              USING DP010I-NUMERIC-EDIT-AREA                      05012014
050200                                                                  05020003
050300         IF  DP010I-ERROR-DETECTED                                05030003
050400             SET PS-ERROR                                         05040003
050500                 DP020-MSG-FATAL   TO TRUE                        05050003
050600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05060003
050700             MOVE DP015-UNP-NUM-BRT-OFF                           05070003
050800                                   TO ARECSEQA                    05080003
050900             MOVE DP015-RED        TO ARECSEQC                    05090003
051000             MOVE DP015-REVERSE    TO ARECSEQH                    05100003
051100             MOVE -1               TO ARECSEQL                    05110003
051200             SET DP030-SET-CURSOR-APPL-1                          05120003
051300                                   TO TRUE                        05130003
051400         ELSE                                                     05140003
051500             MOVE DP010I-NUMERIC-FIELD                            05150003
051600                                   TO ASC-REC-SEQ-NBR-N           05160003
051700             MOVE ASC-REC-SEQ-NBR  TO ARECSEQO                    05170003
051800         END-IF                                                   05180003
051900     END-IF.                                                      05190003
052000                                                                  05200003
052100     IF ASC-REC-SEQ-NBR = ZEROS                                   05210003
052200         MOVE SPACES               TO ASC-REC-SEQ-NBR             05220003
052300                                      ARECSEQO                    05230003
052400     END-IF.                                                      05240003
052500                                                                  05250003
052600     IF  ASC-PO-NBR > ZEROES                                      05260003
052700         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       05270003
052800         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       05280003
052900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05290003
053000         SET DP010I-NEGATIVE-NOT-ALLOWED                          05300003
053100                                   TO TRUE                        05310003
053210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05321014
053220              USING DP010I-NUMERIC-EDIT-AREA                      05322014
053300                                                                  05330003
053400         IF  DP010I-ERROR-DETECTED                                05340003
053500             SET PS-ERROR                                         05350003
053600                 DP020-MSG-FATAL   TO TRUE                        05360003
053700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05370003
053800             MOVE DP015-UNP-NUM-BRT-OFF                           05380003
053900                                   TO APOA                        05390003
054000             MOVE DP015-RED        TO APOC                        05400003
054100             MOVE DP015-REVERSE    TO APOH                        05410003
054200             MOVE -1               TO APOL                        05420003
054300             SET DP030-SET-CURSOR-APPL-1                          05430003
054400                                   TO TRUE                        05440003
054500         ELSE                                                     05450003
054600             MOVE DP010I-NUMERIC-FIELD                            05460003
054700                                   TO ASC-PO-NBR-N                05470003
054800                                      DK-PO-NBR                   05480003
054900             MOVE ASC-PO-NBR       TO APOO                        05490003
055000*            PERFORM 3500-VALIDATE-PO-NBR                         05500003
055100         END-IF                                                   05510003
055200     ELSE                                                         05520003
055300         SET PS-ERROR                                             05530003
055400         DP020-MSG-FATAL           TO TRUE                        05540003
055500         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            05550003
055600         MOVE DP015-UNP-NUM-BRT-OFF                               05560003
055700                                   TO APOA                        05570003
055800         MOVE DP015-RED            TO APOC                        05580003
055900         MOVE DP015-REVERSE        TO APOH                        05590003
056000         MOVE -1                   TO APOL                        05600003
056100         SET DP030-SET-CURSOR-APPL-1                              05610003
056200                                   TO TRUE                        05620003
056300     END-IF.                                                      05630003
056400                                                                  05640003
056500     IF  ASC-OPER-UNT-ID > ZEROES                                 05650003
056600         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       05660003
056700         MOVE LENGTH OF ASC-OPER-UNT-ID                           05670003
056800                                   TO DP010I-MAXIMUM-DIGITS       05680003
056900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     05690003
057000         SET DP010I-NEGATIVE-NOT-ALLOWED                          05700003
057100                                   TO TRUE                        05710003
057210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05721014
057220              USING DP010I-NUMERIC-EDIT-AREA                      05722014
057300                                                                  05730003
057400         IF  DP010I-ERROR-DETECTED                                05740003
057500             SET PS-ERROR                                         05750003
057600                 DP020-MSG-FATAL   TO TRUE                        05760003
057700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            05770003
057800             MOVE DP015-UNP-NUM-BRT-OFF                           05780003
057900                                   TO AOPERA                      05790003
058000             MOVE DP015-RED        TO AOPERC                      05800003
058100             MOVE DP015-REVERSE    TO AOPERH                      05810003
058200             MOVE -1               TO AOPERL                      05820003
058300             SET DP030-SET-CURSOR-APPL-1                          05830003
058400                                   TO TRUE                        05840003
058500         ELSE                                                     05850003
058600             MOVE DP010I-NUMERIC-FIELD                            05860003
058700                                   TO ASC-OPER-UNT-ID-N           05870003
058800             MOVE ASC-OPER-UNT-ID  TO AOPERO                      05880003
058900             PERFORM 3300-CHECK-OPER-UNT-GET-NAME                 05890006
059000         END-IF                                                   05900003
059100     ELSE                                                         05910003
059200         SET PS-ERROR                                             05920003
059300             DP020-MSG-FATAL       TO TRUE                        05930003
059400         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            05940003
059500         MOVE DP015-UNP-NUM-BRT-OFF                               05950003
059600                                   TO AOPERA                      05960003
059700         MOVE DP015-RED            TO AOPERC                      05970003
059800         MOVE DP015-REVERSE        TO AOPERH                      05980003
059900         MOVE -1                   TO AOPERL                      05990003
060000         SET DP030-SET-CURSOR-APPL-1                              06000003
060100                                   TO TRUE                        06010003
060200     END-IF.                                                      06020003
060300                                                                  06030003
060400     IF  ASC-FCLTY-ID = SPACES OR ZEROS                           06040003
060500         MOVE ZEROS                TO ASC-FCLTY-ID-N              06050009
060600         MOVE SPACES               TO ASC-FCLTY-NME               06060003
060700                                      AFDESCO                     06070003
060800     ELSE                                                         06080003
060900         MOVE ASC-FCLTY-ID         TO DP010I-UNEDITED-FIELD       06090003
061000         MOVE LENGTH OF ASC-FCLTY-ID                              06100003
061100                                   TO DP010I-MAXIMUM-DIGITS       06110003
061200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     06120003
061300         SET DP010I-NEGATIVE-NOT-ALLOWED                          06130003
061400                                   TO TRUE                        06140003
061510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06151014
061520              USING DP010I-NUMERIC-EDIT-AREA                      06152014
061600                                                                  06160003
061700         IF  DP010I-ERROR-DETECTED                                06170003
061800             SET PS-ERROR                                         06180003
061900                 DP020-MSG-FATAL   TO TRUE                        06190003
062000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            06200003
062100             MOVE DP015-UNP-NUM-BRT-OFF                           06210003
062200                                   TO AFCLTYA                     06220003
062300             MOVE DP015-RED        TO AFCLTYC                     06230003
062400             MOVE DP015-REVERSE    TO AFCLTYH                     06240003
062500             MOVE -1               TO AFCLTYL                     06250003
062600             SET DP030-SET-CURSOR-APPL-1                          06260003
062700                                   TO TRUE                        06270003
062800         ELSE                                                     06280003
062900             MOVE DP010I-NUMERIC-FIELD                            06290003
063000                                   TO ASC-FCLTY-ID-N              06300003
063100             IF ASC-FCLTY-ID-N = 1                                06310006
063200                 MOVE XL071-LOC-NM TO ASC-FCLTY-NME               06320006
063300                                      AFDESCO                     06330006
063400                 MOVE ASC-FCLTY-ID TO AFCLTYO                     06340006
063500             ELSE                                                 06350006
063600                 SET PS-ERROR                                     06360006
063700                     DP020-MSG-FATAL         TO TRUE              06370006
063800                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  06380006
063900                 MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA           06390006
064000                 MOVE DP015-RED              TO AFCLTYC           06400006
064100                 MOVE DP015-REVERSE          TO AFCLTYH           06410006
064200                 MOVE -1                     TO AFCLTYL           06420006
064300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06430006
064400             END-IF                                               06440006
064500         END-IF                                                   06450003
064600     END-IF.                                                      06460003
064700                                                                  06470003
064800     IF  PS-NO-ERROR                                              06480003
064900         MOVE -1                   TO AOPERL                      06490003
065000         SET DP030-SET-CURSOR-APPL-1                              06500003
065100                                   TO TRUE                        06510003
065200     END-IF.                                                      06520003
065300                                                                  06530003
065400******************************************************************06540003
065500** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **06550003
065600** MAP.                                                         **06560003
065700******************************************************************06570003
065800 3200-RESET-ATTRIBUTES.                                           06580003
065900                                                                  06590003
066000     MOVE DP015-UNP-ALP-NOR-OFF    TO APKSLIPA                    06600003
066100                                      AACA                        06610003
066200                                      AINA                        06620003
066300                                      AIPA                        06630003
066400                                      ACMA                        06640003
066500                                      ABOLA                       06650003
066600                                      AFBA.                       06660003
066700     MOVE DP015-UNP-NUM-NOR-OFF    TO AOPERA                      06670003
066800                                      AFCLTYA                     06680003
066900                                      APOA                        06690003
067000                                      ARECSEQA.                   06700003
067100     MOVE DP015-GREEN              TO AOPERC                      06710003
067200                                      AFCLTYC                     06720003
067300                                      APOC                        06730003
067400                                      AACC                        06740003
067500                                      AINC                        06750003
067600                                      AIPC                        06760003
067700                                      ACMC                        06770003
067800                                      APKSLIPC                    06780003
067900                                      ABOLC                       06790003
068000                                      AFBC                        06800003
068100                                      ARECSEQC.                   06810003
068200     MOVE DP015-UNDERLINE          TO AOPERH                      06820003
068300                                      AFCLTYH                     06830003
068400                                      APOH                        06840003
068500                                      AACH                        06850003
068600                                      AINH                        06860003
068700                                      AIPH                        06870003
068800                                      ACMH                        06880003
068900                                      APKSLIPH                    06890003
069000                                      ABOLH                       06900003
069100                                      AFBH                        06910003
069200                                      ARECSEQH.                   06920003
069300                                                                  06930003
069400*----------------------------------------------------------------*06940003
069500*  CHECK THE XLT_LOC TABLE TO VERIFY THE OPER UNIT IS VALID AND   06950006
069600*  GET LOCATION NAME.                                             06960006
069700*----------------------------------------------------------------*06970003
069800 3300-CHECK-OPER-UNT-GET-NAME.                                    06980006
069900     INITIALIZE XL071-COMMAREA-REC.                               06990006
070000                                                                  07000006
070100     MOVE ASC-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER.             07010006
070200                                                                  07020006
070300     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    07030006
070400                                      XL071-COMMAREA              07040006
070500                                      XL071-COMMAREA-REC.         07050006
070600                                                                  07060006
070700     EVALUATE TRUE                                                07070006
070800         WHEN XL071-NO-ERRORS                                     07080006
070900             MOVE XL071-LOC-NM TO ASC-FCLTY-NME                   07090006
071000         WHEN XL071-LOC-NOT-FOUND                                 07100006
071100             SET PS-ERROR                                         07110006
071200                 DP020-MSG-FATAL         TO TRUE                  07120006
071300             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      07130006
071400             MOVE DP015-UNP-NUM-BRT-OFF  TO AOPERA                07140006
071500             MOVE DP015-RED              TO AOPERC                07150006
071600             MOVE DP015-REVERSE          TO AOPERH                07160006
071700             MOVE -1                     TO AOPERL                07170006
071800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07180006
071900         WHEN XL071-SQLCODE-N = -904                              07190010
072000         WHEN XL071-SQLCODE-N = -913                              07200010
072100             MOVE SPACES  TO ASC-FCLTY-NME                        07210006
072200         WHEN XL071-BAD-DB2-RETURN                                07220006
072300             MOVE '3300-CHECK-OPER-UNT-GET-NAME'                  07230006
072400                                     TO DP013-PARAGRAPH           07240006
072500             MOVE 'SELECT OPER UNIT' TO DP013-MESSAGE-TEXT (1)    07250006
072600             MOVE 'OPER UNIT     '   TO DP013-MESSAGE-TEXT (2)    07260006
072700             MOVE ASC-OPER-UNT-ID    TO DP013-MESSAGE-TEXT (3)    07270006
072800             MOVE XL071-SQLCA        TO DP013-SQLCA               07280006
072900             MOVE XL071-SQLCODE-N    TO SQLCODE                   07290011
073000             MOVE 'XLT-LOC'          TO DP013-DB2-TABLE-NAME (1)  07300006
073100             SET  DP013-DB2-ABEND                                 07310007
073200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07320007
073300             PERFORM DP013-0000-PROCESS-ABEND                     07330006
073400     END-EVALUATE.                                                07340006
073500                                                                  07350003
073600*----------------------------------------------------------------*07360003
073700*  CHECK THE PURCHASE ORDER TABLE TO VERIFY THE PURCHASE ORDER   *07370003
073800*  ENTERED ON THE MAP IS VALID.                                  *07380003
073900*----------------------------------------------------------------*07390003
074000                                                                  07400003
074100 3500-VALIDATE-PO-NBR.                                            07410003
074200                                                                  07420003
074300     PERFORM                                                      07430003
074400         WITH TEST AFTER                                          07440003
074500         VARYING PV-RETRY-COUNTER                                 07450003
074600         FROM 1 BY 1                                              07460003
074700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07470003
074800                   OR (SQLCODE = +0)                              07480003
074900                   OR (SQLCODE = +100))                           07490003
075000                                                                  07500003
075100         EXEC SQL                                                 07510003
075200            SELECT  PO_NBR                                        07520003
075300              INTO  :PURCHS-PO-NBR                                07530003
075400              FROM  TPURCHS                                       07540003
075500             WHERE  PO_NBR         = :DK-PO-NBR                   07550003
075600               AND  VER_STATUS_CDE = :PC-ACTIVE                   07560003
075700         END-EXEC                                                 07570003
075800                                                                  07580003
075900         EVALUATE TRUE                                            07590003
076000             WHEN SQLCODE = +0                                    07600003
076100             WHEN SQLCODE = +100                                  07610003
076200             WHEN SQLCODE = -904                                  07620003
076300             WHEN SQLCODE = -913                                  07630003
076400                 CONTINUE                                         07640003
076500                                                                  07650003
076600             WHEN SQLWARN0 NOT = SPACES                           07660003
076700             WHEN SQLCODE < +0                                    07670003
076800             WHEN SQLCODE > +0                                    07680003
076900                 MOVE '3500-VALIDATE-PO-NBR'                      07690003
077000                                   TO DP013-PARAGRAPH             07700003
077100                 MOVE 'SELECT PURCHASE ORDER NUMBER'              07710003
077200                                   TO DP013-MESSAGE-TEXT (1)      07720003
077300                 MOVE SQLCA        TO DP013-SQLCA                 07730003
077400                 MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)    07740003
077500                 SET DP013-DB2-ABEND                              07750003
077600                                   TO TRUE                        07760003
077700                 SET DP013-XCTL-DISPLAY-RESTART                   07770003
077800                                   TO TRUE                        07780003
077900                 PERFORM DP013-0000-PROCESS-ABEND                 07790003
078000         END-EVALUATE                                             07800003
078100     END-PERFORM.                                                 07810003
078200                                                                  07820003
078300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07830003
078400         MOVE '3500-VALIDATE-PO-NBR'                              07840003
078500                                   TO DP013-PARAGRAPH             07850003
078600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     07860003
078700                                   TO DP013-MESSAGE-TEXT (1)      07870003
078800         MOVE 'PURCHASE ORDER'     TO DP013-MESSAGE-TEXT (2)      07880003
078900         MOVE SQLCA                TO DP013-SQLCA                 07890003
079000         MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)    07900003
079100         SET DP013-DB2-ABEND       TO TRUE                        07910003
079200         SET DP013-XCTL-DISPLAY-RESTART                           07920003
079300                                   TO TRUE                        07930003
079400         PERFORM DP013-0000-PROCESS-ABEND                         07940003
079500     END-IF.                                                      07950003
079600                                                                  07960003
079700     IF SQLCODE = +100                                            07970003
079800         SET PS-ERROR                                             07980003
079900             DP020-MSG-FATAL       TO TRUE                        07990003
080000         MOVE PC-TSYMSG-00083      TO DP020-MSG-NUMBER            08000003
080100         MOVE DP015-UNP-NUM-BRT-OFF                               08010003
080200                                   TO APOA                        08020003
080300         MOVE DP015-RED            TO APOC                        08030003
080400         MOVE DP015-REVERSE        TO APOH                        08040003
080500         MOVE -1                   TO APOL                        08050003
080600         SET DP030-SET-CURSOR-APPL-1                              08060003
080700                                   TO TRUE                        08070003
080800     END-IF.                                                      08080003
080900                                                                  08090003
081000*----------------------------------------------------------------*08100003
081100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *08110003
081200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *08120003
081300*  IT HERE.                                                      *08130003
081400*----------------------------------------------------------------*08140003
081500 4000-BUILD-INITIAL-PANEL.                                        08150003
081600                                                                  08160003
081700     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        08170003
081800     MOVE -1                       TO APOL.                       08180003
081900     MOVE DP020-LOCATION-NBR       TO PV-LOCATION.                08190008
082000     MOVE PV-OPER-UNT-ID-N         TO ASC-OPER-UNT-ID-N           08200007
082100                                      AOPERO.                     08210003
082200     MOVE PC-1                     TO ASC-FCLTY-ID-N              08220007
082300                                      AFCLTYO.                    08230003
082400     MOVE PC-X                     TO AACO                        08240003
082500                                      AINO.                       08250003
082600     MOVE PC-AC                    TO ASC-AC-STAT                 08260003
082700     MOVE PC-IN                    TO ASC-IN-STAT.                08270003
082800                                                                  08280003
082900     PERFORM 3300-CHECK-OPER-UNT-GET-NAME.                        08290007
083000                                                                  08300003
083100*----------------------------------------------------------------*08310003
083200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *08320003
083300*----------------------------------------------------------------*08330003
083400 4400-MOVE-COMMAREA-TO-SCREEN.                                    08340003
083500                                                                  08350003
083600     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     08360003
083700     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    08370003
083800     MOVE ASC-PO-NBR               TO APOO.                       08380003
083900                                                                  08390003
084000     IF ASC-AC-STAT > SPACES                                      08400003
084100         MOVE PC-X                 TO AACO                        08410003
084200     END-IF.                                                      08420003
084300                                                                  08430003
084400     IF ASC-IN-STAT > SPACES                                      08440003
084500         MOVE PC-X                 TO AINO                        08450003
084600     END-IF.                                                      08460003
084700                                                                  08470003
084800     IF ASC-IP-STAT > SPACES                                      08480003
084900         MOVE PC-X                 TO AIPO                        08490003
085000     END-IF.                                                      08500003
085100                                                                  08510003
085200     IF ASC-CM-STAT > SPACES                                      08520003
085300         MOVE PC-X                 TO ACMO                        08530003
085400     END-IF.                                                      08540003
085500                                                                  08550003
085600     IF ASC-VE-STAT > SPACES                                      08560003
085700         MOVE PC-X                 TO AVEO                        08570003
085800     END-IF.                                                      08580003
085900                                                                  08590003
086000     MOVE ASC-PKSL-NBR             TO APKSLIPO.                   08600003
086100     MOVE ASC-BOL-NBR              TO ABOLO.                      08610003
086200     MOVE ASC-PRO-NBR              TO AFBO.                       08620003
086300     MOVE ASC-REC-SEQ-NBR          TO ARECSEQO.                   08630003
086400 EJECT                                                            08640003
086500*----------------------------------------------------------------*08650003
086600*    ABEND PROCESSOR MODULE                                      *08660003
086700*----------------------------------------------------------------*08670003
086800                                                                  08680003
086900     COPY DPPD013.                                                08690006
