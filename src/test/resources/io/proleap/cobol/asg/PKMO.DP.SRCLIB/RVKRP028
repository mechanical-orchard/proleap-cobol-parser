000100 IDENTIFICATION DIVISION.                                         00010038
000200                                                                  00020038
000300 PROGRAM-ID.             RVKRP028.                                00030038
000400 AUTHOR.                 JOHN HUTCHINSON.                         00040038
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050038
000600 DATE-WRITTEN.           JULY 2011.                               00060038
000700 DATE-COMPILED.                                                   00070038
000800                                                                  00080038
000900*                                                                 00090038
001000*-----------------------------------------------------------------00100038
001100* DATE:        10/30/2011                                         00110038
001200* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00120038
001300* WR/IR#:      WR40134                                            00130038
001400* PROGRAMMER:  JOHN HUTCHINSON                                    00140038
001500*                                                                 00150038
001600*  PROGRAM NARRATIVE:                                             00160038
001700*  THIS PROGRAM WILL CREATE A REPORT OF ERRORS CREATED BY THE     00170038
001800*  GENCO TRANSFER POSITIVE RECEIPT FILE CREATE IN RVKUT037.       00180038
001900*--------------------------------------------------------------*  00190038
002100                                                                  00200038
002200 ENVIRONMENT DIVISION.                                            00210038
002300                                                                  00220038
002400 CONFIGURATION SECTION.                                           00230038
002500                                                                  00240038
002600 SOURCE-COMPUTER.                        IBM-3090.                00250038
002700 OBJECT-COMPUTER.                        IBM-3090.                00260038
002800                                                                  00270038
002900 INPUT-OUTPUT SECTION.                                            00280038
003000                                                                  00290038
003100 FILE-CONTROL.                                                    00300038
003200                                                                  00310038
003300     SELECT GENCO-TPR-ERROR-FILE     ASSIGN TO INP01.             00320038
003400                                                                  00330038
003500     SELECT GENCO-TPR-ERROR-REPORT   ASSIGN TO RPT01.             00340038
003600                                                                  00350038
003700******************************************************************00360038
003800 DATA DIVISION.                                                   00370038
003900******************************************************************00380038
004000                                                                  00390038
004100 FILE SECTION.                                                    00400038
004200                                                                  00410038
004300 FD  GENCO-TPR-ERROR-FILE                                         00420038
004400     RECORDING MODE IS F                                          00430038
004500     LABEL RECORDS ARE STANDARD                                   00440038
004600     BLOCK CONTAINS 0 RECORDS.                                    00450038
004610                                                                  00460038
004700 01  GENCO-TPR-ERROR-FILE-RECORD      PIC  X(150).                00470038
004800                                                                  00480038
004900 FD  GENCO-TPR-ERROR-REPORT                                       00490038
005000     RECORDING MODE IS F                                          00500038
005100     LABEL RECORDS ARE STANDARD                                   00510038
005200     BLOCK CONTAINS 0 RECORDS.                                    00520038
005210                                                                  00530038
005300 01  GENCO-TPR-REPORT-RECORD          PIC  X(132).                00540038
005400                                                                  00550038
005500                                                                  00560038
005600 WORKING-STORAGE SECTION.                                         00570038
032523                                                                  00580038
W40134**  CMS 10/30/2011  BEG                                           00590041
W40134***************************************************************** 00600041
W40134*    CONTROL CARD INPUT                                           00610041
W40134***************************************************************** 00620041
W40134 01  CC-CONTROL-CARD.                                             00630041
W40134     05  CC-LOC                       PIC X(04).                  00640041
W40134     05  FILLER REDEFINES CC-LOC.                                 00650041
W40134         10  CC-RTV-LOCATION          PIC 9(04).                  00660041
W40134     05  FILLER                       PIC X(76).                  00670041
W40134                                                                  00680041
W40134**  CMS 10/30/2011  END                                           00690041
032526                                                                  00700038
032527******************************************************************00710038
032528**   COMMUNICATIONS AREA FOR DB2                                  00720038
032529******************************************************************00730038
032530     EXEC SQL                                                     00740038
032531          INCLUDE SQLCA                                           00750038
032532     END-EXEC.                                                    00760038
032533                                                                  00770038
032534******************************************************************00780038
032535**   DB2 FORMATTED MESSAGE AREA                                   00790038
032536******************************************************************00800038
032537     COPY DPWS004.                                                00810038
032538                                                                  00820038
032539***************************************************************** 00830038
032540**   TCOCNTL TABLE                                                00840038
032541***************************************************************** 00850038
032542     EXEC SQL                                                     00860038
032543          INCLUDE TCOCNTL                                         00870038
032544     END-EXEC.                                                    00880038
032545                                                                  00890038
032546******************************************************************00900038
032547**   DB2 TABLE DECLARATION - LOGISTICS - DC LOCATION.             00910038
032548**   (XLT_LOC).                                                   00920038
032549******************************************************************00930038
032550     EXEC SQL                                                     00940038
032551          INCLUDE XLT00010                                        00950038
032552     END-EXEC.                                                    00960038
032553                                                                  00970038
032554******************************************************************00980038
032555**   RVRD059 ERROR RECORD                                         00990038
032556******************************************************************01000038
032557     COPY RVRD059.                                                01010038
032558                                                                  01020038
032559***************************************************************** 01030038
032560**   PROGRAM CONSTANTS                                            01040038
032561***************************************************************** 01050038
032562 01  PC-CONSTANTS.                                                01060038
032563     05  PC-CURRENT-PGM               PIC  X(08) VALUE 'RVKRP028'.01070038
032564     05  PC-TOTL-LIMIT                PIC  9(02) VALUE 55.        01080038
032565     05  PC-ONE                       PIC  9(01) VALUE 1.         01090038
032566                                                                  01100038
032567***************************************************************** 01110038
032568**   PROGRAM SWITCHES                                             01120038
032569***************************************************************** 01130038
032570 01  PS-SWITCHES.                                                 01140038
032571     05  PS-END-OF-FILE-SWITCH       PIC  X(01) VALUE 'N'.        01150038
032572         88  PS-EOF                             VALUE 'Y'.        01160038
032573         88  PS-NOT-EOF                         VALUE 'N'.        01170038
032574                                                                  01180038
032575***************************************************************** 01190038
032576**   PROGRAM VARIABLES                                            01200038
032577***************************************************************** 01210038
032578 01  PV-VARIABLES.                                                01220038
032579     05  PV-RPT-LINE-CNT             PIC 9(03)  VALUE 60.         01230038
032580     05  PV-RPT-PAGE-CNT             PIC 9(03)  VALUE ZEROS.      01240038
032581     05  PV-RECORDS-READ             PIC S9(07) VALUE +0 COMP-3.  01250038
032582     05  PV-RECORDS-WRITTEN          PIC S9(07) VALUE +0 COMP-3.  01260038
032583     05  PV-LOC-NBR                  PIC S9(04) VALUE +0 COMP.    01270038
032584     05  PV-LOC-NAME                 PIC X(10)  VALUE SPACE.      01280038
032585     05  PV-PD-DTE.                                               01290038
032586         10  PV-PD-CY                PIC 9(04)  VALUE ZERO.       01300038
032587         10  FILLER                  PIC X(01).                   01310038
032588         10  PV-PD-MM                PIC 9(02)  VALUE ZERO.       01320038
032589         10  FILLER                  PIC X(01).                   01330038
032590         10  PV-PD-DD                PIC 9(02)  VALUE ZERO.       01340038
032591     05  PV-PD2-DTE.                                              01350038
032592         10  PV-PD2-MM               PIC 9(02)  VALUE ZERO.       01360038
032593         10  PV-PD2-DASH1            PIC X(01)  VALUE '-'.        01370038
032594         10  PV-PD2-DD               PIC 9(02)  VALUE ZERO.       01380038
032595         10  PV-PD2-DASH2            PIC X(01)  VALUE '-'.        01390038
032596         10  PV-PD2-CY               PIC 9(04)  VALUE ZERO.       01400038
032597     05  PV-TIMESTAMP                PIC X(26)  VALUE SPACE.      01410038
032598     05  FILLER                      REDEFINES                    01420038
032599         PV-TIMESTAMP.                                            01430038
032600         10  PV-TIMESTAMP-CCYY       PIC 9(4).                    01440038
032601         10  PV-TIMESTAMP-DASH1      PIC X.                       01450038
032602         10  PV-TIMESTAMP-MONTH      PIC 9(2).                    01460038
032603         10  PV-TIMESTAMP-DASH2      PIC X.                       01470038
032604         10  PV-TIMESTAMP-DAY        PIC 9(2).                    01480038
032605         10  PV-TIMESTAMP-PERIOD1    PIC X.                       01490038
032606         10  PV-TIMESTAMP-HOUR       PIC 9(2).                    01500038
032607         10  PV-TIMESTAMP-PERIOD2    PIC X.                       01510038
032608         10  PV-TIMESTAMP-MINUTES    PIC 9(2).                    01520038
032609         10  PV-TIMESTAMP-PERIOD3    PIC X.                       01530038
032610         10  PV-TIMESTAMP-SECONDS    PIC 9(2).                    01540038
032611         10  PV-TIMESTAMP-PERIOD4    PIC X.                       01550038
032612         10  PV-TIMESTAMP-HUND-SEC   PIC 9(6).                    01560038
032613     05  PV-ABEND-PARAGRAPH          PIC X(35)  VALUE SPACE.      01570038
032614     05  PV-ABEND-CODE               PIC S9(04) VALUE +0 COMP.    01580038
032615     05  PV-ERROR-MSG                PIC X(60) VALUE SPACE.       01590038
032616     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       01600038
032617     05  PV-ABEND-MESSAGE            PIC X(30) VALUE SPACE.       01610038
032618     05  PV-SQLCODE                  PIC S9(9) VALUE +0.          01620038
032619     05  PV-ABEND-TABLE-1            PIC X(20) VALUE SPACE.       01630038
032620     05  PV-TRANSFER-NUMBER          PIC 9(10)  VALUE ZEROS.      01640039
032630     05  FILLER                      REDEFINES                    01650039
032640         PV-TRANSFER-NUMBER.                                      01660039
032650         10  PV-TRANSFER-NUM-STR     PIC 9(04).                   01670040
032651         10  PV-TRANSFER-NUM-SEQ     PIC 9(06).                   01680040
032652                                                                  01690038
032653 01  SYSTEM-DATE-TIME.                                            01700038
032654     05  SD-SYSTEM-DATE.                                          01710038
032655         10  SD-CD-CCYY              PIC 9(04) VALUE ZEROS.       01720038
032656         10  SD-CD-MM                PIC 9(02) VALUE ZEROS.       01730038
032657         10  SD-CD-DD                PIC 9(02) VALUE ZEROS.       01740038
032658     05  ST-SYSTEM-TIME.                                          01750038
032659         10  ST-CT-HH                PIC 9(02) VALUE ZEROS.       01760038
032660         10  ST-CT-MM                PIC 9(02) VALUE ZEROS.       01770038
032661         10  FILLER                  PIC 9(04) VALUE ZEROS.       01780038
032662                                                                  01790038
032663***************************************************************** 01800038
032664**   STANDARD HEADING LAYOUT - 132 COLUMNS                        01810038
032665***************************************************************** 01820038
032666     COPY DPWS132.                                                01830038
032667                                                                  01840038
032668 01  PH1-PAGE-HEADING.                                            01850038
032669     05  FILLER                      PIC X(47)  VALUE SPACE.      01860038
032670     05  FILLER                      PIC X(52)  VALUE             01870038
032671         'ERRORS PROCESSING POSITIVE RECEIPTS DATA '.             01880038
032672     05  FILLER                      PIC X(40)  VALUE SPACE.      01890038
032673                                                                  01900038
032674 01  PH2-PAGE-HEADING-2.                                          01910038
032675     05  FILLER                      PIC X(54)  VALUE SPACE.      01920038
032676     05  FILLER                      PIC X(16)  VALUE             01930038
032677         'PROCESSING DATE '.                                      01940038
032678     05  PH2-DATE.                                                01950038
032679         10  PH2-DATE-MM-1           PIC X(02)  VALUE SPACE.      01960038
032680         10  FILLER                  PIC X(01)  VALUE '/'.        01970038
032681         10  PH2-DATE-DD-1           PIC X(02)  VALUE SPACE.      01980038
032682         10  FILLER                  PIC X(01)  VALUE '/'.        01990038
032683         10  PH2-DATE-CY-1           PIC X(04)  VALUE SPACE.      02000038
032684     05  FILLER                      PIC X(52)  VALUE SPACE.      02010038
032685                                                                  02020038
032686 01  PH3-PAGE-HEADING-3.                                          02030038
032687     05  FILLER                      PIC X(17)  VALUE             02040038
032688         '  RTV LOCATION:  '.                                     02050038
032689     05  PH3-RTV-LOC                 PIC X(04)  VALUE SPACE.      02060038
032690     05  FILLER                      PIC X(02)  VALUE SPACE.      02070038
032691     05  PH3-RTV-NAME                PIC X(10)  VALUE SPACE.      02080038
032692                                                                  02090038
032693 01  DH1-DETAIL-HEADING-1.                                        02100038
032694     05  FILLER                      PIC X(2)   VALUE SPACE.      02110038
032695     05  FILLER                      PIC X(11)  VALUE             02120038
032696                                     'TRANSFER'.                  02130038
032697     05  FILLER                      PIC X(10)  VALUE             02140038
032698                                     'TRANSFER'.                  02150038
032699     05  FILLER                      PIC X(14)  VALUE             02160038
032700                                     'TRANSFER LOC'.              02170038
032701     05  FILLER                      PIC X(14)  VALUE             02180038
032702                                     'TRANSFER LOC'.              02190038
032703     05  FILLER                      PIC X(11)  VALUE             02200038
032704                                     'RECEIVED'.                  02210038
032705     05  FILLER                      PIC X(13)  VALUE             02220038
032706                                     'EXPECTED'.                  02230038
032707     05  FILLER                      PIC X(9)   VALUE             02240038
032708                                     'EXPECTED'.                  02250038
032709     05  FILLER                      PIC X(47)  VALUE SPACE.      02260038
032710                                                                  02270038
032711 01  DH2-DETAIL-HEADING-2.                                        02280038
032712     05  FILLER                      PIC X(3)   VALUE SPACE.      02290038
032713     05  FILLER                      PIC X(12)  VALUE             02300038
032714                                     'NUMBER'.                    02310038
032715     05  FILLER                      PIC X(09)  VALUE             02320038
032716                                     'TYPE'.                      02330038
032717     05  FILLER                      PIC X(14)  VALUE             02340038
032718                                     'CREATED FOR'.               02350038
032719     05  FILLER                      PIC X(14)  VALUE             02360038
032720                                     'RECEIVED'.                  02370038
032721     05  FILLER                      PIC X(11)  VALUE             02380038
032722                                     'DATE'.                      02390038
032723     05  FILLER                      PIC X(12)  VALUE             02400038
032724                                     'RETAIL'.                    02410038
032725     05  FILLER                      PIC X(13)  VALUE             02420038
032726                                     'UNITS'.                     02430038
032727     05  FILLER                      PIC X(13)  VALUE             02440038
032728                                     'ERROR MESSAGE'.             02450038
032729     05  FILLER                      PIC X(47)  VALUE SPACE.      02460038
032730                                                                  02470038
032731 01  DL-DETAIL-LINE.                                              02480038
032732     05  FILLER                      PIC X(02)  VALUE SPACE.      02490038
032733     05  DL-TRANSFER-NUMBER          PIC X(10)  VALUE SPACE.      02500038
032734     05  FILLER                      PIC X(04)  VALUE SPACE.      02510038
032735     05  DL-TRANSFER-TYPE            PIC X(02)  VALUE SPACE.      02520038
032736     05  FILLER                      PIC X(08)  VALUE SPACE.      02530038
032737     05  DL-TO-STORE                 PIC X(04)  VALUE SPACE.      02540038
032738     05  FILLER                      PIC X(10)  VALUE SPACE.      02550038
032739     05  DL-ACTUAL-STORE             PIC X(04)  VALUE SPACE.      02560038
032740     05  FILLER                      PIC X(07)  VALUE SPACE.      02570038
032741     05  DL-RECEIVED-DATE            PIC X(10)  VALUE SPACE.      02580038
032742     05  FILLER                      PIC X(02)  VALUE SPACE.      02590038
032743     05  DL-EXPECTED-RETAIL          PIC ZZZ,Z99.99.              02600038
032744     05  DL-EXPECTED-RETAIL-X        REDEFINES                    02610038
032745         DL-EXPECTED-RETAIL          PIC X(10)  JUST RIGHT.       02620038
032746     05  FILLER                      PIC X(02)  VALUE SPACE.      02630038
032747     05  DL-EXPECTED-UNITS           PIC Z,ZZ9.                   02640038
032748     05  DL-EXPECTED-UNITS-X         REDEFINES                    02650038
032749         DL-EXPECTED-UNITS           PIC X(5)   JUST RIGHT.       02660038
032750     05  FILLER                      PIC X(04)  VALUE SPACE.      02670038
032751     05  DL-ERROR-MESSAGE            PIC X(35)  VALUE SPACE.      02680038
032752                                                                  02690038
032753 01  DL-BLANK-LINE.                                               02700038
032754     05  FILLER                      PIC X(132) VALUE SPACE.      02710038
032755                                                                  02720038
032756 01  END-OF-REPORT-LINE.                                          02730038
032757     05  FILLER                      PIC X(31)  VALUE SPACE.      02740038
032758     05  FILLER                      PIC X(26)  VALUE             02750038
032759         '************************* '.                            02760038
032760     05  FILLER                      PIC X(14)  VALUE             02770038
032761         'END OF REPORT '.                                        02780038
032762     05  FILLER                      PIC X(26)  VALUE             02790038
032763         '************************* '.                            02800038
032764                                                                  02810038
032765 01  NO-DATA-REPORT-LINE.                                         02820038
032766     05  FILLER                      PIC X(42)  VALUE SPACE.      02830038
032767     05  FILLER                      PIC X(48)  VALUE             02840038
032768         '*************  NO DATA TO REPORT  **************'.      02850038
032769     05  FILLER                      PIC X(42)  VALUE SPACE.      02860038
032770                                                                  02870038
032771 LINKAGE SECTION.                                                 02880038
032772                                                                  02890038
032773 PROCEDURE DIVISION.                                              02900038
032774                                                                  02910038
032775***************************************************************** 02920038
032776**   MAINLINE LOGIC FOR PROGRAM                                   02930038
032777***************************************************************** 02940038
032778                                                                  02950038
032779 0000-MAINLINE.                                                   02960038
032780                                                                  02970038
032781     PERFORM 1000-INITIALIZE.                                     02980038
032782                                                                  02990038
032783     PERFORM 2000-PROCESS                                         03000038
032784         UNTIL PS-EOF.                                            03010038
032785                                                                  03020038
032786     PERFORM 9000-EOJ.                                            03030038
032787                                                                  03040038
032788     GOBACK.                                                      03050038
032789                                                                  03060038
032790***************************************************************** 03070038
032791**   INITIALIZATION PARAGRAPH                                     03080038
032792***************************************************************** 03090038
032793                                                                  03100038
032794 1000-INITIALIZE.                                                 03110038
032795                                                                  03120038
032796     OPEN  INPUT GENCO-TPR-ERROR-FILE                             03130038
032797          OUTPUT GENCO-TPR-ERROR-REPORT.                          03140038
032798                                                                  03150038
032799     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           03160038
032800                                                                  03170038
W40134**   CMS 10/30/2011  BEG                                          03180041
W40134     IF CC-RTV-LOCATION IS NUMERIC AND                            03190041
W40134        CC-RTV-LOCATION IS GREATER THAN ZERO                      03200041
W40134         MOVE CC-RTV-LOCATION TO PV-LOC-NBR                       03210041
W40134         PERFORM 3000-VALIDATE-LOCATION                           03220041
W40134         MOVE PV-LOC-NBR  TO PH3-RTV-LOC                          03230041
W40134         MOVE PV-LOC-NAME TO PH3-RTV-NAME                         03240041
W40134     ELSE                                                         03250041
W40134         DISPLAY '*************************************'          03260041
W40134         DISPLAY '**              ABEND              **'          03270041
W40134         DISPLAY '** PROGRAM   = RVKRP028            **'          03280041
W40134         DISPLAY '** INPUT CNTL CARD LOCATION IS     **'          03290041
W40134         DISPLAY '** INVALID.                        **'          03300041
W40134         DISPLAY '**                                 **'          03310041
W40134         DISPLAY '** C.C.  RTV LOCATION : ' CC-RTV-LOCATION       03320041
W40134         DISPLAY '*************************************'          03330041
W40134         MOVE +4019 TO PV-ABEND-CODE                              03340041
W40134         CALL 'ILBOABN0' USING PV-ABEND-CODE                      03350041
W40134     END-IF.                                                      03360041
W40134**   CMS 10/30/2011  END                                          03370041
037316                                                                  03380038
037317     MOVE FUNCTION CURRENT-DATE (1:8) TO  SD-SYSTEM-DATE.         03390038
037318     MOVE FUNCTION CURRENT-DATE (9:6) TO  ST-SYSTEM-TIME.         03400038
037319                                                                  03410038
037320     MOVE SD-CD-CCYY       TO DP132-RUN-YEAR.                     03420038
037321     MOVE SD-CD-MM         TO DP132-RUN-MONTH.                    03430038
037322     MOVE SD-CD-DD         TO DP132-RUN-DAY.                      03440038
037323     MOVE ST-CT-HH         TO DP132-RUN-HOUR.                     03450038
037324     MOVE ST-CT-MM         TO DP132-RUN-MINUTE.                   03460038
037325     MOVE PC-CURRENT-PGM   TO DP132-PROGRAM-NAME.                 03470038
037326     MOVE PC-ONE           TO DP132-REPORT-NUMBER.                03480038
037327     MOVE DP132-RUN-DATE   TO PH2-DATE.                           03490038
037328                                                                  03500038
037329     PERFORM 5000-SELECT-TCOCNTL.                                 03510038
037330                                                                  03520038
037331     MOVE COCNTL-BTCH-PRC-DTE TO PV-PD-DTE.                       03530038
037332                                                                  03540038
037333     MOVE PV-PD-MM TO PH2-DATE-MM-1.                              03550038
037334     MOVE PV-PD-DD TO PH2-DATE-DD-1.                              03560038
037335     MOVE PV-PD-CY TO PH2-DATE-CY-1.                              03570038
037336                                                                  03580038
037337     PERFORM 4000-READ-FILE.                                      03590038
037338                                                                  03600038
037339     IF PS-EOF                                                    03610038
037340         PERFORM 6000-WRITE-HEADINGS                              03620038
037341         WRITE GENCO-TPR-REPORT-RECORD                            03630038
037342             FROM NO-DATA-REPORT-LINE AFTER ADVANCING 3 LINES     03640038
037343     END-IF.                                                      03650038
037344                                                                  03660038
037345***************************************************************** 03670038
037346**   PROCESS EACH CONTROL OR DETAIL ERROR RECORD.                 03680038
037347**   WRITE THE REPORT AND READ THE NEXT RECORD.                   03690038
037348***************************************************************** 03700038
037349                                                                  03710038
037350 2000-PROCESS.                                                    03720038
037351                                                                  03730038
037352     EVALUATE TRUE                                                03740038
037353         WHEN RV059-RECORD-TYPE-CONTROL                           03750038
037354             MOVE RV059-CTL-RECEIVED-STR-NBR TO PV-LOC-NBR        03760038
037355             PERFORM 3000-VALIDATE-LOCATION                       03770038
037356             MOVE PV-LOC-NBR                 TO PH3-RTV-LOC       03780038
037357             MOVE PV-LOC-NAME                TO PH3-RTV-NAME      03790038
037358             MOVE RV059-CTL-RECEIVED-STR-NBR TO DL-TO-STORE       03800038
037359             MOVE RV059-CTL-CREATE-TIMESTAMP TO PV-TIMESTAMP      03810038
037360             MOVE PV-TIMESTAMP-MONTH         TO PV-PD2-MM         03820038
037361             MOVE PV-TIMESTAMP-DAY           TO PV-PD2-DD         03830038
037362             MOVE PV-TIMESTAMP-CCYY          TO PV-PD2-CY         03840038
037363             MOVE PV-PD2-DTE                 TO DL-RECEIVED-DATE  03850038
037364             MOVE RV059-CTL-RECEIVED-STR-NBR TO PV-LOC-NBR        03860038
037365                                                                  03870038
037366             IF RV059-CTL-SUM-TOTAL-AMT IS NUMERIC                03880038
037367                 MOVE RV059-CTL-SUM-TOTAL-AMT                     03890038
037368                     TO DL-EXPECTED-RETAIL                        03900038
037369             ELSE                                                 03910038
037370                 MOVE RV059-CTL-SUM-TOTAL-AMT-X                   03920038
037371                     TO DL-EXPECTED-RETAIL-X                      03930038
037372             END-IF                                               03940038
037373                                                                  03950038
037374             IF RV059-CTL-SUM-TOTAL-UNITS IS NUMERIC              03960038
037375                 MOVE RV059-CTL-SUM-TOTAL-UNITS                   03970038
037376                     TO DL-EXPECTED-UNITS                         03980038
037377             ELSE                                                 03990038
037378                 MOVE RV059-CTL-SUM-TOTAL-UNITS-X                 04000038
037379                     TO DL-EXPECTED-UNITS-X                       04010038
037380             END-IF                                               04020038
037381             MOVE RV059-MESSAGE TO DL-ERROR-MESSAGE               04030038
037382             PERFORM 7000-WRITE-REPORT                            04040038
037383                                                                  04050038
037384         WHEN RV059-RECORD-TYPE-DETAIL                            04060038
037385             MOVE RV059-TIMESTAMP          TO PV-TIMESTAMP        04070038
037386             MOVE PV-TIMESTAMP-CCYY        TO PV-PD2-CY           04080038
037387             MOVE PV-TIMESTAMP-MONTH       TO PV-PD2-MM           04090038
037388             MOVE PV-TIMESTAMP-DAY         TO PV-PD2-DD           04100038
037389             MOVE PV-PD2-DTE               TO DL-RECEIVED-DATE    04110038
037400             MOVE RV059-TRANSFER-NBR-STR   TO PV-TRANSFER-NUM-STR 04120040
037500             MOVE RV059-TRANSFER-NBR-SEQ   TO PV-TRANSFER-NUM-SEQ 04130040
037501             MOVE PV-TRANSFER-NUMBER       TO DL-TRANSFER-NUMBER  04140039
037502             MOVE RV059-TRANSFER-TYPE-CODE TO DL-TRANSFER-TYPE    04150038
037503             MOVE RV059-TO-STORE-NBR       TO DL-TO-STORE         04160038
037504             MOVE RV059-ACTUAL-STORE-NBR   TO DL-ACTUAL-STORE     04170038
037505                                                                  04180038
037506             IF RV059-EXP-RETAIL-AMT IS NUMERIC                   04190038
037507                 MOVE RV059-EXP-RETAIL-AMT                        04200038
037508                     TO DL-EXPECTED-RETAIL                        04210038
037509             ELSE                                                 04220038
037510                 MOVE RV059-EXP-RETAIL-AMT-X                      04230038
037511                     TO DL-EXPECTED-RETAIL-X                      04240038
037512             END-IF                                               04250038
037513                                                                  04260038
037514             IF RV059-EXP-UNITS IS NUMERIC                        04270038
037515                 MOVE RV059-EXP-UNITS   TO DL-EXPECTED-UNITS      04280038
037516             ELSE                                                 04290038
037517                 MOVE RV059-EXP-UNITS-X TO DL-EXPECTED-UNITS-X    04300038
037518             END-IF                                               04310038
037519                                                                  04320038
037520             MOVE RV059-MESSAGE TO DL-ERROR-MESSAGE               04330038
037521             PERFORM 7000-WRITE-REPORT                            04340038
037522     END-EVALUATE.                                                04350038
037523                                                                  04360038
037524     PERFORM 4000-READ-FILE.                                      04370038
037525                                                                  04380038
037526                                                                  04390038
037527******************************************************************04400038
037528**   VALIDATE THE LOCATION, MOVE LOC, NAME TO REPORT              04410038
037529******************************************************************04420038
037530                                                                  04430038
037531 3000-VALIDATE-LOCATION.                                          04440038
037532                                                                  04450038
037533     INITIALIZE DCLXLT00010.                                      04460038
037700                                                                  04470038
037800     EXEC SQL                                                     04480038
037900         SELECT  LOC_NBR                                          04490038
038000                ,LOC_10_ABBR_NM                                   04500038
038100           INTO  :XLT00010-LOC-NBR                                04510038
038200                ,:XLT00010-LOC-10-ABBR-NM                         04520038
038300           FROM XLT_LOC                                           04530038
038400         WHERE LOC_TYP_CDE = 'RV' AND                             04540038
038500               LOC_NBR = :PV-LOC-NBR                              04550038
038600     END-EXEC.                                                    04560038
038700                                                                  04570038
038800     EVALUATE TRUE                                                04580038
038900         WHEN SQLCODE = +0                                        04590038
039000             MOVE XLT00010-LOC-10-ABBR-NM TO PV-LOC-NAME          04600038
039100             CONTINUE                                             04610038
039200         WHEN SQLCODE = +100                                      04620038
039300         WHEN SQLWARN0 NOT EQUAL SPACE                            04630038
039400         WHEN SQLCODE  NOT EQUAL ZERO                             04640038
039500             DISPLAY '------------------------------------'       04650038
039600             DISPLAY 'INVALID LOCATION FOUND  ' PV-LOC-NBR        04660038
039700             DISPLAY '------------------------------------'       04670038
039800     END-EVALUATE.                                                04680038
039900                                                                  04690038
040000******************************************************************04700038
040100**   READ GENCO ERROR FILE                                        04710038
040200******************************************************************04720038
040300                                                                  04730038
040400 4000-READ-FILE.                                                  04740038
040500                                                                  04750038
040600     READ GENCO-TPR-ERROR-FILE INTO RV059-ERROR-RECORD            04760038
040700         AT END                                                   04770038
040800             SET PS-EOF TO TRUE                                   04780038
040900     END-READ.                                                    04790038
041000                                                                  04800038
041100     IF PS-NOT-EOF                                                04810038
041200         ADD +1 TO PV-RECORDS-READ                                04820038
041300     END-IF.                                                      04830038
041400                                                                  04840038
041500******************************************************************04850038
041600**   READ THE CURRENT BATCH PROCESSING DATE FROM TCOCNTL          04860038
041700******************************************************************04870038
041800                                                                  04880038
041900 5000-SELECT-TCOCNTL.                                             04890038
042000                                                                  04900038
042100     MOVE '5000-SELECT-TCOCNTL'  TO PV-PARAGRAPH.                 04910038
042200                                                                  04920038
042300     EXEC SQL                                                     04930038
042400        SELECT  A.BTCH_PRC_DTE                                    04940038
042500          INTO :COCNTL-BTCH-PRC-DTE                               04950038
042600          FROM  TCOCNTL A                                         04960038
042700          WHERE A.OPER_UNT_ID   =  90                             04970038
042800     END-EXEC.                                                    04980038
042900                                                                  04990038
043000     EVALUATE TRUE                                                05000038
043100                                                                  05010038
043200         WHEN SQLCODE = ZEROS                                     05020038
043300             CONTINUE                                             05030038
043400         WHEN OTHER                                               05040038
043500             MOVE 'TCOCNTL' TO PV-ABEND-TABLE-1                   05050038
043600             PERFORM 9100-SQL-ERROR                               05060038
043700                                                                  05070038
043800     END-EVALUATE.                                                05080038
043900                                                                  05090038
044000******************************************************************05100038
044100**   WRITE THE REPORT HEADING LINES                               05110038
044200******************************************************************05120038
044300                                                                  05130038
044400 6000-WRITE-HEADINGS.                                             05140038
044500                                                                  05150038
044600     ADD PC-ONE           TO PV-RPT-PAGE-CNT.                     05160038
044700     MOVE PV-RPT-PAGE-CNT TO DP132-PAGE-NUMBER.                   05170038
044800                                                                  05180038
044900     WRITE GENCO-TPR-REPORT-RECORD                                05190038
045000         FROM DP132-STANDRD-HEADER-132-COLS AFTER ADVANCING PAGE. 05200038
045100                                                                  05210038
045200     WRITE GENCO-TPR-REPORT-RECORD                                05220038
045300         FROM PH1-PAGE-HEADING     AFTER ADVANCING 2 LINES.       05230038
045400                                                                  05240038
045500     WRITE GENCO-TPR-REPORT-RECORD                                05250038
045600         FROM PH2-PAGE-HEADING-2   AFTER ADVANCING 2 LINES.       05260038
045700                                                                  05270038
045800     WRITE GENCO-TPR-REPORT-RECORD                                05280038
045900         FROM PH3-PAGE-HEADING-3   AFTER ADVANCING 2 LINES.       05290038
046000                                                                  05300038
046100     WRITE GENCO-TPR-REPORT-RECORD                                05310038
046200         FROM DH1-DETAIL-HEADING-1 AFTER ADVANCING 2 LINES.       05320038
046300                                                                  05330038
046400     WRITE GENCO-TPR-REPORT-RECORD                                05340038
046500         FROM DH2-DETAIL-HEADING-2 AFTER ADVANCING 1 LINES.       05350038
046600                                                                  05360038
046700     WRITE GENCO-TPR-REPORT-RECORD                                05370038
046800         FROM DL-BLANK-LINE        AFTER ADVANCING 1 LINES.       05380038
046900                                                                  05390038
047000     MOVE 11 TO PV-RPT-LINE-CNT.                                  05400038
047100                                                                  05410038
047200***************************************************************** 05420038
047300**   WRITE THE REPORT DETAIL LINE                                 05430038
047400***************************************************************** 05440038
047500                                                                  05450038
047600 7000-WRITE-REPORT.                                               05460038
047700                                                                  05470038
047800     IF PV-RPT-LINE-CNT > PC-TOTL-LIMIT                           05480038
047900          PERFORM 6000-WRITE-HEADINGS                             05490038
048000     END-IF.                                                      05500038
048100                                                                  05510038
048200     WRITE GENCO-TPR-REPORT-RECORD                                05520038
048300         FROM DL-DETAIL-LINE AFTER ADVANCING 1 LINES.             05530038
048400                                                                  05540038
048500     WRITE GENCO-TPR-REPORT-RECORD                                05550038
048600         FROM DL-BLANK-LINE  AFTER ADVANCING 1 LINES.             05560038
048700                                                                  05570038
048800     ADD 2  TO PV-RPT-LINE-CNT.                                   05580038
048900     ADD 1  TO PV-RECORDS-WRITTEN.                                05590038
049000                                                                  05600038
049100                                                                  05610038
049200***************************************************************** 05620038
049300**   END OF JOB PROCESSING                                        05630038
049400***************************************************************** 05640038
049500                                                                  05650038
049600 9000-EOJ.                                                        05660038
049700                                                                  05670038
049800     WRITE GENCO-TPR-REPORT-RECORD                                05680038
049900         FROM END-OF-REPORT-LINE AFTER ADVANCING 3 LINES.         05690038
050000                                                                  05700038
050100     DISPLAY SPACES.                                              05710038
050200     DISPLAY '*************************************************'. 05720038
050300     DISPLAY '*****        RECORD COUNTS FOR RVKRP028    ******'. 05730038
050400     DISPLAY 'GENCO ERROR FILE RECS READ ==> ' PV-RECORDS-READ.   05740038
050500     DISPLAY SPACES.                                              05750038
050600     DISPLAY 'GENCO ERROR RECS WRITTEN   ==> ' PV-RECORDS-WRITTEN.05760038
050700     DISPLAY SPACES.                                              05770038
050800     DISPLAY '*************************************************'. 05780038
050900                                                                  05790038
051000     CLOSE GENCO-TPR-ERROR-FILE                                   05800038
051100           GENCO-TPR-ERROR-REPORT.                                05810038
051200                                                                  05820038
051300******************************************************************05830038
051400**   PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL  05840038
051500**   ERROR OR WARNING CODE OCCURS.                                05850038
051600******************************************************************05860038
051700                                                                  05870038
051800 9100-SQL-ERROR.                                                  05880038
051900                                                                  05890038
052000     DISPLAY '************************************************'.  05900038
052100     DISPLAY '********** PROGRAM ABEND ***********************'.  05910038
052200     DISPLAY '** PROGRAM       : ' PC-CURRENT-PGM.                05920038
052300     DISPLAY '** PARAGRAPH     : ' PV-PARAGRAPH.                  05930038
052400     DISPLAY '** TABLE         : ' PV-ABEND-TABLE-1.              05940038
052500     DISPLAY '** ERROR MESSAGE : ' PV-ERROR-MSG.                  05950038
052600     DISPLAY '***********************************************'.   05960038
052700                                                                  05970038
052800     MOVE +4013 TO PV-ABEND-CODE.                                 05980038
052900                                                                  05990038
053000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06000038
053100                                                                  06010038
053200*************  END OF RVKRP028  ********************************  06020038
