       IDENTIFICATION DIVISION.                                         00000100
00006  PROGRAM-ID.              MLKUT612.                               00000300
00008  INSTALLATION.            KOHLS DEPARTMENT STORES.                00000400
00009  DATE-WRITTEN.            10/30/2000.                             00000500
00010  DATE-COMPILED.                                                   00000600
00011                                                                   00000700
00012 ******************************************************************00000800
00013 *     FIRE DAMAGE PROCESSING MODULE                               00000900
00012 ******************************************************************00000800
PM3403* PM3403 - LARGER RETAIL EXPANSION PROJECT                        MLRD005O
PM3403* CHANGE 04/26/2012  RECOMPILE FOR EXPANSION OF MLRD005I/MLRD005O MLRD005O
00015 ******************************************************************00001100
00016 *                                                                 00001200
00019  ENVIRONMENT DIVISION.                                            00001500
00022  CONFIGURATION SECTION.                                           00001800
00024  SOURCE-COMPUTER. IBM-3090.                                       00002000
00025  OBJECT-COMPUTER. IBM-3090.                                       00002100
00028  INPUT-OUTPUT SECTION.                                            00002400
00030  FILE-CONTROL.                                                    00002600
00031                                                                   00002700
00032      SELECT FIRE-IN-FILE                                          00002800
00033          ASSIGN TO INP01.                                         00002900
00032      SELECT SKU-FILE                                              00003000
00033          ASSIGN TO INP02.                                         00003100
00035      SELECT CONVERTED-TRANSFER-FILE                               00003200
00036          ASSIGN TO OUT01.                                         00003300
00035      SELECT INVALIDS-FILE                                         00003400
00036          ASSIGN TO OUT02.                                         00003500
           SELECT  REPORT-FILE      ASSIGN RPT01.                       00003600
           SELECT  NEGATIVE-RPT-FILE ASSIGN RPT02.                      00003700
00037                                                                   00003800
00041  DATA DIVISION.                                                   00004100
00044  FILE SECTION.                                                    00004400
00045                                                                   00004500
00046  FD  FIRE-IN-FILE                                                 00004600
00047                                                                   00004700
00048      LABEL RECORDS ARE STANDARD                                   00004800
           RECORDING MODE IS F                                          00004900
00049      BLOCK CONTAINS 0 RECORDS.                                    00005000
00050                                                                   00005100
00051  01  FIRE-IN-RECORD                      PIC X(80).               00005200
00052                                                                   00005300
00046  FD  SKU-FILE                                                     00005400
00047                                                                   00005500
00048      LABEL RECORDS ARE STANDARD                                   00005600
           RECORDING MODE IS F                                          00005700
00049      BLOCK CONTAINS 0 RECORDS.                                    00005800
00050                                                                   00005900
00051  01  SKU-RECORD                          PIC X(80).               00006000
                                                                        00006100
00046  FD  CONVERTED-TRANSFER-FILE                                      00006200
           LABEL RECORDS ARE STANDARD                                   00006300
           RECORDING MODE IS F                                          00006400
           BLOCK CONTAINS 0 RECORDS.                                    00006500
00058  01  CONVERTED-TRANSFER-RECORD           PIC X(80).               00006600
00059                                                                   00006700
00053  FD  INVALIDS-FILE                                                00006800
00054                                                                   00006900
00055      LABEL RECORDS ARE STANDARD                                   00007000
           RECORDING MODE IS F                                          00007100
00056      BLOCK CONTAINS 0 RECORDS.                                    00007200
00057                                                                   00007300
00058  01  INVALIDS-RECORD                     PIC X(80).               00007400
00059                                                                   00007500
       FD  REPORT-FILE                                                  00007600
           RECORDING MODE F                                             00007700
           LABEL RECORDS OMITTED                                        00007800
           BLOCK CONTAINS  0 RECORDS.                                   00007900
       01  REPORT-RECORD.                                               00008000
           05  REPORT-LINE               PIC X(132).                    00008100
      *                                                                 00008200
       FD  NEGATIVE-RPT-FILE                                            00008300
           RECORDING MODE F                                             00008400
           LABEL RECORDS OMITTED                                        00008500
           BLOCK CONTAINS  0 RECORDS.                                   00008600
       01  NEGATIVE-RPT-RECORD.                                         00008700
           05  NEGATIVE-RPT-LINE         PIC X(132).                    00008800
      *                                                                 00008900
00060                                                                   00009000
00061  EJECT                                                            00009100
00062  WORKING-STORAGE SECTION.                                         00009200
00063                                                                   00009300
00070 ******************************************************************00009400
00071 *    RECORD LAYOUT FOR INPUT TRANSFER FILE FROM SCANNING SERVICE. 00009500
00072 ******************************************************************00009600
00073                                                                   00009700
00074      COPY MLRD005I.                                               00009800
00075                                                                   00009900
00070 ******************************************************************00010000
00071 *    RECORD LAYOUT FOR FSK - FSKST RECS                           00010100
00072 ******************************************************************00010200
00073                                                                   00010300
00074      COPY FSRDHOT.                                                00010400
00075                                                                   00010500
00076 ******************************************************************00010600
00077 *    OUTPUT RECORD LAYOUT FOR STORE TO STORE TRANSFERS.           00010700
00078 ******************************************************************00010800
00079                                                                   00010900
00080      COPY MLRD005O.                                               00011000
00081                                                                   00011100
00082 *                                                                 00011200
00131  01  PC-PROGRAM-CONSTANTS.                                        00011300
00107      05  PC-DOC-NO                PIC X(05)   VALUE '85811'.      00011400
00107      05  PC-MLKUT612-JOB          PIC X(08)   VALUE 'MLKUT612'.   00011500
00132      05  PC-TRANSFER-CODE         PIC 9(01)   VALUE 3.            00011600
           05  PC-MAX-LINES             PIC 9(03)   VALUE 60.           00011700
00132      05  PC-STORE-385             PIC 9(03)   VALUE 385.          00011800
00132      05  PC-STORE-811             PIC 9(03)   VALUE 811.          00011900
00132      05  PC-BATCH-300             PIC 9(03)   VALUE 300.          00012000
00094                                                                   00012100
00095  01  PA-PROGRAM-ACCUMULATORS.                                     00012200
           05  PA-LINE-COUNT           PIC S9(03)    COMP-3 VALUE 0.    00012300
           05  PA-LINE-NO              PIC S9(03)    COMP-3 VALUE 61.   00012400
           05  PA-PAGE-COUNT           PIC S9(05)    COMP-3 VALUE 0.    00012500
           05  PA-LINE-COUNT2          PIC S9(03)    COMP-3 VALUE 0.    00012600
           05  PA-LINE-NO2             PIC S9(03)    COMP-3 VALUE 61.   00012700
           05  PA-PAGE-COUNT2          PIC S9(05)    COMP-3 VALUE 0.    00012800
           05  PA-FIRE-RECS-READ       PIC S9(07)    COMP-3 VALUE 0.    00012900
           05  PA-SKUST-RECS-READ      PIC S9(07)    COMP-3 VALUE 0.    00013000
           05  PA-INV-RECS-WRITTEN     PIC S9(07)    COMP-3 VALUE 0.    00013100
           05  PA-XFER-RECS-WRITTEN    PIC S9(07)    COMP-3 VALUE 0.    00013200
           05  PA-SERVICE-QTY          PIC S9(07)    VALUE 0.           00013300
           05  PA-FS-QTY               PIC S9(07)    VALUE 0.           00013400
           05  PA-DIFF                 PIC S9(07)    VALUE 0.           00013500
           05  PA-RTL-AMT              PIC S9(07)V99  VALUE 0.          00013600
           05  PA-EXTD-RTL-AMT         PIC S9(07)V99  VALUE 0.          00013700
           05  PA-COST-AMT             PIC S9(07)V99  VALUE 0.          00013800
           05  PA-EXTD-COST-AMT        PIC S9(07)V99  VALUE 0.          00013900
           05  PA-SCL-SERVICE-QTY          PIC S9(07)    VALUE 0.       00013910
           05  PA-SCL-FS-QTY               PIC S9(07)    VALUE 0.       00013920
           05  PA-SCL-DIFF                 PIC S9(07)    VALUE 0.       00013930
           05  PA-SCL-RTL-AMT              PIC S9(07)V99  VALUE 0.      00013940
           05  PA-SCL-EXTD-RTL-AMT         PIC S9(07)V99  VALUE 0.      00013950
           05  PA-SCL-COST-AMT             PIC S9(07)V99  VALUE 0.      00013960
           05  PA-SCL-EXTD-COST-AMT        PIC S9(07)V99  VALUE 0.      00013970
                                                                        00014000
           05  PA-SERVICE-QTY2         PIC S9(07)    VALUE 0.           00014100
           05  PA-FS-QTY2              PIC S9(07)    VALUE 0.           00014200
           05  PA-DIFF2                PIC S9(07)    VALUE 0.           00014300
           05  PA-RTL-AMT2             PIC S9(07)V99  VALUE 0.          00014400
           05  PA-EXTD-RTL-AMT2        PIC S9(07)V99  VALUE 0.          00014500
           05  PA-COST-AMT2            PIC S9(07)V99  VALUE 0.          00014600
           05  PA-EXTD-COST-AMT2       PIC S9(07)V99  VALUE 0.          00014700
           05  PA-RPT-SERVICE-QTY      PIC S9(07)    VALUE 0.           00014800
           05  PA-RPT-FS-QTY           PIC S9(07)    VALUE 0.           00014900
           05  PA-RPT-DIFF             PIC S9(07)    VALUE 0.           00015000
           05  PA-RPT-RTL-AMT          PIC S9(07)V99  VALUE 0.          00015100
           05  PA-RPT-EXTD-RTL-AMT     PIC S9(07)V99  VALUE 0.          00015200
           05  PA-RPT-COST-AMT         PIC S9(07)V99  VALUE 0.          00015300
           05  PA-RPT-EXTD-COST-AMT    PIC S9(07)V99  VALUE 0.          00015400
           05  PA-RPT-SERVICE-QTY2     PIC S9(07)    VALUE 0.           00015500
           05  PA-RPT-FS-QTY2          PIC S9(07)    VALUE 0.           00015600
           05  PA-RPT-DIFF2            PIC S9(07)    VALUE 0.           00015700
           05  PA-RPT-RTL-AMT2         PIC S9(07)V99  VALUE 0.          00015800
           05  PA-RPT-EXTD-RTL-AMT2    PIC S9(07)V99  VALUE 0.          00015900
           05  PA-RPT-COST-AMT2        PIC S9(07)V99  VALUE 0.          00016000
           05  PA-RPT-EXTD-COST-AMT2   PIC S9(07)V99  VALUE 0.          00016100
                                                                        00016200
00099  01  PS-PROGRAM-SWITCHES.                                         00016300
00100      05  PS-MORE-INPUT-RECS-SW           PIC X(01)   VALUE 'Y'.   00016400
00101          88  PS-NO-MORE-INPUT-RECS                   VALUE 'N'.   00016500
00100      05  PS-MORE-SKU-RECS-SW             PIC X(01)   VALUE 'Y'.   00016600
00101          88  PS-NO-MORE-SKU-RECS                     VALUE 'N'.   00016700
00102      05  PS-VALID-UPC-SW                 PIC X(01)   VALUE 'N'.   00016800
00103          88  PS-VALID-UPC                            VALUE 'Y'.   00016900
00104          88  PS-INVALID-UPC                          VALUE 'N'.   00017000
00105                                                                   00017100
00106  01  PV-PROGRAM-VARIABLES.                                        00017200
00119      05  PV-DEPT-NBR                     PIC X(03)  VALUE SPACE.  00017300
00119      05  PV-SUB-CL-NBR                   PIC X(02)  VALUE SPACE.  00017310
00119      05  PV-DEPT-NBR2                    PIC X(03)  VALUE SPACE.  00017400
00116      05  PV-UNITS                        PIC S9(07) VALUE 0.      00018000
00116      05  PV-DIFF                         PIC S9(07) VALUE 0.      00018100
00116      05  PV-EXTD-COST-AMT                PIC S9(07)V99 VALUE +0.  00018200
00116      05  PV-EXTD-RTL-AMT                 PIC S9(07)V99 VALUE +0.  00018300
00128      05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 00018400
00130 *                                                                 00018500
00141  01  ABEND-CODE                          PIC S9(04)  VALUE +0.    00018600
      ***************************************************************** 00018700
      *  KOHL'S STANDARD FIRST HEADING LINE                             00018800
      ***************************************************************** 00018900
           COPY DPWS132O.                                               00019000
      *                                                                 00019100
       01  H2-HEADING2.                                                 00019200
           05  FILLER                PIC X(40)     VALUE SPACES.        00019300
           05  FILLER                PIC X(33)     VALUE                00019400
           '     FIRE UNITS REPORT'.                                    00019500
           05  FILLER                PIC X(28)     VALUE SPACES.        00019600
           05  FILLER                PIC X(05)     VALUE 'JOB: '.       00019700
           05  H2-JOB-NAME           PIC X(07)     VALUE SPACES.        00019800
           05  FILLER                PIC X(15)     VALUE SPACES.        00019900
                                                                        00020000
       01  H2-HEADING2-RPT2.                                            00020100
           05  FILLER                PIC X(60)     VALUE SPACES.        00020200
           05  FILLER                PIC X(21)     VALUE                00020300
           'NEGATIVE UNITS REPORT'.                                     00020400
           05  FILLER                PIC X(28)     VALUE SPACES.        00020500
           05  FILLER                PIC X(05)     VALUE 'JOB: '.       00020600
           05  H2-JOB-NAME2          PIC X(07)     VALUE SPACES.        00020700
           05  FILLER                PIC X(15)     VALUE SPACES.        00020800
                                                                        00020900
       01  H3-HEADING3.                                                 00021000
           05  FILLER                 PIC X(05).                        00021100
           05  FILLER                 PIC X(04)   VALUE 'DEPT'.         00021200
           05  FILLER                 PIC X(01).                        00021300
           05  FILLER                 PIC X(05)   VALUE 'SUBCL'.        00021400
           05  FILLER                 PIC X(01).                        00021500
           05  FILLER                 PIC X(03)   VALUE 'SEQ'.          00021600
           05  FILLER                 PIC X(05).                        00021700
           05  FILLER                 PIC X(07)   VALUE 'FASHION'.      00021800
           05  FILLER                 PIC X(02).                        00021900
           05  FILLER                 PIC X(05)   VALUE 'STORE'.        00022000
           05  FILLER                 PIC X(03).                        00022100
           05  FILLER                 PIC X(10)   VALUE 'DIFFERENCE'.   00022200
           05  FILLER                 PIC X(05).                        00022300
           05  FILLER                 PIC X(06)   VALUE 'RETAIL'.       00022400
           05  FILLER                 PIC X(06).                        00022500
           05  FILLER                 PIC X(08)   VALUE 'EXTENDED'.     00022600
           05  FILLER                 PIC X(05).                        00022700
           05  FILLER                 PIC X(08)   VALUE 'COST AMT'.     00022800
           05  FILLER                 PIC X(07).                        00022900
           05  FILLER                 PIC X(08)   VALUE 'EXTENDED'.     00023000
           05  FILLER                 PIC X(09).                        00023100
                                                                        00023200
       01  H4-HEADING4.                                                 00023300
           05  FILLER                 PIC X(22).                        00023400
           05  FILLER                 PIC X(08)   VALUE 'QUANTITY'.     00023500
           05  FILLER                 PIC X(01).                        00023600
           05  FILLER                 PIC X(08)   VALUE 'QUANTITY'.     00023700
           05  FILLER                 PIC X(17).                        00023800
           05  FILLER                 PIC X(06)   VALUE 'AMOUNT'.       00023900
           05  FILLER                 PIC X(04).                        00024000
           05  FILLER                 PIC X(11)   VALUE 'RETAIL AMT'.   00024100
           05  FILLER                 PIC X(20).                        00024200
           05  FILLER                 PIC X(08)   VALUE 'COST AMT'.     00024300
           05  FILLER                 PIC X(30).                        00024400
                                                                        00024500
       01  DL1-DETAIL-LINE.                                             00024600
           05  FILLER                 PIC X(05).                        00024700
           05  DL1-DEPT               PIC X(03).                        00024800
           05  FILLER                 PIC X(02).                        00024900
           05  DL1-SUB-CL-NBR         PIC X(02).                        00025000
           05  FILLER                 PIC X(04).                        00025100
           05  DL1-SEQ                PIC X(03).                        00025200
           05  FILLER                 PIC X(02).                        00025300
           05  DL1-FS-QTY             PIC ZZZZZZ9-.                     00025400
           05  FILLER                 PIC X(03).                        00025500
           05  DL1-SERVICE-QTY        PIC ZZZZZZ9-.                     00025600
           05  FILLER                 PIC X(03).                        00025700
           05  DL1-DIFF               PIC ZZZZZZ9-.                     00025800
           05  FILLER                 PIC X(03).                        00025900
           05  DL1-RTL-AMT            PIC ZZZZZZ9.99-.                  00026000
           05  FILLER                 PIC X(03).                        00026100
           05  DL1-EXTD-RTL-AMT       PIC ZZZZZZ9.99-.                  00026200
           05  FILLER                 PIC X(03).                        00026300
           05  DL1-COST-AMT           PIC ZZZZZZ9.99-.                  00026400
           05  FILLER                 PIC X(03).                        00026500
           05  DL1-EXTD-COST-AMT      PIC ZZZZZZ9.99-.                  00026600
           05  FILLER                 PIC X(03).                        00026700
00163                                                                   00026800
       01  TL1-TOTAL-LINE.                                              00026900
           05  TL1-DESC               PIC X(12).                        00027000
           05  FILLER                 PIC X(09).                        00027100
           05  TL1-FS-QTY             PIC ZZZZZZ9-.                     00027200
           05  FILLER                 PIC X(03).                        00027300
           05  TL1-SERVICE-QTY        PIC ZZZZZZ9-.                     00027400
           05  FILLER                 PIC X(03).                        00027500
           05  TL1-DIFF               PIC ZZZZZZ9-.                     00027600
           05  FILLER                 PIC X(03).                        00027700
           05  TL1-RTL-AMT            PIC ZZZZZZ9.99-.                  00027800
           05  FILLER                 PIC X(03).                        00027900
           05  TL1-EXTD-RTL-AMT       PIC ZZZZZZ9.99-.                  00028000
           05  FILLER                 PIC X(03).                        00028100
           05  TL1-COST-AMT           PIC ZZZZZZ9.99-.                  00028200
           05  FILLER                 PIC X(03).                        00028300
           05  TL1-EXTD-COST-AMT      PIC ZZZZZZ9.99-.                  00028400
           05  FILLER                 PIC X(03).                        00028500
00164  PROCEDURE DIVISION.                                              00028600
00165                                                                   00028700
00166  0000-MLKUT612.                                                   00028800
00167 ******************************************************************00028900
00168 *  MAIN PROCESSING                                                00029000
00169 ******************************************************************00029100
00170      PERFORM 1000-INITIALIZATION.                                 00029200
00177      PERFORM 2000-PROCESS-RECORDS                                 00029300
00178          UNTIL PS-NO-MORE-INPUT-RECS OR                           00029400
00179                PS-NO-MORE-SKU-RECS.                               00029500
           PERFORM 9000-EOJ.                                            00029600
00182                                                                   00029700
00183      STOP RUN.                                                    00029800
00216 *                                                                 00029900
       1000-INITIALIZATION.                                             00030000
                                                                        00030100
           DISPLAY '***********************************'                00030200
           DISPLAY ' BEGIN MLKUT612 '                                   00030300
           MOVE FUNCTION CURRENT-DATE (3:2)  TO DP132O-RUN-YEAR.        00030400
           MOVE FUNCTION CURRENT-DATE (5:2)  TO DP132O-RUN-MONTH.       00030500
           MOVE FUNCTION CURRENT-DATE (7:2)  TO DP132O-RUN-DAY.         00030600
           MOVE FUNCTION CURRENT-DATE (9:2)  TO DP132O-RUN-HOUR.        00030700
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP132O-RUN-MINUTE.      00030800
                                                                        00030900
00171      OPEN INPUT  FIRE-IN-FILE                                     00031000
00171                  SKU-FILE                                         00031100
00172           OUTPUT INVALIDS-FILE                                    00031200
00171                  REPORT-FILE                                      00031300
00171                  NEGATIVE-RPT-FILE                                00031400
00172                  CONVERTED-TRANSFER-FILE.                         00031500
 0173                                                                   00031600
           MOVE PC-MLKUT612-JOB              TO DP132O-PROGRAM-NAME.    00031700
           MOVE 1                            TO DP132O-REPORT-NUMBER.   00031800
           PERFORM 3500-WRITE-REPORT-HEADING.                           00031900
           MOVE 2                            TO DP132O-REPORT-NUMBER.   00032000
           PERFORM 3600-WRITE-NEGATIVE-RPT-HDG.                         00032100
00176      PERFORM 8000-READ-FIRE-IN-FILE.                              00032200
00176      PERFORM 8200-READ-SKU-FILE.                                  00032300
                                                                        00032400
00218 ******************************************************************00032500
00219 *    MOVE DATA FROM THE INPUT FILE TO THE OUTPUT FILE RECORD.     00032600
00220 ******************************************************************00032700
00217  2000-PROCESS-RECORDS.                                            00032800
00221      DISPLAY  'FSK SKU - INPUT ' FSHOT-SKU ' ' ML005I-SKU.        00032900
           IF ML005I-SKU = FSHOT-SKU                                    00033000
               PERFORM 2200-PROCESS-MATCH                               00033100
               PERFORM 8000-READ-FIRE-IN-FILE                           00033200
               PERFORM 8200-READ-SKU-FILE                               00033300
           ELSE                                                         00033400
               IF FSHOT-SKU > ML005I-SKU                                00033500
      *--- INVALID FIRE DATA                                            00033600
                   DISPLAY 'INVALID SCANNED ITEM ' ML005I-SKU           00033700
      *            PERFORM 3000-WRITE-REPORT                            00033800
                   PERFORM 4400-WRITE-INVALIDS                          00033900
                   PERFORM 8000-READ-FIRE-IN-FILE                       00034000
               ELSE                                                     00034100
                   IF FSHOT-SKU < ML005I-SKU                            00034200
      *--- MISSING DATA FROM STORE - SKU DATA IS USED                   00034300
                       DISPLAY 'MISSING DATA FROM STR ' ML005I-SKU      00034400
                       IF FSHOT-ONHAND-QTY < 1                          00034500
                           IF FSHOT-ONHAND-QTY = 0                      00034600
                               CONTINUE                                 00034700
                           ELSE                                         00034800
                               PERFORM 3400-WRITE-NEGATIVE-REPORT       00034900
                           END-IF                                       00035000
                       ELSE                                             00035100
                           MOVE FSHOT-ONHAND-QTY TO PV-UNITS            00035200
                           PERFORM 3200-WRITE-RPT-FROM-TSKST            00035300
                           PERFORM 4200-WRITE-XFER-FROM-SKU             00035400
                       END-IF                                           00035500
                       PERFORM 8200-READ-SKU-FILE                       00035600
                   END-IF                                               00035700
               END-IF                                                   00035800
           END-IF.                                                      00035900
                                                                        00036000
       2200-PROCESS-MATCH.                                              00036100
           IF ML005I-TRANSFER-UNITS = FSHOT-ONHAND-QTY                  00036200
               DISPLAY 'UNITS MATCHED FOR SKU ' FSHOT-SKU               00036300
           ELSE                                                         00036400
               COMPUTE PV-UNITS =                                       00036500
                       FSHOT-ONHAND-QTY - ML005I-TRANSFER-UNITS         00036600
               IF PV-UNITS < 1                                          00036700
                   IF FSHOT-ONHAND-QTY = 0                              00036800
                       CONTINUE                                         00036900
                   ELSE                                                 00037000
                       PERFORM 3400-WRITE-NEGATIVE-REPORT               00037100
                   END-IF                                               00037200
               ELSE                                                     00037300
                   PERFORM 3200-WRITE-RPT-FROM-TSKST                    00037400
                   PERFORM 4000-WRITE-XFER-FROM-STORE                   00037500
               END-IF                                                   00037600
           END-IF.                                                      00037700
                                                                        00037800
       3050-DEPT-TOTALS.                                                00037900
           MOVE 'DEPT TOTAL'        TO TL1-DESC.                        00038000
           MOVE PA-SERVICE-QTY      TO TL1-SERVICE-QTY.                 00038100
           MOVE PA-RTL-AMT          TO TL1-RTL-AMT.                     00038200
           MOVE PA-EXTD-RTL-AMT     TO TL1-EXTD-RTL-AMT.                00038300
           MOVE PA-FS-QTY           TO TL1-FS-QTY.                      00038400
           MOVE PA-DIFF             TO TL1-DIFF.                        00038500
           MOVE PA-COST-AMT         TO TL1-COST-AMT.                    00038600
           MOVE PA-EXTD-COST-AMT    TO TL1-EXTD-COST-AMT.               00038700
           MOVE FSHOT-MERCH-DEPT-NMBR TO PV-DEPT-NBR.                   00038800
                                                                        00038900
           IF PA-LINE-NO > PC-MAX-LINES                                 00039000
               PERFORM 3500-WRITE-REPORT-HEADING                        00039100
           END-IF.                                                      00039200
                                                                        00039300
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE                      00039400
                  AFTER ADVANCING 1 LINES.                              00039500
                                                                        00039600
           ADD 1                    TO PA-LINE-NO.                      00039700
           ADD  PA-SERVICE-QTY      TO PA-RPT-SERVICE-QTY.              00039800
           ADD  PA-RTL-AMT          TO PA-RPT-RTL-AMT.                  00039900
           ADD  PA-EXTD-RTL-AMT     TO PA-RPT-EXTD-RTL-AMT.             00040000
           ADD  PA-FS-QTY           TO PA-RPT-FS-QTY.                   00040100
           ADD  PA-DIFF             TO PA-RPT-DIFF.                     00040200
           ADD  PA-COST-AMT         TO PA-RPT-COST-AMT.                 00040300
           ADD  PA-EXTD-COST-AMT    TO PA-RPT-EXTD-COST-AMT.            00040400
                                                                        00040500
           MOVE 0                   TO PA-SERVICE-QTY                   00040600
                                       PA-RTL-AMT                       00040700
                                       PA-EXTD-RTL-AMT                  00040800
                                       PA-FS-QTY                        00040900
                                       PA-DIFF                          00041000
                                       PA-COST-AMT                      00041100
                                       PA-EXTD-COST-AMT.                00041200
           PERFORM 3500-WRITE-REPORT-HEADING.                           00041300
                                                                        00041400
       3055-NEG-DEPT-TOTALS.                                            00041500
           MOVE 'DEPT TOTAL'        TO TL1-DESC.                        00041600
           MOVE PA-SERVICE-QTY2     TO TL1-SERVICE-QTY.                 00041700
           MOVE PA-RTL-AMT2         TO TL1-RTL-AMT.                     00041800
           MOVE PA-EXTD-RTL-AMT2    TO TL1-EXTD-RTL-AMT.                00041900
           MOVE PA-FS-QTY2          TO TL1-FS-QTY.                      00042000
           MOVE PA-DIFF2            TO TL1-DIFF.                        00042100
           MOVE PA-COST-AMT2        TO TL1-COST-AMT.                    00042200
           MOVE PA-EXTD-COST-AMT2   TO TL1-EXTD-COST-AMT.               00042300
           MOVE FSHOT-MERCH-DEPT-NMBR TO PV-DEPT-NBR2.                  00042400
                                                                        00042500
           IF PA-LINE-NO2 > PC-MAX-LINES                                00042600
               PERFORM 3600-WRITE-NEGATIVE-RPT-HDG                      00042700
           END-IF.                                                      00042800
                                                                        00042900
           WRITE NEGATIVE-RPT-RECORD FROM TL1-TOTAL-LINE                00043000
                  AFTER ADVANCING 1 LINES.                              00043100
           ADD 1                    TO PA-LINE-NO2.                     00043200
                                                                        00043300
           ADD  PA-SERVICE-QTY2     TO PA-RPT-SERVICE-QTY2.             00043400
           ADD  PA-RTL-AMT2         TO PA-RPT-RTL-AMT2.                 00043500
           ADD  PA-EXTD-RTL-AMT2    TO PA-RPT-EXTD-RTL-AMT2.            00043600
           ADD  PA-FS-QTY2          TO PA-RPT-FS-QTY2.                  00043700
           ADD  PA-DIFF2            TO PA-RPT-DIFF2.                    00043800
           ADD  PA-COST-AMT2        TO PA-RPT-COST-AMT2.                00043900
           ADD  PA-EXTD-COST-AMT2   TO PA-RPT-EXTD-COST-AMT2.           00044000
                                                                        00044100
           MOVE 0                   TO PA-SERVICE-QTY2                  00044200
                                       PA-RTL-AMT2                      00044300
                                       PA-EXTD-RTL-AMT2                 00044400
                                       PA-FS-QTY2                       00044500
                                       PA-DIFF2                         00044600
                                       PA-COST-AMT2                     00044700
                                       PA-EXTD-COST-AMT2.               00044800
                                                                        00044900
           PERFORM 3600-WRITE-NEGATIVE-RPT-HDG.                         00045000
                                                                        00045100
       3060-SUB-CL-TOTALS.                                              00045110
           MOVE 'SUBCL TOTAL'        TO TL1-DESC.                       00045120
           MOVE PA-SCL-SERVICE-QTY      TO TL1-SERVICE-QTY.             00045130
           MOVE PA-SCL-RTL-AMT          TO TL1-RTL-AMT.                 00045140
           MOVE PA-SCL-EXTD-RTL-AMT     TO TL1-EXTD-RTL-AMT.            00045150
           MOVE PA-SCL-FS-QTY           TO TL1-FS-QTY.                  00045160
           MOVE PA-SCL-DIFF             TO TL1-DIFF.                    00045170
           MOVE PA-SCL-COST-AMT         TO TL1-COST-AMT.                00045180
           MOVE PA-SCL-EXTD-COST-AMT    TO TL1-EXTD-COST-AMT.           00045190
           MOVE FSHOT-MERCH-CLASS-NMBR  TO PV-SUB-CL-NBR.               00045191
                                                                        00045192
           IF PA-LINE-NO > PC-MAX-LINES                                 00045193
               PERFORM 3500-WRITE-REPORT-HEADING                        00045194
           END-IF.                                                      00045195
                                                                        00045196
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE                      00045197
                  AFTER ADVANCING 1 LINES.                              00045198
                                                                        00045199
           ADD 1                    TO PA-LINE-NO.                      00045200
           ADD  PA-SCL-SERVICE-QTY      TO PA-SERVICE-QTY.              00045201
           ADD  PA-SCL-RTL-AMT          TO PA-RTL-AMT.                  00045202
           ADD  PA-SCL-EXTD-RTL-AMT     TO PA-EXTD-RTL-AMT.             00045203
           ADD  PA-SCL-FS-QTY           TO PA-FS-QTY.                   00045204
           ADD  PA-SCL-DIFF             TO PA-DIFF.                     00045205
           ADD  PA-SCL-COST-AMT         TO PA-COST-AMT.                 00045206
           ADD  PA-SCL-EXTD-COST-AMT    TO PA-EXTD-COST-AMT.            00045207
                                                                        00045208
           MOVE 0                   TO PA-SCL-SERVICE-QTY               00045209
                                       PA-SCL-RTL-AMT                   00045210
                                       PA-SCL-EXTD-RTL-AMT              00045211
                                       PA-SCL-FS-QTY                    00045212
                                       PA-SCL-DIFF                      00045213
                                       PA-SCL-COST-AMT                  00045214
                                       PA-SCL-EXTD-COST-AMT.            00045215
                                                                        00045217
       3200-WRITE-RPT-FROM-TSKST.                                       00045220
           IF FSHOT-MERCH-DEPT-NMBR = PV-DEPT-NBR                       00045300
               IF FSHOT-MERCH-CLASS-NMBR = PV-SUB-CL-NBR                00045310
                   CONTINUE                                             00045400
               ELSE                                                     00045500
                   IF PV-SUB-CL-NBR = SPACES                            00045501
                       MOVE FSHOT-MERCH-CLASS-NMBR TO PV-SUB-CL-NBR     00045502
                   ELSE                                                 00045503
                       PERFORM 3060-SUB-CL-TOTALS                       00045504
                   END-IF                                               00045505
           ELSE                                                         00045510
               IF PV-DEPT-NBR  = SPACES                                 00045600
                   MOVE FSHOT-MERCH-DEPT-NMBR TO PV-DEPT-NBR            00045700
               ELSE                                                     00045800
                   PERFORM 3060-SUB-CL-TOTALS                           00045810
                   PERFORM 3050-DEPT-TOTALS                             00045900
               END-IF                                                   00046000
           END-IF.                                                      00046100
                                                                        00046200
           MOVE FSHOT-MERCH-DEPT-NMBR        TO DL1-DEPT.               00046300
           MOVE FSHOT-MERCH-CLASS-NMBR       TO DL1-SUB-CL-NBR.         00046400
           MOVE FSHOT-SEQ-NMBR               TO DL1-SEQ.                00046500
           MOVE FSHOT-ONHAND-QTY             TO DL1-FS-QTY.             00046600
                                                                        00046700
           IF ML005I-SKU = FSHOT-SKU                                    00046800
               MOVE ML005I-TRANSFER-UNITS    TO DL1-SERVICE-QTY         00047100
               ADD  ML005I-TRANSFER-UNITS    TO PA-SCL-SERVICE-QTY      00047110
               MOVE PV-UNITS                 TO DL1-DIFF                00047300
               ADD  PV-UNITS                 TO PA-SCL-DIFF             00047400
           ELSE                                                         00047800
               MOVE 0                        TO DL1-SERVICE-QTY         00047900
               MOVE FSHOT-ONHAND-QTY         TO DL1-DIFF                00048000
               ADD  FSHOT-ONHAND-QTY         TO PA-SCL-DIFF             00048100
           END-IF.                                                      00048500
                                                                        00048600
           MOVE FSHOT-CUR-UNIT-RTL-AMT TO DL1-RTL-AMT                   00048601
           COMPUTE PV-EXTD-RTL-AMT       =                              00048610
              PV-UNITS * FSHOT-CUR-UNIT-RTL-AMT                         00048620
                                                                        00048630
           MOVE FSHOT-UNIT-COST-AMT          TO DL1-COST-AMT.           00048700
                                                                        00048710
           COMPUTE PV-EXTD-COST-AMT      =                              00048800
                PV-UNITS * FSHOT-UNIT-COST-AMT.                         00048900
                                                                        00049000
           MOVE PV-EXTD-RTL-AMT              TO DL1-EXTD-RTL-AMT.       00049100
           MOVE PV-EXTD-COST-AMT             TO DL1-EXTD-COST-AMT.      00049200
                                                                        00049300
                                                                        00049400
           ADD  FSHOT-ONHAND-QTY             TO PA-SCL-FS-QTY.          00049500
           ADD  FSHOT-CUR-UNIT-RTL-AMT       TO PA-SCL-RTL-AMT.         00049900
           ADD  PV-EXTD-RTL-AMT              TO PA-SCL-EXTD-RTL-AMT.    00050000
           ADD  FSHOT-UNIT-COST-AMT          TO PA-SCL-COST-AMT.        00050100
           ADD  PV-EXTD-COST-AMT             TO PA-SCL-EXTD-COST-AMT.   00050200
                                                                        00050300
           IF PA-LINE-NO > PC-MAX-LINES                                 00050400
               PERFORM 3500-WRITE-REPORT-HEADING                        00050500
           END-IF.                                                      00050600
                                                                        00050700
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE                     00050800
                  AFTER ADVANCING 1 LINES.                              00050900
           ADD 1                              TO PA-LINE-NO.            00051000
                                                                        00051100
       3400-WRITE-NEGATIVE-REPORT.                                      00051200
           IF FSHOT-MERCH-DEPT-NMBR = PV-DEPT-NBR2                      00051300
               CONTINUE                                                 00051400
           ELSE                                                         00051500
               IF PV-DEPT-NBR2  = SPACES                                00051600
                   MOVE FSHOT-MERCH-DEPT-NMBR TO PV-DEPT-NBR2           00051700
               ELSE                                                     00051800
                   PERFORM 3055-NEG-DEPT-TOTALS                         00051900
                                                                        00052000
           END-IF.                                                      00052100
                                                                        00052110
           MOVE FSHOT-MERCH-DEPT-NMBR        TO DL1-DEPT.               00052200
           MOVE FSHOT-MERCH-CLASS-NMBR       TO DL1-SUB-CL-NBR.         00052300
           MOVE FSHOT-SEQ-NMBR               TO DL1-SEQ.                00052400
                                                                        00052500
           MOVE FSHOT-ONHAND-QTY             TO DL1-FS-QTY.             00052600
                                                                        00052700
           IF ML005I-SKU = FSHOT-SKU                                    00052800
               MOVE ML005I-TRANSFER-UNITS    TO DL1-SERVICE-QTY         00053100
               MOVE PV-UNITS                 TO DL1-DIFF                00053300
               ADD  PV-UNITS                 TO PA-DIFF2                00053400
           ELSE                                                         00053800
               MOVE 0                        TO DL1-SERVICE-QTY         00053900
               MOVE FSHOT-ONHAND-QTY         TO DL1-DIFF                00054000
                                                PV-UNITS                00054100
               ADD  FSHOT-ONHAND-QTY         TO PA-DIFF2                00054200
           END-IF.                                                      00054600
                                                                        00054700
           MOVE FSHOT-CUR-UNIT-RTL-AMT       TO DL1-RTL-AMT.            00054701
           COMPUTE PV-EXTD-RTL-AMT      =                               00054710
                PV-UNITS * FSHOT-CUR-UNIT-RTL-AMT.                      00054720
           MOVE PV-EXTD-RTL-AMT              TO DL1-EXTD-RTL-AMT.       00054721
                                                                        00054730
           MOVE FSHOT-UNIT-COST-AMT          TO DL1-COST-AMT.           00054800
           COMPUTE PV-EXTD-COST-AMT      =                              00054900
                PV-UNITS * FSHOT-UNIT-COST-AMT.                         00055000
           MOVE PV-EXTD-COST-AMT             TO DL1-EXTD-COST-AMT.      00055300
                                                                        00055500
           ADD  FSHOT-ONHAND-QTY             TO PA-FS-QTY2.             00055600
           ADD  ML005I-TRANSFER-UNITS        TO PA-SERVICE-QTY2.        00055700
           ADD  FSHOT-CUR-UNIT-RTL-AMT       TO PA-RTL-AMT2.            00056000
           ADD  PV-EXTD-RTL-AMT              TO PA-EXTD-RTL-AMT2.       00056100
           ADD  FSHOT-UNIT-COST-AMT          TO PA-COST-AMT2.           00056200
           ADD  PV-EXTD-COST-AMT             TO PA-EXTD-COST-AMT2.      00056300
                                                                        00056400
           IF PA-LINE-NO2 > PC-MAX-LINES                                00056500
               PERFORM 3600-WRITE-NEGATIVE-RPT-HDG                      00056600
           END-IF.                                                      00056700
                                                                        00056800
           WRITE NEGATIVE-RPT-RECORD FROM DL1-DETAIL-LINE               00056900
                  AFTER ADVANCING 1 LINES.                              00057000
           ADD 1                              TO PA-LINE-NO2.           00057100
                                                                        00057110
      ******************************************************************00057200
      *   3500-WRITE-REPORT-HEADING                                    *00057300
      *      PRINT HEADING LINES                                       *00057400
      ******************************************************************00057500
       3500-WRITE-REPORT-HEADING.                                       00057600
           MOVE 1                              TO DP132O-REPORT-NUMBER. 00057700
           MOVE 0                              TO PA-LINE-COUNT         00057800
           ADD 1                               TO PA-PAGE-COUNT.        00057900
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   00058000
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        00058100
           WRITE REPORT-RECORD                                          00058200
                   AFTER ADVANCING PAGE.                                00058300
                                                                        00058400
           MOVE PC-MLKUT612-JOB                 TO H2-JOB-NAME.         00058500
           MOVE H2-HEADING2                    TO REPORT-RECORD.        00058600
           MOVE 1                              TO PA-LINE-NO.           00058700
           WRITE REPORT-RECORD                                          00058800
                   AFTER ADVANCING 1 LINE.                              00058900
                                                                        00059000
           MOVE H3-HEADING3                    TO REPORT-RECORD.        00059100
           MOVE 1                              TO PA-LINE-NO.           00059200
           WRITE REPORT-RECORD                                          00059300
                   AFTER ADVANCING 1 LINE.                              00059400
                                                                        00059500
           MOVE H4-HEADING4                    TO REPORT-RECORD.        00059600
           MOVE 1                              TO PA-LINE-NO.           00059700
           WRITE REPORT-RECORD                                          00059800
                   AFTER ADVANCING 1 LINE.                              00059900
                                                                        00060000
           MOVE SPACES                         TO REPORT-RECORD.        00060100
           WRITE REPORT-RECORD                                          00060200
                   AFTER ADVANCING 1 LINE.                              00060300
                                                                        00060400
      ******************************************************************00060500
      *   3600-WRITE-REPORT-HEADING                                    *00060600
      *      PRINT HEADING LINES                                       *00060700
      ******************************************************************00060800
       3600-WRITE-NEGATIVE-RPT-HDG.                                     00060900
           MOVE 2                              TO DP132O-REPORT-NUMBER. 00061000
           MOVE 0                              TO PA-LINE-COUNT2.       00061100
           ADD 1                               TO PA-PAGE-COUNT2.       00061200
           MOVE PA-PAGE-COUNT2                 TO DP132O-PAGE-NUMBER.   00061300
           MOVE DP132O-STANDRD-HEADER-132-COLS TO NEGATIVE-RPT-RECORD.  00061400
           WRITE NEGATIVE-RPT-RECORD                                    00061500
                   AFTER ADVANCING PAGE.                                00061600
                                                                        00061700
           MOVE PC-MLKUT612-JOB                TO H2-JOB-NAME2.         00061800
           MOVE H2-HEADING2-RPT2               TO NEGATIVE-RPT-RECORD.  00061900
           MOVE 2                              TO PA-LINE-NO2.          00062000
           WRITE NEGATIVE-RPT-RECORD                                    00062100
                   AFTER ADVANCING 1 LINE.                              00062200
                                                                        00062300
           MOVE H3-HEADING3                    TO NEGATIVE-RPT-RECORD.  00062400
           MOVE 1                              TO PA-LINE-NO2.          00062500
           WRITE NEGATIVE-RPT-RECORD                                    00062600
                   AFTER ADVANCING 1 LINE.                              00062700
                                                                        00062800
           MOVE H4-HEADING4                    TO NEGATIVE-RPT-RECORD.  00062900
           MOVE 1                              TO PA-LINE-NO2.          00063000
           WRITE NEGATIVE-RPT-RECORD                                    00063100
                   AFTER ADVANCING 1 LINE.                              00063200
                                                                        00063300
           MOVE SPACES                         TO NEGATIVE-RPT-RECORD.  00063400
           WRITE NEGATIVE-RPT-RECORD                                    00063500
                   AFTER ADVANCING 1 LINE.                              00063600
                                                                        00063700
       4000-WRITE-XFER-FROM-STORE.                                      00063800
           DISPLAY ' WRITE XFER FROM STORE '                            00063900
           INITIALIZE ML005O-STORE-TRANSFER-RECORD.                     00064000
           MOVE ML005I-STORE-TRANSFER-RECORD TO                         00064100
                ML005O-STORE-TRANSFER-RECORD.                           00064200
           MOVE PV-UNITS               TO ML005O-TRANSFER-UNITS.        00064300
           MOVE FSHOT-CUR-UNIT-RTL-AMT TO ML005O-TRANSFER-RETAIL-PRICE. 00064400
00223      MOVE PC-BATCH-300           TO ML005O-BATCH-NUMBER.          00064500
00235      MOVE PC-STORE-811           TO ML005O-TRANSFER-TO-STORE      00064600
00237      MOVE PC-DOC-NO              TO ML005O-DOCUMENT-NUMBER.       00064700
     ***   MOVE                        TO ML005O-TRANSFER-DATE.         00064800
     ***   MOVE                        TO ML005O-KOHLS-MONTH.           00064900
00243                                                                   00065000
00244      WRITE CONVERTED-TRANSFER-RECORD FROM                         00065100
                ML005O-STORE-TRANSFER-RECORD.                           00065200
                                                                        00065300
           ADD 1 TO  PA-XFER-RECS-WRITTEN.                              00065400
                                                                        00065500
       4200-WRITE-XFER-FROM-SKU.                                        00065600
           INITIALIZE ML005O-STORE-TRANSFER-RECORD.                     00065700
           MOVE PC-TRANSFER-CODE       TO ML005O-TRANSACTION-CODE.      00065800
00235      MOVE PC-STORE-385           TO ML005O-TRANSFER-FROM-STORE.   00065900
00237      MOVE PC-DOC-NO              TO ML005O-DOCUMENT-NUMBER.       00066000
     ***   MOVE                        TO ML005O-TRANSFER-DATE.         00066100
     ***   MOVE                        TO ML005O-KOHLS-MONTH.           00066200
00228      MOVE PV-UNITS               TO ML005O-TRANSFER-UNITS.        00066300
           MOVE FSHOT-CUR-UNIT-RTL-AMT TO ML005O-TRANSFER-RETAIL-PRICE. 00066400
00223      MOVE PC-BATCH-300           TO ML005O-BATCH-NUMBER.          00066500
00235      MOVE PC-STORE-811           TO ML005O-TRANSFER-TO-STORE.     00066600
           MOVE FSHOT-MERCH-DEPT-NMBR  TO ML005O-DEPARTMENT-NUMBER.     00066700
           MOVE FSHOT-MERCH-CLASS-NMBR TO ML005O-CLASS-NUMBER.          00066800
********   MOVE FSHOT-SEQ-NMBR         TO ML005O-SEQUENCE-NUMBER.       00066900
00244      WRITE CONVERTED-TRANSFER-RECORD FROM                         00067000
                ML005O-STORE-TRANSFER-RECORD.                           00067100
00246                                                                   00067200
00283      ADD 1 TO  PA-XFER-RECS-WRITTEN.                              00067300
                                                                        00067400
       4400-WRITE-INVALIDS.                                             00067500
00244      WRITE INVALIDS-RECORD FROM                                   00067600
                ML005I-STORE-TRANSFER-RECORD.                           00067700
00335                                                                   00067800
           ADD 1 TO  PA-INV-RECS-WRITTEN.                               00067900
                                                                        00068000
00337 ******************************************************************00068100
00338 *    READ RECORD FROM THE TRANSFER TAPE FROM THE SCANNING SERVICE.00068200
00339 ******************************************************************00068300
00336  8000-READ-FIRE-IN-FILE.                                          00068400
00341      READ FIRE-IN-FILE                                            00068500
00342          INTO ML005I-STORE-TRANSFER-RECORD                        00068600
00343          AT END SET PS-NO-MORE-INPUT-RECS TO TRUE.                00068700
00344                                                                   00068800
           IF PS-NO-MORE-INPUT-RECS                                     00068900
               CONTINUE                                                 00069000
           ELSE                                                         00069100
               ADD 1 TO PA-FIRE-RECS-READ                               00069200
           END-IF.                                                      00069300
                                                                        00069400
00337 ******************************************************************00069500
00338 *    READ RECORD FROM THE TRANSFER TAPE FROM THE SCANNING SERVICE.00069600
00339 ******************************************************************00069700
00336  8200-READ-SKU-FILE.                                              00069800
00340                                                                   00069900
00341      READ SKU-FILE                                                00070000
00342          INTO FSHOT-FIRE-FILE                                     00070100
00343          AT END SET PS-NO-MORE-SKU-RECS TO TRUE.                  00070200
00344                                                                   00070300
           IF PS-NO-MORE-SKU-RECS                                       00070400
               CONTINUE                                                 00070500
           ELSE                                                         00070600
               ADD 1 TO PA-SKUST-RECS-READ                              00070700
           END-IF.                                                      00070800
                                                                        00070900
       9000-EOJ.                                                        00071000
           IF  PS-NO-MORE-INPUT-RECS                                    00071100
                PERFORM UNTIL PS-NO-MORE-SKU-RECS                       00071200
                    PERFORM 8200-READ-SKU-FILE                          00071300
                    DISPLAY 'NO RECORD FROM STORE '                     00071400
                    IF FSHOT-ONHAND-QTY < 0                             00071500
                        PERFORM 3400-WRITE-NEGATIVE-REPORT              00071600
                    ELSE                                                00071700
                        PERFORM 4200-WRITE-XFER-FROM-SKU                00071800
                    END-IF                                              00071900
                END-PERFORM                                             00072000
           END-IF.                                                      00072100
                                                                        00072200
           IF  PS-NO-MORE-SKU-RECS                                      00072300
                PERFORM UNTIL PS-NO-MORE-INPUT-RECS                     00072400
****************   MOVE 'INVALID SCANNED ITEM' TO DL1-MSG               00072500
                   PERFORM 4400-WRITE-INVALIDS                          00072600
                   PERFORM 8000-READ-FIRE-IN-FILE                       00072700
                END-PERFORM                                             00072800
           END-IF.                                                      00072900
                                                                        00072910
           PERFORM 3060-SUB-CL-TOTALS.                                  00073000
           PERFORM 3050-DEPT-TOTALS.                                    00073010
           PERFORM 9050-RPT-TOTALS.                                     00073100
                                                                        00073110
           PERFORM 3055-NEG-DEPT-TOTALS.                                00073200
           PERFORM 9050-NEG-RPT-TOTALS.                                 00073300
           DISPLAY 'STORE RECS READ      ' PA-FIRE-RECS-READ.           00073400
           DISPLAY 'SKUST RECS READ      ' PA-SKUST-RECS-READ.          00073500
           DISPLAY 'INVALID RECS WRITTEN ' PA-INV-RECS-WRITTEN.         00073600
           DISPLAY 'XFER RECS WRITTEN    ' PA-XFER-RECS-WRITTEN.        00073700
           DISPLAY ' END MLKUT612 '                                     00073800
           DISPLAY '***********************************'                00073900
00180      CLOSE FIRE-IN-FILE                                           00074000
00171            SKU-FILE                                               00074100
00181            INVALIDS-FILE                                          00074200
00181            REPORT-FILE                                            00074300
00171            NEGATIVE-RPT-FILE                                      00074400
00181            CONVERTED-TRANSFER-FILE.                               00074500
                                                                        00074600
       9050-RPT-TOTALS.                                                 00074700
           MOVE 'REPORT TOTAL'          TO TL1-DESC.                    00074800
           MOVE PA-RPT-SERVICE-QTY      TO TL1-SERVICE-QTY.             00074900
           MOVE PA-RPT-RTL-AMT          TO TL1-RTL-AMT.                 00075000
           MOVE PA-RPT-EXTD-RTL-AMT     TO TL1-EXTD-RTL-AMT.            00075100
           MOVE PA-RPT-FS-QTY           TO TL1-FS-QTY.                  00075200
           MOVE PA-RPT-DIFF             TO TL1-DIFF.                    00075300
           MOVE PA-RPT-COST-AMT         TO TL1-COST-AMT.                00075400
           MOVE PA-RPT-EXTD-COST-AMT    TO TL1-EXTD-COST-AMT.           00075500
                                                                        00075600
           IF PA-LINE-NO > PC-MAX-LINES                                 00075700
               PERFORM 3500-WRITE-REPORT-HEADING                        00075800
           END-IF.                                                      00075900
                                                                        00076000
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE                      00076100
                  AFTER ADVANCING 1 LINES.                              00076200
                                                                        00076300
       9050-NEG-RPT-TOTALS.                                             00076400
           MOVE 'REPORT TOTAL'          TO TL1-DESC.                    00076500
           MOVE PA-RPT-SERVICE-QTY2     TO TL1-SERVICE-QTY.             00076600
           MOVE PA-RPT-RTL-AMT2         TO TL1-RTL-AMT.                 00076700
           MOVE PA-RPT-EXTD-RTL-AMT2    TO TL1-EXTD-RTL-AMT.            00076800
           MOVE PA-RPT-FS-QTY2          TO TL1-FS-QTY.                  00076900
           MOVE PA-RPT-DIFF2            TO TL1-DIFF.                    00077000
           MOVE PA-RPT-COST-AMT2        TO TL1-COST-AMT.                00077100
           MOVE PA-RPT-EXTD-COST-AMT2   TO TL1-EXTD-COST-AMT.           00077200
                                                                        00077300
           IF PA-LINE-NO > PC-MAX-LINES                                 00077400
               PERFORM 3600-WRITE-NEGATIVE-RPT-HDG                      00077500
           END-IF.                                                      00077600
                                                                        00077700
           WRITE NEGATIVE-RPT-RECORD FROM TL1-TOTAL-LINE                00077800
                  AFTER ADVANCING 1 LINES.                              00077900
                                                                        00078000
