000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             VLKCS515.                                00050000
000600 AUTHOR.                 MARY SARDINA.                            00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER 1996.                          00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL READ A PURCHASE ORDER NUMBER PASSED FROM THE  00120000
001300* ONLINE AND GENERATE A PURCHASE ORDER PRINT.                     00130000
001400* IT IS CALLED FROM THE "PRE-TICKET REQUEST" OPTION ON THE        00140000
001500* TICKETING MENU.                                                 00150000
001600******************************************************************00160000
001700                                                                  00170000
001800******************************************************************00180000
001900* THIS PROGRAM WILL READ A PURCHASE ORDER NUMBER PASSED FROM THE  00190000
002000* ONLINE AND GENERATE A PURCHASE ORDER PRINT.                     00200000
002100******************************************************************00210000
      *---------------------------------------------------------------* 00220000
      * DATE  04/10/2000, K. SCHOLEY                                  * 00230000
      *   WR20997 ADD LOGIC FOR ECOMMERCE STORE AND PO TYPE CODES     * 00240000
      *---------------------------------------------------------------* 00250047
      * DATE  11/03/2014, CHERI PARMLEY                               * 00260047
      *   CHG0094517 EXPANDED PO# FROM 7 TO 8 DIGITS                  * 00270047
      *---------------------------------------------------------------* 00280047
002200 ENVIRONMENT DIVISION.                                            00290000
002201 CONFIGURATION SECTION.                                           00300000
002210 SOURCE-COMPUTER. IBM-3090.                                       00310000
002300 OBJECT-COMPUTER. IBM-3090.                                       00320000
003300                                                                  00330000
003400******************************************************************00340000
003500 DATA DIVISION.                                                   00350000
003600******************************************************************00360000
005600 WORKING-STORAGE SECTION.                                         00370000
005700******************************************************************00380000
006800*                                                                 00390000
006900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00400000
007000*                                                                 00410000
007100     COPY DPWS013.                                                00420047
007300*                                                                 00430000
007400*  COMMNICATIONS AREA2 FOR DB2                                    00440000
007500*                                                                 00450000
007600     COPY SQLCA2.                                                 00460047
007700*                                                                 00470000
007800*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 00480000
007900*                                                                 00490000
008000     COPY DPWS024.                                                00500047
008110*                                                                 00510000
008120*  WORKING STORAGE AREA FOR THE LINKAGE FROM THE CALLING PROGRAM  00520000
008130*                                                                 00530000
008140     COPY VLWS010.                                                00540047
008147*                                                                 00550000
008148*  LAYOUT FOR DRS COMMAREA                                        00560000
008149*                                                                 00570000
008150     COPY DRRD001O.                                               00580051
008152*                                                                 00590000
008153*  LAYOUT FOR THE DYNAMIC REPORT DETAIL LINES                     00600000
008154*                                                                 00610000
008155     COPY DRRD002O.                                               00620051
008700*                                                                 00630000
008800******************************************************************00640000
008900*  WORKING STORAGE AREA FOR COUNTRY AND STATE RETRIEVAL           00650000
009000******************************************************************00660000
009100     COPY DPWS410.                                                00670047
009101                                                                  00680000
009102*  COMMUNICATIONS AREA FOR DB2                                    00690000
009103*                                                                 00700000
009104     EXEC SQL                                                     00710000
009105          INCLUDE SQLCA                                           00720000
009200     END-EXEC.                                                    00730000
009400*                                                                 00740000
009500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00750000
009600*  HEADER TABLE                                                   00760000
009700*                                                                 00770000
009800     EXEC SQL                                                     00780000
009900          INCLUDE TPURCHS                                         00790000
010000     END-EXEC.                                                    00800000
010200*                                                                 00810000
010300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00820000
010400*  ITEM TABLE                                                     00830000
010500*                                                                 00840000
010600     EXEC SQL                                                     00850000
010700          INCLUDE TPURITM                                         00860000
010800     END-EXEC.                                                    00870000
011000*                                                                 00880000
011100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00890000
011200*  PLANNED SHIPMENT TABLE                                         00900000
011300*                                                                 00910000
011400     EXEC SQL                                                     00920000
011500          INCLUDE TPLNSHP                                         00930000
011600     END-EXEC.                                                    00940000
011800*                                                                 00950000
011900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00960000
012000*  AGREEMENT TABLE                                                00970000
012100*                                                                 00980000
012200     EXEC SQL                                                     00990000
012300          INCLUDE TPOAGMT                                         01000000
012400     END-EXEC.                                                    01010000
014900*                                                                 01020000
015000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ALLOCATION PLAN    01030000
015100*  TABLE                                                          01040000
015200*                                                                 01050000
015300     EXEC SQL                                                     01060000
015400          INCLUDE TALLPLN                                         01070000
015500     END-EXEC.                                                    01080000
015700*                                                                 01090000
015800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE EXTERNAL           01100000
015900*  ENTERPRISE NAME TABLE                                          01110000
016000*                                                                 01120000
016100     EXEC SQL                                                     01130000
016200          INCLUDE TENTNME                                         01140000
016300     END-EXEC.                                                    01150000
016400*                                                                 01160000
016500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE EXTERNAL ENTITY    01170039
016600*                                                                 01180000
016700     EXEC SQL                                                     01190000
016800          INCLUDE TEXTENT                                         01200000
016900     END-EXEC.                                                    01210000
017000*                                                                 01220000
017100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTITY REP TABLE   01230039
017200*                                                                 01240000
017300     EXEC SQL                                                     01250000
017400          INCLUDE TENTREP                                         01260000
017500     END-EXEC.                                                    01270000
017700*                                                                 01280000
017800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPISE LOCATION 01290000
017900*  TABLE                                                          01300000
018000*                                                                 01310000
018100     EXEC SQL                                                     01320000
018200          INCLUDE TBUSLOC                                         01330000
018300     END-EXEC.                                                    01340000
019300*                                                                 01350000
019400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORKER             01360000
019500*  IDENTIFICATION TABLE                                           01370000
019600*                                                                 01380000
019700     EXEC SQL                                                     01390000
019800          INCLUDE TWORKER                                         01400000
019900     END-EXEC.                                                    01410000
020100*                                                                 01420000
020200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MERCHANDISE AREA   01430000
020300*  TABLE                                                          01440000
020400*                                                                 01450000
020500     EXEC SQL                                                     01460000
020600          INCLUDE TMDSEAR                                         01470000
020700     END-EXEC.                                                    01480000
020900*                                                                 01490000
021000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RESPONSIBILITY     01500000
021100*  AREA TABLE                                                     01510000
021200*                                                                 01520000
021300     EXEC SQL                                                     01530000
021400          INCLUDE TRSPBAR                                         01540000
021500     END-EXEC.                                                    01550000
021700*                                                                 01560000
021800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PRETICKET REQUEST      01570000
021900*  TABLE                                                          01580000
022000*                                                                 01590000
022100     EXEC SQL                                                     01600000
022200          INCLUDE TPTKREQ                                         01610000
022300     END-EXEC.                                                    01620000
022400*                                                                 01630000
022500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PRETICKET REQUEST      01640000
022600*  LINE ITEM TABLE                                                01650000
022700*                                                                 01660000
022800     EXEC SQL                                                     01670000
022900          INCLUDE TPTKLNE                                         01680000
023000     END-EXEC.                                                    01690000
023100*                                                                 01700000
023200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PRETICKET REQUEST      01710000
023300*  LINE ITEM TABLE                                                01720000
023400*                                                                 01730000
023500     EXEC SQL                                                     01740000
023600          INCLUDE TPTKSHP                                         01750000
023700     END-EXEC.                                                    01760000
023800*                                                                 01770000
023900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PRETICKET REQUEST      01780000
024000*  SHIPMENT ASSOCIATION TABLE                                     01790000
024100*                                                                 01800000
024200     EXEC SQL                                                     01810000
024300          INCLUDE TREQSHP                                         01820000
024400     END-EXEC.                                                    01830000
024500*                                                                 01840000
024600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR PRETICKET PLACEMENT    01850000
024700*  DESCRIPTION TABLE                                              01860000
024800*                                                                 01870000
024900     EXEC SQL                                                     01880000
025000          INCLUDE TPLDESC                                         01890000
025100     END-EXEC.                                                    01900000
025107                                                                  01910000
025115******************************************************************01920023
025116*    DB2 DCLGEN FOR XLT_SKU (XLT00003)  TABLE                     01930031
025117******************************************************************01940023
025118     EXEC SQL                                                     01950023
025119          INCLUDE XLT00003                                        01960029
025120     END-EXEC.                                                    01970023
025900*                                                                 01980023
025115******************************************************************01990033
025116*    DB2 DCLGEN FOR XLT_VND_STYL (XLT00004)  TABLE                02000033
025117******************************************************************02010033
025118     EXEC SQL                                                     02020033
025119          INCLUDE XLT00004                                        02030033
025120     END-EXEC.                                                    02040033
025900*                                                                 02050033
025115******************************************************************02060023
025116*    DB2 DCLGEN FOR XLV_UPC (XLV00003)  VIEW                      02070029
025117******************************************************************02080023
025118     EXEC SQL                                                     02090023
025119          INCLUDE XLV00003                                        02100023
025120     END-EXEC.                                                    02110023
025900*                                                                 02120023
026000 01  DK-DB2-KEYS.                                                 02130023
026100     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  02140000
026200                                                     COMP.        02150000
026300     05  DK-ORD-REQ-NBR                  PIC S9(09)  VALUE ZEROS  02160000
026200                                                     COMP.        02170007
026200     05  DK-ITM-NBR                      PIC S9(15)V COMP-3.      02180039
026500*                                                                 02190000
026600 01  PS-PROGRAM-SWITCHES.                                         02200000
026700     05  PS-EOF-ADDR-TBL-SW              PIC  X(01)  VALUE 'N'.   02210000
026800         88  PS-EOF-ADDR-TBL                         VALUE 'Y'.   02220000
026900         88  PS-NOT-EOF-ADDR-TBL                     VALUE 'N'.   02230000
027000     05  PS-EOF-PO-LINE-CSR-SW           PIC  X(01)  VALUE 'N'.   02240000
027100         88  PS-EOF-PO-LINE-CSR                      VALUE 'Y'.   02250000
027200         88  PS-NOT-EOF-PO-LINE-CSR                  VALUE 'N'.   02260000
027900                                                                  02270000
028000 01  PC-PROGRAM-CONSTANTS.                                        02280000
028300     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)  VALUE           02290000
028400         'VLKCS515'.                                              02300000
028500     05  PC-NEW-PAGE                  PIC  X(01)  VALUE '1'.      02310000
028600     05  PC-SINGLE-SPACE              PIC  X(01)  VALUE ' '.      02320000
028700     05  PC-DOUBLE-SPACE              PIC  X(01)  VALUE '0'.      02330000
028800     05  PC-TRIPLE-SPACE              PIC  X(01)  VALUE '-'.      02340000
028900     05  PC-MAX-RETRIES               PIC S9(04)  VALUE  +3 COMP. 02350010
029100     05  PC-PUT                       PIC  X(03)  VALUE 'PUT'.    02360000
029200     05  PC-INIT                      PIC  X(04)  VALUE 'INIT'.   02370000
029300     05  PC-TERM                      PIC  X(04)  VALUE 'TERM'.   02380000
029301     05  PC-FORM-STD                  PIC  X(03)  VALUE 'STD'.    02390010
029302     05  PC-Y                         PIC  X(01)  VALUE 'Y'.      02400010
029303     05  PC-RID-1.                                                02410000
029304         10  FILLER                   PIC  X(01)  VALUE 'A'.      02420000
029305         10  PC-RID-1A                PIC  X(07)  VALUE SPACES.   02430000
029311     05  PC-PHONE                     PIC  X(07)  VALUE           02440000
029320         'PHONE: '.                                               02450000
029330     05  PC-ATTN                      PIC  X(07)  VALUE           02460000
029340         'ATTN:  '.                                               02470000
029350     05  PC-RM                        PIC  X(06)  VALUE           02480000
029351         'ROOM: '.                                                02490000
029352     05  PC-PRETICKET-DEPT            PIC  X(20)  VALUE           02500000
029353         'PRETICKET DEPARTMENT'.                                  02510000
029400     05  PC-INIT-DATE                 PIC  X(10) VALUE            02520000
029500                                                     '0001-01-01'.02530000
030200     05  PC-MONTH-ABBR-TABLE.                                     02540000
030300         10  FILLER                   PIC  X(03) VALUE 'JAN'.     02550000
030400         10  FILLER                   PIC  X(03) VALUE 'FEB'.     02560000
030500         10  FILLER                   PIC  X(03) VALUE 'MAR'.     02570000
030600         10  FILLER                   PIC  X(03) VALUE 'APR'.     02580000
030700         10  FILLER                   PIC  X(03) VALUE 'MAY'.     02590000
030800         10  FILLER                   PIC  X(03) VALUE 'JUN'.     02600000
030900         10  FILLER                   PIC  X(03) VALUE 'JUL'.     02610000
031000         10  FILLER                   PIC  X(03) VALUE 'AUG'.     02620000
031100         10  FILLER                   PIC  X(03) VALUE 'SEP'.     02630000
031200         10  FILLER                   PIC  X(03) VALUE 'OCT'.     02640000
031300         10  FILLER                   PIC  X(03) VALUE 'NOV'.     02650000
031400         10  FILLER                   PIC  X(03) VALUE 'DEC'.     02660000
031500     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    02670000
031600         10  PC-MONTH-ABBR OCCURS 12 TIMES                        02680000
031700                                      PIC  X(03).                 02690000
031710     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.02700000
007600     05  PC-LOWEST-INTERNAL-UPC-NMBR  PIC S9(15)V VALUE           02710042
007700         00400000000000                             COMP-3.       02720042
007800     05  PC-HIGHEST-INTERNAL-UPC-NMBR PIC S9(15)V VALUE           02730042
007900         00499999999999                             COMP-3.       02740042
031710     05  PC-ALL-ZERO-UPC-CODE         PIC  9(15)  VALUE ZEROS.    02750042
031800                                                                  02760000
031900 01  PV-PROGRAM-VARIABLES.                                        02770000
032000     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP.        02780000
032010     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  02790000
032100                                                     COMP SYNC.   02800000
035610     05  PV-DRS-ABEND-DISPLAY-LINE1.                              02810000
035620         10  FILLER                      PIC  X(14)  VALUE        02820000
035630             'DRRB ID = DRRB'.                                    02830000
035640         10  FILLER                      PIC  X(02)  VALUE SPACE. 02840000
035650         10  FILLER                      PIC  X(12)  VALUE        02850000
035660             'DRRB FUNC = '.                                      02860000
035670         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 02870000
035680         10  FILLER                      PIC  X(02)  VALUE SPACE. 02880000
035690         10  FILLER                      PIC  X(11)  VALUE        02890000
035691             'DRRB RID = '.                                       02900000
035692         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 02910000
035693         10  FILLER                      PIC  X(02)  VALUE SPACE. 02920000
035694         10  FILLER                      PIC  X(15)  VALUE        02930000
035695             'DRRB OPTIONS = '.                                   02940000
035696         10  PV-DRS-DRRB-OPTIONS         PIC  X(04)  VALUE SPACE. 02950005
035697                                                                  02960000
035698     05  PV-DRS-ABEND-DISPLAY-LINE2.                              02970000
035699         10  FILLER                      PIC  X(10)  VALUE        02980000
035700             'DRRB RC = '.                                        02990000
035701         10  PV-DRS-DRRB-RC              PIC S9(08)  VALUE ZERO.  03000005
035702         10  FILLER                      PIC  X(02)  VALUE SPACE. 03010000
035703         10  FILLER                      PIC  X(18)  VALUE        03020000
035704             'DRRB ATTR-ERROR = '.                                03030000
035705         10  PV-DRS-ATTR-ERROR           PIC S9(04) VALUE +0 COMP.03040005
035706         10  FILLER                      PIC  X(02)  VALUE SPACE. 03050000
035707         10  FILLER                      PIC  X(12)  VALUE        03060000
035708             'DRRB DRDC = '.                                      03070000
035709         10  PV-DRS-DRRB-DRDC            PIC S9(08) VALUE +0 COMP.03080005
035710         10  FILLER                      PIC  X(02)  VALUE SPACE. 03090000
035711         10  FILLER                      PIC  X(13)  VALUE        03100000
035712             'DRRB LINES = '.                                     03110000
035713         10  PV-DRS-DRRB01-LINES         PIC S9(04) VALUE +0 COMP.03120005
035714                                                                  03130000
036200     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0 COMP-3. 03140005
036800     05  PV-LINE-CNT                  PIC S9(03) VALUE +0.        03150000
036900     05  PV-TEMP-LINE-CNT             PIC S9(03) VALUE +0.        03160000
037000     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0 COMP-3. 03170034
037003     05  PV-REQ-PRETKT-QTY            PIC S9(09) VALUE ZERO COMP. 03180034
037200     05  PV-DATE-BREAK.                                           03190000
037300         10  PV-DB-CC                 PIC  X(02).                 03200000
037400         10  PV-DB-YY                 PIC  X(02).                 03210000
037500         10  FILLER                   PIC  X(01).                 03220000
037600         10  PV-DB-MM                 PIC  X(02).                 03230000
037700         10  FILLER                   PIC  X(01).                 03240000
037800         10  PV-DB-DD                 PIC  X(02).                 03250000
037900     05  PV-DATE-BREAK-SLASH.                                     03260000
038000         10  PV-DBS-MM                PIC  X(02).                 03270000
038100         10  FILLER                   PIC  X(01) VALUE '/'.       03280000
038200         10  PV-DBS-DD                PIC  X(02).                 03290000
038300         10  FILLER                   PIC  X(01) VALUE '/'.       03300000
038400         10  PV-DBS-YY                PIC  X(02).                 03310000
041000     05  PV-PO-LINE-NBR               PIC S9(03) COMP-3.          03320000
      *CLP 11/03/14                                                     03330047
041100     05  PV-PO-NBR                    PIC 9(08)  VALUE ZERO.      03340047
041200     05  PV-ALLOC-CNT                 PIC S9(09) COMP-3.          03350000
041900     05  PV-CURRENT-TMST-RDF.                                     03360000
042000         10  PV-CURRENT-CENTURY       PIC  9(02)  VALUE ZEROS.    03370000
042010         10  PV-CURRENT-YEAR          PIC  9(02)  VALUE ZEROS.    03380000
042100         10  FILLER                   PIC  X(01)  VALUE '-'.      03390000
042200         10  PV-CURRENT-MONTH         PIC  9(02)  VALUE ZEROS.    03400000
042300         10  FILLER                   PIC  X(01)  VALUE '-'.      03410000
042400         10  PV-CURRENT-DAY           PIC  9(02)  VALUE ZEROS.    03420000
042410         10  FILLER                   PIC  X(01)  VALUE '-'.      03430000
042420         10  PV-CURRENT-HOUR          PIC  9(02)  VALUE ZEROS.    03440000
042430         10  FILLER                   PIC  X(01)  VALUE '.'.      03450000
042440         10  PV-CURRENT-MINUTE        PIC  9(02)  VALUE ZEROS.    03460000
042450         10  FILLER                   PIC  X(01)  VALUE '.'.      03470000
042460         10  PV-CURRENT-SECOND        PIC  9(02)  VALUE ZEROS.    03480000
042470         10  FILLER                   PIC  X(01)  VALUE '.'.      03490000
042480         10  PV-CURRENT-NANOSECOND    PIC  9(06)  VALUE ZEROS.    03500000
042500     05  PV-CURRENT-TMST              PIC  X(26)  VALUE SPACES.   03510000
042700     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0.        03520000
042800     05  PV-ADDR-COUNTER              PIC S9(04) VALUE +0.        03530000
042900     05  PV-STATE-PROV                PIC  X(30).                 03540000
043000     05  PV-COUNTRY                   PIC  X(30).                 03550000
043001     05  PV-DPKUT410-COMMAREA         PIC  X(01)  VALUE SPACES.   03560034
043001     05  PV-MAJOR-CLASS               PIC  9(04)  VALUE ZEROS.    03570035
043001     05  PV-SUB-CLASS                 PIC  9(04)  VALUE ZEROS.    03580035
      *CLP 11/03/14                                                     03590047
043001     05  PV-PO-NBR-PRINT.                                         03600019
042470         10  PV-PO-NBR-NUMERIC        PIC  9(08)  VALUE ZEROS.    03610047
043001     05  PV-PO-LNE-NBR-PRINT.                                     03620022
042470         10  PV-PO-LNE-NBR-NUMERIC    PIC  9(07)  VALUE ZEROS.    03630048
043002                                                                  03640000
043003 01  ADDR-LINE-TABLE.                                             03650000
043004     05  FILLER OCCURS 15 TIMES                                   03660000
043005           INDEXED BY ADDR-IDX.                                   03670000
043006         10  ADDR-LINE           PIC  X(40).                      03680000
043007                                                                  03690000
043008 01  ADDR-DESC-TABLE.                                             03700000
043009     05  FILLER OCCURS 4 TIMES                                    03710000
043010           INDEXED BY ADDR-DESC-IDX.                              03720000
043011         10  ADDR-DESC           PIC  X(40).                      03730000
043012                                                                  03740000
043013******************************************************************03750000
043014*  PURCHASE ORDER REPORT PRINT LINES                              03760000
043100******************************************************************03770000
043200                                                                  03780000
043300 01  HL1-HEADING-LINE-1.                                          03790000
043400     05  FILLER                          PIC  X(03)  VALUE SPACE. 03800000
043500     05  HL1-RUN-DATE.                                            03810000
043600         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  03820000
043700         10  FILLER                      PIC  X(01)  VALUE '/'.   03830000
043800         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  03840000
043900         10  FILLER                      PIC  X(01)  VALUE '/'.   03850000
044000         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  03860000
044100     05  FILLER                          PIC  X(02)  VALUE SPACE. 03870000
044200     05  HL1-RUN-TIME.                                            03880000
044300         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  03890000
044400         10  FILLER                      PIC  X(01)  VALUE ':'.   03900000
044500         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  03910000
044600     05  FILLER                          PIC  X(27)  VALUE SPACE. 03920000
044700     05  FILLER                          PIC  X(45)  VALUE        03930000
044800         'K O H L S   D E P A R T M E N T   S T O R E S'.         03940000
044900     05  FILLER                          PIC  X(20)  VALUE SPACE. 03950000
045000     05  HL1-PGM-NME                     PIC  X(08)  VALUE SPACE. 03960000
045100     05  FILLER                          PIC  X(01)  VALUE '-'.   03970000
045200     05  HL1-RPT-NBR                     PIC  9(01)  VALUE ZERO.  03980000
045300     05  FILLER                          PIC  X(02)  VALUE SPACE. 03990000
045400     05  FILLER                          PIC  X(04)  VALUE 'PAGE'.04000000
045500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04010000
045600     05  HL1-PG-NBR                      PIC ZZZZ9   VALUE ZERO.  04020000
045700                                                                  04030000
046220 01  HL2A-HEADING-LINE-2A.                                        04040000
046221     05  FILLER                          PIC  X(16)  VALUE SPACES.04050000
046223     05  FILLER                          PIC  X(22)  VALUE SPACES.04060000
046240     05  FILLER                          PIC  X(55)  VALUE        04070000
046250       'P U R C H A S E   O R D E R   -   T I C K E T   C O P Y'. 04080000
046280     05  FILLER                          PIC  X(39)  VALUE SPACE. 04090000
046300                                                                  04100000
046400 01  HLPO-HEADING-LINE-PO.                                        04110000
046500     05  FILLER                          PIC  X(16)  VALUE        04120000
046501         'PURCHASE ORDER: '.                                      04130000
046510     05  HLPO-PO-NBR                 PIC  ZZZZZZZZZ  VALUE ZEROES.04140000
046520     05  FILLER                          PIC  X(04)  VALUE SPACES.04150000
046530     05  FILLER                          PIC  X(14)  VALUE        04160000
046540         'LOCKER STOCK: '.                                        04170000
046550     05  HLPO-LOCKER-STOCK               PIC  X(03)  VALUE SPACES.04180000
046600     05  FILLER                          PIC  X(47)  VALUE SPACES.04190002
046600     05  FILLER                          PIC  X(15)  VALUE        04200002
046540         'DUNS NUMBER..: '.                                       04210002
046600     05  HLPO-DUNS-NBR                   PIC  X(09)  VALUE SPACES.04220002
046600     05  FILLER                          PIC  X(15)  VALUE SPACES.04230032
047610                                                                  04240000
054500 01  HL3A-HEADING-LINE-3A.                                        04250000
054600*    05  FILLER                          PIC  X(01)  VALUE SPACE. 04260000
054700     05  FILLER                          PIC  X(11)  VALUE        04270000
054800         'SEND TO..: '.                                           04280000
054900     05  HL3A-VENDOR                     PIC  X(40)  VALUE SPACE. 04290000
055000     05  FILLER                          PIC  X(03)  VALUE SPACE. 04300000
055100     05  FILLER                          PIC  X(28)  VALUE        04310000
055200         'TICKET QUANTITY...........: '.                          04320000
055300     05  HL3A-TKT-QTY                                             04330000
055310                                   PIC   ZZZZ,ZZ9 VALUE ZEROES.   04340000
055400     05  FILLER                          PIC  X(03)  VALUE SPACE. 04350000
055500     05  FILLER                          PIC  X(15)  VALUE        04360000
055600         'DEPARTMENT...: '.                                       04370000
055700     05  HL3A-DEPT-NBR                   PIC  X(03)  VALUE SPACE. 04380000
055800     05  FILLER                          PIC  X(03)  VALUE        04390000
055900         ' - '.                                                   04400000
056000     05  HL3A-DEPT-DESC                  PIC  X(20)  VALUE SPACE. 04410000
056100 01  HL4A-HEADING-LINE-4A.                                        04420000
056200     05  FILLER                          PIC  X(11)  VALUE SPACE. 04430000
056300     05  HL4A-ADDRESS                    PIC  X(40)  VALUE SPACE. 04440000
056400     05  FILLER                          PIC  X(03)  VALUE SPACE. 04450000
056500     05  FILLER                          PIC  X(28)  VALUE        04460000
056600         'ORDER DATE................: '.                          04470000
056700     05  HL4A-ORDER-DATE                 PIC  X(08)  VALUE SPACE. 04480000
056800     05  FILLER                          PIC  X(03)  VALUE SPACE. 04490000
056900     05  FILLER                          PIC  X(15)  VALUE        04500000
057000         'EDI..........: '.                                       04510000
057100     05  HL4A-EDI-IND                    PIC  X(03)  VALUE SPACE. 04520000
057200     05  FILLER                          PIC  X(21)  VALUE SPACE. 04530032
057300 01  HL5A-HEADING-LINE-5A.                                        04540000
057400     05  FILLER                          PIC  X(11)  VALUE SPACE. 04550000
057500     05  HL5A-ADDRESS                    PIC  X(40)  VALUE SPACE. 04560000
057600     05  FILLER                          PIC  X(03)  VALUE SPACE. 04570000
057700     05  FILLER                          PIC  X(28)  VALUE        04580000
057800         'DO NOT SHIP BEFORE........: '.                          04590000
057900     05  HL5A-DNSB-MONTH                 PIC  X(02)  VALUE SPACE. 04600000
058000     05  FILLER                          PIC  X(01)  VALUE '/'.   04610000
058100     05  HL5A-DNSB-DAY                   PIC  X(02)  VALUE SPACE. 04620000
058200     05  FILLER                          PIC  X(01)  VALUE '/'.   04630000
058300     05  HL5A-DNSB-YEAR                  PIC  X(02)  VALUE SPACE. 04640000
058400     05  FILLER                          PIC  X(03)  VALUE SPACE. 04650000
058500     05  FILLER                          PIC  X(15)  VALUE        04660000
058600         'NEW STORE....: '.                                       04670000
058700     05  HL5A-NEW-STR-IND                PIC  X(03)  VALUE SPACE. 04680000
058800     05  FILLER                          PIC  X(20)  VALUE SPACE. 04690032
058900 01  HL6A-HEADING-LINE-6A.                                        04700000
059000     05  FILLER                          PIC  X(11)  VALUE SPACE. 04710000
059100     05  HL6A-ADDRESS                    PIC  X(40)  VALUE SPACE. 04720000
059300     05  FILLER                          PIC  X(03)  VALUE SPACE. 04730000
059400     05  FILLER                          PIC  X(28)  VALUE        04740000
059500         'CANCEL IF NOT SHIPPED BY..: '.                          04750000
059600     05  HL6A-CNSB-MONTH                 PIC  X(02)  VALUE SPACE. 04760000
059700     05  FILLER                          PIC  X(01)  VALUE '/'.   04770000
059800     05  HL6A-CNSB-DAY                   PIC  X(02)  VALUE SPACE. 04780000
059900     05  FILLER                          PIC  X(01)  VALUE '/'.   04790000
060000     05  HL6A-CNSB-YEAR                  PIC  X(02)  VALUE SPACE. 04800000
060100     05  FILLER                          PIC  X(03)  VALUE SPACE. 04810000
060200     05  FILLER                          PIC  X(15)  VALUE        04820000
060300         'PACK BY STORE: '.                                       04830000
060400     05  HL6A-PK-BY-STORE-IND            PIC  X(03)  VALUE SPACE. 04840000
060500     05  FILLER                          PIC  X(21)  VALUE SPACE. 04850032
060600 01  HL7A-HEADING-LINE-7A.                                        04860000
060700     05  FILLER                          PIC  X(11)  VALUE SPACE. 04870000
060800     05  HL7A-ADDRESS                    PIC  X(40)  VALUE SPACE. 04880000
060900     05  FILLER                          PIC  X(03)  VALUE SPACE. 04890000
061000     05  FILLER                          PIC  X(28)  VALUE        04900000
061100         'REQUEST DATE .............: '.                          04910000
061200     05  HL7A-REQ-MONTH                  PIC  X(02)  VALUE SPACE. 04920000
061300     05  FILLER                          PIC  X(01)  VALUE '/'.   04930000
061400     05  HL7A-REQ-DAY                    PIC  X(02)  VALUE SPACE. 04940000
061500     05  FILLER                          PIC  X(01)  VALUE '/'.   04950000
061600     05  HL7A-REQ-YEAR                   PIC  X(02)  VALUE SPACE. 04960000
061700     05  FILLER                          PIC  X(03)  VALUE SPACE. 04970000
061800     05  FILLER                          PIC  X(15)  VALUE        04980000
061900         'CREATED BY ..: '.                                       04990000
062000     05  HL7A-CREATED-BY                 PIC  X(24)  VALUE SPACE. 05000000
062200 01  HL8A-HEADING-LINE-8A.                                        05010000
062300     05  FILLER                          PIC  X(11)  VALUE SPACE. 05020000
062400     05  HL8A-ADDRESS                    PIC  X(40)  VALUE SPACE. 05030000
062500     05  FILLER                          PIC  X(03)  VALUE SPACE. 05040000
062600     05  FILLER                          PIC  X(28)  VALUE        05050000
062700         'VENDOR DUE DATE ..........: '.                          05060000
062800     05  HL8A-VDR-MONTH                  PIC  X(02)  VALUE SPACE. 05070000
062900     05  FILLER                          PIC  X(01)  VALUE '/'.   05080000
063000     05  HL8A-VDR-DAY                    PIC  X(02)  VALUE SPACE. 05090000
063100     05  FILLER                          PIC  X(01)  VALUE '/'.   05100000
063200     05  HL8A-VDR-YEAR                   PIC  X(02)  VALUE SPACE. 05110000
063300     05  FILLER                          PIC  X(03)  VALUE SPACE. 05120000
063400     05  FILLER                          PIC  X(15)  VALUE        05130000
063500         'BUYER .......: '.                                       05140000
063600     05  HL8A-BUYER                      PIC  X(24)  VALUE SPACE. 05150000
063800 01  HL9A-HEADING-LINE-9A.                                        05160000
063900     05  FILLER                          PIC  X(11)  VALUE SPACE. 05170000
064000     05  HL9A-ADDRESS                    PIC  X(40)  VALUE SPACE. 05180000
064100     05  FILLER                          PIC  X(42)  VALUE SPACE. 05190000
065000     05  FILLER                          PIC  X(15)  VALUE        05200000
065100         'APPROVED BY..: '.                                       05210000
065200     05  HL9A-APPROVED-BY                PIC  X(24)  VALUE SPACE. 05220000
065301                                                                  05230000
065302 01  HL10A-HEADING-LINE-10A.                                      05240000
065303     05  FILLER                          PIC  X(11)  VALUE SPACE. 05250000
065304     05  HL10A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05260000
065305     05  FILLER                          PIC  X(81)  VALUE SPACE. 05270032
065306                                                                  05280000
065307 01  HL11A-HEADING-LINE-11A.                                      05290000
065308     05  FILLER                          PIC  X(11)  VALUE SPACE. 05300000
065309     05  HL11A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05310000
065310     05  FILLER                          PIC  X(81)  VALUE SPACE. 05320032
065311                                                                  05330000
065312 01  HL12A-HEADING-LINE-12A.                                      05340000
065320     05  FILLER                          PIC  X(11)  VALUE SPACE. 05350000
065330     05  HL12A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05360000
065340     05  FILLER                          PIC  X(50)  VALUE SPACE. 05370000
065350     05  FILLER                          PIC  X(30)  VALUE SPACE. 05380032
065351                                                                  05390000
065352 01  HL13A-HEADING-LINE-13A.                                      05400000
065353     05  FILLER                          PIC  X(11)  VALUE SPACE. 05410000
065354     05  HL13A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05420000
065355     05  FILLER                          PIC  X(50)  VALUE SPACE. 05430000
065356     05  FILLER                          PIC  X(30)  VALUE SPACE. 05440032
065357                                                                  05450000
065358 01  HL14A-HEADING-LINE-14A.                                      05460000
065359     05  FILLER                          PIC  X(11)  VALUE SPACE. 05470000
065360     05  HL14A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05480000
065361     05  FILLER                          PIC  X(50)  VALUE SPACE. 05490000
065362     05  FILLER                          PIC  X(30)  VALUE SPACE. 05500032
065363                                                                  05510000
065364 01  HL15A-HEADING-LINE-15A.                                      05520000
065365     05  FILLER                          PIC  X(11)  VALUE SPACE. 05530000
065366     05  HL15A-ADDRESS                   PIC  X(40)  VALUE SPACE. 05540000
065367     05  FILLER                          PIC  X(50)  VALUE SPACE. 05550000
065368     05  FILLER                          PIC  X(30)  VALUE SPACE. 05560032
066400                                                                  05570000
065500 01  DL1-HEADING-LINE-1.                                          05580015
065600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05590005
065700     05  FILLER                          PIC  X(42)  VALUE        05600005
065800         'LNE  CLASS/SUB     VENDOR STYLE           '.            05610015
065900     05  FILLER                          PIC  X(48)  VALUE        05620005
066000         'SKU DESCRIPTION                COLOR        SIZE'.      05630005
054200     05  FILLER                          PIC  X(35)  VALUE        05640005
054300         '          QTY    RETAIL         UPC'.                   05650005
066400                                                                  05660005
071400 01  SKU-LINE-1.                                                  05670005
071500     05  SL1-LNE-NBR                  PIC  9999.                  05680005
071600     05  FILLER                       PIC  X(04) VALUE SPACE.     05690005
071900     05  SL1-MAJOR-CLASS              PIC  9(02).                 05700036
072000     05  FILLER                       PIC  X(01) VALUE SPACE.     05710005
072100     05  SL1-SUB-CLASS                PIC  9(02).                 05720036
072200     05  FILLER                       PIC  X(07) VALUE SPACE.     05730005
072300     05  SL1-STYLE                    PIC  X(20).                 05740005
072400     05  FILLER                       PIC  X(03) VALUE SPACE.     05750005
072500     05  SL1-DESC                     PIC  X(30).                 05760005
072600     05  FILLER                       PIC  X(01) VALUE SPACE.     05770005
072700     05  SL1-COLOR                    PIC  X(10) VALUE SPACE.     05780005
072800     05  FILLER                       PIC  X(02) VALUE SPACE.     05790005
072900     05  SL1-SIZE                     PIC  X(10).                 05800005
073000     05  FILLER                       PIC  X(01) VALUE SPACE.     05810005
073100     05  SL1-QTY                      PIC  ZZZ,ZZZ.               05820005
073200     05  FILLER                       PIC  X(02) VALUE SPACE.     05830005
073300     05  SL1-RETAIL                   PIC  Z,ZZZ.ZZ.              05840005
073400     05  FILLER                       PIC  X(03) VALUE SPACE.     05850005
073300     05  SL1-UPC-X.                                               05860045
073300         10  SL1-UPC                  PIC  9(12) VALUE ZEROS.     05870046
073600                                                                  05880005
073700 01  SKU-LINE-2.                                                  05890005
073800     05  FILLER                       PIC  X(06) VALUE SPACE.     05900005
073900     05  FILLER                       PIC  X(13) VALUE            05910005
074000         'TICKET TYPE: '.                                         05920005
074100     05  SL2-TICKET-TYPE              PIC  X(20).                 05930005
073800     05  FILLER                       PIC  X(01) VALUE SPACE.     05940005
073900     05  FILLER                       PIC  X(18) VALUE            05950005
074000         'TICKET PLACEMENT: '.                                    05960005
074100     05  SL2-TICKET-PLACEMENT         PIC  X(50).                 05970005
074200     05  FILLER                       PIC  X(24) VALUE SPACE.     05980032
069200*                                                                 05990005
078000 01  END-REPORT-LINE.                                             06000000
078100     05  FILLER                       PIC  X(55) VALUE SPACE.     06010032
078200     05  FILLER                       PIC  X(21) VALUE            06020000
078300         'END OF PURCHASE ORDER'.                                 06030000
078400     05  FILLER                       PIC  X(56) VALUE SPACE.     06040032
078500                                                                  06050000
080100******************************************************************06060000
080200*  CURSOR FOR PO LINE ITEMS NOT APPROVED                          06070000
080300******************************************************************06080000
080400     EXEC SQL                                                     06090000
080500         DECLARE PO-LINE-CSR CURSOR FOR                           06100000
080600      SELECT  A.CL_NBR,                                           06110000
080700              A.SKU_SEQ_NBR,                                      06120000
080800              A.VEND_STYL_NAME,                                   06130000
080900              A.SKU_DESC,                                         06140000
081000              A.UNT_QTY,                                          06150000
081100              A.UNT_COST_AMT,                                     06160000
081200              A.TOT_VAL_COST_AMT,                                 06170000
081300              A.COLOR_DESC,                                       06180000
081400              A.SIZE_DESC,                                        06190000
081500              A.AD_EVNT_DTE,                                      06200000
081600              A.GP_QTY,                                           06210000
081700              A.GP_RTL_AMT,                                       06220000
081800              A.UNT_RTL_PR_AMT,                                   06230000
081900              A.TOT_VAL_RTL_AMT,                                  06240000
082000              A.PO_LNE_NBR,                                       06250000
082100              A.STATUS_CDE,                                       06260000
082110              A.ITM_NBR,                                          06270000
082200              B.PO_LNE_NBR,                                       06280000
082300              B.TKT_DESC,                                         06290000
082400              B.TKT_PLCMNT_CDE,                                   06300000
082401              B.TKT_QTY,                                          06310000
082410              C.TKT_PLCMNT_DESC                                   06320000
082500         FROM   TPURITM A                                         06330000
082600               ,TPTKLNE B                                         06340000
082610               ,TPLDESC C                                         06350000
082700         WHERE  A.PO_NBR = :DK-ORD-NBR                            06360000
082800           AND  B.PO_REQ_NBR = :DK-ORD-REQ-NBR                    06370000
082900           AND  A.PO_LNE_NBR = B.PO_LNE_NBR                       06380000
083000           AND  A.VER_STATUS_CDE = 'A'                            06390000
083010           AND  B.TKT_PLCMNT_CDE = C.TKT_PLCMNT_CDE               06400000
083100         ORDER BY A.PO_LNE_NBR                                    06410000
083200                 ,B.PO_LNE_NBR                                    06420000
083300     END-EXEC.                                                    06430000
083400******************************************************************06440000
083500*  CURSOR FOR PO LINE ITEMS APPROVED                              06450000
083600******************************************************************06460000
083700     EXEC SQL                                                     06470000
083800         DECLARE APP-PO-LINE-CSR CURSOR FOR                       06480000
083900       SELECT A.CL_NBR,                                           06490000
084000              A.SKU_SEQ_NBR,                                      06500000
084100              A.VEND_STYL_NAME,                                   06510000
084200              A.SKU_DESC,                                         06520000
084300              A.UNT_QTY,                                          06530000
084400              A.UNT_COST_AMT,                                     06540000
084500              A.TOT_VAL_COST_AMT,                                 06550000
084600              A.COLOR_DESC,                                       06560000
084700              A.SIZE_DESC,                                        06570000
084800              A.AD_EVNT_DTE,                                      06580000
084900              A.GP_QTY,                                           06590000
085000              A.GP_RTL_AMT,                                       06600000
085100              A.UNT_RTL_PR_AMT,                                   06610000
085200              A.TOT_VAL_RTL_AMT,                                  06620000
085300              A.PO_LNE_NBR,                                       06630000
085400              A.APP_PO_LNE_NBR,                                   06640000
085500              A.STATUS_CDE,                                       06650000
085510              A.ITM_NBR,                                          06660000
085600              B.PO_LNE_NBR,                                       06670000
085700              B.TKT_DESC,                                         06680000
085800              B.TKT_PLCMNT_CDE,                                   06690000
085810              C.TKT_PLCMNT_DESC                                   06700000
085900         FROM   TPURITM A                                         06710000
086000               ,TPTKLNE B                                         06720000
086010               ,TPLDESC C                                         06730000
086100         WHERE  A.PO_NBR = :DK-ORD-NBR                            06740000
086200           AND  B.PO_REQ_NBR = :DK-ORD-REQ-NBR                    06750000
086300           AND  A.PO_LNE_NBR = B.PO_LNE_NBR                       06760000
086400           AND  A.VER_STATUS_CDE = 'A'                            06770000
086410           AND  B.TKT_PLCMNT_CDE = C.TKT_PLCMNT_CDE               06780000
086500         ORDER BY A.APP_PO_LNE_NBR                                06790000
086600                 ,B.PO_LNE_NBR                                    06800000
086700     END-EXEC.                                                    06810000
086800                                                                  06820000
086900******************************************************************06830000
087000 LINKAGE SECTION.                                                 06840000
087100******************************************************************06850000
087200 01  DFHCOMMAREA                   PIC X(11).                     06860000
087300                                                                  06870000
087400******************************************************************06880000
087500 PROCEDURE DIVISION.                                              06890000
087600******************************************************************06900000
087700                                                                  06910000
087800******************************************************************06920000
087900*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   06930000
088000******************************************************************06940000
088100 0000-PROGRAM-MAINLINE.                                           06950000
088201     MOVE LENGTH OF VL010-PO-PRINT-COMMAREA                       06960000
088202                                   TO PV-COMMAREA-LENGTH.         06970000
088205     EXEC CICS                                                    06980000
088206         RETRIEVE                                                 06990000
088207         INTO     (VL010-PO-PRINT-COMMAREA)                       07000000
088208         LENGTH   (PV-COMMAREA-LENGTH)                            07010000
088209         RESP     (PV-CICS-RESPONSE)                              07020000
088210     END-EXEC.                                                    07030000
088211                                                                  07040000
088212     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      07050000
088213         CONTINUE                                                 07060000
088214     ELSE                                                         07070000
088216         SET DP013-CICS-ABEND      TO  TRUE                       07080000
088217         SET DP013-NO-ROLLBACK     TO  TRUE                       07090000
088218         MOVE '0000-PROGRAM-MAINLINE'                             07100000
088219                                   TO  DP013-PARAGRAPH            07110000
088220         MOVE 'ATTEMPTING TO RETRIEVE COMMAREA'                   07120000
088221                                   TO  DP013-MESSAGE-TEXT(1)      07130013
088222         PERFORM DP014-0000-PROCESS-ABEND                         07140000
088223     END-IF.                                                      07150000
088230                                                                  07160000
088300     PERFORM 1000-INITIALIZE.                                     07170000
088400     PERFORM 2000-PROCESS-REPORT.                                 07180000
088410     PERFORM 9000-EOJ-ROUTINE.                                    07190000
088500                                                                  07200000
088600     EXEC CICS                                                    07210000
088610         RETURN                                                   07220000
088620     END-EXEC.                                                    07230000
088700                                                                  07240000
088800******************************************************************07250000
088900*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          07260000
089000******************************************************************07270000
089100 1000-INITIALIZE.                                                 07280000
089300     EXEC SQL                                                     07290000
089400         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 07300000
089410     END-EXEC                                                     07310000
089411                                                                  07320000
089412     EVALUATE TRUE                                                07330000
089413         WHEN SQLCODE = +0                                        07340000
089414             CONTINUE                                             07350000
089419         WHEN OTHER                                               07360000
089420             MOVE '1000-INITIALIZE' TO DP013-PARAGRAPH            07370000
089421             MOVE 'GET THE CURRENT TIMESTAMP'                     07380000
089422                             TO DP013-MESSAGE-TEXT (1)            07390000
089423             MOVE SQLCA            TO DP013-SQLCA                 07400000
089424             MOVE 'NONE   '        TO DP013-DB2-TABLE-NAME (1)    07410000
089425             SET DP013-DB2-ABEND   TO TRUE                        07420000
089426             SET DP013-NO-ROLLBACK TO TRUE                        07430000
089427             PERFORM DP014-0000-PROCESS-ABEND                     07440000
089428        END-EVALUATE                                              07450000
089429                                                                  07460000
089430     MOVE PV-CURRENT-TMST  TO PV-CURRENT-TMST-RDF.                07470000
089600     MOVE PV-CURRENT-MONTH    TO  HL1-RUN-MONTH.                  07480000
089700     MOVE PV-CURRENT-DAY      TO  HL1-RUN-DAY.                    07490000
089800     MOVE PV-CURRENT-YEAR     TO  HL1-RUN-YEAR.                   07500000
090000     MOVE PV-CURRENT-HOUR     TO  HL1-RUN-HOUR.                   07510000
090100     MOVE PV-CURRENT-MINUTE   TO  HL1-RUN-MINUTE.                 07520000
090110                                                                  07530000
090200     MOVE PC-CURRENT-PROGRAM-NAME                                 07540000
090210                              TO  HL1-PGM-NME.                    07550000
090300     MOVE 1                   TO  HL1-RPT-NBR.                    07560000
090400                                                                  07570000
090500     MOVE VL010-PO-NBR        TO PV-PO-NBR                        07580000
090600                                 DK-ORD-NBR.                      07590000
090700     MOVE VL010-PO-REQ-NBR    TO DK-ORD-REQ-NBR.                  07600005
090801     MOVE VL010-TASK-ID       TO PC-RID-1A.                       07610005
090802                                                                  07620005
090804                                                                  07630000
090805* SET-UP DRS TO PRINT REPORT (INIT CALL IS DONE HERE)             07640005
090806     MOVE PC-INIT                 TO  DRS01-DRRB-FUNC.            07650000
090807                                                                  07660000
090808     MOVE VL010-DEST              TO  DRS02-DRIB-DEST             07670000
090814     MOVE PC-FORM-STD             TO  DRS02-DRIB-FORM.            07680000
090815     MOVE +2                      TO  DRS02-DRIB-COPIES.          07690000
090823*                                                                 07700000
090825     MOVE DRS02-DRIB-HEADER       TO  DRS01-COMM-DRIB-HDR.        07710000
090826     MOVE DRS02-DRIB-ATTRIB       TO  DRS01-COMM-DRIB-AT1.        07720000
090828                                                                  07730000
090830     PERFORM 9001-LINK-TO-DRS-1.                                  07740000
090833*                                                                 07750000
090840     MOVE PC-PUT                  TO DRS01-DRRB-FUNC.             07760000
091100                                                                  07770000
091200******************************************************************07780000
091300*  CONTROLS REPORT PROCESSING                                     07790000
091400******************************************************************07800000
091500 2000-PROCESS-REPORT.                                             07810000
091600     MOVE +1                       TO PV-PAGE-CNT.                07820000
091700     MOVE PV-PAGE-CNT              TO HL1-PG-NBR.                 07830000
091800     MOVE +0                       TO PV-LINE-CNT.                07840000
091900                                                                  07850000
092000     PERFORM 2100-PROCESS-HEADER.                                 07860000
092100     PERFORM 2300-PROCESS-SKUS.                                   07870000
092200                                                                  07880000
092300     IF PV-LINE-CNT > +57                                         07890000
092400         ADD +1                    TO PV-PAGE-CNT                 07900000
092500         MOVE PV-PAGE-CNT          TO HL1-PG-NBR                  07910000
092600         MOVE +0                   TO PV-LINE-CNT                 07920000
092720         PERFORM 2117-PRINT-HEADINGS                              07930000
094100     END-IF.                                                      07940000
094101                                                                  07950000
094102     MOVE END-REPORT-LINE              TO DRS01-COMM-DATA.        07960000
094103     MOVE PC-TRIPLE-SPACE              TO DRS01-COMM-CTL.         07970000
094104     PERFORM 9001-LINK-TO-DRS-1.                                  07980000
094200                                                                  07990000
095600******************************************************************08000000
095700*  CONTROLS HEADER PROCESSING                                     08010000
095800******************************************************************08020000
095900 2100-PROCESS-HEADER.                                             08030000
096100     PERFORM 2101-GET-TPURCHS.                                    08040000
096200     MOVE '01'                     TO ENTNME-TYPE-CDE.            08050000
096300     PERFORM 2102-GET-TENTNME.                                    08060000
096400     MOVE ENTNME-ENT-NAME-DESC     TO HL3A-VENDOR.                08070003
096500                                                                  08080003
096510     PERFORM 2118-GET-TICKET-QTY.                                 08090000
096520     MOVE    PV-REQ-PRETKT-QTY     TO HL3A-TKT-QTY.               08100003
096530                                                                  08110003
096600     MOVE EXTENT-DUN-NBR           TO HLPO-DUNS-NBR.              08120003
096600                                                                  08130003
096610     PERFORM 2113-GET-PRETKT-REQ.                                 08140000
096700     PERFORM 2103-GET-TBUSLOC.                                    08150000
096710                                                                  08160000
096800     PERFORM 2104-GET-TPLNSHP.                                    08170000
096900     PERFORM 2106-GET-TPOAGMT-2.                                  08180000
097000     MOVE '1'                      TO POAGMT-TYP-CDE.             08190000
097100     PERFORM 2107-GET-TPOAGMT-4.                                  08200000
097200     MOVE '4'                      TO POAGMT-TYP-CDE.             08210000
097300     PERFORM 2107-GET-TPOAGMT-4.                                  08220000
097400     IF SQLCODE = +0                                              08230000
097500         MOVE 'YES'                TO HL6A-PK-BY-STORE-IND        08240000
097600     ELSE                                                         08250000
097700         MOVE 'NO '                TO HL6A-PK-BY-STORE-IND        08260000
097800     END-IF.                                                      08270000
097900     PERFORM 2110-GET-TMDSEAR.                                    08280000
098000     PERFORM 2111-GET-BUYER.                                      08290000
098100     MOVE PURCHS-CRE-BY-UID        TO WORKER-UID-NBR.             08300000
098200     PERFORM 2108-GET-TWORKER.                                    08310000
098300     IF SQLCODE = +0 OR -811                                      08320000
098400         MOVE 20                   TO DP024-FLNAME-LENGTH         08330000
098500         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 08340000
098600         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 08350000
098700         PERFORM DP024-0000-FORMAT-NAME                           08360000
098800         MOVE DP024-FLNAME         TO HL7A-CREATED-BY             08370000
098900     ELSE                                                         08380000
099000         IF PURCHS-PO-TYP-CDE = 'MS'                              08390000
099100             MOVE 'MODEL STOCK'    TO HL7A-CREATED-BY             08400000
099200         ELSE                                                     08410000
099300             IF PURCHS-PO-TYP-CDE = 'VN'                          08420005
181356             OR PURCHS-PO-TYP-CDE = 'VE'                          08430050
099400                 MOVE 'VENDOR GENERATED' TO HL7A-CREATED-BY       08440005
099500             ELSE                                                 08450005
099600                 IF (PURCHS-PO-TYP-CDE = 'IN'                     08460049
181356                 OR  PURCHS-PO-TYP-CDE = 'RE') OR                 08470050
099610                    (PURCHS-PO-TYP-CDE = 'EC' AND                 08480005
099620                     PURCHS-CRE-BY-UID = 'INFOREM')               08490005
099700                     MOVE 'INFOREM     '   TO HL7A-CREATED-BY     08500005
099800                 ELSE                                             08510005
099900                     MOVE SPACE            TO HL7A-CREATED-BY     08520005
100000                 END-IF                                           08530005
100100             END-IF                                               08540005
100200         END-IF                                                   08550000
100300     END-IF.                                                      08560000
100400     MOVE PURCHS-APP-BY-UID        TO WORKER-UID-NBR.             08570000
100500     PERFORM 2108-GET-TWORKER.                                    08580000
100600     IF SQLCODE = +0 OR -811                                      08590000
100700         MOVE 20                   TO DP024-FLNAME-LENGTH         08600000
100800         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 08610000
100900         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 08620000
101000         PERFORM DP024-0000-FORMAT-NAME                           08630000
101100         MOVE DP024-FLNAME         TO HL9A-APPROVED-BY            08640000
101200     ELSE                                                         08650000
101300         IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                      08660000
101400             PERFORM 2112-GET-DMM                                 08670000
101500         ELSE                                                     08680000
101600             MOVE SPACE            TO HL9A-APPROVED-BY            08690000
101700         END-IF                                                   08700000
101800     END-IF.                                                      08710000
102001     PERFORM 2117-PRINT-HEADINGS.                                 08720000
107800                                                                  08730000
107900******************************************************************08740000
108000*  RETRIEVES AND FORMATS PO DATA ON TPURCHS                       08750000
108100******************************************************************08760000
108200 2101-GET-TPURCHS.                                                08770000
108300     PERFORM                                                      08780000
108400         WITH TEST AFTER                                          08790000
108500         VARYING PV-RETRY-COUNTER                                 08800000
108600         FROM 1 BY 1                                              08810000
108700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08820000
108800             OR (SQLCODE = +0)                                    08830000
108900             OR (SQLCODE = +100))                                 08840000
109000                                                                  08850000
109100     EXEC SQL                                                     08860000
109200         SELECT ORD_DTE,                                          08870000
109300                PO_TYP_CDE,                                       08880000
109400                STATUS_CDE,                                       08890000
109500                ENT_ID,                                           08900000
109600                TOT_MU_PCT,                                       08910000
109700                TOT_VAL_COST_AMT,                                 08920000
109800                TOT_VAL_RTL_AMT,                                  08930000
109900                TOT_UNT_QTY,                                      08940000
110100                EDI_IND,                                          08950000
110200                NEW_STR_PO_IND,                                   08960000
110300                CRE_BY_UID,                                       08970000
110400                APP_BY_UID,                                       08980000
110500                DEPT_NBR,                                         08990000
110600                ADR_SEQ_NBR,                                      09000000
110700                REVISION_CT,                                      09010000
110800                DEST_KNOWN_IND                                    09020000
110900         INTO  :PURCHS-ORD-DTE,                                   09030000
111000               :PURCHS-PO-TYP-CDE,                                09040000
111100               :PURCHS-STATUS-CDE,                                09050000
111200               :PURCHS-ENT-ID,                                    09060000
111300               :PURCHS-TOT-MU-PCT,                                09070000
111400               :PURCHS-TOT-VAL-COST-AMT,                          09080000
111500               :PURCHS-TOT-VAL-RTL-AMT,                           09090000
111600               :PURCHS-TOT-UNT-QTY,                               09100000
111800               :PURCHS-EDI-IND,                                   09110000
111900               :PURCHS-NEW-STR-PO-IND,                            09120000
112000               :PURCHS-CRE-BY-UID,                                09130000
112100               :PURCHS-APP-BY-UID,                                09140000
112200               :PURCHS-DEPT-NBR,                                  09150000
112300               :PURCHS-ADR-SEQ-NBR,                               09160000
112400               :PURCHS-REVISION-CT,                               09170000
112500               :PURCHS-DEST-KNOWN-IND                             09180000
112600         FROM TPURCHS                                             09190000
112700         WHERE PO_NBR         = :DK-ORD-NBR                       09200000
112800           AND VER_STATUS_CDE = 'A'                               09210000
112900           AND PO_CATEG_CDE   = 'MR'                              09220000
113000     END-EXEC                                                     09230000
113100                                                                  09240000
113200     EVALUATE TRUE                                                09250000
113300         WHEN SQLCODE = +0                                        09260000
113400         WHEN SQLCODE = -904                                      09270000
113500         WHEN SQLCODE = -911                                      09280000
113600         WHEN SQLCODE = -913                                      09290000
113700             CONTINUE                                             09300000
113800         WHEN SQLWARN NOT = SPACE                                 09310000
113900         WHEN SQLCODE NOT = +0                                    09320000
114000             MOVE '2101-GET-TPURCHS' TO DP013-PARAGRAPH           09330000
114200             MOVE 'SELECT TPURCHS      '                          09340000
114300                             TO DP013-MESSAGE-TEXT (1)            09350000
114400             MOVE SQLCA            TO DP013-SQLCA                 09360000
114500             MOVE 'TPURCHS'        TO DP013-DB2-TABLE-NAME (1)    09370000
114600             SET DP013-DB2-ABEND   TO TRUE                        09380000
114700             SET DP013-NO-ROLLBACK TO TRUE                        09390000
114800             PERFORM DP014-0000-PROCESS-ABEND                     09400000
114900        END-EVALUATE                                              09410000
115000     END-PERFORM.                                                 09420000
115010                                                                  09430000
115100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09440000
115110         MOVE '2101-GET-TPURCHS' TO DP013-PARAGRAPH               09450000
115120         MOVE 'SELECT TPURCHS      '                              09460000
115130                                 TO DP013-MESSAGE-TEXT (1)        09470000
115140         MOVE SQLCA              TO DP013-SQLCA                   09480000
115150         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      09490000
115160         SET DP013-DB2-ABEND     TO TRUE                          09500000
115170         SET DP013-NO-ROLLBACK   TO TRUE                          09510000
115180         PERFORM DP014-0000-PROCESS-ABEND                         09520000
115500     END-IF.                                                      09530000
115600                                                                  09540000
115700     MOVE VL010-PO-NBR             TO HLPO-PO-NBR.                09550000
115800                                                                  09560000
115900     MOVE PURCHS-DEPT-NBR          TO HL3A-DEPT-NBR.              09570000
116000     IF PURCHS-ORD-DTE = PC-INIT-DATE                             09580000
116100         MOVE SPACE                TO HL4A-ORDER-DATE             09590000
116200     ELSE                                                         09600000
116300         MOVE PURCHS-ORD-DTE       TO PV-DATE-BREAK               09610000
116400         MOVE PV-DB-MM             TO PV-DBS-MM                   09620000
116500         MOVE PV-DB-DD             TO PV-DBS-DD                   09630000
116600         MOVE PV-DB-YY             TO PV-DBS-YY                   09640000
116700         MOVE PV-DATE-BREAK-SLASH  TO HL4A-ORDER-DATE             09650000
116800     END-IF.                                                      09660000
116900     IF PURCHS-EDI-IND = 'Y'                                      09670000
117000         MOVE 'YES'                TO HL4A-EDI-IND                09680000
117100     ELSE                                                         09690000
117200         MOVE 'NO '                TO HL4A-EDI-IND                09700000
117300     END-IF.                                                      09710000
117400     IF PURCHS-NEW-STR-PO-IND = 'Y'                               09720000
117500         MOVE 'YES'                TO HL5A-NEW-STR-IND            09730000
117600     ELSE                                                         09740000
117700         MOVE 'NO '                TO HL5A-NEW-STR-IND            09750000
117800     END-IF.                                                      09760000
117900                                                                  09770000
118000******************************************************************09780000
118100*  RETRIEVES AND FORMATS PO DATA ON TENTNME                       09790000
118200******************************************************************09800000
118300 2102-GET-TENTNME.                                                09810000
118500         EXEC SQL                                                 09820000
118600             SELECT A.ENT_NAME_DESC                               09830000
118700                  , B.DUN_NBR                                     09840000
118800              INTO  :ENTNME-ENT-NAME-DESC                         09850000
118900                  , :EXTENT-DUN-NBR                               09860000
119000              FROM  TENTNME A                                     09870000
119100                 ,  TEXTENT B                                     09880000
119200              WHERE A.ENT_ID   = :PURCHS-ENT-ID                   09890000
119300                AND A.ENT_ID   = B.ENT_ID                         09900000
119400                AND A.TYPE_CDE = :ENTNME-TYPE-CDE                 09910000
119500         END-EXEC                                                 09920000
119600                                                                  09930000
119800     EVALUATE TRUE                                                09940000
119900         WHEN SQLCODE = +0                                        09950000
120100             CONTINUE                                             09960005
120000         WHEN SQLCODE = +100                                      09970000
121000             MOVE SPACE TO ENTNME-ENT-NAME-DESC                   09980005
120200         WHEN SQLWARN NOT = SPACE                                 09990000
120300         WHEN SQLCODE NOT = +0                                    10000000
120400             MOVE '2102-GET-TENTNME'  TO DP013-PARAGRAPH          10010000
120500             MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1) 10020000
120510             MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2) 10030000
120511             SET DP013-DB2-ABEND   TO TRUE                        10040000
120512             SET DP013-NO-ROLLBACK TO TRUE                        10050000
120520             MOVE SQLCA            TO DP013-SQLCA                 10060000
120600             PERFORM DP014-0000-PROCESS-ABEND                     10070000
120700     END-EVALUATE.                                                10080000
120800                                                                  10090000
121400******************************************************************10100000
121500*  RETRIEVES AND FORMATS PO DATA ON TBUSLOC                       10110000
121600******************************************************************10120000
121700 2103-GET-TBUSLOC.                                                10130000
121900     EXEC SQL                                                     10140000
122000         SELECT A.ADDRESS_LINE1_DESC,                             10150000
122100                A.ADDRESS_LINE2_DESC,                             10160000
122110                A.ADDRESS_LINE3_DESC,                             10170000
122120                A.ADDRESS_LINE4_DESC,                             10180000
122200                A.ATTENTION_TO_TXT,                               10190000
122300                A.CITY_NAME,                                      10200000
122410                A.ST_PROV_CDE,                                    10210000
122500                A.ZIP_CDE,                                        10220000
122510                A.CNTRY_CDE,                                      10230000
122701                A.ROOM_NBR,                                       10240000
122710                B.FIRST_NAME,                                     10250000
122720                B.LAST_NAME,                                      10260000
122800                B.TITLE_NAME,                                     10270000
122900                B.TEL1_NBR,                                       10280000
123000                B.TEL1_EXT_NBR                                    10290000
123100         INTO  :BUSLOC-ADDRESS-LINE1-DESC,                        10300000
123200               :BUSLOC-ADDRESS-LINE2-DESC,                        10310000
123210               :BUSLOC-ADDRESS-LINE3-DESC,                        10320000
123220               :BUSLOC-ADDRESS-LINE4-DESC,                        10330000
123300               :BUSLOC-ATTENTION-TO-TXT,                          10340000
123400               :BUSLOC-CITY-NAME,                                 10350000
123510               :BUSLOC-ST-PROV-CDE,                               10360000
123600               :BUSLOC-ZIP-CDE,                                   10370000
123700               :BUSLOC-CNTRY-CDE,                                 10380000
123801               :BUSLOC-ROOM-NBR,                                  10390000
123810               :ENTREP-FIRST-NAME,                                10400000
123820               :ENTREP-LAST-NAME,                                 10410000
123900               :ENTREP-TITLE-NAME,                                10420000
124000               :ENTREP-TEL1-NBR,                                  10430000
124100               :ENTREP-TEL1-EXT-NBR                               10440000
124200         FROM TBUSLOC A                                           10450000
124300             ,TENTREP B                                           10460000
124400         WHERE A.ENT_ID = :PURCHS-ENT-ID                          10470000
124500               AND A.ENT_ID         = B.ENT_ID                    10480000
124600               AND A.FUNCTION_ID    = 5                           10490000
124700               AND B.FUNCTION_ID    = A.FUNCTION_ID               10500000
124800               AND A.SEQ_NBR = :PTKREQ-ADDR-SEQ-NBR               10510000
124900               AND B.ENT_BUS_LOC_ID = A.SEQ_NBR                   10520000
125000     END-EXEC.                                                    10530000
125100                                                                  10540000
125200     EVALUATE TRUE                                                10550000
125300         WHEN SQLCODE = +0                                        10560000
125400         WHEN SQLCODE = +100                                      10570000
125500             CONTINUE                                             10580000
125600         WHEN SQLWARN NOT = SPACE                                 10590000
125700         WHEN SQLCODE NOT = +0                                    10600000
125800             MOVE '2103-GET-TBUSLOC'                              10610000
125910                                      TO DP013-PARAGRAPH          10620000
125920             MOVE 'TBUSLOC'           TO DP013-DB2-TABLE-NAME (1) 10630000
125930             MOVE 'TENTREP'           TO DP013-DB2-TABLE-NAME (2) 10640000
125931             SET DP013-DB2-ABEND   TO TRUE                        10650000
125932             SET DP013-NO-ROLLBACK TO TRUE                        10660000
125933             MOVE SQLCA            TO DP013-SQLCA                 10670000
125940             PERFORM DP014-0000-PROCESS-ABEND                     10680000
126100     END-EVALUATE.                                                10690000
126200                                                                  10700000
126300     IF SQLCODE = +100                                            10710000
126400         MOVE SPACE                TO HL4A-ADDRESS                10720003
126610                                      HL5A-ADDRESS                10730000
126700                                      HL6A-ADDRESS                10740000
127300                                      HL7A-ADDRESS                10750000
127500                                      HL8A-ADDRESS                10760000
127700                                      HL9A-ADDRESS                10770000
127900                                      HL10A-ADDRESS               10780000
127930                                      HL11A-ADDRESS               10790000
127950                                      HL12A-ADDRESS               10800000
127970                                      HL13A-ADDRESS               10810000
127972                                      HL14A-ADDRESS               10820000
127974                                      HL15A-ADDRESS               10830000
128000     ELSE                                                         10840000
128100         IF BUSLOC-CNTRY-CDE = 'US ' OR SPACES                    10850000
128200             MOVE SPACES             TO PV-COUNTRY                10860000
128300                                        PV-STATE-PROV             10870000
128400             MOVE BUSLOC-ST-PROV-CDE TO PV-STATE-PROV             10880000
128500         ELSE                                                     10890000
128600           PERFORM 2105-RETRIEVE-ST-PRV-CNTY-NAME                 10900000
128601         END-IF                                                   10910000
128602         PERFORM  2115-MOVE-ADDR-TO-TABLE                         10920000
128603         SET ADDR-IDX TO 1                                        10930000
132520         PERFORM  2116-UNLOAD-ADDR-TABLE  UNTIL                   10940000
132522             PS-EOF-ADDR-TBL                                      10950000
132530     END-IF.                                                      10960000
132600******************************************************************10970000
132700*  RETRIEVES AND FORMATS PO DATA ON TPLNSHP                       10980000
132800******************************************************************10990000
132900 2104-GET-TPLNSHP.                                                11000000
133100     EXEC SQL                                                     11010000
133200         SELECT FOB_POINT_TXT,                                    11020000
133300                FRGT_PAYT_CDE,                                    11030000
133400                DONT_SHIP_BEF_DTE,                                11040000
133500                CAN_IFNOT_SHIP_DTE,                               11050000
133600                EXT_CAN_DTE                                       11060000
133700         INTO  :PLNSHP-FOB-POINT-TXT,                             11070000
133800               :PLNSHP-FRGT-PAYT-CDE,                             11080000
133900               :PLNSHP-DONT-SHIP-BEF-DTE,                         11090000
134000               :PLNSHP-CAN-IFNOT-SHIP-DTE,                        11100000
134100               :PLNSHP-EXT-CAN-DTE                                11110000
134200         FROM TPLNSHP                                             11120000
134300         WHERE PO_NBR = :DK-ORD-NBR                               11130000
134400           AND VER_STATUS_CDE = 'A'                               11140000
134500     END-EXEC.                                                    11150000
134600                                                                  11160000
134700     EVALUATE TRUE                                                11170000
134800         WHEN SQLCODE = +0                                        11180000
134900             CONTINUE                                             11190000
135000         WHEN SQLWARN NOT = SPACE                                 11200000
135100         WHEN SQLCODE NOT = +0                                    11210000
135110             MOVE '2104-GET-TPLNSHP'                              11220000
135120                                      TO DP013-PARAGRAPH          11230000
135130             MOVE 'TPLNSHP'           TO DP013-DB2-TABLE-NAME (1) 11240000
135131             SET DP013-DB2-ABEND   TO TRUE                        11250000
135132             SET DP013-NO-ROLLBACK TO TRUE                        11260000
135140             MOVE SQLCA            TO DP013-SQLCA                 11270000
135150             PERFORM DP014-0000-PROCESS-ABEND                     11280000
135500     END-EVALUATE.                                                11290000
135600                                                                  11300000
135700     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DATE-BREAK.              11310000
135800     MOVE PV-DB-MM                 TO HL5A-DNSB-MONTH.            11320000
135900     MOVE PV-DB-DD                 TO HL5A-DNSB-DAY.              11330000
136000     MOVE PV-DB-YY                 TO HL5A-DNSB-YEAR.             11340000
136100     IF PLNSHP-CAN-IFNOT-SHIP-DTE > PLNSHP-EXT-CAN-DTE            11350000
136200         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                           11360000
136300                                   TO PV-DATE-BREAK               11370000
136400         MOVE PV-DB-MM             TO HL6A-CNSB-MONTH             11380000
136500         MOVE PV-DB-DD             TO HL6A-CNSB-DAY               11390000
136600         MOVE PV-DB-YY             TO HL6A-CNSB-YEAR              11400000
136700     ELSE                                                         11410000
136800         MOVE PLNSHP-EXT-CAN-DTE   TO PV-DATE-BREAK               11420005
137000         MOVE PV-DB-MM             TO HL6A-CNSB-MONTH             11430000
137100         MOVE PV-DB-DD             TO HL6A-CNSB-DAY               11440000
137200         MOVE PV-DB-YY             TO HL6A-CNSB-YEAR              11450000
137300     END-IF.                                                      11460000
137400                                                                  11470000
137500*----------------------------------------------------------------*11480000
137600*    RETRIEVE COUNTRY AND STATE NAME                             *11490000
137700*----------------------------------------------------------------*11500000
137800 2105-RETRIEVE-ST-PRV-CNTY-NAME.                                  11510000
138000     MOVE SPACES                 TO PV-STATE-PROV                 11520000
138100                                    PV-COUNTRY.                   11530000
138200     MOVE BUSLOC-ST-PROV-CDE     TO DP410-STATE-CODE.             11540000
138300     MOVE BUSLOC-CNTRY-CDE       TO DP410-COUNTRY-CODE.           11550000
138400                                                                  11560000
138500     CALL PC-DPKUT410 USING DFHEIBLK                              11570000
138600                            PV-DPKUT410-COMMAREA                  11580000
138700                            DP410-ST-PROV-CNTRY-ROUTINE.          11590000
138800                                                                  11600000
138900     EVALUATE TRUE                                                11610000
139001         WHEN  DP410-DB2-ERROR                                    11620000
139002             MOVE '2105-RETRIEVE-ST-PRV-CNTY-NAME'                11630000
139003                                      TO DP013-PARAGRAPH          11640000
139004             DISPLAY 'STATE/PROV = ' DP410-STATE-CODE             11650000
139005             DISPLAY 'COUNTRY = ' DP410-COUNTRY-CODE              11660000
139006             MOVE 'PS_COUNTRY'        TO DP013-DB2-TABLE-NAME (1) 11670000
139007             MOVE 'PS_STATE'          TO DP013-DB2-TABLE-NAME (2) 11680000
139008             SET DP013-DB2-ABEND   TO TRUE                        11690000
139009             SET DP013-NO-ROLLBACK TO TRUE                        11700000
139010             MOVE SQLCA            TO DP013-SQLCA                 11710000
139020             PERFORM DP014-0000-PROCESS-ABEND                     11720000
139031         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      11730000
139032             MOVE DP410-STATE-CODE TO PV-STATE-PROV               11740000
139033             MOVE DP410-COUNTRY-CODE TO PV-COUNTRY                11750000
139040         WHEN  OTHER                                              11760000
139050             MOVE DP410-STATE-NAME TO PV-STATE-PROV               11770000
139060             MOVE DP410-COUNTRY-NAME TO PV-COUNTRY                11780000
139061     END-EVALUATE.                                                11790000
139062                                                                  11800000
139063******************************************************************11810000
139064*  RETRIEVES AND FORMATS PO DATA ON PAYMENT TPOAGMT               11820000
139065******************************************************************11830000
139066 2106-GET-TPOAGMT-2.                                              11840000
139068     EXEC SQL                                                     11850000
139069         SELECT PAYT_TERM_ID,                                     11860000
139070                DISC_PAY_DAY_QTY,                                 11870000
139071                DISC_DOL_AMT,                                     11880000
139072                DISC_PCT                                          11890000
139073         INTO  :POAGMT-PAYT-TERM-ID,                              11900000
139074               :POAGMT-DISC-PAY-DAY-QTY,                          11910000
139075               :POAGMT-DISC-DOL-AMT,                              11920000
139100               :POAGMT-DISC-PCT                                   11930000
139200         FROM TPOAGMT                                             11940000
139300         WHERE PO_NBR = :DK-ORD-NBR                               11950000
139400           AND VER_STATUS_CDE = 'A'                               11960000
139500           AND AGRMT_TYP_ID = '2'                                 11970000
139600     END-EXEC.                                                    11980000
139700                                                                  11990000
139800     EVALUATE TRUE                                                12000000
139900         WHEN SQLCODE = +0                                        12010000
140000             CONTINUE                                             12020000
140100         WHEN SQLWARN NOT = SPACE                                 12030000
140200         WHEN SQLCODE NOT = +0                                    12040000
140300             MOVE '2106-GET-TPOAGMT-2'                            12050000
140310                                      TO DP013-PARAGRAPH          12060000
140320             MOVE 'TPOAGMT'           TO DP013-DB2-TABLE-NAME (1) 12070000
140330             SET DP013-DB2-ABEND   TO TRUE                        12080000
140340             SET DP013-NO-ROLLBACK TO TRUE                        12090000
140350             MOVE SQLCA            TO DP013-SQLCA                 12100000
140360             PERFORM DP014-0000-PROCESS-ABEND                     12110000
140600     END-EVALUATE.                                                12120000
140900                                                                  12130000
141000******************************************************************12140000
141100*  RETRIEVES TPOAGMT TO CHECK FOR EXISTENCE                       12150000
141200******************************************************************12160000
141300 2107-GET-TPOAGMT-4.                                              12170000
141500     EXEC SQL                                                     12180000
141600         SELECT TYP_CDE                                           12190000
141700         INTO  :POAGMT-TYP-CDE                                    12200000
141800         FROM TPOAGMT                                             12210000
141900         WHERE PO_NBR = :DK-ORD-NBR                               12220000
142000           AND VER_STATUS_CDE = 'A'                               12230000
142100           AND AGRMT_TYP_ID = '4'                                 12240000
142200           AND TYP_CDE = :POAGMT-TYP-CDE                          12250000
142300     END-EXEC.                                                    12260000
142400                                                                  12270000
142500     EVALUATE TRUE                                                12280000
142600         WHEN SQLCODE = +0                                        12290000
142700         WHEN SQLCODE = +100                                      12300000
142800             CONTINUE                                             12310000
142900         WHEN SQLWARN NOT = SPACE                                 12320000
143000         WHEN SQLCODE NOT = +0                                    12330000
143100             MOVE '2107-GET-TPOAGMT-4'                            12340000
143110                                      TO DP013-PARAGRAPH          12350000
143120             MOVE 'TPOAGMT'           TO DP013-DB2-TABLE-NAME (1) 12360000
143130             SET DP013-DB2-ABEND   TO TRUE                        12370000
143140             SET DP013-NO-ROLLBACK TO TRUE                        12380000
143150             MOVE SQLCA            TO DP013-SQLCA                 12390000
143160             PERFORM DP014-0000-PROCESS-ABEND                     12400000
143400     END-EVALUATE.                                                12410000
143500                                                                  12420000
143700******************************************************************12430000
143800*  RETRIEVES NAMES FROM TWORKER                                   12440000
143900******************************************************************12450000
144000 2108-GET-TWORKER.                                                12460000
144200     EXEC SQL                                                     12470000
144300         SELECT LAST_NAME,                                        12480000
144400                FIR_NAME                                          12490000
144500         INTO  :WORKER-LAST-NAME,                                 12500000
144600               :WORKER-FIR-NAME                                   12510000
144700         FROM TWORKER                                             12520000
144800         WHERE UID_NBR = :WORKER-UID-NBR                          12530000
144900     END-EXEC.                                                    12540000
145000                                                                  12550000
145100     EVALUATE TRUE                                                12560000
145200         WHEN SQLCODE = +0                                        12570000
145300         WHEN SQLCODE = +100                                      12580000
145400         WHEN SQLCODE = -811                                      12590000
145500             CONTINUE                                             12600000
145600         WHEN SQLWARN NOT = SPACE                                 12610000
145700         WHEN SQLCODE NOT = +0                                    12620000
145800             MOVE '2108-GET-TWORKER'                              12630000
145810                                      TO DP013-PARAGRAPH          12640000
145820             MOVE 'TWORKER'           TO DP013-DB2-TABLE-NAME (1) 12650000
145830             SET DP013-DB2-ABEND   TO TRUE                        12660000
145840             SET DP013-NO-ROLLBACK TO TRUE                        12670000
145850             MOVE SQLCA            TO DP013-SQLCA                 12680000
145860             PERFORM DP014-0000-PROCESS-ABEND                     12690000
146100     END-EVALUATE.                                                12700000
146200                                                                  12710000
146300     IF SQLCODE = +100                                            12720000
146400         MOVE SPACE                TO WORKER-LAST-NAME            12730000
146500                                      WORKER-FIR-NAME             12740000
146600     END-IF.                                                      12750000
146700                                                                  12760000
147000******************************************************************12770000
147100*  GET DEPARTMENT NAME FROM TMDSEAR                               12780000
147200******************************************************************12790000
147300 2110-GET-TMDSEAR.                                                12800000
147500     EXEC SQL                                                     12810000
147600         SELECT MDSEAR_DESC                                       12820000
147700               ,MDSEAR_DKEY                                       12830000
147800               ,GMA_NBR                                           12840000
147900               ,DMA_NBR                                           12850000
148000         INTO  :MDSEAR-DESC                                       12860000
148100              ,:MDSEAR-DKEY                                       12870000
148200              ,:MDSEAR-GMA-NBR                                    12880000
148300              ,:MDSEAR-DMA-NBR                                    12890000
148400         FROM TMDSEAR                                             12900000
148500         WHERE OPERCO_NBR = '03'                                  12910000
148600           AND DEPT_NBR = :PURCHS-DEPT-NBR                        12920000
148700           AND MDSELV_CDE = 'DPT'                                 12930000
148800           AND STRT_DTE <= CURRENT DATE                           12940000
148900           AND END_DTE >= CURRENT DATE                            12950000
149000     END-EXEC.                                                    12960000
149100                                                                  12970000
149200     EVALUATE TRUE                                                12980000
149300         WHEN SQLCODE = +0                                        12990000
150600             MOVE MDSEAR-DESC          TO HL3A-DEPT-DESC          13000005
149400         WHEN SQLCODE = +100                                      13010000
150400             MOVE SPACE                TO HL3A-DEPT-DESC          13020005
149600         WHEN SQLWARN NOT = SPACE                                 13030000
149700         WHEN SQLCODE NOT = +0                                    13040000
149800             MOVE '2110-GET-TMDSEAR'                              13050000
149810                                      TO DP013-PARAGRAPH          13060000
149820             MOVE 'TMDSEAR'           TO DP013-DB2-TABLE-NAME (1) 13070000
149830             SET DP013-DB2-ABEND   TO TRUE                        13080000
149840             SET DP013-NO-ROLLBACK TO TRUE                        13090000
149850             MOVE SQLCA            TO DP013-SQLCA                 13100000
149860             PERFORM DP014-0000-PROCESS-ABEND                     13110000
150100     END-EVALUATE.                                                13120000
150200                                                                  13130000
150900                                                                  13140000
151000******************************************************************13150000
151100*  GET BUYER NAME FROM TRSPBAR                                    13160000
151200******************************************************************13170000
151300 2111-GET-BUYER.                                                  13180000
151500     EXEC SQL                                                     13190000
151600         SELECT WORKER_LAST_NAME                                  13200000
151700               ,WORKER_FIR_NAME                                   13210000
151800         INTO  :RSPBAR-WORKER-LAST-NAME                           13220000
151900              ,:RSPBAR-WORKER-FIR-NAME                            13230000
152000         FROM TRSPBAR                                             13240000
152100         WHERE MDSEAR_DKEY = :MDSEAR-DKEY                         13250000
152200           AND RSPLVL_CDE = 'BYR'                                 13260000
152300           AND WORKER_STRT_DTE <= CURRENT DATE                    13270000
152400           AND WORKER_END_DTE >= CURRENT DATE                     13280000
152500     END-EXEC.                                                    13290000
152600                                                                  13300000
152700     EVALUATE TRUE                                                13310000
152800         WHEN SQLCODE = +0                                        13320000
152900         WHEN SQLCODE = +100                                      13330000
153000         WHEN SQLCODE = -310                                      13340000
153100             CONTINUE                                             13350000
153200         WHEN SQLWARN NOT = SPACE                                 13360000
153300         WHEN SQLCODE NOT = +0                                    13370000
153400             MOVE '2111-GET-BUYER'                                13380000
153410                                      TO DP013-PARAGRAPH          13390000
153420             MOVE 'TRSPBAR'           TO DP013-DB2-TABLE-NAME (1) 13400000
153430             SET DP013-DB2-ABEND   TO TRUE                        13410000
153440             SET DP013-NO-ROLLBACK TO TRUE                        13420000
153450             MOVE SQLCA            TO DP013-SQLCA                 13430000
153460             PERFORM DP014-0000-PROCESS-ABEND                     13440000
153700     END-EVALUATE.                                                13450000
153800                                                                  13460000
153900     IF SQLCODE = +100 OR -310                                    13470000
154000         MOVE SPACE                TO HL8A-BUYER                  13480000
154100     ELSE                                                         13490000
154200         MOVE 20                   TO DP024-FLNAME-LENGTH         13500000
154300         MOVE RSPBAR-WORKER-LAST-NAME                             13510000
154400                                   TO DP024-LNAME                 13520000
154500         MOVE RSPBAR-WORKER-FIR-NAME                              13530000
154600                                   TO DP024-FNAME                 13540000
154700         PERFORM DP024-0000-FORMAT-NAME                           13550000
154800         MOVE DP024-FLNAME         TO HL8A-BUYER                  13560000
154900     END-IF.                                                      13570000
155000                                                                  13580000
155200******************************************************************13590000
155300*  RETRIEVES NAME OF DMM                                          13600000
155400******************************************************************13610000
155500 2112-GET-DMM.                                                    13620000
155700     EXEC SQL                                                     13630000
155800         SELECT DISTINCT B.WORKER_LAST_NAME,                      13640000
155900                         B.WORKER_FIR_NAME                        13650000
156000         INTO  :RSPBAR-WORKER-LAST-NAME,                          13660000
156100               :RSPBAR-WORKER-FIR-NAME                            13670000
156200         FROM TMDSEAR A,                                          13680000
156300              TRSPBAR B                                           13690000
156400         WHERE A.OPERCO_NBR  = '03'                               13700000
156500           AND A.GMA_NBR     = :MDSEAR-GMA-NBR                    13710000
156600           AND A.DMA_NBR     = :MDSEAR-DMA-NBR                    13720000
156700           AND MDSELV_CDE    = 'DMA'                              13730000
156800           AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                      13740000
156900           AND B.RSPLVL_CDE  = 'DMM'                              13750000
157000           AND B.WORKER_STRT_DTE < CURRENT DATE                   13760000
157100           AND B.WORKER_END_DTE  > CURRENT DATE                   13770000
157200     END-EXEC.                                                    13780000
157300                                                                  13790000
157400     EVALUATE TRUE                                                13800000
157500         WHEN SQLCODE = +0                                        13810000
158800             MOVE 20               TO DP024-FLNAME-LENGTH         13820005
158900             MOVE RSPBAR-WORKER-LAST-NAME                         13830005
159000                                   TO DP024-LNAME                 13840005
159100             MOVE RSPBAR-WORKER-FIR-NAME                          13850005
159200                                   TO DP024-FNAME                 13860005
159300             PERFORM DP024-0000-FORMAT-NAME                       13870005
159400             MOVE DP024-FLNAME     TO HL9A-APPROVED-BY            13880005
157600         WHEN SQLCODE = +100                                      13890000
158600             MOVE SPACE            TO HL9A-APPROVED-BY            13900005
157800         WHEN SQLWARN NOT = SPACE                                 13910000
157900         WHEN SQLCODE NOT = +0                                    13920000
158000             MOVE '2112-GET-DMM    '                              13930000
158010                                      TO DP013-PARAGRAPH          13940000
158020             MOVE 'TMDSEAR'           TO DP013-DB2-TABLE-NAME (1) 13950000
158021             MOVE 'TRSPBAR'           TO DP013-DB2-TABLE-NAME (2) 13960000
158030             SET DP013-DB2-ABEND   TO TRUE                        13970000
158040             SET DP013-NO-ROLLBACK TO TRUE                        13980000
158050             MOVE SQLCA            TO DP013-SQLCA                 13990000
158060             PERFORM DP014-0000-PROCESS-ABEND                     14000000
158300     END-EVALUATE.                                                14010000
158400                                                                  14020000
159800******************************************************************14030000
159900*  RETRIEVES INFO FROM PRETICKET REQUEST TABLE                    14040000
160000******************************************************************14050000
160100 2113-GET-PRETKT-REQ.                                             14060000
160300     EXEC SQL                                                     14070000
160400         SELECT                                                   14080000
160500           A.PO_REQ_NBR                                           14090000
160600          ,A.PO_NBR                                               14100000
160700          ,A.DEPT_NBR                                             14110000
160800          ,A.ENT_ID                                               14120000
160900          ,A.ADDR_SEQ_NBR                                         14130000
161000          ,A.PRTY_STAT_CDE                                        14140000
161100          ,A.REQ_TYP_CDE                                          14150000
161200          ,A.REQ_CREN_DTE                                         14160000
161300          ,A.RQSTR_ID                                             14170000
161400          ,A.REQ_STAT_CDE                                         14180000
161500          ,A.VND_DUE_DTE                                          14190000
161600          ,A.PRT_BY_DTE                                           14200000
161700          ,A.ACTL_PRT_DTE                                         14210000
161800          ,A.PRT_RQSTR_ID                                         14220000
161900          ,A.PRT_TM                                               14230000
162100         INTO                                                     14240000
162200            :PTKREQ-PO-REQ-NBR                                    14250000
162300           ,:PTKREQ-PO-NBR                                        14260000
162400           ,:PTKREQ-DEPT-NBR                                      14270000
162500           ,:PTKREQ-ENT-ID                                        14280000
162600           ,:PTKREQ-ADDR-SEQ-NBR                                  14290000
162700           ,:PTKREQ-PRTY-STAT-CDE                                 14300000
162800           ,:PTKREQ-REQ-TYP-CDE                                   14310000
162900           ,:PTKREQ-REQ-CREN-DTE                                  14320000
163000           ,:PTKREQ-RQSTR-ID                                      14330000
163100           ,:PTKREQ-REQ-STAT-CDE                                  14340000
163200           ,:PTKREQ-VND-DUE-DTE                                   14350000
163300           ,:PTKREQ-PRT-BY-DTE                                    14360000
163400           ,:PTKREQ-ACTL-PRT-DTE                                  14370000
163500           ,:PTKREQ-PRT-RQSTR-ID                                  14380000
163600           ,:PTKREQ-PRT-TM                                        14390000
163800         FROM TPTKREQ A                                           14400000
163900         WHERE A.PO_NBR        =  :DK-ORD-NBR                     14410000
164000           AND A.PO_REQ_NBR  =  :DK-ORD-REQ-NBR                   14420000
164100     END-EXEC.                                                    14430000
164200                                                                  14440000
164300     EVALUATE TRUE                                                14450000
164400         WHEN SQLCODE = +0                                        14460000
165800             MOVE PTKREQ-REQ-CREN-DTE TO PV-DATE-BREAK            14470005
165900             MOVE PV-DB-MM        TO HL7A-REQ-MONTH               14480005
166000             MOVE PV-DB-DD        TO HL7A-REQ-DAY                 14490005
166100             MOVE PV-DB-YY        TO HL7A-REQ-YEAR                14500005
166200             MOVE PTKREQ-VND-DUE-DTE TO PV-DATE-BREAK             14510005
166300             MOVE PV-DB-MM        TO HL8A-VDR-MONTH               14520005
166400             MOVE PV-DB-DD        TO HL8A-VDR-DAY                 14530005
166500             MOVE PV-DB-YY        TO HL8A-VDR-YEAR                14540005
166600             IF PTKREQ-REQ-TYP-CDE = 'L'                          14550005
166700                 MOVE 'YES' TO HLPO-LOCKER-STOCK                  14560005
166710             ELSE                                                 14570005
166720                 MOVE '   ' TO HLPO-LOCKER-STOCK                  14580005
166800             END-IF                                               14590005
164500         WHEN SQLCODE = +100                                      14600000
165600             MOVE SPACE           TO HL9A-APPROVED-BY             14610005
164700         WHEN SQLWARN NOT = SPACE                                 14620000
164800         WHEN SQLCODE NOT = +0                                    14630000
164900             MOVE '2113-GET-PRETKT-REQ'                           14640000
164910                                      TO DP013-PARAGRAPH          14650000
164920             MOVE 'TPTKREQ'           TO DP013-DB2-TABLE-NAME (1) 14660000
164940             SET DP013-DB2-ABEND   TO TRUE                        14670000
164950             SET DP013-NO-ROLLBACK TO TRUE                        14680000
164960             MOVE SQLCA            TO DP013-SQLCA                 14690000
164970             PERFORM DP014-0000-PROCESS-ABEND                     14700000
165300     END-EVALUATE.                                                14710000
165400                                                                  14720000
172410*----------------------------------------------------------------*14730000
172420* THIS PARAGRAPH WILL MOVE AN ADDRESS INTO THE TABLE             *14740000
172430* FIELDS                                                         *14750000
172440*----------------------------------------------------------------*14760000
172460 2115-MOVE-ADDR-TO-TABLE.                                         14770000
172480     INITIALIZE ADDR-LINE-TABLE.                                  14780000
172481     INITIALIZE ADDR-DESC-TABLE.                                  14790000
172490     SET ADDR-IDX TO +1.                                          14800000
172491     SET ADDR-DESC-IDX TO +1                                      14810000
172539                                                                  14820000
172540**  ATTENTION-TO-TXT  ********************************************14830000
172542     IF (ENTREP-FIRST-NAME       = SPACES                         14840018
172543     AND ENTREP-LAST-NAME        = SPACES)                        14850018
172544         STRING PC-ATTN            DELIMITED BY '  '              14860018
172545                ' '                DELIMITED BY SIZE              14870018
172546                PC-PRETICKET-DEPT  DELIMITED BY '  '              14880018
172547                ' '                DELIMITED BY SIZE              14890018
172548                    INTO ADDR-LINE (ADDR-IDX)                     14900000
172549     ELSE                                                         14910018
172550         STRING PC-ATTN            DELIMITED BY '  '              14920018
172560                ' '                DELIMITED BY SIZE              14930018
172570                ENTREP-FIRST-NAME  DELIMITED BY '  '              14940018
172580                ' '                DELIMITED BY SIZE              14950018
172590                ENTREP-LAST-NAME   DELIMITED BY '  '              14960018
172600                    INTO ADDR-LINE (ADDR-IDX)                     14970000
172700            ON OVERFLOW                                           14980018
172800                MOVE SPACES TO ADDR-LINE (ADDR-IDX)               14990000
172900                STRING PC-ATTN     DELIMITED BY '  '              15000018
173000                ' '                DELIMITED BY SIZE              15010018
173200                ENTREP-FIRST-NAME  DELIMITED BY '  '              15020018
173300                    INTO ADDR-LINE (ADDR-IDX)                     15030018
173400                SET ADDR-IDX UP BY +1                             15040018
173500                STRING ENTREP-LAST-NAME                           15050018
                                         DELIMITED BY '  '              15060018
173600                    INTO ADDR-LINE (ADDR-IDX)                     15070018
173700         END-STRING                                               15080018
173800     END-IF.                                                      15090018
174701                                                                  15100018
174700     SET ADDR-IDX UP BY +1.                                       15110018
174701                                                                  15120000
174704** ADDRESS LINE 1 ************************************************15130000
174705     IF BUSLOC-ADDRESS-LINE1-DESC = SPACES                        15140000
174706         CONTINUE                                                 15150000
174707     ELSE                                                         15160000
174708         MOVE BUSLOC-ADDRESS-LINE1-DESC                           15170000
174709              TO ADDR-DESC (ADDR-DESC-IDX)                        15180000
174710         SET ADDR-DESC-IDX UP BY +1                               15190000
174711         ADD +1 TO PV-ADDR-COUNTER                                15200000
174712     END-IF.                                                      15210000
174713** ADDRESS LINE 2 ************************************************15220000
174714     IF BUSLOC-ADDRESS-LINE2-DESC = SPACES                        15230000
174715         CONTINUE                                                 15240000
174716     ELSE                                                         15250000
174717         MOVE BUSLOC-ADDRESS-LINE2-DESC                           15260000
174718              TO ADDR-DESC (ADDR-DESC-IDX)                        15270000
174719         SET ADDR-DESC-IDX UP BY +1                               15280000
174720         ADD +1 TO PV-ADDR-COUNTER                                15290000
174721     END-IF.                                                      15300000
174722                                                                  15310000
174723** ADDRESS LINE 3 ************************************************15320000
174724     IF BUSLOC-ADDRESS-LINE3-DESC = SPACES                        15330000
174725         CONTINUE                                                 15340000
174726     ELSE                                                         15350000
174727         MOVE BUSLOC-ADDRESS-LINE3-DESC                           15360000
174728              TO ADDR-DESC (ADDR-DESC-IDX)                        15370000
174729         SET ADDR-DESC-IDX UP BY +1                               15380000
174730         ADD +1 TO PV-ADDR-COUNTER                                15390000
174731     END-IF.                                                      15400000
174732                                                                  15410000
174733** ADDRESS LINE 4 ************************************************15420000
174734     IF BUSLOC-ADDRESS-LINE4-DESC = SPACES                        15430000
174735         CONTINUE                                                 15440000
174736     ELSE                                                         15450000
174737         MOVE BUSLOC-ADDRESS-LINE4-DESC                           15460000
174738              TO ADDR-DESC (ADDR-DESC-IDX)                        15470000
174739         SET ADDR-DESC-IDX UP BY +1                               15480000
174740         ADD +1 TO PV-ADDR-COUNTER                                15490000
174741     END-IF.                                                      15500000
174742     PERFORM 2119-FORMAT-ADDRESS-LINES.                           15510000
174743                                                                  15520000
174744** CITY STATE AND ZIP (COULD BE ON TWO LINES) *******             15530000
           IF  BUSLOC-CITY-NAME        = SPACES                         15540000
           AND PV-STATE-PROV           = SPACES                         15550000
174750         CONTINUE                                                 15560000
174760     ELSE                                                         15570000
174770         STRING                                                   15580000
174780             BUSLOC-CITY-NAME DELIMITED BY '  '                   15590000
174790             ', ' DELIMITED BY SIZE                               15600000
174900             PV-STATE-PROV      DELIMITED BY '  '                 15610000
175000             '  ' DELIMITED BY SIZE                               15620000
175100             BUSLOC-ZIP-CDE  DELIMITED BY '  '                    15630000
175200            INTO ADDR-LINE(ADDR-IDX)                              15640000
175300         ON OVERFLOW                                              15650000
175400            MOVE SPACES TO ADDR-LINE(ADDR-IDX)                    15660000
175500            STRING                                                15670000
175600               BUSLOC-CITY-NAME DELIMITED BY '  '                 15680000
175700               ', ' DELIMITED BY SIZE                             15690000
175900               PV-STATE-PROV      DELIMITED BY '  '               15700000
176000               INTO ADDR-LINE(ADDR-IDX)                           15710000
176100               SET ADDR-IDX UP BY +1                              15720000
176200            STRING                                                15730000
176300                BUSLOC-ZIP-CDE  DELIMITED BY '  '                 15740000
176400               INTO ADDR-LINE(ADDR-IDX)                           15750000
176500      END-STRING                                                  15760000
176501     END-IF.                                                      15770000
           IF  BUSLOC-CITY-NAME        = SPACES                         15780000
           AND PV-STATE-PROV           = SPACES                         15790000
176505         CONTINUE                                                 15800000
176506     ELSE                                                         15810000
176507               SET ADDR-IDX UP BY +1                              15820000
176508     END-IF.                                                      15830000
176509** PROVINCE AND COUNTRY (COULD BE ON TWO LINES)                   15840000
           IF  PV-COUNTRY              = SPACES                         15850000
176533         CONTINUE                                                 15860000
176534     ELSE                                                         15870000
176535         STRING                                                   15880000
176537             PV-COUNTRY        DELIMITED BY '  '                  15890000
176538             ', ' DELIMITED BY SIZE                               15900000
176560             BUSLOC-ZIP-CDE  DELIMITED BY '  '                    15910000
176570             INTO ADDR-LINE(ADDR-IDX)                             15920000
176580          ON OVERFLOW                                             15930000
176581             MOVE SPACES TO ADDR-LINE(ADDR-IDX)                   15940000
176582             STRING                                               15950000
176584                 PV-COUNTRY        DELIMITED BY '  '              15960000
176585                 INTO ADDR-LINE(ADDR-IDX)                         15970000
176586                   SET ADDR-IDX UP BY +1                          15980000
176587             STRING                                               15990000
176589                 '  ' DELIMITED BY SIZE                           16000000
176590                  BUSLOC-ZIP-CDE  DELIMITED BY '  '               16010000
176600                 INTO ADDR-LINE(ADDR-IDX)                         16020000
176700         END-STRING                                               16030000
176701     END-IF.                                                      16040000
           IF  PV-COUNTRY              = SPACES                         16050000
176705         CONTINUE                                                 16060000
176706     ELSE                                                         16070000
176707      SET ADDR-IDX UP BY +1                                       16080000
176708     END-IF.                                                      16090000
176709** PHONE LINE     ************************************************16100000
176710     IF  ENTREP-TEL1-NBR = SPACES                                 16110000
176711         CONTINUE                                                 16120000
176712     ELSE                                                         16130000
176713         STRING PC-PHONE            DELIMITED BY '  '             16140000
176714                ' '                 DELIMITED BY SIZE             16150000
176715                ENTREP-TEL1-NBR     DELIMITED BY '  '             16160000
176716                ' '                 DELIMITED BY SIZE             16170000
176717                ENTREP-TEL1-EXT-NBR DELIMITED BY '  '             16180000
176718         INTO ADDR-LINE (ADDR-IDX)                                16190000
176719         SET ADDR-IDX UP BY +1                                    16200000
176720     END-IF.                                                      16210000
176722                                                                  16220000
176723******************************************************************16230000
176724*  UNLOADS ADDRESS TABLE.                                         16240000
176725******************************************************************16250000
176727 2116-UNLOAD-ADDR-TABLE.                                          16260000
176728     MOVE ADDR-LINE (ADDR-IDX) TO HL4A-ADDRESS.                   16270003
176729                                                                  16280003
176730     SET ADDR-IDX UP BY 1                                         16290000
176731     MOVE ADDR-LINE (ADDR-IDX) TO HL5A-ADDRESS.                   16300003
176732                                                                  16310003
176733     SET ADDR-IDX UP BY 1                                         16320000
176734                                                                  16330000
176735     MOVE ADDR-LINE (ADDR-IDX) TO HL6A-ADDRESS.                   16340003
176736                                                                  16350003
176737     SET ADDR-IDX UP BY 1                                         16360000
176738     MOVE ADDR-LINE (ADDR-IDX) TO HL7A-ADDRESS.                   16370003
176739                                                                  16380003
176740     SET ADDR-IDX UP BY 1                                         16390000
176741     MOVE ADDR-LINE (ADDR-IDX) TO HL8A-ADDRESS.                   16400003
176742                                                                  16410003
176743     SET ADDR-IDX UP BY 1                                         16420000
176744     MOVE ADDR-LINE (ADDR-IDX) TO HL9A-ADDRESS.                   16430003
176745                                                                  16440003
176746     SET ADDR-IDX UP BY 1                                         16450000
176747     MOVE ADDR-LINE (ADDR-IDX) TO HL10A-ADDRESS.                  16460003
176748                                                                  16470003
176749     SET ADDR-IDX UP BY 1                                         16480000
176750     MOVE ADDR-LINE (ADDR-IDX) TO HL11A-ADDRESS.                  16490003
176751                                                                  16500003
176752     SET ADDR-IDX UP BY 1                                         16510000
176753     MOVE ADDR-LINE (ADDR-IDX) TO HL12A-ADDRESS.                  16520003
176754                                                                  16530003
176755     SET ADDR-IDX UP BY 1                                         16540000
176756     MOVE ADDR-LINE (ADDR-IDX) TO HL13A-ADDRESS.                  16550003
176757                                                                  16560003
176758     SET ADDR-IDX UP BY 1                                         16570000
176759     MOVE ADDR-LINE (ADDR-IDX) TO HL14A-ADDRESS.                  16580003
176760                                                                  16590003
176761     SET ADDR-IDX UP BY 1                                         16600000
176762     MOVE ADDR-LINE (ADDR-IDX) TO HL15A-ADDRESS.                  16610003
176763                                                                  16620003
176764     SET PS-EOF-ADDR-TBL  TO TRUE.                                16630000
176765                                                                  16640000
176766******************************************************************16650000
176767*  PRINTS REPORT HEADINGS.                                        16660000
176768******************************************************************16670000
176770 2117-PRINT-HEADINGS.                                             16680000
176776     MOVE 2 TO HL1-RPT-NBR.                                       16690000
176777     MOVE HL1-HEADING-LINE-1           TO DRS01-COMM-DATA.        16700000
176778     MOVE PC-NEW-PAGE                  TO DRS01-COMM-CTL.         16710000
176779     PERFORM 9001-LINK-TO-DRS-1.                                  16720000
176780*************************************************************     16730000
176782     MOVE PC-SINGLE-SPACE              TO DRS01-COMM-CTL.         16740000
176784                                                                  16750000
176785     MOVE HL2A-HEADING-LINE-2A         TO DRS01-COMM-DATA.        16760000
176786     PERFORM 9001-LINK-TO-DRS-1.                                  16770000
176787*************************************************************     16780000
176789     MOVE PC-DOUBLE-SPACE           TO DRS01-COMM-CTL.            16790000
176791                                                                  16800000
176792     MOVE HLPO-HEADING-LINE-PO      TO DRS01-COMM-DATA.           16810000
176793     PERFORM 9001-LINK-TO-DRS-1.                                  16820000
176794*************************************************************     16830000
176796     MOVE PC-DOUBLE-SPACE              TO DRS01-COMM-CTL.         16840000
176798                                                                  16850000
176799     MOVE HL3A-HEADING-LINE-3A         TO DRS01-COMM-DATA.        16860000
176800     PERFORM 9001-LINK-TO-DRS-1.                                  16870000
176801*************************************************************     16880000
176803     MOVE PC-SINGLE-SPACE              TO DRS01-COMM-CTL.         16890000
176805                                                                  16900000
176806     MOVE HL4A-HEADING-LINE-4A         TO DRS01-COMM-DATA.        16910000
176807     PERFORM 9001-LINK-TO-DRS-1.                                  16920000
176808                                                                  16930000
176809*************************************************************     16940000
176813     MOVE HL5A-HEADING-LINE-5A         TO DRS01-COMM-DATA.        16950000
176814     PERFORM 9001-LINK-TO-DRS-1.                                  16960000
176815                                                                  16970000
176816*************************************************************     16980000
176820     MOVE HL6A-HEADING-LINE-6A         TO DRS01-COMM-DATA.        16990000
176821     PERFORM 9001-LINK-TO-DRS-1.                                  17000000
176822                                                                  17010000
176823*************************************************************     17020000
176827     MOVE HL7A-HEADING-LINE-7A         TO DRS01-COMM-DATA.        17030000
176828     PERFORM 9001-LINK-TO-DRS-1.                                  17040000
176829                                                                  17050000
176830*************************************************************     17060000
176834     MOVE HL8A-HEADING-LINE-8A         TO DRS01-COMM-DATA.        17070000
176835     PERFORM 9001-LINK-TO-DRS-1.                                  17080000
176836                                                                  17090000
176837*************************************************************     17100000
176841     MOVE HL9A-HEADING-LINE-9A         TO DRS01-COMM-DATA.        17110000
176842     PERFORM 9001-LINK-TO-DRS-1.                                  17120000
176843                                                                  17130000
176844*************************************************************     17140000
176845     IF HL10A-ADDRESS = SPACES                                    17150004
176845         CONTINUE                                                 17160003
176846     ELSE                                                         17170000
176850         MOVE HL10A-HEADING-LINE-10A       TO DRS01-COMM-DATA     17180000
176851         PERFORM 9001-LINK-TO-DRS-1.                              17190000
176852                                                                  17200000
176853*************************************************************     17210000
176854     IF HL11A-ADDRESS = SPACES                                    17220004
176854         CONTINUE                                                 17230003
176855     ELSE                                                         17240000
176859         MOVE HL11A-HEADING-LINE-11A       TO DRS01-COMM-DATA     17250000
176860         PERFORM 9001-LINK-TO-DRS-1.                              17260000
176861                                                                  17270000
176862*************************************************************     17280000
176863     IF HL12A-ADDRESS = SPACES                                    17290004
176863         CONTINUE                                                 17300003
176864     ELSE                                                         17310000
176868         MOVE HL12A-HEADING-LINE-12A       TO DRS01-COMM-DATA     17320000
176869         PERFORM 9001-LINK-TO-DRS-1.                              17330000
176870                                                                  17340000
176880*************************************************************     17350000
176890     IF HL13A-ADDRESS = SPACES                                    17360004
176890         CONTINUE                                                 17370003
176900     ELSE                                                         17380000
177300         MOVE HL13A-HEADING-LINE-13A       TO DRS01-COMM-DATA     17390000
177301         PERFORM 9001-LINK-TO-DRS-1.                              17400000
177302*************************************************************     17410000
177303     IF HL14A-ADDRESS = SPACES                                    17420004
177303         CONTINUE                                                 17430003
177304     ELSE                                                         17440000
177308         MOVE HL14A-HEADING-LINE-14A       TO DRS01-COMM-DATA     17450000
177309         PERFORM 9001-LINK-TO-DRS-1.                              17460000
177310*************************************************************     17470000
177320     IF HL15A-ADDRESS = SPACES                                    17480004
177320         CONTINUE                                                 17490003
177330     ELSE                                                         17500000
177370         MOVE HL15A-HEADING-LINE-15A       TO DRS01-COMM-DATA     17510000
177371         PERFORM 9001-LINK-TO-DRS-1.                              17520000
177372                                                                  17530000
177373*************************************************************     17540000
177374     MOVE PC-DOUBLE-SPACE              TO DRS01-COMM-CTL.         17550014
177374     MOVE DL1-HEADING-LINE-1           TO DRS01-COMM-DATA.        17560014
177377     PERFORM 9001-LINK-TO-DRS-1.                                  17570000
177378                                                                  17580000
177374     MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL.           17590015
177379*************************************************************     17600000
177387     MOVE +16                      TO PV-LINE-CNT.                17610014
177388                                                                  17620027
177389******************************************************************17630000
177390* 2118-GET-TICKET-QUANTITY.                                      *17640000
177391*  THIS PROCEDURE WILL GET THE NUMBER OF TICKETS REQUESTED.       17650000
177393******************************************************************17660000
177394 2118-GET-TICKET-QTY.                                             17670000
177395     EXEC SQL                                                     17680000
177396        SELECT                                                    17690000
177397           SUM(A.TKT_QTY)                                         17700000
177398            INTO :PV-REQ-PRETKT-QTY                               17710000
177399            FROM  TPTKLNE A                                       17720000
177400                 ,TPTKREQ B                                       17730000
177401            WHERE A.PO_REQ_NBR = :DK-ORD-REQ-NBR                  17740006
177402              AND A.PO_REQ_NBR = B.PO_REQ_NBR                     17750000
177403     END-EXEC.                                                    17760000
177404     EVALUATE TRUE                                                17770000
177405         WHEN SQLCODE = +0                                        17780000
177406         WHEN SQLCODE = +100                                      17790000
177407              CONTINUE                                            17800000
177408                                                                  17810000
177409         WHEN SQLWARN0 NOT = SPACE                                17820000
177410         WHEN SQLCODE < +0                                        17830000
177411         WHEN SQLCODE > +0                                        17840000
177412             MOVE '2118-COUNT-TPTKLNE'                            17850000
177413                                      TO DP013-PARAGRAPH          17860000
177414             MOVE 'TPTKLNE'           TO DP013-DB2-TABLE-NAME (1) 17870000
177415             SET DP013-DB2-ABEND   TO TRUE                        17880000
177416             SET DP013-NO-ROLLBACK TO TRUE                        17890000
177417             MOVE SQLCA            TO DP013-SQLCA                 17900000
177418             PERFORM DP014-0000-PROCESS-ABEND                     17910000
177419     END-EVALUATE.                                                17920000
177420                                                                  17930000
177421******************************************************************17940000
177422*  FORMATS THE ADDRESS LINES AND ROOM NUMBER                      17950000
177423******************************************************************17960000
177424 2119-FORMAT-ADDRESS-LINES.                                       17970000
177425     SET ADDR-DESC-IDX TO 1                                       17980000
177426     IF PV-ADDR-COUNTER = 1                                       17990000
177427            PERFORM 2120-STRING-ROOM-ADDRESS                      18000000
177428         ELSE                                                     18010000
177429             IF PV-ADDR-COUNTER = 2                               18020000
177430                 MOVE ADDR-DESC (ADDR-DESC-IDX) TO                18030000
177440                 ADDR-LINE (ADDR-IDX)                             18040000
177450                 SET ADDR-IDX UP BY 1                             18050000
177460                 SET ADDR-DESC-IDX TO 2                           18060000
177470                 PERFORM 2120-STRING-ROOM-ADDRESS                 18070000
177480             ELSE                                                 18080000
177490                 IF PV-ADDR-COUNTER = 3                           18090000
177500                     MOVE ADDR-DESC (ADDR-DESC-IDX) TO            18100000
177600                         ADDR-LINE (ADDR-IDX)                     18110000
177700                         SET ADDR-IDX UP BY 1                     18120000
177800                         SET ADDR-DESC-IDX TO 2                   18130000
177900                     MOVE ADDR-DESC (ADDR-DESC-IDX) TO            18140000
178000                         ADDR-LINE (ADDR-IDX)                     18150000
178100                         SET ADDR-IDX UP BY 1                     18160000
178200                         SET ADDR-DESC-IDX TO 3                   18170000
178300                     PERFORM 2120-STRING-ROOM-ADDRESS             18180000
178400                 ELSE                                             18190000
178500                     IF PV-ADDR-COUNTER = 4                       18200000
178600                         MOVE ADDR-DESC (ADDR-DESC-IDX) TO        18210000
178700                             ADDR-LINE (ADDR-IDX)                 18220000
178800                             SET ADDR-IDX UP BY 1                 18230000
178900                             SET ADDR-DESC-IDX TO 2               18240000
179000                         MOVE ADDR-DESC (ADDR-DESC-IDX) TO        18250000
179100                             ADDR-LINE (ADDR-IDX)                 18260000
179200                             SET ADDR-IDX UP BY 1                 18270000
179300                             SET ADDR-DESC-IDX TO 3               18280000
179400                         MOVE ADDR-DESC (ADDR-DESC-IDX) TO        18290000
179500                             ADDR-LINE (ADDR-IDX)                 18300000
179600                             SET ADDR-IDX UP BY 1                 18310000
179700                             SET ADDR-DESC-IDX TO 4               18320000
179800                         PERFORM 2120-STRING-ROOM-ADDRESS         18330000
179900                 END-IF                                           18340000
180000             END-IF                                               18350000
180100         END-IF                                                   18360000
180101     END-IF.                                                      18370000
180102******************************************************************18380000
180103*  STRINGS LAST ADDRESS AND ROOM NUMBER TOGETHER                  18390000
180104******************************************************************18400000
180105 2120-STRING-ROOM-ADDRESS.                                        18410000
180106      IF BUSLOC-ROOM-NBR = SPACES                                 18420000
180107          MOVE ADDR-DESC (ADDR-DESC-IDX) TO                       18430000
180108               ADDR-LINE (ADDR-IDX)                               18440000
180109      ELSE                                                        18450000
180110          STRING ADDR-DESC (ADDR-DESC-IDX)                        18460000
180120          DELIMITED BY '     '                                    18470000
180130          ', '               DELIMITED BY SIZE                    18480000
180140          PC-RM                   DELIMITED BY SIZE               18490000
180150          BUSLOC-ROOM-NBR     DELIMITED BY '  '                   18500000
180160                                                                  18510000
180170          INTO ADDR-LINE (ADDR-IDX)                               18520000
180180          ON OVERFLOW                                             18530000
180190              MOVE SPACES TO ADDR-LINE (ADDR-IDX)                 18540000
180200              MOVE ADDR-DESC (ADDR-DESC-IDX) TO                   18550000
180300                   ADDR-LINE (ADDR-IDX)                           18560000
180400              SET ADDR-IDX UP BY +1                               18570000
180500              STRING PC-RM              DELIMITED BY SIZE         18580000
180600              BUSLOC-ROOM-NBR     DELIMITED BY '  '               18590000
180700              INTO ADDR-LINE (ADDR-IDX)                           18600000
180800              END-STRING                                          18610000
180900          END-STRING                                              18620000
181000      END-IF.                                                     18630000
181100      SET ADDR-IDX UP BY +1.                                      18640000
181101                                                                  18650000
181102******************************************************************18660000
181103*  COUNTS TALLPLANS                                               18670000
181104******************************************************************18680000
181105 2196-COUNT-TALLPLNS.                                             18690000
181107     INITIALIZE PV-DB2-COUNT.                                     18700000
181108     EXEC SQL                                                     18710000
181109          SELECT COUNT(DISTINCT(DEST_NBR))                        18720000
181110          INTO :PV-DB2-COUNT                                      18730000
181111          FROM TALLPLN                                            18740000
181112          WHERE PO_NBR = :DK-ORD-NBR                              18750000
181113     END-EXEC.                                                    18760000
181114                                                                  18770000
181115     EVALUATE TRUE                                                18780000
181116         WHEN SQLCODE = +0                                        18790000
181117         WHEN SQLCODE = +100                                      18800000
181118              CONTINUE                                            18810000
181120         WHEN SQLWARN0 NOT = SPACE                                18820000
181121         WHEN SQLCODE < +0                                        18830000
181122         WHEN SQLCODE > +0                                        18840000
181123             MOVE '2196-COUNT-TALLPLN'                            18850000
181124                                      TO DP013-PARAGRAPH          18860000
181125             MOVE 'TALLPLN'           TO DP013-DB2-TABLE-NAME (1) 18870000
181126             SET DP013-DB2-ABEND   TO TRUE                        18880000
181127             SET DP013-NO-ROLLBACK TO TRUE                        18890000
181128             MOVE SQLCA            TO DP013-SQLCA                 18900000
181129             PERFORM DP014-0000-PROCESS-ABEND                     18910000
181130     END-EVALUATE.                                                18920000
181132                                                                  18930000
181133******************************************************************18940000
181134*  GET DEST NUMBER                                                18950000
181135******************************************************************18960000
181136 2197-GET-SHIP-DEST.                                              18970000
181138     INITIALIZE PV-DB2-COUNT.                                     18980000
181139     EXEC SQL                                                     18990000
181140          SELECT DISTINCT(DEST_NBR)                               19000000
181141          INTO :ALLPLN-DEST-NBR                                   19010000
181142          FROM TALLPLN                                            19020000
181143          WHERE PO_NBR = :DK-ORD-NBR                              19030000
181144     END-EXEC.                                                    19040000
181145                                                                  19050000
181146     EVALUATE TRUE                                                19060000
181147         WHEN SQLCODE = +0                                        19070000
181148              CONTINUE                                            19080000
181149         WHEN SQLWARN0 NOT = SPACE                                19090000
181150         WHEN SQLCODE < +0                                        19100000
181151         WHEN SQLCODE > +0                                        19110000
181152             MOVE '2197-GET-SHIP-DEST'                            19120000
181153                                      TO DP013-PARAGRAPH          19130000
181154             MOVE 'TALLPLN'           TO DP013-DB2-TABLE-NAME (1) 19140000
181155             SET DP013-DB2-ABEND   TO TRUE                        19150000
181156             SET DP013-NO-ROLLBACK TO TRUE                        19160000
181157             MOVE SQLCA            TO DP013-SQLCA                 19170000
181158             PERFORM DP014-0000-PROCESS-ABEND                     19180000
181159     END-EVALUATE.                                                19190000
181160                                                                  19200000
181162***************************************************************   19210000
181163* SELECT NEEDED INFORMATION FROM THE XLT_SKU                      19220033
181163*       AND XLT_VND_STYL TABLES                                   19230033
181164**************************************************************    19240000
181165 2200-SELECT-SKU-INFO.                                            19250024
181167     EXEC SQL                                                     19260024
181167         SELECT SKU.INTR_UPC_ID                                   19270024
181167               ,SKU.SIZE_DESC                                     19280024
181167               ,SKU.CSTM_CLOR_DESC                                19290024
181167               ,VSTYL.MAJ_CL_NBR                                  19300033
181167               ,VSTYL.SUB_CL_NBR                                  19310033
181167           INTO :XLT00003-INTR-UPC-ID                             19320033
181167               ,:XLT00003-SIZE-DESC                               19330033
181167               ,:XLT00003-CSTM-CLOR-DESC                          19340033
181167               ,:XLT00004-MAJ-CL-NBR                              19350033
181167               ,:XLT00004-SUB-CL-NBR                              19360033
181167           FROM XLT_SKU SKU                                       19370033
181167              , XLT_VND_STYL VSTYL                                19380033
181167          WHERE SKU.ITM_NBR  = :PURITM-ITM-NBR                    19390033
181167            AND SKU.STYL_ID  = VSTYL.STYL_ID                      19400033
181167     END-EXEC.                                                    19410033
181167                                                                  19420033
181182     EVALUATE TRUE                                                19430033
181183         WHEN SQLCODE = +0                                        19440033
181184             MOVE XLT00003-CSTM-CLOR-DESC  TO SL1-COLOR           19450033
181184             MOVE XLT00003-SIZE-DESC       TO SL1-SIZE            19460033
181187         WHEN SQLCODE = +100                                      19470033
181188             CONTINUE                                             19480033
181189         WHEN SQLWARN NOT = SPACE                                 19490033
181190         WHEN SQLCODE NOT = +0                                    19500033
181191             MOVE '2200-SELECT-SKU-INFO' TO DP013-PARAGRAPH       19510033
181193             MOVE 'XLT_SKU'           TO DP013-DB2-TABLE-NAME (1) 19520033
181193             MOVE 'XLT_VND_STYL'      TO DP013-DB2-TABLE-NAME (2) 19530037
181194             SET DP013-DB2-ABEND   TO TRUE                        19540037
181195             SET DP013-NO-ROLLBACK TO TRUE                        19550037
181196             MOVE SQLCA            TO DP013-SQLCA                 19560037
181197             PERFORM DP014-0000-PROCESS-ABEND                     19570037
181198     END-EVALUATE.                                                19580037
181167                                                                  19590033
181271******************************************************************19600000
181272*  CONTROLS SKUS PROCESSING                                       19610000
181273******************************************************************19620000
181274 2300-PROCESS-SKUS.                                               19630000
181276     MOVE 0                        TO PV-PO-LINE-NBR.             19640000
181277     SET PS-NOT-EOF-PO-LINE-CSR    TO TRUE.                       19650000
181278     PERFORM 2310-OPEN-PO-LINE-CSR.                               19660000
181279     PERFORM 2320-PROCESS-PO-LINE-CSR                             19670000
181280         UNTIL PS-EOF-PO-LINE-CSR.                                19680000
181281     PERFORM 2330-CLOSE-PO-LINE-CSR.                              19690000
181282                                                                  19700000
181284******************************************************************19710000
181285*  OPENS PO LINE CSR                                              19720000
181286******************************************************************19730000
181287 2310-OPEN-PO-LINE-CSR.                                           19740000
181289         EXEC SQL                                                 19750000
181290             OPEN PO-LINE-CSR                                     19760000
181291         END-EXEC                                                 19770000
181292                                                                  19780000
181293     EVALUATE TRUE                                                19790000
181294         WHEN SQLCODE = +0                                        19800000
181295             CONTINUE                                             19810000
181296         WHEN SQLWARN NOT = SPACE                                 19820000
181297         WHEN SQLCODE NOT = +0                                    19830000
181298             MOVE '2310-OPEN-PO-LINE-CSR'                         19840000
181299                                      TO DP013-PARAGRAPH          19850000
181300             MOVE 'TPTKLNE'           TO DP013-DB2-TABLE-NAME (1) 19860000
181301             SET DP013-DB2-ABEND   TO TRUE                        19870000
181302             SET DP013-NO-ROLLBACK TO TRUE                        19880000
181303             MOVE SQLCA            TO DP013-SQLCA                 19890000
181304             PERFORM DP014-0000-PROCESS-ABEND                     19900000
181500     END-EVALUATE.                                                19910000
181700                                                                  19920000
181800******************************************************************19930000
181900*  FETCHS PO LINE CSR AND PRINTS                                  19940000
182000******************************************************************19950000
182100 2320-PROCESS-PO-LINE-CSR.                                        19960000
182300     EXEC SQL                                                     19970000
182400         FETCH PO-LINE-CSR                                        19980000
182500         INTO :PURITM-CL-NBR,                                     19990000
182600              :PURITM-SKU-SEQ-NBR,                                20000000
182700              :PURITM-VEND-STYL-NAME,                             20010000
182800              :PURITM-SKU-DESC,                                   20020000
182900              :PURITM-UNT-QTY,                                    20030000
183000              :PURITM-UNT-COST-AMT,                               20040000
183100              :PURITM-TOT-VAL-COST-AMT,                           20050000
183200              :PURITM-COLOR-DESC,                                 20060000
183300              :PURITM-SIZE-DESC,                                  20070000
183400              :PURITM-AD-EVNT-DTE,                                20080000
183500              :PURITM-GP-QTY,                                     20090000
183600              :PURITM-GP-RTL-AMT,                                 20100000
183700              :PURITM-UNT-RTL-PR-AMT,                             20110000
183800              :PURITM-TOT-VAL-RTL-AMT,                            20120000
183900              :PURITM-PO-LNE-NBR,                                 20130000
184000              :PURITM-STATUS-CDE,                                 20140000
184100              :PURITM-ITM-NBR,                                    20150000
184200              :PTKLNE-PO-LNE-NBR,                                 20160000
184300              :PTKLNE-TKT-DESC,                                   20170000
184400              :PTKLNE-TKT-PLCMNT-CDE,                             20180000
184500              :PTKLNE-TKT-QTY,                                    20190000
184600              :PLDESC-TKT-PLCMNT-DESC                             20200000
184700     END-EXEC.                                                    20210000
187100                                                                  20220000
187200     EVALUATE TRUE                                                20230000
187300         WHEN SQLCODE = +0                                        20240000
187400         WHEN SQLCODE = +100                                      20250000
187500             CONTINUE                                             20260000
187600         WHEN SQLWARN NOT = SPACE                                 20270000
187700         WHEN SQLCODE NOT = +0                                    20280000
187800             MOVE '2320-PROCESS-PO-LINE-CSR'                      20290000
187810                                      TO DP013-PARAGRAPH          20300000
187830             SET DP013-DB2-ABEND   TO TRUE                        20310000
187840             SET DP013-NO-ROLLBACK TO TRUE                        20320000
187850             MOVE SQLCA            TO DP013-SQLCA                 20330000
187860             PERFORM DP014-0000-PROCESS-ABEND                     20340000
188100     END-EVALUATE.                                                20350000
188200                                                                  20360000
188300     IF SQLCODE = +100                                            20370000
188400         SET PS-EOF-PO-LINE-CSR    TO TRUE                        20380000
188500     ELSE                                                         20390000
188600         MOVE +0                   TO PV-ALLOC-CNT                20400000
188700         IF PURITM-STATUS-CDE = 'CA'                              20410000
188800             COMPUTE PV-TEMP-LINE-CNT = PV-LINE-CNT + 5           20420000
188900         ELSE                                                     20430000
189000             COMPUTE PV-TEMP-LINE-CNT = PV-LINE-CNT + 3           20440000
189100         END-IF                                                   20450000
189200                                                                  20460000
189300         IF PV-TEMP-LINE-CNT > +60                                20470000
189400             ADD +1                TO PV-PAGE-CNT                 20480000
189500             MOVE PV-PAGE-CNT      TO HL1-PG-NBR                  20490000
189600             MOVE +0               TO PV-LINE-CNT                 20500000
189710             PERFORM 2117-PRINT-HEADINGS                          20510000
191100         END-IF                                                   20520000
191200                                                                  20530000
191300         ADD +1                    TO PV-PO-LINE-NBR              20540005
191400         MOVE PTKLNE-PO-LNE-NBR    TO SL1-LNE-NBR                 20550005
192400         MOVE PTKLNE-TKT-DESC      TO SL2-TICKET-TYPE             20560008
192610         MOVE PLDESC-TKT-PLCMNT-DESC TO SL2-TICKET-PLACEMENT      20570005
193400         MOVE PURITM-VEND-STYL-NAME TO SL1-STYLE                  20580005
193700         MOVE PURITM-SKU-DESC      TO SL1-DESC                    20590000
193900         MOVE PTKLNE-TKT-QTY       TO SL1-QTY                     20600000
194100         MOVE PURITM-UNT-RTL-PR-AMT TO SL1-RETAIL                 20610005
194110         PERFORM 2200-SELECT-SKU-INFO                             20620023
193000         MOVE XLT00004-MAJ-CL-NBR  TO PV-MAJOR-CLASS              20630037
193000         MOVE PV-MAJOR-CLASS       TO SL1-MAJOR-CLASS             20640037
193000         MOVE XLT00004-SUB-CL-NBR  TO PV-SUB-CLASS                20650037
193000         MOVE PV-SUB-CLASS         TO SL1-SUB-CLASS               20660037
194110         IF PURITM-ITM-NBR > 0                                    20670038
194110             MOVE PURITM-ITM-NBR    TO DK-ITM-NBR                 20680039
194110             PERFORM 2400-GET-VENDOR-UPC                          20690039
194110             EVALUATE SQLCODE                                     20700041
194110                 WHEN ZERO                                        20710039
332400                     MOVE XLV00003-UPC-NBR TO SL1-UPC             20720039
194110                 WHEN OTHER                                       20730039
332400                     PERFORM 2410-GET-INTERNAL-UPC                20740039
194110             END-EVALUATE                                         20750039
194110         ELSE                                                     20760038
194110             MOVE 'UPC NT FOUND' TO SL1-UPC-X                     20770044
194110         END-IF                                                   20780038
194120                                                                  20790000
194140         MOVE PC-TRIPLE-SPACE              TO DRS01-COMM-CTL      20800000
194910         MOVE SKU-LINE-1                   TO DRS01-COMM-DATA     20810005
195000         PERFORM 9001-LINK-TO-DRS-1                               20820000
195200                                                                  20830000
195210         MOVE SKU-LINE-2                   TO DRS01-COMM-DATA     20840000
195220         MOVE PC-SINGLE-SPACE              TO DRS01-COMM-CTL      20850000
195600         PERFORM 9001-LINK-TO-DRS-1                               20860000
195700                                                                  20870000
195800         ADD +4                    TO PV-LINE-CNT                 20880000
196100     END-IF.                                                      20890000
196200                                                                  20900000
196300******************************************************************20910000
196400*  CLOSES PO LINE CSR                                             20920000
196500******************************************************************20930000
196600 2330-CLOSE-PO-LINE-CSR.                                          20940000
196900     EXEC SQL                                                     20950005
197000         CLOSE PO-LINE-CSR                                        20960005
197100     END-EXEC                                                     20970005
197700                                                                  20980000
197800     EVALUATE TRUE                                                20990000
197900         WHEN SQLCODE = +0                                        21000000
198000             CONTINUE                                             21010000
198100         WHEN SQLWARN NOT = SPACE                                 21020000
198200         WHEN SQLCODE NOT = +0                                    21030000
198300             MOVE '2330-CLOSE-PO-LINE-CSR'                        21040000
198320                                      TO DP013-PARAGRAPH          21050000
198330             SET DP013-DB2-ABEND   TO TRUE                        21060000
198340             SET DP013-NO-ROLLBACK TO TRUE                        21070000
198350             MOVE SQLCA            TO DP013-SQLCA                 21080000
198360             PERFORM DP014-0000-PROCESS-ABEND                     21090000
198600     END-EVALUATE.                                                21100000
198800                                                                  21110000
198900     COPY DPPD024.                                                21120047
199000                                                                  21130000
196300******************************************************************21140010
196400*  GET UPC -- FROM XLV_UPC VIEW                                   21150029
196400*          -- FETCH THE VENDOR UPC FROM XLV_UPC VIEW.  THERE      21160039
196400*             SHOOULD BE ONE VENDOR UPC BEING SENT EDI. IF WE DO  21170039
196400*             NOT FIND A VENDOR UPC, WE WILL FETCH THE INTERNAL   21180039
196400*             UPC FROM THE VIEW AND USE THAT ONE.                 21190039
196500******************************************************************21200010
196600 2400-GET-VENDOR-UPC.                                             21210010
194110     INITIALIZE DCLXLV00003.                                      21220037
330900     EXEC SQL                                                     21230010
331000          SELECT UPC.UPC_NBR                                      21240039
331100            INTO :XLV00003-UPC-NBR                                21250024
331200            FROM XLT_SKU SKU                                      21260039
331200               , XLV_UPC UPC                                      21270039
331300           WHERE SKU.ITM_NBR          = :DK-ITM-NBR               21280039
331300             AND SKU.INTR_UPC_ID      = UPC.INTR_UPC_ID           21290040
331400             AND UPC.UPC_TYP_CDE      = 'V'                       21300039
331400             AND UPC.EDI_ORD_IND      = 'Y'                       21310039
331800     END-EXEC.                                                    21320010
331900                                                                  21330010
332000     EVALUATE TRUE                                                21340010
332100         WHEN SQLCODE = ZERO                                      21350010
332200         WHEN SQLCODE = +100                                      21360010
332300         WHEN SQLCODE = -811                                      21370010
332400             CONTINUE                                             21380039
332600         WHEN SQLWARN0 NOT = SPACES                               21390010
332700         WHEN SQLCODE  NOT = ZERO                                 21400010
332800              MOVE '2400-GET-VENDOR-UPC' TO DP013-PARAGRAPH       21410010
333000              MOVE 'ERROR FETCHING VENDOR UPC NBR'                21420019
333000                                       TO DP013-MESSAGE-TEXT (1)  21430019
333000              MOVE DK-ORD-NBR          TO PV-PO-NBR-NUMERIC       21440019
333000              MOVE PURITM-PO-LNE-NBR   TO PV-PO-LNE-NBR-NUMERIC   21450019
333000              STRING 'PO NBR: '        DELIMITED BY SIZE          21460019
333000                     PV-PO-NBR-PRINT   DELIMITED BY SIZE          21470019
333000                     ' PO LINE NBR: '  DELIMITED BY SIZE          21480019
333000                     PV-PO-LNE-NBR-PRINT                          21490022
333000                                       DELIMITED BY SIZE          21500029
333000                                     INTO DP013-MESSAGE-TEXT (2)  21510019
333200              MOVE SQLCA               TO DP013-SQLCA             21520019
333300              MOVE 'XLV_UPC'           TO DP013-DB2-TABLE-NAME (1)21530024
333300              MOVE 'XLV_SKU'           TO DP013-DB2-TABLE-NAME (2)21540039
333400              SET DP013-DB2-ABEND                                 21550039
333500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              21560039
333800              PERFORM DP014-0000-PROCESS-ABEND                    21570039
333900     END-EVALUATE.                                                21580039
333900                                                                  21590039
196300******************************************************************21600024
196400*  GET UPC -- FETCH THE INTERNAL UPC BECAUSE EITHER NO VENDOR UPC 21610039
196400*     WAS FOUND OR THERE WERE MULTIPLE VENDOR UPC'S               21620024
196400*       WE ARE USING 'FETCH FIRST ROW ONLY' TO FORCE DB2 TO BRING 21630039
196400*       BACK ONLY ONE ROW FROM THE QUERY.  THIS IS MORE EFFICIENT 21640039
196400*       THAN CHECKING FOR -811.  THIS IS NEW IN DB2 VER. 7.       21650039
196400*  IF SQL RETURNS WITH A +100 - NO INTERNAL UPC, THEN 'UPC NOT    21660039
196400*     FOUND' IS PRINTED ON THE DETAIL LINE.                       21670039
196500******************************************************************21680024
196600 2410-GET-INTERNAL-UPC.                                           21690024
194110     INITIALIZE DCLXLV00003.                                      21700037
330900     EXEC SQL                                                     21710024
331000          SELECT UPC.UPC_NBR                                      21720039
331100            INTO :XLV00003-UPC-NBR                                21730024
331200            FROM XLT_SKU SKU                                      21740039
331200               , XLV_UPC UPC                                      21750039
331300           WHERE SKU.ITM_NBR          = :DK-ITM-NBR               21760039
331300             AND SKU.INTR_UPC_ID      = UPC.INTR_UPC_ID           21770040
331400             AND UPC.UPC_TYP_CDE      = 'I'                       21780039
331400           FETCH FIRST ROW ONLY                                   21790039
331800     END-EXEC.                                                    21800039
331900                                                                  21810039
332000     EVALUATE TRUE                                                21820024
332100         WHEN SQLCODE = ZERO                                      21830024
332400             MOVE XLV00003-UPC-NBR     TO SL1-UPC                 21840024
332100         WHEN SQLCODE = +100                                      21850029
332100************ SHOULD NEVER GET HERE BUT JUST IN CASE               21860039
332400             MOVE 'UPC NT FOUND' TO SL1-UPC-X                     21870044
332600         WHEN SQLWARN0 NOT = SPACES                               21880024
332700         WHEN SQLCODE  NOT = ZERO                                 21890024
332800              MOVE '2410-GET-INTERNAL-UPC' TO DP013-PARAGRAPH     21900024
333000              MOVE 'ERROR FETCHING INTERNAL UPC NBR'              21910024
333000                                       TO DP013-MESSAGE-TEXT (1)  21920024
333000              MOVE DK-ORD-NBR          TO PV-PO-NBR-NUMERIC       21930024
333000              MOVE PURITM-PO-LNE-NBR   TO PV-PO-LNE-NBR-NUMERIC   21940024
333000              STRING 'PO NBR: '        DELIMITED BY SIZE          21950024
333000                     PV-PO-NBR-PRINT   DELIMITED BY SIZE          21960024
333000                     ' PO LINE NBR: '  DELIMITED BY SIZE          21970024
333000                     PV-PO-LNE-NBR-PRINT                          21980024
333000                                       DELIMITED BY SIZE          21990024
333000                                     INTO DP013-MESSAGE-TEXT (2)  22000024
333200              MOVE SQLCA               TO DP013-SQLCA             22010024
333300              MOVE 'XLV_UPC'           TO DP013-DB2-TABLE-NAME (1)22020024
333300              MOVE 'XLV_SKU'           TO DP013-DB2-TABLE-NAME (2)22030039
333400              SET DP013-DB2-ABEND                                 22040039
333500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              22050039
333800              PERFORM DP014-0000-PROCESS-ABEND                    22060039
333900     END-EVALUATE.                                                22070039
199000                                                                  22080039
200701******************************************************************22090024
200702*9000-EOJ-ROUTINE.                                                22100000
200709****************************************************************  22110000
200711 9000-EOJ-ROUTINE.                                                22120000
200713     MOVE PC-TERM                TO DRS01-DRRB-FUNC.              22130000
200715     PERFORM 9001-LINK-TO-DRS-1.                                  22140000
200718                                                                  22150000
200720******************************************************************22160000
200721*9001-LINK-TO-DRS-1.                                              22170000
200722*     SENT DRS REPORT LINE TO REPORT 1                            22180000
200723****************************************************************  22190000
200724 9001-LINK-TO-DRS-1.                                              22200000
200725     MOVE PC-RID-1                TO DRS01-DRRB-RID.              22210000
200726     PERFORM 9900-LINK-TO-DRS.                                    22220000
200727                                                                  22230000
200737******************************************************************22240000
200738*9900-LINK-TO-DRS.                                                22250000
200739* ==> PROCESSES:                                                  22260000
200740*   - ISSUES THE LINK TO DRS.                                     22270000
200741*     PERFORMED BY:  B100-INITIALIZE                              22280000
200742*                    C200-PRINT-PAGE-HEADER                       22290000
200743*                    C201-PRINT-REPORT                            22300000
200744*                    Z100-CLOSE-FILES                             22310000
200745******************************************************************22320000
200746 9900-LINK-TO-DRS.                                                22330000
200748     EXEC CICS                                                    22340000
200749         LINK                                                     22350000
200750             PROGRAM  ('DRS1INTC')                                22360000
200751             COMMAREA (DRS01-COMMAREA)                            22370000
200752     END-EXEC.                                                    22380000
200753                                                                  22390000
200754     EVALUATE TRUE                                                22400000
200755         WHEN DRS01-DRRB-RC      = 0                              22410000
200756             CONTINUE                                             22420000
200757         WHEN OTHER                                               22430000
200758             MOVE '9900-LINK-TO-DRS'                              22440000
200759                                 TO DP013-PARAGRAPH               22450000
200760             SET DP013-OTHER-ABEND                                22460000
200761                                 TO TRUE                          22470000
200762             MOVE DRS01-DRRB-FUNC                                 22480000
200763                                 TO PV-DRS-DRRB-FUNC              22490000
200764             MOVE DRS01-DRRB-RID TO PV-DRS-DRRB-RID               22500000
200765             MOVE DRS01-DRRD-OPTIONS                              22510000
200766                                 TO PV-DRS-DRRB-OPTIONS           22520000
200767             MOVE DRS01-DRRB-RC  TO PV-DRS-DRRB-RC                22530000
200768             MOVE DRS01-DRRB-ATTR-ERROR                           22540000
200769                                 TO PV-DRS-ATTR-ERROR             22550000
200770             MOVE DRS01-DRRB-DRDC                                 22560000
200771                                 TO PV-DRS-DRRB-DRDC              22570000
200772             MOVE DRS01-DRRB01-LINES                              22580000
200773                                 TO PV-DRS-DRRB01-LINES           22590008
200774             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22600000
200775                                 TO DP013-MESSAGE-TEXT (1)        22610000
200776             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      22620000
200777                                 TO DP013-MESSAGE-TEXT (2)        22630000
200778             PERFORM  DP014-0000-PROCESS-ABEND                    22640000
200779     END-EVALUATE.                                                22650000
200780                                                                  22660005
200781*----------------------------------------------------------------*22670000
200782*    ABEND PROCESSOR MODULE                                      *22680000
200783*----------------------------------------------------------------*22690000
200790     COPY DPPD014.                                                22700047
