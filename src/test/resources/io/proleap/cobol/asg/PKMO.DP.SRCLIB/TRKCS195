000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    TRKCS195.                                         00020000
000300 AUTHOR.        RICHARD MOORE.                                    00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  12-31-98.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*    Y195 - TRANSPORTATION INQUIRY CRITERIA SPEC                 *00080002
000900*                                                                *00090000
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00100000
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00110000
001200*    DETAIL SCREEN.                                              *00120000
001300*----------------------------------------------------------------*00130000
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED  1/16/2023    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001400                                                                  00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600 DATA DIVISION.                                                   00160000
001700/                                                                 00170000
001800 WORKING-STORAGE SECTION.                                         00180000
001900                                                                  00190000
002000 01  PC-PROGRAM-CONSTANTS.                                        00200000
002100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TR195A  '. 00210002
002200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TRKM195 '. 00220000
002300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TRKCS195'. 00230000
002400     05  PC-MAX-RETRIES            PIC  9(01)  VALUE  3.          00240000
002500     05  PC-TSYMSG-NUMBERS.                                       00250000
002600         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00260000
002700         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00270000
002800         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00280000
002900         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00290000
003000         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      00300000
003100         10  PC-TSYMSG-00143       PIC  9(05)  VALUE  00143.      00310000
003200         10  PC-TSYMSG-00148       PIC  9(05)  VALUE  00148.      00320000
003300         10  PC-TSYMSG-00587       PIC  9(05)  VALUE  00587.      00330000
003400         10  PC-TSYMSG-00639       PIC  9(05)  VALUE  00639.      00340000
003500         10  PC-TSYMSG-00640       PIC  9(05)  VALUE  00640.      00350000
003600         10  PC-TSYMSG-02127       PIC  9(05)  VALUE  02127.      00360016
003700         10  PC-TSYMSG-02139       PIC  9(05)  VALUE  02139.      00370016
003800         10  PC-TSYMSG-02140       PIC  9(05)  VALUE  02140.      00380016
003900         10  PC-TSYMSG-02146       PIC  9(05)  VALUE  02146.      00390016
004000                                                                  00400000
004100 01  PV-PROGRAM-VARIABLES.                                        00410000
004200     05  PV-RETRY-COUNTER          PIC  9(03)  VALUE  0           00420000
004300                                               COMP-3.            00430000
004400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00440016
004500                                                    COMP SYNC.    00450016
004600     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           00460000
004700                                               COMP-3.            00470000
004800     05  PV-XFACT-DATE             PIC X(10) VALUE SPACES.        00480000
004900     05  PV-SHPDT-DATE             PIC X(10) VALUE SPACES.        00490007
005000     05  PV-AD-DATE                PIC X(10) VALUE SPACES.        00500000
005100     05  PV-DEPT-PO017             PIC 9(04).                     00510016
005200     05  PV-DEPT-PO017-X REDEFINES                                00520016
005300         PV-DEPT-PO017.                                           00530016
005400         10 PV-DEPT-PO017-X-1      PIC X(01).                     00540016
005500         10 PV-DEPT-PO017-X-2      PIC X(03).                     00550016
005600     05  PV-SUBCLASS-PO017         PIC 9(04).                     00560016
005700     05  PV-SUBCLASS-PO017-X REDEFINES                            00570016
005800         PV-SUBCLASS-PO017.                                       00580016
005900         10 PV-SUBCLASS-PO017-X-1  PIC X(02).                     00590016
006000         10 PV-SUBCLASS-PO017-X-2  PIC X(02).                     00600016
006100     05  PV-SKU-PO017              PIC 9(08).                     00610016
006200     05  PV-SKU-PO017-X REDEFINES                                 00620016
006300         PV-SKU-PO017.                                            00630016
006400         10 PV-SKU-PO017-X-1       PIC X(05).                     00640016
006500         10 PV-SKU-PO017-X-2       PIC X(03).                     00650016
006600     05  PV-DISPLAY-RECAP-CRIT     PIC X(01).                     00660016
006700         88  PV-DISPLAY-RECAP                VALUE 'Y'            00670016
006800                                                   'N'            00680016
006900                                                   '0'            00690016
007000                                                   '1'            00700016
007100                                                   '2'            00710016
007200                                                   '3'            00720016
007300                                                   '4'            00730016
007400                                                   '5'            00740016
007500                                                   '6'            00750016
007600                                                   '7'            00760016
007700                                                   '8'            00770016
007800                                                   '9'.           00780016
007900 01  PS-PROGRAM-SWITCHES.                                         00790000
008000     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00800000
008100         88  PS-ERROR                          VALUE  'Y'.        00810000
008200         88  PS-NO-ERROR                       VALUE  'N'.        00820000
008300*----------------------------------------------------------------*00830000
008400*    MAP LAYOUT                                                  *00840000
008500*----------------------------------------------------------------*00850000
008600     COPY TRKM195.                                                00860000
008700/                                                                 00870000
008800*----------------------------------------------------------------*00880000
008900*    ATTRIBUTE SETTINGS COPYBOOK.                                *00890000
009000*----------------------------------------------------------------*00900000
009100     COPY DPWS015.                                                00910000
009200/                                                                 00920000
009300*----------------------------------------------------------------*00930000
009400*    FUNCTION KEYS COPYBOOK                                      *00940000
009500*----------------------------------------------------------------*00950000
009600     COPY DPWS016.                                                00960000
009700/                                                                 00970000
009800******************************************************************00980000
009900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00990000
010000** SUB-ROUTINE (DPKUT100).                                      **01000000
010100******************************************************************01010000
010200     COPY DPWS010I.                                               01020000
010300/                                                                 01030000
010400*----------------------------------------------------------------*01040000
010500*  WORK AREA PASSED IN CALL TO DPKUT500                          *01050000
010600*----------------------------------------------------------------*01060000
010700     COPY DPWS500.                                                01070000
010800/                                                                 01080000
010900******************************************************************01090000
011000** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01100000
011100** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01110000
011200******************************************************************01120000
011300     COPY DPWS030.                                                01130000
CICS       COPY DPWS930.                                                01130000
011400/                                                                 01140000
011500***************************************************************** 01150000
011600*    STANDARD COMMAREA.                                           01160000
011700***************************************************************** 01170000
011800                                                                  01180000
011900     COPY DPWS020.                                                01190000
012000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01200000
012100                                                                  01210000
012200***************************************************************** 01220000
012300*    INTER-APPLICATION COMMAREA.                                  01230000
012400***************************************************************** 01240000
012500                                                                  01250000
012600         10  INTER-APPL-COMM-AREA PIC X(200).                     01260000
012700     COPY TRWS195.                                                01270000
012800     COPY POWS017.                                                01280016
012900***************************************************************** 01290016
013000*    SPECIFIC COMMMAREA FOR TRKCS195.                             01300016
013100***************************************************************** 01310016
013200         10  ASC-SPECIFIC-COMMAREA.                               01320016
013300             15  ASC-PO-NBR                PIC X(09).             01330016
013400             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                01340016
013500                                           PIC 9(09).             01350016
013600             15  ASC-CNTRY-ORG             PIC X(3).              01360016
013700             15  ASC-CNTRY-PLC             PIC X(3).              01370016
013800             15  ASC-STATUS-GRP            PIC X(3).              01380016
013900             15  ASC-STATUS-CDE            PIC X(2).              01390016
014000             15  ASC-DEPT-NBR              PIC X(4).              01400016
014100             15  ASC-DEPT-NBR-N REDEFINES ASC-DEPT-NBR            01410016
014200                                           PIC 9(4).              01420016
014300             15  ASC-CLASS                 PIC X(4).              01430016
014400             15  ASC-CLASS-N REDEFINES ASC-CLASS                  01440016
014500                                           PIC 9(4).              01450016
014600             15  ASC-SUBCLASS              PIC X(4).              01460016
014700             15  ASC-SUBCLASS-N REDEFINES ASC-SUBCLASS            01470016
014800                                           PIC 9(4).              01480016
014900             15  ASC-PO-TYP-CDE            PIC X(2).              01490016
015000             15  ASC-PO-TYP-DESC           PIC X(20).             01500016
015100             15  ASC-SKU                   PIC X(8).              01510016
015200             15  ASC-SKU-N REDEFINES ASC-SKU                      01520016
015300                                           PIC 9(8).              01530016
015400             15  ASC-ENT-NAME-DESC         PIC X(19).             01540016
015500             15  ASC-MAKER-NME             PIC X(19).             01550016
015600             15  ASC-VEND-STYL-NME         PIC X(19).             01560016
015700             15  ASC-SEASONAL-SET          PIC X(05).             01570016
015800             15  ASC-DMM                   PIC X(02).             01580016
015900             15  ASC-GROUP-CDE             PIC X(03).             01590016
016000             15  ASC-AD-EVNT-DTE-CC        PIC X(08).             01600016
016100             15  ASC-AD-EVNT-DTE           PIC X(08).             01610016
016200             15  ASC-AD-EVNT-DTE-ISO       PIC X(10).             01620016
016300             15  ASC-PO-TYP-IND            PIC X(01).             01630016
016400             15  ASC-EDI-IND               PIC X(01).             01640016
016500             15  ASC-PRE-TICKET-IND        PIC X(01).             01650016
016600             15  ASC-DIRECT-STORE-IND      PIC X(01).             01660016
016700             15  ASC-STR-NBR               PIC X(05).             01670022
016720             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR              01672023
016730                                           PIC 9(5).              01673023
016800             15  ASC-QUOTA-CATEGORY        PIC X(05).             01680016
016900             15  ASC-PACK-BY-STORE-IND     PIC X(01).             01690016
017000             15  ASC-FOB-CDE               PIC X(03).             01700016
017100             15  ASC-POE-CDE               PIC X(03).             01710016
017200             15  ASC-OTB-PER-NBR-BEG       PIC X(06).             01720016
017300             15  ASC-OTB-PER-NBR-BEG-N REDEFINES                  01730016
017400                 ASC-OTB-PER-NBR-BEG       PIC 9(06).             01740016
017500             15  ASC-OTB-PER-NBR-END       PIC X(06).             01750016
017600             15  ASC-OTB-PER-NBR-END-N REDEFINES                  01760016
017700                 ASC-OTB-PER-NBR-END       PIC 9(06).             01770016
017800             15  ASC-PRE-PACK-IND          PIC X(01).             01780016
017900             15  ASC-XFACT-BEF-DTE         PIC X(08).             01790016
018000             15  ASC-XFACT-BEF-DTE-CC      PIC X(08).             01800016
018100             15  ASC-XFACT-BEF-DTE-ISO PIC X(10).                 01810016
018200             15  ASC-XFACT-END-DTE         PIC X(08).             01820016
018300             15  ASC-XFACT-END-DTE-CC      PIC X(08).             01830016
018400             15  ASC-XFACT-END-DTE-ISO PIC X(10).                 01840016
018500             15  ASC-SHPDT-BEF-DTE         PIC X(08).             01850016
018600             15  ASC-SHPDT-BEF-DTE-CC      PIC X(08).             01860016
018700             15  ASC-SHPDT-BEF-DTE-ISO PIC X(10).                 01870016
018800             15  ASC-SHPDT-END-DTE         PIC X(08).             01880016
018900             15  ASC-SHPDT-END-DTE-CC      PIC X(08).             01890016
019000             15  ASC-SHPDT-END-DTE-ISO PIC X(10).                 01900016
019100             15  ASC-NEW-STORE-IND         PIC X(01).             01910016
019200             15  ASC-PIC-AD-IND            PIC X(01).             01920016
019300             15  ASC-SORT1-BY-IND          PIC X(01).             01930016
019400             15  ASC-SORT2-BY-IND          PIC X(01).             01940016
019500             15  ASC-DFOB                  PIC X(01).             01950016
019600             15  ASC-DPOE                  PIC X(01).             01960016
019700             15  ASC-DXFC                  PIC X(01).             01970016
019800             15  ASC-DBKD                  PIC X(01).             01980016
019900             15  ASC-DFRD                  PIC X(01).             01990016
020000             15  ASC-DSLD                  PIC X(01).             02000016
020100             15  ASC-DPRD                  PIC X(01).             02010016
020200             15  ASC-DCSR                  PIC X(01).             02020016
020300             15  ASC-DDVN                  PIC X(01).             02030016
020400             15  ASC-DETA                  PIC X(01).             02040016
020500             15  ASC-DDSB                  PIC X(01).             02050016
020600             15  ASC-DCNL                  PIC X(01).             02060016
020700             15  ASC-DADD                  PIC X(01).             02070016
020800             15  ASC-DOTB                  PIC X(01).             02080016
020900             15  ASC-DPPK                  PIC X(01).             02090016
021000             15  ASC-DEDI                  PIC X(01).             02100016
021100             15  ASC-DSTA                  PIC X(01).             02110016
021200             15  ASC-DDOL                  PIC X(01).             02120016
021300             15  ASC-DUNT                  PIC X(01).             02130016
021400             15  ASC-DTRP                  PIC X(01).             02140016
021500             15  ASC-DSPL                  PIC X(01).             02150016
021600             15  ASC-DQCT                  PIC X(01).             02160016
021700             15  ASC-DVNS                  PIC X(01).             02170016
021800             15  ASC-DCRL                  PIC X(01).             02180016
021900             15  ASC-DTRA                  PIC X(01).             02190016
022000             15  ASC-SEL-QUEUE-NAME.                              02200016
022100                 20  ASC-SEL-TERM-ID                 PIC  X(04).  02210016
022200                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   02220016
022300                                                          COMP-3. 02230016
022400                 20  ASC-SEL-SEQ                     PIC  9(01).  02240016
022500             15  ASC-LOCAL-01-SW                   PIC X(01).     02250016
022600                 88  ASC-LOCAL-01-NEED-CONFIRM     VALUE 'Y'.     02260016
022700                 88  ASC-LOCAL-01-NO-NEED-CONFIRM  VALUE 'N'.     02270016
022800/                                                                 02280016
022900*----------------------------------------------------------------*02290016
023000*    ABEND PROCESSING COPYBOOK.                                  *02300016
023100*----------------------------------------------------------------*02310016
023200     COPY DPWS013.                                                02320016
023300/                                                                 02330016
023400*----------------------------------------------------------------*02340016
023500*    DB2 AREA FOR THE PO TYPE CODE TABLE                         *02350016
023600*----------------------------------------------------------------*02360016
023700     EXEC SQL                                                     02370016
023800         INCLUDE TPOTYCD                                          02380016
023900     END-EXEC.                                                    02390016
024000/                                                                 02400016
024100*----------------------------------------------------------------*02410016
024200*    DB2 AREA FOR THE SEASONAL SET CODE TABLE                    *02420016
024300*----------------------------------------------------------------*02430016
024400     EXEC SQL                                                     02440016
024500         INCLUDE TSEASET                                          02450016
024600     END-EXEC.                                                    02460016
024700/                                                                 02470016
024800*----------------------------------------------------------------*02480016
024900*    DB2 AREA FOR COMMUNICATIONS                                 *02490016
025000*----------------------------------------------------------------*02500016
025100     EXEC SQL                                                     02510016
025200         INCLUDE SQLCA                                            02520016
025300     END-EXEC.                                                    02530016
025400/                                                                 02540016
025500 LINKAGE SECTION.                                                 02550016
025600                                                                  02560016
025700 01  DFHCOMMAREA.                                                 02570016
025800     05  FILLER                         OCCURS  1 TO 4072 TIMES   02580016
025900                                        DEPENDING ON EIBCALEN.    02590016
026000         10  FILLER                     PIC X.                    02600016
026100/                                                                 02610016
026200 PROCEDURE DIVISION.                                              02620016
026300                                                                  02630016
026400***************************************************************** 02640016
026500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02650016
026600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02660016
026700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02670016
026800**                                                             ** 02680016
026900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02690016
027000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02700016
027100***************************************************************** 02710016
027200                                                                  02720016
027300 0000-MAIN-MODULE.                                                02730016
027400                                                                  02740016
027500     INITIALIZE DP030-CICS-API-FIELDS.                            02750016
027600     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02760016
027700     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02770016
027800     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02780016
027900     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02790016
028000     MOVE LENGTH OF TR195AI      TO DP030-MAP-LENGTH (1).         02800016
028100     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02810016
028200                                                                  02820016
028300     PERFORM 0001-CALL-CICS-ARCH-API.                             02830016
028400     PERFORM 1000-CONTROL-PROCESSING                              02840016
028500                                                                  02850016
028600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02860016
028700     PERFORM 0001-CALL-CICS-ARCH-API.                             02870016
028800                                                                  02880016
028900                                                                  02890016
029000 0001-CALL-CICS-ARCH-API.                                         02900016
029100                                                                  02910016
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02920016
029300                                    DFHCOMMAREA                           
029400                                    DP030-CICS-API-FIELDS                 
029500                                    DP020-STANDARD-COMMAREA               
029600                                    TR195AI.                              
029700                                                                  02970016
029800     IF  DP030-RC-CALL-SUCCESSFUL                                 02980016
029900         CONTINUE                                                 02990016
030000     ELSE                                                         03000016
030100         SET DP013-NO-ROLLBACK                                    03010016
030200             DP013-XCTL-DISPLAY-RESTART                           03020016
030300             DP013-CICS-ABEND    TO TRUE                          03030016
030400         MOVE 'BEFORE 0000-MAIN-MODULE'                           03040016
030500                                 TO DP013-PARAGRAPH               03050016
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03060016
CICS  -             'N NEXT LINE'      TO DP013-MESSAGE-TEXT (2)        03070016
030800         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        03080016
030900         PERFORM DP013-0000-PROCESS-ABEND                         03090016
031000     END-IF.                                                      03100016
031100/                                                                 03110016
031200*----------------------------------------------------------------*03120016
031300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03130016
031400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03140016
031500*----------------------------------------------------------------*03150016
031600                                                                  03160016
031700 1000-CONTROL-PROCESSING.                                         03170016
031800                                                                  03180016
031900     EVALUATE TRUE                                                03190016
032000         WHEN DP020-NEXT-ACT-INITIAL                              03200016
032100             INITIALIZE ASC-SPECIFIC-COMMAREA                     03210016
032200             PERFORM 4000-BUILD-INITIAL-PANEL                     03220016
032300                                                                  03230016
032400         WHEN DP020-NEXT-ACT-READ-MAP                             03240016
032500             PERFORM 2000-FKEY-PROCESSING                         03250016
032600                                                                  03260016
032700         WHEN DP020-NEXT-ACT-RETURN                               03270016
032800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03280016
032900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03290016
033000                                                                  03300016
033100         WHEN OTHER                                               03310016
033200             SET DP013-LOGIC-ABEND                                03320016
033300                 DP013-NO-ROLLBACK                                03330016
033400                                 TO TRUE                          03340016
033500             MOVE '1000-CONTROL-PROCESSING'                       03350016
033600                                 TO  DP013-PARAGRAPH              03360016
033700             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03370016
033800                                 TO  DP013-MESSAGE-TEXT(1)        03380016
033900             MOVE DP020-NEXT-APPL-ACTIVITY                        03390016
034000                                 TO DP013-MESSAGE-TEXT(2)         03400016
034100             PERFORM DP013-0000-PROCESS-ABEND                     03410016
034200     END-EVALUATE.                                                03420016
034300/                                                                 03430016
034400*----------------------------------------------------------------*03440016
034500* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03450016
034600* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03460016
034700* EDITS.                                                         *03470016
034800*----------------------------------------------------------------*03480016
034900                                                                  03490016
035000 2000-FKEY-PROCESSING.                                            03500016
035100                                                                  03510016
035200     EVALUATE TRUE                                                03520016
035300                                                                  03530016
035400         WHEN DP020-SRC-AID = DP016-CLEAR                         03540016
035500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03550016
035600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03560016
035700                                                                  03570016
035800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03580016
035900             INITIALIZE ASC-SPECIFIC-COMMAREA                     03590016
036000             PERFORM 4000-BUILD-INITIAL-PANEL                     03600016
036100             PERFORM 3100-RESET-ATTRIBUTES                        03610016
036200                                                                  03620016
036300         WHEN OTHER                                               03630016
036400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03640016
036500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03650016
036600             IF  PS-NO-ERROR                                      03660016
036700                 SET DP030-CONTINUE-GO                            03670016
036800                                 TO TRUE                          03680016
036900                 PERFORM 2100-CHECK-FUNCTION-KEY                  03690016
037000             ELSE                                                 03700016
037100                 SET DP030-OVERRIDE-GO                            03710016
037200                                 TO TRUE                          03720016
037300             END-IF                                               03730016
037400     END-EVALUATE.                                                03740016
037500/                                                                 03750016
037600******************************************************************03760016
037700** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03770016
037800** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03780016
037900** FROM THE CICS ARCHITECTURE API.                              **03790016
038000******************************************************************03800016
038100                                                                  03810016
038200 2100-CHECK-FUNCTION-KEY.                                         03820016
038300                                                                  03830016
038400     EVALUATE TRUE                                                03840016
038500                                                                  03850016
038600         WHEN DP020-SRC-AID = DP016-ENTER                         03860016
038700             CONTINUE                                             03870016
038800                                                                  03880016
038900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03890016
039000             SET ASC-LOCAL-01-NO-NEED-CONFIRM TO TRUE             03900016
039100             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03910016
039200                                                                  03920016
039300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03930016
039400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03940016
039500             PERFORM 2115-PREPARE-INTER-APPL-PO                   03950016
039600                                                                  03960016
039700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03970016
039800             PERFORM 2120-PREPARE-INTER-APPL-SKU                  03980016
039900                                                                  03990016
040000         WHEN OTHER                                               04000016
040100             SET DP013-NO-ROLLBACK                                04010016
040200                 DP013-XCTL-DISPLAY-RESTART                       04020016
040300                 DP013-CICS-ABEND                                 04030016
040400                                 TO TRUE                          04040016
040500             MOVE '2100-CHECK-FUNCTION-KEY'                       04050016
040600                                 TO DP013-PARAGRAPH               04060016
040700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04070016
040800                                 TO DP013-MESSAGE-TEXT (1)        04080016
040900             PERFORM DP013-0000-PROCESS-ABEND                     04090016
041000     END-EVALUATE.                                                04100016
041100/                                                                 04110016
041200******************************************************************04120016
041300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04130016
041400** INTER-APPLICATION COMMAREA.                                  **04140016
041500******************************************************************04150016
041600                                                                  04160016
041700 2110-PREPARE-INTER-APPL-COMM.                                    04170016
041800                                                                  04180016
041900     INITIALIZE TR195-INTER-APPL-COMMAREA                         04190016
042000     REPLACING ALPHANUMERIC BY SPACES                             04200016
042100               NUMERIC BY ZEROS.                                  04210016
042200                                                                  04220016
042300     MOVE ASC-PO-NBR             TO TR195-PO-NBR.                 04230016
042400     MOVE ASC-CNTRY-ORG          TO TR195-CNTRY-ORG.              04240016
042500     MOVE ASC-CNTRY-PLC          TO TR195-CNTRY-PLC.              04250016
042600     MOVE ASC-DEPT-NBR           TO TR195-DEPT-NBR.               04260016
042700     MOVE ASC-STATUS-GRP         TO TR195-STATUS-GRP.             04270016
042800     MOVE ASC-STATUS-CDE         TO TR195-STATUS-CDE.             04280016
042900     MOVE ASC-CLASS              TO TR195-CLASS.                  04290016
043000     MOVE ASC-SUBCLASS           TO TR195-SUBCLASS.               04300016
043100     MOVE ASC-PO-TYP-CDE         TO TR195-PO-TYP-CDE.             04310016
043200     MOVE ASC-SKU                TO TR195-SKU.                    04320016
043300     MOVE ASC-ENT-NAME-DESC      TO TR195-ENT-NAME-DESC.          04330016
043400     MOVE ASC-VEND-STYL-NME      TO TR195-VEND-STYL-NME.          04340016
043500     MOVE ASC-SEASONAL-SET       TO TR195-SEASONAL-SET.           04350016
043600     MOVE ASC-DMM                TO TR195-DMM.                    04360016
043700     MOVE ASC-GROUP-CDE          TO TR195-GROUP-CDE.              04370016
043800     MOVE ASC-AD-EVNT-DTE-CC     TO TR195-AD-EVNT-DTE.            04380016
043900     MOVE ASC-EDI-IND            TO TR195-EDI-IND.                04390016
044000     MOVE ASC-PRE-TICKET-IND     TO TR195-PRE-TICKET-IND.         04400016
044100     MOVE ASC-QUOTA-CATEGORY     TO TR195-QUOTA-CATEGORY.         04410016
044200     MOVE ASC-DIRECT-STORE-IND   TO TR195-DIRECT-STORE-IND.       04420016
044300     MOVE ASC-STR-NBR            TO TR195-STR-NBR.                04430024
044400     MOVE ASC-PACK-BY-STORE-IND  TO TR195-PACK-BY-STORE-IND.      04440016
044500     MOVE ASC-PRE-PACK-IND       TO TR195-PRE-PACK-IND.           04450016
044600     MOVE ASC-FOB-CDE            TO TR195-FOB-CDE.                04460016
044700     MOVE ASC-POE-CDE            TO TR195-POE-CDE.                04470016
044800     MOVE ASC-MAKER-NME          TO TR195-MAKER-NME.              04480016
044900     MOVE ASC-XFACT-BEF-DTE-CC   TO TR195-XFACT-BEF-DTE.          04490016
045000     MOVE ASC-XFACT-END-DTE-CC   TO TR195-XFACT-END-DTE.          04500016
045100     MOVE ASC-NEW-STORE-IND      TO TR195-NEW-STR-IND.            04510016
045200     MOVE ASC-PIC-AD-IND         TO TR195-PIC-AD-IND.             04520016
045300     MOVE ASC-SORT1-BY-IND       TO TR195-SORT1-BY-IND.           04530016
045400     MOVE ASC-SORT2-BY-IND       TO TR195-SORT2-BY-IND.           04540016
045500     MOVE ASC-OTB-PER-NBR-BEG    TO TR195-OTB-PER-NBR-BEG.        04550016
045600     MOVE ASC-OTB-PER-NBR-END    TO TR195-OTB-PER-NBR-END.        04560016
045700     MOVE ASC-SHPDT-BEF-DTE-CC   TO TR195-SHPDT-BEF-DTE.          04570016
045800     MOVE ASC-SHPDT-END-DTE-CC   TO TR195-SHPDT-END-DTE.          04580016
045900     MOVE ASC-DFOB               TO TR195-DFOB.                   04590016
046000     MOVE ASC-DPOE               TO TR195-DPOE.                   04600016
046100     MOVE ASC-DXFC               TO TR195-DXFC.                   04610016
046200     MOVE ASC-DBKD               TO TR195-DBKD.                   04620016
046300     MOVE ASC-DFRD               TO TR195-DFRD.                   04630016
046400     MOVE ASC-DSLD               TO TR195-DSLD.                   04640016
046500     MOVE ASC-DPRD               TO TR195-DPRD.                   04650016
046600     MOVE ASC-DCSR               TO TR195-DCSR.                   04660016
046700     MOVE ASC-DDVN               TO TR195-DDVN.                   04670016
046800     MOVE ASC-DETA               TO TR195-DETA.                   04680016
046900     MOVE ASC-DDSB               TO TR195-DDSB.                   04690016
047000     MOVE ASC-DCNL               TO TR195-DCNL.                   04700016
047100     MOVE ASC-DADD               TO TR195-DADD.                   04710016
047200     MOVE ASC-DOTB               TO TR195-DOTB.                   04720016
047300     MOVE ASC-DPPK               TO TR195-DPPK.                   04730016
047400     MOVE ASC-DEDI               TO TR195-DEDI.                   04740016
047500     MOVE ASC-DSTA               TO TR195-DSTA.                   04750016
047600     MOVE ASC-DDOL               TO TR195-DDOL.                   04760016
047700     MOVE ASC-DUNT               TO TR195-DUNT.                   04770016
047800     MOVE ASC-DTRP               TO TR195-DTRP.                   04780016
047900     MOVE ASC-DSPL               TO TR195-DSPL.                   04790016
048000     MOVE ASC-DQCT               TO TR195-DQCT.                   04800016
048100     MOVE ASC-DVNS               TO TR195-DVNS.                   04810016
048200     MOVE ASC-DCRL               TO TR195-DCRL.                   04820016
048300     MOVE ASC-DTRA               TO TR195-DTRA.                   04830016
048400/                                                                 04840016
048500******************************************************************04850016
048600** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **04860016
048700** INTER-APPLICATION COMMAREA.                                  **04870016
048800******************************************************************04880016
048900                                                                  04890016
049000 2115-PREPARE-INTER-APPL-PO.                                      04900016
049100                                                                  04910016
049200     INITIALIZE PO017-INTER-APPL-COMMAREA                         04920016
049300         REPLACING ALPHANUMERIC BY SPACES                         04930016
049400                   NUMERIC BY ZEROS.                              04940016
049500                                                                  04950016
049600     MOVE ASC-PO-NBR TO PO017-PO-NBR.                             04960016
049700                                                                  04970016
049800/                                                                 04980016
049900******************************************************************04990016
050000** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **05000016
050100** INTER-APPLICATION COMMAREA.                                  **05010016
050200******************************************************************05020016
050300                                                                  05030016
050400 2120-PREPARE-INTER-APPL-SKU.                                     05040016
050500                                                                  05050016
050600     INITIALIZE PO017-INTER-APPL-COMMAREA                         05060016
050700         REPLACING ALPHANUMERIC BY SPACES                         05070016
050800                   NUMERIC BY ZEROS.                              05080016
050900                                                                  05090016
051000     MOVE ASC-DEPT-NBR              TO PV-DEPT-PO017.             05100016
051100     MOVE PV-DEPT-PO017-X-2         TO PO017-DEPT-NBR.            05110016
051200                                                                  05120016
051300     MOVE ASC-SUBCLASS              TO PV-SUBCLASS-PO017.         05130016
051400     MOVE PV-SUBCLASS-PO017-X-2     TO PO017-CL-NBR.              05140016
051500                                                                  05150016
051600     MOVE ASC-SKU                   TO PV-SKU-PO017.              05160016
051700     MOVE PV-SKU-PO017-X            TO PO017-SKU-NBR.             05170019
051800                                                                  05180019
051900     MOVE ASC-OTB-PER-NBR-BEG (3:2)                               05190019
052000                               TO PO017-OTB-PER-NBR-BEG (1:2).    05200019
052100     MOVE ASC-OTB-PER-NBR-BEG (5:2)                               05210019
052200                               TO PO017-OTB-PER-NBR-BEG (3:2).    05220019
052300     MOVE ASC-OTB-PER-NBR-END (3:2)                               05230019
052400                               TO PO017-OTB-PER-NBR-END (1:2).    05240019
052500     MOVE ASC-OTB-PER-NBR-END (5:2)                               05250019
052600                               TO PO017-OTB-PER-NBR-END (3:2).    05260019
052700                                                                  05270019
052800/                                                                 05280019
052900*----------------------------------------------------------------*05290019
053000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*05300019
053100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *05310019
053200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *05320019
053300*----------------------------------------------------------------*05330019
053400                                                                  05340019
053500 2200-MOVE-SCREEN-TO-COMMAREA.                                    05350019
053600                                                                  05360019
053700     IF  APONUML > ZERO                                           05370019
053800         MOVE APONUMI              TO ASC-PO-NBR                  05380019
053900     ELSE                                                         05390019
054000         IF  APONUMF = DP015-ERASE-EOF                            05400019
054100             MOVE SPACE            TO ASC-PO-NBR                  05410019
054200         END-IF                                                   05420019
054300     END-IF.                                                      05430019
054400                                                                  05440019
054500     IF  ACTORL > ZERO                                            05450019
054600         MOVE ACTORI              TO ASC-CNTRY-ORG                05460019
054700     ELSE                                                         05470019
054800         IF  ACTORF = DP015-ERASE-EOF                             05480019
054900             MOVE SPACE           TO ASC-CNTRY-ORG                05490019
055000         END-IF                                                   05500019
055100     END-IF.                                                      05510019
055200                                                                  05520019
055300     IF  ACTPLL > ZERO                                            05530019
055400         MOVE ACTPLI              TO ASC-CNTRY-PLC                05540019
055500     ELSE                                                         05550019
055600         IF  ACTPLF = DP015-ERASE-EOF                             05560019
055700             MOVE SPACE           TO ASC-CNTRY-PLC                05570019
055800         END-IF                                                   05580019
055900     END-IF.                                                      05590019
056000                                                                  05600019
056100     IF  ADEPTL > ZERO                                            05610019
056200         MOVE ADEPTI               TO ASC-DEPT-NBR                05620019
056300     ELSE                                                         05630019
056400         IF  ADEPTF = DP015-ERASE-EOF                             05640019
056500             MOVE SPACE            TO ASC-DEPT-NBR                05650019
056600         END-IF                                                   05660019
056700     END-IF.                                                      05670019
056800                                                                  05680019
056900     IF  ASTGRPL > ZERO                                           05690019
057000         MOVE ASTGRPI              TO ASC-STATUS-GRP              05700019
057100     ELSE                                                         05710019
057200         IF  ASTGRPF = DP015-ERASE-EOF                            05720019
057300             MOVE SPACE            TO ASC-STATUS-GRP              05730019
057400         END-IF                                                   05740019
057500     END-IF.                                                      05750019
057600                                                                  05760019
057700     IF  ASRT1L > ZERO                                            05770019
057800         MOVE ASRT1I                TO ASC-SORT1-BY-IND           05780019
057900     ELSE                                                         05790019
058000         IF  ASRT1F = DP015-ERASE-EOF                             05800019
058100             MOVE SPACE             TO ASC-SORT1-BY-IND           05810019
058200         END-IF                                                   05820019
058300     END-IF.                                                      05830019
058400                                                                  05840019
058500     IF  ASRT2L > ZERO                                            05850019
058600         MOVE ASRT2I                TO ASC-SORT2-BY-IND           05860019
058700     ELSE                                                         05870019
058800         IF  ASRT2F = DP015-ERASE-EOF                             05880019
058900             MOVE SPACE             TO ASC-SORT2-BY-IND           05890019
059000         END-IF                                                   05900019
059100     END-IF.                                                      05910019
059200                                                                  05920019
059300     IF  ASC1L > ZERO                                             05930019
059400         MOVE ASC1I                TO ASC-STATUS-CDE              05940019
059500     ELSE                                                         05950019
059600         IF  ASC1F = DP015-ERASE-EOF                              05960019
059700             MOVE SPACE            TO ASC-STATUS-CDE              05970019
059800         END-IF                                                   05980019
059900     END-IF.                                                      05990019
060000                                                                  06000019
060100     IF  ACLASSL > ZERO                                           06010019
060200         MOVE ACLASSI               TO ASC-CLASS                  06020019
060300     ELSE                                                         06030019
060400         IF  ACLASSF = DP015-ERASE-EOF                            06040019
060500             MOVE SPACE             TO ASC-CLASS                  06050019
060600         END-IF                                                   06060019
060700     END-IF.                                                      06070019
060800                                                                  06080019
060900     IF  ASUBCLL > ZERO                                           06090019
061000         MOVE ASUBCLI               TO ASC-SUBCLASS               06100019
061100     ELSE                                                         06110019
061200         IF  ASUBCLF = DP015-ERASE-EOF                            06120019
061300             MOVE SPACE             TO ASC-SUBCLASS               06130019
061400         END-IF                                                   06140019
061500     END-IF.                                                      06150019
061600                                                                  06160019
061700     IF  APOTYPEL > ZERO                                          06170019
061800         MOVE APOTYPEI             TO ASC-PO-TYP-CDE              06180019
061900     ELSE                                                         06190019
062000         IF  APOTYPEF = DP015-ERASE-EOF                           06200019
062100             MOVE SPACE            TO ASC-PO-TYP-CDE              06210019
062200         END-IF                                                   06220019
062300     END-IF.                                                      06230019
062400                                                                  06240019
062500     IF ASKUL > ZERO                                              06250019
062600         MOVE ASKUI                TO ASC-SKU                     06260019
062700     ELSE                                                         06270019
062800         IF ASKUF = DP015-ERASE-EOF                               06280019
062900             MOVE SPACE            TO ASC-SKU                     06290019
063000         END-IF                                                   06300019
063100     END-IF.                                                      06310019
063200                                                                  06320019
063300     IF AFOBL > ZERO                                              06330019
063400         MOVE AFOBI                TO ASC-FOB-CDE                 06340019
063500     ELSE                                                         06350019
063600         IF AFOBF = DP015-ERASE-EOF                               06360019
063700             MOVE SPACE            TO ASC-FOB-CDE                 06370019
063800         END-IF                                                   06380019
063900     END-IF.                                                      06390019
064000                                                                  06400019
064100     IF APOEL > ZERO                                              06410019
064200         MOVE APOEI                TO ASC-POE-CDE                 06420019
064300     ELSE                                                         06430019
064400         IF APOEF = DP015-ERASE-EOF                               06440019
064500             MOVE SPACE            TO ASC-POE-CDE                 06450019
064600         END-IF                                                   06460019
064700     END-IF.                                                      06470019
064800                                                                  06480019
064900     IF AGRPCDEL > ZERO                                           06490019
065000         MOVE AGRPCDEI             TO ASC-GROUP-CDE               06500019
065100     ELSE                                                         06510019
065200         IF AGRPCDEF = DP015-ERASE-EOF                            06520019
065300             MOVE SPACE            TO ASC-GROUP-CDE               06530019
065400         END-IF                                                   06540019
065500     END-IF.                                                      06550019
065600                                                                  06560019
065700     IF  ASEASETL > ZERO                                          06570019
065800         MOVE ASEASETI             TO ASC-SEASONAL-SET            06580019
065900     ELSE                                                         06590019
066000         IF  ASEASETF = DP015-ERASE-EOF                           06600019
066100             MOVE SPACE            TO ASC-SEASONAL-SET            06610019
066200         END-IF                                                   06620019
066300     END-IF.                                                      06630019
066400                                                                  06640019
066500     IF  ADMML > ZERO                                             06650019
066600         MOVE ADMMI                TO ASC-DMM                     06660019
066700     ELSE                                                         06670019
066800         IF  ADMMF = DP015-ERASE-EOF                              06680019
066900             MOVE SPACE            TO ASC-DMM                     06690019
067000         END-IF                                                   06700019
067100     END-IF.                                                      06710019
067200                                                                  06720019
067300     IF  AMAKERL > ZERO                                           06730019
067400         MOVE AMAKERI              TO ASC-MAKER-NME               06740019
067500     ELSE                                                         06750019
067600         IF  AMAKERF  = DP015-ERASE-EOF                           06760019
067700             MOVE SPACE            TO ASC-MAKER-NME               06770019
067800         END-IF                                                   06780019
067900     END-IF.                                                      06790019
068000                                                                  06800019
068100     IF AVENDNML > ZERO                                           06810019
068200         MOVE AVENDNMI             TO ASC-ENT-NAME-DESC           06820019
068300     ELSE                                                         06830019
068400         IF AVENDNMF = DP015-ERASE-EOF                            06840019
068500             MOVE SPACE            TO ASC-ENT-NAME-DESC           06850019
068600         END-IF                                                   06860019
068700     END-IF.                                                      06870019
068800                                                                  06880019
068900     IF ASTYLEL > ZERO                                            06890019
069000         MOVE ASTYLEI              TO ASC-VEND-STYL-NME           06900019
069100     ELSE                                                         06910019
069200         IF ASTYLEF = DP015-ERASE-EOF                             06920019
069300             MOVE SPACE            TO ASC-VEND-STYL-NME           06930019
069400         END-IF                                                   06940019
069500     END-IF.                                                      06950019
069600                                                                  06960019
069700     IF ADDATEL > ZERO                                            06970019
069800         MOVE SPACE            TO ASC-AD-EVNT-DTE                 06980019
069900                                  ASC-AD-EVNT-DTE-CC              06990019
070000                                  ASC-AD-EVNT-DTE-ISO             07000019
070100         MOVE ADDATEI          TO ASC-AD-EVNT-DTE                 07010019
070200     ELSE                                                         07020019
070300         IF ADDATEF = DP015-ERASE-EOF                             07030019
070400             MOVE SPACE            TO ASC-AD-EVNT-DTE             07040019
070500                                      ASC-AD-EVNT-DTE-CC          07050019
070600                                      ASC-AD-EVNT-DTE-ISO         07060019
070700         END-IF                                                   07070019
070800     END-IF.                                                      07080019
070900                                                                  07090019
071000     IF APPIL > ZERO                                              07100019
071100         MOVE APPII                TO ASC-PRE-PACK-IND            07110019
071200     ELSE                                                         07120019
071300         IF APPIF = DP015-ERASE-EOF                               07130019
071400             MOVE SPACE            TO ASC-PRE-PACK-IND            07140019
071500         END-IF                                                   07150019
071600     END-IF.                                                      07160019
071700                                                                  07170019
071800     IF AOTBBEGL > ZERO                                           07180019
071900         MOVE SPACES TO ASC-OTB-PER-NBR-BEG                       07190019
072000         IF AOTBBEGI NOT = SPACES                                 07200019
072100         IF AOTBBEGI(3:2) > 80                                    07210019
072200            MOVE '19' TO ASC-OTB-PER-NBR-BEG(1:2)                 07220019
072300         ELSE                                                     07230019
072400            MOVE '20' TO ASC-OTB-PER-NBR-BEG(1:2)                 07240019
072500         END-IF                                                   07250019
072600         END-IF                                                   07260019
072700         MOVE AOTBBEGI(3:2) TO ASC-OTB-PER-NBR-BEG(3:2)           07270019
072800         MOVE AOTBBEGI(1:2) TO ASC-OTB-PER-NBR-BEG(5:2)           07280019
072900     ELSE                                                         07290019
073000         IF AOTBBEGF = DP015-ERASE-EOF                            07300019
073100             MOVE SPACE            TO ASC-OTB-PER-NBR-BEG         07310019
073200         END-IF                                                   07320019
073300     END-IF.                                                      07330019
073400                                                                  07340019
073500     IF AOTBENDL > ZERO                                           07350019
073600         MOVE SPACES TO ASC-OTB-PER-NBR-END                       07360019
073700         IF AOTBENDI NOT = SPACES                                 07370019
073800         IF AOTBENDI(3:2) > 80                                    07380019
073900            MOVE '19' TO ASC-OTB-PER-NBR-END(1:2)                 07390019
074000         ELSE                                                     07400019
074100            MOVE '20' TO ASC-OTB-PER-NBR-END(1:2)                 07410019
074200         END-IF                                                   07420019
074300         END-IF                                                   07430019
074400         MOVE AOTBENDI(3:2) TO ASC-OTB-PER-NBR-END(3:2)           07440019
074500         MOVE AOTBENDI(1:2) TO ASC-OTB-PER-NBR-END(5:2)           07450019
074600     ELSE                                                         07460019
074700         IF AOTBENDF = DP015-ERASE-EOF                            07470019
074800             MOVE SPACE            TO ASC-OTB-PER-NBR-END         07480019
074900         END-IF                                                   07490019
075000     END-IF.                                                      07500019
075100                                                                  07510019
075200     IF AXFCBL > ZERO                                             07520019
075300         MOVE SPACE            TO ASC-XFACT-BEF-DTE               07530019
075400                                  ASC-XFACT-BEF-DTE-CC            07540019
075500                                  ASC-XFACT-BEF-DTE-ISO           07550019
075600         MOVE AXFCBI           TO ASC-XFACT-BEF-DTE               07560019
075700     ELSE                                                         07570019
075800         IF AXFCBF = DP015-ERASE-EOF                              07580019
075900             MOVE SPACE            TO ASC-XFACT-BEF-DTE           07590019
076000                                      ASC-XFACT-BEF-DTE-CC        07600019
076100                                      ASC-XFACT-BEF-DTE-ISO       07610019
076200         END-IF                                                   07620019
076300     END-IF.                                                      07630019
076400                                                                  07640019
076500     IF AXFCEL > ZERO                                             07650019
076600         MOVE SPACE            TO ASC-XFACT-END-DTE               07660019
076700                                  ASC-XFACT-END-DTE-CC            07670019
076800                                  ASC-XFACT-END-DTE-ISO           07680019
076900         MOVE AXFCEI           TO ASC-XFACT-END-DTE               07690019
077000     ELSE                                                         07700019
077100         IF AXFCEF = DP015-ERASE-EOF                              07710019
077200             MOVE SPACE            TO ASC-XFACT-END-DTE           07720019
077300                                      ASC-XFACT-END-DTE-CC        07730019
077400                                      ASC-XFACT-END-DTE-ISO       07740019
077500         END-IF                                                   07750019
077600     END-IF.                                                      07760019
077700                                                                  07770019
077800     IF ASHDBL > ZERO                                             07780019
077900         MOVE SPACE            TO ASC-SHPDT-BEF-DTE               07790019
078000                                  ASC-SHPDT-BEF-DTE-CC            07800019
078100                                  ASC-SHPDT-BEF-DTE-ISO           07810019
078200         MOVE ASHDBI           TO ASC-SHPDT-BEF-DTE               07820019
078300     ELSE                                                         07830019
078400         IF ASHDBF = DP015-ERASE-EOF                              07840019
078500             MOVE SPACE            TO ASC-SHPDT-BEF-DTE           07850019
078600                                      ASC-SHPDT-BEF-DTE-CC        07860019
078700                                      ASC-SHPDT-BEF-DTE-ISO       07870019
078800         END-IF                                                   07880019
078900     END-IF.                                                      07890019
079000                                                                  07900019
079100     IF ASHDEL > ZERO                                             07910019
079200         MOVE SPACE            TO ASC-SHPDT-END-DTE               07920019
079300                                  ASC-SHPDT-END-DTE-CC            07930019
079400                                  ASC-SHPDT-END-DTE-ISO           07940019
079500         MOVE ASHDEI           TO ASC-SHPDT-END-DTE               07950019
079600     ELSE                                                         07960019
079700         IF ASHDEF = DP015-ERASE-EOF                              07970019
079800             MOVE SPACE            TO ASC-SHPDT-END-DTE           07980019
079900                                      ASC-SHPDT-END-DTE-CC        07990019
080000                                      ASC-SHPDT-END-DTE-ISO       08000019
080100         END-IF                                                   08010019
080200     END-IF.                                                      08020019
080300                                                                  08030019
080400     IF ANEWSTRL > ZERO                                           08040019
080500         MOVE ANEWSTRI             TO ASC-NEW-STORE-IND           08050019
080600     ELSE                                                         08060019
080700         IF ANEWSTRF = DP015-ERASE-EOF                            08070019
080800             MOVE SPACE            TO ASC-NEW-STORE-IND           08080019
080900         END-IF                                                   08090019
081000     END-IF.                                                      08100019
081100                                                                  08110019
081200     IF APICADL > ZERO                                            08120019
081300         MOVE APICADI              TO ASC-PIC-AD-IND              08130019
081400     ELSE                                                         08140019
081500         IF APICADF = DP015-ERASE-EOF                             08150019
081600             MOVE SPACE            TO ASC-PIC-AD-IND              08160019
081700         END-IF                                                   08170019
081800     END-IF.                                                      08180019
081900                                                                  08190019
082000     IF AEDIL > ZERO                                              08200019
082100         MOVE AEDII              TO ASC-EDI-IND                   08210019
082200     ELSE                                                         08220019
082300         IF AEDIF = DP015-ERASE-EOF                               08230019
082400             MOVE SPACE            TO ASC-EDI-IND                 08240019
082500         END-IF                                                   08250019
082600     END-IF.                                                      08260019
082700                                                                  08270019
082800     IF APBSL > ZERO                                              08280019
082900         MOVE APBSI              TO ASC-PACK-BY-STORE-IND         08290019
083000     ELSE                                                         08300019
083100         IF APBSF = DP015-ERASE-EOF                               08310019
083200             MOVE SPACE            TO ASC-PACK-BY-STORE-IND       08320019
083300         END-IF                                                   08330019
083400     END-IF.                                                      08340019
083500                                                                  08350019
083600     IF APRETL > ZERO                                             08360019
083700         MOVE APRETI             TO ASC-PRE-TICKET-IND            08370019
083800     ELSE                                                         08380019
083900         IF APRETF = DP015-ERASE-EOF                              08390019
084000             MOVE SPACE            TO ASC-PRE-TICKET-IND          08400019
084100         END-IF                                                   08410019
084200     END-IF.                                                      08420019
084300                                                                  08430019
084400     IF AQUOTAL > ZERO                                            08440019
084500         MOVE AQUOTAI            TO ASC-QUOTA-CATEGORY            08450019
084600     ELSE                                                         08460019
084700         IF AQUOTAF = DP015-ERASE-EOF                             08470019
084800             MOVE SPACE            TO ASC-QUOTA-CATEGORY          08480019
084900         END-IF                                                   08490019
085000     END-IF.                                                      08500019
085100                                                                  08510019
085200     IF ADSTRL > ZERO                                             08520019
085300         MOVE ADSTRI             TO ASC-DIRECT-STORE-IND          08530019
085400     ELSE                                                         08540019
085500         IF ADSTRF = DP015-ERASE-EOF                              08550019
085600             MOVE SPACE            TO ASC-DIRECT-STORE-IND        08560019
085700         END-IF                                                   08570019
085800     END-IF.                                                      08580019
085900                                                                  08590019
086000     IF ASTRL > ZERO                                              08600019
086100         MOVE ASTRI             TO ASC-STR-NBR                    08610019
086200     ELSE                                                         08620019
086300         IF ASTRF = DP015-ERASE-EOF                               08630019
086400             MOVE SPACE            TO ASC-STR-NBR                 08640019
086500         END-IF                                                   08650019
086600     END-IF.                                                      08660019
086700                                                                  08670019
086800     IF ADFOBL > ZERO                                             08680019
086900         MOVE ADFOBI               TO ASC-DFOB                    08690019
087000     ELSE                                                         08700019
087100         IF ADFOBF = DP015-ERASE-EOF                              08710019
087200             MOVE SPACE            TO ASC-DFOB                    08720019
087300         END-IF                                                   08730019
087400     END-IF.                                                      08740019
087500                                                                  08750019
087600     IF ADPOEL > ZERO                                             08760019
087700         MOVE ADPOEI               TO ASC-DPOE                    08770019
087800     ELSE                                                         08780019
087900         IF ADPOEF = DP015-ERASE-EOF                              08790019
088000             MOVE SPACE            TO ASC-DPOE                    08800019
088100         END-IF                                                   08810019
088200     END-IF.                                                      08820019
088300                                                                  08830019
088400     IF ADXFCL > ZERO                                             08840019
088500         MOVE ADXFCI               TO ASC-DXFC                    08850019
088600     ELSE                                                         08860019
088700         IF ADXFCF = DP015-ERASE-EOF                              08870019
088800             MOVE SPACE            TO ASC-DXFC                    08880019
088900         END-IF                                                   08890019
089000     END-IF.                                                      08900019
089100                                                                  08910019
089200     IF ADBKDL > ZERO                                             08920019
089300         MOVE ADBKDI               TO ASC-DBKD                    08930019
089400     ELSE                                                         08940019
089500         IF ADBKDF = DP015-ERASE-EOF                              08950019
089600             MOVE SPACE            TO ASC-DBKD                    08960019
089700         END-IF                                                   08970019
089800     END-IF.                                                      08980019
089900                                                                  08990019
090000     IF ADPRDL > ZERO                                             09000019
090100         MOVE ADPRDI               TO ASC-DPRD                    09010019
090200     ELSE                                                         09020019
090300         IF ADPRDF = DP015-ERASE-EOF                              09030019
090400             MOVE SPACE            TO ASC-DPRD                    09040019
090500         END-IF                                                   09050019
090600     END-IF.                                                      09060019
090700                                                                  09070019
090800     IF ADSLDL > ZERO                                             09080019
090900         MOVE ADSLDI               TO ASC-DSLD                    09090019
091000     ELSE                                                         09100019
091100         IF ADSLDF = DP015-ERASE-EOF                              09110019
091200             MOVE SPACE            TO ASC-DSLD                    09120019
091300         END-IF                                                   09130019
091400     END-IF.                                                      09140019
091500                                                                  09150019
091600     IF ADPRDL > ZERO                                             09160019
091700         MOVE ADPRDI               TO ASC-DPRD                    09170019
091800     ELSE                                                         09180019
091900         IF ADPRDF = DP015-ERASE-EOF                              09190019
092000             MOVE SPACE            TO ASC-DPRD                    09200019
092100         END-IF                                                   09210019
092200     END-IF.                                                      09220019
092300                                                                  09230019
092400     IF ADFRDL > ZERO                                             09240019
092500         MOVE ADFRDI               TO ASC-DFRD                    09250019
092600     ELSE                                                         09260019
092700         IF ADFRDF = DP015-ERASE-EOF                              09270019
092800             MOVE SPACE            TO ASC-DFRD                    09280019
092900         END-IF                                                   09290019
093000     END-IF.                                                      09300019
093100                                                                  09310019
093200     IF ADCSRL > ZERO                                             09320019
093300         MOVE ADCSRI               TO ASC-DCSR                    09330019
093400     ELSE                                                         09340019
093500         IF ADCSRF = DP015-ERASE-EOF                              09350019
093600             MOVE SPACE            TO ASC-DCSR                    09360019
093700         END-IF                                                   09370019
093800     END-IF.                                                      09380019
093900                                                                  09390019
094000     IF ADDVNL > ZERO                                             09400019
094100         MOVE ADDVNI               TO ASC-DDVN                    09410019
094200     ELSE                                                         09420019
094300         IF ADDVNF = DP015-ERASE-EOF                              09430019
094400             MOVE SPACE            TO ASC-DDVN                    09440019
094500         END-IF                                                   09450019
094600     END-IF.                                                      09460019
094700                                                                  09470019
094800     IF ADETAL > ZERO                                             09480019
094900         MOVE ADETAI               TO ASC-DETA                    09490019
095000     ELSE                                                         09500019
095100         IF ADETAF = DP015-ERASE-EOF                              09510019
095200             MOVE SPACE            TO ASC-DETA                    09520019
095300         END-IF                                                   09530019
095400     END-IF.                                                      09540019
095500                                                                  09550019
095600     IF ADDSBL > ZERO                                             09560019
095700         MOVE ADDSBI               TO ASC-DDSB                    09570019
095800     ELSE                                                         09580019
095900         IF ADDSBF = DP015-ERASE-EOF                              09590019
096000             MOVE SPACE            TO ASC-DDSB                    09600019
096100         END-IF                                                   09610019
096200     END-IF.                                                      09620019
096300                                                                  09630019
096400     IF ADCNLL > ZERO                                             09640019
096500         MOVE ADCNLI               TO ASC-DCNL                    09650019
096600     ELSE                                                         09660019
096700         IF ADCNLF = DP015-ERASE-EOF                              09670019
096800             MOVE SPACE            TO ASC-DCNL                    09680019
096900         END-IF                                                   09690019
097000     END-IF.                                                      09700019
097100                                                                  09710019
097200     IF ADADDL > ZERO                                             09720019
097300         MOVE ADADDI               TO ASC-DADD                    09730019
097400     ELSE                                                         09740019
097500         IF ADADDF = DP015-ERASE-EOF                              09750019
097600             MOVE SPACE            TO ASC-DADD                    09760019
097700         END-IF                                                   09770019
097800     END-IF.                                                      09780019
097900                                                                  09790019
098000     IF ADOTBL > ZERO                                             09800019
098100         MOVE ADOTBI               TO ASC-DOTB                    09810019
098200     ELSE                                                         09820019
098300         IF ADOTBF = DP015-ERASE-EOF                              09830019
098400             MOVE SPACE            TO ASC-DOTB                    09840019
098500         END-IF                                                   09850019
098600     END-IF.                                                      09860019
098700                                                                  09870019
098800     IF ADPPKL > ZERO                                             09880019
098900         MOVE ADPPKI               TO ASC-DPPK                    09890019
099000     ELSE                                                         09900019
099100         IF ADPPKF = DP015-ERASE-EOF                              09910019
099200             MOVE SPACE            TO ASC-DPPK                    09920019
099300         END-IF                                                   09930019
099400     END-IF.                                                      09940019
099500                                                                  09950019
099600     IF ADEDIL > ZERO                                             09960019
099700         MOVE ADEDII               TO ASC-DEDI                    09970019
099800     ELSE                                                         09980019
099900         IF ADEDIF = DP015-ERASE-EOF                              09990019
100000             MOVE SPACE            TO ASC-DEDI                    10000019
100100         END-IF                                                   10010019
100200     END-IF.                                                      10020019
100300                                                                  10030019
100400     IF ADSTAL > ZERO                                             10040019
100500         MOVE ADSTAI               TO ASC-DSTA                    10050019
100600     ELSE                                                         10060019
100700         IF ADSTAF = DP015-ERASE-EOF                              10070019
100800             MOVE SPACE            TO ASC-DSTA                    10080019
100900         END-IF                                                   10090019
101000     END-IF.                                                      10100019
101100                                                                  10110019
101200     IF ADDOLL > ZERO                                             10120019
101300         MOVE ADDOLI               TO ASC-DDOL                    10130019
101400     ELSE                                                         10140019
101500         IF ADDOLF = DP015-ERASE-EOF                              10150019
101600             MOVE SPACE            TO ASC-DDOL                    10160019
101700         END-IF                                                   10170019
101800     END-IF.                                                      10180019
101900                                                                  10190019
102000     IF ADUNTL > ZERO                                             10200019
102100         MOVE ADUNTI               TO ASC-DUNT                    10210019
102200     ELSE                                                         10220019
102300         IF ADUNTF = DP015-ERASE-EOF                              10230019
102400             MOVE SPACE            TO ASC-DUNT                    10240019
102500         END-IF                                                   10250019
102600     END-IF.                                                      10260019
102700                                                                  10270019
102800     IF ADTRPL > ZERO                                             10280019
102900         MOVE ADTRPI               TO ASC-DTRP                    10290019
103000     ELSE                                                         10300019
103100         IF ADTRPF = DP015-ERASE-EOF                              10310019
103200             MOVE SPACE            TO ASC-DTRP                    10320019
103300         END-IF                                                   10330019
103400     END-IF.                                                      10340019
103500                                                                  10350019
103600     IF ADSPLL > ZERO                                             10360019
103700         MOVE ADSPLI               TO ASC-DSPL                    10370019
103800     ELSE                                                         10380019
103900         IF ADSPLF = DP015-ERASE-EOF                              10390019
104000             MOVE SPACE            TO ASC-DSPL                    10400019
104100         END-IF                                                   10410019
104200     END-IF.                                                      10420019
104300                                                                  10430019
104400     IF ADQCTL > ZERO                                             10440019
104500         MOVE ADQCTI               TO ASC-DQCT                    10450019
104600     ELSE                                                         10460019
104700         IF ADQCTF = DP015-ERASE-EOF                              10470019
104800             MOVE SPACE            TO ASC-DQCT                    10480019
104900         END-IF                                                   10490019
105000     END-IF.                                                      10500019
105100                                                                  10510019
105200     IF ADVNSL > ZERO                                             10520019
105300         MOVE ADVNSI               TO ASC-DVNS                    10530019
105400     ELSE                                                         10540019
105500         IF ADVNSF = DP015-ERASE-EOF                              10550019
105600             MOVE SPACE            TO ASC-DVNS                    10560019
105700         END-IF                                                   10570019
105800     END-IF.                                                      10580019
105900                                                                  10590019
106000     IF ADCRLL > ZERO                                             10600019
106100         MOVE ADCRLI               TO ASC-DCRL                    10610019
106200     ELSE                                                         10620019
106300         IF ADCRLF = DP015-ERASE-EOF                              10630019
106400             MOVE SPACE            TO ASC-DCRL                    10640019
106500         END-IF                                                   10650019
106600     END-IF.                                                      10660019
106700                                                                  10670019
106800     IF ADTRAL > ZERO                                             10680019
106900         MOVE ADTRAI               TO ASC-DTRA                    10690019
107000     ELSE                                                         10700019
107100         IF ADTRAF = DP015-ERASE-EOF                              10710019
107200             MOVE SPACE            TO ASC-DTRA                    10720019
107300         END-IF                                                   10730019
107400     END-IF.                                                      10740019
107500/                                                                 10750019
107600*----------------------------------------------------------------*10760019
107700* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *10770019
107800* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *10780019
107900* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*10790019
108000* IN THE DESTINATION PROGRAM, NOT HERE.                          *10800019
108100*----------------------------------------------------------------*10810019
108200                                                                  10820019
108300 3000-EDIT-DATA-IN-COMMAREA.                                      10830019
108400                                                                  10840019
108500     PERFORM 3100-RESET-ATTRIBUTES.                               10850019
108600                                                                  10860019
108700     EVALUATE TRUE                                                10870019
108800                                                                  10880019
108900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10890019
109000             IF ASC-LOCAL-01-NO-NEED-CONFIRM                      10900019
109100                 PERFORM 3005-EDIT-RECAP-CRITERIA                 10910019
109200             END-IF                                               10920019
109300                                                                  10930019
109400     END-EVALUATE.                                                10940019
109500                                                                  10950019
109600     IF  ASC-SORT1-BY-IND = 'P' OR 'X' OR 'F' OR 'S' OR           10960019
109700                            'D' OR 'V' OR ' '                     10970019
109800          CONTINUE                                                10980019
109900     ELSE                                                         10990019
110000          SET PS-ERROR          TO TRUE                           11000019
110100          SET DP020-MSG-FATAL   TO TRUE                           11010019
110200          MOVE PC-TSYMSG-02140  TO DP020-MSG-NUMBER               11020019
110300          MOVE DP015-UNP-ALP-BRT-OFF                              11030019
110400                                TO ASRT1A                         11040019
110500          MOVE DP015-RED        TO ASRT1C                         11050019
110600          MOVE DP015-REVERSE    TO ASRT1H                         11060019
110700          MOVE -1               TO ASRT1L                         11070019
110800          SET DP030-SET-CURSOR-APPL-1                             11080019
110900                                TO TRUE                           11090019
111000     END-IF.                                                      11100019
111100                                                                  11110019
111200     IF  ASC-SORT2-BY-IND = 'P' OR 'X' OR 'F' OR 'S' OR           11120019
111300                            'D' OR 'V' OR ' '                     11130019
111400          CONTINUE                                                11140019
111500     ELSE                                                         11150019
111600          SET PS-ERROR          TO TRUE                           11160019
111700          SET DP020-MSG-FATAL   TO TRUE                           11170019
111800          MOVE PC-TSYMSG-02140  TO DP020-MSG-NUMBER               11180019
111900          MOVE DP015-UNP-ALP-BRT-OFF                              11190019
112000                                TO ASRT2A                         11200019
112100          MOVE DP015-RED        TO ASRT2C                         11210019
112200          MOVE DP015-REVERSE    TO ASRT2H                         11220019
112300          MOVE -1               TO ASRT2L                         11230019
112400          SET DP030-SET-CURSOR-APPL-1                             11240019
112500                                TO TRUE                           11250019
112600     END-IF.                                                      11260019
112700                                                                  11270019
112800     IF  ASC-SEASONAL-SET > SPACES                                11280019
112900          PERFORM 3020-VALIDATE-SEASONAL-SET                      11290019
113000          IF SQLCODE = +100                                       11300019
113100              SET PS-ERROR          TO TRUE                       11310019
113200              SET DP020-MSG-FATAL   TO TRUE                       11320019
113300              MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER           11330019
113400              MOVE DP015-UNP-ALP-BRT-OFF                          11340019
113500                                    TO ASEASETA                   11350019
113600              MOVE DP015-RED        TO ASEASETC                   11360019
113700              MOVE DP015-REVERSE    TO ASEASETH                   11370019
113800              MOVE -1               TO ASEASETL                   11380019
113900              SET DP030-SET-CURSOR-APPL-1                         11390019
114000                                    TO TRUE                       11400019
114100          END-IF                                                  11410019
114200     END-IF.                                                      11420019
114300                                                                  11430019
114400     IF  ASC-PRE-PACK-IND > SPACES                                11440019
114500         IF  ASC-PRE-PACK-IND = 'C' OR 'S' OR 'M' OR 'I' OR 'B'   11450019
114600             CONTINUE                                             11460019
114700         ELSE                                                     11470019
114800             SET PS-ERROR          TO TRUE                        11480019
114900             SET DP020-MSG-FATAL   TO TRUE                        11490019
115000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11500019
115100             MOVE DP015-UNP-ALP-BRT-OFF                           11510019
115200                                   TO APPIA                       11520019
115300             MOVE DP015-RED        TO APPIC                       11530019
115400             MOVE DP015-REVERSE    TO APPIH                       11540019
115500             MOVE -1               TO APPIL                       11550019
115600             SET DP030-SET-CURSOR-APPL-1                          11560019
115700                                   TO TRUE                        11570019
115800         END-IF                                                   11580019
115900     END-IF.                                                      11590019
116000                                                                  11600019
116010                                                                  11600019
116012     IF  ASC-STR-NBR > SPACES                                     16520019
116013         MOVE ASC-STR-NBR          TO DP010I-UNEDITED-FIELD       16530019
116014         MOVE LENGTH OF ASC-STR-NBR                               16540019
116015                                   TO DP010I-MAXIMUM-DIGITS       16550019
116016         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16560019
116017         SET DP010I-NEGATIVE-NOT-ALLOWED                          16570019
116018                                   TO TRUE                        16580019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
116020         IF  DP010I-ERROR-DETECTED                                16600019
116021             SET PS-ERROR                                         16610019
116022                 DP020-MSG-FATAL   TO TRUE                        16620019
116023             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16630019
116024             MOVE DP015-UNP-ALP-BRT-OFF                           16640019
116025                                   TO ASTRA                       16650019
116026             MOVE DP015-RED        TO ASTRC                       16660019
116027             MOVE DP015-REVERSE    TO ASTRH                       16670019
116028             MOVE -1               TO ASTRL                       16680019
116029             SET DP030-SET-CURSOR-APPL-1                          16690019
116030                                   TO TRUE                        16700019
116031         ELSE                                                     16710019
116032             MOVE DP010I-NUMERIC-FIELD                            16720019
116033                                   TO ASC-STR-NBR-N               16730019
116034         END-IF                                                   16740019
116035     END-IF.                                                      16750019
116036                                                                  16760019
116040                                                                          
116100     IF  ASC-NEW-STORE-IND > SPACES                               11610019
116200         IF  ASC-NEW-STORE-IND = 'Y' OR 'N'                       11620019
116300             CONTINUE                                             11630019
116400         ELSE                                                     11640019
116500             SET PS-ERROR          TO TRUE                        11650019
116600             SET DP020-MSG-FATAL   TO TRUE                        11660019
116700             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11670019
116800             MOVE DP015-UNP-ALP-BRT-OFF                           11680019
116900                                   TO ANEWSTRA                    11690019
117000             MOVE DP015-RED        TO ANEWSTRC                    11700019
117100             MOVE DP015-REVERSE    TO ANEWSTRH                    11710019
117200             MOVE -1               TO ANEWSTRL                    11720019
117300             SET DP030-SET-CURSOR-APPL-1                          11730019
117400                                   TO TRUE                        11740019
117500         END-IF                                                   11750019
117600     END-IF.                                                      11760019
117700                                                                  11770019
117800     IF  ASC-PIC-AD-IND > SPACES                                  11780019
117900         IF  ASC-PIC-AD-IND = 'Y' OR 'N'                          11790019
118000             CONTINUE                                             11800019
118100         ELSE                                                     11810019
118200             SET PS-ERROR          TO TRUE                        11820019
118300             SET DP020-MSG-FATAL   TO TRUE                        11830019
118400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11840019
118500             MOVE DP015-UNP-ALP-BRT-OFF                           11850019
118600                                   TO APICADA                     11860019
118700             MOVE DP015-RED        TO APICADC                     11870019
118800             MOVE DP015-REVERSE    TO APICADH                     11880019
118900             MOVE -1               TO APICADL                     11890019
119000             SET DP030-SET-CURSOR-APPL-1                          11900019
119100                                   TO TRUE                        11910019
119200         END-IF                                                   11920019
119300     END-IF.                                                      11930019
119400                                                                  11940019
119500     IF ASC-XFACT-END-DTE > SPACES                                11950019
119600        INITIALIZE DPG51                                          11960019
119700        SET DPG51-ACTUAL-CALENDAR-ONLY                            11970019
119800                                 TO TRUE                          11980019
119900        SET DPG51-DO-NOT-INCR-DECR-DATE                           11990019
120000                                 TO TRUE                          12000019
120100        MOVE ZERO                TO TALLY                         12010019
120200        INSPECT ASC-XFACT-END-DTE                                 12020019
120300                TALLYING TALLY FOR ALL '/'                        12030019
120400        IF TALLY > 1                                              12040019
120500*               'MM/DD/YY'                                        12050019
120600           SET DPG52-LK-DTE-GREG-CC-FMT                           12060019
120700                                  TO TRUE                         12070019
120800           IF ASC-XFACT-END-DTE (7:2) > 80                        12080019
120900              MOVE '19' TO PV-XFACT-DATE(7:2)                     12090019
121000           ELSE                                                   12100019
121100              MOVE '20' TO PV-XFACT-DATE(7:2)                     12110019
121200           END-IF                                                 12120019
121300           MOVE ASC-XFACT-END-DTE(1:6)                            12130019
121400                         TO PV-XFACT-DATE(1:6)                    12140019
121500           MOVE ASC-XFACT-END-DTE(7:2)                            12150019
121600                        TO PV-XFACT-DATE(9:2)                     12160019
121700        ELSE                                                      12170019
121800*               'MMDDYY  '                                        12180019
121900           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      12190019
122000           IF ASC-XFACT-END-DTE(5:2) > 80                         12200019
122100              MOVE '19' TO PV-XFACT-DATE(5:2)                     12210019
122200            ELSE                                                  12220019
122300              MOVE '20' TO PV-XFACT-DATE(5:2)                     12230019
122400            END-IF                                                12240019
122500            MOVE ASC-XFACT-END-DTE(1:2)                           12250019
122600                      TO PV-XFACT-DATE(1:2)                       12260019
122700            MOVE ASC-XFACT-END-DTE(3:2)                           12270019
122800                      TO PV-XFACT-DATE(3:2)                       12280019
122900            MOVE ASC-XFACT-END-DTE(5:2)                           12290019
123000                      TO PV-XFACT-DATE(7:2)                       12300019
123100            MOVE SPACES TO PV-XFACT-DATE(9:2)                     12310019
123200        END-IF                                                    12320019
123300        MOVE PV-XFACT-DATE TO DPG52-LK-DATE-INPUT                 12330019
123400        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   12340019
123500                  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             12350019
123600        IF (DPG54-DATE-INVALID                                    12360019
123700        OR  DPG54-SEVERE-ERROR)                                   12370019
123800            SET PS-ERROR                                          12380019
123900                DP020-MSG-FATAL   TO TRUE                         12390019
124000*        ---- INVALID DATE ----                                   12400019
124100            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             12410019
124200            MOVE DP015-UNP-ALP-BRT-MDT                            12420019
124300                                  TO AXFCEA                       12430019
124400            MOVE DP015-RED        TO AXFCEC                       12440019
124500            MOVE DP015-REVERSE    TO AXFCEH                       12450019
124600            MOVE -1               TO AXFCEL                       12460019
124700            SET DP030-SET-CURSOR-APPL-1                           12470019
124800                                  TO TRUE                         12480019
124900        ELSE                                                      12490019
125000            MOVE DPG55-GREG-DATE-FMT                              12500019
125100                                  TO ASC-XFACT-END-DTE            12510019
125200            MOVE DPG55-GREG-CC-DATE                               12520019
125300                                  TO ASC-XFACT-END-DTE-CC         12530019
125400            MOVE DPG55-DB2-ISO-DATE-FMT                           12540019
125500                                  TO ASC-XFACT-END-DTE-ISO        12550019
125600        END-IF                                                    12560019
125700     END-IF.                                                      12570019
125800                                                                  12580019
125900     IF ASC-XFACT-BEF-DTE > SPACES                                12590019
126000        INITIALIZE DPG51 DPG52                                    12600019
126100        SET DPG51-ACTUAL-CALENDAR-ONLY                            12610019
126200                                 TO TRUE                          12620019
126300        SET DPG51-DO-NOT-INCR-DECR-DATE                           12630019
126400                                 TO TRUE                          12640019
126500        MOVE ZERO                TO TALLY                         12650019
126600        INSPECT ASC-XFACT-BEF-DTE                                 12660019
126700                TALLYING TALLY FOR ALL '/'                        12670019
126800        IF TALLY > 1                                              12680019
126900*               'MM/DD/YY'                                        12690019
127000           SET DPG52-LK-DTE-GREG-CC-FMT                           12700019
127100                                  TO TRUE                         12710019
127200           IF ASC-XFACT-BEF-DTE(7:2) > 80                         12720019
127300              MOVE '19' TO PV-XFACT-DATE(7:2)                     12730019
127400           ELSE                                                   12740019
127500              MOVE '20' TO PV-XFACT-DATE(7:2)                     12750019
127600           END-IF                                                 12760019
127700           MOVE ASC-XFACT-BEF-DTE(1:6)                            12770019
127800                         TO PV-XFACT-DATE(1:6)                    12780019
127900           MOVE ASC-XFACT-BEF-DTE(7:2)                            12790019
128000                         TO PV-XFACT-DATE(9:2)                    12800019
128100        ELSE                                                      12810019
128200*               'MMDDYY  '                                        12820019
128300           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      12830019
128400           IF ASC-XFACT-BEF-DTE(5:2) > 80                         12840019
128500              MOVE '19' TO PV-XFACT-DATE(5:2)                     12850019
128600           ELSE                                                   12860019
128700              MOVE '20' TO PV-XFACT-DATE(5:2)                     12870019
128800           END-IF                                                 12880019
128900           MOVE ASC-XFACT-BEF-DTE(1:2)                            12890019
129000                      TO PV-XFACT-DATE(1:2)                       12900019
129100           MOVE ASC-XFACT-BEF-DTE(3:2)                            12910019
129200                      TO PV-XFACT-DATE(3:2)                       12920019
129300           MOVE ASC-XFACT-BEF-DTE(5:2)                            12930019
129400                      TO PV-XFACT-DATE(7:2)                       12940019
129500           MOVE SPACES TO PV-XFACT-DATE(9:2)                      12950019
129600        END-IF                                                    12960019
129700                                                                  12970019
129800        INITIALIZE DPG53 DPG54 DPG55 DPG56                        12980019
129900        MOVE PV-XFACT-DATE           TO DPG52-LK-DATE-INPUT       12990019
130000                                                                  13000019
130100        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   13010019
130200                        DPG51 DPG52 DPG53 DPG54 DPG55 DPG56       13020019
130300        IF (DPG54-DATE-INVALID                                    13030019
130400        OR  DPG54-SEVERE-ERROR)                                   13040019
130500            SET PS-ERROR                                          13050019
130600                DP020-MSG-FATAL   TO TRUE                         13060019
130700*        ---- INVALID DATE ----                                   13070019
130800            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             13080019
130900            MOVE DP015-UNP-ALP-BRT-MDT                            13090019
131000                                  TO AXFCBA                       13100019
131100            MOVE DP015-RED        TO AXFCBC                       13110019
131200            MOVE DP015-REVERSE    TO AXFCBH                       13120019
131300            MOVE -1               TO AXFCBL                       13130019
131400            SET DP030-SET-CURSOR-APPL-1                           13140019
131500                                  TO TRUE                         13150019
131600        ELSE                                                      13160019
131700            MOVE DPG55-GREG-DATE-FMT                              13170019
131800                                  TO ASC-XFACT-BEF-DTE            13180019
131900            MOVE DPG55-GREG-CC-DATE                               13190019
132000                                  TO ASC-XFACT-BEF-DTE-CC         13200019
132100            MOVE DPG55-DB2-ISO-DATE-FMT                           13210019
132200                                  TO ASC-XFACT-BEF-DTE-ISO        13220019
132300        END-IF                                                    13230019
132400     END-IF.                                                      13240019
132500                                                                  13250019
132600     IF  ASC-XFACT-BEF-DTE-ISO > SPACES                           13260019
132700     AND ASC-XFACT-END-DTE-ISO > SPACES                           13270019
132800         IF  ASC-XFACT-BEF-DTE-ISO >                              13280019
132900                                       ASC-XFACT-END-DTE-ISO      13290019
133000             SET PS-ERROR                                         13300019
133100                 DP020-MSG-FATAL  TO TRUE                         13310019
133200             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             13320019
133300             MOVE DP015-UNP-ALP-BRT-MDT                           13330019
133400                                  TO AXFCEA                       13340019
133500             MOVE DP015-RED       TO AXFCEC                       13350019
133600             MOVE DP015-REVERSE   TO AXFCEH                       13360019
133700             MOVE -1              TO AXFCEL                       13370019
133800             SET DP030-SET-CURSOR-APPL-1                          13380019
133900                                  TO TRUE                         13390019
134000         END-IF                                                   13400019
134100     END-IF.                                                      13410019
134200                                                                  13420019
134300     IF ASC-SHPDT-END-DTE > SPACES                                13430019
134400        INITIALIZE DPG51                                          13440019
134500        SET DPG51-ACTUAL-CALENDAR-ONLY                            13450019
134600                                 TO TRUE                          13460019
134700        SET DPG51-DO-NOT-INCR-DECR-DATE                           13470019
134800                                 TO TRUE                          13480019
134900        MOVE ZERO                TO TALLY                         13490019
135000        INSPECT ASC-SHPDT-END-DTE                                 13500019
135100                TALLYING TALLY FOR ALL '/'                        13510019
135200        IF TALLY > 1                                              13520019
135300*               'MM/DD/YY'                                        13530019
135400           SET DPG52-LK-DTE-GREG-CC-FMT                           13540019
135500                                  TO TRUE                         13550019
135600           IF ASC-SHPDT-END-DTE (7:2) > 80                        13560019
135700              MOVE '19' TO PV-SHPDT-DATE(7:2)                     13570019
135800           ELSE                                                   13580019
135900              MOVE '20' TO PV-SHPDT-DATE(7:2)                     13590019
136000           END-IF                                                 13600019
136100           MOVE ASC-SHPDT-END-DTE(1:6)                            13610019
136200                         TO PV-SHPDT-DATE(1:6)                    13620019
136300           MOVE ASC-SHPDT-END-DTE(7:2)                            13630019
136400                        TO PV-SHPDT-DATE(9:2)                     13640019
136500        ELSE                                                      13650019
136600*               'MMDDYY  '                                        13660019
136700           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      13670019
136800           IF ASC-SHPDT-END-DTE(5:2) > 80                         13680019
136900              MOVE '19' TO PV-SHPDT-DATE(5:2)                     13690019
137000            ELSE                                                  13700019
137100              MOVE '20' TO PV-SHPDT-DATE(5:2)                     13710019
137200            END-IF                                                13720019
137300            MOVE ASC-SHPDT-END-DTE(1:2)                           13730019
137400                      TO PV-SHPDT-DATE(1:2)                       13740019
137500            MOVE ASC-SHPDT-END-DTE(3:2)                           13750019
137600                      TO PV-SHPDT-DATE(3:2)                       13760019
137700            MOVE ASC-SHPDT-END-DTE(5:2)                           13770019
137800                      TO PV-SHPDT-DATE(7:2)                       13780019
137900            MOVE SPACES TO PV-SHPDT-DATE(9:2)                     13790019
138000        END-IF                                                    13800019
138100        MOVE PV-SHPDT-DATE TO DPG52-LK-DATE-INPUT                 13810019
138200        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   13820019
138300                  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             13830019
138400        IF (DPG54-DATE-INVALID                                    13840019
138500        OR  DPG54-SEVERE-ERROR)                                   13850019
138600            SET PS-ERROR                                          13860019
138700                DP020-MSG-FATAL   TO TRUE                         13870019
138800*        ---- INVALID DATE ----                                   13880019
138900            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             13890019
139000            MOVE DP015-UNP-ALP-BRT-MDT                            13900019
139100                                  TO ASHDEA                       13910019
139200            MOVE DP015-RED        TO ASHDEC                       13920019
139300            MOVE DP015-REVERSE    TO ASHDEH                       13930019
139400            MOVE -1               TO ASHDEL                       13940019
139500            SET DP030-SET-CURSOR-APPL-1                           13950019
139600                                  TO TRUE                         13960019
139700        ELSE                                                      13970019
139800            MOVE DPG55-GREG-DATE-FMT                              13980019
139900                                  TO ASC-SHPDT-END-DTE            13990019
140000            MOVE DPG55-GREG-CC-DATE                               14000019
140100                                  TO ASC-SHPDT-END-DTE-CC         14010019
140200            MOVE DPG55-DB2-ISO-DATE-FMT                           14020019
140300                                  TO ASC-SHPDT-END-DTE-ISO        14030019
140400        END-IF                                                    14040019
140500     END-IF.                                                      14050019
140600                                                                  14060019
140700     IF ASC-SHPDT-BEF-DTE > SPACES                                14070019
140800        INITIALIZE DPG51 DPG52                                    14080019
140900        SET DPG51-ACTUAL-CALENDAR-ONLY                            14090019
141000                                 TO TRUE                          14100019
141100        SET DPG51-DO-NOT-INCR-DECR-DATE                           14110019
141200                                 TO TRUE                          14120019
141300        MOVE ZERO                TO TALLY                         14130019
141400        INSPECT ASC-SHPDT-BEF-DTE                                 14140019
141500                TALLYING TALLY FOR ALL '/'                        14150019
141600        IF TALLY > 1                                              14160019
141700*               'MM/DD/YY'                                        14170019
141800           SET DPG52-LK-DTE-GREG-CC-FMT                           14180019
141900                                  TO TRUE                         14190019
142000           IF ASC-SHPDT-BEF-DTE(7:2) > 80                         14200019
142100              MOVE '19' TO PV-SHPDT-DATE(7:2)                     14210019
142200           ELSE                                                   14220019
142300              MOVE '20' TO PV-SHPDT-DATE(7:2)                     14230019
142400           END-IF                                                 14240019
142500           MOVE ASC-SHPDT-BEF-DTE(1:6)                            14250019
142600                         TO PV-SHPDT-DATE(1:6)                    14260019
142700           MOVE ASC-SHPDT-BEF-DTE(7:2)                            14270019
142800                         TO PV-SHPDT-DATE(9:2)                    14280019
142900        ELSE                                                      14290019
143000*               'MMDDYY  '                                        14300019
143100           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      14310019
143200           IF ASC-SHPDT-BEF-DTE(5:2) > 80                         14320019
143300              MOVE '19' TO PV-SHPDT-DATE(5:2)                     14330019
143400           ELSE                                                   14340019
143500              MOVE '20' TO PV-SHPDT-DATE(5:2)                     14350019
143600           END-IF                                                 14360019
143700           MOVE ASC-SHPDT-BEF-DTE(1:2)                            14370019
143800                      TO PV-SHPDT-DATE(1:2)                       14380019
143900           MOVE ASC-SHPDT-BEF-DTE(3:2)                            14390019
144000                      TO PV-SHPDT-DATE(3:2)                       14400019
144100           MOVE ASC-SHPDT-BEF-DTE(5:2)                            14410019
144200                      TO PV-SHPDT-DATE(7:2)                       14420019
144300           MOVE SPACES TO PV-SHPDT-DATE(9:2)                      14430019
144400        END-IF                                                    14440019
144500                                                                  14450019
144600        INITIALIZE DPG53 DPG54 DPG55 DPG56                        14460019
144700        MOVE PV-SHPDT-DATE           TO DPG52-LK-DATE-INPUT       14470019
144800                                                                  14480019
144900        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   14490019
145000                        DPG51 DPG52 DPG53 DPG54 DPG55 DPG56       14500019
145100        IF (DPG54-DATE-INVALID                                    14510019
145200        OR  DPG54-SEVERE-ERROR)                                   14520019
145300            SET PS-ERROR                                          14530019
145400                DP020-MSG-FATAL   TO TRUE                         14540019
145500*        ---- INVALID DATE ----                                   14550019
145600            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             14560019
145700            MOVE DP015-UNP-ALP-BRT-MDT                            14570019
145800                                  TO ASHDBA                       14580019
145900            MOVE DP015-RED        TO ASHDBC                       14590019
146000            MOVE DP015-REVERSE    TO ASHDBH                       14600019
146100            MOVE -1               TO ASHDBL                       14610019
146200            SET DP030-SET-CURSOR-APPL-1                           14620019
146300                                  TO TRUE                         14630019
146400        ELSE                                                      14640019
146500            MOVE DPG55-GREG-DATE-FMT                              14650019
146600                                  TO ASC-SHPDT-BEF-DTE            14660019
146700            MOVE DPG55-GREG-CC-DATE                               14670019
146800                                  TO ASC-SHPDT-BEF-DTE-CC         14680019
146900            MOVE DPG55-DB2-ISO-DATE-FMT                           14690019
147000                                  TO ASC-SHPDT-BEF-DTE-ISO        14700019
147100        END-IF                                                    14710019
147200     END-IF.                                                      14720019
147300                                                                  14730019
147400     IF  ASC-SHPDT-BEF-DTE-ISO > SPACES                           14740019
147500     AND ASC-SHPDT-END-DTE-ISO > SPACES                           14750019
147600         IF  ASC-SHPDT-BEF-DTE-ISO >                              14760019
147700                                       ASC-SHPDT-END-DTE-ISO      14770019
147800             SET PS-ERROR                                         14780019
147900                 DP020-MSG-FATAL  TO TRUE                         14790019
148000             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             14800019
148100             MOVE DP015-UNP-ALP-BRT-MDT                           14810019
148200                                  TO ASHDEA                       14820019
148300             MOVE DP015-RED       TO ASHDEC                       14830019
148400             MOVE DP015-REVERSE   TO ASHDEH                       14840019
148500             MOVE -1              TO ASHDEL                       14850019
148600             SET DP030-SET-CURSOR-APPL-1                          14860019
148700                                  TO TRUE                         14870019
148800         END-IF                                                   14880019
148900     END-IF.                                                      14890019
149000                                                                  14900019
149100     IF  ASC-OTB-PER-NBR-END > SPACES                             14910019
149200         IF  ASC-OTB-PER-NBR-END(5:2) < '01'                      14920019
149300         OR  ASC-OTB-PER-NBR-END(5:2) > '12'                      14930019
149400             SET PS-ERROR                                         14940019
149500                 DP020-MSG-FATAL                                  14950019
149600                 DP030-SET-CURSOR-APPL-1 TO TRUE                  14960019
149700             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      14970019
149800             MOVE -1                     TO AOTBENDL              14980019
149900             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBENDA              14990019
150000             MOVE DP015-RED              TO AOTBENDC              15000019
150100             MOVE DP015-REVERSE          TO AOTBENDH              15010019
150200         END-IF                                                   15020019
150300     END-IF.                                                      15030019
150400                                                                  15040019
150500     IF  ASC-OTB-PER-NBR-BEG > SPACES                             15050019
150600         IF  ASC-OTB-PER-NBR-BEG(5:2) < '01'                      15060019
150700         OR  ASC-OTB-PER-NBR-BEG(5:2) > '12'                      15070019
150800             SET PS-ERROR                                         15080019
150900                 DP020-MSG-FATAL                                  15090019
151000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  15100019
151100             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      15110019
151200             MOVE -1                     TO AOTBBEGL              15120019
151300             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBBEGA              15130019
151400             MOVE DP015-RED              TO AOTBBEGC              15140019
151500             MOVE DP015-REVERSE          TO AOTBBEGH              15150019
151600         END-IF                                                   15160019
151700     END-IF.                                                      15170019
151800                                                                  15180019
151900     IF  ASC-OTB-PER-NBR-BEG > SPACES                             15190019
152000     AND ASC-OTB-PER-NBR-END > SPACES                             15200019
152100         IF  ASC-OTB-PER-NBR-BEG-N > ASC-OTB-PER-NBR-END-N        15210019
152200             SET PS-ERROR                                         15220019
152300                 DP020-MSG-FATAL  TO TRUE                         15230019
152400             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             15240019
152500             MOVE DP015-UNP-ALP-BRT-MDT                           15250019
152600                                  TO AOTBENDA                     15260019
152700             MOVE DP015-RED       TO AOTBENDC                     15270019
152800             MOVE DP015-REVERSE   TO AOTBENDH                     15280019
152900             MOVE -1              TO AOTBENDL                     15290019
153000             SET DP030-SET-CURSOR-APPL-1                          15300019
153100                                  TO TRUE                         15310019
153200         END-IF                                                   15320019
153300     END-IF.                                                      15330019
153400                                                                  15340019
153500     IF ASC-AD-EVNT-DTE > SPACES                                  15350019
153600        INITIALIZE DPG51                                          15360019
153700        SET DPG51-ACTUAL-CALENDAR-ONLY                            15370019
153800                                 TO TRUE                          15380019
153900        SET DPG51-DO-NOT-INCR-DECR-DATE                           15390019
154000                                 TO TRUE                          15400019
154100        MOVE ZERO                TO TALLY                         15410019
154200        INSPECT ASC-AD-EVNT-DTE                                   15420019
154300                TALLYING TALLY FOR ALL '/'                        15430019
154400        IF TALLY > 1                                              15440019
154500*               'MM/DD/YY'                                        15450019
154600           SET DPG52-LK-DTE-GREG-CC-FMT                           15460019
154700                                  TO TRUE                         15470019
154800           IF ASC-AD-EVNT-DTE(7:2) > 80                           15480019
154900              MOVE '19' TO PV-AD-DATE(7:2)                        15490019
155000           ELSE                                                   15500019
155100              MOVE '20' TO PV-AD-DATE(7:2)                        15510019
155200           END-IF                                                 15520019
155300           MOVE ASC-AD-EVNT-DTE(1:6) TO PV-AD-DATE(1:6)           15530019
155400           MOVE ASC-AD-EVNT-DTE(7:2) TO PV-AD-DATE(9:2)           15540019
155500        ELSE                                                      15550019
155600*               'MMDDYY  '                                        15560019
155700           SET DPG52-LK-DTE-GREG-CC TO TRUE                       15570019
155800           IF ASC-AD-EVNT-DTE(5:2) > 80                           15580019
155900              MOVE '19' TO PV-AD-DATE(5:2)                        15590019
156000           ELSE                                                   15600019
156100              MOVE '20' TO PV-AD-DATE(5:2)                        15610019
156200           END-IF                                                 15620019
156300           MOVE ASC-AD-EVNT-DTE(1:2) TO PV-AD-DATE(1:2)           15630019
156400           MOVE ASC-AD-EVNT-DTE(3:2) TO PV-AD-DATE(3:2)           15640019
156500           MOVE ASC-AD-EVNT-DTE(5:2) TO PV-AD-DATE(7:2)           15650019
156600           MOVE SPACES               TO PV-AD-DATE(9:2)           15660019
156700        END-IF                                                    15670019
156800        MOVE PV-AD-DATE           TO DPG52-LK-DATE-INPUT          15680019
156900        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   15690019
157000                   DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            15700019
157100        IF (DPG54-DATE-INVALID                                    15710019
157200        OR  DPG54-SEVERE-ERROR)                                   15720019
157300            SET PS-ERROR                                          15730019
157400                DP020-MSG-FATAL   TO TRUE                         15740019
157500*        ---- INVALID DATE ----                                   15750019
157600            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             15760019
157700            MOVE DP015-UNP-ALP-BRT-MDT                            15770019
157800                                  TO ADDATEA                      15780019
157900            MOVE DP015-RED        TO ADDATEC                      15790019
158000            MOVE DP015-REVERSE    TO ADDATEH                      15800019
158100            MOVE -1               TO ADDATEL                      15810019
158200            SET DP030-SET-CURSOR-APPL-1                           15820019
158300                                  TO TRUE                         15830019
158400        ELSE                                                      15840019
158500            MOVE DPG55-GREG-DATE-FMT                              15850019
158600                                  TO ASC-AD-EVNT-DTE              15860019
158700            MOVE DPG55-GREG-CC-DATE                               15870019
158800                                  TO ASC-AD-EVNT-DTE-CC           15880019
158900            MOVE DPG55-DB2-ISO-DATE-FMT                           15890019
159000                                  TO ASC-AD-EVNT-DTE-ISO          15900019
159100        END-IF                                                    15910019
159200     END-IF.                                                      15920019
159300                                                                  15930019
159400                                                                  15940019
159500     IF  ASC-STATUS-GRP > SPACES                                  15950019
159600         IF ASC-STATUS-GRP = 'WKS' OR 'ACT' OR 'CMP' OR 'BTH'     15960019
159700                              OR 'CAN'                            15970019
159800             CONTINUE                                             15980019
159900         ELSE                                                     15990019
160000             SET PS-ERROR          TO TRUE                        16000019
160100             SET DP020-MSG-FATAL   TO TRUE                        16010019
160200             MOVE PC-TSYMSG-02139  TO DP020-MSG-NUMBER            16020019
160300             MOVE DP015-UNP-ALP-BRT-OFF                           16030019
160400                                   TO ASTGRPA                     16040019
160500             MOVE DP015-RED        TO ASTGRPC                     16050019
160600             MOVE DP015-REVERSE    TO ASTGRPH                     16060019
160700             MOVE -1               TO ASTGRPL                     16070019
160800             SET DP030-SET-CURSOR-APPL-1                          16080019
160900                                   TO TRUE                        16090019
161000         END-IF                                                   16100019
161100     END-IF.                                                      16110019
161200                                                                  16120019
161300     IF  ASC-STATUS-GRP > SPACES                                  16130019
161400         IF ASC-STATUS-CDE > SPACES                               16140019
161500             SET PS-ERROR          TO TRUE                        16150019
161600             SET DP020-MSG-FATAL   TO TRUE                        16160019
161700             MOVE PC-TSYMSG-00640  TO DP020-MSG-NUMBER            16170019
161800             MOVE DP015-UNP-ALP-BRT-OFF                           16180019
161900                                   TO ASC1A                       16190019
162000             MOVE DP015-RED        TO ASC1C                       16200019
162100             MOVE DP015-REVERSE    TO ASC1H                       16210019
162200             MOVE -1               TO ASC1L                       16220019
162300             SET DP030-SET-CURSOR-APPL-1                          16230019
162400                                   TO TRUE                        16240019
162500         END-IF                                                   16250019
162600     END-IF.                                                      16260019
162700                                                                  16270019
162800     IF  ASC-SKU > SPACES                                         16280019
162900         MOVE ASC-SKU              TO DP010I-UNEDITED-FIELD       16290019
163000         MOVE LENGTH OF ASC-SKU    TO DP010I-MAXIMUM-DIGITS       16300019
163100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16310019
163200         SET DP010I-NEGATIVE-NOT-ALLOWED                          16320019
163300                                   TO TRUE                        16330019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
163500         IF  DP010I-ERROR-DETECTED                                16350019
163600             SET PS-ERROR                                         16360019
163700                 DP020-MSG-FATAL   TO TRUE                        16370019
163800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16380019
163900             MOVE DP015-UNP-ALP-BRT-OFF                           16390019
164000                                   TO ASKUA                       16400019
164100             MOVE DP015-RED        TO ASKUC                       16410019
164200             MOVE DP015-REVERSE    TO ASKUH                       16420019
164300             MOVE -1               TO ASKUL                       16430019
164400             SET DP030-SET-CURSOR-APPL-1                          16440019
164500                                   TO TRUE                        16450019
164600         ELSE                                                     16460019
164700             MOVE DP010I-NUMERIC-FIELD                            16470019
164800                                   TO ASC-SKU-N                   16480019
164900         END-IF                                                   16490019
165000     END-IF.                                                      16500019
165100                                                                  16510019
165200     IF  ASC-SUBCLASS > SPACES                                    16520019
165300         MOVE ASC-SUBCLASS         TO DP010I-UNEDITED-FIELD       16530019
165400         MOVE LENGTH OF ASC-SUBCLASS                              16540019
165500                                   TO DP010I-MAXIMUM-DIGITS       16550019
165600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16560019
165700         SET DP010I-NEGATIVE-NOT-ALLOWED                          16570019
165800                                   TO TRUE                        16580019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
166000         IF  DP010I-ERROR-DETECTED                                16600019
166100             SET PS-ERROR                                         16610019
166200                 DP020-MSG-FATAL   TO TRUE                        16620019
166300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16630019
166400             MOVE DP015-UNP-ALP-BRT-OFF                           16640019
166500                                   TO ASUBCLA                     16650019
166600             MOVE DP015-RED        TO ASUBCLC                     16660019
166700             MOVE DP015-REVERSE    TO ASUBCLH                     16670019
166800             MOVE -1               TO ASUBCLL                     16680019
166900             SET DP030-SET-CURSOR-APPL-1                          16690019
167000                                   TO TRUE                        16700019
167100         ELSE                                                     16710019
167200             MOVE DP010I-NUMERIC-FIELD                            16720019
167300                                   TO ASC-SUBCLASS-N              16730019
167400         END-IF                                                   16740019
167500     END-IF.                                                      16750019
167600                                                                  16760019
167700     IF  ASC-CLASS  > SPACES                                      16770019
167800         MOVE ASC-CLASS            TO DP010I-UNEDITED-FIELD       16780019
167900         MOVE LENGTH OF ASC-CLASS  TO DP010I-MAXIMUM-DIGITS       16790019
168000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16800019
168100         SET DP010I-NEGATIVE-NOT-ALLOWED                          16810019
168200                                   TO TRUE                        16820019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
168400         IF  DP010I-ERROR-DETECTED                                16840019
168500             SET PS-ERROR                                         16850019
168600                 DP020-MSG-FATAL   TO TRUE                        16860019
168700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16870019
168800             MOVE DP015-UNP-ALP-BRT-OFF                           16880019
168900                                   TO ACLASSA                     16890019
169000             MOVE DP015-RED        TO ACLASSC                     16900019
169100             MOVE DP015-REVERSE    TO ACLASSH                     16910019
169200             MOVE -1               TO ACLASSL                     16920019
169300             SET DP030-SET-CURSOR-APPL-1                          16930019
169400                                   TO TRUE                        16940019
169500         ELSE                                                     16950019
169600             MOVE DP010I-NUMERIC-FIELD                            16960019
169700                                   TO ASC-CLASS-N                 16970019
169800         END-IF                                                   16980019
169900     END-IF.                                                      16990019
170000                                                                  17000019
170100     IF  ASC-DEPT-NBR > SPACES                                    17010019
170200         MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD       17020019
170300         MOVE LENGTH OF ASC-DEPT-NBR                              17030019
170400                                   TO DP010I-MAXIMUM-DIGITS       17040019
170500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17050019
170600         SET DP010I-NEGATIVE-NOT-ALLOWED                          17060019
170700                                   TO TRUE                        17070019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
170900         IF  DP010I-ERROR-DETECTED                                17090019
171000             SET PS-ERROR                                         17100019
171100                 DP020-MSG-FATAL   TO TRUE                        17110019
171200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17120019
171300             MOVE DP015-UNP-ALP-BRT-OFF                           17130019
171400                                   TO ADEPTA                      17140019
171500             MOVE DP015-RED        TO ADEPTC                      17150019
171600             MOVE DP015-REVERSE    TO ADEPTH                      17160019
171700             MOVE -1               TO ADEPTL                      17170019
171800             SET DP030-SET-CURSOR-APPL-1                          17180019
171900                                   TO TRUE                        17190019
172000         ELSE                                                     17200019
172100             MOVE DP010I-NUMERIC-FIELD                            17210019
172200                                   TO ASC-DEPT-NBR-N              17220019
172300         END-IF                                                   17230019
172400     END-IF.                                                      17240019
172500                                                                  17250019
172600     IF  ASC-PO-NBR > SPACES                                      17260019
172700         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       17270019
172800         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       17280019
172900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     17290019
173000         SET DP010I-NEGATIVE-NOT-ALLOWED                          17300019
173100                                   TO TRUE                        17310019
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
173300         IF  DP010I-ERROR-DETECTED                                17330019
173400             SET PS-ERROR                                         17340019
173500                 DP020-MSG-FATAL   TO TRUE                        17350019
173600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17360019
173700             MOVE DP015-UNP-ALP-BRT-OFF                           17370019
173800                                   TO APONUMA                     17380019
173900             MOVE DP015-RED        TO APONUMC                     17390019
174000             MOVE DP015-REVERSE    TO APONUMH                     17400019
174100             MOVE -1               TO APONUML                     17410019
174200             SET DP030-SET-CURSOR-APPL-1                          17420019
174300                                   TO TRUE                        17430019
174400         ELSE                                                     17440019
174500             MOVE DP010I-NUMERIC-FIELD                            17450019
174600                                   TO ASC-PO-NBR-N                17460019
174700         END-IF                                                   17470019
174800     END-IF.                                                      17480019
174900                                                                  17490019
175000     IF  PS-NO-ERROR                                              17500019
175100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     17510019
175200         MOVE -1                 TO APONUML                       17520019
175300         SET DP030-SET-CURSOR-APPL-1                              17530019
175400                                 TO TRUE                          17540019
175500     END-IF.                                                      17550019
175600/                                                                 17560019
175700                                                                  17570019
175800 3005-EDIT-RECAP-CRITERIA.                                        17580019
175900                                                                  17590019
176000     IF ((ASC-DUNT > SPACES AND ASC-DDOL > SPACES)          AND   17600019
176100         (ASC-DUNT EQUAL 'Y' OR '0' OR '1' OR '2' OR '3'          17610019
176200                             OR '4' OR '5' OR '6' OR '7'          17620019
176300                             OR '8' OR '9')                 AND   17630019
176400         (ASC-DDOL EQUAL 'Y' OR '0' OR '1' OR '2' OR '3'          17640019
176500                             OR '4' OR '5' OR '6' OR '7'          17650019
176600                             OR '8' OR '9'))                      17660019
176700*MAM     (ASC-DUNT NOT EQUAL 'N' AND ASC-DDOL NOT EQUAL 'N'))     17670019
176800         SET ASC-LOCAL-01-NEED-CONFIRM TO TRUE                    17680019
176900         SET PS-ERROR          TO TRUE                            17690019
177000         SET DP020-MSG-INFORMATIONAL                              17700019
177100                               TO TRUE                            17710019
177200         MOVE PC-TSYMSG-02127  TO DP020-MSG-NUMBER                17720019
177300         MOVE DP015-UNP-ALP-BRT-OFF                               17730019
177400                               TO ADDOLA                          17740019
177500                                  ADUNTA                          17750019
177600         MOVE DP015-RED        TO ADDOLC                          17760019
177700                                  ADUNTC                          17770019
177800         MOVE DP015-REVERSE    TO ADDOLH                          17780019
177900                                  ADUNTH                          17790019
178000         MOVE -1               TO ADDOLL                          17800019
178100         SET DP030-SET-CURSOR-APPL-1                              17810019
178200                               TO TRUE                            17820019
178300     ELSE                                                         17830019
178400*MAM     IF ((ASC-DDOL > SPACES) AND (ASC-DDOL NOT EQUAL 'N'))    17840019
178500         IF ((ASC-DDOL > SPACES)     AND                          17850019
178600             (ASC-DDOL EQUAL 'Y' OR '0' OR '1' OR '2' OR '3'      17860019
178700                                 OR '4' OR '5' OR '6' OR '7'      17870019
178800                                 OR '8' OR '9'))                  17880019
178900             SET ASC-LOCAL-01-NEED-CONFIRM TO TRUE                17890019
179000             SET PS-ERROR          TO TRUE                        17900019
179100             SET DP020-MSG-INFORMATIONAL                          17910019
179200                               TO TRUE                            17920019
179300             MOVE PC-TSYMSG-02127  TO DP020-MSG-NUMBER            17930019
179400             MOVE DP015-UNP-ALP-BRT-OFF                           17940019
179500                                   TO ADDOLA                      17950019
179600             MOVE DP015-RED        TO ADDOLC                      17960019
179700             MOVE DP015-REVERSE    TO ADDOLH                      17970019
179800             MOVE -1               TO ADDOLL                      17980019
179900             SET DP030-SET-CURSOR-APPL-1                          17990019
180000                                   TO TRUE                        18000019
180100         ELSE                                                     18010019
180200*MAM        IF ((ASC-DUNT > SPACES) AND                           18020019
180300*MAM            (ASC-DUNT NOT EQUAL 'N'))                         18030019
180400            IF ((ASC-DUNT > SPACES) AND                           18040019
180500                (ASC-DUNT EQUAL 'Y' OR '0' OR '1' OR '2' OR '3'   18050019
180600                                    OR '4' OR '5' OR '6' OR '7'   18060019
180700                                    OR '8' OR '9'))               18070019
180800                SET ASC-LOCAL-01-NEED-CONFIRM TO TRUE             18080019
180900                SET PS-ERROR          TO TRUE                     18090019
181000                SET DP020-MSG-INFORMATIONAL                       18100019
181100                                      TO TRUE                     18110019
181200                MOVE PC-TSYMSG-02127  TO DP020-MSG-NUMBER         18120019
181300                MOVE DP015-UNP-ALP-BRT-OFF                        18130019
181400                                      TO ADUNTA                   18140019
181500                MOVE DP015-RED        TO ADUNTC                   18150019
181600                MOVE DP015-REVERSE    TO ADUNTH                   18160019
181700                MOVE -1               TO ADUNTL                   18170019
181800                SET DP030-SET-CURSOR-APPL-1                       18180019
181900                                      TO TRUE                     18190019
182000            END-IF                                                18200019
182100         END-IF                                                   18210019
182200     END-IF.                                                      18220019
182300                                                                  18230019
182400     IF ASC-DTRA > SPACES OR = SPACES                             18240019
182500         MOVE ASC-DTRA TO PV-DISPLAY-RECAP-CRIT                   18250019
182600         IF PV-DISPLAY-RECAP                                      18260019
182700             CONTINUE                                             18270019
182800         ELSE                                                     18280019
182900             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            18290019
183000             SET PS-ERROR          TO TRUE                        18300019
183100             SET DP020-MSG-FATAL   TO TRUE                        18310019
183200             MOVE DP015-UNP-ALP-BRT-OFF                           18320019
183300                                   TO ADTRAA                      18330019
183400             MOVE DP015-RED        TO ADTRAC                      18340019
183500             MOVE DP015-REVERSE    TO ADTRAH                      18350019
183600             MOVE -1               TO ADTRAL                      18360019
183700             SET DP030-SET-CURSOR-APPL-1                          18370019
183800                                   TO TRUE                        18380019
183900         END-IF                                                   18390019
184000     END-IF.                                                      18400019
184100                                                                  18410019
184200     IF ASC-DTRP > SPACES OR = SPACES                             18420019
184300         MOVE ASC-DTRP TO PV-DISPLAY-RECAP-CRIT                   18430019
184400         IF PV-DISPLAY-RECAP                                      18440019
184500             CONTINUE                                             18450019
184600         ELSE                                                     18460019
184700             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            18470019
184800             SET PS-ERROR          TO TRUE                        18480019
184900             SET DP020-MSG-FATAL   TO TRUE                        18490019
185000             MOVE DP015-UNP-ALP-BRT-OFF                           18500019
185100                                   TO ADTRPA                      18510019
185200             MOVE DP015-RED        TO ADTRPC                      18520019
185300             MOVE DP015-REVERSE    TO ADTRPH                      18530019
185400             MOVE -1               TO ADTRPL                      18540019
185500             SET DP030-SET-CURSOR-APPL-1                          18550019
185600                                   TO TRUE                        18560019
185700         END-IF                                                   18570019
185800     END-IF.                                                      18580019
185900                                                                  18590019
186000     IF ASC-DPPK > SPACES OR = SPACES                             18600019
186100         MOVE ASC-DPPK TO PV-DISPLAY-RECAP-CRIT                   18610019
186200         IF PV-DISPLAY-RECAP                                      18620019
186300             CONTINUE                                             18630019
186400         ELSE                                                     18640019
186500             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            18650019
186600             SET PS-ERROR          TO TRUE                        18660019
186700             SET DP020-MSG-FATAL   TO TRUE                        18670019
186800             MOVE DP015-UNP-ALP-BRT-OFF                           18680019
186900                                   TO ADPPKA                      18690019
187000             MOVE DP015-RED        TO ADPPKC                      18700019
187100             MOVE DP015-REVERSE    TO ADPPKH                      18710019
187200             MOVE -1               TO ADPPKL                      18720019
187300             SET DP030-SET-CURSOR-APPL-1                          18730019
187400                                   TO TRUE                        18740019
187500         END-IF                                                   18750019
187600     END-IF.                                                      18760019
187700                                                                  18770019
187800     IF ASC-DETA > SPACES OR = SPACES                             18780019
187900         MOVE ASC-DETA TO PV-DISPLAY-RECAP-CRIT                   18790019
188000         IF PV-DISPLAY-RECAP                                      18800019
188100             CONTINUE                                             18810019
188200         ELSE                                                     18820019
188300             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            18830019
188400             SET PS-ERROR          TO TRUE                        18840019
188500             SET DP020-MSG-FATAL   TO TRUE                        18850019
188600             MOVE DP015-UNP-ALP-BRT-OFF                           18860019
188700                                   TO ADETAA                      18870019
188800             MOVE DP015-RED        TO ADETAC                      18880019
188900             MOVE DP015-REVERSE    TO ADETAH                      18890019
189000             MOVE -1               TO ADETAL                      18900019
189100             SET DP030-SET-CURSOR-APPL-1                          18910019
189200                                   TO TRUE                        18920019
189300         END-IF                                                   18930019
189400     END-IF.                                                      18940019
189500                                                                  18950019
189600     IF ASC-DFRD > SPACES OR = SPACES                             18960019
189700         MOVE ASC-DFRD TO PV-DISPLAY-RECAP-CRIT                   18970019
189800         IF PV-DISPLAY-RECAP                                      18980019
189900             CONTINUE                                             18990019
190000         ELSE                                                     19000019
190100             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19010019
190200             SET PS-ERROR          TO TRUE                        19020019
190300             SET DP020-MSG-FATAL   TO TRUE                        19030019
190400             MOVE DP015-UNP-ALP-BRT-OFF                           19040019
190500                                   TO ADFRDA                      19050019
190600             MOVE DP015-RED        TO ADFRDC                      19060019
190700             MOVE DP015-REVERSE    TO ADFRDH                      19070019
190800             MOVE -1               TO ADFRDL                      19080019
190900             SET DP030-SET-CURSOR-APPL-1                          19090019
191000                                   TO TRUE                        19100019
191100         END-IF                                                   19110019
191200     END-IF.                                                      19120019
191300                                                                  19130019
191400     IF ASC-DCRL > SPACES OR = SPACES                             19140019
191500         MOVE ASC-DCRL TO PV-DISPLAY-RECAP-CRIT                   19150019
191600         IF PV-DISPLAY-RECAP                                      19160019
191700             CONTINUE                                             19170019
191800         ELSE                                                     19180019
191900             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19190019
192000             SET PS-ERROR          TO TRUE                        19200019
192100             SET DP020-MSG-FATAL   TO TRUE                        19210019
192200             MOVE DP015-UNP-ALP-BRT-OFF                           19220019
192300                                   TO ADCRLA                      19230019
192400             MOVE DP015-RED        TO ADCRLC                      19240019
192500             MOVE DP015-REVERSE    TO ADCRLH                      19250019
192600             MOVE -1               TO ADCRLL                      19260019
192700             SET DP030-SET-CURSOR-APPL-1                          19270019
192800                                   TO TRUE                        19280019
192900         END-IF                                                   19290019
193000     END-IF.                                                      19300019
193100                                                                  19310019
193200     IF ASC-DUNT > SPACES OR = SPACES                             19320019
193300         MOVE ASC-DUNT TO PV-DISPLAY-RECAP-CRIT                   19330019
193400         IF PV-DISPLAY-RECAP                                      19340019
193500             CONTINUE                                             19350019
193600         ELSE                                                     19360019
193700             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19370019
193800             SET PS-ERROR          TO TRUE                        19380019
193900             SET DP020-MSG-FATAL   TO TRUE                        19390019
194000             MOVE DP015-UNP-ALP-BRT-OFF                           19400019
194100                                   TO ADUNTA                      19410019
194200             MOVE DP015-RED        TO ADUNTC                      19420019
194300             MOVE DP015-REVERSE    TO ADUNTH                      19430019
194400             MOVE -1               TO ADUNTL                      19440019
194500             SET DP030-SET-CURSOR-APPL-1                          19450019
194600                                   TO TRUE                        19460019
194700         END-IF                                                   19470019
194800     END-IF.                                                      19480019
194900                                                                  19490019
195000     IF ASC-DOTB > SPACES OR = SPACES                             19500019
195100         MOVE ASC-DOTB TO PV-DISPLAY-RECAP-CRIT                   19510019
195200         IF PV-DISPLAY-RECAP                                      19520019
195300             CONTINUE                                             19530019
195400         ELSE                                                     19540019
195500             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19550019
195600             SET PS-ERROR          TO TRUE                        19560019
195700             SET DP020-MSG-FATAL   TO TRUE                        19570019
195800             MOVE DP015-UNP-ALP-BRT-OFF                           19580019
195900                                   TO ADOTBA                      19590019
196000             MOVE DP015-RED        TO ADOTBC                      19600019
196100             MOVE DP015-REVERSE    TO ADOTBH                      19610019
196200             MOVE -1               TO ADOTBL                      19620019
196300             SET DP030-SET-CURSOR-APPL-1                          19630019
196400                                   TO TRUE                        19640019
196500         END-IF                                                   19650019
196600     END-IF.                                                      19660019
196700                                                                  19670019
196800     IF ASC-DDVN > SPACES OR = SPACES                             19680019
196900         MOVE ASC-DDVN TO PV-DISPLAY-RECAP-CRIT                   19690019
197000         IF PV-DISPLAY-RECAP                                      19700019
197100             CONTINUE                                             19710019
197200         ELSE                                                     19720019
197300             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19730019
197400             SET PS-ERROR          TO TRUE                        19740019
197500             SET DP020-MSG-FATAL   TO TRUE                        19750019
197600             MOVE DP015-UNP-ALP-BRT-OFF                           19760019
197700                                   TO ADDVNA                      19770019
197800             MOVE DP015-RED        TO ADDVNC                      19780019
197900             MOVE DP015-REVERSE    TO ADDVNH                      19790019
198000             MOVE -1               TO ADDVNL                      19800019
198100             SET DP030-SET-CURSOR-APPL-1                          19810019
198200                                   TO TRUE                        19820019
198300         END-IF                                                   19830019
198400     END-IF.                                                      19840019
198500                                                                  19850019
198600     IF ASC-DBKD > SPACES OR = SPACES                             19860019
198700         MOVE ASC-DBKD TO PV-DISPLAY-RECAP-CRIT                   19870019
198800         IF PV-DISPLAY-RECAP                                      19880019
198900             CONTINUE                                             19890019
199000         ELSE                                                     19900019
199100             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            19910019
199200             SET PS-ERROR          TO TRUE                        19920019
199300             SET DP020-MSG-FATAL   TO TRUE                        19930019
199400             MOVE DP015-UNP-ALP-BRT-OFF                           19940019
199500                                   TO ADBKDA                      19950019
199600             MOVE DP015-RED        TO ADBKDC                      19960019
199700             MOVE DP015-REVERSE    TO ADBKDH                      19970019
199800             MOVE -1               TO ADBKDL                      19980019
199900             SET DP030-SET-CURSOR-APPL-1                          19990019
200000                                   TO TRUE                        20000019
200100         END-IF                                                   20010019
200200     END-IF.                                                      20020019
200300                                                                  20030019
200400     IF ASC-DDOL > SPACES OR = SPACES                             20040019
200500         MOVE ASC-DDOL TO PV-DISPLAY-RECAP-CRIT                   20050019
200600         IF PV-DISPLAY-RECAP                                      20060019
200700             CONTINUE                                             20070019
200800         ELSE                                                     20080019
200900             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20090019
201000             SET PS-ERROR          TO TRUE                        20100019
201100             SET DP020-MSG-FATAL   TO TRUE                        20110019
201200             MOVE DP015-UNP-ALP-BRT-OFF                           20120019
201300                                   TO ADDOLA                      20130019
201400             MOVE DP015-RED        TO ADDOLC                      20140019
201500             MOVE DP015-REVERSE    TO ADDOLH                      20150019
201600             MOVE -1               TO ADDOLL                      20160019
201700             SET DP030-SET-CURSOR-APPL-1                          20170019
201800                                   TO TRUE                        20180019
201900         END-IF                                                   20190019
202000     END-IF.                                                      20200019
202100                                                                  20210019
202200     IF ASC-DADD > SPACES OR = SPACES                             20220019
202300         MOVE ASC-DADD TO PV-DISPLAY-RECAP-CRIT                   20230019
202400         IF PV-DISPLAY-RECAP                                      20240019
202500             CONTINUE                                             20250019
202600         ELSE                                                     20260019
202700             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20270019
202800             SET PS-ERROR          TO TRUE                        20280019
202900             SET DP020-MSG-FATAL   TO TRUE                        20290019
203000             MOVE DP015-UNP-ALP-BRT-OFF                           20300019
203100                                   TO ADADDA                      20310019
203200             MOVE DP015-RED        TO ADADDC                      20320019
203300             MOVE DP015-REVERSE    TO ADADDH                      20330019
203400             MOVE -1               TO ADADDL                      20340019
203500             SET DP030-SET-CURSOR-APPL-1                          20350019
203600                                   TO TRUE                        20360019
203700         END-IF                                                   20370019
203800     END-IF.                                                      20380019
203900                                                                  20390019
204000     IF ASC-DCSR > SPACES OR = SPACES                             20400019
204100         MOVE ASC-DCSR TO PV-DISPLAY-RECAP-CRIT                   20410019
204200         IF PV-DISPLAY-RECAP                                      20420019
204300             CONTINUE                                             20430019
204400         ELSE                                                     20440019
204500             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20450019
204600             SET PS-ERROR          TO TRUE                        20460019
204700             SET DP020-MSG-FATAL   TO TRUE                        20470019
204800             MOVE DP015-UNP-ALP-BRT-OFF                           20480019
204900                                   TO ADCSRA                      20490019
205000             MOVE DP015-RED        TO ADCSRC                      20500019
205100             MOVE DP015-REVERSE    TO ADCSRH                      20510019
205200             MOVE -1               TO ADCSRL                      20520019
205300             SET DP030-SET-CURSOR-APPL-1                          20530019
205400                                   TO TRUE                        20540019
205500         END-IF                                                   20550019
205600     END-IF.                                                      20560019
205700                                                                  20570019
205800     IF ASC-DXFC > SPACES OR = SPACES                             20580019
205900         MOVE ASC-DXFC TO PV-DISPLAY-RECAP-CRIT                   20590019
206000         IF PV-DISPLAY-RECAP                                      20600019
206100             CONTINUE                                             20610019
206200         ELSE                                                     20620019
206300             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20630019
206400             SET PS-ERROR          TO TRUE                        20640019
206500             SET DP020-MSG-FATAL   TO TRUE                        20650019
206600             MOVE DP015-UNP-ALP-BRT-OFF                           20660019
206700                                   TO ADXFCA                      20670019
206800             MOVE DP015-RED        TO ADXFCC                      20680019
206900             MOVE DP015-REVERSE    TO ADXFCH                      20690019
207000             MOVE -1               TO ADXFCL                      20700019
207100             SET DP030-SET-CURSOR-APPL-1                          20710019
207200                                   TO TRUE                        20720019
207300         END-IF                                                   20730019
207400     END-IF.                                                      20740019
207500                                                                  20750019
207600     IF ASC-DSTA > SPACES OR = SPACES                             20760019
207700         MOVE ASC-DSTA TO PV-DISPLAY-RECAP-CRIT                   20770019
207800         IF PV-DISPLAY-RECAP                                      20780019
207900             CONTINUE                                             20790019
208000         ELSE                                                     20800019
208100             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20810019
208200             SET PS-ERROR          TO TRUE                        20820019
208300             SET DP020-MSG-FATAL   TO TRUE                        20830019
208400             MOVE DP015-UNP-ALP-BRT-OFF                           20840019
208500                                   TO ADSTAA                      20850019
208600             MOVE DP015-RED        TO ADSTAC                      20860019
208700             MOVE DP015-REVERSE    TO ADSTAH                      20870019
208800             MOVE -1               TO ADSTAL                      20880019
208900             SET DP030-SET-CURSOR-APPL-1                          20890019
209000                                   TO TRUE                        20900019
209100         END-IF                                                   20910019
209200     END-IF.                                                      20920019
209300                                                                  20930019
209400     IF ASC-DCNL > SPACES OR = SPACES                             20940019
209500         MOVE ASC-DCNL TO PV-DISPLAY-RECAP-CRIT                   20950019
209600         IF PV-DISPLAY-RECAP                                      20960019
209700             CONTINUE                                             20970019
209800         ELSE                                                     20980019
209900             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            20990019
210000             SET PS-ERROR          TO TRUE                        21000019
210100             SET DP020-MSG-FATAL   TO TRUE                        21010019
210200             MOVE DP015-UNP-ALP-BRT-OFF                           21020019
210300                                   TO ADCNLA                      21030019
210400             MOVE DP015-RED        TO ADCNLC                      21040019
210500             MOVE DP015-REVERSE    TO ADCNLH                      21050019
210600             MOVE -1               TO ADCNLL                      21060019
210700             SET DP030-SET-CURSOR-APPL-1                          21070019
210800                                   TO TRUE                        21080019
210900         END-IF                                                   21090019
211000     END-IF.                                                      21100019
211100                                                                  21110019
211200     IF ASC-DPRD > SPACES OR = SPACES                             21120019
211300         MOVE ASC-DPRD TO PV-DISPLAY-RECAP-CRIT                   21130019
211400         IF PV-DISPLAY-RECAP                                      21140019
211500             CONTINUE                                             21150019
211600         ELSE                                                     21160019
211700             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            21170019
211800             SET PS-ERROR          TO TRUE                        21180019
211900             SET DP020-MSG-FATAL   TO TRUE                        21190019
212000             MOVE DP015-UNP-ALP-BRT-OFF                           21200019
212100                                   TO ADPRDA                      21210019
212200             MOVE DP015-RED        TO ADPRDC                      21220019
212300             MOVE DP015-REVERSE    TO ADPRDH                      21230019
212400             MOVE -1               TO ADPRDL                      21240019
212500             SET DP030-SET-CURSOR-APPL-1                          21250019
212600                                   TO TRUE                        21260019
212700         END-IF                                                   21270019
212800     END-IF.                                                      21280019
212900                                                                  21290019
213000     IF ASC-DPOE > SPACES OR = SPACES                             21300019
213100         MOVE ASC-DPOE TO PV-DISPLAY-RECAP-CRIT                   21310019
213200         IF PV-DISPLAY-RECAP                                      21320019
213300             CONTINUE                                             21330019
213400         ELSE                                                     21340019
213500             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            21350019
213600             SET PS-ERROR          TO TRUE                        21360019
213700             SET DP020-MSG-FATAL   TO TRUE                        21370019
213800             MOVE DP015-UNP-ALP-BRT-OFF                           21380019
213900                                   TO ADPOEA                      21390019
214000             MOVE DP015-RED        TO ADPOEC                      21400019
214100             MOVE DP015-REVERSE    TO ADPOEH                      21410019
214200             MOVE -1               TO ADPOEL                      21420019
214300             SET DP030-SET-CURSOR-APPL-1                          21430019
214400                                   TO TRUE                        21440019
214500         END-IF                                                   21450019
214600     END-IF.                                                      21460019
214700                                                                  21470019
214800     IF ASC-DSPL > SPACES OR = SPACES                             21480019
214900         MOVE ASC-DSPL TO PV-DISPLAY-RECAP-CRIT                   21490019
215000         IF PV-DISPLAY-RECAP                                      21500019
215100             CONTINUE                                             21510019
215200         ELSE                                                     21520019
215300             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            21530019
215400             SET PS-ERROR          TO TRUE                        21540019
215500             SET DP020-MSG-FATAL   TO TRUE                        21550019
215600             MOVE DP015-UNP-ALP-BRT-OFF                           21560019
215700                                   TO ADSPLA                      21570019
215800             MOVE DP015-RED        TO ADSPLC                      21580019
215900             MOVE DP015-REVERSE    TO ADSPLH                      21590019
216000             MOVE -1               TO ADSPLL                      21600019
216100             SET DP030-SET-CURSOR-APPL-1                          21610019
216200                                   TO TRUE                        21620019
216300         END-IF                                                   21630019
216400     END-IF.                                                      21640019
216500                                                                  21650019
216600     IF ASC-DEDI > SPACES OR = SPACES                             21660019
216700         MOVE ASC-DEDI TO PV-DISPLAY-RECAP-CRIT                   21670019
216800         IF PV-DISPLAY-RECAP                                      21680019
216900             CONTINUE                                             21690019
217000         ELSE                                                     21700019
217100             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            21710019
217200             SET PS-ERROR          TO TRUE                        21720019
217300             SET DP020-MSG-FATAL   TO TRUE                        21730019
217400             MOVE DP015-UNP-ALP-BRT-OFF                           21740019
217500                                   TO ADEDIA                      21750019
217600             MOVE DP015-RED        TO ADEDIC                      21760019
217700             MOVE DP015-REVERSE    TO ADEDIH                      21770019
217800             MOVE -1               TO ADEDIL                      21780019
217900             SET DP030-SET-CURSOR-APPL-1                          21790019
218000                                   TO TRUE                        21800019
218100         END-IF                                                   21810019
218200     END-IF.                                                      21820019
218300                                                                  21830019
218400     IF ASC-DDSB > SPACES OR = SPACES                             21840019
218500         MOVE ASC-DDSB TO PV-DISPLAY-RECAP-CRIT                   21850019
218600         IF PV-DISPLAY-RECAP                                      21860019
218700             CONTINUE                                             21870019
218800         ELSE                                                     21880019
218900             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            21890019
219000             SET PS-ERROR          TO TRUE                        21900019
219100             SET DP020-MSG-FATAL   TO TRUE                        21910019
219200             MOVE DP015-UNP-ALP-BRT-OFF                           21920019
219300                                   TO ADDSBA                      21930019
219400             MOVE DP015-RED        TO ADDSBC                      21940019
219500             MOVE DP015-REVERSE    TO ADDSBH                      21950019
219600             MOVE -1               TO ADDSBL                      21960019
219700             SET DP030-SET-CURSOR-APPL-1                          21970019
219800                                   TO TRUE                        21980019
219900         END-IF                                                   21990019
220000     END-IF.                                                      22000019
220100                                                                  22010019
220200     IF ASC-DSLD > SPACES OR = SPACES                             22020019
220300         MOVE ASC-DSLD TO PV-DISPLAY-RECAP-CRIT                   22030019
220400         IF PV-DISPLAY-RECAP                                      22040019
220500             CONTINUE                                             22050019
220600         ELSE                                                     22060019
220700             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            22070019
220800             SET PS-ERROR          TO TRUE                        22080019
220900             SET DP020-MSG-FATAL   TO TRUE                        22090019
221000             MOVE DP015-UNP-ALP-BRT-OFF                           22100019
221100                                   TO ADSLDA                      22110019
221200             MOVE DP015-RED        TO ADSLDC                      22120019
221300             MOVE DP015-REVERSE    TO ADSLDH                      22130019
221400             MOVE -1               TO ADSLDL                      22140019
221500             SET DP030-SET-CURSOR-APPL-1                          22150019
221600                                   TO TRUE                        22160019
221700         END-IF                                                   22170019
221800     END-IF.                                                      22180019
221900                                                                  22190019
222000     IF ASC-DFOB > SPACES OR = SPACES                             22200019
222100         MOVE ASC-DFOB TO PV-DISPLAY-RECAP-CRIT                   22210019
222200         IF PV-DISPLAY-RECAP                                      22220019
222300             CONTINUE                                             22230019
222400         ELSE                                                     22240019
222500             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            22250019
222600             SET PS-ERROR          TO TRUE                        22260019
222700             SET DP020-MSG-FATAL   TO TRUE                        22270019
222800             MOVE DP015-UNP-ALP-BRT-OFF                           22280019
222900                                   TO ADFOBA                      22290019
223000             MOVE DP015-RED        TO ADFOBC                      22300019
223100             MOVE DP015-REVERSE    TO ADFOBH                      22310019
223200             MOVE -1               TO ADFOBL                      22320019
223300             SET DP030-SET-CURSOR-APPL-1                          22330019
223400                                   TO TRUE                        22340019
223500         END-IF                                                   22350019
223600     END-IF.                                                      22360019
223700                                                                  22370019
223800     IF ASC-DQCT > SPACES OR = SPACES                             22380019
223900         MOVE ASC-DQCT TO PV-DISPLAY-RECAP-CRIT                   22390019
224000         IF PV-DISPLAY-RECAP                                      22400019
224100             CONTINUE                                             22410019
224200         ELSE                                                     22420019
224300             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            22430019
224400             SET PS-ERROR          TO TRUE                        22440019
224500             SET DP020-MSG-FATAL   TO TRUE                        22450019
224600             MOVE DP015-UNP-ALP-BRT-OFF                           22460019
224700                                   TO ADFOBA                      22470019
224800             MOVE DP015-RED        TO ADFOBC                      22480019
224900             MOVE DP015-REVERSE    TO ADFOBH                      22490019
225000             MOVE -1               TO ADFOBL                      22500019
225100             SET DP030-SET-CURSOR-APPL-1                          22510019
225200                                   TO TRUE                        22520019
225300         END-IF                                                   22530019
225400     END-IF.                                                      22540019
225500                                                                  22550019
225600     IF ASC-DVNS > SPACES OR = SPACES                             22560019
225700         MOVE ASC-DVNS TO PV-DISPLAY-RECAP-CRIT                   22570019
225800         IF PV-DISPLAY-RECAP                                      22580019
225900             CONTINUE                                             22590019
226000         ELSE                                                     22600019
226100             MOVE PC-TSYMSG-02146  TO DP020-MSG-NUMBER            22610019
226200             SET PS-ERROR          TO TRUE                        22620019
226300             SET DP020-MSG-FATAL   TO TRUE                        22630019
226400             MOVE DP015-UNP-ALP-BRT-OFF                           22640019
226500                                   TO ADFOBA                      22650019
226600             MOVE DP015-RED        TO ADFOBC                      22660019
226700             MOVE DP015-REVERSE    TO ADFOBH                      22670019
226800             MOVE -1               TO ADFOBL                      22680019
226900             SET DP030-SET-CURSOR-APPL-1                          22690019
227000                                   TO TRUE                        22700019
227100         END-IF                                                   22710019
227200     END-IF.                                                      22720019
227300                                                                  22730019
227400*----------------------------------------------------------------*22740019
227500*    VALIDATE THE SEASONAL SET NAME                              *22750019
227600*----------------------------------------------------------------*22760019
227700 3020-VALIDATE-SEASONAL-SET.                                      22770019
227800                                                                  22780019
227900     PERFORM                                                      22790019
228000         WITH TEST AFTER                                          22800019
228100         VARYING PV-RETRY-COUNTER                                 22810019
228200         FROM 1 BY 1                                              22820019
228300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22830019
228400             OR (SQLCODE = +0)                                    22840019
228500             OR (SQLCODE = -811)                                  22850019
228600             OR (SQLCODE = +100))                                 22860019
228700                                                                  22870019
228800         EXEC SQL                                                 22880019
228900              SELECT SEASET_SHRT_NM                               22890019
229000                INTO :SEASET-SEASET-SHRT-NM                       22900019
229100                FROM TSEASET                                      22910019
229200               WHERE SEASET_SHRT_NM = :ASC-SEASONAL-SET           22920019
229300         END-EXEC                                                 22930019
229400                                                                  22940019
229500         EVALUATE TRUE                                            22950019
229600             WHEN SQLCODE = +0                                    22960019
229700             WHEN SQLCODE = -811                                  22970019
229800             WHEN SQLCODE = +100                                  22980019
229900                 CONTINUE                                         22990019
230000                                                                  23000019
230100             WHEN SQLCODE = -904                                  23010019
230200             WHEN SQLCODE = -913                                  23020019
230300                 CONTINUE                                         23030019
230400                                                                  23040019
230500             WHEN SQLWARN0 NOT = SPACES                           23050019
230600             WHEN SQLCODE < +0                                    23060019
230700             WHEN SQLCODE > +0                                    23070019
230800                  MOVE '3020-VALIDATE-SEASONAL-SET'               23080019
230900                                  TO DP013-PARAGRAPH              23090019
231000                  MOVE 'UNSUCCESSFUL ON SELECT SEASET'            23100019
231100                                  TO DP013-MESSAGE-TEXT (1)       23110019
231200                  MOVE SQLCA      TO DP013-SQLCA                  23120019
231300                  MOVE 'TSEASET ' TO DP013-DB2-TABLE-NAME (1)     23130019
231400                  SET DP013-DB2-ABEND                             23140019
231500                      DP013-XCTL-DISPLAY-RESTART                  23150019
231600                                  TO TRUE                         23160019
231700                  PERFORM DP013-0000-PROCESS-ABEND                23170019
231800         END-EVALUATE                                             23180019
231900     END-PERFORM.                                                 23190019
232000                                                                  23200019
232100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23210019
232200         MOVE '3020-VALIDATE-SEASONAL-SET'                        23220019
232300                                  TO DP013-PARAGRAPH              23230019
232400         MOVE 'MAX RETRIES EXCEEDED ON SELECT SEASET'             23240019
232500                                  TO DP013-MESSAGE-TEXT (1)       23250019
232600         MOVE SQLCA               TO DP013-SQLCA                  23260019
232700         MOVE 'TSEASET '          TO DP013-DB2-TABLE-NAME (1)     23270019
232800         SET DP013-DB2-ABEND                                      23280019
232900             DP013-XCTL-DISPLAY-RESTART                           23290019
233000                                  TO TRUE                         23300019
233100         PERFORM DP013-0000-PROCESS-ABEND                         23310019
233200     END-IF.                                                      23320019
233300/                                                                 23330019
233400*----------------------------------------------------------------*23340019
233500*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *23350019
233600*  MAP.                                                          *23360019
233700*----------------------------------------------------------------*23370019
233800                                                                  23380019
233900 3100-RESET-ATTRIBUTES.                                           23390019
234000                                                                  23400019
234100     MOVE DP015-UNP-ALP-NOR-OFF    TO APONUMA                     23410019
234200                                      ACTORA                      23420019
234300                                      ACTPLA                      23430019
234400                                      ADEPTA                      23440019
234500                                      ACLASSA                     23450019
234600                                      ASUBCLA                     23460019
234700                                      ASKUA                       23470019
234800                                      ASTGRPA                     23480019
234900                                      ADDATEA                     23490019
235000                                      ASC1A                       23500019
235100                                      AOTBBEGA                    23510019
235200                                      AOTBENDA                    23520019
235300                                      APOTYPEA                    23530019
235400                                      ANEWSTRA                    23540019
235500                                      ASTRA                       23550019
235600                                      AFOBA                       23560019
235700                                      APOEA                       23570019
235800                                      AMAKERA                     23580019
235900                                      AVENDNMA                    23590019
236000                                      ASEASETA                    23600019
236100                                      ADMMA                       23610019
236200                                      AGRPCDEA                    23620019
236300                                      ASTYLEA                     23630019
236400                                      AXFCBA                      23640019
236500                                      AXFCEA                      23650019
236600                                      ASHDBA                      23660019
236700                                      ASHDEA                      23670019
236800                                      APPIA                       23680019
236900                                      ASRT1A                      23690019
237000                                      ASRT2A                      23700019
237100                                      APICADA                     23710019
237200                                      AEDIA                       23720019
237300                                      APBSA                       23730019
237400                                      APRETA                      23740019
237500                                      AQUOTAA                     23750019
237600                                      APRETA                      23760019
237700                                      ADSTRA                      23770019
237800                                      ADFOBA                      23780019
237900                                      ADPOEA                      23790019
238000                                      ADXFCA                      23800019
238100                                      ADBKDA                      23810019
238200                                      ADFRDA                      23820019
238300                                      ADSLDA                      23830019
238400                                      ADPRDA                      23840019
238500                                      ADCSRA                      23850019
238600                                      ADDVNA                      23860019
238700                                      ADETAA                      23870019
238800                                      ADDSBA                      23880019
238900                                      ADCNLA                      23890019
239000                                      ADADDA                      23900019
239100                                      ADOTBA                      23910019
239200                                      ADPPKA                      23920019
239300                                      ADEDIA                      23930019
239400                                      ADSTAA                      23940019
239500                                      ADDOLA                      23950019
239600                                      ADUNTA                      23960019
239700                                      ADTRPA                      23970019
239800                                      ADSPLA                      23980019
239900                                      ADQCTA                      23990019
240000                                      ADVNSA                      24000019
240100                                      ADCRLA                      24010019
240200                                      ADTRAA.                     24020019
240300     MOVE DP015-GREEN              TO APONUMC                     24030019
240400                                      ACTORC                      24040019
240500                                      ACTPLC                      24050019
240600                                      ADEPTC                      24060019
240700                                      ACLASSC                     24070019
240800                                      ASUBCLC                     24080019
240900                                      ASKUC                       24090019
241000                                      ASTGRPC                     24100019
241100                                      ADDATEC                     24110019
241200                                      ASC1C                       24120019
241300                                      AOTBBEGC                    24130019
241400                                      AOTBENDC                    24140019
241500                                      APOTYPEC                    24150019
241600                                      ANEWSTRC                    24160019
241700                                      ASTRC                       24170019
241800                                      AFOBC                       24180019
241900                                      APOEC                       24190019
242000                                      AMAKERC                     24200019
242100                                      AVENDNMC                    24210019
242200                                      ASEASETC                    24220019
242300                                      ADMMC                       24230019
242400                                      AGRPCDEC                    24240019
242500                                      ASTYLEC                     24250019
242600                                      AXFCBC                      24260019
242700                                      AXFCEC                      24270019
242800                                      ASHDBC                      24280019
242900                                      ASHDEC                      24290019
243000                                      APPIC                       24300019
243100                                      ASRT1C                      24310019
243200                                      ASRT2C                      24320019
243300                                      APICADC                     24330019
243400                                      AEDIC                       24340019
243500                                      APBSC                       24350019
243600                                      APRETC                      24360019
243700                                      AQUOTAC                     24370019
243800                                      ADSTRC                      24380019
243900                                      ADFOBC                      24390019
244000                                      ADPOEC                      24400019
244100                                      ADXFCC                      24410019
244200                                      ADBKDC                      24420019
244300                                      ADFRDC                      24430019
244400                                      ADSLDC                      24440019
244500                                      ADPRDC                      24450019
244600                                      ADCSRC                      24460019
244700                                      ADDVNC                      24470019
244800                                      ADETAC                      24480019
244900                                      ADDSBC                      24490019
245000                                      ADCNLC                      24500019
245100                                      ADADDC                      24510019
245200                                      ADOTBC                      24520019
245300                                      ADPPKC                      24530019
245400                                      ADEDIC                      24540019
245500                                      ADSTAC                      24550019
245600                                      ADDOLC                      24560019
245700                                      ADUNTC                      24570019
245800                                      ADTRPC                      24580019
245900                                      ADSPLC                      24590019
246000                                      ADQCTC                      24600019
246100                                      ADVNSC                      24610019
246200                                      ADCRLC                      24620019
246300                                      ADTRAC.                     24630019
246400     MOVE DP015-UNDERLINE          TO APONUMH                     24640019
246500                                      ACTORH                      24650019
246600                                      ACTPLH                      24660019
246700                                      ADEPTH                      24670019
246800                                      ACLASSH                     24680019
246900                                      ASUBCLH                     24690019
247000                                      ASKUH                       24700019
247100                                      ASTGRPH                     24710019
247200                                      ADDATEH                     24720019
247300                                      ASC1H                       24730019
247400                                      AOTBBEGH                    24740019
247500                                      AOTBENDH                    24750019
247600                                      APOTYPEH                    24760019
247700                                      ANEWSTRH                    24770019
247800                                      ASTRH                       24780019
247900                                      AFOBH                       24790019
248000                                      APOEH                       24800019
248100                                      AMAKERH                     24810019
248200                                      AVENDNMH                    24820019
248300                                      ASEASETH                    24830019
248400                                      ADMMH                       24840019
248500                                      AGRPCDEH                    24850019
248600                                      ASTYLEH                     24860019
248700                                      AXFCBH                      24870019
248800                                      AXFCEH                      24880019
248900                                      ASHDBH                      24890019
249000                                      ASHDEH                      24900019
249100                                      APPIH                       24910019
249200                                      ASRT1H                      24920019
249300                                      ASRT2H                      24930019
249400                                      APICADH                     24940019
249500                                      AEDIH                       24950019
249600                                      APBSH                       24960019
249700                                      APRETH                      24970019
249800                                      AQUOTAH                     24980019
249900                                      ADSTRH                      24990019
250000                                      ADFOBH                      25000019
250100                                      ADPOEH                      25010019
250200                                      ADXFCH                      25020019
250300                                      ADBKDH                      25030019
250400                                      ADFRDH                      25040019
250500                                      ADSLDH                      25050019
250600                                      ADPRDH                      25060019
250700                                      ADCSRH                      25070019
250800                                      ADDVNH                      25080019
250900                                      ADETAH                      25090019
251000                                      ADDSBH                      25100019
251100                                      ADCNLH                      25110019
251200                                      ADADDH                      25120019
251300                                      ADOTBH                      25130019
251400                                      ADPPKH                      25140019
251500                                      ADEDIH                      25150019
251600                                      ADSTAH                      25160019
251700                                      ADDOLH                      25170019
251800                                      ADUNTH                      25180019
251900                                      ADTRPH                      25190019
252000                                      ADSPLH                      25200019
252100                                      ADQCTH                      25210019
252200                                      ADVNSH                      25220019
252300                                      ADCRLH                      25230019
252400                                      ADTRAH.                     25240019
252500/                                                                 25250019
252600*----------------------------------------------------------------*25260019
252700*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *25270019
252800*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *25280019
252900*  IT HERE.                                                      *25290019
253000*----------------------------------------------------------------*25300019
253100                                                                  25310019
253200 4000-BUILD-INITIAL-PANEL.                                        25320019
253300                                                                  25330019
253400     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         25340019
253500     SET ASC-LOCAL-01-NO-NEED-CONFIRM TO TRUE.                    25350019
253600     MOVE -1                     TO APONUML.                      25360019
253700     MOVE 'ACT'                  TO ASTGRPO                       25370019
253800                                    ASC-STATUS-GRP.               25380019
253900     MOVE 'P'                    TO ASRT1O                        25390019
254000                                    ASC-SORT1-BY-IND.             25400019
254100     MOVE 'X'                    TO ASRT2O                        25410019
254200                                    ASC-SORT2-BY-IND.             25420019
254300     MOVE 'N'                    TO ADFOBO.                       25430019
254400     MOVE 'N'                    TO ADPOEO.                       25440019
254500     MOVE 'N'                    TO ADXFCO.                       25450019
254600     MOVE 'N'                    TO ADBKDO.                       25460019
254700     MOVE 'N'                    TO ADFRDO.                       25470019
254800     MOVE 'N'                    TO ADSLDO.                       25480019
254900     MOVE 'N'                    TO ADPRDO.                       25490019
255000     MOVE 'N'                    TO ADCSRO.                       25500019
255100     MOVE 'N'                    TO ADDVNO.                       25510019
255200     MOVE 'N'                    TO ADETAO.                       25520019
255300     MOVE 'N'                    TO ADDSBO.                       25530019
255400     MOVE 'N'                    TO ADCNLO.                       25540019
255500     MOVE 'N'                    TO ADADDO.                       25550019
255600     MOVE 'N'                    TO ADOTBO.                       25560019
255700     MOVE 'N'                    TO ADPPKO.                       25570019
255800     MOVE 'N'                    TO ADEDIO.                       25580019
255900     MOVE 'N'                    TO ADSTAO.                       25590019
256000     MOVE 'N'                    TO ADDOLO.                       25600019
256100     MOVE 'N'                    TO ADUNTO.                       25610019
256200     MOVE 'N'                    TO ADTRPO.                       25620019
256300     MOVE 'N'                    TO ADSPLO.                       25630019
256400     MOVE 'N'                    TO ADQCTO.                       25640019
256500     MOVE 'N'                    TO ADVNSO.                       25650019
256600     MOVE 'N'                    TO ADCRLO.                       25660019
256700     MOVE 'N'                    TO ADTRAO.                       25670019
256800     MOVE 'N'                    TO ASC-DFOB.                     25680019
256900     MOVE 'N'                    TO ASC-DPOE.                     25690019
257000     MOVE 'N'                    TO ASC-DXFC.                     25700019
257100     MOVE 'N'                    TO ASC-DBKD.                     25710019
257200     MOVE 'N'                    TO ASC-DFRD.                     25720019
257300     MOVE 'N'                    TO ASC-DSLD.                     25730019
257400     MOVE 'N'                    TO ASC-DPRD.                     25740019
257500     MOVE 'N'                    TO ASC-DCSR.                     25750019
257600     MOVE 'N'                    TO ASC-DDVN.                     25760019
257700     MOVE 'N'                    TO ASC-DETA.                     25770019
257800     MOVE 'N'                    TO ASC-DDSB.                     25780019
257900     MOVE 'N'                    TO ASC-DCNL.                     25790019
258000     MOVE 'N'                    TO ASC-DADD.                     25800019
258100     MOVE 'N'                    TO ASC-DOTB.                     25810019
258200     MOVE 'N'                    TO ASC-DPPK.                     25820019
258300     MOVE 'N'                    TO ASC-DEDI.                     25830019
258400     MOVE 'N'                    TO ASC-DSTA.                     25840019
258500     MOVE 'N'                    TO ASC-DDOL.                     25850019
258600     MOVE 'N'                    TO ASC-DUNT.                     25860019
258700     MOVE 'N'                    TO ASC-DTRP.                     25870019
258800     MOVE 'N'                    TO ASC-DSPL.                     25880019
258900     MOVE 'N'                    TO ASC-DQCT.                     25890019
259000     MOVE 'N'                    TO ASC-DVNS.                     25900019
259100     MOVE 'N'                    TO ASC-DCRL.                     25910019
259200     MOVE 'N'                    TO ASC-DTRA.                     25920019
259300/                                                                 25930019
259400*----------------------------------------------------------------*25940019
259500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *25950019
259600*----------------------------------------------------------------*25960019
259700                                                                  25970019
259800 4400-MOVE-COMMAREA-TO-SCREEN.                                    25980019
259900                                                                  25990019
260000     MOVE ASC-PO-NBR             TO APONUMO.                      26000019
260100     MOVE ASC-CNTRY-ORG          TO ACTORO.                       26010019
260200     MOVE ASC-CNTRY-PLC          TO ACTPLO.                       26020019
260300     MOVE ASC-DEPT-NBR           TO ADEPTO.                       26030019
260400     MOVE ASC-STATUS-GRP         TO ASTGRPO.                      26040019
260500     MOVE ASC-STATUS-CDE         TO ASC1O.                        26050019
260600     MOVE ASC-CLASS              TO ACLASSO.                      26060019
260700     MOVE ASC-SUBCLASS           TO ASUBCLO.                      26070019
260800     MOVE ASC-PO-TYP-CDE         TO APOTYPEO.                     26080019
260900     MOVE ASC-SKU                TO ASKUO.                        26090019
261000     MOVE ASC-PRE-PACK-IND       TO APPIO.                        26100019
261100     MOVE ASC-MAKER-NME          TO AMAKERO.                      26110019
261200     MOVE ASC-ENT-NAME-DESC      TO AVENDNMO.                     26120019
261300     MOVE ASC-VEND-STYL-NME      TO ASTYLEO.                      26130019
261400     MOVE ASC-SEASONAL-SET       TO ASEASETO.                     26140019
261500     MOVE ASC-DMM                TO ADMMO.                        26150019
261600     MOVE ASC-GROUP-CDE          TO AGRPCDEO.                     26160019
261700     MOVE ASC-AD-EVNT-DTE        TO ADDATEO.                      26170019
261800     STRING ASC-OTB-PER-NBR-BEG(5:2) DELIMITED BY SIZE            26180019
261900            ASC-OTB-PER-NBR-BEG(3:2) DELIMITED BY SIZE            26190019
262000                               INTO AOTBBEGO.                     26200019
262100     STRING ASC-OTB-PER-NBR-END(5:2) DELIMITED BY SIZE            26210019
262200            ASC-OTB-PER-NBR-END(3:2) DELIMITED BY SIZE            26220019
262300                               INTO AOTBENDO.                     26230019
262400     MOVE ASC-XFACT-BEF-DTE      TO AXFCBO.                       26240019
262500     MOVE ASC-XFACT-END-DTE      TO AXFCEO.                       26250019
262600     MOVE ASC-SHPDT-BEF-DTE      TO ASHDBO.                       26260019
262700     MOVE ASC-SHPDT-END-DTE      TO ASHDEO.                       26270019
262800     MOVE ASC-NEW-STORE-IND      TO ANEWSTRO.                     26280019
262900     MOVE ASC-PIC-AD-IND         TO APICADO.                      26290019
263000     MOVE ASC-EDI-IND            TO AEDIO.                        26300019
263100     MOVE ASC-STR-NBR            TO ASTRO.                        26310019
263200     MOVE ASC-PACK-BY-STORE-IND  TO APBSO.                        26320019
263300     MOVE ASC-PRE-TICKET-IND     TO APRETO.                       26330019
263400     MOVE ASC-QUOTA-CATEGORY     TO AQUOTAO.                      26340019
263500     MOVE ASC-DIRECT-STORE-IND   TO ADSTRO.                       26350019
263600     MOVE ASC-SORT1-BY-IND       TO ASRT1O.                       26360019
263700     MOVE ASC-SORT2-BY-IND       TO ASRT2O.                       26370019
263800     MOVE ASC-FOB-CDE            TO AFOBO.                        26380019
263900     MOVE ASC-POE-CDE            TO APOEO.                        26390019
264000     MOVE ASC-DFOB               TO ADFOBO.                       26400019
264100     MOVE ASC-DPOE               TO ADPOEO.                       26410019
264200     MOVE ASC-DXFC               TO ADXFCO.                       26420019
264300     MOVE ASC-DBKD               TO ADBKDO.                       26430019
264400     MOVE ASC-DFRD               TO ADFRDO.                       26440019
264500     MOVE ASC-DSLD               TO ADSLDO.                       26450019
264600     MOVE ASC-DPRD               TO ADPRDO.                       26460019
264700     MOVE ASC-DCSR               TO ADCSRO.                       26470019
264800     MOVE ASC-DDVN               TO ADDVNO.                       26480019
264900     MOVE ASC-DETA               TO ADETAO.                       26490019
265000     MOVE ASC-DDSB               TO ADDSBO.                       26500019
265100     MOVE ASC-DCNL               TO ADCNLO.                       26510019
265200     MOVE ASC-DADD               TO ADADDO.                       26520019
265300     MOVE ASC-DOTB               TO ADOTBO.                       26530019
265400     MOVE ASC-DPPK               TO ADPPKO.                       26540019
265500     MOVE ASC-DEDI               TO ADEDIO.                       26550019
265600     MOVE ASC-DSTA               TO ADSTAO.                       26560019
265700     MOVE ASC-DDOL               TO ADDOLO.                       26570019
265800     MOVE ASC-DUNT               TO ADUNTO.                       26580019
265900     MOVE ASC-DTRP               TO ADTRPO.                       26590019
266000     MOVE ASC-DSPL               TO ADSPLO.                       26600019
266100     MOVE ASC-DQCT               TO ADQCTO.                       26610019
266200     MOVE ASC-DVNS               TO ADVNSO.                       26620019
266300     MOVE ASC-DCRL               TO ADCRLO.                       26630019
266400     MOVE ASC-DTRA               TO ADTRAO.                       26640019
266500 EJECT                                                            26650019
266600*----------------------------------------------------------------*26660019
266700*    ABEND PROCESSOR MODULE                                      *26670019
266800*----------------------------------------------------------------*26680019
266900     COPY DPPD013.                                                26690019
