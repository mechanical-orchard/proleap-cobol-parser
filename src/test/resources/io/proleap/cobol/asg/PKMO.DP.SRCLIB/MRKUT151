000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             MRKUT151.                                00050000
000600 AUTHOR.                 XXXXXXXXXXXXXXX.                         00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            12-XX-10.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*          CREATE TRANSFER RECORD INPUT                         * 00120000
001300*                                                               * 00130000
001400*  VERSION OF MRKUT003                                          * 00140000
001500*  RETRIEVES RECORDS, DOES NOT ASSIGN WEEK NUMBER, RETRIEVES    * 00150000
001600*  BASED ON RT_NBR                                              * 00160000
001700*                                                               * 00170000
001800*  THIS PROGRAM IS A VERSION OF MRKUT003.  IT WAS CREATED TO    * 00180000
001900*  BE RUN ONLY IN THE ECOMM PROCESS, TO SUM ALL ECOMM ON-HAND,  * 00190000
002000*  ON-ORDER, AND SALES TO THE CHANNEL LEVEL                     * 00200000
002100*                                                               * 00210000
002200***************************************************************** 00220000
002300*  CHANGE MADE:                                                 * 00230000
002400*                                                               * 00240000
RONNA * 09/15/2023 - SEPHORA CHANGES NEEDED.                          * 00241013
RONNA *              THE BUSINESS IS TRANSFERING SURPLUS STORE        * 00241113
RONNA *              SEPHORA MERCHANDISE TO ECOM LOCATION 839,        * 00242013
RONNA *              AND DOES NOT WANT THE ON HAND OR ON ORDER        * 00243013
RONNA *              NUMBERS FROM LOCATION 839 TO BE INCLUDED         * 00244013
RONNA *              IN THE THE OUTPUT FILE FOR INFOREM.  THIS        * 00245013
RONNA *              PROGRAM IS ONLY USED FOR ECOM PROCESSING.        * 00246013
RONNA *              THE SEPHORA DEPTS ARE 700-711, AND ALL           * 00247013
RONNA *              ITEMS THAT HAVE THESE DEPTS WILL NOW USE A       * 00247113
RONNA *              QUERY THAT ONLY LOOKS AT ON HAND NUMBERS         * 00247213
RONNA *              WITH LOCATION 839.                               * 00247313
RONNA *                                                               * 00248013
002500***************************************************************** 00250000
006639***************************************************************** 00260000
006646 ENVIRONMENT DIVISION.                                            00270000
006647***************************************************************** 00280000
006648                                                                  00290000
006649 CONFIGURATION SECTION.                                           00300000
006650                                                                  00310000
006660 SOURCE-COMPUTER.        IBM-3090.                                00320000
006670 OBJECT-COMPUTER.        IBM-3090.                                00330000
006680                                                                  00340000
006690 INPUT-OUTPUT SECTION.                                            00350000
006700                                                                  00360000
006800 FILE-CONTROL.                                                    00370000
006900*                                                                 00380000
007000     SELECT IC-CONTROL-FILE    ASSIGN       TO INP01              00390000
007100                               ORGANIZATION IS INDEXED            00400000
007200                               ACCESS       IS RANDOM             00410000
007300                               RECORD KEY   IS ICCTL-KEY          00420000
007400                               FILE STATUS  IS PV-CONTROL-STATUS. 00430000
007500     SELECT BIM-FILE           ASSIGN       TO INP02              00440000
007600                               ORGANIZATION IS INDEXED            00450000
007700                               ACCESS       IS RANDOM             00460000
007800                               RECORD KEY   IS BIM-FILE-KEY       00470000
007900                               FILE STATUS  IS PV-BIM-STATUS.     00480000
008000     SELECT TRANSFER-RECORD-IN ASSIGN TO INP03.                   00490000
           SELECT CONTROL-CARD-FILE  ASSIGN TO INP04.                   00500000
008100     SELECT TRANSFER-RECORD    ASSIGN TO OUT01.                   00510000
008200*                                                                 00520000
008300***************************************************************** 00530000
008400 DATA DIVISION.                                                   00540000
008500***************************************************************** 00550000
008600*                                                                 00560000
008700 FILE SECTION.                                                    00570000
008800*                                                                 00580000
008900 FD  IC-CONTROL-FILE.                                             00590000
009000 01  IC-CONTROL-REC.                                              00600000
009100     05  ICCTL-KEY                   PIC  X(21).                  00610000
009200     05  FILLER                      PIC  X(379).                 00620000
009300*                                                                 00630000
009400 FD  BIM-FILE.                                                    00640000
009500 01  BIM-REC.                                                     00650000
009600     05  BIM-FILE-KEY                PIC  X(07).                  00660000
009700     05  FILLER                      PIC  X(228).                 00670000
009800*                                                                 00680000
009900 FD  TRANSFER-RECORD-IN                                           00690000
010000     RECORDING MODE IS F                                          00700000
010100     LABEL RECORDS ARE STANDARD                                   00710000
010200     RECORD CONTAINS 1143 CHARACTERS                              00720000
010300     BLOCK CONTAINS 0  RECORDS.                                   00730000
010400 01  TRANSFER-REC-IN                 PIC  X(1143).                00740000
      *                                                                 00750000
       FD  CONTROL-CARD-FILE                                            00760000
           RECORDING MODE IS F                                          00770000
           LABEL RECORDS ARE STANDARD                                   00780000
           RECORD CONTAINS 80 CHARACTERS                                00790000
           BLOCK CONTAINS 0  RECORDS.                                   00800000
       01  CONTROL-CARD-IN                 PIC  X(80).                  00810000
010500*                                                                 00820000
010600 FD  TRANSFER-RECORD                                              00830000
010700     RECORDING MODE IS F                                          00840000
010800     LABEL RECORDS ARE STANDARD                                   00850000
010900     RECORD CONTAINS 2900 CHARACTERS                              00860000
011000     BLOCK CONTAINS 0  RECORDS.                                   00870000
011100 01  TRANSFER-REC                    PIC  X(2900).                00880000
011200*                                                                 00890000
011300 WORKING-STORAGE SECTION.                                         00900000
011400*                                                                 00910000
011500 01  FILLER.                                                      00920000
011600     05  FILLER                      PIC  X(36)    VALUE          00930000
011700         ' ***** WORKING STORAGE PGM=MRKUT151 '.                  00940004
011800     05  FILLER                      PIC  X(10)    VALUE          00950000
011900         ' LOCATION='.                                            00960000
012000     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00970000
012100     05  FILLER                      PIC  X(06)    VALUE          00980000
012200         ' *****'.                                                00990000
012300 EJECT                                                            01000000
012400 01  PROGRAM-SWITCHES.                                            01010000
012500     05  PS-EOF-TRANS-REC            PIC  X(01)    VALUE 'N'.     01020000
012600         88  EOF-TRANS-REC                         VALUE 'Y'.     01030000
012700     05  PS-NO-INPUT                 PIC  X(01)    VALUE 'N'.     01040000
012800         88  NO-INPUT                              VALUE 'Y'.     01050000
012900     05  PS-ROW-FOUND-SWITCH         PIC  X(01)    VALUE 'Y'.     01060000
013000         88  PS-ROW-FOUND                          VALUE 'Y'.     01070000
013100         88  PS-ROW-NOT-FOUND                      VALUE 'N'.     01080000
013200*                                                                 01090000
013300/                                                                 01100000
013400 01  PC-CONSTANTS.                                                01110000
013500     05  PC-PGRM-NAME                PIC  X(08)    VALUE          01120000
013600                                                  'MRKUT151'.     01130004
013700     05  PC-PLUS-1                   PIC S9(04)    VALUE +1       01140000
013800                                                   COMP SYNC.     01150000
013900     05  PC-NEG-1                    PIC S9(04)    VALUE -1       01160000
014000                                                   COMP SYNC.     01170000
014100     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01171001
014200                                                   COMP SYNC.     01172001
014300     05  PC-01                       PIC  X(02)    VALUE '01'.    01200000
014400     05  PC-1                        PIC S9(03)    VALUE +1       01210000
014500                                                   COMP-3.        01220000
014600     05  PC-2                        PIC S9(03)    VALUE +2       01230000
014700                                                   COMP-3.        01240000
014800     05  PC-3                        PIC S9(03)    VALUE +3       01250000
014900                                                   COMP-3.        01260000
015000     05  PC-4                        PIC S9(03)    VALUE +4       01270000
015100                                                   COMP-3.        01280000
015200     05  PC-5                        PIC S9(03)    VALUE +5       01290000
015300                                                   COMP-3.        01300000
015400     05  PC-6                        PIC S9(03)    VALUE +6       01310000
015500                                                   COMP-3.        01320000
015600     05  PC-7                        PIC S9(03)    VALUE +7       01330000
015700                                                   COMP-3.        01340000
015800     05  PC-200                      PIC S9(03)    VALUE +200     01350000
015900                                                   COMP-3.        01360000
016000     05  PC-999                      PIC S9(03)    VALUE +999     01370000
016100                                                   COMP-3.        01380000
016200     05  PC-03                       PIC  X(02)    VALUE '03'.    01390000
016300     05  PC-13                       PIC  X(02)    VALUE '13'.    01400000
016400     05  PC-17                       PIC  X(02)    VALUE '17'.    01410000
016500     05  PC-19                       PIC  X(02)    VALUE '19'.    01420000
016600     05  PC-20                       PIC  X(02)    VALUE '20'.    01430000
016700     05  PC-52                       PIC  9(02)    VALUE  52.     01440000
016800     05  PC-1P                       PIC  S99V     VALUE +1       01450000
016900                                                   COMP-3.        01460000
017000     05  PC-2P                       PIC  S99V     VALUE +2       01470000
017100                                                   COMP-3.        01480000
017200     05  PC-3P                       PIC  S99V     VALUE +3       01490000
017300                                                   COMP-3.        01500000
017400     05  PC-4P                       PIC  S99V     VALUE +4       01510000
017500                                                   COMP-3.        01520000
017600     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01530000
017700     05  PC-A0                       PIC  X(02)    VALUE 'A0'.    01540000
017800     05  PC-F2                       PIC  X(02)    VALUE 'F2'.    01550000
017900     05  PC-F4                       PIC  X(02)    VALUE 'F4'.    01560000
018000     05  PC-DECR-7-DAYS              PIC  9(05)    VALUE 00007.   01570000
018100     05  PC-DPT                      PIC  X(03)    VALUE 'DPT'.   01580000
018200     05  PC-BYR                      PIC  X(03)    VALUE 'BYR'.   01590000
018300     05  PC-RCD-TYPE                 PIC  X(03)    VALUE 'SYS'.   01600000
018400     05  PC-FLNAME-LENGTH            PIC S9(03)    VALUE +30      01610000
018500                                                   COMP-3.        01620000
018600     05  PC-PGM-DPKUT500             PIC  X(08)    VALUE          01630000
018700                                                   'DPKUT500'.    01640000
018800     05  PC-OPER-CO                  PIC  XX       VALUE '03'.    01650000
018900     05  PC-CORPORATE-STORE          PIC  9(05)    VALUE ZERO.    01660000
019000     05  PC-085                      PIC  9(03)    COMP-3         01670000
019100                                                   VALUE 085.     01680000
019200     05  PC-810                      PIC  9(03)    COMP-3         01690000
019300                                                   VALUE 810.     01700000
019400     05  PC-899                      PIC  9(03)    COMP-3         01710000
019500                                                   VALUE 899.     01720000
019600 EJECT                                                            01730000
019700*                                                                 01740000
019800 01  PV-NULL-INDICATORS.                                          01750000
019900     05  PV-SALES-UNIT-QTY-NULL      PIC S9(04)    VALUE +0       01760000
020000                                                   COMP SYNC.     01770000
019900     05  PV-NULL-HISTCPS-QTY         PIC S9(04)    VALUE +0       01780000
020000                                                   COMP SYNC.     01790000
020100     05  PV-NULL-SLS-QTY             PIC S9(04)    VALUE +0       01800000
020200                                                   COMP SYNC.     01810000
020300     05  PV-NULL-OO                  PIC S9(04)    VALUE +0       01820000
020400                                                   COMP SYNC.     01830000
020500*                                                                 01840000
020600 01  PV-ACCUMULATOR-FIELDS.                                       01850000
020610     05  PV-SYSTEM-INPUT-CNT         PIC S9(07)    VALUE ZERO     01860000
020620                                                   COMP-3.        01870000
020630     05  PV-TRANS-INPUT-CNT          PIC S9(07)    VALUE ZERO     01880000
020640                                                   COMP-3.        01890000
020650     05  PV-SYSTEM-OUTPUT-CNT        PIC S9(07)    VALUE ZERO     01900000
020660                                                   COMP-3.        01910000
020670     05  PV-ITEM-COUNT               PIC S9(07)    VALUE ZERO     01920000
020680                                                   COMP-3.        01930000
020690 EJECT                                                            01940000
020700*                                                                 01950000
020800 01  PV-MISC-FIELDS.                                              01960000
020900     05  PV-9-5                      PIC 9(05)    VALUE ZERO.     01970000
020900     05  PV-X-5 REDEFINES PV-9-5.                                 01980000
022300         10   FILLER                 PIC X(2).                    01990000
022300         10   PV-X-3                 PIC X(3).                    02000000
020900     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     02010000
021000                                                   COMP SYNC.     02020000
021100     05  PV-VSAM-STATUS              PIC  X(02)    VALUE SPACE.   02030000
021200         88   PV-NO-REC-FOUND                      VALUE '23'.    02040000
021300                                                                  02050000
021400     05  PV-CONTROL-STATUS           PIC  X(02)    VALUE SPACE.   02060000
021500         88  PV-CONTROL-SUCCESSFUL                 VALUE '00'.    02070000
021600         88  PV-CONTROL-VERIFY                     VALUE '97'.    02080000
021700     05  PV-BIM-STATUS               PIC  X(02)    VALUE SPACE.   02090000
021800         88  PV-BIM-SUCCESSFUL                     VALUE '00'.    02100000
021900         88  PV-BIM-VERIFY                         VALUE '97'.    02110000
022000                                                                  02120000
RONNA      05  PV-SEPHORA-DEPT             PIC  X(03)    VALUE SPACES.  02121014
RONNA          88 PV-SEPHORA-DEPT-LIST                   VALUES         02121214
RONNA             '700' '701' '702' '703' '704' '705' '706'             02122012
RONNA             '707' '708' '709' '710' '711'.                        02123012
022000                                                                  02124012
022100     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  02130000
022200     05  PV-MESSAGES.                                             02140000
022300         10   PV-PARAGRAPH-NAME-MSG.                              02150000
022400             15  FILLER              PIC  X(13)    VALUE          02160000
022500                                    'PARAGRAPH IS '.              02170000
022600             15  PV-PARAGRAPH-NAME   PIC  X(25).                  02180000
022700         10   PV-ERROR-FILE-MSG.                                  02190000
022800             15  FILLER              PIC  X(26)    VALUE          02200000
022900                   'ERROR HAS OCCURED FILE IS '.                  02210000
023000             15  PV-ERROR-FILE       PIC  X(19).                  02220000
023100         10   PV-ERROR-OPERATION-MSG.                             02230000
023200             15  FILLER              PIC  X(13)    VALUE          02240000
023300                   'OPERATION IS '.                               02250000
023400             15  PV-ERROR-OPERATION  PIC  X(19).                  02260000
023500         10   PV-ERROR-STATUS-MSG.                                02270000
023600             15  FILLER              PIC  X(10)    VALUE          02280000
023700                   'STATUS IS '.                                  02290000
023800             15  PV-ERROR-STATUS     PIC  X(20).                  02300000
023900         10   PV-NOT-FOUND-MSG.                                   02310000
024000             15  FILLER              PIC  X(12)    VALUE          02320000
024100                   'FILE KEY IS '.                                02330000
024200             15  PV-NOT-FOUND-KEY    PIC  X(21).                  02340000
024300     05  PC-DATE.                                                 02350000
024400         10  PC-MO                   PIC 9(2) VALUE ZEROES.       02360000
024500         10  FILLER                  PIC X(1) VALUE '/'.          02370000
024600         10  PC-DY                   PIC 9(2) VALUE ZEROES.       02380000
024700         10  FILLER                  PIC X(1) VALUE '/'.          02390000
024800         10  PC-YR                   PIC 9(2) VALUE ZEROES.       02400000
024900                                                                  02410000
025000     05  PV-TODAYS-DATE              PIC  X(08).                  02420000
025100     05  PV-TODAYS-WEEK              PIC  9(02).                  02430000
025200     05  PV-FIRST-DATE.                                           02440000
025300         10  PV-FIRST-MO             PIC  9(02).                  02450000
025400         10  FILLER                  PIC  X(01)    VALUE '/'.     02460000
025500         10  PV-FIRST-DY             PIC  9(02).                  02470000
025600         10  FILLER                  PIC  X(01)    VALUE '/'.     02480000
025700         10  PV-FIRST-YR             PIC  9(02).                  02490000
025800     05  PV-UCYCLE-MIN-DATE                        VALUE SPACES.  02500000
025900         10  PV-UCYCLE-MIN-CCYR      PIC  9(04).                  02510000
026000         10  FILLER                  PIC  X(06).                  02520000
025800     05  PV-UCYCLE5-MIN-DATE                       VALUE SPACES.  02530000
025900         10  PV-UCYCLE5-MIN-CCYR     PIC  9(04).                  02540000
026000         10  FILLER                  PIC  X(06).                  02550000
025800     05  PV-UCYCLE9-MIN-DATE                       VALUE SPACES.  02560000
025900         10  PV-UCYCLE9-MIN-CCYR     PIC  9(04).                  02570000
026000         10  FILLER                  PIC  X(06).                  02580000
026100     05  PV-UCYCLE-MIN-YR            PIC  9(02)    VALUE ZERO.    02590000
026200     05  PV-UCYCLE-MAX-DATE                        VALUE SPACES.  02600000
026300         10  PV-UCYCLE-MAX-CCYR      PIC  9(04).                  02610000
026400         10  FILLER                  PIC  X(06).                  02620000
026200     05  PV-UCYCLE5-MAX-DATE                       VALUE SPACES.  02630000
026300         10  PV-UCYCLE5-MAX-CCYR     PIC  9(04).                  02640000
026400         10  FILLER                  PIC  X(06).                  02650000
026200     05  PV-UCYCLE9-MAX-DATE                       VALUE SPACES.  02660000
026300         10  PV-UCYCLE9-MAX-CCYR     PIC  9(04).                  02670000
026400         10  FILLER                  PIC  X(06).                  02680000
026500     05  PV-UCYCLE-MAX-YR            PIC  9(02)    VALUE ZERO.    02690000
026600**   05  PV-UCYCLE-MIN-DATE.                                      02700000
026700**       10  PV-UCYCLE-MIN-YR        PIC  9(02).                  02710000
026800**       10  PV-UCYCLE-MIN-WK        PIC  9(02).                  02720000
026900**   05  PV-UCYCLE-MAX-DATE.                                      02730000
027000**       10  PV-UCYCLE-MAX-YR        PIC  9(02).                  02740000
027100**       10  PV-UCYCLE-MAX-WK        PIC  9(02).                  02750000
027200     05  PV-CURRENT-DATE.                                         02760000
027300         10  PV-CURRENT-DATE-CC      PIC  9(02)    VALUE ZERO.    02770000
027400         10  PV-CURRENT-DATE-YR      PIC  9(02)    VALUE ZERO.    02780000
027500         10  FILLER                  PIC  X(01)    VALUE '-'.     02790000
027600         10  PV-CURRENT-DATE-MO      PIC  9(02)    VALUE ZERO.    02800000
027700         10  FILLER                  PIC  X(01)    VALUE '-'.     02810000
027800         10  PV-CURRENT-DATE-DY      PIC  9(02)    VALUE ZERO.    02820000
027900     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE              02830000
028000                                     PIC  X(10).                  02840000
028100     05  PV-SUBSCRIPTS.                                           02850000
028200         10  PV-HIST-SUB             PIC  9(02)    VALUE ZERO.    02860000
028300         10  PV-CST-SUB              PIC  9(02)    VALUE ZERO.    02870000
028400         10  PV-BIM-SUB              PIC  9(02)    VALUE ZERO.    02880000
028500         10  PV-BIM-SUB2             PIC  9(02)    VALUE ZERO.    02890000
028600         10  PV-WBI-SUB              PIC  9(02)    VALUE ZERO.    02900000
028700         10  PV-MBI-SUB              PIC  9(02)    VALUE ZERO.    02910000
028800         10  PV-BPN-SUB              PIC S9(01)    COMP.          02920000
028900     05  PV-CALC-DAYS                PIC S9(03)    VALUE ZERO.    02930000
029000* ###                                                             02940000
029100     05  PV-CALC-DAYS-POSITIVE       PIC S9(03)    VALUE ZERO.    02950000
029200     05  PV-MIN-DATE-CALC-DAYS       PIC S9(03)    VALUE ZERO.    02960000
029300* ###                                                             02970000
029400     05  PV-MIN-DATE-CALC-DAYS-POSI  PIC S9(03)    VALUE ZEROS.   02980000
029500     05  PV-BYR-NAME                 PIC  X(30)    VALUE SPACES.  02990000
029600     05  PV-TSKSTWKS-MIN-DTE         PIC  X(10)    VALUE SPACES.  03000000
029700     05  PV-TSKSTWKS-MAX-DTE         PIC  X(10)    VALUE SPACES.  03010000
029800     05  PV-MIN-BOW-DATE             PIC  X(10)    VALUE SPACES.  03020000
029900     05  PV-MAX-BOW-DATE             PIC  X(10)    VALUE SPACES.  03030000
030000                                                                  03040000
030100*    05  PV-MIN-DATE.                                             03050000
030200*        10 PV-MIN-YR                PIC  9(02).                  03060000
030300*        10 PV-MIN-WK                PIC  X(02).                  03070000
030400*    05 PV-MIN-WEEK                  PIC  X(02).                  03080000
030500*    05 PV-MIN-WEEK-N REDEFINES PV-MIN-WEEK                       03090000
030600*                                    PIC 9(02).                   03100000
030700*    05  PV-MAX-DATE.                                             03110000
030800*        10 PV-MAX-YR                PIC  9(02).                  03120000
030900*        10 PV-MAX-WK                PIC  X(02).                  03130000
031000*    05 PV-MAX-WEEK                  PIC  X(02).                  03140000
031100*    05 PV-MAX-WEEK-N REDEFINES PV-MAX-WEEK                       03150000
031200*                                    PIC 9(02).                   03160000
031300                                                                  03170000
031400     05  PV-CPS-QTY                  PIC S9999999V COMP-3.        03180000
031500     05  PV-WN                       PIC S9(02)    VALUE ZEROES.  03190000
031600     05  PV-OO                       PIC S9(07)    COMP-3         03200000
031700                                                   VALUE ZEROES.  03210000
031900     05  PV-F4-NBR-FISCAL-WEEKS      PIC  9(02)    VALUE ZEROES.  03220000
032000     05  PV-F4-NBR-FISCAL-PERIOD-WKS PIC  9(02)    VALUE ZEROES.  03230000
032100*                                                                 03240000
032200     05  PV-PREV-FIELDS.                                          03250000
032300         10  PV-PREV-SORT-SKU.                                    03260000
032400             15  PV-PREV-DEPT       PIC  X(03)    VALUE SPACES.   03270000
032500             15  PV-PREV-CLASS      PIC  X(02)    VALUE SPACES.   03280000
032600             15  PV-PREV-VEND-NBR   PIC  X(03)    VALUE SPACES.   03290000
032700             15  PV-PREV-SKU        PIC S9(08)    COMP-3          03300000
032800                                                  VALUE ZEROES.   03310000
032900         10  PV-PREV-STORE          PIC S9(05)    VALUE ZEROES.   03320000
033000         10  PV-PREV-ITEM-NBR       PIC 9(15)     COMP-3 VALUE 0. 03330000
033100         10  PV-PREV-WEEK-NBR       PIC S99V      COMP-3 VALUE 0. 03340000
033200         10  PV-PREV-SEQ-NBR        PIC S99V      COMP-3 VALUE 0. 03350000
033300         10  PV-PREV-LFWM-QTY       PIC S9(6)V9   COMP-3 VALUE 0. 03360000
033400         10  PV-PREV-FWM-QTY        PIC S9(6)V9   COMP-3 VALUE 0. 03370000
                                                                        03380000
           05  PV-CONTROL-CARD.                                         03390000
               10  PV-MINUS-WK            PIC 9(01).                    03400000
               10  FILLER                 PIC X(79).                    03410000
033500*                                                                 03420000
033600 EJECT                                                            03430000
033700*                                                                 03440000
033800 01 PV-INPUT.                                                     03450000
033900     COPY MRRD017.                                                03460000
034000 EJECT                                                            03470000
034100 01 PV-OUTPUT.                                                    03480000
034200     COPY MRRD004O.                                               03490000
034300 EJECT                                                            03500000
034400     COPY DPWS024.                                                03510000
034500 EJECT                                                            03520000
034600     COPY DPWS500.                                                03530000
034700 EJECT                                                            03540000
034800     COPY MRRD001I.                                               03550000
034900 EJECT                                                            03560000
035000 01 PAN-BIM-FILE.                                                 03570000
035100     COPY IPFGBIC.                                                03580000
035200 EJECT                                                            03590000
035300 01  SYSTEM-RECORD.                                               03600000
035400     COPY ICI005C.                                                03610000
035500 EJECT                                                            03620000
035600     EXEC SQL                                                     03630000
035700         INCLUDE TMRISFL                                          03640000
035800     END-EXEC.                                                    03650000
035900 EJECT                                                            03660000
036000     EXEC SQL                                                     03670000
036100         INCLUDE TENTNME                                          03680000
036200     END-EXEC.                                                    03690000
036300 EJECT                                                            03700000
036400     EXEC SQL                                                     03710000
036500         INCLUDE TSKSTOO                                          03720000
036600     END-EXEC.                                                    03730000
036700 EJECT                                                            03740000
036800     EXEC SQL                                                     03790000
036900         INCLUDE XMT00001                                         03800000
037000     END-EXEC.                                                    03810000
037100 EJECT                                                            03820000
037200     EXEC SQL                                                     03830000
037300         INCLUDE TVNDDPT                                          03840000
037400     END-EXEC.                                                    03850000
037500 EJECT                                                            03860000
037600     EXEC SQL                                                     03870000
037700         INCLUDE TSKSTWKS                                         03880000
037800     END-EXEC.                                                    03890000
037900 EJECT                                                            03900000
038000     EXEC SQL                                                     03910000
038100         INCLUDE TSKST                                            03920000
038200     END-EXEC.                                                    03930000
038300 EJECT                                                            03940000
038400     EXEC SQL                                                     03950000
038500         INCLUDE TMRITST                                          03960000
038600     END-EXEC.                                                    03970000
038700 EJECT                                                            03980000
038800     EXEC SQL                                                     03990000
038900         INCLUDE TUPCSKU                                          04000000
039000     END-EXEC.                                                    04010000
039100 EJECT                                                            04020000
039200     EXEC SQL                                                     04030000
039300         INCLUDE TRSPBAR                                          04040000
039400     END-EXEC.                                                    04050000
039500 EJECT                                                            04060000
039600     EXEC SQL                                                     04070000
039700         INCLUDE TMDSEAR                                          04080000
039800     END-EXEC.                                                    04090000
039900 EJECT                                                            04100000
040000* DB2 COMMUNICATION AREA                                          04110000
040100*                                                                 04120000
040200     EXEC SQL                                                     04130000
040300         INCLUDE SQLCA                                            04140000
040400     END-EXEC.                                                    04150000
040500 EJECT                                                            04160000
040600* DB2 COMMUNICATION AREA2                                         04170000
040700*                                                                 04180000
040800     COPY SQLCA2.                                                 04190000
040900 EJECT                                                            04200000
041000*                                                                 04210000
041100*                                                                 04220000
041200 LINKAGE SECTION.                                                 04230000
041300*** DATABASE PCB AREA ***                                         04240000
041400*                                                                 04250000
041500*** DEBIT MASTER DATABASE                                         04260000
041600*                                                                 04270000
041700***************************************************************** 04280000
041800*PROCEDURE DIVISION.                                              04290000
041900***************************************************************** 04300000
042000 PROCEDURE DIVISION.                                              04310000
042100*                                                                 04320000
042200 A000-MAINLINE-PROCESSING.                                        04330000
042300*                                                                 04340000
042400     PERFORM A100-INITIALIZATION.                                 04350000
042500*                                                                 04360000
042600     PERFORM B000-PROCESS-SYSTEM-RECORD                           04370000
042700             UNTIL EOF-TRANS-REC.                                 04380000
042800*                                                                 04390000
042900     PERFORM Y100-END-ROUTINE.                                    04400000
043000*                                                                 04410000
043100     GOBACK.                                                      04420000
043200*                                                                 04430000
043300 EJECT                                                            04440000
043400******************************************************************04450000
043500** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 04460000
043600** CALL CALENDAR ROUTINES TO RETRIEVE VALUES NEEDED IN PROGRAM    04470000
043700******************************************************************04480000
043800 A100-INITIALIZATION.                                             04490000
043900*                                                                 04500000
044000*    DISPLAY 'A100-INITIALIZATION'.                               04510000
044100*                                                                 04520000
044200     OPEN  INPUT IC-CONTROL-FILE                                  04530000
044300           INPUT BIM-FILE                                         04540000
044400           INPUT TRANSFER-RECORD-IN                               04550000
                 INPUT CONTROL-CARD-FILE                                04560000
044500          OUTPUT TRANSFER-RECORD.                                 04570000
044600*                                                                 04580000
044700     IF  PV-CONTROL-SUCCESSFUL OR                                 04590000
044800         PV-CONTROL-VERIFY                                        04600000
044900        CONTINUE                                                  04610000
045000     ELSE                                                         04620000
045100        MOVE 'A100-INITIALIATION' TO PV-PARAGRAPH-NAME            04630000
045200        MOVE 'IC-CONTROL-FILE'    TO PV-ERROR-FILE                04640000
045300        MOVE 'OPENING INPUT FILE' TO PV-ERROR-OPERATION           04650000
045400        MOVE 'BAD-OPEN'           TO PV-ERROR-STATUS              04660000
045500        MOVE  PV-CONTROL-STATUS   TO PV-VSAM-STATUS               04670000
045600        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             04680000
045700        PERFORM Z999-VSAM-ERROR                                   04690000
045800        MOVE +4005                TO PV-ABEND-CODE                04700000
045900        CALL 'ILBOABN0'        USING PV-ABEND-CODE                04710000
046000     END-IF.                                                      04720000
046100*                                                                 04730000
046200     IF  PV-BIM-SUCCESSFUL OR                                     04740000
046300         PV-BIM-VERIFY                                            04750000
046400        CONTINUE                                                  04760000
046500     ELSE                                                         04770000
046600        MOVE 'A100-INITIALIATION' TO PV-PARAGRAPH-NAME            04780000
046700        MOVE 'BIM-FILE'           TO PV-ERROR-FILE                04790000
046800        MOVE 'OPENING INPUT FILE' TO PV-ERROR-OPERATION           04800000
046900        MOVE 'BAD-OPEN'           TO PV-ERROR-STATUS              04810000
047000        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               04820000
047100        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             04830000
047200        PERFORM Z999-VSAM-ERROR                                   04840000
047300        MOVE +4005                TO PV-ABEND-CODE                04850000
047400        CALL 'ILBOABN0'        USING PV-ABEND-CODE                04860000
047500     END-IF.                                                      04870000
047600*                                                                 04880000
047700     ACCEPT PARAMETER-INPUT-RECORD.                               04890000
047800*                                                                 04900000
           READ CONTROL-CARD-FILE INTO PV-CONTROL-CARD                  04901000
              AT END                                                    04902000
                 DISPLAY '** ABEND ** IN PROGRAM MRKUT151 '             04902100
                 DISPLAY 'MRKUT151 - EMPTY CONTROL CARD'                04902200
                 MOVE +4003                  TO PV-ABEND-CODE           04902300
                 MOVE 'A100-INITIALIZATION'  TO PV-PARAGRAPH-NAME       04902400
                 MOVE 'READING CONTROL CARD' TO PV-ERROR-OPERATION      04902500
                 CALL 'ILBOABN0' USING PV-ABEND-CODE.                   04902600
           DISPLAY 'INPUT WEEK NUMBER = ' PV-MINUS-WK.                  04902704
047900*  ##Y2K                                                          04902800
048000                                                                  04902900
048100     ACCEPT DPG51-SYSTEM-DATE-N FROM DATE.                        04903000
048200     MOVE DPG51-SYSTEM-DATE-YR TO PV-CURRENT-DATE-YR              04903100
048300                                  PC-YR.                          04904000
048400     MOVE DPG51-SYSTEM-DATE-MO TO PV-CURRENT-DATE-MO              04905000
048500                                  PC-MO.                          04906000
048600     MOVE DPG51-SYSTEM-DATE-DY TO PV-CURRENT-DATE-DY              04907000
048700                                  PC-DY.                          04908000
048800*    DISPLAY 'PC-DATE: ' PC-DATE.                                 04909000
048900     MOVE PC-DATE TO DPG52-LK-DATE-INPUT.                         04910000
049000                                                                  04920000
049100* ***********GET FIRST FISCAL DATE FROM SYSTEM DATE **********    04930000
049200* *                                                               04940000
049300     MOVE SPACES              TO DPG51-INCREMENT-DECREMENT-FLAG.  04950000
049400     MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             04960000
049500     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           04970000
049600     PERFORM I000-CALENDAR-ROUTINE.                               04980000
049700     MOVE DPG56-FIRST-FD-GREG-FMT TO PV-TODAYS-DATE.              04990000
049800     MOVE DPG56-FISCAL-WEEK-NBR TO PV-TODAYS-WEEK.                05000000
049900*                                                                 05010000
050000     IF DPG51-SYSTEM-DATE-YR > 80                                 05020000
050100         MOVE PC-19           TO PV-CURRENT-DATE-CC               05030000
050200     ELSE                                                         05040000
050300         MOVE PC-20           TO PV-CURRENT-DATE-CC               05050000
050400     END-IF.                                                      05060000
050500*                                                                 05070000
050600     MOVE MR001I-S-SYS-ID   TO  S-SYS-ID.                         05080000
050700     MOVE PC-RCD-TYPE       TO  S-RCD-TYPE.                       05090000
050800     MOVE LOW-VALUES        TO  S-RCD-ID.                         05100000
050900     MOVE S-KEY             TO  ICCTL-KEY.                        05110000
051000     PERFORM R000-READ-CONTROL-FILE.                              05120000
051100*                                                                 05130000
051200     PERFORM T150-DATE-ROUTINE.                                   05140000
063400     MOVE PC-2 TO PV-BPN-SUB.                                     05150000
063500     PERFORM T155-UCYCLE-CALENDAR-ROUTINE.                        05160000
063600     MOVE PV-UCYCLE-MAX-DATE TO PV-UCYCLE5-MAX-DATE.              05170000
063700     MOVE PV-UCYCLE-MIN-DATE TO PV-UCYCLE5-MIN-DATE.              05180000
063400     MOVE PC-1 TO PV-BPN-SUB.                                     05190000
063500     PERFORM T155-UCYCLE-CALENDAR-ROUTINE.                        05200000
063600     MOVE PV-UCYCLE-MAX-DATE TO PV-UCYCLE9-MAX-DATE.              05210000
063700     MOVE PV-UCYCLE-MIN-DATE TO PV-UCYCLE9-MIN-DATE.              05220000
051300**************************************************************    05230000
051400**   THIS LOGIC IS OBSOLETE SINCE THE NEW PV-MIN-BOW-DATE AND     05240000
051500**   PV-MAX-BOW-DATE FIELDS ARE FILLED IN THE T150- ROUTINE.      05250000
051600**                                                                05260000
051700**   COMPUTE PV-MAX-WEEK-N =                                      05270000
051800**       (PV-MIN-WEEK-N + PV-F4-NBR-FISCAL-PERIOD-WKS) - 1.       05280000
051900***********************************************************       05290000
052000****   THIS IF STATEMENT CAN NEVER BE TRUE  ***************       05300000
052100**   IF PV-MAX-WEEK-N < 1                                         05310000
052200**       ADD PV-F4-NBR-FISCAL-WEEKS TO PV-MAX-WEEK-N              05320000
052300**       SUBTRACT 1                       FROM PV-MAX-YR          05330000
052400**   END-IF.                                                      05340000
052500***********************************************************       05350000
052600**   MOVE PV-MIN-WEEK               TO PV-MIN-WK.                 05360000
052700**   MOVE PV-MAX-WEEK               TO PV-MAX-WK.                 05370000
052800**                                                                05380000
052900     PERFORM R200-READ-TRANS-REC-IN.                              05390000
053000     IF EOF-TRANS-REC                                             05400000
053100         MOVE PC-Y             TO PS-NO-INPUT                     05410000
053200     ELSE                                                         05420000
053300         INITIALIZE PV-OUTPUT                                     05430000
053400         PERFORM D100-MOVE-TRANS-DATA                             05440000
053500         MOVE MR017-TR-SORT-FIELDS TO PV-PREV-FIELDS              05450000
053600*                                                                 05460000
053700         MOVE MR017-DEPT-NBR   TO VNDDPT-DEPT-NBR                 05470000
053800         MOVE MR017-VEND-NBR   TO VNDDPT-INHOUSE-NBR              05480000
053900         PERFORM T700-SELECT-VENDOR-NAME                          05490000
054000*                                                                 05500000
054100         MOVE MR017-DEPT-NBR   TO MDSEAR-DEPT-NBR                 05510000
054200         MOVE PC-DPT           TO MDSEAR-MDSELV-CDE               05520000
054300         PERFORM T800-SELECT-MDSEAR-DKEY                          05530000
054400         MOVE MDSEAR-DKEY      TO RSPBAR-MDSEAR-DKEY              05540000
054500         MOVE PC-BYR           TO RSPBAR-RSPLVL-CDE               05550000
054600         PERFORM T900-SELECT-BUYER-NAME                           05560000
054700*                                                                 05570000
054800         PERFORM T300-SELECT-PO-RECORD                            05580000
054900         PERFORM T000-SELECT-UPC-NUMBER                           05590000
055000         PERFORM C000-FORMAT-TRANSFER-REC                         05600000
055100     END-IF.                                                      05610000
055200*                                                                 05620000
055300 EJECT                                                            05630000
055400******************************************************************05640000
055500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *05650000
055600*  SYSTEM RECORD.                                                *05660000
055700******************************************************************05670000
055800 B000-PROCESS-SYSTEM-RECORD.                                      05680000
055900*                                                                 05690000
056000*    DISPLAY 'B000-PROCESS-SYSTEM-RECORD'.                        05700000
056100*    DISPLAY ' CR DEPT:' MR017-DEPT-NBR 'PV DEPT:' PV-PREV-DEPT.  05710000
056200*    DISPLAY ' CR SKU:' MR017-SORT-SKU 'PV SKU:' PV-PREV-SKU.     05720000
056300*    DISPLAY ' CR STR:' MR017-STR-NBR 'PV STR:' PV-PREV-STORE.    05730000
056400*    DISPLAY ' CR WK:' MR017-WEEK-NBR 'PV WK:' PV-PREV-WEEK-NBR.  05740000
056500*                                                                 05750000
056600       IF MR017-DEPT-NBR = PV-PREV-DEPT                           05760000
056700         IF MR017-SORT-SKU = PV-PREV-SORT-SKU                     05770000
056800           IF MR017-STR-NBR = PV-PREV-STORE                       05780000
056900             PERFORM C100-ACCUM-FE-DETAIL                         05790000
057000           ELSE                                                   05800000
057100             PERFORM W000-WRITE-OUTPUT                            05810000
057200             PERFORM D100-MOVE-TRANS-DATA                         05820000
057300             PERFORM T300-SELECT-PO-RECORD                        05830000
057400             PERFORM C000-FORMAT-TRANSFER-REC                     05840000
057500           END-IF                                                 05850000
057600         ELSE                                                     05860000
057700                                                                  05870000
057800           PERFORM W000-WRITE-OUTPUT                              05880000
057900           PERFORM D100-MOVE-TRANS-DATA                           05890000
058000           MOVE MR017-DEPT-NBR       TO VNDDPT-DEPT-NBR           05900000
058100           MOVE MR017-VEND-NBR       TO VNDDPT-INHOUSE-NBR        05910000
058200*                                                                 05920000
058300           PERFORM T700-SELECT-VENDOR-NAME                        05930000
058400           PERFORM T000-SELECT-UPC-NUMBER                         05940000
058500           PERFORM T300-SELECT-PO-RECORD                          05950000
058600           PERFORM C000-FORMAT-TRANSFER-REC                       05960000
058700         END-IF                                                   05970000
058800       ELSE                                                       05980000
058900         PERFORM W000-WRITE-OUTPUT                                05990000
059000         PERFORM D100-MOVE-TRANS-DATA                             06000000
059100*                                                                 06010000
059200         MOVE MR017-DEPT-NBR       TO VNDDPT-DEPT-NBR             06020000
059300         MOVE MR017-VEND-NBR       TO VNDDPT-INHOUSE-NBR          06030000
059400         PERFORM T700-SELECT-VENDOR-NAME                          06040000
059500*                                                                 06050000
059600         MOVE MR017-DEPT-NBR       TO MDSEAR-DEPT-NBR             06060000
059700         MOVE PC-DPT               TO MDSEAR-MDSELV-CDE           06070000
059800         PERFORM T800-SELECT-MDSEAR-DKEY                          06080000
059900         MOVE MDSEAR-DKEY          TO RSPBAR-MDSEAR-DKEY          06090000
060000         MOVE PC-BYR               TO RSPBAR-RSPLVL-CDE           06100000
060100         PERFORM T900-SELECT-BUYER-NAME                           06110000
060200*                                                                 06120000
060300         PERFORM T000-SELECT-UPC-NUMBER                           06130000
060400         PERFORM T300-SELECT-PO-RECORD                            06140000
060500         PERFORM C000-FORMAT-TRANSFER-REC                         06150000
060600       END-IF.                                                    06160000
060700*                                                                 06170000
060800       MOVE MR017-TR-SORT-FIELDS TO PV-PREV-FIELDS.               06180000
060900       PERFORM R200-READ-TRANS-REC-IN.                            06190000
061000*                                                                 06200000
061100 EJECT                                                            06210000
061200******************************************************************06220000
061300*  MOVE VALUES TO OUTPUT FOR A REPLENISHMENT RUN(TYPE-CD = 1)    *06230000
061400******************************************************************06240000
061500 C000-FORMAT-TRANSFER-REC.                                        06250000
061600*                                                                 06260000
061700     PERFORM T100-SELECT-ONHAND-QTY.                              06270000
061800*                                                                 06280000
061900*    DISPLAY ' C000-FORMAT-TRANSFER-REC.'                         06290000
062000*    DISPLAY '  UCYCLE ' MR017-UCYCLE.                            06300000
062100*    DISPLAY 'PV-MAX-BOW-DATE ' PV-MAX-BOW-DATE.                  06310000
062200*    DISPLAY 'PV-MIN-BOW-DATE ' PV-MIN-BOW-DATE.                  06320000
062300*    DISPLAY 'PV-UCYCLE-MAX-DATE ' PV-UCYCLE-MAX-DATE.            06330000
062400*    DISPLAY 'PV-UCYCLE-MIN-DATE ' PV-UCYCLE-MIN-DATE.            06340000
062500                                                                  06350000
062600     IF MR017-UCYCLE = S-UCYCLE (3) AND                           06360000
062700       MR017-UCYCLE = PC-4                                        06370000
062800         MOVE PV-MAX-BOW-DATE TO PV-TSKSTWKS-MAX-DTE              06380000
062900         MOVE PV-MIN-BOW-DATE TO PV-TSKSTWKS-MIN-DTE              06390000
063000         PERFORM S600-SUM-CPS-QTY                                 06400000
063100     ELSE                                                         06410000
063200         IF MR017-UCYCLE = S-UCYCLE (2) AND                       06420000
063300           MR017-UCYCLE = PC-5                                    06430000
063400             MOVE PC-2                TO PV-BPN-SUB               06440000
063600             MOVE PV-UCYCLE5-MAX-DATE TO PV-TSKSTWKS-MAX-DTE      06450000
063700             MOVE PV-UCYCLE5-MIN-DATE TO PV-TSKSTWKS-MIN-DTE      06460000
063800             PERFORM S600-SUM-CPS-QTY                             06470000
063900         ELSE                                                     06480000
064000             MOVE PC-1                TO PV-BPN-SUB               06490000
064200             MOVE PV-UCYCLE9-MAX-DATE TO PV-TSKSTWKS-MAX-DTE      06500000
064300             MOVE PV-UCYCLE9-MIN-DATE TO PV-TSKSTWKS-MIN-DTE      06510000
064400             PERFORM S600-SUM-CPS-QTY                             06520000
064500         END-IF                                                   06530000
064600     END-IF.                                                      06540000
064700     MOVE SKSTWKS-SALES-UNIT-QTY TO PV-CPS-QTY.                   06550000
064800*                                                                 06560000
064900*    LOAD VALUES FROM THE TMRISHS TABLE                           06570000
065000*    TO HISTCPS, HISTOH, HISTDD, HISTMAD.                         06580000
065100*                                                                 06590000
065200     MOVE PC-1                TO PV-HIST-SUB.                     06600000
065300*                                                                 06610000
065400     PERFORM E000-LOAD-REPL-HIST                                  06620000
065500             VARYING PV-HIST-SUB                                  06630000
065600             FROM 1 BY 1                                          06640000
065700             UNTIL PV-HIST-SUB > PC-13.                           06650000
065800*                                                                 06660000
065900*    LOAD ZEROES TO HISTLYS                                       06670000
066000*                                                                 06680000
066100     MOVE PC-1 TO PV-HIST-SUB.                                    06690000
066200     PERFORM E300-LOAD-HISTLYS-QTY                                06700000
066300             UNTIL PV-HIST-SUB > PC-17.                           06710000
066400*                                                                 06720000
066500     MOVE MR017-PTAG     TO GBI-KEY-PTAG.                         06730000
066600     MOVE MR017-PTAG     TO BIM-FILE-KEY.                         06740000
066700     PERFORM R100-READ-BIM-FILE.                                  06750000
066800*                                                                 06760000
066900     PERFORM F000-FORMAT-TRAN-INPUT.                              06770000
067000*                                                                 06780000
067100     PERFORM H000-FORMAT-ROH-USER-AREA.                           06790000
067200*                                                                 06800000
067300*                                                                 06810000
067400******************************************************************06820000
067500*   ACCUMULATE MRISFE DETAIL                                      06830000
067600******************************************************************06840000
067700 C100-ACCUM-FE-DETAIL.                                            06850000
067800*                                                                 06860000
067900*    DISPLAY 'C100-ACCUM-FE-DETAIL'.                              06870000
068000*                                                                 06880000
068100     EVALUATE TRUE                                                06890000
068200     WHEN MR017-WEEK-NBR = PC-1P                                  06900000
068300      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(1)                    06910000
068400      MOVE MR017-FWM-QTY     TO MR004O-FWM(1)                     06920000
068500     WHEN MR017-WEEK-NBR = PC-2P                                  06930000
068600      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(2)                    06940000
068700      MOVE MR017-FWM-QTY     TO MR004O-FWM(2)                     06950000
068800     WHEN MR017-WEEK-NBR = PC-3P                                  06960000
068900      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(3)                    06970000
069000      MOVE MR017-FWM-QTY     TO MR004O-FWM(3)                     06980000
069100     WHEN MR017-WEEK-NBR = PC-4P                                  06990000
069200      MOVE MR017-LFWM-QTY    TO MR004O-LFWM(4)                    07000000
069300      MOVE MR017-FWM-QTY     TO MR004O-FWM(4)                     07010000
069400     WHEN OTHER                                                   07020000
069500         CONTINUE                                                 07030000
069600     END-EVALUATE.                                                07040000
069700*                                                                 07050000
069800******************************************************************07060000
069900*   ACCUMULATE MRISFE DETAIL                                      07070000
070000******************************************************************07080000
070100 D100-MOVE-TRANS-DATA.                                            07090000
070200*                                                                 07100000
070300*    DISPLAY 'D100-MOVE-TRANS-DATA'.                              07110000
070400*                                                                 07120000
070500     MOVE MR017-UCYCLE           TO MR004O-UCYCLE.                07130000
070600     MOVE MR017-WN               TO MR004O-WN.                    07140000
070700     MOVE MR017-DN               TO MR004O-DN.                    07150000
070800     MOVE MR017-CADL             TO MR004O-CADL.                  07160000
070900*WR20601 FIX   PUT CODE BACK THAT WAS DELETED.  START             07170000
071000     MOVE MR017-IDFL             TO MR004O-IDFL.                  07180000
071100     MOVE MR017-HIDFL            TO MR004O-HIDFL.                 07190000
071200     MOVE MR017-LODFL            TO MR004O-LODFL.                 07200000
071300     MOVE MR017-NDFL             TO MR004O-NDFL.                  07210000
071400     MOVE MR017-MINSMK           TO MR004O-MINSMK.                07220000
071500     MOVE MR017-MAXSMK           TO MR004O-MAXSMK.                07230000
071600     MOVE MR017-DAMP             TO MR004O-DAMP.                  07240000
071700     MOVE MR017-TSL              TO MR004O-TSL.                   07250000
071800*WR20601 FIX   PUT CODE BACK THAT WAS DELETED.  END               07260000
071900     MOVE MR017-BYPDDU           TO MR004O-BYPDDU.                07270000
072000     MOVE MR017-BYPSCL           TO MR004O-BYPSCL.                07280000
072100     MOVE MR017-FRCDDU           TO MR004O-FRCDDU.                07290000
072200     MOVE MR017-BYPZSL           TO MR004O-BYPZSL.                07300000
072300     MOVE MR017-BYPTFP           TO MR004O-BYPTFP.                07310000
072400     MOVE MR017-BYPZOH           TO MR004O-BYPZOH.                07320000
072500     MOVE MR017-BYPBEF           TO MR004O-BYPBEF.                07330000
072600     MOVE MR017-BYPAFT           TO MR004O-BYPAFT.                07340000
072700     MOVE MR017-LUMPSW           TO MR004O-LUMPSW.                07350000
072800     MOVE MR017-MINBI            TO MR004O-MINBI.                 07360000
072900     MOVE MR017-DDFTSW           TO MR004O-DDFTSW.                07370000
073000     MOVE MR017-HIPCT            TO MR004O-HIPCT.                 07380000
073100     MOVE MR017-LOPCT            TO MR004O-LOPCT.                 07390000
073200     MOVE MR017-MINDD            TO MR004O-MINDD.                 07400000
073300     MOVE MR017-HIMADP           TO MR004O-HIMADP.                07410000
073400     MOVE MR017-LOMADP           TO MR004O-LOMADP.                07420000
073500     MOVE MR017-RT               TO MR004O-RT.                    07430000
073600     MOVE MR017-RTF              TO MR004O-RTF.                   07440000
073700     MOVE MR017-ZOPSW            TO MR004O-ZOPSW.                 07450000
073800     MOVE MR017-OUTLSW           TO MR004O-OUTLSW.                07460000
073900     MOVE MR017-ZSSTOCK          TO MR004O-ZSSTOCK.               07470000
074000     MOVE MR017-PACKSW           TO MR004O-PACKSW.                07480000
074100     MOVE MR017-DSER             TO MR004O-DSER.                  07490000
074200     MOVE MR017-PTAG             TO MR004O-PTAG.                  07500000
074300     MOVE MR017-LT               TO MR004O-LT.                    07510000
074400     MOVE MR017-ICOST            TO MR004O-ICOST.                 07520000
074500     MOVE MR017-OO               TO MR004O-OO.                    07530000
074600     MOVE MR017-COMSTK           TO MR004O-COMSTK.                07540000
074700     MOVE MR017-SPOQSW           TO MR004O-SPOQSW.                07550000
074800     MOVE MR017-SPOQ             TO MR004O-SPOQ.                  07560000
074900     MOVE MR017-INAME            TO MR004O-INAME.                 07570000
075000     MOVE MR017-DEPT-NBR         TO MR004O-H-DEPT.                07580000
075100     MOVE MR017-CLASS-NBR        TO MR004O-H-CLASS.               07590000
075200     MOVE MR017-SKU              TO MR004O-SKU.                   07600000
075300     MOVE MR017-UPC              TO MR004O-UPC.                   07610000
075400     MOVE MR017-FT               TO MR004O-FT.                    07620000
075500     MOVE MR017-OSTRAT           TO MR004O-OSTRAT.                07630000
075600     MOVE MR017-PACKSZ           TO MR004O-PACKSZ.                07640000
075700     MOVE MR017-IMIN             TO MR004O-IMIN.                  07650000
075800     MOVE MR017-IMAX             TO MR004O-IMAX.                  07660000
075900     MOVE MR017-CSTOCK           TO MR004O-CSTOCK.                07670000
076000     MOVE MR017-SSADJ            TO MR004O-SSADJ.                 07680000
076100     MOVE MR017-MINOUTL          TO MR004O-MINOUTL.               07690000
076200     MOVE MR017-MAXOUTL          TO MR004O-MAXOUTL.               07700000
076300     MOVE MR017-MAXOQP           TO MR004O-MAXOQP.                07710000
076400     MOVE MR017-FOQ              TO MR004O-FOQ.                   07720000
076500     MOVE MR017-TMIN             TO MR004O-TMIN.                  07730000
076600     MOVE MR017-USERMIN          TO MR004O-USERMIN.               07740000
076700     MOVE MR017-USERMAX          TO MR004O-USERMAX.               07750000
076800     MOVE MR017-DD               TO MR004O-DD.                    07760000
076900     MOVE MR017-DDI              TO MR004O-DDI.                   07770000
077000     MOVE MR017-LPP              TO MR004O-LPP.                   07780000
077100     MOVE MR017-MADSS            TO MR004O-MADSS.                 07790000
077200     MOVE MR017-FWMAD            TO MR004O-FWMAD.                 07800000
077300     MOVE MR017-TRNDP            TO MR004O-TRNDP.                 07810000
077400     MOVE MR017-MSDTS            TO MR004O-MSDTS.                 07820000
077500     MOVE MR017-MADTS            TO MR004O-MADTS.                 07830000
077600     MOVE MR017-LTVFACT          TO MR004O-LTVFACT.               07840000
077700     MOVE MR017-PCTZ             TO MR004O-PCTZ.                  07850000
077800     MOVE MR017-MADSTAT          TO MR004O-MADSTAT.               07860000
077900     MOVE MR017-DFLREG           TO MR004O-DFLREG.                07870000
078000     MOVE MR017-TSREG            TO MR004O-TSREG.                 07880000
078100     MOVE MR017-DIREG            TO MR004O-DIREG.                 07890000
078200     MOVE MR017-BYPREG           TO MR004O-BYPREG.                07900000
078300     MOVE MR017-LDD              TO MR004O-LDD.                   07910000
078400     MOVE MR017-LDDI             TO MR004O-LDDI.                  07920000
078500     MOVE MR017-LMADSS           TO MR004O-LMADSS.                07930000
078600     MOVE MR017-OUTSTAT          TO MR004O-OUTSTAT.               07940000
078700     MOVE MR017-LRTFCST          TO MR004O-LRTFCST.               07950000
078800     MOVE MR017-ORDSTAT          TO MR004O-ORDSTAT.               07960000
078900     MOVE MR017-DDUPRM           TO MR004O-DDUPRM.                07970000
079000     PERFORM D200-MOVE-CST-MIN-MAX                                07980000
079100        VARYING PV-CST-SUB                                        07990000
079200        FROM 1 BY 1                                               08000000
079300        UNTIL  PV-CST-SUB > PC-6.                                 08010000
079400                                                                  08020000
079500     MOVE MR017-FTJOPF           TO MR004O-FTJOPF.                08030000
079600     MOVE MR017-COST-UNIT-MSMT   TO MR004O-COST-UNIT-MSMT.        08040000
079700     MOVE MR017-RTL-UNIT-MSMT    TO MR004O-RTL-UNIT-MSMT.         08050000
079800     MOVE MR017-CUR-UNIT-RTL-AMT TO MR004O-CUR-UNIT-RTL-AMT.      08060000
079900     MOVE MR017-GR-RTL-AMT       TO MR004O-GR-RTL-AMT.            08070000
080000     MOVE MR017-GR-QTY           TO MR004O-GR-QTY.                08080000
080100     MOVE MR017-MERCH-DIV-CODE   TO MR004O-MERCH-DIV-CODE.        08090000
080200     MOVE MR017-DMM-NBR          TO MR004O-DMM-NBR.               08100000
080300     MOVE SPACES                 TO MR004O-SEQ-NBR.               08110000
080400*                                                                 08120000
080500******************************************************************08130000
080600 D200-MOVE-CST-MIN-MAX.                                           08140000
080700*                                                                 08150000
080800*    DISPLAY 'D200-MOVE-CST-MIN-MAX'.                             08160000
080900*                                                                 08170000
081000     MOVE MR017-CSTKMINT (PV-CST-SUB)                             08180000
081100                                 TO MR004O-CSTKMINT(PV-CST-SUB).  08190000
081200     MOVE MR017-CSTKMAXT (PV-CST-SUB)                             08200000
081300                                 TO MR004O-CSTKMAXT(PV-CST-SUB).  08210000
081400*                                                                 08220000
081500******************************************************************08230000
081600*  REPLENISHMENT QUANTITY FIELDS : CPS, OH, MAD, & DD.            08240000
081700*-----------------------------------------------------------------08250000
081800*  THERE ARE 13 OCCURANCES AND THE MAKEUP OF THESE SHOULD BE:     08260000
081900*        OCCURANCE 1  - TNOW-WN - 1                               08270000
082000*        OCCURANCE 2  - TNOW-WN - 2                               08280000
082100*        OCCURANCE 3  - TNOW-WN - 3                               08290000
082200*        OCCURANCE 4  - TNOW-WN - 4                               08300000
082300*        OCCURANCE 5  - TNOW-WN - 5                               08310000
082400*        OCCURANCE 6  - TNOW-WN - 6                               08320000
082500*        OCCURANCE 7  - TNOW-WN - 7                               08330000
082600*        OCCURANCE 8  - TNOW-WN - 8                               08340000
082700*        OCCURANCE 9  - TNOW-WN - 9                               08350000
082800*        OCCURANCE 10 - TNOW-WN - 10                              08360000
082900*        OCCURANCE 11 - TNOW-WN - 11                              08370000
083000*        OCCURANCE 12 - TNOW-WN - 12                              08380000
083100*        OCCURANCE 13 - TNOW-WN - 13                              08390000
083200******************************************************************08400000
083300*                                                                 08410000
083400*                                                                 08420000
083500 E000-LOAD-REPL-HIST.                                             08430000
083600*                                                                 08440000
083700*    DISPLAY 'E000-LOAD-REPL-HIST'.                               08450000
083800*                                                                 08460000
083900         MOVE MR017-HISTBPN(PV-HIST-SUB)                          08470000
084000                               TO  MR004O-HISTBPN(PV-HIST-SUB).   08480000
084100         MOVE MR017-HISTCPS(PV-HIST-SUB)                          08490000
084200                               TO  MR004O-HISTCPS(PV-HIST-SUB).   08500000
084300         MOVE MR017-HISTMAD(PV-HIST-SUB)                          08510000
084400                               TO  MR004O-HISTMAD(PV-HIST-SUB).   08520000
084500         MOVE MR017-HISTOH(PV-HIST-SUB)                           08530000
084600                               TO  MR004O-HISTOH(PV-HIST-SUB).    08540000
084700         MOVE MR017-HISTDD(PV-HIST-SUB)                           08550000
084800                               TO  MR004O-HISTDD(PV-HIST-SUB).    08560000
084900*                                                                 08570000
085000******************************************************************08580000
085100*  LAST YEAR SALES HISTORY QUANTITIES.                            08590000
085200*-----------------------------------------------------------------08600000
085300*  THERE ARE 17 OCCURANCES AND THE MAKEUP OF THESE SHOULD BE:     08610000
085400*        OCCURANCE 1 - TNOW-WN + 2                                08620000
085500*        OCCURANCE 2 - TNOW-WN + 1                                08630000
085600*        OCCURANCE 3 - TNOW-WN                                    08640000
085700*        OCCURANCE 4 - TNOW-WN  OR IF UCYCLE = 4, TOTAL OF WEEKS I08650000
085800*                                  THE PERIOD ( 4 OR 5 WEEKS)     08660000
085900*        OCCURANCE 5 - TNOW-WN - 1                                08670000
086000*        OCCURANCE 6 - TNOW-WN - 2                                08680000
086100*        OCCURANCE 7 - TNOW-WN - 3                                08690000
086200*        OCCURANCE 8 - TNOW-WN - 4                                08700000
086300*        OCCURANCE 9 - TNOW-WN - 5                                08710000
086400*        OCCURANCE 10 - TNOW-WN - 6                               08720000
086500*        OCCURANCE 11 - TNOW-WN - 7                               08730000
086600*        OCCURANCE 12 - TNOW-WN - 8                               08740000
086700*        OCCURANCE 13 - TNOW-WN - 9                               08750000
086800*        OCCURANCE 14 - TNOW-WN - 10                              08760000
086900*        OCCURANCE 15 - TNOW-WN - 11                              08770000
087000*        OCCURANCE 16 - TNOW-WN - 12                              08780000
087100*        OCCURANCE 17 - TNOW-WN - 13                              08790000
087200******************************************************************08800000
087300 E300-LOAD-HISTLYS-QTY.                                           08810000
087400*                                                                 08820000
087500*    DISPLAY 'E300-LOAD-HISTLYS-QTY'.                             08830000
087600*                                                                 08840000
087700        MOVE ZEROES         TO  MR004O-HISTLYS(PV-HIST-SUB).      08850000
087800        ADD PC-1            TO  PV-HIST-SUB.                      08860000
087900*                                                                 08870000
088000*                                                                 08880000
088100******************************************************************08890000
088200*  MOVE VALUES INTO THE TRANSFER-RECORD LAYOUT FOR OUTPUT         08900000
088300******************************************************************08910000
088400 F000-FORMAT-TRAN-INPUT.                                          08920000
088500*                                                                 08930000
088600*    DISPLAY 'F000-FORMAT-TRAN-INPUT'.                            08940000
088700*                                                                 08950000
088800*                                                                 08960000
088900     MOVE PC-1                        TO PV-BIM-SUB,              08970000
089000                                         PV-WBI-SUB,              08980000
089100                                         PV-MBI-SUB,              08990000
089200                                         PV-BIM-SUB2.             09000000
089300     PERFORM F100-MOVE-BIM-AMOUNTS VARYING PV-BIM-SUB             09010000
089400             FROM 1 BY 1 UNTIL PV-BIM-SUB > PC-52.                09020000
089500     PERFORM F200-MOVE-MTHLY-BIM   VARYING PV-BIM-SUB2            09030000
089600             FROM 1 BY 1 UNTIL PV-BIM-SUB2 > PC-13.               09040000
089700     MOVE PV-CPS-QTY                  TO MR004O-CPS.              09050000
089800     MOVE TSKST-ONHAND-QTY            TO MR004O-OH.               09060000
089900     MOVE PV-OO                       TO MR004O-OO.               09070000
090000*                                                                 09080000
090100     MOVE TUPCSKU-UPC-NBR             TO MR004O-UPC.              09090000
090200*                                                                 09100000
090300******************************************************************09110000
090400*  MOVE WEEKLY AMOUNTS FROM THE BIM FILE TO THE TRANSFER RECORD   09120000
090500******************************************************************09130000
090600 F100-MOVE-BIM-AMOUNTS.                                           09140000
090700*                                                                 09150000
090800*    DISPLAY 'F100-MOVE-BIM-AMOUNTS'.                             09160000
090900*                                                                 09170000
091000     MOVE GBI-BI-WEEK(PV-BIM-SUB)     TO MR004O-WBI(PV-WBI-SUB).  09180000
091100*                                                                 09190000
091200     ADD PC-PLUS-1                    TO PV-WBI-SUB.              09200000
091300*                                                                 09210000
091400******************************************************************09220000
091500*  MOVE MONTHLY AMOUNTS FROM THE BIM FILE TO THE TRANSFER RECORD  09230000
091600******************************************************************09240000
091700 F200-MOVE-MTHLY-BIM.                                             09250000
091800*                                                                 09260000
091900*    DISPLAY 'F100-MOVE-MTHLY-BIM  '.                             09270000
092000*                                                                 09280000
092100     MOVE GBI-BI-MNTH(PV-BIM-SUB2)    TO MR004O-MBI(PV-MBI-SUB).  09290000
092200*                                                                 09300000
092300     ADD PC-PLUS-1                    TO PV-MBI-SUB.              09310000
092400*                                                                 09320000
092500*                                                                 09330000
092600******************************************************************09340000
092700*   MOVE APPROPRIATE FIELDS TO THE HEADER USER AREA FOR OUTPUT    09350000
092800******************************************************************09360000
092900 H000-FORMAT-ROH-USER-AREA.                                       09370000
093000*                                                                 09380000
093100*    DISPLAY 'H000-FORMAT-ROH-USER-AREA'.                         09390000
093200*                                                                 09400000
093300*    MOVE DMIVDRNM                    TO MR004O-H-VENDOR-NAME.    09410000
093400     MOVE ENTNME-ENT-NAME-DESC        TO MR004O-H-VENDOR-NAME.    09420000
093500     MOVE MDSEAR-BYR-NBR              TO MR004O-H-BUYER-ID.       09430000
093600     MOVE PV-BYR-NAME                 TO MR004O-H-BUYER-NAME.     09440000
093700*                                                                 09450000
093800******************************************************************09460000
093900*  THIS PARAGRAPH CALLS THE CALENDAR ROUTINE                      09470000
094000******************************************************************09480000
094100 I000-CALENDAR-ROUTINE.                                           09490000
094200*                                                                 09500000
094300*    DISPLAY 'I000-CALENDAR-ROUTINE'.                             09510000
094400*                                                                 09520000
094500     CALL PC-PGM-DPKUT500 USING DPG51 DPG52                       09530000
094600                                DPG53 DPG54                       09540000
094700                                DPG55 DPG56.                      09550000
094800     EVALUATE TRUE                                                09560000
094900     WHEN DPG54-SEVERE-ERROR                                      09570000
095000         DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'               09580000
095100         DISPLAY DPG54-ERROR-MESSAGE                              09590000
095200         DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT              09600000
095300         CALL 'ILBOABN0'        USING PV-ABEND-CODE               09610000
095400     WHEN DPG54-WARNING-ERROR                                     09620000
095500         DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'              09630000
095600         DISPLAY DPG54-ERROR-MESSAGE                              09640000
095700     WHEN DPG54-NO-ERROR                                          09650000
095800         CONTINUE                                                 09660000
095900     END-EVALUATE.                                                09670000
096000*                                                                 09680000
096100******************************************************************09690000
096200* THIS SECTION READS THE VSAM SYSTEM RECORD                      *09700000
096300******************************************************************09710000
096400 R000-READ-CONTROL-FILE.                                          09720000
096500*                                                                 09730000
096600*    DISPLAY 'R000-READ-CONTROL-FILE'.                            09740000
096700*                                                                 09750000
096800      READ IC-CONTROL-FILE INTO  SYSTEM-RECORD                    09760000
096900                                KEY IS ICCTL-KEY.                 09770000
097000*                                                                 09780000
097100     IF  PV-CONTROL-SUCCESSFUL OR                                 09790000
097200         PV-CONTROL-VERIFY                                        09800000
097300*       DISPLAY 'BPN-1: ' S-BPN(1)                                09810000
097400*       DISPLAY 'BPN-2: ' S-BPN(2)                                09820000
097500*       DISPLAY 'BPN-3: ' S-BPN(3)                                09830000
097600*       DISPLAY 'BPN-4: ' S-BPN(4)                                09840000
097700*       DISPLAY 'BPN-5: ' S-BPN(5)                                09850000
097800*       DISPLAY 'BPN-6: ' S-BPN(6)                                09860000
097900        CONTINUE                                                  09870000
098000     ELSE                                                         09880000
098100        MOVE 'R000-READ-CONTROL-FILE' TO PV-PARAGRAPH-NAME        09890000
098200        MOVE 'IC-CONTROL-FILE'        TO PV-ERROR-FILE            09900000
098300        MOVE 'READING INPUT FILE'     TO PV-ERROR-OPERATION       09910000
098400        MOVE 'BAD-READ'               TO PV-ERROR-STATUS          09920000
098500        MOVE  PV-CONTROL-STATUS       TO PV-VSAM-STATUS           09930000
098600        MOVE  ICCTL-KEY               TO PV-NOT-FOUND-KEY         09940000
098700            IF PV-NO-REC-FOUND                                    09950000
098800               PERFORM Z999-VSAM-ERROR                            09960000
098900               MOVE +4002  TO        PV-ABEND-CODE                09970000
099000               CALL 'ILBOABN0' USING PV-ABEND-CODE                09980000
099100            ELSE                                                  09990000
099200               PERFORM Z999-VSAM-ERROR                            10000000
099300               MOVE +4008         TO PV-ABEND-CODE                10010000
099400               CALL 'ILBOABN0' USING PV-ABEND-CODE                10020000
099500            END-IF                                                10030000
099600     END-IF.                                                      10040000
099700*                                                                 10050000
099800     ADD PC-PLUS-1 TO PV-SYSTEM-INPUT-CNT.                        10060000
099900*                                                                 10070000
100000 EJECT                                                            10080000
100100******************************************************************10090000
100200* THIS SECTION READS THE VSAM SYSTEM RECORD                      *10100000
100300******************************************************************10110000
100400 R100-READ-BIM-FILE.                                              10120000
100500*                                                                 10130000
100600*    DISPLAY 'R100-READ-BIM-FILE'.                                10140000
100700*                                                                 10150000
100800     READ BIM-FILE        INTO  PAN-BIM-FILE                      10160000
100900                                KEY IS BIM-FILE-KEY.              10170000
101000*                                                                 10180000
101100     IF  PV-BIM-SUCCESSFUL OR                                     10190000
101200         PV-BIM-VERIFY                                            10200000
101300        CONTINUE                                                  10210000
101400     ELSE                                                         10220000
101500        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               10230000
101600        MOVE  SPACES              TO PV-NOT-FOUND-KEY             10240000
101700            IF PV-NO-REC-FOUND                                    10250000
101800               CONTINUE                                           10260000
101900*              DISPLAY '** MESSAGE IS '                           10270000
102000*              'RECORD NOT FOUND, STATUS IS ' PV-VSAM-STATUS      10280000
102100*              ' BIM KEY: ' GBI-KEY-PTAG                          10290000
102200            ELSE                                                  10300000
102300               MOVE 'R100-READ-BIM-FILE' TO PV-PARAGRAPH-NAME     10310000
102400               MOVE 'BIM-FILE'           TO PV-ERROR-FILE         10320000
102500               MOVE 'READING INPUT FILE' TO PV-ERROR-OPERATION    10330000
102600               MOVE 'BAD-READ'           TO PV-ERROR-STATUS       10340000
102700               MOVE  GBI-KEY-PTAG        TO PV-NOT-FOUND-KEY      10350000
102800               PERFORM Z999-VSAM-ERROR                            10360000
102900               MOVE +4008           TO PV-ABEND-CODE              10370000
103000               CALL 'ILBOABN0'   USING PV-ABEND-CODE              10380000
103100            END-IF                                                10390000
103200     END-IF.                                                      10400000
103300*                                                                 10410000
103400     ADD PC-PLUS-1 TO PV-SYSTEM-INPUT-CNT.                        10420000
103500*                                                                 10430000
103600 EJECT                                                            10440000
103700******************************************************************10450000
103800* THIS SECTION READS THE VSAM SYSTEM RECORD                      *10460000
103900******************************************************************10470000
104000 R200-READ-TRANS-REC-IN.                                          10480000
104100*                                                                 10490000
104200*    DISPLAY 'R200-READ-TRANS-REC-IN'.                            10500000
104300*                                                                 10510000
104400     READ TRANSFER-RECORD-IN INTO  PV-INPUT                       10520000
104500       AT END MOVE PC-Y TO PS-EOF-TRANS-REC.                      10530000
104600*                                                                 10540000
104700     ADD PC-PLUS-1 TO PV-TRANS-INPUT-CNT.                         10550000
104800*                                                                 10560000
104900 EJECT                                                            10570000
105000******************************************************************10580000
105100*  THIS PARAGRAPH SUMS THE CURRENT PERIOD SALES FOR LYS WHEN     *10590000
105200*  THE UCYCLE CODE = 4(MONTHLY)                                  *10600000
105300******************************************************************10610000
105400 S600-SUM-CPS-QTY.                                                10620000
105500*                                                                 10630000
105600*    DISPLAY 'S600-SUM-CPS-QTY'.                                  10640000
105700*                                                                 10650000
105800     MOVE 'S600'                   TO PGM-LOCATION.               10660000
105900     MOVE 'S600-SUM-CPS-QTY        '                              10670000
106000                                   TO PV-ABEND-PARAGRAPH.         10680000
106100                                                                  10690000
106100                                                                  10700000
106200     INITIALIZE SKSTWKS-SALES-UNIT-QTY.                           10710000
106300     MOVE MR017-ITEM-NBR TO SKSTWKS-ITEM-NMBR.                    10720000
106400     MOVE MR017-STR-NBR  TO SKSTWKS-STR-NBR.                      10730000
 06400*    MOVE MR017-STR-NBR  TO PV-9-5                                10740000
106400*    MOVE PV-X-3         TO SKSTWKS-STORE-NMBR.                   10750000
106500*    DISPLAY 'ITEM NBR: ' SKSTWKS-ITEM-NMBR.                      10760000
106600*    DISPLAY 'STORE NBR: ' SKSTWKS-STORE-NMBR.                    10770000
106700*    DISPLAY 'MIN WEEK: ' PV-TSKSTWKS-MIN-DTE.                    10780000
106800*    DISPLAY 'MAX WEEK: ' PV-TSKSTWKS-MAX-DTE.                    10790000
106900                                                                  10800000
107000**     DISPLAY 'MIN DATE: ' PV-TSKSTWKS-MIN-DTE                   10810008
107100**     DISPLAY 'MAX DATE: ' PV-TSKSTWKS-MAX-DTE                   10820008
107200*                                                                 10830000
107300     EXEC SQL                                                     10840000
107400         SELECT SUM(SALES_UNIT_QTY)                               10850000
107500           INTO :SKSTWKS-SALES-UNIT-QTY                           10860000
107600                :PV-NULL-HISTCPS-QTY                              10870000
107700           FROM TSKSTWKS                                          10880000
                    , XMT_LOC                                           10890000
107800          WHERE FSCL_BOW_DTE BETWEEN :PV-TSKSTWKS-MIN-DTE         10900000
107900                               AND  :PV-TSKSTWKS-MAX-DTE          10910000
108000            AND ITEM_NMBR = :SKSTWKS-ITEM-NMBR                    10920000
108100            AND STR_NBR  = LOC_NBR                                10930000
                  AND E_BUS_IND = 'Y'                                   10940000
108200     END-EXEC.                                                    10950000
108300                                                                  10960000
108400     EVALUATE TRUE                                                10970000
108500       WHEN SQLCODE         = ZERO                                10980000
108600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    10990000
                IF PV-NULL-HISTCPS-QTY = -1                             10991009
                   MOVE 0 TO SKSTWKS-SALES-UNIT-QTY                     10992009
                END-IF                                                  10993009
108800       WHEN OTHER                                                 11010000
108900         DISPLAY PV-ABEND-PARAGRAPH                               11020000
109000         PERFORM Z999-SQL-ERROR                                   11030000
109100     END-EVALUATE.                                                11040000
109200*                                                                 11050000
109300******************************************************************11060000
109400* THIS PARAGRAPH SELECTS THE UPC NUMBER FOR OUTPUT               *11070000
109500******************************************************************11080000
109600 T000-SELECT-UPC-NUMBER.                                          11090000
109700*                                                                 11100000
109800*    DISPLAY 'T000-SELECT-UPC-NUMBER'.                            11100100
109900*                                                                 11100200
110000     MOVE 'T000'                   TO PGM-LOCATION.               11100300
110100     MOVE 'T000-SELECT-UPC-NUMBER'                                11100400
110200                                   TO PV-ABEND-PARAGRAPH.         11100500
110300     MOVE MR017-ITEM-NBR TO TUPCSKU-ITEM-NBR.                     11100600
110400     ADD  PC-1           TO PV-ITEM-COUNT.                        11100700
110500     MOVE PC-Y TO TUPCSKU-EDI-ORD-IND                             11100800
110600*                                                                 11100900
110700     EXEC SQL                                                     11101000
110800       SELECT UPC_NBR                                             11102000
110900         INTO :TUPCSKU-UPC-NBR                                    11103000
111000         FROM TUPCSKU                                             11104000
111100        WHERE ITEM_NBR = :TUPCSKU-ITEM-NBR                        11105000
111200          AND EDI_ORD_IND = :TUPCSKU-EDI-ORD-IND                  11106000
111300     END-EXEC.                                                    11107000
111400*                                                                 11108000
111500     EVALUATE TRUE                                                11109000
111600       WHEN SQLCODE         = ZERO                                11110000
111700         CONTINUE                                                 11120000
111800       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    11130000
111900         MOVE ZEROES TO TUPCSKU-UPC-NBR                           11140000
112000       WHEN OTHER                                                 11150000
112100         DISPLAY PV-ABEND-PARAGRAPH                               11160000
112200         DISPLAY 'ITEM NBR: ' TUPCSKU-ITEM-NBR                    11170000
112300         DISPLAY 'UPC NBR: ' TUPCSKU-UPC-NBR                      11180000
112400         PERFORM Z999-SQL-ERROR                                   11190000
112500     END-EVALUATE.                                                11200000
112600*                                                                 11210000
112700 EJECT                                                            11220000
112800******************************************************************11230000
112900*  THIS PARAGRAPH SELECTS THE ON-HAND QUANTITY FOR OUTPUT        *11240000
113000******************************************************************11250000
113100 T100-SELECT-ONHAND-QTY.                                          11260000
113200*                                                                 11270000
113300*    DISPLAY 'T100-SELECT-ONHAND-QTY'.                            11280000
113400*                                                                 11290000
113500     MOVE 'T100'                   TO PGM-LOCATION.               11300000
113600     MOVE 'T100-SELECT-ONHAND-QTY'                                11310000
113700                                   TO PV-ABEND-PARAGRAPH.         11320000
113800     MOVE MR017-ITEM-NBR TO TSKST-ITEM-NMBR.                      11330000
113900     MOVE MR017-STR-NBR  TO TSKST-LOC-NBR                         11340000
114000*                                                                 11350000
114100     IF MR017-STR-NBR EQUAL PC-CORPORATE-STORE                    11360000
114200         PERFORM T110-SUM-ONHAND-QTY                              11370000
114300     ELSE                                                         11380000
114400         PERFORM T120-SELECT-ONHAND-QTY                           11390000
114500     END-IF.                                                      11400000
114600*                                                                 11410000
114700******************************************************************11420000
114800*  THIS PARAGRAPH SUMS THE ON-HAND QUANTITY FOR THE CORPORATE STR*11430000
114900******************************************************************11440000
115000 T110-SUM-ONHAND-QTY.                                             11450000
115100*                                                                 11460000
115200*    DISPLAY 'T110-SUM-ONHAND-QTY'.                               11470000
115300*                                                                 11480000
           MOVE ZEROS                    TO TSKST-ONHAND-QTY.           11481011
115400     MOVE 'T110'                   TO PGM-LOCATION.               11490000
115500     MOVE 'T110-SUM-ONHAND-QTY'                                   11500000
115600                                   TO PV-ABEND-PARAGRAPH.         11510000
115700*                                                                 11520000
115800     EXEC SQL                                                     11530000
115900       SELECT SUM(ONHAND_QTY)                                     11540000
116000         INTO :TSKST-ONHAND-QTY:PV-NULL-SLS-QTY                   11550002
116100         FROM TSKST   A,                                          11560000
116200              TMRITST B                                           11570000
116300        WHERE ITEM_NMBR  = :TSKST-ITEM-NMBR                       11580000
116400          AND A.ITEM_NMBR  = B.ITEM_NBR                           11590000
116500          AND A.LOC_NBR    = B.STR_NBR                            11600000
116600          AND A.LOC_NBR    <>  0                                  11610000
116700          AND A.ONHAND_QTY > 0                                    11620000
116800     END-EXEC.                                                    11630000
116900*                                                                 11640000
117000     EVALUATE TRUE                                                11650000
117100       WHEN SQLCODE         = ZERO                                11660000
117200            IF TSKST-ONHAND-QTY < ZERO                            11670000
117300               MOVE ZERO TO TSKST-ONHAND-QTY                      11680000
117400            END-IF                                                11690000
117500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    11700000
                IF PV-NULL-SLS-QTY = -1                                 11701009
                   MOVE ZERO TO TSKST-ONHAND-QTY                        11702009
                END-IF                                                  11703009
117800       WHEN OTHER                                                 11730000
117900         DISPLAY PV-ABEND-PARAGRAPH                               11740000
118000         PERFORM Z999-SQL-ERROR                                   11750000
118100     END-EVALUATE.                                                11760000
118200*                                                                 11770000
118300******************************************************************11780000
118400*  THIS PARAGRAPH SELECTS THE ON-HAND QUANTITY FOR OUTPUT        *11790000
118500******************************************************************11800000
118600 T120-SELECT-ONHAND-QTY.                                          11810000
118700*                                                                 11820000
118800*    DISPLAY 'T120-SELECT-ONHAND-QTY'.                            11830000
118900*                                                                 11840000
           MOVE ZEROS                    TO TSKST-ONHAND-QTY.           11841011
119000     MOVE 'T120'                   TO PGM-LOCATION.               11850000
119100     MOVE 'T120-SELECT-ONHAND-QTY'                                11860000
119200                                   TO PV-ABEND-PARAGRAPH.         11870000
119300*                                                                 11880000
RONNA *    IF MR017-ITEM-NBR  = 702200000000077                         11881012
RONNA      MOVE MR004O-H-DEPT TO PV-SEPHORA-DEPT                        11881114
RONNA      IF PV-SEPHORA-DEPT-LIST                                      11881214
RONNA          DISPLAY 'DEPT' MR004O-H-DEPT                             11882012
RONNA          EXEC SQL                                                 11883012
RONNA            SELECT SUM(ONHAND_QTY)                                 11884012
RONNA              INTO :TSKST-ONHAND-QTY:PV-NULL-SLS-QTY               11885012
RONNA              FROM TSKST                                           11886012
RONNA                 , XMT_LOC                                         11887012
RONNA              WHERE ITEM_NMBR  = :TSKST-ITEM-NMBR                  11888012
RONNA               AND TSKST.LOC_NBR = XMT_LOC.LOC_NBR                 11889012
RONNA               AND E_BUS_IND = 'Y' AND TSKST.LOC_NBR = 839         11889112
RONNA          END-EXEC                                                 11889212
RONNA      ELSE                                                         11889312
RONNA          EXEC SQL                                                 11890012
RONNA            SELECT SUM(ONHAND_QTY)                                 11900012
RONNA              INTO :TSKST-ONHAND-QTY:PV-NULL-SLS-QTY               11910012
RONNA              FROM TSKST                                           11920012
RONNA                 , XMT_LOC                                         11930012
RONNA             WHERE ITEM_NMBR  = :TSKST-ITEM-NMBR                   11940012
RONNA               AND TSKST.LOC_NBR = XMT_LOC.LOC_NBR                 11950012
RONNA               AND E_BUS_IND = 'Y'                                 11960012
RONNA          END-EXEC                                                 11970012
RONNA      END-IF.                                                      11971012
120100*                                                                 11980000
120200     EVALUATE TRUE                                                11990000
120300       WHEN SQLCODE         = ZERO                                12000000
120400            IF TSKST-ONHAND-QTY < ZERO                            12010000
120500               MOVE ZERO TO TSKST-ONHAND-QTY                      12020000
120600            END-IF                                                12030000
120700       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    12040000
                IF PV-NULL-SLS-QTY = -1                                 12041009
                   MOVE ZERO TO TSKST-ONHAND-QTY                        12042009
                END-IF                                                  12043009
120900       WHEN OTHER                                                 12060000
121000         DISPLAY PV-ABEND-PARAGRAPH                               12070000
121100         PERFORM Z999-SQL-ERROR                                   12080000
121200     END-EVALUATE.                                                12090000
121300*                                                                 12100000
121400 T150-DATE-ROUTINE.                                               12110000
121500******************************************************************12120000
121600*  THIS PARAGRAPH SELECTS THE SALES UNIT QUANTITY FOR OUTPUT     *12130000
121700******************************************************************12140000
121800*                                                                 12150000
121900*  THIS COMPARES S-TNOW-WN (THE INPUT WEEK #) TO THE SYSTEM RUN   12160000
122000*  DATE WEEK # IN THE F2 CALENDAR.                                12170000
122100*                                                                 12180000
122200*  IF THE INPUT WEEK # IS GREATER THAN THE RUN WEEK # THEN THE    12190000
122300*  INPUT IS FROM THE PREVIOUS YEAR.                               12200000
122400*                                                                 12210000
122500*  CALL THE CALENDAR ROUTINE TO GET THE FIRST DAY OF THE PREVIOUS 12220000
122600*  YEAR.                                                          12230000
122700*                                                                 12240000
122800******************************************************************12250000
122900                                                                  12260000
123000     MOVE PV-TODAYS-DATE TO PV-FIRST-DATE.                        12270000
123100                                                                  12280000
123200     IF S-TNOW-WN > PV-TODAYS-WEEK                                12290000
123300            MOVE '01'  TO  PV-FIRST-MO                            12300000
123400            MOVE '01'  TO  PV-FIRST-DY                            12310000
123500            MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT             12320000
123600                                                                  12330000
123700            MOVE PC-F2               TO DPG51-CALENDAR-TYPE       12340000
123800                                                                  12350000
123900            SET DPG52-LK-DTE-GREG-FMT TO TRUE                     12360000
124000                                                                  12370000
124100            MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG         12380000
124200                                                                  12390000
124300            PERFORM I000-CALENDAR-ROUTINE                         12400000
124400                                                                  12410000
124500            MOVE DPG56-FIRST-FD-GREG-FMT TO PV-FIRST-DATE         12420000
124600                                                                  12430000
124700     END-IF.                                                      12440000
124800                                                                  12450000
124900******************************************************************12460000
125000*                                                                 12470000
125100*  THE INPUT TO THIS ROUTINE IS EITHER THE FIRST DATE OF THE      12480000
125200*  CURRENT YEAR OR THE FIRST DATE OF THE PREVIOUS YEAR DEPENDING  12490000
125300*  ON THE PREVIOUS WEEK # COMPARISONS.                            12500000
125400*                                                                 12510000
125500*  THIS CALL TO THE CALENDAR ROUTINE WILL INCREMENT OUT THE # OF  12520000
125600*  WEEKS - 1 TO GIVE A WEEK NUMBER IN F2 FOR LATER CONVERSION.    12530000
125700******************************************************************12540000
125800                                                                  12550000
125900     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   12560000
126000                                                                  12570000
126100     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           12580000
126200     MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             12590000
126300                                                                  12600000
126400     COMPUTE DPG51-INCR-DECR-DAYS-9 = ( S-TNOW-WN - 1 ) * 7 +     12610000
126500                                      ( S-TNOW-DN - 1 ).          12620000
126600                                                                  12630000
126700     SET DPG51-INCREMENT-DATE TO TRUE.                            12640000
126800                                                                  12650000
126900     PERFORM I000-CALENDAR-ROUTINE.                               12660000
127000                                                                  12670000
127100     MOVE DPG55-GREG-DATE-FMT  TO PV-TODAYS-DATE.                 12680000
127200                                                                  12690000
127300******************************************************************12700000
127400* RETRIEVE THE NBR OF FISCAL PERIOD WEEKS FOR THE PREVIOUS MONTH  12710000
127500* IN THE F4 CALENDAR AND USE THE FIRST FISCAL PERIOD DATE AS THE  12720000
127600* MIN BOW DATE.                                                   12730000
127700******************************************************************12740000
127800                                                                  12750000
127900     MOVE DPG56-FIRST-FP-GREG-FMT                                 12760000
128000                        TO DPG52-LK-DATE-INPUT.                   12770000
128100                                                                  12780000
128200     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           12790000
128300     MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             12800000
128400                                                                  12810000
128500     MOVE PC-7   TO DPG51-INCR-DECR-DAYS-9.                       12820000
128600     SET DPG51-DECREMENT-DATE TO TRUE.                            12830000
128700                                                                  12840000
128800     PERFORM I000-CALENDAR-ROUTINE.                               12850000
128900                                                                  12860000
129000     MOVE DPG56-NBR-FISCAL-PERIOD-WEEKS                           12870000
129100                                TO PV-F4-NBR-FISCAL-PERIOD-WKS.   12880000
129200     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              12890000
129300                                TO PV-MIN-BOW-DATE.               12900000
129400                                                                  12910000
129500******************************************************************12920000
129600* RETRIEVE THE MAXIMUM BOW DATE AS AN OFFSET OF THE MIN BOW DATE  12930000
129700******************************************************************12940000
129800                                                                  12950000
129900     MOVE DPG56-FIRST-FP-DB2-ISO-FMT                              12960000
130000                              TO DPG52-LK-DATE-INPUT.             12970000
130100     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            12980000
130200     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             12990000
130300                                                                  13000000
130400     COMPUTE DPG51-INCR-DECR-DAYS-9 =                             13010000
130500           (PV-F4-NBR-FISCAL-PERIOD-WKS - 1 ) * 7.                13020000
130600                                                                  13030000
130700     SET DPG51-INCREMENT-DATE TO TRUE.                            13040000
130800                                                                  13050000
130900     PERFORM I000-CALENDAR-ROUTINE.                               13060000
131000                                                                  13070000
131100     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-MAX-BOW-DATE.              13080000
131200                                                                  13090000
131300******************************************************************13100000
131400* RETRIEVE THE MIN WEEK NUMBER TO BE USED FOR MONTHLY CPS SALES   13110000
131500******************************************************************13120000
131600***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         13130000
131700***   IT IS NO LONGER NEEDED.                                     13140000
131800*                                                                 13150000
131900*    MOVE DPG56-FIRST-FP-GREG-FMT TO DPG52-LK-DATE-INPUT.         13160000
132000*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13170000
132100*    MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             13180000
132200*                                                                 13190000
132300*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       13200000
132400*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               13210000
132500*                                                                 13220000
132600*    PERFORM I000-CALENDAR-ROUTINE.                               13230000
132700*                                                                 13240000
132800*    MOVE DPG56-FISCAL-WEEK-NBR                                   13250000
132900*                               TO PV-MIN-WEEK.                   13260000
133000*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-MIN-YR                      13270000
133100*                                  PV-MAX-YR                      13280000
133200*                                                                 13290000
133300******************************************************************13300000
133400*                                                                 13310000
133500*  THE INPUT TO THIS ROUTINE IS AN F2 WEEK NUMBER AND YEAR. THIS  13320000
133600*  IS TO BE CONVERTED TO THE F4 WEEK NUMBER FOR COMPARISON TO THE 13330000
133700*  SALES/HISTORY TABLE.                                           13340000
133800*                                                                 13350000
133900*  THE OUTPUT F4 WEEK NUMBER IS TO BE USED FOR THE CALCULATION OF 13360000
134000*  THE MINIMIUM AND MAXIMIUM WEEKS.                               13370000
134100******************************************************************13380000
134200***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         13390000
134300***   PV-F4-NBR-FISCAL-WEEKS IS NO LONGER BEING USED.             13400000
134400*                                                                 13410000
134500*    MOVE PV-TODAYS-DATE       TO DPG52-LK-DATE-INPUT.            13420000
134600*                                                                 13430000
134700*    MOVE PC-F4                TO DPG51-CALENDAR-TYPE.            13440000
134800*                                                                 13450000
134900*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13460000
135000*                                                                 13470000
135100*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               13480000
135200*                                                                 13490000
135300*    PERFORM I000-CALENDAR-ROUTINE.                               13500000
135400*                                                                 13510000
135500*    MOVE DPG56-NBR-FISCAL-WEEKS TO PV-F4-NBR-FISCAL-WEEKS.       13520000
135600*                                                                 13530000
135700******************************************************************13540000
135800*   END                                                           13550000
135900*                                                                 13560000
136000 T155-UCYCLE-CALENDAR-ROUTINE.                                    13570000
136100******************************************************************13580000
136200*                                                                *13590000
136300******************************************************************13600000
136400                                                                  13610000
136500*    DISPLAY 'T155-UCYCLE-CALENDAR-ROUTINE'.                      13620000
136600*    DISPLAY 'FIRST DATE: ' PV-FIRST-DATE                         13630000
136700     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   13640000
136800                                                                  13650000
136900     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           13660000
137000     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             13670000
137100*    MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             13680000
137200*                                                                 13690000
137300*    DISPLAY 'BPN: ' S-BPN(PV-BPN-SUB).                           13700000
137400*    DISPLAY 'BPN SUB: ' PV-BPN-SUB.                              13710000
137500*                                                                 13720000
137600*    DISPLAY 'PV-CALC-DAYS 'PV-CALC-DAYS.                         13730000
137700     COMPUTE PV-CALC-DAYS = ((S-TNOW-WN - PV-MINUS-WK) * 7) +     13740000
137800                             (S-TNOW-DN - 1).                     13750000
137900                                                                  13760000
138000* *** ###                                                         13770000
138100     IF PV-CALC-DAYS IS NEGATIVE                                  13780000
138200* ***IF PV-CALC-DAYS <  0                                         13790000
138300       COMPUTE PV-CALC-DAYS-POSITIVE = ((PV-CALC-DAYS) * (-1))    13800000
138400       MOVE PV-CALC-DAYS-POSITIVE TO DPG51-INCR-DECR-DAYS-9       13810000
138500     ELSE                                                         13820000
138600       MOVE PV-CALC-DAYS TO DPG51-INCR-DECR-DAYS-9                13830000
138700     END-IF.                                                      13840000
138800                                                                  13850000
138900                                                                  13860000
139000     IF PV-CALC-DAYS > 0                                          13870000
139100         SET DPG51-INCREMENT-DATE TO TRUE                         13880000
139200     ELSE                                                         13890000
139300         SET DPG51-DECREMENT-DATE TO TRUE                         13900000
139400     END-IF.                                                      13910000
139500                                                                  13920000
139600     PERFORM I000-CALENDAR-ROUTINE.                               13930000
139700                                                                  13940000
139800     MOVE DPG55-1ST-WKDY-DB2ISO-FMT                               13950000
139900                                TO PV-UCYCLE-MAX-DATE.            13960000
140000                                                                  13970000
140100*****************************************************             13980000
140200***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         13990000
140300***   IT IS NO LONGER NEEDED.                                     14000000
140400*    MOVE DPG55-GREG-DATE-FMT   TO DPG52-LK-DATE-INPUT.           14010000
140500*    SET DPG52-LK-DTE-GREG-FMT  TO TRUE.                          14020000
140600*    MOVE PC-F4                 TO DPG51-CALENDAR-TYPE.           14030000
140700*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               14040000
140800*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       14050000
140900*    PERFORM I000-CALENDAR-ROUTINE.                               14060000
141000*                                                                 14070000
141100*    MOVE DPG56-FISCAL-WEEK-NBR TO PV-UCYCLE-MAX-WK.              14080000
141200*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-UCYCLE-MAX-YR.              14090000
141300*****************************************************             14100000
141400                                                                  14110000
141500     COMPUTE PV-MIN-DATE-CALC-DAYS =                              14120000
141600           ((S-BPN(PV-BPN-SUB) - 1) * 7 ) + (S-TNOW-DN - 1 ).     14130000
141700*    DISPLAY 'PV-MIN-DATE-CALC-DAYS 'PV-MIN-DATE-CALC-DAYS.       14140000
141800*************************************************************     14150000
141900****   THIS IF STATEMENT WAS REMOVED BECAUSE THE ELSE PORTION     14160000
142000****   OF THE IF STATEMENT IS THE SAME VALUE AS THE IF PORTION    14170000
142100**   IF S-BPN(PV-BPN-SUB) > PC-1                                  14180000
142200**      COMPUTE DPG51-INCR-DECR-DAYS-9 =                          14190000
142300**           ((S-BPN(PV-BPN-SUB) - 1) * 7 ) + (S-TNOW-DN - 1 )    14200000
142400**   ELSE                                                         14210000
142500**      COMPUTE DPG51-INCR-DECR-DAYS-9 = (S-TNOW-DN - 1 )         14220000
142600**   END-IF                                                       14230000
142700***********************************************************       14240000
142800                                                                  14250000
142900     IF PV-MIN-DATE-CALC-DAYS > PV-CALC-DAYS                      14260000
143000*      GET THE NUMBER OF DAYS IN THE PREVIOUS FISCAL YEAR IN      14270000
143100*      ORDER TO SUBTRACT THAT NUMBER OF DAYS FROM PV-MIN-DATE-    14280000
143200*      CALC-DAYS TO GET THE CORRECT MINIMUM DATE CALC DAYS        14290000
143300         INITIALIZE            DPG51 DPG52                        14300000
143400                               DPG53 DPG54                        14310000
143500                               DPG55 DPG56                        14320000
143600         MOVE SPACES           TO DPG52-LK-DATE-INPUT             14330000
143700         MOVE PV-FIRST-YR      TO DPG52-FISCAL-PRD-YR             14340000
143800         MOVE 1                TO DPG52-FISCAL-PRD-PP             14350000
143900         SET DPG52-LK-DTE-FISC-PRD TO TRUE                        14360000
144000         MOVE PC-F4            TO DPG51-CALENDAR-TYPE             14370000
144100         SET DPG51-DECREMENT-DATE TO TRUE                         14380000
144200         MOVE 1                TO DPG51-INCR-DECR-FISCAL-PRD-9    14390000
144300         PERFORM I000-CALENDAR-ROUTINE                            14400000
144400         COMPUTE PV-MIN-DATE-CALC-DAYS = PV-MIN-DATE-CALC-DAYS -  14410000
144500           (DPG56-NBR-FISCAL-WEEKS * 7 )                          14420000
144600     END-IF.                                                      14430000
144700                                                                  14440000
144800         INITIALIZE            DPG51 DPG52                        14450000
144900                               DPG53 DPG54                        14460000
145000                               DPG55 DPG56.                       14470000
145100                                                                  14480000
145200     MOVE PV-FIRST-DATE TO DPG52-LK-DATE-INPUT.                   14490000
145300                                                                  14500000
145400     SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           14510000
145500     MOVE PC-A0               TO DPG51-CALENDAR-TYPE.             14520000
145600**   MOVE PC-F2               TO DPG51-CALENDAR-TYPE.             14530000
145700                                                                  14540000
145800* ###                                                             14550000
145900     IF PV-MIN-DATE-CALC-DAYS IS NEGATIVE                         14560000
146000        COMPUTE PV-MIN-DATE-CALC-DAYS-POSI =                      14570000
146100        ((PV-MIN-DATE-CALC-DAYS) * (-1))                          14580000
146200          MOVE PV-MIN-DATE-CALC-DAYS-POSI                         14590000
146300             TO DPG51-INCR-DECR-DAYS-9                            14600000
146400     ELSE                                                         14610000
146500        MOVE PV-MIN-DATE-CALC-DAYS TO DPG51-INCR-DECR-DAYS-9      14620000
146600     END-IF.                                                      14630000
146700                                                                  14640000
146800     IF PV-MIN-DATE-CALC-DAYS > 0                                 14650000
146900         SET DPG51-INCREMENT-DATE TO TRUE                         14660000
147000     ELSE                                                         14670000
147100         SET DPG51-DECREMENT-DATE TO TRUE                         14680000
147200     END-IF.                                                      14690000
147300                                                                  14700000
147400     PERFORM I000-CALENDAR-ROUTINE.                               14710000
147500                                                                  14720000
147600     MOVE DPG55-1ST-WKDY-DB2ISO-FMT                               14730000
147700                                TO PV-UCYCLE-MIN-DATE.            14740000
147800                                                                  14750000
147900*****************************************************             14760000
148000***   THE NEXT DATE ROUTINE CALL IS COMMENTED OUT BECAUSE         14770000
148100***   IT IS NO LONGER NEEDED.                                     14780000
148200*    MOVE DPG55-GREG-DATE-FMT TO DPG52-LK-DATE-INPUT.             14790000
148300*    SET DPG52-LK-DTE-GREG-FMT TO TRUE.                           14800000
148400*    MOVE PC-F4               TO DPG51-CALENDAR-TYPE.             14810000
148500*    MOVE SPACES TO DPG51-INCREMENT-DECREMENT-FLAG.               14820000
148600*    MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9.                       14830000
148700*    PERFORM I000-CALENDAR-ROUTINE.                               14840000
148800*                                                                 14850000
148900*    MOVE DPG56-FISCAL-WEEK-NBR TO PV-UCYCLE-MIN-WK.              14860000
149000*    MOVE DPG56-FISCAL-YEAR-NBR TO PV-UCYCLE-MIN-YR.              14870000
149100                                                                  14880000
149200*    IF PV-UCYCLE-MIN-YR >  PV-UCYCLE-MAX-YR                      14890000
149300*        MOVE PV-UCYCLE-MAX-YR TO PV-UCYCLE-MIN-YR                14900000
149400*    END-IF.                                                      14910000
149500*****************************************************             14920000
149600                                                                  14930000
149700 EJECT                                                            14940000
149800******************************************************************14950000
149900*  THIS PARAGRAPH SELECTS THE PO RECORD FOR ON-ORDER QUANTITY    *14960000
150000*  BASED ON SKU.                                                 *14970000
150100******************************************************************14980000
150200 T300-SELECT-PO-RECORD.                                           14990000
150300*                                                                 15000000
150400*    DISPLAY 'T300-SELECT-PO-RECORD'.                             15010000
150500*                                                                 15020000
150600     MOVE 'T300'                   TO PGM-LOCATION.               15030000
150700     MOVE 'T300-SELECT-PO-RECORD'                                 15040000
150800                                   TO PV-ABEND-PARAGRAPH.         15050000
150900*                                                                 15060000
151000*    DISPLAY 'ON-ORD-SKU: ' SKSTOO-SKU-SEQ-NBR.                   15070000
151100*                                                                 15080000
151500     IF MR017-STR-NBR EQUAL PC-CORPORATE-STORE                    15090000
151600        PERFORM T350-ACCUM-CORP-OO-TOTAL                          15100000
151700     ELSE                                                         15110000
151800        PERFORM T360-ACCUM-STORE-OO-TOTAL                         15120000
151900     END-IF.                                                      15130000
152000*                                                                 15140000
152100*                                                                 15150000
152200 EJECT                                                            15160000
152300******************************************************************15170000
152400*  THIS PARAGRAPH SELECTS THE TOTAL ONORDER AT THE CORP LEVEL    *15180000
152500******************************************************************15190000
152600 T350-ACCUM-CORP-OO-TOTAL.                                        15200000
152700*                                                                 15210000
152800     MOVE 'T350'                   TO PGM-LOCATION.               15220000
152900     MOVE 'T350-ACCUM-CORP-OO-TOTAL'                              15230000
153000                                   TO PV-ABEND-PARAGRAPH.         15240000
153100     MOVE ZEROS               TO PV-OO                            15250000
153200     MOVE MR017-ITEM-NBR TO SKSTOO-ITM-NBR.                       15260000
153300     EXEC SQL                                                     15270000
153400        SELECT SUM(ONORD_UNT_QTY)                                 15280000
153500        INTO :PV-OO:PV-NULL-OO                                    15290000
153600        FROM TSKSTOO A                                            15300000
153700            , XMT_LOC B                                           15310000
153800        WHERE A.STR_NBR    =   B.LOC_NBR                          15320000
153900        AND B.LOC_TYP_CDE  =   'DS'                               15330000
154000        AND A.ITM_NBR          =   :SKSTOO-ITM-NBR                15340000
154100     END-EXEC.                                                    15350000
154200*                                                                 15360000
154300     EVALUATE TRUE                                                15370000
154400       WHEN SQLCODE         = ZERO                                15380000
154500         CONTINUE                                                 15390000
154600       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    15400000
154700          IF PV-NULL-OO = -1                                      15410000
154800             MOVE 0 TO PV-OO                                      15420000
154900          END-IF                                                  15430000
155000       WHEN OTHER                                                 15440000
155100         DISPLAY '**** ABEND ****'                                15450000
155200         DISPLAY '**** PROGRAM   = MRKUT151 ****'                 15460004
155300         DISPLAY '**** PARAGRAPH = T350-ACCUM-  '                 15470000
155400         DISPLAY '**** INVALID SELECT SUM ON TSKSTOO    '         15480000
155500         DISPLAY '**** ITEM-NBR  = ' MR017-ITEM-NBR               15490000
155600         DISPLAY PV-ABEND-PARAGRAPH                               15500000
155700         PERFORM Z999-SQL-ERROR                                   15510000
155800     END-EVALUATE.                                                15520000
155900 EJECT                                                            15530000
156000******************************************************************15540000
156100*  THIS PARAGRAPH SELECTS THE TOTAL ONORDER AT THE STORE LEVEL   *15550000
156200******************************************************************15560000
156300 T360-ACCUM-STORE-OO-TOTAL.                                       15570000
156400*                                                                 15580000
156500     MOVE 'T360'                   TO PGM-LOCATION.               15590000
156600     MOVE 'T360-ACCUM-STORE-OO-TOTAL'                             15600000
156700                                   TO PV-ABEND-PARAGRAPH.         15610000
156800     MOVE ZEROS               TO PV-OO                            15620000
156900     MOVE MR017-ITEM-NBR TO SKSTOO-ITM-NBR.                       15630000
157000     MOVE MR017-STR-NBR TO  XMT00001-LOC-NBR                      15640000
RONNA      MOVE MR004O-H-DEPT TO PV-SEPHORA-DEPT                        15640114
RONNA      IF PV-SEPHORA-DEPT-LIST                                      15640214
RONNA         DISPLAY 'DEPT' MR004O-H-DEPT                              15642013
RONNA         EXEC SQL                                                  15650013
RONNA            SELECT SUM(ONORD_UNT_QTY)                              15660013
RONNA            INTO :PV-OO:PV-NULL-OO                                 15670013
RONNA            FROM TSKSTOO A,                                        15680013
RONNA                 XMT_LOC B                                         15690013
RONNA            WHERE A.STR_NBR    =   B.LOC_NBR                       15700013
RONNA            AND B.LOC_TYP_CDE  =   'DS'                            15710013
RONNA            AND A.ITM_NBR      =   :SKSTOO-ITM-NBR                 15730013
RONNA            AND E_BUS_IND      =   'Y'                             15740013
RONNA            AND A.STR_NBR      =   839                             15741013
RONNA         END-EXEC                                                  15750013
RONNA      ELSE                                                         15750113
RONNA         EXEC SQL                                                  15751013
RONNA            SELECT SUM(ONORD_UNT_QTY)                              15752013
RONNA            INTO :PV-OO:PV-NULL-OO                                 15753013
RONNA            FROM TSKSTOO A,                                        15754013
RONNA                 XMT_LOC B                                         15755013
RONNA            WHERE A.STR_NBR    =   B.LOC_NBR                       15756013
RONNA            AND B.LOC_TYP_CDE  =   'DS'                            15757013
RONNA            AND A.ITM_NBR      =   :SKSTOO-ITM-NBR                 15758013
RONNA            AND E_BUS_IND      =   'Y'                             15759013
RONNA         END-EXEC                                                  15759113
RONNA      END-IF.                                                      15759213
158100*                                                                 15760000
158200     EVALUATE TRUE                                                15770000
158300       WHEN SQLCODE         = ZERO                                15780000
158400         CONTINUE                                                 15790000
158500       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    15800000
158600          IF PV-NULL-OO = -1                                      15810000
158700             MOVE 0 TO PV-OO                                      15820000
158800          END-IF                                                  15830000
158900       WHEN OTHER                                                 15840000
159000         DISPLAY '**** ABEND ****'                                15850000
159100         DISPLAY '**** PROGRAM   = MRKUT151 ****'                 15860004
159200         DISPLAY '**** PARAGRAPH = T360-ACCUM-  '                 15870000
159300         DISPLAY '**** INVALID SELECT SUM ON TSKSTOO    '         15880000
159400         DISPLAY '**** ITEM-NBR  = ' MR017-ITEM-NBR               15890000
159500         DISPLAY PV-ABEND-PARAGRAPH                               15900000
159600         PERFORM Z999-SQL-ERROR                                   15910000
159700     END-EVALUATE.                                                15920000
159800 EJECT                                                            15930000
159900                                                                  15940000
160000*  THIS PARAGRAPH SELECTS THE VENDOR NAME FOR OUTPUT             *15950000
160100******************************************************************15960000
160200 T700-SELECT-VENDOR-NAME.                                         15970000
160300*                                                                 15980000
160400*    DISPLAY 'T700-SELECT-VENDOR-NAME'.                           15990000
160500*                                                                 16000000
160600     MOVE 'T700'                   TO PGM-LOCATION.               16010000
160700     MOVE 'T700-SELECT-VENDOR-NAME'                               16020000
160800                                   TO PV-ABEND-PARAGRAPH.         16030000
160900*                                                                 16040000
161000     MOVE PC-01  TO ENTNME-TYPE-CDE                               16050000
161100     EXEC SQL                                                     16060000
161200         SELECT A.ENT_NAME_DESC                                   16070000
161300           INTO :ENTNME-ENT-NAME-DESC                             16080000
161400           FROM TENTNME A,                                        16090000
161500                TVNDDPT B                                         16100000
161600           WHERE A.ENT_ID          = B.ENT_ID                     16110000
161700             AND B.DEPT_NBR        = :VNDDPT-DEPT-NBR             16120000
161800             AND B.INHOUSE_NBR     = :VNDDPT-INHOUSE-NBR          16130000
161900             AND A.TYPE_CDE        = :ENTNME-TYPE-CDE             16140000
162000     END-EXEC.                                                    16150000
162100*                                                                 16160000
162200     EVALUATE TRUE                                                16170000
162300       WHEN SQLCODE = ZEROS                                       16180000
162400         MOVE PC-FLNAME-LENGTH   TO DP024-FLNAME-LENGTH           16190000
162500         MOVE RSPBAR-WORKER-FIR-NAME                              16200000
162600                                 TO DP024-FNAME                   16210000
162700         MOVE RSPBAR-WORKER-LAST-NAME                             16220000
162800                                 TO DP024-LNAME                   16230000
162900         PERFORM DP024-0000-FORMAT-NAME                           16240000
163000         MOVE DP024-FLNAME       TO PV-BYR-NAME                   16250000
163100       WHEN SQLCODE = PC-ROW-NOT-FOUND                            16260000
163200         MOVE SPACES             TO PV-BYR-NAME                   16270000
163300       WHEN OTHER                                                 16280000
163400         DISPLAY PV-ABEND-PARAGRAPH                               16290000
163500         DISPLAY 'MDSEAR-DKEY: '                                  16300000
163600                  MDSEAR-DKEY                                     16310000
163700         DISPLAY 'PC-BUYER  : '                                   16320000
163800                  PC-BYR                                          16330000
163900         DISPLAY 'PV-CURRENT-DATE-R: '                            16340000
164000                  PV-CURRENT-DATE-R                               16350000
164100         PERFORM Z999-SQL-ERROR                                   16360000
164200     END-EVALUATE.                                                16370000
164300*                                                                 16380000
164400 EJECT                                                            16390000
164500******************************************************************16400000
164600*  THIS PARAGRAPH SELECTS THE BUYER NUMBER FOR OUTPUT AND THE    *16410000
164700*  DKEY TO RETRIEVE THE BUYER NAME                               *16420000
164800******************************************************************16430000
164900 T800-SELECT-MDSEAR-DKEY.                                         16440000
165000*                                                                 16450000
165100*    DISPLAY 'T800-SELECT-MDSEAR-DKEY'.                           16460000
165200*                                                                 16470000
165300     MOVE 'T800'                   TO PGM-LOCATION.               16480000
165400     MOVE 'T800-SELECT-MDSEAR-DKEY'                               16490000
165500                                   TO PV-ABEND-PARAGRAPH.         16500000
165600     MOVE PC-OPER-CO TO  MDSEAR-OPERCO-NBR                        16510000
165700*                                                                 16520000
165800     EXEC SQL                                                     16530000
165900         SELECT  MDSEAR_DKEY,                                     16540000
166000                 BYR_NBR                                          16550000
166100           INTO  :MDSEAR-DKEY,                                    16560000
166200                 :MDSEAR-BYR-NBR                                  16570000
166300           FROM TMDSEAR                                           16580000
166400          WHERE DEPT_NBR   = :MDSEAR-DEPT-NBR                     16590000
166500            AND MDSELV_CDE = :MDSEAR-MDSELV-CDE                   16600000
166600            AND OPERCO_NBR = :MDSEAR-OPERCO-NBR                   16610000
166700            AND :PV-CURRENT-DATE-R BETWEEN                        16620000
166800                STRT_DTE AND END_DTE                              16630000
166900     END-EXEC.                                                    16640000
167000*                                                                 16650000
167100     EVALUATE TRUE                                                16660000
167200       WHEN SQLCODE         = ZERO                                16670000
167300         CONTINUE                                                 16680000
167400       WHEN SQLCODE         = PC-ROW-NOT-FOUND                    16690000
167500         MOVE ZEROES TO MDSEAR-DKEY                               16700000
167600         MOVE SPACES TO MDSEAR-BYR-NBR                            16710000
167700       WHEN OTHER                                                 16720000
167800         DISPLAY '**** ABEND ****'                                16730000
167900         DISPLAY '**** PROGRAM   = MRKUT151 ****'                 16740004
168000         DISPLAY '**** PARAGRAPH = T800-SELECT  '                 16750000
168100         DISPLAY '**** INVALID SELECT ON TMDSEAR TABLE     '      16760000
168200         DISPLAY '**** DEPT-NBR  = ' MDSEAR-DEPT-NBR              16770000
168300         DISPLAY '**** MDSELV-CDE = ' MDSEAR-MDSELV-CDE           16780000
168400         DISPLAY '**** PROCESS DTE = ' PV-CURRENT-DATE-R          16790000
168500         DISPLAY PV-ABEND-PARAGRAPH                               16800000
168600         PERFORM Z999-SQL-ERROR                                   16810000
168700     END-EVALUATE.                                                16820000
168800*                                                                 16830000
168900 EJECT                                                            16840000
169000******************************************************************16850000
169100*  RETRIEVES THE BUYER   NAME.                                   *16860000
169200******************************************************************16870000
169300*                                                                 16880000
169400 T900-SELECT-BUYER-NAME.                                          16890000
169500*                                                                 16900000
169600*    DISPLAY 'T900-SELECT-BUYER-NAME'.                            16910000
169700*                                                                 16920000
169800     MOVE 'T900'                 TO PGM-LOCATION.                 16930000
169900     MOVE 'T900-GET-BUYER-NAME       '                            16940000
170000                                 TO PV-ABEND-PARAGRAPH.           16950000
170100*                                                                 16960000
170200     EXEC SQL                                                     16970000
170300         SELECT WORKER_FIR_NAME,                                  16980000
170400                WORKER_LAST_NAME                                  16990000
170500           INTO :RSPBAR-WORKER-FIR-NAME,                          17000000
170600                :RSPBAR-WORKER-LAST-NAME                          17010000
170700           FROM TRSPBAR                                           17020000
170800           WHERE MDSEAR_DKEY       = :RSPBAR-MDSEAR-DKEY          17030000
170900             AND RSPLVL_CDE        = :RSPBAR-RSPLVL-CDE           17040000
171000             AND :PV-CURRENT-DATE-R BETWEEN                       17050000
171100                 WORKER_STRT_DTE AND WORKER_END_DTE               17060000
171200     END-EXEC.                                                    17070000
171300*                                                                 17080000
171400     EVALUATE TRUE                                                17090000
171500       WHEN SQLCODE = ZEROS                                       17100000
171600         MOVE PC-FLNAME-LENGTH   TO DP024-FLNAME-LENGTH           17110000
171700         MOVE RSPBAR-WORKER-FIR-NAME                              17120000
171800                                 TO DP024-FNAME                   17130000
171900         MOVE RSPBAR-WORKER-LAST-NAME                             17140000
172000                                 TO DP024-LNAME                   17150000
172100         PERFORM DP024-0000-FORMAT-NAME                           17160000
172200         MOVE DP024-FLNAME       TO PV-BYR-NAME                   17170000
172300       WHEN SQLCODE = PC-ROW-NOT-FOUND                            17180000
172400         MOVE SPACES             TO PV-BYR-NAME                   17190000
172500       WHEN OTHER                                                 17200000
172600         DISPLAY PV-ABEND-PARAGRAPH                               17210000
172700         DISPLAY 'MDSEAR-DKEY: '                                  17220000
172800                  MDSEAR-DKEY                                     17230000
172900         DISPLAY 'PC-BUYER  : '                                   17240000
173000                  PC-BYR                                          17250000
173100         DISPLAY 'PV-CURRENT-DATE-R: '                            17260000
173200                  PV-CURRENT-DATE-R                               17270000
173300         PERFORM Z999-SQL-ERROR                                   17280000
173400     END-EVALUATE.                                                17290000
173500 EJECT                                                            17300000
173600******************************************************************17310000
173700*     WRITES THE INPUT TRANSFER RECORD TO BE USED IN THE         *17320000
173800*     REPLENISHMENT SYSTEM                                       *17330000
173900******************************************************************17340000
174000 W000-WRITE-OUTPUT.                                               17350000
174100*                                                                 17360000
174200*    DISPLAY 'W000-WRITE'.                                        17370000
174300     MOVE 'W000'                  TO PGM-LOCATION.                17380000
174400     MOVE 'W000-WRITE-SYSTEM-RECORD   '                           17390000
174500                                  TO PV-ABEND-PARAGRAPH.          17400000
174600*                                                                 17410000
174700     WRITE TRANSFER-REC           FROM PV-OUTPUT.                 17420000
174800*                                                                 17430000
174900     ADD PC-PLUS-1 TO PV-SYSTEM-OUTPUT-CNT.                       17440000
175000*                                                                 17450000
175100 EJECT                                                            17460000
175200******************************************************************17470000
175300*   CLOSES FILES AND DISPLAYS MESSAGES.                          *17480000
175400******************************************************************17490000
175500 Y100-END-ROUTINE.                                                17500000
175600*                                                                 17510000
175700     IF NO-INPUT                                                  17520000
175800         CONTINUE                                                 17530000
175900     ELSE                                                         17540000
176000         PERFORM W000-WRITE-OUTPUT                                17550000
176100     END-IF.                                                      17560000
176200*                                                                 17570000
176300     CLOSE  IC-CONTROL-FILE                                       17580000
176400            BIM-FILE                                              17590000
                  CONTROL-CARD-FILE                                     17600000
176500            TRANSFER-RECORD-IN                                    17610000
176600            TRANSFER-RECORD.                                      17620000
176700                                                                  17630000
176800     IF NOT (PV-CONTROL-SUCCESSFUL OR                             17640000
176900             PV-CONTROL-VERIFY)                                   17650000
177000        MOVE 'Y100-END-ROUTINE'   TO PV-PARAGRAPH-NAME            17660000
177100        MOVE 'IC-CONTROL-FILE'    TO PV-ERROR-FILE                17670000
177200        MOVE 'CLOSING INPUT FILE' TO PV-ERROR-OPERATION           17680000
177300        MOVE 'BAD-CLOSE'          TO PV-ERROR-STATUS              17690000
177400        MOVE  PV-CONTROL-STATUS   TO PV-VSAM-STATUS               17700000
177500        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             17710000
177600        PERFORM Z999-VSAM-ERROR                                   17720000
177700        MOVE +4006              TO PV-ABEND-CODE                  17730000
177800        CALL 'ILBOABN0'        USING PV-ABEND-CODE                17740000
177900     END-IF.                                                      17750000
178000                                                                  17760000
178100     IF NOT (PV-BIM-SUCCESSFUL OR                                 17770000
178200             PV-BIM-VERIFY)                                       17780000
178300        MOVE 'Y100-END-ROUTINE'   TO PV-PARAGRAPH-NAME            17790000
178400        MOVE 'BIM-FILE'           TO PV-ERROR-FILE                17800000
178500        MOVE 'CLOSING INPUT FILE' TO PV-ERROR-OPERATION           17810000
178600        MOVE 'BAD-CLOSE'          TO PV-ERROR-STATUS              17820000
178700        MOVE  PV-BIM-STATUS       TO PV-VSAM-STATUS               17830000
178800        MOVE  '//////////////'    TO PV-NOT-FOUND-KEY             17840000
178900        PERFORM Z999-VSAM-ERROR                                   17850000
179000        MOVE +4006              TO PV-ABEND-CODE                  17860000
179100        CALL 'ILBOABN0'        USING PV-ABEND-CODE                17870000
179200     END-IF.                                                      17880000
179300*                                                                 17890000
179400*** DISPLAY COUNT OF ITEMS PROCESSED.  (DIVIDE COUNT BY 2 TO      17900000
179500*** ELIMINATE CORPORATE RECORDS, FOR ALL SYSTEMS EXCEPT 02.)      17910000
179600*                                                                 17920000
179700     IF MR001I-S-SYS-ID EQUAL '02'                                17930000
179800        CONTINUE                                                  17940000
179900     ELSE                                                         17950000
179901        COMPUTE PV-ITEM-COUNT = PV-ITEM-COUNT / 2                 17960000
179902     END-IF.                                                      17970000
179903     DISPLAY '*******************************'.                   17980000
179904     DISPLAY '*  TOTAL ITEMS: ' PV-ITEM-COUNT.                    17990000
179905     DISPLAY '*******************************'.                   18000000
179906*                                                                 18010000
179907 EJECT                                                            18020000
179908******************************************************************18030000
179909*     VSAM WARNING OR ERROR PROCESSING                           *18040000
179910*                                                                *18050000
179920******************************************************************18060000
179930                                                                  18070000
179940 Z999-VSAM-ERROR.                                                 18080000
179950*---------------                                                  18090000
179960*                                                                 18100000
179970*    DISPLAY 'Z999-VSAM-ERROR'.                                   18110000
179980     DISPLAY '**   ABEND   **'.                                   18120000
179990     DISPLAY 'PROGRAM NAME = ' PC-PGRM-NAME.                      18130000
180000     DISPLAY PV-PARAGRAPH-NAME-MSG.                               18140000
180100     DISPLAY PV-ERROR-FILE-MSG.                                   18150000
180200     DISPLAY PV-ERROR-OPERATION-MSG.                              18160000
180300     DISPLAY PV-ERROR-STATUS-MSG.                                 18170000
180400     DISPLAY PV-NOT-FOUND-MSG                                     18180000
180500     DISPLAY 'VSAM STATUS = ' PV-VSAM-STATUS.                     18190000
180600     DISPLAY '***************'.                                   18200000
180700*                                                                 18210000
180800 EJECT                                                            18220000
180900******************************************************************18230000
181000*     SQL WARNING OR ERROR PROCESSING                            *18240000
181100*                                                                *18250000
181200******************************************************************18260000
181300                                                                  18270000
181400 Z999-SQL-ERROR.                                                  18280000
181500*---------------                                                  18290000
181600                                                                  18300000
181700     MOVE SQLCODE    TO SQLCODE2.                                 18310000
181800     MOVE SQLERRD(3) TO SQLERRD3.                                 18320000
181900     DISPLAY '** ABEND **       ** = SQLERROR'.                   18330000
182000     DISPLAY '** PROGRAM        ** = MRKUT151'.                   18340004
182100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  18350000
182200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  18360000
182300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   18370000
182400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  18380000
182500     MOVE +4013 TO PV-ABEND-CODE.                                 18390000
182600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18400000
182700*                                                                 18410000
182800******************************************************************18420000
182900     COPY DPPD024.                                                18430000
183000 EJECT                                                            18440000
183100******************************************************************18450000
183200******************************************************************18460000
