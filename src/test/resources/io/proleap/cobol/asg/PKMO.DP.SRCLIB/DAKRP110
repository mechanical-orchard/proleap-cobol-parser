       IDENTIFICATION DIVISION.                                         00000100
       PROGRAM-ID.    DAKRP110.                                         00000200
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00000300
       DATE-WRITTEN.  12-30-2003.                                       00000400
       DATE-COMPILED.                                                   00000500
                                                                        00000600
      ******************************************************************00000700
      *     DAKRP110 - THE MODULE LISTS ASSET RECOVERY PRICE CHANGES    00001000
      *                AND CREATES THE DEBIT ALLOWANCE PRICE CHANGE     00001100
      *                BY DMM.                                          00001200
      *                                                                 00001300
      *CHANGE HISTORY:                                                  00001400
      * PROJ   DATE       PGMR       DESCRIPTION                        00001500
      * ------ ---------- ---------- ---------------------------------- 00001600
22405 * 22405  05-31-2001 R JANSSEN  DAII - ASSET RECOVERY ENHANCEMENT  00001700
      ******************************************************************00001800
                                                                        00001900
       ENVIRONMENT DIVISION.                                            00002000
       CONFIGURATION SECTION.                                           00002100
       SOURCE-COMPUTER.        IBM-3090.                                00002200
       OBJECT-COMPUTER.        IBM-3090.                                00002300
       INPUT-OUTPUT SECTION.                                            00002400
       FILE-CONTROL.                                                    00002500
                                                                        00002600
           SELECT DA-TRANS-FILE-IN                                      00002700
               ASSIGN TO INP01.                                         00002800
                                                                        00002900
           SELECT CONTROL-CARD-FILE                                     00003000
               ASSIGN TO INP02.                                         00003100
                                                                        00003200
           SELECT REPORT-FILE                                           00003300
               ASSIGN TO RPT01.                                         00003400
                                                                        00003500
       DATA DIVISION.                                                   00003600
       FILE SECTION.                                                    00003700
                                                                        00003800
       FD  DA-TRANS-FILE-IN                                             00003900
           LABEL RECORDS ARE OMITTED                                    00004000
           RECORDING MODE IS F                                          00004100
           BLOCK CONTAINS 0 RECORDS.                                    00004200
       01  DA-TRANS-FILE-REC      PIC X(550).                           00004300
                                                                        00004400
       FD  CONTROL-CARD-FILE                                            00004500
           RECORDING MODE IS F                                          00004600
           LABEL RECORDS ARE STANDARD                                   00004700
           BLOCK CONTAINS 0 RECORDS.                                    00004800
       01  CONTROL-CARD-RECORD    PIC X(80).                            00005000
                                                                        00005100
       FD  REPORT-FILE                                                  00005200
           RECORDING MODE F                                             00005300
           LABEL RECORDS OMITTED                                        00005400
           BLOCK CONTAINS  0 RECORDS.                                   00005500
       01  REPORT-LINE            PIC X(80).                            00005600
                                                                        00005700
      /*****************************************************************00701000
       WORKING-STORAGE SECTION.                                         00710000
      ******************************************************************00711000
                                                                        00720000
       01  PA-PROGRAM-ACCUMULATORS.                                     00760000
           05  PA-LINE-NO            PIC S9(03)    COMP-3 VALUE 0.      00770000
           05  PA-PAGE-COUNT         PIC S9(05)    COMP-3 VALUE 0.      00780000
           05  PA-IN-COUNT           PIC S9(09)    COMP-3 VALUE 0.      00790000
           05  PA-TOTAL-READ         PIC S9(09)    COMP-3 VALUE 0.      00800000
           05  PA-AP-TOTAL-WRITTEN   PIC S9(09)    COMP-3 VALUE 0.      00810000
           05  PA-DA-TOTAL-WRITTEN   PIC S9(09)    COMP-3 VALUE 0.      00820000
           05  PA-TOTAL-CREDIT-AMT   PIC S9(09)V99 COMP-3 VALUE 0.      00830000
           05  PA-TOTAL-RTL-AMT      PIC S9(09)V99 COMP-3 VALUE 0.      00840000
           05  PA-DEPT-RTL           PIC S9(09)V99 COMP-3 VALUE 0.      00850000
           05  PA-DEPT-COST          PIC S9(09)V99 COMP-3 VALUE 0.      00860000
           05  PA-TOTAL-RTL          PIC S9(09)V99 COMP-3 VALUE 0.      00870000
           05  PA-TOTAL-COST         PIC S9(09)V99 COMP-3 VALUE 0.      00880000
                                                                        00890000
       01  PC-CONSTANTS.                                                00900000
           05  PC-OPERCO-NBR         PIC  X(02) VALUE '03'.             00910000
           05  PC-MDSELV-DPT         PIC  X(03) VALUE 'DPT'.            00920000
           05  PC-DAK001-JOB         PIC  X(06) VALUE 'DAK001'.         00930000
           05  PC-DAKRP110-PGM       PIC  X(08) VALUE 'DAKRP110'.       00940000
           05  PC-DMM-DESC           PIC  X(13) VALUE 'DMM TOTAL:   '.  00950000
           05  PC-TOTAL-DESC         PIC  X(13) VALUE 'REPORT TOTAL:'.  00960000
           05  PC-NO-INPUT-MSG       PIC  X(80) VALUE                   00970000
               '          =====> NO INPUT <====                      '. 00980000
           05  PC-END-RPT-MSG        PIC  X(80) VALUE                   00990000
               '          * * *  END OF REPORT  * * *                '. 01000000
           05  PC-MAX-LINES          PIC S9(03)  VALUE 79.              01010000
                                                                        01020000
       01  PS-SWITCHES.                                                 01030000
           05  PS-EOF-EXTRACT-SWITCH PIC  X(01) VALUE 'N'.              01040000
               88  PS-EOF-EXTRACT                      VALUE 'Y'.       01050000
                                                                        01060000
       01  PV-VARIABLES.                                                01070000
           05  PV-PREV-DMM            PIC X(02)     VALUE SPACES.       01080001
           05  PV-BTCH-SRC-CDE        PIC X(03)     VALUE SPACES.       01090000
           05  PV-RUN-TIME            PIC X(08)     VALUE SPACES.       01100000
           05  PV-RUN-DATE            PIC X(10)     VALUE SPACES.       01110000
           05  PV-PARAGRAPH           PIC X(30)     VALUE SPACES.       01120000
           05  PV-OPERATION-ATTEMPTED PIC X(40)     VALUE SPACES.       01130000
           05  PV-ABEND-MESSAGE       PIC X(75)     VALUE SPACES.       01140000
           05  PV-TOTAL-CREDITS       PIC S9(09)V99 COMP-3 VALUE 0.     01150000
           05  PV-TOTAL-CREDIT-AMT    PIC S9(09)V99 COMP-3 VALUE 0.     01160000
           05  PV-STMT-DTL-SEQ-NBR    PIC S9(05)    COMP-3 VALUE 0.     01170000
           05  PV-DISP-NUMBER         PIC Z,ZZZ,ZZ9.                    01180000
           05  PV-EFF-DTE-TIME.                                         01190000
               10  PV-EFF-DTE         PIC X(10).                        01200000
               10  PV-EFF-TIME        PIC X(09).                        01210000
                                                                        01220000
                                                                        01230000
      ***************************************************************** 01240000
      *  KOHL'S STANDARD FIRST HEADING LINE                             01250000
      ***************************************************************** 01260000
           COPY DPWS075O.                                               01270000
      *                                                                 01280000
       01  H2-HEADING2.                                                 01290000
           05  FILLER                PIC X(08) VALUE SPACES.            01300004
           05  FILLER                PIC X(55) VALUE                    01310004
           ' DEBIT ALLOWANCE ASSET RECOVERY PRICE CHANGES BY DMM'.      01320004
           05  FILLER                PIC X(01) VALUE SPACES.            01330004
           05  FILLER                PIC X(05) VALUE 'JOB: '.           01340000
           05  H2-JOB-NAME           PIC X(06) VALUE SPACES.            01350000
                                                                        01360000
       01  H4-HEADING4.                                                 01430000
           05  FILLER                PIC X(02) VALUE SPACES.            01440000
           05  FILLER                PIC X(06) VALUE 'DMM:  '.          01450005
           05  H4-DMM-NBR            PIC X(02) VALUE SPACES.            01460005
           05  FILLER                PIC X(01) VALUE SPACES.            01470000
           05  H4-DMM-NAME           PIC X(25) VALUE SPACES.            01480005
           05  FILLER                PIC X(39) VALUE SPACES.            01490005
                                                                        01500000
       01  H5-HEADING5.                                                 01510000
           05  FILLER                PIC X(02) VALUE SPACES.            01520000
           05  FILLER                PIC X(10) VALUE 'DEPT/CLASS'.      01530005
           05  FILLER                PIC X(03) VALUE SPACES.            01531007
           05  FILLER                PIC X(12) VALUE 'PRICE CHANGE'.    01532005
           05  FILLER                PIC X(01) VALUE SPACES.            01540007
           05  FILLER                PIC X(15) VALUE                    01550000
              'DEBIT ALLOWANCE'.                                        01560000
           05  FILLER                PIC X(10) VALUE SPACES.            01570010
           05  FILLER                PIC X(04) VALUE 'COST'.            01580000
           05  FILLER                PIC X(08) VALUE SPACES.            01590011
           05  FILLER                PIC X(06) VALUE 'RETAIL'.          01600000
                                                                        01620000
       01  DL1-DETAIL-LINE-1.                                           01630000
           05  FILLER                PIC X(03)     VALUE SPACES.        01640012
           05  DL1-DEPT-CLASS.                                          01650005
               10  DL1-DEPT          PIC 9999.                          01650107
               10  FILLER            PIC X(01)     VALUE '-'.           01650206
               10  DL1-CLASS         PIC 9999.                          01650305
           05  FILLER                PIC X(06)     VALUE SPACES.        01651008
           05  DL1-CENPPC-NBR        PIC ZZZZZZ9   VALUE SPACES.        01652005
           05  FILLER                PIC X(05)     VALUE SPACES.        01660012
           05  DL1-DR-ALW-NBR        PIC X(16)     VALUE SPACES.        01670000
           05  FILLER                PIC X(01)     VALUE SPACES.        01680010
           05  DL1-COST-AMT          PIC ZZZZZZZZ9.99-.                 01690000
           05  FILLER                PIC X(02)     VALUE SPACES.        01700011
           05  DL1-RETAIL-AMT        PIC ZZZZZZZZ9.99-.                 01710000
                                                                        01730000
       01  TL1-TOTAL-LINE-1.                                            01740000
           05  FILLER                PIC X(04)     VALUE SPACES.        01750012
           05  TL1-DESC              PIC X(13)     VALUE SPACES.        01760000
           05  FILLER                PIC X(30)     VALUE SPACES.        01770012
           05  TL1-COST-AMT          PIC ZZZZZZZZ9.99-.                 01780000
           05  FILLER                PIC X(02)     VALUE SPACES.        01790012
           05  TL1-RETAIL-AMT        PIC ZZZZZZZZ9.99-.                 01800000
                                                                        01820000
      /**************************************************************** 01830000
      * COPYBOOK - DA TRANSACTION FILE RECORD                           01840000
      ***************************************************************** 01850000
           COPY DARD105.                                                01860000
                                                                        01930000
      ****************************************************************  01940000
      * RECORD LAYOUT FOR CONTROL CARD FILE.                            01950000
      ****************************************************************  01960000
       01  CC-CONTROL-CARD.                                             01970000
           05  CC-CTL-DTE                   PIC X(10).                  01980000
           05  CC-CTL-FILLER                PIC X(70).                  01990000
                                                                        02000000
      ***************************************************************** 02201000
      ***************************************************************** 02202000
       PROCEDURE DIVISION.                                              02210000
      ***************************************************************** 02211000
                                                                        02220000
       0000-MAINLINE-DRIVER-SECTION.                                    02230000
                                                                        02240000
           PERFORM 1000-INITIALIZE.                                     02250000
                                                                        02260000
           PERFORM 2000-MAIN-PROCESS-LOOP                               02270000
               UNTIL PS-EOF-EXTRACT.                                    02280000
                                                                        02290000
           PERFORM 9000-EOJ.                                            02300000
                                                                        02310000
       9999-EXIT-PROGRAM.                                               02321000
           STOP RUN.                                                    02322000
                                                                        02323000
      /**************************************************************** 02324000
      *1000-INITIALIZE.                                                 02325000
      ***************************************************************** 02351000
       1000-INITIALIZE.                                                 02352000
                                                                        02360000
           OPEN INPUT  DA-TRANS-FILE-IN                                 02370003
                       CONTROL-CARD-FILE.                               02380000
           OPEN OUTPUT REPORT-FILE.                                     02390000
           PERFORM 8000-READ-CONTROL-CARD-FILE.                         02400000
                                                                        02410000
           PERFORM 8200-READ-EXTRACT.                                   02420000
                                                                        02430000
           MOVE CC-CTL-DTE   (3:2)           TO DP075O-RUN-YEAR.        02440000
           MOVE CC-CTL-DTE   (6:2)           TO DP075O-RUN-MONTH.       02450000
           MOVE CC-CTL-DTE   (9:2)           TO DP075O-RUN-DAY.         02460000
           MOVE FUNCTION CURRENT-DATE (9:2)  TO DP075O-RUN-HOUR.        02470000
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP075O-RUN-MINUTE.      02480000
           MOVE PC-DAKRP110-PGM              TO DP075O-PROGRAM-NAME.    02490000
           MOVE 1                            TO DP075O-REPORT-NUMBER.   02500000
                                                                        02510000
           PERFORM 4000-WRITE-REPORT-HEADING.                           02520000
           IF PS-EOF-EXTRACT                                            02530000
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            02540000
           ELSE                                                         02550000
               PERFORM 4200-SUB-HEADINGS                                02560000
           END-IF.                                                      02570000
                                                                        02580000
      /*****************************************************************02581000
      * 2000-MAIN-PROCESS-LOOP.                                         02582000
      ******************************************************************02584000
       2000-MAIN-PROCESS-LOOP.                                          02590000
                                                                        02600000
           IF DA105-DMM NOT EQUAL PV-PREV-DMM                           02610000
               PERFORM 5400-WRITE-DEPT-TOTALS                           02640000
               PERFORM 4000-WRITE-REPORT-HEADING                        02641014
               PERFORM 4200-SUB-HEADINGS                                02650000
           END-IF.                                                      02660000
                                                                        02670000
           MOVE DA105-DEPT-NBR         TO DL1-DEPT.                     02671005
           MOVE DA105-CL-NBR           TO DL1-CLASS.                    02672005
           MOVE DA105-CENPPC-NBR       TO DL1-CENPPC-NBR.               02680000
           MOVE DA105-DOC-NBR          TO DL1-DR-ALW-NBR.               02690000
           MOVE DA105-NET-CST-AMT TO DL1-COST-AMT.                      02700000
                                                                        02710000
           MOVE DA105-RTL-AMT          TO DL1-RETAIL-AMT.               02720000
                                                                        02730000
           ADD DA105-RTL-AMT           TO PA-DEPT-RTL.                  02740000
           ADD DA105-NET-CST-AMT       TO PA-DEPT-COST.                 02750000
                                                                        02760000
           PERFORM 5000-WRITE-REPORT-LINE.                              02770000
           PERFORM 8200-READ-EXTRACT.                                   02780000
                                                                        02800000
      /*****************************************************************02801000
      * 4000-WRITE-REPORT-HEADING                                       02802000
      ******************************************************************02804000
       4000-WRITE-REPORT-HEADING.                                       02810000
                                                                        02860000
           ADD 1                               TO PA-PAGE-COUNT.        02880000
           MOVE PA-PAGE-COUNT                  TO DP075O-PAGE-NUMBER.   02890000
           MOVE DP075O-STANDARD-HEADER-75-COLS TO REPORT-LINE.          02900002
           WRITE REPORT-LINE                                            02910002
                   AFTER ADVANCING PAGE.                                02920000
                                                                        02930000
           MOVE PC-DAK001-JOB                  TO H2-JOB-NAME.          02940000
           MOVE H2-HEADING2                    TO REPORT-LINE.          02950002
           WRITE REPORT-LINE                                            02960002
                   AFTER ADVANCING 1 LINE.                              02970000
                                                                        02980000
           MOVE 2                              TO PA-LINE-NO.           03040005
                                                                        03040100
      ******************************************************************03041000
      * 4200-SUB-HEADINGS.                                              03042000
      ******************************************************************03043000
       4200-SUB-HEADINGS.                                               03050000
                                                                        03060000
           IF PA-LINE-NO > PC-MAX-LINES                                 03070000
               PERFORM 4000-WRITE-REPORT-HEADING                        03080000
           END-IF.                                                      03090000
                                                                        03100000
           MOVE DA105-DMM      TO H4-DMM-NBR.                           03110005
           MOVE DA105-NAME-DMM TO H4-DMM-NAME.                          03130005
           MOVE H4-HEADING4    TO REPORT-LINE.                          03140002
           WRITE REPORT-LINE                                            03150002
               AFTER ADVANCING 2 LINES.                                 03160000
           MOVE H5-HEADING5    TO REPORT-LINE.                          03170002
           WRITE REPORT-LINE                                            03180002
               AFTER ADVANCING 1 LINES.                                 03190000
                                                                        03200000
           ADD 3 TO PA-LINE-NO.                                         03210000
           MOVE DA105-DMM       TO PV-PREV-DMM.                         03220003
                                                                        03230000
      /*****************************************************************03231000
      * 5000-WRITE-REPORT-LINE.                                         03232000
      ******************************************************************03233000
       5000-WRITE-REPORT-LINE.                                          03240000
                                                                        03250000
           IF PA-LINE-NO > PC-MAX-LINES                                 03260000
               PERFORM 4000-WRITE-REPORT-HEADING                        03270000
               PERFORM 4200-SUB-HEADINGS                                03280000
           END-IF.                                                      03290000
                                                                        03300000
           WRITE REPORT-LINE FROM DL1-DETAIL-LINE-1                     03310002
                  AFTER ADVANCING 1 LINES.                              03320000
           ADD 1 TO PA-LINE-NO.                                         03330000
                                                                        03340000
      ******************************************************************03341000
      * 5400-WRITE-DEPT-TOTALS.                                         03342000
      ******************************************************************03343000
       5400-WRITE-DEPT-TOTALS.                                          03350000
           MOVE PC-DMM-DESC      TO TL1-DESC.                           03360000
           MOVE PA-DEPT-RTL      TO TL1-RETAIL-AMT.                     03370000
           MOVE PA-DEPT-COST     TO TL1-COST-AMT.                       03380000
                                                                        03390000
           IF PA-LINE-NO > PC-MAX-LINES                                 03400000
               PERFORM 4000-WRITE-REPORT-HEADING                        03410000
               PERFORM 4200-SUB-HEADINGS                                03420000
           END-IF.                                                      03430000
                                                                        03440000
           WRITE REPORT-LINE FROM TL1-TOTAL-LINE-1                      03450002
                  AFTER ADVANCING 2 LINES.                              03460000
           ADD 2 TO PA-LINE-NO.                                         03470000
                                                                        03480000
           ADD  PA-DEPT-RTL      TO PA-TOTAL-RTL.                       03490000
           ADD  PA-DEPT-COST     TO PA-TOTAL-COST.                      03500000
                                                                        03510000
           MOVE 0                TO PA-DEPT-RTL                         03520000
                                    PA-DEPT-COST.                       03530000
                                                                        03550000
      ******************************************************************03551000
      * 5600-WRITE-RPT-TOTALS.                                          03552000
      ******************************************************************03553000
       5600-WRITE-RPT-TOTALS.                                           03560000
                                                                        03561000
           MOVE PC-TOTAL-DESC   TO TL1-DESC.                            03570000
           MOVE PA-TOTAL-RTL    TO TL1-RETAIL-AMT.                      03580000
           MOVE PA-TOTAL-COST   TO TL1-COST-AMT.                        03590000
                                                                        03600000
           IF PA-LINE-NO > PC-MAX-LINES                                 03610000
               PERFORM 4000-WRITE-REPORT-HEADING                        03620000
               PERFORM 4200-SUB-HEADINGS                                03630000
           END-IF.                                                      03640000
                                                                        03650000
           WRITE REPORT-LINE FROM TL1-TOTAL-LINE-1                      03660002
                  AFTER ADVANCING 3 LINES.                              03670000
                                                                        03680000
      /*****************************************************************03690000
      * 8000-READ-CONTROL-CARD-FILE.                                    03700000
      ******************************************************************03710000
       8000-READ-CONTROL-CARD-FILE.                                     04070000
                                                                        04080000
           READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD.                 04090000
                                                                        04100000
      ******************************************************************04101000
      * 8200-READ-EXTRACT.                                              04102000
      ******************************************************************04103000
       8200-READ-EXTRACT.                                               04110000
           READ DA-TRANS-FILE-IN INTO DA105-TRANSACTION-FILE            04120003
           AT END                                                       04130000
               SET PS-EOF-EXTRACT           TO TRUE                     04140000
           NOT AT END                                                   04150000
               ADD 1                        TO PA-TOTAL-READ            04160000
           END-READ.                                                    04170000
                                                                        04180000
      *************************************************************     04190000
      *  9000-EOJ IS PERFORMED FROM 0000-DAKRP110.  IT PRODUCES   *     04200000
      *  A 'NO ERROR MESSAGE' ON THE REPORT IF NONE WERE FOUND    *     04210000
      *  IF ERRORS WERE FOUND, THE RETURN CODE IS SET TO 4095     *     04220000
      *  WHICH IS USED TO ALERT THE ML TEAM VIA AN EMAIL THAT     *     04230000
      *  ERRORS OCCURED.  RECORD COUNTS ARE ALSO DISPLAYED.       *     04240000
      *************************************************************     04250000
       9000-EOJ.                                                        04260000
                                                                        04270000
           IF PA-TOTAL-READ = ZERO                                      04280000
              WRITE REPORT-LINE FROM PC-NO-INPUT-MSG                    04290002
                    AFTER ADVANCING 5 LINES                             04300000
           ELSE                                                         04310000
               PERFORM 5400-WRITE-DEPT-TOTALS                           04320000
               PERFORM 4000-WRITE-REPORT-HEADING                        04321015
               MOVE '00'            TO DA105-DMM                        04321116
               MOVE SPACES          TO DA105-NAME-DMM                   04321216
               PERFORM 4200-SUB-HEADINGS                                04322016
               PERFORM 5600-WRITE-RPT-TOTALS                            04330000
           END-IF.                                                      04340000
                                                                        04350000
           WRITE REPORT-LINE FROM PC-END-RPT-MSG                        04360002
                AFTER ADVANCING 5 LINES                                 04370000
                                                                        04380000
           CLOSE DA-TRANS-FILE-IN                                       04390003
                 CONTROL-CARD-FILE                                      04400000
                 REPORT-FILE.                                           04410000
                                                                        04420000
           DISPLAY SPACES.                                              04430000
           MOVE PA-TOTAL-READ        TO PV-DISP-NUMBER.                 04440000
           DISPLAY 'RECS READ    =    ' PV-DISP-NUMBER.                 04450000
                                                                        04460000
