000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.             RCKUT125.                                00030000
000400 AUTHOR.                 LARRY SCHLEICHER.                        00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN            SEPTEMBER,2003.                          00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL PERFORM THE CONFIRMATION OF THE FULL CASE     00100000
001100* UNITS FOR A PO.                                                 00110000
001200******************************************************************00120000
001300******************************************************************00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 DATA DIVISION.                                                   00150000
001600******************************************************************00160000
001700 WORKING-STORAGE SECTION.                                         00170000
001800******************************************************************00180000
001900                                                                  00190000
002000* COPY BOOK FOR CALLED MODULE PCKCS756                            00200000
002100     COPY PCWS238.                                                00210000
002200*                                                                 00220000
002300     COPY RCWS038.                                                00230000
002400*                                                                 00240000
002500     COPY RCWS041.                                                00250000
002600*                                                                 00260000
002700     COPY RCWS289.                                                00270000
002800*                                                                 00280000
002900     COPY SUWS047.                                                00290000
003000*                                                                 00300000
003100     COPY RCWS071.                                                00310000
003200*                                                                 00320000
003300***************************************************************** 00330000
003400*   RCWS074 - COPYBOOK IS USED FOR THE MODULE TO CALCULATE UNIT * 00340000
003500*             QUANTITIES AND CARTON COUNTS (RCKUT128)          .* 00350000
003600***************************************************************** 00360000
003700     COPY RCWS074.                                                00370000
003800                                                                  00380000
003900 01  DK-DB2-KEYS.                                                 00390000
004000     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00400000
004100     05  DK-RCVR-NBR                     PIC S9(09) COMP SYNC.    00410000
004200     05  DK-PREPK-ID                     PIC S9(04) COMP SYNC.    00420000
004300     05  DK-PREPK-ID-TRBL                PIC S9(04) COMP SYNC.    00430000
004400     05  DK-OPER-UNT-ID                  PIC S9(04) COMP SYNC.    00440000
004500     05  DK-LINE-NBR                     PIC S9(09) COMP SYNC.    00450000
004600     05  DK-LINE-NBR-TRBL                PIC S9(09) COMP SYNC.    00460000
004700     05  DK-PRCG-STAT-CDE                PIC  X(01).              00470000
004800                                                                  00480000
004900*                                                                 00490000
005000 01  PC-PROGRAM-CONSTANTS.                                        00500000
005100     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00510000
005200                     '9999-09-09-09.09.09.999999'.                00520000
005300     05  PC-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00530000
005400                                                     COMP SYNC.   00540000
005500     05  PC-UNTS-WRKD-PGRM-NAME       PIC X(08) VALUE 'PCKCS756'. 00550000
005600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKUT125'. 00560000
005700     05  PC-RCKUT124                  PIC X(08) VALUE 'RCKUT124'. 00570000
005800     05  PC-TRLR-UNLD-LIST            PIC X(08) VALUE 'RCKCS827'. 00580000
005900     05  PC-TRAILER-UNLOAD            PIC X(08) VALUE 'RCKUT129'. 00590000
006000     05  PC-HOT-COMPLETE              PIC X(08) VALUE 'PCKCS161'. 00600000
006100     05  PC-CHECK-IN-VERIFY           PIC X(08) VALUE 'SUKCS764'. 00610000
006200     05  PC-CHECK-IN-START            PIC X(08) VALUE 'SUKRF502'. 00620000
006300     05  PC-SUKCS771                  PIC X(08) VALUE 'SUKCS771'. 00630015
006400     05  PC-SWEEPER                   PIC X(08) VALUE 'RCKCS291'. 00640000
006500     05  PC-R                         PIC X(01) VALUE 'R'.        00650000
006600                                                                  00660000
006700 01  PS-PROGRAM-SWITCHES.                                         00670000
006800     05  PS-ERROR-SW                    PIC X(01)   VALUE 'Y'.    00680000
006900         88  PS-NO-ERROR                            VALUE 'Y'.    00690000
007000         88  PS-ERROR                               VALUE 'N'.    00700000
007100     05  PS-ROLLBACK-SW                 PIC X(01)   VALUE 'N'.    00710010
007200         88  PS-ROLLBACK                            VALUE 'Y'.    00720010
007300         88  PS-NO-ROLLBACK                         VALUE 'N'.    00730010
007400     05  PS-ARRIVED-SW                  PIC X(01)   VALUE 'Y'.    00740000
007500         88  PS-ARRIVED                             VALUE 'Y'.    00750000
007600         88  PS-NOT-ARRIVED                         VALUE 'N'.    00760000
007700     05  PS-UNITS-WORKED-ERROR-SW       PIC X(01)   VALUE 'N'.    00770000
007800         88  PS-UNITS-WORKED-ERROR                  VALUE 'Y'.    00780000
007900         88  PS-NO-UNITS-WORKED-ERROR               VALUE 'N'.    00790000
008000     05  PS-VERIFY-MODULE-SW            PIC X(01)   VALUE 'N'.    00800000
008100         88  PS-DONT-SUBMIT-E200                    VALUE 'N'.    00810000
008200         88  PS-DO-SUBMIT-E200                      VALUE 'Y'.    00820000
008300     05  PS-MORE-RECITM-SW              PIC X(01)   VALUE 'N'.    00830000
008400         88  PS-MORE-RECITM-YES                     VALUE 'Y'.    00840000
008500         88  PS-MORE-RECITM-NO                      VALUE 'N'.    00850000
008600     05  PS-RECITM-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    00860000
008700         88  PS-RECITM-ODD-UNITS-YES                VALUE 'Y'.    00870000
008800         88  PS-RECITM-ODD-UNITS-NO                 VALUE 'N'.    00880000
008900     05  PS-DISTDT-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    00890000
009000         88  PS-DISTDT-ODD-UNITS-YES                VALUE 'Y'.    00900000
009100         88  PS-DISTDT-ODD-UNITS-NO                 VALUE 'N'.    00910000
009200     05  PS-PREVIOUSLY-CONFIRMED-SW     PIC X(01)   VALUE 'N'.    00920000
009300         88  PS-PREVIOUSLY-CONFIRMED-YES            VALUE 'Y'.    00930000
009400         88  PS-PREVIOUSLY-CONFIRMED-NO             VALUE 'N'.    00940000
009500     05  PS-SUSPEND-CONFIRMATION-SW     PIC X(01)   VALUE 'N'.    00950000
009600         88  PS-SUSPEND-CONFIRMATION-YES            VALUE 'Y'.    00960000
009700         88  PS-SUSPEND-CONFIRMATION-NO             VALUE 'N'.    00970000
009800     05  PS-FIRST-PRPK-LNE-SW           PIC X(01)   VALUE 'Y'.    00980000
009900         88  PS-FIRST-PRPK-LNE                      VALUE 'Y'.    00990000
010000         88  PS-FIRST-PRPK-LNE-NO                   VALUE 'N'.    01000000
010100     05  PS-FIRST-TIME-SW               PIC X(01)   VALUE 'Y'.    01010007
010200         88  PS-FIRST-TIME                          VALUE 'Y'.    01020002
010300         88  PS-FIRST-TIME-NO                       VALUE 'N'.    01030002
010400                                                                  01040000
010500 01  PV-PROGRAM-VARIABLES.                                        01050000
010600     05  PV-NULL-IND                  PIC S9(04)  VALUE ZEROS     01060000
010700                                                  COMP SYNC.      01070000
010800     05  PV-HOLD-PREPK-ID             PIC S9(04)  VALUE ZEROS.    01080000
010900                                                                  01090000
011000     05  PV-STATUS-COUNTERS.                                      01100000
011100         10 PV-TRBL-RCVR-COUNT        PIC S9(04) VALUE ZERO       01110000
011200                                                    COMP SYNC.    01120000
011300     05  PV-CURRENT-TMST              PIC X(26).                  01130000
011400     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             01140000
011500         10 PV-CURRENT-DATE           PIC X(10).                  01150000
011600         10 FILLER                    PIC X(16).                  01160000
011700     05  PV-TMST                      PIC X(26).                  01170000
011800     05  FILLER REDEFINES PV-TMST.                                01180000
011900         10  PV-CCYY                  PIC X(04).                  01190000
012000         10  FILLER                   PIC X(01).                  01200000
012100         10  PV-MM                    PIC X(02).                  01210000
012200         10  FILLER                   PIC X(01).                  01220000
012300         10  PV-DD                    PIC X(02).                  01230000
012400         10  FILLER                   PIC X(01).                  01240000
012500         10  PV-HH                    PIC X(02).                  01250000
012600         10  FILLER                   PIC X(01).                  01260000
012700         10  PV-MIN                   PIC X(02).                  01270000
012800         10  FILLER                   PIC X(01).                  01280000
012900         10  PV-SEC                   PIC X(02).                  01290000
013000         10  FILLER                   PIC X(01).                  01300000
013100         10  FILLER                   PIC X(06).                  01310000
013200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01320000
013300                                                     COMP SYNC.   01330000
013400     05  PV-CICS-RESP                    PIC S9(09)  VALUE ZEROS  01340000
013500                                                     COMP SYNC.   01350000
013600     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01360000
013700     05  PV-RCVR-SEQ-NBR                 PIC  S9(9) COMP.         01370000
013800     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 01380000
013900     05  PV-DISPLAY-SQLCODE-2            PIC -9(05) VALUE ZEROES. 01390000
014000     05  PV-DISP-PO-NBR                  PIC 9(09).               01400000
014100     05  PV-DISP-RCVR-NBR                PIC 9(09).               01410000
014200     05  PV-DISP-LINE-NBR                PIC 9(09).               01420000
014300     05  PV-DISP-PREPK-ID                PIC 9(04).               01430000
014400     05  PV-DISP-CICS-RESPONSE           PIC  9(09)  VALUE ZEROS. 01440000
014500     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             01450000
014600     05  PV-DISP-FCLTY-ID                PIC   9(04).             01460000
014700     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               01470000
014800     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(09).               01480000
014900     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               01490000
015000*                                                                 01500000
015100     05  PV-TROUBLE-COUNT                PIC S9(09)  COMP.        01510000
015200     05  PV-TROUBLE-COUNT-LNE-PCK        PIC S9(09)  COMP.        01520000
015300*                                                                 01530000
015400                                                                  01540000
015500     EXEC SQL                                                     01550000
015600          INCLUDE TKRPRPM                                         01560000
015700     END-EXEC.                                                    01570000
015800                                                                  01580000
015900     EXEC SQL                                                     01590000
016000          INCLUDE TDISTDT                                         01600000
016100     END-EXEC.                                                    01610000
016200                                                                  01620000
016300     EXEC SQL                                                     01630000
016400          INCLUDE TDISTHD                                         01640000
016500     END-EXEC.                                                    01650000
016600                                                                  01660000
016700     EXEC SQL                                                     01670000
016800          INCLUDE TRECITM                                         01680000
016900     END-EXEC.                                                    01690000
017000                                                                  01700000
017100******************************************************************01710000
017200*  TROUBLE NOTIFICATION TABLE                                    *01720000
017300******************************************************************01730000
017400     EXEC SQL                                                     01740000
017500          INCLUDE TTRBNTF                                         01750000
017600     END-EXEC.                                                    01760000
017700                                                                  01770000
017800******************************************************************01780000
017900*  TROUBLE REASON CODE TABLE                                     *01790000
018000******************************************************************01800000
018100     EXEC SQL                                                     01810000
018200          INCLUDE TTRBRSN                                         01820000
018300     END-EXEC.                                                    01830000
018400                                                                  01840000
018500******************************************************************01850000
018600*  TROUBLE CONTROL BY REPORT NAME                                *01860000
018700******************************************************************01870000
018800     EXEC SQL                                                     01880000
018900          INCLUDE TTRBRCN                                         01890000
019000     END-EXEC.                                                    01900000
019100                                                                  01910000
019200******************************************************************01920000
019300*  COMMUNICATIONS AREA FOR DB2                                    01930000
019400******************************************************************01940000
019500     EXEC SQL                                                     01950000
019600         INCLUDE SQLCA                                            01960000
019700     END-EXEC.                                                    01970000
019800                                                                  01980000
019900     EXEC SQL                                                     01990000
020000          DECLARE PREPK-SEARCH-CSR CURSOR FOR                     02000000
020100           SELECT A.ORD_LNE_NBR                                   02010000
020200                , A.STATUS_CDE                                    02020000
020300                , A.PREPK_ODD_UNT_QTY                             02030000
020400             FROM TRECITM A                                       02040000
020500            WHERE A.ORD_NBR        = :DK-PO-NBR                   02050000
020600              AND A.REC_SEQ_NBR    = :DK-RCVR-NBR                 02060000
020700              AND A.PREPK_ID       = :DK-PREPK-ID                 02070000
020800         ORDER BY A.ORD_LNE_NBR                                   02080000
020900     END-EXEC.                                                    02090000
021000                                                                  02100000
021100******************************************************************02110000
021200 LINKAGE SECTION.                                                 02120000
021300 01  DFHCOMMAREA.                                                 02130000
021400     05  FILLER                         OCCURS  1 TO 4072 TIMES   02140000
021500                                      DEPENDING ON EIBCALEN.      02150000
021600         10  FILLER                   PIC X.                      02160000
021700******************************************************************02170000
021800 PROCEDURE DIVISION.                                              02180000
021900******************************************************************02190000
022000 0000-PROGRAM-MAINLINE.                                           02200000
022100     INITIALIZE PV-PROGRAM-VARIABLES                              02210000
022200                PS-PROGRAM-SWITCHES                               02220000
022300                RC041-FIELDS.                                     02230000
022400     MOVE DFHCOMMAREA              TO  RC041-FIELDS.              02240000
022500     MOVE RC041-OPER-UNT-ID        TO DK-OPER-UNT-ID.             02250000
022600                                                                  02260000
022700     PERFORM 9300-CHECK-LOGGING.                                  02270000
022800                                                                  02280000
022900     IF KRPRPM-FUNC-TXT = 'Y'                                     02290000
023000          MOVE RC041-PO-NBR TO PV-DISP-PO-NBR                     02300000
023100          MOVE RC041-REC-SEQ-NBR TO PV-DISP-RCVR-NBR              02310000
023200          MOVE RC041-PO-LNE-NBR TO PV-DISP-LINE-NBR               02320000
023300          STRING   ' RCKUT125 '                                   02330000
023400                   ' CALLED BY-'                                  02340000
023500                   RC041-PROGRAM-NAME                             02350000
023600                   ' PO = '                                       02360000
023700                   PV-DISP-PO-NBR '-'                             02370000
023800                   PV-DISP-RCVR-NBR '-'                           02380000
023900                   PV-DISP-LINE-NBR                               02390000
024000                   DELIMITED BY SIZE                              02400000
024100                                   INTO RC041-CRA-RET-MSG         02410000
024200             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     02420000
024300          PERFORM 9999-WRITE-TO-CSSL                              02430000
024400      END-IF.                                                     02440000
024500                                                                  02450000
024600     SET PS-FIRST-TIME    TO TRUE.                                02460014
024700     SET PS-NO-ERROR TO TRUE.                                     02470000
024800     SET PS-SUSPEND-CONFIRMATION-NO TO TRUE                       02480000
024900     SET PS-DO-SUBMIT-E200 TO TRUE.                               02490000
025000     SET PS-FIRST-PRPK-LNE TO TRUE.                               02500000
025100     IF RC041-PREPACK                                             02510000
025200         IF RC041-PREPACK-ID = 0                                  02520000
025300             SET PS-ERROR                                         02530000
025400                 RC041-NOT-SUCCESSFUL                             02540000
025500                 PS-DONT-SUBMIT-E200    TO TRUE                   02550000
025600             MOVE RC041-PO-NBR TO PV-DISP-PO-NBR                  02560000
025700             MOVE RC041-REC-SEQ-NBR TO PV-DISP-RCVR-NBR           02570000
025800             MOVE RC041-PO-LNE-NBR TO PV-DISP-LINE-NBR            02580000
025900             MOVE RC041-PREPACK-ID TO PV-DISP-PREPK-ID            02590000
026000             STRING   ' RCKUT125-0000-'                           02600000
026100                      ' PREPACK IND IS YES'                       02610000
026200                      ' CALLED BY-'                               02620000
026300                      RC041-PROGRAM-NAME                          02630000
026400                      ' PO = '                                    02640000
026500                      PV-DISP-PO-NBR                              02650000
026600                      ' RECV = '                                  02660000
026700                      PV-DISP-RCVR-NBR                            02670000
026800                      ' LINE  = '                                 02680000
026900                      PV-DISP-LINE-NBR                            02690000
027000                      ' PACK  = '                                 02700000
027100                      PV-DISP-PREPK-ID                            02710000
027200                      DELIMITED BY SIZE                           02720000
027300                                      INTO RC041-CRA-RET-MSG      02730000
027400             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     02740000
027500             PERFORM 9999-WRITE-TO-CSSL                           02750000
027600         ELSE                                                     02760000
027700             PERFORM 1000-CONFIRM-PRE-EDIT-PK                     02770000
027800             IF PS-NO-ERROR                                       02780000
027900                 PERFORM 3000-UPDATE-VERIFY-PREPK                 02790000
028000             END-IF                                               02800000
028100         END-IF                                                   02810000
028200     ELSE                                                         02820000
028300         MOVE RC041-PO-LNE-NBR TO DK-LINE-NBR                     02830000
028400         SET PS-PREVIOUSLY-CONFIRMED-NO TO TRUE                   02840000
028500         PERFORM 2000-CONFIRM-EDITS                               02850000
028600         IF PS-NO-ERROR AND PS-PREVIOUSLY-CONFIRMED-NO            02860000
028700             PERFORM 3200-UPDATE-VERIFY-FIELDS                    02870000
028800             IF DISTHD-PRCG-STAT-CDE = 'A'                        02880000
028900                 SET PS-DONT-SUBMIT-E200 TO TRUE                  02890000
029000             END-IF                                               02900000
029100         END-IF                                                   02910000
029200     END-IF.                                                      02920000
029300                                                                  02930000
029400                                                                  02940000
029500     IF  PS-PREVIOUSLY-CONFIRMED-YES                              02950000
029600         IF DISTHD-P2L-CART-CNT > 0 AND                           02960000
029700            DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST              02970000
029800            SET PS-DONT-SUBMIT-E200 TO TRUE                       02980000
029900         END-IF                                                   02990000
030000     END-IF.                                                      03000000
030100                                                                  03010000
030200     IF  PS-DO-SUBMIT-E200 AND                                    03020011
030300         PS-NO-ERROR                                              03030011
030400         PERFORM 4000-VEM-MODULE                                  03040000
030500     END-IF.                                                      03050000
030600     IF  PS-DO-SUBMIT-E200 AND                                    03060000
030700         RC038-VERIFY-YES AND                                     03070011
030800         PS-NO-ERROR                                              03080011
030900         IF DISTHD-PRCG-STAT-CDE NOT = 'R'                        03090000
031000            MOVE 'R'    TO DK-PRCG-STAT-CDE                       03100000
031100            PERFORM 8650-UPDATE-PRCG-STAT-CDE                     03110002
031200            IF RC041-PREPACK                                      03120002
031300               IF PS-FIRST-TIME                                   03130002
031400                   PERFORM 8700-TRACK-CONFIRMATION                03140002
031500                   SET PS-FIRST-TIME-NO  TO TRUE                  03150002
031600               ELSE                                               03160002
031700                   CONTINUE                                       03170002
031800               END-IF                                             03180002
031900            ELSE                                                  03190002
032000                PERFORM 8700-TRACK-CONFIRMATION                   03200002
032100            END-IF                                                03210002
032200         END-IF                                                   03220002
032300         PERFORM 5000-START-VERIFY-MODULE                         03230000
032400     END-IF.                                                      03240000
032500     MOVE RC041-FIELDS            TO DFHCOMMAREA.                 03250000
032600                                                                  03260000
032700     GOBACK.                                                      03270000
032800*----------------------------------------------------------------*03280000
032900 1000-CONFIRM-PRE-EDIT-PK.                                        03290000
033000                                                                  03300000
033100     SET  PS-MORE-RECITM-YES  TO  TRUE.                           03310000
033200                                                                  03320000
033300     MOVE RC041-PO-NBR      TO DK-PO-NBR.                         03330000
033400     MOVE RC041-REC-SEQ-NBR TO DK-RCVR-NBR.                       03340000
033500     MOVE RC041-PREPACK-ID  TO DK-PREPK-ID.                       03350000
033600                                                                  03360000
033700     PERFORM 8000-OPEN-PREPK-SEARCH-CSR.                          03370000
033800                                                                  03380000
033900     PERFORM 1100-PRE-EDIT-PACK                                   03390000
034000       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       03400000
034100                                                                  03410000
034200     PERFORM 8200-CLOSE-PREPK-SEARCH-CSR.                         03420000
034300                                                                  03430000
034400*----------------------------------------------------------------*03440000
034500 1100-PRE-EDIT-PACK.                                              03450000
034600                                                                  03460000
034700     PERFORM 8100-FETCH-PREPK-SEARCH-CSR.                         03470000
034800                                                                  03480000
034900     IF PS-MORE-RECITM-YES                                        03490000
035000         IF RECITM-PREPK-ODD-UNT-QTY > ZEROES                     03500000
035100             SET PS-RECITM-ODD-UNITS-YES TO TRUE                  03510000
035200         END-IF                                                   03520000
035300         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   03530000
035400         PERFORM 2000-CONFIRM-EDITS                               03540000
035500     END-IF.                                                      03550000
035600                                                                  03560000
035700 2000-CONFIRM-EDITS.                                              03570000
035800     MOVE RC041-PO-NBR      TO DK-PO-NBR.                         03580000
035900     MOVE RC041-REC-SEQ-NBR TO DK-RCVR-NBR.                       03590000
036000     MOVE RC041-PREPACK-ID  TO DK-PREPK-ID.                       03600000
036100                                                                  03610000
036200     PERFORM 8300-SELECT-TDISTHD.                                 03620000
036300     PERFORM 8400-SUM-TDISTDT.                                    03630000
036400                                                                  03640000
036500     IF RC041-PREPACK                                             03650000
036600       AND DISTDT-PREPK-ODD-UNT-QTY > ZEROES                      03660000
036700         SET PS-DISTDT-ODD-UNITS-YES TO TRUE                      03670000
036800     ELSE                                                         03680000
036900         IF RC041-PREPACK                                         03690001
037000             CONTINUE                                             03700001
037100         ELSE                                                     03710001
037200             IF DISTHD-PREPK-LNE-PRC-CDE = 'D'  OR                03720001
037300                DISTHD-PREPK-LNE-PRC-CDE = 'P'                    03730001
037400                 SET PS-ERROR                                     03740001
037500                     RC041-NOT-SUCCESSFUL                         03750001
037600                     PS-DONT-SUBMIT-E200    TO TRUE               03760001
037700                 MOVE RC041-PO-NBR TO PV-DISP-PO-NBR              03770001
037800                 MOVE RC041-REC-SEQ-NBR TO PV-DISP-RCVR-NBR       03780001
037900                 MOVE RC041-PO-LNE-NBR TO PV-DISP-LINE-NBR        03790001
038000                 MOVE RC041-PREPACK-ID TO PV-DISP-PREPK-ID        03800001
038100                 STRING   ' RCKUT125-2000-'                       03810001
038200                          ' NON-PREPACK IND AND D '               03820001
038300                          ' CALLED BY-'                           03830001
038400                          RC041-PROGRAM-NAME                      03840001
038500                          ' PO = '                                03850001
038600                          PV-DISP-PO-NBR                          03860001
038700                          ' RECV = '                              03870001
038800                          PV-DISP-RCVR-NBR                        03880001
038900                          ' LINE  = '                             03890001
039000                          PV-DISP-LINE-NBR                        03900001
039100                          ' PACK  = '                             03910001
039200                          PV-DISP-PREPK-ID                        03920001
039300                          DELIMITED BY SIZE                       03930001
039400                                          INTO RC041-CRA-RET-MSG  03940001
039500                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 03950001
039600                 PERFORM 9999-WRITE-TO-CSSL                       03960001
039700             END-IF                                               03970001
039800         END-IF                                                   03980001
039900     END-IF.                                                      03990001
040000                                                                  04000000
040100     EVALUATE TRUE                                                04010000
040200**   WHEN                                                         04020000
040300** SLH 06/18/04 STILL WANT TO CONFIRM SO IT VE AT 0               04030000
040400**     THERE ARE NO FULLCASE UNITS TO CONFIRM                     04040000
040500**        DISTDT-FCSE-SPLT-UNT-QTY  =  ZEROES  AND                04050000
040600**        DISTDT-INPK-SPLT-UNT-QTY  =  ZEROES  AND                04060000
040700**        DISTDT-FCSE-ACTL-UNT-QTY  =  ZEROES                     04070000
040800**           SET PS-DONT-SUBMIT-E200                              04080000
040900**               PS-ERROR            TO TRUE                      04090000
041000** GB 5/14/04 CONTINUE PROCESSING EVEN IF ALREADY CONFIRMED       04100000
041100     WHEN DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST           04110000
041200**      ALREADY CONFIRMED                                         04120000
041300             SET PS-PREVIOUSLY-CONFIRMED-YES TO TRUE              04130000
041400**           SET PS-DONT-SUBMIT-E200                              04140000
041500**               PS-ERROR            TO TRUE                      04150000
041600     END-EVALUATE.                                                04160000
041700                                                                  04170000
041800*----------------------------------------------------------------*04180000
041900 3000-UPDATE-VERIFY-PREPK.                                        04190000
042000                                                                  04200000
042100     SET PS-MORE-RECITM-YES  TO  TRUE.                            04210000
042200     SET PS-NO-ROLLBACK      TO  TRUE.                            04220010
042300                                                                  04230000
042400     MOVE RC041-PO-NBR       TO DK-PO-NBR.                        04240000
042500     MOVE RC041-REC-SEQ-NBR  TO DK-RCVR-NBR.                      04250000
042600     MOVE RC041-PREPACK-ID   TO DK-PREPK-ID.                      04260000
042700                                                                  04270000
042800     PERFORM 8000-OPEN-PREPK-SEARCH-CSR.                          04280000
042900                                                                  04290000
043000     PERFORM 3100-UPDATE-VERIFY-PREPK-LINE                        04300000
043100       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       04310000
043200                                                                  04320000
043300     IF PS-ROLLBACK                                               04330010
043400         CONTINUE                                                 04340010
043500     ELSE                                                         04350010
043600         PERFORM 8200-CLOSE-PREPK-SEARCH-CSR                      04360010
043700     END-IF.                                                      04370010
043800                                                                  04380000
043900     PERFORM 9902-SYNCPOINT.                                      04390000
044000                                                                  04400000
044100*----------------------------------------------------------------*04410000
044200 3100-UPDATE-VERIFY-PREPK-LINE.                                   04420000
044300                                                                  04430000
044400     PERFORM 8100-FETCH-PREPK-SEARCH-CSR.                         04440000
044500                                                                  04450000
044600* GB                                                              04460000
044700     MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                       04470000
044800     PERFORM 8300-SELECT-TDISTHD                                  04480000
044900* GB                                                              04490000
045000     IF PS-MORE-RECITM-YES                                        04500000
045100         PERFORM 3200-UPDATE-VERIFY-FIELDS                        04510000
045200         IF DISTHD-PRCG-STAT-CDE = 'A'                            04520000
045300             SET PS-DONT-SUBMIT-E200 TO TRUE                      04530000
045400         END-IF                                                   04540000
045500     END-IF.                                                      04550000
045600                                                                  04560000
045700 3200-UPDATE-VERIFY-FIELDS.                                       04570000
045800                                                                  04580000
045900     IF PS-SUSPEND-CONFIRMATION-NO                                04590000
046000        IF RC041-PREPACK                                          04600000
046100           IF PS-FIRST-PRPK-LNE                                   04610000
046200              PERFORM 4000-VEM-MODULE                             04620000
046300              SET PS-FIRST-PRPK-LNE-NO TO TRUE                    04630000
046400           END-IF                                                 04640000
046500        ELSE                                                      04650000
046600           PERFORM 4000-VEM-MODULE                                04660000
046700        END-IF                                                    04670000
046800     END-IF.                                                      04680008
046900                                                                  04690000
047000     IF RC038-OPEN-SYSTEM-AUDIT                                   04700000
047100        SET PS-SUSPEND-CONFIRMATION-YES                           04710000
047200            PS-DONT-SUBMIT-E200 TO TRUE                           04720000
047300        MOVE 'K'   TO DK-PRCG-STAT-CDE                            04730000
047400        PERFORM 8650-UPDATE-PRCG-STAT-CDE                         04740000
047500        IF RC041-PREPACK                                          04750002
047600           IF PS-FIRST-TIME                                       04760002
047700               PERFORM 8700-TRACK-CONFIRMATION                    04770002
047800               SET PS-FIRST-TIME-NO  TO TRUE                      04780002
047900           ELSE                                                   04790002
048000               CONTINUE                                           04800002
048100           END-IF                                                 04810002
048200        ELSE                                                      04820002
048300            PERFORM 8700-TRACK-CONFIRMATION                       04830002
048400        END-IF                                                    04840002
048500        IF (RC041-PROGRAM-NAME  = PC-TRAILER-UNLOAD)  OR          04850000
048600           (RC041-PROGRAM-NAME  = PC-HOT-COMPLETE)                04860000
048700           IF RC041-PREPACK                                       04870000
048800              IF RC041-PREPACK-ID = PV-HOLD-PREPK-ID              04880000
048900                 CONTINUE                                         04890000
049000              ELSE                                                04900000
049100                 PERFORM 8720-CALL-ADJUST-SYST-AUDIT              04910000
049200              END-IF                                              04920000
049300           ELSE                                                   04930000
049400              PERFORM 8720-CALL-ADJUST-SYST-AUDIT                 04940000
049500           END-IF                                                 04950000
049600        END-IF                                                    04960000
049700     ELSE                                                         04970000
049800        IF RC038-RECV-TROUBLE                                     04980000
049900           MOVE ZEROES TO PV-TROUBLE-COUNT                        04990000
050000           PERFORM 3500-CHECK-TROUBLE                             05000000
050100           IF PV-TROUBLE-COUNT > +0                               05010000
050200              SET PS-SUSPEND-CONFIRMATION-YES                     05020000
050300                  PS-DONT-SUBMIT-E200 TO TRUE                     05030000
050400              MOVE 'L'   TO DK-PRCG-STAT-CDE                      05040000
050500              PERFORM 8650-UPDATE-PRCG-STAT-CDE                   05050000
050600              IF RC041-PREPACK                                    05060002
050700                 IF PS-FIRST-TIME                                 05070002
050800                     PERFORM 8700-TRACK-CONFIRMATION              05080002
050900                     SET PS-FIRST-TIME-NO  TO TRUE                05090002
051000                 ELSE                                             05100002
051100                     CONTINUE                                     05110002
051200                 END-IF                                           05120002
051300              ELSE                                                05130002
051400                  PERFORM 8700-TRACK-CONFIRMATION                 05140002
051500              END-IF                                              05150002
051600           END-IF                                                 05160000
051700        ELSE                                                      05170000
051800           IF RC038-LINE-TROUBLE                                  05180000
051900              MOVE ZEROES TO PV-TROUBLE-COUNT                     05190000
052000                             PV-TROUBLE-COUNT-LNE-PCK             05200000
052100              PERFORM 3500-CHECK-TROUBLE                          05210000
052200              IF PV-TROUBLE-COUNT > +0                            05220000
052300                 PERFORM 3600-CHECK-TROUBLE-PCK-LNE               05230000
052400                 IF PV-TROUBLE-COUNT-LNE-PCK > +0                 05240000
052500                    SET PS-SUSPEND-CONFIRMATION-YES               05250000
052600                        PS-DONT-SUBMIT-E200 TO TRUE               05260000
052700                    MOVE 'L'   TO DK-PRCG-STAT-CDE                05270000
052800                    PERFORM 8650-UPDATE-PRCG-STAT-CDE             05280000
052900                    IF RC041-PREPACK                              05290002
053000                       IF PS-FIRST-TIME                           05300002
053100                          PERFORM 8700-TRACK-CONFIRMATION         05310002
053200                          SET PS-FIRST-TIME-NO  TO TRUE           05320002
053300                       ELSE                                       05330002
053400                          CONTINUE                                05340002
053500                       END-IF                                     05350002
053600                    ELSE                                          05360002
053700                        PERFORM 8700-TRACK-CONFIRMATION           05370002
053800                    END-IF                                        05380002
053900                 END-IF                                           05390000
054000              END-IF                                              05400000
054100           END-IF                                                 05410000
054200        END-IF                                                    05420000
054300     END-IF.                                                      05430008
054400                                                                  05440000
054500     IF PS-SUSPEND-CONFIRMATION-NO                                05450000
054600** HAS THE P2L BEEN UPLOADED YET?                                 05460000
054700     IF DISTHD-RSLTS-RCVD-TMST NOT = PC-DEFAULT-TMST              05470000
054800**     YES - P2L HAS BEEN UPLOADED                                05480000
054900         IF DISTDT-P2L-SPLT-UNT-QTY > ZERO                        05490000
055000             MOVE 'R'         TO DISTHD-PRCG-STAT-CDE             05500000
055100*            UPDATE FULLCASE FIELDS AND PROCESS CODE              05510000
055200             PERFORM 8500-VERIFY-UPDATE                           05520000
055300             IF RECITM-STATUS-CDE = 'VE'                          05530000
055400                 CONTINUE                                         05540000
055500             ELSE                                                 05550000
055600                 PERFORM 8450-CALL-RCKUT128                       05560000
055700                 IF PS-NO-ERROR                                   05570012
055800                     INITIALIZE PC238-COMM-AREA                   05580012
055900                     MOVE RC074-FCSE-ACTL-ITM-QTY TO              05590012
056000                                             PC238-WRKD-UNT-QTY   05600000
056100* GB -CONFIRM BASED ON FCSE UNITS FROM UNITS MODULE               05610000
056200*                COMPUTE PC238-WRKD-UNT-QTY =                     05620000
056300*                    DISTDT-FCSE-ACTL-UNT-QTY +                   05630000
056400*                                     DISTDT-PREPK-ODD-UNT-QTY    05640000
056500                     MOVE 'C'         TO PC238-TRANS-TYPE-CDE     05650012
056600                     MOVE DISTHD-OPER-UNT-ID TO                   05660013
056700                                         PC238-WRKD-OPER-UNT-ID   05670013
056800                     PERFORM 9000-UPDATE-UNITS-WRKD               05680012
056900                 END-IF                                           05690012
057000             END-IF                                               05700012
057100*                                                                 05710000
057200         ELSE                                                     05720000
057300             IF  PS-DO-SUBMIT-E200 AND RC041-PREPACK AND          05730000
057400                 RC038-VERIFY-YES                                 05740000
057500                 IF DISTHD-PRCG-STAT-CDE NOT = 'R'                05750000
057600                    MOVE 'R'    TO DK-PRCG-STAT-CDE               05760000
057700                    PERFORM 8650-UPDATE-PRCG-STAT-CDE             05770000
057800                    IF RC041-PREPACK                              05780002
057900                       IF PS-FIRST-TIME                           05790002
058000                          PERFORM 8700-TRACK-CONFIRMATION         05800002
058100                          SET PS-FIRST-TIME-NO  TO TRUE           05810002
058200                       ELSE                                       05820002
058300                          CONTINUE                                05830002
058400                       END-IF                                     05840002
058500                    ELSE                                          05850002
058600                        PERFORM 8700-TRACK-CONFIRMATION           05860002
058700                    END-IF                                        05870002
058800                 END-IF                                           05880000
058900             END-IF                                               05890000
059000*                                                                 05900000
059100         END-IF                                                   05910000
059200     ELSE                                                         05920000
059300*        PACK TO LIGHT HAS NOT BEEN WORKED YET, UPDATE FCSE FIELDS05930000
059400        IF  DISTHD-P2L-CART-CNT > 0                               05940000
059500            SET PS-DONT-SUBMIT-E200 TO TRUE                       05950000
059600        END-IF                                                    05960000
059700        IF  DISTHD-FCSE-CART-CNT = 0                              05970000
059800               AND DISTHD-INPK-CART-CNT = 0                       05980000
059900            SET PS-DONT-SUBMIT-E200 TO TRUE                       05990000
060000        ELSE                                                      06000000
060100            IF DISTHD-PRCG-STAT-CDE = 'A'                         06010000
060200                MOVE 'A'         TO DISTHD-PRCG-STAT-CDE          06020000
060300            ELSE                                                  06030000
060400                IF DISTDT-P2L-SPLT-UNT-QTY > ZERO                 06040000
060500                   MOVE 'B'          TO DISTHD-PRCG-STAT-CDE      06050000
060600                ELSE                                              06060000
060700                   MOVE 'R'          TO DISTHD-PRCG-STAT-CDE      06070000
060800                END-IF                                            06080000
060900            END-IF                                                06090000
061000            PERFORM 8600-CONFIRM-UPDATE                           06100000
061100            PERFORM 8700-TRACK-CONFIRMATION                       06110000
061200            IF PS-NO-ERROR                                        06120000
061300                                                                  06130000
061400              IF RECITM-STATUS-CDE = 'VE'                         06140000
061500                  CONTINUE                                        06150000
061600              ELSE                                                06160000
061700                  PERFORM 8450-CALL-RCKUT128                      06170000
061800                  IF PS-NO-ERROR                                  06180012
061900                      INITIALIZE PC238-COMM-AREA                  06190012
062000                      MOVE RC074-FCSE-ACTL-ITM-QTY TO             06200012
062100                                       PC238-WRKD-UNT-QTY         06210000
062200*              PERFORM 8400-SUM-TDISTDT                           06220000
062300*              COMPUTE PC238-WRKD-UNT-QTY =                       06230000
062400*                DISTDT-FCSE-ACTL-UNT-QTY + DISTDT-PREPK-ODD-UNT-Q06240000
062500                      MOVE 'C'            TO PC238-TRANS-TYPE-CDE 06250012
062600*              PERFORM 8300-SELECT-TDISTHD                        06260000
062700                      MOVE DISTHD-OPER-UNT-ID TO                  06270012
062800                                          PC238-WRKD-OPER-UNT-ID  06280012
062900                      PERFORM 9000-UPDATE-UNITS-WRKD              06290012
063000                  END-IF                                          06300012
063100              END-IF                                              06310012
063200            END-IF                                                06320000
063300        END-IF                                                    06330000
063400     END-IF                                                       06340008
063500     END-IF.                                                      06350008
063600                                                                  06360000
063700     IF NOT RC041-PREPACK AND PS-NO-ERROR                         06370008
063800         PERFORM 9902-SYNCPOINT                                   06380008
063900     END-IF                                                       06390008
064000     IF PS-ERROR                                                  06400008
064100         PERFORM 9905-ROLLBACK                                    06410008
064200         SET PS-ROLLBACK      TO  TRUE                            06420010
064300     END-IF.                                                      06430008
064400                                                                  06440000
064500*----------------------------------------------------------------*06450000
064600* CHECK IF PO/RECEIVER IS IN TROUBLE                             *06460000
064700* EXCEPTIONS ARE STORAGE TROUBLE (999,301,998,)                   06470000
064800*----------------------------------------------------------------*06480000
064900 3500-CHECK-TROUBLE.                                              06490000
065000     MOVE ZEROES                   TO PV-TROUBLE-COUNT.           06500000
065100                                                                  06510000
065200     EXEC SQL                                                     06520000
065300        SELECT COUNT(*)                                           06530000
065400          INTO :PV-TROUBLE-COUNT                                  06540000
065500          FROM TTRBNTF A                                          06550000
065600              ,TTRBRSN C                                          06560000
065700         WHERE A.PO_NBR       =  :DK-PO-NBR                       06570000
065800           AND A.REC_SEQ_NBR  =  :DK-RCVR-NBR                     06580000
065900           AND A.RESOLVED_IND IN ('N','I','R')                    06590000
066000           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    06600000
066100           AND C.NOTIF_IND    =  'T'                              06610000
066200           AND NOT EXISTS                                         06620000
066300              ( SELECT *                                          06630000
066400                FROM  TTRBRCN B                                   06640000
066500                WHERE B.RPT_PGM_NM  = 'RCKUT125'                  06650000
066600                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         06660000
066700     END-EXEC                                                     06670000
066800                                                                  06680000
066900     EVALUATE TRUE                                                06690000
067000         WHEN SQLCODE = ZERO                                      06700000
067100         WHEN SQLCODE = +100                                      06710000
067200              CONTINUE                                            06720000
067300                                                                  06730000
067400         WHEN SQLWARN0 NOT = SPACES                               06740000
067500         WHEN SQLCODE < ZERO                                      06750000
067600         WHEN SQLCODE > ZERO                                      06760000
067700             SET PS-ERROR                                         06770000
067800                 RC041-INVALID-SQL    TO TRUE                     06780011
067900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       06790000
068000             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           06800000
068100             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         06810000
068200             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         06820000
068300             STRING   ' RCKUT125-3500-'                           06830000
068400                      ' CALLED BY-'                               06840000
068500                      RC041-PROGRAM-NAME                          06850011
068600                      '  SQLCODE='                                06860000
068700                      PV-DISPLAY-SQLCODE                          06870000
068800                      ' PO = '                                    06880000
068900                      PV-DISP-PO-NBR                              06890000
069000                      ' RECV = '                                  06900000
069100                      PV-DISP-RCVR-NBR                            06910000
069200                      ' LINE  = '                                 06920000
069300                      PV-DISP-LINE-NBR                            06930000
069400                      DELIMITED BY SIZE                           06940000
069500                                      INTO RC041-CRA-RET-MSG      06950011
069600             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     06960011
069700             PERFORM 9999-WRITE-TO-CSSL                           06970000
069800     END-EVALUATE.                                                06980000
069900                                                                  06990000
070000 3600-CHECK-TROUBLE-PCK-LNE.                                      07000000
070100     IF RC041-PREPACK                                             07010000
070200        MOVE RC041-PREPACK-ID  TO DK-PREPK-ID-TRBL                07020000
070300        MOVE ZEROES            TO DK-LINE-NBR-TRBL                07030000
070400     ELSE                                                         07040000
070500        MOVE RC041-PO-LNE-NBR  TO DK-LINE-NBR-TRBL                07050000
070600        MOVE ZEROES            TO DK-PREPK-ID-TRBL                07060000
070700     END-IF                                                       07070000
070800                                                                  07080000
070900     EXEC SQL                                                     07090000
071000          SELECT COUNT(*)                                         07100000
071100          INTO  :PV-TROUBLE-COUNT-LNE-PCK :PV-NULL-IND            07110000
071200          FROM   TTRBNTF A                                        07120000
071300                ,TTRBRSN B                                        07130000
071400          WHERE  A.PO_NBR           =  :DK-PO-NBR                 07140000
071500          AND    A.REC_SEQ_NBR      =  :DK-RCVR-NBR               07150000
071600          AND  ((A.PO_LNE_NBR       =  :DK-LINE-NBR-TRBL          07160000
071700          AND    B.TRBL_LVL_IND     <>  'M')                      07170000
071800           OR   (A.PREPK_ID         = :DK-PREPK-ID-TRBL           07180000
071900          AND    B.TRBL_LVL_IND     =  'M'))                      07190000
072000          AND    A.RESOLVED_IND    IN  ('N','I','R')              07200000
072100          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             07210000
072200          AND    B.NOTIF_IND        =  'T'                        07220000
072300     END-EXEC                                                     07230000
072400                                                                  07240000
072500     EVALUATE TRUE                                                07250000
072600         WHEN SQLCODE = ZERO                                      07260000
072700         WHEN SQLCODE = +100                                      07270000
072800              CONTINUE                                            07280000
072900                                                                  07290000
073000         WHEN SQLWARN0 NOT = SPACES                               07300000
073100         WHEN SQLCODE < ZERO                                      07310000
073200         WHEN SQLCODE > ZERO                                      07320000
073300             SET PS-ERROR                                         07330000
073400                 RC041-INVALID-SQL    TO TRUE                     07340011
073500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       07350000
073600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           07360000
073700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         07370000
073800             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         07380000
073900             MOVE DK-PREPK-ID-TRBL    TO PV-DISP-PREPK-ID         07390000
074000             STRING   ' RCKUT125-3600-'                           07400000
074100                      ' CALLED BY-'                               07410000
074200                      RC041-PROGRAM-NAME                          07420011
074300                      '  SQLCODE='                                07430000
074400                      PV-DISPLAY-SQLCODE                          07440000
074500                      ' PO = '                                    07450000
074600                      PV-DISP-PO-NBR                              07460000
074700                      ' RECV = '                                  07470000
074800                      PV-DISP-RCVR-NBR                            07480000
074900                      ' LINE  = '                                 07490000
075000                      PV-DISP-LINE-NBR                            07500000
075100                      ' PACK  = '                                 07510000
075200                      PV-DISP-PREPK-ID                            07520000
075300                      DELIMITED BY SIZE                           07530000
075400                                      INTO RC041-CRA-RET-MSG      07540011
075500             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     07550011
075600             PERFORM 9999-WRITE-TO-CSSL                           07560000
075700     END-EVALUATE.                                                07570000
075800                                                                  07580000
075900 4000-VEM-MODULE.                                                 07590000
076000                                                                  07600000
076100     INITIALIZE RC038-FIELDS.                                     07610000
076200     MOVE RC041-PO-NBR              TO RC038-PO-NBR               07620000
076300     MOVE RC041-REC-SEQ-NBR         TO RC038-REC-SEQ-NBR          07630000
076400     MOVE RC041-PO-LNE-NBR          TO RC038-PO-LNE-NBR           07640000
076500     MOVE RC041-PREPACK-ID          TO RC038-PREPACK-ID           07650000
076600     MOVE RC041-OPER-UNT-ID         TO RC038-OPER-UNT-ID          07660000
076700     MOVE RC041-FCLTY-ID            TO RC038-FCLTY-ID             07670000
076800     MOVE RC041-PKGNG-CDE           TO RC038-PKGNG-CDE            07680000
076900     MOVE RC041-PBS-IND             TO RC038-PBS-IND              07690000
077000     MOVE RC041-USER-ID             TO RC038-USER-ID              07700000
077100     MOVE RC041-PROGRAM-NAME        TO RC038-PROGRAM-NAME         07710000
077200     MOVE RC041-VERIFY-SW           TO RC038-VERIFY-SW            07720000
077300     MOVE RC041-RCVR-OPER-UNT-ID    TO RC038-RCVR-OPER-UNT-ID     07730000
077400     MOVE RC041-PROCESS-LEVEL-SW    TO RC038-PROCESS-LEVEL-SW     07740000
077500     MOVE LENGTH OF RC038-FIELDS         TO PV-COMMAREA-LENGTH.   07750000
077600                                                                  07760000
077700     EXEC CICS                                                    07770000
077800         LINK PROGRAM  (PC-RCKUT124)                              07780000
077900              COMMAREA (RC038-FIELDS)                             07790000
078000              LENGTH   (PV-COMMAREA-LENGTH)                       07800000
078100              RESP     (PV-CICS-RESP)                             07810000
078200     END-EXEC.                                                    07820000
078300                                                                  07830000
078400     EVALUATE TRUE                                                07840000
078500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     07850000
078600             IF  RC038-INVALID-SQL     OR                         07860000
078700                 RC038-DATABASE-BUSY                              07870000
078800                 STRING ' RCKUT125 - '        DELIMITED BY SIZE   07880000
078900                        '4000-VEM-MODULE  '   DELIMITED BY SIZE   07890000
079000                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   07900000
079100                        RC038-SUCCESS-IND     DELIMITED BY SIZE   07910000
079200                                         INTO RC041-CRA-RET-MSG   07920011
079300                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 07930011
079400                 PERFORM 9999-WRITE-TO-CSSL                       07940000
079500                 SET RC041-NOT-SUCCESSFUL TO TRUE                 07950011
079600                                                                  07960000
079700             END-IF                                               07970000
079800         WHEN OTHER                                               07980000
079900             STRING ' RCKUT125 (OTHER) -' DELIMITED BY SIZE       07990000
080000                    '4000-VEM-MODULE  '   DELIMITED BY SIZE       08000000
080100                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       08010000
080200                    RC038-SUCCESS-IND     DELIMITED BY SIZE       08020000
080300                                         INTO RC041-CRA-RET-MSG   08030011
080400                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 08040011
080500             PERFORM 9999-WRITE-TO-CSSL                           08050000
080600             SET RC041-NOT-SUCCESSFUL TO TRUE                     08060011
080700                                                                  08070000
080800     END-EVALUATE.                                                08080000
080900                                                                  08090000
081000*----------------------------------------------------------------*08100000
081100 5000-START-VERIFY-MODULE.                                        08110000
081200                                                                  08120000
081300     IF  (DISTHD-FCSE-CART-CNT >  +0  OR                          08130000
081400          DISTHD-INPK-CART-CNT >  +0)                             08140000
081500          IF  DISTHD-P2L-CART-CNT  >  +0                          08150000
081600              SET RC289-P2L-CASE-PROCESS  TO  TRUE                08160000
081700          ELSE                                                    08170000
081800              SET RC289-CASE-PROCESS  TO  TRUE                    08180000
081900          END-IF                                                  08190000
082000     ELSE                                                         08200000
082100         IF  DISTHD-P2L-CART-CNT  >  +0                           08210000
082200             SET RC289-P2L-PROCESS   TO  TRUE                     08220000
082300         END-IF                                                   08230000
082400     END-IF.                                                      08240000
082500                                                                  08250000
082600     SET  RC289-NO-INV-CYCLE         TO TRUE.                     08260000
082700     MOVE DK-PO-NBR              TO RC289-ORD-NBR.                08270000
082800     MOVE DK-RCVR-NBR            TO RC289-RCVR-SEQ-NBR.           08280000
082900*** WILL THIS LINE NUMBER BE CORRECT FOR PREPACK ORDERS???        08290000
083000     IF RC041-PREPACK                                             08300000
083100        MOVE RC041-PO-LNE-NBR       TO RC289-ORD-LNE-NBR          08310000
083200     ELSE                                                         08320000
083300         MOVE DK-LINE-NBR            TO RC289-ORD-LNE-NBR         08330000
083400     END-IF                                                       08340000
083500                                                                  08350000
083600     MOVE RC038-PKGNG-CDE          TO RC289-PACKAGE-TYPE-CDE      08360000
083700     MOVE DISTHD-PREPK-LNE-PRC-CDE TO RC289-DISTHD-PROC-TYPE      08370000
083800                                                                  08380000
083900     MOVE RC041-PROGRAM-NAME       TO RC289-CALLING-PROGRAM.      08390000
084000     MOVE RC041-USER-ID            TO RC289-USER-ID.              08400000
084100                                                                  08410000
084200     EVALUATE TRUE                                                08420000
084300        WHEN RC041-PROGRAM-NAME = PC-TRAILER-UNLOAD               08430000
084400        WHEN RC041-PROGRAM-NAME = PC-TRLR-UNLD-LIST               08440000
084500          SET RC289-VERIF-TRLR-UNLOAD TO TRUE                     08450000
084600        WHEN RC041-PROGRAM-NAME = PC-HOT-COMPLETE                 08460000
084700          SET RC289-VERIF-HOT-COMPLETE TO TRUE                    08470000
084800        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-VERIFY              08480000
084900        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-START               08490000
085000        WHEN RC041-PROGRAM-NAME = PC-SUKCS771                     08500015
085100          SET RC289-VERIF-CHECK-IN TO TRUE                        08510000
085200        WHEN RC041-PROGRAM-NAME = PC-SWEEPER                      08520000
085300          SET RC289-VERIF-SWEEPER  TO TRUE                        08530000
085400     END-EVALUATE                                                 08540000
085500                                                                  08550000
085600     EXEC CICS                                                    08560000
085700          START TRANSID ('E200')                                  08570000
085800               FROM (RC289-COMMAREA-FOR-E200)                     08580000
085900     END-EXEC.                                                    08590000
086000                                                                  08600000
086100*----------------------------------------------------------------*08610000
086200 8000-OPEN-PREPK-SEARCH-CSR.                                      08620000
086300                                                                  08630000
086400     EXEC SQL                                                     08640000
086500         OPEN PREPK-SEARCH-CSR                                    08650000
086600     END-EXEC.                                                    08660000
086700                                                                  08670000
086800     EVALUATE TRUE                                                08680000
086900         WHEN SQLCODE = ZERO                                      08690000
087000             SET PS-MORE-RECITM-YES TO TRUE                       08700000
087100                                                                  08710000
087200         WHEN SQLWARN0 NOT = SPACE                                08720000
087300         WHEN SQLCODE  NOT = ZERO                                 08730000
087400             SET PS-ERROR                                         08740000
087500                 RC041-INVALID-SQL    TO TRUE                     08750011
087600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       08760000
087700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           08770000
087800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         08780000
087900             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         08790000
088000             STRING   ' RCKUT125-8000-'                           08800000
088100                      ' CALLED BY-'                               08810000
088200                      RC041-PROGRAM-NAME                          08820011
088300                      '  SQLCODE='                                08830000
088400                      PV-DISPLAY-SQLCODE                          08840000
088500                      ' PO = '                                    08850000
088600                      PV-DISP-PO-NBR                              08860000
088700                      ' RECV = '                                  08870000
088800                      PV-DISP-RCVR-NBR                            08880000
088900                      ' PACK  = '                                 08890000
089000                      PV-DISP-PREPK-ID                            08900000
089100                      DELIMITED BY SIZE                           08910000
089200                                      INTO RC041-CRA-RET-MSG      08920011
089300                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 08930011
089400             PERFORM 9999-WRITE-TO-CSSL                           08940000
089500     END-EVALUATE.                                                08950000
089600                                                                  08960000
089700*----------------------------------------------------------------*08970000
089800 8100-FETCH-PREPK-SEARCH-CSR.                                     08980000
089900                                                                  08990000
090000     EXEC SQL                                                     09000000
090100         FETCH PREPK-SEARCH-CSR                                   09010000
090200          INTO :RECITM-ORD-LNE-NBR                                09020000
090300             , :RECITM-STATUS-CDE                                 09030000
090400             , :RECITM-PREPK-ODD-UNT-QTY                          09040000
090500     END-EXEC.                                                    09050000
090600                                                                  09060000
090700     EVALUATE TRUE                                                09070000
090800         WHEN SQLCODE = ZERO                                      09080000
090900             IF RECITM-PREPK-ODD-UNT-QTY > ZERO                   09090000
091000                 SET PS-RECITM-ODD-UNITS-YES TO TRUE              09100000
091100             END-IF                                               09110000
091200                                                                  09120000
091300         WHEN SQLCODE = +100                                      09130000
091400             MOVE SPACES TO RECITM-STATUS-CDE                     09140000
091500             SET PS-MORE-RECITM-NO TO TRUE                        09150000
091600                                                                  09160000
091700         WHEN SQLWARN0 NOT = SPACE                                09170000
091800         WHEN SQLCODE < ZERO                                      09180000
091900         WHEN SQLCODE > ZERO                                      09190000
092000             SET PS-ERROR                                         09200000
092100                 RC041-INVALID-SQL    TO TRUE                     09210011
092200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       09220000
092300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           09230000
092400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         09240000
092500             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         09250000
092600             STRING   ' RCKUT125-8100-'                           09260000
092700                      ' CALLED BY-'                               09270000
092800                      RC041-PROGRAM-NAME                          09280011
092900                      '  SQLCODE='                                09290000
093000                      PV-DISPLAY-SQLCODE                          09300000
093100                      ' PO = '                                    09310000
093200                      PV-DISP-PO-NBR                              09320000
093300                      ' RECV = '                                  09330000
093400                      PV-DISP-RCVR-NBR                            09340000
093500                      ' PACK  = '                                 09350000
093600                      PV-DISP-PREPK-ID                            09360000
093700                      DELIMITED BY SIZE                           09370000
093800                                      INTO RC041-CRA-RET-MSG      09380011
093900                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 09390011
094000             PERFORM 9999-WRITE-TO-CSSL                           09400000
094100     END-EVALUATE.                                                09410000
094200                                                                  09420000
094300*----------------------------------------------------------------*09430000
094400 8200-CLOSE-PREPK-SEARCH-CSR.                                     09440000
094500                                                                  09450000
094600     EXEC SQL                                                     09460000
094700         CLOSE PREPK-SEARCH-CSR                                   09470000
094800     END-EXEC.                                                    09480000
094900                                                                  09490000
095000     EVALUATE TRUE                                                09500000
095100         WHEN SQLCODE = ZERO                                      09510000
095200             CONTINUE                                             09520000
095300                                                                  09530000
095400         WHEN SQLWARN0 NOT = SPACE                                09540000
095500         WHEN SQLCODE  NOT = ZERO                                 09550000
095600             SET PS-ERROR                                         09560000
095700                 RC041-INVALID-SQL    TO TRUE                     09570011
095800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       09580000
095900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           09590000
096000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         09600000
096100             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         09610000
096200             STRING   ' RCKUT125-8200-'                           09620000
096300                      ' CALLED BY-'                               09630000
096400                      RC041-PROGRAM-NAME                          09640011
096500                      '  SQLCODE='                                09650000
096600                      PV-DISPLAY-SQLCODE                          09660000
096700                      ' PO = '                                    09670000
096800                      PV-DISP-PO-NBR                              09680000
096900                      ' RECV = '                                  09690000
097000                      PV-DISP-RCVR-NBR                            09700000
097100                      ' PACK  = '                                 09710000
097200                      PV-DISP-PREPK-ID                            09720000
097300                      DELIMITED BY SIZE                           09730000
097400                                      INTO RC041-CRA-RET-MSG      09740011
097500                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 09750011
097600             PERFORM 9999-WRITE-TO-CSSL                           09760000
097700     END-EVALUATE.                                                09770000
097800                                                                  09780000
097900 8300-SELECT-TDISTHD.                                             09790000
098000                                                                  09800000
098100     INITIALIZE DCLTDISTHD.                                       09810000
098200     EXEC SQL                                                     09820000
098300         SELECT FCSE_CART_CNT                                     09830000
098400            ,   RSLTS_RCVD_TMST                                   09840000
098500            ,   FCSE_CNFRMN_TMST                                  09850000
098600            ,   PRCG_STAT_CDE                                     09860000
098700            ,   P2L_CART_CNT                                      09870000
098800            ,   INPK_CART_CNT                                     09880000
098900            ,   PREPK_LNE_PRC_CDE                                 09890000
099000            ,   OPER_UNT_ID                                       09900000
099100            ,   FCSE_FCLTY_AREA_ID                                09910000
099200            INTO :DISTHD-FCSE-CART-CNT                            09920000
099300            ,    :DISTHD-RSLTS-RCVD-TMST                          09930000
099400            ,    :DISTHD-FCSE-CNFRMN-TMST                         09940000
099500            ,    :DISTHD-PRCG-STAT-CDE                            09950000
099600            ,    :DISTHD-P2L-CART-CNT                             09960000
099700            ,    :DISTHD-INPK-CART-CNT                            09970000
099800            ,    :DISTHD-PREPK-LNE-PRC-CDE                        09980000
099900            ,    :DISTHD-OPER-UNT-ID                              09990000
100000            ,    :DISTHD-FCSE-FCLTY-AREA-ID                       10000000
100100            FROM  TDISTHD                                         10010000
100200          WHERE ORD_NBR                  = :DK-PO-NBR             10020000
100300            AND RCVR_SEQ_NBR             = :DK-RCVR-NBR           10030000
100400            AND ORD_LNE_NBR              = :DK-LINE-NBR           10040000
100500            WITH UR                                               10050000
100600     END-EXEC.                                                    10060000
100700                                                                  10070000
100800     EVALUATE TRUE                                                10080000
100900         WHEN SQLCODE = ZERO                                      10090000
101000              CONTINUE                                            10100000
101100                                                                  10110000
101200         WHEN SQLWARN0 NOT = SPACES                               10120000
101300         WHEN SQLCODE < ZERO                                      10130000
101400         WHEN SQLCODE > ZERO                                      10140000
101500             SET PS-ERROR                                         10150000
101600                 RC041-INVALID-SQL    TO TRUE                     10160011
101700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10170000
101800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10180000
101900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10190000
102000             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         10200000
102100             STRING   ' RCKUT125-8300-'                           10210000
102200                      ' CALLED BY-'                               10220000
102300                      RC041-PROGRAM-NAME                          10230011
102400                      '  SQLCODE='                                10240000
102500                      PV-DISPLAY-SQLCODE                          10250000
102600                      ' PO = '                                    10260000
102700                      PV-DISP-PO-NBR                              10270000
102800                      ' RECV = '                                  10280000
102900                      PV-DISP-RCVR-NBR                            10290000
103000                      ' LINE  = '                                 10300000
103100                      PV-DISP-LINE-NBR                            10310000
103200                      DELIMITED BY SIZE                           10320000
103300                                      INTO RC041-CRA-RET-MSG      10330011
103400                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 10340011
103500             PERFORM 9999-WRITE-TO-CSSL                           10350000
103600     END-EVALUATE.                                                10360000
103700                                                                  10370000
103800 8400-SUM-TDISTDT.                                                10380000
103900                                                                  10390000
104000      EXEC SQL                                                    10400000
104100         SELECT                                                   10410000
104200             SUM(P2L_SPLT_UNT_QTY)                                10420000
104300           , SUM(ACTL_ALLOC_QTY)                                  10430000
104400           , SUM(FCSE_SPLT_UNT_QTY)                               10440000
104500           , SUM(INPK_SPLT_UNT_QTY)                               10450000
104600           , SUM(FCSE_ACTL_UNT_QTY)                               10460000
104700           , SUM(PREPK_ODD_UNT_QTY)                               10470000
104800           INTO                                                   10480000
104900             :DISTDT-P2L-SPLT-UNT-QTY                             10490000
105000           , :DISTDT-ACTL-ALLOC-QTY                               10500000
105100           , :DISTDT-FCSE-SPLT-UNT-QTY                            10510000
105200           , :DISTDT-INPK-SPLT-UNT-QTY                            10520000
105300           , :DISTDT-FCSE-ACTL-UNT-QTY                            10530000
105400           , :DISTDT-PREPK-ODD-UNT-QTY                            10540000
105500           FROM TDISTDT                                           10550000
105600           WHERE ORD_NBR    = :DK-PO-NBR                          10560000
105700           AND RCVR_SEQ_NBR = :DK-RCVR-NBR                        10570000
105800           AND ORD_LNE_NBR  = :DK-LINE-NBR                        10580000
105900      END-EXEC.                                                   10590000
106000                                                                  10600000
106100      EVALUATE TRUE                                               10610000
106200           WHEN SQLCODE = ZERO                                    10620000
106300               CONTINUE                                           10630000
106400           WHEN SQLCODE = -305                                    10640000
106500               MOVE ZERO        TO DISTDT-P2L-SPLT-UNT-QTY        10650000
106600                                   DISTDT-FCSE-SPLT-UNT-QTY       10660000
106700                                   DISTDT-INPK-SPLT-UNT-QTY       10670000
106710                                   DISTDT-PREPK-ODD-UNT-QTY       10671016
106720                                   DISTDT-ACTL-ALLOC-QTY          10672016
106730                                   DISTDT-FCSE-ACTL-UNT-QTY       10673016
106800                                                                  10680000
106900         WHEN SQLWARN0 NOT = SPACES                               10690000
107000         WHEN SQLCODE < ZERO                                      10700000
107100         WHEN SQLCODE > ZERO                                      10710000
107200             SET PS-ERROR                                         10720000
107300                 RC041-INVALID-SQL    TO TRUE                     10730011
107400             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10740000
107500             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10750000
107600             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10760000
107700             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         10770000
107800             STRING   ' RCKUT125-8400-'                           10780000
107900                      ' CALLED BY-'                               10790000
108000                      RC041-PROGRAM-NAME                          10800011
108100                      '  SQLCODE='                                10810000
108200                      PV-DISPLAY-SQLCODE                          10820000
108300                      ' PO = '                                    10830000
108400                      PV-DISP-PO-NBR                              10840000
108500                      ' RECV = '                                  10850000
108600                      PV-DISP-RCVR-NBR                            10860000
108700                      ' LINE  = '                                 10870000
108800                      PV-DISP-LINE-NBR                            10880000
108900                      DELIMITED BY SIZE                           10890000
109000                                      INTO RC041-CRA-RET-MSG      10900011
109100                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 10910011
109200             PERFORM 9999-WRITE-TO-CSSL                           10920000
109300     END-EVALUATE.                                                10930000
109400                                                                  10940000
109500 8450-CALL-RCKUT128.                                              10950000
109600                                                                  10960000
109700     INITIALIZE RC074-FIELDS.                                     10970000
109800     MOVE DISTHD-OPER-UNT-ID  TO RC074-OPER-UNT-ID.               10980000
109900     MOVE 1                   TO RC074-FCLTY-ID.                  10990000
110000     MOVE DK-PO-NBR           TO RC074-PO-NBR.                    11000000
110100     MOVE DK-RCVR-NBR         TO RC074-RCVR-SEQ-NBR.              11010000
110200     MOVE DK-LINE-NBR         TO RC074-LINE-NBR.                  11020000
110300     SET RC074-UNIT-QTY-YES   TO TRUE.                            11030000
110400                                                                  11040000
110500                                                                  11050000
110600     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 11060000
110700                                         RC074-COMMAREA           11070000
110800                                         RC074-FIELDS.            11080000
110900     EVALUATE TRUE                                                11090000
111000         WHEN RC074-SUCCESSFUL                                    11100000
111100             CONTINUE                                             11110000
111200         WHEN OTHER                                               11120000
111300             SET PS-ERROR                                         11130000
111400                 RC041-INVALID-SQL    TO TRUE                     11140011
111500             MOVE RC074-DISPLAY-SQLCODE TO PV-DISPLAY-SQLCODE     11150000
111600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11160000
111700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11170000
111800             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         11180000
111900             STRING   ' RCKUT125-8450-'                           11190009
112000                      ' CALLED BY-'                               11200000
112100                      RC041-PROGRAM-NAME                          11210011
112200                      '  SQLCODE='                                11220000
112300                      PV-DISPLAY-SQLCODE                          11230000
112400                      ' PO = '                                    11240000
112500                      PV-DISP-PO-NBR                              11250000
112600                      ' RECV = '                                  11260000
112700                      PV-DISP-RCVR-NBR                            11270000
112800                      ' LINE  = '                                 11280000
112900                      PV-DISP-LINE-NBR                            11290000
113000                      DELIMITED BY SIZE                           11300000
113100                                      INTO RC041-CRA-RET-MSG      11310011
113200                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 11320011
113300             PERFORM 9999-WRITE-TO-CSSL                           11330000
113400             MOVE RC074-DISPLAY-SQLCODE TO PV-DISPLAY-SQLCODE     11340000
113500             STRING   ' RCKUT125-8450-'                           11350009
113600                      ' RC074 ABEND PARA '                        11360009
113700                      RC074-ABEND-PARAGRAPH                       11370000
113800                      ' RC074-DISPLAY-STR'                        11380009
113900                      RC074-DISPLAY-STR                           11390000
114000                      ' RC074-DISPLAY-SSCC'                       11400009
114100                      RC074-DISPLAY-SSCC                          11410000
114200                      DELIMITED BY SIZE                           11420000
114300                                      INTO RC041-CRA-RET-MSG      11430011
114400                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 11440011
114500             PERFORM 9999-WRITE-TO-CSSL                           11450000
114600     END-EVALUATE.                                                11460000
114700 8500-VERIFY-UPDATE.                                              11470000
114800                                                                  11480000
114900     EXEC SQL                                                     11490000
115000         SET :PV-TMST =  CURRENT_TIMESTAMP                        11500000
115100     END-EXEC                                                     11510000
115200                                                                  11520000
115300     MOVE PV-TMST  TO DISTHD-FCSE-CNFRMN-TMST.                    11530000
115400                                                                  11540000
115500     EXEC SQL                                                     11550000
115600         UPDATE TDISTHD                                           11560000
115700           SET FCSE_CNFRMN_TMST   = :DISTHD-FCSE-CNFRMN-TMST      11570000
115800            ,  FCSE_CNFRMN_USR_ID = :RC041-USER-ID                11580000
115900            ,  FCSE_CNFRMN_PGM_ID = :PC-CURRENT-PROGRAM-NAME      11590000
116000            ,  PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         11600000
116100      WHERE ORD_NBR                  = :DK-PO-NBR                 11610000
116200        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               11620000
116300        AND ORD_LNE_NBR              = :DK-LINE-NBR               11630000
116400     END-EXEC.                                                    11640000
116500                                                                  11650000
116600     EVALUATE TRUE                                                11660000
116700         WHEN SQLCODE = ZERO                                      11670000
116800             CONTINUE                                             11680000
116900                                                                  11690000
117000         WHEN SQLWARN0 NOT = SPACES                               11700000
117100         WHEN SQLCODE < ZERO                                      11710000
117200         WHEN SQLCODE > ZERO                                      11720000
117300             SET PS-ERROR                                         11730000
117400                 RC041-INVALID-SQL    TO TRUE                     11740011
117500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11750000
117600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11760000
117700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11770000
117800             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         11780000
117900             STRING   ' RCKUT125-8500-'                           11790000
118000                      ' CALLED BY-'                               11800000
118100                      RC041-PROGRAM-NAME                          11810011
118200                      '  SQLCODE='                                11820000
118300                      PV-DISPLAY-SQLCODE                          11830000
118400                      ' PO = '                                    11840000
118500                      PV-DISP-PO-NBR                              11850000
118600                      ' RECV = '                                  11860000
118700                      PV-DISP-RCVR-NBR                            11870000
118800                      ' LINE  = '                                 11880000
118900                      PV-DISP-LINE-NBR                            11890000
119000                      DELIMITED BY SIZE                           11900000
119100                                      INTO RC041-CRA-RET-MSG      11910011
119200                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 11920011
119300             PERFORM 9999-WRITE-TO-CSSL                           11930000
119400     END-EVALUATE.                                                11940000
119500                                                                  11950000
119600 8600-CONFIRM-UPDATE.                                             11960000
119700                                                                  11970000
119800     EXEC SQL                                                     11980000
119900         SET :PV-TMST =  CURRENT_TIMESTAMP                        11990000
120000     END-EXEC                                                     12000000
120100                                                                  12010000
120200     MOVE PV-TMST  TO DISTHD-FCSE-CNFRMN-TMST.                    12020000
120300     IF DISTHD-P2L-CART-CNT = 0                                   12030000
120400        MOVE PV-TMST   TO DISTHD-RSLTS-RCVD-TMST                  12040000
120500     ELSE                                                         12050000
120600        SET PS-DONT-SUBMIT-E200 TO TRUE                           12060000
120700     END-IF.                                                      12070000
120800                                                                  12080000
120900     MOVE PC-CURRENT-PROGRAM-NAME TO DISTHD-FCSE-CNFRMN-PGM-ID.   12090000
121000                                                                  12100000
121100*  NOTE - IF THERE ARE P2L CARTONS, THEN THE TABLE WILL BE UPDATED12110000
121200*  WITH THE ORIGINAL VALUE                                        12120000
121300                                                                  12130000
121400     EXEC SQL                                                     12140000
121500         UPDATE  TDISTHD                                          12150000
121600           SET FCSE_CNFRMN_TMST   = :DISTHD-FCSE-CNFRMN-TMST      12160000
121700            ,  FCSE_CNFRMN_USR_ID = :RC041-USER-ID                12170000
121800            ,  FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID    12180000
121900            ,  PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         12190000
122000            ,  RSLTS_RCVD_TMST    = :DISTHD-RSLTS-RCVD-TMST       12200000
122100      WHERE ORD_NBR                  = :DK-PO-NBR                 12210000
122200        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               12220000
122300        AND ORD_LNE_NBR              = :DK-LINE-NBR               12230000
122400     END-EXEC.                                                    12240000
122500                                                                  12250000
122600     EVALUATE TRUE                                                12260000
122700         WHEN SQLCODE = ZERO                                      12270000
122800             CONTINUE                                             12280000
122900                                                                  12290000
123000         WHEN SQLWARN0 NOT = SPACES                               12300000
123100         WHEN SQLCODE < ZERO                                      12310000
123200         WHEN SQLCODE > ZERO                                      12320000
123300             SET PS-ERROR                                         12330000
123400                 PS-DONT-SUBMIT-E200                              12340000
123500                 RC041-INVALID-SQL    TO TRUE                     12350011
123600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       12360000
123700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           12370000
123800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         12380000
123900             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         12390000
124000             STRING   ' RCKUT125-8600-'                           12400000
124100                      ' CALLED BY-'                               12410000
124200                      RC041-PROGRAM-NAME                          12420011
124300                      '  SQLCODE='                                12430000
124400                      PV-DISPLAY-SQLCODE                          12440000
124500                      ' PO = '                                    12450000
124600                      PV-DISP-PO-NBR                              12460000
124700                      ' RECV = '                                  12470000
124800                      PV-DISP-RCVR-NBR                            12480000
124900                      ' LINE  = '                                 12490000
125000                      PV-DISP-LINE-NBR                            12500000
125100                      DELIMITED BY SIZE                           12510000
125200                                      INTO RC041-CRA-RET-MSG      12520011
125300                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 12530011
125400             PERFORM 9999-WRITE-TO-CSSL                           12540000
125500     END-EVALUATE.                                                12550000
125600                                                                  12560000
125700 8650-UPDATE-PRCG-STAT-CDE.                                       12570000
125800                                                                  12580000
125900     EXEC SQL                                                     12590000
126000         UPDATE TDISTHD                                           12600000
126100           SET PRCG_STAT_CDE         = :DK-PRCG-STAT-CDE          12610000
126200      WHERE ORD_NBR                  = :DK-PO-NBR                 12620000
126300        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               12630000
126400        AND ORD_LNE_NBR              = :DK-LINE-NBR               12640000
126500     END-EXEC.                                                    12650000
126600                                                                  12660000
126700     EVALUATE TRUE                                                12670000
126800         WHEN SQLCODE = ZERO                                      12680000
126900             CONTINUE                                             12690000
127000                                                                  12700000
127100         WHEN SQLWARN0 NOT = SPACES                               12710000
127200         WHEN SQLCODE < ZERO                                      12720000
127300         WHEN SQLCODE > ZERO                                      12730000
127400             SET PS-ERROR                                         12740000
127500                 RC041-INVALID-SQL    TO TRUE                     12750011
127600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       12760000
127700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           12770000
127800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         12780000
127900             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         12790000
128000             STRING   ' RCKUT125-8650-'                           12800000
128100                      ' CALLED BY-'                               12810000
128200                      RC041-PROGRAM-NAME                          12820011
128300                      '  SQLCODE='                                12830000
128400                      PV-DISPLAY-SQLCODE                          12840000
128500                      ' PO = '                                    12850000
128600                      PV-DISP-PO-NBR                              12860000
128700                      ' RECV = '                                  12870000
128800                      PV-DISP-RCVR-NBR                            12880000
128900                      ' LINE  = '                                 12890000
129000                      PV-DISP-LINE-NBR                            12900000
129100                      DELIMITED BY SIZE                           12910000
129200                                      INTO RC041-CRA-RET-MSG      12920011
129300                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 12930011
129400             PERFORM 9999-WRITE-TO-CSSL                           12940000
129500     END-EVALUATE.                                                12950000
129600                                                                  12960000
129700 8700-TRACK-CONFIRMATION.                                         12970000
129800                                                                  12980000
129900     INITIALIZE RC071-FIELDS.                                     12990000
130000     MOVE RC041-PO-NBR              TO RC071-PO-NBR               13000000
130100     MOVE RC041-REC-SEQ-NBR         TO RC071-PO-RCVR              13010000
130200     MOVE DK-LINE-NBR               TO RC071-PO-LINE              13020000
130300     MOVE RC041-PREPACK-ID          TO RC071-PREPK-ID             13030000
130400     MOVE RC041-OPER-UNT-ID         TO RC071-SIGNON-LOCATION      13040000
130500     MOVE RC041-USER-ID             TO RC071-USER-ID              13050000
130600                                                                  13060000
130700     EVALUATE TRUE                                                13070000
130800        WHEN RC041-PROGRAM-NAME = PC-TRAILER-UNLOAD               13080003
130900         AND DK-PRCG-STAT-CDE = 'K'                               13090003
131000           SET RC071-SUSP-TRUN-CNF-SUS-AU TO TRUE                 13100006
131100        WHEN RC041-PROGRAM-NAME = PC-TRAILER-UNLOAD               13110003
131200         AND DK-PRCG-STAT-CDE = 'L'                               13120003
131300           SET RC071-SUSP-TRUN-CNF-SUS-TR TO TRUE                 13130003
131400        WHEN RC041-PROGRAM-NAME = PC-TRAILER-UNLOAD               13140005
131500         AND DK-PRCG-STAT-CDE = 'R'                               13150005
131600           SET RC071-SUSP-TRLUN-FOR-READY TO TRUE                 13160005
131700        WHEN RC041-PROGRAM-NAME = PC-TRAILER-UNLOAD               13170005
131800        WHEN RC041-PROGRAM-NAME = PC-TRLR-UNLD-LIST               13180005
131900           SET RC071-CONFIRM-TRLR-UNLD TO TRUE                    13190005
132000       WHEN RC041-PROGRAM-NAME = PC-HOT-COMPLETE                  13200004
132100        AND DK-PRCG-STAT-CDE = 'K'                                13210004
132200          SET RC071-SUSP-HTCP-CNF-SUS-AU TO  TRUE                 13220006
132300       WHEN RC041-PROGRAM-NAME = PC-HOT-COMPLETE                  13230004
132400        AND DK-PRCG-STAT-CDE = 'L'                                13240004
132500          SET RC071-SUSP-HTCP-CNF-SUS-AU TO  TRUE                 13250006
132600        WHEN RC041-PROGRAM-NAME = PC-HOT-COMPLETE                 13260005
132700         AND DK-PRCG-STAT-CDE = 'R'                               13270005
132800           SET RC071-SUSP-HTCMP-FOR-READY TO TRUE                 13280005
132900       WHEN RC041-PROGRAM-NAME = PC-HOT-COMPLETE                  13290005
133000          SET RC071-CONFIRM-HOT-COMPLETE TO  TRUE                 13300005
133100       WHEN RC041-PROGRAM-NAME = PC-SWEEPER                       13310004
133200        AND DK-PRCG-STAT-CDE = 'K'                                13320004
133300          SET RC071-SUSP-SWEP-CNF-SUS-AU  TO  TRUE                13330007
133400       WHEN RC041-PROGRAM-NAME = PC-SWEEPER                       13340004
133500        AND DK-PRCG-STAT-CDE = 'L'                                13350004
133600          SET RC071-SUSP-SWEP-CNF-SUS-AU  TO  TRUE                13360007
133700        WHEN RC041-PROGRAM-NAME = PC-SWEEPER                      13370005
133800         AND DK-PRCG-STAT-CDE = 'R'                               13380005
133900           SET RC071-SUSP-SWEEP-FOR-READY TO TRUE                 13390005
134000       WHEN RC041-PROGRAM-NAME = PC-SWEEPER                       13400005
134100          SET RC071-CONFIRMATION-SWEEPER TO  TRUE                 13410005
134200        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-VERIFY              13420004
134300        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-START               13430004
134400        WHEN RC041-PROGRAM-NAME = PC-SUKCS771                     13440015
134500         AND DK-PRCG-STAT-CDE = 'K'                               13450004
134600           SET RC071-SUSP-CHKN-CNF-SUS-AU TO TRUE                 13460005
134700        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-VERIFY              13470004
134800        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-START               13480004
134900        WHEN RC041-PROGRAM-NAME = PC-SUKCS771                     13490015
135000         AND DK-PRCG-STAT-CDE = 'L'                               13500005
135100           SET RC071-SUSP-CHKN-CNF-SUS-TR TO TRUE                 13510004
135200        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-VERIFY              13520005
135300        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-START               13530005
135400        WHEN RC041-PROGRAM-NAME = PC-SUKCS771                     13540015
135500         AND DK-PRCG-STAT-CDE = 'R'                               13550005
135600           SET RC071-SUSP-CHKIN-FOR-READY TO TRUE                 13560005
135700        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-VERIFY              13570005
135800        WHEN RC041-PROGRAM-NAME = PC-CHECK-IN-START               13580005
135900        WHEN RC041-PROGRAM-NAME = PC-SUKCS771                     13590015
136000          IF  (DISTHD-FCSE-CART-CNT >  +0  OR                     13600005
136100               DISTHD-INPK-CART-CNT >  +0)                        13610005
136200             SET RC071-CONFIRMATION-CHECK-IN TO TRUE              13620005
136300          ELSE                                                    13630005
136400             SET RC071-CONFIRM-NO-FULLCASE   TO TRUE              13640005
136500          END-IF                                                  13650005
136600     END-EVALUATE                                                 13660000
136700                                                                  13670000
136800     MOVE RC041-PROGRAM-NAME        TO RC071-CALLING-PROGRAM      13680000
136900                                                                  13690000
137000     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        13700000
137100                                                                  13710000
137200     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  13720000
137300                                        RC071-COMMAREA            13730000
137400                                        RC071-FIELDS.             13740000
137500                                                                  13750000
137600     EVALUATE TRUE                                                13760000
137700         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     13770000
137800             IF  RC071-INVALID-SQL     OR                         13780000
137900                 RC071-DATABASE-BUSY                              13790000
138000                 STRING ' RCKUT137 - '        DELIMITED BY SIZE   13800000
138100                   '8700-TRACK-CONFIRMATION'  DELIMITED BY SIZE   13810000
138200                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   13820000
138300                        RC071-SUCCESS-IND     DELIMITED BY SIZE   13830000
138400                                         INTO RC071-CRA-RET-MSG   13840000
138500             MOVE RC071-CRA-RET-MSG       TO PV-CICS-MSG-AREA     13850000
138600                 PERFORM 9999-WRITE-TO-CSSL                       13860000
138700                 SET RC071-NOT-SUCCESSFUL TO TRUE                 13870000
138800             END-IF                                               13880000
138900         WHEN OTHER                                               13890000
139000             STRING ' RCKUT125 (OTHER) -' DELIMITED BY SIZE       13900000
139100                '8700-TRACK-CONFIRMATION' DELIMITED BY SIZE       13910000
139200                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       13920000
139300                    RC071-SUCCESS-IND     DELIMITED BY SIZE       13930000
139400                                         INTO RC071-CRA-RET-MSG   13940000
139500             MOVE RC071-CRA-RET-MSG       TO PV-CICS-MSG-AREA     13950000
139600             PERFORM 9999-WRITE-TO-CSSL                           13960000
139700             SET RC071-NOT-SUCCESSFUL TO TRUE                     13970000
139800     END-EVALUATE.                                                13980000
139900                                                                  13990000
140000*----------------------------------------------------------------*14000000
140100*    CALL TO ADJUST SYSTEM AUDIT                                  14010000
140200*----------------------------------------------------------------*14020000
140300 8720-CALL-ADJUST-SYST-AUDIT.                                     14030000
140400                                                                  14040000
140500     INITIALIZE SU047-COMMAREA-REC.                               14050000
140600     MOVE RC041-PO-NBR              TO SU047-PO-NBR.              14060000
140700     MOVE RC041-REC-SEQ-NBR         TO SU047-REC-SEQ-NBR.         14070000
140800     MOVE RC041-PKGNG-CDE           TO SU047-PKGNG-CDE.           14080000
140900     MOVE RC041-USER-ID             TO SU047-USER-ID.             14090000
141000     MOVE RC041-OPER-UNT-ID         TO SU047-OPER-UNT-ID.         14100000
141100     MOVE +1                        TO SU047-FCLTY-ID.            14110000
141200     IF RC041-PREPACK                                             14120000
141300        MOVE RC041-PREPACK-ID          TO SU047-PREPACK-ID        14130000
141400     ELSE                                                         14140000
141500        MOVE RC041-PO-LNE-NBR          TO SU047-PO-LNE-NBR        14150000
141600     END-IF                                                       14160000
141700                                                                  14170000
141800     MOVE PC-CURRENT-PROGRAM-NAME   TO SU047-CALLING-PROGRAM.     14180000
141900                                                                  14190000
142000     MOVE LENGTH OF SU047-COMMAREA-REC   TO PV-COMMAREA-LENGTH.   14200000
142100                                                                  14210000
142200     EXEC CICS                                                    14220000
142300         LINK PROGRAM  (SU047-MODULE-NAME)                        14230000
142400              COMMAREA (SU047-COMMAREA-REC)                       14240000
142500              LENGTH   (PV-COMMAREA-LENGTH)                       14250000
142600              RESP     (PV-CICS-RESP)                             14260000
142700     END-EXEC.                                                    14270000
142800                                                                  14280000
142900     EVALUATE TRUE                                                14290000
143000         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     14300000
143100             IF SU047-SUCCESSFUL                                  14310000
143200                IF RC041-PREPACK                                  14320000
143300                   MOVE RC041-PREPACK-ID TO  PV-HOLD-PREPK-ID     14330000
143400                END-IF                                            14340000
143500             ELSE                                                 14350000
143600               IF SU047-INVALID-SQL     OR                        14360000
143700                   SU047-DATABASE-BUSY                            14370000
143800                 STRING ' RCKUT125 - '        DELIMITED BY SIZE   14380000
143900                   '8720-CALL-ADJUST-SYST-AU' DELIMITED BY SIZE   14390000
144000                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   14400000
144100                        SU047-SUCCESS-IND     DELIMITED BY SIZE   14410000
144200                                         INTO SU047-CRA-RET-MSG   14420000
144300                  MOVE SU047-CRA-RET-MSG       TO PV-CICS-MSG-AREA14430000
144400                   PERFORM 9999-WRITE-TO-CSSL                     14440000
144500                 SET SU047-NOT-SUCCESSFUL TO TRUE                 14450000
144600               END-IF                                             14460000
144700             END-IF                                               14470000
144800         WHEN OTHER                                               14480000
144900             STRING ' RCKUT125 (OTHER) -' DELIMITED BY SIZE       14490000
145000                '8720-CALL-ADJUST-SYST-A' DELIMITED BY SIZE       14500000
145100                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       14510000
145200                    SU047-SUCCESS-IND     DELIMITED BY SIZE       14520000
145300                                         INTO RC071-CRA-RET-MSG   14530000
145400             MOVE SU047-CRA-RET-MSG       TO PV-CICS-MSG-AREA     14540000
145500             PERFORM 9999-WRITE-TO-CSSL                           14550000
145600             SET SU047-NOT-SUCCESSFUL TO TRUE                     14560000
145700     END-EVALUATE.                                                14570000
145800                                                                  14580000
145900                                                                  14590000
146000 9000-UPDATE-UNITS-WRKD.                                          14600000
146100* THIS WILL CALL PCKCS756 WHICH WILL UPDATE THE TABLES FOR UNITS  14610000
146200* WORKED OR VERIFIED                                              14620000
146300     EXEC SQL                                                     14630000
146400         SET :PV-CURRENT-TMST =  CURRENT_TIMESTAMP                14640000
146500     END-EXEC.                                                    14650000
146600                                                                  14660000
146700     MOVE PV-CURRENT-TMST             TO PC238-WRKD-TMST.         14670000
146800     MOVE DK-PO-NBR                   TO PC238-PO-NBR.            14680000
146900     MOVE DK-RCVR-NBR                 TO PC238-RCVR-SEQ-NBR.      14690000
147000     MOVE DK-LINE-NBR                 TO PC238-PO-LNE-NBR.        14700000
147100     MOVE DISTHD-FCSE-FCLTY-AREA-ID   TO PC238-PRCG-AREA-CDE.     14710000
147200     MOVE 'N'                         TO PC238-VERIFY-TYPE-CDE.   14720000
147300     MOVE LENGTH OF PC238-COMM-AREA   TO PC-COMMAREA-LENGTH.      14730000
147400                                                                  14740000
147500     EXEC CICS                                                    14750000
147600         LINK                                                     14760000
147700             PROGRAM   (PC-UNTS-WRKD-PGRM-NAME)                   14770000
147800             COMMAREA  (PC238-COMM-AREA)                          14780000
147900             LENGTH    (PC-COMMAREA-LENGTH)                       14790000
148000             RESP      (PV-CICS-RESP)                             14800000
148100     END-EXEC.                                                    14810000
148200                                                                  14820000
148300     EVALUATE TRUE                                                14830000
148400         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     14840000
148500              EVALUATE TRUE                                       14850000
148600                  WHEN PC238-MOD-SUCCESSFUL                       14860000
148700                       CONTINUE                                   14870000
148800                 WHEN PC238-MOD-UNSUCCESSFUL                      14880000
148900                     PERFORM 9100-MOD-UNSUCCESSFUL                14890000
149000             END-EVALUATE                                         14900000
149100                                                                  14910000
149200         WHEN OTHER                                               14920000
149300             SET PS-ERROR                                         14930000
149400                 RC041-INVALID-SQL    TO TRUE                     14940011
149500             MOVE PV-CICS-RESP        TO PV-DISP-CICS-RESPONSE    14950000
149600             STRING   ' RCKUT125-9000-'                           14960000
149700                      ' CALLED BY-'                               14970000
149800                      RC041-PROGRAM-NAME                          14980011
149900                      '  CICS RESP='                              14990000
150000                      PV-DISP-CICS-RESPONSE                       15000000
150100                      DELIMITED BY SIZE                           15010000
150200                                      INTO RC041-CRA-RET-MSG      15020011
150300                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15030011
150400             PERFORM 9999-WRITE-TO-CSSL                           15040000
150500     END-EVALUATE.                                                15050000
150600                                                                  15060000
150700 9100-MOD-UNSUCCESSFUL.                                           15070000
150800                                                                  15080000
150900     SET PS-ERROR                                                 15090000
151000         RC041-INVALID-SQL    TO TRUE.                            15100011
151100     MOVE PC238-PO-NBR              TO PV-DISP-PO-NBR.            15110000
151200     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISP-RCVR-NBR.          15120000
151300     MOVE PC238-PO-LNE-NBR          TO PV-DISP-LINE-NBR.          15130000
151400     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID.       15140000
151500     MOVE PC238-BAD-SQL-CDE         TO PV-DISPLAY-SQLCODE.        15150000
151600     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      15160000
151700                                                                  15170000
151800     IF  PC238-MOD-BAD-TMST                                       15180000
151900         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15190000
152000                ' 9000-UPDATE-UNITS-WRKD '                        15200000
152100                                    DELIMITED BY SIZE             15210000
152200                ' BAD TIMESTAMP '   DELIMITED BY SIZE             15220000
152300                PC238-WRKD-TMST     DELIMITED BY SIZE             15230000
152400                             INTO RC041-CRA-RET-MSG               15240011
152500                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15250011
152600         PERFORM 9999-WRITE-TO-CSSL                               15260000
152700         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15270000
152800                ' 9000-UPDATE-UNITS-WRKD '                        15280000
152900                                    DELIMITED BY SIZE             15290000
153000                ' KEY INFO - '      DELIMITED BY SIZE             15300000
153100                PV-DISP-PO-NBR      DELIMITED BY SIZE             15310000
153200                ' - '               DELIMITED BY SIZE             15320000
153300                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             15330000
153400                ' - '               DELIMITED BY SIZE             15340000
153500                PV-DISP-LINE-NBR    DELIMITED BY SIZE             15350000
153600                             INTO RC041-CRA-RET-MSG               15360011
153700                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15370011
153800         PERFORM 9999-WRITE-TO-CSSL                               15380000
153900     ELSE                                                         15390000
154000     IF  PC238-MOD-BAD-OPER                                       15400000
154100         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15410000
154200                ' 9000-UPDATE-UNITS-WRKD '                        15420000
154300                                    DELIMITED BY SIZE             15430000
154400                ' BAD OPER UNIT '   DELIMITED BY SIZE             15440000
154500                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             15450000
154600                             INTO RC041-CRA-RET-MSG               15460011
154700                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15470011
154800         PERFORM 9999-WRITE-TO-CSSL                               15480000
154900         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15490000
155000                ' 9000-UPDATE-UNITS-WRKD '                        15500000
155100                                    DELIMITED BY SIZE             15510000
155200                ' KEY INFO - '      DELIMITED BY SIZE             15520000
155300                PV-DISP-PO-NBR      DELIMITED BY SIZE             15530000
155400                ' - '               DELIMITED BY SIZE             15540000
155500                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             15550000
155600                ' - '               DELIMITED BY SIZE             15560000
155700                PV-DISP-LINE-NBR    DELIMITED BY SIZE             15570000
155800                             INTO RC041-CRA-RET-MSG               15580011
155900                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15590011
156000         PERFORM 9999-WRITE-TO-CSSL                               15600000
156100     ELSE                                                         15610000
156200     IF  PC238-MOD-BAD-TRANS-TYPE                                 15620000
156300         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15630000
156400                ' 9000-UPDATE-UNITS-WRKD '                        15640000
156500                                    DELIMITED BY SIZE             15650000
156600                ' BAD TRAN TYPE '   DELIMITED BY SIZE             15660000
156700                PC238-TRANS-TYPE-CDE                              15670000
156800                                    DELIMITED BY SIZE             15680000
156900                             INTO RC041-CRA-RET-MSG               15690011
157000                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15700011
157100         PERFORM 9999-WRITE-TO-CSSL                               15710000
157200         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15720000
157300                ' 9000-UPDATE-UNITS-WRKD '                        15730000
157400                                    DELIMITED BY SIZE             15740000
157500                ' KEY INFO - '      DELIMITED BY SIZE             15750000
157600                PV-DISP-PO-NBR      DELIMITED BY SIZE             15760000
157700                ' - '               DELIMITED BY SIZE             15770000
157800                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             15780000
157900                ' - '               DELIMITED BY SIZE             15790000
158000                PV-DISP-LINE-NBR    DELIMITED BY SIZE             15800000
158100                             INTO RC041-CRA-RET-MSG               15810011
158200                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15820011
158300         PERFORM 9999-WRITE-TO-CSSL                               15830000
158400     ELSE                                                         15840000
158500     IF  PC238-MOD-BAD-PO                                         15850000
158600         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15860000
158700                ' 9000-UPDATE-UNITS-WRKD '                        15870000
158800                                    DELIMITED BY SIZE             15880000
158900                ' BAD PO NUMBER '   DELIMITED BY SIZE             15890000
159000                PV-DISP-PO-NBR      DELIMITED BY SIZE             15900000
159100                             INTO RC041-CRA-RET-MSG               15910011
159200                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 15920011
159300         PERFORM 9999-WRITE-TO-CSSL                               15930000
159400         STRING ' RCKUT125 - '      DELIMITED BY SIZE             15940000
159500                ' 9000-UPDATE-UNITS-WRKD '                        15950000
159600                                    DELIMITED BY SIZE             15960000
159700                ' KEY INFO - '      DELIMITED BY SIZE             15970000
159800                PV-DISP-PO-NBR      DELIMITED BY SIZE             15980000
159900                ' - '               DELIMITED BY SIZE             15990000
160000                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16000000
160100                ' - '               DELIMITED BY SIZE             16010000
160200                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16020000
160300                             INTO RC041-CRA-RET-MSG               16030011
160400                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16040011
160500         PERFORM 9999-WRITE-TO-CSSL                               16050000
160600     ELSE                                                         16060000
160700     IF  PC238-MOD-BAD-RCVR                                       16070000
160800         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16080000
160900                ' 9000-UPDATE-UNITS-WRKD '                        16090000
161000                                    DELIMITED BY SIZE             16100000
161100                ' BAD RCVR NBR  '   DELIMITED BY SIZE             16110000
161200                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16120000
161300                             INTO RC041-CRA-RET-MSG               16130011
161400                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16140011
161500         PERFORM 9999-WRITE-TO-CSSL                               16150000
161600         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16160000
161700                ' 9000-UPDATE-UNITS-WRKD '                        16170000
161800                                    DELIMITED BY SIZE             16180000
161900                ' KEY INFO - '      DELIMITED BY SIZE             16190000
162000                PV-DISP-PO-NBR      DELIMITED BY SIZE             16200000
162100                ' - '               DELIMITED BY SIZE             16210000
162200                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16220000
162300                ' - '               DELIMITED BY SIZE             16230000
162400                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16240000
162500                             INTO RC041-CRA-RET-MSG               16250011
162600                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16260011
162700         PERFORM 9999-WRITE-TO-CSSL                               16270000
162800     ELSE                                                         16280000
162900     IF  PC238-MOD-BAD-LINE                                       16290000
163000         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16300000
163100                ' 9000-UPDATE-UNITS-WRKD '                        16310000
163200                                    DELIMITED BY SIZE             16320000
163300                ' BAD LINE NBR  '   DELIMITED BY SIZE             16330000
163400                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16340000
163500                             INTO RC041-CRA-RET-MSG               16350011
163600                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16360011
163700         PERFORM 9999-WRITE-TO-CSSL                               16370000
163800         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16380000
163900                ' 9000-UPDATE-UNITS-WRKD '                        16390000
164000                                    DELIMITED BY SIZE             16400000
164100                ' KEY INFO - '      DELIMITED BY SIZE             16410000
164200                PV-DISP-PO-NBR      DELIMITED BY SIZE             16420000
164300                ' - '               DELIMITED BY SIZE             16430000
164400                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16440000
164500                ' - '               DELIMITED BY SIZE             16450000
164600                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16460000
164700                             INTO RC041-CRA-RET-MSG               16470011
164800                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16480011
164900         PERFORM 9999-WRITE-TO-CSSL                               16490000
165000     ELSE                                                         16500000
165100     IF  PC238-MOD-BAD-NO-SHIFT                                   16510000
165200         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16520000
165300                ' 9000-UPDATE-UNITS-WRKD '                        16530000
165400                                    DELIMITED BY SIZE             16540000
165500                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             16550000
165600                PC238-WRKD-TMST     DELIMITED BY SIZE             16560000
165700                ' FOR OPER '        DELIMITED BY SIZE             16570000
165800                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             16580000
165900                             INTO RC041-CRA-RET-MSG               16590011
166000                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16600011
166100         PERFORM 9999-WRITE-TO-CSSL                               16610000
166200         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16620000
166300                ' 9000-UPDATE-UNITS-WRKD '                        16630000
166400                                    DELIMITED BY SIZE             16640000
166500                ' KEY INFO - '      DELIMITED BY SIZE             16650000
166600                PV-DISP-PO-NBR      DELIMITED BY SIZE             16660000
166700                ' - '               DELIMITED BY SIZE             16670000
166800                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16680000
166900                ' - '               DELIMITED BY SIZE             16690000
167000                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16700000
167100                             INTO RC041-CRA-RET-MSG               16710011
167200                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16720011
167300         PERFORM 9999-WRITE-TO-CSSL                               16730000
167400     ELSE                                                         16740000
167500         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16750000
167600                ' 9000-UPDATE-UNITS-WRKD '                        16760000
167700                                    DELIMITED BY SIZE             16770000
167800                ' DB ERROR - SQL CODE '                           16780000
167900                                    DELIMITED BY SIZE             16790000
168000                PV-DISPLAY-SQLCODE DELIMITED BY SIZE              16800000
168100                ' FUNC: '           DELIMITED BY SIZE             16810000
168200                PC238-BAD-TABLE-FUNCTION                          16820000
168300                                    DELIMITED BY SIZE             16830000
168400                ' TABLE: '          DELIMITED BY SIZE             16840000
168500                PC238-BAD-TABLE-NAME                              16850000
168600                                    DELIMITED BY SIZE             16860000
168700                             INTO RC041-CRA-RET-MSG               16870011
168800                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 16880011
168900         PERFORM 9999-WRITE-TO-CSSL                               16890000
169000         STRING ' RCKUT125 - '      DELIMITED BY SIZE             16900000
169100                ' 9000-UPDATE-UNITS-WRKD '                        16910000
169200                                    DELIMITED BY SIZE             16920000
169300                ' KEY INFO - '      DELIMITED BY SIZE             16930000
169400                PV-DISP-PO-NBR      DELIMITED BY SIZE             16940000
169500                ' - '               DELIMITED BY SIZE             16950000
169600                PV-DISP-RCVR-NBR    DELIMITED BY SIZE             16960000
169700                ' - '               DELIMITED BY SIZE             16970000
169800                PV-DISP-LINE-NBR    DELIMITED BY SIZE             16980000
169900                             INTO RC041-CRA-RET-MSG               16990011
170000                 MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA 17000011
170100         PERFORM 9999-WRITE-TO-CSSL                               17010000
170200     END-IF                                                       17020000
170300     END-IF                                                       17030000
170400     END-IF                                                       17040000
170500     END-IF                                                       17050000
170600     END-IF                                                       17060000
170700     END-IF                                                       17070000
170800     END-IF.                                                      17080000
170900                                                                  17090000
171000 9300-CHECK-LOGGING.                                              17100000
171100     EXEC SQL                                                     17110000
171200         SELECT FUNC_TXT                                          17120000
171300           INTO :KRPRPM-FUNC-TXT                                  17130000
171400           FROM TKRPRPM                                           17140000
171500          WHERE SYS_PRC_FUNC_CDE  = 'RC125D'                      17150000
171600            AND LOC_ID            = :DK-OPER-UNT-ID               17160000
171700            AND INTFC_SYS_CDE     = 'KHL'                         17170000
171800            AND FUNC_PRC_STAT_CDE = 'AC'                          17180000
171900     END-EXEC.                                                    17190000
172000                                                                  17200000
172100     EVALUATE TRUE                                                17210000
172200         WHEN SQLCODE = ZERO                                      17220000
172300         WHEN SQLCODE = +100                                      17230000
172400              CONTINUE                                            17240000
172500         WHEN SQLWARN0 NOT = SPACE                                17250000
172600         WHEN SQLCODE NOT = ZERO                                  17260000
172700             SET PS-ERROR                                         17270000
172800                 RC041-INVALID-SQL    TO TRUE                     17280000
172900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       17290000
173000             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      17300000
173100             STRING   ' RCKUT125-9300-'                           17310000
173200                      ' CALLED BY-'                               17320000
173300                      RC041-PROGRAM-NAME                          17330000
173400                      '  SQLCODE='                                17340000
173500                      PV-DISPLAY-SQLCODE                          17350000
173600                      ' OPER = '                                  17360000
173700                      PV-DISP-OPER-UNT-ID                         17370000
173800                      DELIMITED BY SIZE                           17380000
173900                                      INTO RC041-CRA-RET-MSG      17390000
174000             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     17400000
174100             PERFORM 9999-WRITE-TO-CSSL                           17410000
174200     END-EVALUATE.                                                17420000
174300                                                                  17430000
174400                                                                  17440000
174500 9902-SYNCPOINT.                                                  17450000
174600     EXEC CICS                                                    17460000
174700         SYNCPOINT                                                17470000
174800     END-EXEC.                                                    17480000
174900                                                                  17490000
175000 9905-ROLLBACK.                                                   17500000
175100     EXEC CICS SYNCPOINT                                          17510000
175200         ROLLBACK                                                 17520000
175300     END-EXEC.                                                    17530000
175400                                                                  17540000
175500                                                                  17550000
175600 9999-WRITE-TO-CSSL.                                              17560000
175700                                                                  17570000
175800     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      17580000
175900                                                                  17590000
176000     EXEC CICS                                                    17600000
176100          WRITEQ TD                                               17610000
176200           QUEUE   ('CSSL')                                       17620000
176300            FROM   (PV-CICS-MSG-AREA)                             17630000
176400          LENGTH   (PV-COMMAREA-LENGTH)                           17640000
176500            RESP   (PV-CICS-RESP)                                 17650000
176600     END-EXEC.                                                    17660000
176700                                                                  17670000
