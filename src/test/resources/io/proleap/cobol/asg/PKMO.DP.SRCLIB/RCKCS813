000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS813.                                         00020000
000300 AUTHOR.        JOE LAROSA - COMPUWARE.                           00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  APRIL 2000.                                       00050000
000600 DATE-COMPILED.                                                   00060000
000700***************************************************************** 00070000
000800*    E813 - CONFIRM LINE LIST BY STORE                          * 00080000
000900*                                                               * 00090000
001000*    THIS PROGRAM GENERATES A LIST OF LINES FOR A GIVEN         * 00100000
001100*     PO/RECEIVER/STORE.  IF THE RECEIVER PACKING CODE IS 'I'   * 00110000
001200*    OR 'M', THE USER CAN UPDATE THE 'ODD UNIT' QUANTITY.       * 00120000
001300*    IF THE RECEIVER PACKING IS NOT 'I' OR 'M', THE USER CAN    * 00130000
001400*    THE 'FULLCASE' QUANTITY.                                   * 00140000
001500*                                                               * 00150000
001600***************************************************************** 00160000
001700*  CHANGED 10/21/14 BY CHERI PARMLEY       CHG#0094571           *00170059
001800*   CHANGED FILLER IN MAP REDEFINED AREA TO INCLUDE ONE MORE     *00180059
001801*   CHAR IN FILLER FOR LARGER PO# ON MAP.                        *00180159
001802***************************************************************** 00180200
001803* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00180359
001804* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00180459
001805* MAKING THE CALL DYNAMIC VS STATIC.                              00180559
001806*---------------------------------------------------------------* 00180659
001807 ENVIRONMENT DIVISION.                                            00180700
001808 DATA DIVISION.                                                   00180800
001900                                                                  00190000
002000***************************************************************** 00200000
002100 WORKING-STORAGE SECTION.                                         00210000
002200 01  DK-DB2-KEYS.                                                 00220000
002300     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00230000
002400     05  DK-FCLTY-ID                  PIC S9(04) COMP.            00240000
002500     05  DK-ORD-NBR                   PIC S9(09) COMP.            00250000
002600     05  DK-RCVR-NBR                  PIC S9(09) COMP.            00260000
002700     05  DK-LINE-NBR                  PIC S9(09) COMP.            00270000
002800     05  DK-STR-NBR                   PIC S9(04) COMP.            00280000
002900     05  DK-PACK-ID                   PIC S9(04) COMP.            00290000
003000     05  DK-STR-NBR-NAME.                                         00300000
003100         10  FILLER                   PIC X(01).                  00310000
003200         10  DK-STR-L3                PIC X(03).                  00320000
003210     05  DK-PK-SKU-NBR                PIC  S9(8)V COMP-3.         00321050
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-CURRENT-MAP-NAME          PIC X(08) VALUE 'RC813A  '. 00350000
003600     05  PC-CURRENT-MAPSET-NAME       PIC X(08) VALUE 'RCKM813 '. 00360000
003700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKCS813'. 00370000
003800     05  PC-LIST-QUEUE-SEQ            PIC 9(01) VALUE 1.          00380000
003900     05  PC-SEL-QUEUE-SEQ             PIC 9(01) VALUE 2.          00390000
004000     05  PC-CRIT-SPEC-FORMAT          PIC X(01) VALUE '2'.        00400000
004100     05  PC-LIST-FORMAT               PIC X(01) VALUE '1'.        00410000
004200     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +12         00420000
004300                                                      COMP SYNC.  00430000
004400     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00440000
004500                                                      COMP SYNC.  00450000
004600     05  PC-MAX-ITEMS                 PIC S9(9) VALUE +1000000    00460000
004700                                                      COMP-3.     00470000
004800     05  PC-MSG-NUMBER-LENGTH         PIC S9(4) VALUE +7          00480000
004900                                                      COMP SYNC.  00490000
005000     05  PC-ADD                       PIC X(03) VALUE 'ADD'.      00500000
005100     05  PC-INQ                       PIC X(03) VALUE 'INQ'.      00510000
005200     05  PC-UPD                       PIC X(03) VALUE 'UPD'.      00520000
005300     05  PC-DEL                       PIC X(03) VALUE 'DEL'.      00530000
005400     05  PC-ERR                       PIC X(03) VALUE 'ERR'.      00540000
005410     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00541000
005420     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00542000
005430     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00543000
005440     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00544000
005450     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00545000
005460     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00546000
005470                                                 VALUE ZEROS.     00547000
005500                                                                  00550000
005600*----------------------------------------------------------------*00560000
005700*  SYSTEM MESSAGES                                               *00570000
005800*----------------------------------------------------------------*00580000
005900*   00005 = INVALID VALUE                                         00590000
006000*   00007 = REQUIRED ENTRY                                        00600000
006100*   00008 = MUST BE NUMERIC                                       00610000
006200*   00050 = NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   00620000
006300*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00630000
006400*   00059 = UPDATE(S) SUCCESSFUL                                  00640000
006500*   00069 = TOP OF LIST                                           00650000
006600*   00070 = BOTTOM OF LIST                                        00660000
006700*   00101 = VALUE MUST BE GREATER THAN ZERO AND LESS THAN 1,000,0000670000
006800*   00279 = MORE ITEMS TO DISPLAY                                 00680000
006900*   00551 = WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL 00690000
007000*   00966 = INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS     00700000
007010*   00984 = DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES          00701046
007020*   03135 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR00702046
007030*   03136 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR00703046
007040*   03137 = YOU DO NOT HAVE THE AUTHORITY TO UPDATE CONFIRMATION  00704046
007050*   03138 = AN ERROR OCCURRED DETERMINING F-KEY ELIGIBILITY - CONT00705046
007100*   99901 = INVALID COMMAND WAS ENTERED                           00710000
007200*----------------------------------------------------------------*00720000
007300     05  PC-TSYMSG-NUMBERS.                                       00730000
007400         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00740000
007500         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     00750000
007600         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     00760000
007700         10  PC-TSYMSG-00050          PIC 9(05)  VALUE 00050.     00770000
007800         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     00780000
007900         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     00790000
008000         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     00800000
008100         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     00810000
008200         10  PC-TSYMSG-00101          PIC 9(05)  VALUE 00101.     00820000
008300         10  PC-TSYMSG-00279          PIC 9(05)  VALUE 00279.     00830000
008400         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     00840000
008410         10  PC-TSYMSG-00736          PIC 9(05)  VALUE 00736.     00841046
008500         10  PC-TSYMSG-00966          PIC 9(05)  VALUE 00966.     00850000
008510         10  PC-TSYMSG-00984          PIC 9(05)  VALUE 00984.     00851046
008700         10  PC-TSYMSG-01298          PIC 9(05)  VALUE 01298.     00870000
008800         10  PC-TSYMSG-02463          PIC 9(05)  VALUE 02463.     00880000
008810         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     00881000
008901         10  PC-TSYMSG-03135          PIC 9(05)  VALUE 03135.     00890146
008902         10  PC-TSYMSG-03136          PIC 9(05)  VALUE 03136.     00890246
008903         10  PC-TSYMSG-03137          PIC 9(05)  VALUE 03137.     00890346
008904         10  PC-TSYMSG-03138          PIC 9(05)  VALUE 03138.     00890446
008905         10  PC-TSYMSG-99901          PIC 9(05)  VALUE 99901.     00890546
008910                                                                  00891046
009000     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00900000
009100                     '9999-09-09-09.09.09.999999'.                00910000
009200     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00920000
009300                     '09/09/9999'.                                00930000
009400                                                                  00940000
009401     05  PC-FKEY-MODULE               PIC X(08) VALUE 'RCKUT126'. 00940146
009402     05  PC-AUTO-VE-MODULE            PIC X(08) VALUE 'RCKUT127'. 00940247
009403     05  PC-FKEY-MODULE-LENGTH        PIC S9(04) VALUE  +400      00940346
009404                                                    COMP SYNC.    00940446
009405                                                                  00940546
009410*----------------------------------------------------------------*00941000
009420* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *00942000
009430*----------------------------------------------------------------*00943000
009440     05  PC-000                       PIC X(03) VALUE '000'.      00944000
009450     05  PC-999                       PIC X(03) VALUE '999'.      00945000
009460*----------------------------------------------------------------*00946000
009470* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00947000
009480*----------------------------------------------------------------*00948000
009490                                                                  00949000
009500 01  PS-PROGRAM-SWITCHES.                                         00950000
009540     05  PS-FUNTION-RACF-SW           PIC X(01) VALUE 'N'.        00954047
009550         88  PS-FUNCTION-RACF-YES               VALUE 'Y'.        00955047
009560         88  PS-FUNCTION-RACF-NO                VALUE 'N'.        00956047
009600     05  PS-ERROR-SW                  PIC X(01) VALUE 'Y'.        00960000
009700         88  PS-NO-ERROR                        VALUE 'Y'.        00970000
009800         88  PS-ERROR                           VALUE 'N'.        00980000
009900     05  PS-LIST-END-SW               PIC X(01) VALUE 'N'.        00990000
010000         88  PS-LIST-END                        VALUE 'Y'.        01000000
010100         88  PS-NO-LIST-END                     VALUE 'N'.        01010000
010200     05  PS-COMMAREA-SW               PIC X(01) VALUE 'N'.        01020000
010300         88  PS-COMMAREA-VALID                  VALUE 'Y'.        01030000
010400         88  PS-COMMAREA-NOT-VALID              VALUE 'N'.        01040000
010500     05  PS-NEXT-SCREEN-SW            PIC X(01) VALUE 'N'.        01050000
010600         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01060000
010700         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01070000
010800     05  PS-MORE-RECITM-SW            PIC X(01) VALUE 'N'.        01080000
010900         88  PS-MORE-RECITM-YES                 VALUE 'Y'.        01090000
011000         88  PS-MORE-RECITM-NO                  VALUE 'N'.        01100000
011010     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       01101000
011020         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       01102000
011030         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       01103000
011040     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01)  VALUE 'Y'.       01104000
011050         88 PS-FIRST-TIME-UPDATE                 VALUE 'Y'.       01105000
011060         88 PS-NOT-FIRST-TIME-UPDATE             VALUE 'N'.       01106000
011100                                                                  01110000
011200*  LINE LEVEL SWITCHES                                            01120000
011300     05  PS-VERIFY-MODULE-SW          PIC X(01) VALUE 'N'.        01130000
011400         88  PS-DONT-SUBMIT-E200                VALUE 'N'.        01140000
011500         88  PS-DO-SUBMIT-E200                  VALUE 'Y'.        01150000
011600                                                                  01160000
011610*----------------------------------------------------------------*01161000
011620*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *01162000
011630*----------------------------------------------------------------*01163000
011640     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01164000
011650         88  PS-CALL-API-NO                     VALUE 'N'.        01165000
011660         88  PS-CALL-API-YES                    VALUE 'Y'.        01166000
011670*----------------------------------------------------------------*01167000
011680* CHANGES MADE FOR WR # 21361 ENDS HERE.        *                 01168000
011690*----------------------------------------------------------------*01169000
011691                                                                  01169100
011700 01  PA-PROGRAM-ACCUMULATORS.                                     01170000
011800     05  PA-FCSE-QTY                  PIC S9(9) VALUE +0.         01180000
011900     05  PA-ODD-QTY                   PIC S9(9) VALUE +0.         01190000
012000     05  PA-TOT-QTY                   PIC S9(9) VALUE +0.         01200000
012010     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         01201000
012020     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         01202000
012030     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         01203000
012050                                                                  01205000
012060*----------------------------------------------------------------*01206000
012070*                                                    WR # 21361  *01207000
012080* ADDED NEW PROGRAM VARIABLES PV-TEMP-SKU WITH PIC 9(8) AND      *01208000
012081* PV-SKU WITH PIC X(8).                                          *01208100
012090*----------------------------------------------------------------*01209000
012100                                                                  01210000
012200 01  PV-PROGRAM-VARIABLES.                                        01220000
012210     05  PV-SUM-OF-PACKS                 PIC S9(09)  VALUE ZERO   01221050
012220                                                    COMP-3.       01222050
012300     05  PV-SEL-TERM-ID                  PIC  X(04).              01230000
012400     05  PV-SEL-TASK-NUMBER              PIC  9(05).              01240000
012500     05  PV-SEL-SEQ                      PIC  9(01).              01250000
012510     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01251000
012600     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01260000
012700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01270000
012800                                                     COMP SYNC.   01280000
012810     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     01281000
012820                                                    COMP SYNC.    01282000
012900     05  PV-READ-COUNT                PIC S9(9) VALUE +0 COMP-3.  01290000
013000     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE +0 COMP-3.  01300000
013100     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE +0 COMP-3.  01310000
013200     05  PV-ITEM-IN-USE               PIC S9(9) VALUE +0 COMP-3.  01320000
013300     05  PV-TOP-ITEM                  PIC S9(9) VALUE +0 COMP-3.  01330000
013400     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE +0 COMP-3.  01340000
013500     05  PV-SUB                       PIC S9(4) VALUE +0          01350000
013600                                                      COMP SYNC.  01360000
013700     05  PV-REMAINDER                 PIC S9(4) VALUE +0          01370000
013800                                                      COMP SYNC.  01380000
013900     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE +0          01390000
014000                                                      COMP SYNC.  01400000
014100     05  PV-CICS-RESP                 PIC S9(4) VALUE +0          01410000
014200                                                      COMP SYNC.  01420000
014300     05  PV-CICS-RESP-2               PIC S9(4) VALUE +0          01430000
014400                                                      COMP SYNC.  01440000
014500     05  PV-ITEM                      PIC S9(4) VALUE +0          01450000
014600                                                      COMP SYNC.  01460000
014700     05  PV-SAVE-ITEM                 PIC S9(4) VALUE +0          01470000
014800                                                      COMP SYNC.  01480000
014900     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE +0          01490000
015000                                                      COMP SYNC.  01500000
015100     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE +0          01510000
015200                                                      COMP SYNC.  01520000
015300     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE +0          01530000
015400                                                      COMP SYNC.  01540000
015500     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE +0          01550000
015600                                                      COMP SYNC.  01560000
015700     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE +0          01570000
015800                                                      COMP SYNC.  01580000
015900     05  PV-TOTAL-LINE-COUNT          PIC S9(9) VALUE +0          01590000
016000                                                      COMP SYNC.  01600000
016100     05  PV-PREPK-BLANK-COUNT         PIC S9(9) VALUE +0          01610000
016200                                                      COMP SYNC.  01620000
016300     05  PV-NULL-IND                  PIC S9(4) VALUE +0          01630000
016400                                                      COMP SYNC.  01640000
016500     05  PV-DATE                      PIC X(10) VALUE SPACES.     01650000
016600     05  PV-TIME                      PIC X(05) VALUE SPACES.     01660000
016700     05  PV-UPDATE-QTY                PIC S9(5) VALUE +0 COMP-3.  01670000
016800     05  PV-PROCESS-CHANGE-QTY        PIC S9(5) VALUE +0 COMP-3.  01680000
016900     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   01690000
017000     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  01700000
017001     05  PV-DISPLAY-PO                PIC 9(09).                  01700150
017002     05  PV-DISPLAY-RECV              PIC 9(09).                  01700250
017003     05  PV-DISPLAY-SKU               PIC 9(08).                  01700350
017010     05  PV-DISTHD-FCSE-FCLTY-AREA-ID PIC X(06)  VALUE SPACES.    01701000
017020     05  PV-DISTHD-OPER-UNT-ID        PIC S9(4)  COMP             01702000
017030                                                 VALUE ZERO.      01703000
017040     05  PV-DISTHD-FCSE-CNFRMN-TMST   PIC X(26).                  01704000
017050     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   01705000
017060     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  01706000
017070     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.01707000
017072     05  PV-TEMP-SKU                  PIC 9(08).                  01707200
017073     05  PV-SKU                       PIC X(08).                  01707300
017080     05  PV-TMST                      PIC X(26).                  01708000
017090     05  FILLER REDEFINES PV-TMST.                                01709000
017091         10  PV-CCYY                  PIC X(04).                  01709100
017092         10  FILLER                   PIC X(01).                  01709200
017093         10  PV-MM                    PIC X(02).                  01709300
017094         10  FILLER                   PIC X(01).                  01709400
017095         10  PV-DD                    PIC X(02).                  01709500
017096         10  FILLER                   PIC X(01).                  01709600
017097         10  PV-HH                    PIC X(02).                  01709700
017098         10  FILLER                   PIC X(01).                  01709800
017099         10  PV-MIN                   PIC X(02).                  01709900
017100         10  FILLER                   PIC X(01).                  01710000
017101         10  PV-SEC                   PIC X(02).                  01710100
017102         10  FILLER                   PIC X(01).                  01710200
017103         10  FILLER                   PIC X(06).                  01710300
017104                                                                  01710446
017105     05  PV-PO-NBR                    PIC 9(08).                  01710546
017106     05  PV-RCVR-NBR                  PIC 9(04).                  01710646
017107     05  PV-OPER-UNT-ID               PIC 9(04).                  01710746
017108     05  PV-FCLTY-ID                  PIC 9(04).                  01710846
017109     05  PV-LINE-NBR                  PIC 9(04).                  01710946
017110     05  PV-PACK-ID                   PIC 9(04).                  01711046
017111                                                                  01711146
017113*----------------------------------------------------------------*01711300
017114* CHANGES MADE FOR WR # 21361 ENDS HERE.        *                 01711400
017115*----------------------------------------------------------------*01711500
017120                                                                  01712000
017200*---------------------------------------------------------------* 01720000
017300*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 01730000
017400*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 01740000
017500*   APPLICATION-SPECIFIC COMMAREA.                              * 01750000
017600*---------------------------------------------------------------* 01760000
017610*----------------------------------------------------------------*01761000
017620*                                                **   WR # 21361 *01762000
017630* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *01763000
017640*----------------------------------------------------------------*01764000
017700 01  LQW-LIST-QUEUE-WORK-AREA.                                    01770000
017800     05  LQW-BLOCK-MODIFIED           PIC X(01) VALUE SPACE.      01780000
017900     05  LQW-ITEM-ENTRIES OCCURS 12 TIMES INDEXED BY LQW-IDX.     01790000
018000         10  LQW-LIST-ITEM-NUMBER     PIC S9(9) COMP-3.           01800000
018100         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  01810000
018200         10  LQW-SELECTED-SW          PIC X(01).                  01820000
018300             88  LQW-SELECT                     VALUE 'S'.        01830000
018400             88  LQW-DESELECT                   VALUE SPACE.      01840000
018500         10  LQW-ACTION               PIC X(03).                  01850000
018600             88  LQW-NULL-ACTION                    VALUE SPACES. 01860000
018700             88  LQW-ERROR                          VALUE 'ERR'.  01870000
018800             88  LQW-INQUIRE                        VALUE 'INQ'.  01880000
018900             88  LQW-UPDATE                         VALUE 'UPD'.  01890000
019000             88  LQW-DELETE                         VALUE 'DLT'.  01900000
019100             88  LQW-ADD                            VALUE 'ADD'.  01910000
019200         10  LQW-U-PROCESS-QTY-X.                                 01920000
019300             15 LQW-U-PROCESS-QTY     PIC 9(05).                  01930000
019400         10  LQW-LINE-NBR             PIC X(04).                  01940000
019500         10  LQW-CLASS                PIC X(02).                  01950000
019910         10  LQW-SKU                  PIC X(08).                  01991000
020000         10  LQW-PACK-ID              PIC X(04).                  02000000
020100         10  LQW-PACK-RATIO           PIC 9(04).                  02010000
020110         10  LQW-EXPECT-QTY           PIC 9(05).                  02011051
020200         10  LQW-FCSE-QTY             PIC 9(05).                  02020000
020300         10  LQW-ODD-UNIT             PIC 9(05).                  02030000
020400         10  LQW-TOTAL-QTY            PIC 9(05).                  02040000
020500                                                                  02050000
020510*----------------------------------------------------------------*02051000
020520*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        02052000
020530*----------------------------------------------------------------*02053000
020600*---------------------------------------------------------------* 02060000
020700*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02070000
020800*---------------------------------------------------------------* 02080000
020900     COPY RCWS013.                                                02090045
021000                                                                  02100000
021010***************************************************************** 02101046
021020*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO        * 02102046
021030*             THE F-KEY ELIGIBILITY MODULE (RCKUT126).          * 02103046
021040***************************************************************** 02104046
021050     COPY RCWS039.                                                02105046
021051                                                                  02105147
021052***************************************************************** 02105247
021053*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 02105347
021054*             AUTOVERIFY (AUTOVE) MODULE (RCKUT127).            * 02105447
021055***************************************************************** 02105547
021056     COPY RCWS040.                                                02105647
021057                                                                  02105747
021060/                                                                 02106046
021500     COPY RCWS074.                                                02150050
021510/                                                                 02151059
021600*    LOCATION MODULE                                              02160000
021610     COPY XLWS071.                                                02161057
021620                                                                  02162057
021700     COPY RCKM813.                                                02170000
021800                                                                  02180000
021900 01  MR-OCCURS-LAYOUT                   REDEFINES  RC813AO.       02190000
021910*CLP 10/21/14                                                     02191059
022000     02  MR-HEADER-INFO.                                          02200000
022100     05  FILLER                       PIC X(155).                 02210055
022200                                                                  02220000
022300     02  MR-DETAIL-LINES.                                         02230000
022400     05  MR-SCROLL-AREA OCCURS 12 TIMES.                          02240000
022500         10  MR-SELECTL               PIC S9(4) COMP.             02250000
022600         10  MR-SELECTA               PIC X(01).                  02260000
022700         10  MR-SELECTC               PIC X(01).                  02270000
022800         10  MR-SELECTH               PIC X(01).                  02280000
022900         10  MR-SELECT                PIC X(01).                  02290000
023000                                                                  02300000
023100         10  MR-ACTIONL               PIC S9(4) COMP.             02310000
023200         10  MR-ACTIONA               PIC X(01).                  02320000
023300         10  MR-ACTIONC               PIC X(01).                  02330000
023400         10  MR-ACTIONH               PIC X(01).                  02340000
023500         10  MR-ACTION                PIC X(03).                  02350000
023600                                                                  02360000
023700         10  MR-U-PROCESS-QTYL        PIC S9(4) COMP.             02370000
023800         10  MR-U-PROCESS-QTYA        PIC X(01).                  02380000
023900         10  MR-U-PROCESS-QTYC        PIC X(01).                  02390000
024000         10  MR-U-PROCESS-QTYH        PIC X(01).                  02400000
024100         10  MR-U-PROCESS-QTY-X.                                  02410000
024200             15 MR-U-PROCESS-QTY      PIC ZZZZ9.                  02420000
024300                                                                  02430000
024400         10  MR-LINEL                 PIC S9(4) COMP.             02440000
024500         10  MR-LINEA                 PIC X(01).                  02450000
024600         10  MR-LINEC                 PIC X(01).                  02460000
024700         10  MR-LINEH                 PIC X(01).                  02470000
024800         10  MR-LINE                  PIC X(04).                  02480000
024900                                                                  02490000
025000         10  MR-CLASSL                PIC S9(4) COMP.             02500000
025100         10  MR-CLASSA                PIC X(01).                  02510000
025200         10  MR-CLASSC                PIC X(01).                  02520000
025300         10  MR-CLASSH                PIC X(01).                  02530000
025400         10  MR-CLASS                 PIC X(02).                  02540000
025500                                                                  02550000
025600         10  MR-SKUL                  PIC S9(4) COMP.             02560000
025700         10  MR-SKUA                  PIC X(01).                  02570000
025800         10  MR-SKUC                  PIC X(01).                  02580000
025900         10  MR-SKUH                  PIC X(01).                  02590000
026000         10  MR-SKU                   PIC X(08).                  02600000
026100                                                                  02610000
026200         10  MR-PACKL                 PIC S9(4) COMP.             02620000
026300         10  MR-PACKA                 PIC X(01).                  02630000
026400         10  MR-PACKC                 PIC X(01).                  02640000
026500         10  MR-PACKH                 PIC X(01).                  02650000
026600         10  MR-PACK                  PIC X(04).                  02660000
026700                                                                  02670000
026800         10  MR-EXPTD-QTYL            PIC S9(4) COMP.             02680051
026900         10  MR-EXPTD-QTYA            PIC X(01).                  02690051
027000         10  MR-EXPTD-QTYC            PIC X(01).                  02700051
027100         10  MR-EXPTD-QTYH            PIC X(01).                  02710051
027200         10  MR-EXPTD-QTY-X.                                      02720051
027300             15 MR-EXPTD-QTY          PIC ZZZZ9.                  02730051
027400                                                                  02740000
027410         10  MR-FCSE-QTYL             PIC S9(4) COMP.             02741051
027420         10  MR-FCSE-QTYA             PIC X(01).                  02742051
027430         10  MR-FCSE-QTYC             PIC X(01).                  02743051
027440         10  MR-FCSE-QTYH             PIC X(01).                  02744051
027450         10  MR-FCSE-QTY-X.                                       02745051
027460             15 MR-FCSE-QTY           PIC ZZZZ9.                  02746051
027470                                                                  02747051
027500         10  MR-ODD-QTYL              PIC S9(4) COMP.             02750000
027600         10  MR-ODD-QTYA              PIC X(01).                  02760000
027700         10  MR-ODD-QTYC              PIC X(01).                  02770000
027800         10  MR-ODD-QTYH              PIC X(01).                  02780000
027900         10  MR-ODD-QTY-X.                                        02790000
028000             15 MR-ODD-QTY            PIC ZZZZ9.                  02800000
028100                                                                  02810000
028200         10  MR-TOTAL-QTYL            PIC S9(4) COMP.             02820000
028300         10  MR-TOTAL-QTYA            PIC X(01).                  02830000
028400         10  MR-TOTAL-QTYC            PIC X(01).                  02840000
028500         10  MR-TOTAL-QTYH            PIC X(01).                  02850000
028600         10  MR-TOTAL-QTY-X.                                      02860000
028700             15 MR-TOTAL-QTY          PIC ZZZZ9.                  02870000
028800                                                                  02880000
028900     COPY DPWS015.                                                02890045
029000                                                                  02900000
029100     COPY DPWS016.                                                02910045
029200                                                                  02920000
029300     COPY DPWS010I.                                               02930045
029400                                                                  02940000
029410******************************************************************02941060
029420** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **02942060
029430** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02943060
029440******************************************************************02944060
029500     COPY DPWS030.                                                02950045
029510     COPY DPWS930.                                                02951060
029600                                                                  02960000
029700*---------------------------------------------------------------* 02970000
029800*    STANDARD COMMAREA.                                         * 02980000
029900*---------------------------------------------------------------* 02990000
030000     COPY DPWS020.                                                03000045
030100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03010000
030200                                                                  03020000
030300*---------------------------------------------------------------* 03030000
030400* INTER-APPLICATION COMMAREA.                                   * 03040000
030500*---------------------------------------------------------------* 03050000
030600         10  INTER-APPL-COMM-AREA     PIC X(200).                 03060000
030700     COPY RCWS012.                                                03070000
030800     COPY RCWS015.                                                03080000
030900*---------------------------------------------------------------* 03090000
031000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03100000
031100*---------------------------------------------------------------* 03110000
031110*----------------------------------------------------------------*03111000
031120*                                             WR # 21361         *03112000
031130* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *03113000
031140* GROUP VARIABLE ASC-SKU IS CHANGED TO AN INDIVIDUAL VARIABLE  *  03114000
031141* WITH SAME PICTURE CLAUSE X(8).                                 *03114100
031150*----------------------------------------------------------------*03115000
031200         10  ASC-SPECIFIC-COMMAREA.                               03120000
031300             15  ASC-HEADER-KEYS.                                 03130000
031400                 20  ASC-KEY-PO-NBR        PIC S9(9) COMP.        03140000
031500                 20  ASC-KEY-RCVR-NBR      PIC S9(9) COMP.        03150000
031600                 20  ASC-KEY-OPER-UNT-ID   PIC S9(4) COMP.        03160000
031700                 20  ASC-KEY-FCLTY-ID      PIC S9(4) COMP.        03170000
031800             15  ASC-LIST-KEYS.                                   03180000
031900                 20  ASC-KEY-STR-NBR       PIC S9(4) COMP.        03190000
032000                 20  ASC-KEY-PACK-ID       PIC S9(4) COMP.        03200000
032100                 20  ASC-KEY-LNE-NBR       PIC S9(9) COMP.        03210000
032200                 20  ASC-DRV-LNE-NBR       PIC S9(9) COMP.        03220000
032300             15  ASC-HEADER-FIELDS.                               03230000
032400                 20  ASC-RCVR-OPER-UNT-ID  PIC S9(4) COMP.        03240000
032500                 20  ASC-OPER-UNT-ID       PIC 9(04).             03250000
032600                 20  ASC-FCLTY-ID          PIC 9(04).             03260000
032700                 20  ASC-ORD-NBR           PIC 9(08).             03270000
032800*CLP 10/21/14    20  ASC-ORD-NBR-7         PIC 9(07).             03280000
032900                 20  ASC-RCVR-NBR          PIC 9(04).             03290000
033000                 20  ASC-STORE-NBR         PIC 9(04).             03300000
033100                 20  ASC-STORE-NAME        PIC X(25).             03310000
033200                 20  ASC-DEPT              PIC X(03).             03320000
033300                 20  ASC-PKGNG-CDE-DISPLAY PIC X(01).             03330000
033400                 20  ASC-PKGNG-CDE         PIC X(01).             03340000
033500                     88  ASC-BULK                    VALUE 'B'.   03350000
033600                     88  ASC-CASEPACK                VALUE 'C'.   03360000
033700                     88  ASC-INNER-PREPK             VALUE 'I'.   03370000
033800                     88  ASC-MULTI-SKU-PREPK         VALUE 'M'.   03380000
033900                     88  ASC-SINGLE-SKU-PREPK        VALUE 'S'.   03390000
034000                 20  ASC-PROTECT-SW        PIC X(01).             03400000
034100                     88  ASC-PROTECT-ALL-STORES      VALUE 'Y'.   03410000
034200                                                                  03420000
034300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03430000
034400                 20  ASC-BLOCK-MODIFIED-SW                        03440000
034500                                           PIC  X(01).            03450000
034600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03460000
034700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03470000
034800                                                                  03480000
034900                 20  ASC-ITEM-ARRAY.                              03490000
035000                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        03500000
035100                         30  ASC-LIST-ITEM-NUMBER                 03510000
035200                                           PIC S9(9) COMP-3.      03520000
035300                         30  ASC-TEMP-SELECTED-SW PIC X(01).      03530000
035400                             88  ASC-VALID-SELECT    VALUE ' '    03540000
035500                                                           'S'.   03550000
035600                             88  ASC-TEMP-SELECT     VALUE 'S'.   03560000
035700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03570000
035800                         30  ASC-SELECTED-SW      PIC X(01).      03580000
035900                             88  ASC-NO-SELECT       VALUE ' '.   03590000
036000                             88  ASC-SELECT          VALUE 'S'.   03600000
036100                         30  ASC-ACTION      PIC X(03).           03610000
036200                             88  ASC-DEL             VALUE 'DEL'. 03620000
036300                             88  ASC-INQ             VALUE 'INQ'. 03630000
036400                             88  ASC-UPD             VALUE 'UPD'. 03640000
036500                             88  ASC-ERR             VALUE 'ERR'. 03650000
036600                         30  ASC-U-PROCESS-QTY-X  PIC X(05).      03660000
036700                         30  ASC-U-PROCESS-QTY REDEFINES          03670000
036800                             ASC-U-PROCESS-QTY-X  PIC 9(05).      03680000
036900                         30  ASC-LINE-X           PIC X(04).      03690000
037000                         30  ASC-LINE REDEFINES                   03700000
037100                             ASC-LINE-X           PIC 9(04).      03710000
037200                         30  ASC-CLASS            PIC X(02).      03720000
037610                         30  ASC-SKU              PIC X(08).      03761000
037700                         30  ASC-PACK-ID-X        PIC X(04).      03770000
037800                         30  ASC-PACK-ID REDEFINES                03780000
037900                             ASC-PACK-ID-X        PIC 9(04).      03790000
038000                         30  ASC-PREPK-RATO-QTY   PIC 9(04).      03800000
038010                         30  ASC-EXPECT-QTY       PIC 9(05).      03801051
038100                         30  ASC-FCSE-QTY         PIC 9(05).      03810000
038200                         30  ASC-ODD-QTY          PIC 9(05).      03820000
038300                         30  ASC-TOT-QTY          PIC 9(05).      03830000
038400                                                                  03840000
038500             15  ASC-BLK-SUB               PIC S9(4) COMP SYNC.   03850000
038600             15  ASC-ITEM-SUB              PIC S9(4) COMP SYNC.   03860000
038700             15  ASC-NUMBER-OF-ITEMS-READ  PIC S9(9) COMP-3.      03870000
038800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03880000
038900                                           PIC S9(9) COMP-3.      03890000
039000             15  ASC-ITEMS-DISPLAYED       PIC S9(3) COMP-3.      03900000
039100             15  ASC-ITEM-AT-TOP-OF-PANEL  PIC S9(9) COMP-3.      03910000
039200             15  ASC-ITEM-AT-BOT-OF-PANEL  PIC S9(9) COMP-3.      03920000
039300             15  ASC-HIGHEST-BLOCK-WRITTEN PIC S9(4) COMP SYNC.   03930000
039400             15  ASC-ITEMS-LEFT-INDICATOR  PIC X(01).             03940000
039500                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03950000
039600                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03960000
039700             15  ASC-TEMP-QUEUE-UPDATE-SW  PIC X(01).             03970000
039800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03980000
039900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03990000
040000             15  ASC-LIST-QUEUE-NAME.                             04000000
040100                 20  ASC-LIST-TERM-ID      PIC X(04).             04010000
040200                 20  ASC-LIST-TASK-NUMBER  PIC S9(05) COMP-3.     04020000
040300                 20  ASC-LIST-SEQ          PIC 9(01).             04030000
040400             15  ASC-SEL-QUEUE-NAME.                              04040000
040500                 20  ASC-SEL-TERM-ID       PIC X(04).             04050000
040600                 20  ASC-SEL-TASK-NUMBER   PIC S9(05) COMP-3.     04060000
040700                 20  ASC-SEL-SEQ           PIC 9(01).             04070000
040800             15  ASC-SEL-QUEUE-NAME-IN     PIC X(08).             04080000
040900             15  ASC-START-ITEM-REQUEST.                          04090000
041000                 20  ASC-START-ITEM-REQUEST-N                     04100000
041100                                           PIC 9(07).             04110000
041200             15  ASC-USE-SELECTION-QUEUE-IND PIC X(01).           04120000
041300                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   04130000
041400             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(5) COMP-3.      04140000
041500             15  ASC-SEL-SUB               PIC S9(4) COMP.        04150000
041600             15  ASC-SEL-ITEM              PIC S9(4) COMP.        04160000
041700             15  ASC-DISPLAY-FORMAT        PIC X(01).             04170000
041710             15  ASC-AUTO-VE-SW            PIC X(01).             04171050
041720                 88  ASC-AUTO-VE-YES        VALUE 'Y'.            04172050
041730                 88  ASC-AUTO-VE-NO         VALUE 'N'.            04173050
041800                                                                  04180000
041810*----------------------------------------------------------------*04181000
041820* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04182000
041830*----------------------------------------------------------------*04183000
041900*---------------------------------------------------------------* 04190000
042000*---------------------------------------------------------------* 04200000
042100     COPY DPWS013.                                                04210045
042200                                                                  04220000
042210*----------------------------------------------------------------*04221000
042220*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *04222000
042230*----------------------------------------------------------------*04223000
042240     COPY PCWS238.                                                04224045
042250                                                                  04225000
042260*---------------------------------------------------------------* 04226000
042270*                                                **   WR # 21361* 04227000
042280*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 04228000
042281*---------------------------------------------------------------* 04228100
042282     COPY XLWS001.                                                04228200
042283*----------------------------------------------------------------*04228300
042284*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        04228400
042285*----------------------------------------------------------------*04228500
042290                                                                  04229000
042300**        SUT_OTBND_PK                                            04230052
042310     EXEC SQL                                                     04231052
042320          INCLUDE SUT00041                                        04232052
042330     END-EXEC.                                                    04233052
042340                                                                  04234052
042800     EXEC SQL                                                     04280000
042900          INCLUDE TDISTHD                                         04290000
043000     END-EXEC.                                                    04300000
043100                                                                  04310000
043110     EXEC SQL                                                     04311052
043120          INCLUDE TPOPRPK                                         04312052
043130     END-EXEC.                                                    04313052
043140                                                                  04314052
043200     EXEC SQL                                                     04320000
043300          INCLUDE TDISTDT                                         04330000
043400     END-EXEC.                                                    04340000
043500                                                                  04350000
043600     EXEC SQL                                                     04360000
043700          INCLUDE TRECEIV                                         04370000
043800     END-EXEC.                                                    04380000
043900                                                                  04390000
044000     EXEC SQL                                                     04400000
044100          INCLUDE TRECITM                                         04410000
044200     END-EXEC.                                                    04420000
044300                                                                  04430000
044400     EXEC SQL                                                     04440000
044500          INCLUDE TPURCHS                                         04450000
044600     END-EXEC.                                                    04460000
044700                                                                  04470000
044800     EXEC SQL                                                     04480000
044900          INCLUDE TPURITM                                         04490000
045000     END-EXEC.                                                    04500000
045100                                                                  04510000
045200     EXEC SQL                                                     04520000
045300          INCLUDE SQLCA                                           04530000
045400     END-EXEC.                                                    04540000
045500                                                                  04550000
045600*---------------------------------------------------------------* 04560000
045700*    DRIVING CURSOR                                               04570000
045800*---------------------------------------------------------------* 04580000
045900     EXEC SQL                                                     04590000
046000         DECLARE STORE-CSR CURSOR FOR                             04600000
046100          SELECT ORD_LNE_NBR                                      04610000
046200               , FCSE_SPLT_UNT_QTY                                04620000
046300               , FCSE_ACTL_UNT_QTY                                04630000
046400               , PREPK_ODD_UNT_QTY                                04640000
046500            FROM TDISTDT A                                        04650000
046600           WHERE A.ORD_NBR       = :DK-ORD-NBR                    04660000
046700             AND A.RCVR_SEQ_NBR  = :DK-RCVR-NBR                   04670000
046800             AND A.STR_NBR       = :DK-STR-NBR                    04680000
046900        ORDER BY ORD_LNE_NBR                                      04690000
047000     END-EXEC.                                                    04700000
047100                                                                  04710000
047200*---------------------------------------------------------------* 04720000
047300*  CURSOR TO SELECT DETAIL LINES (BY PACK ID)                   * 04730000
047400*---------------------------------------------------------------* 04740000
047500                                                                  04750000
047600     EXEC SQL                                                     04760000
047700          DECLARE PREPK-SEARCH-CSR CURSOR FOR                     04770000
047800           SELECT A.ORD_LNE_NBR                                   04780000
047900                , A.PREPK_RATO_QTY                                04790000
048000             FROM TRECITM A                                       04800000
048100            WHERE A.ORD_NBR        = :DK-ORD-NBR                  04810000
048200              AND A.REC_SEQ_NBR    = :DK-RCVR-NBR                 04820000
048300              AND A.PREPK_ID       = :DK-PACK-ID                  04830000
048400         ORDER BY A.ORD_LNE_NBR                                   04840000
048500     END-EXEC.                                                    04850000
048600                                                                  04860000
048700*---------------------------------------------------------------* 04870000
048800*---------------------------------------------------------------* 04880000
048900 LINKAGE SECTION.                                                 04890000
049000                                                                  04900000
049100 01  DFHCOMMAREA.                                                 04910000
049200     05  FILLER OCCURS  1 TO 4072 TIMES DEPENDING ON EIBCALEN.    04920000
049300         10  FILLER                   PIC X.                      04930000
049400                                                                  04940000
049500/                                                                 04950000
049600 PROCEDURE DIVISION.                                              04960000
049700*---------------------------------------------------------------* 04970000
049800*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 04980000
049900*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 04990000
050000*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 05000000
050100*---------------------------------------------------------------* 05010000
050200 0000-MAIN-MODULE.                                                05020000
050300                                                                  05030000
050400     INITIALIZE DP030-CICS-API-FIELDS.                            05040000
050500                                                                  05050000
050600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05060000
050700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05070000
050800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05080000
050900                                                                  05090000
051000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05100000
051100                                                                  05110000
051200     MOVE LENGTH OF RC813AI        TO DP030-MAP-LENGTH (1).       05120000
051300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05130000
051400                                                                  05140000
051500     PERFORM 0001-CALL-CICS-ARCH-API.                             05150000
051600     PERFORM 1000-CONTROL-PROCESSING                              05160000
051700                                                                  05170000
051800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05180000
051900     PERFORM 0001-CALL-CICS-ARCH-API.                             05190000
052000                                                                  05200000
052100*---------------------------------------------------------------* 05210000
052200*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 05220000
052300*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 05230000
052400*---------------------------------------------------------------* 05240000
052500 0001-CALL-CICS-ARCH-API.                                         05250000
052610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05261060
052700                                    DFHCOMMAREA                   05270060
052800                                    DP030-CICS-API-FIELDS         05280060
052900                                    DP020-STANDARD-COMMAREA       05290060
053000                                    RC813AI.                      05300060
053100                                                                  05310000
053200     IF  DP030-RC-CALL-SUCCESSFUL                                 05320000
053300         CONTINUE                                                 05330000
053400     ELSE                                                         05340000
053500         SET DP013-NO-ROLLBACK                                    05350000
053600             DP013-XCTL-DISPLAY-RESTART                           05360000
053700             DP013-CICS-ABEND      TO TRUE                        05370000
053800         MOVE '0001-CALL-CICS-ARCH-API'                           05380000
053900                                   TO DP013-PARAGRAPH             05390000
053920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O05392060
053930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05393060
054200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05420000
054300         PERFORM DP013-0000-PROCESS-ABEND                         05430000
054400     END-IF.                                                      05440000
054500                                                                  05450000
054600*----------------------------------------------------------------*05460000
054700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05470000
054800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05480000
054900*                                                                *05490000
055000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05500000
055100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05510000
055200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05520000
055300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05530000
055400*----------------------------------------------------------------*05540000
055500 1000-CONTROL-PROCESSING.                                         05550000
055600                                                                  05560000
055700     EVALUATE TRUE                                                05570000
055800         WHEN DP020-NEXT-ACT-INITIAL                              05580000
055900             INITIALIZE ASC-SPECIFIC-COMMAREA                     05590000
056000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05600000
056100                                      ASC-SEL-TERM-ID             05610000
056200             MOVE DP020-SRC-TASK-NUMBER                           05620000
056300                                   TO ASC-LIST-TASK-NUMBER        05630000
056400                                      ASC-SEL-TASK-NUMBER         05640000
056500             MOVE PC-LIST-QUEUE-SEQ                               05650000
056600                                   TO ASC-LIST-SEQ                05660000
056700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 05670000
056800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05680000
056900                                                                  05690000
057000***-----$TEMPLATE NOTE$-------------------------------------------05700000
057100*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05710000
057200*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05720000
057300*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05730000
057400***---------------------------------------------------------------05740000
057500             IF PS-COMMAREA-NOT-VALID                             05750000
057600***              MOVE PC-TSYMSG-99901 TO DP020-MSG-NUMBER         05760000
057700                 SET DP020-MSG-FATAL  TO TRUE                     05770000
057800                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            05780000
057900             ELSE                                                 05790000
058000                 PERFORM 3200-RESET-ATTRIBUTES                    05800000
058100                 PERFORM 4000-BUILD-INITIAL-PANEL                 05810000
058200             END-IF                                               05820000
058300                                                                  05830000
058400         WHEN DP020-NEXT-ACT-READ-MAP                             05840000
058500             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         05850000
058600             PERFORM 2000-PROCESS-PANEL                           05860000
058700                                                                  05870000
058800         WHEN DP020-NEXT-ACT-RETURN                               05880000
058900             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           05890000
059000             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              05900000
059100             MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR               05910000
059200             MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR              05920000
059300             MOVE ASC-KEY-STR-NBR     TO DK-STR-NBR               05930000
059400             PERFORM 2050-DELETE-LIST-QUEUE                       05940000
059500             PERFORM 3200-RESET-ATTRIBUTES                        05950000
059600             PERFORM 4000-BUILD-INITIAL-PANEL                     05960000
059700                                                                  05970000
059800         WHEN OTHER                                               05980000
059900             SET DP013-LOGIC-ABEND TO TRUE                        05990000
060000             SET DP013-NO-ROLLBACK TO TRUE                        06000000
060100             MOVE '1000-CONTROL-PROCESSING'                       06010000
060200                                   TO DP013-PARAGRAPH             06020000
060300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06030000
060400                                   TO DP013-MESSAGE-TEXT(1)       06040000
060500             PERFORM DP013-0000-PROCESS-ABEND                     06050000
060600     END-EVALUATE.                                                06060000
060700                                                                  06070000
060800*----------------------------------------------------------------*06080000
060900* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *06090000
061000*----------------------------------------------------------------*06100000
061100 1100-PROCESS-INTER-APPL-COMM.                                    06110000
061200                                                                  06120000
061300     SET PS-COMMAREA-VALID          TO TRUE.                      06130000
061400     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    06140000
061500     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-DISPLAY-FORMAT.        06150000
061600                                                                  06160000
061700     IF DP020-INT-APPL-FORMAT-IND = '1'                           06170000
061800         MOVE RC015-PO-NBR             TO ASC-KEY-PO-NBR          06180000
061900                                          ASC-ORD-NBR             06190000
062000                                          DK-ORD-NBR              06200000
062100         MOVE RC015-REC-SEQ-NBR        TO ASC-KEY-RCVR-NBR        06210000
062200                                          ASC-RCVR-NBR            06220000
062300                                          DK-RCVR-NBR             06230000
062400         MOVE RC015-OPER-UNT-ID        TO ASC-KEY-OPER-UNT-ID     06240000
062500                                          ASC-OPER-UNT-ID         06250000
062600         MOVE RC015-FCLTY-ID           TO ASC-KEY-FCLTY-ID        06260000
062700                                          ASC-FCLTY-ID            06270000
062800         MOVE RC015-STR-NBR            TO ASC-KEY-STR-NBR         06280000
062900                                          ASC-STORE-NBR           06290000
063000         MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   06300000
063100     ELSE                                                         06310000
063200         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    06320000
063300         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      06330000
063400           TO ASC-NUMBER-OF-SELECTED-ITEMS                        06340000
063500         MOVE RC015-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  06350000
063600         MOVE RC015-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   06360000
063700         MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB             06370000
063800         MOVE ZERO                     TO ASC-SEL-ITEM            06380000
063900         PERFORM 2300-GET-NEXT-RECORD                             06390000
064000         MOVE RC015-OPER-UNT-ID        TO ASC-KEY-OPER-UNT-ID     06400000
064100                                          ASC-OPER-UNT-ID         06410000
064200         MOVE RC015-FCLTY-ID           TO ASC-KEY-FCLTY-ID        06420000
064300                                          ASC-FCLTY-ID            06430000
064400         MOVE RC015-PO-NBR             TO ASC-KEY-PO-NBR          06440000
064500                                          ASC-ORD-NBR             06450000
064600                                          DK-ORD-NBR              06460000
064700         MOVE RC015-REC-SEQ-NBR        TO ASC-KEY-RCVR-NBR        06470000
064800                                          ASC-RCVR-NBR            06480000
064900                                          DK-RCVR-NBR             06490000
065000     END-IF.                                                      06500000
065100                                                                  06510000
065200     PERFORM 7200-GET-RECEIV-STATUS.                              06520000
065300     IF SQLCODE NOT = +0                                          06530000
065400         MOVE PC-TSYMSG-01298 TO DP020-MSG-NUMBER                 06540000
065500         SET PS-ERROR                                             06550000
065600             PS-COMMAREA-NOT-VALID                                06560000
065700             DP020-NEXT-ACT-APPL-ERROR                            06570000
065800             DP020-MSG-FATAL  TO TRUE                             06580000
065900     END-IF.                                                      06590000
066000                                                                  06600000
066100*----------------------------------------------------------------*06610000
066200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06620000
066300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06630000
066400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06640000
066500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06650000
066600* FUNCTION KEYS CAN GET THIS FAR.                                *06660000
066700*----------------------------------------------------------------*06670000
066800 2000-PROCESS-PANEL.                                              06680000
066900                                                                  06690000
067000     SET PS-NEXT-SCREEN TO TRUE.                                  06700000
067100                                                                  06710000
067200     EVALUATE TRUE                                                06720000
067300         WHEN DP020-SRC-AID = DP016-CLEAR                         06730000
067400             MOVE ZEROES TO ASC-ITEM-AT-TOP-OF-PANEL              06740000
067500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06750000
067600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06760000
067700                                                                  06770000
067800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06780000
067900             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           06790000
068000             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              06800000
068100             MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR               06810000
068200             MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR              06820000
068300             MOVE ASC-KEY-STR-NBR     TO DK-STR-NBR               06830000
068400             PERFORM 2050-DELETE-LIST-QUEUE                       06840000
068500             PERFORM 3200-RESET-ATTRIBUTES                        06850000
068600             PERFORM 4000-BUILD-INITIAL-PANEL                     06860000
068700                                                                  06870000
068800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06880000
068900             IF ASC-USE-SELECTION-QUEUE                           06890000
069000                 PERFORM 2300-GET-NEXT-RECORD                     06900000
069100                 IF PS-LIST-END                                   06910000
069200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06920000
069300                     SET PS-NO-LIST-END TO TRUE                   06930000
069400                 ELSE                                             06940000
069500                     PERFORM 2050-DELETE-LIST-QUEUE               06950000
069600                     PERFORM 3200-RESET-ATTRIBUTES                06960000
069700                     PERFORM 4000-BUILD-INITIAL-PANEL             06970000
069800                 END-IF                                           06980000
069900              ELSE                                                06990000
070000*                --- BOTTOM OF LIST ---                           07000000
070100                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         07010000
070200                 SET DP020-MSG-INFORMATIONAL TO TRUE              07020000
070300             END-IF                                               07030000
070400                                                                  07040000
070500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07050000
070600             IF ASC-USE-SELECTION-QUEUE                           07060000
070700                 PERFORM 2310-GET-PREV-RECORD                     07070000
070800                 IF PS-LIST-END                                   07080000
070900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07090000
071000                     SET PS-NO-LIST-END TO TRUE                   07100000
071100                 ELSE                                             07110000
071200                     PERFORM 2050-DELETE-LIST-QUEUE               07120000
071300                     PERFORM 3200-RESET-ATTRIBUTES                07130000
071400                     PERFORM 4000-BUILD-INITIAL-PANEL             07140000
071500                 END-IF                                           07150000
071600             ELSE                                                 07160000
071700                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         07170000
071800                 SET DP020-MSG-INFORMATIONAL TO TRUE              07180000
071900             END-IF                                               07190000
072000                                                                  07200000
072100         WHEN OTHER                                               07210000
072200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07220000
072300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07230000
072400             IF  PS-NO-ERROR                                      07240000
072500                 SET DP030-CONTINUE-GO TO TRUE                    07250000
072600                 PERFORM 2100-CHECK-FUNCTION-KEY                  07260000
072700             ELSE                                                 07270000
072800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07280000
072900                 SET DP030-OVERRIDE-GO TO TRUE                    07290000
073000             END-IF                                               07300000
073100     END-EVALUATE.                                                07310000
073200                                                                  07320000
073300*----------------------------------------------------------------*07330000
073400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07340000
073500*----------------------------------------------------------------*07350000
073600 2050-DELETE-LIST-QUEUE.                                          07360000
073700                                                                  07370000
073800     EXEC CICS                                                    07380000
073900         DELETEQ TS                                               07390000
074000           QUEUE (ASC-LIST-QUEUE-NAME)                            07400000
074100            RESP (PV-CICS-RESP)                                   07410000
074200     END-EXEC.                                                    07420000
074300                                                                  07430000
074400*DMH     MOVE ASC-LIST-TERM-ID     TO PV-SEL-TERM-ID              07440000
074500*DMH     MOVE ASC-LIST-TASK-NUMBER TO PV-SEL-TASK-NUMBER          07450000
074600*DMH     MOVE ASC-LIST-SEQ         TO PV-SEL-SEQ                  07460000
074700*DMH     STRING ' RCKCS813-DEL LST1'  DELIMITED BY SIZE           07470000
074800*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           07480000
074900*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           07490000
075000*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           07500000
075100*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           07510000
075200*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           07520000
075300*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           07530000
075400*DMH                             INTO  PV-CICS-MSG-AREA2          07540000
075500*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     07550000
075600*DMH           TO PV-COMMAREA-LENGTH                              07560000
075700*DMH         EXEC CICS                                            07570000
075800*DMH              WRITEQ TD                                       07580000
075900*DMH               QUEUE  ('CSSL')                                07590000
076000*DMH                FROM  (PV-CICS-MSG-AREA2)                     07600000
076100*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    07610000
076200*DMH                RESP  (PV-CICS-RESP-2)                        07620000
076300*DMH         END-EXEC                                             07630000
076400                                                                  07640000
076500     IF (PV-CICS-RESP = DFHRESP(NORMAL))                          07650000
076600       OR (PV-CICS-RESP = DFHRESP(QIDERR))                        07660000
076700         CONTINUE                                                 07670000
076800     ELSE                                                         07680000
076900         SET DP013-CICS-ABEND          TO TRUE                    07690000
077000         SET DP013-NO-ROLLBACK         TO TRUE                    07700000
077100         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         07710000
077200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07720000
077300                                       TO DP013-MESSAGE-TEXT (1)  07730000
077400         PERFORM DP013-0000-PROCESS-ABEND                         07740000
077500     END-IF.                                                      07750000
077600                                                                  07760000
077700     MOVE ZERO TO ASC-HIGHEST-BLOCK-WRITTEN.                      07770000
077800                                                                  07780000
077900*----------------------------------------------------------------*07790000
078000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*07800000
078100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *07810000
078200* CICS ARCHITECTURE API.                                         *07820000
078300*----------------------------------------------------------------*07830000
078400 2100-CHECK-FUNCTION-KEY.                                         07840000
078500                                                                  07850000
078600     SET PS-NEXT-SCREEN TO TRUE.                                  07860000
078700                                                                  07870000
078800     EVALUATE TRUE                                                07880000
078900                                                                  07890000
079000*UPDATE FULLCASE/ODD-UNIT QTY.                                    07900000
079100     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  07910000
079102          IF  ASC-AUTO-VE-YES                                     07910250
079110              SET RC039-FUNC-CNFM           TO TRUE               07911047
079120              PERFORM 2108-LINK-FKEY-MODULE                       07912047
079130          END-IF                                                  07913047
079140                                                                  07914047
079150          IF (ASC-AUTO-VE-YES  AND                                07915050
079160              RC039-SUCCESSFUL AND                                07916047
079170              PS-FUNCTION-RACF-YES)  OR                           07917047
079180              ASC-AUTO-VE-NO                                      07918050
079190                                                                  07919047
079200              IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO             07920047
079300                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       07930047
079400                  SET DP020-MSG-FATAL   TO TRUE                   07940047
079500                  MOVE -1               TO MR-SELECTL (1)         07950047
079600                  SET DP030-SET-CURSOR-APPL-1                     07960047
079700                      PS-ERROR                                    07970047
079800                      ASC-NO-TSQ-UPDATE TO TRUE                   07980047
079900              ELSE                                                07990047
080000                  PERFORM 8000-UPDATE-STORE                       08000047
080100                    VARYING PV-ITEM FROM 1 BY 1                   08010047
080200                      UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN   08020047
080300                  MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER        08030047
080400                  SET DP020-MSG-INFORMATIONAL TO TRUE             08040047
080500              END-IF                                              08050047
080501                                                                  08050147
080510          END-IF                                                  08051047
080600                                                                  08060000
080700     WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                      08070000
080800             MOVE +1 TO PV-TOP-ITEM                               08080000
080900             PERFORM 3200-RESET-ATTRIBUTES                        08090000
081000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08100000
081100                                                                  08110000
081200     WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                       08120000
081300             PERFORM 2110-BROWSE-BACKWARD                         08130000
081400             PERFORM 3200-RESET-ATTRIBUTES                        08140000
081500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08150000
081600                                                                  08160000
081700     WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                       08170000
081800             PERFORM 2120-BROWSE-FORWARD                          08180000
081900             PERFORM 3200-RESET-ATTRIBUTES                        08190000
082000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08200000
082100                                                                  08210000
082200     WHEN DP020-SRC-AID = DP016-ENTER                             08220000
082300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   08230000
082400             IF PS-NO-ERROR                                       08240000
082500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08250000
082600             END-IF                                               08260000
082700                                                                  08270000
082800     WHEN OTHER                                                   08280000
082900         PERFORM 2050-DELETE-LIST-QUEUE                           08290000
083000         PERFORM 4000-BUILD-INITIAL-PANEL                         08300000
083100         PERFORM 3200-RESET-ATTRIBUTES                            08310000
083200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     08320000
083300     END-EVALUATE.                                                08330000
083400                                                                  08340000
083410*----------------------------------------------------------------*08341046
083420*    LINK TO F-KEY ELIGIBILITY MODULE (RCKUT126)                 *08342046
083430*----------------------------------------------------------------*08343046
083440 2108-LINK-FKEY-MODULE.                                           08344046
083450                                                                  08345046
083460     MOVE DP020-LOCATION    TO RC039-SIGNON-LOCATION.             08346046
083470     MOVE ASC-OPER-UNT-ID   TO RC039-OPER-UNT-ID                  08347046
083480                               PV-OPER-UNT-ID.                    08348046
083490     MOVE ASC-FCLTY-ID      TO RC039-FCLTY-ID                     08349046
083491                               PV-FCLTY-ID.                       08349146
083492     MOVE ASC-ORD-NBR       TO RC039-PO-NBR                       08349246
083493                               PV-PO-NBR.                         08349346
083494     MOVE ASC-RCVR-NBR      TO RC039-REC-SEQ-NBR                  08349446
083495                               PV-RCVR-NBR.                       08349546
083496     MOVE DK-LINE-NBR       TO RC039-PO-LNE-NBR                   08349646
083497                               PV-LINE-NBR.                       08349746
083498     MOVE MR-PACK (PV-SUB)  TO RC039-PREPACK-ID                   08349846
083499                               PV-PACK-ID.                        08349946
083500     MOVE DP020-USERID      TO RC039-USER-ID.                     08350046
083501     MOVE 'RCKCS813'        TO RC039-PROGRAM-NAME.                08350146
083502                                                                  08350246
083503     EXEC CICS                                                    08350346
083504          LINK PROGRAM (PC-FKEY-MODULE)                           08350446
083505          COMMAREA (RC039-FIELDS)                                 08350546
083506          LENGTH (PC-FKEY-MODULE-LENGTH)                          08350646
083507          RESP (PV-CICS-RESP)                                     08350746
083508     END-EXEC.                                                    08350846
083509                                                                  08350946
083510     EVALUATE TRUE                                                08351046
083511         WHEN RC039-SUCCESSFUL                                    08351146
083512             IF RC039-FUNCTION-YES                                08351246
083513                 SET  PS-FUNCTION-RACF-YES  TO  TRUE              08351349
083514             ELSE                                                 08351449
083515                 SET  PS-FUNCTION-RACF-NO   TO  TRUE              08351549
083517                 PERFORM 2109-PROCESS-NO-FUNCTION                 08351746
083518             END-IF                                               08351846
083519                                                                  08351946
083520         WHEN RC039-DATABASE-BUSY                                 08352046
083521             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         08352146
083522             SET DP020-MSG-WARNING    TO TRUE                     08352246
083523                                                                  08352346
083524         WHEN RC039-INVALID-SQL                                   08352446
083525             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         08352546
083526             SET DP020-MSG-WARNING    TO TRUE                     08352646
083527                                                                  08352746
083528         WHEN OTHER                                               08352846
083529             MOVE '2108-LINK-FKEY-MODULE' TO DP013-PARAGRAPH      08352946
083530             MOVE 'UNSUCCESSFUL CALL TO FKEY ELIGIBILITY MODULE'  08353046
083531                                 TO DP013-MESSAGE-TEXT (1)        08353146
083532             MOVE RC039-SUCCESS-IND TO DP013-MESSAGE-TEXT (2)     08353246
083533             MOVE RC039-CRA-RET-MSG TO DP013-MESSAGE-TEXT (3)     08353346
083534                 STRING ' LOCATION ='                             08353446
083535                        DP020-LOCATION                            08353546
083536                        ' USER = '                                08353646
083537                        DP020-USERID                              08353746
083538                        ' PO = '                                  08353846
083539                        PV-PO-NBR                                 08353946
083540                        ' RECV ='                                 08354046
083541                        PV-RCVR-NBR                               08354146
083542                        ' OPER = '                                08354246
083543                        PV-OPER-UNT-ID                            08354346
083544                        ' FCLTY = '                               08354446
083545                        PV-FCLTY-ID                               08354546
083546                        ' PO LINE = '                             08354646
083547                        PV-LINE-NBR                               08354746
083548                        ' PREPACK ID = '                          08354846
083549                        PV-PACK-ID        DELIMITED BY SIZE       08354946
083550                                 INTO DP013-MESSAGE-TEXT (4)      08355046
083551             MOVE RC039-SQLCA    TO DP013-SQLCA                   08355146
083552             SET DP013-DB2-ABEND                                  08355246
083553                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              08355346
083554             PERFORM DP013-0000-PROCESS-ABEND                     08355446
083555     END-EVALUATE.                                                08355546
083556                                                                  08355646
083557*----------------------------------------------------------------*08355746
083558*    PROCESS NO FUNCTION REASON RETURNED FROM COMMAREA RCWS039   *08355846
083559*    AND SEND ERROR MESSAGE TO SCREEN.                           *08355946
083560*----------------------------------------------------------------*08356046
083561 2109-PROCESS-NO-FUNCTION.                                        08356146
083562                                                                  08356246
083563     EVALUATE TRUE                                                08356346
083564         WHEN RC039-FUNC-CNFM                                     08356446
083565             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         08356546
083566             SET DP020-MSG-WARNING    TO TRUE                     08356646
083567         WHEN RC039-FUNC-UNCNFM                                   08356746
083568             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         08356846
083569             SET DP020-MSG-WARNING    TO TRUE                     08356946
083570         WHEN RC039-FUNC-VRFY                                     08357046
083571             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         08357146
083572             SET DP020-MSG-WARNING    TO TRUE                     08357246
083573         WHEN RC039-FUNC-UNVRFY                                   08357346
083574             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         08357446
083575             SET DP020-MSG-WARNING    TO TRUE                     08357546
083576         WHEN RC039-FUNC-SMOOTH                                   08357646
083577*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         08357746
083578             SET DP020-MSG-WARNING    TO TRUE                     08357846
083579         WHEN RC039-FUNC-PHY-LBL                                  08357946
083580*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         08358046
083581             SET DP020-MSG-WARNING    TO TRUE                     08358146
083582         WHEN RC039-PO-AUTOVE-CHECK                               08358246
083583*            MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         08358346
083584             SET DP020-MSG-WARNING    TO TRUE                     08358446
083585     END-EVALUATE.                                                08358546
083586                                                                  08358646
083590*----------------------------------------------------------------*08359000
083600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *08360000
083700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *08370000
083800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *08380000
083900*    MESSAGE.                                                    *08390000
084000*----------------------------------------------------------------*08400000
084100 2110-BROWSE-BACKWARD.                                            08410000
084200                                                                  08420000
084300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    08430000
084400         GIVING PV-TOP-ITEM.                                      08440000
084500                                                                  08450000
084600     IF  ((PV-TOP-ITEM < +1)                                      08460000
084700       OR (PV-TOP-ITEM = +1))                                     08470000
084800         MOVE +1                   TO PV-TOP-ITEM                 08480000
084900*        -- TOP OF LIST --                                        08490000
085000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            08500000
085100         SET DP020-MSG-INFORMATIONAL                              08510000
085200                                   TO TRUE                        08520000
085300     END-IF.                                                      08530000
085400                                                                  08540000
085500*----------------------------------------------------------------*08550000
085600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *08560000
085700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *08570000
085800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *08580000
085900*----------------------------------------------------------------*08590000
086000 2120-BROWSE-FORWARD.                                             08600000
086100                                                                  08610000
086200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              08620000
086300         GIVING PV-TOP-ITEM.                                      08630000
086400                                                                  08640000
086500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   08650000
086600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08660000
086700                                   TO PV-TOP-ITEM                 08670000
086800*        -- BOTTOM OF LIST --                                     08680000
086900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08690000
087000         SET DP020-MSG-INFORMATIONAL                              08700000
087100                                   TO TRUE                        08710000
087200     ELSE                                                         08720000
087300         COMPUTE PV-BOTTOM-ITEM =                                 08730000
087400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08740000
087500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            08750000
087600*            -- BOTTOM OF LIST --                                 08760000
087700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08770000
087800             SET DP020-MSG-INFORMATIONAL                          08780000
087900                                   TO TRUE                        08790000
088000         END-IF                                                   08800000
088100     END-IF.                                                      08810000
088200                                                                  08820000
088300*----------------------------------------------------------------*08830000
088400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08840000
088500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08850000
088600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08860000
088700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *08870000
088800*----------------------------------------------------------------*08880000
088900 2130-CHECK-FOR-JUMP-BROWSE.                                      08890000
089000                                                                  08900000
089100     SET PS-NO-ERROR               TO TRUE.                       08910000
089200     IF (ASC-START-ITEM-REQUEST = SPACE)                          08920000
089300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08930000
089400                                   TO PV-TOP-ITEM                 08940000
089500     ELSE                                                         08950000
089600         MOVE ASC-START-ITEM-REQUEST                              08960000
089700                                   TO DP010I-UNEDITED-FIELD       08970000
089800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       08980000
089900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08990000
090000         SET DP010I-NEGATIVE-NOT-ALLOWED                          09000000
090100                                   TO TRUE                        09010000
090200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09020059
090210              USING DP010I-NUMERIC-EDIT-AREA                      09021059
090300                                                                  09030000
090400         IF  NOT DP010I-ERROR-DETECTED                            09040000
090500             MOVE DP010I-NUMERIC-FIELD                            09050000
090600                                   TO ASC-START-ITEM-REQUEST-N    09060000
090700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  09070000
090800                 IF  ASC-START-ITEM-REQUEST-N >                   09080000
090900                                          ASC-NUMBER-OF-ITEMS-READ09090000
091000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         09100000
091100                     COMPUTE PV-TOP-ITEM =                        09110000
091200                             ASC-NUMBER-OF-ITEMS-READ             09120000
091300                             - PC-ITEMS-PER-PANEL + 1             09130000
091400                     IF  PV-TOP-ITEM < +1                         09140000
091500                         MOVE +1   TO PV-TOP-ITEM                 09150000
091600                         MOVE PC-TSYMSG-00070                     09160000
091700                                   TO DP020-MSG-NUMBER            09170000
091800                         SET DP020-MSG-INFORMATIONAL              09180000
091900                                   TO TRUE                        09190000
092000                     END-IF                                       09200000
092100                 ELSE                                             09210000
092200                     MOVE ASC-START-ITEM-REQUEST-N                09220000
092300                                   TO PV-TOP-ITEM                 09230000
092400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      09240000
092500                     COMPUTE PV-BOTTOM-ITEM =                     09250000
092600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     09260000
092700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ09270000
092800*                        -- BOTTOM OF LIST --                     09280000
092900                         MOVE PC-TSYMSG-00070                     09290000
093000                                   TO DP020-MSG-NUMBER            09300000
093100                         SET DP020-MSG-INFORMATIONAL              09310000
093200                                   TO TRUE                        09320000
093300                     END-IF                                       09330000
093400                 END-IF                                           09340000
093500             ELSE                                                 09350000
093600*                --- VALUE OUT OF RANGE ----                      09360000
093700                 MOVE PC-TSYMSG-00101                             09370000
093800                                   TO DP020-MSG-NUMBER            09380000
093900                 MOVE -1           TO ASTRTITL                    09390000
094000                 SET DP030-SET-CURSOR-APPL-1                      09400000
094100                                   TO TRUE                        09410000
094200                 MOVE DP015-REVERSE                               09420000
094300                                   TO ASTRTITH                    09430000
094400                 MOVE DP015-RED    TO ASTRTITC                    09440000
094500                 MOVE DP015-UNP-NUM-BRT-MDT                       09450000
094600                                   TO ASTRTITA                    09460000
094700                 SET DP020-MSG-FATAL                              09470000
094800                                   TO TRUE                        09480000
094900                 SET PS-ERROR      TO TRUE                        09490000
095000             END-IF                                               09500000
095100                                                                  09510000
095200         ELSE                                                     09520000
095300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09530000
095400             MOVE -1               TO ASTRTITL                    09540000
095500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09550000
095600             MOVE DP015-REVERSE    TO ASTRTITH                    09560000
095700             MOVE DP015-RED        TO ASTRTITC                    09570000
095800             MOVE DP015-UNP-NUM-BRT-MDT                           09580000
095900                                   TO ASTRTITA                    09590000
096000             SET DP020-MSG-FATAL   TO TRUE                        09600000
096100             SET PS-ERROR          TO TRUE                        09610000
096200         END-IF                                                   09620000
096300     END-IF.                                                      09630000
096400                                                                  09640000
096500*----------------------------------------------------------------*09650000
096600*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *09660000
096700*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *09670000
096800*----------------------------------------------------------------*09680000
096900 2200-MOVE-SCREEN-TO-COMMAREA.                                    09690000
097000                                                                  09700000
097100     MOVE PV-TOP-ITEM  TO PV-ITEM-IN-USE.                         09710000
097200     MOVE +1           TO PV-SUB.                                 09720000
097300                                                                  09730000
097400     PERFORM 3100-SET-SUBSCRIPTS.                                 09740000
097500                                                                  09750000
097600     IF ASTRTITL > ZERO                                           09760000
097700         MOVE ASTRTITI TO ASC-START-ITEM-REQUEST                  09770000
097800     ELSE                                                         09780000
097900         IF ASTRTITF = DP015-ERASE-EOF                            09790000
098000             INITIALIZE ASC-START-ITEM-REQUEST                    09800000
098100         END-IF                                                   09810000
098200     END-IF.                                                      09820000
098300                                                                  09830000
098400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          09840000
098500       VARYING PV-SUB FROM 1 BY 1                                 09850000
098600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      09860000
098700                                                                  09870000
098800*----------------------------------------------------------------*09880000
098900*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *09890000
099000*----------------------------------------------------------------*09900000
099100 2210-MOVE-LINES-TO-COMMAREA.                                     09910000
099200                                                                  09920000
099300     IF MR-SELECTL (PV-SUB) > ZERO                                09930000
099400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             09940000
099500         MOVE MR-SELECT (PV-SUB) TO ASC-TEMP-SELECTED-SW          09950000
099600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      09960000
099700     ELSE                                                         09970000
099800         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 09980000
099900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         09990000
100000             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          10000000
100100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      10010000
100200         END-IF                                                   10020000
100300     END-IF.                                                      10030000
100400                                                                  10040000
100500     IF MR-U-PROCESS-QTYL (PV-SUB) > ZERO                         10050000
100600         MOVE MR-U-PROCESS-QTY-X (PV-SUB)                         10060000
100700                                 TO ASC-U-PROCESS-QTY-X           10070000
100800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     10080000
100900     ELSE                                                         10090000
101000         IF MR-U-PROCESS-QTYA (PV-SUB) = DP015-ERASE-EOF          10100000
101100             MOVE SPACES         TO ASC-U-PROCESS-QTY-X           10110000
101200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     10120000
101300         END-IF                                                   10130000
101400     END-IF.                                                      10140000
101500                                                                  10150000
101600     ADD +1 TO ASC-ITEM-SUB.                                      10160000
101700                                                                  10170000
101800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         10180000
101900         ADD +1  TO ASC-BLK-SUB                                   10190000
102000         MOVE +1 TO ASC-ITEM-SUB                                  10200000
102100     END-IF.                                                      10210000
102200                                                                  10220000
102300*----------------------------------------------------------------*10230000
102400 2300-GET-NEXT-RECORD.                                            10240000
102500                                                                  10250000
102600     ADD +1      TO ASC-SEL-SUB.                                  10260000
102700     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             10270000
102800         ADD +1  TO ASC-SEL-ITEM                                  10280000
102900         MOVE +1 TO ASC-SEL-SUB                                   10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200     MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN.          10320000
103300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 10330000
103400         PERFORM 9100-READ-SEL-QUEUE                              10340000
103500         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       10350000
103600             INITIALIZE ASC-LIST-KEYS                             10360000
103700             MOVE RC013-STR-NBR (ASC-SEL-SUB) TO ASC-KEY-STR-NBR  10370000
103800                                                 ASC-STORE-NBR    10380000
103900             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  10390000
104000             PERFORM 5120-REWRITE-LIST-QUEUE                      10400000
104100         ELSE                                                     10410000
104200             SUBTRACT +1 FROM ASC-SEL-SUB                         10420000
104300*            --- BOTTOM OF LIST ---                               10430000
104400             MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER      10440000
104500             SET DP020-MSG-INFORMATIONAL TO TRUE                  10450000
104600         END-IF                                                   10460000
104700     ELSE                                                         10470000
104800         SUBTRACT +1 FROM ASC-SEL-ITEM                            10480000
104900         MOVE RC013-MAX-ITEMS            TO ASC-SEL-SUB           10490000
105000         MOVE PC-TSYMSG-00070            TO DP020-MSG-NUMBER      10500000
105100         SET DP020-MSG-INFORMATIONAL     TO TRUE                  10510000
105200     END-IF.                                                      10520000
105300                                                                  10530000
105400*----------------------------------------------------------------*10540000
105500 2310-GET-PREV-RECORD.                                            10550000
105600     SUBTRACT +1                   FROM ASC-SEL-SUB.              10560000
105700     IF ASC-SEL-SUB < +1                                          10570000
105800         SUBTRACT +1               FROM ASC-SEL-ITEM              10580000
105900         MOVE RC013-MAX-ITEMS        TO ASC-SEL-SUB               10590000
106000     END-IF.                                                      10600000
106100                                                                  10610000
106200     MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME-IN.          10620000
106300     IF ASC-SEL-ITEM > ZERO                                       10630000
106400         PERFORM 9100-READ-SEL-QUEUE                              10640000
106500         MOVE RC013-STR-NBR (ASC-SEL-SUB) TO ASC-KEY-STR-NBR      10650000
106600                                             ASC-STORE-NBR        10660000
106700         SET RC013-INQ (ASC-SEL-SUB) TO TRUE                      10670000
106800         PERFORM 5120-REWRITE-LIST-QUEUE                          10680000
106900     ELSE                                                         10690000
107000         MOVE +1 TO  ASC-SEL-SUB                                  10700000
107100                     ASC-SEL-ITEM                                 10710000
107200*        --- TOP OF LIST ---                                      10720000
107300         MOVE PC-TSYMSG-00069        TO DP020-MSG-NUMBER          10730000
107400         SET DP020-MSG-INFORMATIONAL TO TRUE                      10740000
107500     END-IF.                                                      10750000
107600                                                                  10760000
107700*----------------------------------------------------------------*10770000
107800*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *10780000
107900*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *10790000
108000*----------------------------------------------------------------*10800000
108100 3000-EDIT-DATA-IN-COMMAREA.                                      10810000
108200                                                                  10820000
108300     SET PS-NO-ERROR               TO TRUE.                       10830000
108400                                                                  10840000
108500     PERFORM 3200-RESET-ATTRIBUTES.                               10850000
108600                                                                  10860000
108700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     10870000
108800**                                                                10880000
108900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              10890000
109000* EDITING IS DONE FROM THE BOTTOM UP.                             10900000
109100**                                                                10910000
109200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       10920000
109300         ASC-ITEMS-DISPLAYED - 1.                                 10930000
109400                                                                  10940000
109500     PERFORM 3100-SET-SUBSCRIPTS.                                 10950000
109600                                                                  10960000
109700     PERFORM 3300-EDIT-SELECTIONS                                 10970000
109800       VARYING PV-SUB FROM PV-SUB BY -1                           10980000
109900         UNTIL PV-SUB < +1.                                       10990000
110000                                                                  11000000
110100*----------------------------------------------------------------*11010000
110200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *11020000
110300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*11030000
110400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *11040000
110500*                                                                *11050000
110600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *11060000
110700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *11070000
110800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *11080000
110900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *11090000
111000*----------------------------------------------------------------*11100000
111100 3100-SET-SUBSCRIPTS.                                             11110000
111200                                                                  11120000
111300     COMPUTE ASC-ITEM-SUB =                                       11130000
111400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        11140000
111500                                                                  11150000
111600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         11160000
111700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            11170000
111800                                                                  11180000
111900         MOVE PC-MAX-BLOCKS-IN-ARRAY                              11190000
112000                                   TO ASC-BLK-SUB                 11200000
112100     ELSE                                                         11210000
112200         MOVE +1                   TO ASC-BLK-SUB                 11220000
112300     END-IF.                                                      11230000
112400                                                                  11240000
112500*----------------------------------------------------------------*11250000
112600*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *11260000
112700*----------------------------------------------------------------*11270000
112800 3200-RESET-ATTRIBUTES.                                           11280000
112900                                                                  11290000
113000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    11300000
113100     MOVE DP015-GREEN              TO ASTRTITC                    11310000
113200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   11320000
113300                                                                  11330000
113400     PERFORM                                                      11340000
113500       VARYING PV-SUB FROM 1 BY 1                                 11350000
113600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        11360000
113700                                                                  11370000
113800***      IF PV-SUB > ASC-NUMBER-OF-ITEMS-READ                     11380000
113900***          MOVE DP015-ASK-DRK-OFF     TO MR-SELECTA (PV-SUB)    11390000
114000***          MOVE DP015-HL-OFF          TO MR-SELECTH (PV-SUB)    11400000
114100***          MOVE SPACE                 TO MR-SELECT (PV-SUB)     11410000
114200***                                        MR-ACTION (PV-SUB)     11420000
114300***      ELSE                                                     11430000
114400             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    11440000
114500                                       MR-U-PROCESS-QTYA (PV-SUB) 11450000
114600             MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)    11460000
114700                                       MR-U-PROCESS-QTYC (PV-SUB) 11470000
114800             MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)    11480000
114900                                       MR-U-PROCESS-QTYH (PV-SUB) 11490000
115000***      END-IF                                                   11500000
115100                                                                  11510000
115200     END-PERFORM.                                                 11520000
115300                                                                  11530000
115400*----------------------------------------------------------------*11540000
115500*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *11550000
115600*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *11560000
115700*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *11570000
115800*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *11580000
115900*----------------------------------------------------------------*11590000
116000 3300-EDIT-SELECTIONS.                                            11600000
116100                                                                  11610000
116200     EVALUATE TRUE                                                11620000
116300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     11630000
116400            = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          11640000
116500             CONTINUE                                             11650000
116600                                                                  11660000
116700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         11670000
116800             IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)         11680000
116900                 ADD +1 TO ASC-NUMBER-OF-SELECTED-ITEMS           11690000
117000                 MOVE ASC-TEMP-SELECTED-SW                        11700000
117100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  11710000
117200                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  11720000
117300             END-IF                                               11730000
117400                                                                  11740000
117500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     11750000
117600                                   = SPACE                        11760000
117700             EVALUATE TRUE                                        11770000
117800                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       11780000
117900                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS11790000
118000                     MOVE SPACE    TO ASC-SELECTED-SW             11800000
118100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   11810000
118200             END-EVALUATE                                         11820000
118300                                                                  11830000
118400         WHEN OTHER                                               11840000
118500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11850000
118600             SET DP020-MSG-FATAL   TO TRUE                        11860000
118700             MOVE -1               TO MR-SELECTL (PV-SUB)         11870000
118800             SET DP030-SET-CURSOR-APPL-1                          11880000
118900                                   TO TRUE                        11890000
119000             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         11900000
119100             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         11910000
119200             SET PS-ERROR          TO TRUE                        11920000
119300             IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             11930000
119400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     11940000
119500                 MOVE SPACE        TO ASC-SELECTED-SW             11950000
119600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  11960000
119700             END-IF                                               11970000
119800     END-EVALUATE.                                                11980000
119900                                                                  11990000
120000***  IF ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                12000000
120100     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     12010000
120200         IF ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)        12020000
120300                                = SPACES                          12030000
120400           AND DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)             12040000
120500             SET PS-ERROR                                         12050000
120600                 DP020-MSG-FATAL                                  12060000
120700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  12070000
120800                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         12080000
120900                 MOVE DP015-UNP-NUM-BRT-OFF                       12090000
121000                                    TO MR-U-PROCESS-QTYA (PV-SUB) 12100000
121100                 MOVE -1            TO MR-U-PROCESS-QTYL (PV-SUB) 12110000
121200                 MOVE DP015-RED     TO MR-U-PROCESS-QTYC (PV-SUB) 12120000
121300                 MOVE DP015-REVERSE TO MR-U-PROCESS-QTYH (PV-SUB) 12130000
121400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     12140000
121500         ELSE                                                     12150000
121600         IF ASC-U-PROCESS-QTY-X       (ASC-BLK-SUB ASC-ITEM-SUB)  12160000
121700                > SPACES                                          12170000
121800             MOVE ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)  12180000
121900               TO DP010I-UNEDITED-FIELD                           12190000
122000             MOVE LENGTH OF ASC-U-PROCESS-QTY-X                   12200000
122100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12210000
122200               TO DP010I-MAXIMUM-DIGITS                           12220000
122300             MOVE ZEROES  TO DP010I-MAXIMUM-DECIMALS              12230000
122400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12240000
122500             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12250059
122510                  USING DP010I-NUMERIC-EDIT-AREA                  12251059
122600             IF DP010I-ERROR-DETECTED                             12260000
122700                 SET PS-ERROR                                     12270000
122800                     DP020-MSG-FATAL                              12280000
122900                     DP030-SET-CURSOR-APPL-1 TO TRUE              12290000
123000                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         12300000
123100                 MOVE DP015-UNP-NUM-BRT-OFF                       12310000
123200                                 TO MR-U-PROCESS-QTYA (PV-SUB)    12320000
123300                 MOVE -1         TO MR-U-PROCESS-QTYL (PV-SUB)    12330000
123400                 MOVE DP015-RED  TO MR-U-PROCESS-QTYC (PV-SUB)    12340000
123500                 MOVE DP015-REVERSE                               12350000
123600                                 TO MR-U-PROCESS-QTYH (PV-SUB)    12360000
123700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12370000
123800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     12380000
123900             ELSE                                                 12390000
124000                 MOVE DP010I-NUMERIC-FIELD                        12400000
124100                   TO ASC-U-PROCESS-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 12410000
124200                 MOVE ASC-U-PROCESS-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 12420000
124300                   TO MR-U-PROCESS-QTY (PV-SUB)                   12430000
124400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      12440000
124500             END-IF                                               12450000
124600         END-IF                                                   12460000
124700         END-IF                                                   12470000
124800     IF ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             12480000
124900         MOVE SPACE TO MR-U-PROCESS-QTY-X (PV-SUB)                12490000
125000     END-IF                                                       12500000
125100     END-IF.                                                      12510000
125200                                                                  12520000
125300     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             12530000
125400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               12540000
125500                                                                  12550000
125600     IF  ASC-ITEM-SUB < 1                                         12560000
125700         SUBTRACT +1 FROM ASC-BLK-SUB                             12570000
125800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                12580000
125900     END-IF.                                                      12590000
126000                                                                  12600000
126100*----------------------------------------------------------------*12610000
126200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *12620000
126300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *12630000
126400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *12640000
126500*    DISPLAY THE PANEL TO USER.                                  *12650000
126600*----------------------------------------------------------------*12660000
126700 4000-BUILD-INITIAL-PANEL.                                        12670000
126800                                                                  12680000
126900     INITIALIZE ASC-BLOCK-ENTRIES (1)                             12690000
127000                ASC-BLOCK-ENTRIES (2).                            12700000
127100                                                                  12710000
127200     MOVE +1                       TO ASC-BLK-SUB.                12720000
127300     MOVE SPACE                    TO ASC-PROTECT-SW.             12730000
127400                                                                  12740000
127500     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       12750000
127600                                                                  12760000
127700     MOVE ZERO                     TO ASC-ITEM-SUB                12770000
127800                                      ASC-NUMBER-OF-ITEMS-READ    12780000
127900                                      ASC-NUMBER-OF-SELECTED-ITEMS12790000
128000                                      ASC-HIGHEST-BLOCK-WRITTEN   12800000
128100                                      ASC-ITEM-AT-TOP-OF-PANEL.   12810000
128200                                                                  12820000
128300     PERFORM 4100-PREPARE-CURSOR.                                 12830000
128400                                                                  12840000
128500     PERFORM 7200-GET-RECEIV-STATUS.                              12850000
128600     IF RECEIV-STATUS-CDE = 'VE'                                  12860000
128700         SET ASC-PROTECT-ALL-STORES TO TRUE                       12870000
128800     END-IF.                                                      12880000
128900                                                                  12890000
129000*TO HANDLE ALREADY EXISTING ORDERS (PROCESSED BY LINE), CHECK     12900000
129100*DISTHD-PREPK-LNE-PRC-CDE FOR PACKS & PROCESS OLD WAY IF BLANK.   12910000
129200     IF ASC-PKGNG-CDE = 'I' OR 'M'                                12920000
129300         MOVE +0 TO PV-PREPK-BLANK-COUNT                          12930000
129400         PERFORM 4030-CHECK-DISTHD                                12940000
129500         IF PV-PREPK-BLANK-COUNT > +0                             12950000
129600             MOVE 'X' TO ASC-PKGNG-CDE                            12960000
129700         END-IF                                                   12970000
129800     END-IF.                                                      12980000
129900                                                                  12990000
130000*    MOVE ASC-STORE-NBR TO DK-STR-NBR-NAME.                       13000000
130100     PERFORM 7400-GET-STORE-NAME.                                 13010000
130200                                                                  13020000
130300     PERFORM 7000-GET-DEPT.                                       13030000
130400     MOVE PURCHS-DEPT-NBR TO ASC-DEPT.                            13040000
130500                                                                  13050000
130600     PERFORM 4110-OPEN-CURSOR.                                    13060000
130700     PERFORM 4300-READ-ITEMS-FROM-DB.                             13070000
130800     PERFORM 4120-CLOSE-CURSOR.                                   13080000
130900                                                                  13090000
131000     MOVE +1 TO PV-TOP-ITEM.                                      13100000
131100                                                                  13110000
131200     IF ASC-NUMBER-OF-ITEMS-READ = ZERO                           13120000
131300         IF DP020-NEXT-ACT-INITIAL                                13130000
131400             SET DP020-NEXT-ACT-APPL-ERROR                        13140000
131500                                   TO TRUE                        13150000
131600             SET DP020-MSG-FATAL   TO TRUE                        13160000
131700             MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER            13170000
131800         ELSE                                                     13180000
131900             SET DP020-MSG-FATAL   TO TRUE                        13190000
132000             MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER            13200000
132100             SET ASC-BLOCK-MODIFIED (1)                           13210000
132200                 ASC-BLOCK-MODIFIED (2) TO TRUE                   13220000
132300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13230000
132400         END-IF                                                   13240000
132500     ELSE                                                         13250000
132600         MOVE -1 TO MR-SELECTL (1)                                13260000
132700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13270000
132800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     13280000
132900     END-IF.                                                      13290000
133000                                                                  13300000
133100*----------------------------------------------------------------*13310000
133200 4030-CHECK-DISTHD.                                               13320000
133300                                                                  13330000
133400     EXEC SQL                                                     13340000
133500         SELECT COUNT (*)                                         13350000
133600           INTO :PV-PREPK-BLANK-COUNT                             13360000
133700           FROM TDISTHD A                                         13370000
133800          WHERE A.ORD_NBR            = :DK-ORD-NBR                13380000
133900            AND A.RCVR_SEQ_NBR       = :DK-RCVR-NBR               13390000
134000            AND A.PREPK_LNE_PRC_CDE  = ' '                        13400000
134100            AND A.DLT_REQ_TMST       = :PC-DEFAULT-TMST           13410000
134200     END-EXEC.                                                    13420000
134300                                                                  13430000
134400     EVALUATE TRUE                                                13440000
134500         WHEN SQLCODE = ZERO                                      13450000
134600             CONTINUE                                             13460000
134700                                                                  13470000
134800         WHEN SQLWARN0 NOT = SPACES                               13480000
134900         WHEN SQLCODE < ZERO                                      13490000
135000         WHEN SQLCODE > ZERO                                      13500000
135100             MOVE '4030-CHECK-TDISTHD' TO DP013-PARAGRAPH         13510000
135200             MOVE 'UNSUCCESSFUL SELECT TDISTHD '                  13520000
135300                                   TO DP013-MESSAGE-TEXT (1)      13530000
135400             MOVE SQLCA            TO DP013-SQLCA                 13540000
135500             MOVE 'TDISTHD '       TO DP013-DB2-TABLE-NAME (1)    13550000
135600             SET DP013-DB2-ABEND                                  13560000
135700                 DP013-NO-ROLLBACK TO TRUE                        13570000
135800             PERFORM DP013-0000-PROCESS-ABEND                     13580000
135900     END-EVALUATE.                                                13590000
136000                                                                  13600000
136100*----------------------------------------------------------------*13610000
136200*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *13620000
136300*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSOR.                *13630000
136400*----------------------------------------------------------------*13640000
136500 4100-PREPARE-CURSOR.                                             13650000
136600                                                                  13660000
136700     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR                 13670000
136800                                       ASC-ORD-NBR.               13680000
136900                                                                  13690000
137000     MOVE ASC-KEY-RCVR-NBR          TO DK-RCVR-NBR                13700000
137100                                       ASC-RCVR-NBR.              13710000
137200                                                                  13720000
137300     MOVE ASC-KEY-STR-NBR           TO DK-STR-NBR                 13730000
137400                                       ASC-STORE-NBR.             13740000
137500                                                                  13750000
137600*----------------------------------------------------------------*13760000
137700* OPEN THE STORE CURSOR.                                         *13770000
137800*----------------------------------------------------------------*13780000
137900 4110-OPEN-CURSOR.                                                13790000
138000                                                                  13800000
138100     EXEC SQL                                                     13810000
138200         OPEN STORE-CSR                                           13820000
138300     END-EXEC                                                     13830000
138400                                                                  13840000
138500     EVALUATE TRUE                                                13850000
138600         WHEN SQLCODE = ZERO                                      13860000
138700             CONTINUE                                             13870000
138800                                                                  13880000
138900         WHEN SQLCODE = -904                                      13890000
139000         WHEN SQLCODE = -911                                      13900000
139100         WHEN SQLCODE = -913                                      13910000
139200             PERFORM 9900-SOFT-ABORT                              13920000
139300                                                                  13930000
139400         WHEN SQLWARN0 NOT = SPACE                                13940000
139500         WHEN SQLCODE  NOT = ZERO                                 13950000
139600             MOVE '4110-OPEN-CURSOR' TO DP013-PARAGRAPH           13960000
139700             MOVE 'OPEN STORE-CSR CURSOR'                         13970000
139800                                     TO DP013-MESSAGE-TEXT (1)    13980000
139900             MOVE SQLCA              TO DP013-SQLCA               13990000
140000             MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1)  14000000
140100             SET DP013-DB2-ABEND     TO TRUE                      14010000
140200             PERFORM DP013-0000-PROCESS-ABEND                     14020000
140300     END-EVALUATE.                                                14030000
140400                                                                  14040000
140500*----------------------------------------------------------------*14050000
140600* CLOSE THE STORE CURSOR.                                        *14060000
140700*----------------------------------------------------------------*14070000
140800 4120-CLOSE-CURSOR.                                               14080000
140900                                                                  14090000
141000     EXEC SQL                                                     14100000
141100         CLOSE STORE-CSR                                          14110000
141200     END-EXEC.                                                    14120000
141300                                                                  14130000
141400     EVALUATE TRUE                                                14140000
141500         WHEN SQLCODE = ZERO                                      14150000
141600             CONTINUE                                             14160000
141700                                                                  14170000
141800         WHEN SQLWARN0 NOT = SPACE                                14180000
141900         WHEN SQLCODE  NOT = ZERO                                 14190000
142000             MOVE '4120-CLOSE-CURSOR' TO DP013-PARAGRAPH          14200000
142100             MOVE 'CLOSE STORE-CSR CURSOR'                        14210000
142200                                      TO DP013-MESSAGE-TEXT (1)   14220000
142300             MOVE SQLCA               TO DP013-SQLCA              14230000
142400             MOVE 'TDISTDT'           TO DP013-DB2-TABLE-NAME (1) 14240000
142500             SET DP013-DB2-ABEND      TO TRUE                     14250000
142600             PERFORM DP013-0000-PROCESS-ABEND                     14260000
142700     END-EVALUATE.                                                14270000
142800                                                                  14280000
142900*----------------------------------------------------------------*14290000
143000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *14300000
143100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *14310000
143200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *14320000
143300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *14330000
143400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *14340000
143500*                                                                *14350000
143600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *14360000
143700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *14370000
143800*    UPON INITIALIZATION.                                        *14380000
143900*----------------------------------------------------------------*14390000
144000 4300-READ-ITEMS-FROM-DB.                                         14400000
144100                                                                  14410000
144200     PERFORM                                                      14420000
144300       VARYING PV-READ-COUNT FROM 1 BY 1                          14430000
144400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    14440000
144500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         14450000
144600                                                                  14460000
144700         PERFORM 4310-FETCH                                       14470000
144800         IF ASC-ITEMS-LEFT-ON-DB                                  14480000
144900             PERFORM 4320-BLOCK-SUBSCRIPTS                        14490000
145000             PERFORM 4330-FILL-SCREEN-LINE                        14500000
145100         END-IF                                                   14510000
145200                                                                  14520000
145300     END-PERFORM.                                                 14530000
145400                                                                  14540000
145500     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           14550000
145600         MOVE +1 TO ASC-BLK-SUB                                   14560000
145700         PERFORM 5100-WRITE-TEMP-STORAGE                          14570000
145800         ADD +1  TO ASC-BLK-SUB                                   14580000
145900         PERFORM 5100-WRITE-TEMP-STORAGE                          14590000
146000         MOVE 1  TO ASC-BLK-SUB                                   14600000
146100                    PV-BLOCK-NUMBER                               14610000
146200         PERFORM 4410-READ-TEMP-STORAGE                           14620000
146300         IF ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1              14630000
146400             MOVE 2 TO ASC-BLK-SUB                                14640000
146500                       PV-BLOCK-NUMBER                            14650000
146600             PERFORM 4410-READ-TEMP-STORAGE                       14660000
146700         END-IF                                                   14670000
146800     END-IF.                                                      14680000
146810     PERFORM 8400-CHECK-AUTOVE.                                   14681050
146900                                                                  14690000
147000*----------------------------------------------------------------*14700000
147100* FETCH NEXT ROW FROM TDISTDT USING THE STORE CURSOR.            *14710000
147200*----------------------------------------------------------------*14720000
147300 4310-FETCH.                                                      14730000
147400                                                                  14740000
147500     EXEC SQL                                                     14750000
147600         FETCH STORE-CSR                                          14760000
147700          INTO :DISTDT-ORD-LNE-NBR                                14770000
147800             , :DISTDT-FCSE-SPLT-UNT-QTY                          14780000
147900             , :DISTDT-FCSE-ACTL-UNT-QTY                          14790000
148000             , :DISTDT-PREPK-ODD-UNT-QTY                          14800000
148100     END-EXEC.                                                    14810000
148200                                                                  14820000
148300     EVALUATE TRUE                                                14830000
148400         WHEN SQLCODE = ZERO                                      14840000
148500             CONTINUE                                             14850000
148600                                                                  14860000
148700         WHEN SQLCODE = +100                                      14870000
148800             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  14880000
148900                                                                  14890000
149000         WHEN SQLCODE = -904                                      14900000
149100         WHEN SQLCODE = -911                                      14910000
149200         WHEN SQLCODE = -913                                      14920000
149300             PERFORM 9900-SOFT-ABORT                              14930000
149400                                                                  14940000
149500         WHEN SQLWARN0 NOT = SPACE                                14950000
149600         WHEN SQLCODE < ZERO                                      14960000
149700         WHEN SQLCODE > ZERO                                      14970000
149800             MOVE '4310-FETCH'   TO DP013-PARAGRAPH               14980000
149900             MOVE 'FETCH STORE CURSOR'                            14990000
150000                                 TO DP013-MESSAGE-TEXT (1)        15000000
150100             MOVE SQLCA          TO DP013-SQLCA                   15010000
150200             MOVE 'TDISTDT'      TO DP013-DB2-TABLE-NAME (1)      15020000
150300             SET DP013-DB2-ABEND TO TRUE                          15030000
150400             PERFORM DP013-0000-PROCESS-ABEND                     15040000
150500     END-EVALUATE.                                                15050000
150600                                                                  15060000
150700*----------------------------------------------------------------*15070000
150800* 4320-BLOCK-SUBSCRIPTS ADVANCES TO A NEW LINE ON THE SCREEN.     15080000
150900*----------------------------------------------------------------*15090000
151000 4320-BLOCK-SUBSCRIPTS.                                           15100000
151100                                                                  15110000
151200     IF ASC-ITEMS-LEFT-ON-DB                                      15120000
151300         IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                     15130000
151400             ADD +1  TO ASC-ITEM-SUB                              15140000
151500         ELSE                                                     15150000
151600             ADD +1  TO ASC-BLK-SUB                               15160000
151700             MOVE +1 TO ASC-ITEM-SUB                              15170000
151800                                                                  15180000
151900             IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY              15190000
152000                 MOVE +1 TO ASC-BLK-SUB                           15200000
152100                 SET ASC-BLOCK-MODIFIED (1) TO TRUE               15210000
152200                 PERFORM 5100-WRITE-TEMP-STORAGE                  15220000
152300                 MOVE ASC-BLOCK-ENTRIES (PC-MAX-BLOCKS-IN-ARRAY)  15230000
152400                   TO ASC-BLOCK-ENTRIES (ASC-BLK-SUB)             15240000
152500                 ADD +1  TO ASC-BLK-SUB                           15250000
152600                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       15260000
152700                 SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE  15270000
152800             END-IF                                               15280000
152900         END-IF                                                   15290000
153000                                                                  15300000
153100         ADD +1 TO ASC-NUMBER-OF-ITEMS-READ                       15310000
153200         MOVE ASC-NUMBER-OF-ITEMS-READ                            15320000
153300           TO ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)     15330000
153400     END-IF.                                                      15340000
153500                                                                  15350000
153600*----------------------------------------------------------------*15360000
153700*  FILL THE APPLICATION-SPECIFIC COMMAREA DETAIL LINE PORTION.   *15370000
153800*----------------------------------------------------------------*15380000
153810*----------------------------------------------------------------*15381000
153820*                                               **   WR # 21361  *15382000
153830* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *15383000
153840* ADDED CODE TO INCLUDE XLKUT001 LOGIC.DELETED   OUT THE LINES   *15384044
153841* WHICH MOVES VALUE TO ASC-SKU-DEPT AND ASC-SKU-CLS SINCE THESE  *15384100
153842* TWO FIELDS ARE REMOVED FROM THE STRUCTURE.                     *15384200
153850*----------------------------------------------------------------*15385000
153900 4330-FILL-SCREEN-LINE.                                           15390000
154000                                                                  15400000
154100*FILL LINE NUMBER.                                                15410000
154200     MOVE DISTDT-ORD-LNE-NBR                                      15420000
154300       TO ASC-LINE (ASC-BLK-SUB ASC-ITEM-SUB).                    15430000
154800                                                                  15480000
154900*FILL CLASS.                                                      15490000
155000     MOVE DISTDT-ORD-LNE-NBR TO DK-LINE-NBR.                      15500000
155100     PERFORM 7300-GET-SKU.                                        15510000
155101                                                                  15510100
155102*FILL SKU.                                                        15510200
155110     IF PURITM-ITM-NBR < 0                                        15511000
155120        MOVE '4330-FILL-SCREEN-LINE'       TO DP013-PARAGRAPH     15512000
155130        MOVE 'ITEM NUMBER IS LESS THAN ZERO'                      15513000
155140                              TO DP013-MESSAGE-TEXT (1)           15514000
155190        PERFORM DP013-0000-PROCESS-ABEND                          15519000
155191     END-IF.                                                      15519100
155192                                                                  15519200
155193     IF PURITM-ITM-NBR = 0                                        15519300
155194        IF PURITM-SKU-SEQ-NBR = PC-000                            15519400
155195           MOVE '00000000'                                        15519500
155196                      TO PV-SKU                                   15519600
155197        ELSE                                                      15519700
155198           IF PURITM-SKU-SEQ-NBR = PC-999                         15519800
155199              MOVE '99999999'                                     15519900
155200                      TO PV-SKU                                   15520000
155201           ELSE                                                   15520100
155202              MOVE '4330-FILL-SCREEN-LINE'                        15520200
155203                      TO DP013-PARAGRAPH                          15520300
155204              MOVE 'ITEM NUMBER IS NOT VALID'                     15520400
155205                      TO DP013-MESSAGE-TEXT (1)                   15520500
155210              PERFORM DP013-0000-PROCESS-ABEND                    15521000
155218           END-IF                                                 15521800
155219        END-IF                                                    15521900
155220     END-IF                                                       15522000
155221                                                                  15522100
155222     IF PURITM-ITM-NBR > 0 AND                                    15522200
155223      PS-CALL-API-YES    AND                                      15522300
155224      ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                      15522400
155225       (PURITM-SKU-SEQ-NBR NOT = PC-999))                         15522545
155226        PERFORM 7310-CALL-XLKUT-DOMAIN-PGM                        15522600
155227     END-IF.                                                      15522700
155230                                                                  15523000
155240     MOVE PURITM-CL-NBR                                           15524000
155300       TO ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB).                   15530000
155500                                                                  15550000
155810     MOVE PV-SKU                                                  15581000
155820       TO ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB).                     15582000
155900                                                                  15590000
155910*----------------------------------------------------------------*15591000
155920* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *15592000
155930*----------------------------------------------------------------*15593000
156000*FILL PACK-ID.                                                    15600000
156100     PERFORM 7100-GET-PREPK-ID.                                   15610000
156200     IF RECITM-PREPK-ID > +0                                      15620000
156300         MOVE RECITM-PREPK-ID                                     15630000
156400           TO ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)              15640000
156500         MOVE RECITM-PREPK-RATO-QTY                               15650000
156600           TO ASC-PREPK-RATO-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       15660000
156700     ELSE                                                         15670000
156800         MOVE SPACES                                              15680000
156900           TO ASC-PACK-ID-X (ASC-BLK-SUB ASC-ITEM-SUB)            15690000
157000         MOVE ZEROES                                              15700000
157100           TO ASC-PREPK-RATO-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       15710000
157200     END-IF.                                                      15720000
157300                                                                  15730000
157400*FILL FULLCASE QUANTITY.                                          15740000
157500     IF (ASC-PKGNG-CDE = 'I' OR 'M')                              15750000
157600       AND (ASC-PREPK-RATO-QTY(ASC-BLK-SUB ASC-ITEM-SUB) NOT = 0) 15760000
157610         IF ASC-AUTO-VE-YES                                       15761050
157620             MOVE POPRPK-PK-SKU-NBR   TO DK-PK-SKU-NBR            15762050
157630             MOVE ASC-RCVR-NBR        TO DK-RCVR-NBR              15763050
157640             PERFORM 4370-SUM-PACKS                               15764050
157650             MOVE PV-SUM-OF-PACKS                                 15765050
157660                  TO ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      15766050
157670         ELSE                                                     15767050
157680             MOVE DISTDT-FCSE-ACTL-UNT-QTY                        15768050
157700                  TO ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      15770050
157810         END-IF                                                   15781050
158000     ELSE                                                         15800000
158001         IF ASC-AUTO-VE-YES                                       15800150
158002             INITIALIZE RC074-FIELDS                              15800250
158003             SET RC074-UNIT-QTY-YES     TO TRUE                   15800350
158004             PERFORM 4350-CALL-RCKUT128                           15800450
158005             MOVE RC074-FCSE-ACTL-ITM-QTY                         15800550
158010               TO ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         15801050
158020          ELSE                                                    15802050
158100             MOVE DISTDT-FCSE-ACTL-UNT-QTY                        15810050
158200               TO ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         15820050
158210          END-IF                                                  15821050
158300     END-IF.                                                      15830000
158400                                                                  15840000
158500*FILL ODD UNIT QUANTITY.                                          15850000
158520     IF (ASC-PKGNG-CDE = 'I' OR 'M')                              15852056
158530       AND (ASC-PREPK-RATO-QTY(ASC-BLK-SUB ASC-ITEM-SUB) NOT = 0) 15853056
158540       AND ASC-AUTO-VE-YES                                        15854056
158542         IF RECEIV-STATUS-CDE = 'VE'                              15854256
158543             MOVE RC074-VERIFY-ODD-QTY                            15854356
158550               TO ASC-ODD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          15855056
158551         ELSE                                                     15855156
158552             MOVE RC074-ACTUAL-ODD-QTY                            15855256
158553               TO ASC-ODD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          15855356
158554         END-IF                                                   15855456
158560     ELSE                                                         15856056
158600         MOVE DISTDT-PREPK-ODD-UNT-QTY                            15860056
158700           TO ASC-ODD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              15870056
158710     END-IF.                                                      15871056
158800                                                                  15880000
158900*FILL TOTAL QUANTITY.                                             15890000
159000     ADD ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                  15900000
159100         ASC-ODD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                   15910000
159200         GIVING ASC-TOT-QTY (ASC-BLK-SUB ASC-ITEM-SUB).           15920000
159210                                                                  15921050
159211*FILL EXPECTED QUANTITY.                                          15921150
159212     MOVE DISTDT-FCSE-SPLT-UNT-QTY                                15921250
159213       TO ASC-EXPECT-QTY (ASC-BLK-SUB ASC-ITEM-SUB).              15921350
159214                                                                  15921450
159215                                                                  15921553
159216 4350-CALL-RCKUT128.                                              15921653
159217     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               15921753
159218     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  15921853
159219     MOVE ASC-ORD-NBR         TO RC074-PO-NBR.                    15921953
159220     MOVE ASC-RCVR-NBR        TO RC074-RCVR-SEQ-NBR.              15922053
159221     MOVE DISTHD-ORD-LNE-NBR  TO RC074-LINE-NBR.                  15922153
159222     MOVE DK-STR-NBR          TO RC074-STR-NBR.                   15922253
159223                                                                  15922353
159224     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 15922453
159225                                         RC074-COMMAREA           15922553
159226                                         RC074-FIELDS.            15922653
159227                                                                  15922753
159228     EVALUATE TRUE                                                15922853
159229         WHEN RC074-SUCCESSFUL                                    15922953
159230             CONTINUE                                             15923053
159231         WHEN OTHER                                               15923153
159232             MOVE '4350-CALL-RCKUT128'                            15923253
159233                                 TO DP013-PARAGRAPH               15923353
159234             STRING                                               15923453
159235                  'UNSUCCESSFUL CALL TO RCKUT128 '                15923553
159236                  'SUCCESS-IND = '                                15923653
159237                  RC074-SUCCESS-IND                               15923753
159238                               DELIMITED BY SIZE                  15923853
159239                               INTO DP013-MESSAGE-TEXT (1)        15923953
159240             MOVE RC074-CRA-RET-MSG                               15924053
159241                                 TO DP013-MESSAGE-TEXT (2)        15924153
159242             MOVE RC074-SQLCA    TO DP013-SQLCA                   15924253
159243             SET DP013-DB2-ABEND                                  15924353
159244                 DP013-XCTL-DISPLAY-RESTART                       15924453
159245                                 TO TRUE                          15924553
159246             PERFORM DP013-0000-PROCESS-ABEND                     15924653
159247     END-EVALUATE.                                                15924753
159248                                                                  15924853
159249                                                                  15924953
159250 4370-SUM-PACKS.                                                  15925053
159251                                                                  15925153
159252     MOVE 0            TO PV-SUM-OF-PACKS.                        15925253
159253                                                                  15925353
159260     EXEC SQL                                                     15926050
159270         SELECT SUM(SHPD_PK_QTY)                                  15927050
159280           INTO :PV-SUM-OF-PACKS                                  15928050
159290           FROM SUT_OTBND_PK                                      15929050
159291          WHERE TRN_NBR        =  :DK-ORD-NBR                     15929150
159292            AND RCVR_SEQ_NBR   =  :DK-RCVR-NBR                    15929250
159293            AND PK_SKU_NBR     =  :DK-PK-SKU-NBR                  15929350
159294     END-EXEC                                                     15929450
159295                                                                  15929550
159296     EVALUATE TRUE                                                15929650
159297         WHEN SQLCODE = +0                                        15929750
159298         WHEN SQLCODE = -305                                      15929850
159299         WHEN SQLCODE = +100                                      15929950
159300             CONTINUE                                             15930050
159301         WHEN SQLCODE = -904                                      15930150
159302         WHEN SQLCODE = -911                                      15930250
159303         WHEN SQLCODE = -913                                      15930350
159304             PERFORM 9900-SOFT-ABORT                              15930450
159305                                                                  15930550
159306         WHEN SQLWARN0 NOT = SPACES                               15930650
159307         WHEN SQLCODE < ZERO                                      15930750
159308         WHEN SQLCODE > ZERO                                      15930850
159309             MOVE DK-ORD-NBR       TO PV-DISPLAY-PO               15930950
159310             MOVE DK-RCVR-NBR      TO PV-DISPLAY-RECV             15931050
159311             MOVE DK-PK-SKU-NBR    TO PV-DISPLAY-SKU              15931150
159312             MOVE '4370-SUM-PACKS'                                15931250
159313                               TO DP013-PARAGRAPH                 15931350
159314             MOVE 'SUM PACKS FOR THE PO RECEIVER'                 15931450
159315                               TO DP013-MESSAGE-TEXT (1)          15931550
159316             STRING  'PO = '                                      15931650
159317                     PV-DISPLAY-PO                                15931750
159318                     ' RECVR = '                                  15931850
159319                     PV-DISPLAY-RECV                              15931950
159320                     ' PACK SKU = '                               15932050
159321                     PV-DISPLAY-SKU                               15932150
159322                                  DELIMITED BY SIZE               15932250
159323                             INTO DP013-MESSAGE-TEXT (2)          15932350
159324             MOVE SQLCA        TO DP013-SQLCA                     15932450
159325             MOVE 'SUT00041'   TO DP013-DB2-TABLE-NAME (1)        15932550
159326             SET DP013-DB2-ABEND                                  15932650
159327                 DP013-XCTL-DISPLAY-RESTART                       15932750
159328                               TO TRUE                            15932850
159329             PERFORM DP013-0000-PROCESS-ABEND                     15932950
159330     END-EVALUATE.                                                15933050
159340                                                                  15934000
159400*----------------------------------------------------------------*15940000
159500*----------------------------------------------------------------*15950000
159600 4400-MOVE-COMMAREA-TO-SCREEN.                                    15960000
159700                                                                  15970000
159800     IF (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))              15980000
159900       AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))            15990000
160000        OR (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            16000000
160100                                                                  16010000
160200         MOVE +1 TO ASC-BLK-SUB                                   16020000
160300         PERFORM 5100-WRITE-TEMP-STORAGE                          16030000
160400                                                                  16040000
160500         ADD +1  TO ASC-BLK-SUB                                   16050000
160600         PERFORM 5100-WRITE-TEMP-STORAGE                          16060000
160700                                                                  16070000
160800         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 16080000
160900           GIVING PV-BLOCK-NUMBER                                 16090000
161000           REMAINDER PV-REMAINDER                                 16100000
161100         IF PV-REMAINDER > ZERO                                   16110000
161200             ADD +1 TO PV-BLOCK-NUMBER                            16120000
161300         END-IF                                                   16130000
161400                                                                  16140000
161500         MOVE +1 TO ASC-BLK-SUB                                   16150000
161600         PERFORM 4410-READ-TEMP-STORAGE                           16160000
161700                                                                  16170000
161800         ADD +1  TO ASC-BLK-SUB                                   16180000
161900                    PV-BLOCK-NUMBER                               16190000
162000         PERFORM 4410-READ-TEMP-STORAGE                           16200000
162100     END-IF.                                                      16210000
162200                                                                  16220000
162300     MOVE +1 TO ASC-BLK-SUB.                                      16230000
162400                                                                  16240000
162500     COMPUTE ASC-ITEM-SUB =                                       16250000
162600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              16260000
162700         + PC-ITEMS-PER-PANEL).                                   16270000
162800                                                                  16280000
162900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16290000
163000         ADD +1 TO ASC-BLK-SUB                                    16300000
163100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           16340000
163500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                16350000
163600                                                                  16360000
163700     PERFORM 4420-FORMAT-LIST-LINES                               16370000
163800       VARYING PV-SUB FROM PC-ITEMS-PER-PANEL BY -1               16380000
163900         UNTIL PV-SUB < +1.                                       16390000
164000                                                                  16400000
164100     COMPUTE ASC-ITEMS-DISPLAYED =                                16410000
164200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          16420000
164300                                                                  16430000
164400     MOVE PV-TOP-ITEM TO ASC-ITEM-AT-TOP-OF-PANEL                 16440000
164500                         ASTRTITO.                                16450000
164600                                                                  16460000
164700* HEADINGS.                                                       16470000
164800     IF ASC-PKGNG-CDE = 'I' OR 'M'                                16480000
164900         MOVE ' ODD'               TO APKHD1O                     16490000
165000         MOVE 'UNITS'              TO APKHD2O                     16500000
165100     ELSE                                                         16510000
165200         MOVE 'FCSE'               TO APKHD1O                     16520000
165300         MOVE ' QTY '              TO APKHD2O                     16530000
165400     END-IF.                                                      16540000
165500                                                                  16550000
165600* HEADER FIELDS.                                                  16560000
165700     MOVE ASC-RCVR-OPER-UNT-ID     TO AOPERO.                     16570000
165800     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    16580000
165900*CLP 10/21/14 - MOVE ENTIRE 8 DIGIT PO                            16590059
166000     MOVE ASC-ORD-NBR              TO APOO.                       16600000
166100     MOVE ASC-RCVR-NBR             TO ARCVRO.                     16610000
166200     MOVE ASC-STORE-NBR            TO ASTRO.                      16620000
166300     MOVE ASC-STORE-NAME           TO ASTRNO.                     16630000
166400     MOVE ASC-DEPT                 TO ADEPTO.                     16640000
166500                                                                  16650000
166600     IF ASC-PKGNG-CDE-DISPLAY = 'B'                               16660000
166700         MOVE 'BULK  '             TO APKCDO                      16670000
166800     ELSE                                                         16680000
166900     IF ASC-PKGNG-CDE-DISPLAY = 'C'                               16690000
167000         MOVE 'CASEPK'             TO APKCDO                      16700000
167100     ELSE                                                         16710000
167200     IF ASC-PKGNG-CDE-DISPLAY = 'I'                               16720000
167300         MOVE 'INPRPK'             TO APKCDO                      16730000
167400     ELSE                                                         16740000
167500     IF ASC-PKGNG-CDE-DISPLAY = 'M'                               16750000
167600         MOVE 'MLTSKU'             TO APKCDO                      16760000
167700     ELSE                                                         16770000
167800     IF ASC-PKGNG-CDE-DISPLAY = 'S'                               16780000
167900         MOVE 'SGLSKU'             TO APKCDO                      16790000
168000     ELSE                                                         16800000
168100         MOVE 'UNKNWN'             TO APKCDO                      16810000
168200     END-IF.                                                      16820000
168300                                                                  16830000
168400     IF ASC-PKGNG-CDE-DISPLAY = 'I' OR 'M'                        16840000
168500         MOVE DP015-YELLOW         TO APKCDC                      16850000
168600     END-IF.                                                      16860000
168700                                                                  16870000
168800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    16880000
168900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    16890000
169000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            16900000
169100                                   TO ASELITO.                    16910000
169200                                                                  16920000
169300     IF DP020-MSG-NUMBER-X = SPACE                                16930000
169400         IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ   16940000
169500*            --- MORE ITEMS TO DISPLAY ----                       16950000
169600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            16960000
169700             SET DP020-MSG-INFORMATIONAL TO TRUE                  16970000
169800         END-IF                                                   16980000
169900     END-IF.                                                      16990000
170000                                                                  17000000
170100*----------------------------------------------------------------*17010000
170200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *17020000
170300*----------------------------------------------------------------*17030000
170400 4410-READ-TEMP-STORAGE.                                          17040000
170500                                                                  17050000
170600     EXEC CICS                                                    17060000
170700         READQ TS                                                 17070000
170800             QUEUE (ASC-LIST-QUEUE-NAME)                          17080000
170900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               17090000
171000             ITEM  (PV-BLOCK-NUMBER)                              17100000
171100             RESP  (PV-CICS-RESP)                                 17110000
171200     END-EXEC.                                                    17120000
171300                                                                  17130000
171400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       17140000
171500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     17150000
171600         CONTINUE                                                 17160000
171700     ELSE                                                         17170000
171800         SET DP013-CICS-ABEND      TO TRUE                        17180000
171900         SET DP013-NO-ROLLBACK     TO TRUE                        17190000
172000         MOVE '4410-READ-TEMP-STORAGE'                            17200000
172100                                   TO DP013-PARAGRAPH             17210000
172200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      17220000
172300                                   TO DP013-MESSAGE-TEXT(1)       17230000
172400         PERFORM DP013-0000-PROCESS-ABEND                         17240000
172500     END-IF.                                                      17250000
172600                                                                  17260000
172700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             17270000
172800                                                                  17280000
172900     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          17290000
173000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               17300000
173100     END-IF.                                                      17310000
173200                                                                  17320000
173300*----------------------------------------------------------------*17330000
173400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *17340000
173500*----------------------------------------------------------------*17350000
173600 4420-FORMAT-LIST-LINES.                                          17360000
173700                                                                  17370000
173800     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       17380000
173900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                17390000
174000         IF ASC-LINE-X (ASC-BLK-SUB ASC-ITEM-SUB) = 0 OR SPACE    17400000
174100             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        17410000
174200                                       MR-U-PROCESS-QTYA (PV-SUB) 17420000
174300             MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)        17430000
174400                                       MR-U-PROCESS-QTYH (PV-SUB) 17440000
174500             MOVE SPACE             TO MR-SELECT  (PV-SUB)        17450000
174600                                       MR-ACTION  (PV-SUB)        17460000
174700                                       MR-U-PROCESS-QTY-X (PV-SUB)17470000
174800                                       MR-LINE       (PV-SUB)     17480000
174900                                       MR-CLASS      (PV-SUB)     17490000
175000                                       MR-SKU        (PV-SUB)     17500000
175100                                       MR-PACK       (PV-SUB)     17510000
175200                                       MR-EXPTD-QTY-X (PV-SUB)    17520051
175210                                       MR-FCSE-QTY-X (PV-SUB)     17521051
175300                                       MR-ODD-QTY-X  (PV-SUB)     17530000
175400                                       MR-TOTAL-QTY-X (PV-SUB)    17540000
175500         END-IF                                                   17550000
175600     ELSE                                                         17560000
175700         IF ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB) > SPACE17570000
175800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17580000
175900               TO MR-SELECT (PV-SUB)                              17590000
176000         ELSE                                                     17600000
176100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      17610000
176200               TO MR-SELECT (PV-SUB)                              17620000
176300         END-IF                                                   17630000
176400                                                                  17640000
176500         IF DP030-SET-CURSOR-TRAILER                              17650000
176600             IF ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17660000
176700                                       > SPACE)                   17670000
176800               OR (PV-SUB = 1))                                   17680000
176900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17690000
177000                 MOVE -1 TO MR-SELECTL (PV-SUB)                   17700000
177100             END-IF                                               17710000
177200         END-IF                                                   17720000
177300                                                                  17730000
177400*MOVE DETAIL TO MAP.                                              17740000
177500         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               17750000
177600            TO MR-ACTION (PV-SUB)                                 17760000
177700         IF (ASC-U-PROCESS-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)       17770000
177800                                  = SPACES)                       17780000
177900           OR (MR-SELECT (PV-SUB) = SPACES)                       17790000
178000             MOVE SPACES TO MR-U-PROCESS-QTY-X (PV-SUB)           17800000
178100         ELSE                                                     17810000
178200             MOVE ASC-U-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)    17820000
178300               TO MR-U-PROCESS-QTY (PV-SUB)                       17830000
178400         END-IF                                                   17840000
178500                                                                  17850000
178600         MOVE ASC-LINE (ASC-BLK-SUB ASC-ITEM-SUB)                 17860000
178700           TO MR-LINE (PV-SUB)                                    17870000
178800                                                                  17880000
178900         MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)                17890000
179000           TO MR-CLASS (PV-SUB)                                   17900000
179100                                                                  17910000
179200         MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                  17920000
179300           TO MR-SKU (PV-SUB)                                     17930000
179400                                                                  17940000
179500         MOVE ASC-PACK-ID-X (ASC-BLK-SUB ASC-ITEM-SUB)            17950000
179600           TO MR-PACK (PV-SUB)                                    17960000
179700                                                                  17970000
179710         MOVE ASC-EXPECT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)           17971051
179720           TO MR-EXPTD-QTY (PV-SUB)                               17972051
179800         MOVE ASC-FCSE-QTY (ASC-BLK-SUB ASC-ITEM-SUB)             17980000
179900           TO MR-FCSE-QTY (PV-SUB)                                17990000
180000                                                                  18000000
180100         MOVE ASC-ODD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              18010000
180200           TO MR-ODD-QTY (PV-SUB)                                 18020000
180300         IF ASC-PKGNG-CDE = 'I' OR 'M'                            18030000
180400             MOVE DP015-YELLOW TO MR-ODD-QTYC (PV-SUB)            18040000
180500         END-IF                                                   18050000
180600                                                                  18060000
180700         MOVE ASC-TOT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              18070000
180800           TO MR-TOTAL-QTY (PV-SUB)                               18080000
180900                                                                  18090000
181000         IF ASC-PROTECT-ALL-STORES                                18100000
181100             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        18110000
181200                                       MR-U-PROCESS-QTYA (PV-SUB) 18120000
181300             MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)        18130000
181400                                       MR-U-PROCESS-QTYH (PV-SUB) 18140000
181500             MOVE -1                TO ASTRTITL                   18150000
181600         END-IF                                                   18160000
181700     END-IF.                                                      18170000
181800                                                                  18180000
181900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18190000
182000                                                                  18200000
182100     IF ASC-ITEM-SUB < + 1                                        18210000
182200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  18220000
182300         MOVE +1                 TO ASC-BLK-SUB                   18230000
182400     END-IF.                                                      18240000
182500                                                                  18250000
182600*----------------------------------------------------------------*18260000
182700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *18270000
182800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *18280000
182900* FOR THE SELECTED ITEMS QUEUE.                                  *18290000
183000*                                                                *18300000
183100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *18310000
183200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *18320000
183300* THE ARRAY IS FULL.                                             *18330000
183400*----------------------------------------------------------------*18340000
183500 5000-PREPARE-SEL-QUEUE.                                          18350000
183600                                                                  18360000
183700     MOVE +1 TO ASC-BLK-SUB.                                      18370000
183800     PERFORM 5100-WRITE-TEMP-STORAGE.                             18380000
183900     ADD +1  TO ASC-BLK-SUB.                                      18390000
184000     PERFORM 5100-WRITE-TEMP-STORAGE.                             18400000
184100                                                                  18410000
184200     MOVE ASC-OPER-UNT-ID      TO  RC015-OPER-UNT-ID.             18420000
184300     MOVE ASC-FCLTY-ID         TO  RC015-FCLTY-ID.                18430000
184400     MOVE ASC-ORD-NBR          TO  RC015-PO-NBR.                  18440000
184500     MOVE ASC-RCVR-NBR         TO  RC015-REC-SEQ-NBR.             18450000
184600     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          18460000
184700     PERFORM 6010-DELETE-SEL-QUEUE.                               18470000
184800                                                                  18480000
184900     IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                       18490000
185000         SET ASC-UPDATE-TSQ TO TRUE                               18500000
185100     END-IF.                                                      18510000
185200                                                                  18520000
185300     SET RC013-IDX TO 1.                                          18530000
185400     MOVE ZERO     TO RC015-NUMBER-OF-TS-ITEMS.                   18540000
185500     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        18550000
185600                                                                  18560000
185700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           18570000
185800       VARYING PV-ITEM  FROM 1 BY 1                               18580000
185900         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.               18590000
186000                                                                  18600000
186100     IF RC013-IDX > 1                                             18610000
186200         PERFORM 5205-WRITE-SEL-QUEUE                             18620000
186300         ADD +1 TO RC015-NUMBER-OF-TS-ITEMS                       18630000
186400     END-IF.                                                      18640000
186500                                                                  18650000
186600*----------------------------------------------------------------*18660000
186700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *18670000
186800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *18680000
186900*----------------------------------------------------------------*18690000
187000 5100-WRITE-TEMP-STORAGE.                                         18700000
187100                                                                  18710000
187200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     18720000
187300       TO PV-LIST-ITEM-NUMBER.                                    18730000
187400     COMPUTE PV-BLOCK-NUMBER =                                    18740000
187500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18750000
187600                                                                  18760000
187700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             18770000
187800       OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)           18780000
187900         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       18790000
188000             PERFORM 5105-REWRITE-ASC-LISTQ                       18800000
188100         END-IF                                                   18810000
188200     ELSE                                                         18820000
188300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       18830000
188400                 ASC-HIGHEST-BLOCK-WRITTEN + 1                    18840000
188500         PERFORM 5110-WRITE-ASC-LISTQ                             18850000
188600         ADD +1 TO ASC-HIGHEST-BLOCK-WRITTEN                      18860000
188700     END-IF.                                                      18870000
188800                                                                  18880000
188900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             18890000
189000                                                                  18900000
189100*----------------------------------------------------------------*18910000
189200*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *18920000
189300*  SPECIFIC COMMAREA.                                            *18930000
189400*----------------------------------------------------------------*18940000
189500 5105-REWRITE-ASC-LISTQ.                                          18950000
189600                                                                  18960000
189700     EXEC CICS                                                    18970000
189800         WRITEQ TS                                                18980000
189900             QUEUE (ASC-LIST-QUEUE-NAME)                          18990000
190000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19000000
190100             ITEM  (PV-BLOCK-NUMBER)                              19010000
190200             REWRITE                                              19020000
190300             RESP  (PV-CICS-RESP)                                 19030000
190400     END-EXEC.                                                    19040000
190500                                                                  19050000
190600*DMH     MOVE ASC-LIST-TERM-ID     TO PV-SEL-TERM-ID              19060000
190700*DMH     MOVE ASC-LIST-TASK-NUMBER TO PV-SEL-TASK-NUMBER          19070000
190800*DMH     MOVE ASC-LIST-SEQ         TO PV-SEL-SEQ                  19080000
190900*DMH     STRING ' RCKCS813-WRI LST2'  DELIMITED BY SIZE           19090000
191000*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           19100000
191100*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           19110000
191200*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           19120000
191300*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           19130000
191400*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           19140000
191500*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           19150000
191600*DMH                             INTO  PV-CICS-MSG-AREA2          19160000
191700*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     19170000
191800*DMH           TO PV-COMMAREA-LENGTH                              19180000
191900*DMH         EXEC CICS                                            19190000
192000*DMH              WRITEQ TD                                       19200000
192100*DMH               QUEUE  ('CSSL')                                19210000
192200*DMH                FROM  (PV-CICS-MSG-AREA2)                     19220000
192300*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    19230000
192400*DMH                RESP  (PV-CICS-RESP-2)                        19240000
192500*DMH         END-EXEC                                             19250000
192600                                                                  19260000
192700     IF PV-CICS-RESP = DFHRESP(NORMAL)                            19270000
192800         CONTINUE                                                 19280000
192900     ELSE                                                         19290000
193000         SET DP013-CICS-ABEND          TO TRUE                    19300000
193100         SET DP013-NO-ROLLBACK         TO TRUE                    19310000
193200         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         19320000
193300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     19330000
193400                                       TO DP013-MESSAGE-TEXT(1)   19340000
193500         PERFORM DP013-0000-PROCESS-ABEND                         19350000
193600     END-IF.                                                      19360000
193700                                                                  19370000
193800*----------------------------------------------------------------*19380000
193900*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *19390000
194000*  SPECIFIC COMMAREA.                                            *19400000
194100*----------------------------------------------------------------*19410000
194200 5110-WRITE-ASC-LISTQ.                                            19420000
194300                                                                  19430000
194400     EXEC CICS                                                    19440000
194500         WRITEQ TS                                                19450000
194600             QUEUE (ASC-LIST-QUEUE-NAME)                          19460000
194700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19470000
194800             ITEM  (PV-BLOCK-NUMBER)                              19480000
194900             RESP  (PV-CICS-RESP)                                 19490000
195000     END-EXEC.                                                    19500000
195100                                                                  19510000
195200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       19520000
195300         SET DP013-CICS-ABEND        TO TRUE                      19530000
195400         SET DP013-NO-ROLLBACK       TO TRUE                      19540000
195500         MOVE '5110-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           19550000
195600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           19560000
195700                                     TO DP013-MESSAGE-TEXT(1)     19570000
195800         PERFORM DP013-0000-PROCESS-ABEND                         19580000
195900     END-IF.                                                      19590000
196000                                                                  19600000
196100*----------------------------------------------------------------*19610000
196200 5120-REWRITE-LIST-QUEUE.                                         19620000
196300     EXEC CICS                                                    19630000
196400          WRITEQ TS                                               19640000
196500              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     19650000
196600              FROM    (RC013-DC-SELECT-RECORD)                    19660000
196700              ITEM    (ASC-SEL-ITEM)                              19670000
196800              RESP    (PV-CICS-RESP)                              19680000
196900              REWRITE                                             19690000
197000     END-EXEC.                                                    19700000
197100                                                                  19710000
197200     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    19720000
197300         SET DP013-CICS-ABEND                                     19730000
197400             DP013-NO-ROLLBACK     TO TRUE                        19740000
197500         MOVE '5120-REWRITE-LIST-QUEUE'                           19750000
197600                                   TO DP013-PARAGRAPH             19760000
197700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   19770000
197800                                   TO DP013-MESSAGE-TEXT (1)      19780000
197900         PERFORM DP013-0000-PROCESS-ABEND                         19790000
198000     END-IF.                                                      19800000
198100                                                                  19810000
198200*----------------------------------------------------------------*19820000
198300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *19830000
198400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *19840000
198500*----------------------------------------------------------------*19850000
198600 5200-FILL-SEL-QUEUE-RECORD.                                      19860000
198700                                                                  19870000
198800     PERFORM 6112-READ-LIST-QUEUE.                                19880000
198900                                                                  19890000
199000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        19900000
199100         PERFORM                                                  19910000
199200           VARYING LQW-IDX FROM 1 BY 1                            19920000
199300             UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        19930000
199400                OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO     19940000
199500                                                                  19950000
199600             IF LQW-SELECT (LQW-IDX)                              19960000
199700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              19970000
199800                                 TO RC013-ITEM      (RC013-IDX)   19980000
199900                 MOVE SPACE      TO RC013-ACTION-SW (RC013-IDX)   19990000
200000                 MOVE RC015-OPER-UNT-ID                           20000000
200100                                 TO RC013-OPER-UNT-ID(RC013-IDX)  20010000
200200                 MOVE RC015-FCLTY-ID                              20020000
200300                                 TO RC013-FCLTY-ID(RC013-IDX)     20030000
200400                 MOVE RC015-PO-NBR                                20040000
200500                                 TO RC013-PO-NBR(RC013-IDX)       20050000
200600                 MOVE RC015-REC-SEQ-NBR                           20060000
200700                                 TO RC013-REC-SEQ-NBR(RC013-IDX)  20070000
200800                                                                  20080000
200900                 SET LQW-DESELECT (LQW-IDX) TO TRUE               20090000
201000                 SET RC013-IDX UP BY 1                            20100000
201100                 IF  RC013-IDX > RC013-MAX-ITEMS                  20110000
201200                     PERFORM 5205-WRITE-SEL-QUEUE                 20120000
201300                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    20130000
201400                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         20140000
201500                     SET RC013-IDX TO 1                           20150000
201600                 END-IF                                           20160000
201700             END-IF                                               20170000
201800         END-PERFORM                                              20180000
201900     END-IF.                                                      20190000
202000                                                                  20200000
202100*----------------------------------------------------------------*20210000
202200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *20220000
202300*----------------------------------------------------------------*20230000
202400 5205-WRITE-SEL-QUEUE.                                            20240000
202500                                                                  20250000
202600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC013-SELECTED-ITEMS.   20260000
202700                                                                  20270000
202800     EXEC CICS                                                    20280000
202900          WRITEQ TS                                               20290000
203000              QUEUE (ASC-SEL-QUEUE-NAME)                          20300000
203100              FROM  (RC013-DC-SELECT-RECORD)                      20310000
203200              ITEM  (ASC-SEL-ITEM)                                20320000
203300              RESP  (PV-CICS-RESP)                                20330000
203400     END-EXEC.                                                    20340000
203500                                                                  20350000
203600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           20360000
203700         CONTINUE                                                 20370000
203800     ELSE                                                         20380000
203900         SET DP013-CICS-ABEND        TO TRUE                      20390000
204000         SET DP013-NO-ROLLBACK       TO TRUE                      20400000
204100         MOVE '5205-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           20410000
204200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          20420000
204300                                     TO DP013-MESSAGE-TEXT(1)     20430000
204400         PERFORM DP013-0000-PROCESS-ABEND                         20440000
204500     END-IF.                                                      20450000
204600                                                                  20460000
204700*----------------------------------------------------------------*20470000
204800*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *20480000
204900*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *20490000
205000*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *20500000
205100*  THE USER.                                                     *20510000
205200*----------------------------------------------------------------*20520000
205300 6000-REFRESH-PANEL-FROM-TEMP.                                    20530000
205400                                                                  20540000
205500     IF ASC-UPDATE-TSQ                                            20550000
205600         SET ASC-NO-TSQ-UPDATE TO TRUE                            20560000
205700         MOVE ZERO             TO PV-SAVE-ITEM                    20570000
205800                                  ASC-SEL-ITEM                    20580000
205900                                                                  20590000
206000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        20600000
206100                               TO PV-HOLD-SELECTED-ITEMS          20610000
206200                                                                  20620000
206300         PERFORM 6100-UPDATE-TSQ                                  20630000
206400           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS20640000
206500                                                                  20650000
206600*****    PERFORM 6010-DELETE-SEL-QUEUE                            20660000
206700                                                                  20670000
206800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         20680000
206900                    ASC-BLOCK-ENTRIES (2)                         20690000
207000     END-IF.                                                      20700000
207100                                                                  20710000
207200*----------------------------------------------------------------*20720000
207300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *20730000
207400*----------------------------------------------------------------*20740000
207500 6010-DELETE-SEL-QUEUE.                                           20750000
207600                                                                  20760000
207700     EXEC CICS                                                    20770000
207800         DELETEQ TS                                               20780000
207900             QUEUE (ASC-SEL-QUEUE-NAME)                           20790000
208000             RESP  (PV-CICS-RESP)                                 20800000
208100     END-EXEC.                                                    20810000
208200                                                                  20820000
208300*DMH     MOVE ASC-SEL-TERM-ID     TO PV-SEL-TERM-ID               20830000
208400*DMH     MOVE ASC-SEL-TASK-NUMBER TO PV-SEL-TASK-NUMBER           20840000
208500*DMH     MOVE ASC-SEL-SEQ         TO PV-SEL-SEQ                   20850000
208600*DMH     STRING ' RCKCS813-DEL SEL3'  DELIMITED BY SIZE           20860000
208700*DMH            ' QUEUE TERM ID-'     DELIMITED BY SIZE           20870000
208800*DMH             PV-SEL-TERM-ID       DELIMITED BY SIZE           20880000
208900*DMH            ' QUEUE TASK-'        DELIMITED BY SIZE           20890000
209000*DMH             PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           20900000
209100*DMH            ' QUEUE SEQ-'         DELIMITED BY SIZE           20910000
209200*DMH             PV-SEL-SEQ           DELIMITED BY SIZE           20920000
209300*DMH                             INTO  PV-CICS-MSG-AREA2          20930000
209400*DMH         MOVE LENGTH OF PV-CICS-MSG-AREA2                     20940000
209500*DMH           TO PV-COMMAREA-LENGTH                              20950000
209600*DMH         EXEC CICS                                            20960000
209700*DMH              WRITEQ TD                                       20970000
209800*DMH               QUEUE  ('CSSL')                                20980000
209900*DMH                FROM  (PV-CICS-MSG-AREA2)                     20990000
210000*DMH              LENGTH  (PV-COMMAREA-LENGTH)                    21000000
210100*DMH                RESP  (PV-CICS-RESP-2)                        21010000
210200*DMH         END-EXEC                                             21020000
210300                                                                  21030000
210400     IF ((PV-CICS-RESP = DFHRESP(NORMAL))                         21040000
210500       OR (PV-CICS-RESP = DFHRESP(QIDERR)))                       21050000
210600         CONTINUE                                                 21060000
210700     ELSE                                                         21070000
210800         SET DP013-CICS-ABEND         TO TRUE                     21080000
210900         SET DP013-NO-ROLLBACK        TO TRUE                     21090000
211000         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          21100000
211100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         21110000
211200                                      TO DP013-MESSAGE-TEXT (1)   21120000
211300         PERFORM DP013-0000-PROCESS-ABEND                         21130000
211400     END-IF.                                                      21140000
211500                                                                  21150000
211600*----------------------------------------------------------------*21160000
211700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *21170000
211800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *21180000
211900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *21190000
212000*    THE TEMP QUEUE.                                             *21200000
212100*----------------------------------------------------------------*21210000
212200 6100-UPDATE-TSQ.                                                 21220000
212300                                                                  21230000
212400     ADD 1 TO ASC-SEL-ITEM.                                       21240000
212500     PERFORM 6105-READ-SEL-QUEUE.                                 21250000
212600                                                                  21260000
212700     PERFORM                                                      21270000
212800       VARYING RC013-IDX FROM 1 BY 1                              21280000
212900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     21290000
213000            OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))          21300000
213100                                                                  21310000
213200         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   21320000
213300             PERFORM 6110-PROCESS-ITEMS                           21330000
213400         END-IF                                                   21340000
213500                                                                  21350000
213600         ADD +1 TO PV-ITEMS-PROCESSED                             21360000
213700                                                                  21370000
213800     END-PERFORM.                                                 21380000
213900                                                                  21390000
214000     PERFORM 6111-WRITE-LIST-QUEUE.                               21400000
214100                                                                  21410000
214200*----------------------------------------------------------------*21420000
214300*    READ THE LIST QUEUE RECORD.                                 *21430000
214400*----------------------------------------------------------------*21440000
214500 6105-READ-SEL-QUEUE.                                             21450000
214600                                                                  21460000
214700     EXEC CICS                                                    21470000
214800          READQ TS                                                21480000
214900              QUEUE (ASC-SEL-QUEUE-NAME)                          21490000
215000              INTO  (RC013-DC-SELECT-RECORD)                      21500000
215100              ITEM  (ASC-SEL-ITEM)                                21510000
215200              RESP  (PV-CICS-RESP)                                21520000
215300     END-EXEC.                                                    21530000
215400                                                                  21540000
215500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           21550000
215600         CONTINUE                                                 21560000
215700     ELSE                                                         21570000
215800         SET DP013-CICS-ABEND       TO TRUE                       21580000
215900         SET DP013-NO-ROLLBACK      TO TRUE                       21590000
216000         MOVE '6105-READ-SEL-QUEUE' TO DP013-PARAGRAPH            21600000
216100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           21610000
216200                                    TO DP013-MESSAGE-TEXT(1)      21620000
216300         PERFORM DP013-0000-PROCESS-ABEND                         21630000
216400     END-IF.                                                      21640000
216500                                                                  21650000
216600*----------------------------------------------------------------*21660000
216700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*21670000
216800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*21680000
216900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *21690000
217000*----------------------------------------------------------------*21700000
217100 6110-PROCESS-ITEMS.                                              21710000
217200                                                                  21720000
217300     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          21730000
217400                     / PC-ITEMS-PER-PANEL).                       21740000
217500                                                                  21750000
217600     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            21760000
217700         IF PV-SAVE-ITEM NOT EQUAL ZERO                           21770000
217800             PERFORM 6111-WRITE-LIST-QUEUE                        21780000
217900         END-IF                                                   21790000
218000         MOVE PV-ITEM TO PV-SAVE-ITEM                             21800000
218100                                                                  21810000
218200         PERFORM 6112-READ-LIST-QUEUE                             21820000
218300         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                21830000
218400             CONTINUE                                             21840000
218500         END-IF                                                   21850000
218600     END-IF.                                                      21860000
218700                                                                  21870000
218800     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     21880000
218900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              21890000
219000                                                                  21900000
219100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       21910000
219200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        21920000
219300                                     (PV-SUB).                    21930000
219400                                                                  21940000
219500***  EVALUATE TRUE                                                21950000
219600***      WHEN RC801-INQ (RC801-IDX)                               21960000
219700***           MOVE PC-INQ TO LQW-ACTION (PV-SUB)                  21970000
219800***                                                               21980000
219900***      WHEN RC801-UPD (RC801-IDX)                               21990000
220000***           MOVE PC-UPD TO LQW-ACTION (PV-SUB)                  22000000
220100***                                                               22010000
220200***      WHEN RC801-DEL (RC801-IDX)                               22020000
220300***           MOVE PC-DEL TO LQW-ACTION (PV-SUB)                  22030000
220400***                                                               22040000
220500***      WHEN RC801-ERR (RC801-IDX)                               22050000
220600***           MOVE PC-ERR TO LQW-ACTION (PV-SUB)                  22060000
220700***  END-EVALUATE.                                                22070000
220800                                                                  22080000
220900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                22090000
221000                                                                  22100000
221100*----------------------------------------------------------------*22110000
221200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *22120000
221300*----------------------------------------------------------------*22130000
221400 6111-WRITE-LIST-QUEUE.                                           22140000
221500                                                                  22150000
221600     EXEC CICS                                                    22160000
221700         WRITEQ TS                                                22170000
221800             QUEUE (ASC-LIST-QUEUE-NAME)                          22180000
221900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     22190000
222000             ITEM  (PV-SAVE-ITEM)                                 22200000
222100             REWRITE                                              22210000
222200             RESP  (PV-CICS-RESP)                                 22220000
222300     END-EXEC.                                                    22230000
222400                                                                  22240000
222500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22250000
222600         CONTINUE                                                 22260000
222700     ELSE                                                         22270000
222800         SET DP013-CICS-ABEND      TO TRUE                        22280000
222900         SET DP013-NO-ROLLBACK     TO TRUE                        22290000
223000         MOVE '6111-WRITE-LIST-QUEUE'                             22300000
223100                                   TO DP013-PARAGRAPH             22310000
223200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  22320000
223300                                   TO DP013-MESSAGE-TEXT(1)       22330000
223400         PERFORM DP013-0000-PROCESS-ABEND                         22340000
223500     END-IF.                                                      22350000
223600                                                                  22360000
223700*----------------------------------------------------------------*22370000
223800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*22380000
223900*----------------------------------------------------------------*22390000
224000 6112-READ-LIST-QUEUE.                                            22400000
224100                                                                  22410000
224200     EXEC CICS                                                    22420000
224300         READQ TS                                                 22430000
224400             QUEUE (ASC-LIST-QUEUE-NAME)                          22440000
224500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     22450000
224600             ITEM  (PV-ITEM)                                      22460000
224700             RESP  (PV-CICS-RESP)                                 22470000
224800     END-EXEC.                                                    22480000
224900                                                                  22490000
225000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22500000
225100         CONTINUE                                                 22510000
225200     ELSE                                                         22520000
225300         SET DP013-CICS-ABEND      TO TRUE                        22530000
225400         SET DP013-NO-ROLLBACK     TO TRUE                        22540000
225500         MOVE '6112-READ-LIST-QUEUE'                              22550000
225600                                   TO DP013-PARAGRAPH             22560000
225700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    22570000
225800                                   TO DP013-MESSAGE-TEXT(1)       22580000
225900         PERFORM DP013-0000-PROCESS-ABEND                         22590000
226000     END-IF.                                                      22600000
226100                                                                  22610000
226200*----------------------------------------------------------------*22620000
226300*----------------------------------------------------------------*22630000
226400 7000-GET-DEPT.                                                   22640000
226500                                                                  22650000
226600     EXEC SQL                                                     22660000
226700         SELECT DEPT_NBR                                          22670000
226800           INTO :PURCHS-DEPT-NBR                                  22680000
226900           FROM TPURCHS A                                         22690000
227000          WHERE A.PO_NBR = :DK-ORD-NBR                            22700000
227100            AND A.VER_STATUS_CDE = 'A'                            22710000
227200     END-EXEC.                                                    22720000
227300                                                                  22730000
227400     EVALUATE TRUE                                                22740000
227500         WHEN SQLCODE = ZERO                                      22750000
227600         WHEN SQLCODE = +100                                      22760000
227700             CONTINUE                                             22770000
227800                                                                  22780000
227900         WHEN SQLCODE = -904                                      22790000
228000         WHEN SQLCODE = -911                                      22800000
228100         WHEN SQLCODE = -913                                      22810000
228200             PERFORM 9900-SOFT-ABORT                              22820000
228300                                                                  22830000
228400         WHEN SQLWARN0 NOT = SPACE                                22840000
228500         WHEN SQLCODE < ZERO                                      22850000
228600         WHEN SQLCODE > ZERO                                      22860000
228700             MOVE '7000-GET-DEPT' TO DP013-PARAGRAPH              22870000
228800             MOVE 'SELECT DEPT NUMBER'                            22880000
228900                                  TO DP013-MESSAGE-TEXT (1)       22890000
229000             MOVE SQLCA           TO DP013-SQLCA                  22900000
229100             MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)     22910000
229200             SET DP013-DB2-ABEND  TO TRUE                         22920000
229300             PERFORM DP013-0000-PROCESS-ABEND                     22930000
229400     END-EVALUATE.                                                22940000
229500                                                                  22950000
229600*----------------------------------------------------------------*22960000
229700 7100-GET-PREPK-ID.                                               22970000
229800                                                                  22980000
229900     EXEC SQL                                                     22990000
230000         SELECT A.PREPK_ID                                        23000050
230100              , A.PREPK_RATO_QTY                                  23010050
230110              , B.PK_SKU_NBR                                      23011050
230200           INTO :RECITM-PREPK-ID                                  23020000
230300              , :RECITM-PREPK-RATO-QTY                            23030000
230310              , :POPRPK-PK-SKU-NBR                                23031050
230400           FROM TRECITM A                                         23040050
230410              , TPOPRPK B                                         23041050
230500          WHERE A.ORD_NBR          =  :DK-ORD-NBR                 23050050
230510            AND A.ORD_NBR          =  B.PO_NBR                    23051050
230600            AND A.REC_SEQ_NBR      =  :DK-RCVR-NBR                23060050
230700            AND A.ORD_LNE_NBR      =  :DK-LINE-NBR                23070050
230800            AND A.VER_STATUS_CDE   =  'A'                         23080050
230810            AND A.PREPK_ID         =  B.PO_PREPK_ID               23081050
230900     END-EXEC.                                                    23090000
231000                                                                  23100000
231100     EVALUATE TRUE                                                23110000
231200         WHEN SQLCODE = ZERO                                      23120000
231300             CONTINUE                                             23130000
231400                                                                  23140000
231500         WHEN SQLCODE = +100                                      23150000
231600             MOVE +0 TO RECITM-PREPK-ID                           23160000
231700                        RECITM-PREPK-RATO-QTY                     23170000
231800                                                                  23180000
231900         WHEN SQLCODE = -904                                      23190000
232000         WHEN SQLCODE = -911                                      23200000
232100         WHEN SQLCODE = -913                                      23210000
232200             PERFORM 9900-SOFT-ABORT                              23220000
232300                                                                  23230000
232400         WHEN SQLWARN0 NOT = SPACES                               23240000
232500         WHEN SQLCODE < ZERO                                      23250000
232600         WHEN SQLCODE > ZERO                                      23260000
232700             MOVE '7100-GET-PREPK-ID' TO DP013-PARAGRAPH          23270000
232800             MOVE 'UNSUCCESSFUL SELECT FOR PREPK-ID  '            23280000
232900                             TO DP013-MESSAGE-TEXT (1)            23290000
233000             MOVE SQLCA      TO DP013-SQLCA                       23300000
233100             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          23310000
233200             SET DP013-DB2-ABEND                                  23320000
233300                 DP013-NO-ROLLBACK TO TRUE                        23330000
233400             PERFORM DP013-0000-PROCESS-ABEND                     23340000
233500                                                                  23350000
233600     END-EVALUATE.                                                23360000
233700                                                                  23370000
233800*----------------------------------------------------------------*23380000
233900 7200-GET-RECEIV-STATUS.                                          23390000
234000                                                                  23400000
234100     EXEC SQL                                                     23410000
234200         SELECT STATUS_CDE                                        23420000
234300              , PKGNG_CDE                                         23430000
234400              , OPER_UNT_ID                                       23440000
234500           INTO :RECEIV-STATUS-CDE                                23450000
234600              , :RECEIV-PKGNG-CDE                                 23460000
234700              , :ASC-RCVR-OPER-UNT-ID                             23470000
234800           FROM TRECEIV A                                         23480000
234900          WHERE A.ORD_NBR        = :DK-ORD-NBR                    23490000
235000            AND A.REC_SEQ_NBR    = :DK-RCVR-NBR                   23500000
235100            AND A.VER_STATUS_CDE = 'A'                            23510000
235200     END-EXEC.                                                    23520000
235300                                                                  23530000
235400     EVALUATE TRUE                                                23540000
235500         WHEN SQLCODE = ZERO                                      23550000
235600             MOVE RECEIV-PKGNG-CDE TO ASC-PKGNG-CDE               23560000
235700                                      ASC-PKGNG-CDE-DISPLAY       23570000
235800                                                                  23580000
235900         WHEN SQLCODE = +100                                      23590000
236000             CONTINUE                                             23600000
236100                                                                  23610000
236200         WHEN SQLCODE = -904                                      23620000
236300         WHEN SQLCODE = -911                                      23630000
236400         WHEN SQLCODE = -913                                      23640000
236500             PERFORM 9900-SOFT-ABORT                              23650000
236600                                                                  23660000
236700         WHEN SQLWARN0 NOT = SPACE                                23670000
236800         WHEN SQLCODE < ZERO                                      23680000
236900         WHEN SQLCODE > ZERO                                      23690000
237000             MOVE '7200-GET-RECEIV-STATUS'                        23700000
237100                                  TO DP013-PARAGRAPH              23710000
237200             MOVE 'SELECT RCVR STATUS'                            23720000
237300                                  TO DP013-MESSAGE-TEXT (1)       23730000
237400             MOVE SQLCA           TO DP013-SQLCA                  23740000
237500             MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)     23750000
237600             SET DP013-DB2-ABEND  TO TRUE                         23760000
237700             PERFORM DP013-0000-PROCESS-ABEND                     23770000
237800     END-EVALUATE.                                                23780000
237900                                                                  23790000
238010*----------------------------------------------------------------*23801000
238020* INCLUDED NEW VARIABLE ITM_NBR.                     WR # 21361  *23802000
238030* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *23803000
238040* TO TRUE.                                                       *23804000
238050*----------------------------------------------------------------*23805000
238100 7300-GET-SKU.                                                    23810000
238200                                                                  23820000
238210     SET PS-CALL-API-NO      TO TRUE.                             23821000
238220                                                                  23822000
238300     EXEC SQL                                                     23830000
238400         SELECT B.CL_NBR                                          23840000
238500              , B.SKU_SEQ_NBR                                     23850000
238510              , B.ITM_NBR                                         23851000
238600              , A.STATUS_CDE                                      23860000
238700           INTO :PURITM-CL-NBR                                    23870000
238800              , :PURITM-SKU-SEQ-NBR                               23880000
238810              , :PURITM-ITM-NBR                                   23881000
238900              , :RECITM-STATUS-CDE                                23890000
239000           FROM TRECITM A                                         23900000
239100              , TPURITM B                                         23910000
239200          WHERE A.ORD_NBR          = :DK-ORD-NBR                  23920000
239300            AND A.ORD_NBR          = B.PO_NBR                     23930000
239400            AND A.REC_SEQ_NBR      = :DK-RCVR-NBR                 23940000
239500            AND A.ORD_LNE_NBR      = :DK-LINE-NBR                 23950000
239600            AND A.ORD_LNE_NBR      = B.APP_PO_LNE_NBR             23960000
239700            AND A.VER_STATUS_CDE   = 'A'                          23970000
239800            AND A.PO_VER_NBR       = B.VER_NBR                    23980000
239900     END-EXEC.                                                    23990000
240000                                                                  24000000
240100     EVALUATE TRUE                                                24010000
240200         WHEN SQLCODE = ZERO                                      24020000
240210             SET PS-CALL-API-YES     TO TRUE                      24021000
240300         WHEN SQLCODE = +100                                      24030000
240400         WHEN SQLCODE = -305                                      24040000
240500             CONTINUE                                             24050000
240600                                                                  24060000
240700         WHEN SQLCODE = -904                                      24070000
240800         WHEN SQLCODE = -911                                      24080000
240900         WHEN SQLCODE = -913                                      24090000
241000             PERFORM 9900-SOFT-ABORT                              24100000
241100                                                                  24110000
241200         WHEN SQLWARN0 NOT = SPACES                               24120000
241300         WHEN SQLCODE < ZERO                                      24130000
241400         WHEN SQLCODE > ZERO                                      24140000
241500             MOVE '7300-GET-SKU'   TO DP013-PARAGRAPH             24150000
241600             MOVE 'UNSUCCESSFUL RETRIEVAL OF SKU'                 24160000
241700                                   TO DP013-MESSAGE-TEXT (1)      24170000
241800             MOVE SQLCA            TO DP013-SQLCA                 24180000
241900             MOVE 'TRECITM '       TO DP013-DB2-TABLE-NAME (1)    24190000
242000             SET DP013-DB2-ABEND                                  24200000
242100                 DP013-NO-ROLLBACK TO TRUE                        24210000
242200             PERFORM DP013-0000-PROCESS-ABEND                     24220000
242300     END-EVALUATE.                                                24230000
242400                                                                  24240000
242410*----------------------------------------------------------------*24241000
242420* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *24242000
242430*----------------------------------------------------------------*24243000
242440                                                                  24244000
242500*----------------------------------------------------------------*24250000
242501*                                               **   WR # 21361  *24250100
242502*  ADDED NEW PARAGRAPH TO INCLUDE XLKUT001 LOGIC                 *24250200
242503*----------------------------------------------------------------*24250300
242504                                                                  24250400
242505 7310-CALL-XLKUT-DOMAIN-PGM.                                      24250500
242510     INITIALIZE XL001-ITEM-COMMAREA                               24251000
242520     MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR                   24252000
242530                                                                  24253000
242540     SET  XL001-BY-ITEM                                           24254000
242550          XL001-SELECT-SKU TO TRUE                                24255000
242560                                                                  24256000
242570     CALL XL001-VSM-PGM USING  DFHEIBLK                           24257000
242580                               XL001-COMMAREA                     24258000
242590                               XL001-ITEM-COMMAREA                24259000
242591                                                                  24259100
242592     EVALUATE TRUE                                                24259200
242593                                                                  24259300
242594          WHEN XL001-SKU-SQLCODE = +0                             24259400
242595               MOVE XL001-SKU-NBR                                 24259500
242596                      TO PV-TEMP-SKU                              24259600
242597               MOVE PV-TEMP-SKU                                   24259700
242598                      TO PV-SKU                                   24259800
242599                                                                  24259900
242600          WHEN XL001-SKU-SQLCODE = +100                           24260000
242601               MOVE SPACES                                        24260100
242602                      TO PV-SKU                                   24260200
242603                                                                  24260300
242604          WHEN XL001-SKU-CONTENTION                               24260400
242605               PERFORM 9900-SOFT-ABORT                            24260500
242612                                                                  24261200
242613          WHEN OTHER                                              24261300
242614               MOVE '7310-CALL-XLKUT-DOMAIN-PGM'                  24261400
242615                                  TO DP013-PARAGRAPH              24261500
242616               MOVE 'INVALID RETURN'                              24261600
242617                                  TO DP013-MESSAGE-TEXT (1)       24261700
242618               MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)       24261844
242619               MOVE XL001-SQLCA   TO DP013-SQLCA                  24261900
242620               SET DP013-DB2-ABEND                                24262000
242621                                  TO TRUE                         24262100
242622               PERFORM DP013-0000-PROCESS-ABEND                   24262200
242623          END-EVALUATE.                                           24262300
242624                                                                  24262400
242625*----------------------------------------------------------------*24262500
242626* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *24262600
242627*----------------------------------------------------------------*24262700
242628                                                                  24262800
242630 7400-GET-STORE-NAME.                                             24263000
242700                                                                  24270000
242701     INITIALIZE  XL071-COMMAREA-REC.                              24270159
242702     MOVE ASC-STORE-NBR  TO  XL071-LOCATION-NUMBER                24270224
242703                                                                  24270324
242704     CALL XL071-LOCATION-MODULE USING                             24270424
242705          DFHEIBLK                                                24270524
242706          XL071-COMMAREA                                          24270624
242707          XL071-COMMAREA-REC.                                     24270724
242708                                                                  24270800
242709     EVALUATE TRUE                                                24270924
242710         WHEN XL071-NO-ERRORS                                     24271024
243700             MOVE XL071-LOC-NM  TO ASC-STORE-NAME                 24370000
243701                                                                  24370159
243702         WHEN XL071-LOC-NOT-FOUND                                 24370224
244000             MOVE 'STORE NOT FOUND'  TO ASC-STORE-NAME            24400000
244001                                                                  24400159
244002         WHEN XL071-BAD-DB2-RETURN                                24400224
244200              IF XL071-SQLCODE-N = -904 OR -911 OR -913           24420000
244500                 PERFORM 9900-SOFT-ABORT                          24450000
244501             ELSE                                                 24450159
244502                 INITIALIZE PV-CICS-MSG-AREA                      24450224
244503                 STRING 'RCKCS813-CALL XLKUT071 - '               24450324
244504                     'SQLCODE=' XL071-SQLCODE                     24450427
244505                     '  TABLE-' XL071-DB2-TABLE DELIMITED BY SIZE 24450524
244506                                        INTO PV-CICS-MSG-AREA     24450624
244507                 MOVE LENGTH OF PV-CICS-MSG-AREA                  24450724
244508                                          TO PV-COMMAREA-LENGTH   24450824
244509                 PERFORM 9200-WRITE-TO-CICS-LOG                   24450924
245500                 MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1) 24550000
245510                 MOVE XL071-SQLCODE-N TO SQLCODE                  24551059
245600                 SET DP013-DB2-ABEND  TO TRUE                     24560000
245700                 PERFORM DP013-0000-PROCESS-ABEND                 24570000
245701             END-IF                                               24570159
245702     END-EVALUATE.                                                24570224
245703/                                                                 24570324
246001*----------------------------------------------------------------*24600100
246002*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *24600200
246003*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *24600300
246004*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *24600400
246005*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *24600500
246006*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *24600600
246007*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *24600700
246008*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *24600800
246009*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *24600900
246010*----------------------------------------------------------------*24601000
246011 7750-DISTHD-PURITM-JOIN.                                         24601100
246012                                                                  24601200
246013     EXEC SQL                                                     24601300
246014     SELECT A.FCSE_CNFRMN_TMST,                                   24601400
246015            C.UNT_RTL_PR_AMT,                                     24601500
246016            A.OPER_UNT_ID,                                        24601600
246017            A.FCSE_FCLTY_AREA_ID                                  24601700
246018         INTO :PV-DISTHD-FCSE-CNFRMN-TMST                         24601800
246019         ,    :PURITM-UNT-RTL-PR-AMT                              24601900
246020         ,    :PV-DISTHD-OPER-UNT-ID                              24602000
246021         ,    :PV-DISTHD-FCSE-FCLTY-AREA-ID                       24602100
246022         FROM                                                     24602200
246023             TDISTHD A                                            24602300
246024         ,   TRECITM B                                            24602400
246025         ,   TPURITM C                                            24602500
246026         WHERE A.ORD_NBR          = :DK-ORD-NBR                   24602600
246027           AND A.RCVR_SEQ_NBR     = :DK-RCVR-NBR                  24602700
246028           AND A.ORD_LNE_NBR      = :DK-LINE-NBR                  24602800
246029           AND B.ORD_NBR          = A.ORD_NBR                     24602900
246030           AND B.REC_SEQ_NBR      = A.RCVR_SEQ_NBR                24603000
246031           AND B.ORD_LNE_NBR      = A.ORD_LNE_NBR                 24603100
246032           AND C.PO_NBR           = B.ORD_NBR                     24603200
246033           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 24603300
246034           AND C.VER_NBR          = B.PO_VER_NBR                  24603400
246035     END-EXEC.                                                    24603500
246036*                                                                 24603600
246037     EVALUATE TRUE                                                24603700
246038         WHEN SQLCODE = ZERO                                      24603800
246039             CONTINUE                                             24603900
246040         WHEN SQLCODE = -904                                      24604000
246041         WHEN SQLCODE = -911                                      24604100
246042         WHEN SQLCODE = -913                                      24604200
246043             PERFORM 9900-SOFT-ABORT                              24604300
246044                                                                  24604400
246045         WHEN SQLWARN0 NOT = SPACES                               24604500
246046         WHEN SQLCODE < ZERO                                      24604600
246047         WHEN SQLCODE > ZERO                                      24604700
246048             MOVE '7750-DISTHD-PURITM-JOIN'                       24604800
246049                                  TO DP013-PARAGRAPH              24604900
246050             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 24605000
246051                                  TO DP013-MESSAGE-TEXT (1)       24605100
246052             MOVE SQLCA      TO DP013-SQLCA                       24605200
246053             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          24605300
246054             SET DP013-DB2-ABEND                                  24605400
246055                 DP013-NO-ROLLBACK                                24605500
246056                                  TO TRUE                         24605600
246057             PERFORM DP013-0000-PROCESS-ABEND                     24605700
246058     END-EVALUATE.                                                24605800
246059                                                                  24605900
246061*----------------------------------------------------------------*24606100
246062* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *24606200
246063* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *24606300
246064* THE RESULTS RETURNED FROM THE ROUTINE.                         *24606400
246065*----------------------------------------------------------------*24606500
246066 7800-UNITS-WORK-ROUTINE.                                         24606600
246067                                                                  24606700
246068     INITIALIZE PC238-COMM-AREA.                                  24606800
246069                                                                  24606900
246070     EXEC SQL                                                     24607000
246071         SET :PV-TMST =  CURRENT_TIMESTAMP                        24607100
246080     END-EXEC                                                     24608000
246090                                                                  24609000
246091     MOVE PV-TMST                 TO PC238-WRKD-TMST.             24609100
246092                                                                  24609200
246093     MOVE PV-DISTHD-OPER-UNT-ID   TO PC238-WRKD-OPER-UNT-ID.      24609300
246094     MOVE PV-DISTHD-FCSE-FCLTY-AREA-ID                            24609400
246095                                  TO PC238-PRCG-AREA-CDE.         24609500
246096     MOVE DK-ORD-NBR              TO PC238-PO-NBR.                24609600
246097     MOVE DK-RCVR-NBR             TO PC238-RCVR-SEQ-NBR.          24609700
246098     MOVE DK-LINE-NBR             TO PC238-PO-LNE-NBR.            24609800
246099                                                                  24609900
246100     MOVE PA-UPDATE-DIFF-QTY      TO PC238-WRKD-UNT-QTY.          24610000
246101     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        24610100
246102     SET  PC238-TRANS-CONFIRM-ADJ TO TRUE.                        24610200
246103     SET  PC238-NOT-VERIFY        TO TRUE.                        24610300
246104                                                                  24610400
246105************************************************                  24610500
246106*                                                                 24610600
246107*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    24610700
246108*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  24610800
246109*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  24610900
246110*    MOVE PC238-WRKD-OPER-UNT-ID                                  24611000
246111*                            TO PC-DISPLAY-OPER.                  24611100
246112*    STRING ' RCKCS298 - '      DELIMITED BY SIZE                 24611200
246113*           ' CALLING PCKCS756 WITH KEY INFO - '                  24611300
246114*                               DELIMITED BY SIZE                 24611400
246115*           PC-DISPLAY-PO       DELIMITED BY SIZE                 24611500
246116*           ' - '               DELIMITED BY SIZE                 24611600
246117*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 24611700
246118*           ' - '               DELIMITED BY SIZE                 24611800
246119*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 24611900
246120*           ' - '               DELIMITED BY SIZE                 24612000
246121*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 24612100
246122*                        INTO PV-CICS-MSG-AREA.                   24612200
246123*    MOVE LENGTH OF PV-CICS-MSG-AREA                              24612300
246124*                          TO PV-COMMAREA-LENGTH.                 24612400
246125*    PERFORM 9200-WRITE-TO-CICS-LOG.                              24612500
246126*                                                                 24612600
246127************************************************                  24612700
246128                                                                  24612800
246129     MOVE LENGTH OF PC238-COMM-AREA                               24612900
246130                                  TO PV-COMMAREA-LENGTH.          24613000
246131                                                                  24613100
246132     EXEC CICS                                                    24613200
246133         LINK PROGRAM  (PV-PCKCS756)                              24613300
246134              COMMAREA (PC238-COMM-AREA)                          24613400
246135              LENGTH   (PV-COMMAREA-LENGTH)                       24613500
246136              RESP     (PV-CICS-RESPONSE)                         24613600
246137     END-EXEC.                                                    24613700
246138                                                                  24613800
246139************************************************                  24613900
246140*                                                                 24614000
246141*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    24614100
246142*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  24614200
246143*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  24614300
246144*    MOVE PC238-WRKD-OPER-UNT-ID                                  24614400
246145*                            TO PC-DISPLAY-OPER.                  24614500
246146*    STRING ' RCKCS298 - '      DELIMITED BY SIZE                 24614600
246147*           ' RETURN FROM PCKCS756 - '                            24614700
246148*                               DELIMITED BY SIZE                 24614800
246149*           PC-DISPLAY-PO       DELIMITED BY SIZE                 24614900
246150*           ' - '               DELIMITED BY SIZE                 24615000
246151*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 24615100
246152*           ' - '               DELIMITED BY SIZE                 24615200
246153*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 24615300
246154*           ' - '               DELIMITED BY SIZE                 24615400
246155*           PC238-MOD-SUCCESS-CDE                                 24615500
246156*                               DELIMITED BY SIZE                 24615600
246157*           ' - '               DELIMITED BY SIZE                 24615700
246158*           PC238-UNSUCCESSFUL-CDE                                24615800
246159*                               DELIMITED BY SIZE                 24615900
246160*                        INTO PV-CICS-MSG-AREA.                   24616000
246161*    MOVE LENGTH OF PV-CICS-MSG-AREA                              24616100
246162*                          TO PV-COMMAREA-LENGTH.                 24616200
246163*    PERFORM 9200-WRITE-TO-CICS-LOG.                              24616300
246164*                                                                 24616400
246165************************************************                  24616500
246166                                                                  24616600
246167     EVALUATE TRUE                                                24616700
246168         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 24616800
246169              IF  PC238-MOD-UNSUCCESSFUL                          24616900
246170                  PERFORM 7810-MOD-UNSUCCESSFUL                   24617000
246171              END-IF                                              24617100
246172         WHEN OTHER                                               24617200
246173              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            24617300
246174              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          24617400
246175              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          24617500
246176              MOVE PC238-WRKD-OPER-UNT-ID                         24617600
246177                                      TO PC-DISPLAY-OPER          24617700
246178              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      24617800
246179              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     24617900
246180              SET PS-UNITS-WORKED-ERROR  TO TRUE                  24618000
246181              STRING ' RCKCS298 - '      DELIMITED BY SIZE        24618100
246182                     ' 7800-UNITS-WORK-ROUTINE '                  24618200
246183                                         DELIMITED BY SIZE        24618300
246184                     ' BAD CALL TO UNITS WORKED MODULE '          24618400
246185                                         DELIMITED BY SIZE        24618500
246186                     ' - CICS RESP '                              24618600
246187                                         DELIMITED BY SIZE        24618700
246188                     PC-DISPLAY-CICS-RESP                         24618800
246189                                         DELIMITED BY SIZE        24618900
246190                                      INTO PV-CICS-MSG-AREA       24619000
246191              MOVE LENGTH OF PV-CICS-MSG-AREA                     24619100
246192                                        TO PV-COMMAREA-LENGTH     24619200
246193              PERFORM 9200-WRITE-TO-CICS-LOG                      24619300
246194              MOVE SPACES TO PV-CICS-MSG-AREA                     24619400
246195              STRING ' RCKCS298 - '      DELIMITED BY SIZE        24619500
246196                     ' 7800-UNITS-WORK-ROUTINE '                  24619600
246197                                         DELIMITED BY SIZE        24619700
246198                     ' KEY INFO - '      DELIMITED BY SIZE        24619800
246199                     PC-DISPLAY-PO       DELIMITED BY SIZE        24619900
246200                     ' - '               DELIMITED BY SIZE        24620000
246201                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        24620100
246202                     ' - '               DELIMITED BY SIZE        24620200
246203                     PC-DISPLAY-LINE     DELIMITED BY SIZE        24620300
246204                                  INTO PV-CICS-MSG-AREA           24620400
246205              MOVE LENGTH OF PV-CICS-MSG-AREA                     24620500
246206                                    TO PV-COMMAREA-LENGTH         24620600
246207              PERFORM 9200-WRITE-TO-CICS-LOG                      24620700
246208              PERFORM 9900-SOFT-ABORT                             24620800
246209     END-EVALUATE.                                                24620900
246210                                                                  24621000
246212*----------------------------------------------------------------*24621200
246213* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *24621300
246214* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *24621400
246215* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *24621500
246216* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *24621600
246217*----------------------------------------------------------------*24621700
246218 7810-MOD-UNSUCCESSFUL.                                           24621800
246219                                                                  24621900
246220     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             24622000
246221     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           24622100
246222     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           24622200
246223     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           24622300
246224     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       24622400
246225     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      24622500
246226                                                                  24622600
246227     IF  PC238-MOD-BAD-TMST                                       24622700
246228         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24622800
246229                ' 7800-UNITS-WORK-ROUTINE '                       24622900
246230                                    DELIMITED BY SIZE             24623000
246231                ' BAD TIMESTAMP '   DELIMITED BY SIZE             24623100
246232                PC238-WRKD-TMST     DELIMITED BY SIZE             24623200
246233                             INTO PV-CICS-MSG-AREA                24623300
246234         MOVE LENGTH OF PV-CICS-MSG-AREA                          24623400
246235                               TO PV-COMMAREA-LENGTH              24623500
246236         PERFORM 9200-WRITE-TO-CICS-LOG                           24623600
246237         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24623700
246238                ' 7800-UNITS-WORK-ROUTINE '                       24623800
246239                                    DELIMITED BY SIZE             24623900
246240                ' KEY INFO - '      DELIMITED BY SIZE             24624000
246241                PC-DISPLAY-PO       DELIMITED BY SIZE             24624100
246242                ' - '               DELIMITED BY SIZE             24624200
246243                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24624300
246244                ' - '               DELIMITED BY SIZE             24624400
246245                PC-DISPLAY-LINE     DELIMITED BY SIZE             24624500
246246                             INTO PV-CICS-MSG-AREA                24624600
246247         MOVE LENGTH OF PV-CICS-MSG-AREA                          24624700
246248                               TO PV-COMMAREA-LENGTH              24624800
246249         PERFORM 9200-WRITE-TO-CICS-LOG                           24624900
246250         PERFORM 9900-SOFT-ABORT                                  24625000
246251     ELSE                                                         24625100
246252     IF  PC238-MOD-BAD-OPER                                       24625200
246253         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24625300
246254                ' 7800-UNITS-WORK-ROUTINE '                       24625400
246255                                    DELIMITED BY SIZE             24625500
246256                ' BAD OPER UNIT '   DELIMITED BY SIZE             24625600
246257                PC-DISPLAY-OPER     DELIMITED BY SIZE             24625700
246258                             INTO PV-CICS-MSG-AREA                24625800
246259         MOVE LENGTH OF PV-CICS-MSG-AREA                          24625900
246260                               TO PV-COMMAREA-LENGTH              24626000
246261         PERFORM 9200-WRITE-TO-CICS-LOG                           24626100
246262         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24626200
246263                ' 7800-UNITS-WORK-ROUTINE '                       24626300
246264                                    DELIMITED BY SIZE             24626400
246265                ' KEY INFO - '      DELIMITED BY SIZE             24626500
246266                PC-DISPLAY-PO       DELIMITED BY SIZE             24626600
246267                ' - '               DELIMITED BY SIZE             24626700
246268                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24626800
246269                ' - '               DELIMITED BY SIZE             24626900
246270                PC-DISPLAY-LINE     DELIMITED BY SIZE             24627000
246271                             INTO PV-CICS-MSG-AREA                24627100
246272         MOVE LENGTH OF PV-CICS-MSG-AREA                          24627200
246273                               TO PV-COMMAREA-LENGTH              24627300
246274         PERFORM 9200-WRITE-TO-CICS-LOG                           24627400
246275         PERFORM 9900-SOFT-ABORT                                  24627500
246276     ELSE                                                         24627600
246277     IF  PC238-MOD-BAD-TRANS-TYPE                                 24627700
246278         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24627800
246279                ' 7800-UNITS-WORK-ROUTINE '                       24627900
246280                                    DELIMITED BY SIZE             24628000
246281                ' BAD TRAN TYPE '   DELIMITED BY SIZE             24628100
246282                PC238-TRANS-TYPE-CDE                              24628200
246283                                    DELIMITED BY SIZE             24628300
246284                             INTO PV-CICS-MSG-AREA                24628400
246285         MOVE LENGTH OF PV-CICS-MSG-AREA                          24628500
246286                               TO PV-COMMAREA-LENGTH              24628600
246287         PERFORM 9200-WRITE-TO-CICS-LOG                           24628700
246288         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24628800
246289                ' 7800-UNITS-WORK-ROUTINE '                       24628900
246290                                    DELIMITED BY SIZE             24629000
246291                ' KEY INFO - '      DELIMITED BY SIZE             24629100
246292                PC-DISPLAY-PO       DELIMITED BY SIZE             24629200
246293                ' - '               DELIMITED BY SIZE             24629300
246294                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24629400
246295                ' - '               DELIMITED BY SIZE             24629500
246296                PC-DISPLAY-LINE     DELIMITED BY SIZE             24629600
246297                             INTO PV-CICS-MSG-AREA                24629700
246298         MOVE LENGTH OF PV-CICS-MSG-AREA                          24629800
246299                               TO PV-COMMAREA-LENGTH              24629900
246300         PERFORM 9200-WRITE-TO-CICS-LOG                           24630000
246301         PERFORM 9900-SOFT-ABORT                                  24630100
246302     ELSE                                                         24630200
246303     IF  PC238-MOD-BAD-PO                                         24630300
246304         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24630400
246305                ' 7800-UNITS-WORK-ROUTINE '                       24630500
246306                                    DELIMITED BY SIZE             24630600
246307                ' BAD PO NUMBER '   DELIMITED BY SIZE             24630700
246308                PC-DISPLAY-PO       DELIMITED BY SIZE             24630800
246309                             INTO PV-CICS-MSG-AREA                24630900
246310         MOVE LENGTH OF PV-CICS-MSG-AREA                          24631000
246311                               TO PV-COMMAREA-LENGTH              24631100
246312         PERFORM 9200-WRITE-TO-CICS-LOG                           24631200
246313         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24631300
246314                ' 7800-UNITS-WORK-ROUTINE '                       24631400
246315                                    DELIMITED BY SIZE             24631500
246316                ' KEY INFO - '      DELIMITED BY SIZE             24631600
246317                PC-DISPLAY-PO       DELIMITED BY SIZE             24631700
246318                ' - '               DELIMITED BY SIZE             24631800
246319                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24631900
246320                ' - '               DELIMITED BY SIZE             24632000
246321                PC-DISPLAY-LINE     DELIMITED BY SIZE             24632100
246322                             INTO PV-CICS-MSG-AREA                24632200
246323         MOVE LENGTH OF PV-CICS-MSG-AREA                          24632300
246324                               TO PV-COMMAREA-LENGTH              24632400
246325         PERFORM 9200-WRITE-TO-CICS-LOG                           24632500
246326         PERFORM 9900-SOFT-ABORT                                  24632600
246327     ELSE                                                         24632700
246328     IF  PC238-MOD-BAD-RCVR                                       24632800
246329         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24632900
246330                ' 7800-UNITS-WORK-ROUTINE '                       24633000
246331                                    DELIMITED BY SIZE             24633100
246332                ' BAD RCVR NBR  '   DELIMITED BY SIZE             24633200
246333                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24633300
246334                             INTO PV-CICS-MSG-AREA                24633400
246335         MOVE LENGTH OF PV-CICS-MSG-AREA                          24633500
246336                               TO PV-COMMAREA-LENGTH              24633600
246337         PERFORM 9200-WRITE-TO-CICS-LOG                           24633700
246338         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24633800
246339                ' 7800-UNITS-WORK-ROUTINE '                       24633900
246340                                    DELIMITED BY SIZE             24634000
246341                ' KEY INFO - '      DELIMITED BY SIZE             24634100
246342                PC-DISPLAY-PO       DELIMITED BY SIZE             24634200
246343                ' - '               DELIMITED BY SIZE             24634300
246344                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24634400
246345                ' - '               DELIMITED BY SIZE             24634500
246346                PC-DISPLAY-LINE     DELIMITED BY SIZE             24634600
246347                             INTO PV-CICS-MSG-AREA                24634700
246348         MOVE LENGTH OF PV-CICS-MSG-AREA                          24634800
246349                               TO PV-COMMAREA-LENGTH              24634900
246350         PERFORM 9200-WRITE-TO-CICS-LOG                           24635000
246351         PERFORM 9900-SOFT-ABORT                                  24635100
246352     ELSE                                                         24635200
246353     IF  PC238-MOD-BAD-LINE                                       24635300
246354         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24635400
246355                ' 7800-UNITS-WORK-ROUTINE '                       24635500
246356                                    DELIMITED BY SIZE             24635600
246357                ' BAD LINE NBR  '   DELIMITED BY SIZE             24635700
246358                PC-DISPLAY-LINE     DELIMITED BY SIZE             24635800
246359                             INTO PV-CICS-MSG-AREA                24635900
246360         MOVE LENGTH OF PV-CICS-MSG-AREA                          24636000
246361                               TO PV-COMMAREA-LENGTH              24636100
246362         PERFORM 9200-WRITE-TO-CICS-LOG                           24636200
246363         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24636300
246364                ' 7800-UNITS-WORK-ROUTINE '                       24636400
246365                                    DELIMITED BY SIZE             24636500
246366                ' KEY INFO - '      DELIMITED BY SIZE             24636600
246367                PC-DISPLAY-PO       DELIMITED BY SIZE             24636700
246368                ' - '               DELIMITED BY SIZE             24636800
246369                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24636900
246370                ' - '               DELIMITED BY SIZE             24637000
246371                PC-DISPLAY-LINE     DELIMITED BY SIZE             24637100
246372                             INTO PV-CICS-MSG-AREA                24637200
246373         MOVE LENGTH OF PV-CICS-MSG-AREA                          24637300
246374                               TO PV-COMMAREA-LENGTH              24637400
246375         PERFORM 9200-WRITE-TO-CICS-LOG                           24637500
246376         PERFORM 9900-SOFT-ABORT                                  24637600
246377     ELSE                                                         24637700
246378     IF  PC238-MOD-BAD-NO-SHIFT                                   24637800
246379         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24637900
246380                ' 7800-UNITS-WORK-ROUTINE '                       24638000
246381                                    DELIMITED BY SIZE             24638100
246382                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             24638200
246383                PC238-WRKD-TMST     DELIMITED BY SIZE             24638300
246384                ' FOR OPER '        DELIMITED BY SIZE             24638400
246385                PC-DISPLAY-OPER     DELIMITED BY SIZE             24638500
246386                             INTO PV-CICS-MSG-AREA                24638600
246387         MOVE LENGTH OF PV-CICS-MSG-AREA                          24638700
246388                               TO PV-COMMAREA-LENGTH              24638800
246389         PERFORM 9200-WRITE-TO-CICS-LOG                           24638900
246390         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24639000
246391                ' 7800-UNITS-WORK-ROUTINE '                       24639100
246392                                    DELIMITED BY SIZE             24639200
246393                ' KEY INFO - '      DELIMITED BY SIZE             24639300
246394                PC-DISPLAY-PO       DELIMITED BY SIZE             24639400
246395                ' - '               DELIMITED BY SIZE             24639500
246396                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24639600
246397                ' - '               DELIMITED BY SIZE             24639700
246398                PC-DISPLAY-LINE     DELIMITED BY SIZE             24639800
246399                             INTO PV-CICS-MSG-AREA                24639900
246400         MOVE LENGTH OF PV-CICS-MSG-AREA                          24640000
246401                               TO PV-COMMAREA-LENGTH              24640100
246402         PERFORM 9200-WRITE-TO-CICS-LOG                           24640200
246403         PERFORM 9900-SOFT-ABORT                                  24640300
246404     ELSE                                                         24640400
246405         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24640500
246406                ' 7800-UNITS-WORK-ROUTINE '                       24640600
246407                                    DELIMITED BY SIZE             24640700
246408                ' DB ERROR - SQL CODE '                           24640800
246409                                    DELIMITED BY SIZE             24640900
246410                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             24641000
246411                ' FUNC: '           DELIMITED BY SIZE             24641100
246412                PC238-BAD-TABLE-FUNCTION                          24641200
246413                                    DELIMITED BY SIZE             24641300
246414                ' TABLE: '          DELIMITED BY SIZE             24641400
246415                PC238-BAD-TABLE-NAME                              24641500
246416                                    DELIMITED BY SIZE             24641600
246417                             INTO PV-CICS-MSG-AREA                24641700
246418         MOVE LENGTH OF PV-CICS-MSG-AREA                          24641800
246419                               TO PV-COMMAREA-LENGTH              24641900
246420         PERFORM 9200-WRITE-TO-CICS-LOG                           24642000
246421         STRING ' RCKCS298 - '      DELIMITED BY SIZE             24642100
246422                ' 7800-UNITS-WORK-ROUTINE '                       24642200
246423                                    DELIMITED BY SIZE             24642300
246424                ' KEY INFO - '      DELIMITED BY SIZE             24642400
246425                PC-DISPLAY-PO       DELIMITED BY SIZE             24642500
246426                ' - '               DELIMITED BY SIZE             24642600
246427                PC-DISPLAY-RCVR     DELIMITED BY SIZE             24642700
246428                ' - '               DELIMITED BY SIZE             24642800
246429                PC-DISPLAY-LINE     DELIMITED BY SIZE             24642900
246430                             INTO PV-CICS-MSG-AREA                24643000
246431         MOVE LENGTH OF PV-CICS-MSG-AREA                          24643100
246432                               TO PV-COMMAREA-LENGTH              24643200
246433         PERFORM 9200-WRITE-TO-CICS-LOG                           24643300
246435         PERFORM 9900-SOFT-ABORT                                  24643500
246436     END-IF                                                       24643600
246437     END-IF                                                       24643700
246438     END-IF                                                       24643800
246439     END-IF                                                       24643900
246440     END-IF                                                       24644000
246441     END-IF                                                       24644100
246442     END-IF.                                                      24644200
246443                                                                  24644300
246444*----------------------------------------------------------------*24644400
246445* THIS PARAGRAPH WILL ACCESS DATA FROM THE 7750-DISTHD-PURITM-   *24644500
246446* JOIN PARAGRAPH AND THEN DETERMINE IF THE LINE HAS BEEN         *24644600
246447* CONFIRMED.  IF IT HAS BEEN, THEN THE UNITS WORKED MODULE WILL  *24644700
246448* BE CALLED TO PROCESS THE ADJUSTMENT.                           *24644800
246449*----------------------------------------------------------------*24644900
246450 7900-CHECK-UNIT-WORK-UPDATE.                                     24645000
246451                                                                  24645100
246452     PERFORM 7750-DISTHD-PURITM-JOIN.                             24645200
246453                                                                  24645300
246454     IF  PV-DISTHD-FCSE-CNFRMN-TMST NOT EQUAL                     24645400
246455         PC-DEFAULT-TMST                                          24645500
246456         PERFORM 7800-UNITS-WORK-ROUTINE                          24645600
246457     END-IF.                                                      24645700
246458                                                                  24645800
246459*----------------------------------------------------------------*24645900
246460 8000-UPDATE-STORE.                                               24646000
246461                                                                  24646100
246470     MOVE +1 TO ASC-BLK-SUB.                                      24647000
246500     PERFORM 5100-WRITE-TEMP-STORAGE.                             24650000
246600     ADD +1  TO ASC-BLK-SUB.                                      24660000
246700     PERFORM 5100-WRITE-TEMP-STORAGE.                             24670000
246800                                                                  24680000
246900     PERFORM 6112-READ-LIST-QUEUE.                                24690000
247000                                                                  24700000
247100     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        24710000
247200     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       24720000
247300     MOVE ASC-KEY-STR-NBR   TO DK-STR-NBR.                        24730000
247400                                                                  24740000
247500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           24750000
247600         PERFORM                                                  24760000
247700           VARYING LQW-IDX FROM 1 BY 1                            24770000
247800             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   24780000
247900                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          24790000
248000                                                                  24800000
248100             IF LQW-SELECT (LQW-IDX)                              24810000
248200                 MOVE LQW-LINE-NBR (LQW-IDX) TO DK-LINE-NBR       24820000
248300                                                                  24830000
248400                 IF ASC-PKGNG-CDE = 'I' OR 'M'                    24840000
248500                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             24850000
248600                       TO DISTDT-PREPK-ODD-UNT-QTY                24860000
248620                          PA-UPDATE-TO-QTY                        24862000
248630                     MOVE LQW-ODD-UNIT (LQW-IDX) TO               24863000
248640                          PA-UPDATE-FROM-QTY                      24864000
248650                     SUBTRACT PA-UPDATE-FROM-QTY                  24865000
248660                         FROM PA-UPDATE-TO-QTY                    24866000
248670                       GIVING PA-UPDATE-DIFF-QTY                  24867000
248700                 ELSE                                             24870000
248800                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             24880000
248900                       TO DISTDT-FCSE-ACTL-UNT-QTY                24890000
248910                          PA-UPDATE-TO-QTY                        24891000
248911                     MOVE LQW-FCSE-QTY (LQW-IDX) TO               24891100
248930                          PA-UPDATE-FROM-QTY                      24893000
248940                     SUBTRACT PA-UPDATE-FROM-QTY                  24894000
248950                         FROM PA-UPDATE-TO-QTY                    24895000
248960                       GIVING PA-UPDATE-DIFF-QTY                  24896000
249000                 END-IF                                           24900000
249100                                                                  24910000
249200                 IF (ASC-PKGNG-CDE = 'I' OR 'M')                  24920000
249300                     PERFORM 8200-UPDATE-ODD-UNITS                24930000
249400                 ELSE                                             24940000
249500                     PERFORM 8100-UPDATE-TDISTDT                  24950000
249600                 END-IF                                           24960000
249610                                                                  24961000
249611                 IF  PA-UPDATE-DIFF-QTY NOT EQUAL TO ZERO         24961100
249620                     PERFORM 7900-CHECK-UNIT-WORK-UPDATE          24962000
249630                 END-IF                                           24963000
249700                                                                  24970000
249800                 IF ASC-PKGNG-CDE = 'I' OR 'M'                    24980000
249900                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             24990000
250000                       TO LQW-ODD-UNIT (LQW-IDX)                  25000000
250100                 ELSE                                             25010000
250200                     MOVE LQW-U-PROCESS-QTY (LQW-IDX)             25020000
250300                       TO LQW-FCSE-QTY (LQW-IDX)                  25030000
250400                 END-IF                                           25040000
250500                                                                  25050000
250600                 MOVE SPACES TO LQW-U-PROCESS-QTY-X (LQW-IDX)     25060000
250700                                                                  25070000
250800                 SET LQW-DESELECT (LQW-IDX) TO TRUE               25080000
250900                 SET LQW-UPDATE   (LQW-IDX) TO TRUE               25090000
251000                 MOVE LQW-SELECTED-SW (LQW-IDX)                   25100000
251100                   TO LQW-TEMP-SELECTED-SW (LQW-IDX)              25110000
251200                                                                  25120000
251300             END-IF                                               25130000
251400         END-PERFORM                                              25140000
251500                                                                  25150000
251600         MOVE PV-ITEM TO PV-SAVE-ITEM                             25160000
251700         PERFORM 6111-WRITE-LIST-QUEUE                            25170000
251800     END-IF.                                                      25180000
251900                                                                  25190000
252000     MOVE +1 TO ASC-BLK-SUB.                                      25200000
252100     PERFORM 4410-READ-TEMP-STORAGE                               25210000
252200                                                                  25220000
252300     ADD +1  TO ASC-BLK-SUB                                       25230000
252400                PV-BLOCK-NUMBER.                                  25240000
252500     PERFORM 4410-READ-TEMP-STORAGE.                              25250000
252600                                                                  25260000
252700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        25270000
252800                                                                  25280000
252900*----------------------------------------------------------------*25290000
253000* UPDATE FULLCASE QUANTITY FOR STORE.                            *25300000
253100*----------------------------------------------------------------*25310000
253200 8100-UPDATE-TDISTDT.                                             25320000
253300                                                                  25330000
253400     EXEC SQL                                                     25340000
253500         UPDATE TDISTDT                                           25350000
253600            SET FCSE_ACTL_UNT_QTY = :DISTDT-FCSE-ACTL-UNT-QTY     25360000
253700          WHERE ORD_NBR           = :DK-ORD-NBR                   25370000
253800            AND RCVR_SEQ_NBR      = :DK-RCVR-NBR                  25380000
253900            AND ORD_LNE_NBR       = :DK-LINE-NBR                  25390000
254000            AND STR_NBR           = :DK-STR-NBR                   25400000
254100     END-EXEC.                                                    25410000
254200                                                                  25420000
254300     EVALUATE TRUE                                                25430000
254400         WHEN SQLCODE = ZERO                                      25440000
254500         WHEN SQLCODE = +100                                      25450000
254600             CONTINUE                                             25460000
254700                                                                  25470000
254800         WHEN SQLCODE = -904                                      25480000
254900         WHEN SQLCODE = -911                                      25490000
255000         WHEN SQLCODE = -913                                      25500000
255100             PERFORM 9900-SOFT-ABORT                              25510000
255200                                                                  25520000
255300         WHEN SQLWARN0 NOT = SPACES                               25530000
255400         WHEN SQLCODE < ZERO                                      25540000
255500         WHEN SQLCODE > ZERO                                      25550000
255600             MOVE '8100-UPDATE-TDISTDT' TO DP013-PARAGRAPH        25560000
255700             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              25570000
255800                                    TO DP013-MESSAGE-TEXT (1)     25580000
255900             MOVE SQLCA             TO DP013-SQLCA                25590000
256000             MOVE 'TDISTDT '        TO DP013-DB2-TABLE-NAME (1)   25600000
256100             SET DP013-DB2-ABEND                                  25610000
256200                  DP013-NO-ROLLBACK TO TRUE                       25620000
256300             PERFORM DP013-0000-PROCESS-ABEND                     25630000
256400     END-EVALUATE.                                                25640000
256500                                                                  25650000
256600*----------------------------------------------------------------*25660000
256700* UPDATE ODD UNIT QUANTITY FOR STORE.                            *25670000
256800*----------------------------------------------------------------*25680000
256900 8200-UPDATE-ODD-UNITS.                                           25690000
257000                                                                  25700000
257100     EXEC SQL                                                     25710000
257200         UPDATE TDISTDT                                           25720000
257300            SET PREPK_ODD_UNT_QTY = :DISTDT-PREPK-ODD-UNT-QTY     25730000
257400          WHERE ORD_NBR           = :DK-ORD-NBR                   25740000
257500            AND RCVR_SEQ_NBR      = :DK-RCVR-NBR                  25750000
257600            AND ORD_LNE_NBR       = :DK-LINE-NBR                  25760000
257700            AND STR_NBR           = :DK-STR-NBR                   25770000
257800     END-EXEC.                                                    25780000
257900                                                                  25790000
258000     EVALUATE TRUE                                                25800000
258100         WHEN SQLCODE = ZERO                                      25810000
258200         WHEN SQLCODE = +100                                      25820000
258300             CONTINUE                                             25830000
258400                                                                  25840000
258500         WHEN SQLCODE = -904                                      25850000
258600         WHEN SQLCODE = -911                                      25860000
258700         WHEN SQLCODE = -913                                      25870000
258800             PERFORM 9900-SOFT-ABORT                              25880000
258900                                                                  25890000
259000         WHEN SQLWARN0 NOT = SPACES                               25900000
259100         WHEN SQLCODE < ZERO                                      25910000
259200         WHEN SQLCODE > ZERO                                      25920000
259300             MOVE '8200-UPDATE-ODD-UNITS' TO DP013-PARAGRAPH      25930000
259400             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              25940000
259500                                   TO DP013-MESSAGE-TEXT (1)      25950000
259600             MOVE SQLCA            TO DP013-SQLCA                 25960000
259700             MOVE 'TDISTDT '       TO DP013-DB2-TABLE-NAME (1)    25970000
259800             SET DP013-DB2-ABEND                                  25980000
259900                 DP013-NO-ROLLBACK TO TRUE                        25990000
260000             PERFORM DP013-0000-PROCESS-ABEND                     26000000
260100     END-EVALUATE.                                                26010000
260200                                                                  26020000
260210*----------------------------------------------------------------*26021047
260220*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             26022047
260230*    TO SEE IF THIS IS AN AUTOVE PO                               26023047
260240*----------------------------------------------------------------*26024047
260250 8400-CHECK-AUTOVE.                                               26025047
260260                                                                  26026047
260270     INITIALIZE RC040-FIELDS.                                     26027047
260280     MOVE ASC-KEY-OPER-UNT-ID TO RC040-SIGNON-LOCATION.           26028047
260290     MOVE ASC-KEY-PO-NBR      TO RC040-PO-NBR.                    26029047
260291     MOVE ASC-KEY-RCVR-NBR    TO RC040-PO-RCVR.                   26029147
260292     SET  RC040-RCVR-EXISTS   TO TRUE.                            26029247
260294     MOVE DP020-USERID        TO RC040-USER-ID.                   26029447
260295     MOVE 'RCKCS297'          TO RC040-CALLING-PROGRAM.           26029547
260296                                                                  26029647
260297     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  26029747
260298                                        RC040-COMMAREA            26029847
260299                                        RC040-FIELDS.             26029947
260300     EVALUATE TRUE                                                26030047
260301         WHEN RC040-SUCCESSFUL                                    26030147
260302              MOVE RC040-AUTO-VE-SW     TO ASC-AUTO-VE-SW         26030250
260303         WHEN RC040-DATABASE-BUSY OR                              26030347
260304              RC040-INVALID-SQL                                   26030447
260305                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       26030547
260306                  SET DP020-MSG-WARNING TO TRUE                   26030647
260307                  SET DP030-OVERRIDE-GO TO TRUE                   26030747
260308                  SET PS-ERROR          TO TRUE                   26030847
260309         WHEN RC040-NOT-SUCCESSFUL                                26030947
260310                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       26031047
260311                  SET DP020-MSG-WARNING TO TRUE                   26031147
260312                  SET DP030-OVERRIDE-GO TO TRUE                   26031247
260313                  SET PS-ERROR          TO TRUE                   26031347
260314         WHEN OTHER                                               26031447
260315             MOVE '8400-CHECK-AUTOVE ' TO DP013-PARAGRAPH         26031547
260316             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              26031647
260317                                         TO DP013-MESSAGE-TEXT (1)26031747
260318             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)26031847
260319             MOVE RC040-SQLCA            TO DP013-SQLCA           26031947
260320             SET DP013-DB2-ABEND                                  26032047
260321                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              26032147
260322             SET PS-ERROR                    TO TRUE              26032247
260323             PERFORM DP013-0000-PROCESS-ABEND                     26032347
260324     END-EVALUATE.                                                26032447
260325                                                                  26032547
260330*----------------------------------------------------------------*26033000
260400*    READ THE INPUT SELECTION QUEUE.                             *26040000
260500*----------------------------------------------------------------*26050000
260600 9100-READ-SEL-QUEUE.                                             26060000
260700                                                                  26070000
260800     EXEC CICS                                                    26080000
260900          READQ TS                                                26090000
261000              QUEUE (ASC-SEL-QUEUE-NAME-IN)                       26100000
261100              INTO  (RC013-DC-SELECT-RECORD)                      26110000
261200              ITEM  (ASC-SEL-ITEM)                                26120000
261300              RESP  (PV-CICS-RESP)                                26130000
261400     END-EXEC.                                                    26140000
261500                                                                  26150000
261600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           26160000
261700         CONTINUE                                                 26170000
261800     ELSE                                                         26180000
261900         SET DP013-CICS-ABEND       TO TRUE                       26190000
262000         SET DP013-NO-ROLLBACK      TO TRUE                       26200000
262100         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            26210000
262200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           26220000
262300                                    TO DP013-MESSAGE-TEXT(1)      26230000
262400         PERFORM DP013-0000-PROCESS-ABEND                         26240000
262500     END-IF.                                                      26250000
262600                                                                  26260000
262700*----------------------------------------------------------------*26270000
262720 9200-WRITE-TO-CICS-LOG.                                          26272000
262730                                                                  26273000
262740     EXEC CICS                                                    26274000
262750          WRITEQ TD                                               26275000
262760          QUEUE  ('CSSL')                                         26276000
262770          FROM  (PV-CICS-MSG-AREA)                                26277000
262780          LENGTH  (PV-COMMAREA-LENGTH)                            26278000
262790          RESP  (PV-CICS-RESP)                                    26279000
262791     END-EXEC.                                                    26279100
262792                                                                  26279200
262793     MOVE SPACES TO PV-CICS-MSG-AREA.                             26279300
262794                                                                  26279400
262800*----------------------------------------------------------------*26280000
262900 9900-SOFT-ABORT.                                                 26290000
263000     SET PS-ERROR         TO TRUE.                                26300000
263100     SET DP020-MSG-FATAL  TO TRUE.                                26310000
263200     MOVE 'THROUGH SOFT-ABORT PARA'                               26320000
263300                      TO DP013-MESSAGE-TEXT (1)                   26330000
263310                                                                  26331000
263320     IF  PS-UNITS-WORKED-ERROR                                    26332000
263330         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 26333000
263340     ELSE                                                         26334000
263350         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 26335000
263360     END-IF.                                                      26336000
263370                                                                  26337000
263500     IF PS-NO-NEXT-SCREEN                                         26350000
263600        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     26360000
263700     END-IF.                                                      26370000
263710                                                                  26371000
263800     PERFORM 9901-BACKUP.                                         26380000
263810                                                                  26381000
263900     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          26390000
264000     PERFORM 0001-CALL-CICS-ARCH-API.                             26400000
264100                                                                  26410000
264200 9901-BACKUP.                                                     26420000
264300     EXEC CICS SYNCPOINT                                          26430000
264400          ROLLBACK                                                26440000
264500     END-EXEC.                                                    26450000
264600                                                                  26460000
264700 9902-SYNCPOINT.                                                  26470000
264800     EXEC CICS                                                    26480000
264900         SYNCPOINT                                                26490000
265000     END-EXEC.                                                    26500000
265100                                                                  26510000
265200*----------------------------------------------------------------*26520000
265300*    ABEND PROCESSOR MODULE                                      *26530000
265400*----------------------------------------------------------------*26540000
265500     COPY DPPD013.                                                26550045
