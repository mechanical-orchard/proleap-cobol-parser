000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKRP003.                                         00020000
000300 AUTHOR.        DOUG NOLTNER - STRATAGEM.                         00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN.  08/93.                                            00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800* THIS PROGRAM WILL READ A PURCHASE ORDER NUMBER PASSED FROM THE  00080000
000900* ONLINE AND GENERATE A PURCHASE ORDER PRINT.                     00090000
001000******************************************************************00100000
001100* DATE  02/18/00                                                 *00110000
001200*   WR20853 INCREASE 300 STORE LIMIT TO 999.                     *00120000
001300******************************************************************00130000
001400*---------------------------------------------------------------* 00140000
001500* DATE  04/10/2000, K. SCHOLEY                                  * 00150000
001600*   WR20997 ADD LOGIC FOR ECOMMERCE STORE AND PO TYPE CODES     * 00160000
001700*---------------------------------------------------------------* 00170000
001800* DATE  10/24/2000, K. SCHOLEY                                  * 00180000
001900*   WR21302 ADD LOGIC TO PRINT NEW DEALS DISCOUNT PERCENTS, AMTS* 00190000
002000*   AND EXTENDED DAYS.                                          * 00200000
002100*---------------------------------------------------------------* 00210000
002200* DATE  11/16/2000, K. SCHOLEY                                  * 00220000
002300*   WR21302 MULTIPLY NEW DISCOUNTS BY 100 BEFORE MOVING TO PRINT* 00230000
002400*---------------------------------------------------------------* 00240000
002500* DATE  06/27/2002, R. STAUFFACHER                              * 00250000
002600*   P471028 ADDED RETRY LOGIC FOR TPURITM PARAGRAPHS            * 00260000
002700*---------------------------------------------------------------* 00270000
002800* DATE  07/11/2002, CINDY HANSEN                                * 00280000
002900*   P471028 INCREASED RETRY MAX FOR TPURITM TO 30.  THIS GIVES  * 00290000
003000*           ADDITIONAL PROCESSING TIME FOR THE PO BRIDGE TO     * 00300000
003100*           CONVERT LARGE ORDERS TO RMS WITHOUT CAUSING AN ABEND* 00310000
003200*           IN THIS PROGRAM DUE TO CONTENTION.                  * 00320000
003210*---------------------------------------------------------------* 00330000
003220* TKMA888 04/18/2003 - CHANGE PURCHASE ORDERS COST COMPUTATION    00340000
003230* BILL SCHROEDER       FOR ALL IMPORT PURCHASE ORDERS TO USE      00350000
003240* STRATAGEM, INC.      PRD_1ST_COST_AMT                           00360000
W24803*---------------------------------------------------------------* 00370000
W24803* 05/09/2003  ABRAHAM JACOB, IBM GLOBAL SERVICES      WR 24803  * 00380000
W24803*   NON-INTELLIGENT SKU PROJECT : CHANGES BEING INCORPORATED    * 00390000
W24803*   INTO THIS PROGRAM                                           * 00400000
W24803*                                                               * 00410000
003300***************************************************************** 00420000
003400* 02/10/2004  RYAN STAUFFACHER PM00631727                       * 00430000
003500*   CHANGED PO LINE CURSOR AND APPROVED PO LINE CURSOR TO ONLY  * 00440000
003600*   INCLUDE LINES WHERE THE UNIT QUANTITY IS GREATER THAN ZERO  * 00450000
003700*   CHANGED ALLOCATION CURSOR TO INCLUDE ONLY LINES WHERE THE   * 00460000
003700*   STORE DISTRO QUANTITY IS GREATER THAN ZERO.  CHANGED THE    * 00470000
003700*   COUNT OF ALLOCATIONS TO ONLY COUNT ROWS WHERE THE STORE     * 00480000
003700*   DISTRO QUANTITY IS GREATER THAN ZERO.                       * 00490000
      ***************************************************************** 00500003
      * 11/22/2006 SUE BARTELT PM00954065.                            * 00510003
      *   CHANGED DISTR-LINE-OLD.  CHANGED LAST FILLER STMT FROM 02   * 00520003
      *   TO 01.  WAS CAUSING LAST QTY AMOUNT IN LAST COLUMN NOT TO   * 00530003
      *   DISPLAY ON REPORT.                                            00540003
      ***************************************************************** 00550004
C98147* 11/04/2014 LINDA FRIESS CHG0098147                            * 00560010
C98147*   EXPANDED PO NUMBER IN REPORT TO 8 DIGITS.                   * 00570009
C98147***************************************************************** 00580009
P12016* 12/07/2017 VENKATSUBBU  CHG0178452                            * 00581026
P12016*   HANDLED THE NEW PO TYPE CODE 'RE' AS PART OF MTT PROJECT.   * 00582011
P12016***************************************************************** 00583011
003100* 03/2021    JEAN KURK                                          * 00584027
003200*   REMOVE TABLE TPOUPC                                         * 00585027
003300***************************************************************** 00586027
003400 ENVIRONMENT DIVISION.                                            00590000
003500 CONFIGURATION SECTION.                                           00600000
003600 SOURCE-COMPUTER. IBM-3090.                                       00610000
003700 OBJECT-COMPUTER. IBM-3090.                                       00620000
003800 INPUT-OUTPUT SECTION.                                            00630000
003900 FILE-CONTROL.                                                    00640000
004000                                                                  00650000
004100     SELECT INPUT-FILE                                            00660000
004200         ASSIGN TO INP01.                                         00670000
004300     SELECT PORPT-FILE                                            00680000
004400         ASSIGN TO RPT01.                                         00690000
004500                                                                  00700000
004600******************************************************************00710000
004700 DATA DIVISION.                                                   00720000
004800******************************************************************00730000
004900 FILE SECTION.                                                    00740000
005000                                                                  00750000
005100 FD  INPUT-FILE                                                   00760000
005200     RECORDING MODE IS F                                          00770000
005300     LABEL RECORDS ARE STANDARD                                   00780000
005400     RECORD CONTAINS 80 CHARACTERS                                00790000
005500     BLOCK CONTAINS 0 RECORDS.                                    00800000
005600 01  INPUT-RECORD                     PIC  X(80).                 00810000
005700                                                                  00820000
005800 FD  PORPT-FILE                                                   00830000
005900     RECORDING MODE F                                             00840000
006000     BLOCK CONTAINS 0 RECORDS                                     00850000
006100     RECORD CONTAINS 150 CHARACTERS                               00860000
006200     LABEL RECORDS ARE OMITTED                                    00870000
006300     DATA RECORD IS PORPT-RECORD.                                 00880000
006400 01  PORPT-RECORD                     PIC  X(150).                00890000
006500                                                                  00900000
006600 WORKING-STORAGE SECTION.                                         00910000
006700                                                                  00920000
006800 01  IR-INPUT-RECORD.                                             00930000
006900     05  IR-PO-NBR                    PIC S9(09) COMP.            00940023
007000     05  IR-RPT-TYPE-BY               PIC  X(02).                 00950000
007100     05  IR-RPT-TYPE-VN               PIC  X(02).                 00960000
007200     05  IR-RPT-TYPE-DC               PIC  X(02).                 00970000
007300     05  IR-RPT-TYPE-AN               PIC  X(02).                 00980000
007400     05  FILLER                       PIC  X(65).                 00990000
007500                                                                  01000000
007600 01  SD-SYSTEM-DATE.                                              01010000
007700     05  SD-SYSTEM-YY                 PIC  9(02) VALUE ZEROES.    01020000
007800     05  SD-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    01030000
007900     05  SD-SYSTEM-DD                 PIC  9(02) VALUE ZEROES.    01040000
008000                                                                  01050000
008100 01  ST-SYSTEM-TIME.                                              01060000
008200     05  ST-SYSTEM-HH                 PIC  9(02) VALUE ZEROES.    01070000
008300     05  ST-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    01080000
008400     05  ST-SYSTEM-SS                 PIC  9(02) VALUE ZEROES.    01090000
008500     05  FILLER                       PIC  9(02) VALUE ZEROES.    01100000
008600                                                                  01110000
008700 01  PS-PROGRAM-SWITCHES.                                         01120000
008800     05  PS-SORT-DONE-SW                PIC  X(01)   VALUE 'N'.   01130000
008900         88  PS-SORT-DONE                            VALUE 'Y'.   01140000
009000         88  PS-SORT-NOT-DONE                        VALUE 'N'.   01150000
009100     05  PS-ADD-SUB-SW                PIC  X(01) VALUE ' '.       01160000
009200         88  PS-ADD                              VALUE '1'.       01170000
009300         88  PS-SUBTR                            VALUE '2'.       01180000
009400     05  PS-EOF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.       01190000
009500         88  PS-EOF-INPUT-FILE                   VALUE 'Y'.       01200000
009600     05  PS-EOF-INST-CSR-SW           PIC  X(01) VALUE 'N'.       01210000
009700         88  PS-EOF-INST-CSR                     VALUE 'Y'.       01220000
009800         88  PS-NOT-EOF-INST-CSR                 VALUE 'N'.       01230000
009900     05  PS-EOF-PO-LINE-CSR-SW        PIC  X(01) VALUE 'N'.       01240000
010000         88  PS-EOF-PO-LINE-CSR                  VALUE 'Y'.       01250000
010100         88  PS-NOT-EOF-PO-LINE-CSR              VALUE 'N'.       01260000
010200     05  PS-EOF-ALLOC-CSR-SW          PIC  X(01) VALUE 'N'.       01270000
010300         88  PS-EOF-ALLOC-CSR                    VALUE 'Y'.       01280000
010400         88  PS-NOT-EOF-ALLOC-CSR                VALUE 'N'.       01290000
010500*    05  PS-EOF-UPC-CSR-SW            PIC  X(01) VALUE 'N'.       01300028
010600*        88  PS-EOF-UPC-CSR                      VALUE 'Y'.       01310028
010700*        88  PS-NOT-EOF-UPC-CSR                  VALUE 'N'.       01320028
010800     05  PS-TYPE-RPT-PROCESS-SW       PIC  X(01) VALUE ' '.       01330000
010900         88  PS-BUYER-RPT-TYPE                   VALUE 'B'.       01340000
011000         88  PS-ANALYST-RPT-TYPE                 VALUE 'A'.       01350000
011100         88  PS-VENDOR-RPT-TYPE                  VALUE 'V'.       01360000
011200         88  PS-DC-RPT-TYPE                      VALUE 'D'.       01370000
011300     05  PS-PACK-BY-STORE-SW          PIC  X(01) VALUE ' '.       01380000
011400         88  PS-PACK-BY-STORE                    VALUE 'Y'.       01390000
011500         88  PS-NOT-PACK-BY-STORE                VALUE 'N'.       01400000
011600                                                                  01410000
011700 01  PC-PROGRAM-CONSTANTS.                                        01420000
011800     05  PC-MIN-UPC                      PIC S9(15)V VALUE        01430000
011900                                   +000400000000000 COMP-3.       01440000
012000     05  PC-MAX-UPC                      PIC S9(15)V VALUE        01450000
012100                                    000409999999999 COMP-3.       01460000
012200     05  PC-INIT-DATE                 PIC  X(10) VALUE            01470000
012300                                                     '0001-01-01'.01480000
012400     05  PC-STORE-QTY                 PIC  X(36) VALUE            01490000
012500         ' --STORE--   ---SIZE---  QUANTITY   '.                  01500000
012600     05  PC-STORE-QTY-OLD             PIC  X(22) VALUE            01510000
012700         ' --STORE--  QUANTITY  '.                                01520000
012800     05  PC-SHIP-INST-ATT             PIC  X(31) VALUE            01530000
012900         'REFER TO SHIPPING INSTRUCTIONS '.                       01540000
013000     05  PC-SHIP-INST-FOLL            PIC  X(31) VALUE            01550000
013100         'SHIPPING INSTRUCTIONS TO FOLLOW'.                       01560000
013200     05  PC-MONTH-ABBR-TABLE.                                     01570000
013300         10  FILLER                   PIC  X(03) VALUE 'JAN'.     01580000
013400         10  FILLER                   PIC  X(03) VALUE 'FEB'.     01590000
013500         10  FILLER                   PIC  X(03) VALUE 'MAR'.     01600000
013600         10  FILLER                   PIC  X(03) VALUE 'APR'.     01610000
013700         10  FILLER                   PIC  X(03) VALUE 'MAY'.     01620000
013800         10  FILLER                   PIC  X(03) VALUE 'JUN'.     01630000
013900         10  FILLER                   PIC  X(03) VALUE 'JUL'.     01640000
014000         10  FILLER                   PIC  X(03) VALUE 'AUG'.     01650000
014100         10  FILLER                   PIC  X(03) VALUE 'SEP'.     01660000
014200         10  FILLER                   PIC  X(03) VALUE 'OCT'.     01670000
014300         10  FILLER                   PIC  X(03) VALUE 'NOV'.     01680000
014400         10  FILLER                   PIC  X(03) VALUE 'DEC'.     01690000
014500     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    01700000
014600         10  PC-MONTH-ABBR OCCURS 12 TIMES                        01710000
014700                                      PIC  X(03).                 01720000
014800     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.01730000
014900     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +30       01740000
015000                                                 COMP.            01750000
015100                                                                  01760000
015200 01  PV-PROGRAM-VARIABLES.                                        01770000
015300     05  PV-HOLD-IDX                  PIC S9(06) VALUE +0         01780000
015400                                                 COMP.            01790000
015500     05  PV-HOLD-STR-NBR              PIC X(04).                  01800000
015600     05  PV-HOLD-STR-NAME             PIC X(05).                  01810000
015700     05  PV-HOLD-STR-QTY              PIC 9(06).                  01820000
015800     05  PV-HOLD-STR-SUBTOTAL         PIC S9(09) COMP-3.          01830000
015900     05  PV-TIMES-THROUGH             PIC S9(06) VALUE +0         01840000
016000                                                 COMP.            01850000
016100     05  PV-DIFF                      PIC S9(06) VALUE +0         01860000
016200                                                 COMP SYNC.       01870000
016300     05  PV-ABS-DIFF                  PIC 9(06).                  01880000
016400     05  PV-QTY                       PIC S9(09) VALUE +0         01890000
016500                                                 COMP SYNC.       01900000
016600     05  PV-UPC-PCT                   PIC S9(9)V9(9)              01910000
016700                                                 VALUE +0 COMP.   01920000
016800     05  PV-UPC-TOTAL-QTY             PIC S9(09) VALUE +0         01930000
016900                                                 COMP-3.          01940000
017000     05  PV-UPC-QTY-TEMP              PIC S9(09) VALUE +0         01950000
017100                                                 COMP-3.          01960000
017200     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACES.    01970000
017300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01980000
017400                                                 COMP.            01990000
017500     05  PV-NULL-IND                  PIC S9(04) VALUE +0         02000000
017600                                                 COMP.            02010000
017700     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0         02020000
017800                                                 COMP-3.          02030000
017900     05  PV-QUOTIENT                  PIC S9(04) VALUE +0         02040000
018000                                                 COMP.            02050000
018100     05  PV-REMAINDER                 PIC S9(04) VALUE +0         02060000
018200                                                 COMP.            02070000
018300     05  PV-LINE-CNT                  PIC 9(06).                  02080000
018400     05  PV-TIMES                     PIC S9(06) VALUE +0         02090000
018500                                                 COMP-3.          02100000
018600     05  PV-TIMES2                    PIC S9(06) VALUE +0         02110000
018700                                                 COMP-3.          02120000
018800     05  PV-START                     PIC S9(06) VALUE +0         02130000
018900                                                 COMP-3.          02140000
019000     05  PV-END                       PIC S9(06) VALUE +0         02150000
019100                                                 COMP-3.          02160000
019200     05  PV-NBR-STORES                PIC S9(06) VALUE +0         02170000
019300                                                 COMP-3.          02180000
019400     05  PV-NBR-WRITES                PIC S9(06) VALUE +0         02190000
019500                                                 COMP-3.          02200000
019600     05  PV-STR-ADJ                   PIC S9(06) VALUE +0         02210000
019700                                                 COMP-3.          02220000
019800     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         02230000
019900                                                 COMP-3.          02240000
020000     05  PV-DATE-BREAK.                                           02250000
020100         10  PV-DB-CC                 PIC  X(02).                 02260000
020200         10  PV-DB-YY                 PIC  X(02).                 02270000
020300         10  FILLER                   PIC  X(01).                 02280000
020400         10  PV-DB-MM                 PIC  X(02).                 02290000
020500         10  FILLER                   PIC  X(01).                 02300000
020600         10  PV-DB-DD                 PIC  X(02).                 02310000
020700     05  PV-DATE-BREAK-SLASH.                                     02320000
020800         10  PV-DBS-MM                PIC  X(02).                 02330000
020900         10  FILLER                   PIC  X(01) VALUE '/'.       02340000
021000         10  PV-DBS-DD                PIC  X(02).                 02350000
021100         10  FILLER                   PIC  X(01) VALUE '/'.       02360000
021200         10  PV-DBS-YY                PIC  X(02).                 02370000
021300     05  PV-OTB-PER-BREAK             PIC  X(06).                 02380000
021400     05  FILLER REDEFINES PV-OTB-PER-BREAK.                       02390000
021500         10  PV-OTBP-CC               PIC  X(02).                 02400000
021600         10  PV-OTBP-YY               PIC  X(02).                 02410000
021700         10  PV-OTBP-MM               PIC  X(02).                 02420000
021800         10  PV-OTBP-MM-N REDEFINES PV-OTBP-MM                    02430000
021900                                      PIC  9(02).                 02440000
022000     05  PV-EDIT-DISC-PCT             PIC  ZZ.                    02450000
022100     05  PV-NUM-DISC-PCT              PIC  9(02) VALUE ZERO.      02460000
022200     05  PV-EDIT-DISC-DAYS            PIC  ZZZ.                   02470000
022300     05  PV-EDIT-DUE-DAYS             PIC  ZZZ.                   02480000
022400     05  PV-EDIT-PAYT-TERM-ID         PIC  ZZ9.                   02490000
022500     05  PV-EDIT-ZIP-CODE             PIC  X(10).                 02500000
022600     05  PV-EDIT-ZIP-NO-DASH REDEFINES PV-EDIT-ZIP-CODE.          02510000
022700         10  PV-EZND-1-5              PIC  X(05).                 02520000
022800         10  PV-EZND-6-9              PIC  X(04).                 02530000
               10  FILLER                   PIC  X(01).                 02540000
022600     05  PV-EDIT-ZIP-DASH REDEFINES PV-EDIT-ZIP-CODE.             02550000
022700         10  PV-EZD-1-5               PIC  X(05).                 02560000
023100         10  PV-EZD-DASH              PIC  X(01).                 02570000
022800         10  PV-EZD-6-9               PIC  X(04).                 02580000
022900     05  PV-ZIP-CODE-DISPLAY.                                     02590000
023000         10  PV-ZCD-1-5               PIC  X(05).                 02600000
023100         10  FILLER                   PIC  X(01) VALUE '-'.       02610000
023200         10  PV-ZCD-6-9               PIC  X(04).                 02620000
023300     05  PV-EDIT-MU-PCT               PIC  ZZZ.99.                02630000
023400     05  PV-DOL-FORM-9                PIC  $$,$$$.99.             02640000
023500     05  PV-DOL-FORM-11               PIC  $$$$,$$$.99.           02650000
023600     05  PV-DOL-FORM-13               PIC  $$,$$$,$$$.99.         02660000
023700     05  PV-DOL-FORM-14               PIC  $$$,$$$,$$$.99.        02670000
023800     05  PV-PCT-HOLD                  PIC  9(04)V9(04).           02680000
023900     05  PV-RECIP-CDE-HOLD            PIC  X(02).                 02690000
024000     05  PV-PO-LINE-NBR               PIC S9(03) COMP-3.          02700000
024100     05  PV-ALLOC-CNT                 PIC S9(09) COMP-3.          02710000
024200     05  PV-UPC-DTL-CNT               PIC S9(09) COMP-3.          02720000
024300     05  PV-NBR-TIMES                 PIC S9(09) COMP-3.          02730000
024400     05  PV-GRP-PRICE.                                            02740000
024500         10  PV-GP-QTY                PIC  ZZZ.                   02750000
024600         10  FILLER                   PIC  X(01) VALUE '/'.       02760000
024700         10  PV-GP-AMT                PIC  $$$$$$.99.             02770000
024800     05  PV-SUB                       PIC S9(04) COMP VALUE +0.   02780000
024900     05  PV-SUB1                      PIC S9(04) COMP VALUE +0.   02790000
025000     05  PV-SUB2                      PIC S9(04) COMP VALUE +0.   02800000
025100     05  ASC-PAYT-TERM-ID-DESC        PIC X(28)     VALUE SPACES. 02810000
C98147     05  PV-PO-NBR                    PIC 9(08)     VALUE ZERO.   02820009
025300     05  IR-PO-NBR2                   PIC S9(09)    VALUE +0 COMP.02830000
025400     05  PV-CITY                      PIC  X(15).                 02840000
025500     05  PV-STATE-PROV                PIC  X(30).                 02850000
025600     05  PV-COUNTRY                   PIC  X(30).                 02860000
025700     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         02870000
025800                                                 COMP SYNC.       02880000
025810* TKMA888 * ADDED 1 LINE *****************************************02890000
025820*           FOR COMPUTING TOTAL PO COST FOR IMPORT PO'S           02900000
025830* TKMA888 *------------------------------------------------------*02910000
025840     05  PV-TOT-VAL-COST-AMT          PIC S9(11)V9(03) COMP-3.    02920000
025850* TKMA888 *------------------------------------------------------*02930000
025900                                                                  02940000
026000* THIS TABLE WILL HOLD UP TO 2000 STORES                          02950000
026100* BUMP OCCURS UP IF KOHL'S IS OPERATING > 2000 STORES             02960000
026200* THIS TABLE HOLDS ALL THE STORES FOR A SKU ON AN ORDER           02970000
026300* IT IS CLEARED OUT BETWEEN LINE NUMBERS                          02980000
026400     05  PV-SAVE-TABLE.                                           02990000
026500         10  PV-SAVE-OCC                OCCURS 2000 TIMES         03000000
026600                                        INDEXED BY PV-STR-IDX.    03010000
026700             15  PV-SAVE-STR-NBR         PIC 9(04).               03020000
026800             15  PV-SAVE-STR-NAME        PIC X(05).               03030000
026900             15  PV-SAVE-STR-QTY         PIC 9(06).               03040000
027000             15  PV-SAVE-STR-SUBTOTAL    PIC S9(09) COMP-3.       03050000
027100             15  PV-UPC-OCC             OCCURS 50 TIMES           03060000
027200                                        INDEXED BY PV-UPC-IDX.    03070000
027300                 20  PV-SAVE-UPC-DESC        PIC X(10).           03080000
027400                 20  PV-SAVE-UPC-QTY-STR     PIC 9(06).           03090000
027500                 20  PV-SAVE-POUPC-QTY       PIC 9(06).           03100000
027600                 20  PV-SAVE-UPC-SUBTOTAL    PIC S9(09) COMP-3.   03110000
W24803     05  PV-NULL-INDICATOR-VARIABLES.                             03120000
W24803         10 PV-MAJ-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   03130000
W24803         10 PV-SUB-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   03140000
W24803         10 PV-SKU-NBR-IND            PIC S9(04) COMP VALUE +0.   03150000
W24803         10 PV-VS-NBR-IND             PIC S9(04) COMP VALUE +0.   03160000
W24803         10 PV-SKU-DESC-IND           PIC S9(04) COMP VALUE +0.   03170000
W24803         10 PV-CSTM-CLOR-DESC-IND     PIC S9(04) COMP VALUE +0.   03180000
W24803         10 PV-SIZE-DESC-IND          PIC S9(04) COMP VALUE +0.   03190000
W24803     05 PV-TEMP-SKU.                                              03200000
W24803         10 PV-TEMP-DEPT              PIC 9(03) VALUE ZEROES.     03210000
W24803         10 PV-TEMP-CLASS             PIC 9(02) VALUE ZEROES.     03220000
W24803         10 PV-TEMP-SEQ               PIC 9(03) VALUE ZEROES.     03230000
W24803     05 PV-TEMP-MAJ-CL.                                           03240000
W24803         10 PV-TEMP-MAJ-CL-1          PIC 9(01) VALUE 0.          03250000
W24803         10 FILLER                    PIC 9(01) VALUE 0.          03260000
027700******************************************************************03270000
027800*  COMMUNICATIONS AREA2 FOR DB2                                   03280000
027900******************************************************************03290000
028000     COPY SQLCA2.                                                 03300000
028100                                                                  03310000
028200******************************************************************03320000
028300*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03330000
028400******************************************************************03340000
028500     COPY DPWS024.                                                03350000
028600                                                                  03360000
028700******************************************************************03370000
028800*  WORKING STORAGE AREA FOR PAYMENT TERMS                         03380000
028900******************************************************************03390000
029000     COPY POWS020.                                                03400000
029100                                                                  03410000
029200******************************************************************03420000
029300*  WORKING STORAGE AREA FOR COUNTRY AND STATE RETRIEVAL           03430000
029400******************************************************************03440000
029500     COPY DPWS410.                                                03450000
029600                                                                  03460000
029700******************************************************************03470000
029800*  PURCHASE ORDER REPORT PRINT LINES                              03480000
029900******************************************************************03490000
030000 01  HEADER-LINE1.                                                03500000
030100     05  FILLER                       PIC  X(11) VALUE            03510000
030200         'PO NUMBER: '.                                           03520000
C98147     05  HL1-PO-NBR                   PIC  ZZZZZZZZ.              03530009
C98147     05  FILLER                       PIC  X(03) VALUE SPACES.    03540009
030500     05  FILLER                       PIC  X(12) VALUE            03550000
030600         'ORDER DATE: '.                                          03560000
030700     05  HL1-ORD-DATE                 PIC  X(08).                 03570000
030800     05  FILLER                       PIC  X(09) VALUE SPACES.    03580000
030900     05  FILLER                       PIC  X(08) VALUE 'K O H L '.03590000
031000     05  FILLER                       PIC  X(01) VALUE QUOTE.     03600000
031100     05  FILLER                       PIC  X(38) VALUE            03610000
031200         ' S   D E P A R T M E N T   S T O R E S'.                03620000
031300     05  FILLER                       PIC  X(18) VALUE SPACES.    03630000
031400     05  FILLER                       PIC  X(06) VALUE 'DATE: '.  03640000
031500     05  HL1-RUN-MONTH                PIC  X(02).                 03650000
031600     05  FILLER                       PIC  X(01) VALUE '/'.       03660000
031700     05  HL1-RUN-DAY                  PIC  X(02).                 03670000
031800     05  FILLER                       PIC  X(01) VALUE '/'.       03680000
031900     05  HL1-RUN-YEAR                 PIC  X(02).                 03690000
032000     05  FILLER                       PIC  X(06) VALUE SPACES.    03700000
032100     05  FILLER                       PIC  X(06) VALUE 'TIME: '.  03710000
032200     05  HL1-RUN-HOUR                 PIC  X(02).                 03720000
032300     05  FILLER                       PIC  X(01) VALUE ':'.       03730000
032400     05  HL1-RUN-MINUTE               PIC  X(02).                 03740000
032500     05  FILLER                       PIC  X(01) VALUE ':'.       03750000
032600     05  HL1-RUN-SECOND               PIC  X(02).                 03760000
032700                                                                  03770000
032800 01  HEADER-LINE2.                                                03780000
032900     05  FILLER                       PIC  X(11) VALUE            03790000
033000         'DEPT.....: '.                                           03800000
033100     05  HL2-DEPT-NBR                 PIC  X(03).                 03810000
033200     05  FILLER                       PIC  X(02) VALUE SPACES.    03820000
033300     05  HL2-DEPT-NAME                PIC  X(25).                 03830000
033400     05  FILLER                       PIC  X(01) VALUE SPACES.    03840000
033500     05  FILLER                       PIC  X(46) VALUE            03850000
033600         'P U R C H A S E   O R D E R - (SUBJECT TO KOHL'.        03860000
033700     05  FILLER                       PIC  X(01) VALUE QUOTE.     03870000
033800     05  FILLER                       PIC  X(23) VALUE            03880000
033900         'S TERMS AND CONDITIONS)'.                               03890000
034000     05  FILLER                       PIC  X(24) VALUE SPACES.    03900000
034100     05  FILLER                       PIC  X(06) VALUE 'PAGE: '.  03910000
034200     05  HL2-PAGE                     PIC  ZZZZ,ZZZ.              03920000
034300                                                                  03930000
034400 01  HEADER-LINE3.                                                03940000
034500     05  FILLER                       PIC  X(69) VALUE SPACES.    03950000
034600     05  HL3-VERSION                  PIC  X(12).                 03960000
034700     05  FILLER                       PIC  X(69) VALUE SPACES.    03970000
034800                                                                  03980000
034900 01  HEADER-LINE4.                                                03990000
035000     05  FILLER                       PIC  X(10) VALUE            04000000
035100         ' VENDOR.: '.                                            04010000
035200     05  HL4-VEND-NAME                PIC  X(30).                 04020000
035300     05  FILLER                       PIC  X(20) VALUE SPACES.    04030000
035400     05  FILLER                       PIC  X(17) VALUE            04040000
035500         'MARKUP.........: '.                                     04050000
035600     05  HL4-MU-PCT                   PIC  X(06).                 04060000
035700     05  FILLER                       PIC  X(02) VALUE ' %'.      04070000
035800     05  FILLER                       PIC  X(28) VALUE SPACES.    04080000
035900     05  FILLER                       PIC  X(26) VALUE            04090000
036000         'DO NOT SHIP BEFORE......: '.                            04100000
036100     05  HL4-DNSB-MONTH               PIC  X(02).                 04110000
036200     05  FILLER                       PIC  X(01) VALUE '/'.       04120000
036300     05  HL4-DNSB-DAY                 PIC  X(02).                 04130000
036400     05  FILLER                       PIC  X(01) VALUE '/'.       04140000
036500     05  HL4-DNSB-YEAR                PIC  X(02).                 04150000
036600     05  FILLER                       PIC  X(03) VALUE SPACES.    04160000
036700                                                                  04170000
036800 01  HEADER-LINE5.                                                04180000
036900     05  FILLER                       PIC  X(10) VALUE SPACES.    04190000
037000     05  HL5-VEND-ADDR-1              PIC  X(40).                 04200000
037100     05  FILLER                       PIC  X(10) VALUE SPACES.    04210000
037200     05  FILLER                       PIC  X(17) VALUE            04220000
037300         'COST...........: '.                                     04230000
037400     05  HL5-COST                     PIC  $$$,$$$,$$$.99.        04240000
037500     05  FILLER                       PIC  X(22) VALUE SPACES.    04250000
037600     05  FILLER                       PIC  X(26) VALUE            04260000
037700         'CANCEL IF NOT SHIPPED BY: '.                            04270000
037800     05  HL5-CNSB-MONTH               PIC  X(02).                 04280000
037900     05  FILLER                       PIC  X(01) VALUE '/'.       04290000
038000     05  HL5-CNSB-DAY                 PIC  X(02).                 04300000
038100     05  FILLER                       PIC  X(01) VALUE '/'.       04310000
038200     05  HL5-CNSB-YEAR                PIC  X(02).                 04320000
038300     05  FILLER                       PIC  X(03) VALUE SPACES.    04330000
038400                                                                  04340000
038500 01  HEADER-LINE6.                                                04350000
038600     05  FILLER                       PIC  X(10) VALUE SPACES.    04360000
038700     05  HL6-VEND-ADDR-2              PIC  X(40).                 04370000
038800     05  FILLER                       PIC  X(10) VALUE SPACES.    04380000
038900     05  FILLER                       PIC  X(17) VALUE            04390000
039000         'RETAIL.........: '.                                     04400000
039100     05  HL6-RETAIL                   PIC  X(14).                 04410000
039200     05  FILLER                       PIC  X(22) VALUE SPACES.    04420000
039300     05  FILLER                       PIC  X(26) VALUE            04430000
039400         'OTB PERIOD..............: '.                            04440000
039500     05  HL6-OTBP-MONTH               PIC  X(03).                 04450000
039600     05  FILLER                       PIC  X(01) VALUE ' '.       04460000
039700     05  HL6-OTBP-YEAR                PIC  X(02).                 04470000
039800     05  FILLER                       PIC  X(05) VALUE SPACES.    04480000
039900                                                                  04490000
040000 01  HEADER-LINE7.                                                04500000
040100     05  FILLER                       PIC  X(10) VALUE SPACES.    04510000
040200     05  HL7-VEND-ADDR-3              PIC  X(40).                 04520000
040300     05  FILLER                       PIC  X(10) VALUE SPACES.    04530000
040400     05  FILLER                       PIC  X(17) VALUE            04540000
040500         'UNITS..........: '.                                     04550000
040600     05  HL7-UNITS                    PIC  Z,ZZZ,ZZZ.             04560000
040700     05  FILLER                       PIC  X(27) VALUE SPACES.    04570000
040800     05  FILLER                       PIC  X(15) VALUE            04580000
040900         'EDI..........: '.                                       04590000
041000     05  HL7-EDI                      PIC  X(03).                 04600000
041100     05  FILLER                       PIC  X(02) VALUE SPACES.    04610000
041200     05  HL7-EDI-DEAL                 PIC  X(16).                 04620000
041300     05  FILLER                       PIC  X(01) VALUE SPACES.    04630000
041400                                                                  04640000
041500 01  HEADER-LINE8.                                                04650000
041600     05  FILLER                       PIC  X(60) VALUE SPACES.    04660000
041700     05  FILLER                       PIC  X(17) VALUE            04670000
041800         'PAYMENT TERM...: '.                                     04680000
041900     05  HL8-PAY-TERM                 PIC  X(28).                 04690000
042000     05  FILLER                       PIC  X(08) VALUE SPACES.    04700000
042100     05  FILLER                       PIC  X(15) VALUE            04710000
042200         'NEW STORE....: '.                                       04720000
042300     05  HL8-NEW-STORE                PIC  X(03).                 04730000
042400     05  FILLER                       PIC  X(19) VALUE SPACES.    04740000
042500                                                                  04750000
042600 01  HEADER-LINE9.                                                04760000
042700     05  FILLER                       PIC  X(60) VALUE SPACES.    04770000
042800     05  FILLER                       PIC  X(17) VALUE            04780000
042900         'EXTENDED DATING: '.                                     04790000
043000     05  HL9-EXTEND-DATE              PIC  ZZZ.                   04800000
043100     05  FILLER                       PIC  X(05) VALUE ' DAYS'.   04810000
043200     05  FILLER                       PIC  X(28) VALUE SPACES.    04820000
043300     05  FILLER                       PIC  X(15) VALUE            04830000
043400         'PRETICKETING.: '.                                       04840000
043500     05  HL9-PRE-TICK                 PIC  X(03).                 04850000
043600     05  FILLER                       PIC  X(14) VALUE            04860000
043700         '    HANGERS.: '.                                        04870000
043800     05  HL9-HANGERS                  PIC  X(03).                 04880000
043900     05  FILLER                       PIC  X(02) VALUE SPACES.    04890000
044000                                                                  04900000
044100 01  HEADER-LINE10.                                               04910000
044200     05  FILLER                       PIC  X(10) VALUE            04920000
044300         ' SHIP TO: '.                                            04930000
044400     05  HL10-SHIP-TO-NAME            PIC  X(40).                 04940000
044500     05  FILLER                       PIC  X(10) VALUE SPACES.    04950000
044600     05  FILLER                       PIC  X(17) VALUE            04960000
044700         'VENDOR DISCOUNT: '.                                     04970000
044800     05  HL10-VEND-DIS-AMT            PIC  $$$$$$.99.             04980000
044900     05  FILLER                       PIC  X(02) VALUE SPACES.    04990000
045000     05  HL10-VEND-DIS-PCT            PIC  ZZ.99.                 05000000
045100     05  FILLER                       PIC  X(02) VALUE ' %'.      05010000
045200     05  FILLER                       PIC  X(18) VALUE SPACES.    05020000
045300     05  FILLER                       PIC  X(15) VALUE            05030000
045400         'PACK BY STORE: '.                                       05040000
045500     05  HL10-PACK-STORE              PIC  X(03).                 05050000
045600     05  FILLER                       PIC  X(19) VALUE SPACES.    05060000
045700                                                                  05070000
045800 01  HEADER-LINE11.                                               05080000
045900     05  FILLER                       PIC  X(10) VALUE SPACES.    05090000
046000     05  HL11-SHIP-TO-ADDR-1          PIC  X(30).                 05100000
046100     05  FILLER                       PIC  X(20) VALUE SPACES.    05110000
046200     05  FILLER                       PIC  X(17) VALUE            05120000
046300         'MARK OUT OF STK: '.                                     05130000
046400     05  HL11-MOS-PCT                 PIC  ZZ.99.                 05140000
046500     05  FILLER                       PIC  X(02) VALUE ' %'.      05150000
046600     05  FILLER                       PIC  X(29) VALUE SPACES.    05160000
046700     05  FILLER                       PIC  X(15) VALUE            05170000
046800         'CREATED BY...: '.                                       05180000
046900     05  HL11-CREATED-BY              PIC  X(20).                 05190000
047000     05  FILLER                       PIC  X(02) VALUE SPACES.    05200000
047100                                                                  05210000
047200 01  HEADER-LINE12.                                               05220000
047300     05  FILLER                       PIC  X(10) VALUE SPACES.    05230000
047400     05  HL12-SHIP-TO-ADDR-2          PIC  X(40).                 05240000
047500     05  FILLER                       PIC  X(10) VALUE SPACES.    05250000
047600     05  FILLER                       PIC  X(17) VALUE            05260000
047700         'TRADE..........: '.                                     05270000
047800     05  HL12-TRD-PCT                 PIC  ZZ.99.                 05280000
047900     05  FILLER                       PIC  X(02) VALUE ' %'.      05290000
048000     05  FILLER                       PIC  X(29) VALUE SPACES.    05300000
048100     05  FILLER                       PIC  X(15) VALUE            05310000
048200         'BUYER........: '.                                       05320000
048300     05  HL12-BUYER                   PIC  X(20).                 05330000
048400     05  FILLER                       PIC  X(02) VALUE SPACES.    05340000
048500                                                                  05350000
048600 01  HEADER-LINE13.                                               05360000
048700     05  FILLER                       PIC  X(10) VALUE SPACES.    05370000
048800     05  HL13-SHIP-TO-ADDR-3          PIC  X(40).                 05380000
048900     05  FILLER                       PIC  X(10) VALUE SPACES.    05390000
049000     05  FILLER                       PIC  X(17) VALUE            05400000
049100         'ADVERTISING PCT: '.                                     05410000
049200     05  HL13-ADV-PCT                 PIC  ZZ.99.                 05420000
049300     05  FILLER                       PIC  X(02) VALUE ' %'.      05430000
049400     05  FILLER                       PIC  X(29) VALUE SPACES.    05440000
049500     05  FILLER                       PIC  X(15) VALUE            05450000
049600         'APPROVED BY..: '.                                       05460000
049700     05  HL13-APPROVE-BY              PIC  X(20).                 05470000
049800     05  FILLER                       PIC  X(02) VALUE SPACES.    05480000
049900                                                                  05490000
050000 01  HEADER-LINE14.                                               05500000
050100     05  FILLER                       PIC  X(60) VALUE SPACES.    05510000
050200     05  FILLER                       PIC  X(20) VALUE            05520000
050300         'ADDITIONAL DISCOUNTS'.                                  05530000
050400     05  FILLER                       PIC  X(70) VALUE SPACES.    05540000
050500                                                                  05550000
050600 01  HEADER-LINE15.                                               05560000
050700     05  FILLER                       PIC  X(60) VALUE SPACES.    05570000
050800     05  FILLER                       PIC  X(17) VALUE            05580000
050900         'MISC. DAY(S)...: '.                                     05590000
051000     05  HL15-ADDL-DAYS               PIC  ZZZ.                   05600000
051100     05  FILLER                       PIC  X(72) VALUE SPACES.    05610000
051200                                                                  05620000
051300 01  HEADER-LINE16.                                               05630000
051400     05  FILLER                       PIC  X(60) VALUE SPACES.    05640000
051500     05  FILLER                       PIC  X(17) VALUE            05650000
051600         'MISC. AMOUNT...: '.                                     05660000
051700     05  HL16-ADDL-AMOUNT             PIC  ZZZZZZ.99.             05670000
051800     05  FILLER                       PIC  X(66) VALUE SPACES.    05680000
051900                                                                  05690000
052000 01  HEADER-LINE17.                                               05700000
052100     05  FILLER                       PIC  X(60) VALUE SPACES.    05710000
052200     05  FILLER                       PIC  X(17) VALUE            05720000
052300         'MISC. PERCENT..: '.                                     05730000
052400     05  HL17-ADDL-PERCENT            PIC  ZZ.99.                 05740000
052500     05  FILLER                       PIC  X(02) VALUE ' %'.      05750000
052600     05  FILLER                       PIC  X(68) VALUE SPACES.    05760000
052700                                                                  05770000
052800 01  HEADER-LINE18.                                               05780000
052900     05  FILLER                       PIC  X(60) VALUE SPACES.    05790000
053000     05  FILLER                       PIC  X(17) VALUE            05800000
053100         'PAYS FREIGHT...: '.                                     05810000
053200     05  HL18-PAY-FRT                 PIC  X(10).                 05820000
053300     05  FILLER                       PIC  X(65) VALUE SPACES.    05830000
053400                                                                  05840000
053500 01  HEADER-LINE19.                                               05850000
053600     05  FILLER                       PIC  X(60) VALUE SPACES.    05860000
053700     05  FILLER                       PIC  X(17) VALUE            05870000
053800         'AD MERCHANDISE.: '.                                     05880000
053900     05  HL19-AD-MERCH                PIC  X(03).                 05890000
054000     05  FILLER                       PIC  X(10) VALUE            05900000
054100         ' AD DATE: '.                                            05910000
054200     05  HL19-AD-DATE                 PIC  X(08).                 05920000
054300     05  FILLER                       PIC  X(52) VALUE SPACES.    05930000
054400                                                                  05940000
054500 01  INSTR-HEADER.                                                05950000
054600     05  FILLER                       PIC  X(13) VALUE            05960000
054700         'INSTRUCTIONS:'.                                         05970000
054800     05  FILLER                       PIC  X(137) VALUE SPACES.   05980000
054900                                                                  05990000
055000 01  INSTR-RECIP-LINE.                                            06000000
055100     05  FILLER                       PIC  X(13) VALUE            06010000
055200         '  RECIPIENT: '.                                         06020000
055300     05  INSTR-RECIP                  PIC  X(15).                 06030000
055400     05  FILLER                       PIC  X(122) VALUE SPACES.   06040000
055500                                                                  06050000
055600 01  INSTR-LINE.                                                  06060000
055700     05  INSTR-DESC                   PIC  X(150).                06070000
055800                                                                  06080000
055900 01  SKU-LINE-1.                                                  06090000
056000     05  SL1-SKU-NBR                  PIC  999.                   06100000
W24803     05  FILLER                       PIC  X(01) VALUE SPACES.    06110000
W24803     05  FILLER                       PIC  X(05) VALUE 'DEPT:'.   06120000
056200     05  SL1-DEPT                     PIC  X(03).                 06130000
056300     05  FILLER                       PIC  X(01) VALUE SPACES.    06140000
W24803     05  FILLER                       PIC  X(04) VALUE 'MCL:'.    06150000
W24803     05  SL1-MAJ-CLASS                PIC  9(02).                 06160000
W24803     05  FILLER                       PIC  X(01) VALUE SPACES.    06170000
W24803     05  FILLER                       PIC  X(04) VALUE 'SCL:'.    06180000
W24803     05  SL1-CLASS                    PIC  9(02).                 06190000
056500     05  FILLER                       PIC  X(01) VALUE SPACES.    06200000
W24803     05  FILLER                       PIC  X(04) VALUE 'SKU:'.    06210000
W24803     05  SL1-SKU                      PIC  9(08).                 06220000
W24803     05  FILLER                       PIC  X(07) VALUE            06230000
W24803         ' STYLE:'.                                               06240000
056900     05  SL1-STYLE                    PIC  X(20).                 06250000
W24803     05  FILLER                       PIC  X(06) VALUE            06260000
W24803         ' DESC:'.                                                06270000
W24803     05  SL1-DESC                     PIC  X(19).                 06280000
W24803     05  FILLER                       PIC  X(10) VALUE            06290000
W24803         ' QUANTITY:'.                                            06300000
057500     05  SL1-QTY                      PIC  ZZZ,ZZZ.               06310000
W24803     05  FILLER                       PIC  X(06) VALUE ' COST:'.  06320000
057700     05  SL1-COST                     PIC  $$,$$$.999.            06330000
W24803     05  FILLER                       PIC  X(12) VALUE            06340000
W24803         ' TOTAL COST:'.                                          06350000
058000     05  SL1-TOT-COST                 PIC  $$$,$$$,$$$.99.        06360000
058100                                                                  06370000
058200 01  SKU-LINE-2.                                                  06380000
058300     05  FILLER                       PIC  X(06) VALUE            06390000
058400         ' CLR: '.                                                06400000
058500     05  SL2-COLOR                    PIC  X(25).                 06410000
058600     05  FILLER                       PIC  X(07) VALUE ' SIZE: '. 06420000
058700     05  SL2-SIZE                     PIC  X(25).                 06430000
058800     05  FILLER                       PIC  X(09) VALUE            06440000
058900         ' AD DTE: '.                                             06450000
059000     05  SL2-AD-DATE                  PIC  X(08).                 06460000
059100     05  FILLER                       PIC  X(08) VALUE            06470000
059200         ' GROUP: '.                                              06480000
059300     05  SL2-GRP-PRICE                PIC  X(13).                 06490000
059400     05  FILLER                       PIC  X(06) VALUE            06500000
059500         ' RET: '.                                                06510000
059600     05  SL2-RTL-COST                 PIC  X(14).                 06520000
059700     05  FILLER                       PIC  X(15) VALUE            06530000
059800         ' TOTAL RETAIL: '.                                       06540000
059900     05  SL2-TOT-RTL-COST             PIC  X(14).                 06550000
060000                                                                  06560000
060100 01  LINE-CANCEL-LINE.                                            06570000
060200     05  FILLER                       PIC  X(39) VALUE            06580000
060300         '   *** THIS LINE HAS BEEN CANCELLED ***'.               06590000
060400     05  FILLER                       PIC  X(111) VALUE SPACES.   06600000
060500                                                                  06610000
060600 01  DISTR-HEADER-1.                                              06620000
060700     05  FILLER                       PIC  X(22) VALUE            06630000
060800         '   STORE DISTRIBUTION:'.                                06640000
060900     05  FILLER                       PIC  X(128) VALUE SPACES.   06650000
061000                                                                  06660000
061100 01  DISTR-HEADER-2.                                              06670000
061200     05  FILLER                       PIC  X(03) VALUE SPACES.    06680000
061300     05  DH2-COL-HDR                  OCCURS 4 TIMES              06690000
061400                                      PIC  X(35).                 06700000
061500 01  DISTR-HEADER-3.                                              06710000
061600     05  FILLER                       PIC  X(03) VALUE SPACES.    06720000
061700     05  DH3-COL-HDR                  OCCURS 7 TIMES              06730000
061800                                      PIC  X(21).                 06740000
061900*01  DISTR-HEADER-3.                                              06750000
062000*    05  FILLER                       PIC  X(03) VALUE SPACES.    06760000
062100*    05  DH3-COL-HDR                  OCCURS 4 TIMES              06770000
062200*                                     PIC  X(22).                 06780000
062300                                                                  06790000
062400 01  DISTR-LINE.                                                  06800000
062500     05  FILLER                       PIC  X(03) VALUE SPACES.    06810000
062600     05  DL-DISTR                     OCCURS 4 TIMES.             06820000
062700         10  FILLER                   PIC  X(01) VALUE SPACES.    06830000
062800         10  DL-STR-NBR               PIC  ZZZZ.                  06840000
062900         10  FILLER                   PIC  X(01) VALUE SPACES.    06850000
063000         10  DL-STR-NAME              PIC  X(05).                 06860000
063100         10  FILLER                   PIC  X(02) VALUE SPACES.    06870000
063200         10  DL-TOTAL-HDR             PIC  X(05) VALUE SPACES.    06880000
063300         10  FILLER                   PIC  X(08) VALUE SPACES.    06890000
063400         10  DL-QTY                   PIC  ZZZ,ZZZ.               06900000
063500         10  FILLER                   PIC  X(03) VALUE SPACES.    06910000
063600                                                                  06920000
063700 01  DISTR-LINE-OLD.                                              06930000
063800     05  FILLER                       PIC  X(03) VALUE SPACES.    06940000
063900     05  DL-DISTR-OLD                 OCCURS 7 TIMES.             06950000
064000         10  FILLER                   PIC  X(01) VALUE SPACES.    06960000
064100         10  DL-STR-NBR-OLD           PIC  ZZZZ.                  06970000
064200         10  FILLER                   PIC  X(01) VALUE SPACES.    06980000
064300         10  DL-STR-NAME-OLD          PIC  X(05).                 06990000
064400         10  FILLER                   PIC  X(02) VALUE SPACES.    07000000
064500         10  DL-QTY-OLD               PIC  ZZZ,ZZZ.               07010000
064600         10  FILLER                   PIC  X(01) VALUE SPACES.    07020002
064700                                                                  07030000
064800                                                                  07040000
064900 01  UPC-LINE.                                                    07050000
065000     05  FILLER                       PIC  X(15) VALUE SPACES.    07060000
065100     05  DL-UPC                       OCCURS 4 TIMES.             07070000
065200         10  DL-UPC-DESC              PIC  X(10) VALUE SPACES.    07080000
065300         10  FILLER                   PIC  X(03) VALUE SPACES.    07090000
065400         10  DL-UPC-QTY               PIC  ZZZ,ZZZ.               07100000
065500         10  FILLER                   PIC  X(15) VALUE SPACES.    07110000
065600                                                                  07120000
065700 01  END-REPORT-LINE.                                             07130000
065800     05  FILLER                       PIC  X(64) VALUE SPACES.    07140000
065900     05  FILLER                       PIC  X(21) VALUE            07150000
066000         'END OF PURCHASE ORDER'.                                 07160000
066100     05  FILLER                       PIC  X(65) VALUE SPACES.    07170000
066200                                                                  07180000
066300 01  NOT-APPROVED-LINE.                                           07190000
066400     05  FILLER                       PIC  X(48) VALUE            07200000
066500         '***** PURCHASE ORDER HAS NOT BEEN APPROVED *****'.      07210000
066600     05  FILLER                       PIC  X(102) VALUE SPACES.   07220000
066700                                                                  07230000
066800 01  CANCELLED-LINE.                                              07240000
066900     05  FILLER                       PIC  X(45) VALUE            07250000
067000         '***** PURCHASE ORDER HAS BEEN CANCELLED *****'.         07260000
067100     05  FILLER                       PIC  X(105) VALUE SPACES.   07270000
067200                                                                  07280000
067300 01  REVISED-LINE.                                                07290000
067400     05  FILLER                       PIC  X(43) VALUE            07300000
067500         '***** PURCHASE ORDER HAS BEEN REVISED *****'.           07310000
067600     05  FILLER                       PIC  X(107) VALUE SPACES.   07320000
067700                                                                  07330000
067800 01  BLANK-REPORT-LINE.                                           07340000
067900     05  FILLER                       PIC  X(58) VALUE SPACES.    07350000
068000     05  FILLER                       PIC  X(34) VALUE            07360000
068100         'THIS PAGE INTENTIONALLY LEFT BLANK'.                    07370000
068200     05  FILLER                       PIC  X(58) VALUE SPACES.    07380000
068300                                                                  07390000
068400/                                                                 07400000
068500******************************************************************07410000
068600*  COMMUNICATIONS AREA FOR DB2                                    07420000
068700******************************************************************07430000
068800     EXEC SQL                                                     07440000
068900          INCLUDE SQLCA                                           07450000
069000     END-EXEC.                                                    07460000
069100******************************************************************07470000
069200*  COPY BOOK FOR PURCHASE ORDER TABLE                             07480000
069300******************************************************************07490000
069400     EXEC SQL                                                     07500000
069500          INCLUDE TPURCHS                                         07510000
069600     END-EXEC.                                                    07520000
069700******************************************************************07530000
069800*  COPY BOOK FOR SKU TABLE                                        07540000
069900******************************************************************07550000
070000     EXEC SQL                                                     07560000
070100          INCLUDE TSK                                             07570000
070200     END-EXEC.                                                    07580000
070300******************************************************************07590000
070400*  COPY BOOK FOR PURCHASE ITEM TABLE                              07600000
070500******************************************************************07610000
070600     EXEC SQL                                                     07620000
070700          INCLUDE TPURITM                                         07630000
070800     END-EXEC.                                                    07640000
070900******************************************************************07650000
071000*  COPY BOOK FOR PO PLANNED SHIPMENT TABLE                        07660000
071100******************************************************************07670000
071200     EXEC SQL                                                     07680000
071300          INCLUDE TPLNSHP                                         07690000
071400     END-EXEC.                                                    07700000
071500******************************************************************07710000
071600*  COPY BOOK FOR PO AGREEMENT TABLE                               07720000
071700******************************************************************07730000
071800     EXEC SQL                                                     07740000
071900          INCLUDE TPOAGMT                                         07750000
072000     END-EXEC.                                                    07760000
072100******************************************************************07770000
072200*  COPY BOOK FOR PO INSTRUCTION TABLE                             07780000
072300******************************************************************07790000
072400     EXEC SQL                                                     07800000
072500          INCLUDE TPOINST                                         07810000
072600     END-EXEC.                                                    07820000
072700******************************************************************07830000
072800*  COPY BOOK FOR INSTRUCTION CODE TABLE                           07840000
072900******************************************************************07850000
073000     EXEC SQL                                                     07860000
073100          INCLUDE TINSTCD                                         07870000
073200     END-EXEC.                                                    07880000
073300******************************************************************07890000
073400*  COPY BOOK FOR RECIPENT CODE TABLE                              07900000
073500******************************************************************07910000
073600     EXEC SQL                                                     07920000
073700          INCLUDE TINRCCD                                         07930000
073800     END-EXEC.                                                    07940000
073900******************************************************************07950000
074000*  COPY BOOK FOR ALLOCATION PLAN TABLE                            07960000
074100******************************************************************07970000
074200     EXEC SQL                                                     07980000
074300          INCLUDE TALLPLN                                         07990000
074400     END-EXEC.                                                    08000000
074500******************************************************************08010000
074600*  COPY BOOK FOR MERCHANDISE STORE DISTRIBUTION TABLE             08020000
074700******************************************************************08030000
074800     EXEC SQL                                                     08040000
074900          INCLUDE TMESTDS                                         08050000
075000     END-EXEC.                                                    08060000
075100******************************************************************08070000
075200*  COPY BOOK FOR EXTERNAL ENTERPRISE NAME TABLE                   08080000
075300******************************************************************08090000
075400     EXEC SQL                                                     08100000
075500          INCLUDE TENTNME                                         08110000
075600     END-EXEC.                                                    08120000
075700******************************************************************08130000
075800*  COPY BOOK FOR ENTERPRISE LOCATION TABLE                        08140000
075900******************************************************************08150000
076000     EXEC SQL                                                     08160000
076100          INCLUDE TBUSLOC                                         08170000
076200     END-EXEC.                                                    08180000
076300******************************************************************08190000
076400*  COPY BOOK FOR VENDOR PAYMENT TERM TABLE                        08200000
076500******************************************************************08210000
076600     EXEC SQL                                                     08220000
076700          INCLUDE TPAYTRM                                         08230000
076800     END-EXEC.                                                    08240000
076900******************************************************************08250000
077000*  COPY BOOK FOR LOCATION TABLE                                   08260000
077100******************************************************************08270000
077200     EXEC SQL                                                     08280000
077300          INCLUDE XMT00001                                        08290000
077400     END-EXEC.                                                    08300000
077500******************************************************************08310000
077600*  COPY BOOK FOR WORKER ID TABLE                                  08320000
077700******************************************************************08330000
077800     EXEC SQL                                                     08340000
077900          INCLUDE TWORKER                                         08350000
078000     END-EXEC.                                                    08360000
078100******************************************************************08370000
078200*  COPY BOOK FOR MERCHANDISE AREA                                 08380000
078300******************************************************************08390000
078400     EXEC SQL                                                     08400000
078500          INCLUDE TMDSEAR                                         08410000
078600     END-EXEC.                                                    08420000
078700******************************************************************08430000
078800*  COPY BOOK FOR MERCHANDISE AREA                                 08440000
078900******************************************************************08450000
079000     EXEC SQL                                                     08460000
079100          INCLUDE TRSPBAR                                         08470000
079200     END-EXEC.                                                    08480000
079300                                                                  08490000
080600*    EXEC SQL                                                     08500027
080700*         INCLUDE TPOUPC                                          08510027
080800*    END-EXEC.                                                    08520027
080900                                                                  08530000
W24803******************************************************************08540000
W24803*  COPY BOOK FOR DOMAIN TABLES                                    08550000
W24803******************************************************************08560000
W24803     EXEC SQL                                                     08570000
W24803          INCLUDE XLT00003                                        08580000
W24803     END-EXEC.                                                    08590000
W24803                                                                  08600000
W24803     EXEC SQL                                                     08610000
W24803          INCLUDE XLT00006                                        08620000
W24803     END-EXEC.                                                    08630000
W24803                                                                  08640000
W24803     EXEC SQL                                                     08650000
W24803          INCLUDE XLT00004                                        08660000
W24803     END-EXEC.                                                    08670000
W24803                                                                  08680000
081000******************************************************************08690000
081100*    PULL ALL VENDOR UPC'S FOR EACH SKU THAT HAVE POUPC QUANTITIES08700000
081200******************************************************************08710000
081300*    EXEC SQL                                                     08720028
081400*        DECLARE UPC_CURSOR CURSOR FOR                            08730028
W24803*       SELECT  A.SIZE_DESC,                                      08740028
081600*               B.UPC_QTY,                                        08750028
W24803*               A.KOHLS_SIZE_CDE                                  08760028
W24803*        FROM XLT_SKU A,                                          08770028
082100*             TPOUPC  B,                                          08780028
W24803*             XLT_UPC C                                           08790028
W24803*        WHERE A.SKU_NBR      = :XLT00003-SKU-NBR                 08800028
W24803*          AND A.INTR_UPC_ID  = C.INTR_UPC_ID                     08810028
083100*          AND B.UPC_ID       = C.UPC_ID                          08820028
W24803*          AND B.PO_NBR       = :POUPC-PO-NBR                     08830028
083300*          AND B.PO_LNE_NBR   = :PURITM-PO-LNE-NBR                08840028
083400*          AND C.UPC_TYP_CDE  = 'V'                               08850028
W24803*        ORDER BY 3                                               08860028
083700*          FOR FETCH ONLY                                         08870028
083800*    END-EXEC.                                                    08880028
083900*EJECT                                                            08890028
084000******************************************************************08900000
084100*  CURSOR FOR INSTRUCTIONS                                        08910000
084200******************************************************************08920000
084300     EXEC SQL                                                     08930000
084400         DECLARE INST-CSR CURSOR FOR                              08940000
084500         SELECT B.INSTR_DESC,                                     08950000
084600                B.INSTR_NBR,                                      08960000
084700                C.RECIP_CDE,                                      08970000
084800                C.RECIP_DESC                                      08980000
084900         FROM   TPOINST A,                                        08990000
085000                TINSTCD B,                                        09000000
085100                TINRCCD C                                         09010000
085200         WHERE A.PO_NBR = :IR-PO-NBR2                             09020000
085300           AND A.RECIP_CDE LIKE :POINST-RECIP-CDE                 09030000
085400           AND B.INSTR_NBR = A.INSTR_NBR                          09040000
085500           AND C.RECIP_CDE = A.RECIP_CDE                          09050000
085600         ORDER BY RECIP_CDE, INSTR_NBR                            09060000
085700     END-EXEC.                                                    09070000
085800******************************************************************09080000
085900*  CURSOR FOR PO LINE ITEMS NOT APPROVED                          09090000
086000******************************************************************09100000
086100     EXEC SQL                                                     09110000
086200         DECLARE PO-LINE-CSR CURSOR FOR                           09120000
086300         SELECT CL_NBR,                                           09130000
086400                SKU_SEQ_NBR,                                      09140000
086500                VEND_STYL_NAME,                                   09150000
W24803                C.SKU_DESC,                                       09160000
W24803                B.MAJ_CL_NBR,                                     09170000
W24803                B.SUB_CL_NBR,                                     09180000
W24803                A.SKU_NBR,                                        09190000
W24803                B.VS_NBR,                                         09200000
W24803                A.SKU_DESC,                                       09210000
086700                UNT_QTY,                                          09220000
086800                UNT_COST_AMT,                                     09230000
086900                TOT_VAL_COST_AMT,                                 09240000
087000                COLOR_DESC,                                       09250000
W24803                C.SIZE_DESC,                                      09260000
W24803                A.CSTM_CLOR_DESC,                                 09270000
W24803                A.SIZE_DESC,                                      09280000
087200                AD_EVNT_DTE,                                      09290000
087300                GP_QTY,                                           09300000
087400                GP_RTL_AMT,                                       09310000
087500                UNT_RTL_PR_AMT,                                   09320000
087600                TOT_VAL_RTL_AMT,                                  09330000
087700                PO_LNE_NBR,                                       09340000
087800                STATUS_CDE,                                       09350000
087810* TKMA888 * ADDED 1 LINES ****************************************09360000
087820                PRD_1ST_COST_AMT,                                 09370000
087830* TKMA888 *------------------------------------------------------*09380000
W24803                C.ITM_NBR                                         09390000
W24803         FROM   TPURITM C LEFT OUTER JOIN                         09400000
W24803                XLT_SKU A ON C.ITM_NBR = A.ITM_NBR                09410000
W24803                LEFT OUTER JOIN                                   09420000
W24803                XLT_VND_STYL B ON A.STYL_ID = B.STYL_ID           09430000
W24803         WHERE  PO_NBR              = :PURITM-PO-NBR              09440000
088200                AND  VER_STATUS_CDE = 'A'                         09450000
                      AND  UNT_QTY > 0                                  09460000
088300         ORDER  BY PO_LNE_NBR                                     09470000
088400     END-EXEC.                                                    09480000
088500******************************************************************09490000
088600*  CURSOR FOR PO LINE ITEMS APPROVED                              09500000
088700******************************************************************09510000
088800     EXEC SQL                                                     09520000
088900         DECLARE APP-PO-LINE-CSR CURSOR FOR                       09530000
089000         SELECT CL_NBR,                                           09540000
089100                SKU_SEQ_NBR,                                      09550000
089200                VEND_STYL_NAME,                                   09560000
W24803                C.SKU_DESC,                                       09570000
W24803                B.MAJ_CL_NBR,                                     09580000
W24803                B.SUB_CL_NBR,                                     09590000
W24803                A.SKU_NBR,                                        09600000
W24803                B.VS_NBR,                                         09610000
W24803                A.SKU_DESC,                                       09620000
089400                UNT_QTY,                                          09630000
089500                UNT_COST_AMT,                                     09640000
089600                TOT_VAL_COST_AMT,                                 09650000
W24803                C.COLOR_DESC,                                     09660000
W24803                C.SIZE_DESC,                                      09670000
W24803                CSTM_CLOR_DESC,                                   09680000
W24803                A.SIZE_DESC,                                      09690000
089900                AD_EVNT_DTE,                                      09700000
090000                GP_QTY,                                           09710000
090100                GP_RTL_AMT,                                       09720000
090200                UNT_RTL_PR_AMT,                                   09730000
090300                TOT_VAL_RTL_AMT,                                  09740000
090400                PO_LNE_NBR,                                       09750000
090500                APP_PO_LNE_NBR,                                   09760000
090600                STATUS_CDE,                                       09770000
090610* TKMA888 * ADDED 1 LINES ****************************************09780000
090620                PRD_1ST_COST_AMT,                                 09790000
090630* TKMA888 *------------------------------------------------------*09800000
W24803                C.ITM_NBR                                         09810000
W24803         FROM   TPURITM C LEFT OUTER JOIN                         09820000
W24803                XLT_SKU A ON C.ITM_NBR = A.ITM_NBR                09830000
W24803                LEFT OUTER JOIN                                   09840000
W24803                XLT_VND_STYL B ON A.STYL_ID = B.STYL_ID           09850000
W24803         WHERE  PO_NBR = : PURITM-PO-NBR                          09860000
091000           AND  VER_STATUS_CDE = 'A'                              09870000
                 AND  UNT_QTY > 0                                       09880000
091100         ORDER BY APP_PO_LNE_NBR                                  09890000
091200     END-EXEC.                                                    09900000
091300******************************************************************09910000
091400*  CURSOR FOR STORE DISTRIBUTIONS (ALLOCATIONS)                   09920000
091500******************************************************************09930000
091600     EXEC SQL                                                     09940000
091700         DECLARE ALLOC-CSR CURSOR FOR                             09950000
091800         SELECT A.STR_NBR,                                        09960000
091900                A.STR_DISTRO_QTY,                                 09970000
092000                B.LOC_5_ABBR_NM                                   09980000
092100         FROM TMESTDS A,                                          09990000
092200              XMT_LOC B                                           10000000
092300         WHERE A.PO_NBR = :IR-PO-NBR2                             10010000
092400           AND A.PO_LNE_NBR = :PURITM-PO-LNE-NBR                  10020000
092500           AND B.LOC_NBR    = A.STR_NBR                           10030000
                 AND A.STR_DISTRO_QTY > 0                               10040000
092600         ORDER BY A.STR_NBR                                       10050000
092700     END-EXEC.                                                    10060000
092800                                                                  10070000
092900 PROCEDURE DIVISION.                                              10080000
093000                                                                  10090000
093100******************************************************************10100000
093200*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   10110000
093300******************************************************************10120000
093400 0000-MAINLINE.                                                   10130000
093500                                                                  10140000
093600     PERFORM 1000-INITIALIZE.                                     10151012
093700     IF IR-RPT-TYPE-BY = 'BY'                                     10160000
093800         SET PS-BUYER-RPT-TYPE     TO TRUE                        10170000
093900         MOVE 'BUYER COPY  '       TO HL3-VERSION                 10180000
094000         PERFORM 2000-PROCESS-REPORT.                             10190000
094100                                                                  10200000
094200     IF IR-RPT-TYPE-AN = 'AN'                                     10210000
094300         SET PS-ANALYST-RPT-TYPE   TO TRUE                        10220000
094400         MOVE 'ANALYST COPY'       TO HL3-VERSION                 10230000
094500         PERFORM 2000-PROCESS-REPORT.                             10240000
094600                                                                  10250000
094700     IF IR-RPT-TYPE-DC = 'DC'                                     10260000
094800         SET PS-DC-RPT-TYPE        TO TRUE                        10270000
094900         MOVE 'DC COPY     '       TO HL3-VERSION                 10280000
095000         PERFORM 2000-PROCESS-REPORT.                             10290000
095100                                                                  10300000
095200     IF IR-RPT-TYPE-VN = 'VS' OR 'VN'                             10310000
095300         SET PS-VENDOR-RPT-TYPE    TO TRUE                        10320000
095400         MOVE 'VENDOR COPY '       TO HL3-VERSION                 10330000
095500         PERFORM 2000-PROCESS-REPORT.                             10340000
095600                                                                  10350000
095700     CLOSE INPUT-FILE                                             10360000
095800           PORPT-FILE.                                            10370000
095900                                                                  10380000
096000     STOP RUN.                                                    10390000
096100                                                                  10400000
096200******************************************************************10410000
096300*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          10420000
096400******************************************************************10430000
096500 1000-INITIALIZE.                                                 10440000
096600                                                                  10450000
096700     OPEN INPUT  INPUT-FILE.                                      10460000
096800     OPEN OUTPUT PORPT-FILE.                                      10470000
096900                                                                  10480000
097000     READ INPUT-FILE                                              10490000
097100         INTO IR-INPUT-RECORD                                     10500000
097200         AT END SET PS-EOF-INPUT-FILE                             10510000
097300                                   TO TRUE.                       10520000
097400     IF  PS-EOF-INPUT-FILE                                        10530000
097500         DISPLAY  '****** ABEND IN PROGRAM POKRP003 *******'      10540000
097600         DISPLAY  'EMPTY INPUT FILE'                              10550000
097700         MOVE +4003                TO PV-ABEND-CODE               10560000
097800         CALL 'ILBOABN0' USING PV-ABEND-CODE                      10570000
097900     END-IF.                                                      10580000
098000                                                                  10590000
098100     DISPLAY IR-PO-NBR ' PO NUMBER BEING PROCESSED '.             10600000
098200     MOVE IR-PO-NBR                TO IR-PO-NBR2.                 10610000
098300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             10620000
098400     MOVE SD-SYSTEM-MM             TO HL1-RUN-MONTH.              10630000
098500     MOVE SD-SYSTEM-DD             TO HL1-RUN-DAY.                10640000
098600     MOVE SD-SYSTEM-YY             TO HL1-RUN-YEAR.               10650000
098700                                                                  10660000
098800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             10670000
098900     MOVE ST-SYSTEM-HH             TO HL1-RUN-HOUR.               10680000
099000     MOVE ST-SYSTEM-MM             TO HL1-RUN-MINUTE.             10690000
099100     MOVE ST-SYSTEM-SS             TO HL1-RUN-SECOND.             10700000
099200                                                                  10710000
099300     MOVE IR-PO-NBR                TO PV-PO-NBR                   10720000
099400                                      IR-PO-NBR2.                 10730000
099500                                                                  10740000
099600******************************************************************10750000
099700*  CONTROLS REPORT PROCESSING                                     10760000
099800******************************************************************10770000
099900 2000-PROCESS-REPORT.                                             10780000
100000                                                                  10790000
100100     MOVE +1                       TO PV-PAGE-CNT.                10800000
100200     MOVE PV-PAGE-CNT              TO HL2-PAGE.                   10810000
100300     MOVE +0                       TO PV-LINE-CNT.                10820000
100400                                                                  10830000
100500     PERFORM 2100-PROCESS-HEADER.                                 10840000
100600     PERFORM 2200-PROCESS-INSTRUCTION.                            10850000
100700     PERFORM 2300-PROCESS-SKUS.                                   10860000
100800                                                                  10870000
100900     PERFORM 2370-ADVANCE-TO-NEWPAGE.                             10880000
101000     WRITE PORPT-RECORD FROM END-REPORT-LINE                      10890000
101100         AFTER 3 LINES.                                           10900000
101200                                                                  10910000
101300     DIVIDE PV-PAGE-CNT BY 2                                      10920000
101400         GIVING PV-QUOTIENT                                       10930000
101500         REMAINDER PV-REMAINDER.                                  10940000
101600     IF PV-REMAINDER > 0                                          10950000
101700         ADD +1                    TO PV-PAGE-CNT                 10960000
101800         MOVE PV-PAGE-CNT          TO HL2-PAGE                    10970000
101900         MOVE +0                   TO PV-LINE-CNT                 10980000
102000         WRITE PORPT-RECORD FROM HEADER-LINE1                     10990000
102100             AFTER ADVANCING PAGE                                 11000000
102200         WRITE PORPT-RECORD FROM HEADER-LINE2                     11010000
102300             AFTER 1 LINES                                        11020000
102400         WRITE PORPT-RECORD FROM HEADER-LINE3                     11030000
102500             AFTER 1 LINES                                        11040000
102600         WRITE PORPT-RECORD FROM BLANK-REPORT-LINE                11050000
102700             AFTER 1 LINES                                        11060000
102800     END-IF.                                                      11070000
102900                                                                  11080000
103000******************************************************************11090000
103100*  CONTROLS HEADER PROCESSING                                     11100000
103200******************************************************************11110000
103300 2100-PROCESS-HEADER.                                             11120000
103400                                                                  11130000
103500     PERFORM 2101-GET-TPURCHS.                                    11140000
103600     MOVE '01'                     TO ENTNME-TYPE-CDE.            11150000
103700     PERFORM 2102-GET-TENTNME.                                    11160000
103800     MOVE ENTNME-ENT-NAME-DESC     TO HL4-VEND-NAME.              11170000
103900     PERFORM 2103-GET-TBUSLOC.                                    11180000
104000     PERFORM 2104-GET-TPLNSHP.                                    11190000
104100     IF PURCHS-DEST-KNOWN-IND = 'Y'                               11200000
104200         PERFORM 2196-COUNT-TALLPLNS                              11210000
104300         IF PV-DB2-COUNT > 1                                      11220000
104400             MOVE PC-SHIP-INST-ATT TO HL10-SHIP-TO-NAME           11230000
104500             MOVE SPACES           TO HL11-SHIP-TO-ADDR-1         11240000
104600                                      HL12-SHIP-TO-ADDR-2         11250000
104700                                      HL13-SHIP-TO-ADDR-3         11260000
104800         ELSE                                                     11270000
104900             IF PV-DB2-COUNT = 0                                  11280000
105000                 MOVE SPACES       TO HL10-SHIP-TO-NAME           11290000
105100                                      HL11-SHIP-TO-ADDR-1         11300000
105200                                      HL12-SHIP-TO-ADDR-2         11310000
105300                                      HL13-SHIP-TO-ADDR-3         11320000
105400             ELSE                                                 11330000
105500                 PERFORM 2197-GET-SHIP-DEST                       11340000
105600                 PERFORM 2105-GET-XMT-LOC                         11350000
105700             END-IF                                               11360000
105800         END-IF                                                   11370000
105900     ELSE                                                         11380000
106000         MOVE PC-SHIP-INST-FOLL    TO HL10-SHIP-TO-NAME           11390000
106100         MOVE SPACES               TO HL11-SHIP-TO-ADDR-1         11400000
106200                                      HL12-SHIP-TO-ADDR-2         11410000
106300                                      HL13-SHIP-TO-ADDR-3         11420000
106400     END-IF.                                                      11430000
106500     PERFORM 2113-GET-TPOAGMT-3.                                  11440000
106600     PERFORM 2106-GET-TPOAGMT-2.                                  11450000
106700** GET PRETICKETING INFO                                          11460000
106800     MOVE '1'                      TO POAGMT-TYP-CDE.             11470000
106900     PERFORM 2107-GET-TPOAGMT-4.                                  11480000
107000     IF SQLCODE = +0                                              11490000
107100         MOVE 'YES'                TO HL9-PRE-TICK                11500000
107200     ELSE                                                         11510000
107300         MOVE 'NO '                TO HL9-PRE-TICK                11520000
107400     END-IF.                                                      11530000
107500** GET PACK BY STORE INFO                                         11540000
107600     MOVE '4'                      TO POAGMT-TYP-CDE.             11550000
107700     PERFORM 2107-GET-TPOAGMT-4.                                  11560000
107800     IF SQLCODE = +0                                              11570000
107900         MOVE 'YES'                TO HL10-PACK-STORE             11580000
108000         SET PS-PACK-BY-STORE      TO TRUE                        11590000
108100     ELSE                                                         11600000
108200         MOVE 'NO '                TO HL10-PACK-STORE             11610000
108300         SET PS-NOT-PACK-BY-STORE  TO TRUE                        11620000
108400     END-IF.                                                      11630000
108500* GET HANGER INFO                                                 11640000
108600     MOVE '2'                      TO POAGMT-TYP-CDE.             11650000
108700     PERFORM 2107-GET-TPOAGMT-4.                                  11660000
108800     IF SQLCODE = +0                                              11670000
108900         MOVE 'YES'                TO HL9-HANGERS                 11680000
109000     ELSE                                                         11690000
109100         MOVE 'NO '                TO HL9-HANGERS                 11700000
109200     END-IF.                                                      11710000
109300* OBTAIN OTHER VALUES FOR THE REPORT                              11720000
109400     PERFORM 2110-GET-TMDSEAR.                                    11730000
109500     PERFORM 2111-GET-BUYER.                                      11740000
109600     MOVE PURCHS-CRE-BY-UID        TO WORKER-UID-NBR.             11750000
109700     PERFORM 2108-GET-TWORKER.                                    11760000
109800     IF SQLCODE = +0 OR -811                                      11770000
109900         MOVE 20                   TO DP024-FLNAME-LENGTH         11780000
110000         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 11790000
110100         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 11800000
110200         PERFORM DP024-0000-FORMAT-NAME                           11810000
110300         MOVE DP024-FLNAME         TO HL11-CREATED-BY             11820000
110400     ELSE                                                         11830000
110500         IF PURCHS-PO-TYP-CDE = 'MS'                              11840000
110600             MOVE 'MODEL STOCK'    TO HL11-CREATED-BY             11850000
110700         ELSE                                                     11860000
110800         IF PURCHS-PO-TYP-CDE = 'VN'                              11870000
110900             MOVE 'VENDOR GENERATED' TO HL11-CREATED-BY           11880000
111000         ELSE                                                     11890000
111100         IF (PURCHS-PO-TYP-CDE = 'IN') OR                         11900000
111200            (PURCHS-PO-TYP-CDE = 'EC' AND                         11911024
P12016               PURCHS-CRE-BY-UID = 'INFOREM') OR                  11920025
P12016            (PURCHS-PO-TYP-CDE = 'RE' AND                         11921024
P12016               PURCHS-CRE-BY-UID = 'INFOREM')                     11922024
111400             MOVE 'INFOREM     '   TO HL11-CREATED-BY             11930000
111500         ELSE                                                     11940000
111600             MOVE SPACES           TO HL11-CREATED-BY             11950000
111700         END-IF                                                   11960000
111800         END-IF                                                   11970000
111900         END-IF                                                   11980000
112000     END-IF.                                                      11990000
112100     MOVE PURCHS-APP-BY-UID        TO WORKER-UID-NBR.             12000000
112200     PERFORM 2108-GET-TWORKER.                                    12010000
112300     IF SQLCODE = +0 OR -811                                      12020000
112400         MOVE 20                   TO DP024-FLNAME-LENGTH         12030000
112500         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 12040000
112600         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 12050000
112700         PERFORM DP024-0000-FORMAT-NAME                           12060000
112800         MOVE DP024-FLNAME         TO HL13-APPROVE-BY             12070000
112900     ELSE                                                         12080000
113000         IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                      12090000
113100             PERFORM 2112-GET-DMM                                 12100000
113200         ELSE                                                     12110000
113300             MOVE SPACES           TO HL13-APPROVE-BY             12120000
113400         END-IF                                                   12130000
113500     END-IF.                                                      12140000
113600     PERFORM 2109-GET-TPURITM.                                    12150000
113700*SELECT TPOAGMT 5/1                                               12160000
113800     PERFORM 2114-ADDL-DISCOUNT.                                  12170000
113900*SELECT TPOAGMT 5/7                                               12180000
114000     PERFORM 2115-MOS-DISCOUNT.                                   12190000
114100*SELECT TPOAGMT 5/8                                               12200000
114200     PERFORM 2116-TRD-DISCOUNT.                                   12210000
114300*SELECT TPOAGMT 5/9                                               12220000
114400     PERFORM 2117-ADV-DISCOUNT.                                   12230000
114500                                                                  12240000
114600     WRITE PORPT-RECORD FROM HEADER-LINE1                         12250000
114700         AFTER ADVANCING PAGE.                                    12260000
114800     WRITE PORPT-RECORD FROM HEADER-LINE2                         12270000
114900         AFTER 1 LINES.                                           12280000
115000     WRITE PORPT-RECORD FROM HEADER-LINE3                         12290000
115100         AFTER 1 LINES.                                           12300000
115200     WRITE PORPT-RECORD FROM HEADER-LINE4                         12310000
115300         AFTER 2 LINES.                                           12320000
115400     WRITE PORPT-RECORD FROM HEADER-LINE5                         12330000
115500         AFTER 1 LINES.                                           12340000
115600     WRITE PORPT-RECORD FROM HEADER-LINE6                         12350000
115700         AFTER 1 LINES.                                           12360000
115800     WRITE PORPT-RECORD FROM HEADER-LINE7                         12370000
115900         AFTER 1 LINES.                                           12380000
116000     WRITE PORPT-RECORD FROM HEADER-LINE8                         12390000
116100         AFTER 1 LINES.                                           12400000
116200     WRITE PORPT-RECORD FROM HEADER-LINE9                         12410000
116300         AFTER 1 LINES.                                           12420000
116400     WRITE PORPT-RECORD FROM HEADER-LINE10                        12430000
116500         AFTER 1 LINES.                                           12440000
116600     WRITE PORPT-RECORD FROM HEADER-LINE11                        12450000
116700         AFTER 1 LINES.                                           12460000
116800     WRITE PORPT-RECORD FROM HEADER-LINE12                        12470000
116900         AFTER 1 LINES.                                           12480000
117000     WRITE PORPT-RECORD FROM HEADER-LINE13                        12490000
117100         AFTER 1 LINES.                                           12500000
117200     WRITE PORPT-RECORD FROM HEADER-LINE14                        12510000
117300         AFTER 1 LINES.                                           12520000
117400     WRITE PORPT-RECORD FROM HEADER-LINE15                        12530000
117500         AFTER 1 LINES.                                           12540000
117600     WRITE PORPT-RECORD FROM HEADER-LINE16                        12550000
117700         AFTER 1 LINES.                                           12560000
117800     WRITE PORPT-RECORD FROM HEADER-LINE17                        12570000
117900         AFTER 1 LINES.                                           12580000
118000     WRITE PORPT-RECORD FROM HEADER-LINE18                        12590000
118100         AFTER 1 LINES.                                           12600000
118200     WRITE PORPT-RECORD FROM HEADER-LINE19                        12610000
118300         AFTER 1 LINES.                                           12620000
118400                                                                  12630000
118500     MOVE +20                      TO PV-LINE-CNT.                12640000
118600                                                                  12650000
118700******************************************************************12660000
118800*  RETRIEVES AND FORMATS PO DATA ON TPURCHS                       12670000
118900******************************************************************12680000
119000 2101-GET-TPURCHS.                                                12690000
119100                                                                  12700000
119200       EXEC SQL                                                   12710000
119300         SELECT ORD_DTE,                                          12720000
119400                PO_TYP_CDE,                                       12730000
119500                STATUS_CDE,                                       12740000
119600                ENT_ID,                                           12750000
119700                TOT_MU_PCT,                                       12760000
119800                TOT_VAL_COST_AMT,                                 12770000
119900                TOT_VAL_RTL_AMT,                                  12780000
120000                TOT_UNT_QTY,                                      12790000
120100                OTB_PER_NBR,                                      12800000
120200                EDI_IND,                                          12810000
120300                NEW_STR_PO_IND,                                   12820000
120400                CRE_BY_UID,                                       12830000
120500                APP_BY_UID,                                       12840000
120600                DEPT_NBR,                                         12850000
120700                ADR_SEQ_NBR,                                      12860000
120800                REVISION_CT,                                      12870000
120900                DEST_KNOWN_IND,                                   12880000
121000                CRE_BY_UID                                        12890000
121100         INTO  :PURCHS-ORD-DTE,                                   12900000
121200               :PURCHS-PO-TYP-CDE,                                12910000
121300               :PURCHS-STATUS-CDE,                                12920000
121400               :PURCHS-ENT-ID,                                    12930000
121500               :PURCHS-TOT-MU-PCT,                                12940000
121600               :PURCHS-TOT-VAL-COST-AMT,                          12950000
121700               :PURCHS-TOT-VAL-RTL-AMT,                           12960000
121800               :PURCHS-TOT-UNT-QTY,                               12970000
121900               :PURCHS-OTB-PER-NBR,                               12980000
122000               :PURCHS-EDI-IND,                                   12990000
122100               :PURCHS-NEW-STR-PO-IND,                            13000000
122200               :PURCHS-CRE-BY-UID,                                13010000
122300               :PURCHS-APP-BY-UID,                                13020000
122400               :PURCHS-DEPT-NBR,                                  13030000
122500               :PURCHS-ADR-SEQ-NBR,                               13040000
122600               :PURCHS-REVISION-CT,                               13050000
122700               :PURCHS-DEST-KNOWN-IND,                            13060000
122800               :PURCHS-CRE-BY-UID                                 13070000
122900         FROM TPURCHS                                             13080000
123000         WHERE PO_NBR         = :IR-PO-NBR2                       13090000
123100           AND VER_STATUS_CDE = 'A'                               13100000
123200           AND PO_CATEG_CDE   = 'MR'                              13110000
123300       END-EXEC.                                                  13120000
123400                                                                  13130000
123500       EVALUATE TRUE                                              13140000
123600         WHEN SQLCODE = +0                                        13150000
123700             CONTINUE                                             13160000
123800         WHEN SQLWARN NOT = SPACE                                 13170000
123900         WHEN SQLCODE NOT = +0                                    13180000
124000             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    13190000
124100             MOVE '2101-GET-TPURCHS'                              13200000
124200                                   TO PV-ABEND-PARAGRAPH          13210000
124300             PERFORM 9000-SQL-ABEND                               13220000
124400       END-EVALUATE.                                              13230000
124500                                                                  13240000
124600     MOVE IR-PO-NBR2               TO HL1-PO-NBR.                 13250000
124700     MOVE PURCHS-DEPT-NBR          TO HL2-DEPT-NBR                13260000
124800     IF PURCHS-ORD-DTE = PC-INIT-DATE                             13270000
124900         MOVE SPACES               TO HL1-ORD-DATE                13280000
125000     ELSE                                                         13290000
125100         MOVE PURCHS-ORD-DTE       TO PV-DATE-BREAK               13300000
125200         MOVE PV-DB-MM             TO PV-DBS-MM                   13310000
125300         MOVE PV-DB-DD             TO PV-DBS-DD                   13320000
125400         MOVE PV-DB-YY             TO PV-DBS-YY                   13330000
125500         MOVE PV-DATE-BREAK-SLASH  TO HL1-ORD-DATE                13340000
125600     END-IF.                                                      13350000
125700     IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              13360000
125800         MOVE SPACES               TO HL4-MU-PCT                  13370000
125900     ELSE                                                         13380000
126000         MOVE PURCHS-TOT-MU-PCT    TO PV-EDIT-MU-PCT              13390000
126100         MOVE PV-EDIT-MU-PCT       TO HL4-MU-PCT                  13400000
126200     END-IF.                                                      13410000
126220* TKMA888 * REPLACED 1 LINE WITH 26 LINES ************************13420000
126230*           TO CHANGE COMPUTATION OF TOTAL COST FOR IMPORT PO'S   13430000
126240* TKMA888 *------------------------------------------------------*13440000
126250*    MOVE PURCHS-TOT-VAL-COST-AMT  TO HL5-COST.                   13450000
126270*                                                                 13460000
126280     EXEC SQL                                                     13470001
126290       SELECT ROUND(SUM(UNT_QTY * PRD_1ST_COST_AMT),2)            13480001
126300         INTO :PV-TOT-VAL-COST-AMT                                13490001
126310         FROM TPURITM                                             13500001
126320        WHERE PO_NBR         = :IR-PO-NBR2                        13510001
126330          AND VER_STATUS_CDE = 'A'                                13520001
126340     END-EXEC                                                     13530001
126350*                                                                 13540000
126360     EVALUATE TRUE                                                13550001
126370         WHEN SQLCODE     = +0                                    13560001
126380             CONTINUE                                             13570001
126390         WHEN SQLWARN NOT = SPACE                                 13580001
126391         WHEN SQLCODE NOT = +0                                    13590001
126392             MOVE '2101-GET-TPURCHS TOT-VAL-COST'                 13600001
126393                                  TO PV-ABEND-PARAGRAPH           13610001
126394             PERFORM 9000-SQL-ABEND                               13620001
126395     END-EVALUATE                                                 13630001
126396*                                                                 13640000
126397     MOVE PV-TOT-VAL-COST-AMT      TO HL5-COST                    13650001
126401* TKMA888 *------------------------------------------------------*13660000
126410     IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              13670000
126500         MOVE SPACES               TO HL6-RETAIL                  13680000
126600     ELSE                                                         13690000
126700         MOVE PURCHS-TOT-VAL-RTL-AMT                              13700000
126800                                   TO PV-DOL-FORM-14              13710000
126900         MOVE PV-DOL-FORM-14       TO HL6-RETAIL                  13720000
127000     END-IF.                                                      13730000
127100     MOVE PURCHS-TOT-UNT-QTY       TO HL7-UNITS.                  13740000
127200     MOVE PURCHS-OTB-PER-NBR       TO PV-OTB-PER-BREAK.           13750000
127300     MOVE PC-MONTH-ABBR (PV-OTBP-MM-N)                            13760000
127400                                   TO HL6-OTBP-MONTH.             13770000
127500     MOVE PV-OTBP-YY               TO HL6-OTBP-YEAR.              13780000
127600     IF PURCHS-EDI-IND = 'Y'                                      13790000
127700         MOVE 'YES'                TO HL7-EDI                     13800000
127800     ELSE                                                         13810000
127900         MOVE 'NO '                TO HL7-EDI                     13820000
128000     END-IF.                                                      13830000
128100     IF PURCHS-NEW-STR-PO-IND = 'Y'                               13840000
128200         MOVE 'YES'                TO HL8-NEW-STORE               13850000
128300     ELSE                                                         13860000
128400         MOVE 'NO '                TO HL8-NEW-STORE               13870000
128500     END-IF.                                                      13880000
128600                                                                  13890000
128700******************************************************************13900000
128800*  RETRIEVES AND FORMATS PO DATA ON TENTNME                       13910000
128900******************************************************************13920000
129000 2102-GET-TENTNME.                                                13930000
129100                                                                  13940000
129200     EXEC SQL                                                     13950000
129300         SELECT ENT_NAME_DESC                                     13960000
129400         INTO  :ENTNME-ENT-NAME-DESC                              13970000
129500         FROM TENTNME                                             13980000
129600         WHERE ENT_ID = :PURCHS-ENT-ID                            13990000
129700           AND TYPE_CDE = :ENTNME-TYPE-CDE                        14000000
129800     END-EXEC.                                                    14010000
129900                                                                  14020000
130000     EVALUATE TRUE                                                14030000
130100         WHEN SQLCODE = +0                                        14040000
130200         WHEN SQLCODE = +100                                      14050000
130300             CONTINUE                                             14060000
130400         WHEN SQLWARN NOT = SPACE                                 14070000
130500         WHEN SQLCODE NOT = +0                                    14080000
130600             MOVE '2102-GET-TENTNME'                              14090000
130700                                   TO PV-ABEND-PARAGRAPH          14100000
130800             PERFORM 9000-SQL-ABEND                               14110000
130900     END-EVALUATE.                                                14120000
131000                                                                  14130000
131100     IF SQLCODE = +100                                            14140000
131200         MOVE SPACES TO ENTNME-ENT-NAME-DESC                      14150000
131300     END-IF.                                                      14160000
131400                                                                  14170000
131500******************************************************************14180000
131600*  RETRIEVES AND FORMATS PO DATA ON TBUSLOC                       14190000
131700******************************************************************14200000
131800 2103-GET-TBUSLOC.                                                14210000
131900                                                                  14220000
132000     EXEC SQL                                                     14230000
132100         SELECT ADDRESS_LINE1_DESC,                               14240000
132200                ADDRESS_LINE2_DESC,                               14250000
132300                ATTENTION_TO_TXT,                                 14260000
132400                CITY_NAME,                                        14270000
132500                ZIP_CDE,                                          14280000
132600                ST_PROV_CDE,                                      14290000
132700                CNTRY_CDE                                         14300000
132800         INTO  :BUSLOC-ADDRESS-LINE1-DESC,                        14310000
132900               :BUSLOC-ADDRESS-LINE2-DESC,                        14320000
133000               :BUSLOC-ATTENTION-TO-TXT,                          14330000
133100               :BUSLOC-CITY-NAME,                                 14340000
133200               :BUSLOC-ZIP-CDE,                                   14350000
133300               :BUSLOC-ST-PROV-CDE,                               14360000
133400               :BUSLOC-CNTRY-CDE                                  14370000
133500         FROM TBUSLOC                                             14380000
133600         WHERE ENT_ID = :PURCHS-ENT-ID                            14390000
133700           AND FUNCTION_ID = 2                                    14400000
133800           AND SEQ_NBR = :PURCHS-ADR-SEQ-NBR                      14410000
133900     END-EXEC.                                                    14420000
134000                                                                  14430000
134100     EVALUATE TRUE                                                14440000
134200         WHEN SQLCODE = +0                                        14450000
134300         WHEN SQLCODE = +100                                      14460000
134400             CONTINUE                                             14470000
134500         WHEN SQLWARN NOT = SPACE                                 14480000
134600         WHEN SQLCODE NOT = +0                                    14490000
134700             MOVE '2103-GET-TBUSLOC'                              14500000
134800                                   TO PV-ABEND-PARAGRAPH          14510000
134900             PERFORM 9000-SQL-ABEND                               14520000
135000     END-EVALUATE.                                                14530000
135100                                                                  14540000
135200     IF SQLCODE = +100                                            14550000
135300         MOVE SPACES               TO HL5-VEND-ADDR-1             14560000
135400         MOVE SPACES               TO HL6-VEND-ADDR-2             14570000
135500         MOVE SPACES               TO HL7-VEND-ADDR-3             14580000
135600     ELSE                                                         14590000
135700         MOVE BUSLOC-CITY-NAME TO PV-CITY                         14600000
135800         IF BUSLOC-CNTRY-CDE = 'US ' OR SPACES                    14610000
135900             MOVE SPACES             TO PV-COUNTRY                14620000
136000                                        PV-STATE-PROV             14630000
136100             MOVE BUSLOC-ST-PROV-CDE TO PV-STATE-PROV             14640000
136200         ELSE                                                     14650000
136300             PERFORM 2150-RETRIEVE-PROV-COUNTRY                   14660000
136400         END-IF                                                   14670000
136500         MOVE BUSLOC-ADDRESS-LINE1-DESC                           14680000
136600                                   TO HL5-VEND-ADDR-1             14690000
136700         IF BUSLOC-ADDRESS-LINE2-DESC > SPACES                    14700000
136800             MOVE BUSLOC-ADDRESS-LINE2-DESC                       14710000
136900                                   TO HL6-VEND-ADDR-2             14720000
137000             INITIALIZE HL7-VEND-ADDR-3                           14730000
137100             STRING PV-CITY             DELIMITED BY '  '         14740000
137200                    ', '                DELIMITED BY SIZE         14750000
137300                    PV-STATE-PROV       DELIMITED BY '  '         14760000
137400                    '  '                DELIMITED BY SIZE         14770000
137500                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         14780000
137600                    '  '                DELIMITED BY SIZE         14790000
137700                    PV-COUNTRY          DELIMITED BY '  '         14800000
137800                                 INTO HL7-VEND-ADDR-3             14810000
137900         ELSE                                                     14820000
138000             INITIALIZE HL6-VEND-ADDR-2                           14830000
138100             STRING PV-CITY             DELIMITED BY '  '         14840000
138200                    ', '                DELIMITED BY SIZE         14850000
138300                    PV-STATE-PROV       DELIMITED BY '  '         14860000
138400                    '  '                DELIMITED BY SIZE         14870000
138500                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         14880000
138600                    '  '                DELIMITED BY SIZE         14890000
138700                    PV-COUNTRY          DELIMITED BY '  '         14900000
138800                                 INTO HL6-VEND-ADDR-2             14910000
138900             MOVE BUSLOC-ATTENTION-TO-TXT                         14920000
139000                                   TO HL7-VEND-ADDR-3             14930000
139100         END-IF                                                   14940000
139200     END-IF.                                                      14950000
139300                                                                  14960000
139400******************************************************************14970000
139500*  RETRIEVES AND FORMATS PO DATA ON TPLNSHP                       14980000
139600******************************************************************14990000
139700 2104-GET-TPLNSHP.                                                15000000
139800                                                                  15010000
139900     EXEC SQL                                                     15020000
140000         SELECT FRGT_PAYT_CDE,                                    15030000
140100                DONT_SHIP_BEF_DTE,                                15040000
140200                CAN_IFNOT_SHIP_DTE,                               15050000
140300                EXT_CAN_DTE                                       15060000
140400         INTO  :PLNSHP-FRGT-PAYT-CDE,                             15070000
140500               :PLNSHP-DONT-SHIP-BEF-DTE,                         15080000
140600               :PLNSHP-CAN-IFNOT-SHIP-DTE,                        15090000
140700               :PLNSHP-EXT-CAN-DTE                                15100000
140800         FROM TPLNSHP                                             15110000
140900         WHERE PO_NBR = :IR-PO-NBR2                               15120000
141000           AND VER_STATUS_CDE = 'A'                               15130000
141100     END-EXEC.                                                    15140000
141200                                                                  15150000
141300     EVALUATE TRUE                                                15160000
141400         WHEN SQLCODE = +0                                        15170000
141500             CONTINUE                                             15180000
141600         WHEN SQLWARN NOT = SPACE                                 15190000
141700         WHEN SQLCODE NOT = +0                                    15200000
141800             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    15210000
141900             MOVE '2104-GET-TPLNSHP'                              15220000
142000                                   TO PV-ABEND-PARAGRAPH          15230000
142100             PERFORM 9000-SQL-ABEND                               15240000
142200     END-EVALUATE.                                                15250000
142300                                                                  15260000
142400     IF PLNSHP-FRGT-PAYT-CDE = 'V'                                15270000
142500         MOVE '04' TO ENTNME-TYPE-CDE                             15280000
142600         PERFORM 2102-GET-TENTNME                                 15290000
142700         MOVE ENTNME-ENT-NAME-DESC TO HL18-PAY-FRT                15300000
142800     ELSE                                                         15310000
142900         IF PLNSHP-FRGT-PAYT-CDE = 'B'                            15320000
143000             MOVE 'BOTH'           TO HL18-PAY-FRT                15330000
143100         ELSE                                                     15340000
143200             MOVE 'KOHLS'          TO HL18-PAY-FRT                15350000
143300         END-IF                                                   15360000
143400     END-IF.                                                      15370000
143500     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DATE-BREAK.              15380000
143600     MOVE PV-DB-MM                 TO HL4-DNSB-MONTH.             15390000
143700     MOVE PV-DB-DD                 TO HL4-DNSB-DAY.               15400000
143800     MOVE PV-DB-YY                 TO HL4-DNSB-YEAR.              15410000
143900     IF PLNSHP-CAN-IFNOT-SHIP-DTE > PLNSHP-EXT-CAN-DTE            15420000
144000         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                           15430000
144100                                   TO PV-DATE-BREAK               15440000
144200         MOVE PV-DB-MM             TO HL5-CNSB-MONTH              15450000
144300         MOVE PV-DB-DD             TO HL5-CNSB-DAY                15460000
144400         MOVE PV-DB-YY             TO HL5-CNSB-YEAR               15470000
144500     ELSE                                                         15480000
144600         MOVE PLNSHP-EXT-CAN-DTE                                  15490000
144700                                   TO PV-DATE-BREAK               15500000
144800         MOVE PV-DB-MM             TO HL5-CNSB-MONTH              15510000
144900         MOVE PV-DB-DD             TO HL5-CNSB-DAY                15520000
145000         MOVE PV-DB-YY             TO HL5-CNSB-YEAR               15530000
145100     END-IF.                                                      15540000
145200                                                                  15550000
145300******************************************************************15560000
145400*  RETRIEVES AND FORMATS SHIP TO DATA ON XMT-LOC                  15570000
145500******************************************************************15580000
145600 2105-GET-XMT-LOC.                                                15590000
145700                                                                  15600000
145800     EXEC SQL                                                     15610000
145900         SELECT LOC_NM,                                           15620000
146000                LNE_1_ADDR,                                       15630000
146100                LNE_2_ADDR,                                       15640000
146200                CTY_NM,                                           15650000
146300                ST_CDE,                                           15660000
146400                ZIP_10_CDE                                        15670000
146500         INTO  :XMT00001-LOC-NM,                                  15680000
146600               :XMT00001-LNE-1-ADDR,                              15690000
146700               :XMT00001-LNE-2-ADDR,                              15700000
146800               :XMT00001-CTY-NM,                                  15710000
146900               :XMT00001-ST-CDE,                                  15720000
147000               :XMT00001-ZIP-10-CDE                               15730000
147100         FROM XMT_LOC                                             15740000
147200         WHERE LOC_NBR = :ALLPLN-DEST-NBR                         15750000
147300     END-EXEC.                                                    15760000
147400                                                                  15770000
147500     EVALUATE TRUE                                                15780000
147600         WHEN SQLCODE = +0                                        15790000
147700         WHEN SQLCODE = +100                                      15800000
147800             CONTINUE                                             15810000
147900         WHEN SQLWARN NOT = SPACE                                 15820000
148000         WHEN SQLCODE NOT = +0                                    15830000
148100             MOVE '2105-GET-XMT-LOC'                              15840000
148200                                   TO PV-ABEND-PARAGRAPH          15850000
148300             PERFORM 9000-SQL-ABEND                               15860000
148400     END-EVALUATE.                                                15870000
148500                                                                  15880000
148600     IF SQLCODE = 0                                               15890000
148700         MOVE XMT00001-LOC-NM  TO HL10-SHIP-TO-NAME               15900000
148800         MOVE XMT00001-LNE-1-ADDR                                 15910000
148900                                   TO HL11-SHIP-TO-ADDR-1         15920000
149000         MOVE XMT00001-ZIP-10-CDE                                 15930000
149100                                   TO PV-EDIT-ZIP-CODE            15940000
               DISPLAY 'X' PV-EDIT-ZIP-CODE 'X'                         15950000
               IF PV-EZD-DASH EQUAL '-' OR ' '                          15960000
149200            MOVE PV-EZD-1-5          TO PV-ZCD-1-5                15970000
149300            MOVE PV-EZD-6-9          TO PV-ZCD-6-9                15980000
               ELSE                                                     15990000
149200            MOVE PV-EZND-1-5          TO PV-ZCD-1-5               16000000
149300            MOVE PV-EZND-6-9          TO PV-ZCD-6-9               16010000
               END-IF                                                   16020000
149400         IF XMT00001-LNE-2-ADDR > SPACES                          16030000
149500             MOVE XMT00001-LNE-2-ADDR                             16040000
149600                                   TO HL12-SHIP-TO-ADDR-2         16050000
149700             INITIALIZE HL13-SHIP-TO-ADDR-3                       16060000
149800             STRING XMT00001-CTY-NM        DELIMITED BY '  '      16070000
149900                    ', '                   DELIMITED BY SIZE      16080000
150000                    XMT00001-ST-CDE        DELIMITED BY '  '      16090000
150100                    '  '                   DELIMITED BY SIZE      16100000
150200                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      16110000
150300                                 INTO HL13-SHIP-TO-ADDR-3         16120000
150400         ELSE                                                     16130000
150500             INITIALIZE HL12-SHIP-TO-ADDR-2                       16140000
150600             STRING XMT00001-CTY-NM        DELIMITED BY '  '      16150000
150700                    ', '                   DELIMITED BY SIZE      16160000
150800                    XMT00001-ST-CDE        DELIMITED BY '  '      16170000
150900                    '  '                   DELIMITED BY SIZE      16180000
151000                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      16190000
151100                                 INTO HL12-SHIP-TO-ADDR-2         16200000
151200             MOVE SPACES           TO HL13-SHIP-TO-ADDR-3         16210000
151300         END-IF                                                   16220000
151400     ELSE                                                         16230000
151500         MOVE SPACES               TO HL10-SHIP-TO-NAME           16240000
151600                                      HL11-SHIP-TO-ADDR-1         16250000
151700                                      HL12-SHIP-TO-ADDR-2         16260000
151800                                      HL13-SHIP-TO-ADDR-3         16270000
151900     END-IF.                                                      16280000
152000                                                                  16290000
152100******************************************************************16300000
152200*  RETRIEVES AND FORMATS PO DATA ON PAYMENT TPOAGMT               16310000
152300******************************************************************16320000
152400 2106-GET-TPOAGMT-2.                                              16330000
152500                                                                  16340000
152600     EXEC SQL                                                     16350000
152700         SELECT PAYT_TERM_ID                                      16360000
152800               ,DISC_PAY_DAY_QTY                                  16370000
152900               ,DISC_DOL_AMT                                      16380000
153000               ,DISC_PCT                                          16390000
153100         INTO  :POAGMT-PAYT-TERM-ID                               16400000
153200              ,:POAGMT-DISC-PAY-DAY-QTY                           16410000
153300              ,:POAGMT-DISC-DOL-AMT                               16420000
153400              ,:POAGMT-DISC-PCT                                   16430000
153500         FROM TPOAGMT                                             16440000
153600         WHERE PO_NBR = :IR-PO-NBR2                               16450000
153700           AND VER_STATUS_CDE = 'A'                               16460000
153800           AND AGRMT_TYP_ID = '2'                                 16470000
153900     END-EXEC.                                                    16480000
154000                                                                  16490000
154100     EVALUATE TRUE                                                16500000
154200         WHEN SQLCODE = +0                                        16510000
154300             CONTINUE                                             16520000
154400         WHEN SQLWARN NOT = SPACE                                 16530000
154500         WHEN SQLCODE NOT = +0                                    16540000
154600             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    16550000
154700             MOVE '2106-GET-TPOAGMT-2'                            16560000
154800                                   TO PV-ABEND-PARAGRAPH          16570000
154900             PERFORM 9000-SQL-ABEND                               16580000
155000     END-EVALUATE.                                                16590000
155100                                                                  16600000
155200     MOVE POAGMT-DISC-PAY-DAY-QTY  TO HL9-EXTEND-DATE.            16610000
155300     MOVE POAGMT-DISC-DOL-AMT      TO HL10-VEND-DIS-AMT.          16620000
155400                                                                  16630000
155500     COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100.                 16640000
155600     MOVE PV-PCT-HOLD              TO HL10-VEND-DIS-PCT.          16650000
155700     PERFORM 2198-GET-TPAYTRM.                                    16660000
155800     IF SQLCODE = +0                                              16670000
155900         PERFORM 2199-FORMAT-PAYMENT-TERM                         16680000
156000     ELSE                                                         16690000
156100         MOVE SPACES               TO HL8-PAY-TERM                16700000
156200     END-IF.                                                      16710000
156300                                                                  16720000
156400******************************************************************16730000
156500*  RETRIEVES TPOAGMT TO CHECK FOR EXISTENCE                       16740000
156600******************************************************************16750000
156700 2107-GET-TPOAGMT-4.                                              16760000
156800                                                                  16770000
156900     EXEC SQL                                                     16780000
157000         SELECT TYP_CDE                                           16790000
157100         INTO  :POAGMT-TYP-CDE                                    16800000
157200         FROM TPOAGMT                                             16810000
157300         WHERE PO_NBR = :IR-PO-NBR2                               16820000
157400           AND VER_STATUS_CDE = 'A'                               16830000
157500           AND AGRMT_TYP_ID = '4'                                 16840000
157600           AND TYP_CDE = :POAGMT-TYP-CDE                          16850000
157700     END-EXEC.                                                    16860000
157800                                                                  16870000
157900     EVALUATE TRUE                                                16880000
158000         WHEN SQLCODE = +0                                        16890000
158100         WHEN SQLCODE = +100                                      16900000
158200             CONTINUE                                             16910000
158300         WHEN SQLWARN NOT = SPACE                                 16920000
158400         WHEN SQLCODE NOT = +0                                    16930000
158500             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    16940000
158600             DISPLAY 'TYP CDE = ' POAGMT-TYP-CDE                  16950000
158700             MOVE '2107-GET-TPOAGMT-4'                            16960000
158800                                   TO PV-ABEND-PARAGRAPH          16970000
158900             PERFORM 9000-SQL-ABEND                               16980000
159000     END-EVALUATE.                                                16990000
159100                                                                  17000000
159200******************************************************************17010000
159300*  RETRIEVES NAMES FROM TWORKER                                   17020000
159400******************************************************************17030000
159500 2108-GET-TWORKER.                                                17040000
159600                                                                  17050000
159700     EXEC SQL                                                     17060000
159800         SELECT LAST_NAME,                                        17070000
159900                FIR_NAME                                          17080000
160000         INTO  :WORKER-LAST-NAME,                                 17090000
160100               :WORKER-FIR-NAME                                   17100000
160200         FROM TWORKER                                             17110000
160300         WHERE UID_NBR = :WORKER-UID-NBR                          17120000
160400     END-EXEC.                                                    17130000
160500                                                                  17140000
160600     EVALUATE TRUE                                                17150000
160700         WHEN SQLCODE = +0                                        17160000
160800         WHEN SQLCODE = +100                                      17170000
160900         WHEN SQLCODE = -811                                      17180000
161000             CONTINUE                                             17190000
161100         WHEN SQLWARN NOT = SPACE                                 17200000
161200         WHEN SQLCODE NOT = +0                                    17210000
161300             MOVE '2108-GET-TWORKER'                              17220000
161400                                   TO PV-ABEND-PARAGRAPH          17230000
161500             PERFORM 9000-SQL-ABEND                               17240000
161600     END-EVALUATE.                                                17250000
161700                                                                  17260000
161800     IF SQLCODE = +100                                            17270000
161900         MOVE SPACES               TO WORKER-LAST-NAME            17280000
162000                                      WORKER-FIR-NAME             17290000
162100     END-IF.                                                      17300000
162200                                                                  17310000
162300******************************************************************17320000
162400*  RETRIEVES ANY AD MERCHANDISE FROM TPURITM                      17330000
162500******************************************************************17340000
162600 2109-GET-TPURITM.                                                17350000
162700                                                                  17360000
162800     PERFORM WITH TEST AFTER                                      17370000
162900        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      17380000
163000        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              17390000
163100                SQLCODE = ZERO OR SQLCODE = +100                  17400000
163200        EXEC SQL                                                  17410000
163300            SELECT MIN(AD_EVNT_DTE)                               17420000
163400            INTO :PURITM-AD-EVNT-DTE:PV-NULL-IND                  17430000
163500            FROM TPURITM                                          17440000
163600            WHERE PO_NBR = :IR-PO-NBR2                            17450000
163700              AND VER_STATUS_CDE = 'A'                            17460000
163800              AND AD_EVNT_DTE > :PC-INIT-DATE                     17470000
163900              AND STATUS_CDE ^= 'CA'                              17480000
164000        END-EXEC                                                  17490000
164100                                                                  17500000
164200        EVALUATE TRUE                                             17510000
164300            WHEN SQLCODE = +0                                     17520000
164400            WHEN SQLCODE = +100                                   17530000
164500                CONTINUE                                          17540000
164600            WHEN SQLCODE = -904                                   17550000
164700            WHEN SQLCODE = -911                                   17560000
164800            WHEN SQLCODE = -913                                   17570000
164900                CONTINUE                                          17580000
165000            WHEN SQLWARN NOT = SPACE                              17590000
165100            WHEN SQLCODE NOT = +0                                 17600000
165200                MOVE '2109-GET-TPURITM'                           17610000
165300                                      TO PV-ABEND-PARAGRAPH       17620000
165400                PERFORM 9000-SQL-ABEND                            17630000
165500        END-EVALUATE                                              17640000
165600     END-PERFORM.                                                 17650000
165700                                                                  17660000
165800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         17670000
165900         MOVE '2109-GET-TPURITM' TO PV-ABEND-PARAGRAPH            17680000
166000         PERFORM 9000-SQL-ABEND                                   17690000
166100     END-IF.                                                      17700000
166200                                                                  17710000
166300     IF SQLCODE = +100 OR                                         17720000
166400        PV-NULL-IND < +0                                          17730000
166500         MOVE 'NO '                TO HL19-AD-MERCH               17740000
166600         MOVE SPACES               TO HL19-AD-DATE                17750000
166700     ELSE                                                         17760000
166800         MOVE 'YES'                TO HL19-AD-MERCH               17770000
166900         MOVE PURITM-AD-EVNT-DTE   TO PV-DATE-BREAK               17780000
167000         MOVE PV-DB-MM             TO PV-DBS-MM                   17790000
167100         MOVE PV-DB-DD             TO PV-DBS-DD                   17800000
167200         MOVE PV-DB-YY             TO PV-DBS-YY                   17810000
167300         MOVE PV-DATE-BREAK-SLASH  TO HL19-AD-DATE                17820000
167400     END-IF.                                                      17830000
167500                                                                  17840000
167600******************************************************************17850000
167700*  GET DEPARTMENT NAME FROM TMDSEAR                               17860000
167800******************************************************************17870000
167900 2110-GET-TMDSEAR.                                                17880000
168000                                                                  17890000
168100     EXEC SQL                                                     17900000
168200         SELECT MDSEAR_DESC                                       17910000
168300               ,MDSEAR_DKEY                                       17920000
168400               ,GMA_NBR                                           17930000
168500               ,DMA_NBR                                           17940000
168600         INTO  :MDSEAR-DESC                                       17950000
168700              ,:MDSEAR-DKEY                                       17960000
168800              ,:MDSEAR-GMA-NBR                                    17970000
168900              ,:MDSEAR-DMA-NBR                                    17980000
169000         FROM TMDSEAR                                             17990000
169100         WHERE OPERCO_NBR = '03'                                  18000000
169200           AND DEPT_NBR = :PURCHS-DEPT-NBR                        18010000
169300           AND MDSELV_CDE = 'DPT'                                 18020000
169400           AND STRT_DTE <= CURRENT DATE                           18030000
169500           AND END_DTE >= CURRENT DATE                            18040000
169600     END-EXEC.                                                    18050000
169700                                                                  18060000
169800     EVALUATE TRUE                                                18070000
169900         WHEN SQLCODE = +0                                        18080000
170000         WHEN SQLCODE = +100                                      18090000
170100             CONTINUE                                             18100000
170200         WHEN SQLWARN NOT = SPACE                                 18110000
170300         WHEN SQLCODE NOT = +0                                    18120000
170400             MOVE '2110-GET-TMDSEAR'                              18130000
170500                                   TO PV-ABEND-PARAGRAPH          18140000
170600             PERFORM 9000-SQL-ABEND                               18150000
170700     END-EVALUATE.                                                18160000
170800                                                                  18170000
170900     IF SQLCODE = +100                                            18180000
171000         MOVE SPACES               TO HL2-DEPT-NAME               18190000
171100     ELSE                                                         18200000
171200         MOVE MDSEAR-DESC          TO HL2-DEPT-NAME               18210000
171300     END-IF.                                                      18220000
171400                                                                  18230000
171500******************************************************************18240000
171600*  GET BUYER NAME FROM TRSPBAR                                    18250000
171700******************************************************************18260000
171800 2111-GET-BUYER.                                                  18270000
171900                                                                  18280000
172000     EXEC SQL                                                     18290000
172100         SELECT WORKER_LAST_NAME                                  18300000
172200               ,WORKER_FIR_NAME                                   18310000
172300         INTO  :RSPBAR-WORKER-LAST-NAME                           18320000
172400              ,:RSPBAR-WORKER-FIR-NAME                            18330000
172500         FROM TRSPBAR                                             18340000
172600         WHERE MDSEAR_DKEY = :MDSEAR-DKEY                         18350000
172700           AND RSPLVL_CDE = 'BYR'                                 18360000
172800           AND WORKER_STRT_DTE <= CURRENT DATE                    18370000
172900           AND WORKER_END_DTE >= CURRENT DATE                     18380000
173000     END-EXEC.                                                    18390000
173100                                                                  18400000
173200     EVALUATE TRUE                                                18410000
173300         WHEN SQLCODE = +0                                        18420000
173400         WHEN SQLCODE = +100                                      18430000
173500             CONTINUE                                             18440000
173600         WHEN SQLWARN NOT = SPACE                                 18450000
173700         WHEN SQLCODE NOT = +0                                    18460000
173800             MOVE '2111-GET-BUYER'                                18470000
173900                                   TO PV-ABEND-PARAGRAPH          18480000
174000             PERFORM 9000-SQL-ABEND                               18490000
174100     END-EVALUATE.                                                18500000
174200                                                                  18510000
174300     IF SQLCODE = +100                                            18520000
174400         MOVE SPACES               TO HL12-BUYER                  18530000
174500     ELSE                                                         18540000
174600         MOVE 20                   TO DP024-FLNAME-LENGTH         18550000
174700         MOVE RSPBAR-WORKER-LAST-NAME                             18560000
174800                                   TO DP024-LNAME                 18570000
174900         MOVE RSPBAR-WORKER-FIR-NAME                              18580000
175000                                   TO DP024-FNAME                 18590000
175100         PERFORM DP024-0000-FORMAT-NAME                           18600000
175200         MOVE DP024-FLNAME         TO HL12-BUYER                  18610000
175300     END-IF.                                                      18620000
175400                                                                  18630000
175500******************************************************************18640000
175600*  RETRIEVES NAME OF DMM                                          18650000
175700******************************************************************18660000
175800 2112-GET-DMM.                                                    18670000
175900                                                                  18680000
176000     EXEC SQL                                                     18690000
176100         SELECT DISTINCT B.WORKER_LAST_NAME,                      18700000
176200                         B.WORKER_FIR_NAME                        18710000
176300         INTO  :RSPBAR-WORKER-LAST-NAME,                          18720000
176400               :RSPBAR-WORKER-FIR-NAME                            18730000
176500         FROM TMDSEAR A,                                          18740000
176600              TRSPBAR B                                           18750000
176700         WHERE A.OPERCO_NBR  = '03'                               18760000
176800           AND A.GMA_NBR     = :MDSEAR-GMA-NBR                    18770000
176900           AND A.DMA_NBR     = :MDSEAR-DMA-NBR                    18780000
177000           AND MDSELV_CDE    = 'DMA'                              18790000
177100           AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                      18800000
177200           AND B.RSPLVL_CDE  = 'DMM'                              18810000
177300           AND B.WORKER_STRT_DTE < CURRENT DATE                   18820000
177400           AND B.WORKER_END_DTE  > CURRENT DATE                   18830000
177500     END-EXEC.                                                    18840000
177600                                                                  18850000
177700     EVALUATE TRUE                                                18860000
177800         WHEN SQLCODE = +0                                        18870000
177900         WHEN SQLCODE = +100                                      18880000
178000             CONTINUE                                             18890000
178100         WHEN SQLWARN NOT = SPACE                                 18900000
178200         WHEN SQLCODE NOT = +0                                    18910000
178300             MOVE '2112-GET-DMM    '                              18920000
178400                                   TO PV-ABEND-PARAGRAPH          18930000
178500             PERFORM 9000-SQL-ABEND                               18940000
178600     END-EVALUATE.                                                18950000
178700                                                                  18960000
178800     IF SQLCODE = +100                                            18970000
178900         MOVE SPACES               TO HL13-APPROVE-BY             18980000
179000     ELSE                                                         18990000
179100         MOVE 20                   TO DP024-FLNAME-LENGTH         19000000
179200         MOVE RSPBAR-WORKER-LAST-NAME                             19010000
179300                                   TO DP024-LNAME                 19020000
179400         MOVE RSPBAR-WORKER-FIR-NAME                              19030000
179500                                   TO DP024-FNAME                 19040000
179600         PERFORM DP024-0000-FORMAT-NAME                           19050000
179700         MOVE DP024-FLNAME         TO HL13-APPROVE-BY             19060000
179800     END-IF.                                                      19070000
179900                                                                  19080000
180000******************************************************************19090000
180100*  RETRIEVES AND FORMATS EDI PROMO TEXT ON TPOAGMT                19100000
180200******************************************************************19110000
180300 2113-GET-TPOAGMT-3.                                              19120000
180400                                                                  19130000
180500     EXEC SQL                                                     19140000
180600         SELECT EDI_PROMO_TXT                                     19150000
180700                                                                  19160000
180800         INTO  :POAGMT-EDI-PROMO-TXT                              19170000
180900                                                                  19180000
181000         FROM TPOAGMT                                             19190000
181100         WHERE PO_NBR = :IR-PO-NBR2                               19200000
181200           AND VER_STATUS_CDE = 'A'                               19210000
181300           AND AGRMT_TYP_ID = '3'                                 19220000
181400     END-EXEC.                                                    19230000
181500                                                                  19240000
181600     EVALUATE TRUE                                                19250000
181700         WHEN SQLCODE = +0                                        19260000
181800             CONTINUE                                             19270000
181900         WHEN SQLCODE = +100                                      19280000
182000             MOVE SPACES           TO HL7-EDI-DEAL                19290000
182100         WHEN SQLWARN NOT = SPACE                                 19300000
182200         WHEN SQLCODE NOT = +0                                    19310000
182300             MOVE '2113-GET-TPOAGMT-3'                            19320000
182400                                   TO PV-ABEND-PARAGRAPH          19330000
182500             PERFORM 9000-SQL-ABEND                               19340000
182600     END-EVALUATE.                                                19350000
182700                                                                  19360000
182800     IF PURCHS-EDI-IND = 'Y'                                      19370000
182900        MOVE POAGMT-EDI-PROMO-TXT  TO HL7-EDI-DEAL                19380000
183000     ELSE                                                         19390000
183100        MOVE SPACES                TO HL7-EDI-DEAL                19400000
183200     END-IF.                                                      19410000
183300                                                                  19420000
183400 2114-ADDL-DISCOUNT.                                              19430000
183500******************************************************************19440000
183600*  SELECT THE ADDITIONAL DISCOUNT DATA                            19450000
183700******************************************************************19460000
183800*    DISPLAY '2114-ADDL-DISCOUNT'.                                19470000
183900                                                                  19480000
184000     EXEC SQL                                                     19490000
184100         SELECT DISC_DOL_AMT,                                     19500000
184200                DISC_PCT,                                         19510000
184300                DISC_PAY_DAY_QTY                                  19520000
184400         INTO :POAGMT-DISC-DOL-AMT,                               19530000
184500              :POAGMT-DISC-PCT,                                   19540000
184600              :POAGMT-DISC-PAY-DAY-QTY                            19550000
184700         FROM TPOAGMT                                             19560000
184800         WHERE PO_NBR         = :IR-PO-NBR2   AND                 19570000
184900               AGRMT_TYP_ID   = '5'           AND                 19580000
185000               TYP_CDE        = 1             AND                 19590000
185100               VER_STATUS_CDE = 'A'                               19600000
185200     END-EXEC.                                                    19610000
185300                                                                  19620000
185400     EVALUATE TRUE                                                19630000
185500                                                                  19640000
185600         WHEN SQLCODE = +000                                      19650000
185700           IF POAGMT-DISC-PAY-DAY-QTY > 0                         19660000
185800             MOVE POAGMT-DISC-PAY-DAY-QTY TO HL15-ADDL-DAYS       19670000
185900           ELSE                                                   19680000
186000             MOVE ZEROS                     TO HL15-ADDL-DAYS     19690000
186100           END-IF                                                 19700000
186200                                                                  19710000
186300           IF POAGMT-DISC-DOL-AMT > 0                             19720000
186400             MOVE POAGMT-DISC-DOL-AMT TO HL16-ADDL-AMOUNT         19730000
186500           ELSE                                                   19740000
186600             MOVE ZEROS                 TO HL16-ADDL-AMOUNT       19750000
186700           END-IF                                                 19760000
186800                                                                  19770000
186900           IF POAGMT-DISC-PCT > 0                                 19780000
187000             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          19790000
187100             MOVE PV-PCT-HOLD           TO HL17-ADDL-PERCENT      19800000
187200           ELSE                                                   19810000
187300             MOVE ZEROS                 TO HL17-ADDL-PERCENT      19820000
187400           END-IF                                                 19830000
187500                                                                  19840000
187600         WHEN SQLCODE = +100                                      19850000
187700             MOVE ZEROS                 TO HL15-ADDL-DAYS         19860000
187800             MOVE ZEROS                 TO HL16-ADDL-AMOUNT       19870000
187900             MOVE ZEROS                 TO HL17-ADDL-PERCENT      19880000
188000         WHEN SQLWARN NOT = SPACES                                19890000
188100         WHEN SQLCODE NOT = +000                                  19900000
188200             MOVE '2114-ADDL-DISCOUNT'    TO PV-ABEND-PARAGRAPH   19910000
188300                                                                  19920000
188400             PERFORM 9000-SQL-ABEND                               19930000
188500                                                                  19940000
188600     END-EVALUATE.                                                19950000
188700 EJECT                                                            19960000
188800 2115-MOS-DISCOUNT.                                               19970000
188900******************************************************************19980000
189000*  SELECT THE MARK OUT OF STOCK DISCOUNT DATA                     19990000
189100******************************************************************20000000
189200*    DISPLAY '2115-MOS-DISCOUNT'.                                 20010000
189300                                                                  20020000
189400     EXEC SQL                                                     20030000
189500         SELECT DISC_PCT                                          20040000
189600         INTO :POAGMT-DISC-PCT                                    20050000
189700         FROM TPOAGMT                                             20060000
189800         WHERE PO_NBR         = :IR-PO-NBR2        AND            20070000
189900               AGRMT_TYP_ID   = '5'                AND            20080000
190000               TYP_CDE        = 7                  AND            20090000
190100               VER_STATUS_CDE = 'A'                               20100000
190200     END-EXEC.                                                    20110000
190300                                                                  20120000
190400     EVALUATE TRUE                                                20130000
190500                                                                  20140000
190600         WHEN SQLCODE = +000                                      20150000
190700           IF POAGMT-DISC-PCT > 0                                 20160000
190800             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          20170000
190900             MOVE PV-PCT-HOLD           TO HL11-MOS-PCT           20180000
191000           ELSE                                                   20190000
191100             MOVE ZEROS                 TO HL11-MOS-PCT           20200000
191200           END-IF                                                 20210000
191300                                                                  20220000
191400         WHEN SQLCODE = +100                                      20230000
191500             MOVE ZEROS                 TO HL11-MOS-PCT           20240000
191600         WHEN SQLWARN NOT = SPACES                                20250000
191700         WHEN SQLCODE NOT = +000                                  20260000
191800             MOVE '2115-MOS-DISCOUNT'     TO PV-ABEND-PARAGRAPH   20270000
191900                                                                  20280000
192000             PERFORM 9000-SQL-ABEND                               20290000
192100                                                                  20300000
192200     END-EVALUATE.                                                20310000
192300 EJECT                                                            20320000
192400 2116-TRD-DISCOUNT.                                               20330000
192500******************************************************************20340000
192600*  SELECT THE TRADE DISCOUNT DATA                                 20350000
192700******************************************************************20360000
192800*    DISPLAY '2116-TRD-DISCOUNT'.                                 20370000
192900                                                                  20380000
193000     EXEC SQL                                                     20390000
193100         SELECT DISC_PCT                                          20400000
193200         INTO :POAGMT-DISC-PCT                                    20410000
193300         FROM TPOAGMT                                             20420000
193400         WHERE PO_NBR         = :IR-PO-NBR2        AND            20430000
193500               AGRMT_TYP_ID   = '5'                AND            20440000
193600               TYP_CDE        = 8                  AND            20450000
193700               VER_STATUS_CDE = 'A'                               20460000
193800     END-EXEC.                                                    20470000
193900                                                                  20480000
194000     EVALUATE TRUE                                                20490000
194100                                                                  20500000
194200         WHEN SQLCODE = +000                                      20510000
194300           IF POAGMT-DISC-PCT > 0                                 20520000
194400             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          20530000
194500             MOVE PV-PCT-HOLD           TO HL12-TRD-PCT           20540000
194600           ELSE                                                   20550000
194700             MOVE ZEROS                 TO HL12-TRD-PCT           20560000
194800           END-IF                                                 20570000
194900                                                                  20580000
195000         WHEN SQLCODE = +100                                      20590000
195100             MOVE ZEROS                 TO HL12-TRD-PCT           20600000
195200         WHEN SQLWARN NOT = SPACES                                20610000
195300         WHEN SQLCODE NOT = +000                                  20620000
195400             MOVE '2116-TRD-DISCOUNT'     TO PV-ABEND-PARAGRAPH   20630000
195500                                                                  20640000
195600             PERFORM 9000-SQL-ABEND                               20650000
195700                                                                  20660000
195800     END-EVALUATE.                                                20670000
195900 EJECT                                                            20680000
196000 2117-ADV-DISCOUNT.                                               20690000
196100******************************************************************20700000
196200*  SELECT THE ADVERTISING DISCOUNT DATA                           20710000
196300******************************************************************20720000
196400*    DISPLAY '2117-ADV-DISCOUNT'.                                 20730000
196500                                                                  20740000
196600     EXEC SQL                                                     20750000
196700         SELECT DISC_PCT                                          20760000
196800         INTO :POAGMT-DISC-PCT                                    20770000
196900         FROM TPOAGMT                                             20780000
197000         WHERE PO_NBR         = :IR-PO-NBR2        AND            20790000
197100               AGRMT_TYP_ID   = '5'                AND            20800000
197200               TYP_CDE        = 9                  AND            20810000
197300               VER_STATUS_CDE = 'A'                               20820000
197400     END-EXEC.                                                    20830000
197500                                                                  20840000
197600     EVALUATE TRUE                                                20850000
197700                                                                  20860000
197800         WHEN SQLCODE = +000                                      20870000
197900           IF POAGMT-DISC-PCT > 0                                 20880000
198000             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          20890000
198100             MOVE PV-PCT-HOLD           TO HL13-ADV-PCT           20900000
198200           ELSE                                                   20910000
198300             MOVE ZEROS                 TO HL13-ADV-PCT           20920000
198400           END-IF                                                 20930000
198500                                                                  20940000
198600         WHEN SQLCODE = +100                                      20950000
198700             MOVE ZEROS                 TO HL13-ADV-PCT           20960000
198800         WHEN SQLWARN NOT = SPACES                                20970000
198900         WHEN SQLCODE NOT = +000                                  20980000
199000             MOVE '2117-ADV-DISCOUNT'     TO PV-ABEND-PARAGRAPH   20990000
199100                                                                  21000000
199200             PERFORM 9000-SQL-ABEND                               21010000
199300                                                                  21020000
199400     END-EVALUATE.                                                21030000
199500                                                                  21040000
199600******************************************************************21050000
199700*  RETRIEVE THE COUNTRY AND PROVINCE FROM THE PEOPLESOFT TABLES   21060000
199800******************************************************************21070000
199900 2150-RETRIEVE-PROV-COUNTRY.                                      21080000
200000                                                                  21090000
200100     MOVE BUSLOC-ST-PROV-CDE     TO DP410-STATE-CODE.             21100000
200200     MOVE BUSLOC-CNTRY-CDE       TO DP410-COUNTRY-CODE.           21110000
200300                                                                  21120000
200400     CALL PC-DPKUT410 USING DP410-ST-PROV-CNTRY-ROUTINE.          21130000
200500                                                                  21140000
200600     EVALUATE TRUE                                                21150000
200700                                                                  21160000
200800         WHEN  DP410-DB2-ERROR                                    21170000
200900             DISPLAY 'STATE/PROV = ' DP410-STATE-CODE             21180000
201000             DISPLAY 'COUNTRY = ' DP410-COUNTRY-CODE              21190000
201100             MOVE '2150-RETRIEVE-PROV-COUNTRY'                    21200000
201200                                   TO PV-ABEND-PARAGRAPH          21210000
201300             PERFORM 9000-SQL-ABEND                               21220000
201400                                                                  21230000
201500         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      21240000
201600             MOVE DP410-STATE-CODE TO PV-STATE-PROV               21250000
201700             MOVE DP410-COUNTRY-CODE TO PV-COUNTRY                21260000
201800                                                                  21270000
201900         WHEN  OTHER                                              21280000
202000             MOVE DP410-STATE-NAME TO PV-STATE-PROV               21290000
202100             MOVE DP410-COUNTRY-NAME TO PV-COUNTRY                21300000
202200     END-EVALUATE.                                                21310000
202300******************************************************************21320000
202400*  COUNTS TALLPLANS                                               21330000
202500******************************************************************21340000
202600 2196-COUNT-TALLPLNS.                                             21350000
202700                                                                  21360000
202800     INITIALIZE PV-DB2-COUNT.                                     21370000
202900     EXEC SQL                                                     21380000
203000          SELECT COUNT(DISTINCT(DEST_NBR))                        21390000
203100          INTO :PV-DB2-COUNT                                      21400000
203200          FROM TALLPLN                                            21410000
203300          WHERE PO_NBR = :IR-PO-NBR2                              21420000
203400     END-EXEC.                                                    21430000
203500                                                                  21440000
203600     EVALUATE TRUE                                                21450000
203700         WHEN SQLCODE = +0                                        21460000
203800         WHEN SQLCODE = +100                                      21470000
203900              CONTINUE                                            21480000
204000                                                                  21490000
204100         WHEN SQLWARN0 NOT = SPACES                               21500000
204200         WHEN SQLCODE < +0                                        21510000
204300         WHEN SQLCODE > +0                                        21520000
204400             MOVE '2196-COUNT-TALLPLN'                            21530000
204500                                   TO PV-ABEND-PARAGRAPH          21540000
204600             PERFORM 9000-SQL-ABEND                               21550000
204700     END-EVALUATE.                                                21560000
204800                                                                  21570000
204900******************************************************************21580000
205000*  GET DEST NUMBER                                                21590000
205100******************************************************************21600000
205200 2197-GET-SHIP-DEST.                                              21610000
205300                                                                  21620000
205400     INITIALIZE PV-DB2-COUNT.                                     21630000
205500     EXEC SQL                                                     21640000
205600          SELECT DISTINCT(DEST_NBR)                               21650000
205700          INTO :ALLPLN-DEST-NBR                                   21660000
205800          FROM TALLPLN                                            21670000
205900          WHERE PO_NBR = :IR-PO-NBR2                              21680000
206000     END-EXEC.                                                    21690000
206100                                                                  21700000
206200     EVALUATE TRUE                                                21710000
206300         WHEN SQLCODE = +0                                        21720000
206400              CONTINUE                                            21730000
206500                                                                  21740000
206600         WHEN SQLWARN0 NOT = SPACES                               21750000
206700         WHEN SQLCODE < +0                                        21760000
206800         WHEN SQLCODE > +0                                        21770000
206900             MOVE '2197-GET-SHIP-DEST'                            21780000
207000                                   TO PV-ABEND-PARAGRAPH          21790000
207100             PERFORM 9000-SQL-ABEND                               21800000
207200     END-EVALUATE.                                                21810000
207300                                                                  21820000
207400******************************************************************21830000
207500*  GETS TPAYTRM DATA                                              21840000
207600******************************************************************21850000
207700 2198-GET-TPAYTRM.                                                21860000
207800                                                                  21870000
207900     EXEC SQL                                                     21880000
208000         SELECT DISCOUNT_DAYS_QTY,                                21890000
208100                DISCOUNT_PCT,                                     21900000
208200                DUE_DAY_QTY,                                      21910000
208300                DUE_DAY_FR_DTE_TXT,                               21920000
208400                OTHER_TXT                                         21930000
208500         INTO  :PAYTRM-DISCOUNT-DAYS-QTY,                         21940000
208600               :PAYTRM-DISCOUNT-PCT,                              21950000
208700               :PAYTRM-DUE-DAY-QTY,                               21960000
208800               :PAYTRM-DUE-DAY-FR-DTE-TXT,                        21970000
208900               :PAYTRM-OTHER-TXT                                  21980000
209000         FROM TPAYTRM                                             21990000
209100         WHERE PAY_TERM_ID = :POAGMT-PAYT-TERM-ID                 22000000
209200     END-EXEC.                                                    22010000
209300                                                                  22020000
209400     EVALUATE TRUE                                                22030000
209500         WHEN SQLCODE = +0                                        22040000
209600         WHEN SQLCODE = +100                                      22050000
209700             CONTINUE                                             22060000
209800         WHEN SQLWARN NOT = SPACE                                 22070000
209900         WHEN SQLCODE NOT = +0                                    22080000
210000             MOVE '2198-GET-TPAYTRM'                              22090000
210100                                   TO PV-ABEND-PARAGRAPH          22100000
210200             PERFORM 9000-SQL-ABEND                               22110000
210300     END-EVALUATE.                                                22120000
210400                                                                  22130000
210500******************************************************************22140000
210600*  FORMATS PAYMENT TERM                                           22150000
210700******************************************************************22160000
210800 2199-FORMAT-PAYMENT-TERM.                                        22170000
210900                                                                  22180000
211000     MOVE POAGMT-PAYT-TERM-ID      TO PV-EDIT-PAYT-TERM-ID.       22190000
211100     COPY POPD001.                                                22200000
211200     MOVE ASC-PAYT-TERM-ID-DESC TO HL8-PAY-TERM.                  22210000
211300                                                                  22220000
211400******************************************************************22230000
211500*  CONTROLS INSTRUCTION PROCESSING                                22240000
211600******************************************************************22250000
211700 2200-PROCESS-INSTRUCTION.                                        22260000
211800                                                                  22270000
211900     WRITE PORPT-RECORD FROM INSTR-HEADER                         22280000
212000         AFTER 2 LINES.                                           22290000
212100     ADD +2                        TO PV-LINE-CNT.                22300000
212200                                                                  22310000
212300                                                                  22320000
212400     IF HL1-ORD-DATE = SPACES                                     22330000
212500         WRITE PORPT-RECORD FROM NOT-APPROVED-LINE                22340000
212600             AFTER 2 LINE                                         22350000
212700         ADD +2                    TO PV-LINE-CNT                 22360000
212800     END-IF.                                                      22370000
212900                                                                  22380000
213000     IF PURCHS-STATUS-CDE = 'CA'                                  22390000
213100         WRITE PORPT-RECORD FROM CANCELLED-LINE                   22400000
213200             AFTER 2 LINE                                         22410000
213300         ADD +2                    TO PV-LINE-CNT                 22420000
213400     END-IF.                                                      22430000
213500                                                                  22440000
213600     IF PURCHS-REVISION-CT > 0                                    22450000
213700         WRITE PORPT-RECORD FROM REVISED-LINE                     22460000
213800             AFTER 2 LINE                                         22470000
213900         ADD +2                    TO PV-LINE-CNT                 22480000
214000     END-IF.                                                      22490000
214100                                                                  22500000
214200     IF PS-VENDOR-RPT-TYPE                                        22510000
214300         MOVE 'VN'                 TO POINST-RECIP-CDE            22520000
214400                                      PV-RECIP-CDE-HOLD           22530000
214500     ELSE                                                         22540000
214600         IF PS-BUYER-RPT-TYPE OR PS-ANALYST-RPT-TYPE              22550000
214700             MOVE '%%'             TO POINST-RECIP-CDE            22560000
214800             MOVE '  '             TO PV-RECIP-CDE-HOLD           22570000
214900         ELSE                                                     22580000
215000             MOVE 'DC'             TO POINST-RECIP-CDE            22590000
215100                                      PV-RECIP-CDE-HOLD           22600000
215200         END-IF                                                   22610000
215300     END-IF.                                                      22620000
215400                                                                  22630000
215500     SET PS-NOT-EOF-INST-CSR       TO TRUE.                       22640000
215600     PERFORM 2210-OPEN-INST-CSR.                                  22650000
215700     PERFORM 2220-PROCESS-INST-CSR                                22660000
215800         UNTIL PS-EOF-INST-CSR.                                   22670000
215900     PERFORM 2230-CLOSE-INST-CSR.                                 22680000
216000                                                                  22690000
216100******************************************************************22700000
216200*  OPENS INSTRUCTION CODE CSR                                     22710000
216300******************************************************************22720000
216400 2210-OPEN-INST-CSR.                                              22730000
216500                                                                  22740000
216600     EXEC SQL                                                     22750000
216700         OPEN INST-CSR                                            22760000
216800     END-EXEC.                                                    22770000
216900                                                                  22780000
217000     EVALUATE TRUE                                                22790000
217100         WHEN SQLCODE = +0                                        22800000
217200             CONTINUE                                             22810000
217300         WHEN SQLWARN NOT = SPACE                                 22820000
217400         WHEN SQLCODE NOT = +0                                    22830000
217500             MOVE '2210-OPEN-INST-CSR'                            22840000
217600                                   TO PV-ABEND-PARAGRAPH          22850000
217700             PERFORM 9000-SQL-ABEND                               22860000
217800     END-EVALUATE.                                                22870000
217900                                                                  22880000
218000******************************************************************22890000
218100*  FETCHS INSTRUCTION CSR AND PRINTS                              22900000
218200******************************************************************22910000
218300 2220-PROCESS-INST-CSR.                                           22920000
218400                                                                  22930000
218500     EXEC SQL                                                     22940000
218600         FETCH INST-CSR                                           22950000
218700         INTO  :INSTCD-INSTR-DESC,                                22960000
218800               :INSTCD-INSTR-NBR,                                 22970000
218900               :INRCCD-RECIP-CDE,                                 22980000
219000               :INRCCD-RECIP-DESC                                 22990000
219100     END-EXEC.                                                    23000000
219200                                                                  23010000
219300     EVALUATE TRUE                                                23020000
219400         WHEN SQLCODE = +0                                        23030000
219500         WHEN SQLCODE = +100                                      23040000
219600             CONTINUE                                             23050000
219700         WHEN SQLWARN NOT = SPACE                                 23060000
219800         WHEN SQLCODE NOT = +0                                    23070000
219900             MOVE '2220-PROCESS-INST-CSR'                         23080000
220000                                   TO PV-ABEND-PARAGRAPH          23090000
220100             PERFORM 9000-SQL-ABEND                               23100000
220200     END-EVALUATE.                                                23110000
220300                                                                  23120000
220400     IF SQLCODE = +100                                            23130000
220500         SET PS-EOF-INST-CSR       TO TRUE                        23140000
220600     ELSE                                                         23150000
220700         IF PV-LINE-CNT > +58                                     23160000
220800             ADD +1                TO PV-PAGE-CNT                 23170000
220900             MOVE PV-PAGE-CNT      TO HL2-PAGE                    23180000
221000             MOVE +0               TO PV-LINE-CNT                 23190000
221100                                                                  23200000
221200             WRITE PORPT-RECORD FROM HEADER-LINE1                 23210000
221300                 AFTER ADVANCING PAGE                             23220000
221400             WRITE PORPT-RECORD FROM HEADER-LINE2                 23230000
221500                 AFTER 1 LINES                                    23240000
221600             WRITE PORPT-RECORD FROM HEADER-LINE3                 23250000
221700                 AFTER 1 LINES                                    23260000
221800             WRITE PORPT-RECORD FROM INSTR-HEADER                 23270000
221900                 AFTER 2 LINES                                    23280000
222000             MOVE +5               TO PV-LINE-CNT                 23290000
222100         END-IF                                                   23300000
222200                                                                  23310000
222300         IF INRCCD-RECIP-CDE = PV-RECIP-CDE-HOLD                  23320000
222400             CONTINUE                                             23330000
222500         ELSE                                                     23340000
222600             MOVE INRCCD-RECIP-DESC                               23350000
222700                                   TO INSTR-RECIP                 23360000
222800             WRITE PORPT-RECORD FROM INSTR-RECIP-LINE             23370000
222900                 AFTER 1 LINES                                    23380000
223000             MOVE INRCCD-RECIP-CDE TO PV-RECIP-CDE-HOLD           23390000
223100             ADD +1                TO PV-LINE-CNT                 23400000
223200         END-IF                                                   23410000
223300                                                                  23420000
223400         MOVE INSTCD-INSTR-DESC    TO INSTR-DESC                  23430000
223500         WRITE PORPT-RECORD FROM INSTR-LINE                       23440000
223600             AFTER 1 LINES                                        23450000
223700         ADD +1                    TO PV-LINE-CNT                 23460000
223800     END-IF.                                                      23470000
223900                                                                  23480000
224000******************************************************************23490000
224100*  CLOSES INSTRUCTION CODE CSR                                    23500000
224200******************************************************************23510000
224300 2230-CLOSE-INST-CSR.                                             23520000
224400                                                                  23530000
224500     EXEC SQL                                                     23540000
224600         CLOSE INST-CSR                                           23550000
224700     END-EXEC.                                                    23560000
224800                                                                  23570000
224900     EVALUATE TRUE                                                23580000
225000         WHEN SQLCODE = +0                                        23590000
225100             CONTINUE                                             23600000
225200         WHEN SQLWARN NOT = SPACE                                 23610000
225300         WHEN SQLCODE NOT = +0                                    23620000
225400             MOVE '2230-CLOSE-INST-CSR'                           23630000
225500                                   TO PV-ABEND-PARAGRAPH          23640000
225600             PERFORM 9000-SQL-ABEND                               23650000
225700     END-EVALUATE.                                                23660000
225800                                                                  23670000
225900******************************************************************23680000
226000*  CONTROLS SKUS PROCESSING                                       23690000
226100******************************************************************23700000
226200 2300-PROCESS-SKUS.                                               23710000
226300                                                                  23720000
226400     MOVE 0                        TO PV-PO-LINE-NBR.             23730000
226500     SET PS-NOT-EOF-PO-LINE-CSR    TO TRUE.                       23740000
226600     PERFORM 2310-OPEN-PO-LINE-CSR.                               23750000
226700     PERFORM 2320-PROCESS-PO-LINE-CSR                             23760000
226800         UNTIL PS-EOF-PO-LINE-CSR.                                23770000
226900     PERFORM 2330-CLOSE-PO-LINE-CSR.                              23780000
227000                                                                  23790000
227100******************************************************************23800000
227200*  OPENS PO LINE CSR                                              23810000
227300******************************************************************23820000
227400 2310-OPEN-PO-LINE-CSR.                                           23830000
227500                                                                  23840000
W24803     MOVE IR-PO-NBR2           TO PURITM-PO-NBR                   23850000
227600     PERFORM WITH TEST AFTER                                      23860000
227700        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      23870000
227800        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              23880000
227900                SQLCODE = ZERO                                    23890000
228000        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               23900000
228100                            OR 'RS' OR 'WK'                       23910000
228200            EXEC SQL                                              23920000
228300                OPEN PO-LINE-CSR                                  23930000
228400            END-EXEC                                              23940000
228500        ELSE                                                      23950000
228600            EXEC SQL                                              23960000
228700                OPEN APP-PO-LINE-CSR                              23970000
228800            END-EXEC                                              23980000
228900        END-IF                                                    23990000
229000                                                                  24000000
229100        EVALUATE TRUE                                             24010000
229200            WHEN SQLCODE = +0                                     24020000
229300                CONTINUE                                          24030000
229400            WHEN SQLCODE = -904                                   24040000
229500            WHEN SQLCODE = -911                                   24050000
229600            WHEN SQLCODE = -913                                   24060000
229700                CONTINUE                                          24070000
229800            WHEN SQLWARN NOT = SPACE                              24080000
229900            WHEN SQLCODE NOT = +0                                 24090000
230000                MOVE '2310-OPEN-PO-LINE-CSR'                      24100000
230100                                      TO PV-ABEND-PARAGRAPH       24110000
230200                PERFORM 9000-SQL-ABEND                            24120000
230300        END-EVALUATE                                              24130000
230400     END-PERFORM.                                                 24140000
230500                                                                  24150000
230600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         24160000
230700         MOVE '2310-OPEN-PO-LINE-CSR' TO PV-ABEND-PARAGRAPH       24170000
230800         PERFORM 9000-SQL-ABEND                                   24180000
230900     END-IF.                                                      24190000
231000                                                                  24200000
231100******************************************************************24210000
231200*  OPENS UPC CURSOR                                               24220000
231300******************************************************************24230000
231400*2320-OPEN-UPC-CSR.                                               24240028
W24803*                                                                 24250028
W24803*        MOVE IR-PO-NBR2 TO POUPC-PO-NBR                          24260028
231500*        EXEC SQL                                                 24270028
231600*            OPEN UPC_CURSOR                                      24280028
231700*        END-EXEC                                                 24290028
231800*    EVALUATE TRUE                                                24300028
231900*        WHEN SQLCODE = +0                                        24310028
232000*            CONTINUE                                             24320028
232100*        WHEN SQLWARN NOT = SPACE                                 24330028
232200*        WHEN SQLCODE NOT = +0                                    24340028
232300*            MOVE '2320-OPEN-UPC-CSR'                             24350028
232400*                                  TO PV-ABEND-PARAGRAPH          24360028
232500*            PERFORM 9000-SQL-ABEND                               24370028
232600*    END-EVALUATE.                                                24380028
232700                                                                  24390000
232800******************************************************************24400000
232900*  FETCHS PO LINE CSR AND PRINTS                                  24410000
233000******************************************************************24420000
233100 2320-PROCESS-PO-LINE-CSR.                                        24430000
233200                                                                  24440000
W24803     INITIALIZE  PV-NULL-INDICATOR-VARIABLES.                     24450000
233300     PERFORM WITH TEST AFTER                                      24460000
233400        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      24470000
233500        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              24480000
233600                SQLCODE = ZERO OR SQLCODE = +100                  24490000
233700        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               24500000
233800                            OR 'RS' OR 'WK'                       24510000
233900            EXEC SQL                                              24520000
234000                FETCH PO-LINE-CSR                                 24530000
234100                INTO :PURITM-CL-NBR,                              24540000
234200                     :PURITM-SKU-SEQ-NBR,                         24550000
234300                     :PURITM-VEND-STYL-NAME,                      24560000
234400                     :PURITM-SKU-DESC,                            24570000
W24803                     :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,      24580000
W24803                     :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,      24590000
W24803                     :XLT00003-SKU-NBR:PV-SKU-NBR-IND,            24600000
W24803                     :XLT00004-VS-NBR:PV-VS-NBR-IND,              24610000
W24803                     :XLT00003-SKU-DESC:PV-SKU-DESC-IND,          24620000
234500                     :PURITM-UNT-QTY,                             24630000
234600                     :PURITM-UNT-COST-AMT,                        24640000
234700                     :PURITM-TOT-VAL-COST-AMT,                    24650000
234800                     :PURITM-COLOR-DESC,                          24660000
234900                     :PURITM-SIZE-DESC,                           24670000
W24803                 :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,  24680000
W24803                     :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,        24690000
235000                     :PURITM-AD-EVNT-DTE,                         24700000
235100                     :PURITM-GP-QTY,                              24710000
235200                     :PURITM-GP-RTL-AMT,                          24720000
235300                     :PURITM-UNT-RTL-PR-AMT,                      24730000
235400                     :PURITM-TOT-VAL-RTL-AMT,                     24740000
235500                     :PURITM-PO-LNE-NBR,                          24750000
235600                     :PURITM-STATUS-CDE,                          24760000
235610* TKMA888 * ADDED 1 LINES ****************************************24770000
235620                     :PURITM-PRD-1ST-COST-AMT,                    24780000
235630* TKMA888 *------------------------------------------------------*24790000
235700                     :PURITM-ITM-NBR                              24800000
235800            END-EXEC                                              24810000
235900        ELSE                                                      24820000
236000            EXEC SQL                                              24830000
236100                FETCH APP-PO-LINE-CSR                             24840000
236200                INTO :PURITM-CL-NBR,                              24850000
236300                     :PURITM-SKU-SEQ-NBR,                         24860000
236400                     :PURITM-VEND-STYL-NAME,                      24870000
236500                     :PURITM-SKU-DESC,                            24880000
W24803                     :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,      24890000
W24803                     :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,      24900000
W24803                     :XLT00003-SKU-NBR:PV-SKU-NBR-IND,            24910000
W24803                     :XLT00004-VS-NBR:PV-VS-NBR-IND,              24920000
W24803                     :XLT00003-SKU-DESC:PV-SKU-DESC-IND,          24930000
236600                     :PURITM-UNT-QTY,                             24940000
236700                     :PURITM-UNT-COST-AMT,                        24950000
236800                     :PURITM-TOT-VAL-COST-AMT,                    24960000
236900                     :PURITM-COLOR-DESC,                          24970000
237000                     :PURITM-SIZE-DESC,                           24980000
W24803                 :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,  24990000
W24803                     :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,        25000000
237100                     :PURITM-AD-EVNT-DTE,                         25010000
237200                     :PURITM-GP-QTY,                              25020000
237300                     :PURITM-GP-RTL-AMT,                          25030000
237400                     :PURITM-UNT-RTL-PR-AMT,                      25040000
237500                     :PURITM-TOT-VAL-RTL-AMT,                     25050000
237600                     :PURITM-PO-LNE-NBR,                          25060000
237700                     :PURITM-APP-PO-LNE-NBR,                      25070000
237800                     :PURITM-STATUS-CDE,                          25080000
237810* TKMA888 * ADDED 1 LINES ****************************************25090000
237820                     :PURITM-PRD-1ST-COST-AMT,                    25100000
237830* TKMA888 *------------------------------------------------------*25110000
237900                     :PURITM-ITM-NBR                              25120000
238000            END-EXEC                                              25130000
238100        END-IF                                                    25140000
238200                                                                  25150000
238300        EVALUATE TRUE                                             25160000
238400            WHEN SQLCODE = +0                                     25170000
238500            WHEN SQLCODE = +100                                   25180000
238600                CONTINUE                                          25190000
238700            WHEN SQLCODE = -904                                   25200000
238800            WHEN SQLCODE = -911                                   25210000
238900            WHEN SQLCODE = -913                                   25220000
239000                CONTINUE                                          25230000
239100            WHEN SQLWARN NOT = SPACE                              25240000
239200            WHEN SQLCODE NOT = +0                                 25250000
239300                MOVE '2320-PROCESS-PO-LINE-CSR'                   25260000
239400                                      TO PV-ABEND-PARAGRAPH       25270000
239500                PERFORM 9000-SQL-ABEND                            25280000
239600        END-EVALUATE                                              25290000
239700     END-PERFORM.                                                 25300000
239800                                                                  25310000
239900                                                                  25320000
240000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25330000
240100         MOVE '2350-PROCESS-PO-LINE-CSR' TO PV-ABEND-PARAGRAPH    25340000
240200         PERFORM 9000-SQL-ABEND                                   25350000
240300     END-IF.                                                      25360000
240400                                                                  25370000
240500     IF SQLCODE = +100                                            25380000
240600         SET PS-EOF-PO-LINE-CSR    TO TRUE                        25390000
240700     ELSE                                                         25400000
240800         MOVE +0                   TO PV-ALLOC-CNT                25410000
240900                                      PV-UPC-DTL-CNT              25420000
241000*        PERFORM 2322-COUNT-POUPC-ROWS                            25430028
241000*        REMOVING CALL TO 2322-COUNT-POUPC-ROWS, SO               25431029
241000*        PV-UPC-DTL-CNT WILL ALWAYS BE ZERO                       25432029
241100         IF (PS-VENDOR-RPT-TYPE AND PS-NOT-PACK-BY-STORE)         25440000
241200            CONTINUE                                              25450000
241300         ELSE                                                     25460000
241400            PERFORM 2321-COUNT-ALLOCATIONS                        25470000
241500         END-IF                                                   25480000
241600                                                                  25490000
241700         IF PURCHS-STATUS-CDE =                                   25500000
241800                             'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK' 25510000
241900             ADD +1                TO PV-PO-LINE-NBR              25520000
242000             MOVE PV-PO-LINE-NBR   TO SL1-SKU-NBR                 25530000
242100         ELSE                                                     25540000
242200             MOVE PURITM-APP-PO-LNE-NBR                           25550000
242300                                   TO SL1-SKU-NBR                 25560000
242400         END-IF                                                   25570000
242500                                                                  25580000
242600         MOVE PURCHS-DEPT-NBR      TO SL1-DEPT                    25590000
W24803         IF PV-SKU-NBR-IND = +0                                   25600000
W24803            MOVE XLT00004-MAJ-CL-NBR  TO SL1-MAJ-CLASS            25610000
W24803            MOVE XLT00004-SUB-CL-NBR  TO SL1-CLASS                25620000
W24803            MOVE XLT00003-SKU-NBR     TO SL1-SKU                  25630000
W24803            MOVE XLT00004-VS-NBR      TO SL1-STYLE                25640000
W24803            MOVE XLT00003-SKU-DESC    TO SL1-DESC                 25650000
W24803            MOVE XLT00003-CSTM-CLOR-DESC TO SL2-COLOR             25660000
W24803            MOVE XLT00003-SIZE-DESC   TO SL2-SIZE                 25670000
W24803         ELSE                                                     25680000
W24803            MOVE PURITM-CL-NBR        TO SL1-CLASS                25690000
W24803            MOVE PURCHS-DEPT-NBR      TO PV-TEMP-DEPT             25700000
W24803            MOVE PURITM-CL-NBR        TO PV-TEMP-CLASS            25710000
W24803            MOVE PURITM-SKU-SEQ-NBR   TO PV-TEMP-SEQ              25720000
W24803            MOVE PV-TEMP-SKU          TO SL1-SKU                  25730000
W24803            MOVE PURITM-CL-NBR(1:1)   TO PV-TEMP-MAJ-CL-1         25740000
W24803            MOVE PV-TEMP-MAJ-CL       TO SL1-MAJ-CLASS            25750000
W24803            MOVE PURITM-VEND-STYL-NAME TO SL1-STYLE               25760000
W24803            MOVE PURITM-SKU-DESC      TO SL1-DESC                 25770000
W24803            MOVE PURITM-COLOR-DESC    TO SL2-COLOR                25780000
W24803            MOVE PURITM-SIZE-DESC     TO SL2-SIZE                 25790000
W24803         END-IF                                                   25800000
243200         MOVE PURITM-UNT-QTY       TO SL1-QTY                     25810000
243310* TKMA888 * REPLACED 1 LINE WITH 5 LINES *************************25820000
243320*           TO CHANGE UNIT COST AMOUNT FOR IMPORT PO'S            25830000
243330* TKMA888 *------------------------------------------------------*25840000
243341*        MOVE PURITM-UNT-COST-AMT  TO SL1-COST                    25850000
243350* TKMA888 *------------------------------------------------------*25860000
243370         MOVE PURITM-PRD-1ST-COST-AMT TO SL1-COST                 25870001
243392* TKMA888 *------------------------------------------------------*25880000
243510* TKMA888 * REPLACED 2 LINE WITH 7 LINES *************************25890000
243520*           TO CHANGE COMPUTE OF ITEM TOTAL COST FOR IMPORT PO'S  25900000
243530* TKMA888 *------------------------------------------------------*25910000
243531*        MOVE PURITM-TOT-VAL-COST-AMT                             25920000
243532*                                  TO SL1-TOT-COST                25930000
243560* TKMA888 *------------------------------------------------------*25940000
243580         COMPUTE PV-TOT-VAL-COST-AMT =                            25950001
243590                 PURITM-UNT-QTY * PURITM-PRD-1ST-COST-AMT         25960001
243591         MOVE PV-TOT-VAL-COST-AMT     TO SL1-TOT-COST             25970001
243595* TKMA888 *------------------------------------------------------*25980000
243800         IF SL2-SIZE = 'ASSORTED' AND  PV-UPC-DTL-CNT > 0         25990000
243900            MOVE 'SEE BELOW' TO SL2-SIZE                          26000000
244000         END-IF                                                   26010000
244100         IF PURITM-AD-EVNT-DTE = PC-INIT-DATE                     26020000
244200             MOVE SPACES           TO SL2-AD-DATE                 26030000
244300         ELSE                                                     26040000
244400             MOVE PURITM-AD-EVNT-DTE                              26050000
244500                                   TO PV-DATE-BREAK               26060000
244600             MOVE PV-DB-MM         TO PV-DBS-MM                   26070000
244700             MOVE PV-DB-DD         TO PV-DBS-DD                   26080000
244800             MOVE PV-DB-YY         TO PV-DBS-YY                   26090000
244900             MOVE PV-DATE-BREAK-SLASH                             26100000
245000                                   TO SL2-AD-DATE                 26110000
245100         END-IF                                                   26120000
245200         IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'          26130000
245300             MOVE SPACES           TO SL2-GRP-PRICE               26140000
245400         ELSE                                                     26150000
245500             IF PURITM-GP-QTY > +1                                26160000
245600                 MOVE PURITM-GP-QTY                               26170000
245700                                   TO PV-GP-QTY                   26180000
245800                 MOVE PURITM-GP-RTL-AMT                           26190000
245900                                   TO PV-GP-AMT                   26200000
246000                 MOVE PV-GRP-PRICE TO SL2-GRP-PRICE               26210000
246100             ELSE                                                 26220000
246200                 MOVE SPACES       TO SL2-GRP-PRICE               26230000
246300             END-IF                                               26240000
246400         END-IF                                                   26250000
246500         IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'          26260000
246600             MOVE SPACES           TO SL2-RTL-COST                26270000
246700             MOVE SPACES           TO SL2-TOT-RTL-COST            26280000
246800         ELSE                                                     26290000
246900             MOVE PURITM-UNT-RTL-PR-AMT                           26300000
247000                                   TO PV-DOL-FORM-14              26310000
247100             MOVE PV-DOL-FORM-14   TO SL2-RTL-COST                26320000
247200             MOVE PURITM-TOT-VAL-RTL-AMT                          26330000
247300                                   TO PV-DOL-FORM-14              26340000
247400             MOVE PV-DOL-FORM-14   TO SL2-TOT-RTL-COST            26350000
247500         END-IF                                                   26360000
247600                                                                  26370000
247700         PERFORM 2370-ADVANCE-TO-NEWPAGE                          26380000
247800         WRITE PORPT-RECORD FROM SKU-LINE-1                       26390000
247900             AFTER 2 LINES                                        26400000
248000         PERFORM 2370-ADVANCE-TO-NEWPAGE                          26410000
248100         WRITE PORPT-RECORD FROM SKU-LINE-2                       26420000
248200             AFTER 1 LINES                                        26430000
248300         ADD +3                    TO PV-LINE-CNT                 26440000
248400                                                                  26450000
248500         IF PURITM-STATUS-CDE = 'CA'                              26460000
248600             WRITE PORPT-RECORD FROM LINE-CANCEL-LINE             26470000
248700                 AFTER 2 LINES                                    26480000
248800             ADD +2                TO PV-LINE-CNT                 26490000
248900         ELSE                                                     26500000
249000               IF PV-ALLOC-CNT = +0 OR                            26510000
249100                     (PS-BUYER-RPT-TYPE AND PS-NOT-PACK-BY-STORE) 26520000
249200                  OR (PS-VENDOR-RPT-TYPE AND PURCHS-EDI-IND = 'N' 26530000
249300                                         AND PS-NOT-PACK-BY-STORE)26540000
249400* GET ALL THE UPC'S FOR THIS SKU                                  26550000
249500                 INITIALIZE PV-SAVE-TABLE                         26560000
249600                 PERFORM                                          26570000
249700                 VARYING PV-STR-IDX FROM 1 BY 1                   26580000
249800                 UNTIL PV-STR-IDX > 2000                          26590000
249900                    MOVE 0 TO PV-SAVE-STR-NBR(PV-STR-IDX)         26600000
250000                    PERFORM                                       26610000
250100                    VARYING PV-UPC-IDX FROM 1 BY 1                26620000
250200                    UNTIL PV-UPC-IDX > 50                         26630000
250300                     MOVE SPACES TO PV-SAVE-UPC-DESC(PV-STR-IDX   26640000
250400                                                    PV-UPC-IDX)   26650000
250500                    END-PERFORM                                   26660000
250600                 END-PERFORM                                      26670000
250700                 SET PV-UPC-IDX TO +1                             26680000
W24803*                IF PV-SKU-NBR-IND = +0                           26690028
250800*                   SET PS-NOT-EOF-UPC-CSR TO TRUE                26700028
250900*                   PERFORM 2320-OPEN-UPC-CSR                     26710028
251000*                   PERFORM 2350-FETCH-UPC-CSR                    26720028
251100*                        UNTIL PS-EOF-UPC-CSR                     26730028
251200*                   PERFORM 2326-CLOSE-UPC-CSR                    26740028
W24803*                END-IF                                           26750028
251300                 PERFORM F175-DISPLAY-UPC2-QUANTITIES             26760000
251400               ELSE                                               26770000
251500                IF PV-ALLOC-CNT = +0 OR                           26780000
251600                    (PS-VENDOR-RPT-TYPE AND PS-NOT-PACK-BY-STORE  26790000
251700                     AND PURCHS-EDI-IND = 'Y')                    26800000
251800                     CONTINUE                                     26810000
251900                ELSE                                              26820000
252000                 PERFORM 2370-ADVANCE-TO-NEWPAGE                  26830000
252100* PRINT "STORE DISTRIBUTION:"                                     26840000
252200                 WRITE PORPT-RECORD FROM DISTR-HEADER-1           26850000
252300                     AFTER 2 LINES                                26860000
252400                 ADD +2 TO PV-LINE-CNT                            26870000
252500                 IF PV-UPC-DTL-CNT = 0                            26880000
252600                    IF PV-ALLOC-CNT < +7                          26890000
252700                        CONTINUE                                  26900000
252800                    ELSE                                          26910000
252900                        MOVE +7    TO PV-ALLOC-CNT                26920000
253000                    END-IF                                        26930000
253100                 ELSE                                             26940000
253200                    IF PV-ALLOC-CNT < +4                          26950000
253300                        CONTINUE                                  26960000
253400                    ELSE                                          26970000
253500                        MOVE +4    TO PV-ALLOC-CNT                26980000
253600                    END-IF                                        26990000
253700                 END-IF                                           27000000
253800                                                                  27010000
253900                 PERFORM 2323-OPEN-ALLOC-CSR                      27020000
254000                 MOVE +0           TO PV-SUB                      27030000
254100                                      PV-NBR-STORES               27040000
254200                                      PV-NBR-WRITES               27050000
254300                 SET PV-STR-IDX    TO +1                          27060000
254400                 INITIALIZE PV-SAVE-TABLE                         27070000
254500                 INITIALIZE DISTR-LINE                            27080000
254600                 INITIALIZE DISTR-LINE-OLD                        27090000
254700                 SET PS-NOT-EOF-ALLOC-CSR                         27100000
254800                                   TO TRUE                        27110000
254900                 PERFORM 2324-PROCESS-ALLOC-CSR                   27120000
255000                     UNTIL PS-EOF-ALLOC-CSR                       27130000
255100                 PERFORM 2325-CLOSE-ALLOC-CSR                     27140000
255200* GET ALL THE UPC'S FOR THIS SKU                                  27150000
255300                 SET PV-UPC-IDX TO +1                             27160000
W24803*                IF PV-SKU-NBR-IND = +0                           27170028
255400*                   SET PS-NOT-EOF-UPC-CSR TO TRUE                27180028
255500*                   PERFORM 2320-OPEN-UPC-CSR                     27190028
255600*                   PERFORM 2350-FETCH-UPC-CSR                    27200028
255700*                        UNTIL PS-EOF-UPC-CSR                     27210028
255800*                   PERFORM 2326-CLOSE-UPC-CSR                    27220028
W24803*                END-IF                                           27230028
255900* CALCULATE THE UPC QUANTITIES PER STORE                          27240000
256000                 PERFORM F100-COMPUTE-UPC-QTYS                    27250000
256100                 PERFORM F150-CHECK-IF-TOTALS                     27260000
256200             END-IF                                               27270000
256300          END-IF                                                  27280000
256400       END-IF                                                     27290000
256500     END-IF.                                                      27300000
256600                                                                  27310000
256700 F100-COMPUTE-UPC-QTYS.                                           27320000
256800      PERFORM                                                     27330000
256900        VARYING PV-STR-IDX                                        27340000
257000        FROM +1 BY +1                                             27350000
257100        UNTIL PV-STR-IDX > PV-NBR-STORES                          27360000
257200           OR PV-STR-IDX > 999                                    27370000
257300             PERFORM                                              27380000
257400               VARYING PV-UPC-IDX                                 27390000
257500               FROM +1 BY +1                                      27400000
257600               UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) =    27410000
257700                           SPACES                                 27420000
257800                  OR PV-UPC-IDX > 50                              27430000
257900                    COMPUTE PV-UPC-PCT = PV-SAVE-POUPC-QTY        27440000
258000                        (PV-STR-IDX PV-UPC-IDX) / PURITM-UNT-QTY  27450000
258100                    COMPUTE PV-QTY ROUNDED =                      27460000
258200                        PV-UPC-PCT * PV-SAVE-STR-QTY(PV-STR-IDX)  27470000
258300                    COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-IDX) =    27480000
258400                         PV-QTY + PV-SAVE-STR-SUBTOTAL(PV-STR-IDX)27490000
258500* KEEP A RUNNING TOTAL OF THE UPC QUANTITIES FOR ALL STORES       27500000
258600                    IF PV-STR-IDX = +1                            27510000
258700                      MOVE PV-QTY TO PV-SAVE-UPC-SUBTOTAL         27520000
258800                       (PV-STR-IDX PV-UPC-IDX)                    27530000
258900                    ELSE                                          27540000
259000                         SET PV-STR-ADJ TO PV-STR-IDX             27550000
259100                         SET PV-STR-IDX DOWN BY +1                27560000
259200                         COMPUTE PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ  27570000
259300                       PV-UPC-IDX) = PV-QTY + PV-SAVE-UPC-SUBTOTAL27580000
259400                                           (PV-STR-IDX PV-UPC-IDX)27590000
259500                         SET PV-STR-IDX UP BY +1                  27600000
259600                    END-IF                                        27610000
259700                    MOVE PV-QTY TO PV-SAVE-UPC-QTY-STR            27620000
259800                                          (PV-STR-IDX PV-UPC-IDX) 27630000
259900             END-PERFORM                                          27640000
260000      END-PERFORM.                                                27650000
260100                                                                  27660000
260200 EJECT                                                            27670000
260300                                                                  27680000
260400 F150-CHECK-IF-TOTALS.                                            27690000
260500*DISPLAY MAKE SURE THE UPC TOTALS ARE WHAT IS GIVEN ON TPOUPC     27700000
260600* ALSO MAKE SURE THE STORE QUANTITIES ADD UP TO TMESTDS TOTAL     27710000
260700      PERFORM                                                     27720000
260800        VARYING PV-STR-IDX                                        27730000
260900        FROM +1 BY +1                                             27740000
261000        UNTIL PV-STR-IDX > PV-NBR-STORES                          27750000
261100           OR PV-STR-IDX > 999                                    27760000
261200           MOVE ZERO TO PV-UPC-TOTAL-QTY                          27770000
261300             PERFORM                                              27780000
261400               VARYING PV-UPC-IDX                                 27790000
261500               FROM +1 BY +1                                      27800000
261600               UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) =    27810000
261700                           SPACES                                 27820000
261800                  OR PV-UPC-IDX > 50                              27830000
261900                    ADD PV-SAVE-UPC-QTY-STR(PV-STR-IDX PV-UPC-IDX)27840000
262000                           TO PV-UPC-TOTAL-QTY                    27850000
262100             END-PERFORM                                          27860000
262200* VERIFY THAT THE SPLIT QUANTITIES ADD UP TO THE UPC TOTAL        27870000
262300             IF PV-UPC-TOTAL-QTY NOT = PV-SAVE-STR-QTY(PV-STR-IDX)27880000
262400                  SET PV-STR-ADJ TO PV-STR-IDX                    27890000
262500                  PERFORM F200-ADJUST-SPLIT-QUANTITIES            27900000
262600             END-IF                                               27910000
262700      END-PERFORM.                                                27920000
262800      SET PV-STR-IDX DOWN BY +1.                                  27930000
262900      PERFORM                                                     27940000
263000        VARYING PV-UPC-IDX                                        27950000
263100        FROM +1 BY +1                                             27960000
263200        UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) = SPACES    27970000
263300            OR PV-UPC-IDX > 50                                    27980000
263400            IF NOT PV-SAVE-UPC-SUBTOTAL(PV-STR-IDX PV-UPC-IDX) =  27990000
263500                   PV-SAVE-POUPC-QTY(1 PV-UPC-IDX)                28000000
263600                  PERFORM F200-ADJUST-SPLIT-QTY-STR               28010000
263700            END-IF                                                28020000
263800      END-PERFORM.                                                28030000
263900                                                                  28040000
264000        INITIALIZE DISTR-LINE.                                    28050000
264100        INITIALIZE DISTR-LINE-OLD.                                28060000
264200        MOVE +0           TO PV-SUB                               28070000
264300                             PV-TIMES2.                           28080000
264400        IF PV-UPC-DTL-CNT = 0                                     28090000
264500           INITIALIZE DISTR-HEADER-3                              28100000
264600           IF PV-NBR-STORES > 7                                   28110000
264700              MOVE PV-ALLOC-CNT TO PV-NBR-TIMES                   28120000
264800           ELSE                                                   28130000
264900              MOVE PV-NBR-STORES TO PV-NBR-TIMES                  28140000
265000           END-IF                                                 28150000
265100           PERFORM 2370-ADVANCE-TO-NEWPAGE                        28160000
265200           PERFORM 2322-FILL-DIST-HEAD2-OLD                       28170028
265300               VARYING PV-SUB1 FROM +1 BY +1                      28180028
265400               UNTIL PV-SUB1 > PV-NBR-TIMES                       28190028
265500*    PRINT ' --STORE--  QUANTITY   '.                             28200000
265600           WRITE PORPT-RECORD FROM DISTR-HEADER-3                 28210000
265700               AFTER 1 LINES                                      28220000
265800           ADD +1              TO PV-LINE-CNT                     28230000
265900        ELSE                                                      28240000
266000            INITIALIZE DISTR-HEADER-2                             28250000
266100            IF PV-NBR-STORES > 4                                  28260000
266200               MOVE PV-ALLOC-CNT TO PV-NBR-TIMES                  28270000
266300            ELSE                                                  28280000
266400               MOVE PV-NBR-STORES TO PV-NBR-TIMES                 28290000
266500            END-IF                                                28300000
266600            PERFORM 2370-ADVANCE-TO-NEWPAGE                       28310000
266700            PERFORM 2322-FILL-DIST-HEAD2                          28320028
266800                VARYING PV-SUB1 FROM +1 BY +1                     28330028
266900                UNTIL PV-SUB1 > PV-NBR-TIMES                      28340028
267000* PRINT  ' --STORE--  ---SIZE---  QUANTITY   '.                   28350000
267100            WRITE PORPT-RECORD FROM DISTR-HEADER-2                28360000
267200                AFTER 1 LINES                                     28370000
267300            ADD +1             TO PV-LINE-CNT                     28380000
267400        END-IF.                                                   28390000
267500                                                                  28400000
267600        PERFORM                                                   28410000
267700          VARYING PV-STR-IDX                                      28420000
267800          FROM +1 BY +1                                           28430000
267900          UNTIL PV-STR-IDX > PV-NBR-STORES                        28440000
268000          OR PV-STR-IDX > 999                                     28450000
268100             ADD +1            TO PV-SUB                          28460000
268200             IF PV-UPC-DTL-CNT = 0                                28470000
268300                MOVE PV-SAVE-STR-NBR(PV-STR-IDX)                  28480000
268400                                  TO DL-STR-NBR-OLD(PV-SUB)       28490000
268500                MOVE PV-SAVE-STR-NAME(PV-STR-IDX)                 28500000
268600                                  TO DL-STR-NAME-OLD(PV-SUB)      28510000
268700                MOVE PV-SAVE-STR-QTY(PV-STR-IDX)                  28520000
268800                                  TO DL-QTY-OLD(PV-SUB)           28530000
268900                PERFORM 2375-DISPLAY-NON-POUPC-LINES              28540000
269000             ELSE                                                 28550000
269100                MOVE PV-SAVE-STR-NBR(PV-STR-IDX)                  28560000
269200                                  TO DL-STR-NBR(PV-SUB)           28570000
269300                MOVE PV-SAVE-STR-NAME(PV-STR-IDX)                 28580000
269400                                  TO DL-STR-NAME(PV-SUB)          28590000
269500                MOVE PV-SAVE-STR-QTY(PV-STR-IDX)                  28600000
269600                                  TO DL-QTY(PV-SUB)               28610000
269700                MOVE 'TOTAL' TO DL-TOTAL-HDR(PV-SUB)              28620000
269800                PERFORM 2375-DISPLAY-POUPC-LINES                  28630000
269900             END-IF                                               28640000
270000        END-PERFORM.                                              28650000
270100 EJECT                                                            28660000
270200                                                                  28670000
270300 F175-DISPLAY-UPC-QUANTITIES.                                     28680000
270400*     DISPLAY 'CALCULATED QUANTITIES FOLLOW'.                     28690000
270500*     PERFORM                                                     28700000
270600*       VARYING PV-STR-IDX                                        28710000
270700*       FROM +1 BY +1                                             28720000
270800*       UNTIL PV-STR-IDX > PV-NBR-STORES                          28730000
270900*          OR PV-STR-IDX > 999                                    28740000
271000*               DISPLAY 'STR' PV-SAVE-STR-NBR(PV-STR-IDX) ' QTY ' 28750000
271100*                       PV-SAVE-STR-QTY(PV-STR-IDX)               28760000
271200*            PERFORM                                              28770000
271300*              VARYING PV-UPC-IDX                                 28780000
271400*              FROM +1 BY +1                                      28790000
271500*              UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) =    28800000
271600*                       SPACES                                    28810000
271700*                 OR PV-UPC-IDX > 50                              28820000
271800*                     DISPLAY 'UPC ' PV-SAVE-UPC-DESC(PV-STR-IDX  28830000
271900*                     PV-UPC-IDX) ' ' PV-SAVE-POUPC-QTY(PV-STR-IDX28840000
272000*                     PV-UPC-IDX) ' ' PV-SAVE-UPC-QTY-STR         28850000
272100*                     (PV-STR-IDX PV-UPC-IDX)                     28860000
272200*            END-PERFORM                                          28870000
272300*       END-PERFORM.                                              28880000
272400        INITIALIZE DISTR-LINE.                                    28890000
272500        INITIALIZE DISTR-LINE-OLD.                                28900000
272600        MOVE +0           TO PV-SUB                               28910000
272700                             PV-TIMES2.                           28920000
272800        IF PV-UPC-DTL-CNT = 0                                     28930000
272900           INITIALIZE DISTR-HEADER-3                              28940000
273000           IF PV-NBR-STORES > 7                                   28950000
273100              MOVE PV-ALLOC-CNT TO PV-NBR-TIMES                   28960000
273200           ELSE                                                   28970000
273300              MOVE PV-NBR-STORES TO PV-NBR-TIMES                  28980000
273400           END-IF                                                 28990000
273500           PERFORM 2370-ADVANCE-TO-NEWPAGE                        29000000
273600           PERFORM 2322-FILL-DIST-HEAD2-OLD                       29010028
273700               VARYING PV-SUB1 FROM +1 BY +1                      29020028
273800               UNTIL PV-SUB1 > PV-NBR-TIMES                       29030028
273900*    PRINT ' --STORE--  QUANTITY   '.                             29040000
274000           WRITE PORPT-RECORD FROM DISTR-HEADER-3                 29050000
274100               AFTER 1 LINES                                      29060000
274200           ADD +1              TO PV-LINE-CNT                     29070000
274300        ELSE                                                      29080000
274400            INITIALIZE DISTR-HEADER-2                             29090000
274500            IF PV-NBR-STORES > 4                                  29100000
274600               MOVE PV-ALLOC-CNT TO PV-NBR-TIMES                  29110000
274700            ELSE                                                  29120000
274800               MOVE PV-NBR-STORES TO PV-NBR-TIMES                 29130000
274900            END-IF                                                29140000
275000            PERFORM 2370-ADVANCE-TO-NEWPAGE                       29150000
275100            PERFORM 2322-FILL-DIST-HEAD2                          29160028
275200                VARYING PV-SUB1 FROM +1 BY +1                     29170028
275300                UNTIL PV-SUB1 > PV-NBR-TIMES                      29180028
275400* PRINT  ' --STORE--  ---SIZE---  QUANTITY   '.                   29190000
275500            WRITE PORPT-RECORD FROM DISTR-HEADER-2                29200000
275600                AFTER 1 LINES                                     29210000
275700            ADD +1             TO PV-LINE-CNT                     29220000
275800        END-IF.                                                   29230000
275900                                                                  29240000
276000        PERFORM                                                   29250000
276100          VARYING PV-STR-IDX                                      29260000
276200          FROM +1 BY +1                                           29270000
276300          UNTIL PV-STR-IDX > PV-NBR-STORES                        29280000
276400          OR PV-STR-IDX > 999                                     29290000
276500             ADD +1            TO PV-SUB                          29300000
276600             IF PV-UPC-DTL-CNT = 0                                29310000
276700                MOVE PV-SAVE-STR-NBR(PV-STR-IDX)                  29320000
276800                                  TO DL-STR-NBR-OLD(PV-SUB)       29330000
276900                MOVE PV-SAVE-STR-NAME(PV-STR-IDX)                 29340000
277000                                  TO DL-STR-NAME-OLD(PV-SUB)      29350000
277100                MOVE PV-SAVE-STR-QTY(PV-STR-IDX)                  29360000
277200                                  TO DL-QTY-OLD(PV-SUB)           29370000
277300                PERFORM 2375-DISPLAY-NON-POUPC-LINES              29380000
277400             ELSE                                                 29390000
277500                MOVE PV-SAVE-STR-NBR(PV-STR-IDX)                  29400000
277600                                  TO DL-STR-NBR(PV-SUB)           29410000
277700                MOVE PV-SAVE-STR-NAME(PV-STR-IDX)                 29420000
277800                                  TO DL-STR-NAME(PV-SUB)          29430000
277900                MOVE PV-SAVE-STR-QTY(PV-STR-IDX)                  29440000
278000                                  TO DL-QTY(PV-SUB)               29450000
278100                MOVE 'TOTAL' TO DL-TOTAL-HDR(PV-SUB)              29460000
278200                PERFORM 2375-DISPLAY-POUPC-LINES                  29470000
278300             END-IF                                               29480000
278400        END-PERFORM.                                              29490000
278500 EJECT                                                            29500000
278600 F175-DISPLAY-UPC2-QUANTITIES.                                    29510000
278700        PERFORM                                                   29520000
278800          VARYING PV-UPC-IDX                                      29530000
278900          FROM 1 BY +1                                            29540000
279000          UNTIL PV-UPC-IDX > 50 OR PV-SAVE-UPC-DESC(1 PV-UPC-IDX) 29550000
279100                                                         = SPACES 29560000
279200            INITIALIZE UPC-LINE                                   29570000
279300            MOVE PV-SAVE-UPC-DESC(1 PV-UPC-IDX)                   29580000
279400                                         TO DL-UPC-DESC(1)        29590000
279500            MOVE PV-SAVE-POUPC-QTY(1 PV-UPC-IDX)                  29600000
279600                                         TO DL-UPC-QTY(1)         29610000
279700            PERFORM 2370-ADVANCE-TO-NEWPAGE                       29620000
279800            WRITE PORPT-RECORD FROM UPC-LINE                      29630000
279900                               AFTER 1 LINES                      29640000
280000            ADD +1                       TO PV-LINE-CNT           29650000
280100        END-PERFORM.                                              29660000
280200                                                                  29670000
280300 EJECT                                                            29680000
280400                                                                  29690000
280500 2375-DISPLAY-POUPC-LINES.                                        29700000
280600             IF PV-SUB = +4                                       29710000
280700                ADD +1 TO PV-TIMES2                               29720000
280800                IF PV-LINE-CNT >= 58                              29730000
280900                   PERFORM 2370-ADVANCE-TO-NEWPAGE                29740000
281000* PRINT "STORE DISTRIBUTION:"                                     29750000
281100                   WRITE PORPT-RECORD FROM DISTR-HEADER-1         29760000
281200                       AFTER 1 LINES                              29770000
281300                   ADD +1 TO PV-LINE-CNT                          29780000
281400                   PERFORM 2322-FILL-DIST-HEAD2                   29790028
281500                       VARYING PV-SUB1 FROM +1 BY +1              29800028
281600                       UNTIL PV-SUB1 > PV-NBR-TIMES               29810028
281700* PRINT '--STORE-- ---SIZE---  QUANTITY   '.                      29820000
281800                   WRITE PORPT-RECORD FROM DISTR-HEADER-2         29830000
281900                       AFTER 1 LINES                              29840000
282000                   ADD +1      TO PV-LINE-CNT                     29850000
282100                END-IF                                            29860000
282200* NOW WRITE THE STORES                                            29870000
282300                WRITE PORPT-RECORD FROM DISTR-LINE                29880000
282400                                     AFTER 1 LINES                29890000
282500                ADD +1      TO PV-LINE-CNT                        29900000
282600                INITIALIZE DISTR-LINE                             29910000
282700                INITIALIZE UPC-LINE                               29920000
282800* WRITE ALL THE UPCS FOR THIS SKU (4 STORES WORTH)                29930000
282900                PERFORM                                           29940000
283000                  VARYING PV-UPC-IDX                              29950000
283100                  FROM +1 BY +1                                   29960000
283200                  UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) = 29970000
283300                        SPACES OR PV-UPC-IDX > 50                 29980000
283400                     COMPUTE PV-START = PV-TIMES2 * 4             29990000
283500                     COMPUTE PV-START = PV-START - 3              30000000
283600                     COMPUTE PV-END = PV-START + 3                30010000
283700                     MOVE 0 TO PV-TIMES                           30020000
283800                     PERFORM                                      30030000
283900                       VARYING PV-START                           30040000
284000                       FROM PV-START BY +1                        30050000
284100                       UNTIL PV-START > PV-END                    30060000
284200                         ADD +1 TO PV-TIMES                       30070000
284300                         MOVE PV-SAVE-UPC-DESC(PV-START           30080000
284400                          PV-UPC-IDX)    TO DL-UPC-DESC(PV-TIMES) 30090000
284500                         MOVE PV-SAVE-UPC-QTY-STR(PV-START        30100000
284600                           PV-UPC-IDX)    TO DL-UPC-QTY(PV-TIMES) 30110000
284700                     END-PERFORM                                  30120000
284800                     IF PV-LINE-CNT >= 58                         30130000
284900                       PERFORM 2370-ADVANCE-TO-NEWPAGE            30140000
285000* PRINT "STORE DISTRIBUTION:"                                     30150000
285100                       WRITE PORPT-RECORD FROM DISTR-HEADER-1     30160000
285200                          AFTER 1 LINES                           30170000
285300                       ADD +1 TO PV-LINE-CNT                      30180000
285400                       PERFORM 2322-FILL-DIST-HEAD2               30190000
285500                          VARYING PV-SUB1 FROM +1 BY +1           30200000
285600                          UNTIL PV-SUB1 > PV-NBR-TIMES            30210000
285700* PRINT '--STORE-- ---SIZE---  QUANTITY   '.                      30220000
285800                       WRITE PORPT-RECORD FROM DISTR-HEADER-2     30230000
285900                         AFTER 1 LINES                            30240000
286000                       ADD +1      TO PV-LINE-CNT                 30250000
286100                     END-IF                                       30260000
286200                     WRITE PORPT-RECORD FROM UPC-LINE             30270000
286300                                       AFTER 1 LINES              30280000
286400                     ADD +1                   TO PV-LINE-CNT      30290000
286500                END-PERFORM                                       30300000
286600                MOVE +0           TO PV-SUB                       30310000
286700                INITIALIZE DISTR-LINE                             30320000
286800             ELSE                                                 30330000
286900               IF PV-SUB < 4 AND PV-STR-IDX = PV-NBR-STORES       30340000
287000                ADD +1 TO PV-TIMES2                               30350000
287100* NOW WRITE THE STORES                                            30360000
287200                IF PV-LINE-CNT >= 58                              30370000
287300                   PERFORM 2370-ADVANCE-TO-NEWPAGE                30380000
287400* PRINT "STORE DISTRIBUTION:"                                     30390000
287500                   WRITE PORPT-RECORD FROM DISTR-HEADER-1         30400000
287600                       AFTER 1 LINES                              30410000
287700                   ADD +1 TO PV-LINE-CNT                          30420000
287800                   PERFORM 2322-FILL-DIST-HEAD2                   30430000
287900                       VARYING PV-SUB1 FROM +1 BY +1              30440000
288000                       UNTIL PV-SUB1 > PV-NBR-TIMES               30450000
288100* PRINT '--STORE-- ---SIZE---  QUANTITY   '.                      30460000
288200                   WRITE PORPT-RECORD FROM DISTR-HEADER-2         30470000
288300                       AFTER 1 LINES                              30480000
288400                   ADD +1      TO PV-LINE-CNT                     30490000
288500                END-IF                                            30500000
288600                WRITE PORPT-RECORD FROM DISTR-LINE                30510000
288700                                     AFTER 1 LINES                30520000
288800                ADD +1         TO PV-LINE-CNT                     30530000
288900                INITIALIZE DISTR-LINE                             30540000
289000                IF PV-LINE-CNT >= 58                              30550000
289100                   PERFORM 2370-ADVANCE-TO-NEWPAGE                30560000
289200* PRINT "STORE DISTRIBUTION:"                                     30570000
289300                   WRITE PORPT-RECORD FROM DISTR-HEADER-1         30580000
289400                       AFTER 1 LINES                              30590000
289500                   ADD +1 TO PV-LINE-CNT                          30600000
289600                   PERFORM 2322-FILL-DIST-HEAD2                   30610000
289700                       VARYING PV-SUB1 FROM +1 BY +1              30620000
289800                       UNTIL PV-SUB1 > PV-NBR-TIMES               30630000
289900* PRINT '--STORE-- ---SIZE---  QUANTITY   '.                      30640000
290000                   WRITE PORPT-RECORD FROM DISTR-HEADER-2         30650000
290100                       AFTER 1 LINES                              30660000
290200                   ADD +1      TO PV-LINE-CNT                     30670000
290300                END-IF                                            30680000
290400                INITIALIZE UPC-LINE                               30690000
290500* WRITE ALL THE UPCS FOR THIS SKU (4 STORES WORTH)                30700000
290600                PERFORM                                           30710000
290700                  VARYING PV-UPC-IDX                              30720000
290800                  FROM +1 BY +1                                   30730000
290900                  UNTIL PV-SAVE-UPC-DESC(PV-STR-IDX PV-UPC-IDX) = 30740000
291000                        SPACES OR PV-UPC-IDX > 50                 30750000
291100                     COMPUTE PV-START = PV-TIMES2 * 4             30760000
291200                     COMPUTE PV-START = PV-START - 3              30770000
291300                     COMPUTE PV-END = PV-START + 3                30780000
291400                     MOVE 0 TO PV-TIMES                           30790000
291500                     PERFORM                                      30800000
291600                       VARYING PV-START                           30810000
291700                       FROM PV-START BY +1                        30820000
291800                       UNTIL PV-START > PV-END                    30830000
291900                         ADD +1 TO PV-TIMES                       30840000
292000                         MOVE PV-SAVE-UPC-DESC(PV-START           30850000
292100                          PV-UPC-IDX)    TO DL-UPC-DESC(PV-TIMES) 30860000
292200                         MOVE PV-SAVE-UPC-QTY-STR(PV-START        30870000
292300                           PV-UPC-IDX)    TO DL-UPC-QTY(PV-TIMES) 30880000
292400                     END-PERFORM                                  30890000
292500                     IF PV-LINE-CNT >= 58                         30900000
292600                       PERFORM 2370-ADVANCE-TO-NEWPAGE            30910000
292700* PRINT "STORE DISTRIBUTION:"                                     30920000
292800                       WRITE PORPT-RECORD FROM DISTR-HEADER-1     30930000
292900                          AFTER 1 LINES                           30940000
293000                       ADD +1 TO PV-LINE-CNT                      30950000
293100                       PERFORM 2322-FILL-DIST-HEAD2               30960000
293200                          VARYING PV-SUB1 FROM +1 BY +1           30970000
293300                          UNTIL PV-SUB1 > PV-NBR-TIMES            30980000
293400* PRINT '--STORE-- ---SIZE---  QUANTITY   '.                      30990000
293500                       WRITE PORPT-RECORD FROM DISTR-HEADER-2     31000000
293600                         AFTER 1 LINES                            31010000
293700                       ADD +1      TO PV-LINE-CNT                 31020000
293800                     END-IF                                       31030000
293900                     WRITE PORPT-RECORD FROM UPC-LINE             31040000
294000                                       AFTER 1 LINES              31050000
294100                     ADD +1                   TO PV-LINE-CNT      31060000
294200                END-PERFORM                                       31070000
294300                MOVE +0           TO PV-SUB                       31080000
294400             END-IF                                               31090000
294500             END-IF.                                              31100000
294600                                                                  31110000
294700                                                                  31120000
294800 2375-DISPLAY-NON-POUPC-LINES.                                    31130000
294900         IF PV-SUB = +7                                           31140000
295000            PERFORM 2370-ADVANCE-TO-NEWPAGE                       31150000
295100* NOW WRITE THE STORES                                            31160000
295200            WRITE PORPT-RECORD FROM DISTR-LINE-OLD                31170000
295300                                 AFTER 1 LINES                    31180000
295400            ADD +1             TO PV-LINE-CNT                     31190000
295500            MOVE +0               TO PV-SUB                       31200000
295600            INITIALIZE DISTR-LINE-OLD                             31210000
295700            IF PV-LINE-CNT >= 58                                  31220000
295800                PERFORM 2370-ADVANCE-TO-NEWPAGE                   31230000
295900* PRINT "STORE DISTRIBUTION:"                                     31240000
296000                WRITE PORPT-RECORD FROM DISTR-HEADER-1            31250000
296100                    AFTER 1 LINES                                 31260000
296200                ADD +1 TO PV-LINE-CNT                             31270000
296300                PERFORM 2322-FILL-DIST-HEAD2-OLD                  31280000
296400                    VARYING PV-SUB1 FROM +1 BY +1                 31290000
296500                    UNTIL PV-SUB1 > PV-NBR-TIMES                  31300000
296600* PRINT ' STORE-- QUANTITY   '.                                   31310000
296700                WRITE PORPT-RECORD FROM DISTR-HEADER-3            31320000
296800                    AFTER 1 LINES                                 31330000
296900                ADD +1      TO PV-LINE-CNT                        31340000
297000            END-IF                                                31350000
297100         ELSE                                                     31360000
297200           IF PV-SUB < 7 AND PV-STR-IDX = PV-NBR-STORES           31370000
297300* NOW WRITE THE STORES                                            31380000
297400            PERFORM 2370-ADVANCE-TO-NEWPAGE                       31390000
297500            WRITE PORPT-RECORD FROM DISTR-LINE-OLD                31400000
297600                                 AFTER 1 LINES                    31410000
297700            INITIALIZE DISTR-LINE-OLD                             31420000
297800            ADD +1             TO PV-LINE-CNT                     31430000
297900            IF PV-LINE-CNT >= 58                                  31440000
298000                PERFORM 2370-ADVANCE-TO-NEWPAGE                   31450000
298100* PRINT "STORE DISTRIBUTION:"                                     31460000
298200                WRITE PORPT-RECORD FROM DISTR-HEADER-1            31470000
298300                    AFTER 1 LINES                                 31480000
298400                ADD +1 TO PV-LINE-CNT                             31490000
298500                PERFORM 2322-FILL-DIST-HEAD2-OLD                  31500000
298600                    VARYING PV-SUB1 FROM +1 BY +1                 31510000
298700                    UNTIL PV-SUB1 > PV-NBR-TIMES                  31520000
298800* PRINT ' STORE-- QUANTITY   '.                                   31530000
298900                WRITE PORPT-RECORD FROM DISTR-HEADER-3            31540000
299000                    AFTER 1 LINES                                 31550000
299100                ADD +1      TO PV-LINE-CNT                        31560000
299200            END-IF                                                31570000
299300            MOVE +0               TO PV-SUB                       31580000
299400         END-IF                                                   31590000
299500         END-IF.                                                  31600000
299600                                                                  31610000
299700                                                                  31620000
299800 F200-ADJUST-SPLIT-QUANTITIES.                                    31630000
299900* SORT THE TABLE BY QUANTITY (DESCENDING ORDER)                   31640000
300000*     PERFORM F300-SORT-QUANTITIES-DESC.                          31650000
300100      COMPUTE PV-DIFF =                                           31660000
300200               PV-SAVE-STR-QTY(PV-STR-ADJ) - PV-UPC-TOTAL-QTY     31670000
300300      IF PV-DIFF > 0                                              31680000
300400         SET PS-ADD     TO TRUE                                   31690000
300500      ELSE                                                        31700000
300600         SET PS-SUBTR   TO TRUE                                   31710000
300700      END-IF.                                                     31720000
300800                                                                  31730000
300900      MOVE PV-DIFF TO PV-ABS-DIFF.                                31740000
301000      MOVE +0 TO PV-TIMES-THROUGH.                                31750000
301100                                                                  31760000
301200         PERFORM                                                  31770000
301300            VARYING PV-UPC-IDX                                    31780000
301400            FROM +1 BY +1                                         31790000
301500            UNTIL PV-UPC-IDX > 50                                 31800000
301600              OR PV-SAVE-UPC-DESC(PV-STR-ADJ PV-UPC-IDX) = SPACES 31810000
301700              OR PV-TIMES-THROUGH = PV-ABS-DIFF                   31820000
301800               ADD +1 TO PV-TIMES-THROUGH                         31830000
301900            IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 0 OR  31840000
302000               PV-SAVE-STR-QTY(PV-STR-ADJ) > 0                    31850000
302100               IF PS-ADD                                          31860000
302200                 COMPUTE PV-UPC-QTY-TEMP = 1 +                    31870000
302300                 PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ PV-UPC-IDX)      31880000
302400                 IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX)31890000
302500                      >= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 31900000
302600                     SUBTRACT +1 FROM PV-TIMES-THROUGH            31910000
302700                  ELSE                                            31920000
302800                     ADD +1 TO PV-SAVE-UPC-QTY-STR(PV-STR-ADJ     31930000
302900                                                      PV-UPC-IDX) 31940000
303000                               PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES 31950000
303100                                                      PV-UPC-IDX) 31960000
303200                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   31970000
303300                            1 + PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)  31980000
303400                  END-IF                                          31990000
303500               ELSE                                               32000000
303600                 IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 032010000
303700                   COMPUTE PV-UPC-QTY-TEMP =                      32020000
303800                   PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ PV-UPC-IDX) - 132030000
303900                IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX) 32040000
304000                      <= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 32050000
304100                     SUBTRACT +1 FROM PV-TIMES-THROUGH            32060000
304200                 ELSE                                             32070000
304300                     SUBTRACT +1 FROM                             32080000
304400                        PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX)32090000
304500                       PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES         32100000
304600                                            PV-UPC-IDX)           32110000
304700                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   32120000
304800                             PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) - 1 32130000
304900                 END-IF                                           32140000
305000                END-IF                                            32150000
305100               END-IF                                             32160000
305200            END-IF                                                32170000
305300         END-PERFORM.                                             32180000
305400                                                                  32190000
305500         IF PV-SAVE-UPC-DESC(PV-STR-ADJ PV-UPC-IDX) = SPACES      32200000
305600            AND NOT PV-TIMES-THROUGH = PV-ABS-DIFF                32210000
305700         PERFORM                                                  32220000
305800            VARYING PV-UPC-IDX                                    32230000
305900            FROM +1 BY +1                                         32240000
306000            UNTIL PV-UPC-IDX > 50                                 32250000
306100              OR PV-SAVE-UPC-DESC(PV-STR-ADJ PV-UPC-IDX) = SPACES 32260000
306200              OR PV-TIMES-THROUGH = PV-ABS-DIFF                   32270000
306300               ADD +1 TO PV-TIMES-THROUGH                         32280000
306400            IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 0 OR  32290000
306500               PV-SAVE-STR-QTY(PV-STR-ADJ) > 0                    32300000
306600               IF PS-ADD                                          32310000
306700                 COMPUTE PV-UPC-QTY-TEMP = 1 +                    32320000
306800                 PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ PV-UPC-IDX)      32330000
306900                  IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES           32340000
307000                        PV-UPC-IDX) = PV-SAVE-POUPC-QTY(PV-STR-ADJ32350000
307100                             PV-UPC-IDX)                          32360000
307200                     SUBTRACT +1 FROM PV-TIMES-THROUGH            32370000
307300                  ELSE                                            32380000
307400                     ADD +1 TO PV-SAVE-UPC-QTY-STR(PV-STR-ADJ     32390000
307500                                                      PV-UPC-IDX) 32400000
307600                               PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES 32410000
307700                                                      PV-UPC-IDX) 32420000
307800                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   32430000
307900                            1 + PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)  32440000
308000                  END-IF                                          32450000
308100               ELSE                                               32460000
308200                 IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 032470000
308300                   COMPUTE PV-UPC-QTY-TEMP =                      32480000
308400                   PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ PV-UPC-IDX) - 132490000
308500                IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX) 32500000
308600                      = PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX)  32510000
308700                     SUBTRACT +1 FROM PV-TIMES-THROUGH            32520000
308800                 ELSE                                             32530000
308900                     SUBTRACT +1 FROM                             32540000
309000                        PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX)32550000
309100                       PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES         32560000
309200                                            PV-UPC-IDX)           32570000
309300                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   32580000
309400                             PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) - 1 32590000
309500                 END-IF                                           32600000
309600                END-IF                                            32610000
309700               END-IF                                             32620000
309800            END-IF                                                32630000
309900         END-PERFORM                                              32640000
310000        END-IF.                                                   32650000
310100                                                                  32660000
310200 F200-ADJUST-SPLIT-QTY-STR.                                       32670000
310300      COMPUTE PV-DIFF =                                           32680000
310400               PV-SAVE-POUPC-QTY(1 PV-UPC-IDX) -                  32690000
310500                   PV-SAVE-UPC-SUBTOTAL(PV-STR-IDX PV-UPC-IDX)    32700000
310600                                                                  32710000
310700      IF PV-DIFF > 0                                              32720000
310800         SET PS-ADD     TO TRUE                                   32730000
310900      ELSE                                                        32740000
311000         SET PS-SUBTR   TO TRUE                                   32750000
311100      END-IF.                                                     32760000
311200                                                                  32770000
311300      MOVE PV-DIFF TO PV-ABS-DIFF.                                32780000
311400      MOVE +0 TO PV-TIMES-THROUGH.                                32790000
311500         PERFORM                                                  32800000
311600            VARYING PV-STR-ADJ                                    32810000
311700            FROM +1 BY +1                                         32820000
311800            UNTIL PV-STR-ADJ > 999                                32830000
311900              OR PV-SAVE-STR-NBR(PV-STR-ADJ) = 0                  32840000
312000              OR PV-TIMES-THROUGH = PV-ABS-DIFF                   32850000
312100               ADD +1 TO PV-TIMES-THROUGH                         32860000
312200            IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 0 OR  32870000
312300               PV-SAVE-STR-QTY(PV-STR-ADJ) > 0                    32880000
312400               IF PS-ADD                                          32890000
312500                  COMPUTE PV-UPC-QTY-TEMP = 1 +                   32900000
312600                  PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)                32910000
312700                 IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX)32920000
312800                      >= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 32930000
312900                     SUBTRACT +1 FROM PV-TIMES-THROUGH            32940000
313000                 ELSE                                             32950000
313100                   IF (PV-UPC-QTY-TEMP <= PV-SAVE-STR-QTY(        32960000
313200                      PV-STR-ADJ) AND PV-UPC-IDX = PV-UPC-DTL-CNT)32970000
313300                      OR (NOT PV-UPC-IDX = PV-UPC-DTL-CNT)        32980000
313400                     ADD +1 TO PV-SAVE-UPC-QTY-STR(PV-STR-ADJ     32990000
313500                                                      PV-UPC-IDX) 33000000
313600                               PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES 33010000
313700                                                      PV-UPC-IDX) 33020000
313800                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   33030000
313900                            1 + PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)  33040000
314000                   ELSE                                           33050000
314100                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33060000
314200                   END-IF                                         33070000
314300                  END-IF                                          33080000
314400               ELSE                                               33090000
314500                 IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 033100000
314600                  COMPUTE PV-UPC-QTY-TEMP =                       33110000
314700                  PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) - 1            33120000
314800                IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX) 33130000
314900                      <= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 33140000
315000                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33150000
315100                 ELSE                                             33160000
315200                   IF (PV-UPC-QTY-TEMP >= PV-SAVE-STR-QTY(        33170000
315300                      PV-STR-ADJ) AND PV-UPC-IDX = PV-UPC-DTL-CNT)33180000
315400                      OR (NOT PV-UPC-IDX = PV-UPC-DTL-CNT)        33190000
315500                     SUBTRACT +1 FROM                             33200000
315600                        PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX)33210000
315700                       PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES         33220000
315800                                            PV-UPC-IDX)           33230000
315900                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   33240000
316000                             PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) - 1 33250000
316100                   ELSE                                           33260000
316200                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33270000
316300                   END-IF                                         33280000
316400                 END-IF                                           33290000
316500                END-IF                                            33300000
316600               END-IF                                             33310000
316700            END-IF                                                33320000
316800         END-PERFORM.                                             33330000
316900                                                                  33340000
317000         IF NOT PV-TIMES-THROUGH = PV-ABS-DIFF                    33350000
317100           PERFORM F250-ADJUST-SPLIT-QTY-STR                      33360000
317200             UNTIL PV-TIMES-THROUGH = PV-ABS-DIFF                 33370000
317300         END-IF.                                                  33380000
317400 EJECT                                                            33390000
317500                                                                  33400000
317600 F250-ADJUST-SPLIT-QTY-STR.                                       33410000
317700                                                                  33420000
317800         PERFORM                                                  33430000
317900            VARYING PV-STR-ADJ                                    33440000
318000            FROM +1 BY +1                                         33450000
318100            UNTIL PV-STR-ADJ > 999                                33460000
318200              OR PV-SAVE-STR-NBR(PV-STR-ADJ) = 0                  33470000
318300              OR PV-TIMES-THROUGH = PV-ABS-DIFF                   33480000
318400               ADD +1 TO PV-TIMES-THROUGH                         33490000
318500            IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 0 OR  33500000
318600               PV-SAVE-STR-QTY(PV-STR-ADJ) > 0                    33510000
318700               IF PS-ADD                                          33520000
318800                  COMPUTE PV-UPC-QTY-TEMP = 1 +                   33530000
318900                  PV-SAVE-UPC-SUBTOTAL(PV-STR-ADJ PV-UPC-IDX)     33540000
319000                  COMPUTE PV-UPC-QTY-TEMP = 1 +                   33550000
319100                  PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)                33560000
319200                 IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX)33570000
319300                      >= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 33580000
319400                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33590000
319500                 ELSE                                             33600000
319600                   IF (PV-UPC-QTY-TEMP <= PV-SAVE-STR-QTY(        33610000
319700                      PV-STR-ADJ) AND PV-UPC-IDX = PV-UPC-DTL-CNT)33620000
319800                      OR (NOT PV-UPC-IDX = PV-UPC-DTL-CNT)        33630000
319900                     ADD +1 TO PV-SAVE-UPC-QTY-STR(PV-STR-ADJ     33640000
320000                                                      PV-UPC-IDX) 33650000
320100                               PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES 33660000
320200                                                      PV-UPC-IDX) 33670000
320300                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   33680000
320400                            1 + PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)  33690000
320500                   ELSE                                           33700000
320600                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33710000
320700                   END-IF                                         33720000
320800                  END-IF                                          33730000
320900               ELSE                                               33740000
321000                 IF PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX) > 033750000
321100                  COMPUTE PV-UPC-QTY-TEMP =                       33760000
321200                  PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ)- 1             33770000
321300                IF PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES PV-UPC-IDX) 33780000
321400                      <= PV-SAVE-POUPC-QTY(PV-STR-ADJ PV-UPC-IDX) 33790000
321500                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33800000
321600                 ELSE                                             33810000
321700                   IF (PV-UPC-QTY-TEMP >= PV-SAVE-STR-QTY(        33820000
321800                      PV-STR-ADJ) AND PV-UPC-IDX = PV-UPC-DTL-CNT)33830000
321900                      OR (NOT PV-UPC-IDX = PV-UPC-DTL-CNT)        33840000
322000                     SUBTRACT +1 FROM                             33850000
322100                        PV-SAVE-UPC-QTY-STR(PV-STR-ADJ PV-UPC-IDX)33860000
322200                       PV-SAVE-UPC-SUBTOTAL(PV-NBR-STORES         33870000
322300                                            PV-UPC-IDX)           33880000
322400                     COMPUTE PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) =   33890000
322500                             PV-SAVE-STR-SUBTOTAL(PV-STR-ADJ) - 1 33900000
322600                   ELSE                                           33910000
322700                     SUBTRACT +1 FROM PV-TIMES-THROUGH            33920000
322800                   END-IF                                         33930000
322900                 END-IF                                           33940000
323000                END-IF                                            33950000
323100               END-IF                                             33960000
323200            END-IF                                                33970000
323300         END-PERFORM.                                             33980000
323400                                                                  33990000
323500                                                                  34000000
323600*F300-SORT-QUANTITIES-DESC.                                       34010000
323700*      SET PS-SORT-NOT-DONE TO TRUE.                              34020000
323800*      SET PV-STR-IDX TO 1.                                       34030000
323900*      PERFORM                                                    34040000
324000*        VARYING PV-HOLD-IDX                                      34050000
324100*        FROM +1 BY +1                                            34060000
324200*        UNTIL PS-SORT-DONE                                       34070000
324300*            MOVE PV-SAVE-STR-NBR (PV-STR-IDX) TO PV-HOLD-STR-NBR 34080000
324400*            MOVE PV-SAVE-STR-NAME (PV-STR-IDX)                   34090000
324500*                                             TO PV-HOLD-STR-NAME 34100000
324600*            MOVE PV-SAVE-STR-QTY (PV-STR-IDX) TO PV-HOLD-STR-QTY 34110000
324700*            MOVE PV-SAVE-STR-QTY-UPC (PV-STR-IDX) TO             34120000
324800*                                              PV-HOLD-STR-QTY-UPC34130000
324900*            MOVE PV-SAVE-STR-SUBTOTAL(PV-STR-IDX) TO             34140000
325000*                                             PV-HOLD-STR-SUBTOTAL34150000
325100*            SET PV-STR-IDX UP BY +1                              34160000
325200*            IF PS-SORT-NOT-DONE                                  34170000
325300*               IF (PV-HOLD-STR-QTY-UPC < PV-SAVE-STR-QTY-UPC     34180000
325400*                                         (PV-STR-IDX))           34190000
325500*                  MOVE PV-SAVE-STR-NBR (PV-STR-IDX) TO           34200000
325600*                                                  PV-TEMP-STR-NBR34210000
325700*                  MOVE PV-SAVE-STR-QTY (PV-STR-IDX) TO           34220000
325800*                                                  PV-TEMP-STR-QTY34230000
325900*                  MOVE PV-SAVE-STR-QTY-UPC (PV-STR-IDX) TO       34240000
326000*                                              PV-TEMP-STR-QTY-UPC34250000
326100*                  MOVE PV-SAVE-STR-SUBTOTAL (PV-STR-IDX) TO      34260000
326200*                                             PV-TEMP-STR-SUBTOTAL34270000
326300*                  MOVE PV-HOLD-STR-NBR TO PV-SAVE-STR-NBR        34280000
326400*                                                     (PV-STR-IDX)34290000
326500*                  MOVE PV-HOLD-STR-QTY TO PV-SAVE-STR-QTY        34300000
326600*                                                     (PV-STR-IDX)34310000
326700*                  MOVE PV-HOLD-STR-QTY-UPC TO PV-SAVE-STR-QTY-UPC34320000
326800*                                                     (PV-STR-IDX)34330000
326900*                  MOVE PV-HOLD-STR-SUBTOTAL TO                   34340000
327000*                                             PV-SAVE-STR-SUBTOTAL34350000
327100*                                                     (PV-STR-IDX)34360000
327200*                  SET PV-STR-IDX DOWN BY +1                      34370000
327300*                  SET PS-SET-IDX-DOWN TO TRUE                    34380000
327400*                  MOVE PV-TEMP-STR-NBR TO PV-SAVE-STR-NBR        34390000
327500*                                                     (PV-STR-IDX)34400000
327600*                  MOVE PV-TEMP-STR-QTY TO PV-SAVE-STR-QTY        34410000
327700*                                                     (PV-STR-IDX)34420000
327800*                  MOVE PV-TEMP-STR-QTY-UPC TO PV-SAVE-STR-QTY-UPC34430000
327900*                                                     (PV-STR-IDX)34440000
328000*               END-IF                                            34450000
328100*             ELSE                                                34460000
328200*               SET PS-SORT-DONE TO TRUE                          34470000
328300*             END-IF                                              34480000
328400*             IF PS-SET-IDX-DOWN                                  34490000
328500*                CONTINUE                                         34500000
328600*             ELSE                                                34510000
328700*                SET PV-STR-IDX DOWN BY +1                        34520000
328800*             END-IF                                              34530000
328900*    NOW LOOP THRU THE SAVE TABLE TO SEE IF ORDER IS CORRECT      34540000
329000*             SET PS-SORT-DONE TO TRUE                            34550000
329100*             PERFORM                                             34560000
329200*                VARYING PV-STR-IDX                               34570000
329300*                FROM +1 BY +1                                    34580000
329400*                UNTIL ((PV-STR-IDX > PV-NBR-STORES) OR           34590000
329500*                        PS-SORT-NOT-DONE)                        34600000
329600*                MOVE PV-SAVE-STR-NBR (PV-STR-IDX) TO             34610000
329700*                                                  PV-HOLD-STR-NBR34620000
329800*                MOVE PV-SAVE-STR-QTY (PV-STR-IDX) TO             34630000
329900*                                                  PV-HOLD-STR-QTY34640000
330000*                MOVE PV-SAVE-STR-QTY-UPC (PV-STR-IDX) TO         34650000
330100*                                              PV-HOLD-STR-QTY-UPC34660000
330200*                MOVE PV-SAVE-STR-SUBTOTAL(PV-STR-IDX) TO         34670000
330300*                                             PV-HOLD-STR-SUBTOTAL34680000
330400*                SET PV-STR-IDX UP BY +1                          34690000
330500*                IF PV-HOLD-STR-QTY-UPC < PV-SAVE-STR-QTY-UPC     34700000
330600*                                                   (PV-STR-IDX)  34710000
330700*                    SET PS-SORT-NOT-DONE TO TRUE                 34720000
330800*                END-IF                                           34730000
330900*                SET PV-STR-IDX DOWN BY +1                        34740000
331000*             END-PERFORM                                         34750000
331100*             IF PV-STR-IDX > PV-NBR-STORES                       34760000
331200*                SET PV-STR-IDX TO +1                             34770000
331300*                SET PS-SORT-DONE TO TRUE                         34780000
331400*             ELSE                                                34790000
331500*                SET PV-STR-IDX DOWN BY +1                        34800000
331600*             END-IF                                              34810000
331700*         END-PERFORM.                                            34820000
331800*END OF SORT                                                      34830000
331900                                                                  34840000
332000 EJECT                                                            34850000
332100******************************************************************34860000
332200*  COUNT ALLOCATIONS FOR PO                                       34870000
332300******************************************************************34880000
332400 2321-COUNT-ALLOCATIONS.                                          34890000
332500                                                                  34900000
332600     EXEC SQL                                                     34910000
332700         SELECT COUNT(*)                                          34920000
332800         INTO :PV-ALLOC-CNT                                       34930000
332900         FROM TMESTDS A,                                          34940000
333000              XMT_LOC B                                           34950000
333100         WHERE A.PO_NBR = :IR-PO-NBR2                             34960000
333200           AND A.PO_LNE_NBR = :PURITM-PO-LNE-NBR                  34970000
333300           AND B.LOC_NBR    = A.STR_NBR                           34980000
333400           AND B.LOC_TYP_CDE IN ( 'CS', 'DS', 'RV')               34990000
333500     END-EXEC.                                                    35000000
333600                                                                  35010000
333700     EVALUATE TRUE                                                35020000
333800         WHEN SQLCODE = +0                                        35030000
333900             CONTINUE                                             35040000
334000         WHEN SQLWARN NOT = SPACE                                 35050000
334100         WHEN SQLCODE NOT = +0                                    35060000
334200             MOVE '2321-COUNT-ALLOCATIONS'                        35070000
334300                                   TO PV-ABEND-PARAGRAPH          35080000
334400             PERFORM 9000-SQL-ABEND                               35090000
334500     END-EVALUATE.                                                35100000
334600                                                                  35110000
334700     IF PV-ALLOC-CNT = +0                                         35120000
334800         CONTINUE                                                 35130000
334900     ELSE                                                         35140000
335000         EXEC SQL                                                 35150000
335100             SELECT COUNT(*)                                      35160000
335200             INTO :PV-ALLOC-CNT                                   35170000
335300             FROM TMESTDS                                         35180000
335400             WHERE PO_NBR = :IR-PO-NBR2                           35190000
335500               AND PO_LNE_NBR = :PURITM-PO-LNE-NBR                35200000
                     AND STR_DISTRO_QTY > 0                             35210000
335600         END-EXEC                                                 35220000
335700                                                                  35230000
335800         EVALUATE TRUE                                            35240000
335900             WHEN SQLCODE = +0                                    35250000
336000                 CONTINUE                                         35260000
336100             WHEN SQLWARN NOT = SPACE                             35270000
336200             WHEN SQLCODE NOT = +0                                35280000
336300                 MOVE '2321-COUNT-ALLOCATIONS'                    35290000
336400                                   TO PV-ABEND-PARAGRAPH          35300000
336500                 PERFORM 9000-SQL-ABEND                           35310000
336600         END-EVALUATE                                             35320000
336700     END-IF.                                                      35330000
336800                                                                  35340000
336900******************************************************************35350000
337000*  COUNT UPC DETAIL ROWS FOR THIS LINE.                           35360000
337100******************************************************************35370000
337200*2322-COUNT-POUPC-ROWS.                                           35380028
337300*                                                                 35390028
337400*    EXEC SQL                                                     35400028
337500*        SELECT COUNT(*)                                          35410028
337600*        INTO :PV-UPC-DTL-CNT                                     35420028
337700*        FROM TPOUPC                                              35430028
337800*        WHERE PO_NBR = :IR-PO-NBR2                               35440028
337900*          AND PO_LNE_NBR = :PURITM-PO-LNE-NBR                    35450028
338000*    END-EXEC.                                                    35460028
338100*                                                                 35470028
338200*    EVALUATE TRUE                                                35480028
338300*        WHEN SQLCODE = +0                                        35490028
338400*            CONTINUE                                             35500028
338500*        WHEN SQLWARN NOT = SPACE                                 35510028
338600*        WHEN SQLCODE NOT = +0                                    35520028
338700*            MOVE '2322-COUNT-POUPC-ROWS'                         35530028
338800*                                  TO PV-ABEND-PARAGRAPH          35540028
338900*            PERFORM 9000-SQL-ABEND                               35550028
339000*    END-EVALUATE.                                                35560028
339100                                                                  35570000
339200                                                                  35580000
339300******************************************************************35590000
339400*  FILL DISTRIBUTION HEADER LINE 2 WITH HEADINGS BASED ON         35600000
339500*  NUMBER OF ALLOCATIONS PRESENT                                  35610000
339600******************************************************************35620000
339700 2322-FILL-DIST-HEAD2.                                            35630000
339800                                                                  35640000
339900     MOVE PC-STORE-QTY             TO DH2-COL-HDR (PV-SUB1).      35650000
340000                                                                  35660000
340100******************************************************************35670000
340200*  FILL DISTRIBUTION HEADER LINE 2 WITH HEADINGS BASED ON         35680000
340300*  NUMBER OF ALLOCATIONS PRESENT                                  35690000
340400******************************************************************35700000
340500 2322-FILL-DIST-HEAD2-OLD.                                        35710000
340600                                                                  35720000
340700     MOVE PC-STORE-QTY-OLD         TO DH3-COL-HDR (PV-SUB1).      35730000
340800                                                                  35740000
340900                                                                  35750000
341000******************************************************************35760000
341100*  OPENS ALLOCATION CSR                                           35770000
341200******************************************************************35780000
341300 2323-OPEN-ALLOC-CSR.                                             35790000
341400                                                                  35800000
341500     EXEC SQL                                                     35810000
341600         OPEN ALLOC-CSR                                           35820000
341700     END-EXEC.                                                    35830000
341800                                                                  35840000
341900     EVALUATE TRUE                                                35850000
342000         WHEN SQLCODE = +0                                        35860000
342100             CONTINUE                                             35870000
342200         WHEN SQLWARN NOT = SPACE                                 35880000
342300         WHEN SQLCODE NOT = +0                                    35890000
342400             MOVE '2323-OPEN-ALLOC-CSR'                           35900000
342500                                   TO PV-ABEND-PARAGRAPH          35910000
342600             PERFORM 9000-SQL-ABEND                               35920000
342700     END-EVALUATE.                                                35930000
342800                                                                  35940000
342900******************************************************************35950000
343000*  FETCHS ALLOCATION CSR AND WRITES ALLOCATION LINES              35960000
343100******************************************************************35970000
343200 2324-PROCESS-ALLOC-CSR.                                          35980000
343300                                                                  35990000
343400     EXEC SQL                                                     36000000
343500         FETCH ALLOC-CSR                                          36010000
343600         INTO  :MESTDS-STR-NBR,                                   36020000
343700               :MESTDS-STR-DISTRO-QTY,                            36030000
343800               :XMT00001-LOC-5-ABBR-NM                            36040000
343900     END-EXEC.                                                    36050000
344000                                                                  36060000
344100     EVALUATE TRUE                                                36070000
344200         WHEN SQLCODE = +0                                        36080000
344300         WHEN SQLCODE = +100                                      36090000
344400             CONTINUE                                             36100000
344500         WHEN SQLWARN NOT = SPACE                                 36110000
344600         WHEN SQLCODE NOT = +0                                    36120000
344700             MOVE '2324-PROCESS-ALLOC-CSR'                        36130000
344800                                   TO PV-ABEND-PARAGRAPH          36140000
344900             PERFORM 9000-SQL-ABEND                               36150000
345000     END-EVALUATE.                                                36160000
345100                                                                  36170000
345200     IF SQLCODE = +100                                            36180000
345300         SET PS-EOF-ALLOC-CSR      TO TRUE                        36190000
345400     ELSE                                                         36200000
345500         ADD +1 TO PV-NBR-STORES                                  36210000
345600         MOVE MESTDS-STR-NBR TO PV-SAVE-STR-NBR(PV-STR-IDX)       36220000
345700         MOVE XMT00001-LOC-5-ABBR-NM                              36230000
345800                             TO PV-SAVE-STR-NAME(PV-STR-IDX)      36240000
345900         MOVE MESTDS-STR-DISTRO-QTY                               36250000
346000                             TO PV-SAVE-STR-QTY(PV-STR-IDX)       36260000
346100         SET PV-STR-IDX UP BY +1                                  36270000
346200     END-IF.                                                      36280000
346300******************************************************************36290000
346400*  FETCHS UPC_CURSOR                                              36300000
346500******************************************************************36310000
346600*2350-FETCH-UPC-CSR.                                              36320028
346700*                                                                 36330028
346800*    EXEC SQL                                                     36340028
346900*        FETCH UPC_CURSOR                                         36350028
W24803*        INTO :XLT00003-SIZE-DESC                                 36360028
347100*             ,:POUPC-UPC-QTY                                     36370028
W24803*             ,:XLT00003-KOHLS-SIZE-CDE                           36380028
347500*    END-EXEC.                                                    36390028
347600*                                                                 36400028
347700*    EVALUATE TRUE                                                36410028
347800*        WHEN SQLCODE = +0                                        36420028
347900*        WHEN SQLCODE = +100                                      36430028
348000*            CONTINUE                                             36440028
348100*        WHEN SQLWARN NOT = SPACE                                 36450028
348200*        WHEN SQLCODE NOT = +0                                    36460028
348300*            MOVE '2350-FETCH-UPC-CSR'                            36470028
348400*                                  TO PV-ABEND-PARAGRAPH          36480028
348500*            PERFORM 9000-SQL-ABEND                               36490028
348600*    END-EVALUATE.                                                36500028
348700*                                                                 36510028
348800*    IF SQLCODE = +100                                            36520028
348900*        SET PS-EOF-UPC-CSR      TO TRUE                          36530028
349000*    ELSE                                                         36540028
349100* MOVE THE UPC'S TO THE SAVE TABLE IN EACH STORE POSITION         36550000
349200*      IF PV-ALLOC-CNT = +0 OR (PS-BUYER-RPT-TYPE AND             36560028
349300*                               PS-NOT-PACK-BY-STORE)             36570028
349400*               OR (PS-ANALYST-RPT-TYPE AND PS-NOT-PACK-BY-STORE) 36580028
W24803*          MOVE XLT00003-SIZE-DESC       TO                       36590028
349600*                  PV-SAVE-UPC-DESC (1 PV-UPC-IDX)                36600028
349700*          MOVE POUPC-UPC-QTY TO                                  36610028
349800*                  PV-SAVE-POUPC-QTY(1 PV-UPC-IDX)                36620028
349900*          SET PV-UPC-IDX UP BY +1                                36630028
350000*      ELSE                                                       36640028
350100*          PERFORM                                                36650028
350200*          VARYING PV-STR-IDX                                     36660028
350300*          FROM 1 BY 1                                            36670028
350400*          UNTIL PV-STR-IDX > PV-NBR-STORES                       36680028
350500*            OR PV-STR-IDX > 999                                  36690028
W24803*                   MOVE XLT00003-SIZE-DESC TO                    36700028
350700*                        PV-SAVE-UPC-DESC (PV-STR-IDX PV-UPC-IDX) 36710028
350800*                   MOVE POUPC-UPC-QTY TO                         36720028
350900*                        PV-SAVE-POUPC-QTY(PV-STR-IDX PV-UPC-IDX) 36730028
351000*          END-PERFORM                                            36740028
351100*          SET PV-UPC-IDX UP BY +1                                36750028
351200*      END-IF                                                     36760028
351300*    END-IF.                                                      36770028
351400                                                                  36780000
351500 2370-ADVANCE-TO-NEWPAGE.                                         36790000
351600     IF PV-LINE-CNT >= +58                                        36800000
351700         ADD +1                    TO PV-PAGE-CNT                 36810000
351800         MOVE PV-PAGE-CNT          TO HL2-PAGE                    36820000
351900         MOVE +0                   TO PV-LINE-CNT                 36830000
352000                                                                  36840000
352100         WRITE PORPT-RECORD FROM HEADER-LINE1                     36850000
352200             AFTER ADVANCING PAGE                                 36860000
352300         WRITE PORPT-RECORD FROM HEADER-LINE2                     36870000
352400             AFTER 1 LINES                                        36880000
352500         WRITE PORPT-RECORD FROM HEADER-LINE3                     36890000
352600             AFTER 1 LINES                                        36900000
352700         MOVE +3                   TO PV-LINE-CNT                 36910000
352800     END-IF.                                                      36920000
352900                                                                  36930000
353000******************************************************************36940000
353100*  CLOSES ALLOCATION                                              36950000
353200******************************************************************36960000
353300 2325-CLOSE-ALLOC-CSR.                                            36970000
353400                                                                  36980000
353500     EXEC SQL                                                     36990000
353600         CLOSE ALLOC-CSR                                          37000000
353700     END-EXEC.                                                    37010000
353800                                                                  37020000
353900     EVALUATE TRUE                                                37030000
354000         WHEN SQLCODE = +0                                        37040000
354100             CONTINUE                                             37050000
354200         WHEN SQLWARN NOT = SPACE                                 37060000
354300         WHEN SQLCODE NOT = +0                                    37070000
354400             MOVE '2325-CLOSE-ALLOC-CSR'                          37080000
354500                                   TO PV-ABEND-PARAGRAPH          37090000
354600             PERFORM 9000-SQL-ABEND                               37100000
354700     END-EVALUATE.                                                37110000
354800******************************************************************37120000
354900*  CLOSES UPC CURSOR                                              37130000
355000******************************************************************37140000
355100*2326-CLOSE-UPC-CSR.                                              37150028
355200*                                                                 37160028
355300*    EXEC SQL                                                     37170028
355400*        CLOSE UPC_CURSOR                                         37180028
355500*    END-EXEC.                                                    37190028
355600*                                                                 37200028
355700*    EVALUATE TRUE                                                37210028
355800*        WHEN SQLCODE = +0                                        37220028
355900*            CONTINUE                                             37230028
356000*        WHEN SQLWARN NOT = SPACE                                 37240028
356100*        WHEN SQLCODE NOT = +0                                    37250028
356200*            MOVE '2326-CLOSE-UPC-CSR'                            37260028
356300*                                  TO PV-ABEND-PARAGRAPH          37270028
356400*            PERFORM 9000-SQL-ABEND                               37280028
356500*    END-EVALUATE.                                                37290028
356600                                                                  37300000
356700******************************************************************37310000
356800*  CLOSES PO LINE CSR                                             37320000
356900******************************************************************37330000
357000 2330-CLOSE-PO-LINE-CSR.                                          37340000
357100                                                                  37350000
357200     PERFORM WITH TEST AFTER                                      37360000
357300        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      37370000
357400        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              37380000
357500                SQLCODE = ZERO                                    37390000
357600        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               37400000
357700                            OR 'RS' OR 'WK'                       37410000
357800            EXEC SQL                                              37420000
357900                CLOSE PO-LINE-CSR                                 37430000
358000            END-EXEC                                              37440000
358100        ELSE                                                      37450000
358200            EXEC SQL                                              37460000
358300                CLOSE APP-PO-LINE-CSR                             37470000
358400            END-EXEC                                              37480000
358500        END-IF                                                    37490000
358600                                                                  37500000
358700        EVALUATE TRUE                                             37510000
358800            WHEN SQLCODE = +0                                     37520000
358900                CONTINUE                                          37530000
359000            WHEN SQLCODE = -904                                   37540000
359100            WHEN SQLCODE = -911                                   37550000
359200            WHEN SQLCODE = -913                                   37560000
359300                CONTINUE                                          37570000
359400            WHEN SQLWARN NOT = SPACE                              37580000
359500            WHEN SQLCODE NOT = +0                                 37590000
359600                MOVE '2330-CLOSE-PO-LINE-CSR'                     37600000
359700                                      TO PV-ABEND-PARAGRAPH       37610000
359800                PERFORM 9000-SQL-ABEND                            37620000
359900        END-EVALUATE                                              37630000
360000     END-PERFORM.                                                 37640000
360100                                                                  37650000
360200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37660000
360300         MOVE '2330-CLOSE-PO-LINE-CSR' TO PV-ABEND-PARAGRAPH      37670000
360400         PERFORM 9000-SQL-ABEND                                   37680000
360500     END-IF.                                                      37690000
360600                                                                  37700000
360700*----------------------------------------------------------------*37710000
360800*    NAME REFORMATOR MODULE                                      *37720000
360900*----------------------------------------------------------------*37730000
361000     COPY DPPD024.                                                37740000
361100/                                                                 37750000
361200******************************************************************37760000
361300*  - ERROR ROUTINE FOR DB2 ABENDS                                 37770000
361400******************************************************************37780000
361500 9000-SQL-ABEND.                                                  37790000
361600                                                                  37800000
361700     MOVE SQLCODE                  TO SQLCODE2.                   37810000
361800     MOVE SQLERRD(3)               TO SQLERRD3.                   37820000
361900     DISPLAY '** ABEND          **'.                              37830000
362000     DISPLAY '** PROGRAM        ** = POKRP003'.                   37840000
362100     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        37850000
362200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  37860000
362300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  37870000
362400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   37880000
362500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  37890000
362600     MOVE +4013                    TO PV-ABEND-CODE.              37900000
362700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         37910000
362800******************************************************************37920000
